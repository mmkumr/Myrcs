"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8721],{22433:(e,t,n)=>{n.r(t),n.d(t,{AssistantChatStep:()=>ee,AssistantLabelerBar:()=>fe,AssistantMenuPopup:()=>Ht,AssistantOriginElement:()=>It,TopbarAssistantButton:()=>Ie,UpdateSidebarTabAssistant:()=>ht,assistantActions:()=>a});var a=n(94715),i=n(10434),o=n.n(i),r=n(23174),l=n.n(r),s=n(67294),d=n(480),c=n(86628),u=n(24405),p=n(49019),m=n(23867),v=n(70203),g=n(97880),f=n(50906),y=n(91839),h=n(26388),k=n(95477),S=n(60682),b=n(14976),C=(n(21703),n(18466)),w=n(26263),x=n(88891),I=n(21202),A=n(19889),T=n(14871),B=n(39699),Z=n(15201),E=n(55217),F=n(57559),M=n(49065);function V(e){window.__c={n:"AssistantChatMessageRenderer"};const{clientStep:t}=e,n=(0,d.O7)(),a=(0,s.useMemo)((()=>C.Z.withListenerIgnored((()=>function(e){const{environment:t,clientStep:n}=e,a=new w.Z({name:"AssistantChatMessageRenderer"}),i=t.currentUser.id;if(!i)throw new Error("No current user.");const o={table:A.KJ,id:i},r=B.createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStore",environment:t,perform:e=>{for(const l of n.operations){const n=(0,x.ND)({assistantOperation:l,actorPointer:o,getRecordValue:a.makeGetRecordValueFn(i),spaceId:e.spaceId});for(const i of n){const n=new M.ST({environment:t,pointer:i.pointer,path:i.path,inMemoryRecordCache:a});B.applyOperation({store:n,operation:i,transaction:e})}}const r=n.blockIds.map((e=>new F.G(t,{table:I.iU,id:e},{inMemoryRecordCache:a})));return T.Lh({environment:t,stores:r,inMemoryRecordCache:a,transaction:e})}}).performResult;return a.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),r}({environment:n,clientStep:t})))),[n,t]);return l()(Z.O,{displayName:"AssistantChatStepContent",disabled:!0},void 0,l()(E.Z,{store:a,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,disableDrag:!0}))}var _=n(15145),K=n(72126),P=n(5366),L=n(82990),R=n(24677),z=n(2456),D=n(16550),O=n(61519),N=n(84076),W=n(76798),U=n(90706),q=n(84210),H=n(95802),G=n(80444),Q=n(5737);function j(e){window.__c={n:"AssistantTransactionRenderer"};const{clientStep:t}=e,n=(0,x.rn)(t.operations),a=(0,u.yK)((e=>({divider:{marginTop:6,marginBottom:6},subheader:{color:e.mediumTextColor}})),[]);return s.createElement(s.Fragment,null,n.map(((e,t)=>s.createElement(s.Fragment,null,l()(Y,{group:e},t),n[t+1]&&l()(O.Z,{style:a.divider,size:1})))))}function Y(e){window.__c={n:"AssistantTransactionGroupRenderer"};const{group:t}=e,n=(0,u.yK)((e=>({header:{marginBottom:6,color:e.mediumTextColor},pageTitle:{display:"inline",color:e.regularTextColor,fontWeight:L.Z.fontWeight.semibold,whiteSpace:void 0,overflow:void 0,textOverflow:void 0,textDecoration:"underline"},divider:{marginBottom:6},subheader:{color:e.mediumTextColor}})),[]),a=(0,c.VK)((()=>{const{mainEditorCurrentBlockStore:e}=G.default.state;if(!e)throw new Error("No main editor current block store");return e}),[]),i=(0,c.VK)((()=>a.getSpaceId()),[a]),o=F.G.createChildStore(a,{table:I.iU,id:t.pageId,spaceId:i}),r=(0,c.VK)((()=>{if("updatedPage"!==t.type)return[];const e=o.getParentCollectionStore(),n=null==e?void 0:e.getSchema();return K.oA(Array.from(t.updatedPropertyNames).map((e=>{const t=Object.entries(n||{}).find((t=>{let[,n]=t;return(null==n?void 0:n.name)===e}));if(t)return t[0]})))}),[o,t]),d=(0,c.VK)((()=>t.pageId===a.id?(0,q.ZP)({store:a,pageVisitSource:_.tY.AIChat,fullyQualified:!1}):(0,q.ZP)({store:a,pageVisitSource:_.tY.AIChat,fullyQualified:!1,peekViewBlockId:t.pageId})),[a,t.pageId]);if("updatedPage"===t.type){const{insertedBlockIds:e,updatedBlockIds:a,removedBlockIds:i,updatedTitle:c,updatedPropertyNames:u}=t,p=e.size+a.size+i.size+(c?1:0)+u.size;return s.createElement(s.Fragment,null,l()(N.Z,{style:n.header,href:d},void 0,l()("span",{},void 0,t.didCreatePage?l()(P.FormattedMessage,{defaultMessage:"Created {page}",id:"assistant.transactionRenderer.createdPage.title",values:{page:l()(W.Z,{store:o,style:n.pageTitle})}}):l()(P.FormattedMessage,{defaultMessage:"{numEdits, plural, one {1 edit to {page}} other {{numEdits} edits to {page}}}",id:"assistant.transactionRenderer.editedPage.title",values:{numEdits:p,page:l()(W.Z,{store:o,style:n.pageTitle})}}))),c&&s.createElement(s.Fragment,null,l()("div",{style:n.subheader},void 0,"Updated title"),l()(X,{blockIds:[t.pageId]})),r.length>0&&s.createElement(s.Fragment,null,r.map(((e,t)=>l()($,{pageStore:o,property:e},t)))),e.size>0&&s.createElement(s.Fragment,null,l()("div",{style:n.subheader},void 0,`Inserted ${e.size} block${e.size>1?"s":""}`),l()(X,{blockIds:Array.from(e)})),a.size>0&&s.createElement(s.Fragment,null,l()("div",{style:n.subheader},void 0,`Updated ${a.size} block${a.size>1?"s":""}`),l()(X,{blockIds:Array.from(a)})),i.size>0&&s.createElement(s.Fragment,null,l()("div",{style:n.subheader},void 0,`Removed ${i.size} block${i.size>1?"s":""}`),l()(X,{blockIds:Array.from(i)})))}if("removedPage"===t.type)return l()(N.Z,{style:n.header,href:d},void 0,l()("span",{},void 0,l()(P.FormattedMessage,{defaultMessage:"Deleted {page}",id:"assistant.transactionRenderer.removedPage.title",values:{page:l()("span",{style:{fontWeight:L.Z.fontWeight.bold}},void 0,l()(W.Z,{store:o,style:n.pageTitle}))}})));(0,g.t1)(t)}function $(e){window.__c={n:"BlockPropertyRenderer"};const{pageStore:t,property:n}=e,a=(0,c.VK)((()=>t.getParentCollectionStore()),[t]),i=(0,c.VK)((()=>{const e=null==a?void 0:a.getSchema(),t=Object.entries(e||{}).find((e=>{let[t]=e;return t===n}));return null==t?void 0:t[1]}),[a,n]),o=(0,c.VK)((()=>t.getPropertyValue(n)),[t,n]);return a&&i?s.createElement(s.Fragment,null,l()(z.Hq,{labeled:!0,name:i.name,type:i.type,icon:i.icon,style:{marginBottom:6}},void 0,l()(U.Z,{propertySchema:i,beforeValue:{value:[],spaceId:a.getSpaceId()},afterValue:{value:o||[],spaceId:a.getSpaceId()},rootStore:t}))):null}function X(e){window.__c={n:"BlockListRenderer"};const{blockIds:t}=e,n=(0,d.O7)(),a=(0,s.useMemo)((()=>C.Z.withListenerIgnored((()=>{const e=H.C.findSelectablesFromIds(t),a=t.map((t=>{if(!Q.N.state)throw new Error("No state");const a=e.find((e=>e.props.store.id===t));return(null==a?void 0:a.props.store)||new F.G(n,{table:I.iU,id:t},{inMemoryRecordCache:Q.N.state.temporaryCache})}));return R.rs(a),a}))),[n,t]);return l()(Z.O,{displayName:"AssistantBlockRenderer",disabled:!0},void 0,a.map(((e,t)=>l()(J,{store:e},t))))}function J(e){window.__c={n:"BlockRenderer"};const{store:t}=e,n=(0,c.VK)((()=>(0,D.h)(t)),[t]);return n?l()(n,{store:t,disabled:!0,isFirstItem:!1,isLastItem:!1}):null}function ee(e){window.__c={n:"AssistantChatStep"};const{clientStep:t,parentStore:n,parentSpaceId:a,fakeSlackUser:i,configurationState:r}=e,k=(0,d.O7)(),C=(0,u.Fg)(),w=(0,u.yK)((e=>({wrap:{display:"flex",marginTop:6,marginBottom:6},baseMessage:{maxWidth:"80%",borderRadius:12,padding:"6px 10px",fontSize:14,whiteSpace:"pre-wrap",overflowWrap:"break-word",position:"relative"},userLabel:{fontSize:12,color:e.mediumTextColor},humanMessage:{backgroundColor:e.accentColors.purple[50],color:e.aiPurpleColor},assistantThinkMessage:{backgroundColor:e.accentColors.gray[50],color:e.mediumTextColor},assistantMessage:{backgroundColor:e.contentBackground,color:e.darkTextColor,boxShadow:e.buttonBoxShadow},assistantFriendlyError:{backgroundColor:e.accentColors.red[50],boxShadow:e.buttonBoxShadow,color:e.accentColors.red[500]}})),[]),x=(0,c.VK)((()=>{if("human"===t.type)return(0,b.IY)({environment:k,textValue:{value:t.text,spaceId:(0,m.C)(a)},parentStore:n,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:C,emojiType:(0,S.e_)(k),katex:k.KatexStore.getKatex(),formulaValueTypes:[]});if("assistantLoading"===t.type)return l()(y.Z,{});if("assistantThink"===t.type)return`ðŸ’¡ ${t.thought}`;if("assistantChatText"===t.type)return t.text;if("assistantChat"===t.type)return l()(V,{clientStep:t});if("assistantTransaction"===t.type)return l()(j,{clientStep:t});if("assistantLoadPage"===t.type)return"Load page";if("assistantFriendlyError"===t.type)return s.createElement(s.Fragment,null,l()("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"}},void 0,"I'm sorry! I wasn't able to complete this query. Please try asking me a different question."));if("assistantSearch"===t.type)return s.createElement(s.Fragment,null,l()("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"}},void 0,(0,p.e)({width:14,marginRight:4}),l()("b",{},void 0,"Search "),t.question));if("assistantSearchPeople"===t.type)return s.createElement(s.Fragment,null,l()("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"}},void 0,(0,p.e)({width:14,marginRight:4}),l()("b",{},void 0,"Search people "),t.search));if("queryDatabase"===t.type)return l()("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"}},void 0,(0,p.e)({width:14,marginRight:4}),l()("b",{},void 0,"Query database"));if("assistantShowSearchResults"===t.type){const{searchResults:e}=t,a=e.map((e=>(0,b.IY)({environment:k,parentStore:n,textValue:{value:[(0,v.YCD)(["p",e])],spaceId:n.id},disableHover:!0,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:C,emojiType:(0,S.e_)(k),katex:k.KatexStore.getKatex(),formulaValueTypes:[]}))).slice(0,3);return s.createElement(s.Fragment,null,l()("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"}},void 0,(0,p.e)({width:14,marginRight:4}),l()("b",{},void 0,"Search Results"),l()("div",{style:{display:"flex",flexDirection:"column"}},void 0,a.map(((e,t)=>l()("div",{},t,e))))))}(0,g.t1)(t)}),[t,k,a,n,C]);return s.createElement(s.Fragment,null,l()(h.Z,{placement:h.Z.Placement.Left,textWrap:!0,style:{maxWidth:240},disableTooltip:!("thought"in t&&t.thought,0),renderTooltip:()=>"thought"in t?`ðŸ’¡ ${t.thought}`:void 0,delayThreshold:500,render:e=>s.createElement("div",o()({style:w.wrap},e,{onClick:e=>{e.target instanceof HTMLSpanElement&&null!=r&&r.isQnA&&f.lO(k,r,e.target.baseURI.split("/").slice(-1)[0])}}),"human"===t.type&&l()("div",{style:{flexGrow:1}}),l()("div",{style:{...w.baseMessage,..."human"===t.type?w.humanMessage:"assistantThink"===t.type?w.assistantThinkMessage:"assistantFriendlyError"===t.type?w.assistantFriendlyError:w.assistantMessage}},void 0,x))}),i&&"human"===t.type&&l()("div",{style:{display:"flex"}},void 0,l()("div",{style:{flexGrow:1}}),l()("div",{style:w.userLabel},void 0,i.name)))}var te=n(94568),ne=n(42875),ae=n(59054),ie=n(54642),oe=n(98104),re=n(52275),le=n(88359),se=n(1743),de=n(74194),ce=n(68785),ue=n(63296),pe=n(53437),me=n(45959),ve=n(82375),ge=n(24666);function fe(){window.__c={n:"AssistantLabelerBar"};const e=(0,d.O7)(),t=(0,u.yK)((e=>({wrap:{padding:8,backgroundColor:e.contentBackground,width:400},samplingPicker:{display:"flex",alignItems:"center",marginBottom:8,gap:4},error:{fontSize:14,color:e.accentColors.red[600],maxHeight:150,overflow:"scroll"},observation:{fontSize:14,maxHeight:150,overflow:"scroll"},tooltip:{width:500,whiteSpace:"pre-wrap",fontFamily:L.Z.baseFontFamily.mono},input:{marginTop:5,marginBottom:5,fontFamily:L.Z.baseFontFamily.githubMono,fontSize:12},inputInner:{height:100}})),[]),n=(0,c.VK)((()=>ve.Hl.state),[]),i=(0,c.VK)((()=>ve.XN.state),[]),o=(0,c.VK)((()=>Q.N.state),[]),r=(0,c.VK)((()=>Boolean(i&&i.sampledSteps.length>0)),[i]),p=(0,c.VK)((()=>Boolean(o&&(o.sampling||o.evaluating))),[o]),m=(0,c.VK)((()=>null==i?void 0:i.previewingStepIndex),[i]),v=(0,c.VK)((()=>{const e=null==i?void 0:i.previewingStepIndex;var t;if("number"==typeof e)return null==i||null===(t=i.sampledSteps)||void 0===t?void 0:t[e]}),[i],{useDeepEqual:!0}),g=(0,c.VK)((()=>(null==i?void 0:i.previewingStepObservations)||[]),[i],{useDeepEqual:!0}),f=g.filter((e=>"error"===e.observationType)),y=g.filter((e=>"error"!==e.observationType)),h=(0,s.useCallback)((()=>{a.cancelPreviewStep()}),[]),S=(0,s.useCallback)((async t=>{if(!v||!i)return;const n={...v,value:t.target.value};(0,ve.zZ)({store:ve.XN,step:n}),await a.simulateOrCommitStep({environment:e,step:n,commit:!1,isStreaming:!1,preventSelection:!0})}),[e,v,i]),b=(0,s.useCallback)((async t=>{i&&await a.simulateOrCommitStep({environment:e,step:i.sampledSteps[t],commit:!1,isStreaming:!1})}),[e,i]),C=(0,s.useCallback)((async()=>{if(!i)return;const t=i.previewingStepObservations.length>0;await a.commitPreviewAssistantStep({environment:e}),t||await a.applyUncommittedOperations({environment:e})}),[e,i]),w=(0,s.useCallback)((async()=>{await a.retryNextAssistantSteps({environment:e})}),[e]),x=(0,c.VK)((()=>({top:20,left:0,right:0,bottom:0,width:e.WindowSizeStore.state.width,height:0})),[e],{useDeepEqual:!0}),[I,A]=(0,s.useState)(!1),T=(0,s.useCallback)((()=>{ge.default.hasSelection()&&oe.ZH(e),A(!0)}),[e,A]),B=(0,s.useCallback)((()=>{A(!1)}),[A]),Z=k.default.isLocalhost||!1;return l()(pe.ZP,{popupType:pe.kQ.Popup,open:!0,originRect:x,originGap:6,disableMouseCapture:!0,render:()=>l()(se.Z,{capture:I},void 0,l()("div",{style:t.wrap},void 0,l()(ye,{}),r&&s.createElement(s.Fragment,null,l()("div",{style:t.samplingPicker},void 0,l()(ue.Z,{hovered:void 0===m||void 0,onClick:h},void 0,"Original"),l()(ue.Z,{hovered:0===m||void 0,onClick:()=>b(0)},void 0,"A"),l()(ue.Z,{hovered:1===m||void 0,onClick:()=>b(1)},void 0,"B"),l()("div",{style:{flexGrow:1}}),p&&l()(ce.Z,{style:{marginRight:4}}),l()(ue.Z,{disabled:!Z&&(void 0===m||p||!n),disabledFeedback:!0,onClick:w},void 0,"Retry"),l()(ue.Z,{disabled:!Z&&(void 0===m||p||!n),disabledFeedback:!0,onClick:C,isBlue:!0},void 0,"Accept")),v&&l()(de.Z,{style:t.input,inputStyle:t.inputInner,value:v.value,onChange:S,onFocus:T,onBlur:B,textarea:!0,spellCheck:!1}),f.length>0&&!p&&l()("div",{style:t.error},void 0,f.map((e=>e.value)).join("\n")),y.length>0&&!p&&l()("div",{style:t.observation},void 0,"Results: ",y.map((e=>e.value)).join("\n")))))})}function ye(e){var t;window.__c={n:"TaskPicker"};const n=(0,d.O7)(),a=(0,c.VK)((()=>ve.Hl.state),[]),[i]=(0,ae.r5)((async()=>{const e="results",t={type:"reducer",filter:{operator:"and",filters:[{property:"ouFf",filter:{operator:"status_is",value:{type:"is_group",value:"In progress"}}}]},sort:[],userId:n.currentUser.id,userTimeZone:(0,ne.r)(),searchQuery:void 0,reducers:{[e]:{type:"results",limit:100}}},a=await ie.queryCollection(n,{source:{type:"collection",id:"f704a995-6417-457a-8038-ca9e1cb2c65f",spaceId:te.vj},collectionView:{id:"1dee420b-aa96-4e48-8eba-c2a0613e179e",spaceId:te.vj},loader:t},void 0,{src:"queryCollectionAction"});if("failed"===a.type)return;const i=a.data.result.reducerResults.results;if(!i||"results"!==i.type)return;const{blockIds:o}=i;let r=K.oA(o.map((e=>new F.G(n,{table:I.iU,id:e}).getValue()))).map((e=>{var t,n,a;return{id:e.id,name:(0,v.QaF)(null==e||null===(t=e.properties)||void 0===t?void 0:t.title),url:(0,v.QaF)(null==e||null===(n=e.properties)||void 0===n?void 0:n["}v_K"]),type:(0,v.QaF)(null==e||null===(a=e.properties)||void 0===a?void 0:a.pdfW)}}));return r=K.MR(r,(e=>e.name.toLowerCase())),r}),[n]),r=(0,s.useCallback)((e=>{var t;const n=null===(t=i.value)||void 0===t?void 0:t.find((t=>t.id===e));n&&ve.Hl.setState(n)}),[i]),p={menuTitle:"",items:(null===(t=i.value)||void 0===t?void 0:t.map((e=>e.id)))??[],getKey:e=>e,selectedItem:null==a?void 0:a.id,onSelect:r,renderItem:e=>{var t;const n=null===(t=i.value)||void 0===t?void 0:t.find((t=>t.id===e.value));return s.createElement(re.Z,o()({},e,{title:null==n?void 0:n.name}))},renderOrigin:e=>s.createElement(le.Z,o()({focused:!1,title:"",right:(null==a?void 0:a.name)||l()("span",{style:{color:"red"}},void 0,"Please select a task")},e)),width:300},m=(0,u.yK)((e=>({wrap:{marginBottom:8},inner:{display:"flex",alignItems:"center",marginBottom:4,gap:4},label:{fontSize:14,flexShrink:0},link:{fontSize:14,textDecoration:"underline"}})),[]);return l()("div",{style:m.wrap},void 0,l()("div",{style:m.inner},void 0,l()("div",{style:m.label},void 0,"Current task:"),s.createElement(me.Z,p)),a&&l()(N.Z,{style:m.link,href:a.url,external:!0},void 0,"Instructions for task"))}var he=n(11751),ke=n(74647),Se=n(73063),be=n(43250),Ce=n(34700),we=n(45094),xe=n(7011);function Ie(e){window.__c={n:"TopbarAssistantButton"};const{blockStore:t}=e,n=(0,d.O7)(),{isElectronMac:a}=n.device,i=(0,u.yK)((e=>({icon:{height:20,width:20,fill:e.aiPurpleColor},button:{...(0,Ce.X)(a,!1),width:33,height:28,marginRight:2}})),[a]),o=(0,s.useCallback)((()=>{ke.handleSidebarButtonClick(n,t,xe.gY.Assistant,"topbar")}),[n,t]),r=(0,c.VK)((()=>(0,we.Sx)(n)&&xe.ZP.state.currentTab===xe.gY.Assistant),[n]);return l()(Se.Z,{icon:he.t,iconStyle:i.icon,style:i.button,ariaLabel:"Assistant",className:be.N27,onClick:o,hovered:r})}var Ae=n(75553),Te=n(84169),Be=n(47453),Ze=n(47307),Ee=n(75018),Fe=n(31299),Me=n(97444),Ve=n(10052),_e=n(89728),Ke=n(53336),Pe=n(72495),Le=n(57254),Re=n(12921),ze=n(17809),De=n(34859),Oe=n(74822),Ne=n(64921);function We(e){window.__c={n:"AssistantActionButton"};const{style:t,icon:n,disabled:a,iconStyle:i,title:o,onClick:r,focused:s}=e,d=(0,u.yK)((e=>({AssistantActionButton:{background:e.cardContentBackground,display:"flex",alignItems:"center",boxShadow:e.borderBoxShadow,padding:"6px 10px",color:e.regularTextColor,fontSize:14,borderRadius:24,width:"max-content"},icon:{width:14,height:14,fill:e.regularIconColor,marginRight:6}})),[]);return l()(Ne.Z,{disabled:a,style:{...d.AssistantActionButton,...t},onClick:r,focused:s},void 0,null==n?void 0:n({...d.icon,...i}),o)}var Ue=n(83176),qe=n(79198),He=n(98519),Ge=n(33676),Qe=n(39986),je=n(55863),Ye=n(4615),$e=n(64964),Xe=n(49085);class Je extends Xe.default{getInitialState(){return{inferenceId:"",feedback:"thumbs_up"}}}const et=new Je;class tt extends Xe.default{getInitialState(){return{open:!1,inferenceId:void 0}}}const nt=new tt;var at=n(39040),it=n(42922),ot=n(60458),rt=n(36488),lt=n(64369),st=n(92660);const dt=["Difficult to understand","Does not answer my question","Contains irrelevant details","Contains misleading or made-up information","Uses outdated information","I don't fully trust this answer"];function ct(){window.__c={n:"ReportBadQnAForm"};const e=(0,u.yK)((e=>({reasonsArea:{width:"100%",background:e.popoverBackground,display:"block",marginBottom:16},title:{},checkboxArea:{display:"flex",alignItems:"center",gap:8},modalWrap:{width:"32rem",padding:24,fontSize:14},modalTitle:{fontSize:16,fontWeight:L.Z.fontWeight.medium},modalSubtitle:{fontSize:14},titleContainer:{marginBottom:16},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18},outlineButton:{marginRight:12},selectAll:{fontWeight:500,marginBottom:4},checkboxContainer:{display:"flex",flexDirection:"column",gap:4},linkTruncated:{maxWidth:"16rem",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"auto"}})),[]),[t,n]=(0,s.useState)([]),a=(0,s.useCallback)((e=>()=>{t.includes(e)?n((t=>t.filter((t=>t!==e)))):n((t=>[...t,e]))}),[t]),i=e=>t.includes(e),[r,p]=(0,s.useState)(),[m,g]=(0,s.useState)([]),f=(0,c.VK)((()=>G.default.state.currentSpaceStore),[]),y=(0,d.O7)(),h=(0,u.Fg)(),k=(0,s.useCallback)((()=>{const{inferenceId:e}=nt.state,n=null==f?void 0:f.id;e&&n&&(ie.saveAssistantFeedback(y,{type:"slackbot_followup_feedback",id:e,notes:r||"",reasons:t,correctAnswerPageIds:m}),nt.reset())}),[null==f?void 0:f.id,y,r,t,m]),C=(0,s.useCallback)((e=>{m.includes(e)?g((t=>t.filter((t=>t!==e)))):g((t=>[...t,e]))}),[m]),w=(0,s.useCallback)((e=>m.includes(e)),[m]),x=(0,c.VK)((()=>{var e,t,n;const a=null===(e=ve.XN.state)||void 0===e||null===(e=e.evaluator)||void 0===e||null===(e=e.codeEvaluator)||void 0===e?void 0:e.state,i=G.default.state.currentSpaceStore,o=null===(t=ve.XN.state)||void 0===t||null===(t=t.evaluator)||void 0===t?void 0:t.getTranscript().filter((e=>"observation"===e.type&&"search"===e.observationType)),r=null==o||null===(n=o[o.length-1])||void 0===n?void 0:n.value;if(!r||!i)return[];const l=(0,at.P)(r)[0];if("element"===(s=l).type&&"search-results"===s.tagName&&(null===(d=s.children)||void 0===d?void 0:d.every((e=>"element"===e.type&&"page-result"===e.tagName)))){return l.children.map((e=>{var t;return((null==e||null===(t=e.attributes)||void 0===t?void 0:t.id)&&(null==a?void 0:a.getIdMapper().mapCounterToKey(e.attributes.id).key))??void 0})).filter((e=>!!e)).map((e=>({pageId:e,component:(0,b.IY)({environment:y,parentStore:i,textValue:{value:[(0,v.YCD)(["p",e])],spaceId:i.id},disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:h,emojiType:(0,S.e_)(y),katex:y.KatexStore.getKatex(),formulaValueTypes:[]})})))}var s,d;return[]}),[y,h]);return l()(st.Z,{onDismiss:ut,render:()=>l()(rt.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:t=>s.createElement("div",o()({style:e.modalWrap},t),l()("div",{style:e.titleContainer},void 0,l()("div",{style:e.modalTitle},void 0,l()(P.FormattedMessage,{id:"BadQnAFeedbackForm.title",defaultMessage:"Report bad question & answer"}))),l()("div",{style:e.reasonsArea},void 0,l()("div",{style:e.selectAll},void 0,"What should we know about this answer?"),l()("div",{style:e.checkboxContainer},void 0,dt.map((t=>l()("div",{style:e.checkboxArea},t,l()(ot.Z,{checked:i(t),onClick:a(t),size:14,checkSize:10}),l()(lt.Z,{style:e.title},void 0,t)))))),l()("div",{style:e.reasonsArea},void 0,l()("div",{style:e.selectAll},void 0,"Do any of these pages have the correct answer?"),l()("div",{style:{display:"flex",flexDirection:"column",gap:4}},void 0,x.map(((t,n)=>l()("div",{style:e.checkboxArea},t.pageId,l()(ot.Z,{checked:w(t.pageId),onClick:()=>C(t.pageId),size:14,checkSize:10}),l()("div",{style:e.linkTruncated,onClick:e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget.firstElementChild instanceof HTMLAnchorElement&&window.open(e.currentTarget.firstElementChild.href,"_blank")}},void 0,t.component)))))),l()(de.Z,{textarea:!0,placeholder:"Additional comments...",value:r,onChange:e=>p(e.target.value),focusInitial:!0,inputStyle:{padding:8}}),l()("div",{style:e.buttonArea},void 0,l()(ue.Z,{isLarge:!0,onClick:ut,style:e.outlineButton},void 0,l()(P.FormattedMessage,{id:"BadQnAFeedbackForm.cancelButton.label",defaultMessage:"Cancel"})),l()(it.Z,{isLarge:!0,onClick:k},void 0,l()(P.FormattedMessage,{id:"BadQnAFeedbackForm.reportButton.label",defaultMessage:"Submit"}))))}),requireOnline:!0,modalStore:nt})}function ut(){nt.update((()=>({open:!1,inferenceId:void 0})))}function pt(e){window.__c={n:"AssistantFeedbackBar"};const{type:t}=e,[n,i]=(0,s.useState)((()=>(0,Ye.ZP)())),o=(0,c.VK)((()=>et.state.inferenceId===n?et.state.feedback:void 0),[n]),r=(0,c.VK)((()=>Q.N.state),[]),p=(0,s.useMemo)((()=>Boolean(r&&r.isQnA)),[r]),m=(0,d.O7)(),v=(0,u.yK)((e=>({wrap:{display:"flex",marginTop:8,marginBottom:6,gap:6},thumbsUpFeedbackButton:{width:32,background:"thumbs_up"===o?e.accentColors.gray[50]:"unset",boxShadow:e.buttonBoxShadow},thumbsDownFeedbackButton:{width:32,background:"thumbs_down"===o?e.accentColors.gray[50]:"unset",boxShadow:e.buttonBoxShadow}})),[o]),g=(0,s.useCallback)((async()=>{await a.saveFeedback({environment:m,inferenceId:n,type:"assistant_accept_edits"}),await a.commitPreviewAssistantStep({environment:m}),await a.applyUncommittedOperations({environment:m})}),[m,n]),f=(0,s.useCallback)((async()=>{await a.saveFeedback({environment:m,inferenceId:n,type:"assistant_fix_errors"}),await a.commitPreviewAssistantStep({environment:m})}),[m,n]),y=(0,s.useCallback)((async()=>{await a.saveFeedback({environment:m,inferenceId:n,type:"assistant_undo"}),await a.commitPreviewAssistantStep({environment:m}),a.resetUncommittedOperations({environment:m})}),[m,n]),h=(0,s.useCallback)((async()=>{await a.saveFeedback({environment:m,inferenceId:n,type:"assistant_retry"}),await a.retryNextAssistantSteps({environment:m})}),[m,n]),k=(0,s.useCallback)((async()=>{await a.saveFeedback({environment:m,inferenceId:n,type:"assistant_thumbs_up"}),et.update((()=>({feedback:"thumbs_up",inferenceId:n}))),$e.oV({label:"Thanks for your feedback!"})}),[m,n]),S=(0,s.useCallback)((async()=>{await a.saveFeedback({environment:m,inferenceId:n,type:"assistant_thumbs_down"}),et.update((()=>({feedback:"thumbs_down",inferenceId:n}))),nt.update((()=>({open:!0,inferenceId:n})))}),[m,n]);return l()("div",{style:v.wrap},void 0,"feedback"===t&&s.createElement(s.Fragment,null,l()(We,{icon:Qe.P,disabled:void 0!==o,style:v.thumbsUpFeedbackButton,onClick:k}),l()(We,{icon:Ge.A,disabled:void 0!==o,style:v.thumbsDownFeedbackButton,onClick:S}),p&&l()(ct,{})),"accept_action"===t&&s.createElement(s.Fragment,null,l()(We,{icon:He.k,onClick:g,title:l()(P.FormattedMessage,{defaultMessage:"Accept all",id:"assistant.acceptAllButton"})}),l()(We,{icon:je.s,onClick:y,title:l()(P.FormattedMessage,{defaultMessage:"Undo all",id:"assistant.undoAllButton"})})),"error"===t&&s.createElement(s.Fragment,null,l()(We,{icon:Ue.z,onClick:f,title:l()(P.FormattedMessage,{defaultMessage:"Fix errors",id:"assistant.fixErrorsButton"})})),l()(We,{icon:qe.n,onClick:h,title:l()(P.FormattedMessage,{defaultMessage:"Try again",id:"assistant.retryButton"})}))}var mt=n(80402),vt=n(65187);function gt(e){window.__c={n:"AssistantRichTextInput"};const{store:t,placeholder:n,disabled:a,onSubmit:i}=e,o=(0,d.O7)(),r=(0,u.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:8,padding:"6px 10px",marginLeft:8,marginRight:8,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{minHeight:40},placeholder:{minHeight:40,opacity:a?.5:1}})),[a]),c=(0,s.useCallback)((e=>{if(i&&!e.shiftKey)i(t.getValue()),B.createAndCommit({userAction:"AssistantRichTextInput.valueChanged",environment:o,perform:e=>{Me.sO({environment:o,store:t,value:void 0,transaction:e})}});else{const e=ge.default.state;if("editing"!==e.mode)return;B.createAndCommit({userAction:"AssistantRichTextInput.handleEnter",environment:o,perform:t=>{Me.hJ({environment:o,string:"\n",multiSelection:e.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}})}}),[o,t,i]);return l()("div",{style:r.wrap,className:be.Wh_},void 0,l()(vt.Z,{placeholder:n,disabled:a??!1,store:t,style:r.text,placeholderStyle:r.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!1,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:c,disableMobileActionBar:!1,disableDateReminderMentions:!0,disableStyleAnnotations:!0,onFocus:()=>mt.MO()}))}var ft=n(31278);function yt(e){window.__c={n:"InstructionsPageBar"};const{sourceBlock:t,instructionsPage:n}=e,a=(0,d.O7)(),i=(0,c.VK)((()=>t.getIcon()),[t]),o=(0,s.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=G.default.state;if(!e)return;const t=(0,q.ZP)({store:e,pageVisitSource:_.tY.AIChat,fullyQualified:!1,peekViewBlockId:n.id});Ee.navigate({environment:a,url:t})}),[a,n]),r=(0,u.yK)((e=>({InstructionsPageBar:{display:"flex",fontSize:14,background:e.cardBackground,padding:12,borderRadius:12,gap:8,alignItems:"center",marginBottom:12},icon:{display:"inline-block"},text:{flexGrow:1,overflow:"hidden"}})),[]);return l()("div",{style:r.InstructionsPageBar},void 0,i&&l()(ft.Z,{disabled:!0,icon:i,isEmptyPage:!1,size:18,style:r.icon}),l()("div",{style:r.text},void 0,l()(P.FormattedMessage,{defaultMessage:"Using custom instructions from {recordIconAndTitle}",id:"assistant.instructionsBar.title",values:{recordIconAndTitle:l()("span",{style:{whiteSpace:"nowrap",fontWeight:L.Z.fontWeight.bold}},void 0,l()(W.Z,{store:t,style:{display:"inline"}}))}})),l()(it.Z,{onClick:o},void 0,l()(P.FormattedMessage,{defaultMessage:"Edit",id:"assistant.instructionsBar.editButton"})))}function ht(){var e;window.__c={n:"UpdateSidebarTabAssistant"};const t=(0,s.useRef)(void 0),n=(0,c.VK)((()=>ve.XN.state),[]),i=(0,c.VK)((()=>Q.N.state),[]),r=(0,d.O7)(),p=(0,c.VK)((()=>G.default.state.mainEditorCurrentBlockStore),[]),m=(0,c.VK)((()=>G.default.state.currentSpaceStore),[]),g=(0,c.VK)((()=>(0,Re.lN)()),[]),f=(0,c.VK)((()=>(0,we._c)(r)),[r]),y=(0,s.useCallback)((()=>{a.clearAssistantStores()}),[]),h=(0,s.useCallback)((()=>{var e;const t=(null===(e=ve.XN.state)||void 0===e?void 0:e.evaluator.getTranscript())??[];navigator.clipboard.writeText(JSON.stringify(t,null,2))}),[]),S=(0,s.useCallback)((()=>{Ee.navigateToExternalURL({environment:r,url:"https://notion.notion.site/Notion-Q-A-Welcome-Guide-50275eee027a44e8bc69f521cee8e86b"})}),[r]),b=(0,c.VK)((()=>(0,Le.dv)()),[]),C=void 0===(null==i?void 0:i.isQnA)?!g:!(null!=i&&i.isQnA),w=(0,u.yK)((e=>({wrap:{display:"flex",flexDirection:"column",flex:"1 1 0%",background:e.contentBackground,marginRight:f?2:0,pointerEvents:"auto",marginTop:1,height:0},header:{display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`,alignItems:"center",pointerEvents:"auto",padding:12},headerLabel:{fontSize:14,color:e.aiPurpleColor,fontWeight:L.Z.fontWeight.medium,display:"flex",alignItems:"center"},labeledInput:{display:"flex",gap:8,alignItems:"center"},headerSparkles:{width:16,height:16,marginRight:4,color:e.aiPurpleColor},reset:{color:e.mediumTextColor},toggleSlackMode:{color:e.mediumTextColor},input:{width:void 0,marginLeft:8,marginRight:8},scroller:{flexGrow:1,paddingTop:8,paddingBottom:8,paddingLeft:8,paddingRight:8,backgroundColor:e.contentBackground},samplesLabel:{fontSize:12,marginTop:8,marginBottom:8},inputLabel:{fontSize:14,color:e.mediumTextColor},previewLabel:{fontSize:12},editLink:{fontSize:14,color:e.mediumTextColor,textDecoration:"underline",paddingLeft:8,paddingRight:8},error:{fontSize:14,color:e.errorText},addCustomInstructionsIcon:{fill:e.aiPurpleColor},suggestionsLabel:{fontSize:12,color:e.mediumTextColor,marginTop:18,marginBottom:12},betaBadge:{marginLeft:8,fontSize:12,fontWeight:500,padding:"2px 4px",backgroundColor:e.accentColors.purple[50],color:e.aiPurpleColor,borderRadius:4}})),[f]),x=(0,c.VK)((()=>{var e;const t=null===(e=ve.XN.state)||void 0===e?void 0:e.previewingStepObservations.filter((e=>"observation"===e.type&&"error"===e.observationType));return null==t?void 0:t.map((e=>e.value)).join("\n")}),[]),I=(0,c.VK)((()=>(0,Re.Gw)()),[]),A=k.default.isLocalhost||!1,T=(0,c.VK)((()=>ve.Pl.state),[]),Z=Boolean(T),E=(0,s.useCallback)((()=>{a.clearAssistantStores(),Z?ve.Pl.setState(void 0):ve.Pl.setState({enabled:!0,selectedFakeUser:void 0,selectedFakeChannel:"#"})}),[Z]),[F,M]=(0,s.useState)("#"),[V,_]=(0,s.useState)([]),[z,D]=(0,s.useState)(void 0);(0,s.useEffect)((()=>{Z&&Fe.Yu({environment:r,query:"",membersOnly:!1}).then((e=>_(e))).catch((e=>{throw new Error(e)}))}),[r,Z]);const O=(0,s.useCallback)((async e=>{!Z||z?(ve.XN.state||await a.resetAssistantStore({environment:r,isLabelerSlackMode:Z,fakeSlackChannel:F,clientSkill:g?Oe.lU:void 0}),ve.XN.state&&e&&a.commitHumanStep({environment:r,text:e,fakeUser:z})):Ze.showErrorMessage("Please select a user to send the message as")}),[r,Z,z,F,g]),{store:N}=(0,ze.useMockTextStore)({initialValue:void 0,onChange:K.yR});(0,s.useEffect)((()=>{R.ZH({device:r.device}),oe.N_({store:N}),null!=n&&n.primeTextInput&&(B.createAndCommit({userAction:"assistant.primeTextFromSearch",environment:r,perform:e=>{Me.sO({environment:r,store:N,value:v.TPx(n.primeTextInput),transaction:e})}}),a.clearPrimedText())}),[r,N,null==n?void 0:n.primeTextInput]),(0,s.useEffect)((()=>{t.current&&t.current.scrollToBottom(),R.ZH({device:r.device}),oe.N_({store:N})}),[null==n?void 0:n.clientSteps,N,r.device]);const W=(0,s.useCallback)((()=>{B.createAndCommit({userAction:"assistant.createInstructionsPage",environment:r,perform:e=>{a.createInstructionsPage({environment:r,transaction:e})}})}),[r]),U=(0,s.useCallback)((e=>!g||("human"===e.type||"assistantChat"===e.type||"assistantChatText"===e.type)),[g]);return m&&p?l()("div",{style:w.wrap},void 0,l()(Pe.Z,{},void 0,l()("div",{style:w.header},void 0,(0,he.t)(w.headerSparkles),l()("div",{style:w.headerLabel},void 0,"Ask Notion AI"),l()("div",{style:w.betaBadge},void 0,"Beta"),l()("div",{style:{flexGrow:1}}),l()(_e.Z,{style:w.reset,onClick:S},void 0,(0,Te.m)({height:16,width:16})),(I||A)&&l()(_e.Z,{style:w.reset,onClick:h},void 0,(0,Ae.U)({height:16,width:16})),I&&l()(_e.Z,{style:w.toggleSlackMode,onClick:E},void 0,Z?"Disable Slack mode":"Enable Slack mode"),l()(_e.Z,{style:w.reset,onClick:y},void 0,"Clear")),Z&&l()("div",{style:{...w.header,flexDirection:"column",gap:6}},void 0,l()("div",{style:w.labeledInput},void 0,l()("div",{style:w.inputLabel},void 0,"Channel"),l()(Ve.b,{value:F,onChange:e=>{M(e)},disabled:Boolean(n),placeholder:"Channel name",style:w.input})),l()("div",{style:w.labeledInput},void 0,l()("div",{style:w.inputLabel},void 0,"User"),l()(me.Z,{items:V,selectedItem:z,getKey:e=>e.name||e.id,renderItem:e=>s.createElement(re.Z,o()({},e,{title:e.key})),onSelect:e=>D(e),renderOrigin:e=>s.createElement(le.Z,o()({focused:!1,title:z?z.name:"Select a user"},e))})))),s.createElement(Ke.Z,{ref:t,type:De.Z.Y,style:w.scroller},b&&C?s.createElement(yt,b):null,n||g?null:l()(ee,{clientStep:{type:"assistantChatText",text:"Hi! I'm your AI assistant. I can answer questions by searching the workspace, edit pages, and query and manipulate databases."},parentStore:m,parentSpaceId:m.id,configurationState:i}),!b&&!n&&!g&&s.createElement(s.Fragment,null,l()("div",{style:w.suggestionsLabel},void 0,l()(P.FormattedMessage,{defaultMessage:"Things you can do",id:"assistant.suggestionsLabel"})),l()(We,{icon:Be.R,iconStyle:w.addCustomInstructionsIcon,title:l()(P.FormattedMessage,{defaultMessage:"Add custom AI instructions for this page",id:"assistant.addCustomInstructions"}),onClick:W})),g?s.createElement(s.Fragment,null,l()(ee,{clientStep:{type:"assistantChatText",text:"Hi! I'm Notion AI. I can search through your Notion workspace and answer questions based on what I find."},parentStore:m,parentSpaceId:m.id,configurationState:i})):null,null==n||null===(e=n.clientSteps)||void 0===e?void 0:e.filter(U).map(((e,t)=>l()(ee,{clientStep:e,parentStore:m,parentSpaceId:m.id,fakeSlackUser:"human"===e.type?e.fakeUser:void 0,configurationState:i},t))),null==n?void 0:n.temporaryClientSteps.filter(U).map(((e,t)=>l()(ee,{clientStep:e,parentStore:m,parentSpaceId:m.id,configurationState:i},t))),i&&x&&!i.sampling&&!i.evaluating&&(g?l()(ee,{clientStep:{type:"assistantFriendlyError"},parentStore:m,parentSpaceId:m.id,configurationState:i}):l()("div",{style:w.error},void 0,x)),!I&&n&&i&&(n.temporaryClientSteps.length>0||x)&&!i.sampling&&!i.evaluating&&l()(pt,{type:x?g?"retry_only":"error":Boolean(n.temporaryClientSteps.find((e=>"assistantTransaction"===e.type)))?"accept_action":"feedback"}),n&&i&&(i.sampling||i.evaluating)&&!n.temporaryClientSteps.find((e=>"assistantChat"===e.type||"assistantTransaction"===e.type))&&l()(ee,{clientStep:{type:"assistantLoading"},parentStore:m,parentSpaceId:m.id,configurationState:i})),l()(Pe.Z,{},void 0,l()(gt,{store:N,placeholder:g?"Ask a question":"Ask a question or ask to update this pageâ€¦",onSubmit:O}))):null}var kt=n(41892),St=n(20669),bt=n(55031),Ct=n(23910),wt=n(31523),xt=n(33932);function It(e){window.__c={n:"AssistantOriginElement"};const t=(0,d.O7)(),n=(0,u.Fg)(),i=(0,c.VK)((()=>(0,Re.lN)()),[]),o=(0,u.yK)((e=>({faceImg:{width:i?25:42,fill:e.mediumIconColor,pointerEvents:"none"}})),[i]),r=(0,s.useCallback)((async()=>{xt.O({view:"chat"}),Q.N.state||await a.resetAssistantStore({environment:t,primeTextInput:void 0,clientSkill:Oe.lU}),f.IR(t,{configurationState:Q.N.state,hasQuery:!1,from:"button",searchSessionId:void 0})}),[t]),p=(0,c.VK)((()=>(0,bt.y)(t,{theme:n,rightEdgeDistance:16,isInPeekRenderer:!1,width:48})),[t,n]),m=(0,s.useMemo)((()=>(0,St.y)({...o.faceImg})),[o.faceImg]);return l()(Ct.N,{},void 0,l()(wt.P,{},void 0,l()(Ne.Z,{ariaLabel:"ai",className:"notion-ai-button",style:p,onClick:r},void 0,i?m:l()("img",{style:o.faceImg,src:kt.Z.images.aiFaceLookleftPng}))))}var At=n(31945),Tt=n(4023),Bt=n(4926),Zt=n(56206),Et=n(37652),Ft=n(13148),Mt=n(77907),Vt=n(70771),_t=n(5175);function Kt(e){window.__c={n:"AssistantChat"};const{store:t}=e,n=(0,s.useRef)(void 0),i=(0,c.VK)((()=>t.state),[t]),o=(0,c.VK)((()=>Q.N.state),[]),r=(0,d.O7)(),p=(0,c.VK)((()=>(0,Oe.Qv)()),[]),m=(0,c.VK)((()=>G.default.state.mainEditorCurrentBlockStore),[]),g=(0,c.VK)((()=>{var e;const t=null==m||null===(e=m.getFormat())||void 0===e?void 0:e.app_config_uri;return Re.fG.canViewMoreSkills(t)}),[m]),f=(0,c.VK)((()=>G.default.state.currentSpaceStore),[]),y=(0,c.VK)((()=>{var e;return null===(e=t.state)||void 0===e?void 0:e.selectedSkill}),[t]),h=(0,c.VK)((()=>(0,Re.lN)()),[]),k="qna"===(null==y?void 0:y.skillType),S=(0,u.yK)((e=>({wrap:{display:"flex",flexDirection:"column",background:e.contentBackground,width:400,height:"max(40vh, 600px)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto",paddingTop:8,paddingLeft:12,paddingRight:12},labeledInput:{display:"flex",gap:8,alignItems:"center"},reset:{color:e.mediumIconColor},toggleSlackMode:{color:e.mediumIconColor},closeButton:{borderRadius:"100%",marginLeft:4},input:{width:void 0,marginLeft:8,marginRight:8},scroller:{flexGrow:1,paddingTop:8,paddingBottom:8,paddingLeft:8,paddingRight:8,backgroundColor:e.contentBackground},samplesLabel:{fontSize:12,marginTop:8,marginBottom:8},inputLabel:{fontSize:14,color:e.mediumTextColor},previewLabel:{fontSize:12},editLink:{fontSize:14,color:e.mediumTextColor,textDecoration:"underline",paddingLeft:8,paddingRight:8},error:{fontSize:14,color:e.errorText},addCustomInstructionsIcon:{fill:e.aiPurpleColor},suggestionsLabel:{fontSize:12,color:e.mediumTextColor,marginTop:18,marginBottom:12},emptyStateIntro:{marginLeft:18,marginRight:18},faceImgWrap:{width:64,height:64,borderRadius:"100%",background:"white",boxShadow:e.largeLightBoxShadow,overflow:"hidden"},faceImg:{width:64,pointerEvents:"none"},emptyStateText:{marginTop:28,fontSize:16,color:e.regularTextColor,fontFamily:L.Z.baseFontFamily.serif},inputWrap:{paddingTop:8,paddingBottom:8},skillsCaption:{fontSize:12,color:e.mediumTextColor,marginBottom:8},skillIcon:{fill:e.aiPurpleColor},skillsWrap:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:8}})),[]),b=(0,c.VK)((()=>{var e;const n=null===(e=t.state)||void 0===e?void 0:e.previewingStepObservations.filter((e=>"observation"===e.type&&"error"===e.observationType));return null==n?void 0:n.map((e=>e.value)).join("\n")}),[t]),C=(0,c.VK)((()=>(0,Re.Gw)()),[]),w=(0,c.VK)((()=>ve.Pl.state),[]),x=Boolean(w),I=(0,s.useCallback)((()=>{(0,xt.O)({view:"skillSwitcher"})}),[]),A=(0,s.useCallback)((async e=>{!x||null!=w&&w.selectedFakeUser?(i||await a.resetAssistantStore({environment:r,isLabelerSlackMode:x,fakeSlackChannel:null==w?void 0:w.selectedFakeChannel,clientSkill:h?Oe.lU:y}),e&&a.commitHumanStep({environment:r,text:e,fakeUser:null==w?void 0:w.selectedFakeUser})):Ze.showErrorMessage("Please select a user to send the message as")}),[x,null==w?void 0:w.selectedFakeUser,null==w?void 0:w.selectedFakeChannel,i,r,h,y]),T=(0,s.useCallback)((async e=>{await(0,Vt.OZ)({environment:r,clientSkill:e})}),[r]),Z=(0,s.useCallback)((e=>!k||("human"===e.type||"assistantChat"===e.type||"assistantChatText"===e.type||"assistantShowSearchResults"===e.type)),[k]),{store:E}=(0,ze.useMockTextStore)({initialValue:void 0,onChange:K.yR});(0,s.useEffect)((()=>{R.ZH({device:r.device}),oe.N_({store:E}),null!=i&&i.primeTextInput&&(B.createAndCommit({userAction:"assistant.primeTextFromSearch",environment:r,perform:e=>{Me.sO({environment:r,store:E,value:v.TPx(i.primeTextInput),transaction:e})}}),a.clearPrimedText())}),[r,E,null==i?void 0:i.primeTextInput]),(0,s.useEffect)((()=>{n.current&&n.current.scrollToBottom(),R.ZH({device:r.device}),oe.N_({store:E})}),[null==i?void 0:i.clientSteps,E,r.device]);const F=(null==o?void 0:o.evaluating)||(null==o?void 0:o.sampling)||(null==o?void 0:o.committing);return f&&m?s.createElement(s.Fragment,null,s.createElement(Ke.Z,{ref:n,type:De.Z.Y,style:S.scroller},!i&&!h&&l()("div",{style:S.emptyStateIntro},void 0,l()("div",{style:S.faceImgWrap},void 0,l()("img",{style:S.faceImg,src:kt.Z.images.aiFaceLookleftPng})),l()("div",{style:S.emptyStateText},void 0,l()("p",{},void 0,"Hi! I'm Notion AI."),l()("p",{},void 0,"I can answer questions about this workspace, help you analyze and edit pages, and search and manipulate databases.")),p.length>0&&s.createElement(s.Fragment,null,l()("div",{style:S.skillsCaption},void 0,"Things to try"),l()("div",{style:S.skillsWrap},void 0,p.filter((e=>e.inAppSkillTrigger)).slice(0,6).map((e=>l()(We,{icon:Oe.AN[e.skillType],iconStyle:S.skillIcon,onClick:async()=>{await T(e)},title:l()(_t.Z,{clientSkill:e})},e.key))),g&&l()(We,{onClick:I,title:"More"})))),h?s.createElement(s.Fragment,null,l()(ee,{clientStep:{type:"assistantChatText",text:"Hi! I'm Notion AI. I can search through your Notion workspace and answer questions based on what I find."},parentStore:f,parentSpaceId:f.id,configurationState:o})):null,null!=i&&i.clientSteps?i.clientSteps.filter(Z).map(((e,t)=>l()(ee,{clientStep:e,parentStore:f,parentSpaceId:f.id,fakeSlackUser:"human"===e.type?e.fakeUser:void 0,configurationState:o},t))):null,null!=i&&i.temporaryClientSteps?i.temporaryClientSteps.filter(Z).map(((e,t)=>l()(ee,{clientStep:e,parentStore:f,parentSpaceId:f.id,configurationState:o},t))):null,o&&b&&!o.sampling&&!o.evaluating&&(k?l()(ee,{clientStep:{type:"assistantFriendlyError"},parentStore:f,parentSpaceId:f.id,configurationState:o}):l()("div",{style:S.error},void 0,b)),!C&&i&&o&&(i.temporaryClientSteps.length>0||b)&&!o.sampling&&!o.evaluating&&l()(pt,{type:b?k?"retry_only":"error":Boolean(i.temporaryClientSteps.find((e=>"assistantTransaction"===e.type)))?"accept_action":"feedback"}),i&&o&&(o.sampling||o.evaluating)&&!i.temporaryClientSteps.find((e=>"assistantChat"===e.type||"assistantTransaction"===e.type))&&l()(ee,{clientStep:{type:"assistantLoading"},parentStore:f,parentSpaceId:f.id,configurationState:o})),l()("div",{style:S.inputWrap},void 0,l()(gt,{store:E,placeholder:k?"Ask a questionâ€¦":"Ask for anythingâ€¦",onSubmit:A,disabled:F}))):null}var Pt=n(85264),Lt=n(18442),Rt=n(32163),zt=n(98165),Dt=n(61766);function Ot(e){window.__c={n:"AssistantSkillSwitcher"};const t=(0,d.O7)(),n=(0,u.yK)((e=>({skillIcon:{width:16,fill:e.aiPurpleColor,marginRight:4},headerWrap:{display:"flex",alignItems:"center",margin:"0 4px"},editPopupWrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow,width:392},skillMenuItemWrap:{display:"flex",alignItems:"center",margin:"8px 8px"},settingsButton:{marginLeft:8}})),[]),[a,i]=s.useState([]),r=s.useCallback((()=>{i((0,Oe.Qv)())}),[]);s.useEffect((()=>{r()}),[r]);const[p,m]=s.useState(void 0),v=(0,c.qz)(void 0,Dt.Z),g=p?a.find((e=>"persisted"===e.type&&e.skillStore.id===p.id)):void 0,f=(0,s.useCallback)((()=>{const{performResult:e}=B.createAndCommit({userAction:"AssistantSkillSwitcher.handleAddCustomSkillClick",environment:t,perform:e=>(0,Vt.Fv)({environment:t,transaction:e})});m(e),v.setState({...v.state,open:!0}),r()}),[t,v,r]),y=(0,s.useCallback)((()=>{const{performResult:e}=B.createAndCommit({userAction:"AssistantSkillSwitcher.handleWikiAddToSlackClick",environment:t,perform:e=>(0,Vt.y5)({environment:t,transaction:e})});m(e),v.setState({...v.state,open:!0})}),[t,v]),h=(0,s.useCallback)((()=>{const{performResult:e}=B.createAndCommit({userAction:"AssistantSkillSwitcher.handleWikiAddToSlackClick",environment:t,perform:e=>(0,Vt.oY)({environment:t,transaction:e})});m(e),v.setState({...v.state,open:!0})}),[t,v]),k=(0,c.VK)((()=>{var e;const{mainEditorCurrentBlockStore:t}=G.default.state;return null==t||null===(e=t.getFormat())||void 0===e?void 0:e.app_config_uri}),[]),S=(0,c.VK)((()=>{const{mainEditorCurrentBlockStore:e}=G.default.state;if(!e)return[];return(0,zt.uJ)(e).map((e=>e.id))}),[]),b=(0,c.VK)((()=>Re.fG.allowWikiSkillCreation(k)),[k]),C=(0,c.VK)((()=>Re.fG.allowTaskSkillCreation(k)),[k]),w=(0,c.VK)((()=>Re.fG.allowCustomSkillCreation()),[]),x=(0,c.VK)((()=>{const e=a.filter((e=>"persisted"===e.type&&Boolean(e.inAppSkillTrigger)&&S.includes(e.skillStore.getParentId()))),t=a.filter((e=>"persisted"===e.type&&!e.inAppSkillTrigger&&Boolean(e.slackSkillTriggers)&&S.includes(e.skillStore.getParentId()))),n=a.filter((n=>Boolean(n.inAppSkillTrigger)&&!e.includes(n)&&!t.includes(n)));return{slackSkills:t,pageSkills:e,workspaceSkills:n}}),[S,a]),I=x.pageSkills.map((e=>Nt({environment:t,clientSkill:e,styles:n,onDelete:r}))),A=x.workspaceSkills.map((e=>Nt({environment:t,clientSkill:e,styles:n,onDelete:r}))),T=K.oA([...x.slackSkills.map((e=>Nt({environment:t,clientSkill:e,styles:n,onDelete:r}))),b&&{key:"wiki_slack",render:e=>s.createElement("div",{key:e.key,style:n.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref},l()(We,{iconStyle:n.skillIcon,title:"Add to Slack",icon:Oe.AN.wiki_slack,focused:e.focused,onClick:e.onClick})),action:y},C&&{key:"tasks",render:e=>s.createElement("div",{key:e.key,style:n.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref},l()(We,{iconStyle:n.skillIcon,title:"Add to Slack",icon:Oe.AN.tasks_slack,focused:e.focused,onClick:e.onClick})),action:h}]);return s.createElement(s.Fragment,null,l()(Pe.Z,{},void 0,l()("div",{style:n.headerWrap},void 0,l()("div",{style:{flexGrow:1}}),w&&l()(Pt.Z,{clientSkill:g,renderOrigin:()=>l()(_e.Z,{onClick:f,isBlue:!0},void 0,"New skill"),buttonPopupStore:v,onDelete:r})),l()(Rt.Z,{type:Rt.i.Vertical,initialFocus:0,sections:K.oA([I.length>0&&{key:"page",render:e=>s.createElement(Pe.Z,o()({topBorder:!1,disableMobileBorders:!0,title:"From this page"},e)),items:I},T.length>0&&{key:"slack",render:e=>s.createElement(Pe.Z,o()({topBorder:!1,disableMobileBorders:!0,title:"From Slack"},e)),items:T},A.length>0&&{key:"workspace",render:e=>s.createElement(Pe.Z,o()({topBorder:!1,disableMobileBorders:!0,title:"Other skills"},e)),items:A}])})))}function Nt(e){const{environment:t,clientSkill:n,styles:a,onDelete:i}=e;return{key:n.key,render:e=>"persisted"===n.type?l()(Pt.Z,{clientSkill:n,onDelete:i,renderOrigin:t=>s.createElement("div",{key:e.key,style:a.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref},l()(We,{iconStyle:a.skillIcon,title:l()(_t.Z,{clientSkill:n}),icon:Oe.AN[n.skillType],onClick:e.onClick,focused:e.focused}),"persisted"===n.type&&e.focused&&s.createElement(Se.Z,o()({icon:Lt.H,ariaLabel:"edit",style:a.settingsButton},t)))}):s.createElement("div",{key:e.key,style:a.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref},l()(We,{iconStyle:a.skillIcon,title:l()(_t.Z,{clientSkill:n}),icon:Oe.AN[n.skillType],focused:e.focused,onClick:e.onClick})),action:async()=>{await(0,Vt.OZ)({environment:t,clientSkill:n})}}}var Wt=n(42853);function Ut(e){window.__c={n:"AssistantSkillSwitcherButton"};const{store:t}=e,n=(0,c.VK)((()=>t.state),[t]),a=(0,u.yK)((e=>({skillIcon:{fill:e.aiPurpleColor},chevronDown:{fill:e.mediumIconColor,width:12,marginLeft:4}})),[]),i=(0,s.useCallback)((()=>{(0,xt.O)({view:"skillSwitcher"})}),[]);if(null==n||!n.selectedSkill)return null;const{selectedSkill:o}=n;return l()(_e.Z,{onClick:i,icon:Oe.AN[o.skillType],iconStyle:a.skillIcon},void 0,l()(_t.Z,{clientSkill:o}),(0,Wt.i)(a.chevronDown))}function qt(e){var t,n,i,r;window.__c={n:"AssistantMenu"};const{store:p,configurationStore:m,onClose:v}=e,g=(0,c.VK)((()=>p.state),[p]),y=(0,c.VK)((()=>m.state),[m]),h=(0,c.VK)((()=>(0,Re.lN)()),[]),S="qna"===(null==g||null===(t=g.selectedSkill)||void 0===t?void 0:t.skillType),b=(0,d.O7)(),C=(0,s.useCallback)((()=>{var e;"qna"===(null==g||null===(e=g.selectedSkill)||void 0===e?void 0:e.skillType)&&f.Le6(b,y),a.clearAssistantStores()}),[y,null==g||null===(n=g.selectedSkill)||void 0===n?void 0:n.skillType,b]),w=(0,s.useCallback)((()=>{var e;const t=(null===(e=p.state)||void 0===e?void 0:e.evaluator.getTranscript())??[];navigator.clipboard.writeText(JSON.stringify(t,null,2))}),[p]),x=(null==y?void 0:y.committing)||(null==y?void 0:y.evaluating)||(null==y?void 0:y.sampling),I=(0,u.yK)((e=>({wrap:{display:"flex",flexDirection:"column",background:e.contentBackground,width:400,height:"max(40vh, 600px)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto",paddingTop:8,paddingLeft:12,paddingRight:12},labeledInput:{display:"flex",gap:8,alignItems:"center"},clearButton:{color:x?e.lightTextColor:e.mediumIconColor,opacity:x?.5:1},headerButton:{color:e.mediumIconColor},closeButton:{borderRadius:"100%",marginLeft:6},input:{width:void 0,marginLeft:8,marginRight:8},inputLabel:{fontSize:14,color:e.mediumTextColor},faceImgWrap:{width:64,height:64,borderRadius:"100%",background:"white",boxShadow:e.largeLightBoxShadow,overflow:"hidden"},faceImg:{width:64,pointerEvents:"none"},emptyStateText:{marginTop:28,fontSize:16,color:e.regularTextColor,fontFamily:L.Z.baseFontFamily.serif},inputWrap:{paddingTop:8,paddingBottom:8},skillsCaption:{fontSize:12,color:e.mediumTextColor,marginBottom:8},skillIcon:{fill:e.aiPurpleColor},skillsWrap:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:8},headerSparkles:{width:16,height:16,marginRight:4,color:e.aiPurpleColor},headerLabel:{fontSize:14,color:e.aiPurpleColor,fontWeight:L.Z.fontWeight.medium,display:"flex",alignItems:"center"},betaBadge:{marginLeft:8,fontSize:12,fontWeight:500,padding:"2px 4px",backgroundColor:e.accentColors.purple[50],color:e.aiPurpleColor,borderRadius:4}})),[x]),A=(0,c.VK)((()=>{var e;return null===(e=G.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);(0,ae.r5)((async()=>{A&&await(0,Vt.K7)({environment:b,spaceId:A})}),[b,A]);const T=(0,c.VK)((()=>(0,Re.Gw)()),[]),B=(0,c.VK)((()=>!0===Zt.d.state.open?Zt.d.state.currentView:void 0),[]),Z=k.default.isLocalhost||!1,E=(0,c.VK)((()=>ve.Pl.state),[]),F=Boolean(E),M=(0,s.useCallback)((()=>{(0,xt.O)({view:"chat"})}),[]),V=(0,s.useCallback)((()=>{var e;v(),"qna"===(null==g||null===(e=g.selectedSkill)||void 0===e?void 0:e.skillType)&&f.Ti_(b,y)}),[y,null==g||null===(i=g.selectedSkill)||void 0===i?void 0:i.skillType,b,v]),_=(0,s.useCallback)((()=>{a.clearAssistantStores(),F?ve.Pl.setState(void 0):ve.Pl.setState({enabled:!0,selectedFakeUser:void 0,selectedFakeChannel:"#"})}),[F]),[K,P]=(0,s.useState)([]);return(0,s.useEffect)((()=>{F&&Fe.Yu({environment:b,query:"",membersOnly:!1}).then((e=>P(e))).catch((e=>{throw new Error(e)}))}),[b,F]),l()("div",{style:I.wrap},void 0,l()(Pe.Z,{},void 0,l()("div",{style:I.header},void 0,"chat"===B&&s.createElement(s.Fragment,null,g&&!h&&l()(Ut,{store:p}),"persisted"===(null==g||null===(r=g.selectedSkill)||void 0===r?void 0:r.type)&&l()(Pt.Z,{clientSkill:g.selectedSkill,renderOrigin:e=>s.createElement(_e.Z,o()({},e,{style:I.headerButton}),"Edit")}),h&&s.createElement(s.Fragment,null,(0,he.t)(I.headerSparkles),l()("div",{style:I.headerLabel},void 0,"Ask Notion AI"),l()("div",{style:I.betaBadge},void 0,"Beta")),l()("div",{style:{flexGrow:1}}),T&&l()(_e.Z,{style:I.headerButton,onClick:_},void 0,F?"Disable Slack mode":"Enable Slack mode"),g&&l()(_e.Z,{style:I.clearButton,onClick:C,disabled:x},void 0,"Clear"),(T||Z)&&g&&l()(Se.Z,{icon:Ae.U,onClick:w,ariaLabel:"copy"})),"skillSwitcher"===B&&s.createElement(s.Fragment,null,l()(Se.Z,{icon:Et.V,onClick:M,ariaLabel:"back"}),l()("div",{style:{marginLeft:4,fontSize:14}},void 0,"All skills"),l()("div",{style:{flexGrow:1}})),"chat"===B&&(!g||S)&&l()(At.ZP,{popupType:b.device.isMobile?At.Z4.SlideUp:At.Z4.Popup,renderOrigin:e=>s.createElement(Se.Z,o()({icon:Te.m,ariaLabel:"help"},e)),render:()=>l()(Mt.LazyHelpButtonContent,{shouldRenderAsStaticModal:!1})}),l()(Se.Z,{style:I.closeButton,hovered:!0,icon:Ft.U,onClick:V,ariaLabel:"close"})),F&&l()("div",{style:{...I.header,flexDirection:"column",gap:6}},void 0,l()("div",{style:I.labeledInput},void 0,l()("div",{style:I.inputLabel},void 0,"Channel"),l()(Ve.b,{value:(null==E?void 0:E.selectedFakeChannel)||"",onChange:e=>{if(!E)throw new Error("slackModeState is undefined");ve.Pl.setState({...E,selectedFakeChannel:e})},disabled:Boolean(g),placeholder:"Channel name",style:I.input})),l()("div",{style:I.labeledInput},void 0,l()("div",{style:I.inputLabel},void 0,"User"),l()(me.Z,{items:K,selectedItem:null==E?void 0:E.selectedFakeUser,getKey:e=>e.name||e.id,renderItem:e=>s.createElement(re.Z,o()({},e,{title:e.key})),onSelect:e=>{if(!E)throw new Error("slackModeState is undefined");ve.Pl.setState({...E,selectedFakeUser:e})},renderOrigin:e=>s.createElement(le.Z,o()({focused:!1,title:null!=E&&E.selectedFakeUser?null==E?void 0:E.selectedFakeUser.name:"Select a user"},e))})))),"chat"===B&&l()(Kt,{store:p}),"skillSwitcher"===B&&l()(Ot,{}))}function Ht(){window.__c={n:"AssistantMenuPopup"};const e=(0,c.VK)((()=>Zt.d.state.open),[]),[t,n]=(0,s.useState)(),a=(0,d.O7)(),i=(0,c.VK)((()=>{const e=(0,we.ll)(a,!1)-(0,we.vJ)(a);return{bottom:15+Bt.Z.state,right:15+Bt.Z.state,xPosition:e}}),[a]);(0,s.useEffect)((()=>{const e=()=>{n(new DOMRect(window.innerWidth-i.right-i.xPosition,window.innerHeight-i.bottom,0,0))};return e(),addEventListener("resize",e),()=>removeEventListener("resize",e)}),[i.right,i.xPosition,i.bottom]);const o=(0,u.yK)((e=>({wrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow}})),[]);return l()(pe.ZP,{popupType:a.device.isMobile?At.Z4.SlideUp:At.Z4.Popup,alignmentToOrigin:Tt.v.End,alignBoxStyle:{transition:"left 200ms, top 200ms"},originRect:t,disableMouseCapture:!0,preventScaleTransition:!0,popupWrapStyle:o.wrap,open:e,render:()=>l()(qt,{store:ve.XN,configurationStore:Q.N,onClose:()=>xt.W()})})}},92660:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(23174),i=n.n(a),o=(n(67294),n(83355)),r=n(50506),l=n(53437);class s extends o.Z{renderComponent(){const{render:e}=this.props,{device:t}=this.environment,n=this.props.modalStore.state;return t.isMobile?i()(l.ZP,{ariaLabel:this.props.ariaLabel,open:n.open,popupType:l.ZP.PopupType.SlideUp,origin:this.props.origin,onDismiss:this.props.onDismiss,render:e,style:this.props.style}):i()(r.Z,{ariaLabel:this.props.ariaLabel,open:n.open,preventHideChildrenWhileOpening:!0,render:e,onDismiss:this.props.onDismiss,style:this.props.style,innerStyle:this.props.innerStyle})}}s.displayName="DefaultPopupOrModal"},90706:(e,t,n)=>{n.d(t,{Z:()=>x});var a=n(23174),i=n.n(a),o=(n(57658),n(67294)),r=n(86628),l=n(24405),s=n(80951),d=n(14215),c=(n(30541),n(21703),n(67266)),u=n.n(c),p=n(5242),m=n.n(p),v=n(15095),g=n(72126),f=n(70203),y=n(97880);let h=function(e){return e[e.removed=-1]="removed",e[e.added=1]="added",e[e.same=0]="same",e}({});function k(e){const{before:t,after:n}=e,a={count:0,encoding:{},decoding:{},annotationEncoding:{},annotationDecoding:{}},i=e=>{const t=a.encoding[e];if(t)return t;{const t=String.fromCharCode(a.count);return a.count++,a.encoding[e]=t,a.decoding[t]=e,t}},o=e=>{const t=u()(e),n=a.annotationEncoding[t];if(n)return n;{const n=String.fromCharCode(a.count);return a.count++,a.annotationEncoding[t]=n,a.annotationDecoding[n]=e,n}},r=e=>g.xH(f.lzi(e).map((e=>{const t=v.p4(e[0]).map(i);if(f.km_(e)){const n=f.hDy(e),a=f.I$B(n);a&&(t[0]=o({type:"mention",value:a}),n.forEach((e=>{f.ZAl(e)||f.kuv(e)||f.QVC(e)||(t.unshift(o({type:"start",value:e})),t.push(o({type:"end",value:e})))})))}else if(f.YrK(e)){const n=f.hDy(e),a=f.Ap(n);if(a){t[0]=o({type:"equation",value:a});for(const e of n)f.ZAl(e)||f.kuv(e)||f.QVC(e)||(t.unshift(o({type:"start",value:e})),t.push(o({type:"end",value:e})))}}else if(f.AJd(e)){f.hDy(e).forEach((e=>{t.unshift(o({type:"start",value:e})),t.push(o({type:"end",value:e}))}))}return t}))).join("");if(a.count>65535)throw new Error("This string has way too many different characters.");const l=function(e,t){const n=new(m())({timeout:2,editCost:6}),a=n.main(t,e);return n.cleanupSemantic(a),a}(r(n),r(t)),s=[];let d=[];return l.forEach((e=>{let[t,n]=e;n.split("").forEach((e=>{if(a.decoding[e]){const n=a.decoding[e];t===h.added?s.push([n,[...d,["+"]]]):t===h.removed?s.push([n,[...d,["-"]]]):t===h.same&&s.push([n,d])}else{const n=a.annotationDecoding[e];if(t===h.added)if("mention"===n.type)s.push([f.qyI,[...d,["+"],n.value]]);else if("start"===n.type)d=[...d,n.value];else if("end"===n.type)d=d.filter((e=>!g.Xy(e,n.value)));else if("equation"===n.type){const e=f.xey(n.value),t=f.qZ6(e,[...d,["+"]]);s.push(t)}else(0,y.t1)(n);else if(t===h.removed){if("mention"===n.type)s.push([f.qyI,[...d,["-"],n.value]]);else if("equation"===n.type){const e=f.xey(n.value),t=f.qZ6(e,[...d,["-"]]);s.push(t)}}else if(t===h.same)if("mention"===n.type)s.push([f.qyI,[...d,n.value]]);else if("start"===n.type)d=[...d,n.value];else if("end"===n.type)d=d.filter((e=>!g.Xy(e,n.value)));else if("equation"===n.type){const e=f.xey(n.value),t=f.qZ6(e,d);s.push(t)}else(0,y.t1)(n)}}))})),f.Zxt(s)}const S=(0,n(45238).I)("arrowRightSmaller",{viewBox:"0 0 16 16",svg:i()("path",{d:"M15.383 8.352a.877.877 0 01-.274.64l-5.156 5.14a.864.864 0 01-.617.266.831.831 0 01-.602-.234.795.795 0 01-.234-.586c0-.12.02-.232.063-.336a.912.912 0 01.187-.273l1.75-1.766 2.914-2.656.274.5-2.711.156H1.484c-.26 0-.471-.078-.632-.234a.851.851 0 01-.235-.617c0-.256.078-.461.235-.618a.856.856 0 01.632-.242h9.493l2.71.164-.273.508L10.5 5.5 8.75 3.727a.946.946 0 01-.188-.266.917.917 0 01-.062-.344c0-.234.078-.43.234-.586a.831.831 0 01.602-.234.79.79 0 01.328.07c.104.047.203.117.297.211l5.148 5.133a.877.877 0 01.274.64z"})});var b=n(21202),C=n(57559),w=n(14200);function x(e){const t=e.propertySchema.type;switch(t){case"title":case"text":return o.createElement(I,e);case"relation":return i()(A,{propertySchema:e.propertySchema,beforeValue:e.beforeValue,afterValue:e.afterValue,rootStore:e.rootStore});case"checkbox":case"number":case"person":case"file":case"url":case"email":case"phone_number":case"created_time":case"created_by":case"last_edited_time":case"last_edited_by":case"last_visited_time":case"formula":case"rollup":case"select":case"multi_select":case"date":case"button":case"status":case"auto_increment_id":case"location":case"verification":return o.createElement(T,e);default:(0,y.t1)(t)}}function I(e){const t={value:k({before:e.beforeValue.value,after:e.afterValue.value}),spaceId:e.beforeValue.spaceId};return i()(w.Z,{value:t,propertySchema:e.propertySchema,rootStore:e.rootStore})}function A(e){window.__c={n:"RelationPropertyDiff"};const{beforeValue:t,afterValue:n,propertySchema:a,rootStore:o}=e,l=(0,r.VK)((()=>{const e=(0,s.rq)(t.value),i=(0,s.rq)(n.value),r=(0,d.N)(e,i,(e=>`${e.id}${e.table}`)),l=new Set(s.j$({relationValue:r.created,getRecordModel:o.getRecordModel,propertySchema:a})),c=new Set(s.j$({relationValue:r.deleted,getRecordModel:o.getRecordModel,propertySchema:a})),u=[...l,...c];return u.flatMap(((e,t)=>{const n=C.G.createChildStore(o,{table:b.iU,id:e.id}).getPropertyValue("title")||[],a=[],i=f.lzi(n);for(const o of i)if(f.QJH(o)){const t=l.has(e)?"+":"-",n=[o[0],[[t]]];a.push(n)}else a.push(o);return t<u.length-1&&a.push(f.V3y("\n")),a}))}),[t,n,a,o]);return i()(w.Z,{value:{value:l,spaceId:t.spaceId},propertySchema:{type:"title",name:"Title"},rootStore:o})}function T(e){window.__c={n:"ArrowPropertyDiff"};const t=(0,l.yK)((()=>({arrowDiffWrap:{display:"inline-flex",alignItems:"center"}})),[]);return i()("div",{style:t.arrowDiffWrap},void 0,i()(w.Z,{value:e.beforeValue,propertySchema:e.propertySchema,rootStore:e.rootStore}),i()(B,{}),i()(w.Z,{value:e.afterValue,propertySchema:e.propertySchema,rootStore:e.rootStore}))}function B(){window.__c={n:"Arrow"};const e=(0,l.yK)((e=>({container:{padding:"0px 8px"},icon:{width:15,height:15,fill:e.mediumIconColor}})),[]);return i()("div",{style:e.container},void 0,S(e.icon))}},83176:(e,t,n)=>{n.d(t,{z:()=>o});var a=n(23174),i=n.n(a);n(67294);const o=(0,n(45238).I)("analyticsSearch",{viewBox:"0 0 51 52",svg:i()("path",{d:"M.414 21.297c0 2.86.533 5.543 1.6 8.049a21.156 21.156 0 004.468 6.576 20.797 20.797 0 006.577 4.443c2.505 1.067 5.18 1.6 8.023 1.6 2.116 0 4.13-.305 6.043-.914a21.55 21.55 0 005.332-2.565l11.654 11.655a3.44 3.44 0 001.245.812c.473.186.964.28 1.472.28.728 0 1.371-.17 1.93-.508a3.48 3.48 0 001.32-1.346 3.887 3.887 0 00.482-1.93 3.8 3.8 0 00-.279-1.447 3.126 3.126 0 00-.787-1.193l-11.578-11.63a20.414 20.414 0 002.818-5.51c.694-2.013 1.041-4.138 1.041-6.372 0-2.844-.541-5.51-1.625-7.998a20.718 20.718 0 00-4.443-6.602 20.515 20.515 0 00-6.602-4.468c-2.488-1.067-5.162-1.6-8.023-1.6-2.844 0-5.518.533-8.023 1.6a20.592 20.592 0 00-6.577 4.468A21.072 21.072 0 002.014 13.3c-1.067 2.488-1.6 5.154-1.6 7.998zm5.408 0c0-2.1.39-4.071 1.168-5.916a15.517 15.517 0 013.301-4.875 15.168 15.168 0 014.875-3.276c1.845-.795 3.817-1.193 5.916-1.193 2.116 0 4.096.398 5.941 1.193a14.877 14.877 0 014.85 3.276 15.515 15.515 0 013.3 4.875c.796 1.845 1.194 3.817 1.194 5.916 0 2.116-.398 4.096-1.193 5.941a15.517 15.517 0 01-3.301 4.875 15.426 15.426 0 01-4.85 3.276c-1.845.795-3.825 1.193-5.941 1.193-2.099 0-4.07-.398-5.916-1.193a15.737 15.737 0 01-4.875-3.276 15.52 15.52 0 01-3.3-4.875c-.78-1.845-1.169-3.825-1.169-5.941zm15.31 10.36c.458 0 .746-.263.864-.788.237-1.32.474-2.437.711-3.351.254-.931.559-1.693.914-2.286a4.554 4.554 0 011.397-1.498c.575-.389 1.311-.694 2.209-.914.914-.237 2.056-.448 3.427-.634.542-.085.813-.381.813-.89 0-.507-.271-.812-.813-.913-1.354-.17-2.496-.373-3.427-.61-.915-.253-1.668-.567-2.26-.939a4.814 4.814 0 01-1.422-1.498c-.373-.61-.677-1.363-.914-2.26a42.337 42.337 0 01-.635-3.326c-.084-.542-.372-.813-.863-.813s-.796.263-.914.788a53.724 53.724 0 01-.737 3.377c-.22.914-.507 1.675-.863 2.285a4.64 4.64 0 01-1.396 1.472c-.576.373-1.32.677-2.235.914-.914.22-2.048.424-3.402.61-.559.101-.838.406-.838.914 0 .49.28.787.838.889 1.693.186 3.055.44 4.088.761 1.032.305 1.828.762 2.387 1.371.575.61 1.015 1.44 1.32 2.489.305 1.05.584 2.395.838 4.037a1 1 0 00.279.584c.17.152.38.228.635.228z"})})},37652:(e,t,n)=>{n.d(t,{V:()=>o});var a=n(23174),i=n.n(a);n(67294);const o=(0,n(45238).I)("arrowLeft",{viewBox:"0 0 30 30",svg:i()("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},79198:(e,t,n)=>{n.d(t,{n:()=>o});var a=n(23174),i=n.n(a);n(67294);const o=(0,n(45238).I)("refresh",{viewBox:"0 0 24 20",svg:i()("path",{d:"M0.19663 9.99023C-0.184229 10.5273-0.00844799 11.0059 0.694677 11.0059L2.04233 11.0059C2.56968 15.9766 6.85679 19.9219 11.9447 19.9219C14.9232 19.9219 17.6185 18.5645 19.4544 16.4551C19.8158 16.0352 19.7669 15.5078 19.3861 15.2344C19.0052 14.9609 18.5365 15.0586 18.224 15.4199C16.7103 17.168 14.4642 18.2617 11.9447 18.2617C7.68686 18.2617 4.22007 15.1074 3.72202 11.0059L5.1771 11.0059C5.87046 11.0059 6.04624 10.5273 5.67515 10L3.48765 6.88477C3.17515 6.43555 2.7064 6.42578 2.38413 6.88477ZM4.44468 3.4668C4.07358 3.88672 4.12241 4.4043 4.51304 4.67773C4.8939 4.95117 5.35288 4.86328 5.67515 4.50195C7.19858 2.76367 9.44468 1.66016 11.9447 1.66016C16.1927 1.66016 19.6595 4.81445 20.1673 8.92578L18.7123 8.92578C18.0189 8.92578 17.8431 9.39453 18.2142 9.93164L20.4017 13.0469C20.7142 13.4961 21.183 13.5059 21.5052 13.0469L23.683 9.94141C24.0736 9.39453 23.888 8.92578 23.1849 8.92578L21.847 8.92578C21.3099 3.95508 17.0326 0 11.9447 0C8.96616 0 6.28061 1.34766 4.44468 3.4668Z"})})},33676:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(23174),i=n.n(a),o=(n(67294),n(45238)),r=n(39986);const l=(0,o.I)("thumbDown",{viewBox:"0 0 18 19",svg:i()("g",{transform:"rotate(180 9 9.5)"},void 0,r.f)})},39986:(e,t,n)=>{n.d(t,{P:()=>l,f:()=>r});var a=n(23174),i=n.n(a),o=(n(67294),n(45238));const r=i()("path",{d:"M0.539062 12.3125C0.539062 15.0547 2.29688 17.3125 4.54688 17.3125H7.11719C8.17188 17.8516 9.42188 18.1641 10.8047 18.1641H11.8906C12.9062 18.1641 13.7734 18.1016 14.3359 17.9609C15.4766 17.6797 16.1953 16.8672 16.1953 15.8516C16.1953 15.6641 16.1719 15.5 16.1172 15.3281C16.6562 14.9141 16.9609 14.2969 16.9609 13.6328C16.9609 13.3203 16.8984 13.0078 16.7891 12.7578C17.1484 12.375 17.3594 11.8203 17.3594 11.25C17.3594 10.875 17.2656 10.4922 17.1094 10.2031C17.3281 9.86719 17.4531 9.42188 17.4531 8.9375C17.4531 7.69531 16.5078 6.73438 15.2734 6.73438H12.3672C12.1953 6.73438 12.0859 6.65625 12.0938 6.50781C12.1328 5.69531 13.4062 3.75781 13.4062 2.17188C13.4062 1.01562 12.5859 0.171875 11.4688 0.171875C10.6484 0.171875 10.0859 0.59375 9.55469 1.61719C8.58594 3.48438 7.40625 5.125 5.65625 7.28125H4.25C2.14844 7.28125 0.539062 9.52344 0.539062 12.3125ZM5.375 12.25C5.375 10.5938 5.75 9.53125 6.80469 8.11719C7.99219 6.53125 9.625 4.63281 10.8125 2.27344C11.0625 1.77344 11.2344 1.64844 11.4844 1.64844C11.7891 1.64844 11.9844 1.86719 11.9844 2.25C11.9844 3.42188 10.6641 5.35156 10.6641 6.61719C10.6641 7.55469 11.4219 8.15625 12.4375 8.15625H15.2422C15.7031 8.15625 16.0391 8.5 16.0391 8.95312C16.0391 9.28125 15.9297 9.5 15.6562 9.76562C15.4609 9.96875 15.4375 10.25 15.6094 10.4453C15.8359 10.7734 15.9375 10.9844 15.9375 11.25C15.9375 11.5781 15.7812 11.8516 15.4609 12.0938C15.2031 12.2812 15.1094 12.5859 15.2656 12.8828C15.4297 13.2109 15.5156 13.3672 15.5156 13.6172C15.5156 14 15.2734 14.2891 14.7812 14.5469C14.5312 14.6875 14.4609 14.9531 14.5703 15.1875C14.7344 15.5938 14.7578 15.6641 14.7578 15.8438C14.7578 16.1797 14.5078 16.4531 13.9766 16.5859C13.5156 16.7031 12.7812 16.75 11.8203 16.7422L10.8125 16.7344C7.57031 16.7031 5.375 14.8828 5.375 12.25ZM1.9375 12.3125C1.9375 10.3281 2.96094 8.73438 4.14062 8.6875C4.34375 8.6875 4.55469 8.6875 4.75781 8.6875C4.20312 9.76562 3.95312 10.8984 3.95312 12.25C3.95312 13.6875 4.46094 14.9531 5.375 15.9453C5.07812 15.9453 4.76562 15.9375 4.46875 15.9375C3.10156 15.8906 1.9375 14.2812 1.9375 12.3125Z"}),l=(0,o.I)("thumbUp",{viewBox:"0 0 18 19",svg:r})}}]);