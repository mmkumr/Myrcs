"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1655],{77465:(e,t,o)=>{o.r(t),o.d(t,{AutomationButtonActionList:()=>at});var n=o(10434),i=o.n(n),a=o(23174),r=o.n(a),l=o(67294),c=o(480),d=o(86628),s=o(24405),u=o(47453),m=o(5366),p=o(98963),g=o(94291),b=o(39699),f=o(63362),y=o(80700),S=o(4615),v=o(97880),h=o(82343),C=o(98742),A=o(24457),w=o(63474),k=o(52275),x=o(78140),M=o(32163),B=o(72495),P=o(26388),T=o(60442);function Z(e){window.__c={n:"AddActionMenu"};const{contextStore:t,onActionAdded:o,insertionPoint:n}=e,a=(0,m.useIntl)(),s=(0,c.O7)(),u=(0,w.D)(),p=(0,A.F)({width:280}),Z=function(e){const{contextStore:t}=e,[o,n]=(0,l.useState)([]),i=(0,d.VK)((()=>(0,h.uV)(t.context.automationStore,t.context.type)),[t.context.automationStore,t.context.type]),a=(0,l.useMemo)((()=>(0,y.P)("display")),[]);return(0,d.VK)((async()=>{if(i){const e=await Promise.all(a.map((async e=>await e.isAvailableForContext(i))));return n(function(e){const t=e=>e?1:-1;return e.slice().sort(((e,o)=>t(o.display.hasSideEffects)-t(e.display.hasSideEffects)))}(a.filter(((t,o)=>e[o]))))}o.length>0&&n([])}),[i,o.length,a]),o}({contextStore:t}).map((e=>{const{display:c}=e;return{key:e.type,render:e=>{const t=t=>l.createElement(k.Z,i()({},(0,C.Z)(t??{},e),{icon:r()(E,{display:c}),disabled:!1,title:a.formatMessage(c.name)})),o=c.description;return o?r()(P.Z,{renderTooltip:()=>r()(T.Z,{caption:a.formatMessage(o)}),placement:P.Z.Placement.Right,delayThreshold:0,render:t}):t()},action:()=>{const i=(0,S.ZP)(),r=t.context.automationStore;b.createAndCommit({userAction:"AutomationActionList.addAction",environment:s,perform:t=>{g.zY({actionId:i,actionType:e.type,automationStore:r,environment:s,intl:a,transaction:t,insertionPoint:n})}}),(0,f.eI)(u,{automation_id:r.id,automation_action_id:i,automation_action_type:e.type}),o(i)}}})).filter(v.$K);return l.createElement(x.Z,p,r()(M.Z,{type:M.i.Vertical,sections:[{key:0,render:e=>l.createElement(B.Z,i()({enableActionSheetTitle:!0},e)),items:Z}],initialFocus:0}))}function E(e){window.__c={n:"AddActionIcon"};const{display:t}=e,o=(0,s.yK)((e=>({icon:{width:13,height:13,fill:t.hasSideEffects?e.blueColor:e.mediumIconColor},iconWrapper:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",background:t.hasSideEffects?"rgba(35, 131, 226, 0.14)":e.accentColors.gray[50],borderRadius:3,marginLeft:-2}})),[t.hasSideEffects]);return r()("div",{style:o.iconWrapper},void 0,t.icon(o.icon))}var V=o(82990),_=o(9953),I=o(92223),O=o(40745),K=o(8597),F=o(56666),L=o(88437),W=o(1230);const D=(0,o(45238).I)("insertUp",{viewBox:"0 0 16 16",svg:r()("path",{d:"M9.55566 3.61987H14.2095C14.5325 3.61987 14.7961 3.36279 14.7961 3.03979C14.7961 2.7168 14.5325 2.45972 14.2095 2.45972H9.55566C9.23267 2.45972 8.97559 2.7168 8.97559 3.03979C8.97559 3.36279 9.23267 3.61987 9.55566 3.61987ZM1.21045 6.9751C1.21045 7.55518 1.52686 7.91113 2.04102 7.91113C2.55518 7.91113 2.87817 7.54199 2.87817 6.99487V5.86768C2.87817 5.70947 2.96387 5.61719 3.12866 5.61719H4.7041V6.28955C4.7041 6.83667 5.2644 7.04761 5.68628 6.71143L7.56494 5.2019C7.84839 4.97778 7.84839 4.57568 7.56494 4.35815L5.68628 2.84204C5.25122 2.48608 4.7041 2.69702 4.7041 3.27051V3.94946H2.93091C1.8894 3.94946 1.21045 4.55591 1.21045 5.59741V6.9751ZM9.55566 7.07397H14.2095C14.5325 7.07397 14.7961 6.81689 14.7961 6.4939C14.7961 6.1709 14.5325 5.91382 14.2095 5.91382H9.55566C9.23267 5.91382 8.97559 6.1709 8.97559 6.4939C8.97559 6.81689 9.23267 7.07397 9.55566 7.07397ZM1.78394 10.5281H14.2095C14.5325 10.5281 14.7961 10.271 14.7961 9.948C14.7961 9.625 14.5325 9.36792 14.2095 9.36792H1.78394C1.46094 9.36792 1.20386 9.625 1.20386 9.948C1.20386 10.271 1.46094 10.5281 1.78394 10.5281ZM1.78394 13.9756H14.2095C14.5325 13.9756 14.7961 13.7251 14.7961 13.4021C14.7961 13.0725 14.5325 12.822 14.2095 12.822H1.78394C1.46094 12.822 1.20386 13.0725 1.20386 13.4021C1.20386 13.7251 1.46094 13.9756 1.78394 13.9756Z"})});var R=o(37612),H=o(89733),U=o(29502),Q=o(28267),N=o(1533),G=o(23063),z=o(31945),q=o(50478),j=o(73063),Y=o(91839),$=o(53437),X=o(27186);const J=(0,m.defineMessages)({moreActionsButtonAriaLabel:{defaultMessage:"More actions",id:"buttonBlock.button.moreActionsButtonAriaLabel"}});function ee(e){window.__c={n:"AutomationActionHeader"};const{contextStore:t,actionStore:o,disabled:n,dragging:i,title:a,picker:c,onActionAdded:u}=e,m=(0,l.useRef)(null),p=(0,Q.X)(m),g=(0,l.useMemo)((()=>Boolean(p&&p.width<320)),[p]),b=(0,d.qz)(void 0,N.Z),f=(0,d.VK)((()=>i||b.state.hovered),[i,b]),S=(0,s.yK)((e=>({iconHandle:{display:"flex",justifyContent:"center",left:0,position:"absolute",top:0,width:24},iconWrap:{position:"relative",width:24},nameRow:{display:"flex",alignItems:g?"flex-start":"center"},name:{flexGrow:1,fontWeight:V.Z.fontWeight.medium,display:"flex",overflow:"hidden",...g?{flexDirection:"row",flexWrap:"wrap",marginLeft:8,alignItems:"center"}:{alignItems:"center",marginLeft:8}},title:{whiteSpace:"nowrap"},picker:{position:"relative",left:-4,...g?{flexShrink:1,display:"inline-flex",minWidth:0}:{flexGrow:1,width:0}}})),[g]),v=(0,d.VK)((()=>o.getType()),[o]);if(!v)return null;const h=(0,y.z)(v),{display:C}=h;return l.createElement("div",{onMouseLeave:e=>H.iV({store:b,event:e,disabled:n}),onMouseMove:e=>H.Js({store:b,event:e,disabled:n}),style:S.nameRow,ref:m},r()("div",{style:S.iconWrap},void 0,r()(G.Z,{isVisible:!0,animationStyle:{opacity:f?0:1},enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:1},render:()=>r()(te,{display:C})}),r()(G.Z,{isVisible:!n,animationStyle:{opacity:f?1:0},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:()=>r()("div",{style:S.iconHandle},void 0,r()(q.ZP,{hideClickMessage:!0}))})),r()("div",{style:S.name},void 0,r()("div",{style:S.title},void 0,a),!g&&l.createElement(l.Fragment,null," "),c&&r()("div",{style:S.picker},void 0,c)),!n&&r()(oe,{contextStore:t,actionStore:o,onActionAdded:u}))}function te(e){window.__c={n:"ActionIcon"};const{display:t}=e,o=(0,s.yK)((e=>({iconWrap:{width:24,height:24,display:"flex",alignItems:"center",borderRadius:4,background:t.hasSideEffects?"rgba(35, 131, 226, 0.14)":e.accentColors.gray[50],flexShrink:0},icon:{width:14,height:14,fill:t.hasSideEffects?e.blueColor:e.accentColors.gray[500],margin:"0 auto"}})),[t.hasSideEffects]);return r()("div",{style:o.iconWrap},void 0,t.icon(o.icon))}function oe(e){window.__c={n:"MoreActionsButton"};const{contextStore:t,actionStore:o,onActionAdded:n}=e,a=(0,m.useIntl)(),c=(0,U.d)(),[d,s]=(0,l.useState)("closed"),[u,p]=l.useState(void 0);return l.createElement(l.Fragment,null,r()(z.ZP,{popupType:c,alignmentToOrigin:z.vR.Center,placementToOrigin:z.pO.Bottom,originGap:0,renderOrigin:e=>l.createElement(j.Z,i()({ariaLabel:a.formatMessage(J.moreActionsButtonAriaLabel),icon:F.o},e)),render:t=>l.createElement(ie,i()({onClose:()=>t.close(),onAddStep:e=>{p(new DOMRect(X.IL.x,X.IL.y,1,1)),s(e?"above":"below"),t.close()}},e))}),r()($.ZP,{popupType:c,open:"closed"!==d,originRect:u,placementToOrigin:$.ZP.Placement.Bottom,alignmentToOrigin:$.ZP.Alignment.Center,render:()=>r()(Z,{contextStore:t,onActionAdded:e=>{n(e),s("closed")},insertionPoint:"above"===d?{beforeActionId:o.id}:{afterActionId:o.id}}),onDismiss:()=>s("closed")}))}function ne(e,t,o){if(t<0||t>=e.length||o<0||o>=e.length)return e;const n=[...e];return n[t]=e[o],n[o]=e[t],n}function ie(e){window.__c={n:"MoreActionsMenu"};const{onClose:t,contextStore:o,actionStore:n,onAddStep:a}=e,s=(0,m.useIntl)(),u=(0,c.O7)(),y=(0,w.D)(),S=(0,d.VK)((()=>o.context.automationStore),[o]),h=(0,d.VK)((()=>S.getActionIds()),[S]),[C,P]=(0,l.useState)(!1),T=h.length<p.FT,Z=h.indexOf(n.id),E=0===Z,V=Z===h.length-1,_=(0,A.F)(),I={key:"duplicate",action:async()=>{P(!0);const e=b.createAndCommit({userAction:"AutomationAction.duplicateAction",environment:u,perform:e=>g.AN({actionStore:n,automationStore:S,environment:u,intl:s,transaction:e})});n.isDefined()&&(0,f.eI)(y,{automation_id:o.context.automationStore.id,automation_action_id:n.id,automation_action_type:n.getType(),from:"duplicate"});try{await e.performResult.onComplete}finally{P(!1)}t()},render:e=>{const t=C?r()(Y.Z,{}):(0,L.a)({height:16,width:16}),o=r()(m.FormattedMessage,C?{id:"automations.duplicatingActionButton.label",defaultMessage:"Duplicating..."}:{id:"automations.duplicateBelowActionButton.label",defaultMessage:"Duplicate below"});return l.createElement(k.Z,i()({},e,{disabled:C,icon:t,title:o}))}},F={key:"delete",action:()=>{b.createAndCommit({userAction:"AutomationAction.removeAction",environment:u,perform:e=>{g.sl({clientContext:o.context,actionStore:n,transaction:e}),n.isDefined()&&(0,f.co)(y,{automation_id:o.context.automationStore.id,automation_action_id:n.id,automation_action_type:n.getType()})}}),t()},render:e=>l.createElement(k.Z,i()({},e,{icon:(0,R.y)({height:16,width:16}),title:r()(m.FormattedMessage,{id:"automations.deleteActionButton.label",defaultMessage:"Delete"})}))},H=[!0,!1].map((e=>{if(!(e&&E||!e&&V))return{key:e?"moveUp":"moveDown",action:()=>{b.createAndCommit({userAction:"AutomationAction.moveAction",environment:u,perform:t=>{let n;n=ne(h,e?Z-1:Z+1,Z),g.kM({clientContext:o.context,transaction:t,newActionIds:n})}}),t()},render:t=>l.createElement(k.Z,i()({},t,{icon:(e?K.Z:O.M)({width:16,height:16}),title:r()(m.FormattedMessage,e?{id:"automations.moveUpButton.label",defaultMessage:"Move up"}:{id:"automations.moveDownButton.label",defaultMessage:"Move down"})}))}})).filter(v.$K),U=[!0,!1].map((e=>({key:e?"addStepAbove":"addStepBelow",action:()=>{a(e)},render:t=>l.createElement(k.Z,i()({},t,{disabledFeedback:!0,icon:e?D({width:16,height:16}):(0,W.H)({width:16,height:16}),title:r()(m.FormattedMessage,e?{id:"automations.addStepAboveButton.label",defaultMessage:"Add step above"}:{id:"automations.addStepBelowButton.label",defaultMessage:"Add step below"})}))})));return l.createElement(x.Z,_,r()(M.Z,{type:M.i.Vertical,sections:[...H.length>0?[{key:"movement",render:e=>l.createElement(B.Z,i()({enableActionSheetTitle:!0},e)),items:H}]:[],...T?[{key:"addSteps",render:e=>l.createElement(B.Z,i()({enableActionSheetTitle:!0,topBorder:!0},e)),items:U},{key:"duplicate",render:e=>l.createElement(B.Z,i()({enableActionSheetTitle:!0,topBorder:!0},e)),items:[I]}]:[],{key:"delete",render:e=>l.createElement(B.Z,i()({enableActionSheetTitle:!0,topBorder:!0},e)),items:[F]}],initialFocus:0}))}var ae=o(5795),re=o(68214),le=o(19959);var ce=o(72126),de=o(43250),se=o(12534),ue=o(57559),me=o(15201),pe=o(68709),ge=o(55217),be=o(79954),fe=o(38752);const ye=(0,m.defineMessages)({aboveButtonLabel:{id:"automations.DuplicateBlocksAction.aboveButtonLabel",defaultMessage:"Above button"},belowButtonLabel:{id:"automations.DuplicateBlocksAction.belowButtonLabel",defaultMessage:"Below button"}});function Se(e){window.__c={n:"DuplicateBlocksActionEditor"};const{actionStore:t,disabled:o,contentParentPointer:n,buttonPlacement:i}=e,a=(0,c.O7)(),u=(0,s.yK)((e=>({listWrap:{background:e.contentBackground,boxShadow:e.inputBoxShadow,padding:"3px 9px",borderRadius:5,minHeight:64,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},emptyPlaceholder:{caretColor:e.mediumTextColor,color:e.lightTextColor,fontSize:14,padding:"5px 0",display:"inline-block"}})),[]),p=(0,d.VK)((()=>ue.G.createChildStore(t,n)),[t,n]),f=(0,d.VK)((()=>p.getContentStore()),[p]),y=(0,l.useCallback)((e=>{(0,se.ZP)({event:e,context:se.Af.EditorClick,callback:()=>{if(!f)return;(f.getValue()||[]).length>0||b.createAndCommit({userAction:"DuplicateBlocksAction.handleListClick",environment:a,perform:e=>{g.Nj({environment:a,parentStore:f,transaction:e})}})}})}),[a,f]);if(!f)return null;const S="inline"===(null==i?void 0:i.type);return l.createElement(l.Fragment,null,r()(be.Z,{store:p,analyticsName:"duplicate_blocks_action",isListContainer:!0},void 0,r()(pe.p,{allowSelectionWithin:!0},void 0,r()("div",{style:u.listWrap,onClick:y,className:de.Wh_},void 0,r()(me.O,{displayName:"DuplicateBlocksActionContent",disabled:o},void 0,r()(ge.Z,{disabled:o,store:f,emptyPlaceholder:r()("div",{style:u.emptyPlaceholder},void 0,r()(m.FormattedMessage,S?{id:"automations.DuplicateBlocksAction.emptyPlaceholder",defaultMessage:"Click to edit or drop blocks here…"}:{id:"automations.DuplicateBlocksAction.emptyCannotDropPlaceholder",defaultMessage:"Click to edit blocks here…"})),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1}))))))}const ve={before:{icon:D({width:16}),key:"before",title:ye.aboveButtonLabel},after:{icon:(0,W.H)({width:16}),key:"after",title:ye.belowButtonLabel}};function he(e){window.__c={n:"InsertBlockInDropdownButton"};const{actionStore:t,disabled:o}=e,n=(0,m.useIntl)(),a=(0,s.yK)((e=>({button:{fontWeight:"normal"}})),[]),c=(0,U.d)(),u=(0,d.VK)((()=>t.getInsertionPoint()),[t]),p=Object.values(ve),g=p.find((e=>e.key===u));return g?r()(z.ZP,{popupType:c,alignmentToOrigin:z.vR.End,disabled:o,placementToOrigin:z.pO.Bottom,originGap:0,renderOrigin:e=>l.createElement(fe.S,i()({disabled:o,style:a.button,variant:"gray"},e),n.formatMessage(g.title)),render:e=>r()(Ce,{actionStore:t,currentOption:g,options:p,parent:e})}):null}function Ce(e){window.__c={n:"InsertBlockInDropdownMenu"};const{actionStore:t,currentOption:o,options:n,parent:a}=e,d=(0,c.O7)(),s=(0,m.useIntl)(),u=(0,l.useCallback)((e=>{b.createAndCommit({userAction:"DuplicateBlocksAction.setInsertionPoint",environment:d,perform:o=>{_.sW({store:t.getConfigStore(),data:{insertion_point:e},transaction:o})}})}),[d,t]),p=(0,A.F)({maxWidth:360}),g=n.map((e=>({key:e.key,render:t=>l.createElement(k.Z,i()({},t,{checkState:o.key===e.key,icon:e.icon,title:s.formatMessage(e.title)})),action:()=>{u(e.key),a.close()}})));return l.createElement(x.Z,p,r()(M.Z,{initialFocus:0,sections:[{key:0,render:e=>l.createElement(B.Z,i()({enableActionSheetTitle:!0},e)),items:g}],type:M.i.Vertical}))}var Ae=o(72865),we=o(10052);const ke=(0,m.defineMessages)({confirmationInputPlaceholder:{defaultMessage:"Write a message to show users…",id:"automations.BaseModalAction.confirmationPlaceholder"},continueButtonHint:{defaultMessage:"Completes button action",id:"automations.BaseModalAction.continueButtonHint"},cancelButtonHint:{defaultMessage:"Stops button action",id:"automations.BaseModalAction.cancelButtonHint"}});function xe(e){window.__c={n:"WithRightOverlay"};const{children:t,overlayContent:o}=e,n=(0,s.yK)((e=>({wrap:{position:"relative"},overlay:{position:"absolute",height:"100%",display:"flex",alignItems:"center",top:0,right:10,color:e.lightTextColor}})),[]);return r()("div",{style:n.wrap},void 0,t,r()("div",{style:n.overlay},void 0,o))}var Me=o(23877);function Be(e){window.__c={n:"AutomationKeyValueRow"};const{keyComp:t,valueComp:o,style:n}=e,i=(0,s.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"space-between",...n}})),[n]);return r()("div",{style:i.container},void 0,t,o)}function Pe(e){return r()("div",{style:{marginRight:4,flexShrink:0}},void 0,e.text)}var Te=o(84619),Ze=o(61766),Ee=o(76798),Ve=o(21396),_e=o(29758);function Ie(e){window.__c={n:"AutomationPagePicker"};const{contextStore:t,actionStore:o,target:n,onChange:a,disabled:c,errorMessage:s}=e,u=(0,d.qz)(void 0,Ze.Z),p=(0,d.VK)((()=>{if(n&&"variable"===n.type)return t.getContextValueForActionById(o.id,n.id)}),[n,t,o.id]),g=(0,U.d)(),b=(0,fe.d)({errorMessage:s,hasValue:Boolean(n)}),f=(0,l.useCallback)((e=>{"page"!==e.type&&"variable"!==e.type||(a(e),u.reset())}),[a,u]),y=(0,l.useCallback)((()=>u.reset()),[u]);return r()(z.ZP,{buttonPopupStore:u,popupType:g,alignmentToOrigin:z.vR.End,placementToOrigin:z.pO.Bottom,originGap:0,disabled:c,renderOrigin:e=>l.createElement(fe.S,i()({disabled:c},b,e),n&&"page"===n.type?r()(Ee.Z,{store:ue.G.createChildStore(t.context.parentRecordStore,n.page)}):p?r()(Ve.F,{value:p,format:Te.l.Medium,isSingle:!0}):r()(m.FormattedMessage,{id:"automations.AutomationPagePicker.pagesDropdown.label",defaultMessage:"Select page"})),render:e=>r()(_e.L,{actionId:o.id,automationContextStore:t,onChange:f,onClose:y,selectedTarget:n,skipCollections:!0})})}function Oe(e){window.__c={n:"OpenPageInDropdownButton"};const{actionStore:t,disabled:o}=e,n=(0,s.Fg)(),a=(0,d.VK)((()=>t.getOpenPageIn()),[t]),c=(0,U.d)(),u=(0,Me.v)({currentViewType:void 0,theme:n}).find((e=>e.key===a));return u?r()(z.ZP,{popupType:c,alignmentToOrigin:z.vR.End,placementToOrigin:z.pO.Bottom,originGap:0,disabled:o,renderOrigin:e=>l.createElement(fe.S,i()({disabled:o,variant:"gray"},e),u.title),render:t=>l.createElement(Ke,i()({currentOpenPageIn:a,parent:t},e))}):null}function Ke(e){window.__c={n:"OpenPageInDropdownMenu"};const{currentOpenPageIn:t,actionStore:o,parent:n}=e,a=(0,c.O7)(),d=(0,s.Fg)(),u=(0,s.yK)((()=>({menuItem:{paddingTop:8,paddingBottom:8}})),[]),m=(0,l.useCallback)((e=>{b.createAndCommit({userAction:"OpenPageAction.setTarget",environment:a,perform:t=>{_.sW({store:o.getConfigStore(),data:{open_in:e},transaction:t})}})}),[a,o]),p=(0,A.F)({width:280,maxWidth:360}),g=(0,Me.v)({currentViewType:void 0,theme:d}),f=ce.oA(g.map(((e,o)=>({key:o,render:o=>l.createElement(k.Z,i()({},o,{disabled:!1,title:e.title,icon:e.icon,caption:e.caption,body:e.body,style:u.menuItem,checkState:t===e.key},o)),action:()=>{m(e.key),n.close()}}))));return l.createElement(x.Z,p,r()(M.Z,{type:M.i.Vertical,sections:[{key:0,render:e=>l.createElement(B.Z,i()({enableActionSheetTitle:!0},e)),items:f}],initialFocus:0}))}o(57658);var Fe=o(22109),Le=o(87279),We=o(61053),De=o(12076),Re=o(80117);const He=(0,m.defineMessages)({addSortLimit:{id:"automations.QueryCollectionAction.addSortLimitButton.addSortLimit",defaultMessage:"Add sort, limit"},addLimit:{id:"automations.QueryCollectionAction.addSortLimitButton.addLimit",defaultMessage:"Add limit"},addSort:{id:"automations.QueryCollectionAction.addSortLimitButton.addSort",defaultMessage:"Add sort"},limitDescription:{id:"automations.QueryCollectionAction.limitPopup.limitDescription",defaultMessage:"{numberOfPages, plural, one {{numberOfPages} page} other {{numberOfPages} pages}}"},unlimitedDescription:{id:"automations.QueryCollectionAction.limitPopup.unlimitedDescription",defaultMessage:"Unlimited"}});function Ue(e){window.__c={n:"AddSortLimitButton"};const{actionStore:t,collectionStore:o,disabled:n,onSortAdded:a,onLimitAdded:s}=e,u=(0,c.Fy)(),p=(0,c.O7)(),[g,f]=(0,l.useState)(!1);let y;y=u.isMobile?{menuType:Le.og.ActionSheet}:{menuType:Le.og.Popup,width:250};const S=(0,l.useRef)(null),[v,h]=l.useState(void 0),C=(0,d.VK)((()=>o.getSchema()??{}),[o]),A=(0,d.VK)((()=>o.getFormat()??{}),[o]),w=(0,l.useCallback)((()=>Object.keys(o.getSchema())),[o]),k=(0,d.VK)((()=>t.hasSort()),[t]),M=(0,d.VK)((()=>t.hasLimit()),[t]),B=(0,l.useCallback)((e=>{e&&b.createAndCommit({userAction:"QueryCollectionAction.setInitialSort",environment:p,perform:o=>{_.sW({store:t.getConfigStore(),data:{sort:[{property:e,direction:"ascending"}]},transaction:o})}}),f(!1),a()}),[t,p,a]),P=(0,l.useCallback)((()=>{b.createAndCommit({userAction:"QueryCollectionAction.setInitialLimit",environment:p,perform:e=>{_.sW({store:t.getConfigStore(),data:{limit:1},transaction:e})}}),s()}),[t,p,s]);if(k&&M)return null;let T;return T=k?He.addLimit:M?He.addSort:He.addSortLimit,l.createElement(l.Fragment,null,r()(z.ZP,{popupType:u.isMobile?$.kQ.SlideUp:$.kQ.Popup,alignmentToOrigin:z.vR.Start,placementToOrigin:z.pO.Bottom,originGap:0,disabled:n,renderOrigin:e=>l.createElement(fe.S,i()({disabled:n,variant:"gray",ref:S},e),l.createElement(m.FormattedMessage,T)),render:e=>r()(Qe,{showSortOption:!k,showLimitOption:!M,onSortSelected:()=>{var t;f(!0),h(null===(t=S.current)||void 0===t?void 0:t.getBoundingClientRect()),e.close()},onLimitSelected:()=>{P(),e.close()}})}),r()($.ZP,{popupType:u.isMobile?$.kQ.SlideUp:$.kQ.Popup,open:g,placementToOrigin:$.ZP.Placement.Bottom,alignmentToOrigin:$.ZP.Alignment.Start,originRect:v,render:()=>l.createElement(x.Z,y,r()(We.Z,{schema:C,format:A,currentProperty:void 0,getProperties:w,onAccept:B})),onDismiss:()=>f(!1)}))}function Qe(e){window.__c={n:"AddSortLimitMenu"};const{showSortOption:t,showLimitOption:o,onSortSelected:n,onLimitSelected:a}=e;let d;d=(0,c.Fy)().isMobile?{menuType:Le.og.ActionSheet}:{menuType:Le.og.Popup,width:250};const s=[];return t&&s.push({key:"sort",action:n,render:e=>l.createElement(k.Z,i()({},e,{title:"Sort",icon:(0,Fe.T)({width:16})}))}),o&&s.push({key:"limit",action:a,render:e=>l.createElement(k.Z,i()({},e,{title:"Limit",icon:(0,O.M)({width:16})}))}),l.createElement(x.Z,d,r()(M.Z,{type:M.i.Vertical,sections:[{key:0,render:e=>l.createElement(B.Z,i()({enableActionSheetTitle:!0},e)),items:s}],initialFocus:0}))}function Ne(e){window.__c={n:"SortPopup"};const{contextStore:t,actionStore:o,collectionStore:n,disabled:a,buttonPopupStore:s}=e,u=(0,c.O7)(),{device:p}=u,g=(0,d.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e||null===(e=e.sort)||void 0===e?void 0:e.length)??0}),[o]);return r()(z.ZP,{popupType:p.isMobile?$.kQ.SlideUp:$.kQ.Popup,alignmentToOrigin:z.vR.End,placementToOrigin:z.pO.Bottom,originGap:0,disabled:a,buttonPopupStore:s,renderOrigin:e=>l.createElement(fe.S,i()({disabled:a,variant:"gray"},e),r()(m.FormattedMessage,g>0?{defaultMessage:"{numberOfSorts, plural, one {{numberOfSorts} sort} other {{numberOfSorts} sorts}}",values:{numberOfSorts:g},id:"automations.QueryCollectionAction.oneOrMoreSorts.title"}:{defaultMessage:"None",id:"automations.QueryCollectionAction.noSorts.title"})),render:e=>r()(Ge,{contextStore:t,collectionStore:n,actionStore:o,disabled:a})})}function Ge(e){window.__c={n:"SortMenu"};const{contextStore:t,actionStore:o,collectionStore:n,disabled:i}=e,a=(0,c.O7)(),{device:s}=a;let u;u=s.isMobile?{menuType:Le.og.ActionSheet}:{menuType:Le.og.Popup,minWidth:300};const m=(0,l.useCallback)((e=>{b.createAndCommit({userAction:"QueryCollectionAction.setSort",environment:a,perform:t=>{_.sW({store:o.getConfigStore(),data:{sort:e},transaction:t})}})}),[a,o]),p=(0,d.VK)((()=>o.getConfigStore().getKeyStore("sort").getValue()??[]),[o]),g=(0,d.VK)((()=>n.getSchema()),[n]),f=(0,d.VK)((()=>n.getFormat()),[n]);return l.createElement(x.Z,u,r()(De.Z,{schema:g,format:f,collectionViewStore:void 0,sorts:p,disabled:i,parentStore:t.context.parentRecordStore,onChange:m}))}function ze(e){window.__c={n:"LimitPopup"};const{actionStore:t,disabled:o,buttonPopupStore:n}=e,a=(0,c.O7)(),{device:s}=a,u=(0,d.VK)((()=>t.getConfigStore().getKeyStore("limit").getValue()),[t]);return r()(z.ZP,{popupType:s.isMobile?$.kQ.SlideUp:$.kQ.Popup,alignmentToOrigin:z.vR.End,placementToOrigin:z.pO.Bottom,originGap:0,disabled:o,buttonPopupStore:n,renderOrigin:e=>l.createElement(fe.S,i()({disabled:o,variant:"gray"},e),(0,v.$K)(u)&&l.createElement(m.FormattedMessage,i()({},He.limitDescription,{values:{numberOfPages:u}}))),render:e=>r()(qe,{onLimitChanged:o=>{(e=>{b.createAndCommit({userAction:"QueryCollectionAction.setLimit",environment:a,perform:o=>{_.sW({store:t.getConfigStore(),data:{limit:e},transaction:o})}})})(o),e.close()}})})}function qe(e){window.__c={n:"LimitMenu"};const{onLimitChanged:t}=e;let o;o=(0,c.Fy)().isMobile?{menuType:Le.og.ActionSheet}:{menuType:Le.og.Popup,minWidth:250};const n=[];for(let a=1;a<=5;a++)n.push({key:`limit-${a}`,action:()=>{t(a)},render:e=>l.createElement(k.Z,i()({},e,{title:l.createElement(m.FormattedMessage,i()({},He.limitDescription,{values:{numberOfPages:a}}))}))});return n.push({key:"unlimited",action:()=>{t(void 0)},render:e=>l.createElement(k.Z,i()({},e,{title:l.createElement(m.FormattedMessage,He.unlimitedDescription)}))}),l.createElement(x.Z,o,r()(M.Z,{type:M.i.Vertical,sections:[{key:0,render:e=>l.createElement(B.Z,i()({enableActionSheetTitle:!0},e)),items:n}],initialFocus:0}))}o(21703);var je=o(43690),Ye=o(78106),$e=o(68626),Xe=o(11335),Je=o(37034);function et(e){window.__c={n:"TargetPicker"};const{contextStore:t,actionStore:o,disabled:n,errorMessage:a}=e,s=(0,c.O7)(),u=(0,d.VK)((()=>{const e=o.getVariableTargetStore();if(e)return e.getValue();const t=o.getCollectionTargetStore();if(t){const e=t.getKeyStore("collection").getValue();if(e)return{collection:e,type:"collection"}}}),[o]),p=(0,d.VK)((()=>{if(u&&"variable"===u.type)return t.getContextValueForActionById(o.id,u.id)}),[t,o,u]),g=(0,fe.d)({errorMessage:a,hasValue:Boolean(u||p)}),f=(0,d.qz)(void 0,Ze.Z),y=(0,U.d)(),S=(0,l.useCallback)((e=>{let t;if("collection"===e.type)t="UpdatePageAction.updateCollection";else if("variable"===e.type)t="UpdatePageAction.updateVariable";else{if("page"===e.type)throw new Error("Not implemented yet.");(0,v.t1)(e)}b.createAndCommit({userAction:t,environment:s,perform:t=>{_.sW({store:o.getConfigStore(),transaction:t,data:{target:e,properties:null,values:null}})}}),f.reset()}),[s,o,f]),h=(0,l.useCallback)((()=>f.reset()),[f]);return r()(z.ZP,{buttonPopupStore:f,popupType:y,alignmentToOrigin:z.vR.End,placementToOrigin:z.pO.Bottom,originGap:0,disabled:n,renderOrigin:e=>l.createElement(fe.S,i()({disabled:n},g,e),u&&"collection"===u.type?r()(Ee.Z,{store:ue.NW.createChildStore(t.context.parentRecordStore,u.collection)}):p?r()(Ve.F,{value:p,format:Te.l.Medium,isSingle:!0}):r()(m.FormattedMessage,{id:"automations.UpdatePagesAction.pagesDropdown.label",defaultMessage:"Select database"})),render:e=>r()(_e.L,{actionId:o.id,automationContextStore:t,onChange:S,onClose:h,selectedTarget:u,skipPages:!0})})}const tt={create_page:function(e){window.__c={n:"CreatePageAction"};const{contextStore:t,actionStore:o,disabled:n,showErrorIfPresent:a}=e,s=(0,c.O7)(),u=(0,d.VK)((()=>o.getCollectionStore()),[o]),p=(0,d.VK)((()=>{const e=o.getCollectionStore();if(e)return{collection:e.getSpaceShardedPointer(),type:"collection"}}),[o]),g=(0,d.VK)((()=>{var e;return null===(e=o.getConfig())||void 0===e?void 0:e.template_page_id}),[o]),f=(0,d.VK)((()=>{var e;if(!u)return!1;return((null===(e=u.getTemplatePageStores())||void 0===e?void 0:e.filter((e=>e.pathIsAccessibleAndAlive())))??[]).length>0}),[u]),y=(0,l.useCallback)((e=>{"collection"===e.type&&b.createAndCommit({userAction:"CreatePageAction.setCollection",environment:s,perform:t=>{_.sW({store:o.getConfigStore(),data:{collection:e.collection,properties:["title"],values:null,template_page_id:null},transaction:t})}})}),[s,o]),S=(0,l.useCallback)((e=>{b.createAndCommit({userAction:"CreatePageAction.setTemplate",environment:s,perform:t=>{const n=o.getConfig();if(!n)return;const{properties:i,values:a}=n;let r=!1;if(e&&i&&1===i.length&&i.includes("title")){var l;const e=null==a?void 0:a.title;e&&null!==(l=e.value)&&void 0!==l&&l.value||(r=!0)}_.sW({store:o.getConfigStore(),data:{template_page_id:e??null,...r&&{properties:[]}},transaction:t})}})}),[s,o]),v=(0,I.TU)({contextStore:t,actionId:o.id,shouldShow:a,errorKey:"collection"}),h=(0,I.TU)({contextStore:t,actionId:o.id,shouldShow:a,errorKey:"template"});return l.createElement(l.Fragment,null,l.createElement(ee,i()({},e,{title:r()(m.FormattedMessage,{id:"automations.CreatePageAction.header",defaultMessage:"Add page to"}),picker:r()("div",{style:{display:"flex",alignItems:"center",whiteSpace:"normal"}},void 0,r()(re.a,{actionStore:o,currentValue:p,contextStore:t,onChange:y,disabled:n,errorMessage:v}),u&&f&&r()(m.FormattedMessage,{id:"automations.CreatePageAction.asTemplate",defaultMessage:"as {templateName}",values:{templateName:r()(le.f,{collectionStore:u,currentTemplateId:g,onChange:S,disabled:n,errorMessage:h})}}))})),u&&r()(ae.QF,{contextStore:t,collectionStore:u,actionStore:o,disabled:n,showSetPropertyActions:!1}))},update_pages:function(e){window.__c={n:"UpdatePagesAction"};const{contextStore:t,actionStore:o,disabled:n,showErrorIfPresent:a}=e,s=(0,c.O7)(),u=(0,m.useIntl)(),p=(0,d.VK)((()=>o.getTargetStore()),[o]),g=(0,d.VK)((()=>"collection"===p.getKeyStore("type").getValue()),[p]),f=(0,d.VK)((()=>{var e;const t=o.getCollectionTargetStore();return null==t||null===(e=t.getKeyStore("filter"))||void 0===e?void 0:e.getValue()}),[o]),y=(0,l.useCallback)((e=>{b.createAndCommit({userAction:"QueryCollectionAction.setFilter",environment:s,perform:t=>{_.sW({store:p,transaction:t,data:{filter:e}})}})}),[s,p]),S=(0,d.VK)((()=>{const e=p.getValue();if(e){if("collection"===e.type)return ue.NW.createChildStore(t.context.parentRecordStore,e.collection);if("variable"===e.type){const o=t.compilationResultStore.state;if($e.x.isFail(o))return;const n=(0,Ye.vx)(o.value.valueTypes,e.id);if(n)return(0,Xe.wB)(n,t.context.parentRecordStore)}else{if("page"===e.type)return;(0,v.t1)(e)}}}),[p,t.context.parentRecordStore,t.compilationResultStore]),h=(0,d.VK)((()=>S?(0,Je.vU)({environment:s,intl:u,store:S}):void 0),[S,u,s]),C=(0,d.VK)((()=>f?(0,je.Ih)(f,(null==S?void 0:S.getSchema())||{}):void 0),[f,S]),A=(0,I.TU)({contextStore:t,actionId:o.id,shouldShow:a}),w=(0,d.VK)((()=>{var e;const n=null===(e=o.getVariableTargetStore())||void 0===e?void 0:e.getValue();if(!n)return!1;const i=t.getContextValueForActionById(o.id,n.id);return!!i&&"block"===i.type.type}),[o,t]);return l.createElement(l.Fragment,null,l.createElement(ee,i()({},e,{title:r()(m.FormattedMessage,w?{id:"automations.UpdatePagesAction.singularHeader",defaultMessage:"Edit"}:{id:"automations.UpdatePagesAction.header",defaultMessage:"Edit pages in"}),picker:r()(et,{contextStore:t,actionStore:o,disabled:n,errorMessage:A})})),g&&S&&r()("div",{style:{margin:"0 0 -4px 8px"}},void 0,r()(Be,{keyComp:r()(Pe,{text:r()(m.FormattedMessage,{id:"automations.UpdatePagesAction.filter.label",defaultMessage:"Pages to edit"})}),valueComp:r()(Re.W,{contextStore:t,filter:C,collectionStore:S,onChange:y,disabled:n,noFiltersMessage:(0,v.$K)(h)?r()(m.FormattedMessage,{defaultMessage:"All pages in {collectionName}",id:"automations.UpdatePagesAction.filterRuleCount.noFilters.label",values:{collectionName:h}}):r()(m.FormattedMessage,{defaultMessage:"All pages in database",id:"automations.UpdatePagesAction.filterRuleCount.noFilters.fallbackLabel",values:{collectionName:h}})})})),S&&r()(ae.QF,{contextStore:t,collectionStore:S,actionStore:o,disabled:n,showSetPropertyActions:!0}))},query_collection:function(e){window.__c={n:"QueryCollectionAction"};const{contextStore:t,actionStore:o,disabled:n}=e,a=(0,c.O7)(),s=(0,d.VK)((()=>o.getCollectionStore()),[o]),u=(0,d.VK)((()=>{const e=o.getCollectionStore();if(e)return{collection:e.getSpaceShardedPointer(),type:"collection"}}),[o]),p=(0,d.VK)((()=>o.getConfigStore().getKeyStore("filter").getValue()),[o]),g=(0,d.VK)((()=>o.hasSort()),[o]),f=(0,d.VK)((()=>o.hasLimit()),[o]),y=(0,d.qz)(void 0,Ze.Z),S=(0,d.qz)(void 0,Ze.Z),v=(0,l.useCallback)((e=>{"collection"===e.type&&b.createAndCommit({userAction:"QueryCollectionAction.setCollection",environment:a,perform:t=>{_.sW({store:o.getConfigStore(),data:{collection:e.collection,filter:void 0,sort:void 0},transaction:t})}})}),[a,o]),h=(0,l.useCallback)((e=>{b.createAndCommit({userAction:"QueryCollectionAction.setFilter",environment:a,perform:t=>{_.sW({store:o.getConfigStore(),data:{filter:e},transaction:t})}})}),[a,o]),C=(0,l.useCallback)((()=>{y.setState({open:!0})}),[y]),A=(0,l.useCallback)((()=>{S.setState({open:!0})}),[S]);return l.createElement(l.Fragment,null,l.createElement(ee,i()({},e,{title:r()(m.FormattedMessage,{id:"automations.QueryCollectionAction.title",defaultMessage:"Get pages from"}),picker:r()(re.a,{currentValue:u,contextStore:t,onChange:v,disabled:n})})),s&&l.createElement(l.Fragment,null,r()("div",{style:{margin:"0 8px"}},void 0,r()(Be,{keyComp:r()(Pe,{text:r()(m.FormattedMessage,{id:"automations.QueryCollectionAction.filter.label",defaultMessage:"Filter"})}),valueComp:r()(Re.W,{contextStore:t,collectionStore:s,filter:p,onChange:h,disabled:n,noFiltersMessage:r()(m.FormattedMessage,{defaultMessage:"Return all pages",id:"automations.QueryCollectionAction.filterRuleCount.noFilters.label"})})}),g&&r()(Be,{keyComp:r()(Pe,{text:r()(m.FormattedMessage,{id:"automations.QueryCollectionAction.sort.label",defaultMessage:"Sort"})}),valueComp:r()(Ne,{contextStore:t,collectionStore:s,actionStore:o,disabled:n,buttonPopupStore:y})}),f&&r()(Be,{keyComp:r()(Pe,{text:r()(m.FormattedMessage,{id:"automations.QueryCollectionAction.limit.label",defaultMessage:"Limit"})}),valueComp:r()(ze,{actionStore:o,disabled:n,buttonPopupStore:S})})),r()(Ue,{collectionStore:s,actionStore:o,disabled:n,onSortAdded:C,onLimitAdded:A})))},open_page:function(e){window.__c={n:"OpenPageAction"};const{contextStore:t,actionStore:o,disabled:n,showErrorIfPresent:a}=e,s=(0,c.O7)(),u=(0,l.useCallback)((e=>{b.createAndCommit({userAction:"OpenPageAction.setTarget",environment:s,perform:t=>{_.sW({store:o.getConfigStore(),data:{target:e},transaction:t})}})}),[s,o]),p=(0,d.VK)((()=>{var e;return null===(e=o.getConfig())||void 0===e?void 0:e.target}),[o]),g=(0,I.TU)({contextStore:t,actionId:o.id,shouldShow:a});return l.createElement(l.Fragment,null,l.createElement(ee,i()({},e,{title:r()(m.FormattedMessage,{id:"automations.OpenPageAction.header",defaultMessage:"Open"}),picker:r()(Ie,{actionStore:o,target:p,onChange:u,contextStore:t,disabled:n,errorMessage:g})})),r()("div",{style:{margin:"0 8px"}},void 0,r()(Be,{keyComp:r()(Pe,{text:r()(m.FormattedMessage,{id:"automations.OpenPageAction.openPageIn.label",defaultMessage:"Open page in"})}),valueComp:l.createElement(Oe,e)})))},duplicate_blocks:function(e){window.__c={n:"DuplicateBlocksAction"};const{actionStore:t,disabled:o}=e,n=(0,d.VK)((()=>ce.Ps(t.getBlockPointers())),[t],{useDeepEqual:!0});return l.createElement(l.Fragment,null,l.createElement(ee,i()({},e,{title:r()(m.FormattedMessage,{id:"automations.DuplicateBlocksAction.header",defaultMessage:"Insert blocks"}),picker:r()(he,{actionStore:t,disabled:o})})),n?l.createElement(Se,i()({},e,{contentParentPointer:n})):null)},modal_confirmation:function(e){window.__c={n:"ModalConfirmationAction"};const{actionStore:t,disabled:o}=e,n=(0,c.O7)(),a=(0,m.useIntl)(),u=(0,s.yK)((e=>({wrap:{display:"flex",flexDirection:"column",gap:10},plainTextInput:{backgroundColor:e.contentBackground,paddingTop:6,paddingBottom:6}})),[]),g=(0,d.VK)((()=>t.getType()),[t]),f=(0,d.VK)((()=>t.getConfigStore().getKeyStore("text")),[t]),S=(0,d.VK)((()=>f.getValue()),[f]),v=(0,l.useCallback)((e=>{b.createAndCommit({userAction:"BaseModalAction.handleTextChange",environment:n,perform:t=>{_.sO({store:f,value:e,transaction:t})}})}),[n,f]),h=t.getConfigStore().getKeyStore("continue_button").getKeyStore("text"),C=(0,d.VK)((()=>t.getConfigStore().getKeyStore("cancel_button").getKeyStore("text")),[t]);if(!g)return null;const A=(0,y.z)(g);return l.createElement(l.Fragment,null,l.createElement(ee,i()({},e,{title:l.createElement(m.FormattedMessage,A.display.name)})),r()("div",{style:u.wrap},void 0,r()(Ae.D,{disabled:o,value:S,onChange:v,multiline:!0,placeholder:a.formatMessage(ke.confirmationInputPlaceholder),disableFormattingAndMentions:!0,disableMobileActionBar:!0}),r()(xe,{overlayContent:l.createElement(m.FormattedMessage,ke.continueButtonHint)},void 0,r()(we.Y,{disabled:o,maxlength:p.OO,style:u.plainTextInput,store:h})),r()(xe,{overlayContent:l.createElement(m.FormattedMessage,ke.cancelButtonHint)},void 0,r()(we.Y,{disabled:o,maxlength:p.OO,style:u.plainTextInput,store:C}))))},slack_notification:()=>null};function ot(e){window.__c={n:"AutomationAction"};const{contextStore:t,buttonPlacement:o,actionStore:n,disabled:i,dragging:a,showErrorIfPresent:l,onActionAdded:c}=e,u=(0,s.yK)((e=>({container:{background:e.contentBackground,borderRadius:5,display:"flex",flexDirection:"column",gap:8,padding:8,marginLeft:12,marginRight:12,marginBottom:8,fontSize:14,boxShadow:a?e.mediumBoxShadow:e.lightBoxShadow,width:"calc(100% - 24px)"},nameRow:{display:"flex",alignItems:"center",marginBottom:4},name:{flexGrow:1,fontWeight:V.Z.fontWeight.medium,marginLeft:8},iconWrap:{width:24,height:24,display:"flex",alignItems:"center",borderRadius:4,background:"rgba(35, 131, 226, 0.14)"},icon:{width:14,height:14,fill:e.blueColor,margin:"0 auto"}})),[a]),[m,p]=(0,d.VK)((()=>n.hasConcern("display")?[n,n.getType()]:[void 0,void 0]),[n]);if(!n||!p)return null;const g=tt[p];return r()("div",{style:u.container},void 0,r()(g,{contextStore:t,actionStore:m,buttonPlacement:o,disabled:i,dragging:a,showErrorIfPresent:l,onActionAdded:c}))}var nt=o(79131),it=o(45452);function at(e){window.__c={n:"AutomationButtonActionList"};const{contextStore:t,buttonPlacement:o,disabled:n,suppressErrors:i,onActionAdded:a}=e,u=(0,c.O7)(),m=(0,d.VK)((()=>t.context.automationStore.getActionStores()),[t.context.automationStore]),f=(0,d.VK)((()=>m.map((e=>e.id))),[m]),y=(0,d.qz)(void 0,it.Z),S=(0,d.VK)((()=>y.state.isDragging),[y]),v=(0,d.VK)((()=>y.state.isDragging&&y.state.draggingKey),[y]),h=!n&&m.length<p.FT,C=(0,s.yK)((e=>({actionsLineWrap:{cursor:S?"grabbing":void 0,position:"relative"},actionLine:{position:"absolute",top:0,bottom:8,left:28,width:4,background:e.accentColors.gray[100],zIndex:1},actionsWrap:{position:"relative",zIndex:2}})),[S]);return l.createElement(l.Fragment,null,r()("div",{style:C.actionsLineWrap},void 0,r()("div",{style:C.actionLine}),r()("div",{style:C.actionsWrap},void 0,r()(nt.ZP,{direction:"vertical",disabled:n,keys:f,onDrop:e=>{b.createAndCommit({userAction:"AutomationButtonAction.moveAction",environment:u,perform:o=>{g.kM({clientContext:t.context,transaction:o,newActionIds:e})}})},renderKey:e=>{const l=m.find((t=>t.id===e));return l?r()(ot,{actionStore:l,contextStore:t,buttonPlacement:o,disabled:n,dragging:v===e,onActionAdded:a,showErrorIfPresent:Array.isArray(i)?!i.includes(l.id):!i},l.id):null},store:y}))),h&&r()(rt,{contextStore:t,disabled:n,onActionAdded:a}))}function rt(e){window.__c={n:"AddActionButton"};const{contextStore:t,disabled:o,onActionAdded:n}=e,a=(0,c.O7)(),{device:p}=a,[g,b]=(0,l.useState)(!0),f=(0,s.yK)((e=>({buttonWrap:{boxShadow:"initial",background:"transparent"},button:{color:e.mediumTextColor,fill:e.mediumIconColor},buttonIcon:{width:24,height:p.isMobile?18:16,marginRight:-2}})),[p.isMobile]),y=(0,d.qz)(void 0,Ze.Z),S=(0,U.d)(),v=(0,d.VK)((()=>t.context.automationStore.hasAnyActions()),[t.context.automationStore]);return(0,l.useEffect)((()=>{!v&&g&&(y.setState({open:!0}),b(!1))}),[y,v,g]),r()(z.ZP,{popupType:S,alignmentToOrigin:z.vR.Start,placementToOrigin:z.pO.Bottom,originGap:0,buttonPopupStore:y,disabled:o,renderOrigin:e=>l.createElement(k.Z,i()({focused:!1,style:f.buttonWrap,buttonStyle:f.button,icon:(0,u.R)(f.buttonIcon),title:r()(m.FormattedMessage,v?{id:"automations.addActionButton.nonEmpty.label",defaultMessage:"Add another step"}:{id:"automations.addActionButton.empty.label",defaultMessage:"Add a step"})},e)),render:e=>r()(Z,{contextStore:t,onActionAdded:t=>{n(t),e.close()}})})}},49446:(e,t,o)=>{o.r(t),o.d(t,{PlacedButtonBlockEditor:()=>q,buttonBlockMessages:()=>z});var n=o(23174),i=o.n(n),a=o(10434),r=o.n(a),l=o(67294),c=o(480),d=o(86628),s=o(24405),u=o(63362),m=o(65955),p=o(5366),g=o(97880),b=o(27153),f=o(9953),y=o(24677),S=o(98104),v=o(39699),h=o(10052),C=o(68709),A=o(42922),w=o(73063),k=o(53437),x=o(31278),M=o(53336),B=o(72495),P=o(26388),T=o(13148),Z=o(95094),E=o(82990),V=o(42402);const _="https://www.notion.so/help/template-buttons";function I(e){window.__c={n:"FactoryButtonMigrationBanner"};const{handleDismissBanner:t}=e,o=(0,s.yK)((e=>({banner:{width:"100%",display:"flex",alignItems:"start",backgroundColor:e.accentColors.blue["light"===e.mode?50:300],borderRadius:4,padding:12,fontSize:12,lineHeight:1.5,gap:8},icon:{width:12,color:e.blueColor},bannerContent:{flex:"1 1 auto"},bannerTitle:{fontWeight:E.Z.fontWeight.medium},bannerCaption:{color:e.mediumTextColor},closeButton:{borderRadius:"50%"},starIcon:{flex:"0 0 auto",marginBlockStart:3},link:{color:e.text.interactive}})),[]);return i()("div",{style:o.banner},void 0,i()("div",{style:o.starIcon},void 0,(0,Z.p)(o.icon)),i()("div",{style:o.bannerContent},void 0,i()("div",{style:o.bannerTitle},void 0,i()(p.FormattedMessage,{id:"factoryButton.deprecationBanner.title",defaultMessage:"Your buttons just got better"})),i()("div",{style:o.bannerCaption},void 0,i()(p.FormattedMessage,{id:"factoryButton.deprecationBanner.caption",defaultMessage:"Now you can create, edit and open pages and <buttonsHelpCenterLink>more</buttonsHelpCenterLink>.",values:{buttonsHelpCenterLink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i()(V.Z,{href:_,disableUnderline:!0,style:o.link},void 0,t)}}}))),i()(w.Z,{icon:T.U,ariaLabel:"closeButton",style:o.closeButton,onClick:()=>t()}))}var O=o(59557),K=o(72187),F=o(12534),L=o(33929),W=o(98742),D=o(29502),R=o(63474),H=o(34859),U=o(68910),Q=o(57559),N=o(82343);var G=o(77465);const z=(0,p.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You don’t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});function q(e){window.__c={n:"PlacedButtonBlockEditor"};const{buttonBlockStore:t}=e,o=(0,d.VK)((()=>t.state.editing?t.state:void 0),[t]),n=(0,s.yK)((e=>({popup:{width:400},editor:{background:e.sidebarBackground,..."inline"===(null==o?void 0:o.placement.type)?{marginTop:6,borderRadius:6,border:`1px solid ${e.regularDividerColor}`,maxWidth:600}:{}}})),[null==o?void 0:o.placement.type]),a=(0,D.d)({tabletBehavior:"slideUp"});return o?"popup"===o.placement.type?i()(k.ZP,{open:!0,popupType:a,render:()=>l.createElement(j,r()({},e,{style:n.editor})),originRect:o.placement.originRect,style:n.popup,originGap:4,onDismiss:()=>{t.stopEditing()}}):"inline"===o.placement.type?l.createElement(j,r()({},e,{style:n.editor})):void(0,g.t1)(o.placement):null}function j(e){window.__c={n:"ButtonBlockEditor"};const{disabled:t,store:o,buttonBlockStore:n}=e,a=(0,c.O7)(),g=a.currentUser.id,k=(0,p.useIntl)(),T=(0,s.yK)((e=>({header:{display:"flex",alignItems:"center",padding:"12px 12px 8px 12px",gap:6},scroller:{maxHeight:"75vh"},nameInputWrap:{flexGrow:"1"},factoryButtonDeprecationBanner:{margin:"12px 12px 6px 12px"}})),[]),Z=(0,R.D)(),E=(0,d.VK)((()=>o.getAutomationStore()),[o]),V=(0,d.VK)((()=>null==E?void 0:E.getNameStore()),[E]),_=(0,d.VK)((()=>null==E?void 0:E.getIconStore()),[E]),D=(0,d.VK)((()=>(null==V?void 0:V.getValue())??""),[V]),q=function(e){const{store:t,automationStore:o}=e,n=(0,c.O7)().currentUser.id;return(0,d.VK)((()=>{const e=t.getRecordStoreUIRoot();if(o&&e instanceof Q.G)return(0,N.Gb)({type:"button_block",persisted:!0,automationStore:o,blockStore:t,pageStore:e,intl:L.default.getIntl(),parentRecordStore:o,currentUserId:n})}),[o,t,n])}({store:o,automationStore:E}),j=(0,d.VK)((()=>{var e;return o.canEdit()&&"sufficient"===(null==q||null===(e=q.state)||void 0===e?void 0:e.executionPermissionStatus)}),[o,q]),{showFactoryButtonDeprecationBanner:Y,handleDismissFactoryButtonMigrationBanner:$}=(0,O.N)({blockStore:o}),X=(0,d.VK)((()=>null==_?void 0:_.getValue()),[_]),J=(0,d.VK)((()=>{const e=o.getRecordStoreUIRoot();if(e instanceof Q.G)return e}),[o]),ee=(0,d.VK)((()=>n.state.editing?n.state.placement:void 0),[n]),te=(0,l.useMemo)((()=>{if(E&&J)return new U.L({type:"button_block",persisted:!0,automationStore:E,blockStore:o,pageStore:J,intl:L.default.getIntl(),parentRecordStore:E,currentUserId:g})}),[E,J,o,g]),oe=(0,l.useCallback)((e=>{(0,F.ZP)({event:e,context:F.Af.EditorClick,callback:()=>{S.ZH(a),y.ZH(a)}})}),[a]),ne=(0,l.useCallback)((()=>{n.stopEditing(),(0,u.lN)(Z,{block_id:o.id,automation_id:null==E?void 0:E.id})}),[E,n,o,Z]),ie=(0,l.useCallback)(((e,t)=>{E&&v.createAndCommit({userAction:"ButtonBlock.updateProperty",environment:a,perform:o=>{f.sW({store:E.getPropertiesStore(),transaction:o,data:{[e]:t??null}})}})}),[E,a]),ae=(0,l.useCallback)((e=>ie("icon",e)),[ie]),re=(0,l.useCallback)((e=>ie("name",e)),[ie]),le=(0,l.useCallback)((e=>{b.$(a,{originRect:e.currentTarget.getBoundingClientRect(),originGap:4,popupWidth:K.FZ,popupHeight:K.kX,isSmallWidth:!1,title:k.formatMessage({defaultMessage:"Icon",id:"buttonBlock.button.iconHeading"}),currentTab:"icon",tabs:[{type:"icon",onChange:e=>{ae(e),b.Z()}},{type:"emoji",onChange:(e,t)=>{ae(e),b.Z()}}],onDelete:()=>{ae(void 0),b.Z()}})}),[a,ae,k]),ce=(0,d.VK)((()=>n.state.suppressErrorsForActionIds),[n]),de=t||!j;if(!te)return null;const se=e=>l.createElement(w.Z,r()({ariaLabel:k.formatMessage(z.addIconButtonAriaLabel),style:{width:26,height:26},iconStyle:{width:16,height:16},hasBackground:!0,disabled:de,showShadow:!0,icon:e=>X?i()(x.Z,{disabled:!0,isEmptyPage:!1,size:24,icon:{icon:X,pointer:o.pointer},style:e}):(0,m.o)(e)},(0,W.Z)(e??{},{onClick:le}))),ue=X?se():i()(P.Z,{renderTooltip:()=>i()(p.FormattedMessage,{defaultMessage:"Add an icon",id:"buttonBlock.button.addIcon"}),delayThreshold:300,render:se});return i()("div",{style:e.style,onClick:oe},void 0,Y&&i()("div",{style:T.factoryButtonDeprecationBanner},void 0,i()(I,{handleDismissBanner:$})),i()(C.p,{allowSelectionWithin:!0,style:T.header},void 0,ue,i()(h.b,{onChange:re,value:D,disabled:de,placeholder:L.default.formatMessage(z.buttonPlaceholder),wrapStyle:T.nameInputWrap}),i()(A.Z,{onClick:ne},void 0,i()(p.FormattedMessage,{defaultMessage:"Done",id:"buttonBlock.button.done"}))),i()(M.Z,{style:T.scroller,type:H.Z.Y},void 0,i()(B.Z,{mobileStyle:{boxShadow:"initial"},mobileTitleStyle:{textTransform:"none",marginTop:8},title:i()(p.FormattedMessage,{id:"buttonBlock.actions",defaultMessage:"When button is clicked"})},void 0,i()(G.AutomationButtonActionList,{contextStore:te,buttonPlacement:ee,disabled:de,suppressErrors:ce,onActionAdded:e=>{n.suppressErrorsForAction(e)}}),i()("div",{}))))}},69872:(e,t,o)=>{o.d(t,{L:()=>g,Z:()=>f});var n=o(10434),i=o.n(n),a=o(23174),r=o.n(a),l=o(67294),c=o(83355),d=o(39068),s=o(52821),u=o(87279),m=o(52275),p=o(28992);let g=function(e){return e[e.Name=0]="Name",e[e.Type=1]="Type",e}({});class b extends c.Z{renderComponent(){const{name:e,type:t,icon:o}=this.props.propertySchema,n=this.props.format===g.Name?e:s.SO[t],{theme:a}=this;return this.props.locked?l.createElement(p.Z,i()({title:n,icon:r()(d.ZP,{icon:o,type:t,size:this.environment.device.isMobile?18:16,theme:a,style:{fill:a.regularIconColor}})},this.props)):l.createElement(m.Z,i()({title:n,icon:r()(d.ZP,{icon:o,type:t,size:this.environment.device.isMobile?18:16,theme:a,style:{fill:a.regularIconColor,marginLeft:6,marginRight:2}})},this.props))}}b.displayName="PropertyMenuItem",b.DisplayFormat=g,b.contextTypes={...u.mw,...c.w};const f=b},10052:(e,t,o)=>{o.d(t,{Y:()=>y,b:()=>f});var n=o(23174),i=o.n(n),a=o(10434),r=o.n(a),l=o(67294),c=o(480),d=o(86628),s=o(9953),u=o(98104),m=o(39699),p=o(21199),g=o(1743),b=o(74194);function f(e){window.__c={n:"AutomationPlainTextInput"};const{value:t,onChange:o,wrapStyle:n,...a}=e,[c,d]=(0,l.useState)(!1);return i()(g.Z,{capture:c},void 0,i()(p.Z,{capture:!0,render:e=>l.createElement("div",r()({},e,{style:n}),l.createElement(b.Z,r()({value:t,onChange:e=>o(e.currentTarget.value),onBlur:()=>{d(!1)},onFocus:()=>{u.o9(),d(!0)}},a)))}))}function y(e){window.__c={n:"ConnectedAutomationPlainTextInput"};const{store:t,...o}=e,n=(0,c.O7)(),i=(0,d.VK)((()=>t.getValue()??""),[t]),a=(0,l.useCallback)((e=>{m.createAndCommit({userAction:"AutomationPlainTextInput.setValue",environment:n,perform:o=>{s.sO({store:t,transaction:o,value:e})}})}),[n,t]);return l.createElement(f,r()({value:i,onChange:a},o))}},24457:(e,t,o)=>{o.d(t,{F:()=>l,U:()=>r});var n=o(480),i=o(86628),a=o(87279);function r(e){return e.device.isPhone||"actionSheet"===e.tabletBehavior&&e.device.isTablet?{menuType:a.og.ActionSheet}:{menuType:a.og.Popup,maxHeight:e.maxHeight,maxWidth:e.maxWidth,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,width:e.width,minWidth:e.minWidth}}function l(e){const t=(0,n.Fy)();return(0,i.VK)((()=>r({device:t,maxHeight:null==e?void 0:e.maxHeight,maxWidth:null==e?void 0:e.maxWidth,paddingTop:null==e?void 0:e.paddingTop,paddingBottom:null==e?void 0:e.paddingBottom,width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,tabletBehavior:null==e?void 0:e.tabletBehavior})),[t,null==e?void 0:e.maxHeight,null==e?void 0:e.maxWidth,null==e?void 0:e.paddingTop,null==e?void 0:e.paddingBottom,null==e?void 0:e.width,null==e?void 0:e.minWidth,null==e?void 0:e.tabletBehavior])}},40745:(e,t,o)=>{o.d(t,{M:()=>a});var n=o(23174),i=o.n(n);o(67294);const a=(0,o(45238).I)("arrowDown",{viewBox:"0 0 16 16",svg:i()("path",{d:"M8 1.57715C7.5625 1.57715 7.25488 1.88477 7.25488 2.33594V10.8262L7.30957 12.3027L5.50488 10.2861L3.95312 8.75488C3.82324 8.625 3.63184 8.53613 3.42676 8.53613C3.0166 8.53613 2.70898 8.85059 2.70898 9.26758C2.70898 9.46582 2.78418 9.64355 2.94141 9.80762L7.44629 14.3193C7.59668 14.4697 7.79492 14.5586 8 14.5586C8.20508 14.5586 8.40332 14.4697 8.55371 14.3193L13.0586 9.80762C13.2158 9.64355 13.291 9.46582 13.291 9.26758C13.291 8.85059 12.9902 8.53613 12.5801 8.53613C12.3682 8.53613 12.1836 8.625 12.0469 8.75488L10.4951 10.2861L8.69043 12.2959L8.74512 10.8262V2.33594C8.74512 1.88477 8.44434 1.57715 8 1.57715Z"})})},8597:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(23174),i=o.n(n);o(67294);const a=(0,o(45238).I)("arrowUp",{viewBox:"0 0 16 16",svg:i()("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},1230:(e,t,o)=>{o.d(t,{H:()=>a});var n=o(23174),i=o.n(n);o(67294);const a=(0,o(45238).I)("insertDown",{viewBox:"0 0 16 16",svg:i()("path",{d:"M9.55548 13.0343H14.2085C14.5315 13.0343 14.7951 13.2913 14.7951 13.6142C14.7951 13.9372 14.5315 14.1942 14.2085 14.1942H9.55548C9.23254 14.1942 8.9755 13.9372 8.9755 13.6142C8.9755 13.2913 9.23254 13.0343 9.55548 13.0343ZM1.21167 9.67959C1.21167 9.09961 1.52802 8.74371 2.0421 8.74371C2.55617 8.74371 2.87911 9.11279 2.87911 9.65982V10.7868C2.87911 10.945 2.96479 11.0373 3.12956 11.0373H4.70473V10.365C4.70473 9.818 5.26494 9.60709 5.68675 9.94322L7.56509 11.4525C7.84849 11.6766 7.84849 12.0786 7.56509 12.2961L5.68675 13.812C5.25176 14.1679 4.70473 13.9569 4.70473 13.3836V12.7047H2.93184C1.89051 12.7047 1.21167 12.0984 1.21167 11.057V9.67959ZM9.55548 9.58073H14.2085C14.5315 9.58073 14.7951 9.83777 14.7951 10.1607C14.7951 10.4837 14.5315 10.7407 14.2085 10.7407H9.55548C9.23254 10.7407 8.9755 10.4837 8.9755 10.1607C8.9755 9.83777 9.23254 9.58073 9.55548 9.58073ZM1.78506 6.12721H14.2085C14.5315 6.12721 14.7951 6.38425 14.7951 6.70719C14.7951 7.03014 14.5315 7.28717 14.2085 7.28717H1.78506C1.46211 7.28717 1.20508 7.03014 1.20508 6.70719C1.20508 6.38425 1.46211 6.12721 1.78506 6.12721ZM1.78506 2.68028H14.2085C14.5315 2.68028 14.7951 2.93073 14.7951 3.25367C14.7951 3.5832 14.5315 3.83365 14.2085 3.83365H1.78506C1.46211 3.83365 1.20508 3.5832 1.20508 3.25367C1.20508 2.93073 1.46211 2.68028 1.78506 2.68028Z"})})},95094:(e,t,o)=>{o.d(t,{p:()=>a});var n=o(23174),i=o.n(n);o(67294);const a=(0,o(45238).I)("starFilled",{viewBox:"0 0 24 24",svg:i()("path",{d:"M4.603 22.837c.375.277.826.2 1.4-.22l6.002-4.411 6.003 4.41c.561.42 1.024.498 1.387.221.375-.276.463-.73.232-1.403l-2.346-7.075 6.047-4.366c.572-.41.77-.83.627-1.271-.143-.432-.55-.653-1.255-.653l-7.424.045-2.269-7.108C12.787.32 12.457 0 12.005 0c-.463 0-.782.32-1.002 1.006l-2.27 7.108-7.423-.045c-.716 0-1.123.221-1.266.653-.144.442.066.862.638 1.27l6.036 4.367-2.335 7.075c-.231.674-.143 1.127.22 1.403z"})})}}]);