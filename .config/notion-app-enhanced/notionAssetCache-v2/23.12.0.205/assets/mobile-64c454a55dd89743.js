"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5008],{54428:(e,t,i)=>{i.r(t),i.d(t,{default:()=>v});var o=i(23174),n=i.n(o),s=i(67294),r=i(83355),a=i(35840),l=i(5366),c=i(24677),d=i(98104),u=i(33846),h=i(37601),m=i(21199),p=i(1743),g=i(74194);class b extends r.Z{constructor(){super(...arguments),this.storeTypes={store:u.Z},this.handleFocused=()=>{c.ZH(this.environment),d.ZH(this.environment),this.stores.store.setState({...this.stores.store.state,focus:!0})},this.handleBlurred=()=>{this.stores.store.setState({...this.stores.store.state,focus:!1})},this.handleSearchQueryChange=e=>{this.props.onChange({searchQuery:e.target.value})}}renderComponent(){const{searchQuery:e,intl:t}=this.props,{focus:i}=this.stores.store.state;return n()(p.Z,{capture:i},void 0,n()(m.Z,{capture:!0,render:o=>s.createElement("div",o,n()(g.Z,{style:this.getStyle(),format:g.B.Transparent,value:e,placeholder:t.formatMessage({defaultMessage:"Type to searchâ€¦",id:"database.mobileSearch.placeholder"}),onChange:this.handleSearchQueryChange,autoComplete:"on",autoCorrect:"on",onFocus:this.handleFocused,onBlur:this.handleBlurred,showClearButton:!0,left:(0,a.R)(this.getSearchIconStyle())}),n()(h.Z,{show:i}))}))}getStyle(){return{boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,flexGrow:0,flexShrink:0,height:32,paddingLeft:8,paddingRight:12,borderRadius:3,fontSize:14,marginBottom:4}}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:this.theme.mediumIconColor}}}b.displayName="CollectionMobileSearch";const v=(0,l.injectIntl)(b)},75498:(e,t,i)=>{i.d(t,{Z:()=>u});var o=i(83355),n=i(1302),s=i(49085),r=i(72126),a=i(71644),l=i(97880),c=i(76427);class d extends o.Z{constructor(){super(...arguments),this.reducerId=this.props.id,this.instanceId=(0,a.ZP)(),this.localResultStoreChangeIsQueued=!1,this.storeTypes={resultStore:s.default.createClass(void 0)},this.handleLocalResultStoreChange=()=>{this.localResultStoreChangeIsQueued||(this.localResultStoreChangeIsQueued=!0,n.default.afterNextFlush(this.dequeueLocalResultStoreChange))},this.dequeueLocalResultStoreChange=()=>{const{resultStore:e}=this.stores;if(this.localResultStoreChangeIsQueued=!1,!this.componentIsMounted)return;const t=this.getCurrentResult();r.Xy(t,e.state)||e.setState(t)}}willMount(e){const{collectionContextStore:t}=e;t.remoteResult.addListener(this.handleLocalResultStoreChange),t.localResultStore.addListener(this.handleLocalResultStoreChange),this.updateReducer(e),this.handleLocalResultStoreChange()}willUpdate(e){this.updateReducer(e)}willUnmount(){super.willUnmount();const{collectionContextStore:e,groupsPointer:t}=this.props;c.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:void 0,collectionContextStore:e,groupsPointer:t}),e.remoteResult.removeListener(this.handleLocalResultStoreChange),e.localResultStore.removeListener(this.handleLocalResultStoreChange)}renderComponent(){const{render:e}=this.props;if(e)return e(this.stores.resultStore)}updateReducer(e){const{reducer:t,collectionContextStore:i,groupsPointer:o}=e;c.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:t,collectionContextStore:i,groupsPointer:o})}getCurrentResult(){const{collectionContextStore:e}=this.props,t=e.localResultStore.state,i=e.remoteResult.state,o=t&&"reducer"===t.type?t.reducerResults[this.reducerId]:void 0,n=i&&"reducer"===i.type?i.reducerResults[this.reducerId]:void 0;return this.getResultFromLocalAndRemote(o,n)}getResultFromLocalAndRemote(e,t){const{collectionContextStore:i,reducer:o}=this.props,n=i.reducers.state,s=i.remoteResult.state;if(i.isClientModeEnabled.state)return e;if("aggregation"===o.type||"groups"===o.type){if(null!=s&&s.reducerResults[this.reducerId])return s.reducerResults[this.reducerId];return Boolean(s&&"reducer"===s.type&&r.sE(s.reducerResults,((e,t)=>{const i=n[t];return Boolean(i&&"results"===i.reducer.type&&!i.reducer.searchQuery&&"results"===e.type&&e.hasMore&&r.Xy(o.filter,i.reducer.filter))})))?e:t}if("results"===o.type){const o=i.wasCreatedThisSession.state;if((Boolean(s&&"reducer"===s.type&&s.reducerResults[this.reducerId])||o)&&e&&"results"===e.type){return{...e,hasMore:t&&"results"===t.type?t.hasMore:e.hasMore}}return t}throw(0,l.t1)(o)}}d.displayName="CollectionReducerRequest";const u=d},78948:(e,t,i)=>{i.d(t,{Z:()=>c});var o=i(23174),n=i.n(o),s=(i(67294),i(83355)),r=i(68785),a=i(28992);class l extends s.Z{renderComponent(){return n()(a.Z,{title:n()(r.Z,{})})}}l.displayName="LoadingMenuItem";const c=l},28385:(e,t,i)=>{i.d(t,{Z:()=>T});var o=i(10434),n=i.n(o),s=i(23174),r=i.n(s),a=i(67294),l=i(83355);const c=(0,i(45238).I)("teamSize",{viewBox:"0 0 20 20",svg:r()("path",{d:"M7.333 14.667a4.667 4.667 0 1 0 0-9.334 4.667 4.667 0 0 0 0 9.334zm4.356-.548A5.977 5.977 0 0 1 7.333 16a5.977 5.977 0 0 1-4.355-1.881A7.295 7.295 0 0 0 0 20h14.667a7.296 7.296 0 0 0-2.978-5.881zm1.599-4.832a4.664 4.664 0 1 0-5.242-5.241 6.01 6.01 0 0 1 5.242 5.241zm.003 1.347a6.024 6.024 0 0 1-.794 2.414 8.571 8.571 0 0 1 1.656 1.619H20a7.296 7.296 0 0 0-2.978-5.882 5.983 5.983 0 0 1-3.731 1.849z"})});var d=i(5366),u=i(75018),h=i(87279),m=i(8323),p=i(88632),g=i(53610),b=i(64921),v=i(31945),S=i(78140),f=i(64369),y=i(27386),C=i(14694),M=i(58705);class k extends l.Z{constructor(){super(...arguments),this.handleClose=()=>{const{mobileNative:e}=this.environment,t=()=>{g.Z.setState({open:!1})};null!=e&&e.supportsNativeHomeOnPhone()?u.navigateToHomeTab(this.environment,t):t()}}renderComponent(){const{store:e}=this.props;if(!(0,m.Mk)()||!e.isDefined())return;const{mobileNative:t}=this.environment,i=(null==t?void 0:t.supportsNativeHomeOnPhone())||!1;return r()(v.ZP,{buttonPopupStore:g.Z,popupType:v.Z4.SlideUp,hidesMobileNativeBottomBar:i,preventSlideUpTransition:i,renderOrigin:e=>a.createElement(b.Z,n()({mobileFeedback:!0},e),r()(C.Z,{left:this.renderIcon(),disableMobileBorder:!0},void 0,r()(d.FormattedMessage,{defaultMessage:"Members",id:"memberSettingsButton.mobileSidebar.label"}))),render:()=>{if(p.Z.state.online){const t={menuType:h.og.Modal,title:r()(d.FormattedMessage,{defaultMessage:"Members",id:"memberSettingsButton.mobileMemberSettings.title"}),right:r()(d.FormattedMessage,{defaultMessage:"Done",id:"memberSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose,onCancel:this.handleClose};return a.createElement(S.Z,t,r()(M.Z,{store:e,isMobile:!0}))}this.renderOffline()}})}renderIcon(){return c({fill:this.theme.mediumIconColor,width:16})}renderOffline(){return r()(y.Z,{},void 0,r()(f.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,r()(d.FormattedMessage,{defaultMessage:"Please go online to manage members.",id:"memberSettingsButton.goOnline.prompt"})))}}k.displayName="MemberSettingsButton";const T=k},14862:(e,t,i)=>{i.r(t),i.d(t,{default:()=>J});var o=i(10434),n=i.n(o),s=i(23174),r=i.n(s),a=i(67294),l=i(83355),c=i(13991),d=i(41432),u=i(42853),h=i(69634),m=i(45238);const p=(0,m.I)("image",{viewBox:"0 0 30 30",svg:r()("path",{d:"M2,2v26h26V2H2z M26,26H4v-4h22V26z M26,20H4V4h22V20z M8,10c1.104,0,2-0.896,2-2S9.104,6,8,6S6,6.896,6,8S6.896,10,8,10z M18,7l-5,5l-2-1l-5,7h18L18,7z M11.635,13.553l1.76,0.881l4.129-4.129L20.631,16H9.887L11.635,13.553z"})}),g=(0,m.I)("indentDown",{viewBox:"0 0 30 30",svg:r()("path",{d:"M24,15l-1.406-1.406L16,20.188V2h-2v18.188l-6.594-6.594L6,15l9,9L24,15z M2,26v2h26v-2H2z"})}),b=(0,m.I)("keyboard",{viewBox:"0 0 30 30",svg:r()("g",{},void 0," ",r()("path",{d:"M15,30l8-10H7Zm0-3.2L11.16,22h7.68Z"})," ",r()("path",{d:"M6,4H4V6H6V4Zm4,0H8V6h2V4Zm4,0H12V6h2V4Zm4,0H16V6h2V4Zm4,0H20V6h2V4Zm4,0H24V6h2V4ZM10,8H8v2h2V8Zm4,0H12v2h2V8Zm4,0H16v2h2V8Zm4,0H20v2h2V8Zm-2,4H10v2H20V12Zm5,0H22v2h3V12ZM5,14H8V12H5v2ZM0,0V18H30V0H0ZM28,16H2V2H28V16Z"})," ")}),v=(0,m.I)("moveUp",{viewBox:"0 0 30 30",svg:r()("path",{d:"M14,5.813V24h2V5.813l6.594,6.594L24,11l-9-9l-9,9l1.406,1.406L14,5.813z M2,26v2h26v-2H2z"})});var S=i(38491),f=i(45137),y=i(73426);const C=(0,m.I)("thinPlus",{viewBox:"0 0 14 14",svg:r()("path",{d:"M 7.75 0L 6.25 0L 6.25 6.25L 0 6.25L 0 7.75L 6.25 7.75L 6.25 14L 7.75 14L 7.75 7.75L 14 7.75L 14 6.25L 7.75 6.25L 7.75 0Z"})});var M=i(37612),k=i(55863),T=i(72126),A=i(82990),I=i(5366),B=i(50906),w=i(44886),x=i(55332),P=i(24677),Z=i(98104),R=i(51783),F=i(52533),N=i(68056),O=i(56171),_=i(5162),L=i(17903),V=i(72653),U=i(69454),D=i(27724),E=i(24666),H=i(64921),q=i(1892),W=i(53437),z=i(64131),G=i(82945),j=i(90108),K=i(40464),Q=i(32404),$=i(73383);class Y extends l.Z{constructor(){super(...arguments),this.scrollerDiv=void 0,this.currentlyShownTimer=void 0,this.previouslyShownOnNative=!1,this.handleScrollerRef=e=>{e&&(this.scrollerDiv=e)},this.handleUnindent=e=>{R.$$(this.environment)},this.handleIndent=e=>{R.O2(this.environment)},this.handleMoveUp=e=>{R.s0(this.environment)},this.handleMoveDown=e=>{R.rZ(this.environment)},this.handleUndo=()=>{R.i2(this.environment)},this.handleRedo=()=>{R.GH(this.environment)},this.handleDismissKeyboard=e=>{P.ZH(this.environment),this.props.stores.store.setState({...this.props.stores.store.state,isInsertOpen:!1}),this.trackItemTap("hide_keyboard"),Z.sD()},this.handleInsert=e=>{this.props.stores.store.setState({...this.props.stores.store.state,isInsertOpen:!0}),this.trackItemTap("insert")},this.handleTakePicture=e=>{R.vs(this.environment)},this.handleMention=e=>{R.Z3(this.environment)},this.handleComment=e=>{R.ol(this.environment,!1,"mobile_action_bar")},this.handleDelete=e=>{R.fn(this.environment)},this.handleActionsScroll=()=>{B.FGU(this.environment)},this.handleActionsScrollDebounced=T.Ds(this.handleActionsScroll,500),this.handleMoreClick=e=>{R.w1(this.environment,e.clientX,e.clientY)},this.listenForPositionChanges=this.createComputedStore((()=>{const e=E.default.state;if("editing"===e.mode){const t=e.multiSelection.end;return{scrollTop:L.Z.state.scrollTop,editing:!0,store:t.store.id,selection:t}}return{scrollTop:L.Z.state.scrollTop,editing:!1}})),this.renderStore=this.createComputedStore((()=>{var e;return R.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)})),this.shouldShowTextActions=this.createComputedStore((()=>R.oQ(this.props.stores.ignoreSelectionAreaStore,this.environment.TextSelectionCompositionStore))),this.canTriggerBlockActions=this.createComputedStore((()=>!this.shouldShowTextActions.state&&R.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state))),this.canTriggerTextActions=this.createComputedStore((()=>R.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore))),this.hasMultiBlockSelection=this.createComputedStore((()=>{const e=E.default.state;return"editing"===e.mode&&!(0,N.qS)(e.multiSelection)}))}willMountOrUpdate(){const{device:e}=this.environment,t=this.renderStore.state.shouldShow;if(e.isMobileBrowser){const e=this.props.stores.store.state.isOpen;t?e?void 0!==this.currentlyShownTimer&&(window.clearTimeout(this.currentlyShownTimer),this.currentlyShownTimer=void 0):(this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!0}),this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0)):e&&void 0===this.currentlyShownTimer&&(this.currentlyShownTimer=window.setTimeout((()=>{this.currentlyShownTimer=void 0,this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!1})}),200))}else t!==this.previouslyShownOnNative&&(this.previouslyShownOnNative=t,this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=this.isOpen(),o=e.isMobile&&V.Z.state;if(this.props.position===F.nd.Bottom){let e=0;return(0,_.Y)("supportsFixedSizeWebView")?e=U.Z.estimatedNativeWebBottomOverlap():o&&(e=t.getSafePaddingBottomCSS(j.default.height)),r()("div",{style:{position:"absolute",bottom:e,left:0,height:Y.height,width:"100%",pointerEvents:i?"auto":"none",opacity:i?1:0,transform:i?"translateY(0)":`translateY(${Y.height}px)`,transition:"opacity 120ms ease-out, transform 120ms ease-out"}},void 0,this.renderActionButtons())}{this.listenForPositionChanges.state;const e=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionRect||O.getSelectionRect();if(!e)return;const t=document.body.getBoundingClientRect(),o={...e,left:10,top:e.top+10-t.top},{device:n}=this.environment;return r()(W.ZP,{popupType:n.isMobileNative?W.ZP.PopupType.SlideUp:W.ZP.PopupType.Popup,open:i,preventBlockRenderQueueOnEnter:!0,placementToOrigin:W.ZP.Placement.Bottom,alignmentToOrigin:W.ZP.Alignment.Start,originRect:o,disableMouseCapture:!0,keepFocus:!0,render:()=>r()("div",{style:{height:Y.height,width:"calc(80wv)",borderRadius:3,overflow:"hidden"}},void 0,this.renderActionButtons())})}}renderActions(){return R.Tz({environment:this.environment,store:this.props.currentBlockStore})?this.renderTemplatesButton():this.shouldShowTextActions.state?this.renderTextActions():this.renderBlockActions()}renderActionButtons(){return r()("div",{style:this.getActionButtonStyles()},void 0,this.renderActions(),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),borderLeft:this.getItemBorder(),borderRight:"none"},onClick:this.handleDismissKeyboard},void 0,Y.keyboardIcon))}renderBlockActions(){const e=this.canTriggerBlockActions.state;let t=!1,i=!1;const o=this.props.currentBlockStore.getType();if(o){const e=this.props.currentBlockStore.getFormat();(0,d._T)(o,e)||(t=!0),(0,d.lQ)(o)||(i=!0)}const{device:s}=this.environment;return a.createElement("div",{ref:this.handleScrollerRef,style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),...!s.isSmallPhone&&{paddingLeft:12,paddingRight:12}},onClick:this.handleInsert,disabled:!e},void 0,Y.plusIcon,this.renderChevronDown()),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),fontWeight:A.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isTurnIntoOpen:!0}),this.trackItemTap("turn_into")},disabled:!e},void 0,r()(I.FormattedMessage,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.buttonTitle"}),this.renderChevronDown()),r()(q.Z,{capture:!0,render:e=>a.createElement(H.Z,n()({mobileFeedback:!0,disabledFeedback:!0},e,{style:this.getItemStyle(),onClick:this.handleMention,disabled:!i}),r()("span",{style:{fontSize:19,lineHeight:1,fontWeight:A.Z.fontWeight.medium,marginBottom:s.isAndroid?4:0}},void 0,"@"))}),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleComment,disabled:!t},void 0,Y.discussionIcon),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleTakePicture,disabled:!e},void 0,Y.imageIcon),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleDelete,disabled:!e},void 0,Y.trashIcon),this.renderBlockMovementActions(),this.renderBlockUndoActions(),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),fontWeight:A.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isColorOpen:!0}),this.trackItemTap("color")},disabled:!e},void 0,r()(I.FormattedMessage,{defaultMessage:"Color",id:"mobileActionBar.color.buttonTitle"}),this.renderChevronDown()),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),fontWeight:A.Z.fontWeight.medium},onClick:this.handleMoreClick,disabled:!e},void 0,r()(I.FormattedMessage,{defaultMessage:"More",id:"mobileActionBar.more.buttonTitle"}),this.renderChevronDown()))}renderBlockMovementActions(){const e=this.canTriggerBlockActions.state,t=D.default.state.stores[0];return r()("div",{style:{...this.getItemStyle(),paddingLeft:6,paddingRight:6}},void 0,r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y.minorItemStyle,disabled:!e||!w.gq(t),onClick:this.handleUnindent},void 0,Y.unindentIcon),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y.minorItemStyle,disabled:!e||!w.nt(t),onClick:this.handleIndent},void 0,Y.indentIcon),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y.minorItemStyle,disabled:!e,onClick:this.handleMoveUp},void 0,Y.moveUpIcon),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y.minorItemStyle,disabled:!e,onClick:this.handleMoveDown},void 0,Y.moveDownIcon))}renderBlockUndoActions(){return r()("div",{style:{...this.getItemStyle(),paddingLeft:6,paddingRight:6}},void 0,r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y.minorItemStyle,disabled:!x.L0(),onClick:this.handleUndo},void 0,Y.undoIcon),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y.minorItemStyle,disabled:!x.AZ(),onClick:this.handleRedo},void 0,Y.redoIcon))}renderTextActions(){const e=this.canTriggerTextActions.state,t=this.hasMultiBlockSelection.state,i=this.props.currentBlockStore.canComment(),o=D.default.state.stores[0],n={display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap"};return r()("div",{style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},void 0,r()(G.Z,{style:this.getItemStyle(),blockStore:D.default.state.stores[0],disabled:!i}),r()(K.Z,{type:"b",style:this.getItemStyle(),onClick:()=>this.trackItemTap("bold"),disabled:!e},void 0,r()("span",{style:{fontWeight:A.Z.fontWeight.semibold}},void 0,r()(I.FormattedMessage,{defaultMessage:"B",id:"mobileActionBar.bold.symbol"}))),r()(K.Z,{type:"i",style:this.getItemStyle(),onClick:()=>this.trackItemTap("italic"),disabled:!e},void 0,r()("span",{style:{fontStyle:"italic",fontWeight:A.Z.fontWeight.semibold}},void 0,r()(I.FormattedMessage,{defaultMessage:"i",id:"mobileActionBar.italic.symbol"}))),r()(K.Z,{type:"_",style:this.getItemStyle(),onClick:()=>this.trackItemTap("underline"),disabled:!e},void 0,r()("span",{style:{textDecoration:"underline"}},void 0,r()(I.FormattedMessage,{defaultMessage:"U",id:"mobileActionBar.underline.symbol"}))),r()(K.Z,{type:"s",style:this.getItemStyle(),onClick:()=>this.trackItemTap("strike_through"),disabled:!e},void 0,r()("span",{style:{textDecoration:"line-through"}},void 0,r()(I.FormattedMessage,{defaultMessage:"S",id:"mobileActionBar.strikeThrough.symbol"}))),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:n,disabled:!w.gq(o),onClick:this.handleUnindent},void 0,Y.unindentIcon),r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...n,borderRight:this.getItemBorder()},disabled:!w.nt(o),onClick:this.handleIndent},void 0,Y.indentIcon),r()(K.Z,{type:"c",style:this.getItemStyle(),onClick:()=>this.trackItemTap("code"),disabled:!e},void 0,r()("span",{style:{fontFamily:A.Z.getCompositeFontFamily(c.SP).githubMono}},void 0,r()(I.FormattedMessage,{defaultMessage:"Code",id:"mobileActionBar.code.symbol"}))),r()($.Z,{style:this.getItemStyle(),disabled:!e||t},void 0,r()("span",{style:{borderBottom:`1px solid ${this.theme.linkDecorationColor}`}},void 0,r()(I.FormattedMessage,{defaultMessage:"Link",id:"mobileActionBar.link.symbol"}))),r()(Q.Z,{onClick:()=>this.trackItemTap("equation"),disabled:!e||t,style:this.getItemStyle()},void 0,(0,h.G)({width:16,height:16})),r()(z.Z,{style:this.getItemStyle(),ignoreSelectionAreaStore:this.props.stores.ignoreSelectionAreaStore,disabled:!e}))}renderTemplatesButton(){return r()("div",{style:this.getActionMenuStyle()},void 0,r()(H.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),borderRight:"none",fontWeight:A.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isTemplatesOpen:!0}),this.trackItemTap("templates")}},void 0,(0,y.i)({width:20,marginRight:8}),r()(I.FormattedMessage,{defaultMessage:"Choose a template...",id:"mobileActionBar.templates.buttonTitle"}),this.renderChevronDown()))}renderChevronDown(){return(0,u.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.props.stores.store.state.isOpen:this.renderStore.state.shouldShow}trackItemTap(e){B.YOV(this.environment,{itemName:e})}getItemBorder(){return`1px solid ${this.theme.regularDividerColor}`}getActionButtonStyles(){const{device:e,WindowSizeStore:t}=this.environment;return{height:"100%",width:"100%",fontSize:15,display:"flex",boxShadow:this.props.position===F.nd.Bottom?this.theme.bottomActionBarShadow:this.theme.mediumBoxShadow,backgroundColor:this.theme.keyboardActionBarBackground,paddingLeft:e.isMobileNative?t.state.paddingLeftCSS:0,paddingRight:e.isMobileNative?t.state.paddingRightCSS:0}}getActionMenuStyle(){return{flexGrow:1,flexShrink:1,marginRight:-1,display:"flex",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"}}getItemStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:e.isSmallPhone?8:10,paddingRight:e.isSmallPhone?8:10,borderRight:this.getItemBorder(),whiteSpace:"nowrap",height:Y.height,flexShrink:0,flexGrow:0,flexBasis:"auto",color:this.theme.regularTextColor,minWidth:e.isSmallPhone?42:44}}}Y.displayName="MobileActionBar",Y.unindentIcon=g({width:18,height:18,transform:"rotate(90deg)",position:"relative",left:1}),Y.indentIcon=g({width:18,height:18,transform:"rotate(-90deg)",position:"relative",left:-1}),Y.moveUpIcon=v({width:18,height:18,position:"relative",left:2}),Y.moveDownIcon=v({width:18,height:18,transform:"rotate(180deg)",position:"relative",left:2}),Y.undoIcon=(0,k.s)({width:19,height:19}),Y.redoIcon=(0,S.N)({width:19,height:19}),Y.trashIcon=(0,M.y)({width:18,height:18}),Y.discussionIcon=(0,f.o)({width:18,height:18}),Y.plusIcon=C({width:14,height:14}),Y.keyboardIcon=b({width:18,height:18}),Y.imageIcon=p({width:18,height:18}),Y.height=42,Y.minorItemStyle={width:34,justifyContent:"center"};const J=(0,I.injectIntl)(Y)},87038:(e,t,i)=>{i.r(t),i.d(t,{default:()=>D});var o=i(10434),n=i.n(o),s=i(23174),r=i.n(s),a=i(67294),l=i(83355),c=i(84465),d=i(51454),u=i(5366),h=i(21797),m=i(46225),p=i(11732),g=i(50906),b=i(70442),v=i(21325),S=i(87279),f=i(51783),y=i(45096),C=i(80444),M=i(63334),k=i(29798),T=i(49085);class A extends T.default{getInitialState(){return{isOpen:!1,isInsertOpen:!1,isTurnIntoOpen:!1,isColorOpen:!1,isTemplatesOpen:!1}}}const I=A;var B=i(27724),w=i(24666),x=i(48019),P=i(56940),Z=i(1892),R=i(78140),F=i(32163),N=i(40721),O=i(53437),_=i(72495),L=i(40698),V=i(34574);class U extends l.Z{constructor(){super(...arguments),this.storeTypes={store:I,ignoreSelectionAreaStore:M.Z,templatePickerMenuListStore:k.Z},this.templatePreviewSectionsStore=this.createComputedStore((()=>{var e,t;return Object.entries((0,y.it)({userPersona:null===(e=C.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.persona,subscriptionTier:null===(t=C.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier()})).map((e=>{let[t,i]=e;return{key:t,render:e=>r()(_.Z,{title:a.createElement(u.FormattedMessage,c._5[t])},t,e.children),items:i.map(this.renderMobileTemplatePreviewItem)}}))})),this.renderMobileTemplatePreviewItem=e=>({key:e.name,render:t=>a.createElement(V.Z,n()({},t,{key:e.name,title:e.name,type:"page_template",format:"phone-modal",locked:!1})),action:()=>{b.$7({environment:this.environment,item:e,createNewPage:!1,isPrivate:!1})}}),this.renderPageTemplatePickerItem=e=>{const t=this.props.currentBlockStore;return{key:e.name,render:t=>{var i;return a.createElement(V.Z,n()({},t,{key:e.name,format:"phone-modal",title:e.name,type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,this.getIconStyle(e)),locked:!1}))},action:i=>{t&&v.M_(this.environment)&&(g.rNQ(this.environment,{template_name:e.name,is_keyboard:"keydown"===i.event.type}),e.onClick(this.environment,t))}}},this.handleCloseColorPopup=()=>{this.stores.store.setState({...this.stores.store.state,isColorOpen:!1})},this.handleCloseInsertPopup=()=>{this.stores.store.setState({...this.stores.store.state,isInsertOpen:!1})},this.handleCloseTurnIntoPopup=()=>{this.stores.store.setState({...this.stores.store.state,isTurnIntoOpen:!1})},this.handleCloseTemplatesPopup=()=>{this.stores.store.setState({...this.stores.store.state,isTemplatesOpen:!1})},this.renderStore=this.createComputedStore((()=>{var e;return f.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)}))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=this.isOpen(),{makeActionBarComponent:o}=this.props;return r()(a.Fragment,{},void 0,r()(Z.Z,{capture:!0,render:e=>a.createElement("div",n()({},e,{style:{position:"relative",width:"100%",height:0,zIndex:d.Eo}}),o(this.stores),this.renderNativeMenuIgnoreSelectionArea(),this.renderInsertPopup(),this.renderTurnIntoPopup(),this.renderColorPopup(),this.renderTemplatesPopup())}),!i&&e.isIPhoneX&&e.isNative&&r()("div",{style:{position:"absolute",bottom:0,background:"transparent",height:t.state.paddingBottomCSS,width:"100%",pointerEvents:"none",WebkitUserSelect:"none"}}))}renderNativeMenuIgnoreSelectionArea(){const e=this.environment.NativeMobileActionBarStore;return e?r()(P.Z,{store:this.stores.ignoreSelectionAreaStore,capture:f.y6(this.environment),ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:"editing"!==w.default.state.mode&&e.state.shouldRestoreSelectionForMenu,render:e=>null}):null}renderInsertPopup(){const{device:e}=this.environment;return r()(P.Z,{capture:this.stores.store.state.isInsertOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:t=>r()(O.ZP,{popupType:e.isMobile?O.ZP.PopupType.SlideUp:O.ZP.PopupType.Popup,preventBlockRenderQueueOnEnter:!0,open:this.stores.store.state.isInsertOpen,keepFocus:!0,onDismiss:()=>{t(),this.handleCloseInsertPopup()},render:()=>r()(R.Z,{menuType:S.og.Modal,title:r()(u.FormattedMessage,{defaultMessage:"Insert block",id:"mobileActionBar.insertBlock.modalTitle"}),right:r()(N.CancelMenuText,{}),onClickRight:()=>{t(),this.handleCloseInsertPopup()}},void 0,r()(x.Z,{sections:m.w.state.insertActions,context:{environment:this.environment,blocks:B.default.state.stores,publicEditMode:void 0},onAccept:this.handleCloseInsertPopup}))})})}renderTurnIntoPopup(){const{device:e}=this.environment;return r()(P.Z,{capture:this.stores.store.state.isTurnIntoOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>r()(O.ZP,{popupType:e.isMobile?O.ZP.PopupType.SlideUp:O.ZP.PopupType.Popup,open:this.stores.store.state.isTurnIntoOpen,keepFocus:!0,onDismiss:this.handleCloseTurnIntoPopup,preventBlockRenderQueueOnEnter:!0,render:()=>r()(R.Z,{menuType:S.og.Modal,title:r()(u.FormattedMessage,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.modalTitle"}),right:r()(N.CancelMenuText,{}),onClickRight:this.handleCloseTurnIntoPopup},void 0,r()(x.Z,{sections:[{...p.g,title:""}],context:{environment:this.environment,blocks:B.default.state.stores,publicEditMode:void 0},onAccept:this.handleCloseTurnIntoPopup}))})})}renderColorPopup(){const{device:e}=this.environment;return r()(P.Z,{capture:this.stores.store.state.isColorOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>r()(O.ZP,{popupType:e.isMobile?O.ZP.PopupType.SlideUp:O.ZP.PopupType.Popup,open:this.stores.store.state.isColorOpen,keepFocus:!0,onDismiss:this.handleCloseColorPopup,preventBlockRenderQueueOnEnter:!0,render:()=>r()(R.Z,{menuType:S.og.Modal,title:r()(u.FormattedMessage,{defaultMessage:"Block color",id:"mobileActionBar.blockColor.modalTitle"}),right:r()(N.CancelMenuText,{}),onClickRight:this.handleCloseColorPopup},void 0,r()(x.Z,{sections:[h.te,h.rz,h.Vm],context:{environment:this.environment,blocks:B.default.state.stores,publicEditMode:void 0},onAccept:this.handleCloseColorPopup}))})})}renderTemplatesPopup(){const{device:e}=this.environment;return r()(P.Z,{capture:this.stores.store.state.isTemplatesOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:()=>r()(O.ZP,{popupType:e.isMobile?O.ZP.PopupType.SlideUp:O.ZP.PopupType.Popup,open:this.stores.store.state.isTemplatesOpen,keepFocus:!0,render:()=>r()(R.Z,{menuType:S.og.Modal,title:r()(u.FormattedMessage,{defaultMessage:"Templates",id:"mobileActionBar.templates.modalTitle"}),right:r()(N.CancelMenuText,{}),onClickRight:this.handleCloseTemplatesPopup},void 0,r()(F.Z,{type:F.i.Vertical,store:this.stores.templatePickerMenuListStore,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,onAccept:this.handleCloseTemplatesPopup,sections:[{key:"Basic",render:e=>r()(_.Z,{},void 0,e.children),items:L.ss.map(this.renderPageTemplatePickerItem)},{key:"Database",render:e=>r()(_.Z,{title:r()(u.FormattedMessage,{defaultMessage:"Database",id:"mobileActionBar.databaseSection.title"})},void 0,e.children),items:L.Im.filter((e=>e.shouldShow(this.environment))).map(this.renderPageTemplatePickerItem)},...this.templatePreviewSectionsStore.state]}))})})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.stores.store.state.isOpen:this.renderStore.state.shouldShow}getIconStyle(e){return e.isLargeDatabaseIcon?{width:16,fill:this.theme.regularIconColor,marginLeft:4,marginRight:4}:{width:20,fill:this.theme.regularIconColor,marginLeft:2,marginRight:2}}}U.displayName="MobileActionBarWrapper";const D=(0,u.injectIntl)(U)},90108:(e,t,i)=>{i.r(t),i.d(t,{default:()=>T});var o=i(23174),n=i.n(o),s=i(67294),r=i(83355),a=i(45238);const l=(0,a.I)("mobileBottomBarAddPage",{viewBox:"0 0 26 26",svg:n()("path",{d:"M22.5713 3.95215L23.3447 3.15722C23.71 2.78125 23.7207 2.25488 23.3555 1.90039L23.1084 1.64258C22.7754 1.30957 22.2383 1.35254 21.8945 1.69629L21.1104 2.46972L22.5713 3.95215ZM10.207 15.124L12.3018 14.2109L21.7764 4.73633L20.3047 3.28613L10.8408 12.7607L9.87402 14.7803C9.78809 14.9629 10.0029 15.21 10.207 15.124ZM5.74902 23.1162H18.3604C20.2832 23.1162 21.4111 21.999 21.4111 19.7861V7.83008L19.6816 9.55957V19.7002C19.6816 20.8174 19.0693 21.3867 18.3281 21.3867H5.77051C4.69629 21.3867 4.10547 20.8174 4.10547 19.7002V7.50781C4.10547 6.39062 4.69629 5.81054 5.77051 5.81054H15.0625L16.792 4.08105H5.74902C3.50391 4.08105 2.37598 5.19824 2.37598 7.41113V19.7861C2.37598 22.0098 3.50391 23.1162 5.74902 23.1162Z"})}),c=(0,a.I)("mobileBottomBarRedo",{viewBox:"0 0 26 26",svg:n()("path",{d:"M2.84863 17.498C2.84863 21.6123 5.54492 24.3516 10.3574 24.3516H12.8389C13.4297 24.3516 13.8164 23.9219 13.8164 23.3955C13.8164 22.8691 13.4297 22.4395 12.8389 22.4395H10.3682C6.70508 22.4395 4.76074 20.291 4.76074 17.3906C4.76074 14.501 6.70508 12.4814 10.3682 12.4814H17.7373L20.2617 12.374L18.2207 14.1143L15.127 17.1328C14.9551 17.3047 14.8691 17.5088 14.8691 17.7881C14.8691 18.3467 15.2451 18.7334 15.8145 18.7334C16.0508 18.7334 16.3301 18.626 16.5127 18.4326L22.8291 12.2344C23.0439 12.0303 23.1514 11.7832 23.1514 11.5254C23.1514 11.2568 23.0439 11.0098 22.8291 10.8057L16.5127 4.60742C16.3301 4.4248 16.0508 4.30664 15.8145 4.30664C15.2451 4.30664 14.8691 4.69336 14.8691 5.25195C14.8691 5.53125 14.9551 5.73535 15.127 5.90723L18.2207 8.93652L20.2617 10.6768L17.7373 10.5586H10.5293C5.62012 10.5586 2.84863 13.3945 2.84863 17.498Z"})});var d=i(38780);const u=(0,a.I)("mobileBottomBarUndo",{viewBox:"0 0 26 26",svg:n()("path",{d:"M23.1514 17.498C23.1514 13.3945 20.3691 10.5586 15.4707 10.5586H8.25195L5.73828 10.6768L7.76855 8.93652L10.873 5.90723C11.0342 5.73535 11.1309 5.53125 11.1309 5.25195C11.1309 4.69336 10.7549 4.30664 10.1748 4.30664C9.94922 4.30664 9.66992 4.4248 9.4873 4.60742L3.1709 10.8057C2.95605 11.0098 2.84863 11.2568 2.84863 11.5254C2.84863 11.7832 2.95605 12.0303 3.1709 12.2344L9.4873 18.4326C9.66992 18.626 9.94922 18.7334 10.1748 18.7334C10.7549 18.7334 11.1309 18.3467 11.1309 17.7881C11.1309 17.5088 11.0342 17.3047 10.873 17.1328L7.76855 14.1143L5.73828 12.374L8.25195 12.4814H15.6318C19.2949 12.4814 21.2285 14.501 21.2285 17.3906C21.2285 20.291 19.2949 22.4395 15.6318 22.4395H13.1611C12.5703 22.4395 12.1836 22.8691 12.1836 23.3955C12.1836 23.9219 12.5703 24.3516 13.1611 24.3516H15.6426C20.4443 24.3516 23.1514 21.6123 23.1514 17.498Z"})});var h=i(51454),m=i(50906),p=i(55332),g=i(87531),b=i(74647),v=i(43250),S=i(5162),f=i(80444),y=i(72653),C=i(64921),M=i(42685);class k extends r.Z{constructor(){super(...arguments),this.handleClickFind=()=>{g.Kf({environment:this.environment,analyticsFrom:"mobile-bottom-bar"}),m.nBz(this.environment,{itemName:"search"})},this.handleClickQuickAdd=()=>{b.quickAddPage({environment:this.environment,from:"mobile_bottom_bar"}),m.nBz(this.environment,{itemName:"add_page"})},this.handleUndo=()=>{p.Yw(this.environment,!0),m.nBz(this.environment,{itemName:"undo"})},this.handleRedo=()=>{p.KX(this.environment,!0),m.nBz(this.environment,{itemName:"redo"})},this.canQuickAdd=this.createComputedStore((()=>Boolean(f.default.state.currentSpaceStore&&f.default.state.currentSpaceStore.canEdit())))}renderComponent(){const e=y.Z.state,t=(0,S.Y)("supportsNativeBottomBar"),{isTablet:i}=this.environment.device;if(e)return t?n()("div",{className:v.alX},void 0,this.renderUpdatesButton()):n()("div",{style:this.getWrapStyle(e),className:v.rKl},void 0,i?this.renderTabletButtons():this.renderPhoneButtons())}renderPhoneButtons(){return n()(s.Fragment,{},void 0,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton())}renderTabletButtons(){return n()(s.Fragment,{},void 0,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton(),this.renderUndoRedoButtons())}renderSearchButton(){return n()(C.Z,{style:this.getSearchButtonStyle(),onClick:this.handleClickFind,mobileFeedback:!0},void 0,(0,d.w)(this.getIconStyle()))}renderUpdatesButton(){const{isTablet:e}=this.environment.device;return n()(M.Z,{format:e?M.Z.Format.MobileBottomBarTablet:M.Z.Format.MobileBottomBarPhone})}renderQuickAddPageButton(){return n()(C.Z,{style:this.getQuickAddButtonStyle(),onClick:this.handleClickQuickAdd,mobileFeedback:!0,disabled:!this.canQuickAdd.state,disabledFeedback:!0},void 0,l(this.getIconStyle()))}renderUndoRedoButtons(){return n()(s.Fragment,{},void 0,n()(C.Z,{style:this.getUndoButtonStyle(),onClick:this.handleUndo,mobileFeedback:!0,disabled:!p.L0(),disabledFeedback:!0},void 0,u(this.getIconStyle())),n()(C.Z,{style:this.getRedoButtonStyle(),onClick:this.handleRedo,mobileFeedback:!0,disabled:!p.AZ(),disabledFeedback:!0},void 0,c(this.getIconStyle())))}getWrapStyle(e){const{WindowSizeStore:t}=this.environment,{isTablet:i}=this.environment.device;return{position:"absolute",left:0,right:0,bottom:0,display:"flex",justifyContent:i?"flex-start":"space-around",height:t.getSafePaddingBottomCSS(k.height),paddingBottom:t.state.paddingBottomCSS,background:this.theme.contentBackground,borderTop:`1px ${this.theme.darkDividerColor} solid`,zIndex:h.D_,pointerEvents:e?"auto":"none",cursor:"pointer"}}getSearchButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return{display:"flex",alignItems:"center",justifyContent:"flex-start",flex:1,paddingLeft:e.getSafePaddingLeftCSS(18),...t&&{flex:"none",paddingLeft:2,width:k.tabletButtonWidth,justifyContent:"center"}}}getQuickAddButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return{display:"flex",alignItems:"center",justifyContent:"flex-end",flex:1,paddingRight:e.getSafePaddingRightCSS(18),...t&&{justifyContent:"center",flex:"none",paddingRight:0,width:k.tabletButtonWidth,marginRight:"auto"}}}getUndoButtonStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"flex-start",flex:"none",paddingLeft:e.getSafePaddingLeftCSS(18),width:k.tabletButtonWidth}}getRedoButtonStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",flex:"none",width:k.tabletButtonWidth,paddingRight:4}}getIconStyle(){return{width:26,fill:this.theme.regularTextColor}}}k.displayName="MobileBottomBar",k.height=44,k.tabletButtonWidth=54;const T=k},54230:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ee});var o=i(23174),n=i.n(o),s=i(30120),r=i(67294),a=i(83355),l=i(49085),c=i(15145),d=i(40506),u=i(7057),h=i(53877),m=i(42875),p=i(2585),g=i(5257),b=i(72126),v=i(21202),S=i(5366),f=i(26797),y=i(49865),C=i(75018),M=i(39699),k=i(66213),T=i(40863),A=i(84210),I=i(87279);class B extends l.default{getInitialState(){return{}}}const w=B;var x=i(57559),P=i(13401),Z=i(75498),R=i(73063),F=i(78140),N=i(43765),O=i(40721),_=i(72495),L=i(78948),V=i(6695),U=i(95855),D=i(54497),E=i(82990),H=i(33929),q=i(65598),W=i(80444),z=i(97039),G=i(78030),j=i(52275),K=i(16354),Q=i(31278),$=i(76798);class Y extends a.Z{constructor(){super(...arguments),this.renderProperty=e=>{const{schema:t,store:i,blockPropertyValueOverlayStore:o,collectionStore:s}=this.props;if(t[e])return n()(z.Z,{store:i,property:e,disabled:!0,locked:!1,format:G.C.Calendar,tableWrap:!1,blockPropertyValueOverlayStore:o,collectionStore:s},e)}}renderComponent(){const{time:e,store:t}=this.props,i=t.hasIcon()||!t.isEmptyPage(),o=t.hasError(),s=(0,A.ZP)({store:t,fullyQualified:!1,pageVisitSource:c.tY.LinkInPage}),a=q.Xp(t,{recursivelyLoadAllDiscussions:!1});return n()(K.Z,{href:s},void 0,n()(j.Z,{focused:!1,title:n()(r.Fragment,{},void 0,e&&n()("div",{style:{display:"flex",color:this.theme.mediumTextColor,fontSize:14,marginTop:8,marginBottom:6}},void 0,e),n()("div",{style:{display:"flex",alignItems:"center",...e&&{marginBottom:8}}},void 0,i&&!o&&n()(Q.Z,{disabled:!0,icon:t.getIcon(),isEmptyPage:t.isEmptyPage(),size:24,style:{flexShrink:0,marginRight:8}}),o&&(0,D.t)({marginLeft:2,marginRight:10,width:20,fill:this.theme.accentColors.orange[500]}),n()($.Z,{store:t,style:{fontWeight:E.Z.fontWeight.semibold}}),a>0&&n()("div",{style:{display:"flex",alignItems:"center",color:this.theme.regularDividerColor,fontSize:12,marginLeft:4,flexShrink:0}},void 0,(0,U.z)({width:12,height:12,marginRight:4,fill:this.theme.mediumIconColor}),a))),caption:this.renderProperties()}))}renderProperties(){const{format:e,schema:t,store:i}=this.props,o=(e.calendar_properties?e.calendar_properties.filter((e=>e.visible)).map((e=>e.property)):[]).filter((e=>{var o;return V.XU({block:i.getModel(),property:e,schema:t,getRecordModel:i.getRecordModel,userId:null===(o=W.default.state.currentUserStore)||void 0===o?void 0:o.id,userTimeZone:(0,m.r)(),intl:H.default.getIntl()})}));if(o.length>0)return n()("div",{style:{marginTop:8}},void 0,o.map(this.renderProperty))}}Y.displayName="MobileCalendarDayMenuItem";const J=Y;class X extends a.Z{constructor(){super(...arguments),this.storeTypes={store:w,resultStore:l.default.createClass(void 0)},this.renderResults=()=>{const{disabled:e,collectionContextStore:t}=this.props,i=t.collectionStore();if(!i)return;const o=this.getCurrentStartOfDay(),s=o.endOf("day"),r=this.getCurrentResults();return n()(F.Z,{menuType:I.og.Modal,title:n()("div",{style:X.headerStyle},void 0,n()(R.Z,{onClick:this.handleLeftClick,icon:p.f,style:{marginRight:8,marginTop:2},mobileFeedback:!0}),n()("div",{},void 0,(0,u.ZW)(o,"month_day_long")),n()(R.Z,{onClick:this.handleRightClick,icon:g.o,style:{marginLeft:8,marginTop:2},mobileFeedback:!0})),right:n()(O.DoneMenuText,{}),onClickRight:this.props.onDismiss},void 0,!r&&n()(_.Z,{},void 0,n()(L.Z,{})),r&&0===r.length&&n()(_.Z,{},void 0,n()(N.Z,{title:n()(S.FormattedMessage,{defaultMessage:"No items",id:"mobileCalendarDayMenu.noResults.message"})})),r&&r.length>0&&n()(_.Z,{},void 0,r.map((e=>{const t=x.G.createChildStore(i,{id:e.id,table:v.iU});return this.renderItem(t,e,o,s)}))),!e&&n()(_.Z,{topBorder:!0},void 0,n()(P.Z,{focused:!1,onClick:this.handleAddItemClick,title:n()(S.FormattedMessage,{defaultMessage:"New item",id:"mobileCalendarDayMenu.newItemButton.label"})})))},this.handleLeftClick=()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState({...this.stores.store.state,currentStartOfDay:e.minus({day:1}).valueOf()})},this.handleRightClick=()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState({...this.stores.store.state,currentStartOfDay:e.plus({day:1}).valueOf()})},this.handleAddItemClick=()=>{const{collectionContextStore:e,calendarBy:t}=this.props,i=this.getCurrentStartOfDay(),o=M.createAndCommit({userAction:"MobileCalendarDayMenu.newStore",environment:this.environment,perform:o=>{const n=y.IW({environment:this.environment,collectionContextStore:e,groupsPointer:[],insertAtIndex:0,coerce:!1,initializeDefaultTemplate:!0,transaction:o,from:"mobile_calendar_day_menu"});if(n)return f.xD({type:"timestamp",environment:this.environment,store:n.newStore,propertyId:t,timestampMs:i.valueOf(),transaction:o}),n.newStore}});if(!o.performResult)return;const n=(0,A.ZP)({store:o.performResult,pageVisitSource:c.tY.Create});this.navigate(n)},this.reducerStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props;return(0,T.YG)({collectionContextStore:e,startOfDay:this.getCurrentStartOfDay().valueOf()})}),!0)}navigate(e){this.context.overrideLinkClick?this.context.overrideLinkClick(e):C.navigate({environment:this.environment,url:e})}renderComponent(){const{collectionContextStore:e}=this.props,t=this.reducerStore.state;if(t)return n()(Z.Z,{id:"calendar_day_results",reducer:t,collectionContextStore:e,render:this.renderResults,resultStore:this.stores.resultStore})}renderItem(e,t,i,o){const{disabled:s,blockPropertyValueOverlayStore:r,collectionContextStore:a}=this.props,l=a.collectionStore();if(l)return n()(J,{store:e,time:t.includeTime?this.renderTime(t,i,o):void 0,disabled:s,format:this.props.format,schema:this.props.schema,blockPropertyValueOverlayStore:r,collectionStore:l},t.id)}renderTime(e,t,i){const{schema:o,calendarBy:n,intl:s}=this.props,r=o[n];if(!r||"date"!==r.type)return;const a=r.date_format||d.sF,l=r.time_format||d.c_,c=e.start,p=e.end,g=Boolean(!(t<=c&&c<=i)||p&&!(t<=p&&p<=i));if(e.end){const t=h.iC(e.start.valueOf(),e.end?e.end.valueOf():e.start.valueOf(),e.timeZone??(0,m.r)());return g?(0,u.ZV)({value:t,date_format:a,time_format:l,userTimeZone:e.timeZone,allowRelativeDates:!0,intl:s}):(0,u.ns)({start_time:t.start_time,end_time:t.end_time,time_format:l,humanReadable:!0,intl:s})}return(0,u.mr)({start_time:h.CQ(e.start.valueOf(),e.timeZone??(0,m.r)()).start_time,time_format:l,humanReadable:!0,intl:s})}getCurrentStartOfDay(){const{currentStartOfDay:e}=this.stores.store.state;return e?s.ou.fromMillis(e):s.ou.fromMillis(this.props.initialStartOfDay)}getCurrentResults(){const{collectionContextStore:e}=this.props,t=e.collectionStore();if(!t)return;const i=this.stores.resultStore.state,o=e.normalizedQueryStore.state,n=e.normalizedSchemaStore.state,s=o?o.calendar_by:void 0;if(!(i&&o&&s&&n))return;let r=b.oA(i.blockIds.map((e=>{const i=x.G.createChildStore(t,{id:e,table:v.iU});return(0,T.BO)({blockStore:i,calendarBy:s,schema:n,getRecordValue:t.getRecordValue,userId:this.environment.currentUser.id,intl:this.props.intl})})));return o.sort||(r=b.MR(r,(e=>e.start))),r}}X.displayName="MobileCalendarDayMenu",X.contextTypes={...k.wK,...a.w},X.headerStyle={display:"flex",alignItems:"center",height:"100%"};const ee=(0,S.injectIntl)(X)},61671:(e,t,i)=>{i.d(t,{Z:()=>y});var o=i(10434),n=i.n(o),s=i(23174),r=i.n(s),a=i(67294),l=i(83355),c=i(16001),d=i(5366),u=i(75018),h=i(87279),m=i(14786),p=i(64921),g=i(31945),b=i(78140),v=i(15311),S=i(14694);class f extends l.Z{constructor(){super(...arguments),this.handleClose=()=>{const{mobileNative:e}=this.environment,t=()=>{m.Z.setState({open:!1})};m.Z.state.source!==m.Y.Updates&&((null==e?void 0:e.supportsNativeHomeOnPhone())||!1)?u.navigateToHomeTab(this.environment,t):t()}}renderComponent(){const{device:e,mobileNative:t}=this.environment,i=m.Z.state.open,o=m.Z.state.source!==m.Y.Updates&&((null==t?void 0:t.supportsNativeHomeOnPhone())||!1);return r()(g.ZP,{popupType:e.isMobile?g.Z4.SlideUp:g.Z4.Popup,hidesMobileNativeBottomBar:o,preventSlideUpTransition:o,buttonPopupStore:m.Z,renderOrigin:t=>a.createElement(p.Z,n()({mobileFeedback:e.isMobile},t),r()(S.Z,{left:(0,c.r)({fill:this.theme.mediumIconColor,width:16}),style:{background:i?this.theme.buttonHoveredBackground:"none"},disableMobileBorder:!0},void 0,r()(d.FormattedMessage,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.label"}))),render:()=>{let t;return t=e.isMobile?{menuType:h.og.Modal,title:r()(d.FormattedMessage,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.title"}),right:r()(d.FormattedMessage,{defaultMessage:"Done",id:"notificationSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose,onCancel:this.handleClose,whiteBackground:!0}:{menuType:h.og.Popup},a.createElement(b.Z,t,r()(v.Z,{isMobile:!0,passwordRequestStore:this.props.passwordRequestStore}))}})}}f.displayName="NotificationSettingsButton";const y=f},19986:(e,t,i)=>{i.r(t),i.d(t,{default:()=>De});var o=i(10434),n=i.n(o),s=i(23174),r=i.n(s),a=(i(57658),i(67294)),l=i(83355),c=i(1302),d=i(27328),u=i(69615),h=i(15145),m=i(8848),p=i(42853),g=i(63261),b=i(45238);const v=(0,b.I)("mobileOffline",{viewBox:"0 0 26 26",svg:r()("path",{d:"M26.0029 13.2441C25.9922 11.9873 24.2842 11.0742 22.2324 11.0742H17.9033C17.3018 11.0742 17.0762 10.9775 16.7217 10.5693L9.50293 2.69531C9.27734 2.4375 8.99805 2.30859 8.67578 2.30859H7.42969C7.15039 2.30859 6.98926 2.55566 7.12891 2.85645L10.8457 11.0742L5.38867 11.6973L3.44434 8.13086C3.30469 7.8623 3.06836 7.74414 2.71387 7.74414H2.25195C1.97266 7.74414 1.79004 7.92676 1.79004 8.20605V18.2822C1.79004 18.5615 1.97266 18.7334 2.25195 18.7334H2.71387C3.06836 18.7334 3.30469 18.6152 3.44434 18.3574L5.38867 14.791L10.8457 15.4141L7.12891 23.6318C6.98926 23.9219 7.15039 24.1797 7.42969 24.1797H8.67578C8.99805 24.1797 9.27734 24.04 9.50293 23.793L16.7217 15.9082C17.0762 15.5107 17.3018 15.4141 17.9033 15.4141H22.2324C24.2842 15.4141 25.9922 14.4902 26.0029 13.2441Z"})}),S=(0,b.I)("mobileTopbarComments",{viewBox:"0 0 27 27",svg:r()("path",{d:"M8.74414 24.6816C9.22266 24.6816 9.55469 24.4277 10.1504 23.9004L13.5195 20.9023H19.7891C22.6992 20.9023 24.2617 19.291 24.2617 16.4297V8.94922C24.2617 6.08789 22.6992 4.47656 19.7891 4.47656H7.21094C4.30078 4.47656 2.73828 6.07812 2.73828 8.94922V16.4297C2.73828 19.3008 4.30078 20.9023 7.21094 20.9023H7.67969V23.4414C7.67969 24.1934 8.06055 24.6816 8.74414 24.6816ZM9.14453 22.8945V20.0625C9.14453 19.5352 8.93945 19.3301 8.41211 19.3301H7.21094C5.23828 19.3301 4.31055 18.3242 4.31055 16.4199V8.94922C4.31055 7.04492 5.23828 6.04883 7.21094 6.04883H19.7891C21.752 6.04883 22.6895 7.04492 22.6895 8.94922V16.4199C22.6895 18.3242 21.752 19.3301 19.7891 19.3301H13.4609C12.9141 19.3301 12.6406 19.4082 12.2695 19.7891L9.14453 22.8945ZM8.4707 9.99414H18.4121C18.7246 9.99414 18.9688 9.75 18.9688 9.42773C18.9688 9.125 18.7246 8.87109 18.4121 8.87109H8.4707C8.1582 8.87109 7.9043 9.125 7.9043 9.42773C7.9043 9.75 8.1582 9.99414 8.4707 9.99414ZM8.4707 13.1777H18.4121C18.7246 13.1777 18.9688 12.9238 18.9688 12.6016C18.9688 12.2988 18.7246 12.0449 18.4121 12.0449H8.4707C8.1582 12.0449 7.9043 12.2988 7.9043 12.6016C7.9043 12.9238 8.1582 13.1777 8.4707 13.1777ZM8.4707 16.3516H14.9355C15.248 16.3516 15.4922 16.1074 15.4922 15.7949C15.4922 15.4727 15.248 15.2188 14.9355 15.2188H8.4707C8.1582 15.2188 7.9043 15.4727 7.9043 15.7949C7.9043 16.1074 8.1582 16.3516 8.4707 16.3516Z"})});var f=i(35840),y=i(89101),C=i(21202),M=i(82990),k=i(51454),T=i(5366),A=i(50906),I=i(17503),B=i(11302),w=i(75018),x=i(87531),P=i(24677),Z=i(48429),R=i(74647),F=i(29974),N=i(98104),O=i(39699),_=i(39865),L=i(28020),V=i(43250),U=i(78089),D=i(87279),E=i(67669),H=i(58239),q=i(18514),W=i(45094),z=i(38755),G=i(77907),j=i(4023),K=i(5162),Q=i(80444),$=i(92547),Y=i(69454),J=i(42330),X=i(30496),ee=i(57559),te=i(7755),ie=i(24666),oe=i(52258),ne=i(66708),se=i(83575),re=i(1449),ae=i(91754),le=i(64921),ce=i(31945),de=i(61519),ue=i(73063),he=i(21199),me=i(78140),pe=i(40721),ge=i(89728),be=i(53437),ve=i(31278),Se=i(76798),fe=i(45653),ye=i(39849),Ce=i(86628),Me=i(88144),ke=i(81258),Te=i(84708),Ae=i(82598);function Ie(){window.__c={n:"MobileUpdatesModalPageTab"};const e=(0,a.useCallback)((()=>r()(Ae.Z,{message:r()(T.FormattedMessage,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),title:r()(T.FormattedMessage,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})})),[]),t=(0,Ce.VK)((()=>Q.default.state.currentSpaceStore),[]),i=(0,Ce.VK)((()=>Q.default.state.mainEditorCurrentBlockStore),[]),o=(0,Ce.VK)((()=>{var e;const t=null==i||null===(e=i.getCollectionPointer())||void 0===e?void 0:e.id,o=null==i?void 0:i.isCollectionView();return null!=i&&i.isDefined()?{id:i.id,isCollection:o,collectionId:t}:void 0}),[i]);return t&&o&&i?r()("div",{},void 0,r()(Me.GetNotifiedFor,{navigableBlock:i,from:"page_updates",buttonPopupStore:ke.Z}),r()(Te.Z,{navigableBlock:i,collectionId:o.collectionId,spaceId:t.id,empty:e,source:"updates_sidebar"},"current-page")):null}var Be=i(92955),we=i(58493),xe=i(13612),Pe=i(60526),Ze=i(76006),Re=i(17169),Fe=i(10137),Ne=i(67485),Oe=i(12253),_e=i(19368),Le=i(23727),Ve=i(69054);class Ue extends l.Z{constructor(){super(...arguments),this.hasUnreadCommentsStore=this.createComputedStore((()=>(0,U.DF)({blockStore:this.props.store,currentUserId:this.environment.currentUser.id}).some((e=>!e.getResolved()&&(0,U.NI)(e).some((t=>I.t({discussionStore:e,commentStore:t})))))),!1),this.handleOpenQuickFind=()=>{x.UT({environment:this.environment,analyticsFrom:"public-page-topbar"})},this.handleTopbarClick=()=>{P.ZH(this.environment)},this.handleUpdatesClick=()=>{X.Z.setState({open:!0}),A.gMH(this.environment)},this.navigateToFirstSpace=()=>{const{currentUserRootStore:e,currentUserSettingsStore:t}=Q.default.state;e&&t&&F.L5({environment:this.environment,userRootStore:e,userSettingsStore:t,pageVisitSource:h.tY.SwitchSpace})},this.handleAddToClick=async()=>{await B.$X({environment:this.environment,blocks:[this.props.store],moveToContext:"quick_add",onAccept:this.handleAddToAccept,isAddTo:!0,isDefaultPrivateLocation:this.isDefaultPrivateLocation()})},this.handleAddToAccept=e=>{const{currentSpaceStore:t}=Q.default.state;t&&this.props.saveParent&&(0,H.rq)({currentUserId:this.environment.currentUser.id,spaceId:t.id,value:e}),A.xx2(this.environment)},this.handleCancelQuickAdd=e=>{const t=Q.default.state.mainEditorCurrentBlockStore,i=J.ZP.state.lastPageId;if(t){var o;const e=null===(o=this.environment.mobileNative)||void 0===o?void 0:o.supportsNativeHomeOnPhone();e?w.navigateToHomeTab(this.environment):i?w.navigateToBlock({environment:this.environment,store:ee.G.createChildStore(t,{table:C.iU,id:i}),showMoveTo:!1,saveParent:!1,redirect:e,pageVisitSource:h.tY.BackForward}):w.navigate({environment:this.environment,url:y._j.root,redirect:!0}),O.createAndCommit({userAction:"TopbarMobile.handleCancelQuickAdd",environment:this.environment,perform:e=>{_.y8({environment:this.environment,blocks:[t],transaction:e}),e.postSubmitCallbacks.push((e=>{e||A.dhV(this.environment,{analyticsName:"delete",from:"mobile_topbar",block_id:t.id,block_type:"page"})}))}})}}}renderComponent(){const{store:e}=this.props,{WindowSizeStore:t,device:i}=this.environment,o=(0,E.IJ)(this.environment,this.props.store),s=new $.Z,l=(e.isLocked()||s.state.justUnlocked)&&e.canEdit(),c=(!o||e.canEditCollection())&&i.isPhone&&(e.isRestricted()||l);return r()(he.Z,{capture:!0,render:i=>a.createElement("header",n()({},i,{style:this.getWrapStyle()}),o?this.renderPublicPageTopbar():this.renderNormalTopbar(),c&&r()(ae.Z,{styleKey:ae.v.White,isMobile:!0,style:{justifyContent:"unset"}},void 0,r()(we.Z,{store:this.props.store,isMobile:!0,lockStore:s},this.props.store.id),e.isRestricted()&&a.createElement(a.Fragment,null,l&&r()(de.Z,{vertical:!0,size:10,style:{height:"50%"}}),r()(Oe.Z,{style:{marginRight:8},onClick:()=>Z.lG(this.environment)}))),this.props.isOffline&&r()(ae.Z,{styleKey:ae.v.White,isMobile:!0},void 0,r()("div",{style:{display:"flex",alignItems:"center",width:"100%",paddingLeft:t.getSafePaddingLeftCSS(10),paddingRight:t.getSafePaddingRightCSS(14)}},void 0,v({width:26,marginRight:12}),r()("div",{},void 0,r()(T.FormattedMessage,{defaultMessage:"You're offline",id:"topbarMobile.offline.message"})))),r()(G.LazyBannersRenderer,{banners:this.props.banners,isMobile:!0,isInPeekRenderer:!1}))})}renderPublicPageTopbar(){const{store:e}=this.props;return r()("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:V.ZHw},void 0,this.environment.currentUser.isLoggedIn()&&r()(a.Fragment,{},void 0,r()(le.Z,{style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:14,paddingRight:14,fontWeight:M.Z.fontWeight.medium,color:this.theme.regularTextColor,whiteSpace:"nowrap"},mobileFeedback:!0,onClick:this.navigateToFirstSpace},void 0,r()(T.FormattedMessage,{defaultMessage:"Back",id:"topbarMobile.backButton.label"})),r()("div",{style:{height:18,width:1,flexShrink:0,marginRight:6,background:this.theme.darkDividerColor}})),r()(re.Z,{store:this.props.store,style:this.getBreadcrumbsStyle(),maxAncestorCount:1,showCurrentPageControls:!1,ancestorMaxWidth:100,currentPageMaxWidth:220,isMobile:!0}),r()("div",{style:{flexGrow:1,flexShrink:1}}),r()(ge.Z,{onClick:this.handleOpenQuickFind},void 0,(0,f.R)({width:20,height:20})),r()(xe.Z,{store:e,buttonPopupStore:oe.Z}))}renderNormalTopbar(){const{store:e,pageVisitStore:t,presenceStore:i,hideActionButtons:o}=this.props,{device:n}=this.environment,{isTablet:s}=n,l=this.props.isInvalidPage,c=this.shouldRenderBackButton();return r()("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:V.ZHw},void 0,this.shouldShowHamburgerButton()&&this.renderHamburgerButton(),c&&r()(Ze.Z,{supportsNativeHomeTabPhone:!s&&(0,K.Y)("supportsNativeHome")}),!l&&this.renderBreadcrumbs(c),e.canEditCollection()&&s&&r()(we.Z,{store:e,isMobile:!1},e.id),r()(Re.Z,{}),!o&&a.createElement(a.Fragment,null,e.isRestricted()&&s&&r()(Oe.Z,{style:{marginRight:8},onClick:()=>Z.lG(this.environment)}),s&&e.canEdit()&&t&&i&&r()(Ne.Z,{rootStore:e,pageVisitStore:t,presenceStore:i}),this.shouldShowCancelQuickAdd()?this.renderCancelQuickAdd():this.renderRightButtons()))}isEmptyPageAndTitle(){const{store:e}=this.props;return e.isEmptyTitle()&&e.isEmptyPage()}shouldShowCancelQuickAdd(){return this.props.shouldShowAddTo&&this.isEmptyPageAndTitle()}isTabletWithNativeHome(){return(0,K.Y)("supportsNativeHome")&&this.environment.device.isTablet}shouldShowHamburgerButton(){return this.isTabletWithNativeHome()||!(0,K.Y)("supportsNativeHome")}renderHamburgerButton(){return r()(le.Z,{mobileFeedback:!0,style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,height:"100%",width:36,marginLeft:4},onClick:()=>{var e;if(this.isTabletWithNativeHome())null===(e=this.environment.mobileNative)||void 0===e||e.toggleNativeHome();else if((0,W.Jr)(this.environment))R.setExpand({environment:this.environment,isExpanded:!te.gV.state,from:"topbar_mobile"});else{const{NativeMobileActionBarStore:e}=this.environment,t=e?e.state.menuType:null;"editing"===ie.default.state.mode||null!==t?(N.ZH(this.environment),null==e||e.clear(!1),Y.Z.onHide((()=>{c.default.afterNextFlush((()=>R.open()))}))):R.open()}A.jDo(this.environment)}},void 0,(0,g._)({width:18,height:18}),r()(Be.Z,{type:this.environment.device.isMobileBrowser?"allSpaces":"otherSpaces",color:ye.Z.Color.Red,style:{position:"absolute",top:9,right:1}}))}renderBreadcrumbs(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{isTablet:t}=this.environment.device;return this.props.shouldShowAddTo?this.renderAddTo():r()(re.Z,{store:this.props.store,style:this.getBreadcrumbsStyle(e),maxAncestorCount:t?2:1,showCurrentPageControls:!1,ancestorMaxWidth:t?160:100,currentPageMaxWidth:t?240:220,isMobile:!0})}shouldRenderBackButton(){const{TabbedRouterStore:e}=this.environment,t=(0,q.NW)(this.environment)||"native"===(0,d.w_)(e.state).type;return!(0,q.__)(this.environment)||t}renderAddTo(){const{store:e}=this.props,t=e.getParentStore(),i=this.isDefaultPrivateLocation();if(!(t instanceof ee.T5||t instanceof ee.zq||t instanceof ee.Vf)&&t){if(i){const e=this.theme.mediumTextColor;return r()(le.Z,{mobileFeedback:!0,style:this.getAddToButtonStyle(),onClick:this.handleAddToClick},void 0,r()(T.FormattedMessage,{defaultMessage:"<mediumcolor>Add to</mediumcolor>{userAvatar}<mediumweight>Private pages</mediumweight>",id:"topbarMobile.addToPrivateSectionButton.label",values:{mediumcolor:t=>r()("span",{style:{color:e,marginRight:8}},void 0,t),mediumweight:e=>r()("span",{style:{fontWeight:M.Z.fontWeight.medium,marginLeft:4}},void 0,e),userAvatar:r()(fe.Z,{size:22,avatarShouldShowShadow:!0,userStore:(0,L.B7)(this.environment)})}}),this.renderChevron())}{const i=e instanceof ee.H2?(0,z.Wd)(this.environment,e):e.getIcon();return r()(le.Z,{mobileFeedback:!0,style:this.getAddToButtonStyle(),onClick:this.handleAddToClick},void 0,r()("span",{style:{color:this.theme.mediumTextColor}},void 0,r()(T.FormattedMessage,{defaultMessage:"Add to",id:"topbarMobile.addToPageOrWorkspaceSectionButton.label"})," "),r()(ve.Z,{disabled:!0,icon:i,isEmptyPage:t.table===C.iU&&t.isEmptyPage(),title:t instanceof ee.H2?(0,z.rn)(this.environment,t):void 0,size:24,style:{marginLeft:8,marginRight:4}}),r()(Se.Z,{style:{fontWeight:M.Z.fontWeight.semibold},store:t}),this.renderChevron())}}}renderChevron(){return(0,p.i)({marginLeft:4,width:10,fill:this.theme.lightTextColor})}renderRightButtons(){const{store:e,spaceStore:t,isInvalidPage:i}=this.props;if(i)return;const o=Boolean(t&&!t.canEdit()),n=e.canEdit(),s=(0,Pe.UP)({isSpaceGuest:o,canEditPage:n}),l=(0,Pe.W2)({canEditPage:n,device:this.environment.device});return r()(a.Fragment,{},void 0,this.renderPageUpdatesPopupOrigin(),s&&this.renderShare(),this.renderCommentsButton(),l&&r()(Le.l,{onClick:this.handleUpdatesClick}),this.renderShowMore())}renderCancelQuickAdd(){return r()(le.Z,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:16,paddingRight:16,fontWeight:M.Z.fontWeight.medium,color:m.ZP.blue},onClick:this.handleCancelQuickAdd},void 0,r()(T.FormattedMessage,{defaultMessage:"Cancel",id:"topbarMobile.cancelQuickAddButton.label"}))}renderShowMore(){return r()(Fe.Z,{store:this.props.store,collectionViewStore:this.props.collectionViewStore,buttonPopupStore:oe.Z})}renderShare(){return r()(_e.Z,{store:this.props.store,buttonPopupStore:ne.Z})}renderPageUpdatesPopupOrigin(){const e={menuType:D.og.Modal,title:r()(T.FormattedMessage,{defaultMessage:"Page Updates",id:"pageUpdatesModal.mobileMenu.title"}),right:r()(pe.DoneMenuText,{}),onClickRight:()=>X.Z.setState({open:!1}),whiteBackground:!0};return r()(be.ZP,{open:X.Z.state.open,popupType:ce.Z4.SlideUp,alignmentToOrigin:j.v.Start,placementToOrigin:j.u.Right,onDismiss:()=>X.Z.setState({open:!1}),originGap:0,isWideTabletWidth:!0,render:()=>a.createElement(me.Z,e,r()(Ie,{})),isFullWidthOnMobile:!0,preventScaleTransition:!0})}renderCommentsButton(){return r()(ce.ZP,{buttonPopupStore:se.Z,popupType:ce.Z4.SlideUp,alignmentToOrigin:j.v.Start,placementToOrigin:j.u.Right,originGap:0,stopClickPropagation:!0,isWideTabletWidth:!0,render:e=>r()(me.Z,{menuType:D.og.Modal,scrollerStyle:{paddingBottom:0},title:r()(T.FormattedMessage,{defaultMessage:"Comments",id:"topbarMobile.commentsMenu.title"}),right:r()(pe.DoneMenuText,{}),onClickRight:e.close},void 0,r()(Ve.J,{timeMounted:Date.now(),location:"popup"})),isFullWidthOnMobile:!0,preventScaleTransition:!0,renderOrigin:e=>r()("div",{style:{position:"relative",height:"100%"}},void 0,a.createElement(ue.Z,n()({icon:S,iconStyle:{width:26,height:26,fill:"inherit"},isDarkIconColor:!0,style:{marginLeft:6,marginRight:6,height:"100%"},mobileFeedback:!0},e)),this.hasUnreadCommentsStore.state&&r()("div",{style:{position:"absolute",top:9,right:5,height:8,width:8,borderRadius:4,background:m.ZP.red}}))})}isDefaultPrivateLocation(){const e=this.props.store.getParentStore(),{currentSpaceStore:t}=Q.default.state;return e instanceof ee.H2&&t&&e.id===t.id}getWrapStyle(){return{width:"100%",maxWidth:"100vw",zIndex:k.lI}}getStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100vw",height:u.g,marginTop:e.state.paddingTopCSS,paddingLeft:e.getSafePaddingLeftCSS(0),paddingRight:this.props.shouldShowAddTo?e.getSafePaddingRightCSS(0):e.getSafePaddingRightCSS(7),boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,background:this.theme.contentBackground,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}getBreadcrumbsStyle(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{mobileNative:t,device:i}=this.environment,{isTablet:o}=i;return{flexGrow:0,marginLeft:null!=t&&t.supportsNativeHomeOnPhone()?e?0:20:2,overflow:"auto",WebkitOverflowScrolling:"touch",marginRight:o?16:8,height:"100%"}}getAddToButtonStyle(){let e=0;return e=this.isTabletWithNativeHome()?8:this.shouldRenderBackButton()?6:16,{display:"flex",alignItems:"center",paddingLeft:e,paddingRight:12,fontSize:M.Z.fontSize.UIRegular.mobile,lineHeight:M.Z.lineHeight.UIRegular.mobile,whiteSpace:"nowrap",minWidth:0}}}Ue.displayName="TopbarMobile",Ue.notionLogoStyle={width:18,height:18,marginRight:6,fill:"inherit"};const De=Ue},51214:(e,t,i)=>{i.r(t),i.d(t,{default:()=>re});var o=i(23174),n=i.n(o),s=i(67294),r=i(83355),a=i(68719),l=i(480),c=i(41432),d=i(8848),u=i(72126),h=i(97880),m=i(36054),p=i(74487);function g(e,t,i){const{content:o,apiRequestValue:n}=i;return{id:e,content:o,action:{type:t,apiRequestValue:n}}}const b=["insertBlock","turnInto","textColor","textSelectionColor"],v=["textFormatting"];function S(e,t){return{type:e,apiRequestValue:t}}function f(e,t,i){const o={type:e,from:i,data:t};return JSON.stringify(o)}const y={showActionBarMenu:p.object({required:{type:p.literal("showActionBarMenu"),data:p.object({required:{actionBarMenuId:p.literals("textColor","insertBlock","turnInto","template")},optional:{}})},optional:{}}),blockAction:p.object({required:{type:p.literals("blockAction"),data:p.object({required:{action:p.literals("bold","italic","underline","strikethrough","link","code","equation","mention","trash","comment","filePicker","indent","unindent","moveUp","moveDown","undo","redo","dismissKeyboard","more","ai","voiceInput")},optional:{}})},optional:{from:p.literals("mobile_action_bar","mobile_text_formatting_menu")}})},C=Object.keys(y);let M=function(e){return e[e.InvalidActionType=0]="InvalidActionType",e[e.MissingPayload=1]="MissingPayload",e[e.InvalidRequestType=2]="InvalidRequestType",e[e.InvalidData=3]="InvalidData",e}({});class k{constructor(e,t){this.type=e,this.message=t}}function T(e){return 0===e.reduce(((e,t)=>e+t.items.length),0)}var A=i(70203),I=i(5366),B=i(50906),w=i(44886),x=i(55332),P=i(24677),Z=i(98104),R=i(28020),F=i(12921),N=i(33929),O=i(51783),_=i(68056),L=i(45162),V=i(89086),U=i(35328);var D=i(19361),E=i(50694),H=i(64359),q=i(80444),W=i(27724),z=i(24666),G=(i(57658),i(25666)),j=i(21797),K=i(46225),Q=i(11732),$=i(95477),Y=i(68204),J=i(47853);function X(e){const{type:t,actionSections:i,closeParentMenu:o,context:n}=e,s={},r=[];for(const a of i){const e={id:`${a.key}`,title:a.title,items:a.actions.map((e=>{const i=`${e.key}-${e.displayName||""}`,r=e.nativeRender&&e.nativeRender(n),a=null!=r&&r.thumbnail?(0,J.D)(null==r?void 0:r.thumbnail):G.T;s[i]={...e,thumbnail:a,closeParentMenu:o};const l=/^https?:\/\//.test(a);return{id:i,title:e.displayName||"",icon:{...r,remoteImageUrl:a?`${l?"":$.default.domainBaseUrl}${a}`:void 0,localAssetBundleImagePath:l?void 0:a},action:S("webAction_genericAction",{menuType:t,actionId:i}),checked:!1}}))};r.push(e)}return{actions:s,sections:r}}function ee(e){const{key:t,displayName:i,thumbnail:o,analyticsName:n,closeParentMenu:s,action:r}=e,a=i;return{key:`action ${t}`,displayName:i?N.default.formatMessage(i):void 0,thumbnail:o,analyticsName:n||`textformatting_action_${t}`,searchName:a?`${N.default.formatMessage(a)} ${a.defaultMessage}`:void 0,validators:[],action:r,closeParentMenu:Boolean(s)}}const te={bold:ee({key:"bold",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["b"])}}),italic:ee({key:"italic",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["i"])}}),underline:ee({key:"underline",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["_"])}}),strikethrough:ee({key:"strikethrough",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["s"])}}),code:ee({key:"code",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["c"])}}),comment:ee({key:"comment",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.ol(i,!0,"mobile_action_bar")}}),equation:ee({key:"equation",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O._W(i)}}),filePicker:ee({key:"filePicker",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.vs(i)}}),indent:ee({key:"indent",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.O2(t)}}),unindent:ee({key:"unindent",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.$$(t)}}),moveDown:ee({key:"moveDown",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.rZ(t)}}),moveUp:ee({key:"moveUp",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.s0(t)}}),undo:ee({key:"undo",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.i2(t)}}),redo:ee({key:"redo",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.GH(t)}}),trash:ee({key:"trash",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.fn(t)}}),mention:ee({key:"mention",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.Z3(i)}}),ai:ee({key:"ai",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.QG(i)}}),voiceInput:ee({key:"voiceInput",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary());const o=D.Z.state;if(!(o.isSupported&&o.hasPermissions))return;const n=z.default.state;(o.active||"editing"===n.mode)&&D.Z.update((e=>{const t=!e.active;return{...e,active:t,stage:t?e.stage:"inactive"}}))}}),link:ee({key:"link",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.UF(i)}}),more:ee({key:"more",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.w1(t,void 0,void 0)}}),dismissKeyboard:ee({key:"dismissKeyboard",closeParentMenu:!0,action:e=>{let{environment:t}=e}})},ie=(0,I.defineMessages)({templatesButtonTitle:{defaultMessage:"Choose a template...",id:"mobileActionBar.templateButtonTitle"},actionMenuInsertBlockTitle:{defaultMessage:"Insert Block",id:"mobileActionBar.actionMenuTitle.insertBlock"},actionMenuTurnIntoTitle:{defaultMessage:"Turn Into",id:"mobileActionBar.actionMenuTitle.turnInto"},actionMenuColorTitle:{defaultMessage:"Color",id:"mobileActionBar.actionMenuTitle.blockColor"},accessibilityInsert:{defaultMessage:"Add block",id:"mobileActionBar.accessibility.insertBlock"},accessibilityTurnInto:{defaultMessage:"Turn into block",id:"mobileActionBar.accessibility.turnInto"},accessibilityFilePicker:{defaultMessage:"Add image",id:"mobileActionBar.accessibility.filePicker"},accessibilityMention:{defaultMessage:"Add mention",id:"mobileActionBar.accessibility.mention"},accessibilityBlockColor:{defaultMessage:"Change block color",id:"mobileActionBar.accessibility.blockColor"},accessibilityTextFormatting:{defaultMessage:"Open text formatting menu",id:"mobileActionBar.accessibility.textFormatting"},accessibilityComment:{defaultMessage:"Add comment",id:"mobileActionBar.accessibility.comment"},accessibilityTrash:{defaultMessage:"Delete block",id:"mobileActionBar.accessibility.trash"},accessibilityIndent:{defaultMessage:"Indent block",id:"mobileActionBar.accessibility.indent"},accessibilityDedent:{defaultMessage:"Unindent block",id:"mobileActionBar.accessibility.unindent"},accessibilityMoveUp:{defaultMessage:"Move a block up",id:"mobileActionBar.accessibility.moveUp"},accessibilityMoveDown:{defaultMessage:"Move a block down",id:"mobileActionBar.accessibility.moveDown"},accessibilityUndo:{defaultMessage:"Undo edit",id:"mobileActionBar.accessibility.udno"},accessibilityRedo:{defaultMessage:"Redo edit",id:"mobileActionBar.accessibility.redo"},accessibilityMore:{defaultMessage:"More block actions",id:"mobileActionBar.accessibility.more"},accessibilityBold:{defaultMessage:"Bold",id:"mobileActionBar.accessibility.bold"},accessibilityItalics:{defaultMessage:"Italicize",id:"mobileActionBar.accessibility.italics"},accessibilityUnderline:{defaultMessage:"Underline",id:"mobileActionBar.accessibility.underline"},accessibilityStrikethrough:{defaultMessage:"Strikethrough",id:"mobileActionBar.accessibility.strikethrough"},accessibilityTextColor:{defaultMessage:"Text color",id:"mobileActionBar.accessibility.textColor"},accessibilityCode:{defaultMessage:"Code",id:"mobileActionBar.accessibility.code"},accessibilityLink:{defaultMessage:"Add link",id:"mobileActionBar.accessibility.link"},accessibilityEquation:{defaultMessage:"Add equation",id:"mobileActionBar.accessibility.equation"},accessibilityCloseTextFormattingMenu:{defaultMessage:"Close text formatting menu",id:"mobileActionBar.accessibility.close"},accessibilityDismissKeyboard:{defaultMessage:"End editing",id:"mobileActionBar.accessibility.endEditing"},accessibilityCloseActionMenu:{defaultMessage:"Close menu",id:"mobileActionBar.accessibility.closeMenu"},accessibilityAi:{defaultMessage:"AI Assist",id:"mobileActionBar.accessibility.ai"}}),oe={text:!1,to_do:!0,bulleted_list:!0,numbered_list:!0,toggle:!0,column:!1,transclusion_container:!1,callout:!1,quote:!1};function ne(e){var t;window.__c={n:"MobileActionBarBridgeComponent"};const{onAction:i,fallbackRenderer:o,...n}=e,r=null===(t=(0,l.O7)().mobileNative)||void 0===t?void 0:t.api.renderMobileActionBar,c=(0,a.e)(r,n);return function(e,t,i,o){var n;const r=null===(n=(0,l.O7)().mobileNative)||void 0===n?void 0:n.componentEvents;(0,s.useEffect)((()=>{if(r&&o&&t)return r.addListener(e,t,i,o)}),[e,t,i,o,r])}("MobileActionBar",c,"onAction",i),!c&&o?s.createElement(s.Fragment,null,o()):null}class se extends r.Z{constructor(){super(...arguments),this.handleMobileActionBarBridgeEvent=e=>{const{action:t}=e;switch(t.type){case"nativeAction_hideKeyboard":break;case"nativeAction_setMenuType":this.handleSetMenuTypeAction(t);break;case"nativeAction_setSubMenuType":this.handleSetSubMenuTypeAction(t);break;case"webAction_generic":this.handleGenericWebAction(t);break;case"webAction_genericAction":this.handleActionRegistryAction(t)}},this.handleTextSelectionCompositeStoreChanged=()=>{if(!this.textSelectionCompositeStore.state)return;const{source:e}=this.textSelectionCompositeStore.state,{NativeMobileActionBarStore:t,device:i}=this.environment;"TextSelectionStore"!==e||null===(null==t?void 0:t.state.menuType)||i.isTablet||this.setCurrentMenuType(null,!0)},this.handleTextSelectionStoreChanged=()=>{if(!this.textSelectionPositionsStore.state)return;const{NativeMobileActionBarStore:e}=this.environment;e&&e.state.isSubMenuOverridden&&this.setCurrentSubMenuType(null,!1)},this.actionBarTextSelectionStore=this.createComputedStore((()=>{const e="editing"===z.default.state.mode&&z.default.state.multiSelection,t=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,i=t&&"editing"===t.mode&&t.multiSelection;return e||i||void 0}),!0),this.textSelectedBlocksStore=this.createComputedStore((()=>{var e;const t=this.actionBarTextSelectionStore.state;return t&&(null===(e=(0,L.tp)({multiSelection:t,focus:void 0,filterCommonAncestors:!1}))||void 0===e?void 0:e.stores)})),this.disableMentionCommentsStore=this.createComputedStore((()=>{const e=this.actionBarTextSelectionStore.state,t=Boolean(e&&(0,_.qS)(e)),i=this.props.currentBlockStore.getType(),o=this.props.currentBlockStore.getFormat();return{disableCommentAction:this.commentActionDisabled(i,o)||Boolean(this.renderStore.state.disableComment),disableLinkAction:!t,disableMentionAction:!t||this.mentionActionDisabled(i),disableEquationAction:!t}})),this.disableIndentStore=this.createComputedStore((()=>{const e=W.default.state.stores;return{disableIndent:!e.every(w.nt),disableUnindent:!e.every(w.gq)}})),this.disableUndoRedoStore=this.createComputedStore((()=>({disableUndo:!x.L0(),disableRedo:!x.AZ()}))),this.isEditingCurrentPageTitleStore=this.createComputedStore(R.JE),this.isEditingCollectionViewTitleStore=this.createComputedStore(R.VV),this.showTemplatesButtonStore=this.createComputedStore((()=>O.Tz({environment:this.environment,store:this.props.currentBlockStore}))),this.reactiveMemoizedNativeMenusStore=this.createComputedStore((()=>this.memoizedNativeMenus({blocks:W.default.state.stores,environment:this.environment}))),this.getCurrentActionBarSchema=this.createComputedStore(this.recomputeCurrentActionBarSchema.bind(this),!0,"getCurrentActionBarSchema"),this.buttonSectionsConfigStore=this.createComputedStore((()=>{var e;const{NativeMobileActionBarStore:t}=this.environment,i=Boolean(this.renderStore.state.disableAnnotation),o=t?t.state.menuType:null;var n=null;const s=this.showTemplatesButtonStore.state,r=!!t&&t.state.isSubMenuOverridden,a=this.shouldShowTextActions.state,l=t?t.state.subMenuType:null;r?n=l:a&&!i&&(n="textFormatting",null==t||t.update((e=>({...e,isSubMenuOverridden:!1,subMenuType:null}))));const c=!this.canTriggerTextActions.state,d=!this.canTriggerBlockActions.state,{disableCommentAction:u,disableLinkAction:h,disableMentionAction:m,disableEquationAction:p}=this.disableMentionCommentsStore.state,{disableIndent:g,disableUnindent:b}=this.disableIndentStore.state,v=this.isEditingCurrentPageTitleStore.state||this.isEditingCollectionViewTitleStore.state,{disableUndo:S,disableRedo:f}=this.disableUndoRedoStore.state,y=(0,F.GD)(this.environment,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state),C=H.Z.state.isActive,M=v||C,k=this.reactiveMemoizedNativeMenusStore.state;return{selectedSubMenu:n,createAIAction:y,disableAIAction:M,disableBlockActions:d,disableCommentAction:u,disableMentionAction:m,selectedMenuType:o,disableTextFormatting:i,disableTextColorAction:T(k.textColor.sections),disableDeleteBlock:v,disableInsertBlockAction:T(k.insertBlock.sections),disableTurnIntoAction:T(k.turnInto.sections),shouldShowTemplatesButton:s,disableIndent:g,disableUnindent:b,disableUndo:S,disableRedo:f,disableTextActions:c,isEditingTitle:v,disableLinkAction:h,disableEquationAction:p,shouldShowTextActions:!0===a}})),this.templateButtonSectionsStore=this.createComputedStore((()=>({id:"mab.buttonSection.template",buttons:[g("mab.button.choose_template","webAction_generic",{content:{type:"text_and_icon",imageReference:{localImageIdentifier:"template"},text:N.default.formatMessage(ie.templatesButtonTitle)},apiRequestValue:{jsonPayload:f("showActionBarMenu",{actionBarMenuId:"template"})}})]}))),this.primaryActionButtonSectionsStoreV2=this.createComputedStore((()=>{const{createAIAction:e,disableAIAction:t,disableBlockActions:i,disableCommentAction:o,disableMentionAction:n,selectedMenuType:s,disableInsertBlockAction:r,disableTurnIntoAction:a,disableTextFormatting:l,disableDeleteBlock:c,disableUndo:u,disableIndent:m,disableUnindent:p}=this.buttonSectionsConfigStore.state,b=this.textSelectedBlocksStore.state;return function(e){const{createAIAction:t,disableAIAction:i,disableBlockActions:o,disableCommentAction:n,disableMentionAction:s,selectedMenuType:r,disableInsertBlockAction:a,disableTurnIntoAction:l,disableTextFormatting:c,disableDeleteBlock:u,disableUndo:m,disableIndent:p,disableUnindent:b,someBlockPrioritizesIndentation:v,supportsSectionAnimation:S,isVoiceInputSupported:y,isVoiceInputActive:C,voiceInputStage:M,accessibilityTexts:k}=e,T=!(o||p&&b),A={ai:t?g("mab.button.ai","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"sparkles",localImageIdentifier:"ai",imageTintColor:(0,d.J1)(d.FN.light.purple[500])},disabled:i,accessibilityText:k.ai},apiRequestValue:{jsonPayload:f("blockAction",{action:"ai"})}}):void 0,speech:y?g("mab.button.speech","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:C?"listening"===M?"ellipsis":"mic.fill":"mic",localImageIdentifier:C?"listening"===M?"ellipsis":"micFilled":"mic"},disabled:!1,accessibilityText:k.ai},apiRequestValue:{jsonPayload:f("blockAction",{action:"voiceInput"})}}):void 0,insert:g("mab.button.insert","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"plus",localImageIdentifier:"insertBlock"},accessibilityText:k.insert,disabled:o||a,selected:"insertBlock"===r},apiRequestValue:{menuType:"insertBlock"}}),turnInto:g("mab.button.turnInto","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:o||l,selected:"turnInto"===r,accessibilityText:k.turnInto},apiRequestValue:{menuType:"turnInto"}}),filePicker:g("mab.button.filePicker","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"photo.on.rectangle.angled",localImageIdentifier:"filePicker"},disabled:o,accessibilityText:k.filePicker},apiRequestValue:{jsonPayload:f("blockAction",{action:"filePicker"})}}),mention:g("mab.button.mention","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"at",localImageIdentifier:"mention"},disabled:s,accessibilityText:k.mention},apiRequestValue:{jsonPayload:f("blockAction",{action:"mention"})}}),comment:g("mab.button.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:n,accessibilityText:k.comment},apiRequestValue:{jsonPayload:f("blockAction",{action:"comment"},"mobile_action_bar")}}),biu:g("bold.italic.underline","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"textformat",localImageIdentifier:"textFormat"},disabled:c,accessibilityText:k.textFormatting},apiRequestValue:{subMenuType:"textFormatting"}}),delete:g("mab.button.delete","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"trash",localImageIdentifier:"trash"},disabled:u,accessibilityText:k.trash},apiRequestValue:{jsonPayload:f("blockAction",{action:"trash"})}}),undo:g("mab.button.undo","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.uturn.backward",localImageIdentifier:"undo"},accessibilityText:k.undo,disabled:m},apiRequestValue:{jsonPayload:f("blockAction",{action:"undo"})}}),more:g("mab.button.more","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"ellipsis",localImageIdentifier:"more"},accessibilityText:k.more,disabled:o},apiRequestValue:{jsonPayload:f("blockAction",{action:"more"})}}),indent:g("mab.button.indent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"decrease.indent",localImageIdentifier:"unindent"},accessibilityText:k.indent,disabled:o||b},apiRequestValue:{jsonPayload:f("blockAction",{action:"unindent"})}}),unindent:g("mab.button.unindent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"increase.indent",localImageIdentifier:"indent"},accessibilityText:k.unindent,disabled:o||p},apiRequestValue:{jsonPayload:f("blockAction",{action:"indent"})}}),moveUp:g("mab.button.moveUp","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.up.to.line.alt",localImageIdentifier:"moveUp"},accessibilityText:k.moveUp,disabled:o},apiRequestValue:{jsonPayload:f("blockAction",{action:"moveUp"})}}),moveDown:g("mab.button.moveDown","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.down.to.line.alt",localImageIdentifier:"moveDown"},accessibilityText:k.moveDown,disabled:o},apiRequestValue:{jsonPayload:f("blockAction",{action:"moveDown"})}})};if(T&&v){const e=[A.indent,A.unindent,A.moveUp,A.moveDown].filter(h.$K),t=[A.ai,A.insert,A.turnInto,A.filePicker,A.biu,A.comment,A.undo,A.mention,A.delete,A.more].filter(h.$K);return S?[{id:"mab.buttonSection.listPrioritized",buttons:e,skipSectionDivider:!0},{id:"mab.buttonSection.main",buttons:t}]:[{id:"mab.buttonSection.listPrioritized",buttons:e.concat(t),skipSectionDivider:!0}]}return[{id:"mab.buttonSection.main",buttons:[A.ai,A.speech,A.insert,A.turnInto,A.filePicker,A.biu,A.comment,A.undo,A.mention,A.delete,A.indent,A.unindent,A.moveUp,A.moveDown,A.more].filter(h.$K)}]}({createAIAction:e,disableAIAction:t,disableBlockActions:i,disableCommentAction:o,disableMentionAction:n,selectedMenuType:s,disableInsertBlockAction:r,disableTurnIntoAction:a,disableTextFormatting:l,disableDeleteBlock:c,disableUndo:u,disableIndent:m,disableUnindent:p,someBlockPrioritizesIndentation:!!b&&b.some((e=>{const t=e.getType();return t&&oe[t]})),supportsSectionAnimation:this.environment.device.isIOS,isVoiceInputSupported:D.Z.state.isSupported,isVoiceInputActive:D.Z.state.active,voiceInputStage:D.Z.state.stage,accessibilityTexts:{insert:N.default.formatMessage(ie.accessibilityInsert),turnInto:N.default.formatMessage(ie.accessibilityTurnInto),filePicker:N.default.formatMessage(ie.accessibilityFilePicker),mention:N.default.formatMessage(ie.accessibilityMention),comment:N.default.formatMessage(ie.accessibilityComment),textFormatting:N.default.formatMessage(ie.accessibilityTextFormatting),trash:N.default.formatMessage(ie.accessibilityTrash),ai:N.default.formatMessage(ie.accessibilityAi),undo:N.default.formatMessage(ie.accessibilityUndo),more:N.default.formatMessage(ie.accessibilityMore),indent:N.default.formatMessage(ie.accessibilityIndent),unindent:N.default.formatMessage(ie.accessibilityDedent),moveUp:N.default.formatMessage(ie.accessibilityMoveUp),moveDown:N.default.formatMessage(ie.accessibilityMoveDown)}})})),this.textFormattingButtonSectionsStoreV2=this.createComputedStore((()=>{const{disableCommentAction:e,selectedMenuType:t,disableTextActions:i,disableTextColorAction:o,disableLinkAction:n,disableEquationAction:s,disableBlockActions:r,disableTurnIntoAction:a,disableAIAction:l,createAIAction:c,shouldShowTextActions:u}=this.buttonSectionsConfigStore.state;return function(e){const{disableTextActions:t,boldSelected:i,italicSelected:o,underlineSelected:n,strikeSelected:s,codeSelected:r,linkSelected:a,equationSelected:l,selectedMenuType:c,disableTextColorAction:u,disableCommentAction:m,disableLinkAction:p,disableEquationAction:b,textColorImageReference:v,accessibilityTexts:S,disableBlockActions:y,disableTurnIntoAction:C,disableAIAction:M,createAIAction:k,shouldShowTextActions:T}=e,A=T?"textSelectionColor":"textColor",I={back:g("mab.button.back","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.backward.2",localImageIdentifier:"back"},accessibilityText:S.close},apiRequestValue:{subMenuType:null}}),bold:g("mab.button.bold","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bold",localImageIdentifier:"bold"},accessibilityText:S.bold,disabled:t,selected:i},apiRequestValue:{jsonPayload:f("blockAction",{action:"bold"})}}),italic:g("mab.button.italic","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"italic",localImageIdentifier:"italic"},disabled:t,selected:o,accessibilityText:S.italics},apiRequestValue:{jsonPayload:f("blockAction",{action:"italic"})}}),underline:g("mab.button.underline","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"underline",localImageIdentifier:"underline"},disabled:t,selected:n,accessibilityText:S.underline},apiRequestValue:{jsonPayload:f("blockAction",{action:"underline"})}}),strikethrough:g("mab.button.strikethrough","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"strikethrough",localImageIdentifier:"strikethrough"},disabled:t,selected:s,accessibilityText:S.strikethrough},apiRequestValue:{jsonPayload:f("blockAction",{action:"strikethrough"})}}),color:g("mab.button.textFormatting.textSelectionColor.native","nativeAction_setMenuType",{content:{type:"icon",imageReference:v,disabled:t||u,selected:c===A,accessibilityText:S.textColor},apiRequestValue:{menuType:A}}),comment:g("mab.button.textFormatting.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:t||m,accessibilityText:S.comment},apiRequestValue:{jsonPayload:f("blockAction",{action:"comment"},"mobile_text_formatting_menu")}}),link:g("mab.button.link","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"link",localImageIdentifier:"link"},accessibilityText:S.link,disabled:t||p,selected:a},apiRequestValue:{jsonPayload:f("blockAction",{action:"link"})}}),code:g("mab.button.code","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.left.slash.chevron.right",localImageIdentifier:"code"},accessibilityText:S.code,disabled:t,selected:r},apiRequestValue:{jsonPayload:f("blockAction",{action:"code"})}}),equation:g("mab.button.equation","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"x.squareroot",localImageIdentifier:"equation"},accessibilityText:S.equation,disabled:t||b,selected:l},apiRequestValue:{jsonPayload:f("blockAction",{action:"equation"})}}),cancel:g("mab.button.cancel","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:S.close},apiRequestValue:{subMenuType:null}}),turnInto:g("mab.button.turnInto","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:y||C,selected:"turnInto"===c,accessibilityText:S.turnInto},apiRequestValue:{menuType:"turnInto"}}),ai:k?g("mab.button.ai","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"sparkles",localImageIdentifier:"ai",imageTintColor:(0,d.J1)(d.FN.light.purple[500])},disabled:M,accessibilityText:S.ai},apiRequestValue:{jsonPayload:f("blockAction",{action:"ai"})}}):void 0};let B;return B=T?[I.back,I.turnInto,I.ai,I.color,I.comment,I.bold,I.italic,I.underline,I.strikethrough,I.link,I.code,I.equation].filter(h.$K):[I.back,I.color,I.bold,I.italic,I.underline,I.strikethrough,I.link,I.code,I.equation],{id:"mab.buttonSection.textFormatting",shouldFadeIn:!0,buttons:B}}({disableTextActions:i,disableCommentAction:e,disableLinkAction:n,disableEquationAction:s,selectedMenuType:t,disableTextColorAction:o,disableBlockActions:r,disableTurnIntoAction:a,disableAIAction:l,createAIAction:c,shouldShowTextActions:u,textColorImageReference:this.imageReferenceForBlockColor(this.textSelectionColorStore.state),accessibilityTexts:{bold:N.default.formatMessage(ie.accessibilityBold),italics:N.default.formatMessage(ie.accessibilityItalics),underline:N.default.formatMessage(ie.accessibilityUnderline),strikethrough:N.default.formatMessage(ie.accessibilityStrikethrough),textColor:N.default.formatMessage(ie.accessibilityTextColor),comment:N.default.formatMessage(ie.accessibilityComment),code:N.default.formatMessage(ie.accessibilityCode),link:N.default.formatMessage(ie.accessibilityLink),equation:N.default.formatMessage(ie.accessibilityEquation),close:N.default.formatMessage(ie.accessibilityCloseTextFormattingMenu),turnInto:N.default.formatMessage(ie.accessibilityTurnInto),ai:N.default.formatMessage(ie.accessibilityAi)},...this.textFormattingSelectionStore.state})})),this.mainButtonSectionsStoreV2=this.createComputedStore((()=>{const{shouldShowTemplatesButton:e}=this.buttonSectionsConfigStore.state;return e?[this.templateButtonSectionsStore.state]:this.primaryActionButtonSectionsStoreV2.state})),this.textSelectionPositionsStore=this.createComputedStore((()=>{const e=this.textSelectionCompositeStore.state;if(!e)return;const{source:t,...i}=e;return i}),!0),this.textSelectionCompositeStore=this.createComputedStore((()=>{const e=(e,t)=>{if(!e||"editing"!==e.mode)return;const{multiSelection:i}=e;return{startRecord:i.start.store.pointer,startIndex:i.start.index,endRecord:i.end.store.pointer,endIndex:i.end.index,source:t}};return e(z.default.state,"TextSelectionStore")||e(this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,"IgnoreSelectionAreaStore")}),!0),this.renderStore=this.createComputedStore((()=>{var e;const t=O.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state);if(!t){const e=this.environment.NativeMobileActionBarStore;null!==(null==e?void 0:e.state.menuType)&&u.gw((()=>{var e;O.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||this.setCurrentMenuType(null,!1)}),500),null!==(null==e?void 0:e.state.subMenuType)&&u.gw((()=>{var e;O.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||this.setCurrentSubMenuType(null,!1)}),500)}return t})),this.shouldShowTextActions=this.createComputedStore((()=>O.oQ(this.props.stores.ignoreSelectionAreaStore,this.environment.TextSelectionCompositionStore))),this.canTriggerBlockActions=this.createComputedStore((()=>O.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state))),this.canTriggerTextActions=this.createComputedStore((()=>O.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore))),this.memoizedNativeMenus=u.HP((e=>{const{blocks:t,environment:i}=e;return o={environment:i,blocks:t,publicEditMode:void 0},{insertBlock:X({type:"insertBlock",actionSections:Y.L1(K.v.state.insertActions,o),context:o,closeParentMenu:!0}),turnInto:X({type:"turnInto",actionSections:Y.L1([Q.g],o),context:o,closeParentMenu:!0}),textColor:X({type:"textColor",actionSections:Y.L1([j.rz,j.Vm],o),context:o,closeParentMenu:!0}),textSelectionColor:X({type:"textSelectionColor",actionSections:Y.L1([j.b4,j.Sw],o),context:o,closeParentMenu:!0})};var o}),(e=>{let{blocks:t,environment:i}=e;const o=t.map((e=>e.key)).join(",");return`${i.key}-${o}`})),this.textFormattingSelectionStore=this.createComputedStore((()=>{let e;e="editing"===z.default.state.mode?(0,V.k2)([A.GKr.Bold,A.GKr.Italic,A.GKr.Underline,A.GKr.Strike,A.GKr.Code,A.GKr.Link,A.GKr.Equation,A.GKr.Highlight],z.default.state.multiSelection,z.default.state.forceExtendAnnotations):{};const t=e[A.GKr.Highlight];return{boldSelected:Boolean(e[A.GKr.Bold]),italicSelected:Boolean(Boolean(e[A.GKr.Italic])),underlineSelected:Boolean(Boolean(e[A.GKr.Underline])),strikeSelected:Boolean(Boolean(e[A.GKr.Strike])),codeSelected:Boolean(e[A.GKr.Code]),linkSelected:Boolean(e[A.GKr.Link]),equationSelected:Boolean(e[A.GKr.Equation]),highlightColor:t?(0,A.zIN)(t):void 0}})),this.textSelectionColorStore=this.createComputedStore((()=>{const{NativeMobileActionBarStore:e}=this.environment,t=e&&null!==e.state.menuType?this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState:void 0;if(!t)return this.textFormattingSelectionStore.state.highlightColor;const i="editing"===t.mode&&(0,V.a6)("h",t.multiSelection,t.forceExtendAnnotations);return i?(0,A.zIN)(i):void 0})),this.textColorStore=this.createComputedStore((()=>W.default.state.stores.length>0?W.default.state.stores[0].getFormat().block_color:void 0))}didMount(){this.textSelectionCompositeStore.addListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.addListener(this.handleTextSelectionStoreChanged)}willUnmount(){this.textSelectionCompositeStore.removeListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.removeListener(this.handleTextSelectionStoreChanged),this.props.renderApi&&this.props.renderApi({type:"unmount",id:""})}renderComponent(){const{fallbackRenderer:e,stores:t}=this.props;return n()(ne,{isOpen:this.renderStore.state.shouldShow,canShow:this.renderStore.state.canShowNativeBar,isEmpty:this.renderStore.state.isEmpty,schema:this.getCurrentActionBarSchema.state,onAction:this.handleMobileActionBarBridgeEvent,fallbackRenderer:e&&(()=>e(t))})}recomputeCurrentActionBarSchema(){const{selectedMenuType:e,selectedSubMenu:t}=this.buttonSectionsConfigStore.state,i=this.reactiveMemoizedNativeMenusStore.state;return function(e){const{selectedMenu:t,selectedSubMenu:i,nativeMenus:o,buttonSections:n,nativeSubMenus:s,accessibilityTexts:r}=e;return{nativeMenus:o,nativeSubMenus:s,state:{buttonSections:n,selectedMenu:t,selectedSubMenu:i,dismissKeyboardButton:null!==t?g("mab.dismissKeyboard","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:r.closeActionMenu},apiRequestValue:{menuType:null}}):g("mab.dismissKeyboard","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"keyboard.chevron.compact.down",localImageIdentifier:"keyboardDown"},accessibilityText:r.dismissKeyboard},apiRequestValue:{jsonPayload:f("blockAction",{action:"dismissKeyboard"})}}),mutatedNativeMenus:{},localizedMessages:{}}}}({selectedMenu:e,selectedSubMenu:t,nativeMenus:{textColor:{id:"textColor",title:N.default.formatMessage(ie.actionMenuColorTitle),sections:i.textColor.sections},textSelectionColor:{id:"textSelectionColor",title:N.default.formatMessage(ie.actionMenuColorTitle),sections:i.textSelectionColor.sections},insertBlock:{id:"insertBlock",title:N.default.formatMessage(ie.actionMenuInsertBlockTitle),sections:i.insertBlock.sections},turnInto:{id:"turnInto",title:N.default.formatMessage(ie.actionMenuTurnIntoTitle),sections:i.turnInto.sections}},nativeSubMenus:{textFormatting:[this.textFormattingButtonSectionsStoreV2.state]},buttonSections:this.mainButtonSectionsStoreV2.state,accessibilityTexts:{dismissKeyboard:N.default.formatMessage(ie.accessibilityDismissKeyboard),closeActionMenu:N.default.formatMessage(ie.accessibilityCloseActionMenu)}})}commentActionDisabled(e,t){return!(!e||!(0,c._T)(e,t))}mentionActionDisabled(e){return!(!e||!(0,c.lQ)(e))}handleSetMenuTypeAction(e){const t=function(e){if("nativeAction_setMenuType"!==e.type)return new k(M.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("menuType"in t))return new k(M.MissingPayload,void 0);const i=p.object({required:{menuType:p.literals(...b,null)},optional:{}}),o=(0,m.Gu)(i,t);return o?new k(M.InvalidRequestType,JSON.stringify(o)):t.menuType}(e);if(t instanceof k)return void console.error(JSON.stringify(t));if((this.environment.NativeMobileActionBarStore?this.environment.NativeMobileActionBarStore.state.menuType:null)===t)this.setCurrentMenuType(null,!0);else switch(this.setCurrentMenuType(t,!0),t){case"insertBlock":O.Oh(this.environment,"insert");break;case"turnInto":O.Oh(this.environment,"turn_into");break;case"textColor":O.Oh(this.environment,"color","mobile_action_bar");break;case"textSelectionColor":O.Oh(this.environment,"color","mobile_text_formatting_menu")}}handleSetSubMenuTypeAction(e){const t=function(e){if("nativeAction_setSubMenuType"!==e.type)return new k(M.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("subMenuType"in t))return new k(M.MissingPayload,void 0);const i=p.object({required:{subMenuType:p.literals(...v,null)},optional:{}}),o=(0,m.Gu)(i,t);return o?new k(M.InvalidRequestType,JSON.stringify(o)):t.subMenuType}(e);t instanceof k?console.error(JSON.stringify(t)):this.setCurrentSubMenuType(t,!0)}handleGenericWebAction(e){const t=function(e){if("webAction_generic"!==e.type)return new k(M.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("jsonPayload"in t))return new k(M.MissingPayload,void 0);const i=JSON.parse(t.jsonPayload),o=p.object({required:{type:p.literals(...C)},optional:{}}),n=(0,m.Gu)(o,i);if(n)return new k(M.InvalidRequestType,JSON.stringify(n));const s=i,r=y[s.type],a=(0,m.Gu)(r,s);return a?new k(M.InvalidData,JSON.stringify(a)):s}(e);if(t instanceof k)console.error(JSON.stringify(t));else switch(t.type){case"blockAction":if("dismissKeyboard"===t.data.action){this.handleDismissKeyboard();break}const e=te[t.data.action];if(!e)break;const i=e.action;if(i){const{mainEditorCurrentBlockStore:t}=q.default.state;if(!t)break;const{device:o}=this.environment;e.closeParentMenu&&!o.isTablet&&this.setCurrentMenuType(null,!0),i({environment:this.environment,blocks:[t],publicEditMode:void 0})}switch(t.data.action){case"comment":B.YOV(this.environment,{itemName:"comment",from:t.from})}break;case"showActionBarMenu":switch(t.data.actionBarMenuId){case"insertBlock":this.handleInsert();break;case"textColor":this.handleTextColor();break;case"turnInto":this.handleTurnInto();break;case"template":this.handleTemplate()}}}handleActionRegistryAction(e){var t,i;const o=null===(t=e.apiRequestValue)||void 0===t?void 0:t.menuType,n=null===(i=e.apiRequestValue)||void 0===i?void 0:i.actionId;if(!o||!n)return;const s=this.memoizedNativeMenus({environment:this.environment,blocks:W.default.state.stores})[o].actions[n];if(!s)return;const r=s.action;r&&(s.closeParentMenu&&this.setCurrentMenuType(null,!0),r({environment:this.environment,blocks:W.default.state.stores,publicEditMode:void 0}));const a=W.default.state.stores[0];if(a){const e=a.getType(),t=a.getFormat();B.dhV(this.environment,{analyticsName:s.analyticsName,from:"slash_menu",block_id:a.id,block_type:e,is_toggleable:e?(0,U._A)(e,t):void 0,slash_menu_filter_length:0,slash_menu_section:`Mobile Action Bar ${o}`})}}handleDismissKeyboard(){P.ZH(this.environment),E.HM.clearSelection(),this.props.stores.store.update((e=>({...e,isInsertOpen:!1}))),this.setCurrentMenuType(null,!1),this.setCurrentSubMenuType(null,!1),O.Oh(this.environment,"hide_keyboard"),Z.sD()}imageReferenceForBlockColor(e){let t="textColor";const i=d.E_.find((t=>t===e));let o;"default"===e||i&&(i.includes("background")?(o="background",t="textBackgroundColor"):o="color");const n=o&&i?(0,d.fi)(i,this.theme)[o]:void 0;return{localImageIdentifier:t,imageTintColor:n?(0,d.J1)(n):void 0}}handleInsert(){this.props.stores.store.update((e=>({...e,isInsertOpen:!0}))),O.Oh(this.environment,"insert")}handleTurnInto(){this.props.stores.store.update((e=>({...e,isTurnIntoOpen:!0}))),O.Oh(this.environment,"turn_into")}handleTemplate(){P.ZH(this.environment),Z.sD(),this.props.stores.store.update((e=>({...e,isTemplatesOpen:!0}))),O.Oh(this.environment,"templates")}handleTextColor(){this.props.stores.store.update((e=>({...e,isColorOpen:!0}))),O.Oh(this.environment,"color")}setCurrentMenuType(e,t){var i;null===(i=this.environment.NativeMobileActionBarStore)||void 0===i||i.update((i=>({...i,menuType:e,shouldRestoreSelectionForMenu:t})))}setCurrentSubMenuType(e,t){const{NativeMobileActionBarStore:i}=this.environment;null==i||i.update((i=>({...i,isSubMenuOverridden:t,subMenuType:e}))),null!==e&&O.Oh(this.environment,e)}}se.displayName="NativeMobileActionBar";const re=(0,I.injectIntl)(se)},83388:(e,t,i)=>{i.r(t),i.d(t,{default:()=>m});var o=i(67294),n=i(480),s=i(86628),r=i(97444),a=i(39699),l=(i(21703),i(57658),i(77080)),c=i(19361);class d{static isEligible(){return"webkitSpeechRecognition"in window}constructor(){this.recognition=void 0,this.autoRestart=!0,this.listener=void 0;"webkitSpeechRecognition"in window&&(this.recognition=new webkitSpeechRecognition,this.recognition.continuous=!0,this.recognition.interimResults=!1,this.recognition.maxAlternatives=1,this.recognition.onstart=()=>{},this.recognition.onspeechstart=()=>{var e,t;null===(e=this.listener)||void 0===e||null===(t=e.onStageChanged)||void 0===t||t.call(e,"listening")},this.recognition.onspeechend=()=>{var e,t;null===(e=this.listener)||void 0===e||null===(t=e.onStageChanged)||void 0===t||t.call(e,"inactive")},this.recognition.onerror=e=>{var t,i,o,n;switch(e.error){case"network":this.autoRestart=!1,null===(t=this.recognition)||void 0===t||t.abort();break;case"not-allowed":case"service-not-allowed":this.autoRestart=!1,null===(i=this.recognition)||void 0===i||i.abort(),null===(o=this.listener)||void 0===o||null===(n=o.onPermissionNotAvailable)||void 0===n||n.call(o);break;case"no-speech":this.restart()}},this.recognition.onend=()=>{this.restart()},this.recognition.onresult=e=>{if(e.results)for(var t=e.resultIndex;t<e.results.length;++t){var i,o,n;if(e.results[t].isFinal)null===(i=this.listener)||void 0===i||null===(o=(n=i).onResult)||void 0===o||o.call(n,`${e.results[t][0].transcript} `)}})}restart(){var e;this.autoRestart&&(null===(e=this.recognition)||void 0===e||e.start())}start(e){var t;this.listener=e,this.autoRestart=!0,null===(t=this.recognition)||void 0===t||t.start()}stop(){var e;this.listener=void 0,this.autoRestart=!1,null===(e=this.recognition)||void 0===e||e.stop()}}class u{constructor(e){if(this.id="",this.listener=void 0,this.mediaRecorder=void 0,!e)throw Error("unable to initialize provider without id");this.id=e}async initialize(){const e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1}),t=[];this.mediaRecorder=new MediaRecorder(e,{mimeType:"audio/webm"}),this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&t.push(e.data)},this.mediaRecorder.onstop=i=>{e.getTracks().forEach((e=>e.stop()));const o=new Blob(t);this.transcribe(o)},this.mediaRecorder.start()}async transcribe(e){var t,i;const o=await fetch("https://api-inference.huggingface.co/models/openai/whisper-tiny",{headers:{Authorization:`Bearer ${this.id}`},method:"POST",body:e}),n=await o.json();null===(t=this.listener)||void 0===t||null===(i=t.onResult)||void 0===i||i.call(t,n.text)}start(e){this.listener=e,this.initialize()}stop(){var e;null===(e=this.mediaRecorder)||void 0===e||e.stop()}}var h=i(24666);const m=()=>{window.__c={n:"NativeVoiceInput"};const e=(0,n.O7)(),[t,i]=(0,s.VK)((()=>{const e="mobile_voice_input";return[l.default.getEligibleGroup({experimentId:e,defaultGroup:"control",disableExposureLogging:!0}),l.default.getEligibleGroup({experimentId:e,parameter:"id",defaultGroup:"",disableExposureLogging:!0})]}),[]),m=(0,o.useMemo)((()=>({onResult:t=>{const i=h.default.state;"editing"===i.mode&&a.createAndCommit({userAction:"NativeVoiceInput.onVoiceInputResult",environment:e,perform:o=>{r.hJ({environment:e,string:t,multiSelection:i.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}})},onStageChanged:e=>{c.Z.update((t=>({...t,stage:e})))},onPermissionNotAvailable:()=>{c.Z.update((e=>({...e,active:!1,hasPermissions:!1})))}})),[e]);return(0,o.useEffect)((()=>{const e=function(e,t,i,o){let n;if("web_system_api"===t?d.isEligible()&&(n=new d):"third_party_whisper"===t&&i&&(n=new u(i)),n)return l.default.manuallyLogExperimentExposure("mobile_voice_input"),c.Z.update((e=>({...e,isSupported:!0}))),c.Z.addListener((e=>{var t,i;e.state.isSupported&&e.state.hasPermissions&&e.state.active?null===(t=n)||void 0===t||t.start(o):null===(i=n)||void 0===i||i.stop()})),n}(0,t,i,m);return()=>{null==e||e.stop()}}),[e,t,i,m]),null}},40863:(e,t,i)=>{i.d(t,{BO:()=>v,Ft:()=>h,Lh:()=>C,YG:()=>m,du:()=>b,y$:()=>g});i(57658);var o=i(30120),n=i(30823),s=i(40506),r=i(53877),a=i(42875),l=i(72126),c=i(59753),d=i(5366),u=i(28020);function h(e){const{collectionContextStore:t}=e,i=t.collectionViewStore();if(!i)return;const o=t.normalizedSchemaStore.state,n=i.getQuery(o);if(!n||!n.calendar_by)return;const s=t.dateRangeStart.state,l=t.dateRangeEnd.state,c=(0,r.hT)(s,(0,a.r)()),d=(0,r.hT)(l,(0,a.r)());return p({calendarBy:n.calendar_by,dateRangeStartDate:c,dateRangeEndDate:d})}function m(e){const{collectionContextStore:t,startOfDay:i}=e,n=t.collectionViewStore();if(!n)return;const s=t.normalizedSchemaStore.state,l=n.getQuery(s);if(!l||!l.calendar_by)return;const c=o.ou.fromMillis(i).endOf("day").valueOf(),d=(0,r.hT)(i,(0,a.r)()),u=(0,r.hT)(c,(0,a.r)());return p({calendarBy:l.calendar_by,dateRangeStartDate:d,dateRangeEndDate:u})}function p(e){const{dateRangeStartDate:t,dateRangeEndDate:i,calendarBy:o}=e;return{type:"results",filter:{operator:"and",filters:[{property:o,filter:{operator:"date_is_on_or_after",use_end:!0,value:{type:"exact",value:t}}},{property:o,filter:{operator:"date_is_on_or_before",value:{type:"exact",value:i}}}]},limit:5e3}}function g(e){const{collectionContextStore:t,results:i,getRecordValue:o,intl:n}=e,c=t.collectionViewStore(),d=t.normalizedQueryStore.state,h=t.normalizedSchemaStore.state,m=d?d.calendar_by:void 0,p=t.dateRangeStart.state,g=t.dateRangeEnd.state,f=u.AK.state,y=(0,a.r)(),C=t.getCurrentUserId();if(!(c&&d&&m&&h))return;const M=l.oA(i.map((e=>v({blockStore:e,calendarBy:m,schema:h,getRecordValue:o,userId:C,intl:n})))),k={};i.forEach(((e,t)=>{k[e.id]=t}));0===(d.sort||[]).length&&M.sort(((e,t)=>{const i=e.start.valueOf(),o=t.start.valueOf();if(i===o){return k[e.id]-k[t.id]}return i-o}));const T=(0,r.em)(p,f,y),A=(0,r.gQ)(g,f,y);let I=T;const B=[];do{const e=(0,r.gQ)(I.valueOf(),f,y),t={},i=M.filter((t=>(0,s.b8)(I.valueOf(),e.valueOf(),t.start.valueOf(),t.end?t.end.valueOf():void 0))).map((i=>{const{id:o,start:n,end:s,includeTime:r,timeZone:a}=i,{startColumn:l,columnCount:c}=b({startUnixTimestampMS:n.valueOf(),endUnixTimestampMS:s?s.valueOf():void 0,startOfWeekUnixTimestampMS:I.valueOf(),endOfWeekUnixTimestampMS:e.valueOf()}),d=S(l,c,t);return{id:o,start:n.valueOf(),end:s?s.valueOf():void 0,row:d,includeTime:r,timeZone:a}}));B.push({start:I.valueOf(),end:e.valueOf(),items:i}),I=(0,r.em)(I.plus({week:1}).plus({hour:25}).valueOf(),f,y)}while(I<A);return B}function b(e){const t=o.ou.fromMillis(e.startUnixTimestampMS),i=e.endUnixTimestampMS?o.ou.fromMillis(e.endUnixTimestampMS):void 0,n=o.ou.fromMillis(e.startOfWeekUnixTimestampMS),s=o.ou.fromMillis(e.endOfWeekUnixTimestampMS),r=t.startOf("day"),a=o.ou.max(n,r),l=a.diff(n,"days").get("days");let c=1;if(i){const e=i.endOf("day"),t=o.ou.min(s,e);c=Math.ceil(t.diff(a,"days").get("days"))}return{start:t,end:i,startOfWeek:n,endOfWeek:s,startColumn:l,columnCount:c}}function v(e){const{blockStore:t,calendarBy:i,schema:o,getRecordValue:s,intl:l,userId:d}=e,u=t.getModel();if(!u)return;const h=(0,n.FT)({property:i,schema:o,block:u,getRecordModel:c.om.fromGetRecordValueFn(s),propertyMapping:void 0,collectionRequestContext:{userId:d,userTimeZone:(0,a.r)(),depth:0,intl:l,visitedProperties:new Set,resultCache:{}}}).next().value;if("date"!==h.type)return;const m=h.value,p=m&&(0,r.NK)(m,(0,a.r)());if(!m||!p)return;return{id:u.id,start:p.start,end:p.end,includeTime:"datetime"===m.type||"datetimerange"===m.type,timeZone:"datetime"===m.type||"datetimerange"===m.type?m.time_zone:void 0}}function S(e,t,i){let o=0;for(;;){let n=!1;for(let s=0;s<t;s++)f(i,e+s,o)&&(n=!0);if(!n)break;o++}for(let n=0;n<t;n++)y(i,e+n,o);return o}function f(e,t,i){return Boolean(e[i]&&e[i][t])}function y(e,t,i){e[i]||(e[i]={}),e[i][t]=!0}const C=(0,d.defineMessages)({week:{defaultMessage:"Week",id:"calendar.viewRanges.week"},month:{defaultMessage:"Month",id:"calendar.viewRanges.month"}})},30439:(e,t,i)=>{i.r(t),i.d(t,{TopLevelMobileComponents:()=>M});var o=i(23174),n=i.n(o),s=i(67294),r=i(480),a=i(86628),l=i(22433),c=i(31945),d=i(77137),u=i(24553),h=i(28385),m=i(61671),p=i(78902),g=i(43250),b=i(71119),v=i(27177),S=i(80444),f=i(90848),y=i(12768),C=i(72087);function M(){window.__c={n:"TopLevelMobileComponents"};const e=(0,r.O7)(),t=(0,a.qz)(void 0,C.Z),i=(0,a.VK)((()=>{const e=y.default.state;return e.isOnboarding&&"workspace_setup"===e.stage}),[]),o=(0,a.VK)((()=>S.default.state.currentSpaceStore),[]),l=(0,a.VK)((()=>S.default.state.mainEditorCurrentBlockStore),[]),c=(0,a.VK)((()=>o&&o.canEdit()),[o]);return i?s.createElement(s.Fragment,null):n()("div",{className:g.alX},void 0,n()(v.Z,{createType:"add-account"}),o&&n()(h.Z,{store:o}),n()(d.Z,{request:{},render:()=>null,requestStore:t,performRequest:()=>(0,b.pu)(e)}),n()(m.Z,{passwordRequestStore:t}),c&&l&&n()(p.Z,{store:l,isMobile:!0}),n()(u.Z,{}),n()(k,{}))}function k(){return n()(c.ZP,{buttonPopupStore:f.Z,popupType:c.Z4.SlideUp,originGap:0,stopClickPropagation:!0,render:e=>n()("div",{style:{width:"100%",height:400,display:"flex",flexDirection:"column",paddingBottom:10}},void 0,n()(l.UpdateSidebarTabAssistant,{})),isFullWidthOnMobile:!0,preventScaleTransition:!0,renderOrigin:e=>n()("div",{})})}},27177:(e,t,i)=>{i.d(t,{Z:()=>k});var o=i(10434),n=i.n(o),s=i(23174),r=i.n(s),a=(i(21703),i(67294)),l=i(83355),c=i(5366),d=i(50906),u=i(75018),h=i(52275),m=i(31945),p=i(46457),g=i(43250),b=i(88632),v=i(96071),S=i(30278),f=i(85974),y=i(64157),C=i(17364);class M extends l.Z{constructor(){super(...arguments),this.storeTypes={loginStore:f.Z,loginPermissionsStore:S.Z,loginModalStore:v.Z},this.renderAccountActionModal=(e,t)=>{let i,o;switch(e){case"add-account":i=r()(c.FormattedMessage,{id:"sidebarSwitcherMultiAccount.addAccount.title",defaultMessage:"Add an account"}),o=r()(c.FormattedMessage,{id:"sidebarSwitcherMultiAccount.addAccount.description",defaultMessage:"Use an existing account, or sign up with a new email. Your current account will remain logged in."});break;case"create-work":i=r()(c.FormattedMessage,{id:"sidebarSwitcherMultiAccount.createWork.title",defaultMessage:"Create a work account"}),o=r()(c.FormattedMessage,{id:"sidebarSwitcherMultiAccount.createWork.description",defaultMessage:"Weâ€™ll check if your teammates are already on Notion. If not, weâ€™ll create a new home for you and your team."});break;default:throw new Error(this.props.intl.formatMessage({defaultMessage:"Unexpected createType in SidebarSwitcherMultiAccount",id:"sidebarSwitcherMultiAccount.errorMessage"}))}return r()(p._,{loginModalStore:this.stores.loginModalStore,loginStore:this.stores.loginStore,title:i,description:o,disableLoginLink:this.props.disableLoginLink,className:g.zYS,redirectURL:this.props.redirectURL,onDismiss:t})},this.supportsNativeHomeOnPhone=()=>{const{mobileNative:e}=this.environment;return(null==e?void 0:e.supportsNativeHomeOnPhone())||!1},this.getAccountActionStyle=()=>{const{device:e}=this.environment;return{display:"flex",color:this.theme.mediumTextColor,whiteSpace:"nowrap",fontSize:e.isMobile?16:12}}}willMount(e){super.willMount(e);const{loginStore:t}=this.stores;"email"===t.state.loginType&&this.environment.device.isMobile&&t.setState({...t.state,loginType:"google"})}renderComponent(){const{online:e}=b.Z.state,{device:t}=this.environment,{createType:i}=this.props,o=this.supportsNativeHomeOnPhone();return t.isMobile?r()(m.ZP,{popupType:m.Z4.SlideUp,hidesMobileNativeBottomBar:o,preventSlideUpTransition:o,buttonPopupStore:"add-account"===i?y.C:y.E,alignmentToOrigin:m.vR.Start,placementToOrigin:m.pO.Top,originGap:0,isFullWidthOnMobile:!0,render:e=>this.renderAccountActionModal(i,(()=>{this.supportsNativeHomeOnPhone()?u.navigateToHomeTab(this.environment,e.close):e.close()})),preventScaleTransition:!0,renderOrigin:t=>a.createElement(h.Z,n()({focused:!1,disabled:!e,title:this.renderMenuButtonLoginTitle(i),icon:this.props.icon},t))}):r()("div",{onClick:()=>{e&&(d.D6i(this.environment,{createType:i}),C.Z.setState({...C.Z.getState(),createType:i}),this.stores.loginModalStore.setState({open:!0}))}},void 0,r()(h.Z,{focused:!1,disabled:!e,title:this.renderMenuButtonLoginTitle(i),icon:this.props.icon}),this.renderAccountActionModal(i))}renderMenuButtonLoginTitle(e){switch(e){case"create-work":return r()("div",{style:this.getAccountActionStyle()},void 0,r()(c.FormattedMessage,{defaultMessage:"Create work account",id:"sidebarSwitcherMultiAccount.menuItem.createWorkAccountButton.label"}));case"add-account":return r()("div",{style:this.getAccountActionStyle()},void 0,r()(c.FormattedMessage,{defaultMessage:"Add another account",id:"sidebarSwitcherMultiAccount.addAccountButton.label"}))}}}M.displayName="SidebarSwitcherLoginModal";const k=(0,c.injectIntl)(M)},63334:(e,t,i)=>{i.d(t,{Z:()=>s});var o=i(49085);class n extends o.default{getInitialState(){return{}}}const s=n},72653:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(14577),n=i(5162),s=i(69454),r=i(55320);const a=new o.Z((()=>{const{phase:e}=s.Z.state;if(r.default.state.open)return!0;return(0,n.Y)("supportsFixedSizeWebView")&&!s.Z.state.shouldResizeWebView||e===s.i.hidden||e===s.i.willHide}),{debugName:"MobileBottomBarStore"})},30278:(e,t,i)=>{i.d(t,{Z:()=>s});var o=i(49085);class n extends o.default{getInitialState(){return{contacts:!1}}}const s=n},40462:(e,t,i)=>{i.d(t,{o:()=>s});var o=i(23174),n=i.n(o);i(67294);const s=(0,i(45238).I)("globe2",{viewBox:"0 0 16 16",svg:n()("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM3.88477 3.76465C4.56836 3.11523 5.39551 2.61621 6.31836 2.34277C5.83301 2.82812 5.42285 3.51172 5.11523 4.3457C4.63672 4.19531 4.22656 3.99707 3.88477 3.76465ZM9.68848 2.34961C10.6045 2.62305 11.4316 3.11523 12.1084 3.76465C11.7734 4.00391 11.3633 4.19531 10.8848 4.35254C10.5771 3.51172 10.167 2.82812 9.68848 2.34961ZM8.47852 2.56836C9.0459 2.8418 9.56543 3.58008 9.93457 4.58496C9.4834 4.66699 8.99805 4.71484 8.47852 4.73535V2.56836ZM6.06543 4.58496C6.44141 3.58008 6.9541 2.8418 7.52148 2.56836V4.73535C7.00195 4.71484 6.5166 4.66699 6.06543 4.58496ZM2.05273 7.58594C2.14844 6.42383 2.58594 5.35059 3.25586 4.46875C3.67285 4.77637 4.21289 5.04297 4.8418 5.24121C4.66406 5.95215 4.54785 6.74512 4.51367 7.58594H2.05273ZM11.4863 7.58594C11.4521 6.74512 11.3359 5.95215 11.1582 5.24121C11.7871 5.04297 12.3271 4.7832 12.7373 4.46875C13.4141 5.35059 13.8516 6.42383 13.9473 7.58594H11.4863ZM5.49121 7.58594C5.52539 6.84082 5.62793 6.12988 5.78516 5.4873C6.33203 5.59668 6.91309 5.66504 7.52148 5.69238V7.58594H5.49121ZM8.47852 7.58594V5.69238C9.08691 5.66504 9.66797 5.59668 10.2148 5.4873C10.3721 6.12988 10.4746 6.84082 10.5088 7.58594H8.47852ZM2.05273 8.54297H4.51367C4.54785 9.39746 4.66406 10.1973 4.8418 10.915C4.21973 11.1133 3.68652 11.373 3.27637 11.6807C2.59277 10.792 2.14844 9.71191 2.05273 8.54297ZM5.49121 8.54297H7.52148V10.4707C6.91992 10.498 6.33203 10.5664 5.79199 10.6689C5.62793 10.0195 5.51855 9.29492 5.49121 8.54297ZM8.47852 10.4707V8.54297H10.5088C10.4814 9.29492 10.3721 10.0195 10.208 10.6689C9.66797 10.5664 9.08691 10.498 8.47852 10.4707ZM11.1582 10.915C11.3428 10.1973 11.4521 9.39746 11.4863 8.54297H13.9473C13.8516 9.71191 13.4072 10.792 12.7236 11.6807C12.3135 11.373 11.7803 11.1133 11.1582 10.915ZM8.47852 11.4277C8.99121 11.4482 9.47656 11.4961 9.9209 11.5781C9.55176 12.5625 9.03906 13.2939 8.47852 13.5605V11.4277ZM6.0791 11.5781C6.52344 11.4961 7.00879 11.4482 7.52148 11.4277V13.5605C6.96094 13.2939 6.44824 12.5625 6.0791 11.5781ZM3.90527 12.3848C4.24023 12.1523 4.65039 11.9609 5.12207 11.8105C5.42969 12.6309 5.83301 13.3008 6.30469 13.7793C5.40234 13.5059 4.58203 13.0205 3.90527 12.3848ZM10.8779 11.8105C11.3496 11.9609 11.7598 12.1523 12.0947 12.3848C11.418 13.0205 10.5977 13.5059 9.69531 13.7793C10.167 13.3008 10.5703 12.6309 10.8779 11.8105Z"})})},38780:(e,t,i)=>{i.d(t,{w:()=>s});var o=i(23174),n=i.n(o);i(67294);const s=(0,i(45238).I)("mobileBottomBarSearch",{viewBox:"0 0 26 26",svg:n()("path",{d:"M11.1416 19.3779C12.9355 19.3779 14.5898 18.7979 15.9434 17.8311L21.0352 22.9229C21.2715 23.1592 21.583 23.2773 21.916 23.2773C22.6143 23.2773 23.1084 22.7402 23.1084 22.0527C23.1084 21.7305 23.001 21.4297 22.7646 21.1934L17.7051 16.123C18.7686 14.7266 19.4023 12.9971 19.4023 11.1172C19.4023 6.57324 15.6855 2.85645 11.1416 2.85645C6.59766 2.85645 2.88086 6.57324 2.88086 11.1172C2.88086 15.6611 6.59766 19.3779 11.1416 19.3779ZM11.1416 17.5947C7.59668 17.5947 4.66406 14.6621 4.66406 11.1172C4.66406 7.57227 7.59668 4.63965 11.1416 4.63965C14.6865 4.63965 17.6191 7.57227 17.6191 11.1172C17.6191 14.6621 14.6865 17.5947 11.1416 17.5947Z"})})}}]);