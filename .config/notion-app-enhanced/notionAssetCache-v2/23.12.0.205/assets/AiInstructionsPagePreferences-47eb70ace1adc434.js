"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[7713],{39390:(e,n,t)=>{t.r(n),t.d(n,{AiInstructionsPagePreferences:()=>I});var o=t(10434),a=t.n(o),c=t(23174),i=t.n(c),l=t(67294),s=t(480),r=t(86628),d=t(24405),u=t(8848),h=t(59054),p=t(90199);const g=(0,t(45238).I)("slackLogoUnfilled",{viewBox:"0 0 16 16",svg:i()("g",{},void 0,i()("path",{d:"M1.68078 11.7915C2.60586 11.7915 3.36156 11.0358 3.36156 10.1107V8.42993H1.68078C0.755701 8.42993 0 9.18563 0 10.1107C0 11.0358 0.755701 11.7915 1.68078 11.7915Z"}),i()("path",{d:"M5.88928 8.42993C4.9642 8.42993 4.2085 9.18563 4.2085 10.1107V14.3192C4.2085 15.2443 4.9642 16 5.88928 16C6.81436 16 7.57006 15.2443 7.57006 14.3192V10.1107C7.57006 9.18563 6.81436 8.42993 5.88928 8.42993Z"}),i()("path",{d:"M4.2085 1.68078C4.2085 2.60586 4.9642 3.36156 5.88928 3.36156H7.57006V1.68078C7.57006 0.755701 6.81436 0 5.88928 0C4.9642 0 4.2085 0.755701 4.2085 1.68078Z"}),i()("path",{d:"M7.57003 5.88928C7.57003 4.9642 6.81433 4.2085 5.88925 4.2085H1.68078C0.755701 4.2085 0 4.9642 0 5.88928C0 6.81436 0.755701 7.57006 1.68078 7.57006H5.88925C6.81433 7.57006 7.57003 6.81436 7.57003 5.88928Z"}),i()("path",{d:"M10.1107 7.57003C11.0358 7.57003 11.7915 6.81433 11.7915 5.88925V1.68078C11.7915 0.755701 11.0358 0 10.1107 0C9.18563 0 8.42993 0.755701 8.42993 1.68078V5.88925C8.42993 6.81433 9.18563 7.57003 10.1107 7.57003Z"}),i()("path",{d:"M14.3192 4.2085C13.3941 4.2085 12.6384 4.9642 12.6384 5.88928V7.57006H14.3192C15.2443 7.57006 16 6.81436 16 5.88928C16 4.9642 15.2443 4.2085 14.3192 4.2085Z"}),i()("path",{d:"M8.42993 10.1107C8.42993 11.0358 9.18563 11.7915 10.1107 11.7915H14.3192C15.2443 11.7915 16 11.0358 16 10.1107C16 9.18563 15.2443 8.42993 14.3192 8.42993H10.1107C9.18563 8.42993 8.42993 9.18563 8.42993 10.1107Z"}),i()("path",{d:"M11.7915 14.3192C11.7915 13.3941 11.0358 12.6384 10.1107 12.6384H8.42993V14.3192C8.42993 15.2443 9.18563 16 10.1107 16C11.0358 16 11.7915 15.2443 11.7915 14.3192Z"}))});var C=t(72126),k=t(5366),m=t(97880),f=t(54642),S=t(4023),y=t(78030),w=t(53876),v=t(64921),x=t(31945),M=t(42876),A=t(38990);const Z=(0,k.defineMessages)({slackChannel:{id:"AiInstructionsPagePreferences.slackChannel",defaultMessage:"Slack channel"},selectChannel:{id:"AiInstructionsPagePreferences.selectChannel",defaultMessage:"Select a channel"},unknownChannel:{id:"AiInstructionsPagePreferences.unknownChannel",defaultMessage:"Unknown channel"}});function I(e){const{store:n}=e;return i()("div",{style:{paddingTop:8,paddingBottom:8}},void 0,i()("div",{style:{display:"flex",flexDirection:"column"}},void 0,i()(P,{store:n})))}function P(e){window.__c={n:"SlackChannelPagePreferenceRow"};const{store:n}=e,t=(0,s.O7)(),o=(0,s.Fy)(),c=(0,d.yK)((e=>({button:{alignSelf:"stretch",display:"flex",alignItems:"center",borderRadius:3,width:"100%",padding:w.sf[y.C.Page].text},selectChannelPlaceholder:{color:e.lightTextColor}})),[]),[{value:p},m]=(0,h.r5)((()=>f.getPageAssistantPreferences(t,{pageId:n.id,spaceId:n.getSpaceId()})),[t,n]),M=(0,l.useCallback)((async e=>{const{externalAuthentication:o,notificationChannel:a}=e;await f.setPageAssistantPreferences(t,{pageId:n.id,spaceId:n.getSpaceId(),operation:{type:"set_channel",botId:o.id,channelId:a.id}}),await m()}),[t,n,m]),I=(0,r.VK)((()=>n.canEdit()),[n]),P="success"===(null==p?void 0:p.type)?p.data:void 0,F=C.Ps((null==P?void 0:P.associatedChannels)??[]),V=(0,l.useCallback)((e=>Boolean(null==P?void 0:P.aiEnabledSlackWorkspaceIds.includes(e))),[P]);return i()(B,{nameComp:l.createElement(l.Fragment,null,g({height:12,width:12,marginRight:6,fill:u.ZP.mediumIconColor}),i()("div",{},void 0,l.createElement(k.FormattedMessage,Z.slackChannel))),valueComp:i()(x.ZP,{popupType:o.isMobile?x.Z4.SlideUp:x.Z4.Popup,placementToOrigin:S.u.Bottom,alignmentToOrigin:S.v.Start,renderOrigin:e=>l.createElement(v.Z,a()({style:c.button},e,{disabled:!I}),F?i()(b,{channel:F}):i()("div",{style:c.selectChannelPlaceholder},void 0,l.createElement(k.FormattedMessage,Z.selectChannel))),render:e=>i()(A.F,{onClose:()=>e.close(),onSelect:M,channelFilter:T,workspaceFilter:V,onNewSlackAccountAdded:()=>{m()},onRemove:F?async()=>{await f.setPageAssistantPreferences(t,{pageId:n.id,spaceId:n.getSpaceId(),operation:{type:"clear_channel"}}),await m()}:void 0})})})}const T=e=>"public"===e.type;function b(e){window.__c={n:"ChannelValue"};const{channel:n}=e,t=(0,d.yK)((()=>({wrap:{display:"flex",alignItems:"center"},icon:{height:12,width:12}})),[]),o=(0,k.useIntl)();let a,c;return"unknown"===n.type?(a=(0,p.b)(t.icon),c=o.formatMessage(Z.unknownChannel)):"channel"===n.type?(a=(0,M.N_)({channel:n.channel,styles:t.icon}),c=n.channel.name):(0,m.t1)(n),i()("div",{style:t.wrap},void 0,a," ",c)}function B(e){window.__c={n:"PagePreferenceRow"};const{nameComp:n,valueComp:t}=e,o=(0,s.Fy)(),a=(0,d.yK)((e=>({wrap:{display:"flex",paddingBottom:4,width:"100%",fontSize:w.z6},name:{display:"flex",alignItems:"center",height:w._w,width:o.isMobile?120:160,flex:"none",color:e.mediumTextColor},value:{display:"flex",alignItems:"center",marginLeft:4,flexGrow:1}})),[o]);return i()("div",{style:a.wrap},void 0,i()("div",{style:a.name},void 0,n),i()("div",{style:a.value},void 0,t))}},38990:(e,n,t)=>{t.d(n,{F:()=>L});var o=t(10434),a=t.n(o),c=t(23174),i=t.n(c),l=(t(57658),t(67294)),s=t(86628),r=t(24405),d=t(8848),u=t(80721),h=t(37612),p=t(5366),g=t(97880),C=t(82990),k=t(18441),m=t(24457),f=t(30874),S=t(52275),y=t(73063),w=t(78140),v=t(32163),x=t(72495),M=t(480),A=t(41892),Z=t(77657),I=t(68626),P=t(42631),T=t(80444),b=t(42922),B=t(89728);function F(e){const{renderMenu:n,onClose:t,onConnect:o}=e,c=[{key:"connect-to-slack-menu",items:[],render:e=>l.createElement(V,a()({},e,{onClose:t,onConnect:o}))}];return l.createElement(l.Fragment,null,n(c))}function V(e){window.__c={n:"ConnectSection"};const{onClose:n,onConnect:t}=e,o=W();return i()(x.Z,{},void 0,i()("div",{style:o.container},void 0,i()(_,{}),i()("div",{style:o.connectToSlackBody},void 0,i()("div",{style:o.connectToSlackTitleText},void 0,i()(p.FormattedMessage,{id:"slackConnectToSlackView.connectToSlackView.title",defaultMessage:"Connect to Slack"})),i()("div",{style:o.connectToSlackDescriptionText},void 0,i()(p.FormattedMessage,{id:"slackConnectToSlackView.connectToSlackView.description",defaultMessage:"Enable your assistant to listen to Slack channels"}))),i()(E,{onClose:n,onConnect:t})))}function _(){window.__c={n:"SlackIcon"};const e=W();return i()("div",{},void 0,i()("img",{src:A.Z.images.externalIntegrations.slackIconPng,style:e.slackIcon}))}function E(e){window.__c={n:"AuthActionButtons"};const{onClose:n,onConnect:t}=e,o=(0,M.O7)(),a=(0,s.VK)((()=>{var e;return null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),c=(0,s.VK)((()=>f.Z.integrations.state.find((e=>e.id===Z.nO))),[]),l=W();return c&&a?i()("div",{style:l.buttonGroup},void 0,i()(b.Z,{style:l.connectToSlackButton,isLarge:!0,onClick:async()=>{const e=await P.hM({environment:o,integration:c,spaceId:a,from:"collection_view_settings"});I.x.isFail(e)?t({type:"workspace"}):e.value.externalAuthentication?t({type:"channel",externalAuthentication:e.value.externalAuthentication}):t({type:"workspace"})}},void 0,i()(p.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.connectButton.label",defaultMessage:"Connect"})),i()(B.Z,{style:l.cancelButton,isLarge:!0,onClick:()=>{n()}},void 0,i()(p.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.cancelButton.label",defaultMessage:"Cancel"}))):null}function W(){return(0,r.yK)((e=>({container:{display:"flex",flexDirection:"column",margin:"10px 15px",justifyContent:"center",textAlign:"center"},connectToSlackBody:{margin:"0px 25px"},connectToSlackTitleText:{marginBottom:2,fontWeight:C.Z.fontWeight.semibold},connectToSlackDescriptionText:{fontSize:13,color:e.mediumTextColor},slackIcon:{width:23,height:"auto"},buttonGroup:{margin:"10px 10px 0px 10px"},connectToSlackButton:{width:"100%"},cancelButton:{color:e.mediumTextColor,width:"100%",justifyContent:"center",fontWeight:C.Z.fontWeight.medium,fontSize:13,marginTop:8}})),[])}var H=t(42876),R=t(93364);const K=(0,p.defineMessages)({backButtonAriaLabel:{id:"SlackSelectWorkspaceAndChannelMenu.backButton.ariaLabel",defaultMessage:"Back to previous step"},selectSlackWorkspace:{id:"SlackSelectWorkspaceAndChannelMenu.selectSlackWorkspace",defaultMessage:"Select Slack workspace"},selectSlackChannel:{id:"SlackSelectWorkspaceAndChannelMenu.selectSlackChannel",defaultMessage:"Select Slack channel"},remove:{id:"SlackSelectWorkspaceAndChannelMenu.remove",defaultMessage:"Remove"}});function L(e){window.__c={n:"SlackSelectWorkspaceAndChannelMenu"};const{onSelect:n,onClose:t,onRemove:o,channelFilter:c,workspaceFilter:r,onNewSlackAccountAdded:u}=e,C=(0,s.VK)((()=>(0,k.P9)(f.Z.completeSlackAuthentications.state,r)),[r]),[y,M]=l.useState(function(e){return 0===e.length?{type:"connect"}:1===e.length?{type:"channel",externalAuthentication:e[0]}:{type:"workspace"}}(C)),A=(0,m.F)({maxHeight:"50vh",width:266});return"connect"===y.type?i()(F,{onClose:t,onConnect:e=>M(e),renderMenu:e=>l.createElement(w.Z,A,i()(v.Z,{type:v.i.Vertical,sections:e,initialFocus:0}))}):"workspace"===y.type?i()(R.U,{onWorkspaceSelect:e=>{const n=(0,k.jc)(e);(!r||n&&r(n))&&M({type:"channel",externalAuthentication:e})},workspaceFilter:r,onNewSlackAccountAdded:u,renderMenu:e=>l.createElement(w.Z,a()({},A,{header:i()(N,{},void 0,l.createElement(p.FormattedMessage,K.selectSlackWorkspace))}),i()(v.Z,{type:v.i.Vertical,sections:e,initialFocus:0}))}):"channel"===y.type?i()(H.ZP,{channelFilter:c,onClose:t,currentNotificationChannel:void 0,onNewSlackAccountAdded:()=>{M({type:"workspace"}),null==u||u()},currentExternalAuthentication:y.externalAuthentication,onNotificationChannelSelect:e=>n({notificationChannel:e,externalAuthentication:y.externalAuthentication}),renderMenu:e=>{const n=[...e];return o&&n.push({key:"remove",render:e=>l.createElement(x.Z,a()({topBorder:!0},e)),items:[{key:"remove",render:e=>l.createElement(S.Z,a()({},e,{icon:(0,h.y)({width:16,height:16,marginRight:2}),title:l.createElement(p.FormattedMessage,K.remove),hoveredStyle:{color:d.ZP.red,fill:d.ZP.red}})),action:()=>{o(),t()}}]}),l.createElement(w.Z,a()({},A,{header:i()(N,{onBack:()=>M({type:"workspace"})},void 0,l.createElement(p.FormattedMessage,K.selectSlackChannel))}),i()(v.Z,{type:v.i.Vertical,sections:n,initialFocus:0}))}}):(0,g.t1)(y)}function N(e){window.__c={n:"MenuHeader"};const{onBack:n,children:t}=e,o=(0,r.yK)((e=>({wrap:{display:"flex",alignItems:"center",margin:8,color:e.mediumTextColor,fontWeight:C.Z.fontWeight.medium,fontSize:C.Z.fontSize.UISmall.desktop,minHeight:22},iconButtonStyle:{marginRight:8,marginLeft:-2,height:22},iconButtonIconStyle:{width:16,height:16}})),[]),a=(0,p.useIntl)();return i()("div",{style:o.wrap},void 0,n&&i()(y.Z,{ariaLabel:a.formatMessage(K.backButtonAriaLabel),icon:u.W,style:o.iconButtonStyle,iconStyle:o.iconButtonIconStyle,onClick:n}),t)}}}]);