"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5916],{56812:(e,t,o)=>{o.d(t,{$G:()=>M,Bo:()=>n,Ig:()=>S,Iu:()=>p,Mw:()=>g,Mz:()=>b,NZ:()=>v,Oq:()=>d,S0:()=>u,ST:()=>P,Sj:()=>y,VO:()=>T,XJ:()=>x,aD:()=>C,c5:()=>w,hW:()=>i,ht:()=>s,nf:()=>k,oJ:()=>V,om:()=>m,rf:()=>h,vE:()=>f,wE:()=>c,xf:()=>a,zU:()=>l});var r=o(80951);const n=(0,o(5366).defineMessages)({actionCheckboxPropertyChecked:{defaultMessage:"checked",id:"automations.action.checkboxProperty.checked"},actionCheckboxPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.checkboxProperty.single"},actionCheckboxPropertyUnchecked:{defaultMessage:"unchecked",id:"automations.action.checkboxProperty.unchecked"},actionDatePropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.dateProperty.clear"},actionDatePropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.dateProperty.single"},actionPersonPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.personProperty.clear"},actionPersonPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.personProperty.single"},actionPersonPropertySetMultiple:{defaultMessage:"Set {propertyName} to all of {propertyValues}",id:"automations.action.personProperty.multiple"},actionRelationPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.relationProperty.clear"},actionRelationPropertySetMultiple:{defaultMessage:"Set {propertyName} to all of {propertyValues}",id:"automations.action.relationProperty.multiple"},actionRelationPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.relationProperty.single"},actionSelectPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.selectProperty.clear"},actionSelectPropertySetMultiple:{defaultMessage:"Set {propertyName} to all of {propertyValues}",id:"automations.action.selectProperty.multiple"},actionSelectPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.selectProperty.single"},actionStatusPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.statusProperty.single"},actionTextPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.textProperty.clear"},actionTextPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.textProperty.single"},actionDeletedProperty:{defaultMessage:"Edit a deleted property",id:"automations.action.deletedProperty"},triggerAnyPageAdded:{defaultMessage:"Page added",id:"automations.trigger.pageAdded.title"},triggerAnyPagePropertyEdit:{defaultMessage:"Any property edited",id:"automations.trigger.anyPagePropertyEdited.title"},triggerAnyPropertyEdit:{defaultMessage:"{propertyName} is edited",id:"automations.trigger.propertyChangesToAny.title"},triggerSelectPropertySet:{id:"automations.trigger.selectPropertySet.title",defaultMessage:"{propertyName} set to {propertyValues}"},triggerStatusPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.statusPropertySet.singleProperty"},triggerDeletedPropertyEdit:{defaultMessage:"Deleted property is edited",id:"automations.trigger.deletedPropertyEdited"},deletedPropertyOption:{defaultMessage:"Deleted option",id:"automations.values.deletedPropertyOption"}});function i(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionCheckboxPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function a(e){const{propertyName:t}=e;return{...n.actionDatePropertyClear,values:{propertyName:t}}}function l(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionDatePropertySetSingle,values:{propertyName:t,propertyValue:o}}}function s(e){const{propertyName:t}=e;return{...n.actionPersonPropertyClear,values:{propertyName:t}}}function c(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionPersonPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function d(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionPersonPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function p(e){const{propertyName:t}=e;return{...n.actionRelationPropertyClear,values:{propertyName:t}}}function u(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionRelationPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function m(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionRelationPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function g(e){const{propertyName:t}=e;return{...n.actionSelectPropertyClear,values:{propertyName:t}}}function h(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionSelectPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function y(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionSelectPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function S(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionStatusPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function v(e){const{propertyName:t}=e;return{...n.actionTextPropertyClear,values:{propertyName:t}}}function f(e){const{propertyName:t,propertyValue:o}=e;return{...n.actionTextPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function C(e){return e.formatMessage(n.actionDeletedProperty)}function b(e){return e.formatMessage(n.triggerAnyPageAdded)}function w(e){return e.formatMessage(n.triggerAnyPagePropertyEdit)}function k(e){return e.formatMessage(n.triggerDeletedPropertyEdit)}function M(e,t){const{propertyName:o}=t;return e.formatMessage(n.triggerAnyPropertyEdit,{propertyName:o})}function x(e,t){return e.formatMessage(n.triggerSelectPropertySet,t)}function T(e,t){return e.formatMessage(n.triggerStatusPropertySet,t)}function P(e){return e.formatMessage(n.deletedPropertyOption)}function V(e){const{limit:t,optionValues:o,propertySchema:n}=e,i=n.options??[],a=i.length>0,l=o.map((e=>{const t=a?(0,r.i7)(i,e):void 0;return t?{type:"option",value:t}:{type:"deleted",value:e}}));let s=l;if(void 0!==t&&l.length>t){const e=l.length-t;s=[...l.slice(0,t),{type:"truncation",value:`+${e}`}]}return s}},61053:(e,t,o)=>{o.d(t,{Z:()=>V});var r=o(23174),n=o.n(r),i=o(10434),a=o.n(i),l=(o(57658),o(43261)),s=o.n(l),c=o(67294),d=o(83355),p=o(49085),u=o(6695),m=o(56666),g=o(37612),h=o(72126),y=o(5366),S=o(52821),v=o(33929),f=o(29798),C=o(73657),b=o(52275),w=o(68894),k=o(32163),M=o(72495),x=o(69872);const T=(0,y.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a propertyâ€¦",id:"database.viewSettings.propertySelect.inputPlaceholder"},none:{defaultMessage:"None",id:"database.viewSettings.propertySelect.noneMessage"},remove:{defaultMessage:"Remove",id:"database.viewSettings.propertySelect.removeMessage"}});class P extends d.Z{constructor(){super(...arguments),this.storeTypes={inputStore:p.default.createClass(""),menuListStore:f.Z,showAllProperties:p.default.createClass(!1)}}renderComponent(){const{currentProperty:e,showNoneOption:t,showRemoveOption:o,getProperties:r,onAccept:i,intl:l,inputPlaceholder:d,defaultShowPropertyCount:p,schema:f,format:x}=this.props,{device:P}=this.environment,{inputStore:V,menuListStore:_}=this.stores,F=V.state,Z=(0,u.iB)(x,f,void 0,u.j5.Page).collection_page_properties||[],B=!p||this.stores.showAllProperties.state,A=l.formatMessage(T.none),E=t?{key:"none",render:t=>c.createElement(b.Z,a()({},t,{checkState:!e,title:A})),action:()=>{i(void 0)}}:void 0,R=o?{key:"remove",render:e=>c.createElement(b.Z,a()({},e,{icon:(0,g.y)({width:16,fill:this.theme.mediumTextColor,marginLeft:4,marginRight:2}),title:l.formatMessage(T.remove)})),action:()=>{i(void 0)}}:void 0,I=r();let L=h.MR(I,(e=>Z.findIndex((t=>t.property===e))));if(F){const e=new Map;let t=L.map((t=>{const o=f[t],r=o?`${o.name} ${S.SO[o.type]}`:"";return e.set(t,r),r}));t=s().filter(F,t).map((e=>{let{original:t}=e;return t})),L=L.filter((o=>t.includes(e.get(o)||"")))}else!B&&p&&(L=L.slice(0,p));const D=h.oA([!F||s().test(F,A)?E:void 0,...L.map((e=>this.renderPropertyMenuItem(e)))]);if(!B&&I.length>L.length&&!F){const e={key:"show_more",render:e=>c.createElement(b.Z,a()({},e,{icon:(0,m.o)({width:16,fill:this.theme.mediumTextColor,marginLeft:4,marginRight:2}),style:{color:this.theme.mediumTextColor},title:n()(y.FormattedMessage,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:I.length-L.length}})})),action:()=>{this.stores.showAllProperties.setState(!0)}};D.push(e)}const K=D.length>0,O=Boolean(F),N=!R||K||O;N&&!K&&D.push({action:h.ZT,key:"noResults",render:e=>c.createElement(C.Z,a()({},e,{caption:n()(y.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})}))});const z=[];return N&&z.push({key:"input",comp:n()(M.Z,{},void 0,n()(w.ZP,{focusInitial:!P.isMobile||void 0,focus:!P.isMobile||void 0,value:F,onChange:e=>{V.setState(e.target.value),_.setState({..._.state,focus:{section:0,indexLocal:0,indexGlobal:0}}),this.stores.showAllProperties.setState(!1)},placeholder:d||v.default.formatMessage(T.inputPlaceholder)}))}),(D.length>0||R)&&z.push({key:"properties",comp:n()(k.Z,{type:k.i.Vertical,initialFocus:0,sections:[...D.length>0?[{key:"results",render:e=>c.createElement(M.Z,e),items:D}]:[],...R?[{key:"remove",render:e=>c.createElement(M.Z,a()({topBorder:D.length>0},e)),items:[R]}]:[]],store:_})}),c.createElement(c.Fragment,null,z.map((e=>{let{key:t,comp:o}=e;return n()(c.Fragment,{},t,o)})))}renderPropertyMenuItem(e){const{schema:t,currentProperty:o,onAccept:r,renderProperty:n}=this.props,i=t[e];if(!i)return;return{key:e,render:t=>{const r=e===o;return n?n(t,e,r,i):c.createElement(x.Z,a()({},t,{propertySchema:i,format:x.Z.DisplayFormat.Name,checkState:r}))},action:()=>{r(e)}}}}P.displayName="CollectionSettingsPropertySelectMenu";const V=(0,y.injectIntl)(P)},23877:(e,t,o)=>{o.d(t,{Z:()=>ce,v:()=>se});var r=o(10434),n=o.n(r),i=o(23174),a=o.n(i),l=(o(21703),o(67294)),s=o(83355),c=o(49085),d=o(15145),p=o(6906),u=o(99036),m=o(39068),g=o(53877),h=o(6695),y=o(72126),S=o(4615),v=o(82990),f=o(5366),C=o(50906),b=o(8406),w=o(5149),k=o(76427),M=o(96802),x=o(75018),T=o(80402),P=o(39699),V=o(28020),_=o(40863),F=o(33929);const Z=(0,f.defineMessages)({none:{defaultMessage:"None",id:"database.viewPropertiesMenu.coverFormat.none"},page_content:{defaultMessage:"Page content",id:"database.viewPropertiesMenu.coverFormat.pageContent"},page_cover:{defaultMessage:"Page cover",id:"database.viewPropertiesMenu.coverFormat.pageCover"}}),B=(0,f.defineMessages)({small:{defaultMessage:"Small",id:"database.viewPropertiesMenu.coverSize.small"},medium:{defaultMessage:"Medium",id:"database.viewPropertiesMenu.coverSize.medium"},large:{defaultMessage:"Large",id:"database.viewPropertiesMenu.coverSize.large"}}),A=function(e){return e?"page_content"===e.type?F.default.formatMessage(Z.page_content):"page_cover"===e.type?F.default.formatMessage(Z.page_cover):void 0:F.default.formatMessage(Z.none)},E=e=>{switch(e){case"small":return F.default.formatMessage(B.small);case"medium":return F.default.formatMessage(B.medium);case"large":return F.default.formatMessage(B.large)}};var R=o(81849),I=o(52821),L=o(48543),D=o(65742),K=o(78316),O=o(84210),N=o(87279),z=o(18514),H=o(80444),W=o(61766),Q=o(36857),G=o(88923),q=o(21269),j=o(42917),U=o(13709),Y=o(61053),$=o(75544),J=o(42922),X=o(64921),ee=o(31945),te=o(74194),oe=o(78140),re=o(53437),ne=o(72495),ie=o(86825);class ae extends s.Z{constructor(){super(...arguments),this.storeTypes={hoveredType:c.default.createClass(void 0),timelineByButtonPopupStore:W.Z,timelineByEndButtonPopupStore:W.Z,calendarByButtonPopupStore:W.Z},this.renderViewTypeButton=e=>{const{intl:t,collectionContextStore:o}=this.props,r=this.getCurrentViewType(),n=o.permissionScopes.state,i=r===e,l=i||!n.canConfigureBlock;return a()(X.Z,{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"calc(33% - 12px)",flexGrow:0,flexShrink:0,fontSize:11,borderRadius:3,margin:6,padding:6,boxShadow:`0 0 0 1px ${this.theme.regularDividerColor}`,color:this.theme.mediumTextColor,fill:this.theme.mediumTextColor,...i&&{boxShadow:`0 0 0 2px ${this.theme.blueColor}`,color:this.theme.blueColor,fill:this.theme.blueColor,fontWeight:500}},disabled:l,onClick:()=>{P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderViewTypeButton",environment:this.environment,perform:r=>{k.z2({environment:this.environment,collectionContextStore:o,newViewType:e,transaction:r,intl:t})}}),b.wd({environment:this.environment,collectionContextStore:o,action:"change_type",original_view_type:r})},onMouseMove:()=>{this.stores.hoveredType.setState(e)}},void 0,I.aW[e]({width:void 0,height:20,marginBottom:4,marginTop:4}),a()("div",{},void 0,I.Bh[e]))},this.handleCoverFormatChange=e=>{const{collectionContextStore:t}=this.props,o=this.getCoverFormatKey(),r=t.collectionViewStore();o&&r&&(P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverFormatChange",environment:this.environment,perform:t=>{M.FH({stores:[r],update:{[o]:e},transaction:t})}}),b.wd({environment:this.environment,collectionContextStore:t,action:"update_cover_format"}))},this.handleCoverSizeFormatChange=e=>{const{collectionContextStore:t}=this.props,o=this.getCoverSizeFormatKey(),r=t.collectionViewStore();o&&r&&(P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverSizeFormatChange",environment:this.environment,perform:t=>{M.FH({stores:[r],update:{[o]:e},transaction:t})}}),b.wd({environment:this.environment,collectionContextStore:t,action:"toggle_cover_size_format"}))},this.handleCoverAspectFormatToggle=()=>{const{collectionContextStore:e}=this.props,t=this.getCoverAspectFormatKey(),o=e.collectionViewStore(),r=e.normalizedFormatStore.state;t&&o&&(P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverAspectFormatToggle",environment:this.environment,perform:e=>{M.FH({stores:[o],update:{[t]:"contain"===r[t]?"cover":"contain"},transaction:e})}}),b.wd({environment:this.environment,collectionContextStore:e,action:"toggle_cover_aspect_format"}))},this.handleShowCollectionTitleClick=()=>{const{collectionContextStore:e}=this.props,t=e.collectionViewStore();if(!t)return;const o=!e.shouldShowSource.state;P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleShowCollectionTitleClick",environment:this.environment,perform:e=>{M.FH({stores:[t],update:{hide_linked_collection_name:!o},transaction:e})}}),b.wd({environment:this.environment,collectionContextStore:e,action:"toggle_show_collection_title"})},this.handleTableWrapCellsToggle=()=>{const{collectionContextStore:e}=this.props,t=e.collectionViewStore();if(!t)return;const o=Boolean(e.normalizedFormatStore.state.table_wrap);T.qY({environment:this.environment,collectionViewStore:t,currentValue:o}),C.wds(this.environment,{view_type:this.getCurrentViewType(),action:"set_first_load_limit"}),b.wd({environment:this.environment,collectionContextStore:e,action:"toggle_table_wrap_cells"})},this.handleTableVerticalLinesToggle=()=>{const{collectionContextStore:e}=this.props,t=e.collectionViewStore();if(!t)return;const o=Boolean(e.normalizedFormatStore.state.hide_table_vertical_lines);T.AU({environment:this.environment,collectionViewStore:t,currentValue:o}),b.wd({environment:this.environment,collectionContextStore:e,action:"toggle_table_vertical_lines"})},this.handleTableSubitemToggleOnTitleToggle=()=>{const{collectionContextStore:e}=this.props,t=e.collectionViewStore();t&&(T.d1({environment:this.environment,collectionViewStore:t,currentValue:e.normalizedFormatStore.state.table_subitem_toggle_column}),b.wd({environment:this.environment,collectionContextStore:e,action:"toggle_table_subitem_toggle_on_title"}))},this.handleTimelineSeparateDatesClick=()=>{const{collectionContextStore:e}=this.props,t=e.normalizedQueryStore.state,o=e.collectionViewStore(),r=null==t?void 0:t.timeline_by,n=null==t?void 0:t.timeline_by_end;if(!r||!o)return;const i=n?void 0:r;P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleTimelineSeparateDatesClick",environment:this.environment,perform:e=>{k.Es({collectionViewStore:o,update:{timeline_by_end:i??null},transaction:e})}}),b.wd({environment:this.environment,collectionContextStore:e,action:"toggle_timeline_separate_dates"})},this.handleOpenPeekModePicker=()=>{b.nS({environment:this.environment,collectionContextStore:this.props.collectionContextStore,from:"collection_view_settings"})},this.handleCalendarViewRangeOptionClick=e=>{const{collectionContextStore:t}=this.props,o=t.collectionViewStore();if(!o)return;const{serverCommitResult:r}=P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleViewRangeOptionClick",environment:this.environment,perform:t=>{M.FH({stores:[o],update:{calendar_view_range:e},transaction:t})}}),n=V.AK.state,i=t.dateRangeStart.state,a=t.dateRangeEnd.state,{newDateRangeStart:l,newDateRangeEnd:s}=this.getNewDateRange({oldCalendarEnd:a,newViewRange:e,startOfWeekSetting:n});k.t5({dateRangeStart:l,dateRangeEnd:s,collectionContextStore:t}),r.then((()=>{b.wd({environment:this.environment,collectionContextStore:t,action:"update_calendar_view_range"})})).catch((()=>{k.t5({dateRangeStart:i,dateRangeEnd:a,collectionContextStore:t})}))},this.handlePeekModeFormatClick=e=>{const{collectionContextStore:t}=this.props,o=t.collectionViewStore();if(o&&e&&(P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handlePeekModeFormatClick",environment:this.environment,perform:t=>{M.FH({stores:[o],update:{collection_peek_mode:e},transaction:t})}}),b.gl({environment:this.environment,collectionContextStore:t,peek_mode:e,from:"collection_view_settings"}),G.default.state.open&&G.default.state.collectionContextStore===t)){const{mainEditorCurrentBlockStore:t}=H.default.state,o="full_page"===e?(0,O.ZP)({store:G.default.state.target,fullyQualified:!1,pageVisitSource:d.tY.Expand}):(0,K.mb)({store:G.default.state.target,mainEditorCurrentBlockStore:t,collectionContextStore:G.default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,G.getPeekModeFromCollectionPeekModeFormat)(e)});o&&x.navigate({environment:this.environment,url:o})}},this.handleViewTypeAreaMouseLeave=()=>{this.stores.hoveredType.setState(void 0)},this.handleDoneClick=()=>{const{collectionSettingsStore:e,collectionContextStore:t}=this.props;w.wl({collectionSettingsStore:e,item:{type:"main"}}),b.wd({environment:this.environment,collectionContextStore:t,action:"click_create_view_done"})}}renderComponent(){const{collectionContextStore:e,showDoneButton:t}=this.props,{hoveredType:o}=this.stores,{device:r}=this.environment,n=e.normalizedQueryStore.state,i=e.normalizedSchemaStore.state,s=e.normalizedFormatStore.state,c=e.isFullScreen.state,d=e.isRootChild.state,p=this.getCurrentViewType(),m=Boolean(this.getCoverFormatKey()),g="table"===p||"board"===p||"gallery"===p,h="table"===p,y=Object.keys(i).filter((e=>{const t=i[e];return t&&(0,u.Lt)(t)})),S="timeline"===p&&y.length>0,v="timeline"===p&&y.length>1,C="timeline"===p&&Boolean(null==n?void 0:n.timeline_by_end),b="calendar"===p&&y.length>0,w="calendar"===p,k="board"===p,M=(0,D.d$)({environment:this.environment,isFullScreen:c,isRootChild:d}),x="timeline"===p&&Boolean(s.timeline_show_table)&&M,T="timeline"===p&&M,P=e.collectionViewBlockStore();if(!P)return;const V=P.getCollectionViewSourceCollectionStore(),_=!("collectionTypedView"===e.contextType||V&&c),F=e.permissionScopes.state,Z="page"===p;return l.createElement(l.Fragment,null,a()(ne.Z,{topBorder:!1,shouldShowBottomDivider:r.isMobile},void 0,a()("div",{style:{...!r.isMobile&&{width:"100%",paddingLeft:8,paddingRight:8},...r.isMobile&&{background:this.theme.contentBackground,width:"100%",paddingTop:12,paddingBottom:12}},onMouseLeave:this.handleViewTypeAreaMouseLeave},void 0,a()("div",{style:{display:"flex",flexFlow:"wrap",justifyContent:"center"}},void 0,["table","board","timeline","calendar","list","gallery"].map(this.renderViewTypeButton)),a()("div",{style:{color:this.theme.lightTextColor,fontSize:12,margin:"6px 8px 0px 8px"}},void 0,I.sN[o.state||p]))),a()(ne.Z,{},void 0,_&&a()(ie.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Show database title",id:"database.viewSettings.layoutTab.showDatabaseTitle.title"}),focused:!1,on:e.shouldShowSource.state,onClick:this.handleShowCollectionTitleClick,disabled:!F.canConfigureBlock,textWrapperStyle:{opacity:1}}),m&&this.renderCardSettings(),h&&this.renderTableVerticalLinesSetting(),g&&this.renderTableWrapCellsSetting(),Z&&this.renderPageViewSetting(),S&&this.renderTimelineBySetting(),C&&this.renderTimelineEndSetting(),v&&this.renderTimelineSeparateDatesSetting(),b&&this.renderCalendarBySetting(),w&&this.renderCalendarViewRangeSetting(),T&&a()($.N,{collectionContextStore:e}),x&&this.renderTimelineTableProperties(),k&&this.renderBoardGroupByShortcuts(),this.renderPeekModeSetting()),t&&a()(ne.Z,{disableMobileBorders:!0},void 0,a()(J.Z,{style:{display:"flex",margin:"0 14px"},onClick:this.handleDoneClick},void 0,a()(f.FormattedMessage,{defaultMessage:"Done",id:"database.viewSettings.createViewTab.doneButton.title"}))),a()(ne.Z,{topBorder:!1},void 0,a()(q.Z,{href:(0,z.UY)("guides.databaseView"),title:a()(f.FormattedMessage,{defaultMessage:"Learn about views",id:"database.viewSettings.layoutTab.learnMoreButton.title"}),analyticsFrom:"view_settings_layout"})))}renderCardSettings(){const{device:e}=this.environment,{collectionContextStore:t}=this.props,o=this.getCoverFormat(),r=this.getCoverSizeFormat(),n=!e.isMobile||"board"===this.getCurrentViewType(),i=t.permissionScopes.state;return l.createElement(l.Fragment,null,a()(U.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Card preview",id:"database.viewSettings.layoutTab.cardPreviewButtonTitle"}),selectedKey:o,popupStyle:{minWidth:190},options:this.getCoverFormatOptions(),onChange:this.handleCoverFormatChange,disabled:!i.canConfigureBlock}),n&&a()(U.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Card size",id:"databdatabase.viewSettings.layoutTab.cardSizeButtonTitle"}),selectedKey:r,popupStyle:{minWidth:190},options:this.getCoverSizeFormatOptions(),onChange:this.handleCoverSizeFormatChange,disabled:!i.canConfigureBlock}),o&&a()(ie.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Fit image",id:"databdatabase.viewSettings.layoutTab.fitImageButtonTitle"}),on:"contain"===this.getCoverAspectFormat(),focused:!1,onClick:this.handleCoverAspectFormatToggle,disabled:!i.canConfigureBlock,textWrapperStyle:{opacity:1}}))}getCoverFormatOptions(){const{collectionContextStore:e}=this.props,t=e.normalizedSchemaStore.state;let o=Object.keys(t);o=y.MR(o,(e=>{const o=t[e];return o?o.name:""}));const{theme:r}=this,n=y.oA(o.map((e=>{const o=t[e];if(o&&"file"===o.type){return{key:{type:"property",property:e},title:o.name,icon:a()(m.ZP,{type:o.type,icon:o.icon,size:this.environment.device.isMobile?16:14,theme:r,style:{fill:r.regularIconColor}})}}})));return[...[void 0,{type:"page_cover"},{type:"page_content"}].map((e=>({key:e,title:A(e)}))),...n]}getCoverSizeFormatOptions(){return["small","medium","large"].map((e=>({key:e,title:E(e)})))}renderTableVerticalLinesSetting(){const{collectionContextStore:e}=this.props,t=e.permissionScopes.state;return a()(ie.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Show vertical lines",id:"database.viewSettings.layoutTab.tableShowVerticalLines"}),on:!Boolean(e.normalizedFormatStore.state.hide_table_vertical_lines),focused:!1,onClick:this.handleTableVerticalLinesToggle,disabled:!t.canConfigureBlock,textWrapperStyle:{opacity:1}})}renderTableWrapCellsSetting(){const{collectionContextStore:e}=this.props,t=e.normalizedFormatStore.state,o=e.permissionScopes.state,r=this.getCurrentViewType();return a()(ie.Z,{title:a()(f.FormattedMessage,"table"===r?{defaultMessage:"Wrap all columns",id:"database.viewSettings.layoutTab.tableWrapAllColumns"}:{defaultMessage:"Wrap all properties",id:"database.viewSettings.layoutTab.tableWrapAllProperties"}),on:Boolean(t.table_wrap),focused:!1,onClick:this.handleTableWrapCellsToggle,disabled:!o.canConfigureBlock,textWrapperStyle:{opacity:1}})}renderPageViewSetting(){const e=this.props.collectionContextStore.collectionViewStore();if(e)return a()("div",{style:{padding:5}},void 0,a()(te.Z,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{Q.Z.setState({pageId:e.target.value})},onSubmit:t=>{const o=Q.Z.state.pageId;o&&P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderPageViewSettings",environment:this.environment,perform:t=>{M.FH({stores:[e],update:{page_pointer:{id:(0,S.Mt)(o),spaceId:t.spaceId,table:"block"}},transaction:t})}})}}))}renderTimelineBySetting(){var e,t;const{device:o}=this.environment,{collectionContextStore:r}=this.props,i=null===(e=r.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by,s=null===(t=r.normalizedQueryStore.state)||void 0===t?void 0:t.timeline_by_end,c=r.normalizedSchemaStore.state,d=r.collectionViewStore(),p=r.permissionScopes.state,m=r.collectionStore();if(!i||!d||!m)return;const g=c[i];return g?a()(ee.ZP,{popupType:o.isPhone?re.kQ.SlideUp:re.kQ.Popup,alignmentToOrigin:ee.vR.End,placementToOrigin:ee.pO.Bottom,originGap:0,renderOrigin:e=>l.createElement(j.Z,n()({title:a()(f.FormattedMessage,s?{defaultMessage:"Start date",id:"database.viewSettings.layoutTab.timelineStartDate.title"}:{defaultMessage:"Show timeline by",id:"database.viewSettings.layoutTab.showTimelineByProperty.title"}),disabled:!p.canConfigureBlock,showChevron:!0,right:a()("div",{style:v.Z.textOverflowStyle},void 0,g.name),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}},e)),render:e=>{let t;return t=o.isPhone?{menuType:N.og.ActionSheet}:{menuType:N.og.Popup,width:300},l.createElement(oe.Z,t,a()(Y.Z,{schema:m.getSchema(),format:m.getFormat(),currentProperty:i,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,u.Lt)(t)})),onAccept:t=>{t&&(P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineBySetting",environment:this.environment,perform:e=>{k.Es({collectionViewStore:d,update:{timeline_by:t},transaction:e})}}),e.close(),b.wd({environment:this.environment,collectionContextStore:r,action:"update_timeline_by",original_view_type:void 0,property_type:g[t].type}))}}))}}):void 0}renderTimelineEndSetting(){var e;const{device:t}=this.environment,{collectionContextStore:o}=this.props,r=null===(e=o.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end,i=o.normalizedSchemaStore.state,s=o.permissionScopes.state,c=o.collectionViewStore(),d=o.collectionStore();if(!r||!c||!d)return;const p=i[r];return p?a()(ee.ZP,{popupType:t.isPhone?re.kQ.SlideUp:re.kQ.Popup,alignmentToOrigin:ee.vR.End,placementToOrigin:ee.pO.Bottom,originGap:0,renderOrigin:e=>l.createElement(j.Z,n()({title:a()(f.FormattedMessage,{defaultMessage:"End date",id:"database.viewSettings.layoutTab.timelineEndDate.title"}),showChevron:!0,right:p.name,disabled:!s.canConfigureBlock},e)),render:e=>{let n;return n=t.isPhone?{menuType:N.og.ActionSheet}:{menuType:N.og.Popup,width:300},l.createElement(oe.Z,n,a()(Y.Z,{schema:d.getSchema(),format:d.getFormat(),currentProperty:r,getProperties:()=>Object.keys(i).filter((e=>{const t=i[e];return t&&(0,u.Lt)(t)})),onAccept:t=>{t&&(P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineEndSetting",environment:this.environment,perform:e=>{k.Es({collectionViewStore:c,update:{timeline_by_end:t},transaction:e})}}),e.close(),b.wd({environment:this.environment,collectionContextStore:o,action:"update_timeline_by_end",original_view_type:void 0,property_type:p[t].type}))}}))}}):void 0}renderTimelineSeparateDatesSetting(){const{collectionContextStore:e}=this.props,t=e.normalizedQueryStore.state,o=null==t?void 0:t.timeline_by_end,r=e.permissionScopes.state;return a()(ie.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Separate start and end dates",id:"database.viewSettings.layoutTab.timelineUseSeparateDates.title"}),focused:!1,on:Boolean(o),onClick:this.handleTimelineSeparateDatesClick,disabled:!r.canConfigureBlock,textWrapperStyle:{opacity:1}})}renderCalendarViewRangeSetting(){const{collectionContextStore:e}=this.props,t=e.permissionScopes.state,o=this.getCalendarViewRange();return a()(U.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Show calendar as",id:"database.viewSettings.layoutTab.showCalendarAs.title"}),collectionContextStore:e,openButtonPopup:"peekModeFormat"===e.settingsStore.state.openButtonPopup,selectedKey:o,popupStyle:{minWidth:190},options:le(),onChange:this.handleCalendarViewRangeOptionClick,disabled:!t.canConfigureBlock})}renderCalendarBySetting(){var e;const{device:t}=this.environment,{collectionContextStore:o}=this.props,r=null===(e=o.normalizedQueryStore.state)||void 0===e?void 0:e.calendar_by,i=o.permissionScopes.state,s=o.normalizedSchemaStore.state,c=o.collectionViewStore(),d=o.collectionStore();if(!r||!c||!d)return;const p=s[r];return p?a()(ee.ZP,{popupType:t.isPhone?re.kQ.SlideUp:re.kQ.Popup,alignmentToOrigin:ee.vR.End,placementToOrigin:ee.pO.Bottom,originGap:0,renderOrigin:e=>l.createElement(j.Z,n()({title:a()(f.FormattedMessage,{defaultMessage:"Show calendar by",id:"database.viewSettings.layoutTab.showCalendarByProperty.title"}),disabled:!i.canConfigureBlock,showChevron:!0,right:a()("div",{style:v.Z.textOverflowStyle},void 0,p.name),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}},e)),render:e=>{let n;return n=t.isPhone?{menuType:N.og.ActionSheet}:{menuType:N.og.Popup,width:300},l.createElement(oe.Z,n,a()(Y.Z,{schema:d.getSchema(),format:d.getFormat(),currentProperty:r,getProperties:()=>Object.keys(s).filter((e=>{const t=s[e];return t&&(0,u.Lt)(t)})),onAccept:t=>{t&&(P.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderCalendarBySetting",environment:this.environment,perform:e=>{k.Es({collectionViewStore:c,update:{calendar_by:t},transaction:e})}}),e.close(),b.wd({environment:this.environment,collectionContextStore:o,action:"update_calendar_by",original_view_type:void 0,property_type:p[t].type}))}}))}}):void 0}renderTimelineTableProperties(){const{collectionContextStore:e,collectionSettingsStore:t}=this.props,o=(e.normalizedFormatStore.state.timeline_table_properties||[]).filter((e=>Boolean(e.visible))).length,r=e.permissionScopes.state;return a()(j.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Table properties",id:"database.viewSettings.layoutTab.tablePropertiesButton.title"}),showChevron:!0,right:a()(f.FormattedMessage,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.layoutTab.propertiesButton.propertiesShown.title",values:{propertiesShown:o}}),onClick:()=>{w.H4({collectionSettingsStore:t,item:{type:"properties",timelineViewTab:"table"}}),b.wd({environment:this.environment,collectionContextStore:e,action:"click_timeline_table_properties"})},disabled:!r.canConfigureBlock})}renderBoardGroupByShortcuts(){const{collectionContextStore:e,collectionSettingsStore:t}=this.props,o=e.normalizedFormatStore.state.board_columns_by,r=e.normalizedSchemaStore.state;if(!o)return;const n=e.permissionScopes.state,i=r[o.property];return i?l.createElement(l.Fragment,null,a()(j.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Group by",id:"database.viewSettings.layoutTab.boardGroupByButton.title"}),showChevron:!0,right:i.name,onClick:()=>{w.H4({collectionSettingsStore:t,item:{type:"group",groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}}),b.wd({environment:this.environment,collectionContextStore:e,action:"click_board_group_by",original_view_type:void 0,property_type:i.type})},disabled:!n.canConfigureBlock}),a()(ie.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!(0,R.h6)(this.environment,e),focused:!1,onClick:()=>{w.iN({environment:this.environment,collectionContextStore:e})},disabled:!n.canConfigureBlock,textWrapperStyle:{opacity:1}})):void 0}renderPeekModeSetting(){const{collectionContextStore:e}=this.props,t=e.permissionScopes.state,o=this.getPeekModeFormat();return a()(U.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Open pages in",id:"database.viewSettings.layoutTab.peekModeTitle"}),collectionContextStore:e,openButtonPopup:"peekModeFormat"===e.settingsStore.state.openButtonPopup,selectedKey:o,popupStyle:{minWidth:190},options:se({currentViewType:this.getCurrentViewType(),theme:this.theme}),menuItemOptionsStyle:{paddingTop:8,paddingBottom:8},onClick:this.handleOpenPeekModePicker,onChange:this.handlePeekModeFormatClick,disabled:!t.canConfigureBlock})}getNewDateRange(e){const{newViewRange:t,oldCalendarEnd:o,startOfWeekSetting:r}=e;if("month"===t){const e=(0,g.IS)((0,g.kl)(o),r);return{newDateRangeStart:e,newDateRangeEnd:(0,g.V7)((0,g._)({date:e,monthsToAdd:1}),r)}}{const e=(0,g.IS)(o,r);return{newDateRangeStart:e,newDateRangeEnd:(0,g.V7)(e,r)}}}getCurrentViewType(){var e;const{collectionContextStore:t}=this.props,o=null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType();if(!o)throw new Error("View type was not defined.");return o}getCoverFormatKey(){return I.DL[this.getCurrentViewType()]}getCoverFormat(){const{collectionContextStore:e}=this.props,t=e.normalizedFormatStore.state,o=this.getCoverFormatKey();if(o&&t)return t[o]}getCoverSizeFormatKey(){return I.oy[this.getCurrentViewType()]}getCoverSizeFormat(){const{collectionContextStore:e}=this.props,t=e.normalizedFormatStore.state,o=this.getCoverSizeFormatKey();if(o&&t){const e=t[o];if(e)return e}return h.PZ}getPeekModeFormat(){const{collectionContextStore:e}=this.props,t=e.normalizedFormatStore.state,o=this.getCurrentViewType();return(null==t?void 0:t.collection_peek_mode)||L.Ls[o]}getCalendarViewRange(){const{collectionContextStore:e}=this.props,t=e.normalizedFormatStore.state;return(null==t?void 0:t.calendar_view_range)||"month"}getCoverAspectFormatKey(){return I._Y[this.getCurrentViewType()]}getCoverAspectFormat(){const{collectionContextStore:e}=this.props,t=e.normalizedFormatStore.state,o=this.getCoverAspectFormatKey();if(o&&t)return t[o]}}function le(){return["month","week"].map((e=>({key:e,title:F.default.formatMessage(_.Lh[e])})))}function se(e){const{currentViewType:t,theme:o}=e,r=t?L.Ls[t]:void 0;return["side_peek","center_peek","full_page"].map((e=>({key:e,title:(0,L.LQ)(e),body:l.createElement(l.Fragment,null,(0,L.RI)(e),r&&t&&e===r&&a()("div",{style:{marginTop:2,fontWeight:500,color:o.blueColor}},void 0,a()(f.FormattedMessage,{defaultMessage:"Default for {view}",id:"database.viewPropertiesMenu.peekMode.defaultForView",values:{view:(0,p.Z)(t)}}))),icon:(0,L.RO)(e)({width:16,fill:o.mediumTextColor})})))}ae.displayName="CollectionSettingsViewLayoutMenu";const ce=(0,f.injectIntl)(ae)},75544:(e,t,o)=>{o.d(t,{N:()=>re,Z:()=>ne});var r=o(10434),n=o.n(r),i=o(23174),a=o.n(i),l=o(43261),s=o.n(l),c=o(67294),d=o(83355),p=o(480),u=o(86628),m=o(49085),g=o(99036),h=o(80951),y=o(39068),S=o(6695),v=o(5257),f=o(39132),C=o(61061),b=o(47453),w=o(37612),k=o(72126),M=o(97880),x=o(82990),T=o(5366),P=o(8406),V=o(5149),_=o(87085),F=o(76427),Z=o(96802),B=o(39699),A=o(52821),E=o(68641),R=o(65742),I=o(78316),L=o(33929),D=o(18514),K=o(29798),O=o(73657),N=o(21269),z=o(13005),H=o(42917),W=o(54119),Q=o(52275),G=o(79131),q=o(5145),j=o(73063),U=o(68894),Y=o(32163),$=o(89728),J=o(72495),X=o(86825),ee=o(66957);const te=(0,T.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a propertyâ€¦",id:"database.viewSettings.propertiesTab.inputPlaceholder"},toggleFrozenColumnsAriaLabel:{defaultMessage:"Toggle frozen columns",id:"database.viewSettings.propertiesTab.toggleFrozenColumnsAriaLabel"},togglePropertyVisibilityAriaLabel:{defaultMessage:"Toggle property visibility",id:"database.viewSettings.propertiesTab.togglePropertyVisibilityAriaLabel"}});class oe extends d.Z{constructor(){super(...arguments),this.storeTypes={inputStore:m.default.createClass(""),menuListStore:K.Z},this.handleHideAllClick=e=>{const{collectionContextStore:t}=this.props;P.wd({environment:this.environment,collectionContextStore:t,action:"click_hide_all_properties"}),this.setAllPropertiesVisibility({formatKey:e,visibility:!1})},this.handleShowAllClick=e=>{const{collectionContextStore:t}=this.props;P.wd({environment:this.environment,collectionContextStore:t,action:"click_show_all_properties"}),this.setAllPropertiesVisibility({formatKey:e,visibility:!0})},this.handlePropertyReorder=e=>{const{formatKey:t,newPropertyKeys:o}=e,{collectionContextStore:r}=this.props,n=r.collectionViewStore();if(!n)return;const i=r.normalizedFormatStore.state[t]||[],a=o.indexOf("group-header-hidden-property"),l=[...k.oA(o.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=i.find((t=>t.property===e));if(o)return a>=0?{...o,visible:Boolean(t<a)}:o}))),...i.filter((e=>!o.includes(e.property)))];B.createAndCommit({userAction:"CollectionSettingsViewProperties.handlePropertyReorder",environment:this.environment,perform:e=>{Z.FH({stores:[n],update:{[t]:l},transaction:e})}}),P.wd({environment:this.environment,collectionContextStore:r,action:"reorder_properties",original_view_type:n.getType()}),this.stores.menuListStore.reset()},this.handleTogglePropertyVisibility=e=>{var t;const{formatKey:o,propertyFormat:r}=e,{collectionContextStore:n}=this.props,i=n.collectionViewStore();if(!i)return;const a=n.normalizedFormatStore.state,l=(a[o]||[]).filter((e=>e.property!==r.property)),s=l.filter((e=>e.visible)),c=l.filter((e=>!e.visible)),d={...r,visible:!r.visible},p=[...s,d,...c],u={...a,[o]:p};B.createAndCommit({userAction:"CollectionSettingsViewProperties.handleTogglePropertyVisibility",environment:this.environment,perform:e=>{F.iG({collectionViewStore:i,update:{format:u},transaction:e})}}),P.wd({environment:this.environment,collectionContextStore:n,action:"toggle_property_visibility",original_view_type:i.getType(),property_type:null===(t=i.getCollectionStore())||void 0===t||null===(t=t.getSchema()[d.property])||void 0===t?void 0:t.type}),this.clearInput()},this.handlePropertyClick=e=>{var t,o,r;const{collectionSettingsStore:n,collectionContextStore:i}=this.props,a=(null===(t=i.collectionStore())||void 0===t?void 0:t.getSchema())||i.normalizedSchemaStore.state||{},{formatKey:l,propertyFormat:s}=e;P.wd({environment:this.environment,collectionContextStore:i,action:"click_property",original_view_type:null==i||null===(o=i.collectionViewStore())||void 0===o?void 0:o.getType(),property_type:null===(r=a[s.property])||void 0===r?void 0:r.type}),V.H4({collectionSettingsStore:n,item:{type:"property",formatKey:l,property:s.property}})},this.handleViewDeletedPropertiesClick=()=>{const{collectionSettingsStore:e,collectionContextStore:t,timelineViewTab:o}=this.props;t.collectionStore()&&(P.wd({environment:this.environment,collectionContextStore:t,action:"click_deleted_properties"}),V.H4({collectionSettingsStore:e,item:{type:"deletedProperties",timelineViewTab:o}}))},this.handleNewPropertyClick=()=>{const{collectionContextStore:e}=this.props,t=e.collectionStore();t&&(P.wd({environment:this.environment,collectionContextStore:e,action:"click_new_property"}),V.wl({collectionSettingsStore:e.settingsStore,item:{type:"propertyType",propertyTypes:(0,A.TP)({isSyncedCollection:t.isSyncedCollection(),collectionContextStore:e,environment:this.environment}),onAccept:(t,o)=>{_.PW({environment:this.environment,propertyType:t,propertyName:o,collectionContextStore:e,from:"view_settings"})}}}))},this.handleTabChange=e=>{const{collectionSettingsStore:t,collectionContextStore:o}=this.props;P.wd({environment:this.environment,collectionContextStore:o,action:0===e?"click_properties_tab_timeline":"click_properties_tab_table"}),V.FK({collectionSettingsStore:t,item:{type:"properties",timelineViewTab:0===e?"timeline":"table"}}),this.clearInput()},this.handleShowTableClick=()=>{this.clearInput()},this.isFreezeColumnsEnabled=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props,t=e.collectionViewStore();return(0,I.eL)(this.environment.device.isMobile,null==t?void 0:t.getType())}))}renderComponent(){const{collectionContextStore:e,timelineViewTab:t}=this.props,{device:o}=this.environment,{inputStore:r,menuListStore:i}=this.stores,l=r.state,s=(0,E.WY)({collectionContextStore:e}),d=(0,E.jI)({timelineViewTab:t,collectionContextStore:e}),p=(0,R.d$)({environment:this.environment,isFullScreen:e.isFullScreen.state,isRootChild:e.isRootChild.state});return c.createElement(z.ZP,n()({},this.props,{title:a()(T.FormattedMessage,{defaultMessage:"Properties",id:"database.viewSettings.propertiesTab.title"}),header:a()(J.Z,{},void 0,a()(U.ZP,{focusInitial:!o.isMobile,value:l,showClearButton:!0,onChange:e=>{r.setState(e.target.value),i.setState({...i.state,focus:{section:0,indexLocal:0,indexGlobal:0}})},placeholder:L.default.formatMessage(te.inputPlaceholder)})),footer:this.renderFooter()}),"timeline"===s&&p&&this.renderTimelineControls(),d&&this.renderPropertyFormatList(d),a()(J.Z,{},void 0,this.renderDeletedProperties()))}renderTimelineControls(){const{timelineViewTab:e,collectionContextStore:t}=this.props,o="timeline"===e?0:1;return c.createElement(c.Fragment,null,a()(ee.Z,{tabs:[a()(T.FormattedMessage,{defaultMessage:"Timeline",id:"database.viewSettings.propertiesTab.timelineProperties"},"database.viewSettings.propertiesTab.timelineProperties"),a()(T.FormattedMessage,{defaultMessage:"Table",id:"database.viewSettings.propertiesTab.tableProperties"},"database.viewSettings.propertiesTab.tableProperties")],selectedIndex:o,onChange:this.handleTabChange}),"table"===e&&a()(J.Z,{},void 0,a()(re,{collectionContextStore:t,onClick:this.handleShowTableClick})))}renderPropertyFormatList(e){const{collectionContextStore:t}=this.props,o=t.permissionScopes.state,r=t.normalizedFormatStore.state,i=t.normalizedSchemaStore.state,{inputStore:l}=this.stores,d=l.state;let p=r[e]||[];if(d){let e=p.map((e=>{const t=(0,h.Qm)({schema:i,property:e.property});return null==t?void 0:t.name}));e=s().filter(d,e).map((e=>{let{original:t}=e;return t})),p=p.filter((t=>{const o=i[t.property];return o&&o.name&&e.includes(o.name)}))}const u=p.filter((e=>Boolean(e.visible))),m=p.filter((e=>!Boolean(e.visible))),g="timeline_table_properties"===e?"table":(0,E.WY)({collectionContextStore:t});return c.createElement(c.Fragment,null,0===p.length&&a()(J.Z,{},void 0,a()(O.Z,{caption:a()(T.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.propertiesTab.noResults"})})),p.length>0&&a()(Y.Z,{type:Y.i.Vertical,store:this.stores.menuListStore,initialFocus:void 0,sections:k.oA([u.length>0&&{key:"visible_and_hidden_properties",render:t=>c.createElement(J.Z,n()({},t,{noTextOverflow:!0,isTitleUppercase:!1,title:this.renderShownInViewMessage(g),desktopTitleStyle:{height:19},right:!d&&o.canConfigureBlock&&a()($.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>this.handleHideAllClick(e)},void 0,a()(T.FormattedMessage,{id:"database.viewSettings.propertiesTab.hideAllProperties",defaultMessage:"Hide all"})),children:this.renderPropertySortList({formatKey:e,visibleProperties:u,hiddenProperties:m,children:t.children})})),items:k.oA([...this.renderPropertySortListItems({formatKey:e,properties:u}),m.length>0&&{key:"group-header-hidden-property",render:t=>this.renderHiddenPropertySectionHeader({props:t,formatKey:e,children:c.createElement(c.Fragment,null)}),action:()=>{}},...this.renderPropertySortListItems({formatKey:e,properties:m})])},0===u.length&&m.length>0&&{key:"hidden_properties",render:t=>this.renderHiddenPropertySectionHeader({props:t,formatKey:e,children:this.renderPropertySortList({formatKey:e,visibleProperties:u,hiddenProperties:m,children:t.children})}),items:this.renderPropertySortListItems({formatKey:e,properties:m})}])}))}renderHiddenPropertySectionHeader(e){const{props:t,formatKey:o,children:r}=e,{collectionContextStore:i}=this.props,l=i.permissionScopes.state,{inputStore:s}=this.stores,d=s.state,p="timeline_table_properties"===o?"table":(0,E.WY)({collectionContextStore:i});return c.createElement(J.Z,n()({},t,{noTextOverflow:!0,isTitleUppercase:!1,title:this.renderHiddenInViewMessage(p),desktopTitleStyle:{height:19},right:!d&&l.canConfigureBlock&&a()($.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>this.handleShowAllClick(o)},void 0,a()(T.FormattedMessage,{id:"database.viewSettings.propertiesTab.showAllProperties",defaultMessage:"Show all"})),style:{width:"100%",paddingBottom:0},children:r}))}renderFooter(){const{collectionContextStore:e,timelineViewTab:t}=this.props,o=e.permissionScopes.state,r="timeline"===(0,E.WY)({collectionContextStore:e})&&"table"===t&&!(0,E.vw)({collectionContextStore:e}),n=o.canConfigureCollection&&!r;return a()(J.Z,{topBorder:!0},void 0,n&&a()(H.Z,{icon:b.R,title:a()(T.FormattedMessage,{id:"database.viewSettings.propertiesTab.newProperty",defaultMessage:"New property"}),isGray:!0,onClick:this.handleNewPropertyClick}),a()(N.Z,{href:(0,D.UY)("guides.databaseProperties"),title:a()(T.FormattedMessage,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"}))}renderPropertySortList(e){const{formatKey:t,visibleProperties:o,hiddenProperties:r,children:n}=e,i=k.oA([...o.map((e=>e.property)),o.length>0&&r.length>0&&{key:"group-header-hidden-property",draggable:!1},...r.map((e=>e.property))]);return this.canReorder()?a()(G.ZP,{direction:"vertical",keys:i,renderKey:(e,t)=>n[t],onDrop:(e,o)=>{this.handlePropertyReorder({formatKey:t,newPropertyKeys:e})}}):n}renderPropertySortListItems(e){const{formatKey:t,properties:o}=e;return k.oA(o.map((e=>this.renderPropertySortListItem({formatKey:t,propertyFormat:e}))))}renderPropertySortListItem(e){var t;const{formatKey:o,propertyFormat:r}=e,{collectionContextStore:i}=this.props,l=null===(t=i.collectionStore())||void 0===t?void 0:t.isSyncedCollection(),s=i.permissionScopes.state,d=!r.visible,p=i.normalizedSchemaStore.state,u=(0,h.Qm)({schema:p,property:r.property}),m="title"!==r.property||this.primaryPropertyFormatAllowsHidingTitle(o);let S=!s.canConfigureCollection||l&&((0,h.wl)(r.property)||(0,g.HF)(r.property));if("collectionTypedView"===i.contextType&&s.canConfigureBlock&&(S=!1),!u)return;const{theme:b}=this;return{key:r.property,render:e=>c.createElement(Q.Z,n()({},e,{title:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,this.canReorder()&&a()(q.ZP,{iconSize:12,style:{marginRight:8}}),a()(y.ZP,{type:u.type,icon:u.icon,size:16,theme:b,style:{fill:b.regularIconColor}}),a()("span",{style:{marginLeft:8,...x.Z.textOverflowStyle}},void 0,u.name),(0,g.q3)(u)&&a()(W.Z,{})),right:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()(j.Z,{icon:d?C.B:f.c,iconStyle:{width:16,height:16},isDarkIconColor:!d,onClick:()=>{this.handleTogglePropertyVisibility({formatKey:o,propertyFormat:r})},ariaLabel:this.props.intl.formatMessage(te.togglePropertyVisibilityAriaLabel),disabled:!m||!s.canConfigureBlock}),!S&&(0,v.o)({width:12,fill:b.lightTextColor,marginLeft:5}))})),action:()=>{S||this.handlePropertyClick({formatKey:o,propertyFormat:r})}}}renderShownInViewMessage(e){return"table"===e?a()(T.FormattedMessage,{defaultMessage:"Shown in table",id:"database.viewSettings.propertiesTab.shownInTableTitle"}):"timeline"===e?a()(T.FormattedMessage,{defaultMessage:"Shown in timeline",id:"database.viewSettings.propertiesTab.shownInTimelineTitle"}):"board"===e?a()(T.FormattedMessage,{defaultMessage:"Shown in board",id:"database.viewSettings.propertiesTab.shownInBoardTitle"}):"list"===e?a()(T.FormattedMessage,{defaultMessage:"Shown in list",id:"database.viewSettings.propertiesTab.shownInListTitle"}):"gallery"===e?a()(T.FormattedMessage,{defaultMessage:"Shown in gallery",id:"database.viewSettings.propertiesTab.shownInGalleryTitle"}):"calendar"===e?a()(T.FormattedMessage,{defaultMessage:"Shown in calendar",id:"database.viewSettings.propertiesTab.shownInCalendarTitle"}):"page"===e?null:void(0,M.t1)(e)}renderHiddenInViewMessage(e){return"table"===e?a()(T.FormattedMessage,{defaultMessage:"Hidden in table",id:"database.viewSettings.propertiesTab.hiddenInTableTitle"}):"timeline"===e?a()(T.FormattedMessage,{defaultMessage:"Hidden in timeline",id:"database.viewSettings.propertiesTab.hiddenInTimelineTitle"}):"board"===e?a()(T.FormattedMessage,{defaultMessage:"Hidden in board",id:"database.viewSettings.propertiesTab.hiddenInBoardTitle"}):"list"===e?a()(T.FormattedMessage,{defaultMessage:"Hidden in list",id:"database.viewSettings.propertiesTab.hiddenInListTitle"}):"gallery"===e?a()(T.FormattedMessage,{defaultMessage:"Hidden in gallery",id:"database.viewSettings.propertiesTab.hiddenInGalleryTitle"}):"calendar"===e?a()(T.FormattedMessage,{defaultMessage:"Hidden in calendar",id:"database.viewSettings.propertiesTab.hiddenInCalendarTitle"}):"page"===e?null:void(0,M.t1)(e)}renderDeletedProperties(){const{collectionContextStore:e}=this.props,t=e.normalizedDeletedSchemaStore.state,o=Object.keys(t).length;if(e.permissionScopes.state.canConfigureCollection&&o>0)return a()(H.Z,{icon:w.y,title:a()(T.FormattedMessage,{id:"database.viewSettings.propertiesTab.deletedProperties",defaultMessage:"Deleted properties"}),isGray:!0,onClick:this.handleViewDeletedPropertiesClick,right:o,showChevron:!0})}canReorder(){const{inputStore:e}=this.stores,t=e.state,{collectionContextStore:o}=this.props,r=o.permissionScopes.state;return!this.environment.device.isMobile&&r.canConfigureBlock&&!t}setAllPropertiesVisibility(e){const{formatKey:t,visibility:o}=e,{collectionContextStore:r}=this.props,n=r.collectionViewStore();if(!n)return;const i=r.normalizedFormatStore.state[t]||[],a=i.filter((e=>Boolean(e.visible))),l=i.filter((e=>!Boolean(e.visible))),s=[...a.map((e=>({...e,visible:o}))),...l.map((e=>({...e,visible:o})))];B.createAndCommit({userAction:"CollectionSettingsViewProperties.setAllPropertiesVisibility",environment:this.environment,perform:e=>{Z.FH({stores:[n],update:{[t]:s},transaction:e})}})}primaryPropertyFormatAllowsHidingTitle(e){const{collectionContextStore:t}=this.props,o=t.normalizedFormatStore.state,r=(0,E.WY)({collectionContextStore:t});return"board"===r?(0,S.Lw)(o.board_cover):"gallery"===r?(0,S.Lw)(o.gallery_cover):"timeline"===r&&("timeline_table_properties"===e||(0,S.vP)(Boolean(o.timeline_show_table),o.timeline_table_properties||[]))}clearInput(){this.stores.inputStore.reset()}}function re(e){window.__c={n:"TimelineShowTableSwitcher"};const{collectionContextStore:t,onClick:o}=e,r=(0,p.O7)(),n=(0,u.Kw)(t.normalizedFormatStore),i=Boolean(n.timeline_show_table),l=(0,u.Kw)(t.permissionScopes);return a()(X.Z,{title:a()(T.FormattedMessage,{defaultMessage:"Show table",id:"database.viewSettings.propertiesTab.showTable"}),on:i,focused:!1,onClick:()=>{const e=t.collectionViewStore();e&&(B.createAndCommit({userAction:"CollectionSettingsViewProperties.TimelineShowTableSwitcher",environment:r,perform:t=>{Z.FH({stores:[e],update:{timeline_show_table:!i,timeline_table_properties:[{property:"name",visible:!0}]},transaction:t})}}),null==o||o(),P.wd({environment:r,collectionContextStore:t,action:"timeline_toggle_show_table"}))},disabled:!l.canConfigureBlock,textWrapperStyle:{opacity:1}})}oe.displayName="CollectionSettingsViewProperties";const ne=(0,T.injectIntl)(oe)},12076:(e,t,o)=>{o.d(t,{Z:()=>O});var r=o(10434),n=o.n(r),i=o(23174),a=o.n(i),l=o(67294),s=o(83355),c=o(8848);const d=(0,o(45238).I)("collectionDeleteRule",{viewBox:"0 0 14 14",svg:a()("path",{d:"M12 3.27273L10.7273 2L7 5.72727L3.27273 2L2 3.27273L5.72727 7L2 10.7273L3.27273 12L7 8.27273L10.7273 12L12 10.7273L8.27273 7L12 3.27273Z"})});var p=o(47453),u=o(37612),m=o(72126),g=o(5366),h=o(50906),y=o(12534),S=o(33929),v=o(87279),f=o(31339),C=o(42917),b=o(61053),w=o(60246),k=o(52275),M=o(31945),x=o(45959),T=o(77498),P=o(62045),V=o(50542);class _ extends s.Z{constructor(){super(...arguments),this.handleAccept=e=>{const{sort:t,collectionViewType:o}=this.props,r={...t,property:e};this.props.onChange(this.props.index,r),o&&h.wds(this.environment,{view_type:o,action:"set_sort_property"})}}renderComponent(){const{schema:e,sort:t}=this.props,o=e[t.property];if(o)return a()(l.Fragment,{},void 0,this.renderPropertyDropdown(o),this.renderSortDirection())}renderPropertyDropdown(e){const{device:t}=this.environment,{disabled:o}=this.props;return a()(M.ZP,{popupType:t.isMobile?M.Z4.SlideUp:M.Z4.Popup,renderOrigin:t=>l.createElement(V.Z,n()({},t,{propertySchema:e,disabled:o,textWrapperStyle:{opacity:1}})),render:e=>a()(T.Z,{isRelationProperty:!1,schema:this.props.schema,onAccept:this.handleAccept,onClose:e.close}),disabled:o})}renderSortDirection(){const{sort:e,index:t,onChange:o,collectionViewType:r,intl:i,disabled:a}=this.props,s=e.direction,c={menuTitle:i.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.title",defaultMessage:"Sort"}),items:[...w.C6],getKey:e=>e,selectedItem:s,disabled:a,onSelect:n=>{const i={...e,direction:n};o(t,i),r&&h.wds(this.environment,{view_type:r,action:"set_sort_direction"})},renderItem:e=>l.createElement(k.Z,n()({title:_.sortDirectionMessage[e.value]},e)),renderOrigin:e=>l.createElement(P.Z,n()({},e,{placeholder:i.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.placeholder",defaultMessage:"Empty"}),title:s&&_.sortDirectionMessage[s],disabled:a,desktopStyle:{opacity:1}}))};return l.createElement(x.Z,n()({key:"direction"},c,{mobileActionSheet:!0}))}}_.displayName="CollectionSortMenuRow",_.sortDirectionMessage={ascending:a()(g.FormattedMessage,{defaultMessage:"Ascending",id:"collectionSortMenuRow.sortDirectionSelectMenu.ascending"}),descending:a()(g.FormattedMessage,{defaultMessage:"Descending",id:"collectionSortMenuRow.sortDirectionSelectMenu.descending"})};const F=(0,g.injectIntl)(_);var Z=o(79131),B=o(73063),A=o(78140),E=o(28992),R=o(53437),I=o(72495),L=o(26388);const D=(0,g.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a propertyâ€¦",id:"database.viewSettings.collectionSortMenu.inputPlaceholder"}});class K extends s.Z{constructor(){super(...arguments),this.handleDraggableListDrop=e=>{const{onChange:t}=this.props,{sorts:o}=this.props;t(m.oA(e.map((e=>o[parseInt(e)]))));const r=this.getCurrentViewType();r&&h.wds(this.environment,{action:"reorder_sorts",view_type:r})},this.handleChangeSort=(e,t)=>{const{onChange:o}=this.props,{sorts:r}=this.props;o(r.map(((o,r)=>r===e?t:o)));const n=this.getCurrentViewType();n&&h.wds(this.environment,{action:"update_sort",view_type:n})},this.handleDeleteSort=e=>{const{onChange:t}=this.props,{sorts:o}=this.props;t(o.filter(((t,o)=>o!==e)));const r=this.getCurrentViewType();r&&h.wds(this.environment,{action:"delete_sort",view_type:r})},this.handleDeleteAllSortsClick=()=>{const{onChange:e,onDeleteAll:t}=this.props;e([]),null==t||t();const o=this.getCurrentViewType();o&&h.wds(this.environment,{action:"delete_all_sorts",view_type:o})},this.handleNewPropertyAccept=e=>{var t;if(!e)return;const{schema:o,sorts:r,onChange:n}=this.props,i=null===(t=o[e])||void 0===t?void 0:t.type;n([...r,{property:e,direction:"ascending"}]);const a=this.getCurrentViewType();a&&h.wds(this.environment,{action:"create_sort_accept",view_type:a,property_type:i})}}renderComponent(){const{device:e}=this.environment,{schema:t,format:o,sorts:r,showDeleteAll:i}=this.props,s=!!Object.keys(t).some((e=>!r.find((t=>t.property===e)))),c=i&&r.length>0;return l.createElement(l.Fragment,null,this.renderSorts(),(s||c)&&a()(I.Z,{},void 0,s&&a()(M.ZP,{popupType:e.isMobile?R.kQ.SlideUp:R.kQ.Popup,renderOrigin:e=>l.createElement(C.Z,n()({icon:p.R,isGray:!0,title:a()(g.FormattedMessage,{id:"database.viewSettings.sortTab.newSort",defaultMessage:"Add sort"})},e)),render:n=>{let i;return i=e.isMobile?{menuType:v.og.ActionSheet}:{menuType:v.og.Popup,width:280,height:287},l.createElement(A.Z,i,a()(b.Z,{schema:t,format:o,getProperties:()=>Object.keys(t).filter((e=>!r.find((t=>t.property===e)))),onAccept:e=>{this.handleNewPropertyAccept(e),n.close()},inputPlaceholder:S.default.formatMessage(D.inputPlaceholder)}))}}),c&&a()(C.Z,{icon:u.y,isRed:!0,isGray:!0,title:a()(g.FormattedMessage,{id:"database.viewSettings.sortTab.deleteAllSorts",defaultMessage:"Delete sort"}),onClick:this.handleDeleteAllSortsClick})))}renderSorts(){const{device:e}=this.environment,{sorts:t}=this.props;if(e.isMobile)return t.map(((e,t)=>this.renderSort(e,t)));{const e=t.map(((e,t)=>t.toString()));return e.length>0&&a()("div",{style:{marginBottom:2}},void 0,a()(Z.ZP,{direction:"vertical",keys:e,renderKey:e=>this.renderSort(t[parseInt(e)],parseInt(e)),onDrop:this.handleDraggableListDrop}))}}renderSort(e,t){const{device:o}=this.environment,{schema:r,disabled:n,parentStore:i}=this.props;return o.isMobile?a()(I.Z,{},t,a()(F,{index:t,sort:e,schema:r,parentStore:i,collectionViewType:this.getCurrentViewType(),onChange:this.handleChangeSort}),!n&&this.renderMobileDeleteButtonMenuItem(t)):a()(I.Z,{extraTopPadding:!0,desktopStyle:{padding:"8px 0 0 8px",width:"100%"}},t,a()(E.Z,{showDragHandle:!o.isMobile&&!n,title:a()("div",{style:{display:"flex",alignItems:"center",flexGrow:1,whiteSpace:"nowrap"},onMouseDown:y.$0},void 0,a()(F,{index:t,sort:e,schema:r,parentStore:i,collectionViewType:this.getCurrentViewType(),onChange:this.handleChangeSort})),right:!n&&this.renderDesktopDeleteButton(t)}))}renderMobileDeleteButtonMenuItem(e){return a()(k.Z,{title:a()("div",{style:{color:c.ZP.red}},void 0,a()(g.FormattedMessage,{defaultMessage:"Delete",id:"database.viewSettings.sortTab.mobileDeleteButtonTitle"})),icon:a()(f.Z,{icon:u.y,styles:{color:c.ZP.red}}),onClick:()=>this.handleDeleteSort(e),focused:!1})}renderDesktopDeleteButton(e){return a()(L.Z,{render:t=>l.createElement(B.Z,n()({icon:d,onClick:()=>this.handleDeleteSort(e),style:{marginRight:-6}},t)),renderTooltip:()=>a()(g.FormattedMessage,{defaultMessage:"Remove sort rule",id:"database.sortMenu.deleteButtonTooltip"})})}getCurrentViewType(){const{collectionViewStore:e}=this.props;return null==e?void 0:e.getType()}}K.displayName="CollectionSortMenu";const O=(0,g.injectIntl)(K)},5795:(e,t,o)=>{o.d(t,{vV:()=>de,QF:()=>se,li:()=>ye});var r=o(10434),n=o.n(r),i=o(23174),a=o.n(i),l=o(67294),s=o(480),c=o(86628),d=o(24405),p=o(3865),u=o(48777),m=o(23290),g=o(76218),h=o(72126),y=o(5366),S=o(6287),v=o(97880),f=o(9953),C=o(39699),b=o(30950),w=o(24457),k=o(29502),M=o(28267),x=o(52275),T=o(31945),P=o(78140),V=o(32163),_=o(72495),F=o(61766),Z=o(38752),B=o(53437),A=o(72865),E=o(68626),R=o(87279),I=o(77907),L=o(40721),D=o(74648);const K=(0,I.withDependency)(I.deps.formulas,((e,t)=>l.createElement(O,n()({},t,{formulas:e}))));function O(e){window.__c={n:"FormulaInputMenu"};const{value:t,onChange:o,onClose:r,disabled:n,contextStore:i,formulas:d}=e,p=(0,s.Fy)(),u=(0,l.useCallback)((()=>{o({type:"simple",value:null==t?void 0:t.value}),r()}),[o,r,null==t?void 0:t.value]),m=(0,l.useCallback)((e=>{void 0!==e&&e[0][0].length?o({type:"formula",value:e}):o(void 0),r()}),[o,r]),g=(0,c.VK)((()=>i.context.parentRecordStore.getSpaceId()),[i.context.parentRecordStore]),h=(0,c.Kw)(i.compilationResultStore),y=(0,l.useMemo)((()=>d.createFormulaDataRequestHandler(i.context.parentRecordStore.getRecordModel,i.context.parentRecordStore.loadRecordModel)),[i.context.parentRecordStore.getRecordModel,i.context.parentRecordStore.loadRecordModel,d]),S=(0,c.VK)((()=>{if(E.x.isFail(h))return;return{valueTypes:h.value.valueTypes,handleDataRequest:y}}),[h,y],{useDeepEqual:!0});let v;return v=p.isMobile?{menuType:R.og.Modal,right:a()(L.DoneMenuText,{}),onClickRight:parent.close}:{menuType:R.og.Popup,maxHeight:"50vh",width:600,height:320,disableHeaderBorder:!0},g&&S?l.createElement(P.Z,v,a()(D.Z,{formulas:d,initialCode:null==t?void 0:t.value,typecheckContext:S,handleClose:m,handleBack:u,parentSpaceId:g,disabled:n,focus:!0,evaluationErrors:[],getRecordModel:i.context.parentRecordStore.getRecordModel})):null}var N=o(70203),z=o(17809),H=o(65187);function W(e){window.__c={n:"NumberInput"};const{value:t,disabled:o,buttonPopupStore:r,onChange:n}=e,i=(0,d.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:3,padding:4}})),[]),s=(0,l.useCallback)((e=>{"="===(0,N.QaF)(e)&&(0,z.formulaButtonsEnabled)()?(n({type:"formula",value:void 0}),r.setState({open:!0})):n({type:"simple",value:e})}),[n,r]),{store:c}=(0,z.useMockTextStore)({initialValue:null==t?void 0:t.value,onChange:s});return a()("div",{style:i.wrap},void 0,a()(H.Z,{disabled:o,store:c,pasteBehavior:"inline",disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableEquationInteraction:!0}))}var Q=o(53498),G=o(18466),q=o(13991),j=o(32426),U=o(82990),Y=o(60682),$=o(14976),J=o(75311),X=o(30387);function ee(e){window.__c={n:"ValuePickerValue"};const{value:t,type:o,currentSimpleFormulaValueTokens:r,contextStore:n,context:i}=e,{collectionStore:s,property:p}=i,u=(0,d.yK)((()=>({tokenWrap:{display:"flex",alignItems:"center",flexGrow:1,overflow:"hidden",marginTop:6}})),[]),m=(0,J.M)(s,p),g=(0,c.VK)((()=>(0,z.formulaButtonsEnabled)()),[]);if("formula"===(null==t?void 0:t.type)&&t.value&&g)return l.createElement(oe,e);if("text"===o.type||"number"===o.type)return null;if("date"===o.type||"select"===o.type||"checkbox"===o.type){const e=r[0];return void 0===e?a()(te,{}):a()("div",{style:u.tokenWrap},void 0,a()(Q.K,{token:e,contextStore:n,disabled:!0,currentSimpleFormulaValueTokens:r,context:i}))}if("person_array"===o.type||"block_array"===o.type||"select_array"===o.type)return 0===r.length?a()(te,{}):a()("div",{style:u.tokenWrap},void 0,m(r,"first").map(((e,t)=>a()(Q.K,{token:e,contextStore:n,disabled:!0,currentSimpleFormulaValueTokens:r,context:i},t))));(0,v.t1)(o)}function te(){window.__c={n:"ValueEmptyPlaceholder"};const e=(0,d.yK)((e=>({placeholderText:{color:e.lightTextColor}})),[]);return a()("div",{style:e.placeholderText},void 0,l.createElement(y.FormattedMessage,X.s.personSelect))}function oe(e){window.__c={n:"MinimalFormulaText"};const{value:t,contextStore:o}=e,r=(0,s.O7)(),n=(0,d.Fg)(),i=(0,d.yK)((e=>({wrap:{display:"flex",alignItems:"center",pointerEvents:"none",fontFamily:U.Z.getCompositeFontFamily(q.SP).githubMono,fontSize:12,flexGrow:1,...U.Z.textOverflowStyle},icon:{width:14,fill:e.mediumIconColor,marginRight:6}})),[]),p=(0,Y.kw)(),u=(0,c.VK)((()=>r.KatexStore.getKatex()),[r]),m=(0,c.VK)((()=>o.context.parentRecordStore.getSpaceId()),[o.context.parentRecordStore]),g=(0,c.Kw)(o.compilationResultStore),h=E.x.isSuccess(g)?g.value.valueTypes:void 0,y=(0,l.useMemo)((()=>G.Z.withListenerIgnored((()=>(0,$.IY)({environment:r,textValue:null!=t&&t.value&&m?{value:t.value,spaceId:m}:void 0,parentStore:o.context.parentRecordStore,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:n,emojiType:p,katex:u,parentBlockId:void 0,renderedPageBlockId:void 0,formulaValueTypes:h||[]})))),[t,m,r,o.context.parentRecordStore,p,u,n,h]);return a()("div",{style:i.wrap},void 0,(0,j.D)(i.icon),y)}function re(e){window.__c={n:"SimpleFormulaValuePicker"};const{type:t,value:o,disabled:r}=e,i=(0,s.Fy)(),p=!o||"simple"===o.type,u=(0,c.VK)((()=>(0,g.A6)(null==o?void 0:o.value)),[o]),m=(0,d.yK)((e=>({button:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow}})),[]),h=(0,c.qz)(void 0,F.Z);return"number"===t.type&&p?l.createElement(W,n()({},e,{buttonPopupStore:h})):"text"===t.type?l.createElement(A.D,e):a()(T.ZP,{popupType:i.isMobile?B.kQ.SlideUp:B.kQ.Popup,alignmentToOrigin:T.vR.End,placementToOrigin:T.pO.Bottom,originGap:0,buttonPopupStore:h,disabled:r,renderOrigin:t=>l.createElement(Z.S,n()({disabled:r,variant:"gray"},t,{style:m.button}),l.createElement(ee,n()({},e,{currentSimpleFormulaValueTokens:u}))),render:t=>p?l.createElement(Q.a,n()({},e,{onClose:t.close,currentSimpleFormulaValueTokens:u})):l.createElement(K,n()({},e,{onClose:t.close}))})}var ne=o(39068),ie=o(61053);function ae(e){window.__c={n:"AutomationPropertyPicker"};const{availablePropertyIds:t,currentValue:o,collectionStore:r,onChange:i,onRemove:p,disabled:u,alreadyHaveProperties:m}=e,g=(0,s.O7)(),h=(0,d.Fg)(),{device:S}=g,v=(0,c.VK)((()=>r.getSchema()??{}),[r]),f=(0,c.VK)((()=>r.getFormat()??{}),[r]),C=(0,c.VK)((()=>o?r.getSchema()[o]:void 0),[o,r]),b=(0,d.yK)((e=>({propertyIcon:{fill:e.lightTextColor,height:"auto",marginRight:4,width:16}})),[]),M=(0,l.useCallback)((()=>t),[t]),x=(0,k.d)();return a()(T.ZP,{popupType:x,alignmentToOrigin:T.vR.End,placementToOrigin:T.pO.Bottom,originGap:0,disabled:u,renderOrigin:e=>l.createElement(Z.S,n()({},e,{disabled:u,icon:C?e=>a()(ne.ZP,{icon:void 0,type:C.type,size:16,theme:h,style:{...e,...b.propertyIcon}}):void 0,variant:m||C?C?"default":"gray":"blue"}),C?l.createElement(l.Fragment,null,a()("div",{style:{fontWeight:U.Z.fontWeight.medium,...U.Z.textOverflowStyle}},void 0,C.name)):a()(y.FormattedMessage,m?{id:"automations.propertyPicker.buttonPlaceholderAlreadyHaveProperties",defaultMessage:"Edit another property"}:{id:"automations.propertyPicker.buttonPlaceholder",defaultMessage:"Edit a property"})),render:e=>{const t=(0,w.U)({device:S,width:280,paddingTop:4});return l.createElement(P.Z,t,a()(ie.Z,{schema:v,format:f,showRemoveOption:Boolean(p),currentProperty:o,getProperties:M,onAccept:t=>{t&&t!==o?i(t):void 0===t&&(null==p||p(o)),e.close()}}))}})}const le=(0,y.defineMessages)({replaceActionLabel:{id:"automations.AutomationActionSetPropertiesSection.replaceAction.label",defaultMessage:"Replace with"},appendActionLabel:{id:"automations.AutomationActionSetPropertiesSection.appendAction.label",defaultMessage:"Add"},removeActionLabel:{id:"automations.AutomationActionSetPropertiesSection.removeAction.label",defaultMessage:"Remove"},titlePlaceholder:{id:"automations.AutomationActionSetPropertiesSection.titlePlaceholder",defaultMessage:"Untitled"}});function se(e){window.__c={n:"ButtonAutomationActionSetPropertiesSection"};const{contextStore:t,actionStore:o,collectionStore:r,disabled:n,showSetPropertyActions:i}=e,d=(0,s.O7)(),p=(0,c.VK)((()=>o.id),[o.id]),u=(0,c.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e?void 0:e.values)??{}}),[o]),m=(0,c.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e?void 0:e.properties)??[]}),[o]),g=(0,l.useMemo)((()=>({properties:m,values:u})),[m,u]),h=(0,l.useCallback)((e=>{const t=m.concat([e]),r={...u,[e]:void 0};C.createAndCommit({userAction:"AutomationActionSetPropertiesSection.propertiesChange",environment:d,perform:e=>{ce({configStore:o.getConfigStore(),properties:t,transaction:e,values:r})}})}),[d,m,u,o]),y=(0,l.useCallback)(((e,t)=>{const r=m.indexOf(e);if(-1===r)return;const n=m.slice(0);n[r]=t;const i={...u,[t]:void 0};C.createAndCommit({userAction:"AutomationActionSetPropertiesSection.setProperties",environment:d,perform:e=>{ce({configStore:o.getConfigStore(),properties:n,transaction:e,values:i})}})}),[d,m,u,o]),S=(0,l.useCallback)((e=>{const t=m.filter((t=>t!==e)),r={...u,[e]:void 0};C.createAndCommit({userAction:"AutomationActionSetPropertiesSection.removeProperty",environment:d,perform:e=>{ce({configStore:o.getConfigStore(),properties:t,transaction:e,values:r})}})}),[d,m,u,o]),v=(0,l.useCallback)(((e,t)=>{const r={...u,[e]:t};C.createAndCommit({userAction:"AutomationActionSetPropertiesSection.handleValueChange",environment:d,perform:e=>{ce({configStore:o.getConfigStore(),properties:m,transaction:e,values:r})}})}),[d,m,u,o]);return a()(de,{contextStore:t,actionId:p,config:g,onPropertyAdd:h,onPropertyChange:y,onPropertyRemove:S,onPropertyValueChange:v,collectionStore:r,showSetPropertyActions:i,disabled:n})}function ce(e){const{configStore:t,properties:o,transaction:r,values:n}=e;f.sW({store:t,data:{properties:o,values:n},transaction:r})}function de(e){window.__c={n:"AutomationActionSetPropertiesSection"};const{contextStore:t,actionId:o,config:r,collectionStore:n,onPropertyAdd:i,onPropertyChange:s,onPropertyRemove:u,onPropertyValueChange:m,disabled:g,showSetPropertyActions:h}=e,y=(0,d.yK)((e=>({addPropertyValuePlaceholder:{color:e.mediumTextColor,flexGrow:1,textAlign:"right"},addPropertyRow:{display:"flex",alignItems:"center"}})),[]),S=(0,c.VK)((()=>(0,p.cO)({collectionFormat:n.getFormat(),collectionSchema:n.getSchema(),sort:!1,sourcePropertyIds:r.properties})),[n,r.properties]),v=(0,c.VK)((()=>(0,p.cO)({collectionFormat:n.getFormat(),collectionSchema:n.getSchema(),filter:e=>{let[t]=e;return!S.includes(t)}})),[n,S]),f=0===v.length;return l.createElement(l.Fragment,null,S.length>0&&a()(pe,{availablePropertyIds:v,contextStore:t,actionId:o,config:{properties:S,values:r.values},collectionStore:n,onPropertyChange:s,onPropertyRemove:u,onPropertyValueChange:m,showSetPropertyActions:h,disabled:g}),!g&&!f&&a()("div",{style:y.addPropertyRow},void 0,a()(ae,{availablePropertyIds:v,currentValue:void 0,collectionStore:n,contextStore:t,onChange:i,disabled:g,alreadyHaveProperties:S.length>0})))}function pe(e){window.__c={n:"PropertySectionList"};const{availablePropertyIds:t,contextStore:o,actionId:r,config:n,collectionStore:i,onPropertyChange:s,onPropertyRemove:c,onPropertyValueChange:p,showSetPropertyActions:u,disabled:m}=e,g=(0,l.useRef)(null),h=(0,M.X)(g),y=(0,b.a)(h),S=(0,d.yK)((()=>({wrap:{alignItems:"center",columnGap:4,display:"grid",gridTemplateColumns:y?"100%":"140px 1fr",rowGap:y?4:8},propertyValue:{...y?{fontSize:14,marginBlockEnd:16}:{}},lastPropertyValue:{...y?{fontSize:14,marginBlockEnd:0}:{}}})),[y]);return l.createElement("div",{style:S.wrap,ref:g},n.properties.map(((e,l)=>{const d=l===n.properties.length-1;return a()(ue,{actionId:r,availablePropertyIds:t,collectionStore:i,contextStore:o,disabled:m,onPropertyChange:s,onPropertyRemove:c,onPropertyValueChange:p,property:e,showSetPropertyActions:u,value:n.values[e],valueStyle:d?S.lastPropertyValue:S.propertyValue},e)})))}function ue(e){window.__c={n:"PropertySection"};const{actionId:t,availablePropertyIds:o,collectionStore:r,contextStore:i,disabled:s,onPropertyChange:p,onPropertyRemove:h,onPropertyValueChange:v,property:f,showSetPropertyActions:C,value:b,valueStyle:w}=e,k={type:"collection",collectionStore:r,property:f},M=(0,y.useIntl)(),x=(0,d.yK)((e=>({propertyName:{},propertyValue:{display:"flex",gap:4,minWidth:50,...w}})),[w]),T=(0,l.useMemo)((()=>{if("title"===f)return M.formatMessage(le.titlePlaceholder)}),[M,f]),P=(0,c.VK)((()=>{const e=r.getSchema()[f];if(e)return e}),[r,f]),V=(0,c.VK)((()=>{if(P)return(0,g.qW)({table:S.v,id:r.id,spaceId:r.getSpaceId()},f,P)}),[r,P,f]),_=(0,c.VK)((()=>null==P?void 0:P.type),[P]),F=null==b?void 0:b.value,Z=(0,c.VK)((()=>(0,m.o9)(b)),[b]),B=(0,c.VK)((()=>i.context.parentRecordStore.getSpaceId()),[i.context.parentRecordStore]),A=(0,c.VK)((()=>i.getContextValuesForAction(t)),[i,t]),E=(0,l.useCallback)((e=>{p(f,e)}),[p,f]),R=(0,l.useCallback)((()=>h(f)),[h,f]),I=(0,l.useCallback)((e=>{v(f,e)}),[v,f]),L=(0,l.useCallback)((e=>{I({action:e,value:F})}),[F,I]),D=(0,l.useCallback)((e=>{I({action:Z,value:e})}),[Z,I]);if(!V||!B)return null;const K=ye(_);return l.createElement(l.Fragment,null,a()("div",{style:x.propertyName},void 0,a()(ae,{availablePropertyIds:o,currentValue:f,contextStore:i,collectionStore:r,onChange:E,disabled:s,onRemove:R})),a()("div",{style:x.propertyValue},void 0,C&&P&&u.Y[P.type]&&a()(me,{disabled:s,onChange:L,value:Z}),l.createElement(re,n()({},K,{type:V,value:null==b?void 0:b.value,onChange:D,disabled:s,contextStore:i,context:k,placeholder:T,disableMobileActionBar:!0,formulaTypecheckContextValues:A,disableTemplateVariableMentions:!0}))))}function me(e){window.__c={n:"SetPropertyListActionDropdownButton"};const{disabled:t,onChange:o,value:r}=e,i=(0,k.d)();return a()(T.ZP,{popupType:i,alignmentToOrigin:T.vR.End,placementToOrigin:T.pO.Bottom,originGap:0,disabled:t,renderOrigin:e=>l.createElement(Z.S,n()({disabled:t,variant:"gray"},e),a()(he,{action:r})),render:e=>a()(ge,{onChange:o,parent:e,value:r})})}function ge(e){window.__c={n:"SetPropertyListActionDropdownMenu"};const{value:t,onChange:o,parent:r}=e,i=(0,w.F)({width:250}),s=h.oA(m.E2.map(((e,i)=>({key:i,render:o=>l.createElement(x.Z,n()({},o,{disabled:!1,title:a()(he,{action:e}),checkState:t===e})),action:()=>{e!==t&&o(e),r.close()}}))));return l.createElement(P.Z,i,a()(V.Z,{type:V.i.Vertical,sections:[{key:0,render:e=>l.createElement(_.Z,n()({enableActionSheetTitle:!0},e)),items:s}],initialFocus:0}))}function he(e){const{action:t}=e;return"replace"===t?l.createElement(y.FormattedMessage,le.replaceActionLabel):"append"===t?l.createElement(y.FormattedMessage,le.appendActionLabel):"remove"===t?l.createElement(y.FormattedMessage,le.removeActionLabel):void(0,v.t1)(t)}function ye(e){return"email"===e||"phone_number"===e||"url"===e?{disableEmojiCommands:!0,disableFormattingAndMentions:!0}:{}}},68214:(e,t,o)=>{o.d(t,{a:()=>f});var r=o(10434),n=o.n(r),i=o(23174),a=o.n(i),l=o(67294),s=o(86628),c=o(84619),d=o(5366),p=o(29502),u=o(61766),m=o(57559),g=o(31945),h=o(76798),y=o(21396),S=o(38752),v=o(29758);function f(e){window.__c={n:"AutomationCollectionPicker"};const{actionStore:t,currentValue:o,contextStore:r,onChange:i,disabled:f,errorMessage:C}=e,b=(0,s.qz)(void 0,u.Z),w=(0,s.VK)((()=>o&&"collection"===o.type?m.NW.createChildStore(r.context.parentRecordStore,o.collection):void 0),[o,r.context.parentRecordStore]),k=(0,s.VK)((()=>{if(t&&o&&"variable"===o.type)return r.getContextValueForActionById(t.id,o.id)}),[t,o,r]),M=(0,l.useCallback)((e=>{"collection"!==e.type&&"variable"!==e.type||(i(e),b.reset())}),[i,b]),x=(0,l.useCallback)((()=>b.reset()),[b]),T=(0,p.d)(),P=(0,S.d)({errorMessage:C,hasValue:Boolean(w||k)});return a()(g.ZP,{buttonPopupStore:b,popupType:T,alignmentToOrigin:g.vR.End,placementToOrigin:g.pO.Bottom,originGap:0,disabled:f,renderOrigin:e=>l.createElement(S.S,n()({},P,e,{disabled:f}),w?a()(h.Z,{store:w}):k?a()(y.F,{format:c.l.Medium,isSingle:!0,value:k}):a()(d.FormattedMessage,{id:"automations.databasePicker.buttonPlaceholder",defaultMessage:"Select database"})),render:e=>a()(v.L,{actionId:null==t?void 0:t.id,automationContextStore:r,onChange:M,onClose:x,selectedTarget:o,skipPages:!0})})}},19959:(e,t,o)=>{o.d(t,{f:()=>k});var r=o(10434),n=o.n(r),i=o(23174),a=o.n(i),l=o(67294),s=o(480),c=o(86628),d=o(72126),p=o(5366),u=o(21202),m=o(24457),g=o(29502),h=o(57559),y=o(40071),S=o(31945),v=o(78140),f=o(32163),C=o(76798),b=o(72495),w=o(38752);function k(e){window.__c={n:"AutomationCollectionTemplatePicker"};const{collectionStore:t,currentTemplateId:o,onChange:r,disabled:i,errorMessage:d}=e,y=(0,s.O7)(),{device:f}=y,b=(0,c.VK)((()=>{let e=o;if(!e&&t){const o=t.getFormat().collection_default_template;o&&"empty"!==o&&(e=o.template_page_id)}if(e&&t)return h.G.createChildStore(t,{table:u.iU,id:e,spaceId:t.getSpaceId()})}),[t,o]),k=(0,g.d)(),x=(0,w.d)({errorMessage:d,hasValue:!0}),T=(0,c.VK)((()=>{var e;return(null==t||null===(e=t.getTemplatePageStores())||void 0===e?void 0:e.filter((e=>e.pathIsAccessibleAndAlive())))??[]}),[t]),P=Boolean(o);return a()(S.ZP,{popupType:k,alignmentToOrigin:S.vR.End,placementToOrigin:S.pO.Bottom,originGap:0,disabled:i,renderOrigin:e=>l.createElement(w.S,n()({},x,e,{disabled:i,style:{minWidth:50}}),b&&(P||b.pathIsAccessibleAndAlive())?a()(C.Z,{store:b}):a()(p.FormattedMessage,{id:"automations.templatePicker.buttonPlaceholder",defaultMessage:"Empty"})),render:e=>{const o=(0,m.U)({device:f,width:280});return l.createElement(v.Z,o,t&&a()(M,{collectionStore:t,templatePageStores:T,parent:e,onChange:r}))}})}function M(e){window.__c={n:"AutomationCollectionTemplateMenuList"};const{collectionStore:t,templatePageStores:o,parent:r,onChange:i}=e,u=(0,s.O7)(),{device:m}=u,g=(0,c.VK)((()=>t.getDefaultTemplatePageStore()),[t]),h=o.map((e=>({key:e.id,render:o=>l.createElement(y.Z,n()({},o,{key:e.id,isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:e,isMobile:m.isMobile,locked:!0,isDefault:g===e,onCancelClick:()=>{},draggable:!1})),action:t=>{i(e.id),r.close()}}))),S={key:"empty",render:e=>l.createElement(y.Z,n()({},e,{key:"empty",isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:void 0,isMobile:m.isMobile,locked:!0,onCancelClick:()=>{},draggable:!1})),action:e=>{i(void 0),r.close()}};return a()(f.Z,{type:f.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>l.createElement(b.Z,n()({},e,{title:a()(p.FormattedMessage,{id:"automations.templatePicker.menuHeader",defaultMessage:"Select a template"})})),items:d.oA([...h,g?void 0:S])}]})}},80117:(e,t,o)=>{o.d(t,{W:()=>C});var r=o(10434),n=o.n(r),i=o(23174),a=o.n(i),l=o(67294),s=o(86628),c=o(76205),d=o(5366),p=o(24457),u=o(29502),m=o(88426),g=o(42917),h=o(31945),y=o(8982),S=o(78140),v=o(72495),f=o(38752);function C(e){var t;window.__c={n:"AutomationCombinatorFilterPopup"};const{contextStore:o,filter:r,onChange:i,noFiltersMessage:s,collectionStore:p,disabled:m}=e,g=(0,u.d)({tabletBehavior:"slideUp"}),y=(null==r||null===(t=r.filters)||void 0===t?void 0:t.length)||0;return a()(h.ZP,{popupType:g,alignmentToOrigin:h.vR.End,placementToOrigin:h.pO.Bottom,originGap:0,disabled:m,renderOrigin:e=>l.createElement(f.S,n()({disabled:m,variant:"gray"},e,{onClick:t=>{e.onClick(t),0===y&&i(c.TI)}}),y>0?a()(d.FormattedMessage,{defaultMessage:"{ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",id:"automations.QueryCollectionAction.filterRuleCount.label",values:{ruleCount:y}}):s),render:e=>a()(b,{contextStore:o,filter:r,disabled:m,onChange:i,onClose:()=>e.close(),collectionStore:p})})}function b(e){window.__c={n:"AutomationCombinatorFilterMenu"};const{contextStore:t,filter:o,onChange:r,onClose:n,collectionStore:i}=e,u=(0,s.VK)((()=>i.getSchema()),[i]),h=(0,p.F)({minWidth:300,tabletBehavior:"actionSheet"}),f=(0,l.useCallback)(((e,t)=>{r(t)}),[r]),C=(0,l.useCallback)((()=>{r(void 0),n()}),[r,n]);return l.createElement(S.Z,h,a()(y.D,{},void 0,a()(m.Pq,{index:0,level:0,combinatorFilter:o||c.hh,schema:u,onChange:f,collectionViewType:"table",collectionViewId:"test",parentStore:t.context.parentRecordStore})),a()(v.Z,{topBorder:!0},void 0,a()(g.Z,{title:a()(d.FormattedMessage,{defaultMessage:"Delete filter",id:"automations.AutomationCombinatorFilterPopup.deleteFilter.label"}),onClick:C})))}},38752:(e,t,o)=>{o.d(t,{S:()=>S,d:()=>v});var r=o(10434),n=o.n(r),i=o(23174),a=o.n(i),l=o(67294),s=o(480),c=o(24405),d=o(42853),p=o(54497),u=o(82990),m=o(24677),g=o(98104),h=o(89728),y=o(26388);const S=l.forwardRef(((e,t)=>{window.__c={n:"AutomationDropdownButton"};const{variant:o,onClick:r,style:i,icon:S,children:v,disabled:f}=e,C=(0,s.O7)(),b=(0,c.yK)((e=>({button:{..."gray"===o&&{color:e.mediumTextColor},..."blue"===o&&{color:e.blueColor,fontWeight:500},..."error"===o&&{color:e.errorText},maxWidth:"calc(100% + 2px)",marginLeft:1,padding:"0 8px 0 5px",...i},warningIcon:{width:12,height:12,marginLeft:-6,marginLeft:6,fill:e.errorText,color:e.errorText},chevronIcon:{width:10,height:10,marginLeft:4,marginTop:2,fill:e.lightIconColor},spacer:{flexGrow:1}})),[o,i]),w=(0,l.useCallback)((e=>{g.ZH(C),m.ZH(C),null==r||r(e)}),[r,C]);return a()(y.Z,{renderTooltip:()=>"error"===o?e.errorMessage:null,placement:y.Z.Placement.Bottom,disableTooltip:"error"!==o,delayThreshold:0,render:e=>l.createElement(h.Z,n()({},e,{style:b.button,icon:S,onClick:w,ref:t,shouldShrink:!0,disabled:f,disabledFeedback:f}),a()("div",{style:{...u.Z.textOverflowStyle}},void 0,v),a()("div",{style:b.spacer}),"error"===o&&(0,p.t)(b.warningIcon),(0,d.i)(b.chevronIcon))})}));function v(e){const{errorMessage:t,hasValue:o}=e;return(0,l.useMemo)((()=>t?{variant:"error",errorMessage:t}:o?{variant:"gray"}:{variant:"blue"}),[t,o])}},29758:(e,t,o)=>{o.d(t,{H:()=>W,L:()=>H});var r=o(23174),n=o.n(r),i=o(10434),a=o.n(i),l=(o(57658),o(21703),o(67294)),s=o(480),c=o(86628),d=o(24405),p=o(84619),u=o(23790),m=o(84116),g=o(78106),h=o(58573),y=o(59054),S=o(56666),v=o(72126),f=o(5366),C=o(4615),b=o(21202),w=o(6287),k=o(97880),M=o(8406),x=o(31299),T=o(87279),P=o(98742),V=o(24457),_=o(29798),F=o(57559),Z=o(73657),B=o(71846),A=o(52275),E=o(68894),R=o(78140),I=o(32163),L=o(11470),D=o(72495),K=o(26388),O=o(21396),N=o(78948);const z=(0,f.defineMessages)({searchInputPlaceholder:{defaultMessage:"Select blocks to editâ€¦",id:"automations.AutomationTargetPickerMenu.search.placeholder"}});function H(e){window.__c={n:"AutomationTargetPickerMenu"};const t=(0,s.O7)(),o=(0,V.F)({maxWidth:360,paddingTop:12,width:280}),r=(0,l.useMemo)((()=>(0,C.ZP)()),[]),n=(0,l.useCallback)((()=>{M.tW({environment:t,eventName:"abandoned_search",sessionId:r,source:B.S.Automation})}),[t,r]);return o.menuType===T.og.Popup&&(o.onClickOutside=n),l.createElement(R.Z,o,l.createElement(W,a()({},e,{searchSessionId:r})))}function W(e){window.__c={n:"AutomationTargetPickerMenuChildren"};const{actionId:t,automationContextStore:o,onChange:r,onClose:i,selectedTarget:d,skipCollections:S,skipPages:C,skipVariables:T,searchSessionId:V}=e,E=(0,s.O7)(),R=(0,c.qz)(void 0,_.Z),z=(0,c.VK)((()=>{const{context:e}=o;if("button_property"===e.type)return e.collectionContextStore.collectionViewBlockStore()}),[o]),H=(0,c.VK)((()=>{if(T)return[];const e=(0,k.$K)(t)?o.getContextValuesForAction(t):o.getAllContextValues();if(e){return Object.values(e).filter((e=>{if(!(0,u.uy)(e.type,{type:"block"}))return!1;if("event"===o.context.type&&e.kind===m.yp.ContextValue){const t=(0,g.MY)(e.id);return!("global"===t.source&&"button_page"===t.global)}return!0}))}return[]}),[T,o,t],{useDeepEqual:!0}),W=(0,l.useMemo)((()=>o.context.parentRecordStore),[o.context]),U=(0,c.VK)((()=>W.getSpaceId()),[W]),[Y,$]=(0,l.useReducer)(q,{automationVariables:[],collectionQueryLimit:5,pageQueryLimit:5,searchTerm:""});(0,l.useEffect)((()=>{if(Y.searchTerm){const e=(0,h.ZP)(Y.searchTerm,H,(e=>e.kind===m.yp.ContextValue?e.name:""));$({type:"set_variables",variables:e})}else $({type:"set_variables",variables:H})}),[Y.searchTerm,H]);const J=function(e){const{collectionViewBlockStore:t,limit:o,parentStore:r,searchTerm:n,skip:i}=e,a=(0,s.O7)(),[c,d]=(0,l.useReducer)(j,{error:void 0,isLoading:Boolean(i),results:void 0,total:void 0}),[p]=(0,y.r5)((async()=>{if(i)return;const e=await x.RT({collectionViewBlockStore:t,environment:a,limit:o,parentStore:r,query:n,requireEditPermissions:!0});return{results:e.results,total:e.total}}),[t,a,o,r,n,i],{debounce:x.vp});return(0,l.useEffect)((()=>{if("pending"===p.status||"idle"===p.status)d({type:"query_loadstart"});else if("resolved"===p.status){var e,t;d({results:null===(e=p.value)||void 0===e?void 0:e.results,total:null===(t=p.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===p.status?d({error:p.error,type:"query_error"}):(0,k.t1)(p)}),[p]),c}({collectionViewBlockStore:z,limit:Y.collectionQueryLimit,parentStore:W,searchTerm:Y.searchTerm,skip:S}),X=function(e){const{limit:t,searchTerm:o,skip:r,spaceId:n}=e,i=(0,s.O7)(),[a,c]=(0,l.useReducer)(j,{error:void 0,isLoading:Boolean(r),results:void 0,total:void 0}),[d]=(0,y.r5)((async()=>{if(r||!n)return;const e=await x.D7({boostRecentlyViewedPages:!0,environment:i,excludeTemplates:!0,limit:t,query:o,requireEditPermissions:!1,source:"automation_page_picker",spaceId:n});return{results:e.results.map((e=>e.id)),total:e.total}}),[i,t,o,r,n],{debounce:x.vp});return(0,l.useEffect)((()=>{if("pending"===d.status||"idle"===d.status)c({type:"query_loadstart"});else if("resolved"===d.status){var e,t;c({results:null===(e=d.value)||void 0===e?void 0:e.results,total:null===(t=d.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===d.status?c({error:d.error,type:"query_error"}):(0,k.t1)(d)}),[d]),a}({limit:Y.pageQueryLimit,searchTerm:Y.searchTerm,skip:C,spaceId:U}),ee=(0,l.useCallback)((e=>{"collection"===e.type&&M.tW({environment:E,eventName:"select_search_item",queryLength:Y.searchTerm.length,sessionId:V,source:B.S.Automation,totalResults:J.total}),d&&!v.Xy(d,e)?r(e):d?i():r(e)}),[E,V,Y.searchTerm,J.total,d,r,i]),te=(0,l.useCallback)((e=>{const t=e.target.value;$({searchTerm:t,type:"set_search_term"}),R.setState({focus:{section:0,indexLocal:0,indexGlobal:0}})}),[R]),oe=(0,l.useCallback)((()=>{$({queryLimit:Y.collectionQueryLimit+20,type:"set_collection_query_limit"})}),[Y.collectionQueryLimit]),re=(0,l.useCallback)((()=>{$({queryLimit:Y.pageQueryLimit+20,type:"set_page_query_limit"})}),[Y.pageQueryLimit]),ne="variable"===(null==d?void 0:d.type)?d.id:void 0,ie="collection"===(null==d?void 0:d.type)?d.collection.id:void 0,ae="page"===(null==d?void 0:d.type)?d.page.id:void 0,le=[],se=function(e){const{automationVariables:t,onClick:o,selectedVariableId:r}=e,i=t.map((e=>{if(e.kind!==m.yp.ContextValue)throw new Error("Not implemented yet.");return{action:()=>o({id:e.id,type:"variable"}),key:e.id,render:t=>n()(K.Z,{placement:K.Z.Placement.Right,render:o=>l.createElement(A.Z,a()({},(0,P.Z)(o,t),{checkState:e.id===r,title:n()("div",{style:{display:"flex"}},void 0,n()(O.F,{value:e,format:p.l.Medium,isSingle:!0,shouldShrink:!0}))})),renderTooltip:()=>e.name,textWrap:!0})}}));if(0===i.length)return;return{key:"variable_results",items:i,render:e=>l.createElement(D.Z,a()({},e,{title:n()(f.FormattedMessage,{defaultMessage:"From this automation",id:"automations.AutomationTargetPickerMenu.variablesSection.title"})}))}}({automationVariables:Y.automationVariables,onClick:ee,selectedVariableId:ne});se&&le.push(se);const ce=function(e){const{collectionQueryResult:t,onCollectionMenuItemClick:o,onShowMoreItemClick:r,parentRecordStore:i,selectedCollectionId:s}=e;if(t.isLoading)return;let c=[];if(t.error)c.push({action:r,key:"show_more_collection_results",render:e=>l.createElement(Z.Z,a()({},e,{caption:n()(f.FormattedMessage,{defaultMessage:"Sorry, something went wrong while searching for databases.",id:"automations.AutomationTargetPickerMenu.errorCollections.label"}),shouldWrapCaption:!0}))});else{const e=t.results??[],n=e.length;c=e.map((e=>{const t=F.NW.createChildStore(i,{table:w.v,id:e});return{action:()=>o({collection:t.getSpaceShardedPointer(),type:"collection"}),key:e,render:o=>l.createElement(L.Z,a()({},o,{checkState:e===s,store:t}))}}));const d=t.total??0,p=Math.max(0,d-n);p>0&&c.push({action:r,key:"show_more_collection_results",render:e=>l.createElement(G,a()({},e,{showMoreCount:p}))})}if(0===c.length)return;return{key:"collection_results",items:c,render:e=>l.createElement(D.Z,a()({},e,{title:n()(f.FormattedMessage,{defaultMessage:"Databases",id:"automations.AutomationTargetPickerMenu.collectionsSection.title"})}))}}({collectionQueryResult:J,onCollectionMenuItemClick:ee,onShowMoreItemClick:oe,parentRecordStore:W,selectedCollectionId:ie});ce&&le.push(ce);const de=function(e){const{pageQueryResult:t,onPageMenuItemClick:o,onShowMoreItemClick:r,parentRecordStore:i,selectedPageId:s}=e;if(t.isLoading)return;let c=[];if(t.error)c.push({action:r,key:"show_more_collection_results",render:e=>l.createElement(Z.Z,a()({},e,{caption:n()(f.FormattedMessage,{defaultMessage:"Sorry, something went wrong while searching for pages.",id:"automations.AutomationTargetPickerMenu.errorPages.label"}),shouldWrapCaption:!0}))});else{const e=t.results??[],n=e.length;c=e.map((e=>{const t=F.G.createChildStore(i,{table:b.iU,id:e});return{key:e,render:o=>l.createElement(L.Z,a()({},o,{checkState:e===s,store:t})),action:()=>o({page:t.getSpaceShardedPointer(),type:"page"})}}));const d=t.total??0,p=Math.max(0,d-n);p>0&&c.push({action:r,key:"show_more_page_results",render:e=>l.createElement(G,a()({},e,{showMoreCount:p}))})}if(0===c.length)return;return{key:"page_results",items:c,render:e=>l.createElement(D.Z,a()({},e,{title:n()(f.FormattedMessage,{defaultMessage:"Pages",id:"automations.AutomationTargetPickerMenu.pagesSection.title"})}))}}({onPageMenuItemClick:ee,onShowMoreItemClick:re,pageQueryResult:X,parentRecordStore:W,selectedPageId:ae});de&&le.push(de);const pe=J.isLoading||X.isLoading;return l.createElement(l.Fragment,null,n()(Q,{onChange:te,value:Y.searchTerm}),pe?n()(D.Z,{},void 0,n()(N.Z,{})):!pe&&le.length>0?n()(I.Z,{initialFocus:0,sections:le,store:R,type:I.i.Vertical}):n()(Z.Z,{caption:n()(f.FormattedMessage,{defaultMessage:"No results",id:"automations.AutomationTargetPickerMenu.noResults.label"})}))}function Q(e){window.__c={n:"SearchInputSection"};const{onChange:t,value:o}=e,{isMobile:r}=(0,s.Fy)(),i=(0,f.useIntl)(),a=(0,d.yK)((()=>({section:{paddingBlockStart:0}})),[]);return n()(D.Z,{style:a.section},void 0,n()(E.ZP,{focusInitial:!r||void 0,onChange:t,placeholder:i.formatMessage(z.searchInputPlaceholder),showClearButton:!0,value:o??""}))}const G=(0,l.forwardRef)((function(e,t){window.__c={n:"ShowMoreButtonMenuItem"};const{showMoreCount:o}=e,r=(0,d.yK)((e=>({showMoreButton:{color:e.mediumTextColor,fill:e.mediumIconColor}})),[]);return l.createElement(A.Z,a()({},e,{icon:(0,S.o)({width:16,height:16}),ref:t,style:r.showMoreButton,title:n()(f.FormattedMessage,{defaultMessage:"Show {showMore} more",id:"automations.AutomationTargetPickerMenu.showMore.label",values:{showMore:Math.min(o,20)}})}))}));function q(e,t){if("set_variables"===t.type)return{...e,automationVariables:t.variables.slice(0)};if("set_search_term"===t.type){const o=t.searchTerm?20:5;return{...e,collectionQueryLimit:o,pageQueryLimit:o,searchTerm:t.searchTerm}}if("set_collection_query_limit"===t.type){if(e.collectionQueryLimit!==t.queryLimit)return{...e,collectionQueryLimit:t.queryLimit}}else if("set_page_query_limit"===t.type){if(e.pageQueryLimit!==t.queryLimit)return{...e,pageQueryLimit:t.queryLimit}}else(0,k.t1)(t);return e}function j(e,t){if("query_loadstart"===t.type){if(!e.isLoading)return{...e,isLoading:!0}}else{if("query_finish"===t.type)return{...e,error:void 0,isLoading:!1,results:t.results,total:t.total};if("query_error"===t.type)return{...e,error:t.error,isLoading:!1,results:void 0,total:void 0};(0,k.t1)(t)}return e}},21943:(e,t,o)=>{o.d(t,{Z:()=>u});var r=o(23174),n=o.n(r),i=(o(67294),o(480)),a=o(24405),l=o(84619),s=o(54497),c=o(5366),d=o(56812),p=o(85567);function u(e){let{key:t,tokenFormat:o=l.l.Medium,isSingle:r,showRemoveButton:u,onClickRemove:m}=e;window.__c={n:"DeletedOptionToken"};const{isMobile:g}=(0,i.Fy)(),h=(0,c.useIntl)(),y=(0,a.yK)((e=>{const t="light"===e.mode?400:800,o="light"===e.mode?50:200,r="light"===e.mode?700:900;return{tokenValueWrap:{display:"inline-flex",gap:"4px",alignItems:"baseline"},warning:{color:e.accentColors.orange[t],height:"auto",width:g?16:14},warningWrap:{alignSelf:"center"},token:{backgroundColor:e.accentColors.yellow[o]},textWrap:{color:e.accentColors.yellow[r]}}}),[g]);return n()(p.Z,{format:o,isSingle:r??!0,showRemoveButton:u??!1,onClickRemove:m,style:y.token,value:n()("span",{style:y.tokenValueWrap},void 0,n()("span",{style:y.warningWrap},void 0,(0,s.t)(y.warning)),n()("span",{style:y.textWrap},void 0,(0,d.ST)(h)))},t)}},72865:(e,t,o)=>{o.d(t,{D:()=>y});var r=o(23174),n=o.n(r),i=o(10434),a=o.n(i),l=o(67294),s=o(480),c=o(24405),d=o(97444),p=o(39699),u=o(43250),m=o(17809),g=o(24666),h=o(65187);function y(e){window.__c={n:"SimpleFormulaValueTextInput"};const{value:t,disabled:o,onChange:r,multiline:i,placeholder:y,disableFormattingAndMentions:S,disableMobileActionBar:v,disableEmojiCommands:f,disableTemplateVariableMentions:C}=e,b=(0,s.O7)(),w=(0,c.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:i?"6px 10px":"4px 8px",overflow:"hidden",..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:i?{minHeight:60}:{whiteSpace:"pre"},placeholder:i?{minHeight:60}:{}})),[i]),k=(0,l.useCallback)((e=>{r({type:"simple",value:e})}),[r]),{store:M}=(0,m.useMockTextStore)({initialValue:null==t?void 0:t.value,onChange:k}),x=(0,l.useMemo)((()=>i?()=>{const e=g.default.state;"editing"===e.mode&&p.createAndCommit({userAction:"SimpleFormulaValueTextInput.handleEnter",environment:b,perform:t=>{d.hJ({environment:b,string:"\n",multiSelection:e.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}})}:void 0),[b,i]);return n()("div",{style:w.wrap,className:u.Wh_},void 0,l.createElement(h.Z,a()({placeholder:y,disabled:o,store:M,style:w.text,placeholderStyle:w.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:f,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:x,disableMobileActionBar:v,disableTemplateVariableMentions:C},S?{disableDateMentions:!0,disableDateReminderMentions:!0,disableMentions:!0,disableStyleAnnotations:!0}:{})))}},53498:(e,t,o)=>{o.d(t,{a:()=>xe,K:()=>V});var r=o(10434),n=o.n(r),i=o(23174),a=o.n(i),l=o(67294),s=o(480),c=o(86628),d=o(66897),p=o(99036),u=o(80951),m=o(84619),g=o(78106),h=o(76218),y=o(68626),S=o(19889),v=o(70203),f=o(97880),C=o(21943),b=o(60458),w=o(92864),k=o(89845),M=o(10009),x=o(22084),T=o(21396),P=o(75311);function V(e){window.__c={n:"ValuePickerMenuToken"};const{token:t,contextStore:o,disabled:r,setCurrentTokens:i,currentSimpleFormulaValueTokens:V,context:_}=e,F=(0,s.Fy)(),Z=(0,c.Kw)(o.compilationResultStore),B=(0,c.VK)((()=>{if((0,h.S3)(t)&&(0,v.IWo)(t)){const e=(0,v.zEN)(t);if(e)return(0,d.Hl)({pointer:{table:S.KJ,id:e},getRecordValue:o.context.parentRecordStore.getRecordValue})}}),[o.context.parentRecordStore,t]),A=(0,c.VK)((()=>(0,P._)(_)),[_]),E=(0,c.VK)((()=>_.collectionStore.getSchema()[_.property]),[_]);if("string"==typeof t){if(!E||!(0,p.t)(E))return null;const e=(0,u.i7)((null==E?void 0:E.options)??[],t);if(!e)return a()(C.Z,{isSingle:!1,showRemoveButton:!r,onClickRemove:()=>{null==i||i((0,h.Ck)(V,t))}},`deleted_option_value_${t}`);const o={value:e.value,color:e.color,isSingle:!1,showRemoveButton:!r,format:F.isMobile?m.l.Medium:m.l.Small,onClickRemove:()=>{null==i||i((0,h.Ck)(V,t))}};if((0,p.gB)(E)){var R;const t=null===(R=E.groups)||void 0===R||null===(R=R.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})))||void 0===R?void 0:R.color;return l.createElement(x.F,n()({},o,{groupColor:t}))}return l.createElement(x.a,o)}if("boolean"==typeof t)return a()(b.Z,{checked:t,disabled:!0,size:16,checkSize:12,style:{marginBottom:6}},t.toString());if((0,v.IWo)(t))return null!=B&&B.asActor?a()(w.ZP,{actor:B,format:F.isMobile?w.ZP.Format.Medium:w.ZP.Format.Small,showRemoveButton:!r,onClickRemove:()=>{null==i||i((0,h.Ck)(V,t))},shouldShrink:!0,isSingle:!1},B.id):null;if((0,v.wjk)(t)){const e=(0,v.vmO)(t).id,o=y.x.isSuccess(Z)?(0,g.vx)(Z.value.valueTypes,e):void 0;return o?a()(T.F,{value:o,format:m.l.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!r,onClickRemove:()=>{null==i||i((0,h.Ck)(V,t))}}):null}if((0,v.fpG)(t)){const e=V[0],t=e&&(0,h.S3)(e)&&(0,v.fpG)(e)?(0,v.zyO)(e):void 0;return t?a()(k.Z,{value:t,dateFormat:A.dateFormat,timeFormat:A.timeFormat,style:{marginBottom:6}}):null}if((0,v.STW)(t)){const e=(0,v.TOT)(t);return e?a()(M.Z,{format:F.isMobile?m.l.Medium:m.l.Small,blockId:e,shouldWrap:!1,shouldShrink:!0,isSingle:!1,parentStore:o.context.parentRecordStore,showRemoveButton:!r,onClickRemove:()=>{null==i||i((0,h.Ck)(V,t))}},e):null}(0,f.t1)(t)}o(57658);var _=o(23790),F=o(84116),Z=o(58573),B=o(59054),A=o(72126),E=o(5366),R=o(31299),I=o(17809),L=o(87279),D=o(29798),K=o(78140),O=o(32163),N=o(43765),z=o(40721),H=o(72495),W=o(78948),Q=o(47082),G=o(30387),q=o(32426),j=o(24405),U=o(5257),Y=o(52275);function $(e){window.__c={n:"IconMenuItem"};const t=(0,j.yK)((e=>({icon:{width:14,fill:e.mediumIconColor},chevronRight:{width:12,fill:e.mediumIconColor}})),[]);return a()(Y.Z,{icon:e.icon(t.icon),title:e.title,focused:!1,right:(0,U.o)(t.chevronRight),onClick:e.onClick})}function J(e){window.__c={n:"CustomFormulaItem"};const{value:t,onChange:o}=e,r=(0,l.useCallback)((()=>{o({type:"formula",value:null==t?void 0:t.value})}),[t,o]);return a()($,{icon:q.D,title:l.createElement(E.FormattedMessage,G.s.customFormula),onClick:r})}o(21703);var X=o(21202),ee=o(57559),te=o(11470),oe=o(26388);function re(e){window.__c={n:"ValuePickerMenuItem"};const{token:t,contextStore:o,args:r,checkState:i,checkType:C,context:k,onCheckboxClick:M}=e,P=(0,s.Fy)(),V=(0,c.VK)((()=>o.context.parentRecordStore.getSpaceId()),[o.context.parentRecordStore]),_=(0,c.VK)((()=>{if((0,h.S3)(t)&&(0,v.IWo)(t)){const e=(0,v.zEN)(t);if(e)return(0,d.Hl)({pointer:{table:S.KJ,id:e},getRecordValue:o.context.parentRecordStore.getRecordValue})}}),[o.context.parentRecordStore,t]),F=(0,c.VK)((()=>k.collectionStore.getSchema()[k.property]),[k]),Z=(0,c.VK)((()=>F&&(0,p.t)(F)?F.options??[]:[]),[F]),B=(0,c.VK)((()=>F&&(0,p.gB)(F)?F.groups??[]:[]),[F]),A=(0,c.Kw)(o.compilationResultStore),E=Boolean(F&&(0,p.gB)(F)),R="single"===C?{checkState:i}:{icon:a()(b.Z,{checked:i,size:14,onClick:M})};if("string"==typeof t){if(E){const e=(0,u.i7)(Z,t),o=B.find((t=>{var o;return e&&(null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id))}));return e?l.createElement(Y.Z,n()({},r,R,{title:a()(x.F,{format:P.isMobile?m.l.Large:m.l.Small,isSingle:!0,value:e.value,color:e.color,groupColor:null==o?void 0:o.color,shouldShrink:!0,showRemoveButton:!1},t),isTokenTitle:!0},r)):null}{const e=(0,u.i7)(Z,t);return e?l.createElement(Y.Z,n()({},r,R,{title:a()(x.a,{value:e.value,color:e.color,showRemoveButton:!1,isSingle:!0,shouldShrink:!0,format:P.isMobile?m.l.Large:m.l.Small}),isTokenTitle:!0},r)):null}}if("boolean"==typeof t)return null;if((0,v.IWo)(t))return null!=_&&_.asActor&&_.table===S.KJ?l.createElement(Y.Z,n()({},r,R,{title:a()(w.vw,{isSingle:!0,shouldShrink:!0,format:P.isMobile?w.vw.Format.Large:w.vw.Format.Medium,userValue:_.asActor}),isTokenTitle:!0})):null;if((0,v.wjk)(t)){const e=(0,v.vmO)(t).id,o=y.x.isSuccess(A)?(0,g.vx)(A.value.valueTypes,e):void 0;return o?l.createElement(Y.Z,n()({},R,{title:a()(oe.Z,{renderTooltip:()=>(0,T.e)(o),placement:oe.Z.Placement.Right,render:e=>l.createElement("div",n()({style:{display:"flex"}},e),a()(T.F,{value:o,format:m.l.Medium,isSingle:!0,shouldShrink:!0}))})},r)):null}if((0,v.fpG)(t))return null;if((0,v.STW)(t)){const e=(0,v.TOT)(t);if(!e)return null;if(!V)return null;const a=ee.G.createChildStore(o.context.parentRecordStore,{table:X.iU,id:e,spaceId:V});return l.createElement(te.Z,n()({store:a,checkState:i,hidePath:!0},r))}(0,f.t1)(t)}function ne(e){const{currentSimpleFormulaValueTokens:t,value:o,contextStore:r,setCurrentTokens:n,action:i,context:l,checkType:s,onCheckboxClick:c}=e;if(o.kind!==F.yp.ContextValue)throw new Error("Not implemented yet.");const d=Boolean(t.find((e=>(0,h.S3)(e)&&(0,v.wjk)(e)&&(0,v.vmO)(e).id===o.id))),p=(0,v._QF)({id:o.id}),u=()=>{n("append"===i?d?(0,h.Ck)(t,p):[...t,p]:[p]),null==c||c()};return{key:o.id,render:e=>a()(re,{token:p,contextStore:r,args:e,checkState:d,checkType:s,context:l,onCheckboxClick:u}),action:u}}function ie(e){var t,o;window.__c={n:"ValuePickerMenuBlockArray"};const{currentSimpleFormulaValueTokens:r,menuProps:i,onClose:d,onChange:u,contextStore:m,formulaTypecheckContextValues:g,context:y,showClearButton:S,showInputMenuItem:f,type:C}=e,b=(0,s.Fy)(),w=(0,E.useIntl)(),k=(0,s.O7)(),[M,x]=(0,l.useState)(""),T=(0,c.qz)(void 0,D.Z),{collectionStore:q,property:j}=y,U=(0,P.M)(q,j),Y=U(r,"first"),$=(0,c.VK)((()=>q.getSchema()[y.property]),[q,y.property]),X=(0,c.VK)((()=>!(!$||!(0,p.en)($))&&1===$.limit),[$]),ee=(0,l.useMemo)((()=>{const e="relation"===(null==$?void 0:$.type)?(0,p.j0)($):void 0;return g.filter((t=>(0,_.uy)(t.type,{type:"block",collection:e},!0)))}),[g,$]),[te]=(0,B.r5)((async()=>{const e=M?(0,Z.ZP)(M,ee,(e=>e.kind===F.yp.ContextValue?e.name:"")):ee,{results:t}=await R.df({environment:k,query:M,collectionId:C.collection.id,limit:20,spaceId:C.collection.spaceId,excludeTemplates:!0,source:"simple_formula_value_page_search",includePublicPagesWithoutExplicitAccess:!1,boostRecentlyViewedPages:!1});return{valueResults:e,pageResults:t}}),[k,M,ee,C],{debounce:R.vp}),oe=(0,l.useCallback)((()=>{x(""),T.setState({...T.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[T]),ie=(0,l.useCallback)((e=>{const t=U(e,"last");u({type:"simple",value:(0,h.iC)(t)}),oe(),X&&d()}),[U,u,oe,X,d]),ae=(0,c.VK)((()=>(0,I.formulaButtonsEnabled)()),[]),le=A.oA(Y.map(((e,t)=>a()(V,{token:e,contextStore:m,disabled:!1,currentSimpleFormulaValueTokens:Y,setCurrentTokens:ie,context:y},t)))),se=a()(Q.Z,{focus:!b.isMobile||void 0,focusAfterAnimation:!0,format:Q.Z.Format.FilterValue,tokens:le,placeholder:w.formatMessage(G.s.pageSearchPlaceholder),onRemoveLastToken:()=>{ie(Y.slice(0,Y.length-1))},onClearButtonClick:()=>{ie([])},value:M,onChange:e=>{x(e.target.value)},dontShowBorderBottom:b.isAndroid,showClearButton:S}),ce=void 0!==(null==i?void 0:i.header)?i.header:a()(H.Z,{style:{paddingBottom:0},title:w.formatMessage(G.s.genericMenuHeader)});let de;de=b.isMobile?{menuType:L.og.Modal,right:a()(z.DoneMenuText,{}),onClickRight:d}:{menuType:L.og.Popup,maxHeight:"50vh",width:260,paddingTop:0,footer:ae&&a()(H.Z,{topBorder:!0},void 0,l.createElement(J,e)),disableHeaderBorder:!0};const pe={...de,...i,header:b.isMobile?null:ce},ue=X?"single":"multi",me=[],ge=[...A.oA(((null===(t=te.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>ne({currentSimpleFormulaValueTokens:Y,value:e,setCurrentTokens:ie,contextStore:m,action:"append",context:y,checkType:ue})))),...A.oA(((null===(o=te.value)||void 0===o?void 0:o.pageResults)||[]).map((e=>{const t=Boolean(Y.find((t=>(0,h.S3)(t)&&(0,v.STW)(t)&&(0,v.TOT)(t)===e))),o=(0,v.$0A)(e,C.collection.spaceId),r=()=>{ie(t?(0,h.Ck)(Y,o):[...Y,o])};return{key:e,render:e=>a()(re,{token:o,contextStore:m,args:e,checkState:t,checkType:ue,context:y,onCheckboxClick:r}),action:r}})))];if(f){const e=Boolean(ce);me.push({key:"search-input",render:t=>l.createElement(H.Z,n()({},t,{style:{...e&&{paddingTop:0}}})),items:[{action:()=>{},key:"input",render:()=>se}]})}if(ge.length>0){const e=Boolean(ce)||f;me.push({key:"values",render:t=>l.createElement(H.Z,n()({topBorder:e},t)),items:ge})}return l.createElement(K.Z,pe,te.error&&a()(H.Z,{},void 0,a()(N.Z,{title:l.createElement(E.FormattedMessage,G.s.somethingWentWrong)})),0===me.length&&te.value&&a()(H.Z,{},void 0,a()(N.Z,{title:l.createElement(E.FormattedMessage,G.s.noResults)})),!te.value&&!te.error&&a()(H.Z,{},void 0,a()(W.Z,{})),me.length>0&&a()(O.Z,{type:O.i.Vertical,initialFocus:0,sections:me,store:T}))}function ae(e){window.__c={n:"ValuePickerMenuCheckbox"};const{context:t,contextStore:o,currentSimpleFormulaValueTokens:r,formulaTypecheckContextValues:i,menuProps:d,onChange:p,onClose:u}=e,m=(0,E.useIntl)(),g=(0,s.Fy)(),y=i.filter((e=>"checkbox"===e.type.type)),S=(0,l.useCallback)((e=>{p({type:"simple",value:void 0!==e[0]?(0,h.YD)(e[0]):void 0})}),[p]),v=(0,l.useCallback)((e=>{S(e),u()}),[S,u]),f=(0,c.VK)((()=>(0,I.formulaButtonsEnabled)()),[]),C=A.oA(y.map((e=>ne({currentSimpleFormulaValueTokens:r,value:e,setCurrentTokens:v,contextStore:o,action:"replace",context:t,checkType:"single"})))),b=[],w=r.some((e=>!0===e)),k=[...C,...[{key:0,render:e=>l.createElement(Y.Z,n()({title:l.createElement(E.FormattedMessage,G.s.unchecked),checkState:!w},e)),action:()=>{v([!1])}},{key:1,render:e=>l.createElement(Y.Z,n()({title:l.createElement(E.FormattedMessage,G.s.checked),checkState:w},e)),action:()=>{v([!0])}}]],M=void 0!==(null==d?void 0:d.header)?d.header:a()(H.Z,{style:{paddingBottom:0},title:m.formatMessage(G.s.genericMenuHeader)}),x=Boolean(M);let T;b.push({key:"checkbox",render:e=>l.createElement(H.Z,n()({},e,{topBorder:x})),items:k}),T=g.isMobile?{menuType:L.og.Modal,right:a()(z.DoneMenuText,{}),onClickRight:u}:{header:M,menuType:L.og.Popup,maxHeight:"50vh",width:260,footer:f&&a()(H.Z,{topBorder:!0},void 0,l.createElement(J,e)),disableHeaderBorder:!0};const P={...T,...d,header:g.isMobile?null:M};return l.createElement(K.Z,P,a()(O.Z,{type:O.i.Vertical,initialFocus:0,sections:b}))}var le=o(53016),se=o(40506),ce=o(12392),de=o(28020),pe=o(77907),ue=o(73063),me=o(89728);function ge(e){window.__c={n:"ValueDatePicker"};const{currentSimpleFormulaValueTokens:t,disabled:o,setInDatePicker:r,onClose:n,setCurrentTokens:i,context:s}=e,d=t[0],p=d&&(0,h.S3)(d)&&v.fpG(d)?v.zyO(d):void 0,u=(0,E.useIntl)(),m=(0,c.Kw)(de.AK),g=(0,l.useCallback)((()=>{r(!1)}),[r]),y=(0,l.useCallback)((e=>{e&&(0,se.U3)(e)?i([v.pZr(e)]):i([])}),[i]),S=(0,j.yK)((e=>({header:{display:"flex",alignItems:"center",fontSize:12,paddingInline:14,color:e.mediumTextColor,marginTop:8,fontWeight:500},iconWrap:{width:18,height:18,marginRight:4},icon:{width:12,height:12},title:{flex:"1 1 auto"}})),[]),f=(0,c.VK)((()=>(0,P._)(s)),[s]);return a()(pe.DependencyConsumer,{dependency:pe.deps.menus},void 0,(e=>{let{DatePropertyMenu:t}=e;return a()(t,{firstDayOfWeek:m,value:p,canConfigureCollection:!1,onChangeValue:y,dateFormat:f.dateFormat,timeFormat:f.timeFormat,onDismiss:n,disabled:o,shouldShowReminder:!1,header:a()("div",{style:S.header},void 0,a()(ue.Z,{ariaLabel:u.formatMessage(G.s.back),icon:ce.S,onClick:g,style:S.iconWrap,iconStyle:S.icon}),a()("span",{style:S.title},void 0,l.createElement(E.FormattedMessage,G.s.pickADate)),a()(me.Z,{onClick:n,isBlue:!0},void 0,a()(z.DoneMenuText,{}))),isTemplatePage:!1})}))}function he(e){window.__c={n:"ValuePickerMenuDate"};const{currentSimpleFormulaValueTokens:t,onClose:o,onChange:r,contextStore:i,formulaTypecheckContextValues:d,context:p,menuProps:u}=e,m=(0,E.useIntl)(),g=(0,s.Fy)(),[y,S]=(0,l.useState)(!1),v=d.filter((e=>"date"===e.type.type)),f=(0,l.useCallback)((e=>{r({type:"simple",value:void 0!==e[0]?(0,h.YD)(e[0]):void 0})}),[r]),C=(0,l.useCallback)((e=>{f(e),o()}),[f,o]),b=(0,l.useCallback)((()=>{S(!0)}),[]),w=(0,l.useCallback)((()=>{f([]),o()}),[f,o]),k=(0,c.VK)((()=>(0,I.formulaButtonsEnabled)()),[]);if(y)return l.createElement(ge,n()({},e,{setInDatePicker:S,setCurrentTokens:f,currentSimpleFormulaValueTokens:t}));const M=void 0!==(null==u?void 0:u.header)?u.header:a()(H.Z,{style:{paddingBottom:0},title:m.formatMessage(G.s.genericMenuHeader)}),x=A.oA(v.map((e=>ne({currentSimpleFormulaValueTokens:t,value:e,setCurrentTokens:C,contextStore:i,action:"replace",context:p,checkType:"single"})))),T=[];if(x.length>0){const e=Boolean(M);T.push({key:"values",render:t=>l.createElement(H.Z,n()({topBorder:e},t)),items:x})}const P=l.createElement(l.Fragment,null,a()(H.Z,{topBorder:!0},void 0,a()($,{icon:le.V,title:l.createElement(E.FormattedMessage,G.s.pickADate),onClick:b}),k&&l.createElement(J,e)),t.length>0&&a()(H.Z,{topBorder:!0},void 0,a()(Y.Z,{title:l.createElement(E.FormattedMessage,G.s.clear),focused:!1,onClick:w})));let V;V=g.isMobile?{menuType:L.og.Modal,right:a()(z.DoneMenuText,{}),onClickRight:o,footer:P}:{menuType:L.og.Popup,maxHeight:"50vh",width:260,footer:P,disableHeaderBorder:!0};const _={...V,...u,header:g.isMobile?null:M};return l.createElement(K.Z,_,a()(O.Z,{type:O.i.Vertical,initialFocus:0,sections:T}))}var ye=o(68894);function Se(e){window.__c={n:"ValuePickerMenuNumber"};const{context:t,contextStore:o,currentSimpleFormulaValueTokens:r,formulaTypecheckContextValues:i,menuProps:d,onChange:p,onClose:u,value:m}=e,g=(0,E.useIntl)(),y=(0,s.Fy)(),S=i.filter((e=>"number"===e.type.type)),f=(0,l.useCallback)((e=>{p({type:"simple",value:e})}),[p]),C=(0,l.useCallback)((e=>{f(e),u()}),[f,u]),b=(0,l.useCallback)((e=>{const t=e.target.value;let o;o=""===t?void 0:[[t]],f(o)}),[f]),w=(0,l.useCallback)((e=>{const t=A.U2(e,"event.target.value");let o;o="string"==typeof t&&""!==t?[[t]]:void 0,C(o)}),[C]),k=(0,l.useCallback)((e=>{const t=void 0!==e[0]?(0,h.YD)(e[0]):void 0;C(t)}),[C]),M=(0,c.VK)((()=>(0,I.formulaButtonsEnabled)()),[]),x=[],T=[...[{action:w,key:"input",render:e=>{const t=r[0],o="string"==typeof t?t:(0,v.QaF)(null==m?void 0:m.value);return l.createElement(ye.ZP,n()({},e,{focus:!0,onChange:b,onClick:void 0,value:o}))}}],...A.oA(S.map((e=>ne({currentSimpleFormulaValueTokens:r,value:e,setCurrentTokens:k,contextStore:o,action:"replace",context:t,checkType:"single"}))))],P=void 0!==(null==d?void 0:d.header)?d.header:a()(H.Z,{style:{paddingBottom:0},title:g.formatMessage(G.s.genericMenuHeader)});let V;x.push({key:"textbox",render:e=>l.createElement(H.Z,e),items:T}),V=y.isMobile?{menuType:L.og.Modal,right:a()(z.DoneMenuText,{}),onClickRight:u}:{menuType:L.og.Popup,maxHeight:"50vh",width:260,footer:M&&a()(H.Z,{topBorder:!0},void 0,l.createElement(J,e)),disableHeaderBorder:!0};const _={...V,...d,header:y.isMobile?null:P};return l.createElement(K.Z,_,a()(O.Z,{initialFocus:0,sections:x,type:O.i.Vertical}))}var ve=o(1302);function fe(e){var t,o;window.__c={n:"ValuePickerMenuPersonArray"};const{context:r,contextStore:i,currentSimpleFormulaValueTokens:d,formulaTypecheckContextValues:u,menuProps:m,onChange:g,onClose:y,showClearButton:S,showInputMenuItem:f}=e,C=(0,s.Fy)(),b=(0,E.useIntl)(),w=(0,s.O7)(),{collectionStore:k,property:M}=r,[x,T]=(0,l.useState)(""),q=(0,c.qz)(void 0,D.Z),j=(0,P.M)(k,M),U=j(d,"first"),Y=(0,c.VK)((()=>{const e=k.getSchema()[r.property];return!(!e||!(0,p.en)(e))&&1===e.limit}),[k,r]),$=u.filter((e=>(0,_.uy)(e.type,{type:"person"}))),[X]=(0,B.r5)((async()=>({valueResults:x?(0,Z.ZP)(x,$,(e=>e.kind===F.yp.ContextValue?e.name:"")):$,userResults:(await R.Yu({environment:w,query:x,membersOnly:!1})).map((e=>e.id)).slice(0,20)})),[w,x,$],{debounce:R.vp}),ee=(0,l.useCallback)((()=>{T(""),q.setState({...q.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[q]),te=(0,l.useCallback)((e=>{const t=j(e,"last");g({type:"simple",value:(0,h.iC)(t)}),ee()}),[g,ee,j]),oe=(0,c.VK)((()=>(0,I.formulaButtonsEnabled)()),[]),ie=A.oA(U.map(((e,t)=>a()(V,{token:e,contextStore:i,disabled:!1,currentSimpleFormulaValueTokens:U,setCurrentTokens:te,context:r},t)))),ae=a()(Q.Z,{focus:!C.isMobile||void 0,focusAfterAnimation:!0,format:Q.Z.Format.FilterValue,tokens:ie,placeholder:b.formatMessage(G.s.personSearchPlaceholder),onRemoveLastToken:()=>{te(U.slice(0,U.length-1))},onClearButtonClick:()=>{te([])},value:x,onChange:e=>{T(e.target.value)},dontShowBorderBottom:C.isAndroid,showClearButton:S}),le=void 0!==(null==m?void 0:m.header)?m.header:a()(H.Z,{style:{paddingBottom:0},title:b.formatMessage(G.s.genericMenuHeader)});let se;se=C.isMobile?{menuType:L.og.Modal,right:a()(z.DoneMenuText,{}),onClickRight:y}:{menuType:L.og.Popup,maxHeight:"50vh",width:260,footer:oe&&a()(H.Z,{topBorder:!0},void 0,l.createElement(J,e)),disableHeaderBorder:!0};const ce={...se,...m,header:C.isMobile?null:le},de=Y?"single":"multi",pe=[...A.oA(((null===(t=X.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>ne({currentSimpleFormulaValueTokens:U,value:e,setCurrentTokens:te,contextStore:i,action:"append",context:r,checkType:de,onCheckboxClick:()=>{Y&&ve.default.afterNextFlush((()=>{y()}))}})))),...A.oA(((null===(o=X.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{const t=Boolean(U.find((t=>(0,h.S3)(t)&&(0,v.IWo)(t)&&(0,v.zEN)(t)===e))),o=(0,v.tEo)(e),n=()=>{te(t?(0,h.Ck)(U,o):[...U,o]),Y&&ve.default.afterNextFlush((()=>{y()}))};return{key:e,render:e=>a()(re,{token:o,contextStore:i,args:e,checkState:t,checkType:de,context:r,onCheckboxClick:n}),action:n}})))],ue=[];if(f){const e=Boolean(le);ue.push({key:"search-input",render:t=>l.createElement(H.Z,n()({},t,{style:{...e&&{paddingTop:0}}})),items:[{action:()=>{},key:"input",render:()=>ae}]})}if(pe.length>0){const e=Boolean(le)||f;ue.push({key:"users",render:t=>l.createElement(H.Z,n()({topBorder:e},t)),items:pe})}return l.createElement(K.Z,ce,X.error&&a()(H.Z,{},void 0,a()(N.Z,{title:l.createElement(E.FormattedMessage,G.s.somethingWentWrong)})),0===ue.length&&X.value&&a()(H.Z,{},void 0,a()(N.Z,{title:l.createElement(E.FormattedMessage,G.s.noResults)})),!X.value&&!X.error&&a()(H.Z,{},void 0,a()(W.Z,{})),ue.length>0&&a()(O.Z,{type:O.i.Vertical,initialFocus:0,sections:ue,store:q}))}function Ce(e){window.__c={n:"ValuePickerMenuSelect"};const{context:t,contextStore:o,currentSimpleFormulaValueTokens:r,formulaTypecheckContextValues:i,isSingle:d,menuProps:u,onChange:m,onClose:g,showClearButton:y,showInputMenuItem:S,type:v}=e,C=(0,s.Fy)(),b=(0,E.useIntl)(),[w,k]=(0,l.useState)(""),M=(0,c.qz)(void 0,D.Z),x=ee.NW.createChildStore(o.context.parentRecordStore,v.collection),T=(0,c.VK)((()=>x.getSchema()[v.property]),[x,v]),P=(0,c.VK)((()=>T&&(0,p.gB)(T)?T.groups??[]:[]),[T]),B=(0,c.VK)((()=>T&&(0,p.t)(T)&&T.options||[]),[T]),R=i.filter((e=>(0,_.uy)(e.type,{type:"select",collection:v.collection,property:v.property}))),W=(0,c.VK)((()=>({valueResults:w?(0,Z.ZP)(w,R,(e=>e.kind===F.yp.ContextValue?e.name:"")):R,selectResults:w?(0,Z.ZP)(w,B,(e=>e.value)):B})),[w,R,B]),q=(0,l.useCallback)((()=>{k(""),M.setState({...M.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[M]),j=(0,l.useCallback)((e=>{m({type:"simple",value:d?(0,h.YD)(e[0]):(0,h.iC)(e)}),q()}),[m,q,d]),U=(0,c.VK)((()=>(0,I.formulaButtonsEnabled)()),[]),Y=A.oA(r.map(((e,n)=>a()(V,{token:e,contextStore:o,disabled:!1,currentSimpleFormulaValueTokens:r,setCurrentTokens:j,context:t},n)))),$=void 0!==(null==u?void 0:u.header)?u.header:a()(H.Z,{style:{paddingBottom:0},title:b.formatMessage(G.s.genericMenuHeader)}),X=a()(Q.Z,{focus:!C.isMobile||void 0,focusAfterAnimation:!0,format:Q.Z.Format.FilterValue,tokens:Y,placeholder:b.formatMessage(G.s.searchPlaceHolder),onRemoveLastToken:()=>{j(r.slice(0,r.length-1))},onClearButtonClick:()=>{j([])},value:w,onChange:e=>{k(e.target.value)},dontShowBorderBottom:C.isAndroid,showClearButton:y}),te=[];if(S){const e=Boolean($);te.push({key:"search-input",render:t=>l.createElement(H.Z,n()({},t,{style:{...e&&{paddingTop:0}}})),items:[{action:()=>{},key:"input",render:()=>X}]})}const oe=Boolean(T&&(0,p.gB)(T)),ie={automationContextValues:W.valueResults??[],onClose:g,context:t,contextStore:o,currentSimpleFormulaValueTokens:r,isSingle:d,groupOptions:P,selectOptions:W.selectResults??[],setCurrentTokens:j},ae=oe?function(e){const{automationContextValues:t,onClose:o,context:r,contextStore:i,currentSimpleFormulaValueTokens:s,isSingle:c,groupOptions:d,selectOptions:p,setCurrentTokens:u}=e,m=[],g=c?"single":"multi",y=A.oA(t.map((e=>ne({currentSimpleFormulaValueTokens:s,value:e,setCurrentTokens:u,contextStore:i,action:c?"replace":"append",context:r,checkType:g,onCheckboxClick:()=>{c&&ve.default.afterNextFlush((()=>{o()}))}}))));y.length>0&&m.push({key:"automation-variables",render:e=>l.createElement(H.Z,n()({title:l.createElement(E.FormattedMessage,G.s.valuesFromThisAutomation),topBorder:!0},e)),items:y});const S=new Map(p.map((e=>[e.id,e]))),v=d.map((e=>{const t=(e.optionIds??[]).map((e=>S.get(e))).filter(f.$K).map((e=>{const t=Boolean(s.find((t=>"string"==typeof t&&t===e.value))),n=()=>{u(c?t?[]:[e.value]:t?(0,h.Ck)(s,e.value):[...s,e.value]),c&&ve.default.afterNextFlush((()=>{o()}))};return{key:e.id,render:o=>a()(re,{token:e.value,contextStore:i,args:o,checkState:t,checkType:g,context:r,onCheckboxClick:n}),action:n}}));return{key:e.id,items:t,render:t=>l.createElement(H.Z,n()({title:e.name,topBorder:!0},t))}})).filter((e=>e.items.length>0));return m.push(...v),m}(ie):function(e){const{automationContextValues:t,onClose:o,context:r,contextStore:i,currentSimpleFormulaValueTokens:s,isSingle:c,selectOptions:d,setCurrentTokens:p}=e,u=[],m=c?"single":"multi",g=A.oA(t.map((e=>ne({currentSimpleFormulaValueTokens:s,value:e,setCurrentTokens:p,contextStore:i,action:c?"replace":"append",context:r,checkType:m,onCheckboxClick:()=>{c&&ve.default.afterNextFlush((()=>{o()}))}})))),y=A.oA(d.map((e=>{const t=Boolean(s.find((t=>"string"==typeof t&&t===e.value))),n=()=>{p(c?t?[]:[e.value]:t?(0,h.Ck)(s,e.value):[...s,e.value]),c&&ve.default.afterNextFlush((()=>{o()}))};return{key:e.id,render:o=>a()(re,{token:e.value,contextStore:i,args:o,checkState:t,checkType:m,context:r,onCheckboxClick:n}),action:n}}))),S=[...g,...y];S.length>0&&u.push({key:"options",render:e=>l.createElement(H.Z,n()({topBorder:!0},e)),items:S});return u}(ie);let le;te.push(...ae),le=C.isMobile?{menuType:L.og.Modal,right:a()(z.DoneMenuText,{}),onClickRight:g}:{menuType:L.og.Popup,maxHeight:"50vh",width:260,paddingTop:0,footer:U&&a()(H.Z,{topBorder:!0},void 0,l.createElement(J,e)),disableHeaderBorder:!0};const se={...le,...u,header:C.isMobile?null:$};return l.createElement(K.Z,se,0===te.length&&a()(H.Z,{},void 0,a()(N.Z,{title:l.createElement(E.FormattedMessage,G.s.noResults)})),te.length>0&&a()(O.Z,{type:O.i.Vertical,initialFocus:0,sections:te,store:M}))}var be=o(65187),we=o(43250),ke=o(28992);function Me(e){window.__c={n:"ValuePickerMenuText"};const{context:t,contextStore:o,currentSimpleFormulaValueTokens:r,formulaTypecheckContextValues:i,menuProps:d,onChange:p,onClose:u,value:m,disableEmojiCommands:g,disableFormattingAndMentions:y,disableMobileActionBar:S,disableTemplateVariableMentions:v}=e,f=(0,E.useIntl)(),{isMobile:C}=(0,s.Fy)(),b=(0,j.yK)((e=>({wrap:{background:e.inputBackground,borderRadius:4,boxShadow:e.inputBoxShadow,lineHeight:"24px",padding:1,marginBlock:C?12:0},text:{maxHeight:120,overflow:"auto",padding:"4px 10px"}})),[C]),w=(0,c.VK)((()=>(0,I.formulaButtonsEnabled)()),[]),k=(0,l.useMemo)((()=>i.filter((e=>"text"===e.type.type))),[i]),M=(0,l.useCallback)((e=>{p({type:"simple",value:e})}),[p]),x=(0,l.useCallback)((e=>{M(e),u()}),[M,u]),T=(0,l.useCallback)((e=>{const t=void 0!==e[0]?(0,h.YD)(e[0]):void 0;x(t)}),[x]),{store:P}=(0,I.useMockTextStore)({initialValue:null==m?void 0:m.value,onChange:M}),V=[],_=[...A.oA(k.map((e=>ne({currentSimpleFormulaValueTokens:r,value:e,setCurrentTokens:T,contextStore:o,action:"replace",context:t,checkType:"single"})))),...[{action:A.ZT,key:"input",render:e=>l.createElement(ke.Z,n()({},e,{title:a()("div",{className:we.Wh_,style:b.wrap},void 0,l.createElement(be.Z,n()({disableComment:!0,disabled:!1,disableEmbedMenu:!0,disableEmojiCommands:g,disableMobileActionBar:S,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableSlashCommands:!0,disableTemplateVariableMentions:v},y?{disableDateMentions:!0,disableDateReminderMentions:!0,disableMentions:!0,disableStyleAnnotations:!0}:{},{onEnter:u,pasteBehavior:"inline",store:P,style:b.text})))}))}]],F=void 0!==(null==d?void 0:d.header)?d.header:a()(H.Z,{style:{paddingBottom:0},title:f.formatMessage(G.s.genericMenuHeader)});let Z;V.push({key:"textbox",render:e=>l.createElement(H.Z,e),items:_}),Z=C?{menuType:L.og.Modal,right:a()(z.DoneMenuText,{}),onClickRight:u}:{menuType:L.og.Popup,maxHeight:"50vh",width:260,footer:w&&a()(H.Z,{topBorder:!0},void 0,l.createElement(J,e)),disableHeaderBorder:!0};const B={...Z,...d,header:C?null:F};return l.createElement(K.Z,B,a()(O.Z,{initialFocus:0,sections:V,type:O.i.Vertical}))}function xe(e){const{showClearButton:t,showInputMenuItem:o,type:r}=e;return"text"===r.type?l.createElement(Me,n()({},e,{type:r})):"number"===r.type?l.createElement(Se,n()({},e,{type:r})):"checkbox"===r.type?l.createElement(ae,n()({},e,{type:r})):"date"===r.type?l.createElement(he,n()({},e,{type:r})):"person_array"===r.type?l.createElement(fe,n()({},e,{showClearButton:t??!0,showInputMenuItem:o??!0,type:r})):"block_array"===r.type?l.createElement(ie,n()({},e,{showClearButton:t??!0,showInputMenuItem:o??!0,type:r})):"select"===r.type?l.createElement(Ce,n()({},e,{showClearButton:t??!0,showInputMenuItem:o??!0,type:r,isSingle:!0})):"select_array"===r.type?l.createElement(Ce,n()({},e,{showClearButton:t??!0,showInputMenuItem:o??!0,type:r,isSingle:!1})):void(0,f.t1)(r)}},75311:(e,t,o)=>{o.d(t,{M:()=>s,_:()=>c});var r=o(67294),n=o(86628),i=o(99036),a=o(40506),l=o(97880);function s(e,t){const o=(0,n.VK)((()=>{const o=e.getSchema()[t];let r;return o&&(0,i.en)(o)&&(r=o.limit),r}),[e,t]);return(0,r.useCallback)(((e,t)=>(0,l.$K)(o)?"first"===t?e.slice(0,o):"last"===t?e.slice(-o):void(0,l.t1)(t):e),[o])}function c(e){var t;const o=null===(t=e.collectionStore.getSchema())||void 0===t?void 0:t[e.property];return o&&"date"===o.type?{dateFormat:o.date_format||a.sF,timeFormat:o.time_format||a.c_}:{dateFormat:a.sF,timeFormat:a.c_}}},30387:(e,t,o)=>{o.d(t,{s:()=>r});const r=(0,o(5366).defineMessages)({back:{defaultMessage:"Back",id:"formulas.SimpleFormulaValuePicker.back"},valuesFromThisAutomation:{defaultMessage:"From this automation",id:"formulas.SimpleFormulaValuePicker.valuesFromThisAutomation"},pickADate:{defaultMessage:"Pick a date",id:"formulas.SimpleFormulaValuePicker.pickADate"},clear:{defaultMessage:"Clear",id:"formulas.SimpleFormulaValuePicker.clear"},unchecked:{defaultMessage:"Unchecked",id:"formulas.SimpleFormulaValuePicker.checkbox.unchecked"},checked:{defaultMessage:"Checked",id:"formulas.SimpleFormulaValuePicker.checkbox.checked"},checkboxOptions:{defaultMessage:"Checkbox options",id:"formulas.SimpleFormulaValuePicker.checkbox.sectionHeader"},searchPlaceHolder:{defaultMessage:"Select one or more optionsâ€¦",id:"formulas.SimpleFormulaValuePicker.select.searchPlaceholder"},selectOptionsSectionHeader:{defaultMessage:"Select an option",id:"formulas.SimpleFormulaValuePicker.select.sectionHeader"},noResults:{defaultMessage:"No results",id:"formulas.simpleValuePicker.noResults"},pageSearchPlaceholder:{defaultMessage:"Search for one or more pagesâ€¦",id:"formulas.SimpleFormulaValuePicker.pages.searchPlaceholder"},pages:{defaultMessage:"Pages",id:"formulas.SimpleFormulaValuePicker.pages.sectionHeader"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"formulas.simpleValuePicker.errorMessage"},personSelect:{defaultMessage:"Select...",id:"formulas.SimpleFormulaValuePicker.chooseAValue"},personSearchPlaceholder:{defaultMessage:"Search for one or more peopleâ€¦",id:"formulas.SimpleFormulaValuePicker.people.searchPlaceholder"},customFormula:{defaultMessage:"Custom formula",id:"formulas.SimpleFormulaValuePicker.customFormula"},peopleInWorkspace:{defaultMessage:"People",id:"formulas.SimpleFormulaValuePicker.people.sectionHeader"},genericMenuHeader:{defaultMessage:"Set property to",id:"formulas.SimpleFormulaValuePicker.genericMenuHeader"}})},30950:(e,t,o)=>{o.d(t,{a:()=>n});var r=o(67294);function n(e){return(0,r.useMemo)((()=>Boolean(e&&e.width<400)),[e])}},29502:(e,t,o)=>{o.d(t,{d:()=>a});var r=o(480),n=o(86628),i=o(53437);function a(e){const t=(0,r.Fy)();return(0,n.VK)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?i.kQ.SlideUp:i.kQ.Popup),[t,null==e?void 0:e.tabletBehavior])}},28267:(e,t,o)=>{o.d(t,{X:()=>i});var r=o(67294),n=o(77794);function i(e){const[t,o]=(0,r.useState)(void 0);return(0,r.useEffect)((()=>{if(!e.current)return;const t=new n.E;return t.observe(e.current),t.rect.addListener((e=>{o(e.state)})),()=>{t.destroy()}}),[e]),t}},36857:(e,t,o)=>{o.d(t,{Z:()=>i});var r=o(49085);class n extends r.default{getInitialState(){return{pageId:void 0}}}const i=new n},62208:(e,t,o)=>{o.d(t,{z:()=>i});var r=o(23174),n=o.n(r);o(67294);const i=(0,o(45238).I)("loop",{viewBox:"0 0 16 16",svg:n()("path",{d:"M5.80371 3.12305C5.81006 3.50391 6.05762 3.74512 6.47656 3.74512H11.3643C11.9546 3.74512 12.2783 4.0498 12.2783 4.66553V11.2925L11.377 10.3149L10.8628 9.80078C10.5962 9.54688 10.2344 9.52783 9.96777 9.78809C9.71387 10.0483 9.72021 10.4229 9.98047 10.6831L12.145 12.8413C12.6211 13.311 13.167 13.311 13.6431 12.8413L15.8076 10.6831C16.0679 10.4229 16.0742 10.0483 15.8203 9.78809C15.5537 9.52783 15.1919 9.54688 14.9253 9.80078L14.4111 10.3149L13.5161 11.2861V4.56396C13.5161 3.20557 12.8052 2.50098 11.4341 2.50098H6.47656C6.05762 2.50098 5.79736 2.74219 5.80371 3.12305ZM0.186035 7.05859C0.446289 7.3252 0.808105 7.30615 1.07471 7.0459L1.59521 6.53809L2.48389 5.56689V12.2891C2.48389 13.6475 3.19482 14.3521 4.56592 14.3521H9.52344C9.94238 14.3521 10.2026 14.1108 10.1963 13.73C10.1899 13.3428 9.94238 13.1079 9.52344 13.1079H4.64209C4.05176 13.1079 3.72803 12.7969 3.72803 12.1812V5.5542L4.62305 6.53809L5.14355 7.0459C5.40381 7.30615 5.77197 7.3252 6.03223 7.05859C6.29248 6.79834 6.28613 6.43018 6.01953 6.16992L3.85498 4.01172C3.37891 3.53564 2.83936 3.53564 2.36328 4.01172L0.19873 6.16992C-0.0678711 6.43018 -0.0742188 6.79834 0.186035 7.05859Z"})})}}]);