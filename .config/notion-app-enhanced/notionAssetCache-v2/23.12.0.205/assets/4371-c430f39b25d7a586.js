"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4371],{37834:(e,t,r)=>{r.d(t,{FF:()=>f,U4:()=>v,gs:()=>y,jN:()=>g,xx:()=>k,zb:()=>b});var o=r(23174),i=r.n(o),a=(r(67294),r(23867)),n=r(82990),s=r(5366),d=r(77080),l=r(46096),c=r(50906),p=r(54642),u=r(47307),m=r(92625);const h=(0,s.defineMessages)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoringâ€¦"}});function g(e){const{environment:t,from:r,...o}=e;c.ya1(t,r),l.Z.setState({...o,open:!0,size:50})}const f=()=>{const e=l.Z.state;e.open&&l.Z.setState({...e,size:e.size+20})},v=function(){l.Z.setState({open:!1})};function y(e){const{environment:t,snapshot:r,nextFutureSnapshot:o}=e;c.qDg(t,r);const i=l.Z.state;i.open&&l.Z.setState({...i,snapshot:r,nextFutureSnapshot:o,openSnapshotNearTimestamp:void 0})}function b(){const e=l.Z.state;e.open&&l.Z.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function k(e){if(!l.Z.state.open)return;if(!l.Z.state.snapshot)return;const t="restore_collection",r=l.Z.state.pageHasCollection,o=d.default.checkGate("snapshot_optional_collection_rollback_enabled")&&r?[{key:t,text:i()(s.FormattedMessage,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:i()(s.FormattedMessage,{defaultMessage:"All database pages will be restored to the previous version, which may impact other users or database views.",id:"historyModal.confirmDialog.selectOption.collection.description"})}]:void 0,{accept:g,selectionResult:f}=await u.confirmUserActionV2({message:i()("div",{style:{fontWeight:n.Z.fontWeight.semibold,fontSize:"medium"}},void 0,i()(s.FormattedMessage,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})),acceptLabel:i()(s.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:o});if(!g)return;c.R9m(e,l.Z.state.snapshot),m.j({message:h.restoringPreviousVersion});const y=await p.restoreSnapshot(e,{block:{id:l.Z.state.blockStore.id,spaceId:(0,a.C)(l.Z.state.blockStore.pointer.spaceId)},timestamp:l.Z.state.snapshot.timestamp,shouldRestoreCollection:(null==f?void 0:f.restore_collection)??!1}).next();y.value.error&&u.showErrorMessage(y.value.error.message),m.x(),v()}},63381:(e,t,r)=>{r.d(t,{Z:()=>oe});var o=r(10434),i=r.n(o),a=r(23174),n=r.n(a),s=(r(57658),r(67294)),d=r(83355),l=r(13991),c=r(49085),p=r(40902),u=r(66897),m=r(17215),h=r(41432),g=r(15070),f=r(99036),v=r(80951),y=r(8848),b=r(63144),k=r(25501),C=r(14215),S=r(6695),_=r(38297),M=r(42875),w=r(13530),B=r(72126),T=r(59753),D=r(26825),E=r(27006),P=r(21202),I=r(77420),x=r(70279),F=r(23867),V=r(15047),R=r(29369),Z=r(19889),A=r(70203),N=r(97880),U=r(82990),G=r(7928),L=r(5366),H=r(42130),O=r(33929),K=r(77907),q=r(50694),z=r(30874),W=r(57559),j=r(2456),$=r(44295),J=r(31278);class Q extends d.Z{constructor(){super(...arguments),this.renderEdit=()=>{const{edit:e,formatProperty:t}=this.props;if("page_icon"===t){const r=e.block_data.before.block_value.format&&e.block_data.before.block_value.format[t],o=e.block_data.after.block_value.format&&e.block_data.after.block_value.format[t];return this.renderPageIconUpdatedEdit(r,o)}"is_placeholder"!==t&&(0,N.t1)(t)},this.renderPageIconUpdatedEdit=(e,t)=>{const{edit:r}=this.props;if(e||t)return s.createElement(s.Fragment,null,n()("div",{style:{display:"flex",alignItems:"center",color:this.theme.lightTextColor,fontSize:12,lineHeight:1,marginBottom:8}},void 0,(0,$.I)({width:12,height:12,marginRight:6}),n()(L.FormattedMessage,{id:"editFormatDiff.pageIcon.label",defaultMessage:"Page Icon"})),n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(J.Z,{disabled:!0,isEmptyPage:!1,size:20,icon:e?{pointer:{table:P.iU,id:r.block_data.before.block_value.id},icon:e}:void 0}),n()("div",{style:{padding:"0px 8px"}},void 0,(0,w.s)({width:14,height:14,fill:this.theme.mediumIconColor})),n()(J.Z,{disabled:!0,isEmptyPage:!1,size:20,icon:t?{pointer:{table:P.iU,id:r.block_data.after.block_value.id},icon:t}:void 0})))}}renderComponent(){return this.renderEdit()||null}}Q.displayName="EditFormatDiff";const X=Q;var Y=r(14200),ee=r(75561),te=r(90706);class re extends d.Z{constructor(){super(...arguments),this.storeTypes={isEditHovered:c.default.createClass(!1)},this.renderProperty=(e,t,r)=>n()(j.KX,{value:e,propertySchema:t,labeled:r,rootStore:this.props.rootStore}),this.renderBlockProperty=(e,t,r,o)=>n()(j.Tl,{blockValue:e,prop:t,labeled:r,schema:o,intl:this.props.intl,rootStore:this.props.rootStore}),this.renderBlockEditProperty=(e,t,r)=>{const o=this.getBlockSchema(e)[t],i="block-changed"===e.type?e.block_data.after.block_value:e.block_data.block_value,a=(0,j.SX)(i,t);if(o)return this.renderProperty({value:a,spaceId:(0,F.C)(i.space_id)},o,r)},this.renderBlockEditPropertyDiff=(e,t,r)=>{const o=this.getBlockSchema(e),i=o[t];if(!i)return;const a=(0,j.SX)(e.block_data.before.block_value,t),s=v.wV({property:t,schema:o,block:T.kk.fromBlock(e.block_data.before.block_value),getRecordModel:this.getRecordModel,userId:this.environment.currentUser.id,userTimeZone:(0,M.r)(),intl:this.props.intl}),d=(0,j.SX)(e.block_data.after.block_value,t),l=i.type;return s&&"text"!==l&&"title"!==l?this.renderProperty({value:d,spaceId:(0,F.C)(e.block_data.after.block_value.space_id)},i,r):n()(j.Hq,{labeled:r,name:i.name,type:i.type,icon:i.icon},void 0,n()(te.Z,{propertySchema:i,beforeValue:{value:a,spaceId:(0,F.C)(e.block_data.before.block_value.space_id)},afterValue:{value:d,spaceId:(0,F.C)(e.block_data.after.block_value.space_id)},rootStore:this.props.rootStore}))},this.renderBlockPropertyEditDiff=e=>{const{labeled:t,propertySchema:r,beforeValue:o,afterValue:i,spaceId:a}=e,s=(0,F.C)(a);return n()(j.Hq,{labeled:t,name:r.name,type:r.type,icon:r.icon},void 0,n()(te.Z,{propertySchema:r,beforeValue:{value:o,spaceId:s},afterValue:{value:i,spaceId:s},rootStore:this.props.rootStore}))},this.getRecordValue=this.props.rootStore.getRecordValue,this.getRecordModel=this.props.rootStore.getRecordModel}renderComponent(){return this.renderEdit()||null}renderEdit(){if("comment-edit"===this.props.type){const{edit:e,discussionLocation:t,hideAuthorName:r}=this.props;switch(e.type){case"comment-created":return this.renderCommentCreatedEdit({edit:e,discussionLocation:t,hideAuthorName:r});case"comment-changed":return this.renderCommentChangedEdit(e);case"comment-deleted":return this.renderCommentDeletedEdit(e,t);default:(0,N.t1)(e)}}const{edit:e}=this.props;switch(e.type){case"block-created":return this.renderBlockCreatedEdit(e.block_data.block_value);case"block-deleted":return this.renderBlockDeletedEdit(e.block_data.block_value);case"block-changed":return this.renderBlockChangedEdit(e);case"block-property-changed":return this.renderBlockPropertyChangedEdit(e);case"collection-property-changed":return this.renderCollectionPropertyChangedEdit(e);case"collection-changed":return this.renderCollectionChangedEdit(e);case"collection-created":return this.renderCollectionCreatedEdit(e);case"mention-created":return this.renderMentionCreated(e);case"permission-created":return this.renderPermissionCreated(e);case"permission-changed":return this.renderPermissionChanged(e);case"permission-deleted":return this.renderPermissionDeleted(e);case"permission-restriction-created":case"permission-restriction-deleted":return this.renderPermissionInheritanceChanged(e);case"permission-group-created":return this.renderPermissionGroupCreated(e);case"permission-group-changed":return this.renderPermissionGroupChanged(e);case"permission-group-deleted":return this.renderPermissionGroupDeleted(e);case"reminder-created":return this.renderReminderCreated(e);case"permission-group-mention-created":return this.renderPermissionGroupMentionCreated(e);case"permission-group-mention-deleted":case"mention-deleted":return null;default:(0,N.t1)(e)}}renderBlockChanged(e){switch(e.block_data.after.block_value.type){case h.Ti.text:return this.renderTextBlockChanged(e);case h.Ti.header:return this.renderHeaderBlockChanged(e);case h.Ti.subHeader:return this.renderSubHeaderBlockChanged(e);case h.Ti.subSubHeader:return this.renderSubSubHeaderBlockChanged(e);case h.Ti.toggle:return this.renderToggleBlockChanged(e);case h.Ti.bulletedList:return this.renderBulletedListBlockChanged(e);case h.Ti.numberedList:return this.renderNumberedListBlockChanged(e);case h.Ti.quote:return this.renderQuoteBlockChanged(e);case h.Ti.factory:return this.renderFactoryBlockChanged(e);case h.Ti.equation:return this.renderEquationBlockChanged(e);case h.Ti.toDo:return this.renderTodoBlockChanged(e);case h.Ti.code:return this.renderCodeBlockChanged(e);case h.Ti.bookmark:return this.renderBookmarkBlockChanged(e);case h.Ti.page:return this.renderPageBlockChanged(e);case h.Ti.collectionView:case h.Ti.collectionViewPage:return this.renderCollectionBlockChanged(e);case h.Ti.image:return this.renderImageBlockChanged(e);case h.Ti.embed:return this.renderEmbedBlockChanged(e,"embed");case h.Ti.framer:return this.renderEmbedBlockChanged(e,"framer");case h.Ti.tweet:return this.renderEmbedBlockChanged(e,"tweet");case h.Ti.gist:return this.renderEmbedBlockChanged(e,"gist");case h.Ti.drive:return this.renderDriveBlockChanged(e);case h.Ti.maps:return this.renderEmbedBlockChanged(e,"maps");case h.Ti.invision:return this.renderEmbedBlockChanged(e,"invision");case h.Ti.video:return this.renderEmbedBlockChanged(e,"video");case h.Ti.audio:return this.renderEmbedBlockChanged(e,"audio");case h.Ti.file:return this.renderEmbedBlockChanged(e,"file");case h.Ti.callout:return this.renderCalloutBlockChanged(e);case h.Ti.whimsical:return this.renderEmbedBlockChanged(e,"whimsical");case h.Ti.miro:return this.renderEmbedBlockChanged(e,"miro");case h.Ti.abstract:return this.renderEmbedBlockChanged(e,"abstract");case h.Ti.mixpanel:return this.renderEmbedBlockChanged(e,"mixpanel");case h.Ti.sketch:return this.renderEmbedBlockChanged(e,"sketch");case h.Ti.replit:return this.renderEmbedBlockChanged(e,"replit");case h.Ti.excalidraw:return this.renderEmbedBlockChanged(e,"excalidraw");case h.Ti.tableRow:return this.renderSimpleTableRowBlockChanged(e);case h.Ti.hex:return this.renderEmbedBlockChanged(e,"hex");case h.Ti.hex:return this.renderEmbedBlockChanged(e,"deepnote");case h.Ti.externalObjectInstance:return this.renderExternalObjectInstanceBlockChanged(e)}}renderBlockCreatedEdit(e){const t=n()(j.ZP,{blockValue:e,rootStore:this.props.rootStore,created:!0});if(t)switch(e.type){case h.Ti.quote:case h.Ti.video:case h.Ti.code:case h.Ti.equation:case h.Ti.file:case h.Ti.bookmark:case h.Ti.factory:return n()("div",{style:H.v.wrapStyle},void 0,t);case h.Ti.table:return;case h.Ti.tableRow:return e.properties&&(0,N.Yd)(e.properties).length>0?n()("div",{style:{...H.v.wrapStyle,...H.v.addedStyle}},void 0,t):void 0;default:return n()("div",{style:{...H.v.wrapStyle,...H.v.addedStyle}},void 0,t)}}renderBlockDeletedEdit(e){const t=n()(j.ZP,{rootStore:this.props.rootStore,blockValue:e,deleted:!0});if(t)switch(e.type){case h.Ti.quote:case h.Ti.video:case h.Ti.code:case h.Ti.equation:case h.Ti.file:case h.Ti.bookmark:case h.Ti.factory:return n()("div",{},void 0,n()("div",{style:H.v.getLabelStyle(this.theme)},void 0,n()(L.FormattedMessage,{defaultMessage:"Deleted",id:"edit.blockDeletedEditStyles.factoryLabel"})),n()("div",{style:{...H.v.wrapStyle}},void 0,t));case h.Ti.table:return;case h.Ti.tableRow:return e.properties&&(0,N.Yd)(e.properties).length>0?n()("div",{style:{...H.v.wrapStyle,...H.v.deletedStyle}},void 0,t):void 0;default:return n()("div",{},void 0,n()("div",{style:H.v.getLabelStyle(this.theme)},void 0,n()(L.FormattedMessage,{defaultMessage:"Deleted",id:"edit.blockDeletedEditStyles.defaultLabel"})),n()("div",{style:{...H.v.wrapStyle,...H.v.deletedStyle}},void 0,t))}}renderBlockChangedEdit(e){const t=this.renderBlockChanged(e);if(t)return n()("div",{style:H.v.wrapStyle},void 0,t)}renderBlockPropertyChangedEdit(e){return n()("div",{},void 0,Object.entries(e.property_updates).map((t=>{let[r,o]=t;const i=e.filtered_block_schema[r];if(!i)return;const a=o.before?o.before.value:[],s=o.after?o.after.value:[],d=this.renderBlockPropertyEditDiff({labeled:!0,propertySchema:i,beforeValue:a,afterValue:s,spaceId:e.space_id});return d?n()("div",{style:H.v.wrapStyle},void 0,d):void 0})).filter(N.$K))}renderCheckbox(e){return n()("div",{style:{marginRight:6,marginTop:3}},void 0,this.renderBlockProperty(e,"checked",!1))}renderEditTitle(e){return this.renderBlockEditProperty(e,"title",!1)}renderEditTitleDiff(e){return this.renderBlockEditPropertyDiff(e,"title",!1)}renderTextBlockChanged(e){return this.renderEditTitleDiff(e)}renderCalloutBlockChanged(e){return n()(k.Z,{title:n()(L.FormattedMessage,{defaultMessage:"Callout",id:"edit.calloutBlockChanged.label"}),theme:this.theme},void 0,this.renderEditTitleDiff(e))}renderExternalObjectInstanceBlockChanged(e){const t=t=>{const r=e.block_data[t].block_value,o=T.kk.fromBlock(r);return o.isType("external_object_instance")?m.$F(O.default.getIntl(),o,T.om.fromRecordMap(z.Z.getIntegrationsAsRecordMap())):null};return n()(k.Z,{title:s.createElement(L.FormattedMessage,m.V1.editLabel),theme:this.theme},void 0,n()("div",{style:H.v.deletedStyle},void 0,t("before")),n()("div",{},void 0,t("after")))}renderHeaderBlockChanged(e){return n()("div",{style:H.v.headerStyle},void 0,this.renderEditTitleDiff(e))}renderSubHeaderBlockChanged(e){return n()("div",{style:H.v.subHeaderStyle},void 0,this.renderEditTitleDiff(e))}renderSubSubHeaderBlockChanged(e){return n()("div",{style:H.v.subSubHeaderStyle},void 0,this.renderEditTitleDiff(e))}renderToggleBlockChanged(e){return n()(j.ZD,{},void 0,this.renderEditTitleDiff(e))}renderBulletedListBlockChanged(e){return n()("ul",{style:{margin:0,paddingLeft:28}},void 0,n()("li",{},void 0,this.renderEditTitleDiff(e)))}renderNumberedListBlockChanged(e){return n()("ol",{style:{margin:0,paddingLeft:28}},void 0,n()("li",{},void 0,this.renderEditTitleDiff(e)))}renderQuoteBlockChanged(e){return n()(k.Z,{title:n()(L.FormattedMessage,{defaultMessage:"Quote",id:"edit.quoteBlockChanged.label"}),theme:this.theme},void 0,this.renderEditTitleDiff(e))}renderFactoryBlockChanged(e){return n()(k.Z,{title:n()(L.FormattedMessage,{defaultMessage:"Template Button",id:"edit.templateButtonBlockChanged.label"}),theme:this.theme},void 0,this.renderEditTitleDiff(e))}renderEquationBlockChanged(e){return n()(k.Z,{title:n()(L.FormattedMessage,{defaultMessage:"Equation",id:"edit.equationBlockChanged.label"}),theme:this.theme},void 0,this.renderEditTitleDiff(e))}renderTodoBlockChanged(e){const t=p.j4({before:e.block_data.before.block_value,after:e.block_data.after.block_value,property:"checked"});return n()("div",{style:{display:"inline-flex"}},void 0,t?n()("div",{style:{marginRight:6,marginTop:3,lineHeight:1}},void 0,this.renderBlockEditPropertyDiff(e,"checked",!1)):this.renderCheckbox(e.block_data.after.block_value),this.renderEditTitleDiff(e))}renderCodeBlockChanged(e){return p.j4({before:e.block_data.before.block_value,after:e.block_data.after.block_value,property:"language"})?n()(k.Z,{title:this.getCodeTitle(e.block_data.after.block_value),theme:this.theme},void 0,n()("span",{style:{fontFamily:U.Z.getCompositeFontFamily(l.SP).mono,fontSize:12,tabSize:2}},void 0,this.renderEditTitle(e)),this.renderBlockEditPropertyDiff(e,"language",!0)):n()(k.Z,{title:this.getCodeTitle(e.block_data.after.block_value),theme:this.theme},void 0,n()("span",{style:{fontFamily:U.Z.getCompositeFontFamily(l.SP).mono,fontSize:12,tabSize:2}},void 0,this.renderEditTitle(e)))}renderCaptionChanged(e){return this.propertyChanged(e,"caption")&&this.renderBlockEditPropertyDiff(e,"caption",!1)}renderEmbedBlockChanged(e,t){const{intl:r}=this.props,o=this.propertyChanged(e,"source")&&n()(k.Z,{title:m.xg(r,t),theme:this.theme},void 0,this.renderSource(e.block_data.after.block_value),this.renderBlockEditPropertyDiff(e,"source",!1));return n()(s.Fragment,{},void 0,o,n()("div",{style:{marginBottom:o?4:0}},void 0,this.renderCaptionChanged(e)))}renderImageBlockChanged(e){const t=this.getSource(e.block_data.before.block_value),r=this.getSource(e.block_data.after.block_value),o=t!==r&&n()("div",{style:{marginTop:4,marginBottom:4}},void 0,n()("div",{style:{...H.v.getLabelStyle(this.theme),marginBottom:4}},void 0,n()(L.FormattedMessage,{defaultMessage:"Updated",id:"edit.imageBlockChanged.updatedTitle"})),r&&n()(j.xP,{src:r,permissionRecord:{table:P.iU,id:e.block_id}}));return n()(s.Fragment,{},void 0,o,n()("div",{style:{marginBottom:o?4:0}},void 0,this.renderCaptionChanged(e)))}renderComment(e){let{commentValue:t,discussionLocation:r,showEditedBadge:o,hideAuthorName:i}=e;if(!t.created_by_table||!t.created_by_id)return;if("comment-edit"!==this.props.type)return;const a=this.getRecordValue({table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}),s=a&&(0,u.LU)({table:t.created_by_table,value:a}),d=s?(0,u.$4)(this.props.intl,s):n()(L.FormattedMessage,{defaultMessage:"Unknown author",id:"edit.unknownAuthor.label"}),l=t.text&&n()(Y.Z,{propertySchema:{type:"text",name:""},value:{spaceId:t.space_id,value:this.props.highlightCurrentUser?this.highlightCurrentUserMentions(t.text):t.text},rootStore:this.props.rootStore}),c=t.content&&t.content.length>0&&t.content.map((e=>{const r=this.getRecordValue({table:"block",id:e,spaceId:t.space_id});return r&&n()(j.ZP,{blockValue:r,rootStore:this.props.rootStore})})).filter(N.$K),p=W.t1.createChildStore(this.props.rootStore,{table:x.x_,id:t.id,spaceId:(0,F.C)(this.props.rootStore.pointer.spaceId)}),m=p.getUserVisibleReactions().length>0,h=!m,g=this.stores.isEditHovered;return n()("div",{style:{...h&&{position:"relative"}},onMouseEnter:()=>g.setState(!0),onMouseLeave:()=>g.setState(!1)},void 0,!i&&n()("div",{style:{...H.v.getLabelStyle(this.theme),marginBottom:2}},void 0,d),n()("span",{style:{...U.Z.textOverflowStyle,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:6}},void 0,l),c,n()("div",{style:{...h&&{position:"absolute",top:-3,right:3}}},void 0,(g.state||m)&&n()(K.LazyReactionBar,{parentStore:p,discussionLocation:r,onClick:this.props.onReactionClick})),o&&n()("span",{style:{color:this.theme.mediumTextColor,paddingLeft:4}},void 0,n()(L.FormattedMessage,{id:"edit.editedBadge",defaultMessage:"(edited)"})))}renderCommentDiff(e){var t,r;const{before:o,after:i}=e;if(!i.created_by_table||!i.created_by_id)return;const a=this.getRecordValue({table:i.created_by_table,id:i.created_by_id,spaceId:i.space_id}),d=a&&(0,u.LU)({table:i.created_by_table,value:a}),l=d?(0,u.$4)(this.props.intl,d):n()(L.FormattedMessage,{defaultMessage:"Unknown author",id:"edit.unknownAuthorCommentDiff.label"}),c=o.text&&i.text&&n()(te.Z,{propertySchema:{type:"text",name:""},beforeValue:{value:o.text||[],spaceId:o.space_id},afterValue:{value:i.text||[],spaceId:i.space_id},rootStore:this.props.rootStore}),p=null===(t=i.content)||void 0===t?void 0:t.filter((e=>{var t;return!(null!==(t=o.content)&&void 0!==t&&t.includes(e))})),m=null===(r=o.content)||void 0===r?void 0:r.filter((e=>{var t;return!(null!==(t=i.content)&&void 0!==t&&t.includes(e))})),h=n()(s.Fragment,{},void 0,null==m?void 0:m.map((e=>{const t=this.getRecordValue({table:P.iU,id:e,spaceId:i.space_id});return t&&this.renderBlockDeletedEdit(t)})),null==p?void 0:p.map((e=>{const t=this.getRecordValue({table:P.iU,id:e,spaceId:i.space_id});return t&&n()(j.ZP,{blockValue:t,rootStore:this.props.rootStore})})));return n()("div",{},void 0,n()("div",{style:{...H.v.getLabelStyle(this.theme),marginBottom:2}},void 0,l),c,h)}renderCollectionPropertyChangedDiff(e){if(!e||!e.before||!e.after)return;const{before:t,after:r}=e,o=v.IQ({before:t,after:r});if(!o)return;const{newOptions:a,modifiedOptions:d,removedOptions:l}=o;if([a,d,l].every((e=>0===e.length)))return;const c=e=>{let{option:t,strikethrough:r=!1}=e;const o=(0,y.KR)(this.theme,null==t?void 0:t.color);return s.createElement(ee.Z,i()({},o,{strikethrough:r}),t.value)};return n()(j.Hq,{labeled:!0,name:r.name,icon:r.icon,type:r.type},void 0,n()("div",{style:{display:"flex",flexDirection:"column",rowGap:4}},void 0,a.length>0&&n()("div",{style:{display:"inline-flex",alignItems:"center",columnGap:4}},void 0,n()(L.FormattedMessage,{defaultMessage:"Added",id:"Edit.renderCollectionPropertyChangedDiff.addedProperty"}),a.map((e=>n()("span",{},e.id,c({option:e}))))),l.length>0&&n()("div",{style:{display:"inline-flex",alignItems:"center",columnGap:4}},void 0,n()(L.FormattedMessage,{defaultMessage:"Removed",id:"Edit.renderCollectionPropertyChangedDiff.removedProperty"}),l.map((e=>n()("span",{},e.id,c({option:e,strikethrough:!0}))))),d.length>0&&n()("div",{style:{display:"flex",flex:1,flexDirection:"row"}},void 0,n()("span",{},void 0,n()(L.FormattedMessage,{defaultMessage:"Edited",id:"Edit.renderCollectionPropertyChangedDiff.editedProperty"})),n()("div",{style:{display:"flex",flexDirection:"column"}},void 0,d.map((e=>n()("span",{style:{display:"inline-flex",alignItems:"center"}},e.before.id,n()("span",{style:{marginLeft:4}},void 0,c({option:e.before,strikethrough:!0})),n()("span",{style:{padding:"0px 8px"}},void 0,(0,w.s)({width:10,height:10,fill:this.theme.mediumIconColor})),c({option:e.after}))))))))}renderCollectionDescriptionChangedDiff(e,t){if(!t||!t.before&&!t.after)return;const r=t.before&&t.before.description||[],o=t.after&&t.after.description||[];return n()(j.Hq,{labeled:!0,name:n()(L.FormattedMessage,{defaultMessage:"Description",id:"edit.descriptionPropertyChanged.label"}),icon:void 0,type:"text"},void 0,n()(te.Z,{propertySchema:{type:"text",name:""},beforeValue:{value:r,spaceId:e},afterValue:{value:o,spaceId:e},rootStore:this.props.rootStore}))}renderCollectionDescriptionCreatedDiff(e){if(e)return n()(j.Hq,{labeled:!0,name:n()(L.FormattedMessage,{defaultMessage:"Description",id:"edit.descriptionPropertyCreated.label"}),type:"text",icon:void 0},void 0,n()(te.Z,{propertySchema:{type:"text",name:""},beforeValue:{value:[],spaceId:e.spaceId},afterValue:e,rootStore:this.props.rootStore}))}renderBookmarkBlockChanged(e){const t=(this.propertyChanged(e,"title")||this.propertyChanged(e,"source"))&&n()(k.Z,{title:n()(L.FormattedMessage,{defaultMessage:"Bookmark",id:"edit.bookmarkBlockPropertyChanged.label"}),theme:this.theme},void 0,this.renderEditTitleDiff(e),this.renderBlockEditPropertyDiff(e,"link",!0));return n()(s.Fragment,{},void 0,t,this.propertyChanged(e,"caption")&&n()("div",{style:{marginBottom:t?4:0}},void 0,this.renderCaptionChanged(e)))}renderDriveBlockChanged(e){const t=(0,S.v0)(e.block_data.before.block_value),r=e.block_data.after.block_value,o=t!==(0,S.v0)(r);return n()(s.Fragment,{},void 0,o&&"drive"===r.type&&n()(j.ZP,{blockValue:r,rootStore:this.props.rootStore}))}renderPageBlockChanged(e){const t=p.OS({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),r=p.B9({before:e.block_data.before.block_value,after:e.block_data.after.block_value});return n()("div",{},void 0,t.map(((t,r,o)=>n()("div",{},t,this.renderBlockEditPropertyDiff(e,t,!0)))),r.map(((r,o,i)=>{const a=0===t.length&&0===o,s=o===i.length-1;return n()("div",{style:{marginTop:a?6:10,marginBottom:s?0:6}},r,n()(X,{formatProperty:r,edit:e}))})))}renderCollectionBlockChanged(e){return null}renderSimpleTableRowBlockChanged(e){const t=e.block_data.before.block_value,r=e.block_data.after.block_value,o=p.Yr({before:t,after:r});return n()("div",{style:{display:"flex",alignItems:"stretch",flexDirection:"column"}},void 0,o.map((e=>{const o=t.properties&&e in t.properties?t.properties[e]:void 0,i=r.properties&&e in r.properties?r.properties[e]:void 0,a=q.g$.renderCellValueForActivity({environment:this.environment,cellValue:o,spaceId:t.space_id,parentStore:this.props.rootStore,theme:this.theme}),s=q.g$.renderCellValueForActivity({environment:this.environment,cellValue:i,spaceId:r.space_id,parentStore:this.props.rootStore,theme:this.theme});return n()("div",{style:{display:"flex",border:`1px solid ${this.theme.tableDividerColor}`,overflowWrap:"anywhere",width:"max-content",maxWidth:"100%",verticalAlign:"top",lineHeight:U.Z.lineHeight.UIRegular.desktop,padding:4,marginBottom:4}},void 0,n()("span",{style:{...H.v.deletedStyle,marginBottom:void 0}},void 0,a),o&&i&&(0,w.s)({width:12,height:12,fill:this.theme.mediumIconColor,alignSelf:"center",margin:4}),n()("span",{style:{...H.v.addedStyle}},void 0,s))})))}renderSource(e){const t=this.getSource(e);return n()("span",{style:{wordBreak:"break-word"}},void 0,t)}renderPermissionCreated(e){return n()("div",{style:{...H.v.permissionStyle,...H.v.addedStyle,marginTop:3,marginBottom:3}},void 0,n()("div",{},void 0,this.renderPermissionTarget(e)),n()("div",{},void 0,this.renderPermissionRole(e.permission_data)))}renderPermissionDeleted(e){return n()("div",{style:{...H.v.permissionStyle,...H.v.deletedStyle}},void 0,n()("div",{},void 0,this.renderPermissionTarget(e)),n()("div",{},void 0,this.renderPermissionRole(e.permission_data)))}renderPermissionChanged(e){return n()("div",{style:H.v.permissionStyle},void 0,n()("div",{},void 0,this.renderPermissionTarget(e)),n()("div",{},void 0,n()("div",{style:H.v.diffWrapStyle},void 0,this.renderPermissionRole(e.permission_data.before),n()("div",{style:{padding:"0px 8px"}},void 0,(0,w.s)({width:14,height:14})),this.renderPermissionRole(e.permission_data.after))))}renderPermissionInheritanceChanged(e){var t;return((null===(t=e.permission_data)||void 0===t?void 0:t.calculated_changes)||[]).map(((t,r)=>{let[o,i]=t;const a={timestamp:e.timestamp,space_id:e.space_id,type:"permission-changed",permission_data:{before:o,after:i}};return n()(s.Fragment,{},`inheritance-change-${r}`,this.renderPermissionChanged(a))}))}renderPermissionGroupCreated(e){const t=e.permission_group_data.user_ids||[],r=B.oA(t.map((e=>this.getRecordValue({table:Z.KJ,id:e}))));if(0!==r.length)return n()("div",{},void 0,r.map((e=>n()("div",{style:{...H.v.groupStyle,...H.v.addedStyle,marginTop:3,marginBottom:3}},e.id,(0,G.Nz)(this.props.intl,e)))))}renderPermissionGroupDeleted(e){const t=e.permission_group_data.user_ids||[],r=B.oA(t.map((e=>this.getRecordValue({table:Z.KJ,id:e}))));if(0!==r.length)return n()("div",{},void 0,r.map((e=>n()("div",{style:{...H.v.groupStyle,...H.v.deletedStyle}},e.id,(0,G.Nz)(this.props.intl,e)))))}renderPermissionGroupChanged(e){const t=e.permission_group_data.before.user_ids||[],r=e.permission_group_data.after.user_ids||[],o=(0,C.E)(t,r),i=B.oA(o.created.map((e=>this.getRecordValue({table:Z.KJ,id:e})))),a=B.oA(o.deleted.map((e=>this.getRecordValue({table:Z.KJ,id:e}))));if(0!==i.length||0!==a.length)return n()("div",{},void 0,i.map((e=>n()("div",{style:{...H.v.groupStyle,...H.v.addedStyle,marginTop:3,marginBottom:3}},e.id,(0,G.Nz)(this.props.intl,e)))),a.map((e=>n()("div",{style:{...H.v.groupStyle,...H.v.deletedStyle}},e.id,(0,G.Nz)(this.props.intl,e)))))}renderPermissionRole(e){const t=e.role??"none",r=(0,D.kD)(t,void 0);return r?n()("div",{style:H.v.getRoleStyle()},void 0,this.props.intl.formatMessage(r)):void 0}renderPermissionTarget(e){const t="permission-changed"===e.type?e.permission_data.after:e.permission_data;if((0,E.jg)(t)){const e=this.getRecordValue({table:Z.KJ,id:t.user_id}),r=(0,G.Nz)(this.props.intl,e);return n()("div",{style:H.v.permissionTypeWrapStyle},void 0,n()("div",{style:H.v.getUserHeaderStyle(this.theme)},void 0,r))}if((0,E.ix)(t)){const t=this.getRecordValue({table:V.bx,id:e.space_id}),r=t?t.name:n()(L.FormattedMessage,{defaultMessage:"Unknown",id:"edit.unknownSpacePermissionTarget.label"});return n()("div",{style:H.v.permissionTypeWrapStyle},void 0,n()("div",{style:H.v.getUserHeaderStyle(this.theme)},void 0,r))}if((0,E.$D)(t))return n()("div",{style:H.v.permissionTypeWrapStyle},void 0,n()("div",{style:H.v.getUserHeaderStyle(this.theme)},void 0,n()(L.FormattedMessage,{defaultMessage:"Published link",id:"edit.publishToWebPermissionTarget.label"})));if((0,E.hV)(t)){const r=this.getRecordValue({table:V.bx,id:e.space_id}),o=(r&&r.permission_groups||[]).find((e=>e.id===t.group_id)),i=o&&o.name||n()(L.FormattedMessage,{defaultMessage:"Deleted group",id:"edit.deletedPermissionGroup.label"});return n()("div",{style:H.v.permissionTypeWrapStyle},void 0,n()("div",{style:H.v.getUserHeaderStyle(this.theme)},void 0,i))}if((0,E.FB)(t)){const r=this.getRecordValue({table:I.cZ,id:t.bot_id,spaceId:e.space_id}),o=(0,g.Mh)(r);return n()("div",{style:H.v.permissionTypeWrapStyle},void 0,n()("div",{style:H.v.getUserHeaderStyle(this.theme)},void 0,o))}if((0,E.zU)(t)){const r=this.getRecordValue({table:R.e0,id:t.team_id,spaceId:e.space_id});let o=n()(L.FormattedMessage,{defaultMessage:"Members of an unknown teamspace",id:"edit.teamMemberPermissionChanged.unknownTeam"});return null!=r&&r.name&&(o=n()(L.FormattedMessage,{defaultMessage:"Members of {teamName}",id:"edit.teamMemberPermissionChanged.knownTeam",values:{teamName:r.name}})),n()("div",{style:H.v.permissionTypeWrapStyle},void 0,n()("div",{style:H.v.getUserHeaderStyle(this.theme)},void 0,o))}if((0,E.LW)(t)){const r=this.getRecordValue({table:R.e0,id:t.team_id,spaceId:e.space_id});let o=n()(L.FormattedMessage,{defaultMessage:"Owners of an unknown teamspace",id:"edit.teamOwnerPermissionChanged.unknownTeam"});return null!=r&&r.name&&(o=n()(L.FormattedMessage,{defaultMessage:"Owners of {teamName}",id:"edit.teamOwnerPermissionChanged.knownTeam",values:{teamName:r.name}})),n()("div",{style:H.v.permissionTypeWrapStyle},void 0,n()("div",{style:H.v.getUserHeaderStyle(this.theme)},void 0,o))}}renderCommentCreatedEdit(e){const{edit:t,discussionLocation:r,hideAuthorName:o}=e,i=this.getRecordValue({table:x.x_,id:t.comment_id,spaceId:t.space_id}),a=Boolean(t.comment_data&&i&&(0,b.P)(T.kk.fromValue(x.x_,t.comment_data),T.kk.fromValue(x.x_,i)));if(i)return n()("div",{style:H.v.wrapStyle},void 0,this.renderComment({commentValue:i,discussionLocation:r,showEditedBadge:a,hideAuthorName:o}))}renderCommentChangedEdit(e){return n()("div",{style:H.v.wrapStyle},void 0,this.renderCommentDiff(e.comment_data))}renderCommentDeletedEdit(e,t){const r=this.getRecordValue({table:x.x_,id:e.comment_id,spaceId:e.space_id}),o=e.comment_data||r;if(o)return n()("div",{style:{...H.v.wrapStyle,...H.v.deletedStyle}},void 0,this.renderComment({commentValue:o,discussionLocation:t,showEditedBadge:!1,hideAuthorName:!1}))}renderCollectionPropertyChangedEdit(e){const t=this.renderCollectionPropertyChangedDiff(e.collection_property_data);return t?n()("div",{style:{...H.v.wrapStyle,paddingTop:6,paddingBottom:4}},void 0,t):null}renderCollectionChangedEdit(e){return n()("div",{style:H.v.wrapStyle},void 0,this.renderCollectionDescriptionChangedDiff(e.space_id,e.collection_data))}renderCollectionCreatedEdit(e){var t;const r=null===(t=e.collection_data)||void 0===t?void 0:t.description;return n()("div",{style:H.v.wrapStyle},void 0,this.renderCollectionDescriptionCreatedDiff(r&&{value:r,spaceId:e.space_id}))}renderMentionCreated(e){return this.renderBlockOrProperty({blockId:e.mentioned_block_id,property:e.mentioned_property})}renderPermissionGroupMentionCreated(e){return this.renderBlockOrProperty({blockId:e.mentioned_block_id,property:e.mentioned_property})}renderReminderCreated(e){return this.renderBlockOrProperty({blockId:e.reminder_block_id,property:e.reminder_property})}renderBlockOrProperty(e){const t=this.getRecordValue({table:P.iU,id:e.blockId});if(t){const o=(0,_.ky)({block:t,getRecordValue:this.getRecordValue});if(o){const r=f.oC(o),i=this.renderBlockProperty(t,e.property,!0,r);if(i)return n()("div",{style:{...H.v.wrapStyle}},void 0,i)}else{var r;const e=null===(r=t.properties)||void 0===r?void 0:r.title,o={...t,properties:{...t.properties,title:this.props.highlightCurrentUser&&e?this.highlightCurrentUserMentions(e):e}},i=n()(j.ZP,{blockValue:o,rootStore:this.props.rootStore});if(i)return n()("div",{style:H.v.wrapStyle},void 0,i)}}}highlightCurrentUserMentions(e){const t=[],r=this.environment.currentUser;return A.lzi(e).forEach((e=>{if(A.km_(e)){const o=[];for(const t of A.hn0(e)){const e=A.IWo(t)&&t[1]===r.id,i=A._bk(t)&&this.currentUserIsMemberOfGroup(t[1],t[2]);e||i?(o.push(t),o.push([A.GKr.Highlight,"yellow_background"])):o.push(t)}t.push([e[0],o])}else t.push(e)})),t}currentUserIsMemberOfGroup(e,t){var r;const o=this.environment.currentUser.id;if(!o)return!1;const i=this.getRecordValue({table:V.bx,id:t});return new Set(null==i||null===(r=i.permission_groups)||void 0===r||null===(r=r.find((t=>t.id===e)))||void 0===r?void 0:r.user_ids).has(o)}getBlockSchema(e){return e.block_schema?f.a5(e):f.Kc(this.props.intl)}getCodeTitle(e){const t=e&&e.properties&&e.properties.language;if(!t)return n()(L.FormattedMessage,{defaultMessage:"Code",id:"edit.codeBlockChanged.label"});const r=v.Sj(t,f.fG);return n()(L.FormattedMessage,{defaultMessage:"Code - {codeLanguage}",values:{codeLanguage:r},id:"edit.codeBlockWithLanguageChanged.label"})}getSource(e){const t=e&&e.properties&&e.properties.source;return v.zB(t)}hasProperty(e,t){return Boolean(e&&e.properties&&e.properties[t])}propertyChanged(e,t){return!B.Xy(e.block_data.before.block_value&&e.block_data.before.block_value.properties&&e.block_data.before.block_value.properties[t],e.block_data.after.block_value&&e.block_data.after.block_value.properties&&e.block_data.after.block_value.properties[t])}}re.displayName="Edit";const oe=(0,L.injectIntl)(re)},90706:(e,t,r)=>{r.d(t,{Z:()=>M});var o=r(23174),i=r.n(o),a=(r(57658),r(67294)),n=r(86628),s=r(24405),d=r(80951),l=r(14215),c=(r(30541),r(21703),r(67266)),p=r.n(c),u=r(5242),m=r.n(u),h=r(15095),g=r(72126),f=r(70203),v=r(97880);let y=function(e){return e[e.removed=-1]="removed",e[e.added=1]="added",e[e.same=0]="same",e}({});function b(e){const{before:t,after:r}=e,o={count:0,encoding:{},decoding:{},annotationEncoding:{},annotationDecoding:{}},i=e=>{const t=o.encoding[e];if(t)return t;{const t=String.fromCharCode(o.count);return o.count++,o.encoding[e]=t,o.decoding[t]=e,t}},a=e=>{const t=p()(e),r=o.annotationEncoding[t];if(r)return r;{const r=String.fromCharCode(o.count);return o.count++,o.annotationEncoding[t]=r,o.annotationDecoding[r]=e,r}},n=e=>g.xH(f.lzi(e).map((e=>{const t=h.p4(e[0]).map(i);if(f.km_(e)){const r=f.hDy(e),o=f.I$B(r);o&&(t[0]=a({type:"mention",value:o}),r.forEach((e=>{f.ZAl(e)||f.kuv(e)||f.QVC(e)||(t.unshift(a({type:"start",value:e})),t.push(a({type:"end",value:e})))})))}else if(f.YrK(e)){const r=f.hDy(e),o=f.Ap(r);if(o){t[0]=a({type:"equation",value:o});for(const e of r)f.ZAl(e)||f.kuv(e)||f.QVC(e)||(t.unshift(a({type:"start",value:e})),t.push(a({type:"end",value:e})))}}else if(f.AJd(e)){f.hDy(e).forEach((e=>{t.unshift(a({type:"start",value:e})),t.push(a({type:"end",value:e}))}))}return t}))).join("");if(o.count>65535)throw new Error("This string has way too many different characters.");const s=function(e,t){const r=new(m())({timeout:2,editCost:6}),o=r.main(t,e);return r.cleanupSemantic(o),o}(n(r),n(t)),d=[];let l=[];return s.forEach((e=>{let[t,r]=e;r.split("").forEach((e=>{if(o.decoding[e]){const r=o.decoding[e];t===y.added?d.push([r,[...l,["+"]]]):t===y.removed?d.push([r,[...l,["-"]]]):t===y.same&&d.push([r,l])}else{const r=o.annotationDecoding[e];if(t===y.added)if("mention"===r.type)d.push([f.qyI,[...l,["+"],r.value]]);else if("start"===r.type)l=[...l,r.value];else if("end"===r.type)l=l.filter((e=>!g.Xy(e,r.value)));else if("equation"===r.type){const e=f.xey(r.value),t=f.qZ6(e,[...l,["+"]]);d.push(t)}else(0,v.t1)(r);else if(t===y.removed){if("mention"===r.type)d.push([f.qyI,[...l,["-"],r.value]]);else if("equation"===r.type){const e=f.xey(r.value),t=f.qZ6(e,[...l,["-"]]);d.push(t)}}else if(t===y.same)if("mention"===r.type)d.push([f.qyI,[...l,r.value]]);else if("start"===r.type)l=[...l,r.value];else if("end"===r.type)l=l.filter((e=>!g.Xy(e,r.value)));else if("equation"===r.type){const e=f.xey(r.value),t=f.qZ6(e,l);d.push(t)}else(0,v.t1)(r)}}))})),f.Zxt(d)}const k=(0,r(45238).I)("arrowRightSmaller",{viewBox:"0 0 16 16",svg:i()("path",{d:"M15.383 8.352a.877.877 0 01-.274.64l-5.156 5.14a.864.864 0 01-.617.266.831.831 0 01-.602-.234.795.795 0 01-.234-.586c0-.12.02-.232.063-.336a.912.912 0 01.187-.273l1.75-1.766 2.914-2.656.274.5-2.711.156H1.484c-.26 0-.471-.078-.632-.234a.851.851 0 01-.235-.617c0-.256.078-.461.235-.618a.856.856 0 01.632-.242h9.493l2.71.164-.273.508L10.5 5.5 8.75 3.727a.946.946 0 01-.188-.266.917.917 0 01-.062-.344c0-.234.078-.43.234-.586a.831.831 0 01.602-.234.79.79 0 01.328.07c.104.047.203.117.297.211l5.148 5.133a.877.877 0 01.274.64z"})});var C=r(21202),S=r(57559),_=r(14200);function M(e){const t=e.propertySchema.type;switch(t){case"title":case"text":return a.createElement(w,e);case"relation":return i()(B,{propertySchema:e.propertySchema,beforeValue:e.beforeValue,afterValue:e.afterValue,rootStore:e.rootStore});case"checkbox":case"number":case"person":case"file":case"url":case"email":case"phone_number":case"created_time":case"created_by":case"last_edited_time":case"last_edited_by":case"last_visited_time":case"formula":case"rollup":case"select":case"multi_select":case"date":case"button":case"status":case"auto_increment_id":case"location":case"verification":return a.createElement(T,e);default:(0,v.t1)(t)}}function w(e){const t={value:b({before:e.beforeValue.value,after:e.afterValue.value}),spaceId:e.beforeValue.spaceId};return i()(_.Z,{value:t,propertySchema:e.propertySchema,rootStore:e.rootStore})}function B(e){window.__c={n:"RelationPropertyDiff"};const{beforeValue:t,afterValue:r,propertySchema:o,rootStore:a}=e,s=(0,n.VK)((()=>{const e=(0,d.rq)(t.value),i=(0,d.rq)(r.value),n=(0,l.N)(e,i,(e=>`${e.id}${e.table}`)),s=new Set(d.j$({relationValue:n.created,getRecordModel:a.getRecordModel,propertySchema:o})),c=new Set(d.j$({relationValue:n.deleted,getRecordModel:a.getRecordModel,propertySchema:o})),p=[...s,...c];return p.flatMap(((e,t)=>{const r=S.G.createChildStore(a,{table:C.iU,id:e.id}).getPropertyValue("title")||[],o=[],i=f.lzi(r);for(const a of i)if(f.QJH(a)){const t=s.has(e)?"+":"-",r=[a[0],[[t]]];o.push(r)}else o.push(a);return t<p.length-1&&o.push(f.V3y("\n")),o}))}),[t,r,o,a]);return i()(_.Z,{value:{value:s,spaceId:t.spaceId},propertySchema:{type:"title",name:"Title"},rootStore:a})}function T(e){window.__c={n:"ArrowPropertyDiff"};const t=(0,s.yK)((()=>({arrowDiffWrap:{display:"inline-flex",alignItems:"center"}})),[]);return i()("div",{style:t.arrowDiffWrap},void 0,i()(_.Z,{value:e.beforeValue,propertySchema:e.propertySchema,rootStore:e.rootStore}),i()(D,{}),i()(_.Z,{value:e.afterValue,propertySchema:e.propertySchema,rootStore:e.rootStore}))}function D(){window.__c={n:"Arrow"};const e=(0,s.yK)((e=>({container:{padding:"0px 8px"},icon:{width:15,height:15,fill:e.mediumIconColor}})),[]);return i()("div",{style:e.container},void 0,k(e.icon))}},24764:(e,t,r)=>{r.d(t,{t0:()=>B,Zk:()=>M,CA:()=>_});var o=r(10434),i=r.n(o),a=r(23174),n=r.n(a),s=r(67294),d=r(45433),l=r(98519),c=r(97880),p=r(5366),u=r(62967),m=r(57883),h=r(50906),g=r(9953),f=r(39699);function v(e){const{environment:t,key:r,selectedKey:o,following:i,followSettings:a,navigableBlockId:n,userId:s,spaceId:d,from:l}=e;f.createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{g.Ue({environment:e.environment,table:m.t0,args:{following:i,followSettings:a,navigableBlockId:n,userId:s,spaceId:d},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),i?h.RJe(t,{from:"page_updates"}):h.ubm(t,{from:"page_updates"}),o!==r&&h.kLN(t,{from:l,navigableBlockId:n,oldSetting:o,newSetting:r})}var y=r(64964),b=r(93405),k=r(64369),C=r(80444),S=r(57538);function _(e){const{followSettingsKey:t,environment:r,blockStore:o,from:i,useCopyChanges:a}=e,s=w({key:"none",selectedKey:t,title:n()(p.FormattedMessage,a?{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}:{id:"GetNotifiedDropdown.mentionsAndReplies.label",defaultMessage:"Only replies and @mentions"}),environment:r,blockStore:o,from:i}),l=w({key:"comments",selectedKey:t,title:n()(p.FormattedMessage,a?{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}:{id:"GetNotifiedDropdown.allUpdatesComments.label",defaultMessage:"All updates"}),caption:a?void 0:n()(p.FormattedMessage,{id:"GetNotifiedDropdown.allComments.caption",defaultMessage:"All comments and @mentions"}),environment:r,blockStore:o,from:i}),c=w({key:"all",selectedKey:t,title:n()(p.FormattedMessage,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:n()(p.FormattedMessage,a?{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}:{id:"GetNotifiedDropdown.allUpdates.caption",defaultMessage:"All comments, @mentions, and property changes"}),environment:r,blockStore:o,from:i}),u=o.getAssociatedCollectionStore();if(!u)return[l,s];const m=u.getDatabaseType();if(m===d.GL.tasks){return[c,w({key:"important",selectedKey:t,title:n()(p.FormattedMessage,a?{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesTasks.label",defaultMessage:"Only important updates"}),caption:n()(p.FormattedMessage,a?{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesTasks.caption",defaultMessage:"All comments, @mentions, and changes to Status, Assignee, or Due Date"}),environment:r,blockStore:o,from:i}),s]}if(m===d.GL.projects){return[c,w({key:"important",selectedKey:t,title:n()(p.FormattedMessage,a?{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesProjects.label",defaultMessage:"Only important updates"}),caption:n()(p.FormattedMessage,a?{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesProjects.caption",defaultMessage:"All comments, @mentions, and changes to Status or Date"}),environment:r,blockStore:o,from:i}),s]}return[c,w({key:"comments",selectedKey:t,title:n()(p.FormattedMessage,a?{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}:{id:"GetNotifiedDropdown.onlyComments.label",defaultMessage:"Only comments"}),caption:a?void 0:n()(p.FormattedMessage,{id:"GetNotifiedDropdown.onlyComments.caption",defaultMessage:"All comments and @mentions"}),environment:r,blockStore:o,from:i}),s]}function M(e){const{followSettingsKey:t,environment:r,blockStore:o,from:i}=e;return[w({key:"important",selectedKey:t,title:n()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.label",defaultMessage:"All comments"}),caption:n()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.caption",defaultMessage:"Notified of all comments and @mentions"}),environment:r,blockStore:o,from:i}),w({key:"none",selectedKey:t,title:n()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.label",defaultMessage:"Replies and @mentions"}),caption:n()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.caption",defaultMessage:"Notified of comment replies and @mentions"}),environment:r,blockStore:o,from:i})]}function w(e){const{key:t,title:r,caption:o,selectedKey:a,environment:d,blockStore:c,from:p}=e,m=B({key:t,userSelectedKey:a}),h={icon:{width:14,height:14},rightWrapper:o?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,u.cN)({key:t,displayName:void 0,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=C.default.state;if(e){const{following:r,followSettings:o}=(0,S.Z)(t),i=e.id,n=c.id,s=c.getSpaceId();v({environment:d,following:r,followSettings:o,navigableBlockId:n,spaceId:s,userId:i,from:p,key:t,selectedKey:a}),"inbox"!==p&&"more_menu"!==p||y.d4({item:{label:T(t)},undoFunc:()=>{const{following:e,followSettings:r}=(0,S.Z)(a);v({environment:d,following:e,followSettings:r,navigableBlockId:n,spaceId:s,userId:i,from:p,key:t,selectedKey:a})}})}},render:e=>s.createElement(b.Z,i()({},e,{title:n()(k.Z,{},void 0,r),caption:o,shouldWrapCaption:!0,right:m?(0,l.k)(h.icon):n()("div",{style:h.icon}),rightStyle:h.right}))}),title:r,isSelectedOption:m}}function B(e){const{key:t,userSelectedKey:r}=e;return"important"===r||"comments"===r?"important"===t||"comments"===t:t===r}function T(e){switch(e){case"none":return n()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return n()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return n()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return n()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,c.t1)(e)}}},46096:(e,t,r)=>{r.d(t,{Z:()=>a});var o=r(49085);class i extends o.default{getInitialState(){return{open:!1}}}const a=new i},90334:(e,t,r)=>{r.d(t,{O:()=>a});var o=r(23174),i=r.n(o);r(67294);const a=(0,r(45238).I)("ellipsis",{viewBox:"0 0 16 16",svg:i()("path",{d:"M2.887 9.014c.273 0 .52-.064.738-.192.219-.132.394-.307.526-.526.133-.219.199-.46.199-.725 0-.405-.142-.747-.424-1.025a1.41 1.41 0 00-1.04-.417c-.264 0-.505.066-.724.198a1.412 1.412 0 00-.718 1.244c0 .265.064.506.192.725.132.219.307.394.526.526.219.128.46.192.725.192zm5.113 0a1.412 1.412 0 001.244-.718c.132-.219.198-.46.198-.725 0-.405-.14-.747-.423-1.025A1.386 1.386 0 008 6.129c-.264 0-.506.066-.725.198a1.412 1.412 0 00-.718 1.244c0 .265.064.506.192.725.132.219.308.394.526.526.22.128.46.192.725.192zm5.106 0c.265 0 .506-.064.725-.192.219-.132.394-.307.526-.526.133-.219.199-.46.199-.725 0-.405-.142-.747-.424-1.025a1.394 1.394 0 00-1.026-.417 1.474 1.474 0 00-1.265.718c-.127.218-.19.46-.19.724 0 .265.063.506.19.725.133.219.308.394.527.526.223.128.47.192.738.192z"})})}}]);