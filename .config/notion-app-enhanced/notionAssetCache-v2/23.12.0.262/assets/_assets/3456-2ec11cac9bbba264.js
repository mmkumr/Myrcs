"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[3456],{3553:(e,t,o)=>{o.d(t,{Z:()=>de});o(67294);var n=o(73935),i=o(83355),s=o(18466),r=o(1302),l=o(86628),a=o(24405),c=o(8848),d=o(72126),h=o(45264),u=o(99553),p=o(52989),v=o(24677),m=o(98104),b=o(39699),f=o(84064),C=o(43250),g=o(12534),S=o(39500),w=o(16339),x=o(41662),M=o(69784),k=o(50628),A=o(27724),y=o(4827),Z=o(86486),T=o(23063),j=o(9612),R=o(51454),I=o(28020),L=o(73744),B=o(17504),D=o(77546),E=o(439),H=o(38755),O=o(95802),P=o(47453),z=o(31412),V=o(50906),N=o(42858),_=o(84084),F=o(28314),G=o(65598),U=o(64921),K=o(26388),W=o(65200),J=o(85893);const q=(0,z.defineMessages)({ariaLabelApple:{id:"block.selectableAddMenu.ariaLabel.apple",defaultMessage:"Click to add below. Option-click to add a block above"},ariaLabelWindows:{id:"block.selectableAddMenu.ariaLabel.windows",defaultMessage:"Click to add below. Alt-click to add a block above"}});class X extends i.Z{constructor(){super(...arguments),this.renderTooltip=()=>{const e={color:this.theme.mediumInvertedTextColor};return(0,J.jsxs)("div",{style:{textAlign:"center"},children:[(0,J.jsx)(z.FormattedMessage,{defaultMessage:"Click <mediumcolor>to add below</mediumcolor>",id:"block.selectableAddMenu.tooltip.addBlockBelow",values:{mediumcolor:t=>(0,J.jsx)("span",{style:e,children:t})}}),(0,J.jsx)("div",{children:this.environment.device.isApple?(0,J.jsx)(z.FormattedMessage,{defaultMessage:"Option-click <mediumcolor>to add above</mediumcolor>",id:"block.selectableAddMenu.tooltip.addAbove",values:{mediumcolor:t=>(0,J.jsx)("span",{style:e,children:t})}}):(0,J.jsx)(z.FormattedMessage,{defaultMessage:"Alt-click <mediumcolor>to add a block above</mediumcolor>",id:"block.selectableAddMenu.tooltip.addAbove.windows",values:{mediumcolor:t=>(0,J.jsx)("span",{style:e,children:t})}})})]})},this.handleClick=()=>{const{environment:e}=this,{store:t}=this.props,o=F.lF.state.option,n=O.C.findSelectablesFromStore(t).find((e=>Boolean(e.props.onInsertRowBelow)));o?n&&n.props.onInsertRowAbove?b.createAndCommit({userAction:"SelectableAddMenu.handleClick.onInsertRowBelow",environment:e,perform:e=>{n.props.onInsertRowAbove&&n.props.onInsertRowAbove({transaction:e})}}):b.createAndCommit({environment:e,userAction:"SelectableAddMenu.handleClick.addAbove",perform:o=>{N.uE({environment:e,blocks:[t],transaction:o})}}):G.PF(t)?_.hb({environment:e,blockStore:t}):n&&n.props.onInsertRowBelow?b.createAndCommit({userAction:"SelectableAddMenu.handleClick.onInsertRowBelow",environment:e,perform:e=>{n.props.onInsertRowBelow&&n.props.onInsertRowBelow({transaction:e})}}):b.createAndCommit({environment:e,userAction:"SelectableAddMenu.handleClick.addBelow",perform:o=>{N.ZJ({environment:e,blocks:[t],transaction:o})}}),V.eT_(this.environment),Z.default.reset()}}renderComponent(){const{device:e}=this.environment;if(!e.isPhone)return(0,J.jsx)(K.Z,{placement:K.Z.Placement.Bottom,delayThreshold:300,renderTooltip:this.renderTooltip,render:e=>(0,J.jsx)(U.Z,{disallowTabbing:!0,onClick:this.handleClick,style:this.getStyle(),ariaLabel:this.props.intl.formatMessage(this.environment.device.isApple?q.ariaLabelApple:q.ariaLabelWindows),...e,children:(0,P.R)({width:16})})})}getStyle(){const e=(0,E.zt)(this.props.offsetTop,this.props.store),t=(0,E.tx)(this.environment,24+X.rightMargin+W.Z.width,this.props.store);return{display:"flex",alignItems:"center",justifyContent:"center",fill:this.theme.lightIconColor,position:"absolute",top:e,left:-t,width:24,height:24,borderRadius:4,pointerEvents:"auto",cursor:"-webkit-grab"}}}X.displayName="SelectableAddMenu",X.rightMargin=2;const Y=(0,z.injectIntl)(X);var $=o(95855),Q=o(18821),ee=o(73063);class te extends i.Z{constructor(){super(...arguments),this.handleClick=e=>{Q.yw({environment:this.environment,blockStore:this.props.store})}}renderComponent(){const{device:e}=this.environment,{mediumInvertedTextColor:t}=this.theme;if(!e.isMobile)return(0,J.jsx)("div",{style:this.getStyle(),onMouseDown:g.$0,children:(0,J.jsx)(K.Z,{placement:K.Z.Placement.Bottom,delayThreshold:300,renderTooltip:()=>(0,J.jsx)(z.FormattedMessage,{defaultMessage:"Click <invertedcolor>to add a comment</invertedcolor>",id:"selectableCommentMenu.addCommentPrompt.tooltip",values:{invertedcolor:e=>(0,J.jsx)("span",{style:{color:t},children:e})}}),render:e=>(0,J.jsx)(ee.Z,{disallowTabbing:!0,icon:$.z,onClick:this.handleClick,...e})})})}getStyle(){const e=this.props.shouldOffsetLeft?(0,E.tx)(this.environment,te.itemSize+te.rightMargin+W.Z.width,this.props.store):32;return{position:"absolute",top:this.props.offsetTop,left:-e}}}te.displayName="SelectableCommentMenu",te.itemSize=24,te.rightMargin=2;const oe=te;class ne extends i.Z{constructor(){super(...arguments),this.verticalScrollableAncestor=void 0,this.horizontalScrollableAncestor=void 0,this.isCommentMenu=!1,this.showHoverMenu=!1,this.disableHoverMenuDrag=!1,this.targetSelectableStore=this.createComputedStore((()=>{const{target:e}=this.props;return O.C.findSelectablesFromStore(e).find((e=>Boolean(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)))})),this.targetRectStore=this.createComputedStore((()=>{var e;return null===(e=this.targetSelectableStore.state)||void 0===e||null===(e=e.getNode())||void 0===e?void 0:e.getBoundingClientRect()})),this.handleScroll=()=>{this.targetRectStore.enqueueRecompute()}}willMount(e){super.willMount(e);const t=this.targetSelectableStore.state;if(!t)return;this.isCommentMenu=Boolean(t.props.shouldShowCommentMenu),this.showHoverMenu=Boolean(t.props.shouldShowHoverMenu);const o=t.getNode();o&&(this.verticalScrollableAncestor=(0,D.VW)(o),this.verticalScrollableAncestor&&(0,L.lj)(this.verticalScrollableAncestor,"scroll",this.handleScroll),this.horizontalScrollableAncestor=(0,D.xH)(o),this.horizontalScrollableAncestor&&this.horizontalScrollableAncestor!==this.verticalScrollableAncestor&&(0,L.lj)(this.horizontalScrollableAncestor,"scroll",this.handleScroll),this.handleScroll())}willUnmount(){super.willUnmount(),this.verticalScrollableAncestor&&(0,L.ZV)(this.verticalScrollableAncestor,"scroll",this.handleScroll),this.horizontalScrollableAncestor&&(0,L.ZV)(this.horizontalScrollableAncestor,"scroll",this.handleScroll)}renderComponent(){var e;const{target:t,container:o}=this.props,n=o?o.getBoundingClientRect():void 0,i=this.targetRectStore.state,s=i?i.top-(n?n.top:0):void 0,r=i?i.left-(n?n.left:0):void 0,l=(0,H.Fn)(this.environment),a="editor"===this.props.target.getRole()||"read_and_write"===this.props.target.getRole()||"edit"===(null===(e=this.pageContext)||void 0===e||null===(e=e.publicEditModeStore.state)||void 0===e?void 0:e.permission),c="external_object_instance_page"===t.getType(),d=!!this.pageContext&&(0,I.qG)(this.pageContext.pageStore.id);return(0,B.Z)((e=>{var o;return(0,J.jsxs)("div",{style:{position:"absolute",left:r,top:s,zIndex:R.Mo},...e,children:[this.isCommentMenu&&!t.isNavigableAncestorLocked()&&(0,J.jsx)(oe,{store:t,offsetTop:(0,E.oJ)(t),shouldOffsetLeft:this.showHoverMenu||l}),this.showHoverMenu&&(0,J.jsx)(W.Z,{store:t,offsetTop:(0,E.oJ)(t),disableDrag:this.disableHoverMenuDrag,isWorkspaceAdmin:l,hasEditorPermissions:a}),(!t.isNavigableAncestorLocked()||"collection"===(null===(o=t.getParentStore())||void 0===o?void 0:o.table))&&!this.isCommentMenu&&a&&!c&&!d&&(0,J.jsx)(Y,{store:t,offsetTop:(0,E.oJ)(t)})]})}))}}ne.displayName="SelectableHoverMenuOverlayItem";const ie=ne;class se extends i.Z{constructor(){super(...arguments),this.container=void 0,this.targetStore=this.createComputedStore((()=>{const e=Z.default.state;if(e.isOpen&&e.container===this.props.selectableContainer)return e.currentStore})),this.handleContainerMount=e=>{e&&(this.container=e)}}renderComponent(){return(0,J.jsx)("div",{style:se.containerStyle,ref:this.handleContainerMount,children:(0,J.jsx)(j.Z,{render:()=>d.oA([this.renderCurrentTarget()])})})}renderCurrentTarget(){const e=this.targetStore.state;if(e)return(0,J.jsx)(T.Z,{isVisible:!0,animationStyle:{opacity:1},enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,J.jsx)(ie,{container:this.container,target:e})},e.id)}}se.displayName="SelectableHoverMenuOverlay",se.containerStyle={position:"absolute",top:0,left:0};const re=se;class le extends i.Z{constructor(){super(...arguments),this.observer=void 0,this.handleMouseDown=e=>{const{device:t}=this.environment;this.props.disableRectangularSelection||(t.isPhone?(0,g.ZP)({event:e,context:g.Af.EditorMouseDown,callback:()=>{v.ZH(this.environment),h.wG(),x.HM.clearSelection()}}):(0,g.ZP)({event:e,context:g.Af.EditorMouseDown,callback:()=>{1!==e.button&&(e.preventDefault(),p.AI({environment:this.environment,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1}))}}))},this.handleClick=e=>{(function(e){return k.Z.hasBeenUpdatedSince(e.timeStamp)})(e)||this.props.store.canEdit()&&(0,g.ZP)({event:e,context:g.Af.EditorClick,callback:()=>{var t;if(null!==(t=A.default.getDefaultContainerFromTarget(e.target))&&void 0!==t&&t.isPeekRenderer()||u.E5(this.environment),!S.X9()&&!this.props.disableEditNearestBlock){const{clientX:t,clientY:o,target:n}=e;r.default.afterNextFlush((()=>{b.createAndCommit({userAction:"SelectableContainer.click",environment:this.environment,perform:e=>m.jh(this.environment,{x:t,y:o,target:n instanceof Element?n:void 0},e)})}))}}})},this.shouldRenderRectangularSelectionRectStore=this.createComputedStore((()=>Boolean(M.Z.state.isActive&&M.Z.state.defaultContainer===this)))}get registries(){return[w.Z]}didMount(){if(super.didMount(),this.props.isDefaultContainer){const e=this.props.isRootContainer?d.G0([this],A.default.state.defaultContainerStack||[]):d.G0(A.default.state.defaultContainerStack||[],[this]);A.default.setState({...A.default.state,defaultContainerStack:e,pivot:void 0,anchor:void 0,anchorContainer:void 0})}if(this.props.droppable){const e=this.props.isRootContainer?d.G0([this],A.default.state.droppableContainerStack||[]):d.G0(A.default.state.droppableContainerStack||[],[this]);A.default.setState({...A.default.state,droppableContainerStack:e})}v.Jy();const e=n.findDOMNode(this);e&&(this.observer=new MutationObserver(ae),this.observer.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))}willUnmount(){if(super.willUnmount(),this.props.isDefaultContainer){const e=d.zu(A.default.state.defaultContainerStack||[],this);A.default.setState({...A.default.state,defaultContainerStack:e,pivot:void 0,anchor:void 0,anchorContainer:void 0})}if(this.props.droppable){const e=d.zu(A.default.state.droppableContainerStack||[],this);A.default.setState({...A.default.state,droppableContainerStack:e})}this.observer&&this.observer.disconnect()}renderComponent(){var e;const{render:t}=this.props;return(0,J.jsx)(f.ld,{value:{selectableContainer:this,closestSelectable:null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable},children:(0,J.jsx)(y.Z,{open:this.shouldRenderRectangularSelectionRectStore.state,origin:t({selectableEvents:{onMouseDown:this.handleMouseDown,onClick:this.handleClick},selectableHoverMenuOverlay:(0,J.jsx)(re,{selectableContainer:this})}),children:(0,J.jsx)(ce,{isDefaultContainer:this.props.isDefaultContainer})})})}isPeekRenderer(){return this.props.isPeekRenderer}}le.displayName="SelectableContainer",le.contextTypes={...f.Tf,...i.w};const ae=e=>{let t=!0;if(e.length<=10){const{selectableElementRectMap:o}=s.Z.withListenerIgnored((()=>k.Z.getState()));t=e.some((e=>function(e,t){const o=t.target instanceof Element?t.target:t.target.parentElement;if(!o)return!0;const n=o.closest(`.${C.euV}`);if(!n)return!0;const i=e.get(n);if(!i)return!0;const s=n.getBoundingClientRect();return!(i.x===s.x&&i.y===s.y&&i.width===s.width&&i.height===s.height)}(o,e)))}t&&v.Ch()};function ce(e){window.__c={n:"RectangularSelectionRect"};const{isDefaultContainer:t}=e,{currentRect:o,isActive:n,showSelectionRect:i}=(0,l.VK)((()=>M.Z.state.isActive?M.Z.state:{currentRect:void 0,isActive:!1,showSelectionRect:!1}),[]),s=(0,a.yK)((()=>({selection:{position:"absolute",pointerEvents:"none",backgroundColor:c.ZP.blueWithAlpha(.14),border:"1px solid transparent",left:null==o?void 0:o.left,top:null==o?void 0:o.top,width:o?o.right-o.left:0,height:o?o.bottom-o.top:0}})),[o]);return n&&i&&t?(0,J.jsx)("div",{style:s.selection}):null}const de=le},65200:(e,t,o)=>{o.d(t,{Z:()=>w});var n=o(67294),i=o(480),s=o(86628),r=o(24405),l=o(50906),a=o(24677),c=o(439),d=o(77907),h=o(69454),u=o(86486),p=o(31945),v=o(50478),m=o(53437),b=o(79954),f=o(85893);const C=v.C$,g=v.GN;function S(e){window.__c={n:"SelectableHoverMenu"};const{store:t,disableDrag:o,hasEditorPermissions:S,isWorkspaceAdmin:w,offsetTop:x}=e,M=!o,k=(0,i.O7)(),A=(0,i.MO)(),y=(0,n.useRef)(null),Z=C,T=g,j=(0,s.VK)((()=>(0,c.zt)(x,t)),[x,t]),R=(0,s.VK)((()=>(0,c.tx)(k,Z+2,t)),[k,Z,t]),I=(0,r.yK)((()=>({div:{position:"absolute",top:j,left:-R,width:Z,height:T,pointerEvents:"auto",cursor:M?"-webkit-grab":void 0},popup:{width:265,overflow:"hidden"}})),[M,R,j,T,Z]),[L,B]=(0,n.useState)(""),D=(0,s.VK)((()=>{const e=u.default.state;return e.isOpen&&e.menuIsOpen&&e.currentStore===t}),[t]);(0,n.useEffect)((()=>()=>{D&&u.default.reset()}),[]);const E=(0,n.useCallback)((()=>{const e=u.default.state,o=h.Z.state;if(e.isOpen){B(""),A&&o.phase===h.i.shown?h.Z.onHide((()=>u.default.setState({...e,menuIsOpen:!0}))):u.default.setState({...e,menuIsOpen:!0}),a.Ys({environment:k,store:t});const n=t.getType();n&&l.YMV(k,{blockType:n})}}),[k,A,t]),H=(0,n.useCallback)((()=>u.default.reset()),[]),O=(0,s.VK)((()=>t.isNavigableAncestorLocked()),[t]);return A?null:(0,f.jsx)("div",{style:I.div,ref:y,children:(0,f.jsx)(m.ZP,{popupType:A?p.Z4.SlideUp:p.Z4.Popup,open:D,placementToOrigin:p.pO.Left,alignmentToOrigin:p.vR.Center,onDismiss:H,originGap:5,forceInitialInbound:!0,style:I.popup,render:()=>(0,f.jsx)(d.LazySelectableHoverMenuPopup,{hasEditorPermissions:S,isWorkspaceAdmin:w,store:t,onDismiss:H,containerRef:y,query:L,setQuery:B}),origin:(0,f.jsx)(b.Z,{store:t,isHoverMenu:!0,canDrag:M,canSelect:!1,analyticsName:"selection_menu",disableForceTouch:!0,disableHorizontalDragEdgeScroll:!0,children:(0,f.jsx)(v.ZP,{width:Z,height:T,disallowTabbing:!0,onClick:E,disableDrag:!M||!S||O})}),trapFocus:D})})}S.width=C,S.height=g;const w=S},98321:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(67294);const i=function(e,t){if(e.ref&&t.ref){const o=t.ref;t.ref=t=>{e.ref(t),o(t)}}return n.cloneElement(e,t)}},439:(e,t,o)=>{o.d(t,{oJ:()=>p,tx:()=>h,zt:()=>u});var n=o(49271),i=o(41432),s=o(92650),r=o(16472),l=o(41662),a=o(26350),c=o(30912),d=o(98165);function h(e,t,o){if(o.isQuoteBlockChild())return t+r.nr+r.NE+n.ZD.paddingLeft;if(o.isTransclusionType()||o.isInsideTransclusion()||"ai_block"===o.getType()||o.isInsideAiBlock())return t+4;if(o.getType()===i.Ti.table){const n=l.g$.getNumberOfUnresolvedComments({simpleTableStore:o,environment:e,includeInline:!(0,s.fg)(e,o)}),i=o.isImmediateColumnChild();return 0!==n||i?t+8:t}const h=d.qA(o).filter((e=>e instanceof a.zq&&e.isType("duplicate_blocks"))).length;return h>0?t+c.pZ*h:t}function u(e,t){return t.isTransclusionType()?e+5:"ai_block"===t.getType()?t.hasContent()?e+9:e+15:t.getType()===i.Ti.button?e+3:e}function p(e){const t=e.getType(),o=e.getNavigableAncestorFormat(),n=Boolean(o.page_small_text);return t===i.Ti.divider?-6:t===i.Ti.header?n?7:10:t===i.Ti.subHeader?n?4:6:t===i.Ti.collectionView?8:t===i.Ti.table?14:3}},13148:(e,t,o)=>{o.d(t,{U:()=>s});o(67294);var n=o(45238),i=o(85893);const s=(0,n.I)("close",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.89795 13.3428C3.18799 13.6262 3.6626 13.6262 3.93945 13.3494L7.99341 9.29541L12.0474 13.3494C12.3308 13.6262 12.8054 13.6328 13.0889 13.3428C13.3723 13.0593 13.3723 12.5847 13.0955 12.3079L9.0415 8.24731L13.0955 4.19336C13.3723 3.9165 13.3789 3.4353 13.0889 3.15845C12.7988 2.875 12.3308 2.875 12.0474 3.15186L7.99341 7.20581L3.93945 3.15186C3.6626 2.875 3.1814 2.86841 2.89795 3.15186C2.6145 3.44189 2.62109 3.9231 2.89795 4.19336L6.9519 8.24731L2.89795 12.3079C2.62109 12.5781 2.6145 13.0659 2.89795 13.3428Z"})})},16184:(e,t,o)=>{o.d(t,{Q:()=>s});o(67294);var n=o(45238),i=o(85893);const s=(0,n.I)("lockedFilled",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.69141 14.6338H11.3018C12.2178 14.6338 12.6689 14.1826 12.6689 13.1914V8.08496C12.6689 7.18945 12.293 6.72461 11.541 6.64941V4.96094C11.541 2.36328 9.81152 1.1123 7.99316 1.1123C6.18164 1.1123 4.45215 2.36328 4.45215 4.96094V6.67676C3.74805 6.78613 3.32422 7.2373 3.32422 8.08496V13.1914C3.32422 14.1826 3.77539 14.6338 4.69141 14.6338ZM5.75098 4.83105C5.75098 3.22461 6.76953 2.35645 7.99316 2.35645C9.2168 2.35645 10.2422 3.22461 10.2422 4.83105V6.64258L5.75098 6.64941V4.83105Z"})})},22686:(e,t,o)=>{o.d(t,{f:()=>s});o(67294);var n=o(45238),i=o(85893);const s=(0,n.I)("person",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.7832 8.00195C9.27344 8.00195 10.5381 6.67578 10.5381 4.95996C10.5381 3.28516 9.2666 2 7.7832 2C6.29297 2 5.01465 3.30566 5.02148 4.97363C5.02148 6.67578 6.28613 8.00195 7.7832 8.00195ZM3.51758 14.3594H12.0352C13.1631 14.3594 13.5527 14.0176 13.5527 13.3887C13.5527 11.6318 11.3242 9.21191 7.77637 9.21191C4.23535 9.21191 2 11.6318 2 13.3887C2 14.0176 2.38965 14.3594 3.51758 14.3594Z"})})},14734:(e,t,o)=>{o.d(t,{X:()=>s});o(67294);var n=o(45238),i=o(85893);const s=(0,n.I)("personCrossedOut",{viewBox:"0 0 44 44",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M5.4857 44H0L44 8.56549V13.0061L5.4857 44Z"}),(0,i.jsx)("path",{d:"M39.8048 44H8.66491L25.6448 30.4378C26.9394 30.6489 28.1581 30.9719 29.3009 31.4067C31.5362 32.2374 33.4346 33.326 34.9964 34.6723C36.5725 36.0044 37.7761 37.4367 38.6071 38.9692C39.4525 40.5018 39.8752 41.9555 39.8752 43.3305C39.8752 43.5675 39.8517 43.7906 39.8048 44Z"}),(0,i.jsx)("path",{d:"M30.3971 16.7973C30.3971 16.8668 30.3965 16.9359 30.3952 17.0048L19.3828 25.9192C18.7467 25.7134 18.1339 25.4228 17.5446 25.0473C16.2408 24.2023 15.1876 23.0708 14.3853 21.6528C13.5972 20.2205 13.2032 18.6163 13.2032 16.8403C13.2032 15.0929 13.5972 13.5174 14.3853 12.1137C15.1876 10.7101 16.2408 9.60007 17.5446 8.78366C18.8485 7.96725 20.267 7.55905 21.8001 7.55905C23.3332 7.55905 24.7517 7.96009 26.0556 8.76218C27.3595 9.56426 28.4054 10.6671 29.1935 12.0708C29.9959 13.4601 30.3971 15.0356 30.3971 16.7973Z"})]})})}}]);