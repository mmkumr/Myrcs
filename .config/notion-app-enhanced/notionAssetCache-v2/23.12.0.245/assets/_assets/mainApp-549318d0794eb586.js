(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5906],{78519:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initialize:()=>s});var i=n(80444),o=n(54642);async function s(e,t){if(await i.default.waitUntilRendered(),e.currentUser.isLoggedIn()&&!Boolean(t.fromPageRefresh)){const{CsatMilestoneStore:t}=e,n=await o.getCsatMilestones(e,{});"success"===n.type&&t.setState({data:n.data})}}},22974:(e,t,n)=>{"use strict";n.d(t,{MH:()=>S,rz:()=>v,h0:()=>u,I6:()=>g,LH:()=>f});var i=n(8848);var o=n(97880),s=n(18514),r=n(30021),a=n(4926),d=n(47839);let l;const c=10;function u(e,t){const{device:n,ThemeStore:o}=e,{mode:s,usingSystemTheme:r}=t,l={mode:s};o.setState(l),e.mobileNative&&e.mobileNative.setTheme(s,r),d.setTheme(function(e){const t=(0,i.gh)({theme:e});return{mode:e,colors:{white:i.ZP.white,blue:i.ZP.blue},borderRadius:3,textColor:t.regularTextColor,popoverBackgroundColor:t.popoverBackground,popoverBoxShadow:t.mediumBoxShadow,inputBoxShadow:t.inputBoxShadow,inputBackgroundColor:t.inputBackground,dividerColor:t.darkDividerColor,shadowOpacity:t.shadowOpacity}}(s)),localStorage.setItem("theme",JSON.stringify(l)),function(e,t){if(0===e.nativeScrollbarWidth)return;const n=document.getElementById("scroll-properties");n&&(n.innerHTML=`\n\t\t\t::-webkit-scrollbar {\n\t\t\t\twidth: 10px;\n\t\t\t\theight: 10px;\n\t\t\t}\n\t\t\t::-webkit-scrollbar {\n\t\t\t\tbackground: transparent;\n\t\t\t}\n\t\t\t::-webkit-scrollbar-track {\n\t\t\t\tbackground: ${p[t]};\n\t\t\t}\n\t\t\t::-webkit-scrollbar-thumb {\n\t\t\t\tbackground:${h[t]};\n\t\t\t}\n\t\t\t::-webkit-scrollbar-thumb:hover {\n\t\t\t\tbackground:${m[t]};\n\t\t\t}\n\t\t`,a.Z.setState(c))}(n,s),"dark"===s?document.body.classList.add("dark"):document.body.classList.remove("dark")}const p={light:"#EDECE9",dark:"rgba(202, 204, 206, 0.04)"},h={light:"#D3D1CB",dark:"#474c50"},m={light:"#AEACA6",dark:"rgba(202, 204, 206, 0.3)"};function g(e){l=e}function v(e){l=void 0,r.Z.setState(e)}function f(e){const t=b(e);switch(t){case"dark":case"light":u(e,{mode:t,usingSystemTheme:!1});break;case"system":!async function(e){const{mobileNative:t}=e;let n="light";n=t&&t.api.getTheme?await t.api.getTheme():e.device.prefersDarkInterface?"dark":"light",u(e,{mode:n,usingSystemTheme:!0})}(e);break;default:(0,o.t1)(t)}}function S(e){return l||b(e)}function b(e){let t=r.Z.state;return t||(t=e.device.isMobile||(0,s.Sr)()?"system":e.ThemeStore.state.mode),"dark"===(n=t)||"light"===n||"system"===n?n:"system";var n}},16854:(e,t,n)=>{"use strict";n.d(t,{nc:()=>m,m1:()=>p,rG:()=>h});n(57658);var i=n(6287),o=n(98165),s=n(35661),r=n(49085),a=n(45433);const d={[a.wW]:void 0,[a.iS]:void 0,[a.zU]:void 0,[a.Fi]:void 0,[a.p$]:void 0,[a.GZ]:void 0,[a.nG]:void 0,[a.Be]:void 0};class l extends r.default{getInitialState(){return{typedDatabasesForSpace:{}}}setCachedDatabasesForType(e,t,n){this.state.typedDatabasesForSpace[t]||(this.state.typedDatabasesForSpace[t]=d),this.state.typedDatabasesForSpace[t][e]=n,this.emit()}getCachedDatabasesForType(e,t){const n=this.state.typedDatabasesForSpace[t];if(n)return n[e]}}const c=new l;var u=n(54642);async function p(e){let{environment:t,spaceId:n,databaseType:i,parentStore:o}=e;const s=c.getCachedDatabasesForType(i,n);if(s)return s;const r=await h({environment:t,spaceId:n,databaseType:i,parentStore:o});return r&&c.setCachedDatabasesForType(i,n,r),r}async function h(e){let{environment:t,spaceId:n,databaseType:o,parentStore:r}=e;if(!n)return;const a=await u.getTypedDatabases(t,{spaceId:n,databaseType:o});return"success"===a.type?a.data.result.map((e=>s.NW.createChildStore(r,{table:i.v,id:e.collectionId}))):void 0}async function m(e){let{environment:t,spaceId:n,databaseTypes:i,parentStore:s,teamId:r}=e;const a=[];return await Promise.all(i.map((async e=>{await async function(e){let{environment:t,spaceId:n,databaseType:i,parentStore:s,teamId:r}=e;const a=await h({spaceId:n,environment:t,databaseType:i,parentStore:s});if(!a)return!1;for(const d of a){const e=o.VP(d);if(e&&e.id===r)return!0}return!1}({environment:t,spaceId:n,databaseType:e,parentStore:s,teamId:r})&&a.push(e)}))),a}},16091:(e,t,n)=>{"use strict";n.d(t,{RD:()=>T,gc:()=>I,gl:()=>j,u7:()=>M});var i=n(67294),o=n(36769),s=n(480),r=n(86628),a=n(41432),d=n(5366),l=n(39699),c=n(37181),u=n(81415),p=(n(95477),n(19124)),h=n(68056),m=n(89086),g=n(28685),v=n(80444),f=n(77080),S=n(83212),b=n(35661),y=n(24666),w=n(41752),k=n(89626),x=n(85893);const C=(0,d.defineMessages)({spaceForAiHeader:{id:"AiOnboardingTooltips.spaceForAi.header",defaultMessage:"Press ‘space’ for AI"},spaceForAiContent:{id:"AiOnboardingTooltips.spaceForAi.content",defaultMessage:"On a new line or page, press ‘space’ on your keyboard for AI to generate or edit the page. Try it now!"},askAiAnythingHeader:{id:"AiOnboardingTooltips.askAiAnything.header",defaultMessage:"Ask AI anything"},askAiAnythingContent:{id:"AiOnboardingTooltips.askAiAnything.content",defaultMessage:"Just tell AI what to do — the more details, the better. You can also start from an example in the menu."},refineAiResponseHeader:{id:"AiOnboardingTooltips.refineAiResponse.header",defaultMessage:"Tell AI what to do next"},refineAiResponseContent:{id:"AiOnboardingTooltips.refineAiResponse.content",defaultMessage:"How was it? Give AI further instructions to improve what it wrote, or hit ‘Done’ when finished."},showAssistantLocationHeader:{id:"AiOnboardingTooltips.showAssistantLocation.answersToYourQuestionHeader",defaultMessage:"Get instant answers to your questions"},showAssistantLocationContent:{id:"AiOnboardingTooltips.showAssistantLocation.askQuestionBody",defaultMessage:"Ask a question about anything in your workspace. Notion AI will search across your pages and generate an answer."}});function M(){window.__c={n:"SpaceForAiOnboardingTooltip"};const e=(0,s.O7)(),t=function(){const e=(0,s.O7)(),t=(0,r.VK)((()=>{const t=v.default.state.mainEditorCurrentBlockStore;return t&&S.Z.getMode(e,t)}),[e]);return(0,r.VK)((()=>{if(e.device.isMobile)return;if(!f.default.checkGate("space_for_ai_tooltip_enabled"))return;const{currentUserSettingsStore:n,inAppCalloutStore:i}=v.default.state;if(!i.canShow("ai_onboarding_tooltip"))return;const o=null==n?void 0:n.getSettings();if(!o)return;if(o.signup_time&&o.signup_time>16770636e5)return;if("space_for_ai"!==(0,k.sy)())return;if(!(0,p.GD)(t))return;const s=y.default.state;if("editing"===s.mode){const e=(0,h.QY)(s.multiSelection);if(e&&(0,m.wd)(e.selection)){const t=e.store,n=g.E.findEditableWithStore(t);if(n){const e="block"===t.pointer.table?b.G.createChildStore(t,t.pointer):void 0,i=e&&e.getType(),o=Boolean(i&&(0,a.hD)(i)),s=t.getValue();if(o&&!s)return n}}}}),[e,t])}();return t?(0,x.jsx)(u.U,{origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,x.jsx)(d.FormattedMessage,{...C.spaceForAiHeader}),content:(0,x.jsx)(d.FormattedMessage,{...C.spaceForAiContent}),onCloseClick:()=>(0,k.h1)(e)}):null}function T(e){window.__c={n:"AskAIAnythingOnboardingTooltip"};const{originRef:t,openState:n}=e,i=(0,s.O7)(),o=(0,r.VK)((()=>(0,k.sy)()),[]);if(i.device.isMobile)return null;return"ask_ai_anything"===o&&"initialPrompt"===n.stage?(0,x.jsx)(u.U,{origin:t,placementToOrigin:"top",header:(0,x.jsx)(d.FormattedMessage,{...C.askAiAnythingHeader}),content:(0,x.jsx)(d.FormattedMessage,{...C.askAiAnythingContent}),onCloseClick:()=>(0,k.h1)(i)}):null}function j(e){window.__c={n:"RefineAIResponseOnboardingTooltip"};const{originRef:t,openState:n,isInputEmpty:i}=e,o=(0,s.O7)(),a=(0,r.VK)((()=>(0,k.sy)()),[]);if(o.device.isMobile)return null;const l="refine_ai_response"===a&&"results"===n.stage&&!n.loading&&"cursor"===n.context.type&&i;return(0,x.jsx)(u.U,{origin:l?t:void 0,placementToOrigin:"right",pointerOffset:-4,pointerLength:25,header:(0,x.jsx)(d.FormattedMessage,{...C.refineAiResponseHeader}),content:(0,x.jsx)(d.FormattedMessage,{...C.refineAiResponseContent}),onCloseClick:()=>(0,k.h1)(o)})}function I(e){window.__c={n:"ShowAssistantLocationTooltip"};const{origin:t}=e,n=(0,s.O7)(),o=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e}=v.default.state;e&&(0,w.C)(n,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e})}),[n]);return(0,x.jsx)(u.U,{style:{width:250},pointerLength:25,pointerPosition:"5%",origin:t,placementToOrigin:"bottom",header:(0,x.jsx)(d.FormattedMessage,{...C.showAssistantLocationHeader}),content:(0,x.jsx)(d.FormattedMessage,{...C.showAssistantLocationContent}),onCloseClick:o})}(0,o.exposeDebugEnvironmentValue)("resetAIOnboarding",(e=>()=>{const{currentUserSettingsStore:t}=v.default.state;t&&l.createAndCommit({userAction:"AiIntroModal.debugging.resetAIOnboarding",environment:e,perform:e=>{c.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:"space_for_ai"}})},userId:t.id})}))},41752:(e,t,n)=>{"use strict";n.d(t,{C:()=>s});var i=n(39699),o=n(37181);function s(e,t){const{phase:n,transactionUserAction:s,userSettingsStore:r}=t;i.createAndCommit({environment:e,userAction:s,perform:e=>{o.d2({userSettingsStore:r,transaction:e,data:{ai_qna_intro_onboarding_phase:n}})}})}},81598:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r,Zl:()=>s,eC:()=>a,qS:()=>o,yX:()=>d});var i=n(77907);const o=(0,i.lazyComponent)(i.deps.assistant,(e=>e.AssistantChatStep)),s=(0,i.lazyComponent)(i.deps.assistant,(e=>e.AssistantLabelerBar)),r=(0,i.lazyComponent)(i.deps.assistant,(e=>e.AssistantOriginElement)),a=(0,i.lazyComponent)(i.deps.assistant,(e=>e.AssistantMenuPopup)),d=(0,i.lazyComponent)(i.deps.assistant,(e=>e.SearchAssistantPane))},40824:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var i=n(49085),o=n(92595);class s extends i.default{getInitialState(){return{currentState:"default",lastStepLoadingCompletionUnixEpochMs:-1/0,aiWindowLastSeenUnixEpochMs:-1/0}}setAssistantLastViewedTime(){r.setState({...r.state,aiWindowLastSeenUnixEpochMs:Date.now()})}}const r=new s;(0,o.exposeDebugValue)("AssistantOriginElementStore",r)},55031:(e,t,n)=>{"use strict";n.d(t,{y:()=>d});var i=n(51454),o=n(28020),s=n(24646),r=n(4926),a=n(96234);function d(e,t){const{theme:n,rightEdgeDistance:d,isInPeekRenderer:l}=t,c=t.width??36,u=(0,s.ll)(e,l)-(0,s.vJ)(e);return{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",background:n.whiteButtonBackground,bottom:16+r.Z.state,right:d+r.Z.state,width:c,height:c,borderRadius:"100%",fontSize:20,boxShadow:n.lightBoxShadow,zIndex:i.hT,opacity:o.tu.state?0:1,transform:`translateX(-${u}px) translateZ(0)`,transition:`\n\t\t\topacity ${a.Z.transitionDuration}ms,\n\t\t\tcolor ${a.Z.transitionDuration}ms,\n\t\t\ttransform 200ms\n\t\t`}}},77207:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});n(67294);var i=n(480),o=n(86628),s=n(55367),r=n(80796),a=n(69784),d=n(85893);const l=function(e){window.__c={n:"CursorListener"};const t=(0,i.Fy)(),n=(0,o.VK)((()=>({initiator:r.Z.state.initiator,isDragging:s.ZP.state.isDragging})),[]),l=(0,o.VK)((()=>({active:a.Z.state.isActive,moved:!!a.Z.state.isActive&&a.Z.state.moved})),[]),c=l.moved?"default":n.isDragging?"-webkit-grabbing":"text";let u="notion-cursor-listener";return"-webkit-grabbing"===c&&(u+=" notion-disable-local-cursor"),t.isIOS&&("touch"===n.initiator||n.isDragging||l.active?document.body.classList.add("notion-disable-webkit-user-select"):document.body.classList.remove("notion-disable-webkit-user-select")),(0,d.jsx)("div",{style:{...e.style,cursor:c},className:u,children:e.children})}},84844:(e,t,n)=>{"use strict";n.d(t,{Z:()=>x,d:()=>k});var i=n(67294),o=n(480),s=n(86628),r=n(24405),a=n(99036),d=n(6695),l=n(51365),c=n(66890),u=n(33929),p=n(61766),h=n(886),m=n(13023),g=n(97039),v=n(78030),f=n(24118),S=n(53876),b=n(12867),y=n(85893);const w=[...f.Ae,"button","formula","rollup","title","file","verification"];function k(e){return(0,s.VK)((()=>{if(!e)return{collectionStore:void 0,schema:void 0,format:void 0};const t=e.getAssociatedCollectionStore();let n,i;return n=t?t.getSchema():a.Kc(u.default.getIntl()),t&&(i=d.iB(t.getFormat(),n,void 0,d.j5.Collection)),{collectionStore:t,schema:n,format:i}}),[e])}const x=function(e){window.__c={n:"MiniProperties"};const{store:t}=e,n=(0,o.O7)(),a=(0,i.useMemo)((()=>new h.Z(n)),[n]),{collectionStore:u,schema:f,format:x}=k(t),C=(0,s.qz)(void 0,p.Z),M=(0,r.yK)((e=>({pageProperties:{display:"flex",gap:"0 6px",overflow:"hidden",paddingRight:6},morePropertiesTooltip:{color:e.mediumInvertedTextColor},morePropertiesButton:{borderRadius:6,height:S.IT,width:S.IT},overflowButtonWrapperStyle:{paddingBottom:0},overflowButtonStyle:{height:30,width:30}})),[]);(0,i.useEffect)((()=>{if(u){const e=u.getParentBlockStore();e&&e.isCollectionView()&&a.setContext({type:"collectionPage",collectionViewBlockStore:e,collectionStore:u})}}),[a,u]);const T=(0,i.useCallback)((t=>{l.bA({environment:n,blockPropertyValueOverlayStore:m.Z,store:e.store,property:t,format:v.C.Mini,collectionContextStore:a})}),[a,n,e.store]),[j,I]=(0,s.VK)((()=>{var e;if(!u||!x||!f)return[void 0,void 0];const t=d.iB(x,f,void 0,d.j5.Collection),n=(null==t||null===(e=t.collection_page_properties)||void 0===e?void 0:e.filter((e=>{var t;const n=null===(t=f[e.property])||void 0===t?void 0:t.type;return void 0!==n&&!w.includes(n)})))??[];return[n.slice(0,5),n.slice(5).map((e=>({visibility:"show",hasValue:!0,...e})))]}),[u,x,f]);return u&&x&&null!=j&&j.length?(0,y.jsx)("div",{style:M.pageProperties,children:(0,y.jsxs)(c.L1,{value:a,children:[j.map((e=>(0,y.jsx)(g.Z,{store:t,property:e.property,locked:!1,disabled:!1,format:v.C.Mini,tableWrap:!1,blockPropertyValueOverlayStore:m.Z,onOpenProperty:T,showRelationTooltip:!0,showIfEmpty:!0,collectionStore:u},e.property))),I&&I.length>0&&(0,y.jsx)(b.gm,{hiddenProperties:I,canConfigureCollection:!1,store:e.store,collectionStore:u,collectionContextStore:a,blockPropertyValueOverlayStore:m.Z,disabled:!1,locked:!1,isInPeekRenderer:!0,format:x,buttonPopupStore:C,hideDragHandle:!0,overflowButtonWrapperStyle:M.overflowButtonWrapperStyle,overflowButtonStyle:M.overflowButtonStyle})]})}):null}},58280:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>cd});var i=n(67294),o=n(83355),s=n(13991),r=n(79946),a=n(49271),d=n(8848),l=n(25278),c=n(71644),u=n(99405),p=n(89101),h=n(29369),m=n(32739),g=n(12139),v=n(5366),f=n(50906),S=n(47839),b=n(32603),y=n(91376),w=n(75018),k=n(73966),x=n(70782),C=n(39634),M=n(37181),T=n(95477),j=n(77907),I=n(80444),P=n(35661);const _=(0,j.lazyComponent)(j.deps.StudentGroupSignup,(e=>e.default));var A=n(480),L=n(86628),U=n(24405),Z=n(59054),E=n(49204),R=n(82990),B=n(42922),V=n(61519),O=n(63296),D=n(64369),N=n(74016),z=n(85893);const F=function(e){window.__c={n:"TeamInviteLinkJoinPage"};const{teamStore:t}=e,n=(0,A.O7)(),{teamName:i}=(0,L.VK)((()=>({teamName:t.getName()})),[t]),o=(0,U.yK)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:R.Z.fontWeight.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:R.Z.fontWeight.semibold,marginLeft:10}})),[]);return(0,z.jsxs)("div",{style:o.container,children:[(0,z.jsx)(N.p,{store:t,disabled:!0,size:55}),(0,z.jsx)("div",{style:o.title,children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkJoinPage.page.title",defaultMessage:"You've been invited to join {teamName}",values:{teamName:i}})}),(0,z.jsx)("div",{style:o.subtitle,children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkJoinPage.page.subtitle",defaultMessage:"You can access the content in the teamspace if you join the teamspace."})}),(0,z.jsxs)("div",{style:o.buttonContainer,children:[(0,z.jsx)(B.Z,{isLarge:!0,onClick:async()=>{const e=n.currentUser.id;if(!e)return;const i=[{type:"member",entity_type:"user",user_id:e}];await E.um({environment:n,userId:e,teamStore:t,user:i}),f.Phj(n,{store:t,selection:"yes"})},children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkJoinPage.joinTeam.label",defaultMessage:"Join teamspace"})}),(0,z.jsx)(O.Z,{isLarge:!0,style:o.rightButton,onClick:async()=>{f.Phj(n,{store:t,selection:"no"}),await E.Id({environment:n})},children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkJoinPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,z.jsx)(V.Z,{size:48,innerStyle:o.divider}),(0,z.jsx)(D.Z,{isSmall:!0,children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkJoinPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})};var W=n(14889);function q(e){window.__c={n:"TeamInviteLinkRequestPageContent"};const{teamStore:t,teamName:n,onRequestClick:i}=e,o=(0,A.O7)(),s=(0,U.yK)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:R.Z.fontWeight.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:R.Z.fontWeight.semibold,marginLeft:10}})),[]);return(0,z.jsxs)("div",{style:s.container,children:[(0,z.jsx)(N.p,{store:t,disabled:!0,size:55}),(0,z.jsx)("div",{style:s.title,children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkRequestPage.requestAccess.title",defaultMessage:"Request access to {teamName}",values:{teamName:n??K()}})}),(0,z.jsx)("div",{style:s.subtitle,children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkRequestPage.requestAccess.subtitle",defaultMessage:"You can access this teamspace if a teamspace owner approves your request."})}),(0,z.jsxs)("div",{style:s.buttonContainer,children:[(0,z.jsx)(B.Z,{isLarge:!0,onClick:i,children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkRequestPage.requestAccess.label",defaultMessage:"Request access"})}),(0,z.jsx)(O.Z,{isLarge:!0,style:s.rightButton,onClick:async()=>{await E.Id({environment:o})},children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkRequestPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,z.jsx)(V.Z,{size:48,innerStyle:s.divider}),(0,z.jsx)(D.Z,{isSmall:!0,children:(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkRequestPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})}function K(){return(0,z.jsx)(v.FormattedMessage,{id:"teamInviteLinkRequestPage.privateTeamspace.label",defaultMessage:"Private Teamspace"})}const H=function(e){window.__c={n:"TeamInviteLinkRequestPage"};const{teamStore:t}=e,[n,o]=(0,i.useState)(!1),{teamName:s}=(0,L.VK)((()=>({teamName:t.getName()})),[t]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(q,{teamStore:t,teamName:s,onRequestClick:()=>o(!0)}),(0,z.jsx)(W.Z,{teamStore:t,teamName:s??K(),teamId:t.id,isModalOpen:n,onDismiss:()=>o(!1)})]})};function G(e){const{teamAccessLevel:t,teamStore:n}=e;switch(t){case"open":return(0,z.jsx)(F,{teamStore:n});case"closed":case"private":return(0,z.jsx)(H,{teamStore:n})}}const $=function(e){window.__c={n:"TeamInviteLinkPage"};const{teamId:t}=e,n=(0,A.O7)(),{teamAccessLevel:o,teamStore:s}=(0,L.VK)((()=>{const e=new P.zX(n,{table:h.e0,id:t});return{teamAccessLevel:e.getTeamAccessLevel(),teamStore:e}}),[n,t]),[{value:r}]=(0,Z.r5)((async()=>await E.Ng({environment:n,teamId:t})),[n,t]);(0,i.useEffect)((()=>{!0===(null==r?void 0:r.isValidTeamRequest)&&null!=r&&r.isTeamMember&&(async()=>{var e;const t=null===(e=n.currentUser)||void 0===e?void 0:e.id;t&&s&&await E.t_({environment:n,userId:t,teamStore:s})})()}),[n,s,r]);const a=(0,U.yK)((()=>({container:{display:"flex",justifyContent:"center",height:"100%"}})),[]);return r?(0,z.jsx)("div",{style:a.container,children:r.isValidTeamRequest?(0,z.jsx)(G,{teamStore:s,teamAccessLevel:o}):"nonSpaceMember"===r.invalidRequestReason?(0,z.jsx)(j.LazyPageError,{route:{name:"teamsInvite",teamId:t},publicPageData:void 0}):(0,z.jsx)(j.LazyPageError,{route:{name:"notFound"},publicPageData:void 0})}):null},Q=(0,j.lazyComponent)(j.deps.Templates,(e=>e.TemplateSubmission));var Y=n(84549),X=n(6495),J=n(11342);function ee(e,t){const n=t.deviceType,i=t.mobileAppVersion;if(!(0,X.wv)(e)||"local"===e||!t.isMobileNative||!i)return!1;return function(e){const{environmentName:t,deviceType:n,mobileAppVersion:i,androidVersions:o,iosVersions:s}=e,r=(0,J.parseMobileAppVersion)(i,"android"===n);if(!r)return!1;if("android"===n&&!o||"ios"===n&&!s)return!1;let a;if("android"===n){if(!o)return!1;a=(0,J.parseMobileAppVersion)(o[t],!0)}else{if(!s)return!1;a=(0,J.parseMobileAppVersion)(s[t],!1)}return!!a&&(0,J.isLessThanVersion)(r,a)}({environmentName:e,deviceType:n,mobileAppVersion:i,iosVersions:{staging:"0.1.1022",development:"0.5.1168",production:"0.4.1021"}})}var te=n(51454),ne=n(50950),ie=n(72899),oe=n(16091),se=n(81598),re=n(69098),ae=n(28020),de=n(19124),le=n(64286),ce=n(17652),ue=n(67669);const pe=(0,j.lazyComponent)(j.deps.moveTo,(e=>e.MoveToMenuRenderer));var he=n(48451),me=n(94841),ge=n(74948),ve=n(36596),fe=n(38676);function Se(){window.__c={n:"SidebarLoadingSkeleton"};const e=(0,L.VK)((()=>fe.gV.state?fe.GZ.state:0),[]),t=(0,U.yK)((t=>{const n={width:22,height:22,borderRadius:4},i={height:10,minHeight:10,borderRadius:10};return{sidebar:{backgroundColor:t.sidebarBackground,boxShadow:t.sidebarBoxShadow,display:"flex",minWidth:e,flexDirection:"column",padding:"12px 14px",overflow:"hidden"},heroSection:{marginBottom:19,display:"flex",alignItems:"center"},heroSectionIcon:{padding:"1px",...n},heroSectionTitle:{width:177,marginLeft:8,...i},toplevelMenu:{marginBottom:16,width:78,...i},toplevelMenuLast:{marginBottom:36,width:135,...i},sectionHeader:{marginBottom:12,width:56,...i},pageRow:{display:"flex",alignItems:"center",marginBottom:8},pageChevron:{width:12,height:12,display:"block",marginRight:4,fill:"dark"===t.mode?t.accentColors.gray[300]:t.accentColors.gray[100]},pageIcon:{...n},pageTitle:{marginLeft:6,...i}}}),[e]),n=(0,z.jsxs)("div",{style:t.heroSection,children:[(0,z.jsx)(ve.Z,{style:t.heroSectionIcon}),(0,z.jsx)(ve.Z,{style:t.heroSectionTitle})]}),o=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ve.Z,{style:t.toplevelMenu}),(0,z.jsx)(ve.Z,{style:t.toplevelMenu}),(0,z.jsx)(ve.Z,{style:t.toplevelMenuLast})]}),s=(0,z.jsx)(ve.Z,{style:t.sectionHeader}),r=(0,i.useMemo)((()=>Array(5).fill(null).map((()=>Array(4).fill(null).map((()=>Math.floor(4*Math.random())))))),[]).map(((e,n)=>e.map(((e,i)=>(0,z.jsxs)("div",{style:{...be(n),...t.pageRow},children:[(0,z.jsx)("svg",{viewBox:"0 0 30 30",style:t.pageChevron,children:(0,z.jsx)("polygon",{points:"17.4,15 7,25.2 9.8,28 23,15 9.8,2 7,4.8"})}),(0,z.jsx)(ve.Z,{style:t.pageIcon}),(0,z.jsx)(ve.Z,{style:{...t.pageTitle,width:80+20*e}})]},`${n}-${i}`)))));return(0,z.jsxs)("div",{style:t.sidebar,children:[n,o,s,r]})}function be(e){return 0===e?{}:{animation:`1s ease-in ${e}s 1 normal both running fadein`}}var ye=n(24646),we=n(5162),ke=n(51),xe=n(21273),Ce=n(43604),Me=n(77080),Te=n(27242),je=n(78291),Ie=n(12309),Pe=n(33293);function _e(){window.__c={n:"BillingModalContainer"};const e=(0,L.VK)((()=>Ie.Z.state.modalInfoById),[]);return(0,z.jsx)(z.Fragment,{children:Object.entries(e).map((e=>{let[t,n]=e;const{content:i,dismissUsing:o,isOpen:s,modalStyle:r,onClosed:a,onDismiss:d}=n;return(0,z.jsx)(Pe.q,{dismissUsing:o,isOpen:s,onClosed:a,onDismiss:d,style:r,children:i},t)}))})}n(21703);var Ae=n(30120),Le=n(92595),Ue=n(54642);async function Ze(e,t){const n=await Ue.stripeGetTestClock(t,{spaceId:e});if("success"===n.type){if("advancing"===n.data.status)throw new Error("Test clock is advancing. Please try again in a few seconds.");return n.data.epochSeconds}}async function Ee(e){const{environment:t,spaceId:n,advanceTestClockArgument:i}=e;if(i)return"number"==typeof i?i:"function"==typeof i?await async function(e){const{environment:t,spaceId:n,callback:i}=e,o=await Ze(n,t);if(o)return i(o)}({environment:t,spaceId:n,callback:i}):"object"==typeof i?await async function(e){const{environment:t,spaceId:n,durationLike:i}=e,o=await Ze(n,t);if(!o)return;const s=Ae.ou.fromSeconds(o),r=Ae.nL.fromDurationLike(i);return s.plus(r).toSeconds()}({environment:t,spaceId:n,durationLike:i}):void 0}const Re=function(){window.__c={n:"StripeTestClockSupport"};const e=["local","staging","development"].includes("production"),t=(0,A.O7)();return(0,i.useEffect)((()=>{e&&((0,Le.exposeDebugValue)("refreshTestClock",(async()=>{const{spaceId:e}=je.default.state;if(e){const n=await Ze(e,t);if(n){const e=Ae.ou.fromSeconds(n);console.log(`Test clock time is ${e.toString()} (${n} seconds)`),je.default.setTestClockSeconds(n)}}})),(0,Le.exposeDebugValue)("advanceTestClock",(async e=>{if(!e)throw new Error("advanceTestClock requires an argument. You can pass an epoch timestamp in seconds, a relative DurationLike object like { months: 2 }, or a function that takes the current epoch seconds and returns the new epoch seconds.");const{spaceId:n}=je.default.state;if(!n)return;const i=await Ee({environment:t,spaceId:n,advanceTestClockArgument:e});i&&(await Ue.stripeAdvanceTestClock(t,{spaceId:n,epochSeconds:i}),je.default.setTestClockSeconds(i))})))}),[e,t]),null};var Be=n(1404),Ve=n(59260),Oe=n(62142),De=(n(57658),n(9852)),Ne=n(63143),ze=n(99334);const Fe=10*Ne.C0,We=5*Fe;function qe(){return window.__c={n:"TabAnalyticsTracker"},(0,i.useEffect)((()=>{if(!window.BroadcastChannel)return;const e=(0,De.getSessionTabId)(),t=new Map,n=new BroadcastChannel("notion_tab_tracker");n.onmessage=e=>{const n=e.data;"string"==typeof n&&t.set(n,Date.now())};const i=window.setInterval((()=>{(()=>{const e=[],n=Date.now();for(const[i,o]of t.entries())n-o>We&&e.push(i);e.length;for(const i of e)t.delete(i)})(),n.postMessage(e);const i=t.size+1;(0,ze.$)(i)}),Fe);return()=>{n.close(),window.clearInterval(i)}}),[]),null}var Ke=n(22491),He=n(72126),Ge=n(70203),$e=n(44805),Qe=n(92120),Ye=n(24229),Xe=n(48588);function Je(e){const{discussionId:t,level:n}=e;return`\n\t\t.${(0,Ke.vE)({level:n})}.${(0,Ke.dk)({discussionId:t})}.${$e.kB} {\n\t\t\tbackground: ${(0,d.Hu)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${d.mO};\n\t\t}\n\t`}function et(){function e(){var e,t,n;const i=(null===(e=Qe.Z.state)||void 0===e?void 0:e.discussionIds)||[],o=null!==(t=Ye.Z.state)&&void 0!==t&&t.open&&(null===(n=Ye.Z.state)||void 0===n?void 0:n.discussionIds)||[];return[...i.flatMap((e=>He.DZ(Ke.nB).map((t=>Je({discussionId:e,level:t+1,hovered:!0,selected:!1}))))),...o.flatMap((e=>He.DZ(Ke.nB).map((t=>Je({discussionId:e,level:t+1,hovered:!1,selected:!0})))))].join("\n")}function t(){var e,t;const n=null===(e=Xe.Z.state)||void 0===e?void 0:e.store,i=null===(t=Xe.Z.state)||void 0===t||null===(t=t.annotations)||void 0===t?void 0:t.find(Ge.j0F);if(!i)return"";const o=(0,Ge.zW$)(i);return"block"!==(null==n?void 0:n.table)?"":`\n\t\t\t.${(0,Ke.S$)({href:o,blockId:n.id})}.${$e.kB} {\n\t\t\t\ttransition: border-color 100ms ease-in, opacity 100ms ease-in;\n\t\t\t\tborder-color: currentColor !important;\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`}window.__c={n:"CSSOverrideStyle"};const n=(0,L.VK)((()=>[e(),t()].filter(Boolean).join("\n")),[]);return n?(0,z.jsx)("style",{dangerouslySetInnerHTML:{__html:n}}):null}var tt=n(77207),nt=n(74055),it=n(7339);function ot(e){return(0,z.jsx)("div",{id:"test-customer-io",style:{width:334,height:200,position:"absolute",bottom:64,right:21,zIndex:1,display:e?void 0:"none"}})}const st=function(){window.__c={n:"CustomerIoInAppCallout"};const e=(0,A.O7)(),{currentUser:t}=e,n=(0,L.VK)((()=>it.C.state.ready),[]),o=(0,L.VK)((()=>t.isLoggedIn()&&n&&Me.default.checkGate("customerio")),[t,n]),s=(0,L.VK)((()=>I.default.state.inAppCalloutStore),[]),r=(0,L.VK)((()=>"dark"!==e.ThemeStore.state.mode),[e]);(0,i.useEffect)((()=>{o&&(s.canShow("customer_io")?r?nt.Z.state.suppressReason===nt.V.IN_APP_CALLOUT_CONFLICT?nt.Z.setState({...nt.Z.state,isVisible:!0,suppressReason:void 0}):nt.Z.setState({...nt.Z.state,suppressReason:void 0}):nt.Z.setState({isVisible:!1,suppressReason:nt.V.DARK_MODE}):nt.Z.setState({isVisible:!1,suppressReason:nt.V.IN_APP_CALLOUT_CONFLICT}))}),[s,o,r]);const a=(0,L.VK)((()=>nt.Z.state.isVisible&&s.canShow("customer_io")),[s]);return(0,i.useEffect)((()=>{if(a)return s.updateCalloutStatus({calloutId:"customer_io",visible:!0}),()=>{s.updateCalloutStatus({calloutId:"customer_io",visible:!1})}}),[s,a]),o?ot(!!a):null};var rt=n(41892),at=n(15095),dt=n(43593),lt=n(17755),ct=n(42875),ut=n(79362),pt=n(22808),ht=n(82883),mt=n(64002),gt=n(60682),vt=n(24990),ft=n(19037);async function St(e){const t=document.createElement("canvas");t.width=32,t.height=32;const n=t.getContext("2d"),i=document.createElement("img");return i.src=e,new Promise((e=>{i.onload=()=>{n.drawImage(i,0,0,32,32),e(t.toDataURL("image/png"))},i.onerror=()=>{e("")}}))}var bt=n(84210),yt=n(33929),wt=n(19034),kt=n(80641),xt=n(89087);class Ct extends o.Z{constructor(){super(...arguments),this.lastSetIconString=void 0,this.updateBrowserState=()=>{const{device:e}=this.environment,t=this.computedStore.state;if(!t)return;const{url:n,title:i,icon:o}=t;let s,r,a;o&&(0,ut.V2)(o.icon)?a=o.icon:o&&(0,pt.Z)(o.icon)?s=o.icon:o&&dt.F8(o.icon)&&(r=o);const{intl:d}=this.props,l=t.isNonverified&&!t.hasBypassedContentClassification&&!t.isMemberOfSpace;i&&document.title!==i&&(l?document.title=d.formatMessage({id:"pageTitle.flaggedContent",defaultMessage:"Flagged Content"}):e.isSafari&&s?document.title=`${s} ${i}`:document.title=i),n&&mt.T1(n)!==mt.T1(window.location.href)&&(window.history.replaceState(window.history.state,void 0,n),w.updateRouterStateForDocumentTitleChange({environment:this.environment,url:window.location.href}));const c=document.querySelector("link[rel='shortcut icon']");if(c){const t=rt.Z.images.faviconIco;if(l)c.href=t,this.lastSetIconString=t;else if(s)s!==this.lastSetIconString&&(this.lastSetIconString=s,async function(e,t){const n=document.createElement("canvas");n.width=32,n.height=32;const i=n.getContext("2d");if(i.font="normal normal normal 32px/32px sans",i.textAlign="center",i.textBaseline="middle","raw"===t)return i.fillText(e,n.width/2,n.height/2+4),n.toDataURL("image/png");const o=document.createElement("img");o.src=(0,at.bk)(t);const s=(0,at.yz)(e,vt.Z.state);if(!s)return;const r=(0,at.G0)(s);return new Promise((e=>{o.onload=()=>{i.drawImage(o,r.x,r.y,r.size,r.size,0,0,32,32),e(n.toDataURL("image/png"))},o.onerror=()=>{e("")}}))}(s,(0,gt.e_)(this.environment)).then((e=>{c.href=e})));else if(a){if(a!==this.lastSetIconString){this.lastSetIconString=a;const t=`${a}?mode=${this.theme.mode}`;e.isFirefox?c.href=t:St(t).then((e=>{c.href=e}))}}else if(r){const{icon:e,...t}=r,n=lt.EK({url:e,width:100,permissionRecord:t.pointer,baseUrl:T.default.domainBaseUrl,fullyQualified:!1,userId:this.environment.currentUser.id});n!==this.lastSetIconString&&(this.lastSetIconString=n,xt.transactionQueue.awaitRecordTransaction(t.pointer).then((()=>St(n))).then((e=>{c.href=e})))}else t!==this.lastSetIconString&&(c.href=t,this.lastSetIconString=t)}S.electronApi&&S.electronApi.setWindowTitle&&i&&S.electronApi.setWindowTitle(i)},this.updateBrowserStateDebounced=He.Ds(this.updateBrowserState,500,{leading:!0}),this.computedStore=this.createComputedStore((()=>{const{intl:e}=this.props,{RouterStore:t,device:n}=this.environment,i=t.state.route,o=I.default.state.mainEditorCurrentBlockStore;if(!o||!o.isReady())return;if("page"!==i.name||i.blockId!==o.id)return;const s=wt.Z.getTotalUnreadMentionsCount(),r=o.getTitleStore();let a;const d=o.getModel(),l=o.getCollectionViewIds(),c=null==r?void 0:r.getRecordModel(r.pointer);if(r&&c){if(a=(0,ht.X)({intl:yt.default.getIntl(),textValue:r.getValue(),userTimeZone:(0,ct.r)(),getRecordModel:o.getRecordModel})||c.getEmptyTitlePlaceholder({getRecordModel:r.getRecordModel,userTimeZone:(0,ct.r)(),intl:e}),"collection"===r.table&&d&&d.isCollectionView()&&l.length>1){const e=I.default.state.currentCollectionViewStore;e&&e.getName()&&(a=`${a} | ${e.getName()}`)}n.isElectron||(a=(0,at.db)(a.slice(0,100),vt.Z.state)),ue.IJ(this.environment,o)||this.environment.device.isElectron||(s>9?a=`(9+) ${a}`:s>0&&(a=`(${s}) ${a}`))}const u=(0,bt.ZP)({store:o,fullyQualified:!1,scrollToBlockId:i.scrollToBlockId,peekViewBlockId:i.peekViewBlockId,peekMode:i.peekMode,collectionViewId:i.collectionViewId,discussionId:i.discussionId,showMoveTo:i.showMoveTo,saveParent:i.saveParent,templateGalleryItem:i.templateGalleryItem,projectManagementLaunch:i.projectManagementLaunch,pageVisitSource:void 0}),p=o.getIcon(),h=null==d?void 0:d.isNonverifiedContentClassification();return{title:a,url:u,icon:p,isNonverified:h,hasBypassedContentClassification:h&&d&&kt.Z.bypassedPage(o.id),isMemberOfSpace:(0,ft.I)({blocks:[o],environment:this.environment,publicEditMode:void 0})}}))}willMount(){this.savedTitle=document.title,this.computedStore.addListener(this.updateBrowserStateDebounced)}willUnmount(){this.computedStore.removeListener(this.updateBrowserStateDebounced),document.title=this.savedTitle}}Ct.displayName="DocumentTitleListener";const Mt=(0,v.injectIntl)(Ct);class Tt extends o.Z{constructor(){super(...arguments),this.konami=void 0,this.unlock=!1,this.handleSuccess=()=>{this.unlock=!0,this.forceUpdate()}}willMountOrUpdate(){this.environment.device.isDesktop?this.loadKonami():this.unloadKonami()}loadKonami(){var e,t;this.konami||(this.konami=(e=this.handleSuccess,(t={addEvent:function(e,t,n){e.addEventListener(t,n,!1)},removeEvent:function(e,t,n){e.removeEventListener(t,n)},input:"",pattern:"38384040373937396665",keydownHandler:function(n){t.input+=n.keyCode,t.input.length>t.pattern.length&&(t.input=t.input.substr(t.input.length-t.pattern.length)),t.input===t.pattern&&(e(),t.input="")},load:function(){this.addEvent(document,"keydown",this.keydownHandler)},unload:function(){this.removeEvent(document,"keydown",this.keydownHandler)}}).load(),t))}unloadKonami(){this.konami&&(this.konami.unload(),this.konami=void 0)}renderComponent(){if(this.unlock)return(0,z.jsx)("img",{className:"nyan",style:{position:"fixed",top:"calc(50vh - 100px)",zIndex:1e3,left:"50%",animationName:"leftOrRight",animationDuration:"9s",animationIterationCount:"infinite",pointerEvents:"none",userSelect:"none"},src:rt.Z.images.nyancatGif})}}Tt.displayName="EasterEgg";const jt=Tt;var It=n(15944),Pt=n(81415);const _t=(0,v.defineMessages)({pressSlashHeader:{id:"EducationTooltips.pressSlash.header",defaultMessage:"Press {slashkey} for commands"}});function At(e){return(0,z.jsx)("div",{style:{background:d.ZP.whiteWithAlpha(.1),padding:3,paddingRight:8,paddingLeft:8,marginRight:6,marginLeft:6,borderRadius:3},children:e.char})}function Lt(){window.__c={n:"PressSlashTooltip"};const e=(0,A.O7)(),t=It.o();return(0,L.VK)((()=>{const{currentUserSettingsStore:e}=I.default.state;var t;return!e||!e.isReady()||Boolean(null===(t=e.getSettings())||void 0===t?void 0:t.pressed_slash_tooltip)}),[])||e.device.isMobile||!t?null:(0,z.jsx)(Pt.U,{hideCloseButton:!0,origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,z.jsx)(v.FormattedMessage,{..._t.pressSlashHeader,values:{slashkey:(0,z.jsx)(At,{char:"/"})}}),content:null,onCloseClick:()=>It.q(e)})}n(30541);var Ut=n(41432),Zt=n(82855),Et=n(16880),Rt=n(9953),Bt=n(3898),Vt=n(42858),Ot=n(39699),Dt=n(69316),Nt=n(83212),zt=n(24666),Ft=n(68894),Wt=n(32302);function qt(e){window.__c={n:"FindAndReplace"};const[t,n]=(0,i.useState)(""),o=(0,i.useCallback)((e=>{Dt.Z.setState({...Dt.Z.state,findQuery:e})}),[]),s=(0,L.VK)((()=>Dt.Z.state),[]);return(0,z.jsx)("div",{children:s.open?(0,z.jsx)(Kt,{...e,find:s.findQuery,setFind:o,replace:t,setReplace:n}):null})}function Kt(e){window.__c={n:"FindAndReplaceComponent"};const{environment:t,pageStore:n,replace:o,setReplace:s,find:r,setFind:a}=e,[d,l]=(0,i.useState)(0);(0,i.useEffect)((()=>{l(-1),"empty"!==zt.default.state.mode&&zt.default.setState({mode:"empty"})}),[r,n]);const c=(0,L.VK)((()=>function(e){const{pageStore:t,find:n}=e;if(!t||!t.getContentStores()||0===n.length)return[];const i=[],o=t.getContentStores();for(;o.length>0;){const e=o.shift(),t=null==e?void 0:e.getType();if(!e||!t)continue;const s=(0,Ut.XD)(t),r=e.getProperties();if(s&&r){const{title:t}=r,o=[...t?Ge.Oqk({textValue:t,substring:n,ignoreCase:!0}).map((t=>({blockId:e.id,propertyType:"title",selection:t,blockStore:e}))):[]];o.length>0&&i.push(...o)}const a=e.getContentStores();a&&o.unshift(...a)}return i}({find:r,pageStore:n})),[r,n]),u=(0,i.useCallback)((async e=>{if(!c||0===c.length)return;const i="down"===e?1:-1,o=c[d+i],[s,r]=[c[0],c[c.length-1]];if(!s||!r)return;const a="down"===e?s:r;switch(e){case"down":l((e=>o?e+i:0));break;case"up":l((e=>o?e+i:c.length-1))}const u=(null==o?void 0:o.blockId)??a.blockId;await Bt.Nz(n,[u]),Vt.WG(t,[u])}),[d,c,t,n]),p=(0,U.yK)((e=>({container:{position:"absolute",top:0,right:0,display:"grid",gridTemplateColumns:"repeat(4, auto)",gridTemplateRows:"repeat(3, auto)",flexDirection:"column",padding:10,margin:"3rem 2rem 0",gap:10,boxShadow:e.lightBoxShadow,backgroundColor:"white",zIndex:999,borderRadius:10}})),[]);return(0,z.jsxs)("div",{style:p.container,children:[(0,z.jsx)(Ht,{currentSelectionIndex:d,totalResults:c.length,jumpToResultFn:u}),(0,z.jsx)(Ft.ZP,{value:r,itemMarginLeft:0,itemMarginRight:0,showClearButton:!0,onChange:e=>a(e.target.value),title:"input title",placeholder:"Find",style:{gridColumn:"1/3",gridRow:"1/1"},onSubmit:()=>u("down"),onCancel:()=>Wt.x(),focusInitial:!0},"find input element"),(0,z.jsx)(Ft.ZP,{value:o,itemMarginLeft:0,itemMarginRight:0,showClearButton:!0,onChange:e=>s(e.target.value),title:"input title",placeholder:"Replace",style:{gridColumn:"1/3",gridRow:"2/2"}},"replace input element"),(0,z.jsx)(O.Z,{onClick:()=>{},style:{gridArea:"3/1"},disabled:!0,children:"Replace"}),(0,z.jsx)(O.Z,{onClick:()=>{!function(e){const{find:t,replace:n,pageStore:i,environment:o}=e,s=null==i?void 0:i.getContentStores();if(!i||i.isLocked()||!s)return;for(;s.length>0;){var r,a;const e=s.shift();if(!e)continue;const i=Nt.Z.getMode(o,e),d=e.canEdit()&&"comment"!==i.permission;if(i.permission,!d)continue;const l=null===(r=e.getModel())||void 0===r?void 0:r.type,c=null===(a=e.getModel())||void 0===a?void 0:a.getProperties();if(c&&l&&(0,Ut.XD)(l)){const i=c.title;if(!i)continue;for(const e of i)e[0]=e[0].replace(t,n);Ot.createAndCommit({userAction:"findAndReplaceAll",environment:o,perform:t=>{Rt.sW({store:e.getPropertiesStore(),data:{title:i},transaction:t})}})}const u=null==e?void 0:e.getContentStores();u&&s.unshift(...u)}}({find:r,replace:o,pageStore:n,environment:t})},style:{gridArea:"3/2"},children:"Replace All"})]})}function Ht(e){const{jumpToResultFn:t,totalResults:n,currentSelectionIndex:i}=e;return(0,z.jsxs)("div",{style:{gridArea:"1/3",fontSize:".8rem",display:"flex",alignItems:"center",gap:"5px"},children:[(0,z.jsxs)("div",{style:{fontSize:".8rem",display:"flex",gap:"5px"},children:[(0,z.jsx)("span",{children:i+1}),(0,z.jsx)("span",{children:"of"}),(0,z.jsx)("span",{children:n})]}),(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{style:{cursor:"pointer"},onClick:()=>t("up"),children:(0,Et.R)({width:10,height:10})}),(0,z.jsx)("div",{style:{cursor:"pointer"},onClick:()=>t("down"),children:(0,Zt.E)({width:10,height:10})})]})]})}var Gt=n(21202),$t=n(3297),Qt=n(87279),Yt=n(78140),Xt=n(32163),Jt=n(50506),en=n(72495),tn=n(26673);class nn extends o.Z{constructor(){super(...arguments),this.didSingleWorkspaceFork=!1}didMountOrUpdate(){const e=(e,t,n,i)=>{this.didSingleWorkspaceFork=!0;return $t.DK({environment:this.environment,store:e,spaceStore:t,spaceViewStore:n,isPrivate:i,context:"public_page_duplicate_single_workspace"})};if(!this.environment.currentUser.isLoggedIn()){const{environment:e}=this;return $t.nM({currentUserId:void 0,blockId:this.props.blockId}),"public_page"!==this.props.from&&"notion_template_gallery"!==this.props.from||f.HU0(e,{from:this.props.from,is_paid:!1,template_block_id:this.props.blockId,public_page_device_id:this.props.tid}),void w.navigate({environment:e,url:p._j.login})}const{currentUserRootStore:t}=I.default.state;if(t&&t&&!this.didSingleWorkspaceFork){const n=P.G.createChildStore(t,{table:Gt.iU,id:this.props.blockId}),i=ae.o(t);if(1===i.length){const t=i[0],o=t.getSpaceStore();if(!o)return;e(n,o,t,!0)}else if(this.props.workspaceId&&i.length>1){const t=i.filter((e=>e.pointer.spaceId===this.props.workspaceId))[0],o=null==t?void 0:t.getSpaceStore();if(!o)return;e(n,o,t,!0)}}}renderComponent(){const{device:e}=this.environment,{currentUserRootStore:t}=I.default.state;if(!t)return;const{mainEditorCurrentBlockStore:n}=I.default.state;if(!n)return;if(!n.isDefined())return;const i=[{key:"spaces",render:t=>(0,z.jsx)(en.Z,{title:e.isMobile?void 0:(0,z.jsx)(v.FormattedMessage,{id:"forkPageScreen.chooseWorkspaceForDuplication.message",defaultMessage:"Choose a workspace to duplicate into"}),isTitleUppercase:!0,...t}),items:tn.default.getSpaceViewMenuItems(this.environment,n)}];let o;return o=e.isMobile?{menuType:Qt.og.Modal,title:(0,z.jsx)(v.FormattedMessage,{id:"forkPageScreen.chooseWorkspace.message",defaultMessage:"Choose a workspace"}),width:"100vw"}:{menuType:Qt.og.Popup,height:"auto"},(0,z.jsx)(Jt.Z,{open:!0,render:()=>(0,z.jsx)("div",{style:this.getStyle(),children:(0,z.jsx)(Yt.Z,{...o,children:(0,z.jsx)(Xt.Z,{type:Xt.i.Vertical,sections:i,initialFocus:1})})})})}getStyle(){const{device:e}=this.environment;return{width:"100vw",height:"100vh",paddingLeft:e.isMobile?16:30,paddingRight:e.isMobile?16:30,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}}nn.displayName="ForkPageScreen";const on=nn;var sn=n(81059),rn=n(24553),an=n(35253),dn=n(4708),ln=n(5382),cn=n(91754);function un(){window.__c={n:"InviteBannerListener"};const e=(0,A.Fy)(),t=(0,A.O7)(),n=(0,L.VK)((()=>I.default.state.currentSpaceStore),[]),{isBannerVisible:o,bannerType:s}=(0,L.VK)((()=>{if(e.isMobile)return{isBannerVisible:!1,bannerType:void 0};if(n&&!(0,dn.fW)(t,{spaceStore:n}))return{isBannerVisible:!1,bannerType:void 0};const i=(0,De.getRedirectType)();return i&&["invite_page","invite_space"].includes(i||"")?{isBannerVisible:!0,bannerType:i}:{isBannerVisible:!1,bannerType:void 0}}),[e.isMobile,n,t]);return i.useEffect((()=>{if(o)switch(s){case"invite_page":an.Bw({bannerStore:ln.Z,id:"InvitePageBanner",contentKey:"invite_page",styleKey:cn.v.PageNotification});break;case"invite_space":an.Bw({bannerStore:ln.Z,id:"InviteSpaceBanner",contentKey:"invite_space",styleKey:cn.v.PageNotification})}return()=>{an.qL({bannerStore:ln.Z,id:"InviteSpaceBanner"}),an.qL({bannerStore:ln.Z,id:"InvitePageBanner"})}}),[o,s,t,n]),null}var pn=n(65556);function hn(){window.__c={n:"PageReloadConfirmationListener"};const e=(0,A.O7)();return(0,i.useEffect)((()=>{function t(t){f.f73(e,{reason:t})}return pn.showConfirmationDialogEventEmitter.addListener(t),()=>{pn.showConfirmationDialogEventEmitter.removeListener(t)}}),[e]),null}var mn=n(82540),gn=n(15145),vn=n(18957),fn=n(61045),Sn=n(43250),bn=n(75079),yn=n(78316),wn=n(85957),kn=n(45010),xn=n(18245),Cn=n(34859),Mn=n(4926),Tn=n(38072),jn=n(42330),In=n(82136),Pn=n(88923),_n=n(42057),An=n(27724),Ln=n(41464),Un=n(23063),Zn=n(3386),En=n(68785),Rn=n(4827),Bn=n(53336),Vn=n(26957),On=n(84844);const Dn=function(){window.__c={n:"MiniPeekBottombar"};const e=(0,A.O7)(),t=(0,L.VK)((()=>Pn.default.peekTarget.state),[]),{collectionStore:n,schema:o,format:s}=(0,On.d)(t),r=(0,L.VK)((()=>{const e=Pn.default.state,i=Boolean(e.open&&e.creationSource===gn.tY.SidebarQuickAdd&&"page"===Tn.Z.state.pageType);return Boolean(!i&&t&&!t.isCollectionViewPageWithContent()&&n&&o&&s)}),[n,s,o,t]),a=(0,U.yK)((()=>({propertiesContainer:{display:"flex",justifyContent:r?"space-between":"flex-end",alignItems:"center"},doneButton:{height:30}})),[r]),d=(0,i.useCallback)((()=>{vn.xv(e,"done_button")}),[e]);let l;return t&&r&&(l=(0,z.jsx)(On.Z,{store:t})),(0,z.jsxs)("div",{style:a.propertiesContainer,children:[l,(0,z.jsx)(B.Z,{onClick:d,style:a.doneButton,children:(0,z.jsx)(v.FormattedMessage,{id:"peekBottomBar.done.title",defaultMessage:"Done"})})]})};var Nn=n(80503),zn=n(34700);function Fn(e){const{theme:t,isSidePeekOpen:n,borderRadius:i}=e;return{zIndex:n?te.LI:te.Bh,background:t.peekModalBackground,borderTopLeftRadius:i??5,borderTopRightRadius:i??5}}function Wn(e){const{environment:t,padding:n,height:i}=e,o=t.device.isMobile?4:n??12;return{height:i??Nn.R6(t.device.isElectronMac)-1,display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:o,paddingRight:o}}function qn(e){return{...(0,zn.X)({noDrag:e.device.isElectronMac}),display:"grid",gridAutoFlow:"column",gridColumnGap:2,alignItems:"center"}}var Kn=n(73935),Hn=n(42853),Gn=n(11302),$n=n(45433),Qn=n(58239);var Yn=n(38755),Xn=n(58261),Jn=n(89728),ei=n(31278),ti=n(76798),ni=n(26388),ii=n(45653);class oi extends o.Z{constructor(){super(...arguments),this.buttonEl=null,this.handleButtonMount=e=>{this.buttonEl=e},this.handleOpenPopup=e=>{if(e.preventDefault(),this.buttonEl){const e=Kn.findDOMNode(this.buttonEl);e&&Gn.bA({environment:this.environment,blocks:[this.props.store],originRect:e.getBoundingClientRect(),moveToContext:this.moveToContext.state,onAccept:this.handleMoveToAccept,isAddTo:!0,isDefaultPrivateLocation:this.isDefaultPrivateLocation(),disableSuccessToast:!0,forceUntyped:this.isUntypedPage()})}},this.handleMoveToAccept=e=>{const{pageType:t,saveParent:n,store:i}=this.props,{currentSpaceStore:o}=I.default.state;if(o&&n){let n;t&&(n=vn.OP(i)),function(e){const{pageType:t,spaceStore:n,currentUserId:i,result:o}=e;(0,Qn.rq)({currentUserId:i,spaceId:n.id,value:o}),t&&(0,Qn.ZT)({currentUserId:i,spaceId:n.id,databaseType:$n.wg[t],parent:o})}({pageType:n||t,spaceStore:o,currentUserId:this.environment.currentUser.id,result:e})}},this.moveToContext=this.createComputedStore((()=>{var e;const t=null===(e=I.default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.id;return t&&((0,me.q0)()||(0,ae.qG)(t))?"aggregated_type":"quick_add"}))}renderComponent(){const{store:e,prefix:t,buttonStyle:n}=this.props,i=e.getParentStore();if(i&&!(i instanceof P.T5)&&!(i instanceof P.zq)&&!(i instanceof P.Vf)){const e=t?(0,z.jsx)("span",{style:{color:this.theme.mediumTextColor,marginRight:4},children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:t.defaultMessage,id:t.id})}):void 0;return(0,z.jsx)(Zn.Z,{capture:!0,onMoveTo:this.handleOpenPopup,children:(0,z.jsx)("div",{style:oi.wrapStyle,children:(0,z.jsx)(ni.Z,{renderTooltip:()=>(0,z.jsxs)("div",{children:[(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Set the default page or database",id:"peekMoveToMenu.tooltip"}),(0,z.jsx)("br",{}),(0,z.jsx)(Xn.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"moveTo"})]}),render:t=>(0,z.jsxs)(Jn.Z,{onClick:this.handleOpenPopup,ref:this.handleButtonMount,shouldShrink:!0,style:n,...t,children:[(0,z.jsx)(ri,{parentStore:i,prefixText:e}),(0,Hn.i)({width:10,marginLeft:4,fill:this.theme.lightTextColor})]})})})})}}isDefaultPrivateLocation(){const e=this.props.store.getParentStore(),{currentSpaceStore:t}=I.default.state;return si(e,t)}isUntypedPage(){return!this.props.pageType||"page"===this.props.pageType}}function si(e,t){return e&&e instanceof P.H2&&t&&e.id===t.id}function ri(e){window.__c={n:"PeekMoveToPageName"};const{parentStore:t,prefixText:n}=e,i=(0,A.O7)(),o=(0,L.VK)((()=>(0,ae.B7)(i)),[i]),s=(0,L.VK)((()=>t instanceof P.G&&t.isEmptyPage()),[t]),r=(0,L.VK)((()=>t instanceof P.H2?(0,Yn.Wd)(i,t):t.getIcon()),[i,t]),a=(0,L.VK)((()=>t instanceof P.H2?(0,Yn.rn)(i,t):void 0),[i,t]),d=(0,L.VK)((()=>{const{currentSpaceStore:e}=I.default.state;return si(t,e)}),[t]),l=(0,U.yK)((()=>({privatePagesText:{fontWeight:R.Z.fontWeight.medium,marginLeft:4,...R.Z.textOverflowStyle,overflow:"hidden"},icon:{marginRight:4,marginTop:1},title:{fontWeight:R.Z.fontWeight.semibold}})),[]);return(0,z.jsx)(z.Fragment,{children:d?(0,z.jsxs)(z.Fragment,{children:[n,(0,z.jsx)(ii.Z,{size:22,avatarShouldShowShadow:!0,userStore:o}),(0,z.jsx)("span",{style:l.privatePagesText,children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Private pages",id:"peekMoveToMenu.addTo.privatePages"})})]}):(0,z.jsxs)(z.Fragment,{children:[n,(0,z.jsx)(ei.Z,{disabled:!0,icon:r,isEmptyPage:s,title:a,size:18,style:l.icon}),(0,z.jsx)(ti.Z,{style:l.title,store:t})]})})}oi.displayName="PeekMoveToMenu",oi.wrapStyle={display:"flex",alignItems:"center",fontSize:14,minWidth:0};const ai=oi;var di=n(3553),li=n(75081),ci=n(16854),ui=n(45811);function pi(e){const{databaseType:t,databaseUri:n,targetStores:o}=e,s=function(e){let{environment:t,blocksToFilterParents:n,databaseType:i}=e;const{currentSpaceStore:o,joinedTeamIds:s}=(0,L.VK)((()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=I.default.state;return{currentSpaceStore:e,joinedTeamIds:null==t?void 0:t.getTeamsStores().map((e=>e.id))}}),[]),[{value:r,status:a}]=(0,Z.r5)((async()=>{if(!o)return;const e=await ci.m1({environment:t,spaceId:o.id,parentStore:o,databaseType:i})??[];return(0,ui.m)({environment:t,typedDatabases:e,spaceStore:o,blocksToFilterParents:n,joinedTeamIds:s||[]})}),[t,o,s,n,i]);return"resolved"===a&&r?{success:!0,typedDatabases:r}:{success:!1}}({databaseType:n,environment:(0,A.O7)(),blocksToFilterParents:o}),r=s.success?s.typedDatabases:void 0;(0,i.useEffect)((()=>{r&&r.length>0&&Tn.Z.setCollectionIdForType(t,r[0].id)}),[t,r])}var hi=n(31945),mi=n(53437),gi=n(52275);function vi(e){window.__c={n:"PageTypeButtonPopup"};const t=(0,A.O7)(),{targetStores:n}=e,o=(0,L.VK)((()=>Tn.Z.state.pageType),[]);!function(e){pi({targetStores:e,databaseType:"tasks",databaseUri:$n.iS}),pi({targetStores:e,databaseType:"projects",databaseUri:$n.wW})}(n);const s=(0,U.yK)((e=>({menuIcon:{width:10,marginLeft:4,fill:e.mediumIconColor},typeButton:{fontWeight:R.Z.fontWeight.semibold,paddingLeft:0,paddingRight:4},typeIcon:{width:15,height:15,marginLeft:4,fill:e.regularIconColor,padding:.9,marginRight:4,marginTop:1}})),[]),r=(0,i.useCallback)((()=>{f.K81(t,{from:"type_picker"})}),[t]);return(0,z.jsx)(hi.ZP,{originGap:4,popupType:mi.kQ.Popup,render:e=>(0,z.jsx)(fi,{parent:e,targetStores:n}),onClick:r,renderOrigin:e=>(0,z.jsxs)(Jn.Z,{...e,style:s.typeButton,children:[li.OW[o](s.typeIcon),(0,z.jsx)(v.FormattedMessage,{...li.Hu[o]}),(0,Hn.i)(s.menuIcon)]})})}function fi(e){window.__c={n:"PageTypeMenu"};const{parent:t,targetStores:n}=e,o=(0,A.O7)(),{pageType:s,databaseIds:r}=(0,L.VK)((()=>Tn.Z.state),[]),{currentSpaceStore:a}=(0,L.VK)((()=>I.default.state),[]),d=(0,i.useCallback)((async e=>{if(!a)return;const i=await async function(e){const{currentUserId:t,pageType:n,spaceStore:i}=e,o=await(0,Qn.k1)({spaceStore:i,currentUserId:t,databaseType:$n.wg[n]});if(o||"page"===n)return o;const s=Tn.Z.getCollectionIdForType(n);return s?{type:"collection",id:s,spaceId:i.id}:void 0}({currentUserId:o.currentUser.id,pageType:e,spaceStore:a}),{performResult:r}=await Ot.createAndCommitAsync({environment:o,userAction:"QuickCaptureTopbar.updatePageType",waitForServerCommit:!1,perform:async e=>{if(i)return Gn.kj({environment:o,value:i,targets:n,transaction:e})}});r&&(Tn.Z.setState({...Tn.Z.state,pageType:e}),f.U52(o,{from:"type_picker",to_page_type:e,from_page_type:s}),t.close())}),[a,o,t,n,s]),l=(0,U.yK)((e=>({icon:{width:15,height:15,fill:e.regularIconColor}})),[]),c={key:"types",items:He.oA($n.zn.map((e=>"page"===e||r[e]?function(e){const{iconStyles:t,pageType:n,selectedPageType:i,onPageTypeClick:o}=e;return{key:n,render:e=>(0,z.jsx)(gi.Z,{...e,title:(0,z.jsx)(v.FormattedMessage,{...li.Hu[n]}),icon:li.OW[n](t),checkState:n===i}),action:()=>o(n)}}({iconStyles:l.icon,pageType:e,selectedPageType:s,onPageTypeClick:d}):void 0))),render:e=>(0,z.jsx)(en.Z,{...e})};return(0,z.jsx)(Yt.Z,{menuType:Qt.og.Popup,children:(0,z.jsx)(Xt.Z,{type:Xt.i.Vertical,sections:[c],initialFocus:$n.zn.findIndex((e=>e===s))})})}const Si=function(e){const{store:t}=e;return(0,z.jsx)(vi,{targetStores:[t]})};var bi=n(68626),yi=n(64530),wi=n(91155),ki=n(8406),xi=n(5149),Ci=n(48543),Mi=n(98165),Ti=n(73063),ji=n(16354),Ii=n(49085),Pi=n(13148),_i=n(3418);class Ai extends o.Z{constructor(){super(...arguments),this.storeTypes={visible:Ii.default.createClass(!1)},this.timeout=void 0,this.renderPopup=()=>(0,z.jsxs)("div",{style:{fontSize:12,color:d.ZP.white,position:"absolute",top:"calc(100% + 12px)",left:"calc(50% - 110px)",background:d.ZP.blue,borderRadius:6,padding:"8px 12px 12px 12px",width:220,boxShadow:this.theme.largeLightBoxShadow,zIndex:99},children:[(0,z.jsx)("div",{style:{position:"absolute",top:-12,left:"calc(50% - 2.5px)",background:d.ZP.blue,width:5,height:5,borderRadius:5,boxShadow:`0 0 0 1.5px ${this.theme.contentBackground}`}}),(0,z.jsx)("div",{style:{position:"absolute",top:-12,left:"calc(50% - 1px)",background:d.ZP.blue,width:2,height:12}}),(0,z.jsx)("div",{style:{width:"90%",fontWeight:500,marginBottom:2},children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"New! Open pages in side peek",id:"peekModeIntroTooltip.title"})}),(0,z.jsx)("div",{style:{opacity:.8,lineHeight:1.35},children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Use Tables, Boards, Lists and Timelines while opening pages on the side for faster workflows. Switch to other peek modes here.",id:"peekModeIntroTooltip.subtitle"})}),(0,z.jsx)(Ti.Z,{icon:Pi.U,style:{position:"absolute",top:4,right:4,opacity:.8},iconStyle:{width:12,fill:d.ZP.white},onClick:this.handleCloseClick})]}),this.handleCloseClick=()=>{vn.Om({environment:this.environment,seen:!0})}}willMountOrUpdate(){this.shouldBeVisible()?(clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.stores.visible.setState(!0)}),500)):(clearTimeout(this.timeout),this.stores.visible.setState(!1))}renderComponent(){const{origin:e}=this.props,{visible:t}=this.stores,{device:n}=this.environment;return n.isMobile?e:(0,z.jsxs)("div",{style:{position:"relative"},children:[e,(0,z.jsx)(Un.Z,{isVisible:t.state,animationStyle:{opacity:1},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:this.renderPopup})]})}shouldBeVisible(){const{device:e}=this.environment;if(e.isPhone)return!1;if(_i.Z.state.openPopups.size>0)return!1;const{currentUserSettingsStore:t}=I.default.state;if(!t||!t.isReady())return!1;const n=t.getSettings();return!(null!=n&&n.signup_time&&(null==n?void 0:n.signup_time)>165888e7)&&(null==n||!n.seen_peek_mode_tooltip)}}Ai.displayName="PeekModeIntroTooltip";const Li=(0,v.injectIntl)(Ai),Ui=(0,v.defineMessages)({changeForThisView:{id:"peekTopbar.changePeekOption.changeForThisView",defaultMessage:"Edit view default"}});class Zi extends o.Z{constructor(){super(...arguments),this.getPeekModeUrl=e=>{const{store:t}=this.props,{mainEditorCurrentBlockStore:n}=I.default.state,i=Mi.uJ(t),o=t.isNavigableBlock()?i.slice(1):[...i],s=o.length>0?o[0]:void 0;return(0,yn.mb)({store:t,mainEditorCurrentBlockStore:s instanceof P.G&&!Pn.default.state.open?s:n,collectionContextStore:Pn.default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,Pn.getPeekModeFromCollectionPeekModeFormat)(e)})},this.handlePeekModePickerClick=()=>{if(!Pn.default.state.open)return;const e=Pn.default.state.collectionContextStore;e?ki.nS({environment:this.environment,collectionContextStore:e,from:"peek_topbar",peek_target_id:Pn.default.state.target.id,from_peek_mode:Pn.default.state.mode}):f.v2k(this.environment,{from:"peek_topbar",peek_target_id:Pn.default.state.target.id,from_peek_mode:Pn.default.state.mode})}}willMount(){const e=this.getPeekModeFormatOptions(),t=this.props.overridePeekMode||Pn.default.getPeekMode(),n=e.find((e=>He.Xy(e.key,t)));this.props.hideCurrentPeekModeSelection||n||bi.log({level:"warning",from:"TopbarPeekModeButton",type:"InvalidSelectedPeekMode",error:(0,wi.Ui)("Selected key is invalid.")})}renderComponent(){const{device:e}=this.environment,{mainEditorCurrentBlockStore:t}=I.default.state,n=this.getPeekModeFormatOptions(),i=this.props.overridePeekMode||Pn.default.getPeekMode();return i?(0,z.jsx)(hi.ZP,{popupType:e.isMobile?mi.kQ.SlideUp:mi.kQ.Popup,alignmentToOrigin:hi.vR.Center,placementToOrigin:hi.pO.Bottom,style:{minWidth:190},originGap:0,onClick:this.handlePeekModePickerClick,renderOrigin:e=>(0,z.jsx)(Li,{origin:(0,z.jsx)(ni.Z,{renderTooltip:()=>(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Switch peek mode",id:"peekTopbar.openPagesAs.button"})}),render:t=>(0,z.jsx)(Ti.Z,{...e,...t,icon:(0,Ci.RO)(i),iconStyle:{fill:this.theme.mediumIconColor},style:this.props.buttonStyle})})}),render:o=>{var s,r,a;let d;d=e.isMobile?{menuType:Qt.og.ActionSheet}:{menuType:Qt.og.Popup,width:220};const l=He.oA([...n.map(((e,t)=>{const n=e.key,s="full_page"===n?(0,bt.ZP)({store:this.props.store,fullyQualified:!1,pageVisitSource:gn.tY.Expand}):this.getPeekModeUrl(n);return{key:t,render:t=>(0,z.jsx)(ji.Z,{href:s,onClick:()=>{var e;vn.Om({environment:this.environment,seen:!0}),f.UZT(this.environment,{from:"peek_topbar",peek_mode:n,from_peek_mode:i,target_page_id:null===(e=Pn.default.peekTarget.state)||void 0===e?void 0:e.id}),o.close()},children:(0,z.jsx)(gi.Z,{...t,disabled:!1,title:e.title,icon:e.icon,caption:e.caption,body:e.body,checkState:!this.props.hideCurrentPeekModeSelection&&He.Xy(e.key,i)})}),action:()=>{}}}))]),c=Pn.default.state.open?Pn.default.state.collectionContextStore:void 0,u=Pn.default.state.open?Pn.default.state.target:void 0,p=t&&t.id===(null==c||null===(s=c.collectionViewBlockStore())||void 0===s?void 0:s.getRecordStoreUIRoot().id),h=(null==c||null===(r=c.collectionStore())||void 0===r?void 0:r.id)===(null==u||null===(a=u.getAssociatedCollectionStore())||void 0===a?void 0:a.id)&&(null==c?void 0:c.permissionScopes.state.canConfigureBlock)&&p;return(0,z.jsx)(Yt.Z,{...d,children:(0,z.jsx)(Xt.Z,{type:Xt.i.Vertical,sections:He.oA([{key:0,render:e=>(0,z.jsx)(en.Z,{enableActionSheetTitle:!0,...e}),items:l},h&&{key:1,render:e=>(0,z.jsx)(en.Z,{enableActionSheetTitle:!0,topBorder:!0,...e}),items:[{key:"change_for_view",render:e=>(0,z.jsx)(gi.Z,{...e,disabled:!1,title:yt.default.formatMessage(Ui.changeForThisView),icon:(0,yi.y)({width:16,height:16,fill:this.theme.regularIconColor})}),action:e=>{this.handlePeekModeChangeForViewClick(),o.close()}}]}]),initialFocus:0})})}}):null}getPeekModeFormatOptions(){return["side_peek","center_peek","full_page"].map((e=>({key:e,title:(0,Ci.LQ)(e),icon:(0,Ci.RO)(e)({width:16,fill:this.theme.mediumTextColor})})))}handlePeekModeChangeForViewClick(){const e=Pn.default.state.open?Pn.default.state.collectionContextStore:void 0;e&&(vn.Om({environment:this.environment,seen:!0}),Pn.default.isCenterPeekOpen()&&this.props.onClose&&this.props.onClose(),xi.r$({collectionContextStore:e,collectionSettingsStore:e.settingsStore}),xi.H4({collectionSettingsStore:e.settingsStore,item:{type:"layout"}}),e.settingsStore.setState({...e.settingsStore.state,openButtonPopup:"peekModeFormat"}))}}Zi.displayName="TopbarPeekModeButton";const Ei=Zi;var Ri=n(58810);const Bi=function(e){window.__c={n:"TopbarPeekOpenAsPageButton"};const{store:t,shouldShowMoveToMenu:n}=e,o=(0,A.O7)(),s=(0,v.useIntl)(),r=(0,L.VK)((()=>(0,bt.ZP)({store:t,fullyQualified:!1,pageVisitSource:gn.tY.Expand})),[t]),a=(0,U.yK)((e=>({keyboardShortcut:{color:e.mediumInvertedTextColor},iconButtonWrapper:{height:24}})),[]),d=(0,i.useCallback)((()=>{var e,t,i;f.sxo(o,{isNewPage:n,peek_mode:Pn.default.state.mode,from:"topbar_button",target_page_id:null===(e=Pn.default.peekTarget.state)||void 0===e?void 0:e.id}),f.$CH(o,{peek_mode:Pn.default.state.mode,from:"topbar_open_as_page_button",target_page_id:null===(t=Pn.default.peekTarget.state)||void 0===t?void 0:t.id,target_parent_id:null===(i=Pn.default.peekTarget.state)||void 0===i?void 0:i.getParentId(),target_page_type:"mini_peek"===Pn.default.state.mode?Tn.Z.state.pageType:void 0})}),[o,n]);return(0,z.jsx)(ni.Z,{renderTooltip:()=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Open in full page",id:"peekTopbar.navigateToPage.tooltip"})}),(0,z.jsx)(Xn.Z,{style:a.keyboardShortcut,name:"commandEnter"})]}),render:e=>(0,z.jsx)("div",{style:a.iconButtonWrapper,children:(0,z.jsx)(Ti.Z,{...e,icon:Ri.Z,iconStyle:{width:16,height:16},href:r,onClick:d,ariaLabel:s.formatMessage({id:"peekTopbar.navigateToPage.tooltip",defaultMessage:"Open in full page"})})})})},Vi=(0,v.defineMessages)({page:{defaultMessage:"New page in {location}",id:"miniPeekTopbar.staticTitle.page"},project:{defaultMessage:"New project in {location}",id:"miniPeekTopbar.staticTitle.project"},task:{defaultMessage:"New task in {location}",id:"miniPeekTopbar.staticTitle.task"}});function Oi(e){window.__c={n:"TopbarTypeAndLocationPickers"};const{shouldShowMoveToMenu:t,store:n}=e,i=(0,L.VK)((()=>Tn.Z.state.pageType),[]),o=(0,L.VK)((()=>null==n?void 0:n.getParentStore()),[n]),s=(0,L.VK)((()=>Tn.Z.getCollectionIdForType("tasks")||Tn.Z.getCollectionIdForType("projects")),[]),r=(0,U.yK)((e=>({prefixText:{color:e.mediumTextColor,fontSize:14},staticTextContainer:{display:"flex",fontSize:14,alignItems:"center"}})),[]);return t?s?(0,z.jsx)(v.FormattedMessage,{defaultMessage:"<prefix>New</prefix> {pageTypeMenu} <prefix>in</prefix> {moveToMenu}",id:"miniPeekTopbar.typeAndMoveMenus.new",values:{prefix:e=>(0,z.jsx)("span",{style:r.prefixText,children:e}),pageTypeMenu:(0,z.jsx)(Si,{store:n}),moveToMenu:(0,z.jsx)(Di,{store:n,shouldShowMoveToMenu:t})}}):(0,z.jsx)("div",{style:r.staticTextContainer,children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"New page in {moveToMenu}",id:"miniPeekTopbar.staticPageTypeAndMoveMenu.new",values:{moveToMenu:(0,z.jsx)(Di,{store:n,shouldShowMoveToMenu:t})}})}):(0,z.jsx)(Ni,{pageType:i,parentStore:o})}function Di(e){window.__c={n:"TopbarMoveToMenu"};const{store:t,shouldShowMoveToMenu:n}=e,i=(0,L.VK)((()=>Pn.default.state),[]),o=(0,L.VK)((()=>Tn.Z.state.pageType),[]),s=(0,U.yK)((()=>({buttonStyle:{paddingLeft:2,paddingRight:4}})),[]);return i.open&&n?(0,z.jsx)(ai,{store:t,saveParent:i.saveParent,buttonStyle:s.buttonStyle,forceUntyped:"page"===o,pageType:o}):null}function Ni(e){window.__c={n:"StaticTitleForType"};const{pageType:t,parentStore:n}=e,i=(0,U.yK)((()=>({pageNameWrapper:{display:"inline-flex",alignItems:"center",marginLeft:2},staticTextContainer:{display:"flex",fontSize:14,alignItems:"center"}})),[]);if(!n||n instanceof P.T5||n instanceof P.zq)return null;const o=(0,z.jsx)("div",{style:i.pageNameWrapper,children:(0,z.jsx)(ri,{parentStore:n})});let s=Vi.page;return"tasks"===t?s=Vi.task:"projects"===t&&(s=Vi.project),(0,z.jsx)("div",{style:i.staticTextContainer,children:(0,z.jsx)(v.FormattedMessage,{...s,values:{location:o}})})}const zi=function(e){window.__c={n:"MiniPeekTopbar"};const{store:t,onClose:n}=e,i=(0,A.O7)(),o=(0,L.VK)((()=>Pn.default.state),[]),s=(0,L.VK)((()=>Pn.default.isSidePeekOpen()),[]),r=(0,U.yK)((e=>({buttonsContainerStyle:Wn({environment:i,padding:0,height:28}),containerStyles:{...Fn({theme:e,isSidePeekOpen:s,borderRadius:10}),paddingTop:16,paddingBottom:16},controlsStyle:{...qn(i),marginLeft:6},filler:{flexGrow:1,flexShrink:1},modeSwitcherButton:{marginRight:4},prefixText:{color:e.mediumTextColor,fontSize:14}})),[i,s]);if(!o.open||!t)return null;const{showMoveTo:a}=o;return(0,z.jsx)(di.Z,{store:t,disableRectangularSelection:!0,disableEditNearestBlock:!0,isPeekRenderer:!0,render:e=>{let{selectableEvents:i}=e;return(0,z.jsx)("div",{...i,style:r.containerStyles,children:(0,z.jsxs)("div",{style:r.buttonsContainerStyle,children:[(0,z.jsx)("div",{style:r.controlsStyle,children:(0,z.jsx)(Oi,{shouldShowMoveToMenu:a,store:t})}),(0,z.jsx)("div",{style:r.filler}),(0,z.jsx)(Ei,{store:t,onClose:n,hideCurrentPeekModeSelection:!0,buttonStyle:r.modeSwitcherButton}),(0,z.jsx)(Bi,{store:t,shouldShowMoveToMenu:a})]})})}})};var Fi=n(85164),Wi=n(31192),qi=n(7525),Ki=n(73742),Hi=n(91551);const Gi=new(n(61766).Z);var $i=n(98452),Qi=n(99332),Yi=n(24612),Xi=n(22789),Ji=n(60526),eo=n(79075),to=n(96677),no=n(10137),io=n(63437),oo=n(67485),so=n(12253),ro=n(19368),ao=n(23727);const lo=(0,v.defineMessages)({moveToPrefixText:{id:"peekMoveToMenu.addTo.addTo",defaultMessage:"Add to"}});class co extends o.Z{renderComponent(){const{store:e,shouldShowMoveToMenu:t}=this.props,n=Pn.default.isSidePeekOpen();return(0,z.jsx)(di.Z,{store:e,disableRectangularSelection:!0,disableEditNearestBlock:!0,isPeekRenderer:!0,render:i=>{let{selectableEvents:o}=i;return(0,z.jsxs)("div",{...o,style:Fn({theme:this.theme,isSidePeekOpen:n}),children:[(0,z.jsxs)("div",{style:Wn({environment:this.environment}),children:[(0,z.jsxs)("div",{style:qn(this.environment),children:[this.renderPeekClose(),(0,z.jsx)(Bi,{store:e,shouldShowMoveToMenu:t}),Pn.default.state.open&&(0,z.jsx)(Ei,{store:e,onClose:this.props.onClose}),this.renderPeekNavArrows(),this.renderMoveToMenu(),(0,z.jsx)(Xi.Z,{store:e,isMobile:!1,buttonStyle:{...!this.props.shouldShowMoveToMenu&&{marginLeft:12}}})]}),(0,z.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),this.renderActionButtons()]}),(0,z.jsx)(j.LazyBannersRenderer,{banners:Hi.Z.state.banners,isMobile:!1,isInPeekRenderer:!0})]})}})}renderPeekClose(){if(Pn.default.isSidePeekOpen())return(0,z.jsx)(ni.Z,{renderTooltip:()=>(0,z.jsxs)("div",{children:[(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Close",id:"peekTopbar.close.button"}),(0,z.jsx)("br",{}),(0,z.jsx)(Xn.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"esc"})]}),render:e=>(0,z.jsx)(Ti.Z,{...e,icon:qi.t,iconStyle:{width:16,height:16},onClick:()=>this.props.onClose("close_button")})})}renderPeekNavArrows(){if(!Pn.default.state.open)return;if(this.props.shouldShowMoveToMenu)return;const{target:e,resultsStore:t}=Pn.default.state,n=null==t?void 0:t.getState(),i=e.id;return n&&n.length>0&&n.some((e=>e.id===i))?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(io.Z,{}),(0,z.jsx)(ni.Z,{renderTooltip:()=>(0,z.jsxs)("div",{children:[(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Previous page",id:"peekTopbar.peekNavUpArrow.tooltip"}),(0,z.jsx)("br",{}),(0,z.jsx)(Xn.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"peekUp"})]}),render:e=>(0,z.jsx)(Ti.Z,{...e,disabled:i===n[0].id,icon:Et.R,onClick:()=>w.goUpInPeekMode(),iconStyle:{fill:this.theme.mediumIconColor}})}),(0,z.jsx)(ni.Z,{renderTooltip:()=>(0,z.jsxs)("div",{children:[(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Next page",id:"peekTopbar.peekNavDownArrow.tooltip"}),(0,z.jsx)("br",{}),(0,z.jsx)(Xn.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"peekDown"})]}),render:e=>(0,z.jsx)(Ti.Z,{...e,disabled:i===n[n.length-1].id,icon:Zt.E,onClick:()=>w.goDownInPeekMode(),iconStyle:{fill:this.theme.mediumIconColor}})})]}):void 0}renderMoveToMenu(){const e=Pn.default.state,t=this.props.store.getParentCollectionStore(),n=(null==t?void 0:t.getDatabaseType())===$n.iS?"tasks":void 0;if(e.open&&this.props.shouldShowMoveToMenu)return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(io.Z,{}),(0,z.jsx)(ai,{store:this.props.store,saveParent:e.saveParent,prefix:lo.moveToPrefixText,pageType:n})]})}renderActionButtons(){const{device:e}=this.environment,{store:t,spaceStore:n,spaceViewStore:i}=this.props,o=(0,ue.IJ)(this.environment,t),s=ae.qG(t.id),r=!e.isMobile&&n&&i&&!o&&!s,a=Boolean(n&&!n.canEdit()),d=n&&i&&!o&&(0,Ji.UP)({isSpaceGuest:a,canEditPage:t.canEdit()})&&!s;return(0,z.jsxs)("div",{style:this.getActionButtonsWrapStyle(),children:[t.isRestricted()&&(0,z.jsx)(so.Z,{style:{marginRight:14},onClick:()=>{Qi.Z.setState({open:!0})}}),t.canEdit()&&(0,z.jsx)(oo.Z,{rootStore:t,pageVisitStore:this.props.pageVisitStore,presenceStore:this.props.presenceStore}),d&&(0,z.jsx)(ro.Z,{store:t,buttonPopupStore:Qi.Z}),r&&(0,z.jsx)(eo.Z,{blockStore:t,spaceStore:n,buttonPopupStore:Gi}),r&&(0,z.jsx)(ao.Z,{blockStore:t,spaceStore:n,buttonPopupStore:Yi.Z}),n&&i&&!o&&(0,z.jsx)(to.Z,{store:t,spaceViewStore:i}),s&&(0,z.jsx)(Ki.Z,{}),r&&(0,z.jsx)(no.Z,{store:t,buttonPopupStore:$i.Z})]})}getWrapStyle(){return{zIndex:Pn.default.isSidePeekOpen()?te.LI:te.Bh,background:this.theme.peekModalBackground,borderTopLeftRadius:5,borderTopRightRadius:5}}getStyle(){const{device:e}=this.environment,t=e.isMobile?4:12;return{height:Nn.R6(this.environment.device.isElectronMac)-1,display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:t,paddingRight:t}}getActionButtonsWrapStyle(){return{display:"flex",alignItems:"stretch",flexGrow:0,flexShrink:0,zIndex:1}}}co.displayName="PeekTopbar";const uo=co;var po=n(78901),ho=n(55064);const mo=(0,v.defineMessages)({miniPeekEmptyTitlePlaceholder:{defaultMessage:"Start writing...",id:"pageViewBlock.miniPeekView.emptyTitlePlaceholder"},miniPeekEmptyTaskTitlePlaceholder:{defaultMessage:"Task title",id:"pageViewBlock.miniPeekView.emptyTaskTitlePlaceholder"},miniPeekEmptyProjectTitlePlaceholder:{defaultMessage:"Project title",id:"pageViewBlock.miniPeekView.emptyProjectTitlePlaceholder"}});function go(){window.__c={n:"MiniPeekRenderer"};const e=(0,A.O7)(),t=(0,L.VK)((()=>Pn.default.peekTarget.state),[]),n=(0,L.VK)((()=>wn.I_()),[]),o=(0,L.VK)((()=>wn.yT()),[]),s=(0,i.useCallback)((t=>{Io(e,t)}),[e]);return o?(0,z.jsx)(vo,{onClose:s,store:t}):(0,z.jsx)(fo,{onClose:s,store:t,isExpanding:!n})}function vo(e){window.__c={n:"ExpandedMiniPeekRenderer"};const{onClose:t,store:n}=e,{open:i}=(0,L.VK)((()=>Pn.default.state),[]),o=(0,L.VK)((()=>Mn.Z.state),[]),s=(0,U.yK)((e=>({barContainerStyles:{padding:"0 20px 20px"},containerStyles:{...xo(),background:"rgba(29, 27, 22, 0.1)"},contentStyles:{...Co(e,o),height:`calc(100% - ${Pn.PeekModeOuterPadding}px*2)`}})),[o]);return(0,z.jsx)(Rn.Z,{open:i,trapFocus:!0,children:(0,z.jsx)(wo,{enableCaptureClick:!0,horizontalPadding:Pn.PeekModePadding.horizontal[Pn.PeekModeMini],pageViewBlockContext:In.S.PeekView,priority:void 0,showResizer:!1,styles:s,preventDefaultTitleTabBehavior:!0,preventDefaultTitleUntabBehavior:!0,bottomPadding:0,topBar:(0,z.jsx)("div",{style:s.barContainerStyles,children:(0,z.jsx)(zi,{onClose:t,store:n})}),bottomBar:(0,z.jsx)("div",{style:s.barContainerStyles,children:(0,z.jsx)(Dn,{})})})})}function fo(e){window.__c={n:"CollapsedMiniPeekRenderer"};const{onClose:t,store:n,isExpanding:i}=e,o=(0,v.useIntl)(),s=(0,L.VK)((()=>Pn.default.state),[]),r=(0,L.VK)((()=>Mn.Z.state),[]),a=(0,L.VK)((()=>Tn.Z.state.pageType),[]),d=(0,U.yK)((e=>{let t={};return i&&(t={minHeight:300,height:"fit-content",maxHeight:`calc(100% - ${Pn.PeekModeOuterPadding}px*2)`}),{containerStyles:{...xo(),background:"rgba(29, 27, 22, 0.1)"},contentStyles:{...Co(e,r),top:Pn.PeekModeOuterPadding,height:300,padding:"0 20px 20px",...t},pageViewBlockStyles:{padding:"12px 4px 20px 4px"},pageTitleStyles:{fontWeight:R.Z.fontWeight.medium,fontSize:22,lineHeight:1.4}}}),[r,i]);let l;return l="tasks"===a?o.formatMessage(mo.miniPeekEmptyTaskTitlePlaceholder):"projects"===a?o.formatMessage(mo.miniPeekEmptyProjectTitlePlaceholder):o.formatMessage(mo.miniPeekEmptyTitlePlaceholder),(0,z.jsx)(Rn.Z,{open:s.open,trapFocus:!0,children:(0,z.jsx)(wo,{enableCaptureClick:!0,horizontalPadding:Pn.PeekModePadding.horizontal[Pn.PeekModeMini],pageViewBlockContext:In.S.MiniPeekView,priority:void 0,showResizer:!1,styles:d,titlePlaceholder:l,preventDefaultTitleTabBehavior:!0,preventDefaultTitleUntabBehavior:!0,bottomPadding:0,topBar:(0,z.jsx)(zi,{onClose:t,store:n}),bottomBar:(0,z.jsx)(Dn,{})})})}function So(){window.__c={n:"CenterPeekRenderer"};const{open:e}=(0,L.VK)((()=>Pn.default.state),[]),t=(0,L.VK)((()=>Mn.Z.state),[]),n=(0,U.yK)((e=>({containerStyles:{...xo(),background:e.overlaySmokescreen},contentStyles:{...Mo(e),top:Pn.PeekModeOuterPadding,left:Pn.PeekModeOuterPadding,right:Pn.PeekModeOuterPadding,marginRight:"auto",height:`calc(100% - ${Pn.PeekModeOuterPadding}px*2)`,maxWidth:Pn.CenterPeekModeOuterWidth+t,borderRadius:3}})),[t]);return(0,z.jsx)(Rn.Z,{open:e,children:(0,z.jsx)(wo,{enableCaptureClick:!0,horizontalPadding:Pn.PeekModePadding.horizontal[Pn.PeekModeCenter],pageViewBlockContext:In.S.PeekView,priority:void 0,showResizer:!1,styles:n,topBar:(0,z.jsx)(yo,{})})})}function bo(){window.__c={n:"SidePeekRenderer"};const e=(0,A.O7)(),t=(0,L.VK)((()=>Pn.default.state),[]),n=(0,L.VK)((()=>Pn.default.getSidePeekWidth(e.WindowSizeStore.state.width)),[e]),i=(0,U.yK)((e=>({containerStyles:{position:"fixed",top:0,right:0,bottom:0,translateX:n,width:n,zIndex:te.YO},contentStyles:{...Mo(e),top:0,right:0,width:"100%",height:"100%",borderRadius:0}})),[n]);return(0,z.jsx)(Un.Z,{isVisible:!0,useCompositeLayer:!0,animationStyle:{translateX:t.open&&!t.isClosing?0:n},springConfig:{translateX:{stiffness:t.open&&t.isClosing?50:80,precision:1}},render:()=>(0,z.jsx)(wo,{enableCaptureClick:!1,horizontalPadding:Pn.PeekModePadding.horizontal[Pn.PeekModeSide],pageViewBlockContext:In.S.PeekView,priority:-1,showResizer:!0,styles:i,topBar:(0,z.jsx)(yo,{})}),enterAnimationStyle:{translateX:t.open?0:n},onAnimationEnd:()=>{t.open&&t.isClosing?(Pn.default.setState({...t,isClosing:!1}),vn.ME()):t.open&&t.isOpening&&Pn.default.setState({...t,isOpening:!1})}})}function yo(){window.__c={n:"SideAndCenterPeekTopbar"};const e=(0,A.O7)(),t=(0,L.VK)((()=>Pn.default.state),[]),{currentSpaceStore:n,currentSpaceViewStore:i}=(0,L.VK)((()=>I.default.state),[]);return t.open?(0,z.jsx)(uo,{store:t.target,spaceStore:n,spaceViewStore:i,pageVisitStore:t.pageVisitStore,presenceStore:t.presenceStore,shouldShowMoveToMenu:t.showMoveTo,onClose:t=>{Io(e,t)}}):null}function wo(e){window.__c={n:"PeekContainer"};const{priority:t}=e,n=(0,A.O7)(),o=(0,L.VK)((()=>Pn.default.state),[]),{shouldShowFrame:s}=(0,L.VK)((()=>(0,ae.h1)(n)),[n]),r=(0,L.VK)((()=>wn.Tx()),[]),a=(0,L.VK)((()=>o.open&&0===An.default.state.stores.length&&!An.default.state.pivot&&"editing"!==zt.default.state.mode&&!jn.ZP.state.isOpen),[o.open]),d=(0,i.useCallback)((()=>{Po(n)}),[n]),l=(0,i.useCallback)((()=>{!function(e){Pn.default.peekTarget.state&&(w.navigateToBlock({environment:e,store:Pn.default.peekTarget.state,pageVisitSource:gn.tY.Expand}),f.sxo(e,{isNewPage:Pn.default.state.open&&Pn.default.state.showMoveTo,peek_mode:Pn.default.state.mode,from:"command_enter",target_page_id:Pn.default.peekTarget.state.id}),f.$CH(e,{peek_mode:Pn.default.state.mode,from:"command_enter",target_page_id:Pn.default.peekTarget.state.id,target_parent_id:Pn.default.peekTarget.state.getParentId(),target_page_type:"mini_peek"===Pn.default.state.mode?Tn.Z.state.pageType:void 0}))}(n)}),[n]);return s?o.open?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ln.Z,{priority:t,capture:r}),(0,z.jsx)(Zn.Z,{capture:a,onEsc:d,onCommandEnter:l,children:(0,z.jsx)(ko,{...e})},o.target.id)]}):(0,z.jsx)(ko,{...e}):null}function ko(e){window.__c={n:"PeekContentContainer"};const{enableCaptureClick:t,bottomBar:n,horizontalPadding:o,pageViewBlockContext:s,showResizer:r,topBar:a,styles:d,titlePlaceholder:l,preventDefaultTitleTabBehavior:c,preventDefaultTitleUntabBehavior:u,bottomPadding:p}=e,h=(0,i.useRef)(void 0);kn.Z.PeekViewScroller=h.current;const m=(0,v.useIntl)(),g=(0,A.O7)(),f=(0,L.VK)((()=>Pn.default.state),[]),S=(0,L.SI)((()=>f.open?Nt.Z.getMode(g,f.target):Nt.m.disabled),[g,f]),b=(0,L.VK)((()=>{if(!f.open)return;const{currentSpaceStore:e,currentSpaceViewStore:t}=I.default.state;return{pageStore:f.target,spaceStore:e,spaceViewStore:t,presenceStore:f.presenceStore,pageVisitStore:f.pageVisitStore,publicEditModeStore:S}}),[f,S]),y=(0,i.useCallback)((()=>{Po(g)}),[g]),w=(0,i.useCallback)((e=>{let{startTime:t,endTime:n}=e;const i=f.open?yn.fm(f.target):void 0;xn.default.measure({metricName:"collections.max_scroll_lag_in_session",startTime:t,endTime:n},{environment:g,data:bn.vS(i)})}),[g,f]),k=(0,i.useCallback)((()=>{!function(e){Io(e,"empty_space_click")}(g)}),[g]);return(0,z.jsx)(mn.Mi,{value:b,children:(0,z.jsx)("div",{role:"region","aria-label":m.formatMessage({id:"peekRenderer.ariaLabel",defaultMessage:"Side Peek"}),"aria-hidden":!f.open||void 0,style:d.containerStyles,className:Sn.p1Q,children:f.open&&(0,z.jsxs)(z.Fragment,{children:[t&&(0,z.jsx)("div",{style:{width:"100%",height:"100%"},onClick:k}),(0,z.jsxs)("div",{style:d.contentStyles,children:[r&&(0,z.jsx)(ho.Z,{type:"peek"}),a,(0,z.jsx)(di.Z,{store:f.target,isDefaultContainer:!0,droppable:!0,isPeekRenderer:!0,render:e=>{let{selectableEvents:t,selectableHoverMenuOverlay:n}=e;return(0,z.jsx)(i.Suspense,{fallback:(0,z.jsx)(Vn.Z,{peekMode:Pn.default.getPeekMode(),isVisible:!0,store:f.target}),children:(0,z.jsx)(Fi.Z,{pageStore:f.target,pageVisitStore:f.pageVisitStore,initialChunkSize:25,incrementChunkSize:25,store:f.loadingContainerStore,render:e=>{let{ready:r,initialRequestCompleted:a,endOfResultsReached:m,isCollectionInPage:v}=e;return(0,z.jsxs)(i.Fragment,{children:[(0,z.jsxs)(Bn.Z,{ref:h,onScrollLagMeasure:v?w:void 0,preventType:r?fn.Q7(g):Cn.Z.All,type:Cn.Z.Y,style:{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",transform:"translateZ(0)",...r?{}:To},store:_n.Z,...t,children:[n,(0,de.GD)(S.state)&&(0,z.jsx)(ie.GC,{scrollerStore:_n.Z}),a&&(0,z.jsxs)(i.Fragment,{children:[(0,z.jsx)(Wi.Z,{context:s,loadingContainerStore:f.loadingContainerStore,store:f.target,onTitleEsc:y,preventDefaultTitleTabBehavior:c,preventDefaultTitleUntabBehavior:u,forceSelectTitleOnMount:!0,paddingLeft:o,paddingRight:o,paddingBottom:p??80,titleStyle:d.pageTitleStyles,titlePlaceholder:l,pageCoverHeight:"20vh",disabled:!f.open||f.isClosing,style:d.pageViewBlockStyles}),(0,z.jsx)(po.Z,{pageVisitStore:f.pageVisitStore,presenceStore:f.presenceStore,isPeekView:!0})]}),r&&!m&&(0,z.jsx)(En.Z,{style:{zIndex:1,opacity:.5,width:jo,height:jo,marginTop:0,marginBottom:24,marginLeft:"auto",marginRight:"auto"}})]}),(0,z.jsx)(Vn.Z,{peekMode:Pn.default.getPeekMode(),isVisible:!r,store:f.target})]})}})})}},f.target.id),n]})]})})})}function xo(){return{position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:te.Nn}}function Co(e,t){return{...Mo(e),top:Pn.PeekModeOuterPadding,left:Pn.PeekModeOuterPadding,right:Pn.PeekModeOuterPadding,marginRight:"auto",width:`${Pn.MiniPeekWidthPercentage}%`,minWidth:Pn.MiniPeekModeMinWidth+t,maxWidth:Pn.MiniPeekModeMaxWidth+t,borderRadius:10}}function Mo(e){return{flexDirection:"column",position:"absolute",display:"flex",marginLeft:"auto",background:e.peekModalBackground,boxShadow:e.largeLightBoxShadow}}const To={opacity:0,pointerEvents:"none",height:0},jo="1.375em";function Io(e,t){vn.xv(e,t)}function Po(e){Io(e,"esc")}const _o=function(){window.__c={n:"PeekRenderer"};const e=(0,A.O7)(),t=(0,i.useCallback)((()=>{Pn.default.state.open&&Pn.default.isSidePeekOpen()&&(ge.toggleLeftSidebarByWindowSize(e),Pn.default.setState({...Pn.default.state,isOpening:!1}))}),[e]);switch((0,i.useEffect)((()=>(e.WindowSizeStore.addListener(t),e.WindowSizeStore.removeListener(t))),[e.WindowSizeStore,t]),(0,L.VK)((()=>Pn.default.getPeekMode()),[])){case Pn.PeekModeMini:return(0,z.jsx)(go,{});case Pn.PeekModeCenter:return(0,z.jsx)(So,{});case Pn.PeekModeSide:return(0,z.jsx)(bo,{})}};var Ao=n(20993),Lo=n(64275),Uo=n(55449),Zo=n(15157),Eo=n(60113);const Ro=(0,v.defineMessages)({"7e89f436-7aac-4f66-b0a6-6e65ec868d2a.a.title":{defaultMessage:"Import your workspace (A)",id:"templateChecklist.quickNote.a.title"},"7e89f436-7aac-4f66-b0a6-6e65ec868d2a.a.description":{defaultMessage:"See your docs and wiki in action (A)",id:"templateChecklist.quickNote.a.description"},"7e89f436-7aac-4f66-b0a6-6e65ec868d2a.b.title":{defaultMessage:"Import your workspace (B)",id:"templateChecklist.quickNote.b.title"},"7e89f436-7aac-4f66-b0a6-6e65ec868d2a.b.description":{defaultMessage:"See your docs and wiki in action (B)",id:"templateChecklist.quickNote.b.description"},"7e89f436-7aac-4f66-b0a6-6e65ec868d2a.c.title":{defaultMessage:"Import your workspace (C)",id:"templateChecklist.quickNote.c.title"},"7e89f436-7aac-4f66-b0a6-6e65ec868d2a.c.description":{defaultMessage:"See your docs and wiki in action (C)",id:"templateChecklist.quickNote.c.description"}});function Bo(e){return`templateChecklist--${e}--visible`}class Vo extends Ii.default{getInitialState(){return{open:!0}}}const Oo=new Vo;class Do extends Ii.default{getInitialState(){return{templateChecklistRecord:void 0,completed:!1,hide:!1}}}const No=Do;class zo extends Ii.default{getInitialState(){return{step:"list",templateChecklistRecord:void 0}}}const Fo=zo;var Wo=n(64921),qo=n(77137),Ko=n(15047);const Ho=e=>{let{percentComplete:t=.33}=e;return(0,z.jsx)("div",{style:{height:4,width:288,borderRadius:10,backgroundColor:"#E7E6E5"},children:(0,z.jsx)("div",{style:{height:4,width:288*t+"px",borderRadius:10,position:"relative",backgroundColor:"#2383E2"}})})};class Go extends o.Z{renderComponent(){return(0,z.jsxs)("div",{children:[(0,Uo.L)({height:24,width:24}),(0,z.jsx)("div",{style:this.getHeaderStyle(),children:this.getHeaderMessage()}),(0,z.jsx)(Ho,{...this.props})]})}getHeaderMessage(){switch(this.props.useCase){case"wiki":return(0,z.jsx)(v.FormattedMessage,{id:"templateChecklistHeader.useCaseHeader.wiki",defaultMessage:"Getting started with wikis & docs"});case"doc_notes":case"notes":return(0,z.jsx)(v.FormattedMessage,{id:"templateChecklistHeader.useCaseHeader.notes",defaultMessage:"Getting started with notes"});case"bookmarks":return(0,z.jsx)(v.FormattedMessage,{id:"templateChecklistHeader.useCaseHeader.databases",defaultMessage:"Getting started with databases"});case"project_management":return(0,z.jsx)(v.FormattedMessage,{id:"templateChecklistHeader.useCaseHeader.projectManagement",defaultMessage:"Getting started with projects & tasks"});default:return(0,z.jsx)(v.FormattedMessage,{id:"templateChecklistHeader.useCaseHeader.default",defaultMessage:"Getting started with Notion"})}}getHeaderStyle(){return{paddingTop:12,paddingBottom:12,color:this.theme.regularTextColor,fontWeight:R.Z.fontWeight.semibold,fontSize:17,lineHeight:1.4}}}Go.displayName="TemplateChecklistHeader";const $o=Go;var Qo=n(5257),Yo=n(60458);class Xo extends o.Z{constructor(){super(...arguments),this.showingMore=Ii.default.createValue(!1)}renderComponent(){const{title:e,description:t}=this.props;return(0,z.jsxs)("div",{style:{paddingTop:12,display:"flex",flexDirection:"row",width:"100%",...this.showingMore.state?{borderBottom:"1px solid #ECEBEA",marginBottom:12,paddingBottom:12}:{}},children:[(0,z.jsx)("div",{style:{paddingRight:10},children:(0,z.jsx)(Yo.Z,{size:22,checked:this.props.checked,onClick:()=>this.props.onClick(),round:!0,fill:d.ZP.white})}),(0,z.jsxs)("div",{style:{width:"100%",paddingRight:"14px"},children:[(0,z.jsxs)("div",{style:{fontSize:14,fontWeight:R.Z.fontWeight.semibold,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e,(0,z.jsx)("span",{onClick:()=>this.showingMore.setState(!this.showingMore.state),children:this.showingMore.state?(0,Hn.i)({height:11,width:11,display:"inline"}):(0,Qo.o)({height:11,width:11,display:"inline"})})]}),this.showingMore.state&&(0,z.jsx)("div",{style:{fontSize:14,color:this.theme.mediumTextColor},children:t})]})]})}}Xo.displayName="TemplateChecklistStep";const Jo=Xo;class es extends o.Z{constructor(){super(...arguments),this.completed=Ii.default.createValue(!1),this.renderStepContent=e=>(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{style:{paddingBottom:8,width:"100%"},children:(0,z.jsx)($o,{percentComplete:e.getStepsCompleted().length/e.getSteps().length,useCase:Ko.rz})}),e.getSteps().map((t=>{if(null==e||!e.isDefined())return;const{title:n,description:i}=function(e,t){const n=Ro[`${e}.${t}.title`],i=Ro[`${e}.${t}.description`];if(!n||!i)throw new Error(`No title or description for ${e} at step ${t}`);return{title:n,description:i}}(e.getCopiedFrom(),t);return(0,z.jsx)(Jo,{title:(0,z.jsx)(v.FormattedMessage,{...n}),description:(0,z.jsx)(v.FormattedMessage,{...i}),checked:e.getStepsCompleted().includes(t),onClick:()=>{!function(e){const{environment:t,record:n,step:i}=e;if(!n.isDefined())return;const o=n.getStepsCompleted(),s={steps_completed:o.includes(i)?He.hX(o,(e=>e!==i)):He.jj([...o,i])};Ot.createAndCommit({userAction:"templateChecklistActions.toggleStep",environment:t,perform:e=>{Rt.sW({store:n,data:s,transaction:e})}})}({environment:this.environment,record:e,step:t})}},t)}))]}),this.renderCompleted=()=>(0,z.jsxs)("div",{style:this.getCompletedContainerStyle(),children:[(0,z.jsx)("img",{style:{width:165,height:80},src:rt.Z.images.feedbackThankYouPng}),(0,z.jsx)("div",{style:this.getCompletedTitleStyle(),children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"You're done!",id:"templateChecklist.completed.header"})}),(0,z.jsx)("div",{style:this.getCompletedDescriptionStyle(),children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"For more inspirations, go to Notion Guides to sharpen your skills and explore new ways to use Notion.",id:"templateChecklist.completed.description"})})]}),this.handleCancel=()=>{this.props.onCancel()},this.flexCenteredStyle={display:"flex",alignItems:"center",flexDirection:"column"}}renderComponent(){return(0,z.jsx)(Un.Z,{isVisible:Oo.state.open,enterAnimationStyle:{opacity:1,scale:1},exitAnimationStyle:{opacity:0,scale:.95},render:()=>(0,z.jsxs)("div",{style:this.getContainerStyle(),children:[this.renderCancel(),this.renderStep()]})})}renderCancel(){return(0,z.jsx)(Wo.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground},children:(0,Lo.D)({width:14,fill:this.theme.mediumTextColor})})}renderStep(){const e=this.getTemplateChecklistRecord();if(null==e||!e.isDefined())return;const t=e.getStepsCompleted().length!==e.getSteps().length;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Un.Z,{isVisible:t,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationEnd:()=>{this.completed.setState(!0),He.gw((()=>{Oo.setState({open:!1}),this.props.onComplete()}),2e3)},render:()=>this.renderStepContent(e)}),(0,z.jsx)(Un.Z,{isVisible:!t&&this.completed.state,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:this.renderCompleted})]})}getTemplateChecklistRecord(){return this.props.templateChecklistStore.state.templateChecklistRecord}getContainerStyle(){return{...this.flexCenteredStyle,cursor:"default",padding:16,textAlign:"left",justifyContent:"start",background:this.theme.popoverBackground,borderRadius:3,boxShadow:this.theme.lightBoxShadow,position:"absolute",bottom:65+Mn.Z.state,right:16+Mn.Z.state,width:325,height:400,zIndex:te.hT,clipPath:"inset(-10px -10px -10px -10px)"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center"}}getCompletedContainerStyle(){return{display:"flex",flexDirection:"column",alignItems:"center",height:"100%",textAlign:"center"}}getCompletedTitleStyle(){return{color:this.theme.regularTextColor,fontWeight:R.Z.fontWeight.semibold,fontSize:14}}getCompletedDescriptionStyle(){return{color:this.theme.mediumTextColor,fontSize:12}}}es.displayName="TemplateChecklist";const ts=es;var ns=n(96234);class is extends o.Z{constructor(){super(...arguments),this.storeTypes={templateChecklistButtonStore:No},this.handleCancel=()=>{const{templateChecklistRecord:e}=this.stores.templateChecklistButtonStore.state;e&&(!function(e){const{environment:t,record:n}=e,i={opt_out:!0};Ot.createAndCommit({userAction:"templateChecklistActions.optOut",environment:t,perform:e=>{Rt.sW({store:n,data:i,transaction:e})}})}({environment:this.environment,record:e}),Oo.setState({...Oo.state,open:!1}))}}renderComponent(){const{mainEditorCurrentBlockStore:e,currentSpaceStore:t}=I.default.state;if(null!=e&&e.isDefined()&&null!=t&&t.isDefined())return(0,z.jsx)(qo.Z,{throttle:1e3,request:{spaceId:t.id,blockId:e.id},performRequest:async e=>{let{blockId:t,spaceId:n}=e;const i=await Ue.getTemplateChecklistForBlock(this.environment,{blockId:t,spaceId:n});if("success"===i.type){const{templateChecklistId:e}=i.data;if(!e)return;const t=new P.XJ(this.environment,{table:Eo.$,id:e});if(this.stores.templateChecklistButtonStore.setState({...this.stores.templateChecklistButtonStore.state,templateChecklistRecord:t}),t.isDefined()){const e=Zo.Z.get({userId:this.environment.currentUser.id,key:Bo(t.id)});this.stores.templateChecklistButtonStore.setState({...this.stores.templateChecklistButtonStore.state,hide:"boolean"==typeof e&&!e})}}},render:(e,t,n)=>{if(!n)return;const{templateChecklistRecord:i,completed:o}=this.stores.templateChecklistButtonStore.state;if(null==i||!i.isDefined()||i.getStepsCompleted().length===i.getSteps().length||o)return;const s=new Fo;return s.setState({...s.state,templateChecklistRecord:i}),this.stores.templateChecklistButtonStore.setState({...this.stores.templateChecklistButtonStore.state,templateChecklistRecord:i}),i.getOptOut()?void 0:(0,z.jsxs)("div",{children:[(0,z.jsxs)(Wo.Z,{style:this.getRoundButtonStyle(),hoveredStyle:{background:this.theme.whiteButtonHoveredBackground},pressedStyle:{background:this.theme.whiteButtonPressedBackground},onClick:()=>{const e=this.stores.templateChecklistButtonStore.state.hide;this.stores.templateChecklistButtonStore.setState({...this.stores.templateChecklistButtonStore.state,hide:!e}),this.setVisibilityLocalStorage(e,i.id)},children:[(0,Uo.L)({height:18}),this.stores.templateChecklistButtonStore.state.hide&&(0,z.jsx)(Wo.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground},children:(0,Lo.D)({width:14,fill:this.theme.mediumTextColor})})]}),!this.stores.templateChecklistButtonStore.state.hide&&(0,z.jsx)(ts,{templateChecklistStore:s,onComplete:()=>this.stores.templateChecklistButtonStore.setState({...this.stores.templateChecklistButtonStore.state,completed:!0}),onCancel:()=>{this.setVisibilityLocalStorage(!1,i.id),this.stores.templateChecklistButtonStore.setState({...this.stores.templateChecklistButtonStore.state,hide:!0})}})]})}})}setVisibilityLocalStorage(e,t){Zo.Z.set({userId:this.environment.currentUser.id,key:Bo(t),value:e})}getRoundButtonStyle(){return{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",background:this.theme.buttonBackground,bottom:16+Mn.Z.state,right:60+Mn.Z.state,width:36,height:36,borderRadius:"100%",boxShadow:this.theme.lightBoxShadow,zIndex:te.hT,opacity:ae.tu.state?0:1,transition:`\n\t\t\t\topacity ${ns.Z.transitionDuration}ms,\n\t\t\t\tcolor ${ns.Z.transitionDuration}ms\n\t\t\t`}}getCancelStyle(){return{position:"absolute",top:-2,right:-1,background:this.theme.buttonHoveredBackground,borderRadius:"100%"}}}is.displayName="TemplateChecklistButton";const os=is;var ss=n(29974);function rs(){window.__c={n:"TemporaryQuickSearchCurrentBlockStoreLoader"};const e=(0,A.O7)(),{currentSpaceViewStore:t,currentSpaceStore:n}=(0,L.VK)((()=>({currentSpaceViewStore:I.default.state.currentSpaceViewStore,currentSpaceStore:I.default.state.currentSpaceStore})),[]);return(0,Z.r5)((async()=>{if(null!=n&&n.id){const i=ss.F1({environment:e,spaceId:null==n?void 0:n.id})??(t?await(0,Yn.rg)(e,t):void 0);i&&I.default.setState({...I.default.state,mainEditorCurrentBlockStore:i})}}),[e,n,t]),null}var as=n(90965);function ds(e){let{}=e;window.__c={n:"TransferWorkspaceModalWrapper"};const t=(0,L.VK)((()=>I.default.state.currentSpaceStore),[]),n=(0,L.VK)((()=>{var e;if(!t)return;const n=null===(e=t.getSettings())||void 0===e?void 0:e.space_request;return(0,as.DI)(n)?n:void 0}),[t]);return n?(0,z.jsx)(j.LazyTransferWorkspaceModal,{workspaceTransfer:n}):null}class ls extends o.Z{constructor(){super(...arguments),this.appRenderState=this.createComputedStore((()=>ae.h1(this.environment))),this.handleFrameBlockerClick=()=>{ge.close()},this.showHelpButtonStore=this.createComputedStore((()=>{if(!this.environment.currentUser.isLoggedIn())return!1;if(this.environment.device.isMobile)return!1;const{mainEditorCurrentBlockStore:e}=I.default.state;return!!e&&(!(0,ue.IJ)(this.environment,e)&&!this.shouldIncludeAssistantButton.state)})),this.showTemplateChecklistStore=this.createComputedStore((()=>{if(!this.environment.currentUser.isLoggedIn())return!1;if(this.environment.device.isMobile)return!1;const{mainEditorCurrentBlockStore:e}=I.default.state;if(!e)return!1;return!("on"!==Me.default.getGroup("template-checklist"))})),this.isAssistantLabelerModeEnabledStore=this.createComputedStore((()=>(0,de.Gw)())),this.shouldIncludeAssistantButton=this.createComputedStore((()=>!this.environment.device.isMobile&&xe.Z.shouldShowAssistantInCorner())),this.frameBlockerStyle={position:"absolute",top:0,left:(0,ye.qG)(this.environment),right:0,bottom:0,zIndex:te.l6}}didMount(){var e;null!==(e=this.environment.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&this.environment.mobileNative.api.appComponentMountState(!0)}willUnmount(){var e;null!==(e=this.environment.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&this.environment.mobileNative.api.appComponentMountState(!1)}renderComponent(){const{isElectronMac:e,isMobile:t}=this.environment.device,{RouterStore:n}=this.environment,{route:i}=n.state,{mainEditorCurrentBlockStore:o,currentSpaceStore:s,currentUserRootStore:r,currentCollectionViewStore:a,currentUserSettingsStore:d}=I.default.state,{publicPageData:l}=ke.Z.state,h=this.environment.currentUser.isLoggedIn(),m=fe.TC.state,g=(0,ye.in)(this.environment),{state:{shouldShowSidebar:v,shouldShowFrame:f,shouldShowError:S}}=this.appRenderState,b="page"===i.name&&i.shouldDuplicate&&o&&(0,ue.S4)(o),y=!h&&"modal"===i.name&&(i.templateGalleryItem||i.projectManagementLaunch),k="page"===i.name&&i.workspaceId?i.workspaceId:void 0,x=(0,u.wO)(i)&&r||"nativeTab"===i.name&&r||"quickSearch"===i.name&&r||r||o,C="nativeTab"===i.name&&"search"===i.tab||"quickSearch"===i.name,M="quickSearch"===i.name,T="nativeTab"===i.name,P=(0,we.Y)("supportsNativeHome"),_=ee("production",this.environment.device)||!(0,we.Y)("supportsNativeSearch"),A=(0,ce.H)(),L=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(j.LazySidebarCreateTeamModal,{}),(0,z.jsx)(j.LazySidebarTeamModal,{}),(0,z.jsx)(j.LazyCreateTeamFromPageConfirmModal,{}),(0,z.jsx)(j.LazyConfirmPrivilegedActionModal,{})]});ne.wk({environment:this.environment});const U=je.default.state.data;if(y){const{environment:e}=this;return i.projectManagementLaunch?w.setQueryParamRedirect({currentUserId:void 0,params:{tg:"gallery"}}):i.templateGalleryItem&&w.setQueryParamRedirect({currentUserId:void 0,params:{tg:i.templateGalleryItem}}),void w.navigate({environment:e,url:p._j.login})}return M?(0,z.jsxs)(tt.Z,{style:this.getStyle(),children:[x&&!S&&_&&(0,z.jsx)(j.LazySearch,{parentStore:x,renderAsPage:!0,renderId:(0,c.ZP)(),quickSearchMode:!0}),"rendered"===I.default.state.renderPhase&&(0,z.jsx)(j.LazyAppComponents,{}),(0,z.jsx)(rs,{})]}):(0,z.jsxs)(tt.Z,{style:this.getStyle(),children:[v&&!t&&(0,z.jsx)(cs,{isElectronMac:e,isExpanded:g}),v&&t&&!P&&(0,z.jsx)(j.LazySidebarMobile,{}),v&&t&&P&&(0,z.jsx)(j.LazyTopLevelMobileComponents,{}),v&&A&&(0,z.jsx)(he.HX,{}),(0,z.jsx)(et,{}),(0,z.jsx)(Y.R,{}),"workspaceSetup"===i.name&&(0,z.jsx)(j.LazyAppsSetup,{}),o&&f&&(0,z.jsx)(sn.Z,{routerState:this.props.routerState,store:o,collectionViewStore:a}),b&&"page"===i.name&&(0,z.jsx)(on,{blockId:i.blockId,workspaceId:k,tid:i.tid,from:i.from}),S&&l&&!b&&(0,z.jsx)(j.LazyPageError,{route:this.props.routerState.route,publicPageData:l}),v&&!(0,ye.Jr)(this.environment)&&m&&this.renderMobileSidebarFrameBlocker(),(0,z.jsx)(st,{}),this.showHelpButtonStore.state&&(0,z.jsx)(rn.Z,{}),this.shouldIncludeAssistantButton.state&&(0,z.jsx)(se.eC,{}),this.shouldIncludeAssistantButton.state&&(0,z.jsx)(se.Q,{}),this.showTemplateChecklistStore.state&&(0,z.jsx)(os,{}),this.isAssistantLabelerModeEnabledStore.state&&(0,z.jsx)(se.Zl,{}),o&&(0,z.jsx)(qt,{pageStore:o,environment:this.environment}),(0,de.GD)(void 0)&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(oe.u7,{}),(0,z.jsx)(ie.oF,{})]}),(0,le.u)(this.environment)&&(0,z.jsx)(Lt,{}),this.shouldShowMobileBottomBar()&&h&&o&&s&&(0,z.jsx)(j.LazyMobileBottomBar,{store:o}),!t&&"nativeTab"!==this.props.routerState.route.name&&"workspaceSetup"!==this.props.routerState.route.name&&(0,z.jsx)(_o,{}),"rendered"===I.default.state.renderPhase&&(0,z.jsxs)(z.Fragment,{children:[h&&(0,z.jsxs)(z.Fragment,{children:[L,(0,z.jsx)(pe,{}),(0,z.jsx)(j.LazyCustomizePageMenuRenderer,{}),(0,z.jsx)(j.LazyTopbarPageAnalyticsOptOutMenu,{}),(0,z.jsx)(j.LazyImportModal,{}),(0,z.jsx)(j.LazyExportModal,{}),(0,z.jsx)(j.LazyPageTemplateModal,{}),(0,z.jsx)(j.LazyTemplateGalleryModal,{}),(0,z.jsx)(j.LazyIntegrationGalleryModal,{}),(0,z.jsx)(j.LazyGoogleAuthPromptModal,{}),(0,z.jsx)(j.LazyStudentNotEligibleModal,{}),(0,z.jsx)(j.LazyTypedDBMigrationModal,{}),(0,z.jsx)(j.LazyContactModal,{}),(0,z.jsx)(j.LazyPersonaCollectionModal,{}),(0,z.jsx)(j.LazyCookieModal,{}),(0,z.jsx)(j.LazyAutomationModal,{}),Ce.Z.state.open&&(0,z.jsx)(j.LazyConfirmOverwriteModal,{...Ce.Z.state}),(0,z.jsx)(j.LazyConfigureIntegrationModal,{}),(0,z.jsx)(j.LazyConnectOAuthIntegrationModal,{}),s&&U&&Te.Z.state.open&&(0,z.jsx)(j.LazySpaceSubscriptionUpgradeModal,{data:U,spaceStore:s}),s&&U&&Oe.Z.state.open&&(0,z.jsx)(j.LazyClaimAndUpgradeModal,{spaceStore:s,data:U}),s&&U&&(0,z.jsx)(j.LazySpaceSubscriptionUpdateModal,{data:U}),s&&U&&(0,z.jsx)(j.LazyAddOnUpgradeModal,{data:U}),d&&s&&o&&(0,z.jsx)(j.LazyCsatPopup,{userSettingsStore:d,spaceStore:s,blockStore:o}),f&&(0,z.jsx)(j.LazyOpenInDesktopAppPopup,{}),f&&(0,z.jsx)(j.LazyWikiPromoPopup,{}),f&&(0,z.jsx)(j.LazyAddOnDiscountPopup,{}),f&&(0,z.jsx)(j.LazyAiQnaIntroModal,{}),f&&(0,z.jsx)(j.LazyEnterpriseLaunchModal,{})]}),(0,z.jsx)(j.LazyReportPageModal,{}),x&&!S&&_&&(0,z.jsx)(j.LazySearch,{parentStore:x,renderAsPage:C,renderId:C?(0,c.ZP)():void 0,quickSearchMode:!1}),T&&(0,z.jsx)(j.LazyMobileNativeFullPageComponents,{route:i}),(0,z.jsx)(j.LazyForkPagePopup,{}),void 0,(0,z.jsx)(ds,{}),void 0]}),(0,z.jsx)(Mt,{}),"rendered"===I.default.state.renderPhase&&(0,z.jsx)(j.LazyAppComponents,{}),(0,z.jsx)(jt,{}),v&&!t&&o&&(0,z.jsx)(he.$H,{currentBlockStore:o,isElectronMac:e}),(0,z.jsx)(j.LazyAdminModeBannerListener,{}),(0,z.jsx)(Be.Z,{}),(0,z.jsx)(Ve.Z,{}),(0,z.jsx)(Ao.Z,{subscriptionDataStore:je.default}),(0,z.jsx)(un,{}),(0,z.jsx)(Re,{}),(0,z.jsx)(_e,{}),(0,z.jsx)(re.j,{}),(0,z.jsx)(qe,{}),(0,z.jsx)(hn,{})]})}renderMobileSidebarFrameBlocker(){return(0,z.jsx)("div",{style:this.frameBlockerStyle,onClick:this.handleFrameBlockerClick})}shouldShowMobileBottomBar(){const{isTablet:e,isMobileNative:t,isIOS:n}=this.environment.device;return t&&n&&!e}getStyle(){return{width:"100vw",height:"100%",position:"relative",display:"flex",flex:1,background:(0,me.q0)()?this.theme.personalHomeBackground:this.theme.contentBackground}}}function cs(e){let{isElectronMac:t,isExpanded:n}=e;window.__c={n:"AppLazySidebarComponent"};const o=(0,i.useCallback)((()=>(0,z.jsx)(Se,{})),[]);return(0,z.jsx)(j.LazySidebarComponent,{isElectronMac:t,isExpanded:n,renderLoading:o})}ls.displayName="App";const us=ls;var ps=n(3403),hs=n(97880);var ms=n(40754);function gs(e){let{payload:t}=e;window.__c={n:"ConfirmUnsubscribePage"};const n=(0,A.O7)(),[o,s]=(0,i.useState)(t?{type:"unconfirmed"}:{type:"error"}),r=(0,i.useCallback)((async()=>{if(!t)return void s({type:"error"});s({type:"loading"});const e=await async function(e){let{environment:t,payload:n}=e;const i=await Ue.unsubscribeFromEmails(t,{payload:n});return"success"===i.type?{type:"success",spaceName:i.data.spaceName}:{type:"error"}}({environment:n,payload:t});s("error"===e.type?{type:"error"}:{type:"confirmed",spaceName:e.spaceName})}),[n,t]),a=(0,U.yK)((()=>({confirmUnsubscribeDescription:{marginBottom:10}})),[]);switch(o.type){case"loading":return(0,z.jsx)(ms.Z,{children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Loading…",id:"confirmUnsubscribePage.loadingMessage"})});case"unconfirmed":return(0,z.jsxs)(ms.Z,{children:[(0,z.jsx)("div",{style:a.confirmUnsubscribeDescription,children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Are you sure you want to unsubscribe from this list?",id:"unsubscribeFromEmails.workspace.confirmUnsubscribeDescription"})}),(0,z.jsx)(B.Z,{isLarge:!0,onClick:r,children:(0,z.jsx)(v.FormattedMessage,{id:"confirmUnsubscribePage.confirmButton",defaultMessage:"Unsubscribe"})})]});case"confirmed":return(0,z.jsx)(ms.Z,{children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"You have successfully unsubscribed from emails for {workspaceName}",values:{workspaceName:(0,z.jsx)("b",{children:o.spaceName})},id:"unsubscribeFromEmails.workspace.message"})});case"error":return(0,z.jsx)(ms.Z,{children:(0,z.jsx)(v.FormattedMessage,{id:"confirmUnsubscribePage.errorMessage",defaultMessage:"Could not unsubscribe."})});default:(0,hs.t1)(o)}}n(82801);var vs=n(73420);const fs=(0,v.defineMessages)({pageTitle:{id:"desktopEmailConfirmPage.title",defaultMessage:"Please check your email to confirm"},pageCaption:{id:"desktopEmailConfirmPage.subtitle",defaultMessage:"Almost there!"},pageDescription1:{id:"desktopEmailConfirmPage.description1",defaultMessage:"Please check your email and click the link to confirm."},pageDescription2:{id:"desktopEmailConfirmPage.description2",defaultMessage:"Once confirmed, you'll be able to return to the desktop app to complete signup."},checkYourGmail:{id:"desktopEmailConfirmPage.button.checkYourGmail",defaultMessage:"Check your Gmail inbox"}}),Ss=()=>(0,z.jsxs)("svg",{style:{display:"block",height:42},viewBox:"0 0 87 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,z.jsx)("path",{d:"M1.805 1.294l16.6-1.226c2.039-.175 2.563-.057 3.845.875l5.299 3.733c.874.642 1.165.817 1.165 1.516v20.473c0 1.283-.466 2.042-2.097 2.158L7.34 29.99c-1.224.058-1.807-.117-2.448-.934L.99 23.982c-.7-.934-.99-1.633-.99-2.45V3.334c0-1.049.466-1.924 1.805-2.04z",fill:"#fff"}),(0,z.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.405.068l-16.6 1.226C.466 1.41 0 2.285 0 3.334v18.198c0 .817.29 1.516.99 2.45l3.902 5.074c.641.817 1.224.992 2.448.934l19.277-1.167c1.63-.116 2.097-.875 2.097-2.158V6.192c0-.663-.262-.854-1.033-1.42a85.473 85.473 0 01-.133-.096L22.25.943c-1.282-.932-1.806-1.05-3.845-.875zM7.776 5.857c-1.574.106-1.931.13-2.825-.597L2.678 3.452c-.231-.234-.115-.526.467-.584l15.958-1.166c1.34-.117 2.038.35 2.562.758l2.737 1.983c.117.059.408.408.058.408l-16.48.992-.204.014zM5.941 26.49V9.11c0-.759.233-1.109.931-1.168L25.8 6.834c.642-.058.932.35.932 1.108v17.264c0 .759-.117 1.401-1.165 1.459l-18.113 1.05c-1.048.058-1.513-.291-1.513-1.225zm17.88-16.448c.116.525 0 1.05-.525 1.11l-.873.173v12.832c-.758.408-1.456.641-2.039.641-.932 0-1.165-.292-1.863-1.166l-5.709-8.982v8.69l1.806.409s0 1.05-1.457 1.05l-4.017.233c-.117-.234 0-.817.407-.933l1.049-.291v-11.49L9.144 12.2c-.117-.525.174-1.283.99-1.342l4.31-.29 5.94 9.098v-8.049l-1.514-.174c-.117-.643.349-1.11.931-1.167l4.02-.234z",fill:"#000"}),(0,z.jsx)("path",{className:"fill",d:"M41.434 21.251v-7.91h.137l5.704 7.91h1.796V9.627h-1.997v7.902h-.137l-5.704-7.902H39.43V21.25h2.005zM54.715 21.429c2.635 0 4.238-1.724 4.238-4.584 0-2.852-1.611-4.584-4.238-4.584-2.618 0-4.237 1.74-4.237 4.584 0 2.86 1.595 4.584 4.237 4.584zm0-1.676c-1.393 0-2.19-1.063-2.19-2.908 0-1.837.797-2.908 2.19-2.908 1.386 0 2.183 1.071 2.183 2.908 0 1.845-.789 2.908-2.183 2.908zM60.778 10.28v2.215h-1.393v1.595h1.393v4.809c0 1.708.806 2.393 2.828 2.393.386 0 .757-.04 1.047-.097v-1.563c-.242.024-.395.04-.677.04-.837 0-1.208-.386-1.208-1.256V14.09h1.885v-1.595h-1.885v-2.216h-1.99zM65.85 21.251h1.99v-8.813h-1.99v8.813zm.991-10.27c.66 0 1.192-.533 1.192-1.201 0-.669-.531-1.209-1.192-1.209-.652 0-1.192.54-1.192 1.209 0 .668.54 1.2 1.192 1.2zM73.299 21.429c2.634 0 4.237-1.724 4.237-4.584 0-2.852-1.611-4.584-4.237-4.584-2.619 0-4.238 1.74-4.238 4.584 0 2.86 1.595 4.584 4.238 4.584zm0-1.676c-1.394 0-2.192-1.063-2.192-2.908 0-1.837.798-2.908 2.192-2.908 1.385 0 2.183 1.071 2.183 2.908 0 1.845-.79 2.908-2.183 2.908zM78.725 21.251h1.998V16.12c0-1.297.75-2.119 1.941-2.119 1.217 0 1.78.677 1.78 2.022v5.228h1.999v-5.703c0-2.103-1.072-3.287-3.037-3.287-1.314 0-2.2.604-2.619 1.587h-.137v-1.41h-1.925v8.813z",fill:"#000"})]});function bs(){return(0,z.jsx)("div",{style:{padding:24},children:(0,z.jsx)(Ss,{})})}function ys(e){const{experimentVariant:t}=e;return(0,z.jsx)("div",{style:{width:800,height:"80vh",margin:"0 auto"},children:(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"80vh"},children:[(0,z.jsxs)(vs.sg,{gap:16,padding:16,children:[(0,z.jsx)("div",{style:{fontSize:36,fontWeight:R.Z.fontWeight.bold},children:(0,z.jsx)(v.FormattedMessage,{...fs.pageTitle})}),(0,z.jsx)("div",{style:{fontWeight:R.Z.fontWeight.bold},children:(0,z.jsx)(v.FormattedMessage,{...fs.pageCaption})}),(0,z.jsx)("div",{children:(0,z.jsx)(v.FormattedMessage,{...fs.pageDescription1})}),(0,z.jsx)("div",{children:(0,z.jsx)(v.FormattedMessage,{...fs.pageDescription2})}),"with_gmail_cta"===t&&(0,z.jsx)(B.Z,{style:{width:"fit-content"},isLarge:!0,onClick:()=>{window.location.href="https://mail.google.com/mail/u/0/#search/Your+Notion+signup+code+is"},children:(0,z.jsx)(v.FormattedMessage,{...fs.checkYourGmail})})]}),(0,z.jsx)(vs.sg,{children:(0,z.jsx)("img",{style:{width:350},src:rt.Z.images.onboarding.couch2Png})})]})})}function ws(){window.__c={n:"DesktopEmailConfirmPage"};const e=(0,A.O7)(),[t,n]=(0,i.useState)(null);return(0,i.useEffect)((()=>{try{const t=new URLSearchParams(window.location.search).get("state");if(!t)return;const i=JSON.parse(atob(t));i.experimentVariant&&n(i.experimentVariant),i.email&&i.deviceId&&f.$kb(e,{desktopAppRerouteEmail:i.email,desktopAppDeviceId:i.deviceId})}catch(t){}}),[e,n]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(bs,{}),(0,z.jsx)(ys,{experimentVariant:t})]})}n(84456),n(53238);var ks=n(13559),xs=n(44819);function Cs(e){window.__c={n:"FrontFallbackPage"};const{preventFrontRedirect:t}=e,n=(0,A.O7)(),{pathname:i,search:o,hash:s}=window.location;if(!t&&(0,xs.XR)(n,i)){const e=o.length>0?`${o}&${ks.AM}=1`:`?${ks.AM}=1`;return window.location.href=i+e+s,null}return(0,z.jsx)(j.LazyFrontLoginPage,{isSignup:!n.currentUser.isLoggedIn()})}var Ms=n(26198);class Ts extends o.Z{constructor(){super(...arguments),this.intersectionObserver=void 0,this.registry=new Map,this.handleIntersectionObserverEntries=(e,t)=>{for(const n of e){if(!(n.target instanceof HTMLElement))continue;const e=this.registry.get(n.target);e&&(e.isVisible=n.isIntersecting,e.latestTimestamp=n.time,e.isVisible&&!e.isSpawned&&(e.isSpawned=!0,e.onVisibilityChange(!0)))}this.despawnOldFrames()}}willMount(){void 0!==window.IntersectionObserver&&(this.intersectionObserver=new IntersectionObserver(this.handleIntersectionObserverEntries))}willUnmount(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0)}didUpdate(e){this.props.maxPreferredIFrames<e.maxPreferredIFrames&&this.despawnOldFrames()}despawnOldFrames(){const e=Array.from(this.registry.values()).filter((e=>e.isSpawned)),t=e.length-this.props.maxPreferredIFrames;if(t<=0)return;const n=e.filter((e=>!e.isVisible));n.sort(((e,t)=>e.latestTimestamp-t.latestTimestamp));for(const i of n.slice(0,t))i.isSpawned=!1,i.onVisibilityChange(!1)}track(e,t){this.intersectionObserver?(this.registry.set(e,{isVisible:!1,isSpawned:!1,latestTimestamp:0,onVisibilityChange:He.Ds(t,50)}),this.intersectionObserver.observe(e)):Ms.uf.track(e,t)}untrack(e){this.intersectionObserver?(this.intersectionObserver.unobserve(e),this.registry.delete(e)):Ms.uf.untrack(e)}renderComponent(){return(0,z.jsx)(Ms.Lr.Provider,{value:this,children:this.props.children})}}function js(e){let t=e.isMobile?10:50;return e.ramSizeInGB&&(t=Math.floor(2*e.ramSizeInGB)),{maxPreferredIFrames:t}}Ts.displayName="IFrameManager";var Is=n(25777);const Ps=function(e){window.__c={n:"Index"};const t=(0,A.O7)(),n={position:"absolute",top:0,left:0,bottom:0,right:0},{device:i}=t;return t.currentUser.isLoggedIn()?(0,z.jsx)("div",{style:n,children:(0,z.jsx)(Is.Z,{style:{width:"100%",height:"100%"},spinnerSize:sn.Z.spinnerSize,showSpinnerTimeout:500})}):i.isElectron?(0,z.jsx)(j.LazyLoginDesktop,{}):i.isMobileNative?(0,z.jsx)(j.LazyLoginMobileNative,{}):(0,z.jsx)(Cs,{preventFrontRedirect:!0})};var _s=n(42402),As=n(83785),Ls=n(84076);class Us extends o.Z{constructor(){super(...arguments),this.handleOpenInNativeApp=()=>{w.openInNativeApp({url:this.props.redirect,environment:this.environment})}}didMount(){this.handleOpenInNativeApp()}renderComponent(){return(0,z.jsxs)(ms.Z,{children:[(0,z.jsx)("div",{style:{color:this.theme.regularTextColor},children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Redirecting to your Notion app…",id:"webApp.redirectingToDesktop.message"})}),(0,z.jsx)(Ls.Z,{onClick:this.handleOpenInNativeApp,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:this.theme.lightTextColor},children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"If you weren't redirected, click here.",id:"webApp.redirectingToDesktop.directLink.message"})}),(0,z.jsx)(Ls.Z,{href:this.props.redirect,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:d.ZP.uiGray},children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Or, continue in your browser",id:"webApp.redirectingToDesktop.continueInBrowser.message"})})]})}}Us.displayName="NativeRedirect";const Zs=Us;var Es=n(93214),Rs=n(24211),Bs=n(90287),Vs=n(47307),Os=n(57400),Ds=n(24215),Ns=n(22974),zs=n(30021);function Fs(){return window.__c={n:"AppearanceSettingListener"},function(){const e=(0,A.O7)(),t=(0,i.useCallback)((()=>{Ns.LH(e)}),[e]);(0,i.useEffect)((()=>(t(),zs.Z.addListener(t),()=>{zs.Z.removeListener(t)})),[t])}(),null}var Ws=n(12955),qs=n(81236);function Ks(){return window.__c={n:"IdentifyCurrentUser"},function(){const e=(0,A.O7)(),t=(0,A.Fy)(),n=(0,L.VK)((()=>{const{currentUserStore:n,currentUserSettingsStore:i,currentUserRootStore:o}=I.default.state;if(!(e.currentUser.id&&n&&i&&o)){const t=(0,Ws.getPublicDomainUserId)(e);return t?{user_id:t}:void 0}const s=o.getSpaceViewStores(),r=s.length>0&&s.every((e=>e.isReady()));if(!n.isDefined()||!i.isDefined()||!r)return;const a=He.oA(s.map((e=>e.getSpaceId()))).map((t=>qs.Z.getPublicSpaceData(e,t)));if(!a.every((e=>Boolean(e)||null===e)))return;const d=(0,Ds.ls)(a),l=i.getSettings();if(!l)return;if(void 0===je.default.state.data)return;const c={user_id:n.id,email:n.getEmail(),user_persona:l.persona,user_team_role:l.team_role,user_use_cases:l.use_cases,user_company_size:l.company_size,user_source:l.source,user_plan_type:d,user_subscription_tier:je.default.state.data.subscriptionTier,user_has_at_least_one_free_tier_space:(0,Ds.nZ)(a),time_zone:l.time_zone,locale:l.locale,preferred_locale:l.preferred_locale,signup_time:l.signup_time,app_version:t.version};return l.signup_time&&(c.created_at=Math.floor(l.signup_time/1e3)),t.desktopAppVersion&&(c.desktop_app_version=t.desktopAppVersion),t.mobileAppVersion&&(c.mobile_app_version=t.mobileAppVersion),l.used_desktop_web_app&&(c.used_desktop_web_app=l.used_desktop_web_app),l.used_mobile_web_app&&(c.used_mobile_web_app=l.used_mobile_web_app),l.used_mac_app&&(c.used_mac_app=l.used_mac_app),l.used_windows_app&&(c.used_windows_app=l.used_windows_app),l.used_ios_app&&(c.used_ios_app=l.used_ios_app),l.used_android_app&&(c.used_android_app=l.used_android_app),c}),[e,t],{useDeepEqual:!0});(0,i.useEffect)((()=>{n&&"none"!==n.user_plan_type&&Hs(e,n)}),[e,n]);const o=void 0!==n;(0,i.useEffect)((()=>{const t=window.setTimeout((()=>{!o&&e.currentUser.id&&Hs(e,{user_id:e.currentUser.id})}),5e3);return()=>{window.clearTimeout(t)}}),[e,o])}(),null}const Hs=He.P2(f.XWf,5e3);var Gs=n(55632),$s=n(58455);function Qs(){return window.__c={n:"InitializeEventTrailApi"},function(){const e=(0,A.O7)(),t=(0,L.VK)((()=>$s.default.state.isLoaded),[]),n=(0,L.VK)((()=>$s.default.state.isLoggingEnabled),[]);(0,i.useEffect)((()=>{t&&async function(){const t=await(0,Ds.cG)(e);await Gs.j2({config:T.default,isEnabled:n,deviceId:t})}()}),[e,t,n])}(),null}var Ys=n(2991);function Xs(){return window.__c={n:"RegisterDesktopApp"},function(){const{deviceType:e}=(0,A.Fy)(),t=(0,A.O7)(),n=t.currentUser.isLoggedIn();(0,i.useEffect)((()=>{if(!n)return;if("windows-desktop"!==e&&"mac-desktop"!==e)return;const i=async()=>{await S.isMainTabOrWindow()&&Ue.registerDesktopApp(t,{deviceType:e})};i();const o=window.setInterval((()=>{i()}),5*Ne.hM);return()=>{window.clearInterval(o)}}),[n,e,t])}(),null}function Js(){return window.__c={n:"TrackLoadCachedPageChunkMetrics"},function(){const e=(0,A.O7)(),t=(0,i.useCallback)((t=>{const n={compressed:t.decodedBodySize!==t.encodedBodySize,local_cache_hit:0===t.transferSize,next_hop_protocol:t.nextHopProtocol,did_prefetch:e.prefetchCache.isEnabled},i={dns_lookup:{startTime:t.domainLookupStart,endTime:t.domainLookupEnd},connection_establish:{startTime:t.connectStart,endTime:t.connectEnd},request_queued:{startTime:t.connectEnd,endTime:t.requestStart},response_wait:{startTime:t.requestStart,endTime:t.responseStart},response_download:{startTime:t.responseStart,endTime:t.responseEnd}};xn.default.measure({metricName:"load_cached_page_chunk.fetch",startTime:t.fetchStart,endTime:t.responseEnd},{environment:e,data:{...n,sub_metrics:{dns_lookup:i.dns_lookup.endTime-i.dns_lookup.startTime,connection_establish:i.connection_establish.endTime-i.connection_establish.startTime,request_queued:i.request_queued.endTime-i.request_queued.startTime,response_wait:i.response_wait.endTime-i.response_wait.startTime,response_download:i.response_download.endTime-i.response_download.startTime}}});for(const[o,{startTime:s,endTime:r}]of Object.entries(i))xn.default.measure({metricName:`load_cached_page_chunk.fetch.${o}`,startTime:s,endTime:r},{environment:e,data:n})}),[e]);(0,i.useEffect)((()=>{const e=new PerformanceObserver((n=>{const i=n.getEntries().find((e=>e.name.includes(`${T.default.api.http}/loadCachedPageChunk`)&&!e.name.endsWith("s")));i&&("resource"===i.entryType&&t(i),null==e||e.disconnect())}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[t])}(),null}var er=n(98794),tr=n(27534);class nr extends o.Z{constructor(){super(...arguments),this.multiSelectionStartStore=void 0,this.multiSelectionEndStore=void 0,this.handleTextSelectionChange=()=>{const e=zt.default.state,t="empty"===e.mode?void 0:e.multiSelection.start.store,n="empty"===e.mode?void 0:e.multiSelection.end.store;if(this.multiSelectionStartStore===t&&this.multiSelectionEndStore===n)return;if(this.multiSelectionStartStore=t,this.multiSelectionEndStore=n,this.multiSelectionStartStore!==this.multiSelectionEndStore)return;const i=tr.getSimpleTableCellFromTextSelection();if(!i)return;const{rowIndex:o,columnIndex:s,simpleTableStore:r}=i.props;er.selectCell({environment:this.environment,rowIndex:o,columnIndex:s,simpleTableStore:r})}}willMount(){zt.default.addListener(this.handleTextSelectionChange)}willUnmount(){zt.default.removeListener(this.handleTextSelectionChange),this.multiSelectionStartStore=void 0,this.multiSelectionEndStore=void 0}}nr.displayName="TextAndSimpleTableSelectionSyncer";const ir=nr;var or=n(82246),sr=n(81212),rr=n(4615);async function ar(e){var t,n;void 0!==I.default.state.currentUserStore&&void 0!==I.default.state.currentSpaceStore||await I.default.waitUntil((()=>void 0!==I.default.state.currentUserStore&&void 0!==I.default.state.currentSpaceStore));const i=null===(t=I.default.state.currentUserStore)||void 0===t?void 0:t.id,o=null===(n=I.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!document.hasFocus())return;if(!i||!o)return;const s=Ds.Cd({userId:i,spaceId:o}),r=Date.now();s?Ds.ci({userId:i,spaceId:o,session:{...s,lastFocusedTime:r}}):Ds.ci({userId:i,spaceId:o,session:{id:(0,rr.ZP)(),sessionStartTime:r,lastFocusedTime:r}})}function dr(){return window.__c={n:"AnalyticsSessionListener"},function(){const e=(0,A.O7)();(0,i.useEffect)((()=>{let e;document.hasFocus()&&(e=setInterval((()=>{ar()}),6e4),ar());const t=()=>{e&&clearInterval(e),e=setInterval((()=>{ar()}),6e4),ar()},n=()=>{e&&clearInterval(e),e=void 0};return window.addEventListener("focus",t),window.addEventListener("blur",n),()=>{e&&clearInterval(e),window.removeEventListener("focus",t),window.removeEventListener("blur",n)}}),[e])}(),null}var lr=n(54064),cr=n(88632),ur=n(29755),pr=n(17963);const hr=new lr.Z;const mr=function(){window.__c={n:"ApiListener"};const e=(0,i.useRef)(!1),t=(0,A.O7)(),n=(0,i.useCallback)((async e=>{if(e.currentUser.id&&Ue.pendingTaskIds.size>0){const t=await Ue.getTasks(e,{taskIds:Array.from(Ue.pendingTaskIds.values())});if("success"===t.type){const{results:n}=t.data,i=new Set(Ue.pendingTaskIds);for(const t of n)i.delete(t.id),t.status&&Ue.handleRecordMapForResponse({environment:e,eventName:t.eventName,response:t.status,userId:e.currentUser.id}),Ue.pendingTaskEventsById.emit(t.id,t),hr.emit(t.eventName,t),"failure"!==t.state&&"success"!==t.state||Ue.pendingTaskIds.delete(t.id);if(i.size>0)for(const e of i.values())Ue.pendingTaskIds.delete(e)}}}),[]),o=(0,i.useCallback)((async e=>{if(e.currentUser.id){const t=await Ue.getUserTasks(e,{});if("success"===t.type){for(const e of t.data.taskIds)Ue.pendingTaskIds.add(e);t.data.taskIds.length>0&&n(e)}}}),[n]),s=(0,i.useCallback)((()=>{const n=cr.Z.state.online;n&&!e.current&&o(t),e.current=n}),[t,o]);function r(e){"success"===e.state?ur.Z.setStatus(e.request.blockId,void 0):"in_progress"===e.state||"not_started"===e.state?ur.Z.setStatus(e.request.blockId,e.status):ur.Z.setStatus(e.request.blockId,void 0)}function a(e){"success"===e.state?pr.Z.setStatus(e.request.blockId,!1):"in_progress"===e.state||"not_started"===e.state?pr.Z.setStatus(e.request.blockId,!0):pr.Z.setStatus(e.request.blockId,!1)}return(0,i.useEffect)((()=>{e.current=cr.Z.state.online;const i=setInterval((()=>n(t)),1e3);return o(t),cr.Z.addListener(s),hr.addListener("importEvernote",r),hr.addListener("extractWebClipperContent",a),()=>{clearInterval(i),cr.Z.removeListener(s),hr.removeListener("importEvernote",r),hr.removeListener("extractWebClipperContent",a)}}),[t,n,s,o]),null};var gr=n(12321);class vr extends o.Z{async willMountOrUpdate(){const{currentUserRootStore:e}=I.default.state;if(!e)return;await gr.w();const t=e.getSpaceViewStores();for(const n of t){const e=n.getBookmarkedPageStores();for(const n of e)this.preloadPage(n);const t=n.getSharedPageStores();for(const n of t)this.preloadPage(n);const i=n.getTeamsStores();for(const n of i){const e=n.getTeamPagesStores();for(const t of e)this.preloadPage(t)}const o=n.getSpaceStore();if(o){qs.Z.getPublicSpaceData(this.environment,o.id);const e=(0,Yn.XD)(this.environment,o);for(const t of e)this.preloadPage(t)}}}preloadPage(e){e.load();const t=e.getCollectionViewSourceOrLinkCollectionStores();for(const n of t)n.load()}}vr.displayName="AppRecordStoreListener";const fr=vr;var Sr=n(54153),br=n(2449),yr=n(10854),wr=n(73329),kr=n(85844);class xr extends o.Z{constructor(){super(...arguments),this.handleElectronUpdateChecking=()=>{const{AppUpdateStore:e}=this.environment;e.setState({appUpdate:e.state.appUpdate,electronUpdate:{state:"checking"}})},this.handleElectronUpdateError=(e,t)=>{const{AppUpdateStore:n}=this.environment;n.setState({appUpdate:n.state.appUpdate,electronUpdate:{state:"error",error:t}})},this.handleElectronUpdateNotAvailable=()=>{const{AppUpdateStore:e}=this.environment;e.setState({appUpdate:e.state.appUpdate,electronUpdate:{state:"no-update",timestamp:Date.now()}})},this.handleElectronUpdateAvailable=(e,t)=>{const{AppUpdateStore:n}=this.environment,i=(0,J.parseVersion)(t.version),o=S.getDesktopVersion(),s=(0,J.getUpdateType)({currentVersion:o,nextVersion:i,app:"desktop"});n.setState({appUpdate:n.state.appUpdate,electronUpdate:{state:"downloading",type:s,version:i,timestamp:Date.now(),progress:0}})},this.handleElectronUpdateProgress=(e,t)=>{const{AppUpdateStore:n}=this.environment,i=n.state;i.electronUpdate&&"downloading"===i.electronUpdate.state&&n.setState({appUpdate:i.appUpdate,electronUpdate:{...i.electronUpdate,progress:t.transferred/t.total}})},this.handleElectronUpdateReady=(e,t)=>{const{device:n}=this.environment,{AppUpdateStore:i}=this.environment,o=Sr.Z.get(yr.Tm),s=t.version;if(o===s){if(n.isMac)return i.setState({appUpdate:i.state.appUpdate,electronUpdate:{state:"ready",type:J.UpdateType.Major,version:void 0}}),void Vs.showDialog({message:(0,z.jsx)(v.FormattedMessage,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.prompt",defaultMessage:"Please move the Notion app into the Applications folder for the auto-updater to work."}),showCancel:!1,keepFocus:!1,handleCancel:()=>(0,yr.mK)(this.environment),items:[{label:(0,z.jsx)(v.FormattedMessage,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.dismissButton.label",defaultMessage:"Okay"}),onAccept:()=>(0,yr.mK)(this.environment)}]});bi.log({level:"error",from:"AppUpdateListener",type:"electronUpdateFailed",data:{miscDataToConvertToString:{previousUpdateReady:o,nextUpdateReady:s}}})}const r=S.getDesktopVersion(),a=(0,J.parseVersion)(t.version),d=(0,J.getUpdateType)({currentVersion:r,nextVersion:a,app:"desktop"});i.setState({appUpdate:i.state.appUpdate,electronUpdate:{state:"ready",type:d,version:a}})},this.handleAppUpdateChecking=()=>{const{AppUpdateStore:e}=this.environment;e.state.appUpdate&&"ready"===e.state.appUpdate.state||e.setState({electronUpdate:e.state.electronUpdate,appUpdate:{state:"checking"}})},this.handleElectronAppUpdateError=(e,t)=>{this.handleAppUpdateError(t)},this.handleAppUpdateError=e=>{const{AppUpdateStore:t}=this.environment;t.state.appUpdate&&"ready"===t.state.appUpdate.state||t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"error",error:e}})},this.handleAppUpdateNotAvailable=()=>{const{AppUpdateStore:e}=this.environment;e.state.appUpdate&&"ready"===e.state.appUpdate.state||e.setState({electronUpdate:e.state.electronUpdate,appUpdate:{state:"no-update",timestamp:Date.now()}})},this.handleElectronAppUpdateAvailable=(e,t)=>{this.handleAppUpdateAvailable(t)},this.handleAppUpdateAvailable=e=>{const{AppUpdateStore:t}=this.environment;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;const n=(0,J.parseVersion)(e.version),i=br.ac(),o=(0,J.getUpdateType)({currentVersion:i,nextVersion:n,app:"client"});t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"downloading",type:o,version:n,timestamp:Date.now(),progress:0}})},this.handleElectronAppUpdateProgress=(e,t)=>{this.handleAppUpdateProgress(t)},this.handleAppUpdateProgress=e=>{const{AppUpdateStore:t}=this.environment,n=t.state;n.appUpdate&&"downloading"===n.appUpdate.state&&t.setState({electronUpdate:n.electronUpdate,appUpdate:{...n.appUpdate,progress:e.downloaded/e.total}})},this.handleElectronAppUpdateReady=(e,t)=>{this.handleAppUpdateReady(t)},this.handleAppUpdateReady=e=>{const{AppUpdateStore:t}=this.environment,n=(0,J.parseVersion)(e.version),i=br.ac(),o=(0,J.getUpdateType)({currentVersion:i,nextVersion:n,app:"client"});if(!br.M0(n)){const e={state:"ready",type:o,version:n};t.setState({electronUpdate:t.state.electronUpdate,appUpdate:e})}this.displayUpdateBanner(o,n)},this.handleAppUpdateReload=e=>{an.Js({bannerStore:wr.Z}),br.hC({environment:this.environment,url:window.location.href,version:e})},this.handleElectronAppUpdateInstall=()=>{const e=this.environment.AppUpdateStore;if(cr.Z.getState().online&&e.isSilentUpdate()){const t=e.state.appUpdate;br.hC({environment:this.environment,url:window.location.href,version:t.version})}},this.pollForAppJsUpdates=async()=>{let e="";for(await new Promise((e=>setTimeout(e,5e3)));this.componentIsMounted;){if(void 0===kr.Z.state.isVisible||!0===kr.Z.state.isVisible)try{const t=br.ac(),n=await Ue.getAssetsJsonV2(this.environment,{hash:e});if("success"===n.type){const i=n.data;if("version"in i){const e=(0,J.parseVersion)(i.version);e&&((0,J.isEqualVersion)(e,t)||this.handleAppUpdateReady(i))}"hash"in i&&(e=i.hash||"")}}catch(t){}await new Promise((e=>setTimeout(e,6e4)))}}}didMount(){const{device:e,mobileNative:t}=this.environment;if(e.isElectron?(S.electronUpdateReady.addListener(this.handleElectronUpdateReady),S.electronUpdateError.addListener(this.handleElectronUpdateError),S.electronUpdateChecking.addListener(this.handleElectronUpdateChecking),S.electronUpdateAvailable.addListener(this.handleElectronUpdateAvailable),S.electronUpdateProgress.addListener(this.handleElectronUpdateProgress),S.electronUpdateNotAvailable.addListener(this.handleElectronUpdateNotAvailable),S.appUpdateReady.addListener(this.handleElectronAppUpdateReady),S.appUpdateError.addListener(this.handleElectronAppUpdateError),S.appUpdateChecking.addListener(this.handleAppUpdateChecking),S.appUpdateAvailable.addListener(this.handleElectronAppUpdateAvailable),S.appUpdateInstall.addListener(this.handleElectronAppUpdateInstall),S.appUpdateProgress.addListener(this.handleElectronAppUpdateProgress),S.appUpdateNotAvailable.addListener(this.handleAppUpdateNotAvailable),S.appUpdateReload.addListener(this.handleAppUpdateReload)):t?t.updateReceiveApiHandlers({appUpdateReady:this.handleAppUpdateReady,appUpdateError:this.handleAppUpdateError,appUpdateChecking:this.handleAppUpdateChecking,appUpdateAvailable:this.handleAppUpdateAvailable,appUpdateProgress:this.handleAppUpdateProgress,appUpdateNotAvailable:this.handleAppUpdateNotAvailable}):T.default.isAdminMode||T.default.isLocalhost&&!T.default.offline||this.pollForAppJsUpdates(),this.displayBannerIfSilentUpdate(),e.isMobileNative&&t&&t.api.openUpdateSettings){const t=e.osVersion,n=e.isAndroid&&(0,J.isLessThanVersion)(t,[7,0]),i=e.isIOS&&(0,J.isLessThanVersion)(t,[15,0]);(n||i)&&this.displayPlatformUpdateWarning()}}willUnmount(){const{device:e}=this.environment;e.isElectron&&(S.electronUpdateReady.removeListener(this.handleElectronUpdateReady),S.electronUpdateError.removeListener(this.handleElectronUpdateError),S.electronUpdateChecking.removeListener(this.handleElectronUpdateChecking),S.electronUpdateAvailable.removeListener(this.handleElectronUpdateAvailable),S.electronUpdateProgress.removeListener(this.handleElectronUpdateProgress),S.electronUpdateNotAvailable.removeListener(this.handleElectronUpdateNotAvailable),S.appUpdateReady.removeListener(this.handleElectronAppUpdateReady),S.appUpdateError.removeListener(this.handleElectronAppUpdateError),S.appUpdateChecking.removeListener(this.handleAppUpdateChecking),S.appUpdateAvailable.removeListener(this.handleElectronAppUpdateAvailable),S.appUpdateProgress.removeListener(this.handleElectronAppUpdateProgress),S.appUpdateNotAvailable.removeListener(this.handleAppUpdateNotAvailable),S.appUpdateReload.removeListener(this.handleAppUpdateReload))}displayMajorUpdateDialog(){Vs.showDialog({message:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"We just launched new features!",id:"breakingUpdateDialog.title"}),showCancel:!1,keepFocus:!1,handleCancel:()=>(0,yr.mK)(this.environment),items:[{label:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Update and see what's new",id:"breakingUpdateDialog.updateButtonTitle"}),color:"blue",onAccept:()=>(0,yr.mK)(this.environment)}],innerStyle:{width:380}})}async displayMinorUpdateBanner(){await this.shouldShowMinorUpdateBanner()&&an.Bw({bannerStore:wr.Z,id:"AppUpdate",contentKey:"minor_app_update",styleKey:cn.v.Blue})}displayUpdateBanner(e,t){e===J.UpdateType.Major?t&&br.M0(t)?(br.D$(t),this.displayMinorUpdateBanner()):this.displayMajorUpdateDialog():e===J.UpdateType.Minor?(t&&br.M0(t)&&br.D$(t),this.displayMinorUpdateBanner()):t&&br.M0(t)&&br.D$(t)}displayBannerIfSilentUpdate(){const e=br.ac(),t=br.uG();if(!(0,J.isEqualVersion)(e,t)){const n=(0,J.getUpdateType)({currentVersion:e,nextVersion:t,app:"client"});0,this.displayUpdateBanner(n,t)}}displayPlatformUpdateWarning(){const{mobileNative:e}=this.environment;e&&an.Bw({bannerStore:wr.Z,id:"PlatformUpdateWarning",contentKey:"mobile_platform_unsupported",styleKey:cn.v.Red})}async shouldShowMinorUpdateBanner(){await I.default.waitUntilRendered();const{mainEditorCurrentBlockStore:e,currentUserStore:t}=I.default.state;return!(!t||!e)&&!(0,ue.IJ)(this.environment,e)}}xr.displayName="AppUpdateListener";const Cr=(0,v.injectIntl)(xr);var Mr=n(32223);function Tr(e){cr.Z.setState({...cr.Z.state,online:e,lastOfflineTimestamp:e?cr.Z.state.lastOfflineTimestamp:Date.now()})}class jr extends o.Z{constructor(){super(...arguments),this.connectionIntervalUpdateRequest=void 0}willMount(){this.connectionIntervalUpdateRequest||(this.connectionIntervalUpdateRequest=window.setInterval((()=>async function(e){if((e.device.isBrowser||e.device.isElectron)&&document.hidden)return;if(Mr.isConnected())return void Tr(!0);if(!1===navigator.onLine&&!T.default.isLocalhost)return void Tr(!1);"success"===(await Ue.ping(e,{})).type?Tr(!0):Tr(!1)}(this.environment)),5e3))}willUnmount(){window.clearInterval(this.connectionIntervalUpdateRequest),this.connectionIntervalUpdateRequest=void 0}}jr.displayName="ConnectionListener";const Ir=jr;var Pr=n(78354),_r=n(77788),Ar=n(27186),Lr=n(24042);function Ur(){window.__c={n:"ElectronListener"};const e=(0,A.O7)(),t=(0,L.VK)((()=>({observedWidth:fe.H3.rect.state.width,targetWidth:fe.GZ.state,isExpanded:fe.gV.state,resizing:fe.cY.state})),[]),n=e.currentUser.isLoggedIn(),[o,s]=(0,i.useState)(!1),{isTabsFeatureEnabled:r}=(0,L.Kw)(Lr.Z);(0,i.useEffect)((()=>{o&&r&&S.windowSidebarState.set({isLoggedIn:n,...t})}),[t,n,o,r]),(0,i.useEffect)((()=>{let e;e=n?t.isExpanded?"expanded":"collapsed":"disabled",S.sidebarState.set(e)}),[t.isExpanded,n]);const a=(0,i.useCallback)(((t,n,i)=>{Ds.j(e,n,i)}),[e]);(0,i.useEffect)((()=>(S.track.addListener(a),()=>{S.track.removeListener(a)})),[a]);const d=(0,i.useCallback)(((e,t)=>{s(t)}),[]);(0,i.useEffect)((()=>(S.isActiveTab.get().then((e=>{s(e)})),S.isActiveTab.addListener(d),()=>{S.isActiveTab.removeListener(d)})),[d]);const l=(0,i.useCallback)(((e,t)=>{void 0===t.isShowingTabBar&&(t.isShowingTabBar=t.isTabsFeatureEnabled),Lr.Z.setState(t)}),[]);(0,i.useEffect)((()=>{var e;return null===(e=S.electronAppFeatures.get())||void 0===e||e.then((e=>{Lr.Z.setState(e)})),S.electronAppFeatures.addListener(l),()=>{S.electronAppFeatures.removeListener(l)}}),[l]);const c=(0,i.useCallback)((n=>{ge.setExpand({environment:e,isExpanded:!t.isExpanded,from:"electron_listener"})}),[e,t.isExpanded]);(0,i.useEffect)((()=>(S.sidebarState.addToggleListener(c),()=>{S.sidebarState.removeToggleListener(c)})),[c]);const u=(0,i.useCallback)(((e,t)=>{fe.gV.setState(t.isExpanded),fe.GZ.setState(t.targetWidth)}),[]);return(0,i.useEffect)((()=>(S.windowSidebarState.addListener(u),()=>{S.windowSidebarState.removeListener(u)})),[u]),null}var Zr=n(64496);class Er extends o.Z{constructor(){super(...arguments),this.experimentIntervalRequest=void 0}willMount(){this.load(),this.experimentIntervalRequest||(this.experimentIntervalRequest=window.setInterval((()=>this.load()),6e5))}willUnmount(){window.clearInterval(this.experimentIntervalRequest),this.experimentIntervalRequest=void 0}load(){(0,Zr._3)(this.environment)?Os.Tm(this.environment):Os.Th({environment:this.environment,force:!1})}}Er.displayName="ExperimentListener";const Rr=Er;var Br=n(24608);class Vr extends o.Z{constructor(){super(...arguments),this.refreshFileTokenRequest=void 0}willMount(){this.refresh(),this.refreshFileTokenRequest||(this.refreshFileTokenRequest=window.setInterval((()=>this.refresh()),36e5))}willUnmount(){window.clearInterval(this.refreshFileTokenRequest),this.refreshFileTokenRequest=void 0}refresh(){(0,Br.ZP)({url:`${T.default.secureFileConfig.rootPath}/refresh`,environment:this.environment,method:"GET",format:"text"})}}Vr.displayName="FileTokenRefresh";const Or=Vr;var Dr=n(45483);function Nr(e){window.__c={n:"InertWhenModalsAreOpen"};const t=(0,L.VK)((()=>"on"===Me.default.getEligibleGroup({experimentId:"use_inert_html_attribute"})),[]),n=(0,L.VK)((()=>Dr.Z.state.openModals.size>0),[]),i={inert:t&&n?"true":null};return(0,z.jsx)("div",{style:e.style,...i,children:e.children})}var zr=n(62134),Fr=n(45023);class Wr extends o.Z{constructor(){super(...arguments),this.handleEvent=e=>{zr.Zm(this.environment,e)},this.handleKeyDown=e=>{const{shortcutMap:t}=this.environment.KeyboardShortcutStackStore,n=He.w_(t,((t,n)=>(0,Fr.Z)(this.environment,e,t)));n&&!{cut:!0,copy:!0,paste:!0}[n]&&zr.dJ(this.environment,e,n)}}willMount(){window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("cut",this.handleEvent),window.addEventListener("copy",this.handleEvent),window.addEventListener("paste",this.handleEvent),window.addEventListener("keypress",this.handleEvent)}willUnmount(){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("cut",this.handleEvent),window.removeEventListener("copy",this.handleEvent),window.removeEventListener("paste",this.handleEvent),window.removeEventListener("keypress",this.handleEvent)}}Wr.displayName="KeyboardShortcutStackListener";const qr=Wr;var Kr=n(91948),Hr=n(31104),Gr=n(17294);class $r extends o.Z{constructor(){super(...arguments),this.renderModal=()=>{const e=Hr.Z.state;if(!e.open)return;const{targetRecordId:t}=e;return(0,z.jsxs)("div",{style:this.getStyle(),children:[(0,z.jsxs)("div",{style:this.getMessageStyle(),children:[e.message,(0,z.jsx)(En.Z,{style:this.getLoadingSpinnerStyle()})]}),this.shouldShowProgressBar(t)&&(0,z.jsx)(Kr.Z,{targetRecordId:t,style:this.getMoveOrDuplicateProgressStyle()})]})}}renderComponent(){const e=Hr.Z.state;return(0,z.jsx)(Jt.Z,{open:e.open,render:this.renderModal,overlayZIndex:te._})}shouldShowProgressBar(e){return void 0!==e&&Boolean(Gr.Z.state[e])}getStyle(){return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:180,padding:"18px 24px 20px",textAlign:"center",maxWidth:this.environment.device.isMobile?"300px":"100%"}}getMessageStyle(){return{display:"flex",alignItems:"center",fontSize:14,color:this.theme.mediumTextColor}}getLoadingSpinnerStyle(){return{marginLeft:6}}getMoveOrDuplicateProgressStyle(){return{marginTop:10}}}$r.displayName="LoadingStateRenderer";const Qr=$r;class Yr extends o.Z{willMountOrUpdate(){const{device:e,mobileNative:t}=this.environment;e.isElectron&&S.setLogglyData(bi.clientLogglyEnvironmentData),t&&t.setLogglyData(bi.clientLogglyEnvironmentData)}}Yr.displayName="LogglyDataListener";const Xr=Yr;var Jr=n(1302),ea=n(69454);class ta extends o.Z{constructor(){super(...arguments),this.handleEstimatedKeyboardWebViewOverlapStoreChange=()=>{Jr.default.afterNextFlush((()=>{fn.hQ(this.environment)}))},this.estimatedKeyboardWebViewOverlapStore=this.createComputedStore((()=>{const e=ea.Z.state;return e.phase===ea.i.willShow?0:e.estimatedKeyboardWebViewOverlap}))}willMount(){this.environment.device.isMobile&&(zt.default.addListener(this.handleEstimatedKeyboardWebViewOverlapStoreChange),this.estimatedKeyboardWebViewOverlapStore.addListener(this.handleEstimatedKeyboardWebViewOverlapStoreChange))}willUnmount(){this.environment.device.isMobile&&(zt.default.removeListener(this.handleEstimatedKeyboardWebViewOverlapStoreChange),this.estimatedKeyboardWebViewOverlapStore.removeListener(this.handleEstimatedKeyboardWebViewOverlapStoreChange))}}ta.displayName="MobileListener";const na=ta;var ia=n(27328);const oa=["compact","regular","unknown"];var sa=n(92338),ra=n(36054),aa=n(74487),da=n(97977),la=n(98958),ca=n(82007),ua=n(31299),pa=n(87531),ha=n(24677),ma=n(98104),ga=n(51783),va=n(44499),fa=n(45162),Sa=n(18514),ba=n(48141);function ya(e){const t=(0,ia.w_)(e);switch(t.type){case"native":return;case"web":const e=t.route;switch(e.name){case"page":return e.collectionViewId?"collection":"page";case"nativeTab":switch(e.tab){case"search":return"search";case"updates":return"updates"}break;default:return}}}var wa=n(19361),ka=n(55081),xa=n(75538),Ca=n(97799),Ma=n(91190),Ta=n(36896),ja=n(44604),Ia=n(12252),Pa=n(64233),_a=n(69327),Aa=n(475),La=n(65686),Ua=n(53610),Za=n(62820),Ea=n(34583);const Ra=(0,v.defineMessages)({failedToMovePageGeneric:{id:"MobileNativeListener.failedToMovePage",defaultMessage:"Failed to move page"}});let Ba;class Va extends o.Z{constructor(){super(...arguments),this.bottomBarVisibility=this.createComputedStore((()=>{const{currentUserStore:e,renderPhase:t}=I.default.state,n=Boolean(null==e?void 0:e.id),{shouldShowError:i}=ae.h1(this.environment),o="rendered"===t&&i,s=xa.default.state.isOnboarding,r=(0,we.Y)("supportsNativeBottomBarOverlappingWebView")?_i.Z.hasOpenMobileSlideUps():_i.Z.hasOpenPopups();return!o&&n&&!s&&!r})),this.customAddCommentMenuItemEnabled=this.createComputedStore((()=>{var e;if(!(0,we.Y)("supportsCustomAddCommentMenuItem"))return!1;const{currentUserStore:t}=I.default.state;if(!Boolean(null==t?void 0:t.id))return!1;if((0,we.Y)("supportsNativeBottomBarOverlappingWebView")?_i.Z.hasOpenMobileSlideUps():_i.Z.hasOpenPopups())return!1;const{TabbedRouterStore:n}=this.environment,i=(0,ia.w_)(n.state),o="web"===i.type&&((null===(e=i.redirectedTo)||void 0===e?void 0:e.route)||i.route);if(!o||"page"!==o.name)return!1;const s=zt.default.state;if("empty"===s.mode)return!1;const r=(0,fa.tp)({multiSelection:s.multiSelection,filterCommonAncestors:!0,focus:void 0});if(!r||0===r.stores.length)return!1;let a=!0;return r.stores.forEach((e=>{a&&(a=a&&e.canComment())})),a})),this.isOnUpdatesPage=this.createComputedStore((()=>{const e=this.environment.TabbedRouterStore.state;return"updates"===e.activeTab&&0===e.tabs.updates.pages.length})),this.aiAssistantEnabledState=this.createComputedStore((()=>{const{currentUserStore:e,currentSpaceStore:t}=I.default.state;if(!e||!t)return;const n=xe.Z.shouldShowAssistantInCorner();return{userId:e.id,spaceId:t.id,enabled:n}})),this.sideBarExpandedStateChangeHandler=()=>{var e;null===(e=this.environment.mobileNative)||void 0===e||e.sidebarVisibility(fe.gV.state&&!(0,ye.YR)(this.environment),(0,ye.qG)(this.environment))},this.bottomBarVisibilityChange=()=>{var e;const t=this.bottomBarVisibility.state;null===(e=this.environment.mobileNative)||void 0===e||e.toggleBottomBar(t),t||wa.Z.update((e=>({...e,active:!1})))},this.aiAssistantEnabledStateChange=()=>{var e;const t=this.aiAssistantEnabledState.state;t&&(null===(e=this.environment.mobileNative)||void 0===e||e.updateAiAssistantEnabledState(t))},this.handleStatusBarTap=()=>{this.scrollToTop()},this.scrollToTop=()=>{La.Z.getPreventScrollType()===Cn.Z.None&&(fe.TC.state?kn.Z.SidebarMobileScroller&&kn.Z.SidebarMobileScroller.scrollToTop({animate:!0,animationCallback:He.yR}):kn.Z.MenuScroller?kn.Z.MenuScroller.scrollToTop({animate:!0,animationCallback:He.yR}):kn.Z.MenuPageScroller?kn.Z.MenuPageScroller.scrollToTop({animate:!0,animationCallback:He.yR}):kn.Z.PageScroller&&kn.Z.PageScroller.scrollToTop({animate:!0,animationCallback:He.yR}))},this.handleSwipeNavigation=()=>{const{mobileNative:e,RouterStore:t}=this.environment;if(e&&e.setWebViewAllowsNavigationGestures){const{route:n}=t.state;"onboarding"===n.name||fe.TC.state||La.Z.getPreventScrollType()!==Cn.Z.None?!1!==Ba&&(Ba=!1,e.setWebViewAllowsNavigationGestures(!1)):!0!==Ba&&(Ba=!0,e.setWebViewAllowsNavigationGestures(!0))}},this.spaceViewId=void 0,this.userId=void 0,this.handleAppChange=()=>{const{currentUserStore:e,currentSpaceStore:t}=I.default.state;null!=e&&e.id&&null!=t&&t.id&&_a.Z.reinitializeState(this.environment,e.id,t.id);(void 0===(null==e?void 0:e.id)||this.userId!==(null==e?void 0:e.id))&&this.handleUserChange(e);const n=I.default.state.currentSpaceViewStore;this.spaceViewId!==(null==n?void 0:n.id)&&this.handleSpaceViewChange(n)},this.handleSpaceViewChange=e=>{var t;this.spaceViewId=null==e?void 0:e.id;const{mobileNative:n,TabbedRouterStore:i,currentUser:o}=this.environment,s=I.default.state.currentSpaceStore,r=null==s?void 0:s.id;if(null!=n&&null!==(t=n.api)&&void 0!==t&&t.setCurrentSpaceInfo&&n.api.setCurrentSpaceInfo({spaceId:r,spaceViewId:null==e?void 0:e.id,userId:o.id,editable:(null==s?void 0:s.canEdit())??!0}),(0,Sa.__)(this.environment)){const e=e=>{if("web"!==e.type)return;const t={...e.queryParams},n=r&&(0,rr.cj)(r);t.spaceId=n,e.queryParams=t,e.route.spaceId=n},t=He.Xh(i.state);e(t.tabs.search.rootPage),e(t.tabs.updates.rootPage),e(t.tabs.addPage.rootPage),this.clearTabbedRouterStoreState(t),i.setState(t)}this.getLocalSearchCache(this.environment,void 0)},this.handleUserChange=e=>{var t;this.userId=null==e?void 0:e.id,null!==(t=this.environment.mobileNative)&&void 0!==t&&null!==(t=t.api)&&void 0!==t&&t.setCurrentUserInfo&&this.environment.mobileNative.api.setCurrentUserInfo({userId:null==e?void 0:e.id,loggedInUserIds:this.environment.currentUser.loggedInUserIds});const n=!(0,Sa.__)(this.environment)||void 0===this.environment.currentUser.id,{TabbedRouterStore:i}=this.environment,o=He.Xh(i.state);this.clearTabbedRouterStoreState(o,n),i.setState(o)},this.handleKeyboardAutoScroll=()=>{ea.Z.state.phase===ea.i.willShow&&Jr.default.afterNextFlush((()=>fn.hQ(this.environment)))},this.handleMobileNativeKeyboardStore=()=>{if(ea.Z.state.phase===ea.i.hidden){if(Pa.Z.state.open)return;const{NativeMobileActionBarStore:e,device:t}=this.environment;if(e&&null!==e.state.menuType&&t.isAndroid)return;ma.ZH(this.environment)}},this.setCurrentUserId=async e=>{this.environment.currentUser.id!==e&&await x.x({environment:this.environment,newCurrentUserId:e})},this.setCurrentSpace=async(e,t)=>{const n=await x.x({environment:this.environment,newCurrentUserId:e}),{currentUserRootStore:i,currentUserSettingsStore:o}=I.default.state;if(!i)return;await i.load();const s=(0,Yn.w3)(t);s&&await ss.y3({environment:n,spaceViewStore:s,userSettingsStore:o,userRootStore:i,pageVisitSource:gn.tY.SwitchSpace})},this.openSearch=()=>{(0,we.Y)("supportsNativeHome")&&this.environment.device.isPhone?(w.clearHistoryState({RouterStore:this.environment.RouterStore,currentUserId:this.environment.currentUser.id}),pa.UT({environment:this.environment,analyticsFrom:"mobile-bottom-bar",renderAsPage:!0})):pa.UT({environment:this.environment,analyticsFrom:"mobile-bottom-bar"}),f.nBz(this.environment,{itemName:"search",logging_source:"mobile_native"})},this.openAllUpdates=()=>{(0,we.Y)("supportsNativeHome")&&this.environment.device.isPhone?(w.clearHistoryState({RouterStore:this.environment.RouterStore,currentUserId:this.environment.currentUser.id}),w.navigate({environment:this.environment,url:`${p.VP.nativeTab}/updates`,redirect:!0})):Za.Z.setState({...Za.Z.state,open:!0})},this.openMembersSettings=()=>{Ua.Z.setState({...Ua.Z.state,open:!0})},this.openHelp=()=>{Aa.Z.setState({...Aa.Z.state,open:!0})},this.openSupportMessages=()=>{C.j({environment:this.environment,from:"help_button"})},this.openMoveTo=e=>{const t=new P.G(this.environment,{table:Gt.iU,id:e});Gn.bA({environment:this.environment,blocks:[t],moveToContext:"home_tab",onAccept:e=>{w.navigateToPage({store:t,environment:this.environment,pageVisitSource:gn.tY.Move})}})},this.createOrJoinWorkspace=async()=>{await ka.xN(this.environment)},this.openSettings=()=>{Ca.Z.setState({open:!0,source:Ca.Y.Home})},this.openTrash=e=>{Ta.Z.setState({open:!0});const{query:t}=e;t&&ja.Z.setState({...ja.Z.state,currentTab:"all_pages",filter:t,limit:ja.Z.startLimit})},this.openAIAssistant=e=>{w.navigate({environment:this.environment,url:`${p.VP.nativeTab}/assistant${e.query?`?query=${e.query}`:""}`,redirect:!0})},this.openAddAccount=()=>{Ma.C.setState({...Ma.C.state,open:!0})},this.openAddPage=()=>{(0,we.Y)("supportsNativeHome")&&this.environment.device.isPhone?(w.clearHistoryState({RouterStore:this.environment.RouterStore,currentUserId:this.environment.currentUser.id}),ge.quickAddPage({environment:this.environment,from:"mobile_bottom_bar",redirect:!0,quickAddParentOverride:{type:"space-private-pages"}})):ge.quickAddPage({environment:this.environment,from:"mobile_bottom_bar"}),f.nBz(this.environment,{itemName:"add_page"})},this.handleTabbedRouterStoreChange=()=>{var e;const{mobileNative:t,TabbedRouterStore:n}=this.environment,i=null==t||null===(e=t.api)||void 0===e?void 0:e.handleTabbedRouterStateUpdate;if(i){const e=n.state;i({state:e,topPage:(0,ia.w_)(e),webTransitionType:ya(e),updateId:(0,rr.ZP)()});const t=n.getPreviousState();if(!t)return;const o=(0,ia.F9)(t),s=(0,ia.F9)(e);He.Xy(o,s)||f.w3M(this.environment,{origin:o,destination:s,from:e.navigationSource,action:e.navigationAction,logging_source:"mobile_native"})}},this.handleCustomAddMenuItemEnabledChanged=()=>{if(!(0,we.Y)("supportsCustomAddCommentMenuItem"))return;const e=this.customAddCommentMenuItemEnabled.state,{mobileNative:t}=this.environment;null==t||t.updateCustomAddCommentMenuItemEnabled(e)},this.getLocalSearchCache=He.HP(((e,t)=>ua.tw(e)),((e,t)=>{var n;return`${e.currentUser.id}-${(null===(n=I.default.state.currentSpaceViewStore)||void 0===n?void 0:n.id)??"none"}-${t??"none"}`})),this.clearTabbedRouterStoreState=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(e.tabs).forEach((n=>{const i=n;t&&(e.tabs[i].nativeRootPageOverrideEnabled=void 0),e.tabs[i].pages="home"!==i?[]:e.tabs[i].pages.splice(0,1)}))}}willMount(){const{mobileNative:e,RouterStore:t,TabbedRouterStore:n,device:i}=this.environment;var o;i.isMobileNative&&e&&(this.handleAppChange(),I.default.addListener(this.handleAppChange),fe.TC.addListener(this.handleSwipeNavigation),fe.gV.addListener(this.sideBarExpandedStateChangeHandler),or.Z.addListener(this.handleSwipeNavigation),t.addListener(this.handleSwipeNavigation),ea.Z.addListener(this.handleKeyboardAutoScroll),this.bottomBarVisibility.addListener(this.bottomBarVisibilityChange),this.aiAssistantEnabledState.addListener(this.aiAssistantEnabledStateChange),this.environment.WindowSizeStore.addListener(this.sideBarExpandedStateChangeHandler),n.addListener(this.handleTabbedRouterStoreChange),this.customAddCommentMenuItemEnabled.addListener(this.handleCustomAddMenuItemEnabledChanged),e.updateReceiveApiHandlers({statusBarTap:this.handleStatusBarTap,backButtonPress:()=>zr.Zm(this.environment,{type:"backbutton"}),keyboardWillShow:e=>{ea.Z.updateKeyboardPhase(this.environment,ea.i.willShow,e??0)},keyboardDidShow:e=>ea.Z.updateKeyboardPhase(this.environment,ea.i.shown,e??0),keyboardWillHide:()=>{var e;(ea.Z.updateKeyboardPhase(this.environment,ea.i.willHide,0),(0,we.Y)("supportsIpadOS16Keyboard"))||i.isIpad&&(ha.ZH(this.environment),null===(e=this.environment.NativeMobileActionBarStore)||void 0===e||e.clear(!0))},keyboardDidHide:()=>{var e;(ea.Z.updateKeyboardPhase(this.environment,ea.i.hidden,0),(0,we.Y)("supportsIpadOS16Keyboard"))&&(i.isIpad&&(ha.ZH(this.environment),null===(e=this.environment.NativeMobileActionBarStore)||void 0===e||e.clear(!0)))},keyboardShortcut:e=>zr.Zm(this.environment,e),pushNotificationTokenRefresh:e=>la.handleTokenRefresh(this.environment,e,"refresh"),resume:Ia.Z.resume,pause:Ia.Z.pause,refreshSubscriptionData:async e=>{await Ue.invalidateSubscriptionData(this.environment,{spaceId:e,provider:"revenue_cat"}),await Ea.bi(this.environment)},refreshSubscriptionDataV2:async()=>{await Ea.bi(this.environment)},processMobileActionBarAction:t=>{const{componentId:n,action:i}=t;e.componentEvents.dispatch("MobileActionBar",n,"onAction",{action:i})},updateExperimentData:async e=>{if((0,Zr._3)(this.environment)){const t=await(0,Ws.getExperimentDeviceId)(this.environment),n=this.environment.currentUser.id,i=(0,Zr.fP)(t,n,e);i&&Me.default.updateState(i,this.environment)}},trackExperimentExposure:async e=>{await f.Bb7({environment:this.environment,experiment_id:e.experimentId,experiment_version:e.experimentVersion,experiment_group:e.group||"ineligible",logging_source:"mobile_native"})},receiveRawMessageStoreMessage:e=>{Mr.onMobileNativeReceiveRawMessageStoreMessage(e,this.environment)},updateMessageStoreState:e=>{Mr.onMobileNativeUpdateMessageStoreState(e,this.environment)},logout:e=>{da.logoutSingleAccount({environment:this.environment,userId:e})},logoutAll:()=>{da.logout(this.environment)},openDestinationV2:e=>{switch(_i.Z.closeAll(),(0,Sa.__)(this.environment)&&w.navigateToTab({environment:this.environment,tab:n.state.activeTab,nativeRootPageOverrideEnabled:!1}),e.type){case"moveTo":this.openMoveTo(e.blockId);break;case"trash":this.openTrash({query:e.query});break;case"AIAssistant":this.openAIAssistant({query:e.query})}},openDestination:e=>{_i.Z.closeAll();switch("closePopup"!==e&&(0,Sa.__)(this.environment)&&w.navigateToTab({environment:this.environment,tab:n.state.activeTab,nativeRootPageOverrideEnabled:!1}),e){case"search":this.openSearch();break;case"addPage":this.openAddPage();break;case"allUpdates":this.openAllUpdates();break;case"addAccount":this.openAddAccount();break;case"createOrJoinWorkspace":return this.createOrJoinWorkspace();case"notificationAndSettings":this.openSettings();break;case"trash":this.openTrash({});break;case"memberSettings":this.openMembersSettings();break;case"help":this.openHelp();break;case"intercom_messages":this.openSupportMessages()}},setCurrentUserId:async e=>{await this.setCurrentUserId(e)},setCurrentSpace:async e=>{await this.setCurrentSpace(e.userId,e.spaceId)},updateHorizontalSizeClass:t=>{const n=(0,ra.Gu)(aa.literals(...oa),t)?"unknown":t;n!==e.horizontalSizeClass.state&&e.horizontalSizeClass.setState(n)},updateTabbedRouterState:e=>{var t;const{TabbedRouterStore:n}=this.environment,i=n.state;e.tab!==i.activeTab||null!==(t=e.pages)&&void 0!==t&&t.length||i.tabs[i.activeTab].pages.length?w.navigateToTab({environment:this.environment,tab:e.tab,queryParams:e.queryParams,pages:e.pages,nativeRootPageOverrideEnabled:e.nativeRootPageOverrideEnabled,navigationAction:e.navigationAction,navigationSource:e.navigationSource}):this.scrollToTop();const o=n.state;return[{state:o,topPage:(0,ia.w_)(o),webTransitionType:ya(o),updateId:e.updateId??(0,rr.ZP)()}]},getLocalSearchResults:async e=>{const t=await this.getLocalSearchCache(this.environment,e.searchSessionId);if(!t)return[{error:"Local cache does not exist"}];const n=(0,ra.Gu)(sa.GA,e.sort);if(n)return[{error:`old sort type is unsupported! ${n}`}];const i=e.sort,o=ba.iA({query:{query:{text:e.query??"",filters:e.filters,sort:i},limit:e.limit},localCachedPages:t,includeRecordMap:!1,userId:this.environment.currentUser.id,environment:this.environment,applyRecallScoreThreshold:!1,canUseLtr:!1}),s=[{value:{total:0,results:[],recordMap:{},trackEventProperties:{}}}];if(!o||0===o.results.length)return s;const r=cr.Z.state.online?ba.g8(this.environment,o.results):o.results;return[{value:{results:r,total:r.length,recordMap:{},trackEventProperties:{}}}]},customAddCommentMenuItemTapped:()=>{(0,ga.ol)(this.environment,!0,"custom_add_comment_menu_item")},filterValidMoveToBlocks:e=>{const t=e.targets.map((e=>new P.G(this.environment,{table:Gt.iU,id:e}))),n=e.blocks.filter((e=>{const n=new P.G(this.environment,{table:Gt.iU,id:e});return n.canEdit()&&(0,va.Xk)(n,t)}));return[{value:{targets:e.targets,blocks:n}}]},completeMoveToTransaction:async e=>{const{targets:t,destination:n,moveToContext:i,timeToSelectMs:o,isSearchResult:s}=e,r=this.environment,a=t.map((e=>new P.G(this.environment,{table:Gt.iU,id:e}))),d=Gn.QF(r,t,n);if(a&&a.length>0&&!d)try{return await Ot.createAndCommitAsync({userAction:"MobileNativeListener.completeMoveTo",environment:r,waitForServerCommit:!1,perform:async e=>{await Gn.RL({targets:a,value:n,transaction:e,environment:r,moveToContext:i,renderType:"native",timeToSelectMs:o,disableSuccessToast:!0,isSearchResult:s})}}),[{value:e}]}catch(l){}return[{error:yt.default.formatMessage(Ra.failedToMovePageGeneric)}]},undoRevision:()=>{ca.Yw(this.environment,!0)},searchTeams:async e=>{const{query:t}=e,n=I.default.state.currentSpaceStore,i=I.default.state.currentSpaceViewStore;if(!n||!i)return[{error:"SpaceStore or SpaceViewStore was undefined"}];return[{value:{ids:(await ua.zf({spaceViewStore:i,query:t,teamStores:i.getTeamsStores()})).map((e=>e.id))}}]}}),i.isAndroid&&ea.Z.addListener(this.handleMobileNativeKeyboardStore),null!==(o=this.environment.mobileNative)&&void 0!==o&&o.api.ready&&this.environment.mobileNative.api.ready(),this.sideBarExpandedStateChangeHandler(),this.handleCustomAddMenuItemEnabledChanged())}willUnmount(){const{mobileNative:e,RouterStore:t,TabbedRouterStore:n,device:i}=this.environment;i.isMobileNative&&e&&(I.default.removeListener(this.handleAppChange),fe.TC.removeListener(this.handleSwipeNavigation),fe.gV.removeListener(this.sideBarExpandedStateChangeHandler),or.Z.removeListener(this.handleSwipeNavigation),t.removeListener(this.handleSwipeNavigation),ea.Z.removeListener(this.handleKeyboardAutoScroll),this.bottomBarVisibility.removeListener(this.bottomBarVisibilityChange),this.aiAssistantEnabledState.removeListener(this.aiAssistantEnabledStateChange),n.removeListener(this.handleTabbedRouterStoreChange),this.customAddCommentMenuItemEnabled.removeListener(this.handleCustomAddMenuItemEnabledChanged),i.isAndroid&&ea.Z.removeListener(this.handleMobileNativeKeyboardStore))}}Va.displayName="MobileNativeListener";const Oa=Va;var Da=n(71474);const Na=()=>{window.__c={n:"NativeMetricsLoader"};const e=(0,A.O7)();return(0,i.useEffect)((()=>{const{mobileNative:t}=e;t&&t.enableBridgeMetricsCollection(e,xn.default,Me.default)}),[e]),null};class za extends o.Z{constructor(){super(...arguments),this.updatePageVisibility=()=>{kr.Z.setState({...kr.Z.state,isVisible:!document.hidden});const e=br.W$(),t=e&&(Date.now()-e)/Ne.A0>=7;if(this.environment.device.isBrowser&&!document.hidden&&(!e||t)&&cr.Z.getState().online){const e=this.environment.AppUpdateStore;if(e.isSilentUpdate()){const t=e.state.appUpdate;br.hC({environment:this.environment,url:window.location.href,version:t.version})}}}}didMount(){document.addEventListener("visibilitychange",this.updatePageVisibility),this.updatePageVisibility()}willUnmount(){document.removeEventListener("visibilitychange",this.updatePageVisibility)}}za.displayName="PageVisibilityListener";const Fa=za;var Wa=n(18466);new Set(["destinations","emergencyThrottlePercentage","amplitudeOptions","datadogOptions","snowflakeOptions","statsigOptions"]),aa.literals("connected_apps_settings","compliance_connected_apps_settings","external_object_instance_block","external_object_instance_inline_popup","external_object_instance_block_error_dropdown","placeholder_root_external_collection_view_block","connected_relation_property_menu","source_picker_connect_another_account","integration_gallery","collection_settings_property_type","integration_file_picker","send_to_notion","unfurl","messages_tab","install_redirect","all_updates","notifications_and_settings","collection_view_settings","share_menu","workspace_connections_redirect");var qa=n(77897);function Ka(){return 1}function Ha(e){let{id:t,targetRenderPhase:n="all",samplePercent:o=Ka(),children:s}=e;window.__c={n:"PerformanceProfiler"};const r=(0,A.O7)(),a=(0,i.useCallback)(((e,t,i,s,a,d)=>{(0,qa.lB)(o)&&("all"!==n&&t!==n||Ds.j(r,`render_duration.${e}`,{time:i,render_phase:t}))}),[r,n,o]),[d]=(0,i.useState)(Wa.Z.withListenerIgnored((()=>Me.default.checkGate("client-performance-profiler"))));return d?(0,z.jsx)(i.Profiler,{id:t,onRender:a,children:s}):(0,z.jsx)(z.Fragment,{children:s})}var Ga=n(89224),$a=n(59238);const Qa=()=>{window.__c={n:"TouchSelectionGestureListener"};const e=(0,A.O7)(),t=(0,i.useRef)("none"),n=(0,i.useCallback)((e=>{const n=t.current;e!==n&&(t.current=e,"dragging"===e?$a.Z.setState({isDragging:!0}):"dragging"===n&&$a.Z.setState({isDragging:!1}))}),[]),o=(0,i.useCallback)((()=>{"none"===t.current&&n("touching")}),[n]),s=(0,i.useCallback)((()=>{n("none")}),[n]),r=(0,i.useCallback)((()=>{"touching"===t.current&&Ga.isExpanded(Ga.get())&&n("dragging")}),[n]);return(0,i.useEffect)((()=>{if(e.device.isIOS)return window.addEventListener("touchstart",o),window.addEventListener("touchend",s),window.addEventListener("touchcancel",s),document.addEventListener("selectionchange",r),()=>{window.removeEventListener("touchstart",o),window.removeEventListener("touchend",s),window.removeEventListener("touchcancel",s),document.removeEventListener("selectionchange",r)}}),[e.device.isIOS,o,s,r]),null},Ya=()=>{window.__c={n:"SelectionListener"};const e=(0,A.O7)(),t=(0,i.useCallback)((()=>{Jr.default.afterNextFlush((()=>{ma.ls()}))}),[]),n=(0,i.useCallback)((()=>{setTimeout((()=>{Ga.get()||ma.ZH(e)}),0)}),[e]);return(0,i.useEffect)((()=>(window.addEventListener("mousedown",t),e.device.isMobileBrowser&&document.addEventListener("focusout",n),()=>{window.removeEventListener("mousedown",t),document.removeEventListener("focusout",n)})),[e,t,n]),(0,z.jsx)(Qa,{})};class Xa extends o.Z{constructor(e){super(e),this.mediaQueryList=window.matchMedia("(prefers-color-scheme: dark)"),this.initialSet=Ii.default.createValue(!1),this.handleThemeChange=this.handleThemeChange.bind(this)}willMount(){this.setTheme();const{mobileNative:e,device:t}=this.environment;t.isAndroid&&e?e.updateReceiveApiHandlers({themeChanged:e=>this.setTheme()}):this.mediaQueryList.addEventListener?this.mediaQueryList.addEventListener("change",this.handleThemeChange):this.mediaQueryList.addListener&&this.mediaQueryList.addListener(this.handleThemeChange)}willUnmount(){this.mediaQueryList.removeEventListener?this.mediaQueryList.removeEventListener("change",this.handleThemeChange):this.mediaQueryList.removeListener&&this.mediaQueryList.removeListener(this.handleThemeChange)}willUpdate(){var e;!this.initialSet.state&&null!==(e=I.default.state.mainEditorCurrentBlockStore)&&void 0!==e&&e.isReady()&&(this.setTheme(),this.initialSet.setState(!0))}handleThemeChange(e){this.setTheme()}setTheme(){"system"===Ns.MH(this.environment)&&zs.Z.emit()}}Xa.displayName="SystemThemeListener";const Ja=Xa;class ed extends o.Z{constructor(){super(...arguments),this.updateConnectionStateWithEnvironment=()=>Ot.updateConnectionState(this.environment)}willMount(){cr.Z.addListener(this.updateConnectionStateWithEnvironment),Ot.updateConnectionState(this.environment)}willUnmount(){cr.Z.removeListener(this.updateConnectionStateWithEnvironment)}}ed.displayName="TransactionListener";const td=ed;var nd=n(64964);function id(){window.__c={n:"WebpackHotReloadIndicator"};const e=T.default.isLocalhost||!1;return(0,i.useEffect)((()=>{function t(t){if(!e)return;if(!t.data||"string"!=typeof t.data.type)return;const n=t.data.type;"webpackInvalid"===n?nd.oV({label:(0,z.jsxs)("div",{children:[(0,z.jsx)("span",{style:{paddingRight:10},children:"Webpack Compiling"}),(0,z.jsx)("img",{src:"/images/favicon-local.ico",className:"loading-spinner",style:{display:"inline-block"}})]}),position:"top",durationMs:"keep"}):"webpackOk"!==n&&"webpackWarnings"!==n||nd.rN()}return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}}),[e]),null}class od extends o.Z{willMount(){const{device:e,mobileNative:t}=this.environment;if(Bs.mc(this.environment),Os.Yh(this.environment),t&&t.hideSplashscreen(),e.isMobile){const e=document.body.parentElement;e&&e.classList.add(Sn.aiP)}Ds.pH(this.environment),r.rQ(e,T.default),e.isElectronMac&&S.getAppPath().then((e=>{e&&(e.startsWith("/Volumes/Notion Installer")||e.startsWith("/Volumes/Notion Dev Installer")||e.startsWith("/Volumes/Notion Stg Installer"))&&Vs.showMessage({message:this.props.intl.formatMessage({defaultMessage:"Please move the Notion.app into the /Applications folder for the auto-updater to work.",id:"notionAppContainer.dialog.notionAppNotInApplications.message"})})})),Rs.DM(s.SP),(0,Es.np)(window.location.href)}didMount(){const{device:e,mobileNative:t}=this.environment;"external"===(0,u.Wj)({url:window.location.href,isMobile:e.isMobile,baseUrl:T.default.domainBaseUrl,publicDomainName:T.default.publicDomainName,protocol:T.default.protocol,currentUrl:window.location.href}).name&&Vs.showDialog({message:"Mismatch between origin and baseUrl (dev).",showCancel:!1,keepFocus:!1,items:[{label:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Okay",id:"notionAppContainer.dialog.mismatchedOriginURL.okayButton.label"}),onAccept:()=>{const e=mt.O_({relativeUrl:mt.T1(window.location.href),baseUrl:T.default.domainBaseUrl}),t=mt.Qc(e);t.protocol=mt.Qc(window.location.href).protocol,window.location.href=mt.WU(t)}}]}),null==t||t.markTransitionReady({type:"mount"})}renderComponent(){const e="light"===this.theme.mode?Sn.MsS:Sn.Xj_;return(0,z.jsx)(Ha,{id:"app",targetRenderPhase:"mount",children:(0,z.jsxs)("div",{style:this.getStyle(),className:["notion-app-inner",e].join(" "),children:[(0,z.jsx)(id,{}),(0,z.jsx)(Cr,{},"AppUpdateListener"),(0,z.jsx)(Xr,{},"ElectronLogglyDataListener"),(0,z.jsx)(Nr,{style:{height:"100%"},children:this.props.children}),(0,z.jsx)(_r.Z,{store:or.Z,zIndex:te.mJ,isDefault:!0}),(0,z.jsx)(_r.Z,{store:sr.Z,zIndex:te.O7,isDefault:!1}),(0,z.jsx)(Pr.Z,{}),(0,z.jsx)(Qr,{}),(0,z.jsx)(fr,{}),(0,z.jsx)(Ks,{}),!this.environment.device.isMobileNative&&(0,z.jsx)(dr,{}),(0,z.jsx)(td,{}),(0,z.jsx)(Ya,{}),(0,z.jsx)(qr,{}),(0,z.jsx)(Oa,{}),(0,z.jsx)(Na,{}),this.environment.device.isMobileNative&&(0,z.jsx)(j.LazyNativeVoiceInput,{}),this.environment.device.isElectron&&(0,z.jsx)(Ur,{}),(0,z.jsx)(Xs,{}),(0,z.jsx)(na,{}),(0,z.jsx)(Ar._g,{}),(0,z.jsx)(Fs,{}),(0,z.jsx)(Ja,{}),(0,z.jsx)(Da.Z,{}),(0,z.jsx)(mr,{}),(0,z.jsx)(Or,{}),(0,z.jsx)(Rr,{}),(0,z.jsx)(Ir,{}),(0,z.jsx)(Fa,{}),(0,z.jsx)(ir,{}),(0,z.jsx)(Qs,{}),(0,z.jsx)(j.LazyInjectThirdPartyScripts,{}),(0,z.jsx)(Ys.Kd,{}),(0,z.jsx)(Js,{})]})})}getStyle(){return{...(0,a.N7)(s.SP),color:this.theme.regularTextColor,WebkitFontSmoothing:"auto",backgroundColor:this.theme.contentBackground}}}od.displayName="Notion";const sd=(0,v.injectIntl)(od);var rd=n(94273);class ad extends o.Z{willMount(){const e=m.u5({schemeUrl:window.location.href,baseUrl:T.default.domainBaseUrl});w.navigateToExternalURL({environment:this.environment,url:e}),rd.vq(),w.navigate({environment:this.environment,url:p._j.root,redirect:!0})}}ad.displayName="OpenExternal";const dd=ad;class ld extends o.Z{constructor(){super(...arguments),this.didCatchError=!1,this.caughtErrorId=void 0,this.openSupportMessages=()=>{C.j({environment:this.environment,from:"page_error"})},this.handleOpenNativeLink=e=>{"string"==typeof e?this.handleOpenNativeLinkV2(e,!1,!1):this.handleOpenNativeLinkV2(e.url,!1,!1)},this.handleOpenNativeLinkV2=(e,t,n)=>{const{RouterStore:i}=this.environment,o=m.RD({url:e,protocol:T.default.protocol,baseUrl:T.default.domainBaseUrl}),s=m.u5({schemeUrl:o,baseUrl:T.default.domainBaseUrl}),r=u.Wj({url:s,baseUrl:T.default.domainBaseUrl,publicDomainName:T.default.publicDomainName,isMobile:this.environment.device.isMobile,protocol:T.default.protocol,currentUrl:window.location.href});(this.environment.device.isAndroid||t)&&w.clearHistoryState({RouterStore:i,currentUserId:this.environment.currentUser.id}),this.environment.mobileNative&&this.environment.mobileNative.closeInAppBrowser(),"googleAuthCallback"!==r.name&&"samlAuthCallback"!==r.name?w.navigate({environment:this.environment,url:s,redirect:t,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:n},queryId:"page"===r.name?r.queryId:void 0}):w.navigate({environment:this.environment,url:s})}}didMount(){this.environment.currentUser.isLoggedIn()&&I.default.waitUntil((()=>{const e=I.default.state.currentUserSettingsStore,t=(null==e?void 0:e.isDefined())??!1;if(e&&t){const t=e.getSettings(),n=null==t?void 0:t.disable_auto_set_timezone;t&&!n&&k.wk({environment:this.environment,userSettingsStore:e})}return t}))}willMount(){this.props.onBeforeMount&&this.props.onBeforeMount();const{RouterStore:e,currentUser:t}=this.environment,n=t.id;window.addEventListener("beforeunload",(()=>{w.updateHistoryState({historyId:e.state.id,currentUserId:n})})),window.onpopstate=async t=>{const n=window.location.href,i=t.state?t.state.currentUserId:void 0;let o=this.environment;i&&i!==this.environment.currentUser.id&&(o=await x.x({environment:o,newCurrentUserId:i}));const s=e.state.route,r=u.Wj({url:n,isMobile:o.device.isMobile,baseUrl:T.default.domainBaseUrl,publicDomainName:T.default.publicDomainName,protocol:T.default.protocol,currentUrl:window.location.href}),a="page"===s.name&&"page"===r.name&&s.blockId===r.blockId,d="onboarding"!==s.name&&"onboarding"===r.name;w.updateHistoryState({historyId:e.state.id,currentUserId:i}),await w.updateRouterState({environment:o,id:t.state&&t.state.id||(0,c.ZP)(),action:"pop",href:n}),d&&!this.environment.device.isMobileNative&&w.navigate({environment:o,url:p._j.root}),a&&w.handleNavigateWithinSamePage(o)},this.environment.mobileNative&&this.environment.mobileNative.subscribeToOpenLink(this.handleOpenNativeLinkV2),S.subscribeToProtocolUrl(this.handleOpenNativeLink),S.subscribeToSettingsMenuItem(this.handleOpenSettings),S.ready(),S.onNewWindow(((e,t)=>{e.preventDefault(),w.navigate({environment:this.environment,url:t,openInNew:"tab"})}))}componentDidCatch(e,t){console.error("Client crash during React render:",e),this.caughtErrorId=g.rn(e,{from:"Router",type:"ClientCrash",data:{miscDataToConvertToString:t}}),this.didCatchError=!0,this.forceUpdate()}renderComponent(){return(0,z.jsx)(v.IntlProvider,{defaultLocale:"en-US",locale:s.SP,messages:s.sY,children:(0,z.jsx)(Ts,{...js(this.environment.device),children:this.renderRouteOrError()})})}renderRouteOrError(){return this.didCatchError?(0,z.jsxs)("div",{style:ld.reactErrorStyle,children:[(0,l.H)({width:42,height:42}),(0,z.jsxs)("div",{style:ld.reactErrorMessageStyle,children:[(0,z.jsx)("div",{children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Oops! Something went wrong.",id:"router.renderErrorPage.message.part1"})}),(0,z.jsx)("div",{children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Please refresh and try again or <textlink>message support</textlink>.",id:"router.renderErrorPage.message.part2",values:{textlink:e=>(0,z.jsx)(_s.Z,{onClick:this.openSupportMessages,children:e})}})}),this.caughtErrorId&&(0,z.jsx)("div",{style:ld.reactErrorMessageIdStyle,children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Error ID: {errorId}",id:"router.renderErrorPage.message.errorId",values:{errorId:this.caughtErrorId.slice(0,8)}})})]}),(0,z.jsx)(B.Z,{isLarge:!0,onClick:()=>window.location.reload(),children:(0,z.jsx)(v.FormattedMessage,{defaultMessage:"Refresh",id:"router.renderErrorPage.reloadButton.label"})})]}):(0,z.jsx)(sd,{children:this.renderRoute()})}renderRoute(){const{RouterStore:e}=this.environment,t=e.state;if("root"!==t.route.name&&"page"!==t.route.name&&"space"!==t.route.name&&(b.setInitialRenderCompleted(),I.default.setState({...I.default.state,renderPhase:"rendered"})),this.environment.currentUser.isLoggedIn()||"page"===t.route.name||"space"===t.route.name||r.j(this.environment.device,{facebook:{eventName:"PageView",data:{content_name:window.location.href}},google:{eventName:"pageView",path:window.location.pathname}}),this.environment.currentUser.isLoggedIn()&&I.default.state.currentUserSettingsStore){const{currentUserSettingsStore:e}=I.default.state;M.dM(this.environment,e)}const{device:i}=this.environment;if(i.isNative&&u.lQ[t.route.name])return(0,z.jsx)(dd,{});if("front"===t.route.name)return(0,z.jsx)(Cs,{preventFrontRedirect:t.route.alreadyRedirected});if("root"===t.route.name)return(0,z.jsx)(Ps,{route:t.route});if("nativeRedirect"===t.route.name)return(0,z.jsx)(Zs,{redirect:t.route.redirect});if("login"===t.route.name)return(0,z.jsx)(j.LazyLoginPage,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL});if("desktopEmailConfirm"===t.route.name)return(0,z.jsx)(ws,{});if("teamsInvite"===t.route.name){const{teamId:e}=t.route;return f.uAt(this.environment,{teamId:e}),(0,z.jsx)(As.Z,{fetch:async()=>{const t=new P.zX(this.environment,{table:h.e0,id:e});await t.load()},render:()=>(0,z.jsx)($,{teamId:e})})}if("signup"===t.route.name)return(0,z.jsx)(j.LazyLoginPage,{isSignup:!0,email:t.route.email});if("unsubscribe"===t.route.name)return(0,z.jsx)(gs,{payload:t.route.payload});if("onboarding"===t.route.name)return(0,z.jsx)(j.LazyOnboarding,{});if("upcomingInvoice"===t.route.name)return(0,z.jsx)(j.LazyInvoice,{route:t.route});if("invoiceById"===t.route.name)return(0,z.jsx)(j.LazyInvoice,{route:t.route});if(t.route.name,t.route.name,"admin"===t.route.name&&T.default.isAdminMode)return(0,z.jsx)(As.Z,{fetch:()=>Promise.all([n.e(2743),n.e(782),n.e(2069),n.e(1798),n.e(8611),n.e(2328)]).then(n.bind(n,68611)),render:e=>{let{default:t}=e;return(0,z.jsx)(t,{})}});if("adminListData"===t.route.name){const{category:e}=t.route;if(T.default.isAdminMode)return(0,z.jsx)(As.Z,{fetch:()=>Promise.all([n.e(2743),n.e(782),n.e(2069),n.e(1798),n.e(8611),n.e(2328)]).then(n.bind(n,65585)),render:t=>{let{default:n}=t;return(0,z.jsx)(n,{category:e})}})}if("adminSingleRecord"===t.route.name&&T.default.isAdminMode){const{id:e,table:i}=t.route;return(0,z.jsx)(As.Z,{fetch:()=>Promise.all([n.e(2743),n.e(782),n.e(2069),n.e(1798),n.e(8611),n.e(3854)]).then(n.bind(n,48807)),render:t=>{let{default:n}=t;return(0,z.jsx)(n,{table:i,id:e})}})}if("oauthAuthorization"===t.route.name){const{responseType:e,redirectUri:i,integrationId:o,state:s,owner:r,userId:a,spaceId:d}=t.route;return(0,z.jsx)(As.Z,{fetch:()=>Promise.all([n.e(2774),n.e(2743),n.e(9342),n.e(7848),n.e(3370)]).then(n.bind(n,31074)),render:t=>{let{default:n}=t;return(0,z.jsx)(n,{responseType:e,redirectUri:i,integrationId:o,state:s,owner:r,userId:a,spaceId:d})}})}if("initiateExternalAuthentication"===t.route.name){const{notion_user_id:e,notion_workspace_id:i,notion_last_visited_url:o,notion_authorization_code:s,external_object_instance_block_id:r,callback_type:a,integration_id:d,redirectToAuth:l}=t.route;return(0,z.jsx)(As.Z,{fetch:()=>n.e(1023).then(n.bind(n,84750)),render:t=>{let{default:n}=t;return(0,z.jsx)(n,{notion_user_id:e,notion_workspace_id:i,notion_last_visited_url:o,notion_authorization_code:s,external_object_instance_block_id:r,callback_type:a,integration_id:d,redirectToAuth:l})}})}return"myIntegrations"===t.route.name?"pointer"in t.route?(0,z.jsx)(j.LazyDeveloperIntegrationViewV2,{botOrIntegrationPointer:t.route.pointer}):(0,z.jsx)(j.LazyDeveloperIntegrationsList,{}):"myIntegrationsLab"===t.route.name?(0,z.jsx)(j.LazyDeveloperIntegrationLab,{integrationPointer:t.route.pointer}):"inAppTemplateSubmission"===t.route.name?"inAppTemplateCreatorSubmission"===(null===(o=t.initialRoute)||void 0===o?void 0:o.name)?(0,z.jsx)(Q,{openCreatorProfileModal:!0}):(0,z.jsx)(Q,{openCreatorProfileModal:!1}):("inAppTemplateCreatorSubmission"===t.route.name&&w.navigate({environment:this.environment,url:p._j.templateSubmission,redirect:!0}),"studentGroupSignup"===t.route.name?(0,z.jsx)(_,{}):"notFound"===t.route.name?(0,z.jsx)(j.LazyPageError,{route:t.route,publicPageData:void 0}):"page"===t.route.name||"space"===t.route.name||"nativeTab"===t.route.name||"workspaceSetup"===t.route.name||"modal"===t.route.name||"quickSearch"===t.route.name?(0,z.jsx)(us,{routerState:t}):(0,z.jsx)(ps.Z,{}));var o}handleOpenSettings(){y.r$()}}ld.displayName="Router",ld.reactErrorStyle={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:100,...(0,a.N7)(s.SP)},ld.reactErrorMessageStyle={fontSize:14,textAlign:"center",marginTop:6,marginBottom:12,color:d.ZP.uiGray},ld.reactErrorMessageIdStyle={fontSize:10,marginTop:8};const cd=ld},14694:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});n(67294);var i=n(480),o=n(86628),s=n(24405),r=n(39567),a=n(50659),d=n(85893);function l(){window.__c={n:"AliasIcon"};const e=(0,s.yK)((e=>({icon:{position:"absolute",width:"50%",height:"50%",right:0,bottom:0,fill:"dark"===e.mode?e.regularTextColor:"#3E3C38",stroke:"dark"===e.mode?e.sidebarBackground:"white",strokeWidth:"dark"===e.mode?"1.85px":"1.5px"}})),[]);return(0,d.jsx)("div",{children:(0,r.Y)(e.icon)})}function c(e){var t;window.__c={n:"SidebarItem"};const n=(0,i.O7)(),r=n.device.isMobile,c=(0,o.VK)((()=>{var t,i;if(r)return n.WindowSizeStore.getSafePaddingLeftCSS("number"==typeof(null===(t=e.style)||void 0===t?void 0:t.paddingLeft)?null===(i=e.style)||void 0===i?void 0:i.paddingLeft:10)}),[n.WindowSizeStore,r,null===(t=e.style)||void 0===t?void 0:t.paddingLeft]),u=(0,s.yK)((t=>({wrapper:{...r?{display:"flex",alignItems:"center",width:"100%",minHeight:26,fontSize:16,paddingTop:8,paddingBottom:8,paddingLeft:c,paddingRight:10,userSelect:"none",WebkitUserSelect:"none",boxShadow:e.disableMobileBorder?void 0:`0 1px 0 ${t.regularDividerColor}`,marginBottom:e.shouldShowMobileMarginBottom?12:1}:{display:"flex",alignItems:"center",width:"100%",fontSize:14,minHeight:27,paddingTop:2,paddingBottom:2,marginTop:1,marginBottom:1,...(0,a.MF)()},...e.style},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:r?28:22,height:r?24:18,marginLeft:-3,marginRight:4,position:"relative"},right:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,height:"100%",...e.rightStyle},left:{flexShrink:0,flexGrow:0,borderRadius:3,color:t.mediumTextColor,width:r?26:22,height:r?24:22,display:"flex",alignItems:"center",justifyContent:"center",marginRight:e.icon?0:8},children:{flexGrow:1,flexShrink:1,flexBasis:"auto",whiteSpace:"nowrap",minWidth:0,overflow:"hidden",textOverflow:e.right&&!r?"clip":"ellipsis",...e.childrenStyle}})),[r,c,e.disableMobileBorder,e.shouldShowMobileMarginBottom,e.style,e.rightStyle,e.icon,e.right,e.childrenStyle]);return(0,d.jsxs)("div",{role:e.role,"aria-current":e["aria-current"],"aria-expanded":e["aria-expanded"],"aria-owns":e["aria-owns"],"aria-labelledby":e["aria-labelledby"],style:u.wrapper,onFocus:e.onFocus,onBlur:e.onBlur,onMouseMove:e.onMouseMove,onMouseLeave:e.onMouseLeave,onClick:e.onClick,className:e.className,children:[e.left&&(0,d.jsx)("div",{style:u.left,children:e.left}),e.icon&&(0,d.jsxs)("div",{style:u.icon,children:[e.icon,e.isAlias&&(0,d.jsx)(l,{})]}),(0,d.jsx)("div",{style:u.children,children:e.children}),e.right&&(0,d.jsx)("div",{style:u.right,children:e.right})]})}},55064:(e,t,n)=>{"use strict";n.d(t,{Z:()=>M});var i=n(67294),o=n(83355),s=n(97880),r=n(51454),a=n(5366),d=n(17659),l=n(18957),c=n(24677),u=n(98742),p=n(89224),h=n(74948),m=n(24646),g=n(38676),v=n(36391),f=n(96049),S=n(31792),b=n(45325),y=n(88923),w=n(6685),k=n(26388),x=n(85893);class C extends o.Z{constructor(){super(...arguments),this.didDragMove=!1,this.storeTypes={mouseStore:S.Z},this.renderTooltip=()=>{const e=this.isSidebarExpanded(),t=this.theme.mediumInvertedTextColor;return(0,x.jsxs)("div",{style:{textAlign:"center"},children:[(0,x.jsx)(a.FormattedMessage,{defaultMessage:"Drag <invertedcolor>to resize</invertedcolor>",id:"sidebarResizer.tooltip.dragMessage",values:{invertedcolor:e=>(0,x.jsx)("span",{style:{color:t},children:e})}}),(0,x.jsxs)(i.Fragment,{children:[(0,x.jsx)("br",{}),(0,x.jsx)(a.FormattedMessage,{defaultMessage:"Click <invertedcolor>to {expanded, select, true {close} other {lock open}}</invertedcolor>",id:"sidebarResizer.clickToToggleSidebar.message",values:{expanded:e,invertedcolor:e=>(0,x.jsx)("span",{style:{color:t},children:e})}})]})]})},this.handleMouseEnter=e=>{g.ck.setState(e.clientY)},this.handleMouseMove=()=>{this.updateResizingStore({isResizerHovered:!0})},this.handleMouseLeave=()=>{this.updateResizingStore({isResizerHovered:!1})},this.handleDragStart=()=>{c.ZH(this.environment),this.stores.mouseStore.setState({...this.stores.mouseStore.state,mousePressed:!0}),this.didDragMove=!1,this.updateResizingStore({...g.cY.state,isResizing:!0})},this.handleDragMove=e=>{const{type:t}=this.props;switch(p.clear(this.environment),this.didDragMove=!0,t){case"page":h.setWidth({width:this.calculateWidth(e.currentX),environment:this.environment});break;case"update":h.setUpdateWidth({width:this.calculateWidth(e.currentX),environment:this.environment});break;case"peek":h.setPeekWidth({width:this.calculateWidth(e.currentX),environment:this.environment});break;case"inbox":b.ZP.update((t=>({...t,width:this.calculateWidth(e.currentX)})));break;default:(0,s.t1)(t)}},this.handleDragEnd=()=>{const{type:e}=this.props;if(!this.didDragMove){switch(e){case"page":h.setExpand({environment:this.environment,isExpanded:!g.gV.state,from:"sidebar_resizer"}),g.TC.setState(!1);break;case"update":h.setUpdateExpand({environment:this.environment,isExpanded:!(0,m.Sx)(this.environment),from:"drag"});break;case"peek":l.xv(this.environment,"resizer_click");break;case"inbox":d.qQ({environment:this.environment,open:!b.ZP.isOpen()});break;default:(0,s.t1)(e)}this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})}this.stores.mouseStore.setState({...this.stores.mouseStore.state,mousePressed:!1}),this.updateResizingStore({isResizing:!1})},this.handleDragCancel=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mousePressed:!1}),this.updateResizingStore({isResizing:!1})}}renderComponent(){const{device:e}=this.environment,{type:t}=this.props,n=this.getTooltipX(),i=g.ck.state;if(!f.Z.state&&!e.isChromebook)return(0,x.jsx)(k.Z,{renderTooltip:this.renderTooltip,originRect:new DOMRect(n,i,0,0),delayThreshold:500,placement:"page"===t||"inbox"===t?k.Z.Placement.Right:k.Z.Placement.Left,originGap:10,render:e=>(0,x.jsx)("div",{style:this.getWrapStyle(),...(0,u.Z)(e,{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter}),children:(0,x.jsx)(w.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,x.jsx)("div",{style:this.getStyle(),...e})})})})}get minWidth(){const{type:e}=this.props;switch(e){case"page":return g.nP;case"update":return v.AO;case"peek":return y.sidePeekMinWidth;case"inbox":return 320;default:(0,s.t1)(e)}}get maxWidth(){const{type:e}=this.props,t=window.innerWidth;switch(e){case"page":return 480;case"update":return Math.min(t/2,m.Nc);case"peek":return t>2*y.sidePeekMinWidth?t/1.5:t;case"inbox":return 420;default:(0,s.t1)(e)}}calculateWidth(e){const{type:t}=this.props;let n;switch(t){case"page":n=e;break;case"inbox":n=e-(g.gV.state?g.GZ.state:0);break;case"peek":case"update":n=window.innerWidth-e;break;default:(0,s.t1)(t)}return n>this.maxWidth?this.maxWidth:n<this.minWidth?this.minWidth:n}getWidth(){const{type:e}=this.props;switch(e){case"page":return g.GZ.state;case"inbox":return b.ZP.getPanelWidth();case"update":return v.ZP.state.width;case"peek":return y.default.state.preferredSidePeekWidth;default:(0,s.t1)(e)}}updateResizingStore(e){const{type:t}=this.props;switch(t){case"page":g.cY.update((t=>({...t,...e})));break;case"update":v.ZP.update((t=>({...t,...e})));break;case"inbox":b.ZP.update((t=>({...t,...e})));break;case"peek":break;default:(0,s.t1)(t)}}getTooltipX(){const{type:e}=this.props,t=this.getWidth();switch(e){case"page":return t;case"inbox":return g.GZ.state+b.ZP.getPanelWidth();case"peek":case"update":return window.innerWidth-t;default:(0,s.t1)(e)}}isSidebarExpanded(){const{type:e}=this.props;switch(e){case"page":return(0,m.in)(this.environment);case"update":return(0,m.Sx)(this.environment);case"peek":return y.default.state.open;case"inbox":return b.ZP.isOpen();default:(0,s.t1)(e)}}getWrapStyle(){const{type:e}=this.props,t=(0,m.in)(this.environment);return{position:"absolute",left:"peek"===e?0:void 0,right:"peek"!==e?0:void 0,width:0,flexGrow:0,zIndex:"peek"===e?r.YO:1,top:t?0:-1,bottom:t?0:-1,pointerEvents:"auto"}}getStyle(){return{cursor:"col-resize",height:"100%",width:12,marginLeft:"update"===this.props.type?-v.ZP.state.width:-6}}}C.displayName="SidebarResizer";const M=C},24553:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var i=n(67294),o=n(13991),s=n(480),r=n(6740),a=n(86628),d=n(24405),l=n(84169),c=n(88642),u=n(5366),p=n(50906),h=n(39634),m=n(24215),g=n(43250),v=n(79897),f=n(98742),S=n(77907),b=n(58455),y=n(77080),w=n(475),k=n(16194),x=n(55031),C=n(64921),M=n(31945),T=n(26388),j=n(14694),I=n(85893);function P(e){window.__c={n:"HelpButtonOrigin"};const t=(0,s.O7)(),{isMobile:n}=t.device,o=(0,u.useIntl)(),c=(0,d.Fg)(),p=(0,a.VK)((()=>w.Z.state.open),[]),h=(0,d.yK)((e=>({helpIcon:{fill:e.mediumIconColor,width:16,height:16},hoveredStyle:{background:e.whiteButtonHoveredBackground},pressedStyle:{background:e.whiteButtonPressedBackground}})),[]),m=(0,i.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,r.E)(t)&&k.Z.setState(!0)}),[]),v=(0,i.useCallback)((()=>{k.Z.setState(!1)}),[]);if(n)return(0,I.jsx)(C.Z,{hovered:p,testId:g.lmr,mobileFeedback:n,...e,children:(0,I.jsx)(j.Z,{left:(0,l.m)(h.helpIcon),disableMobileBorder:!0,children:(0,I.jsx)(u.FormattedMessage,{defaultMessage:"Help & feedback",id:"helpButton.mobileHelpFeedbackButton.label"})})});const S=o.formatMessage({defaultMessage:"Help, feedback, and keyboard shortcuts",id:"helpButton.desktopHelpButton.ariaLabel"}),b=(0,f.Z)(e,{onFocus:m,onBlur:v});return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(T.Z,{renderTooltip:()=>(0,I.jsx)("span",{children:(0,I.jsx)(u.FormattedMessage,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:(0,I.jsx)("br",{})}})}),render:e=>(0,I.jsx)(C.Z,{ariaLabel:S,className:g.lmr,testId:g.lmr,style:(0,x.y)(t,{theme:c,rightEdgeDistance:16,isInPeekRenderer:!1}),hoveredStyle:h.hoveredStyle,pressedStyle:h.pressedStyle,...(0,f.Z)(b,e),children:"?"})})})}const _=(0,u.injectIntl)((function(){window.__c={n:"HelpButton"};const e=(0,s.O7)(),{isMobile:t}=e.device,n=(0,a.VK)((()=>{var t;return(null===(t=e.mobileNative)||void 0===t?void 0:t.supportsNativeHomeOnPhone())||!1}),[e]),r=(0,i.useCallback)((()=>{p.Ar6(e);const t=b.default.state;if((0,m.Ug)()&&t.isZendeskEnabled){const{userHighestPlanType:n,isSalesAssistedPlan:i}=(0,v.r)(e);c.j({locale:o.SP,analyticsSettings:t,isForethoughtEnabled:y.default.checkGate("forethought"),forethoughtInitializeArgs:h.z(),userHighestPlanType:n,isSalesAssistedPlan:i})}}),[e]);return(0,I.jsx)(M.ZP,{popupType:t?M.Z4.SlideUp:M.Z4.Popup,hidesMobileNativeBottomBar:n,preventSlideUpTransition:n,renderOrigin:e=>(0,I.jsx)(P,{...e}),originGap:t?0:12,placementToOrigin:t?M.pO.Right:M.pO.Top,alignmentToOrigin:t?M.vR.Center:M.vR.End,buttonPopupStore:w.Z,onClick:r,render:()=>(0,I.jsx)(S.LazyHelpButtonContent,{shouldRenderAsStaticModal:n})})}))},69098:(e,t,n)=>{"use strict";n.d(t,{j:()=>c,o:()=>i});var i={};n.r(i),n.d(i,{showAsyncModal:()=>p,showAsyncModalComponent:()=>h,testOnly:()=>w});var o=n(67294),s=n(86628),r=n(49085);class a extends r.default{getInitialState(){return{asyncModals:[]}}}const d=new a;var l=n(85893);const c=o.memo((e=>{window.__c={n:"AsyncModalRenderer"};const{store:t=d}=e,n=(0,s.VK)((()=>t.state.asyncModals),[t]);return(0,l.jsx)(l.Fragment,{children:n.map((e=>{const{id:t,internalRenderModal:n,isOpen:i}=e,s=n(i);return(0,l.jsx)(o.Fragment,{children:s},t)}))})}));var u=n(4615);function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;return new Promise(((n,i)=>{try{m({asyncModal:S({renderModal:e,promiseResolve:n,promiseReject:i,store:t}),store:t})}catch(o){i(o)}}))}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;const n=t=>o.createElement(e,t);return p(n,t)}function m(e){const{asyncModal:t,store:n=d}=e;n.update((e=>({asyncModals:[...e.asyncModals,t]})))}function g(e){const{id:t,promiseResolve:n,store:i=d}=e;return e=>{const o=b({id:t,store:i});null!=o&&o.isOpen&&(y({id:t,store:i,update:{isOpen:!1}}),n(e))}}function v(e){const{id:t,promiseResolve:n,store:i=d}=e;return()=>{const e=b({id:t,store:i});null!=e&&e.isOpen&&(y({id:t,store:i,update:{isOpen:!1}}),n())}}function f(e){const{id:t,store:n=d}=e;return()=>{n.update((e=>({asyncModals:e.asyncModals.filter((e=>e.id!==t))})))}}function S(e){const{renderModal:t,promiseResolve:n,promiseReject:i,store:o=d}=e,s=(0,u.ZP)(),r=f({id:s,store:o}),a=v({id:s,promiseResolve:n,store:o}),l=g({id:s,promiseResolve:n,store:o});return{id:s,internalRenderModal:e=>{try{return t({isOpen:e,onClosed:r,onDismiss:a,resolve:l})}catch(n){throw i(n),n}},isOpen:!0}}function b(e){const{id:t,store:n=d}=e;return n.state.asyncModals.find((e=>e.id===t))}function y(e){const{id:t,update:n,store:i=d}=e;i.update((e=>({asyncModals:e.asyncModals.map((e=>e.id!==t?e:{...e,...n}))})))}const w={addAsyncModal:m,createAsyncModal:S,createOnClosed:f,createOnDismiss:v,createResolve:g,getAsyncModal:b,updateAsyncModal:y}},65556:(e,t,n)=>{"use strict";n.r(t),n.d(t,{setupOnBeforeUnload:()=>s,showConfirmationDialogEventEmitter:()=>i});const i=new(n(33147).Z),o={transaction_queue_has_tasks:"Changes you made may not be saved. Are you sure you want to quit?",uploading_files:"The files you are currently uploading may not be saved. Are you sure you want to quit?"};function s(e){const{TransactionQueue:t,device:n,AppUpdateStore:s,GlobalFileUploadStore:r}=e;window.onbeforeunload=function(){const e=!t.hasTasks()||n.isMobileNative||n.isElectron||s.isMajorUpdate()?r.isUploading()?"uploading_files":void 0:"transaction_queue_has_tasks";if(e)return i.emit(e),o[e]}}},45811:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});n(57658);var i=n(21202),o=n(75081),s=n(44499);function r(e){let{environment:t,typedDatabases:n,spaceStore:r,joinedTeamIds:d,blocksToFilterParents:l}=e;return function(e){let{typedDatabases:t,blocksToFilterParents:n}=e;const o=n?new Set((0,s.qB)(n)):void 0;return t.filter((e=>{if(!e.canEdit())return!1;if(!o)return!0;const t=e.getParentPointer();return!t||t.table!==i.iU||!o.has(t.id)}))}({typedDatabases:function(e){let{environment:t,typedDatabases:n,spaceStore:i,joinedTeamIds:s}=e;const{privateDatabases:r,otherDatabases:d,teamDatabases:l}=(0,o.x1)({environment:t,typedCollections:n,spaceStore:i});return[...a({teamDatabases:l,joinedTeamIds:s}),...d,...r]}({environment:t,spaceStore:r,typedDatabases:n,joinedTeamIds:d}),blocksToFilterParents:l})}function a(e){let{teamDatabases:t,joinedTeamIds:n}=e;const i=[];for(const[r,a]of Object.entries(t))for(const e of a)i.push([r,e]);if(0===i.length)return[];const o=Object.keys(t).filter((e=>!n.includes(e))),s=[...n,...o];return i.sort(((e,t)=>{let[n,i]=e,[o,r]=t;return s.indexOf(n)-s.indexOf(o)||String(i.getName()).localeCompare(String(r.getName()))})).map((e=>{let[t,n]=e;return n}))}},70511:(e,t,n)=>{"use strict";n.r(t),n.d(t,{setupTransactionLoadGenerator:()=>d});var i=n(92595),o=n(97444),s=n(39699),r=n(80444),a=n(24666);function d(e){(0,i.exposeDebugValue)("generateTransactionLoad",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const d=r.default.state.mainEditorCurrentBlockStore;if(!d)return void console.info("Cannot generateTransactionLoad: No current block");const l=d.getTitleStore();if(!l)return void console.info("Cannot generateTransactionLoad: block has no title");if("editing"!==a.default.state.mode)return void console.info("not editing anything. Click the page title.");const c=t=>{s.createAndCommit({userAction:"generateTransactionLoad.createTransaction",environment:e,perform:i=>{console.info("createAndCommit #",t);for(let s=0;s<n;s++){const n=`This is transaction #${t+1}, op ${s+1}, of load started at ${u}`;o.aS({environment:e,store:l,newValue:n,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:i})}}})},u=new Date;if(0===i)for(let e=0;e<t;e++)c(e);else{let e=0;const n=setInterval((()=>{e<t?(c(e),e++):clearInterval(n)}),i)}}))}},92725:(e,t,n)=>{"use strict";n.r(t),n.d(t,{instrumentRenderQueue:()=>l});var i=n(1302),o=n(77897),s=n(29091),r=n(24215),a=n(97448);const d={componentRender:{enabledPercent:0,sampleRate:0},recomputeStore:{enabledPercent:0,sampleRate:0}};function l(e){const t=(0,a.fastGetConfig)("event_trail_events"),n=(null==t?void 0:t.get("browser.render_queue.component_render",d.componentRender))||d.componentRender,l=(null==t?void 0:t.get("browser.render_queue.store_recompute",d.recomputeStore))||d.recomputeStore;if(0===n.enabledPercent&&0===l.enabledPercent)return;const c=Math.random(),u=(0,s.XJ)(1e4);(0,o.aw)(n.enabledPercent,(()=>c))&&i.default.setComponentRenderTracker({shouldTrackThisRender:()=>(0,o.aw)(n.sampleRate,u),trackRender:t=>{let{componentName:n,renderTime:i}=t;r.j(e,"browser.render_queue.component_render",{time:i,component:n})}}),(0,o.aw)(l.enabledPercent,(()=>c))&&i.default.setStoreRecomputeTracker({shouldTrackThisRecompute:()=>(0,o.aw)(l.sampleRate,u),trackRecompute:(t,n)=>{r.j(e,"browser.render_queue.store_recompute",{time:n,computed_store:t})}})}},19077:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initialize:()=>a});var i=n(68626),o=n(95477),s=n(77080),r=n(15517);function a(e){"object"==typeof o.default&&o.default.version&&(i.clientLogglyEnvironmentData.version=o.default.version);const{device:t,currentUser:n}=e;t.isMobileNative&&(i.clientLogglyEnvironmentData.isMobileNative=!0),t.isMobile&&(i.clientLogglyEnvironmentData.isMobile=!0),t.isAndroid&&(i.clientLogglyEnvironmentData.isAndroid=!0),t.isIOS&&(i.clientLogglyEnvironmentData.isIOS=!0),t.isElectron&&(i.clientLogglyEnvironmentData.isElectron=!0),t.isChromeExtension&&(i.clientLogglyEnvironmentData.isChromeExtension=!0),i.clientLogglyEnvironmentData.os=t.os,i.clientLogglyEnvironmentData.platform=t.platform,window.navigator.userAgent&&(i.clientLogglyEnvironmentData.userAgent=window.navigator.userAgent),document.referrer&&(i.clientLogglyEnvironmentData.referrer=document.referrer),n.id&&(i.clientLogglyEnvironmentData.userId=n.id),i.clientLogglyEnvironmentData.experiments=s.default.getUsedNonControlExperimentsMap(),s.default.addListener((()=>{i.clientLogglyEnvironmentData.experiments=s.default.getUsedNonControlExperimentsMap()})),(0,r.sK)().then((e=>{e&&(i.clientLogglyEnvironmentData.storageUsageEstimate=e.usage,i.clientLogglyEnvironmentData.storageQuotaEstimate=e.quota)}))}},44499:(e,t,n)=>{"use strict";n.d(t,{Hn:()=>m,XQ:()=>p,Xk:()=>u,qB:()=>h});n(57658);var i=n(41432),o=n(45433),s=n(21202),r=n(6287),a=n(55367),d=n(42330),l=n(35661),c=n(75770);function u(e,t){return!(!e.isNavigableBlock()&&e.getType()!==i.Ti.alias)&&(!e.isLinkedCollectionView()&&(!e.getMovedStore().getValue()&&!(0,c.ru)({targets:t,destination:e,direction:a.vh.Onto})))}function p(e){let{recentPageResults:t,blockResults:n,suggestedPages:i}=e;const o=new Set;for(const s of i){const e=s instanceof l.NW?s.getParentId():s.id;e&&o.add(e)}return[...t.filter((e=>!o.has(e.blockId))),...n.filter((e=>!o.has(e.blockId)))]}function h(e){const t=[];for(const i of e){const e=i.getParentPointer();if(e)if(e.table===s.iU)t.push(e.id);else if(e.table===r.v){var n;const e=null===(n=i.getAssociatedCollectionStore())||void 0===n?void 0:n.getParentPointer();e&&e.table===s.iU&&t.push(e.id)}}return t}function m(){const e=d.ZP.getTargetsDatabaseType(),t=d.ZP.getVariant();return("typedInitialized"===t||"typedUninitialized"===t)&&e&&e!==o.GZ}},50659:(e,t,n)=>{"use strict";n.d(t,{G$:()=>o,MF:()=>s,Z3:()=>i});function i(e){let{isMobile:t}=e;return{...!t&&{borderRadius:3}}}function o(e){let{isMobile:t}=e;return t?{}:{...i({isMobile:t}),marginLeft:4,marginRight:4,width:"calc(100% - 8px)"}}function s(){return{paddingLeft:10,paddingRight:10}}},48916:(e,t,n)=>{"use strict";n.r(t),n.d(t,{mainApp:()=>o});n(21703);var i=n(95477);async function o(e){const{mainStartTime:t,prefetchInitiatedTime:o,device:s,mobileNative:r,prefetchCache:a}=e,[{setupOnBeforeUnload:d},l,{createClientEnvironment:c},{setupTransactionQueue:u},{default:p},h]=await Promise.all([Promise.resolve().then(n.bind(n,65556)),Promise.resolve().then(n.bind(n,68626)),Promise.resolve().then(n.bind(n,78200)),Promise.resolve().then(n.bind(n,89087)),Promise.resolve().then(n.bind(n,27411)),Promise.resolve().then(n.bind(n,44133))]);let m=await c({device:s,mobileNative:r,prefetchCache:a});const{ElectronSqlite:g}=m;h.setupRecordCacheDebugging(s);const v=await u(m);d({device:s,TransactionQueue:v,AppUpdateStore:m.AppUpdateStore,GlobalFileUploadStore:p});const[f,{default:S}]=await Promise.all([Promise.resolve().then(n.bind(n,19077)),Promise.resolve().then(n.bind(n,18245))]);if(f.initialize(m),s.isMobileNative){const e=S.mark("initialize_react_native_from_js"),[t,i]=await Promise.all([Promise.resolve().then(n.bind(n,98958)),Promise.resolve().then(n.bind(n,57491))]);await t.initializeMobileNativeApp(m),Object.assign(l.clientLogglyEnvironmentData,i.getMobileNativeDeviceInfo()),S.measure(e,{environment:m})}if(s.isElectron){const e=await Promise.resolve().then(n.bind(n,47839));await e.initializeElectron({device:s,electronSqlite:g}),l.clientLogglyEnvironmentData.desktopVersion=s.desktopAppVersion}const[b,y,w,k,x,C,{getAppRefreshed:M}]=await Promise.all([Promise.resolve().then(n.bind(n,97977)),Promise.resolve().then(n.bind(n,74948)),Promise.resolve().then(n.bind(n,89224)),Promise.resolve().then(n.bind(n,75018)),Promise.resolve().then(n.bind(n,39699)),Promise.resolve().then(n.bind(n,78519)),Promise.resolve().then(n.bind(n,9852))]),{setupTransactionLoadGenerator:T}=await Promise.resolve().then(n.bind(n,70511));T(m);const j=performance.now(),[{EnvironmentContextProvider:I},{DependencyProviderAll:P},{default:_},A,L,U,{CurrentUser:Z},{getGhostAdminUserId:E},{default:R}]=await Promise.all([Promise.resolve().then(n.bind(n,34958)),Promise.resolve().then(n.bind(n,77907)),Promise.resolve().then(n.bind(n,58280)),Promise.resolve().then(n.t.bind(n,67294,19)),Promise.resolve().then(n.t.bind(n,73935,19)),Promise.resolve().then(n.t.bind(n,20745,19)),Promise.resolve().then(n.bind(n,87997)),Promise.resolve().then(n.bind(n,12955)),Promise.resolve().then(n.bind(n,77080))]);y.initialize(),w.startListeners(s),m=await b.initialize(m),m.updateCurrentUserId=async e=>{const t=await E(m),n={...e.environment,currentUser:new Z({id:e.currentUserId,loggedInUserIds:e.userIds,adminUserId:t})};G(n)},k.initialize(m),v.startLoop();const[{maybeClearCookies:B,refreshNotionCookies:V,validateHasPermissionArgsClient:O},{clearNotionCookiesWithNoPermission:D,clearThirdPartyCookiesAndLocalStorageWithNoPermission:N},{clearNotionLocalStorageWithNoPermission:z},{instrumentRenderQueue:F},W,q,{deviceSupportsSqlite:K}]=await Promise.all([Promise.resolve().then(n.bind(n,12955)),Promise.resolve().then(n.bind(n,29450)),Promise.resolve().then(n.bind(n,18613)),Promise.resolve().then(n.bind(n,92725)),Promise.resolve().then(n.bind(n,32223)),Promise.resolve().then(n.bind(n,32603)),Promise.resolve().then(n.bind(n,26492))]);B(),D(i.default),N(i.default),z(),V(m),O(m),C.initialize(m,{fromPageRefresh:M()});const[{TransactionQueueDependenciesImpl:H}]=await Promise.all([Promise.resolve().then(n.bind(n,68026))]);if(K(m.device)){const{default:e}=await Promise.resolve().then(n.bind(n,41226));e.setNotionPerformance(S)}F(m);const G=e=>{const n=performance.now(),i=document.querySelector("#notion-app");if(!i)throw new Error('Could not find element with id "notion-app"');const s=R.checkGate("react_18_concurrent_rendering");v.updateDependencies(new H(e)),x.updateConnectionState(e),W.updateEnvironment(e),l.clientLogglyEnvironmentData.userId=e.currentUser.id;const r=()=>{const e=document.getElementById("initial-loading-spinner"),i=document.getElementById("skeleton");e&&e.remove(),i&&i.remove();const s=performance.now();q.measureSubMetricsAtRenderCallback({mainStartTime:t,prefetchInitiatedTime:o,renderStartTime:n,renderEndTime:s,mainImportEndTime:j})},a=A.createElement(I,{value:e},A.createElement(P,void 0,A.createElement(_,s?{onBeforeMount:r}:{})));if(s){U.createRoot(i).render(a)}else L.render(a,i,r)};return G(m),{transactionQueue:v,environment:m}}},19361:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(49085);class o extends i.default{getInitialState(){return{isSupported:!1,active:!1,stage:"inactive",totalResults:0}}toggleActiveState(e){this.update((t=>({...t,active:e,stage:e?t.stage:"inactive",totalResults:e?0:t.totalResults})))}}const s=new o},78200:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createClientEnvironment:()=>ae});var i=n(26263),o=n(45631),s=n(87997),r=n(58287),a=n(94023),d=n(91814),l=n(27328),c=n(42389),u=n(20475),p=n(99747),h=n(47839),m=n(84709),g=(n(21703),n(57658),n(28084)),v=n(68626),f=n(55652),S=n(72126),b=n(45953),y=n(21202),w=n(97664),k=n(12139),x=n(66504),C=n(6451);let M=1;class T{constructor(e,t){this.getLatency=new f.s,this.batchReadWorkers=15,this.pendingWrites=b.Ao.create(),this.getManyFromDisk=async e=>{const t=b.Ao.create();e.forEach(((e,n)=>{let{pointer:i}=e;t.set(i,n)}));const n=await C.Q6(this.connection,e),i=b.Ao.create();for(const o of n)this.setCachedRecordMap(i,o);return e.map((e=>{let{pointer:t,userId:n}=e;const o=this.getInMemory(t,n);if(o)return o;const s=i.get(t);return s&&s[n]}))},this.diskReadQueue=new g.Z({batchSize:Math.floor(w.mz/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=b.Ao.create();const t=S.VS(Array.from(e),(e=>{let{value:t}=e;return t?Object.values(t):[]}));await C.Y3(this.connection,this.maxSize,t)},this.debouncedFlushWrites=S.Ds(this.flushWrites,500,{maxWait:3e3}),this.connection=e,this.maxSize=t}async initialize(e){}set(e,t,n,i,o){if(void 0===e||void 0===e.id){const t=new Error("Attempting to set a record with an invalid pointer.");return v.log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:t.stack},data:{pointer:e}}),void k.IE(t)}const s={pointer:e,userId:i=i||x.I,value:t,timestamp:Date.now(),importance:n};this.removePendingWrite(e,i,"delete"),this.enqueueWrite({type:"set",record:s,maybeStaleRecord:o})}async get(e,t){const n=`get ${M}`;t=t||x.I,M++,this.getLatency.start(n);try{const i=this.getInMemory(e,t);if(i)return this.enqueueWrite({type:"access",record:i}),this.getLatency.end(n,"memory"),i.value;const o=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:e,userId:t}):this.getFromDiskUnbatched(e,t));if(o)return this.enqueueWrite({type:"access",record:o}),this.getLatency.end(n,"disk"),o.value}finally{this.getLatency.end(n,"miss")}}deleteRecord(e,t){t=t||x.I,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}async getBlocksWithParent(e){const t=Date.now(),n=e.userId||x.I,i=await C.lR(this.connection,{...e,timestamp:t,userId:n}),o=b.Ao.create(),s=S.oA(Array.from(this.pendingWrites).map((i=>{const s=i&&i.value&&n&&i.value[n];if(!s||"set"!==s.type)return;const r=s.record.value?s.record.value.value:void 0;if(!r)return;if(s.record.pointer.table!==y.iU)return;const a=r;return a.parent_id===e.parent.id&&a.parent_table===e.parent.table?(o.set(s.record.pointer,!0),s.record.timestamp<t&&(s.record.timestamp=t),s.record.value):void 0})));for(const r of i)o.get(r.pointer)||this.getInMemory(r.pointer,r.userId)||s.push(r.value);return s}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||x.I,i=await C.GF(this.connection,{...e,timestamp:t,userId:n});return i.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),i}async reset(){this.pendingWrites=b.Ao.create(),await C.G$(this.connection)}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,i=this.pendingWrites.get(t),o=i&&i[n];if(o){if("set"===o.type&&"access"===e.type){const t={type:"set",record:{...o.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===o.type&&!o.maybeStaleRecord&&o.record.value&&o.record.value.value?o.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),i=n&&n[t];if(i&&"set"===i.type)return i.record}setCacheOperationMap(e,t){const n=t,{pointer:i,userId:o}=n.record,s=e.get(i)||{};e.set(i,{...s,[o]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:i}=t,o=e.get(n)||{};e.set(n,{...o,[i]:t})}removePendingWrite(e,t,n){const i=this.pendingWrites.get(e);i&&i[t]&&i[t].type===n&&this.pendingWrites.delete(e)}}var j=n(4615),I=n(65044),P=n(77892);const _=[WebSocket.OPEN,WebSocket.CONNECTING];class A{constructor(){this.sqliteConnection=void 0,this.environment=void 0,this.requests=new Map}setEnvironment(e){var t;this.environment=e,null===(t=this.sqliteConnection)||void 0===t||t.setEnvironment(e)}async initialize(){if(h.electronApi&&h.electronApi.sqliteServerEnabled){await this.initializeWebSocket();const e={execSqliteBatchV2:async e=>{const t=(0,j.ZP)(),{batch:n,precondition:i}=e,o=JSON.stringify({id:t,batch:n,precondition:i,auth:this.authToken});return await this.execSqliteBatchInner(t,o)},execSqliteBatch:async e=>{const t=(0,j.ZP)(),n=JSON.stringify({id:t,batch:e,auth:this.authToken});return await this.execSqliteBatchInner(t,n)}};this.sqliteConnection=new I.s({connection:e,type:"v2",migrations:await(0,P.kk)(e)})}}async execSqliteBatchInner(e,t){const n=new Promise((t=>{this.requests.set(e,t)}));this.ws.readyState===WebSocket.CLOSED&&await this.initializeWebSocket();try{this.ws.send(t)}catch(o){const e=this.ws;this.ws.onopen=function(n){e.send(t)}}const i=await n;if(i.error)throw new Error("Received SQLite error.");return i.value}async initializeWebSocket(){if(!h.electronApi||!h.electronApi.getSqliteMeta)return;const e=await h.electronApi.getSqliteMeta();if(e.error)return;if(this.ws&&_.includes(this.ws.readyState))return;const{serverProcessPort:t,authToken:n}=e.value;this.authToken=n;const i=`ws://127.0.0.1:${t}`;this.ws=new WebSocket(i),this.ws.onclose=()=>{v.log({level:"warning",from:"electronSqlite",type:"reinitializingWebsocket"}),this.initializeWebSocket()},this.ws.addEventListener("message",(e=>{const t=e.data.toString(),{id:n,result:i}=JSON.parse(t),o=this.requests.get(n);o&&(this.requests.delete(n),o({value:i}))})),await new Promise((e=>{this.ws.onopen=()=>{e()}}))}}var L=n(758),U=n(49085);class Z extends U.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.data)))}}const E=Z;var R=n(70203),B=n(77907);class V extends U.default{getInitialState(){return{loading:!1,loaded:!1}}async loadIfNeeded(e){if(this.state.loaded||this.state.loading)return;const t=e();if(!t)return;if(0===R.CGe(t).length)return;const n=B.deps.katex.loader();this.setState({loading:!0,loaded:!1,result:n}),this.setState({loading:!1,loaded:!0,result:await n})}getKatex(){if(this.state.loaded)return this.state.result}}var O=n(15157),D=n(44615),N=n(606),z=n(63143),F=n(54642),W=n(2688),q=n(89087);class K extends U.default{static getCacheKey(e){return`LocalBacklinkStore2:${e}`}getInitialState(){return{}}initializeBacklinks(e){let{block:t,currentUserId:n,environment:i}=e;if(this.instanceState[t.id])return;const o=this.getCachedBacklinkState({blockId:t.id,currentUserId:n});o?this.setState({...this.instanceState,[t.id]:{state:o,loaded:!0}}):this.setState({...this.instanceState,[t.id]:{state:{backlinks:[],inaccessibleBacklinkCount:0},loaded:!1}}),H(i,t),this.startMessageListeners(t,i)}awaitLoaded(e){return this.waitUntil((()=>{const t=this.state[e];return Boolean(t&&t.loaded)}))}destroyBacklinks(e,t){this.stopMessageListeners(e,t),delete this.instanceState[e]}getBacklinkState(e){let{blockId:t,currentUserId:n}=e;const i=this.state[t];return i?i.state:this.getCachedBacklinkState({blockId:t,currentUserId:n})||{backlinks:[],inaccessibleBacklinkCount:0}}setBacklinkState(e){let{blockId:t,state:n,currentUserId:i}=e;this.setCachedBacklinkState({blockId:t,state:n,currentUserId:i});const o=this.state[t];o&&this.setState({...this.state,[t]:{...o,state:n,loaded:!0}})}updateBacklinks(e){const{createdBacklinks:t,deletedBacklinks:n,currentUserId:i}=e,o=(0,z.cf)(t),s=(0,z.cf)(n),r=o.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),a=s.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),d=new Set([...Object.keys(r),...Object.keys(a)]);return d.forEach((e=>{const t=r[e]||[],n=a[e]||[],o=this.getBacklinkState({blockId:e,currentUserId:i}),s=t.filter((e=>!o.backlinks.some((t=>S.Xy(e,t))))),d=[...o.backlinks,...s].filter((e=>!n.some((t=>S.Xy(e,t)))));this.setBacklinkState({blockId:e,state:{...o,backlinks:d},currentUserId:i})})),Array.from(d)}resetBacklinkState(e){let{blockIds:t,currentUserId:n}=e;for(const i of t)this.setCachedBacklinkState({blockId:i,state:{backlinks:[],inaccessibleBacklinkCount:0},currentUserId:n})}getCachedBacklinkState(e){let{blockId:t,currentUserId:n}=e;return O.Z.get({userId:n,key:K.getCacheKey(t)})}setCachedBacklinkState(e){let{blockId:t,state:n,currentUserId:i}=e;return O.Z.set({userId:i,key:K.getCacheKey(t),value:n})}async startMessageListeners(e,t){const n=N.dr.fromSpaceShardRecordId(e,y.iU);q.transactionQueue.isPendingTransactionForRecord(n)&&await q.transactionQueue.drain();const i=this.instanceState[n.id];if(!i)return;let o,s=!1;const r=S.P2(((n,i)=>{const r=o,a=i||void 0;o=a,s?r!==a&&H(t,e):s=!0}),1e3),a=(0,D.Mv)(n.id);i.messageStoreListenerReference=W.Z.addListener(a,r,void 0,t)}stopMessageListeners(e,t){const n=this.instanceState[e];n&&n.messageStoreListenerReference&&(W.Z.removeListener(n.messageStoreListenerReference,t),n.messageStoreListenerReference=void 0)}}async function H(e,t){await q.transactionQueue.awaitRecordTransaction({id:t.id,table:y.iU});const n=await F.getBacklinksForBlock(e,{block:t});"failed"!==n.type&&e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:n.data.backlinks,inaccessibleBacklinkCount:n.data.inaccessibleBacklinkCount},currentUserId:e.currentUser.id})}var G=n(29477);class $ extends U.default{getInitialState(){return{isOpen:!1,isSubMenuOverridden:!1,subMenuType:null,menuType:null,shouldRestoreSelectionForMenu:!0,enableShouldShowDebugging:!1}}clear(e){this.update((t=>({...t,menuType:null,shouldRestoreSelectionForMenu:e})))}async clearNativeActionMenuAndRestoreSelectionIfNecessary(){null!==this.state.menuType&&(this.clear(!0),await G.Vs(10))}}var Q=n(97880);function Y(e){return`PageDetailsStore:${e.type}:${e.id}`}class X extends U.default{getInitialState(){return{}}static getDefaultToggleState(e){return"discussion"===e.type||"backlinks"!==e.type&&void(0,Q.t1)(e)}getToggleState(e){const t=Y(e);if(t in this.state)return this.state[t]}setToggleState(e,t){const n=Y(e);this.setState({...this.state,[n]:t})}}var J=n(54153);const ee="spellcheckEnabled";class te{constructor(e){let{device:t}=e;this.enabled=void 0,this.currentLanguages=void 0;const n=J.Z.get(ee);this.setEnabled(void 0===n||n)}setEnabled(e){var t,n;(this.enabled=e,J.Z.set(ee,e),null!==(t=h.electronApi)&&void 0!==t&&t.setSpellCheckerEnabled)&&(null===(n=h.electronApi)||void 0===n||n.setSpellCheckerEnabled(e))}isEnabled(){return this.enabled}getCorrections(e){return e.dictionarySuggestions}addToDictionary(e){var t;null!==(t=h.electronApi)&&void 0!==t&&t.addToDictionary&&h.electronApi.addToDictionary(e)}setLanguages(e){var t;S.Xy(this.currentLanguages,e)||(this.currentLanguages=e,null!==(t=h.electronApi)&&void 0!==t&&t.setSpellCheckerLanguages&&h.electronApi.setSpellCheckerLanguages(0===e.length?[navigator.language]:e))}async getLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=h.electronApi)&&void 0!==e&&e.getSpellCheckerLanguages){const e=await h.electronApi.getSpellCheckerLanguages();for(const i of e)n.push({code:i,name:t.of(i)})}return n}async getAvailableLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=h.electronApi)&&void 0!==e&&e.getAvailableSpellCheckerLanguages){const e=await h.electronApi.getAvailableSpellCheckerLanguages();for(const i of e)n.push({code:i,name:t.of(i)})}return n}}var ne=n(14577);class ie extends ne.Z{}const oe=["nativeRedirect","page","space","nativeTab","onboarding","unsubscribe","unknown","uiDoc","root"],se=[...oe,"login","signup","quickSearch"];let re=0;async function ae(e){var t,n;const{device:g,mobileNative:v,prefetchCache:f}=e,S=""+re++,b=g.isElectron&&Boolean(null===(t=h.electronApi)||void 0===t?void 0:t.sqliteServerEnabled)?await async function(e){var t;if(!e.device.isElectron||null===(t=h.electronApi)||void 0===t||!t.sqliteServerEnabled)return;const n=new A;return await n.initialize(),n}({device:g}):void 0,y=new d.Z,w=new l.Xk,k=new u.Z;let x;x=null!==(n=h.electronApi)&&void 0!==n&&n.getAvailableSpellCheckerLanguages?new te({device:g}):new L.P({device:g});const C=(null==v?void 0:v.sqliteConnection)||(null==b?void 0:b.sqliteConnection),M=C?new T(C,1e5):void 0,j=function(e){const{device:t,RouterStore:n,ThemeStore:i}=e;let o=oe;return(t.isElectron||t.isMobileNative)&&(o=se),new ie((()=>{const e=n.state.route;return e&&o.includes(e.name)?i.state.mode:"light"}),{debugName:"ThemeModeStore"})}({device:g,RouterStore:y,ThemeStore:k}),I=g.isMobile?new $:void 0,P={key:S,AppUpdateStore:new r.D,device:g,WindowSizeStore:new p.j({device:g},window),KeyboardShortcutStackStore:new a.h({device:g}),defaultRecordCache:new o.q({inMemoryRecordCache:new i.Z({name:"default"}),persistedRecordCache:M}),mobileNative:v,RouterStore:y,ThemeStore:k,ThemeModeStore:j,ElectronSqlite:b,KatexStore:new V,LocalBacklinkStore:new K,PageDetailsStore:new X,updateCurrentUserId:void 0,currentUser:new s.CurrentUser,SpellCheckStore:x,CsatMilestoneStore:new E,NativeMobileActionBarStore:I,TextSelectionCompositionStore:new c.h,recordSubscriptionActions:m,prefetchCache:f,TabbedRouterStore:w};return null==b||b.setEnvironment(P),null==v||v.setEnvironment(P),P}},91190:(e,t,n)=>{"use strict";n.d(t,{C:()=>s,E:()=>o});var i=n(61766);const o=new i.Z,s=new i.Z},26492:(e,t,n)=>{"use strict";function i(e){return e.isElectron||e.isMobileNative}n.r(t),n.d(t,{deviceSupportsSqlite:()=>i})},30021:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(53809),o=n(30548);const s=new i.D({key:"appearanceSettingStorageKey",namespace:o.$p,important:!0,trackingType:"necessary"})},43604:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=n(49085).default.createValue({open:!1})},74055:(e,t,n)=>{"use strict";n.d(t,{V:()=>o,Z:()=>r});var i=n(49085);let o=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class s extends i.default{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const r=new s},81212:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=new(n(61364).Z)},53610:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=new(n(61766).Z)},12309:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(49085),o=n(4615);class s extends i.default{getInitialState(){return{modalInfoById:{}}}async showModal(e){const t=(0,o.ZP)();return new Promise((n=>{const i=e((e=>{n(e),this.internalCloseModal(t,(()=>{this.internalRemoveModal(t)}))}));this.update((e=>({modalInfoById:{...e.modalInfoById,[t]:{...i,isOpen:!0}}})))}))}internalRemoveModal(e){this.update((t=>{const n={...t.modalInfoById};return delete n[e],{modalInfoById:n}}))}internalCloseModal(e,t){this.update((n=>({modalInfoById:{...n.modalInfoById,[e]:{...n.modalInfoById[e],isOpen:!1,onClosed:t}}})))}}const r=new s},82855:(e,t,n)=>{"use strict";n.d(t,{E:()=>s});n(67294);var i=n(45238),o=n(85893);const s=(0,i.I)("chevronDownRounded",{viewBox:"0 0 15 9",svg:(0,o.jsx)("path",{d:"M7.92188 8.65625C8.19531 8.64844 8.44531 8.54688 8.64844 8.32812L14.5859 2.25C14.7578 2.07812 14.8516 1.85938 14.8516 1.60156C14.8516 1.08594 14.4453 0.671875 13.9297 0.671875C13.6797 0.671875 13.4375 0.773438 13.2578 0.953125L7.92969 6.42969L2.58594 0.953125C2.40625 0.78125 2.17188 0.671875 1.91406 0.671875C1.39844 0.671875 0.992188 1.08594 0.992188 1.60156C0.992188 1.85938 1.08594 2.07812 1.25781 2.25L7.20312 8.32812C7.41406 8.54688 7.64844 8.65625 7.92188 8.65625Z"})})},25278:(e,t,n)=>{"use strict";n.d(t,{H:()=>s});n(67294);var i=n(45238),o=n(85893);const s=(0,i.I)("eyes",{viewBox:"0 0 72 72",svg:(0,o.jsx)("path",{d:"M17.0312 64.4375C26.25 64.4375 33.5625 52.9688 33.5625 36.4375C33.5625 19.9062 26.25 8.46875 17.0312 8.46875C7.8125 8.46875 0.5 19.9062 0.5 36.4375C0.5 52.9688 7.8125 64.4375 17.0312 64.4375ZM54.9688 64.4375C64.1875 64.4375 71.5 52.9688 71.5 36.4375C71.5 19.9062 64.1875 8.46875 54.9688 8.46875C45.75 8.46875 38.4375 19.9062 38.4375 36.4375C38.4375 52.9688 45.75 64.4375 54.9688 64.4375ZM10.0625 47.1875C15.125 47.1875 18.4688 43.6562 18.4688 38.3438C18.4688 33.0938 15.125 29.5625 10.0625 29.5625C7.6875 29.5625 5.71875 30.3125 4.25 31.6875C5.375 19.9375 10.6875 11.9375 17.0312 11.9062C24.25 11.875 30.125 22.0312 30.125 36.4375C30.125 50.7812 24.25 60.9688 17.0312 61C11.5312 61.0312 6.78125 54.9688 4.90625 45.5938C6.28125 46.625 8.03125 47.1875 10.0625 47.1875ZM47.9688 47.1875C53 47.1875 56.4062 43.6562 56.4062 38.3438C56.4062 33.0938 53 29.5625 47.9688 29.5625C45.5938 29.5625 43.5938 30.3438 42.1562 31.6875C43.2812 19.9375 48.5938 11.9375 54.9688 11.9375C62.1562 11.9062 68 22.0938 68 36.4375C68 50.7812 62.1562 60.9688 54.9688 60.9688C49.4375 61 44.6875 54.9375 42.7812 45.5938C44.1562 46.5938 45.9375 47.1875 47.9688 47.1875ZM45.5312 37.4062C44.4375 37.25 43.75 35.9688 44.0312 34.6562C44.3125 33.3125 45.3125 32.3438 46.375 32.5312C47.4688 32.75 48.0938 34.0312 47.8438 35.3125C47.5938 36.6562 46.5938 37.5938 45.5312 37.4062ZM7.625 37.4062C6.53125 37.25 5.84375 35.9688 6.09375 34.6562C6.375 33.3125 7.40625 32.3438 8.4375 32.5312C9.5625 32.7812 10.1875 34.0312 9.9375 35.3125C9.6875 36.6562 8.65625 37.5938 7.625 37.4062Z"})})},70954:(e,t,n)=>{"use strict";n.d(t,{C:()=>s});n(67294);var i=n(45238),o=n(85893);const s=(0,i.I)("notionLogoStroked",{viewBox:"0 0 41 42",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M4.253 2.903h0-.01c-1.02.09-1.806.481-2.322 1.142-.5.642-.671 1.441-.671 2.21v23.228c0 1.267.47 2.316 1.416 3.577h0l.006.008 4.99 6.477h0l.005.005c.465.593.963 1.017 1.617 1.256.63.23 1.33.26 2.138.221h.01l24.652-1.49h.008c1.137-.08 2.038-.396 2.632-1.071.588-.668.746-1.543.746-2.431V9.904c0-.584-.133-1.05-.508-1.486-.27-.311-.669-.602-1.113-.925a54.305 54.305 0 01-.176-.13l-.007-.004-.005-.004-6.772-4.761c-.838-.609-1.516-1.017-2.365-1.21-.824-.187-1.75-.156-3.047-.044L4.253 2.903z",fill:"#fff",stroke:"#fff",strokeWidth:"1.5"}),(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.257 3.158L5.176 4.637c-1.62.14-2.184 1.197-2.184 2.464v21.971c0 .987.352 1.83 1.198 2.959l4.72 6.126c.776.987 1.48 1.198 2.96 1.127l23.32-1.408c1.973-.14 2.537-1.057 2.537-2.606V10.552c0-.801-.316-1.032-1.25-1.714l-.16-.117-6.41-4.507c-1.55-1.126-2.184-1.268-4.65-1.056zM12.4 10.146c-1.904.129-2.337.158-3.418-.72l-2.75-2.183c-.28-.283-.14-.635.565-.705L26.102 5.13c1.62-.141 2.466.423 3.1.916l3.311 2.394c.141.07.493.492.07.492L12.645 10.13l-.245.016zM10.179 35.06V14.074c0-.916.281-1.338 1.126-1.41l22.898-1.337c.777-.07 1.128.423 1.128 1.338v20.844c0 .916-.14 1.691-1.41 1.761l-21.91 1.268c-1.269.07-1.832-.352-1.832-1.48zm21.63-19.86c.141.635 0 1.268-.635 1.34l-1.056.21v15.492c-.916.493-1.761.775-2.466.775-1.128 0-1.41-.352-2.255-1.408l-6.905-10.845v10.493l2.185.493s0 1.267-1.763 1.267l-4.86.282c-.142-.282 0-.986.492-1.127l1.269-.351V17.947l-1.761-.142c-.141-.634.21-1.549 1.197-1.62l5.214-.351 7.187 10.986V17.1l-1.832-.21c-.14-.776.422-1.339 1.127-1.409l4.863-.283z",fill:"#222"})]})})},55449:(e,t,n)=>{"use strict";n.d(t,{L:()=>s});n(67294);var i=n(45238),o=n(85893);const s=(0,i.I)("onboardingUseCaseBook",{viewBox:"0 0 18 22",svg:(0,o.jsx)("path",{d:"M3.654 21.535H16.36c.518 0 .918-.4.918-.918 0-.44-.302-.762-.674-.937-1.2-.537-1.435-2.198-.214-3.36.498-.44.879-.927.879-1.914V3.596c0-2.11-1.084-3.213-3.184-3.213H3.674C1.584.383.49 1.477.49 3.596v14.756c0 2.09 1.094 3.183 3.164 3.183zM13.908 2.326c.947 0 1.416.498 1.416 1.397v10.38c0 .479-.273.743-.761.743h-9.59V2.326h8.935zM2.434 15.187V3.723c0-.81.38-1.29 1.152-1.377v12.51a3 3 0 00-1.152.332zM6.72 6.8h6.826c.38 0 .693-.313.693-.694a.696.696 0 00-.693-.693H6.72a.696.696 0 00-.694.693c0 .381.313.694.694.694zm0 2.724h5.175c.381 0 .694-.312.694-.693a.696.696 0 00-.694-.693H6.721a.696.696 0 00-.694.693c0 .38.313.693.694.693zM3.918 19.7c-1.045 0-1.592-.596-1.592-1.514 0-.888.625-1.503 1.66-1.503h9.746c.108 0 .215-.01.313-.03-.488 1.035-.43 2.159.098 3.047H3.918z",fill:"#6E6C62"})})},18613:(e,t,n)=>{"use strict";n.r(t),n.d(t,{clearNotionLocalStorageWithNoPermission:()=>s});var i=n(46637),o=n(72128);function s(){i.Z.removeAllIfNoPermission(),o.Z.removeAllIfNoPermission()}},35717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},27117:(e,t,n)=>{var i=n(17187),o=n(35717);function s(e){if(!(this instanceof s))return new s(e);"number"==typeof e&&(e={max:e}),e||(e={}),i.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=e.max||1e3,this.maxAge=e.maxAge||0}e.exports=s,o(s,i.EventEmitter),Object.defineProperty(s.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),s.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},s.prototype.remove=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];return delete this.cache[e],this._unlink(e,t.prev,t.next),t.value}},s.prototype._unlink=function(e,t,n){this.length--,0===this.length?this.head=this.tail=null:this.head===e?(this.head=t,this.cache[this.head].next=null):this.tail===e?(this.tail=n,this.cache[this.tail].prev=null):(this.cache[t].next=n,this.cache[n].prev=t)},s.prototype.peek=function(e){if(this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return t.value}},s.prototype.set=function(e,t){var n;if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){if((n=this.cache[e]).value=t,this.maxAge&&(n.modified=Date.now()),e===this.head)return t;this._unlink(e,n.prev,n.next)}else n={value:t,modified:0,next:null,prev:null},this.maxAge&&(n.modified=Date.now()),this.cache[e]=n,this.length===this.max&&this.evict();return this.length++,n.next=null,n.prev=this.head,this.head&&(this.cache[this.head].next=e),this.head=e,this.tail||(this.tail=e),t},s.prototype._checkAge=function(e,t){return!(this.maxAge&&Date.now()-t.modified>this.maxAge)||(this.remove(e),this.emit("evict",{key:e,value:t.value}),!1)},s.prototype.get=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return this.head!==e&&(e===this.tail?(this.tail=t.next,this.cache[this.tail].prev=null):this.cache[t.prev].next=t.next,this.cache[t.next].prev=t.prev,this.cache[this.head].next=e,t.prev=this.head,t.next=null,this.head=e),t.value}},s.prototype.evict=function(){if(this.tail){var e=this.tail,t=this.remove(this.tail);this.emit("evict",{key:e,value:t})}}},20745:(e,t,n)=>{"use strict";var i=n(73935);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot}}]);