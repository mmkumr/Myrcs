"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5728],{62967:(e,t,n)=>{n.d(t,{$J:()=>A,CJ:()=>E,MV:()=>R,RE:()=>k,cN:()=>T,cs:()=>x,fi:()=>F,kv:()=>D,wL:()=>B,zz:()=>I});n(67294);var o=n(41432),i=n(8848),r=n(97880),a=n(5366),s=n(96802),l=n(39699),c=n(93405),d=n(48019),u=n(52275),p=n(78140),m=n(40721),f=n(86825),g=n(26388),h=n(42782),v=n(19037),b=n(93959),y=n(33929),S=n(87279),_=n(98742),w=n(85893);const k=(0,a.defineMessages)({deleteName:{id:"action.delete.name",defaultMessage:"Delete"},undoName:{id:"action.undo.name",defaultMessage:"Undo"},redoName:{id:"action.redo.name",defaultMessage:"Redo"},duplicateName:{id:"action.duplicate.name",defaultMessage:"Duplicate"},duplicateToPrivateName:{id:"action.duplicateToPrivate.name",defaultMessage:"Duplicate to Private"},turnIntoName:{id:"action.turnInto.name",defaultMessage:"Turn into"},copyLinkName:{id:"action.copyLink.name",defaultMessage:"Copy link to block"},copyLinkNavigableTypeName:{id:"action.copyLinkNavigableType.name",defaultMessage:"Copy link"},showCodePreviewFormat:{id:"action.showCodePreviewFormat.name",defaultMessage:"Preview"},showOnlyCodeFormat:{id:"action.showOnlyCodeFormat.name",defaultMessage:"Code"},showSplitViewFormat:{id:"action.showSplitViewFormat.name",defaultMessage:"Split"},searchPlaceholder:{defaultMessage:"Search for a language…",id:"codeBlock.searchPrompt"},backgroundColorDefaultKeywords:{id:"action.backgroundColor.default.fuzzySearchKeyword",defaultMessage:"Default Black White"},foregroundColorGrayKeywords:{id:"action.foregroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray"},backgroundColorGrayKeywords:{id:"action.backgroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray background Greybackground Graybackground"},foregroundColorBrownKeywords:{id:"action.foregroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown"},backgroundColorBrownKeywords:{id:"action.backgroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown background Brownbackground"},foregroundColorOrangeKeywords:{id:"action.foregroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange"},backgroundColorOrangeKeywords:{id:"action.backgroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange background Orangebackground"},foregroundColorYellowKeywords:{id:"action.foregroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow"},backgroundColorYellowKeywords:{id:"action.backgroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow background Yellowbackground"},foregroundColorTealKeywords:{id:"action.foregroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green"},backgroundColorTealKeywords:{id:"action.backgroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green background Tealbackground Greenbackground"},foregroundColorBlueKeywords:{id:"action.foregroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue"},backgroundColorBlueKeywords:{id:"action.backgroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue background Bluebackground"},foregroundColorPurpleKeywords:{id:"action.foregroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple"},backgroundColorPurpleKeywords:{id:"action.backgroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple background Purplebackground"},foregroundColorPinkKeywords:{id:"action.foregroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink"},backgroundColorPinkKeywords:{id:"action.backgroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink background Pinkbackground"},foregroundColorRedKeywords:{id:"action.foregroundColor.red.fuzzySearchKeyword",defaultMessage:"Red"},backgroundColorRedKeywords:{id:"action.backgroundColor.red.fuzzySearchKeyword",defaultMessage:"Red background Redbackground"},backgroundSectionKeywords:{id:"action.section.background.fuzzySearchKeywords",defaultMessage:"Color Background"},backgroundSection:{id:"action.section.background",defaultMessage:"Background"},colorSection:{id:"action.section.color",defaultMessage:"Color"},colorName:{id:"action.color.name",defaultMessage:"Color"},duplicateCollectionSchemaOnlyName:{id:"action.duplicateSchemaOnly.name",defaultMessage:"Duplicate without content"},duplicateCollectionWithDataName:{id:"action.duplicateWithData.name",defaultMessage:"Duplicate with content"}}),I=e=>{let{title:t}=e;return t},C={maxWidth:400,whiteSpace:"pre-wrap"};function x(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,contextualDisplayName:i,analyticsName:r,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,validators:c,shortcuts:d,sortScoreMultiplier:u,closeParentMenu:p,action:m,subActions:f,collapseSubActionsIntoParent:g,nativeRender:h,alwaysShowInSearch:v,right:b,renderTooltip:y,userProvidedSearchName:S}=e,{formattedDisplayName:_,searchName:w}=M({displayName:n,displayNameInterpolatedValues:o,userProvidedSearchName:S,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:_,analyticsName:r,analyticsActionType:a,searchName:w,validators:c,shortcuts:d,sortScoreMultiplier:u,action:m,subActions:f,collapseSubActionsIntoParent:g,closeParentMenu:p,render:e.render??P({svg:l,formattedDisplayName:_,right:b,contextualDisplayName:i,shortcut:d[0],renderTooltip:y}),nativeRender:h,alwaysShowInSearch:v}}function T(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,contextualDisplayName:i,analyticsName:r,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,validators:c,sortScoreMultiplier:d,closeParentMenu:u,action:p,subActions:m,collapseSubActionsIntoParent:f,nativeRender:g,alwaysShowInSearch:h,right:v,renderTooltip:b,userProvidedSearchName:y}=e,{formattedDisplayName:S,searchName:_}=M({displayName:n,displayNameInterpolatedValues:o,userProvidedSearchName:y,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:S,analyticsName:r,analyticsActionType:a,searchName:_,validators:c,sortScoreMultiplier:d,action:p,subActions:m,collapseSubActionsIntoParent:f,closeParentMenu:u,render:e.render??P({svg:l,formattedDisplayName:S,right:v,contextualDisplayName:i,renderTooltip:b}),nativeRender:g,alwaysShowInSearch:h}}function M(e){const{displayName:t,displayNameInterpolatedValues:n,fuzzySearchKeywords:o,userProvidedSearchName:i}=e,r=t?y.default.formatMessage(t,n):void 0,a=o||t,s=o?y.default.formatMessage(o):r;let l=i;return l||(l=a?s===a.defaultMessage?s:`${s} ${a.defaultMessage}`:void 0),{formattedDisplayName:r,searchName:l}}function P(e){const{formattedDisplayName:t,svg:n,shortcut:o,right:i,renderTooltip:r}=e;return(a,s,l)=>{const d=(e.contextualDisplayName?e.contextualDisplayName(s):void 0)||t;return(0,w.jsx)(g.Z,{render:e=>(0,w.jsx)(c.Z,{...(0,_.Z)(a,e),title:d,svg:n,shortcut:o,right:"function"==typeof i?i(a,s,l):i}),renderTooltip:()=>(0,w.jsx)("div",{style:C,children:null==r?void 0:r({title:d})}),disableTooltip:!r,placement:g.Z.Placement.Right})}}function A(e){const{key:t,title:n,overrideSearchTitle:o,render:i,actions:r}=e,a=n?y.default.formatMessage(n):void 0,s=o||n,l=s&&y.default.formatMessage(s);return{key:t,title:a,searchTitle:s?l===s.defaultMessage?l:`${l} ${s.defaultMessage}`:void 0,render:i,actions:r}}function R(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,analyticsName:i,validators:r,subActions:a,collapseSubActionsIntoParent:s,svg:l,icon:f,right:g,width:v,initialFocus:b}=e,y=T({key:`extension ${t}`,displayName:n,displayNameInterpolatedValues:o,analyticsName:i,validators:r,subActions:a,collapseSubActionsIntoParent:s,closeParentMenu:!0,action:()=>{},render:(e,t,n)=>(0,w.jsx)(h.Z,{...e,renderOrigin:(e,t)=>l?(0,w.jsx)(c.Z,{...e,title:y.displayName,svg:l,right:g,ref:t}):(0,w.jsx)(u.Z,{...e,title:y.displayName,icon:f,right:g,ref:t}),onFocus:n.onFocus,renderExtension:(e,o)=>{let i;return i=t.environment.device.isPhone?{menuType:S.og.Modal,right:(0,w.jsx)(m.DoneMenuText,{}),onClickRight:o.close,...e}:{menuType:S.og.Popup,width:v??220,...e},(0,w.jsx)(p.Z,{...i,children:(0,w.jsx)(d.Z,{initialFocus:b??0,context:t,sections:a(t),onAccept:n.onAccept})})}})});return y}const D=[v.ff(v.P9(o.Ti.externalObjectInstancePage)),v.ff(v.K5),v.or([v.QL("collection_typed_db_duplication"),v.ff(v.Rg),v.f7]),v.J5,v.ff((e=>e.blocks.some((e=>e.isDefined()&&(0,b.h7)(e))))),v.vd];function B(e){return T({key:`format ${e.key}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:e.validators,render:(t,n,o)=>{let{blocks:i,environment:r}=n;const a=i[0].getFormat(),s=Boolean(a[e.property]),{isMobile:l}=r.device;return(0,w.jsx)(f.Z,{...t,title:e.label,icon:e.svg?(0,w.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.svg({width:l?20:17,height:l?20:17})}):void 0,on:s})},closeParentMenu:!1,action:t=>{let{environment:n,blocks:o}=t;l.createAndCommit({userAction:"actionRegistry.createFormatAction",environment:n,perform:t=>{const i=o[0],r=i.getFormat(),a=!Boolean(r[e.property]);s.FH({stores:[i],update:{[e.property]:a},transaction:t}),e.afterAction(a,n)}})}})}function E(e){switch(e){case"default":return k.backgroundColorDefaultKeywords;case"gray":return k.foregroundColorGrayKeywords;case"gray_background":return k.backgroundColorGrayKeywords;case"brown":return k.foregroundColorBrownKeywords;case"brown_background":return k.backgroundColorBrownKeywords;case"orange":return k.foregroundColorOrangeKeywords;case"orange_background":return k.backgroundColorOrangeKeywords;case"yellow":return k.foregroundColorYellowKeywords;case"yellow_background":return k.backgroundColorYellowKeywords;case"teal":return k.foregroundColorTealKeywords;case"teal_background":return k.backgroundColorTealKeywords;case"blue":return k.foregroundColorBlueKeywords;case"blue_background":return k.backgroundColorBlueKeywords;case"purple":return k.foregroundColorPurpleKeywords;case"purple_background":return k.backgroundColorPurpleKeywords;case"pink":return k.foregroundColorPinkKeywords;case"pink_background":return k.backgroundColorPinkKeywords;case"red":return k.foregroundColorRedKeywords;case"red_background":return k.backgroundColorRedKeywords;default:return(0,r.t1)(e)}}function F(e,t,n){const o=e.device.isAndroid?(0,i.gh)({theme:"light"}):(0,i.gh)({theme:e.ThemeStore.state.mode}),r=(0,i.fi)(t,o);let a,s,l;const c="default"!==t;t.includes("background")||null!=n&&n.includes("background")?(a="background",s=c?"square.fill":"square",l="textBackgroundColor"):(a="color",s="character",l="textColor");const d=a in r?r[a]:void 0,u=d&&(0,i.J1)(d);return{sfProGlyphName:s,localImageIdentifier:l,imageTintColor:c?u:void 0}}},52229:(e,t,n)=>{n.d(t,{k:()=>p});n(21703);var o=n(15145),i=n(41432),r=n(4615),a=n(21202),s=n(70279),l=n(95477),c=n(98165),d=n(35661),u=n(9953);function p(e){const{environment:t,parentBlock:n,targetStore:p,transaction:m}=e;if(!p.isDefined())throw new Error("Target store was not defined.");if(!n.isDefined())throw new Error("Parent block store was not defined.");const f=(0,r.ZP)(),g=p instanceof d.G;let h;if(!g){if(c.Dg(p)&&p.isDefined()){const e=p.getParentStore(),t=null==e?void 0:e.getParentStore();var v;if(null!=e&&e.isDefined())h=null==t||null===(v=t.getModel())||void 0===v?void 0:v.getRenderUrl({getRecordModel:p.getRecordModel,baseUrl:l.default.domainBaseUrl,discussionId:e.id,pageVisitSource:o.tY.LinkInPage})}}const b={id:f,type:i.Ti.alias,format:{alias_pointer:{table:g?a.iU:s.x_,id:p.id,spaceId:p.getSpaceId()},comment_alias_url:h},parent_id:n.id,parent_table:"block",alive:!0,space_id:n.getSpaceId()};return u.ae({environment:t,table:"block",value:b,inMemoryRecordCache:n.inMemoryRecordCache,transaction:m}),d.G.createChildStore(n.getContentStore(),{table:a.iU,id:f,spaceId:n.getSpaceId()})}},50906:(e,t,n)=>{n.d(t,{$1W:()=>Gl,$24:()=>Mr,$5Z:()=>os,$B1:()=>lu,$CH:()=>xn,$DM:()=>Se,$KP:()=>va,$Xl:()=>mi,$aC:()=>Xl,$eA:()=>Rc,$fF:()=>dd,$kb:()=>An,$lT:()=>Ce,$qu:()=>xo,$zQ:()=>sa,A01:()=>Kr,A6G:()=>mo,ADR:()=>Oe,AMz:()=>ce,AQD:()=>Wr,ASv:()=>cl,Af_:()=>Vi,Al4:()=>Ho,An9:()=>Pa,AqV:()=>Zt,Ar6:()=>Ra,B3N:()=>fl,BI8:()=>Us,BLZ:()=>ve,BPl:()=>vi,BR:()=>Rs,BWF:()=>nc,Bb7:()=>K,Bdq:()=>Ul,BgI:()=>Ft,Bp3:()=>Ls,BpO:()=>Hc,Byg:()=>ua,C$e:()=>Pe,CBn:()=>Wo,CDl:()=>xa,CNn:()=>Su,Cdl:()=>yt,Cez:()=>kc,CgF:()=>Eu,CgP:()=>za,Cis:()=>Wd,Cm3:()=>Ws,Cug:()=>jd,D6i:()=>ue,D6j:()=>pt,DB2:()=>ia,DCH:()=>Ds,DRv:()=>ao,DUp:()=>zs,DWr:()=>el,Dah:()=>al,DnI:()=>qd,DoK:()=>yc,E0y:()=>Pr,E50:()=>Rr,EDS:()=>qn,EH8:()=>Ts,EJs:()=>Ns,EKj:()=>Ke,EUb:()=>bt,EUq:()=>bl,EVQ:()=>js,Ebd:()=>As,EfR:()=>$d,Eml:()=>hs,Esd:()=>re,F4S:()=>Al,FBk:()=>Gs,FGU:()=>Fa,FIS:()=>rt,FNU:()=>pc,FRI:()=>Mt,FRk:()=>Ua,FT:()=>Zi,FjP:()=>da,Fn4:()=>Nn,Fo$:()=>oa,Fsx:()=>Ba,G14:()=>ro,G7$:()=>bc,G7t:()=>lt,Gbs:()=>Il,GkL:()=>fe,GlI:()=>no,Glf:()=>st,Gpy:()=>Ql,H6t:()=>zo,HCf:()=>Nc,HH5:()=>Gd,HNg:()=>Vl,HU0:()=>Yn,HYP:()=>Ca,Hcc:()=>Ni,Her:()=>Or,ICF:()=>Tc,IEe:()=>ke,IMD:()=>Di,IMV:()=>Ge,IN8:()=>Js,IR:()=>hu,IVn:()=>qs,IWJ:()=>Jl,Ib5:()=>ee,If_:()=>_r,IvM:()=>dl,IwD:()=>ed,J7i:()=>be,JX1:()=>au,Jed:()=>es,Jgl:()=>to,Jin:()=>Lo,JkE:()=>ku,JoV:()=>iu,JpJ:()=>kr,JrP:()=>Un,JvT:()=>Pc,Jw_:()=>Fd,K1b:()=>ei,K81:()=>Mn,KCu:()=>Xc,KFD:()=>ou,KIh:()=>vr,Kf$:()=>cr,Kge:()=>vd,Khd:()=>Od,KkZ:()=>Ps,L3B:()=>ot,LAz:()=>Cl,LBE:()=>hc,LC7:()=>xd,LDb:()=>so,LEn:()=>Ko,LMg:()=>Fr,LOF:()=>ru,LSY:()=>Dc,LbR:()=>nd,Lc3:()=>Tt,Le6:()=>wu,Lfx:()=>Ec,Ls9:()=>Ht,MEX:()=>wa,MRb:()=>ya,MU3:()=>Ao,McA:()=>Td,Md8:()=>ma,MdY:()=>Wa,Mp:()=>ml,Mqg:()=>aa,Mzl:()=>yo,NF$:()=>Fc,NFM:()=>Xd,NGq:()=>ge,NIS:()=>pn,NLO:()=>qi,NMx:()=>G,NOz:()=>Hl,NgT:()=>Rn,Ngp:()=>Os,O$H:()=>Nr,O8I:()=>Dr,O8v:()=>rr,OFH:()=>vn,OK8:()=>nn,ORE:()=>oc,OSl:()=>Rd,OXe:()=>$t,Ogr:()=>Jt,Opj:()=>na,Otz:()=>Aa,P$y:()=>li,P0l:()=>Iu,P1A:()=>Yd,P9p:()=>jr,PBo:()=>oe,PEc:()=>io,PHO:()=>Er,PL3:()=>Ue,PL5:()=>Li,PNo:()=>Rt,PR:()=>Hs,P_7:()=>Ss,PdU:()=>tr,Pgp:()=>sn,Phj:()=>mc,Prc:()=>Wl,Pu8:()=>ie,PyM:()=>Hn,Q4L:()=>de,QFO:()=>Mc,QIc:()=>$n,QOK:()=>Gt,QUd:()=>oo,QZR:()=>ne,QdK:()=>Zr,QkQ:()=>ic,Qqh:()=>Ai,R9m:()=>_s,RJe:()=>qa,RLv:()=>jc,ROv:()=>bi,Rb9:()=>ra,Rbv:()=>nr,RcY:()=>Fo,Rm2:()=>bd,RnH:()=>ts,SCe:()=>gl,SJp:()=>cc,SK1:()=>Mi,SLv:()=>Dl,SMF:()=>br,SMS:()=>Qt,SOV:()=>dt,SUR:()=>ms,SUq:()=>Vr,SYd:()=>De,Se:()=>_a,Sh9:()=>St,Snv:()=>qe,SwX:()=>ir,Syn:()=>nt,T2x:()=>X,T3Y:()=>Ze,T4J:()=>Kd,TCs:()=>xr,TIz:()=>ki,TJ1:()=>Au,TJp:()=>hr,TLh:()=>Fe,TPH:()=>ln,Ti_:()=>vu,Tlp:()=>Oc,U52:()=>Tn,UD4:()=>Y,UD9:()=>$l,UJm:()=>Ei,UJr:()=>vo,UWw:()=>Ir,UZT:()=>Bo,Uk:()=>Kn,Uut:()=>Md,UwD:()=>fs,V0c:()=>Lr,V5j:()=>Es,VJs:()=>Qa,VN$:()=>Pi,VQs:()=>Dt,VSH:()=>Sa,VTb:()=>fi,VUL:()=>Ve,VZZ:()=>ze,V_i:()=>Gn,VaH:()=>ta,Vaw:()=>Da,VfZ:()=>it,ViF:()=>Mu,VoR:()=>Lc,Vry:()=>yu,W2j:()=>wn,WCB:()=>Cs,WFT:()=>oi,WP:()=>Gc,Wbl:()=>qr,Wg6:()=>le,Wlu:()=>zn,Wr9:()=>on,X0y:()=>Xn,XCt:()=>Pd,XI1:()=>Ur,XQ5:()=>Ln,XTk:()=>fc,XWf:()=>q,XXm:()=>si,XbW:()=>sr,Xov:()=>jt,XwB:()=>zc,XyT:()=>Qn,Y35:()=>Xr,Y4z:()=>Ud,Y7v:()=>Ru,Y8X:()=>fo,YFJ:()=>Yr,YMV:()=>yi,YO0:()=>cn,YOV:()=>Ea,YP3:()=>sc,YTO:()=>_t,YU0:()=>Io,YVI:()=>Ie,YY6:()=>Q,YYl:()=>Ks,Y_F:()=>Zl,YcY:()=>_c,YdN:()=>bu,Yg1:()=>ga,YnN:()=>Bd,Yo0:()=>Ti,Yz2:()=>rs,Z0d:()=>Ii,Z36:()=>at,Z41:()=>ks,Z9y:()=>Ys,ZAW:()=>Tu,ZEy:()=>Dd,ZW8:()=>Xa,ZZ8:()=>Uo,ZaS:()=>id,Zbu:()=>Wt,ZfC:()=>Ms,Zh2:()=>Ha,Zm$:()=>tu,Zmw:()=>rl,Zq6:()=>nl,Zrf:()=>ci,ZyU:()=>kd,ZzP:()=>ws,_0h:()=>he,_6M:()=>mu,_Hi:()=>Co,_T2:()=>co,_Wj:()=>ae,_eA:()=>Uc,_fo:()=>Zs,_g0:()=>J,_jH:()=>Ot,_mq:()=>cu,_qN:()=>Vt,_xm:()=>pl,a1y:()=>et,a5A:()=>yn,a6v:()=>go,a7O:()=>He,aOs:()=>Sc,aT6:()=>fu,air:()=>ka,amv:()=>Jd,apd:()=>Bl,ax_:()=>xe,ays:()=>Xe,azK:()=>Ic,b0I:()=>It,b9E:()=>tn,bOx:()=>ft,bRT:()=>Zd,bRx:()=>Ki,bRy:()=>ss,bd0:()=>$c,bmu:()=>_l,bwR:()=>or,c7L:()=>Fs,cOL:()=>wr,cV4:()=>mt,cXp:()=>Kl,cYL:()=>Et,cir:()=>Ar,coX:()=>vc,ctm:()=>Vn,d2c:()=>cs,dE3:()=>Xi,dSV:()=>$i,dUJ:()=>yr,dZq:()=>Zn,d_o:()=>Yt,dan:()=>ur,dhV:()=>Wn,duO:()=>Oi,dw6:()=>ni,dwr:()=>du,dyr:()=>$,e2:()=>ad,e7E:()=>Te,eO1:()=>xc,eRW:()=>sl,eT_:()=>lo,ebp:()=>Le,efr:()=>Qc,elP:()=>Jn,enX:()=>Fn,enk:()=>ui,eoz:()=>$r,ers:()=>tc,esN:()=>se,ewV:()=>wi,f73:()=>pa,fAb:()=>Ja,fMl:()=>pi,fP8:()=>Re,fW6:()=>Ac,fZH:()=>At,fco:()=>Qs,g0v:()=>pr,g3X:()=>qt,g9P:()=>Br,gEE:()=>td,gL0:()=>pd,gMH:()=>Na,gP4:()=>ri,gRe:()=>er,g_f:()=>Wc,g_k:()=>ji,gl7:()=>gr,gw_:()=>qo,h$X:()=>Yc,h23:()=>Fl,hEo:()=>Cr,hJ5:()=>ps,hYM:()=>Yi,hov:()=>me,hym:()=>So,iA$:()=>Ri,iBN:()=>Tl,iDe:()=>Cd,iHH:()=>Ci,iIY:()=>Be,iIv:()=>Xs,iL9:()=>Bt,iRP:()=>Oo,iSD:()=>dn,ieV:()=>W,ieb:()=>Lt,ikP:()=>Zo,iw$:()=>te,iwE:()=>Yo,ixp:()=>ql,j1w:()=>Si,j72:()=>su,jBu:()=>zi,jDo:()=>Za,jMN:()=>sd,jPN:()=>Je,jRT:()=>On,jWY:()=>Dn,jXQ:()=>as,j_p:()=>fd,jdc:()=>md,jhO:()=>Nt,jkE:()=>Bu,jw0:()=>hn,k$J:()=>ds,k1K:()=>xt,k6o:()=>Ut,kLN:()=>Ka,kVp:()=>Bs,kY8:()=>Ml,kZ0:()=>Ee,kjl:()=>gi,kmb:()=>ii,kq7:()=>la,krX:()=>Nl,kyK:()=>od,kz9:()=>Ya,l0P:()=>Qd,l7z:()=>fr,lLZ:()=>is,lLm:()=>ul,lO:()=>_u,lfq:()=>$o,lgT:()=>Do,ljn:()=>fn,llH:()=>Vs,m0A:()=>Jc,mCV:()=>eo,mFL:()=>Yl,mcx:()=>Ll,meY:()=>Vd,mfs:()=>uo,mgu:()=>yd,miu:()=>ec,mt_:()=>bo,n1D:()=>Bn,n4j:()=>mr,n8f:()=>an,nBz:()=>La,nCD:()=>Sr,nKJ:()=>ld,nLf:()=>xs,ndA:()=>wt,neX:()=>Go,nlj:()=>gn,nnP:()=>Ed,o0U:()=>Qi,o7O:()=>we,o8J:()=>Fu,oIe:()=>en,oQL:()=>hl,oSR:()=>gt,o_A:()=>zl,ovL:()=>qc,p5p:()=>Ae,pCf:()=>gu,pPS:()=>gs,pRQ:()=>Pu,pZG:()=>ht,phe:()=>il,piC:()=>jl,piO:()=>xi,ppr:()=>vl,psf:()=>Hr,q5U:()=>Ye,q7Y:()=>kt,qA6:()=>hd,qBg:()=>Sn,qDg:()=>ys,qG2:()=>Vc,qJZ:()=>ct,qJp:()=>ye,qPY:()=>zr,qTS:()=>ar,qYb:()=>Ma,q_n:()=>Tr,qyQ:()=>tt,qzU:()=>Pt,r5L:()=>Eo,rFP:()=>uc,rNQ:()=>Pn,rOZ:()=>vt,rTg:()=>Zc,rYq:()=>po,rZ2:()=>wd,rZG:()=>nu,rit:()=>Hd,rvR:()=>pu,rvl:()=>ko,rx3:()=>Ne,rxu:()=>Kt,s$$:()=>Sd,s4j:()=>Cc,s8J:()=>Wi,sA6:()=>un,sGw:()=>wo,sIE:()=>Rl,sS1:()=>wl,sSR:()=>ca,sYL:()=>jn,sdb:()=>_o,sos:()=>Ia,sxo:()=>kn,t8_:()=>ba,tBP:()=>Du,tMA:()=>Vo,tPt:()=>ha,tXe:()=>xu,tZo:()=>ea,tfS:()=>tl,tir:()=>wc,tmQ:()=>Oa,tn$:()=>Ui,txh:()=>Hi,uAt:()=>gc,uCY:()=>Qo,uDZ:()=>Xo,uSc:()=>rd,ubm:()=>Ga,udZ:()=>ai,uul:()=>ut,ux6:()=>pe,uyp:()=>$s,v$O:()=>ol,v2V:()=>Ol,v2k:()=>Ro,vCG:()=>uu,vN5:()=>ud,vVs:()=>bn,vcz:()=>Cn,vd1:()=>Me,vkP:()=>kl,vqh:()=>Jr,vtR:()=>xl,vwI:()=>Xt,w3M:()=>Va,w6U:()=>ho,wFN:()=>Is,wVl:()=>eu,wWx:()=>Id,wds:()=>Po,wi:()=>ll,wjW:()=>rn,wkd:()=>Bc,wlq:()=>zt,wql:()=>We,wrY:()=>Gr,wtf:()=>gd,wy9:()=>Bi,wz6:()=>_d,x6y:()=>ls,x8E:()=>Cu,x91:()=>$e,xGP:()=>Qr,xYN:()=>Sl,xbC:()=>Mo,xh4:()=>Fi,xim:()=>Ad,xtf:()=>dr,xti:()=>Ta,xud:()=>$a,xx2:()=>ja,y$F:()=>Ct,y2U:()=>Jo,y4:()=>fa,y6P:()=>_e,y9R:()=>Pl,y9e:()=>To,yEH:()=>Gi,yT1:()=>ti,ya1:()=>vs,yaj:()=>zd,ybK:()=>Qe,ye:()=>En,yeF:()=>Nd,yef:()=>cd,yjq:()=>di,yrm:()=>ns,yvO:()=>je,z01:()=>hi,z2b:()=>mn,z7J:()=>_i,zIF:()=>No,zP:()=>In,zQ6:()=>El,zUE:()=>lr,zah:()=>rc,zdn:()=>us,zes:()=>jo,zim:()=>Kc});n(57658);var o=n(1302),i=n(79946),r=n(15145),a=n(45433),s=n(33728),l=n(30845),c=n(72126),d=n(27006),u=n(29477),p=n(4615),m=n(99405),f=n(19889),g=n(9852),h=n(2438),v=n(49902),b=n(97880),y=n(64002),S=n(54642),_=n(47839),w=n(95477),k=n(24215),I=n(28020),C=n(15010),x=n(75079),T=n(12955),M=n(71776),P=n(45101),A=n(14654),R=n(68418),D=n(55838),B=n(80444),E=n(77080),F=n(29677),Z=n(35661),L=n(87956),j=n(27724),V=n(78291),U=n(70060),O=n(88893),N=n(35057),z=n(39699),H=n(37181);function W(e,t){k.$A({environment:e,userId:(0,p.F9)(t.user_id),traits:{...t,...t.tags?{original_tags:t.tags}:void 0,user_id:(0,p.F9)(t.user_id)}})}function q(e,t){k.$A({environment:e,userId:(0,p.F9)(t.user_id),traits:{...t,user_id:(0,p.F9)(t.user_id)}})}async function G(){await k.NM()}async function K(e){const{environment:t,experiment_id:n,experiment_group:o,experiment_version:i,logging_source:r}=e,a=(0,g.getSessionExperimentExposure)(n),s=await(0,T.getExperimentDeviceId)(t);Boolean(a)&&a===(0,g.getCombinedExperimentValue)(i,o)||(k.j(t,"experiment_exposure",{experiment_id:n,experiment_group:o,experiment_version:i,experiment_device_id:s,logging_source:r}),(0,g.setSessionExperimentExposure)(n,o,i))}function $(e,t){k.j(e,"download_desktop_app",t)}function Q(e,t){k.j(e,"download_mobile_app",t)}function Y(e,t){k.j(e,"getCompletion.emptyResponse",t),E.default.logEvent("getCompletion.emptyResponse",1,{promptKey:t.promptKey})}function J(e,t){const{name:n,...o}=t;k.j(e,"click_link",{...o,click_name:n})}function X(e){k.j(e,"browse_more_templates_click"),E.default.logEvent("browse_more_templates_click",1)}function ee(e){k.j(e,"in_app_template_gallery_brand_click")}function te(e,t){k.j(e,"toggle_pricing_term",t)}function ne(e,t){k.j(e,"scroll",t)}function oe(e,t){const{page_id:n,query:o,team_id:i,page_visit_id:a,previous_page_visit_id:s,...l}=t,c=y.Ph(o,r.$X),d=parseInt(c),u="push"===e.RouterStore.getState().action,p=(0,r.bh)(d)&&u?r.tY.LinkInPage:(0,r.xt)(d),m=y.Ph(o,r.Qs),f=(0,A.t3)({blockOrCollectionId:n});k.j(e,"page_visit",{...l,page_visit_source:p,notificationId:m,page_visit_id:a,previous_page_visit_id:s,entered_at:Date.now(),home_page_type:f},{forceOverrideAutomaticEventData:{team_id:i}})}function ie(e,t){E.default.checkGate("log_page_exit_events_to_analytics")&&k.j(e,"page_exit",{exited_at:Date.now(),page_visit_id:t.pageVisitId},{forceOverrideAutomaticEventData:t})}function re(e){const t=[{name:"initial_partner_stack_key",value:e.partner_stack_key,operation:"setOnce"},{name:"partner_stack_key",value:e.partner_stack_key,operation:"set"}];k.fK(t)}function ae(e,t){const n=y.nx(t,(0,g.getUrlAnalyticsFromSessionStorage)());if(n){const{fbclid:e,gclid:t}=n;e&&i.xx({type:"facebook",id:e}),t&&i.xx({type:"google",id:t}),(0,g.saveUrlAnalyticsInSessionStorage)(n)}k.j(e,"visit",{})}function se(e,t){k.j(e,"database_visit",t)}function le(e,t){k.lu(e,"type_aggregated_database_visit",`type_aggregated_database_visit-${t.databaseType}`,60,t)}function ce(e,t){k.j(e,"page_error",t)}function de(e,t){k.j(e,"reorder_workspaces",t)}function ue(e,t){k.j(e,"multi_account_add_or_create_account_clicked",t)}function pe(e){k.j(e,"content_classification_proceed")}function me(e,t){k.j(e,"onboarding_dialog_error",t),we(e,"onboarding_dialog_error",t)}function fe(e,t){k.j(e,"onboarding_error",t),we(e,"onboarding_error",t)}function ge(e,t){if(k.j(e,"onboarding_show",t),E.default.logEvent("onboarding_show",1,{...t}),t.is_new_onboarding){var n;const{currentUserSettingsStore:e}=B.default.getState();E.default.logEvent("sign_up_by_domain_type",null==e||null===(n=e.getSettings())||void 0===n?void 0:n.domain_type,{})}}function he(e,t){k.j(e,"onboarding_invite_copy",t),we(e,"onboarding_invite_copy",t)}function ve(e,t){k.j(e,"onboarding_close",t),we(e,"onboarding_close",t)}function be(e,t){k.j(e,"onboarding_skip",t),we(e,"onboarding_skip",t)}function ye(e,t){k.j(e,"onboarding_invite_send",t),we(e,"onboarding_invite_send",t)}function Se(e,t){k.j(e,"onboarding_space_icon_upload",t),we(e,"onboarding_space_icon_upload",t)}function _e(e,t){k.j(e,"onboarding_stage",t),E.default.logEvent("onboarding_stage",1,{stage:t.stage,workspace_type:t.initial_workspace_type,is_new_onboarding:t.is_new_onboarding,device_type:e.device.deviceType}),E.default.logEvent("onboarding_stage_by_stage",t.stage,{}),E.default.logEvent("onboarding_stage_by_is_new_user_onboarding",t.is_new_onboarding.toString(),{}),E.default.logEvent("onboarding_stage_by_device_type",e.device.deviceType,{})}function we(e,t,n){k.j(e,"onboarding_serverside",{...n,phase:t},{dontWait:!0})}function ke(e,t){k.j(e,"onboarding_join_space_click",t),E.default.logEvent("onboarding_join_space_click",t.joined_space_index,{...t})}function Ie(e,t){k.j(e,"onboarding_invite_click",t);const{invited_emails:n,...o}=t;E.default.logEvent("onboarding_invite_click",n.length,{...o})}function Ce(e,t){k.j(e,"onboarding_invite_attempt",t)}function xe(e,t){k.j(e,"onboarding_upload_profile_photo",t)}function Te(e,t){k.j(e,"onboarding_join_space",t)}function Me(e,t){k.j(e,"onboarding_create_space",t)}function Pe(e,t){k.j(e,"onboarding_plan_type_select",t),E.default.logEvent("onboarding_plan_type_select",t.planType,{...t})}function Ae(e,t){k.j(e,"onboarding_persona_select",t),E.default.logEvent("onboarding_persona_select","persona",{...t})}function Re(e,t){k.j(e,"onboarding_persona_select",t),E.default.logEvent("onboarding_persona_select","role",{...t})}function De(e,t){k.j(e,"onboarding_persona_select",t),E.default.logEvent("onboarding_persona_select","useCases",{...t})}function Be(e,t){k.j(e,"onboarding_persona_select",t),E.default.logEvent("onboarding_persona_select","companySize",{...t})}function Ee(e,t){k.j(e,"onboarding_company_survey_action",{...t,action:t.action}),E.default.logEvent("onboarding_company_survey_action",t.action,{}),E.default.logEvent(`onboarding_company_survey_action_${t.action}`,t.plan_selection,{})}function Fe(e,t){k.j(e,"onboarding_persona_survey_action",{...t,action:t.action}),E.default.logEvent("onboarding_persona_survey_action",t.action,{}),E.default.logEvent(`onboarding_persona_survey_action_${t.action}`,t.plan_selection,{})}function Ze(e,t){k.j(e,"notion_topbar_click",t,{dontWait:!0}),E.default.logEvent("notion_topbar_click",t.variant)}function Le(e,t){k.j(e,"template_gallery_public_page_topbar_click",t,{dontWait:!0}),E.default.logEvent("template_gallery_public_page_topbar_click",t.target)}function je(e,t){k.j(e,"getting_started_page_create",t)}function Ve(e,t){k.j(e,"debug_getting_started_page_error",t)}function Ue(e,t){var n,o;const{currentUserSettingsStore:r,currentUserRootStore:a}=B.default.state,s=E.default.getExperimentsMap();k.Zf(e,{onboarding_complete:!0,onboarding_emails_experiment:s["onboarding-emails"]}),k.j(e,"onboarding_complete",t),i.PL(),E.default.logEvent("onboarding_complete",1,{domain_type:null==r||null===(n=r.getSettings())||void 0===n?void 0:n.domain_type,device_type:e.device.deviceType,is_new_onboarding:t.is_new_onboarding,is_professional_team_user:(0,C.QZ)(),user_persona:t.user_persona,plan_type:t.plan_type,create_or_join:t.initial_workspace_type}),E.default.logEvent("onboarding_complete_by_plan_type",t.plan_type,{}),E.default.logEvent("onboarding_complete_by_device_type",e.device.deviceType,{}),E.default.logEvent("onboarding_complete_by_user_persona",t.user_persona,{}),E.default.logEvent("onboarding_complete_by_user_team_role",t.user_team_role,{}),t.user_use_cases&&t.user_use_cases.forEach((e=>{E.default.logEvent("onboarding_complete_by_user_use_case",e,{})})),E.default.logEvent("onboarding_complete_by_domain_type",null==r||null===(o=r.getSettings())||void 0===o?void 0:o.domain_type,{}),E.default.logEvent("onboarding_complete_by_create_or_join_space",t.initial_workspace_type,{}),E.default.logEvent("onboarding_complete_by_is_new_user_onboarding",t.is_new_onboarding.toString(),{}),E.default.logEvent("onboarding_complete_by_workspaces_count",(null==a?void 0:a.getSpaceViewStores().length)||0,{}),(0,C.QZ)()&&E.default.logEvent("pro_team_onboarding_complete",1,{})}function Oe(e,t){k.j(e,"proj_management_onboarding_tooltip_show",t),E.default.logEvent("proj_management_tooltip_show")}function Ne(e,t){k.j(e,"proj_management_onboarding_tooltip_dismiss",t),E.default.logEvent("proj_management_tooltip_dismiss")}function ze(e,t){k.j(e,"onboarding_team_invite_email_entered",t)}function He(e,t){k.j(e,"onboarding_team_invite_add_more_clicked",t)}function We(e,t){k.j(e,"onboarding_bulk_invites_rendered",t)}function qe(e,t){k.j(e,"landing_page_visit",{routerName:t}),(0,u.Vs)(4e3).then((n=>{E.default.logEvent(`${t}_page_visit`,e.device.deviceType,{})}))}function Ge(e,t){k.j(e,"customer_io_in_app_callout_show",t)}function Ke(e,t){k.j(e,"customer_io_in_app_callout_suppress",t)}function $e(e,t){k.j(e,"customer_io_in_app_callout_dismiss",t)}function Qe(e,t){k.j(e,"customer_io_in_app_callout_error",t)}function Ye(e,t){k.j(e,"persona_form_step",{event:t.event})}function Je(e,t){k.j(e,"persona_form_action",{event:t.event})}function Xe(e,t){k.j(e,"import_button_click",t)}function et(e,t){k.j(e,"import_source_auth",t)}function tt(e,t){k.j(e,"import_source_input",t)}function nt(e,t){k.j(e,"open_import_modal",t)}function ot(e,t){k.j(e,"auth_integration",t)}function it(e,t){k.j(e,"integration_select_all",t)}function rt(e,t){k.j(e,"integration_deselect_all",t)}function at(e,t){k.j(e,"integration_select_item",t)}function st(e,t){k.j(e,"integration_deselect_item",t)}function lt(e,t){k.j(e,"import_integration",t)}function ct(e,t){k.j(e,"remove_integration",t)}function dt(e,t){k.j(e,"integration_prompt_auth",t)}function ut(e){k.j(e,"open_google_drive_file_picker")}function pt(e,t){k.j(e,"google_drive_pick_file",t)}function mt(e,t){k.j(e,"google_drive_embed_file",t)}function ft(e,t){const{pastedText:n}=t;let o;if(l.B(n,"url")){const e=y.Qc(n);e.host&&(o=e.host)}if(o){const{pastedText:n,...i}={...t,url_domain:o};k.j(e,"paste_url",i)}}function gt(e,t){const n=t.url?(0,y.gy)(t.url):void 0;k.j(e,"edit_link",{type:t.type,url_domain:null==n?void 0:n.hostname})}function ht(e){k.j(e,"edit_link_title")}function vt(e,t){k.j(e,"pricing_grid_button_click",t),E.default.logEvent("pricing_grid_button_click",void 0,t),pn(e,{location:"plans_page",cta_item:t.plan,currency_code:t.currency_code,page_section:(0,U.$r)()?"all_plans_grid":"grid",button_text:t.button_text})}function bt(e){k.j(e,"pricing_grid_contact_sales_click")}function yt(e){k.j(e,"add_on_discount_popup_seen")}function St(e){k.j(e,"add_on_discount_popup_dismissed")}function _t(e,t){k.j(e,"subscription_update_modal_open",t),E.default.logEvent("subscription_update_modal_open",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function wt(e,t){k.j(e,"subscription_update_modal_confirmation_click",t),E.default.logEvent("subscription_update_modal_confirmation_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function kt(e,t){k.j(e,"subscription_update_modal_exit",t),E.default.logEvent("subscription_update_modal_exit",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function It(e,t){k.j(e,"subscription_update_modal_billing_interval_updated",t),E.default.logEvent("subscription_update_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Ct(e,t){k.j(e,"subscription_update_modal_expand_billing_summary",t),E.default.logEvent("subscription_update_modal_expand_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function xt(e,t){k.j(e,"subscription_update_modal_hide_billing_summary",t),E.default.logEvent("subscription_update_modal_hide_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Tt(e,t){k.j(e,"subscription_upgrade_modal_open",t),E.default.logEvent("subscription_upgrade_modal_open",void 0,t)}function Mt(e,t){k.j(e,"subscription_upgrade_modal_billing_interval_updated",t),E.default.logEvent("subscription_upgrade_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Pt(e,t){k.j(e,"subscription_upgrade_modal_add_on_features_updated",t),E.default.logEvent("subscription_upgrade_modal_add_on_features_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function At(e,t){k.j(e,"subscription_upgrade_modal_upgrade_accepted",t),E.default.logEvent("subscription_upgrade_modal_upgrade_accepted",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Rt(e,t){k.j(e,"subscription_upgrade_modal_upgrade_click",t),E.default.logEvent("subscription_upgrade_modal_upgrade_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Dt(e,t){k.j(e,"subscription_upgrade_modal_upgrade_failed_validation",t),E.default.logEvent("subscription_upgrade_modal_upgrade_failed_validation",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Bt(e,t){k.j(e,"subscription_upgrade_onboarding_failed_validation",t)}function Et(e,t){k.j(e,"subscription_upgrade_modal_upgrade_failed_payment",t),E.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Ft(e,t){k.j(e,"subscription_upgrade_onboarding_failed_payment",t)}function Zt(e,t){k.j(e,"subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",t),E.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Lt(e,t){k.j(e,"subscription_upgrade_modal_payment_method_changed",t),E.default.logEvent("subscription_upgrade_modal_payment_method_changed",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function jt(e){k.j(e,"subscription_upgrade_modal_dismissed"),E.default.logEvent("subscription_upgrade_modal_dismissed",void 0,{device_os:e.device.os,platform:e.device.platform})}function Vt(e,t){k.j(e,"subscription_upgrade_modal_stripe_error",t),E.default.logEvent("subscription_upgrade_modal_stripe_error",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Ut(e,t){k.j(e,"create_subscription",t),E.default.logEvent("create_subscription",t.plan,t)}async function Ot(e,t){var n,o;const r=(0,C.JF)(),a=(0,O.qX)();k.j(e,"update_subscription_tier",{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,is_professional_team:t.isProfessionalTeamUser,domain_type:r,space_visible_members:a,is_trial:t.isTrial}),E.default.logEvent("update_subscription_tier",void 0,{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,space_visible_members:a,is_trial:t.isTrial,device_os:e.device.os,platform:e.device.platform});const s=null===(n=t.oldAddOns)||void 0===n?void 0:n.includes("ai"),l=null===(o=t.newAddOns)||void 0===o?void 0:o.includes("ai");if(!s&&l&&(k.j(e,"ai_addon_purchased",t),i.dG({eventType:"ai_addon_purchased",source:"client"})),!t.oldSubscriptionTier||!t.newSubscriptionTier)return;const{device:c}=e;if(!(0,h.nR)(t.oldSubscriptionTier)&&(0,h.nR)(t.newSubscriptionTier)&&"personal"!==t.newSubscriptionTier){const n={country:t.addressCountry,productName:t.newPriceId,price:t.creditAmount||0,spaceId:(0,p.cj)(t.spaceId),deviceType:c.isTablet?"tablet":c.isMobile?"mobile":"desktop",subscriptionTier:t.newSubscriptionTier};if("professional"===r&&k.j(e,"professional_workspace_upgraded",t),k.j(e,"workspace_upgraded",t),i.dG({eventType:"workspace_upgraded",source:"client",eventData:{...n,domainType:r}}),"professional"===r&&i.dG({eventType:"professional_workspace_upgraded",source:"client"}),"team"===t.planType&&(k.j(e,"team_workspace_upgraded",t),i.dG({eventType:"team_workspace_upgraded",source:"client"})),e.device.isElectron){const o=(0,m.fo)(w.default.domainBaseUrl,{deviceId:await k.cG(e),oldSubscriptionTier:t.oldSubscriptionTier,newSubscriptionTier:t.newSubscriptionTier,isProfessionalTeamUser:t.isProfessionalTeamUser,deviceType:e.device.deviceType,domainType:r,eventData:n});return void _.openExternalUrl(o)}}}function Nt(e,t){k.j(e,"subscription_update_plan",t),E.default.logEvent("subscription_update_plan",void 0,t)}function zt(e,t){k.j(e,"subscription_update_billing",t),E.default.logEvent("subscription_update_billing",void 0,t)}function Ht(e,t){const{step:n,name:o,email:i,...r}=t;k.j(e,"enterprise_sales_contact",{...r,enterprise_name:o,enterprise_email:i}),E.default.logEvent("enterprise_sales_contact")}function Wt(e){k.j(e,"enterprise_sales_contact_opened")}function qt(e){k.j(e,"enterprise_sales_contact_dismissed")}function Gt(e,t){k.j(e,"enterprise_sales_contact_updated",t)}function Kt(e,t){k.j(e,"cancel_subscription",t),E.default.logEvent("cancel_subscription",void 0,t)}function $t(e,t,n){k.j(e,"churn_survey",{...t,churnType:n})}function Qt(e,t,n){k.j(e,"churn_survey_close",{...t,churnType:n})}function Yt(e,t,n){k.j(e,"churn_survey_nudge",{...t,churnType:n})}function Jt(e,t,n){k.j(e,"churn_survey_submitted",{...t,churnType:n})}function Xt(e){const{environment:t,userContractionData:n}=e;k.j(t,"contraction_contextual_confirmation_cancelled",{userContractionData:n})}function en(e){const{environment:t,userContractionData:n}=e;k.j(t,"contraction_contextual_confirmation_confirmed",{userContractionData:n})}function tn(e){const{environment:t,userContractionData:n}=e;k.j(t,"contraction_contextual_confirmation_shown",{userContractionData:n})}function nn(e){const{environment:t,contractionSurveyId:n,reasons:o,reasonIndexes:i,reasonOther:r}=e;k.j(t,"contraction_survey_completed",{contraction_survey_id:n,reasons:o,reason_indexes:i,reason_other:r})}function on(e){const{environment:t,contractionSurveyId:n}=e;k.j(t,"contraction_survey_dismissed",{contractionSurveyId:n})}function rn(e){const{environment:t,contractionSurveyId:n}=e;k.j(t,"contraction_survey_opened",{contractionSurveyId:n})}function an(e,t){k.j(e,"currency_select_changed",t)}function sn(e,t){k.j(e,"currency_select_dismissed",t)}function ln(e,t){k.j(e,"currency_select_opened",t)}function cn(e){k.j(e,"delete_workspace_click"),E.default.logEvent("delete_workspace_click")}function dn(e){k.j(e,"quick_workspace_creation_click"),E.default.logEvent("quick_workspace_creation_click")}function un(e,t){k.j(e,"click_upgrade_button",t),E.default.logEvent("click_upgrade_button",void 0,t)}function pn(e,t){k.j(e,"plan_cta_click",t),E.default.logEvent("plan_cta_click",void 0,t)}function mn(e){k.lu(e,"approaching_block_limit","approaching_block_limit",60)}function fn(e){const t=k.lu(e,"reach_block_limit","reach_block_limit",60);E.default.logEvent("reach_block_limit",1),t&&k.Zf(e,{reach_block_limit:!0,reach_block_limit_time:Date.now(),subscription_tier:(0,N.zt)()})}function gn(e){k.j(e,"workspace_invite_copy_link")}function hn(e){k.j(e,"currently_subscribed")}function vn(e){k.j(e,"sidebar_promo_click")}function bn(e){k.j(e,"student_plan_prompt_click")}function yn(e){k.j(e,"student_plan_prompt_close_click")}function Sn(e,t){k.j(e,"onboarding_desktop_app_download_click",t),E.default.logEvent("onboarding_desktop_app_download_click",1)}const _n=c.P2((e=>{k.Zf(e,{created_page:!0})}),864e5,{trailing:!1});function wn(e,t){const{teamStore:n,new_page_id:o,transaction:i,...r}=t;lc(e,"create_block",`create_block-${t.type}-${t.from}`,60,{store:n,...r}),"page"===t.type&&(sc(e,"create_page",{store:n,...r,new_page_id:o}),_n(e))}function kn(e,t){k.j(e,"open_peek_as_page",t)}function In(e,t){k.j(e,"peek_arrow_navigation",t)}function Cn(e,t){k.j(e,"close_side_peek",t)}function xn(e,t){k.j(e,"close_peek",t)}function Tn(e,t){k.j(e,"update_page_type_peek_view",t)}function Mn(e,t){k.j(e,"click_page_type_peek_view",t)}function Pn(e,t){k.j(e,"select_template",t)}function An(e,t){k.j(e,"desktop_app_signup_browser_visit",{desktop_app_reroute_email:t.desktopAppRerouteEmail,desktop_app_device_id:t.desktopAppDeviceId})}function Rn(e,t){k.j(e,"template_modal_persona_select",t)}function Dn(e,t){k.j(e,"template_modal_open",t),E.default.logEvent("template_modal_open",1)}function Bn(e,t){k.j(e,"template_modal_item_click",t),E.default.logEvent("template_modal_item_click",1)}function En(e,t){k.j(e,"template_modal_get_template_click",t),E.default.logEvent("template_modal_get_template_click",1)}function Fn(e,t){const{team_id:n,...o}=t;k.j(e,"template_modal_accept",o,{forceOverrideAutomaticEventData:{team_id:n}}),E.default.logEvent("template_modal_accept",1)}function Zn(e,t){k.j(e,"create_collection_template",t),E.default.logEvent("create_collection_template",1)}function Ln(e,t){k.j(e,"activate_collection_template",t),E.default.logEvent("activate_collection_template",1)}function jn(e,t){k.j(e,"collection_template_action",t)}function Vn(e,t){k.lu(e,"edit_block_text_60",`edit_block_text_60-${t.user_action}`,60,t)}function Un(e,t){k.j(e,"todo_block_check",t)}function On(e,t){k.j(e,"toggle_block_toggle")}function Nn(e,t){k.j(e,"embed_block_action",t)}function zn(e,t){k.j(e,"embed_block_resize",t)}function Hn(e,t){k.j(e,"equation_block_edit",t)}function Wn(e,t){o.default.afterNextFlush((()=>{let n;const o=j.default.state.stores[0];o&&(n=o.getType());const{parentTeamStore:i,...r}=t;lc(e,"block_action",`block_action-${t.analyticsName}-${t.from}-${t.block_id}`,60,{store:i,...r,final_block_type:n})}))}function qn(e,t){const{optionalAnalyticsProperties:n,...o}=t,{teamStore:i,collectionContextStore:r,...a}=t.optionalAnalyticsProperties||{};sc(e,"open_block_menu",{store:i,...(0,x.Pn)(r)||{},...o,...a})}function Gn(e){k.j(e,"open_slash_menu")}function Kn(e,t){k.j(e,"download_file",t)}function $n(e,t){k.j(e,"file_open_attempt",t)}function Qn(e,t){k.j(e,"duplicate_template",{...t,is_paid:!1})}function Yn(e,t){k.j(e,"duplicate_template_attempt",t)}function Jn(e,t){const n=(0,y.gy)(t.url);k.j(e,"open_embed_menu",{url_domain:null==n?void 0:n.hostname})}function Xn(e,t){var n;k.j(e,"click_embed_menu",{url_domain:t.url?null===(n=(0,y.gy)(t.url))||void 0===n?void 0:n.hostname:void 0,type:t.type})}function eo(e,t){k.j(e,"url_turned_bookmark",t)}function to(e,t){k.j(e,"embed_type",t)}function no(e,t){k.j(e,"embed_render",t)}function oo(e,t){k.j(e,"embed_client_error",t)}function io(e,t){k.j(e,"configure_template_button",t)}function ro(e,t){k.j(e,"change_font_type",t)}function ao(e,t){k.j(e,"change_font_size",t)}function so(e,t){k.j(e,"change_page_width",t)}function lo(e){k.j(e,"click_add_menu")}function co(e,t){k.j(e,"move_to",t)}function uo(e,t){k.j(e,"move_to_value_selected",t)}function po(e,t){k.j(e,"move_to_menu_open",t)}function mo(e,t){k.j(e,"move_to_menu_cancel",t)}function fo(e,t){k.j(e,"add_editor_permission_to_ensure_undo",t)}function go(e,t){k.j(e,"move_to_autocomplete_query_change",t)}function ho(e,t){k.j(e,"move_to_toggle_click",t)}function vo(e,t){k.j(e,"edit_lock_toggle",t)}function bo(e,t){k.j(e,"rich_text_menu_click",t)}function yo(e,t){k.j(e,"update_page_section_visibility",t)}function So(e,t){k.j(e,"expand_block",t)}function _o(e,t,n){k.j(e,t,n)}function wo(e,t){k.j(e,"board_item_delete_newly_created",t)}function ko(e,t,n){if(!0===n)k.j(e,"edit_block_property_60",t);else{const n=(0,I.zj)(),{property_type:o,collection_id:i,collection_view_id:r}=t;k.lu(e,"edit_block_property_60",`edit_block_property_60-${n||""}-${o||""}-${i||""}-${r||""}`,60,t)}}function Io(e,t){k.j(e,"click_block_property_url",t)}function Co(e,t){k.j(e,"create_property",t)}function xo(e,t){k.j(e,"configure_property",t)}function To(e,t){k.j(e,"delete_property",t)}function Mo(e,t){k.j(e,"create_view",t)}function Po(e,t){k.j(e,"configure_view",t)}function Ao(e,t){k.j(e,"open_peek_mode_picker",t)}function Ro(e,t){k.j(e,"open_peek_mode_picker",t)}function Do(e,t){k.j(e,"update_peek_mode_format",t)}function Bo(e,t){k.j(e,"update_peek_mode_format",t)}function Eo(e,t){k.j(e,"view_settings",t)}function Fo(e,t){k.j(e,"delete_view",t)}function Zo(e,t){k.j(e,"collection_search",t)}function Lo(e,t){k.j(e,"open_collection_as_page",t)}function jo(e){k.j(e,"collection_no_date_menu_add")}function Vo(e){k.j(e,"collection_no_date_menu_view")}function Uo(e,t){k.j(e,"relation_database_click",t)}function Oo(e,t){k.lu(e,"timeline_view","timeline_view",5,t)}function No(e,t){k.j(e,"timeline_zoom_level_update",t)}function zo(e,t){k.j(e,"timeline_today_click",t)}function Ho(e,t){k.j(e,"timeline_shift_time_click",t)}function Wo(e,t){k.j(e,"timeline_toggle_table_click",t)}function qo(e,t){k.j(e,"timeline_item_scroll_arrow_click",t)}function Go(e,t){k.j(e,"timeline_item_resize",t)}function Ko(e,t){k.j(e,"timeline_dependency_arrow_add",t)}function $o(e,t){k.j(e,"timeline_dependency_arrow_delete",t)}function Qo(e,t){k.j(e,"subitem_toggle_block_open",t)}function Yo(e,t){k.j(e,"subitem_toggle_block_close",t)}function Jo(e){k.j(e,"table_new_subitem_create")}function Xo(e){k.j(e,"inline_collection_load_more_click")}function ei(e,t){k.j(e,"relation_show_as",t)}function ti(e,t){k.j(e,"relation_reorder",t)}function ni(e,t){k.j(e,"relation_add_block",t)}function oi(e,t){k.j(e,"relation_remove_block",t)}function ii(e,t){k.j(e,"relation_create_block",t)}function ri(e,t){k.j(e,"relation_customize_displayed_properties",t)}function ai(e,t){k.j(e,"relation_section_link_pages",t)}function si(e,t){k.j(e,"relation_navigate_block",t)}function li(e,t){k.j(e,"relation_update_property_visibility",t)}function ci(e,t){k.j(e,"configure_rollup_relation",t)}function di(e,t){k.j(e,"configure_rollup_target_property",t)}function ui(e,t){k.j(e,"configure_rollup_aggregation",t)}function pi(e,t){k.j(e,"collection_table_drag_and_fill",t)}function mi(e,t){k.j(e,"complete_sprint_action",t)}function fi(e,t){k.j(e,"create_space",t);const n=(0,N.zt)();if("professional"===t.domain_type&&(k.j(e,"professional_workspace_created",t),i.L1({subscriptionTier:n,planType:t.planType})),"team"===t.planType&&(k.j(e,"team_workspace_created",t),i.tO({subscriptionTier:n,planType:t.planType})),i.VT({subscriptionTier:n,domainType:t.domain_type}),"team"===t.planType){const t=i.Q3(),n=i.SY();S.trackConversionEvent(e,{eventName:"create_team_space",fbp:t,clickIds:n})}}function gi(e,t){k.j(e,"join_space",t)}function hi(e){k.j(e,"leave_space")}function vi(e){k.j(e,"delete_space"),E.default.logEvent("delete_space")}function bi(e,t){const{collectionContextStore:n}=t.optionalAnalyticsProperties||{},o=(0,x.Pn)(n)||{},i={from:t.from,block_types:t.draggedTypes,block_count:t.draggedTypes.length,as_copy:t.asCopy||!1,draggable:t.draggableProps,dropzone:t.dropzoneProps,...o};k.j(e,"drag",i),t.asCopy&&k.j(e,"drag_as_copy",i),"selection_menu"===t.from&&k.j(e,"drag_selection_menu",i)}function yi(e,t){k.j(e,"click_selection_menu",{block_type:t.blockType})}function Si(e){k.j(e,"open_mention_menu")}function _i(e,t){const{clickIndexGlobal:n,clickIndexLocal:o,sectionIndex:i,timeToClickInMs:r,analyticsFrom:a,queryLength:s,mentionType:l}=t,c={clickIndexGlobal:n,clickIndexLocal:o,sectionIndex:i,timeToClickInMs:r,analyticsFrom:a,queryLength:s,mentionType:l};k.j(e,"insert_mention_from_mention_menu",c),E.default.logEvent("insert_mention_from_mention_menu",void 0,c)}function wi(e,t){const{timeToAbandonInMs:n,analyticsFrom:o,queryLength:i}=t,r={timeToAbandonInMs:n,analyticsFrom:o,queryLength:i};k.j(e,"mention_menu_abandon",r),E.default.logEvent("mention_menu_abandon",void 0,r)}function ki(e,t){k.j(e,"mention_user",{mentioned_user_id:(0,p.F9)(t.user_id),from:t.from,block_type:t.block_type})}function Ii(e,t){k.j(e,"mention_group",{mentioned_group_id:(0,p.F9)(t.group_id),from:t.from,block_type:t.block_type})}function Ci(e,t){k.j(e,"hover_mention_group",{group_id:(0,p.F9)(t.group_id)})}function xi(e,t){k.j(e,"hover_page_mention_start",{hover_session_id:t.hover_session_id,hover_content_type:t.hover_content_type,mentioned_page_id:t.mentioned_page_id,page_visit_id:t.page_visit_id})}function Ti(e,t){k.j(e,"hover_page_mention_end",{hover_session_id:t.hover_session_id,hover_content_type:t.hover_content_type,mentioned_page_id:t.mentioned_page_id,page_visit_id:t.page_visit_id})}function Mi(e,t){k.j(e,"page_mention_click",{page_visit_id:t.page_visit_id,mentioned_page_id:t.mentioned_page_id,source_type:t.source_type,hover_preview_enabled:t.hover_preview_enabled,is_navigable_block:t.is_navigable_block})}function Pi(e,t){k.j(e,"mention_date",{date:t.date,from:t.from,block_type:t.block_type})}function Ai(e,t){k.j(e,"mention_page",{mentioned_page_id:(0,p.F9)(t.page_id),from:t.from,block_type:t.block_type})}function Ri(e,t){k.j(e,"inline_equation_edit",t)}function Di(e,t){k.j(e,"set_reminder",{date:t.date,reminder:t.reminder})}function Bi(e){k.j(e,"resize_column")}function Ei(e){k.j(e,"reset_column_sizes")}function Fi(e){k.j(e,"create_column_list")}function Zi(e,t){k.j(e,"insert_column",t)}function Li(e,t){k.j(e,"drag_near_edge_scroll",t)}function ji(e,t){k.j(e,"transform_text_block_filter",t)}function Vi(e,t){k.j(e,"unicode_filter",t)}function Ui(e,t){k.j(e,"annotation_filter",t)}function Oi(e,t){k.j(e,"keyboard_annotation",t)}function Ni(e,t){k.j(e,"link_filter",t)}function zi(e,t){const n=t.invite_targets.filter(F.cl),o=t.invite_targets.filter(F.fZ).map((e=>(0,P.fR)(e))),r=n.length+o.filter((e=>"not_in_space"===e||"page_contextual_invite"===t.invite_origin&&"none"===e||"convert_to_member"===t.invite_origin&&"none"===e||"person_property_invite"===t.invite_origin||"membership_request"===t.invite_origin)).length,a=c.oA(t.permission_items.map((e=>{if("user_permission"===e.type)return e.user_id&&(0,p.cj)(e.user_id)}))),l=(0,N.zt)(),d={role:t.role,user_count:o.length+n.length,new_user_count:n.length,new_workspace_member_count:t.is_space?r:0,is_onboarding:t.is_onboarding,invite_flow_id:t.invite_flow_id,invite_origin:t.invite_origin,invitee_ids:a,invite_message_length:t.invite_message_length,subscription_tier:l,domain_type:t.domainType,...!t.is_space&&{share_menu_session_id:t.share_menu_session_id}};k.j(e,"invite",{...d,is_space:t.is_space}),V.default.waitUntilLoaded().then((()=>{const{data:n}=V.default.state,o=n?O.Ln(e,n):void 0,i=n?O.Lz(e,n):void 0;k.j(e,"invite_debug_with_block_usage",{...d,is_space:t.is_space,is_over_block_limit:o,block_usage:i}),t.is_space||function(e,t){const{currentSpaceStore:n,currentUserStore:o}=B.default.state,i=n&&n.canEditMembership(),r=(0,C.JF)(),a=null==o?void 0:o.getEmail();if(!i||!r||!a)return;if("professional"!==r)return;const l=(0,s.Gd)(a),c=(0,O.A7)().slice(0,50).map((e=>Z.U6.createChildStore(n,{table:f.KJ,id:e.userId}).getEmail())).filter((e=>e&&(0,s.Gd)(e)===l)).length;k.j(e,"page_invite_guest_summary",{...t,guest_with_same_domain_count:c})}(e,d)})),t.is_space?(k.j(e,"space_invite",d),k.Zf(e,{space_invited:!0}),E.default.logEvent("space_invite",t.invite_origin,d),ku(e,{is_space:!0,invite_origin:t.invite_origin,domainType:t.domainType,new_workspace_member_count:d.new_workspace_member_count}),function(e,t){const n=(0,N.zt)();t.visibleMembersCount<=1&&(k.j(e,"workspace_first_invite_sent"),i.kd(n,t.domainType),"professional"===t.domainType&&(k.j(e,"professional_workspace_first_invite_sent",{visible_members_count:t.visibleMembersCount,is_professional_team_user:t.isProfessionalTeamUser,domain_type:t.domainType}),i.Dq()))}(e,{visibleMembersCount:O.qX(),isProfessionalTeamUser:t.isProfessionalTeamUser,domainType:t.domainType})):(k.j(e,"page_invite",d),E.default.logEvent("page_invite",l,d),function(e,t){const{currentUserSettingsStore:n}=B.default.state;if(!n)return;const o=n.getKeyStore("settings").getKeyStore("signup_time").getValue(),i=n.getKeyStore("settings").getKeyStore("first_page_invite_at").getValue();if(!Boolean(i)){const i=Date.now(),r={...t,...o?{signup_time_ready:!0,time_from_signup_to_first_page_invite:o-i}:{signup_time_ready:!1}};k.j(e,"page_invite_time",r),E.default.logEvent("page_invite_time",t.subscription_tier,r),z.createAndCommit({userAction:"firstPageInvite",environment:e,userId:n.id,perform:e=>{H.d2({userSettingsStore:n,data:{first_page_invite_at:i},transaction:e})}})}}(e,d))}function Hi(e,t){k.j(e,"change_email",t)}function Wi(e,t){k.j(e,"update_page_permission","user_id"in t||"page_id"in t?Ji(t):t)}function qi(e,t){k.j(e,"set_permission_item",t)}function Gi(e,t){k.j(e,"invite_modal_input_focus",t)}function Ki(e,t){k.j(e,"invite_users_to_page",t)}function $i(e,t){if("team"===t.type){const{team_id:n,...o}=t;k.j(e,"expand_permission",{...o},{forceOverrideAutomaticEventData:{team_id:n}})}else k.j(e,"expand_permission",t)}function Qi(e,t){k.j(e,"page_share_permissions_summary",t)}function Yi(e,t){k.j(e,"page_share_user_access_role",t)}function Ji(e){const{user_id:t,page_id:n,...o}=e;return o}function Xi(e,t,n){k.j(e,"update_space_permission",{...(0,d.jg)(t)&&{updated_user_id:(0,p.cj)(t.user_id)},...(0,d.FB)(t)&&{updated_bot_id:(0,p.cj)(t.bot_id)},..."user_id"in t||"page_id"in t?Ji(t):t,...n})}function er(e,t){var n;let{item:o,teamStore:i}=t;const r=null===(n=i.getPermissionItems())||void 0===n?void 0:n.find((e=>e.type===o.type));(null==r?void 0:r.role)!==o.role&&sc(e,"update_team_permission",{store:i,..."user_id"in o||"page_id"in o?Ji(o):o,..."user_id"in o&&{permission_user_id:(0,p.cj)(o.user_id)},old_role:null==r?void 0:r.role,is_team_role_change:!1,is_permission_change:!0})}function tr(e,t){let{permission_user_id:n,store:o,team_role:i}=t;sc(e,"update_team_permission",{store:o,permission_user_id:n,team_role:i,is_team_role_change:!0,is_permission_change:!1})}function nr(e,t){k.j(e,"convert_guest_to_member",t),E.default.logEvent("convert_guest_to_member",t.convert_to,{origin:t.origin})}function or(e){k.j(e,"remove_guest")}function ir(e,t){E.default.logEvent("remove_member",t.member_user_id,t),ku(e,{is_space:t.is_space,invite_origin:t.invite_origin,domainType:t.domainType,new_workspace_member_count:t.new_workspace_member_count}),k.j(e,"remove_member",{member_user_id:t.member_user_id,member_role:t.member_role,contraction_survey_id:t.contraction_survey_id})}function rr(e){k.j(e,"permission_group_create")}function ar(e,t){k.j(e,"permissions_settings_tab_click",t)}function sr(e){k.j(e,"permission_group_rename")}function lr(e,t){k.j(e,"permission_group_set_icon",t)}function cr(e,t){k.j(e,"permission_group_add_members",t)}function dr(e){k.j(e,"permission_group_remove_member")}function ur(e){k.j(e,"permission_group_delete")}function pr(e,t){k.j(e,"toggle_allow_search_engine_indexing",t)}function mr(e,t){k.j(e,"set_expiration_time_on_public_page",t)}function fr(e,t){k.j(e,"toggle_allow_duplicate",t)}function gr(e,t){k.j(e,"restrict_permissions",t)}function hr(e,t){k.j(e,"restore_permissions",t)}function vr(e,t){k.j(e,"set_database_sync_permissions",t)}function br(e){k.j(e,"widen_permissions")}function yr(e){k.j(e,"request_access")}function Sr(e,t){k.j(e,"grant_access",t)}function _r(e,t){k.j(e,"grant_access_update_access_level",t)}function wr(e,t){k.j(e,"ignore_access_request",t)}function kr(e,t){k.j(e,"toggle_request_access_security_setting",t)}function Ir(e,t){k.j(e,"invite_typed",t),E.default.logEvent("invite_typed",t.subscription_tier,{...t})}function Cr(e,t){k.j(e,"invite_select_target",t),E.default.logEvent("invite_select_target",t.subscription_tier,{selected_user_token_rank:t.selected_user_token_rank})}function xr(e,t){k.j(e,"invite_change_role",t),E.default.logEvent("invite_change_role",t.subscription_tier,{...t})}function Tr(e,t){k.j(e,"abandon_permissions_invite",t),E.default.logEvent("abandon_permissions_invite",t.subscription_tier,{...t})}function Mr(e,t){k.j(e,"open_share_workspace_invite",t),E.default.logEvent("open_share_workspace_invite",t.subscription_tier,{...t})}function Pr(e,t){k.j(e,"send_share_workspace",t),E.default.logEvent("send_share_workspace",t.subscription_tier,{...t})}function Ar(e,t){k.j(e,"send_membership_request",t),E.default.logEvent("send_membership_request",t.subscription_tier,{...t})}function Rr(e,t){k.j(e,"view_all_requests_from_membership_request_notification",t),E.default.logEvent("view_all_requests_from_membership_request_notification","notification",t)}function Dr(e,t){k.j(e,"resolve_membership_request",t),E.default.logEvent("resolve_membership_request",t.status,t)}function Br(e){k.j(e,"open_guest_membership_request_modal"),E.default.logEvent("open_guest_membership_request_modal")}function Er(e){k.j(e,"render_guest_membership_request_entry_point"),E.default.logEvent("render_guest_membership_request_entry_point")}function Fr(e){k.j(e,"sidebar_expand")}function Zr(e){k.j(e,"sidebar_unexpand")}function Lr(e,t){k.j(e,"bookmark",t)}function jr(e,t){k.j(e,"unbookmark",t)}function Vr(e,t){k.j(e,"open_settings",t)}function Ur(e,t){k.j(e,"toggle_settings_tab",t)}function Or(e){k.j(e,"upload_profile_photo")}function Nr(e,t){k.j(e,"name_changed",t)}function zr(e){k.j(e,"delete_account_clicked")}function Hr(e){k.j(e,"delete_account_confirmed")}function Wr(e){k.j(e,"log_out_from_active_sessions_clicked")}function qr(e){k.j(e,"change_password_clicked")}function Gr(e){k.j(e,"remove_password_clicked")}function Kr(e,t){k.j(e,"locale_changed",t)}function $r(e,t){k.j(e,"invite_link_updated",t)}function Qr(e,t){k.j(e,"allowed_email_domains_updated",t)}function Yr(e){k.j(e,"open_trash")}function Jr(e,t){k.j(e,"toggle_trash_tab",t)}function Xr(e){k.j(e,"restore_trash_page")}function ea(e){k.j(e,"delete_trash_page")}function ta(e){k.j(e,"open_breadcrumb_current_page_menu")}function na(e){k.j(e,"click_breadcrumb_current_page_scroll_to_top")}function oa(e){k.j(e,"click_breadcrumb_move_to")}function ia(e,t){k.j(e,"open_page_share",t),E.default.logEvent("open_page_share")}function ra(e,t){k.j(e,"close_page_share",t)}function aa(e,t){k.j(e,"open_page_share_invite",t),E.default.logEvent("open_page_share_invite",t.subscription_tier,{...t})}function sa(e){k.j(e,"open_space_invite")}function la(e){k.j(e,"open_more_menu")}function ca(e){k.j(e,"open_more_connections_menu")}function da(e){k.j(e,"open_public_more_menu")}function ua(e){k.j(e,"confirm_app_update")}function pa(e,t){k.j(e,"show_page_reload_confirmation_dialog",t)}function ma(e,t){k.j(e,"export",t)}function fa(e,t){k.j(e,"export_failed",t)}function ga(e,t){const{teamStore:n,...o}=t;sc(e,"click_outliner_item",{store:n,...o})}function ha(e,t){"onboarding"===t.from?function(e,t){const{teamStore:n,...o}=t;sc(e,"create_onboarding_page",{store:n,...o})}(e,{from:t.from,teamStore:t.teamStore,forkedTemplateId:t.pageId}):wn(e,{type:"page",from:t.from,teamStore:t.teamStore,new_page_id:t.pageId,transaction:t.transaction})}function va(e,t){k.j(e,"click_outliner_team_new_page",t)}function ba(e,t){const{teamStore:n,...o}=t;sc(e,"outliner_item_toggle",{store:n,...o})}function ya(e,t){sc(e,"outliner_team_toggle",t)}function Sa(e,t){k.j(e,"outliner_section_toggle",t)}function _a(e){k.j(e,"click_nested_child_page")}function wa(e,t){k.j(e,"click_desktop_navigator",t)}function ka(e){k.j(e,"open_space_switcher")}function Ia(e){k.j(e,"space_switcher_select_space")}function Ca(e){k.j(e,"space_switcher_logout_click")}function xa(e,t){k.j(e,"toggle_dark_mode",t)}function Ta(e){k.j(e,"delete_user")}function Ma(e,t){k.j(e,"pin_page",t)}function Pa(e,t){k.j(e,"unpin_page",t)}function Aa(e,t){k.j(e,"open_support_chat",t)}function Ra(e){k.j(e,"click_help"),E.default.logEvent("click_help")}function Da(e,t){k.j(e,"click_help_item",t),"sales_chat"===t.item&&E.default.logEvent("click_help_item")}function Ba(e,t){k.j(e,"global_click_learn",t)}function Ea(e,t){k.j(e,"tap_mobile_action_bar_item",{item_name:t.itemName,from:t.from})}function Fa(e){k.j(e,"scroll_mobile_action_bar")}function Za(e){k.j(e,"open_mobile_sidebar")}function La(e,t){k.j(e,"tap_mobile_bottom_bar_item",{...t})}function ja(e){k.j(e,"mobile_add_to_menu_accept")}function Va(e,t){k.j(e,"navigation",{...t})}function Ua(e){k.j(e,"open_notification_settings_from_all_updates")}function Oa(e,t){E.default.logEvent("open_sidebar_updates",t.tab,t),k.j(e,"open_sidebar_updates",t)}function Na(e){k.j(e,"open_page_updates")}function za(e,t){k.j(e,"click_update",t)}function Ha(e,t){const{target:n,...o}=t;let i;"notify_mobile"===n?i="set_mobile_notification":"notify_desktop"===n?i="set_desktop_notification":"notify_email"===n?i="set_email_notification":"notify_email_always"===n?i="set_email_always_notification":"notify_email_digest"===n?i="set_email_digest_notification":(0,b.t1)(n),k.j(e,i,o)}function Wa(e){k.j(e,"set_marketing_emails_preferences")}function qa(e,t){k.j(e,"follow_page",t)}function Ga(e,t){k.j(e,"unfollow_page",t)}function Ka(e,t){k.j(e,"update_page_follow_settings",t)}function $a(e){k.j(e,"open_emoji_menu")}function Qa(e,t){k.j(e,"emoji_no_results",t)}function Ya(e,t,n){k.j(e,t,n)}function Ja(e,t,n){k.j(e,t,n),E.default.logEvent(t,n.icon)}function Xa(e,t){k.j(e,"open_block_discussion_menu",t)}function es(e){let{environment:t,from:n,notificationId:o,activityId:i}=e;k.j(t,"open_reply_discussion_menu",{from:n,notificationId:o,activityId:i})}function ts(e){let{environment:t,from:n,notificationId:o,activityId:i}=e;k.j(t,"close_reply_discussion_menu",{from:n,notificationId:o,activityId:i})}function ns(e){k.j(e,"open_new_block_discussion")}function os(e){k.j(e,"open_new_inline_discussion")}function is(e){k.j(e,"discard_new_discussion_dialog_show")}function rs(e){k.j(e,"discard_new_discussion_dialog_confirm")}function as(e){k.j(e,"discard_new_discussion_dialog_cancel")}function ss(e,t){k.j(e,"create_block_discussion",t),E.default.logEvent("create_block_discussion")}function ls(e,t){k.j(e,"create_inline_discussion",t),E.default.logEvent("create_inline_discussion")}function cs(e,t){k.j(e,"add_comment",t),E.default.logEvent("add_comment",t.from)}function ds(e,t){k.j(e,"delete_comment",t)}function us(e,t){k.j(e,"edit_comment",t)}function ps(e,t){k.j(e,"resolve_discussion",t),E.default.logEvent("resolve_discussion",t.from)}function ms(e,t){k.j(e,"reopen_discussion",t)}function fs(e,t){k.j(e,"click_discussion",t)}function gs(e){const{environment:t,...n}=e;k.j(t,"add_reaction",n),E.default.logEvent("add_reaction",n.reaction_value)}function hs(e){const{environment:t,...n}=e;k.j(t,"remove_reaction",n)}function vs(e,t){k.j(e,"open_history",{from:t})}function bs(e){return Date.now()-parseInt(e.timestamp)}function ys(e,t){k.j(e,"select_snapshot",{ageMs:bs(t)})}function Ss(e,t){k.j(e,"history_copy",{ageMs:bs(t)})}function _s(e,t){k.j(e,"restore_snapshot",{ageMs:bs(t)})}function ws(e,t){var n;k.j(e,"fork_page",{blockId:t},{dontWait:!0}),E.default.logEvent("fork_page",null===(n=document.location)||void 0===n||null===(n=n.host)||void 0===n||null===(n=n.split(".notion."))||void 0===n?void 0:n[1])}function ks(e,t){const{type:n,bytes:o,data:i}=t;k.j(e,n,{bytes:o,...i})}function Is(e,t){k.j(e,"open_search",t)}function Cs(e,t){k.j(e,"space_invitation_email_clicked",t)}function xs(e,t){k.j(e,"select_search_item",t);const{numKeystrokes:n,timeToSelectMs:o,selectedItemIndex:i,originalPosition:r,context:a,numLocalResults:s,searchSessionId:l,searchSessionFlowNumber:c,numVisibleMembers:d,localSources:u,isMobile:p}=t,m=Boolean(!!u&&u.length>0),f=d>1;E.default.logEvent("select_search_item",i,{numKeystrokes:n,timeToSelectMs:o,selectedItemIndex:i,numLocalResults:s,originalItemIndex:r,searchSessionFlowNumber:c,searchSessionId:l,context:a,isMultiplayer:f,isLocalResult:m,isMobile:p});const g=1/(i+1);k.j(e,"quick_find_reciprocal_rank",{reciprocalRank:g,context:a,searchSessionId:l,numLocalResults:s,isMultiplayer:f}),E.default.logEvent("quick_find_reciprocal_rank",g,{context:a,searchSessionId:l,numLocalResults:s,isMultiplayer:f,isLocalResult:m,isMobile:p})}function Ts(e,t){k.j(e,"abandoned_search",t);const{numKeystrokes:n,timeToAbandonMs:o,numLocalResults:i,numVisibleMembers:r,isMobile:a}=t,s=r>1;E.default.logEvent("abandoned_search",n,{numKeystrokes:n,timeToAbandonMs:o,numLocalResults:i,searchSessionId:t.searchSessionId,isMultiplayer:s,isMobile:a}),k.j(e,"quick_find_reciprocal_rank",{reciprocalRank:0,searchSessionId:t.searchSessionId,numLocalResults:i,isMultiplayer:s}),E.default.logEvent("quick_find_reciprocal_rank",0,{searchSessionId:t.searchSessionId,numLocalResults:i,isMultiplayer:s,isMobile:a})}function Ms(e,t){k.j(e,"search_client_results",t)}function Ps(e,t){k.j(e,"search_post_click_page_interaction",t)}function As(e,t){var n;k.j(e,"search_post_click_page_exit",{dwellTime:(new Date).getTime()-t.timeEntered.getTime()},{forceOverrideAutomaticEventData:{queryId:null===(n=L.Z.state)||void 0===n?void 0:n.queryId}})}function Rs(e,t,n){const o=e=>"peekViewBlockId"in e&&e.peekViewBlockId?e.peekViewBlockId:"blockId"in e?e.blockId:void 0,i=o(t),a=o(n),s="pageVisitSource"in n&&n.pageVisitSource?(0,r.xt)(parseInt(n.pageVisitSource)):void 0;k.j(e,"click_in_page_navigation",{current_route_name:t.name,next_route_name:n.name,page_visit_source:s,current_page_id:i,next_page_id:a},{forceOverrideAutomaticEventData:{page_id:i}})}function Ds(e,t){k.j(e,"offline_access_failure",t)}function Bs(e,t){k.j(e,"open_view_all_popover",t)}function Es(e){k.j(e,"copy_link_from_permissions_setting")}function Fs(e){k.j(e,"copy_web_link")}function Zs(e,t){k.j(e,"select_page_from_view_all_popover",t)}function Ls(e){k.j(e,"dismiss_new_page_suggested_templates")}function js(e){k.j(e,"transclusion_container_copy_button")}function Vs(e,t){k.j(e,"transclusion_container_open_backlinks",t)}function Us(e){k.j(e,"developer_integrations_list_visit")}function Os(e){k.j(e,"developer_integrations_new_click")}function Ns(e,t){k.j(e,"developer_integrations_filter_click",t)}function zs(e,t){const n=M.OS[t.table];k.j(e,"developer_integrations_view_visit",{type:n})}function Hs(e,t){const n=M.OS[t.table];k.j(e,"developer_integrations_create",{type:n})}function Ws(e,t){const n=M.OS[t.table];k.j(e,"developer_integrations_view_secret",{type:n})}function qs(e,t){const n=M.OS[t.table];k.j(e,"developer_integrations_copy_secret",{type:n})}function Gs(e,t){const n=M.OS[t.table],{table:o,...i}=t;k.j(e,"developer_integrations_update",{type:n,...i})}function Ks(e,t){k.j(e,"developer_integrations_my_integrations_click",t)}function $s(e,t){k.j(e,"developer_integrations_all_integrations_click",t)}function Qs(e,t){k.j(e,"developer_integrations_visit_developer_website_click",t)}function Ys(e,t){k.j(e,"developer_integrations_contact_developer_click",t)}function Js(e,t){k.j(e,"developer_integrations_disconnect_click",t)}function Xs(e,t){k.j(e,"developer_integrations_open_card_dropdown_click",t)}function el(e,t){k.j(e,"developer_integrations_delete_click",t)}function tl(e,t){k.j(e,"developer_integrations_confirm_delete_click",t)}function nl(e,t){k.j(e,"comment_upload_attachments",t)}function ol(e,t){k.j(e,"open_comments_sidebar",t)}function il(e,t){k.j(e,"open_updates_sidebar",t)}function rl(e,t){k.j(e,"updates_sidebar_tab_click",t)}function al(e,t){k.j(e,"install_public_integration_oauth",t)}function sl(e,t){k.j(e,"security_and_compliance_integration_install",t)}function ll(e,t){k.j(e,"security_and_compliance_integration_uninstall",t)}function cl(e,t){k.j(e,"security_and_compliance_integration_update",t)}function dl(e,t){k.j(e,"connect_external_integration",t),E.default.logEvent("connect_external_integration",void 0,t)}function ul(e,t){k.j(e,"disconnect_external_integration",t)}function pl(e,t){k.j(e,"activate_link_preview_menu",t)}function ml(e,t){k.j(e,"save_link_preview",t)}function fl(e,t){k.j(e,"update_link_preview",t)}function gl(e,t){k.j(e,"open_link_preview_help_guide",t)}function hl(e,t){k.j(e,"remove_link_preview_with_error",t)}function vl(e,t){k.j(e,"link_preview_url_miss",t)}function bl(e,t){k.j(e,"show_all_discoverable_connected_apps",t)}const yl={tracked:!1};function Sl(e){let{environment:t,type:n,onboardingState:o}=e;if(yl.tracked)return;const i={type:n,onboardingStage:null==o?void 0:o.stage};k.j(t,"cookie_banner_shown",i),yl.tracked=!0}function _l(e){k.j(e,"cookie_modal_shown")}function wl(e,t){k.j(e,"coupon_typeform_clicked",t)}function kl(e,t){k.lu(e,"legacy_transclusion_show",`legacy_transclusion_show_${t.block_type}`,3600,t)}function Il(e,t){k.j(e,"legacy_transclusion_autofix",t)}function Cl(e,t){k.j(e,"transaction_timestamp_collision",t)}function xl(e,t){k.j(e,"transaction_timestamp_regression",t)}function Tl(e,t){k.j(e,"transaction_race_hazard",t)}function Ml(e,t){k.j(e,"transaction_async_data_loss",t)}function Pl(e,t){k.j(e,"transaction_deadlock_warning",t)}function Al(e,t){k.j(e,"transaction_too_large",t)}function Rl(e,t){k.j(e,"transaction_queue_error_show",t)}function Dl(e){k.j(e,"connection_error_show",{})}function Bl(e,t){k.j(e,"connection_error_indicator_details_show",t)}function El(e,t){k.j(e,"low_storage_error_show",t)}function Fl(e,t){k.j(e,"transaction_queue_healthcheck",t)}function Zl(e,t){k.j(e,"save_edits_error_modal_show",t)}function Ll(e,t){k.j(e,"unsaved_transaction_error",t)}function jl(e,t){k.j(e,"open_team_browser",t)}function Vl(e,t){k.j(e,"close_team_browser",{...t,num_of_total_teams:t.num_of_joined_teams+t.num_of_unjoined_teams})}function Ul(e,t){k.j(e,"team_browser_search_cleared",t)}function Ol(e,t){const{teamStore:n,outliner_type:o}=t;sc(e,"team_browser_member_list_hover",{store:n,outliner_type:o})}function Nl(e,t){k.j(e,"create_team_start",{from:t.from,flow_id:t.flowId}),E.default.logEvent("create_team_start",1,t)}async function zl(e,t){const{store:n}=t;await n.load(),sc(e,"create_team_complete",t),ac("create_team_complete",t)}async function Hl(e,t){const{store:n}=t;await n.load(),sc(e,"enable_teams",t)}function Wl(e,t){const{screen:n,...o}=t;if(n===R.F.Team){const t={screen:"team",...o};return sc(e,"close_create_team_modal",t),void ac("close_create_team_modal",t)}const i={screen:"members",flow_id:t.flow_id,from:t.from,team_id:t.team_id,store:t.store};sc(e,"close_create_team_modal",i),ac("close_create_team_modal",i)}function ql(e,t){sc(e,"invite_team_members",t),ac("invite_team_members",t)}function Gl(e,t){sc(e,"invite_team_groups",t),ac("invite_team_groups",t)}function Kl(e,t){sc(e,"set_default_team",t)}function $l(e,t){sc(e,"join_team",t),ac("join_team",t)}function Ql(e,t){sc(e,"archive_team",t)}function Yl(e,t){sc(e,"transition_to_zero_teams",t)}function Jl(e,t){sc(e,"restore_team",t)}function Xl(e,t){sc(e,"remove_team_members",t)}function ec(e,t){sc(e,"remove_team_groups",t)}function tc(e,t){sc(e,"change_teams_order",t)}function nc(e,t){sc(e,"change_team_access_level",t)}function oc(e,t){sc(e,"update_team_settings",t)}function ic(e,t){sc(e,"open_outliner_team_overflow",t)}function rc(e,t){sc(e,"click_outliner_team_overflow_option",t),ac("click_outliner_team_overflow_option",t)}function ac(e,t){const{store:n,...o}=t;n?E.default.logEvent(e,1,{...(0,k.nB)(n),...o}):E.default.logEvent(e,1,t)}async function sc(e,t,n){const{store:o,...i}=n;if(!o)return void(await k.j(e,t,{...i}));const r=(0,k.nB)(o),a=c.CE(r,"team_id");await k.j(e,t,{...a,...i},{forceOverrideAutomaticEventData:{team_id:r.team_id}})}function lc(e,t,n,o,i){const{store:r,...a}=i;if(!r)return void k.lu(e,t,n,o,{...a});const s=(0,k.nB)(r),l=c.CE(s,"team_id");k.lu(e,t,n,o,{...l,...a},{forceOverrideAutomaticEventData:{team_id:s.team_id}})}function cc(e,t){sc(e,"open_team_home",t)}function dc(e){switch(e){case D.a.General:return"general";case D.a.Members:return"members";case D.a.Security:return"security";default:(0,b.t1)(e)}}function uc(e,t){sc(e,"click_team_settings_tab",{store:t.store,tab_old_value:dc(t.tab_old_value),tab_new_value:dc(t.tab_new_value)})}function pc(e,t){sc(e,"restore_team_permissions",t)}function mc(e,t){sc(e,"team_invite_link_confirmation_selection",t)}function fc(e,t){sc(e,"copy_team_invite_link",t),ac("copy_team_invite_link",t)}function gc(e,t){sc(e,"click_team_invite_link",t)}function hc(e,t){sc(e,"request_access_to_team",t)}function vc(e,t){sc(e,"resolve_team_access_request",t)}function bc(e,t){k.j(e,"domain_verification_domain_added",t)}function yc(e,t){k.j(e,"domain_verification_verification_attempted",t)}function Sc(e,t){k.j(e,"domain_verification_domain_verified",t)}function _c(e,t){k.j(e,"workspace_creation_ability",t)}function wc(e,t){k.j(e,"workspace_creation_setting_updated",t)}function kc(e,t){k.j(e,"claimable_spaces_viewed",t)}function Ic(e,t){k.j(e,"space_transfer_requested",t)}function Cc(e,t){k.j(e,"space_transfer_completed",t)}function xc(e,t){k.j(e,"space_claim_upgrade_requested",t)}function Tc(e,t){k.j(e,"space_claim_upgrade_completed",t)}function Mc(e,t){k.j(e,"space_claim_deletion_started",t)}function Pc(e,t){k.j(e,"space_claim_deletion_canceled",t)}function Ac(e,t){k.j(e,"move_to_error",t)}function Rc(e,t){k.j(e,"show_user_validation_response",t)}function Dc(e){k.j(e,"zendesk_metadata_open_messenger")}function Bc(e){k.j(e,"zendesk_metadata_signup")}function Ec(e,t){k.j(e,"full_screen_action",t)}function Fc(e,t){k.j(e,"ai_action",t)}function Zc(e,t,n){const o={site:"client",...n};k.j(e,t,o)}function Lc(e,t){k.j(e,"ai_favorite_action",t)}function jc(e,t){k.j(e,"ai_block_action",t)}function Vc(e,t){k.j(e,"ai_autofill_action",t),E.default.logEvent("ai_autofill_action",1,{action_type:t.type})}function Uc(e,t){k.j(e,"ai_autofill_settings_action",t)}function Oc(e,t){k.j(e,"ai_completion_popup_open",t)}function Nc(e,t){k.j(e,"ai_completion_popup_close",t),E.default.logEvent("ai_completion_popup_close",1,{exit_type:t.exit_type})}function zc(e,t){k.j(e,"ai_completion_popup_retry",t)}function Hc(e,t){k.j(e,"ai_completion_popup_history_navigation",t)}function Wc(e,t){k.j(e,"ai_completion_popup_preview_start",t),E.default.logEvent("ai_completion_popup_preview_start",1,{from:t.from,prompt_key:t.prompt_key})}function qc(e,t){k.j(e,"ai_completion_popup_update_prompt_text",t)}function Gc(e,t){k.j(e,"ai_completion_popup_preview_end",t),E.default.logEvent("ai_completion_popup_preview_end",1,{preview_time:t.preview_time})}function Kc(e,t){k.j(e,"ai_completion_popup_preview_stopped_by_user",t)}function $c(e,t){k.j(e,"ai_user_data_sharing_opt_in_submit",t)}function Qc(e,t){k.j(e,"recurrence_menu_open",t)}function Yc(e,t){k.j(e,"recurrence_saved",t)}function Jc(e,t){k.j(e,"overview_analytics_filter_change",t)}function Xc(e,t){k.j(e,"user_analytics_engagement_timerange_filter_change",t)}function ed(e,t){k.j(e,"user_analytics_table_filter_change",t)}function td(e,t){k.j(e,"user_analytics_table_sort_change",t)}function nd(e,t){k.j(e,"user_analytics_export_requested",t)}function od(e,t){k.j(e,"content_analytics_engagement_timerange_filter_change",t)}function id(e,t){k.j(e,"content_analytics_export_requested",t)}function rd(e,t){k.j(e,"content_analytics_table_filter_change",t)}function ad(e,t){k.j(e,"content_analytics_table_timerange_filter_change",t)}function sd(e,t){k.j(e,"content_analytics_table_sort_change",t)}function ld(e,t){k.j(e,"workspace_analytics_tab_click",t)}function cd(e,t){k.j(e,"search_analytics_table_timerange_filter_change",t)}function dd(e,t){k.j(e,"search_analytics_table_sort_change",t)}function ud(e){k.j(e,"admin_content_search_analytics_acknowledge_confirm")}function pd(e,t){k.j(e,"admin_content_search_analytics_filter_change",t)}function md(e,t){k.j(e,"admin_content_search_analytics_queried",t)}function fd(e,t){k.j(e,"admin_content_search_analytics_export_requested",t)}function gd(e,t){k.j(e,"wiki_convert",t),E.default.logEvent("wiki_convert",void 0,t)}function hd(e,t){k.j(e,"wiki_undo_conversion",t),E.default.logEvent("wiki_undo_conversion",void 0,t),v.j({name:"wiki_undo_conversion",args:t})}function vd(e,t){k.j(e,"wiki_promo_show",t),E.default.logEvent("wiki_promo_show",void 0,t)}function bd(e){k.j(e,"wiki_promo_click_learn_more")}function yd(e){k.j(e,"wiki_promo_dismiss")}function Sd(e,t){k.j(e,"verification_update",t),E.default.logEvent("verification_update",t.action)}function _d(e,t){k.j(e,"toggle_open_in_desktop_app",t)}function wd(e){k.j(e,"configure_open_in_desktop_app")}function kd(e){k.j(e,"open_in_desktop_app_popup_dismiss")}function Id(e){k.j(e,"open_in_desktop_app_popup_display")}function Cd(e){k.j(e,"open_in_desktop_app_popup_download")}function xd(e,t){k.j(e,"open_in_desktop_app_popup_open_in_app",t)}function Td(e){k.j(e,"add_slack_integration")}function Md(e){k.j(e,"remove_slack_integration")}function Pd(e,t){k.j(e,"slack_notification_create",t)}function Ad(e,t){k.j(e,"slack_notification_delete",t)}function Rd(e,t){k.j(e,"slack_notification_update",t)}function Dd(e,t){k.j(e,"click_team_new_page_option",t)}function Bd(e,t){k.j(e,"show_team_duplicate_template_confirmation",t)}function Ed(e,t){k.j(e,"click_team_duplicate_template_confirmation_option",t)}function Fd(e,t){let{from:n,wiki_block_id:o,destination_team_id:i,wiki_template_id:r}=t;Ld(e,{from:n,preset_uri:"notion://wiki/wiki_preset",created_page_ids:[o],database_types:[a.GZ],destination_team_id:i,wiki_template_id:r})}function Zd(e,t){let{from:n,preset_uri:o,created_block_stores:i,destination_team_id:r}=t;const a=[],s=[];for(const d of i){var l;const e=null===(l=d.getCollectionStore())||void 0===l?void 0:l.getDatabaseType();e&&(s.push(d.id),a.push(e))}const c=i.map((e=>{var t;return null===(t=e.getFormat())||void 0===t?void 0:t.app_id})).filter(b.$K);Ld(e,{from:n,preset_uri:o,created_page_ids:s,database_types:a,destination_team_id:r,app_ids:[...new Set(c)]})}function Ld(e,t){k.j(e,"create_app_template",t)}function jd(e,t){k.j(e,"delete_app_template",t)}function Vd(e,t){k.j(e,"create_typed_dbs_in_team_latency",t)}function Ud(e,t){k.j(e,"apply_preset_features",t)}function Od(e,t){const{from:n}=t;k.j(e,"show_tooltip",{from:n,time:Date.now()})}function Nd(e,t){const{from:n}=t;k.j(e,"dismiss_tooltip",{from:n,time:Date.now()})}function zd(e,t){k.j(e,"payment_status_banner_displayed",t)}function Hd(e,t){k.j(e,"payment_status_banner_action",t)}function Wd(e){k.j(e,"managed_user_reactivate_button_clicked")}function qd(e,t){k.j(e,"managed_user_support_access_toggled",t)}function Gd(e,t){k.j(e,"managed_users_dashboard_search",t)}function Kd(e,t){k.j(e,"managed_users_external_space_access_set",t)}function $d(e,t){k.j(e,"managed_users_prevent_support_access_toggled",t)}function Qd(e,t){k.j(e,"managed_users_session_duration_modal_confirmed",t)}function Yd(e,t){k.j(e,"managed_user_delete_button_clicked",t)}function Jd(e,t){k.j(e,"managed_user_edit_modal_submitted",t)}function Xd(e){k.j(e,"managed_user_log_out_button_clicked")}function eu(e,t){k.j(e,"managed_user_remove_from_external_workspace_button_clicked",t)}function tu(e){k.j(e,"managed_user_reset_password_button_clicked")}function nu(e){k.j(e,"managed_user_suspend_button_clicked")}function ou(e,t){k.j(e,"managed_users_log_out_all_button_clicked",t)}function iu(e,t){k.j(e,"managed_users_reset_passwords_all_button_clicked",t)}function ru(e,t){k.j(e,"managed_users_session_duration_selected",t)}function au(e,t){k.j(e,"managed_user_edit_profile_modal_open",t)}function su(e,t){k.j(e,"managed_user_delete_modal_confirmed",t)}function lu(e,t){k.j(e,"managed_user_edit_modal_confirmed",t)}function cu(e){k.j(e,"managed_user_log_out_modal_confirmed")}function du(e,t){k.j(e,"managed_user_remove_from_external_workspace_modal_confirmed",t)}function uu(e){k.j(e,"managed_user_reset_password_modal_confirmed")}function pu(e){k.j(e,"managed_user_suspend_modal_confirmed")}function mu(e,t){k.j(e,"managed_users_log_out_all_modal_confirmed",t)}function fu(e,t){k.j(e,"managed_users_reset_passwords_all_modal_confirmed",t)}function gu(e){k.j(e,"managed_users_dashboard_button_clicked")}function hu(e,t){const{configurationState:n,hasQuery:o,searchSessionId:i,from:r}=t;n&&k.j(e,"qna_open",{qna_session_id:n.sessionId,has_query:o,search_session_id:i,from:r})}function vu(e,t){t&&k.j(e,"qna_close",{qna_session_id:t.sessionId,qna_session_length:Date.now()-t.startTimestamp})}function bu(e,t,n,o){t&&k.j(e,"qna_inference_start",{qna_session_id:t.sessionId,qna_inference_id:n,is_retry:o})}function yu(e,t,n,o){t&&k.j(e,"qna_inference_end",{qna_session_id:t.sessionId,qna_inference_id:n,time_took:o})}function Su(e,t,n,o){t&&k.j(e,"qna_feedback_given",{qna_session_id:t.sessionId,qna_inference_id:n,feedback:o})}function _u(e,t,n){t&&k.j(e,"qna_result_clicked",{qna_session_id:t.sessionId,clicked_page_id:n})}function wu(e,t){t&&k.j(e,"qna_clear",{qna_session_id:t.sessionId})}function ku(e,t){const n=(0,N.zt)();k.j(e,"workspace_member_number_update",{new_workspace_member_count:t.new_workspace_member_count,origin:t.invite_origin,subscription_tier:n,domain_type:t.domainType,company_segment:(0,O.Ns)()}),E.default.logEvent("workspace_member_number_update",t.new_workspace_member_count,{origin:t.invite_origin,subscription_tier:n,domain_type:t.domainType,company_segment:(0,O.Ns)()})}function Iu(e){const t=(0,N.zt)(),n=(0,C.JF)();k.j(e,"person_property_invite_click_menu_item",{subscription_tier:t,domain_type:n})}function Cu(e){const t=(0,N.zt)(),n=(0,C.JF)();k.j(e,"person_property_invite_render_menu_item",{subscription_tier:t,domain_type:n})}function xu(e,t){const n=(0,N.zt)(),o=(0,C.JF)(),i="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";k.j(e,"person_property_invite_click_invite_button",{subscription_tier:n,domain_type:o,invited_type:i,invited_user_count:t.invited_user_count})}function Tu(e){const t=(0,N.zt)(),n=(0,C.JF)();k.j(e,"person_property_invite_click_upgrade_button",{subscription_tier:t,domain_type:n})}function Mu(e,t){const n=(0,N.zt)(),o=(0,C.JF)();k.j(e,"person_property_invite_guest_invited",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count})}function Pu(e,t){const n=(0,N.zt)(),o=(0,C.JF)();k.j(e,"person_property_invite_member_invited",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count})}function Au(e,t){const n=(0,N.zt)(),o=(0,C.JF)();k.j(e,"person_property_invite_member_requested",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count})}function Ru(e,t){const n=(0,N.zt)(),o=(0,C.JF)(),i="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";k.j(e,"person_property_invite_completed",{subscription_tier:n,domain_type:o,invited_type:i,invited_user_count:t.invited_user_count,is_success:t.is_success})}function Du(e,t){k.j(e,"guest_invite_request_setting_toggled",t)}function Bu(e,t){k.j(e,"settings_deeplink_clicked",t)}function Eu(e,t){k.j(e,"guest_invite_request_resolved",t)}function Fu(e,t){k.j(e,"disable_guest_toggle",t)}},8406:(e,t,n)=>{n.d(t,{$q:()=>f,Ac:()=>S,Rc:()=>g,S$:()=>v,YU:()=>w,_H:()=>l,bW:()=>k,bn:()=>C,gl:()=>m,mH:()=>c,nS:()=>p,qm:()=>_,rv:()=>b,tW:()=>I,tf:()=>x,wd:()=>u,xb:()=>d,y9:()=>h,zF:()=>y});var o=n(34296),i=n(97880),r=n(24215),a=n(75079),s=n(50906);function l(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};s._Hi(t,{...i,...o})}function c(e,t){r.j(e,"collection_create_suggested_property_latency",t)}function d(e){const{environment:t,collectionContextStore:n,view_type:o,view_config_uri:i,...r}=e,l=(0,a.Pn)(n)||{};s.xbC(t,{...l,...r,view_type:o,view_config_uri:i})}function u(e){const{environment:t,collectionContextStore:n,action:o,original_view_type:i,new_view_type:r,new_view_id:l,property_type:c,new_date_shift_mode:d,new_avoid_weekends:u}=e,p=(0,a.Pn)(n);p&&p.view_type&&s.wds(t,{action:o,...p,view_type:p.view_type,original_view_type:i,new_view_type:r,new_view_id:l,property_type:c,new_date_shift_mode:d,new_avoid_weekends:u})}function p(e){const t=(0,a.Pn)(e.collectionContextStore);t&&t.view_type&&s.MU3(e.environment,{from:e.from,from_peek_mode:e.from_peek_mode,...t,view_type:t.view_type})}function m(e){const{peek_mode:t,from_peek_mode:n}=e,o=(0,a.Pn)(e.collectionContextStore);o&&o.view_type&&s.lgT(e.environment,{from:e.from,peek_mode:t,from_peek_mode:n,...o,view_type:o.view_type})}function f(e){const{environment:t,collectionContextStore:n,property:o,from:i,action:r,new_property_type:l,...c}=e,d=n.normalizedSchemaStore.state[o],u=(0,a.Pn)(n)||{};s.$qu(t,{property_type:null==d?void 0:d.type,new_property_type:l,property:o,from:i,action:r,...c,...u})}function g(e){const{environment:t,collectionContextStore:n,view_type:o,from:i,...r}=e,l=(0,a.Pn)(n)||{};s.RcY(t,{from:i,...r,...l,view_type:o})}function h(e){const{environment:t,collectionContextStore:n,property_type:o,from:i,property:r,...l}=e,c=(0,a.Pn)(n)||{};s.y9e(t,{property:r,property_type:o,from:i,...l,...c})}function v(e,t,n){var o,s,l;let c="page_properties";const d=(0,a.Pn)(t);switch(d.view_type){case void 0:case"page":case"table":c="table";break;case"list":c="list";break;case"gallery":c="gallery";break;case"board":c="board";break;case"calendar":c="calendar";break;case"timeline":c="timeline";break;default:(0,i.t1)(d.view_type)}const u={...n,collection_id:null==t||null===(o=t.collectionStore())||void 0===o?void 0:o.id,collection_view_id:null==t||null===(s=t.collectionViewStore())||void 0===s?void 0:s.id,collection_view_block_id:null==t||null===(l=t.collectionViewBlockStore())||void 0===l?void 0:l.id,from:c};r.j(e,"copy_property",u)}function b(e){var t;const{environment:n,collectionContextStore:o,block_id:i,property:r,property_type:l,from:c,isFromBulkActionsToolbar:d,isUnthrottled:u,...p}=e,m=(0,a.Pn)(o)||{};let f;null!==(t=o.currentSubitemFormatStore.state)&&void 0!==t&&t.property?f="subitem":o.currentArrowsByFormatStore.state&&(f="timeline_arrows_by"),s.rvl(n,{block_id:i,property:r,property_type:l,property_context:f,from:c,isFromBulkActionsToolbar:d,...p,...m},u||!1)}function y(e){const{environment:t,collectionContextStore:n,property:o,property_type:i,from:s,isFromBulkActionsToolbar:l,...c}=e,d=(0,a.Pn)(n)||{};r.j(t,"collection_open_block_property_overlay",{property:o,property_type:i,property_context:undefined,from:s,isFromBulkActionsToolbar:l,...c,...d})}function S(e){const{environment:t,collectionContextStore:n,checkbox_type:o,...i}=e,s=(0,a.Pn)(n)||{};r.j(t,"collection_multi_select_checkbox_clicked",{...s,checkbox_type:o,...i})}function _(e){const{environment:t,collectionContextStore:n,property_type:o,num_rows:i}=e,r=(0,a.Pn)(n)||{};s.fMl(t,{property_type:o,num_rows:i,...r})}function w(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};s.YU0(t,{...i,...o})}function k(e){r.j(e,"collections.bypassed_query_collection_request")}function I(e){const{environment:t,totalResults:n,clickedIndex:i,eventName:a,sessionId:s,source:l,queryLength:c}=e;let d;l===o.S.Automation?d="automation_collection_picker":l===o.S.Relation?d="collection_settings_select_relation_source":l===o.S.Source&&(d="collection_settings_source");const u=Boolean(0===c);(0,r.j)(t,a,{source:d,"server-indexAlias":"collection",totalResults:n,clickedIndex:i,sessionId:s,queryLength:c,isEmptyQuery:u})}function C(e){r.j(e,"collection_load_more_blocks")}function x(e){r.j(e,"collection_load_more_groups")}},19719:(e,t,n)=>{n.d(t,{EQ:()=>v,F5:()=>u,GP:()=>w,Jn:()=>I,Q6:()=>k,U0:()=>M,Up:()=>_,Xf:()=>T,Z8:()=>h,_b:()=>d,b2:()=>C,cC:()=>p,gY:()=>f,ix:()=>m,nI:()=>y,pw:()=>S,u_:()=>g,zD:()=>x});var o=n(27328),i=n(82813),r=n(97880),a=n(4761),s=n(17659),l=n(24215),c=n(50906);function d(e){b({...e,target:"archive"})}function u(e){b({...e,target:"unarchive"})}function p(e){b({...e,target:"mark_as_read"})}function m(e){b({...e,target:"frame"})}function f(e){b({...e,target:"open_reply_menu"})}function g(e){b({...e,target:"mark_as_unread"})}function h(e){let{environment:t,pageId:n,isCurrentlyFollowing:o,from:i,notificationId:r}=e;l.j(t,"click_page_updates_notifications_button",{pageId:n,isCurrentlyFollowing:o,from:i,notificationId:r})}function v(e){let{environment:t,backlinkPageId:n,notificationId:o,alreadyRead:i,activity:r,tab:a}=e;b({environment:t,target:"title",notificationId:o,alreadyRead:i,activity:r,tab:a,otherArgs:{backlinkPageId:n}})}function b(e){let{environment:t,target:n,notificationId:o,alreadyRead:r,activity:s,tab:d,otherArgs:u}=e;S({environment:t,target:n});const p=a.ZP.state.sessionId;c.CgP(t,{target:n,notification_id:o,activity_id:s.id,tab:d,sessionId:p,is_filtered:a.ZP.isFilteredToUnreadOnly(),...u}),o&&i.e(l.mc(t),{alreadyRead:r,notificationId:o,activityId:s.id,from:n,sessionId:p})}function y(e){const t=a.ZP.state.sessionId;t&&(l.j(e,"close_sidebar_updates",{sessionId:t,tab:I()}),a.ZP.endSession())}function S(e){let{environment:t,target:n}=e,o=!1;switch(n){case"title":case"body":o=!0;break;case"archive":case"unarchive":case"mark_as_read":case"mark_as_unread":case"add_reaction":case"open_reply_menu":case"frame":o=!1;break;default:(0,r.t1)(n)}o&&y(t)}function _(e){let{environment:t,from:n}=e;const i=(0,o.w_)(t.TabbedRouterStore.state);var r;"web"===(r=i).type&&"nativeTab"===r.route.name&&"updates"===r.route.tab&&w({environment:t,from:n})}function w(e){let{environment:t,forceRestartSession:n,from:o}=e;a.ZP.startSession({forceRestart:n??!1}),c.tmQ(t,{tab:I(),unread_notifications_count:s.aY(),sessionId:a.ZP.state.sessionId,from:o})}function k(e){let{environment:t,activityUpdatesSource:n,filters:o,prevFilters:i}=e;l.j(t,"update_notification_filters",{source:n,prev_date_range_filter_start:i.dateRange.start,prev_date_range_filter_end:i.dateRange.end,prev_activity_types:i.activityTypes,date_range_filter_start:o.dateRange.start,date_range_filter_end:o.dateRange.end,activity_types:o.activityTypes})}function I(){const e=a.ZP.state.currentTab;switch(e){case"mentions":return"mentions_comments";case"archive":return"archive";case"allPages":return"all_updates";default:(0,r.t1)(e)}}function C(e){let{environment:t,action:n,args:o}=e;l.j(t,"push_notification_desktop",{...o,action:n})}function x(e,t){l.j(e,"archive_all_notifications",{...t,onlyRead:"read"===t.readFilter})}function T(e){l.j(e,"mark_all_notifications_as_read")}function M(e,t){l.j(e,"toggle_filter_for_unread_notifications",t)}},91536:(e,t,n)=>{n.d(t,{kM:()=>c,oE:()=>d});var o=n(72126),i=n(26825),r=n(27006),a=n(67669),s=n(28578),l=n(50906);function c(e){let{environment:t,location:n,inSudoMode:o,store:i,newItems:r,fromPermissionWrapper:a}=e;u({store:i,newItems:r}).forEach((e=>{let{role_old_inherited_or_most_permissive:i,role_old_on_page:r,privacy_level:c,old_privacy_level:d,newItem:u}=e;c||d?l.s8J(t,{...u,location:n,in_sudo_mode:o||void 0,role_old_inherited_or_most_permissive:i,role_old_on_page:r,privacy_level:c,old_privacy_level:d,share_menu_session_id:s.ZP.state.sessionId,from_permission_wrapper:a}):l.s8J(t,{...u,location:n,in_sudo_mode:o||void 0,role_old_inherited_or_most_permissive:i,role_old_on_page:r,share_menu_session_id:s.ZP.state.sessionId,from_permission_wrapper:a})}))}function d(e){const{environment:t,calculatedPermissions:n}=e;l.o0U(t,{share_menu_session_id:s.ZP.state.sessionId,page_permission_summary:m(n)})}function u(e){let{store:t,newItems:n}=e;const s=e=>`${e.type}:${i.D3(e)}`,l=t.getPermissionItems(),c=o.KX(l,s),d=a.YO(t).map((e=>e.permissionItem)),u=o.KX(d,s);return n.map((e=>{var t;const n=s(e),o=u[n],i=null===(t=c[n])||void 0===t?void 0:t.role,a=null==o?void 0:o.role;return(0,r.ix)(e)?{newItem:e,role_old_inherited_or_most_permissive:a,role_old_on_page:i,privacy_level:p(e),old_privacy_level:o&&(0,r.ix)(o)?p(o):"private"}:{newItem:e,role_old_inherited_or_most_permissive:a,role_old_on_page:i}}))}function p(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function m(e){const{mostPermissiveSpaceItem:t,mostPermissiveAncestorTeamOwnerItem:n,mostPermissiveAncestorTeamMemberItem:o,pagePermissionUIModel:i}=e,{mostPermissiveGroupPermissions:a,mostPermissiveUserPermissions:s}=i;return{space:t.permissionItem.role,team_owner:null==n?void 0:n.permissionItem.role,team_member:null==o?void 0:o.permissionItem.role,groups:{full_access:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.zz(t)})).length,can_edit:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.VM(t)})).length,can_edit_content:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.WY(t)})).length,can_comment:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.rG(t)})).length,can_view:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.rz(t)})).length},users:{full_access:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.zz(t)})).length,can_edit:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.VM(t)})).length,can_edit_content:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.WY(t)})).length,can_comment:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.rG(t)})).length,can_view:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.rz(t)})).length},privacy_level:p(t.permissionItem)}}},54642:(e,t,n)=>{n.r(t),n.d(t,{activateReferral:()=>Jn,addUserToWaitlist:()=>kl,addUsersToSpace:()=>Xt,addWebClipperFile:()=>lt,addWebClipperURLs:()=>mo,adminAddLinkPreviewToSpace:()=>ul,adminAddPublicEmailDomains:()=>Ri,adminAddZeroRetentionSpace:()=>Et,adminAllowlistCreditDomain:()=>Ao,adminBanUser:()=>ka,adminBlockEmailDomain:()=>Fr,adminBulkAddPromotionCodes:()=>xr,adminBulkApplyPromotionCodes:()=>Pr,adminBulkBanUsers:()=>Ia,adminBulkCreateTimedTrials:()=>Vs,adminBulkRemoveSpaceGuests:()=>Tr,adminBulkUpgradeEduPlusUser:()=>Ar,adminBypassEmailReputationChecks:()=>Go,adminCancelSubscription:()=>gi,adminChangeEmail:()=>_i,adminCheckHIPAAComplianceStatus:()=>Ft,adminCheckStatsigSegment:()=>To,adminClaimAndUpgradeForSalesAssisted:()=>Ma,adminContentSearch:()=>us,adminCopyPageBetweenEnvironments:()=>jr,adminCountWordsInPage:()=>Vr,adminCreateMarketingRoute:()=>wa,adminDelayClaimSpaceDeletion:()=>Pa,adminDeleteFileFromS3:()=>fr,adminDeleteSpaces:()=>Wt,adminDeleteUser:()=>Bt,adminDescribeAccountsToReset:()=>qt,adminDescribeDeleteFileFromS3:()=>gr,adminDescribeDeletedBlockPermissions:()=>_r,adminDescribeEditSpacePermission:()=>Ut,adminDescribeRestoreDeletedGuestPermissions:()=>dl,adminDescribeRunSpaceConsolidation:()=>Ht,adminDescribeSpacesToDelete:()=>zt,adminDisableReverifyForUser:()=>Nt,adminDowngradeFraudSubscription:()=>Ga,adminEditBlockPermissions:()=>Lt,adminEditSpacePermissions:()=>Vt,adminEditTeamMembership:()=>$t,adminExplainPaymentStatus:()=>Gs,adminFindDeletedUser:()=>Po,adminForceResyncExternalObjects:()=>ya,adminGetBulkIds:()=>Ks,adminGetBulkSpaceIdsByDomain:()=>jo,adminGetBulkSpaceIdsByEmail:()=>Vo,adminGetBulkUserIdsByEmail:()=>Uo,adminGetClientExperiments:()=>Io,adminGetDataAccessConsent:()=>Lo,adminGetDomainClaimEligibleSpaces:()=>xa,adminGetDomainManagementSettings:()=>Ta,adminGetIntegrationData:()=>fa,adminGetOwnership:()=>dr,adminGetPublicPages:()=>Hr,adminGetRateLimits:()=>ur,adminGetSamlConfig:()=>pr,adminGetSlackIntegrationData:()=>ha,adminGetSpaceMembershipUpdates:()=>js,adminGetSpacesForAllowedEmailDomain:()=>hr,adminGetStatsigExperiment:()=>Co,adminGetStatsigFeatureGate:()=>xo,adminGetSyncedDatabaseData:()=>va,adminGetUserBillingInformation:()=>qo,adminGetWorkspaceWebhookSubscriptions:()=>Il,adminIsSpaceDomainClaimEligible:()=>Ca,adminIsWorkspaceInQnA:()=>yl,adminJoinSpacesForOauthRedirect:()=>ba,adminListData:()=>Zt,adminMergeUsers:()=>Sl,adminModifyBlock:()=>yr,adminOnboardAISlackQnA:()=>Gt,adminOptOutNotionAIDataSharing:()=>Hs,adminPrimaryWorkspaceChange:()=>mr,adminReadBlockPermissions:()=>jt,adminRecoverMfa:()=>Ho,adminReleaseSubscriptionSchedule:()=>Bs,adminRemoveAllowedEducationEmails:()=>Mr,adminRemoveChildFromExternalCollection:()=>Aa,adminRemoveSpaceUsersAndTransferContent:()=>Wo,adminResetAccounts:()=>Kt,adminResetRateLimits:()=>vr,adminRestoreBlock:()=>Sr,adminRestoreDeletedCollectionProperties:()=>Wr,adminRestoreDeletedGuestPermissions:()=>cl,adminRunSpaceConsolidation:()=>Ra,adminSamlConfigForSpace:()=>Ko,adminSearchBlocks:()=>Oo,adminSearchCollections:()=>zo,adminSearchForUsersInSpaces:()=>Zo,adminSearchPermanentlyDeletedPages:()=>Zr,adminSearchSpaceActivity:()=>Lr,adminSearchSpaces:()=>Fo,adminSearchTeams:()=>No,adminSearchUsers:()=>ko,adminSetDisableSpacePublicAccess:()=>Ci,adminSetPageContentClassification:()=>Ot,adminSetSpaceDomain:()=>xi,adminSetupExperiment:()=>pi,adminShowCustomerInvoice:()=>Di,adminSwapUserDomains:()=>Bi,adminSwapUserEmails:()=>Ei,adminUpdateAddOnSubscription:()=>Ds,adminUpdateExperiment:()=>ui,adminUpdateIntegrationData:()=>ga,adminUpdateNotionAIAvailabilityForSpace:()=>Ls,adminUpdatePaymentStatus:()=>$s,adminUpdateStatsigSegmentIds:()=>Mo,adminUpdateSubscription:()=>fi,adminUpdateTeamMember:()=>Qt,adminUpdateUserSettings:()=>Yt,adminViewDeletedCollectionProperties:()=>qr,adminViewExperiments:()=>di,aiSourcePicker:()=>Kr,allowEducationEmails:()=>hi,annotateRecentIntercomConversation:()=>br,applyCustomerOffer:()=>es,authCreateBackupCodes:()=>Is,authCreateSms:()=>St,authCreateTotp:()=>_s,authGetLoginConfiguration:()=>ut,authSendSms:()=>wt,authUpdateMfa:()=>It,authVerifyBackupCodesLogin:()=>Cs,authVerifyPassword:()=>xs,authVerifySmsEnroll:()=>_t,authVerifySmsLogin:()=>kt,authVerifyTotpEnroll:()=>ks,authVerifyTotpLogin:()=>ws,authWithAsana:()=>eo,authWithEvernote:()=>go,authWithExternalIntegration:()=>ao,authWithGoogleForDrive:()=>ro,authWithSlack:()=>io,authWithTrello:()=>oo,authenticateConfluenceUser:()=>Ee,authenticateMondayUser:()=>Fe,calculateTax:()=>Rr,cancelSpaceDeletionForDomain:()=>qa,cancelSubscription:()=>Re,changeEmail:()=>bt,checkFilePermission:()=>Fn,checkSpaceDomain:()=>Dr,claimAndUpgradeSpace:()=>Na,completeMultipartUpload:()=>$a,createDomainVerificationCode:()=>Ea,createEmailUser:()=>fe,createOauthAuthorizationCode:()=>zr,createSpace:()=>Ii,createTeam:()=>ia,deleteBlocks:()=>rn,deleteBot:()=>Br,deleteDomainVerificationCode:()=>Da,deleteGroup:()=>hn,deleteIntegration:()=>Er,deleteManagedUser:()=>Xo,deleteSpace:()=>Pt,deleteSpaceForDomain:()=>Wa,deleteUser:()=>At,disableUserAnalytics:()=>Hn,disconnectAsana:()=>mt,disconnectConfluence:()=>Ve,disconnectDrive:()=>ht,disconnectEvernote:()=>gt,disconnectMonday:()=>Ue,disconnectTrello:()=>ft,duplicateBlock:()=>te,enableTeams:()=>Dt,enqueueTask:()=>et,exportAdminContentSearch:()=>Nn,exportAuditLog:()=>jn,exportBlock:()=>Xe,exportBlockPreview:()=>So,exportContentAnalytics:()=>On,exportDomainClaimableSpaces:()=>Vn,exportSpace:()=>Ln,exportSpaceGuests:()=>hl,exportSpaceMembers:()=>gl,exportUserAnalytics:()=>Un,finalizeAppTemplate:()=>wo,findUser:()=>oe,getAIUsageEligibility:()=>Es,getAboutNotionDevelopers:()=>hs,getAccessRequests:()=>ji,getActiveExportTasks:()=>qs,getActiveImportTasks:()=>ne,getActivityLog:()=>vt,getAdminHistory:()=>lr,getAllTeamsInSpaceForAdmin:()=>la,getAsanaAccount:()=>$,getAsanaWorkspaces:()=>K,getAsanaWorkspacesNames:()=>J,getAssetsJson:()=>W,getAssetsJsonV2:()=>q,getAssetsJsonV3:()=>G,getAssistantLogs:()=>xe,getAuthorizedEmailPreferenceCenterLink:()=>Ui,getAvailableCountries:()=>or,getBacklinksForBlock:()=>Ct,getBillingHistory:()=>Zn,getBlockAdminApiLog:()=>sr,getBlockFileDownloadUrl:()=>ue,getBookmarks:()=>on,getBotToken:()=>xt,getBots:()=>qn,getClientExperiments:()=>li,getClientExperimentsV2:()=>ci,getCollectionViewBlocksByAppId:()=>Ya,getCompletion:()=>no,getCompletionForProperty:()=>Fs,getCompletionForSelectOption:()=>Zs,getConfluenceAccount:()=>je,getConfluenceSpaces:()=>Le,getConnectedAppsStatus:()=>to,getContentEngagementAnalytics:()=>rs,getCostForSpaceUpgrade:()=>Oa,getCsatMilestones:()=>Wi,getCustomerOffer:()=>Xa,getDailyUsersAnalytics:()=>os,getDataAccessConsent:()=>zi,getDataAccessConsentForManagedUser:()=>ni,getDesktopAppRegistration:()=>ys,getDesktopDownloadUrl:()=>Ae,getDeveloperBotsAndIntegrations:()=>kr,getDomainVerificationCodesForSpace:()=>Fa,getEmailDomainSettings:()=>ri,getEmailDomainsForSpace:()=>Qo,getEmailsWithoutAccessToBlock:()=>Yr,getEvernoteAccount:()=>Q,getEvernoteNotebooks:()=>uo,getExternalCollectionSyncState:()=>Qr,getExternalIntegrationAccessToken:()=>ts,getExternalIntegrations:()=>Ur,getExternalNotificationChannels:()=>ds,getExternalOrgData:()=>wl,getGenericEmbedBlockData:()=>yi,getGeoIpLocation:()=>Us,getGiphyRandomId:()=>Bo,getGoogleDriveAccounts:()=>so,getHarmonicData:()=>_e,getHistoricalAuditLogUsers:()=>ce,getIdFromUniqueId:()=>Ps,getInAppCategoriesAndTemplates:()=>Rs,getInferenceTestExamples:()=>ms,getIntegrationDataForGallery:()=>ua,getIntegrationDomainVerifications:()=>Ir,getIntegrationIdsForGallery:()=>pa,getIntegrationSecret:()=>Cr,getInvoiceData:()=>Jt,getJoinableSpaces:()=>tn,getLivestormEvents:()=>Me,getLivestormSessions:()=>Pe,getLoginOptions:()=>dt,getManagedUsers:()=>Yo,getMondayFoldersAndBoards:()=>Ne,getMondayUser:()=>Ze,getMondayWorkspaces:()=>Oe,getNextRelabelingTask:()=>Ce,getNotificationLog:()=>bn,getNotificationLogV2:()=>yn,getPageAnalytics:()=>Ja,getPageAssistantPreferences:()=>sl,getPageVisitors:()=>Gi,getPrivatePageInfo:()=>ca,getPromoCode:()=>bi,getPublicApiObject:()=>Ss,getPublicPageData:()=>Rt,getPublicSpaceData:()=>An,getPublishedPagesForUser:()=>bl,getRecentPageVisits:()=>me,getRecoverableSpaceUserContent:()=>Sa,getSamlConfigForSpace:()=>$o,getSamlRedirect:()=>pt,getSelectPropertyValues:()=>vn,getSignedFileUrl:()=>Dl,getSkillsInSpace:()=>Ie,getSnapshotContents:()=>Qn,getSnapshotsList:()=>$n,getSpaceAdminApiLog:()=>ar,getSpaceMembershipUpdates:()=>nl,getSpaces:()=>nn,getSpacesCreatedByUserWithDomains:()=>Va,getSubitems:()=>H,getSubscriptionData:()=>De,getTasks:()=>Zi,getTeamAccessRequestMetadata:()=>Os,getTeams:()=>sa,getTeamsAndProjectsInAsanaWorkspace:()=>X,getTemplateChecklistForBlock:()=>qi,getTemplateCreator:()=>Ys,getTemplateSearchResults:()=>Qs,getTestFlightStatus:()=>Li,getTransitivePageRelations:()=>Ws,getTrelloAccount:()=>Y,getTrelloBoards:()=>ee,getTypedDatabases:()=>Qa,getUniversitiesAndDomains:()=>fl,getUnreadAccessRequestCount:()=>Vi,getUnvisitedNotificationIds:()=>Sn,getUploadFileUrl:()=>Mt,getUserAdminApiLog:()=>rr,getUserAnalyticsSettings:()=>sn,getUserContractionData:()=>ol,getUserEngagementAnalytics:()=>is,getUserHomePages:()=>nr,getUserNotifications:()=>Cn,getUserSharedPagesInSpace:()=>er,getUserSignals:()=>tr,getUserSpaceExternalBots:()=>Nr,getUserTasks:()=>Fi,getVerifiedEmailDomain:()=>cs,getVisibleUsers:()=>Be,getWebClipperData:()=>po,getWebhookSubscriptions:()=>Gn,getZendeskTicketConversation:()=>Or,handleRecordMapForResponse:()=>F,identifySegmentUser:()=>kn,identifySegmentWorkspace:()=>wn,importAsana:()=>Ke,importAsanaIntoBetterTemplate:()=>$e,importConfluenceExport:()=>He,importEvernote:()=>Je,importFile:()=>ze,importTrello:()=>Ge,initializeGoogleDriveBlock:()=>lo,initializePageTemplate:()=>_o,initializeUserAnalytics:()=>Dn,initializeUserAnalyticsEmptySync:()=>Bn,initiateMultipartUpload:()=>Ka,initiateWorkspaceTransfer:()=>Ua,invalidateSubscriptionData:()=>ir,inviteGuestsToSpace:()=>Pi,isEligibleForGuestMembershipRequest:()=>fs,isEmailEducation:()=>vi,isRecordKeyAvailable:()=>Ms,isUserDomainJoinable:()=>Si,leaveBlock:()=>Pn,listExternalCollections:()=>na,listExternalObjects:()=>oa,listPrices:()=>be,loadBlockSubtree:()=>Rn,loadCachedPageChunk:()=>dn,loadCachedPageChunkBatched:()=>xl,loadCachedPageChunks:()=>un,loadContacts:()=>vs,loadContentAnalytics:()=>ss,loadPageChunk:()=>pn,loadSearchAnalytics:()=>ls,loadUserContent:()=>cn,loadWorkspaceAnalyticsUsers:()=>as,loginWithAppleAuth:()=>tt,loginWithAppleNativeAuth:()=>nt,loginWithEmail:()=>ot,loginWithGoogleAuth:()=>rt,loginWithGoogleJwt:()=>it,logout:()=>at,logoutActiveSessions:()=>ki,logoutManagedUsers:()=>ai,markDiscussionNotificationsRead:()=>da,moveToSpace:()=>Mi,parallelAsanaImport:()=>Qe,parallelImportConfluenceExport:()=>We,parallelImportConfluenceViaApi:()=>qe,parallelMondayImport:()=>Ye,pendingTaskEventsById:()=>Bl,pendingTaskIds:()=>N,performAiSearch:()=>ke,ping:()=>vo,postGiphyAnalytics:()=>Eo,previewMidtermSubscriptionChanges:()=>ye,processShareActionToBlock:()=>Jr,publishAiSession:()=>vl,queryCollection:()=>mn,queryCollectionStream:()=>fn,recordCookieConsent:()=>ma,recordPageExit:()=>$i,recordPageVisit:()=>Ki,recoverSpace:()=>bo,recoverUser:()=>ho,refetchExternalObjectInstanceBlocks:()=>ta,refreshGoogleDriveBlock:()=>co,refreshInviteLink:()=>Ai,registerDesktopApp:()=>bs,releaseSubscriptionSchedule:()=>ve,removeManagedUserFromSpace:()=>ii,removeUsersFromSpace:()=>en,renameGroup:()=>gn,reportBadQnA:()=>le,reportBadSearch:()=>se,reportPage:()=>cr,requestAccess:()=>Oi,requestClaimAndUpgrade:()=>za,resetExperimentOverrides:()=>ea,resetPasswordsForManagedUsers:()=>si,resolveAccessRequest:()=>_l,resolveAddress:()=>wr,restoreBlock:()=>an,restoreSnapshot:()=>Yn,resubscribeExternalCollection:()=>$r,revokeBotToken:()=>Tt,revokeUserTokens:()=>yo,saveAssistantFeedback:()=>we,saveRelabelingTaskFeedback:()=>Te,saveTransactions:()=>Ti,search:()=>ie,searchAuditLog:()=>re,searchContacts:()=>ae,searchGiphyImages:()=>Do,searchIntegrations:()=>de,searchUnsplashImages:()=>Ro,searchVectors:()=>ps,searchWebClipperPages:()=>fo,sendEmailVerification:()=>yt,sendTemporaryPassword:()=>ct,sendVerifyTransferEmail:()=>ns,setAdminPrivilegedTeamMembership:()=>ra,setBookmarkMetadata:()=>Xn,setDataAccessConsent:()=>Hi,setDataAccessConsentForManagedUser:()=>oi,setLocale:()=>pe,setNotificationsAsRead:()=>In,setPageAssistantPreferences:()=>ll,setPageNotificationsAsRead:()=>xn,setPassword:()=>wi,setRecordKey:()=>Ts,setSamlConfig:()=>ja,setSeenGuestMembershipRequests:()=>gs,setSpaceNotificationsAsRead:()=>Tn,spaceAdminRestoreAccess:()=>Qi,stripeAdvanceTestClock:()=>Ns,stripeGetTestClock:()=>zs,submitCsatFeedback:()=>Ni,submitEducationGroupApplication:()=>ml,submitFormstack:()=>Se,submitTemplate:()=>Js,submitTemplateCreator:()=>Xs,suggestRecordKey:()=>As,syncRecordValue:()=>Ml,syncRecordValues:()=>ln,testCreatePage:()=>rl,testDeleteRecord:()=>al,testSetupWorkspace:()=>il,testWebhookConnection:()=>Kn,trackConversionEvent:()=>Yi,trackSegmentEvent:()=>_n,transferPermissionGroup:()=>zn,transferSpaceUserContent:()=>_a,transferWorkspaceToUser:()=>Ha,unfurlUrl:()=>Gr,unsubscribeFromEmails:()=>Mn,unsubscribeFromIntercomEmails:()=>Wn,updateDisableGuestsOnSpace:()=>pl,updateEmailDomainSettings:()=>ei,updateExperimentOverride:()=>Xr,updatePaymentMethod:()=>he,updatePublicHomePage:()=>Xi,updateSpaceDomain:()=>Ji,updateSubscription:()=>ge,updateSubscriptionToEducationPlan:()=>mi,updateTeamMembers:()=>aa,updateUserProfile:()=>ti,updateUserSuspension:()=>Jo,updateWorkspaceCreationForEmailDomains:()=>Za,validateTemplate:()=>el,validateTemplateCreatorHandle:()=>tl,validateUserCanCreateWorkspace:()=>La,verifyDomain:()=>Ba,verifyEmail:()=>st});n(57658);var o=n(39593),i=n.n(o),r=n(28084),a=n(54064),s=n(43593),l=n(68626),c=n(59730),d=n(74229),u=n(72126),p=n(59753),m=n(45953),f=n(606),g=n(89101),h=n(32739),v=n(63143),b=n(95477),y=n(23823),S=n(33954),_=n(24608),w=n(33929),k=n(18514),I=n(80444),C=n(88632),x=n(79167),T=n(77144),M=n(33759),P=n(50906),A=n(47307),R=n(97977),D=n(4408),B=n(75018),E=n(61202);function F(e){const{environment:t,eventName:n,response:o,userId:i}=e;if(o&&o.recordMap){const e=m.PF.create(o.recordMap);"syncRecordValues"!==n&&D.fL({environment:t,userId:i,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,recordMap:e,maybeStaleRecordMap:"loadCachedPageChunk"===n||"loadCachedPageChunks"===n,debugSource:"handleRecordMapForResponse"})}}let Z;async function L(e,t,n,o){if((0,c.tn)(n.body)){A.showError(n);const t=n.body.clientData&&(0,S.cq)(n.body.clientData);P.$eA(e,{type:null==t?void 0:t.type})}if(n.offline)return n;console.error(n.error);const{RouterStore:i}=e;if(401===n.status&&l.log({level:"error",from:"api",type:"httpTrigger401",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:n},routeName:i.state.route.name}}),403===n.status&&n.headers["content-type"]&&n.headers["content-type"].startsWith("text/html")&&l.logWithSampleRate({logMessage:{level:"error",from:"api",type:"httpTrigger403",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:n},userId:e.currentUser.id,routeName:i.state.route.name}},samplePercentage:1}),401===n.status&&Boolean(n.body&&n.body.errorId)&&e.currentUser.isLoggedIn())switch(i.state.route.name){case"page":if((0,k.Sr)()){await R.actuallyLogoutAndDeleteAllLocalData({environment:e,nextLocation:window.location.pathname});break}case"root":case"space":case"onboarding":case"myIntegrations":case"inAppTemplateSubmission":case"inAppTemplateCreatorSubmission":case"studentGroupSignup":if(o&&o===e.currentUser.id){const t=u.Ds((async()=>await R.actuallyLogoutAndDeleteAllLocalData({environment:e,userId:o,doNotRedirect:!0})),1e3);await t();!function(e,t){if((0,c.Jx)(t.body)&&"saml_sso_required"===t.body.clientData.type){const e=(0,S.wf)(w.default.getIntl(),t);M.Z.setState({...M.Z.state,loginType:"saml",alert:e})}B.navigate({environment:e,url:g._j.login})}(await R.clearCurrentUser(e),n)}}return n}async function j(e){const{environment:t,eventName:n,data:o,userId:i,tracking:r,abortSignal:a,prefetchCacheKey:s,encoding:c}=e;!function(e){for(const t of Object.keys(e)){const n=e[t];(u.Ft(n)||u.o8(n))&&delete e[t]}}(o);const d=i||t.currentUser.id,p=(0,y.yX)({environment:t,eventName:n,data:o,activeUserId:d,tracking:r,abortSignal:a,encoding:c});let m;s&&t.prefetchCache&&(m=t.prefetchCache.getPrefetchedHttpRequest(s,p,a)),m||(m=(0,_.ZP)(p)),T.Z.incrementNumApiCallsInitiated();const f=await m;return T.Z.incrementNumApiCallsCompleted(),"success"===f.type?(F({environment:t,eventName:n,response:f.data,userId:d}),function(e){const{environment:t,responseUserId:n,eventName:o}=e;if(!n)return;if("saveTransactions"!==o)return;const{id:i}=t.currentUser;if(n!==i){if(Z===n)return;const{currentUserStore:e,currentUserRootStore:t,currentUserSettingsStore:r,currentSpaceViewStore:a}=I.default.state,s=i||"<undefined>",c=`currentUser ${s} didn't match user's cookie ${n}`;l.log({from:"client/api",level:"error",type:"currentUserWrong",data:{eventName:o,miscDataToConvertToString:{responseUserId:n,connectionStoreState:C.Z.state,currentUserId:s,userStoreId:e&&e.id,userRootStoreId:t&&t.id,userSettingsStoreId:r&&r.id,currentSpaceViewStoreParentId:a&&a.getParentId()},message:c}}),Z=n}else Z=void 0}({environment:t,eventName:n,responseUserId:f.headers["X-Notion-User-Id"]}),f):L(t,n,f,d)}function V(e){return function(t,n,o,i,r,a,s){return j({environment:t,eventName:e,data:n,userId:o,tracking:i,abortSignal:r,prefetchCacheKey:a,encoding:s})}}function U(e){return async function(t,n,o,i){const r=o||t.currentUser.id,a=(0,y.tZ)({environment:t,eventName:e,data:n,activeUserId:r,tracking:i,abortSignal:void 0,format:"jsonStream"}),s=await(0,_.ZP)(a);return"failed"===s.type?L(t,e,s,r):(d.H1.is(s.data)?s.data=d.H1.filter(s.data,(e=>"recordValue"!==e.type||(function(e){const{environment:t,streamItem:n,userId:o}=e,{pointer:i,value:r,role:a}=n;D.Wl({environment:t,userId:o,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:i,model:p.kk.fromValue(i.table,r),role:a,updatePaths:[[]],maybeStaleRecordMap:!1,debugSource:"handleRecordStreamForResponse"})}({environment:t,streamItem:e,userId:r}),!1))):F({environment:t,eventName:e,response:s.data,userId:r}),s)}}const O=async function(e){return new Promise(((t,n)=>{Bl.addOnceListener(e,(e=>{t(e)}))}))},N=new Set,z=function(e){return async function*(t,n){const o={task:{eventName:e,request:n}},i=await et(t,o);if("failed"===i.type)yield{error:i.error,taskStatus:"not_started"};else{const{taskId:o}=i.data;for(N.add(o);;){const i=await O(o);if("success"===i.state){const n=i.status;F({environment:t,eventName:e,response:n}),yield{value:n,taskStatus:i.state};break}if("failure"===i.state){yield{error:new c.hm(i.error||"Something went wrong.",{eventName:e,request:n},i.clientData),taskStatus:i.state};break}"in_progress"===i.state&&i.status&&(yield{value:i.status,taskStatus:i.state})}}}},H=V("getSubitems"),W=V("getAssetsJson"),q=V("getAssetsJsonV2"),G=V("getAssetsJsonV3"),K=V("getAsanaWorkspaces"),$=V("getAsanaAccount"),Q=V("getEvernoteAccount"),Y=V("getTrelloAccount"),J=V("getAsanaWorkspacesNames"),X=V("getTeamsAndProjectsInAsanaWorkspace"),ee=V("getTrelloBoards"),te=z("duplicateBlock"),ne=V("getActiveImportTasks"),oe=V("findUser"),ie=V("search"),re=V("searchAuditLog"),ae=V("searchContacts"),se=V("reportBadSearch"),le=V("reportBadQnA"),ce=V("getHistoricalAuditLogUsers"),de=V("searchIntegrations"),ue=V("getBlockFileDownloadUrl"),pe=V("setlocale"),me=V("getRecentPageVisits"),fe=V("createEmailUser"),ge=V("updateSubscription"),he=V("updatePaymentMethod"),ve=V("releaseSubscriptionSchedule"),be=V("listPrices"),ye=V("previewMidtermSubscriptionChanges"),Se=V("submitFormstack"),_e=V("getHarmonicData"),we=V("saveAssistantFeedback"),ke=V("performAiSearch"),Ie=V("getSkillsInSpace"),Ce=V("getNextRelabelingTask"),xe=V("getAssistantLogs"),Te=V("saveRelabelingTaskFeedback"),Me=V("getLivestormEvents"),Pe=V("getLivestormSessions"),Ae=V("getDesktopDownloadUrl"),Re=V("cancelSubscription"),De=V("getSubscriptionData"),Be=V("getVisibleUsers"),Ee=V("authenticateConfluenceUser"),Fe=V("authenticateMondayUser"),Ze=V("getMondayUser"),Le=V("getConfluenceSpaces"),je=V("getConfluenceAccount"),Ve=V("disconnectConfluence"),Ue=V("disconnectMonday"),Oe=V("getMondayWorkspaces"),Ne=V("getMondayFoldersAndBoards"),ze=z("importFile"),He=z("importConfluenceExport"),We=z("parallelImportConfluenceExport"),qe=z("parallelImportConfluenceViaApi"),Ge=z("importTrello"),Ke=z("importAsana"),$e=z("importAsanaIntoBetterTemplate"),Qe=z("parallelAsanaImport"),Ye=z("parallelMondayImport"),Je=z("importEvernote"),Xe=z("exportBlock"),et=V("enqueueTask"),tt=V("loginWithAppleAuth"),nt=V("loginWithAppleNativeAuth"),ot=V("loginWithEmail"),it=V("loginWithGoogleJwt"),rt=V("loginWithGoogleAuth"),at=V("logout"),st=V("verifyEmail"),lt=V("addWebClipperFile"),ct=V("sendTemporaryPassword"),dt=V("getLoginOptions"),ut=V("authGetLoginConfiguration"),pt=V("getSamlRedirect"),mt=V("disconnectAsana"),ft=V("disconnectTrello"),gt=V("disconnectEvernote"),ht=V("disconnectDrive"),vt=V("getActivityLog"),bt=V("changeEmail"),yt=V("sendEmailVerification"),St=V("authCreateSms"),_t=V("authVerifySmsEnroll"),wt=V("authSendSms"),kt=V("authVerifySmsLogin"),It=V("authUpdateMfa"),Ct=V("getBacklinksForBlock"),xt=V("getBotToken"),Tt=V("revokeBotToken"),Mt=V("getUploadFileUrl"),Pt=z("deleteSpace"),At=V("deleteUser"),Rt=V("getPublicPageData"),Dt=V("enableTeams"),Bt=V("adminDeleteUser"),Et=V("adminAddZeroRetentionSpace"),Ft=V("adminCheckHIPAAComplianceStatus"),Zt=V("adminListData"),Lt=V("adminEditBlockPermissions"),jt=V("adminReadBlockPermissions"),Vt=V("adminEditSpacePermissions"),Ut=V("adminDescribeEditSpacePermission"),Ot=V("adminSetPageContentClassification"),Nt=V("adminDisableReverifyForUser"),zt=V("adminDescribeSpacesToDelete"),Ht=V("adminDescribeRunSpaceConsolidation"),Wt=V("adminDeleteSpaces"),qt=V("adminDescribeAccountsToReset"),Gt=V("adminOnboardAISlackQnA"),Kt=V("adminResetAccounts"),$t=V("adminEditTeamMembership"),Qt=V("adminUpdateTeamMember"),Yt=V("adminUpdateUserSettings"),Jt=V("getInvoiceData"),Xt=V("addUsersToSpace"),en=V("removeUsersFromSpace"),tn=V("getJoinableSpaces"),nn=V("getSpaces"),on=V("getBookmarks"),rn=V("deleteBlocks"),an=V("restoreBlock"),sn=V("getUserAnalyticsSettings"),ln=V("syncRecordValues"),cn=V("loadUserContent"),dn=V("loadCachedPageChunk"),un=V("loadCachedPageChunks"),pn=V("loadPageChunk"),mn=V("queryCollection"),fn=U("queryCollection"),gn=z("renameGroup"),hn=z("deleteGroup"),vn=V("getSelectPropertyValues"),bn=V("getNotificationLog"),yn=V("getNotificationLogV2"),Sn=V("getUnvisitedNotificationIds"),_n=V("trackSegmentEvent"),wn=V("identifySegmentWorkspace"),kn=V("identifySegmentUser"),In=V("setNotificationsAsRead"),Cn=V("getUserNotifications"),xn=V("setPageNotificationsAsRead"),Tn=V("setSpaceNotificationsAsRead"),Mn=V("unsubscribeFromEmails"),Pn=V("leaveBlock"),An=V("getPublicSpaceData"),Rn=V("loadBlockSubtree"),Dn=V("initializeUserAnalytics"),Bn=V("initializeUserAnalyticsEmptySync"),En=V("getSignedFileUrls"),Fn=V("checkFilePermission"),Zn=V("getBillingHistory"),Ln=z("exportSpace"),jn=z("exportAuditLog"),Vn=z("exportDomainClaimableSpaces"),Un=z("exportUserAnalytics"),On=z("exportContentAnalytics"),Nn=z("exportAdminContentSearch"),zn=V("transferPermissionGroup"),Hn=V("disableUserAnalytics"),Wn=V("unsubscribeFromIntercomEmails"),qn=V("getBots"),Gn=V("getWebhookSubscriptions"),Kn=V("testWebhookConnection"),$n=V("getSnapshotsList"),Qn=V("getSnapshotContents"),Yn=z("restoreSnapshot"),Jn=V("activateReferral"),Xn=V("setBookmarkMetadata"),eo=V("authWithAsana"),to=V("getConnectedAppsStatus"),no=U("getCompletion"),oo=V("authWithTrello"),io=V("authWithSlack"),ro=V("authWithGoogleForDrive"),ao=V("authWithExternalIntegration"),so=V("getGoogleDriveAccounts"),lo=V("initializeGoogleDriveBlock"),co=V("refreshGoogleDriveBlock"),uo=V("getEvernoteNotebooks"),po=V("getWebClipperData"),mo=V("addWebClipperURLs"),fo=V("searchWebClipperPages"),go=V("authWithEvernote"),ho=V("recoverUser"),vo=V("ping"),bo=V("recoverSpace"),yo=V("revokeUserTokens"),So=V("exportBlockPreview"),_o=V("initializePageTemplate"),wo=V("finalizeAppTemplate"),ko=V("adminSearchUsers"),Io=V("adminGetClientExperiments"),Co=V("adminGetStatsigExperiment"),xo=V("adminGetStatsigFeatureGate"),To=V("adminCheckStatsigSegment"),Mo=V("adminUpdateStatsigSegmentIds"),Po=V("adminFindDeletedUser"),Ao=V("adminAllowlistCreditDomain"),Ro=V("searchUnsplashImages"),Do=V("searchGiphyImages"),Bo=V("getGiphyRandomId"),Eo=V("postGiphyAnalytics"),Fo=V("adminSearchSpaces"),Zo=V("adminSearchForUsersInSpaces"),Lo=V("adminGetDataAccessConsent"),jo=V("adminGetBulkSpaceIdsByDomain"),Vo=V("adminGetBulkSpaceIdsByEmail"),Uo=V("adminGetBulkUserIdsByEmail"),Oo=V("adminSearchBlocks"),No=V("adminSearchTeams"),zo=V("adminSearchCollections"),Ho=V("adminRecoverMfa"),Wo=V("adminRemoveSpaceUsersAndTransferContent"),qo=V("adminGetUserBillingInformation"),Go=V("adminBypassEmailReputationChecks"),Ko=V("adminSamlConfigForSpace"),$o=V("getSamlConfigForSpace"),Qo=V("getEmailDomainsForSpace"),Yo=V("getManagedUsers"),Jo=V("updateUserSuspension"),Xo=V("deleteManagedUser"),ei=V("updateEmailDomainSettings"),ti=V("updateUserProfile"),ni=V("getDataAccessConsentForManagedUser"),oi=V("setDataAccessConsentForManagedUser"),ii=V("removeManagedUserFromSpace"),ri=V("getEmailDomainSettings"),ai=V("logoutManagedUsers"),si=V("resetPasswordsForManagedUsers"),li=V("getClientExperiments"),ci=V("getClientExperimentsV2"),di=V("adminViewExperiments"),ui=V("adminUpdateExperiment"),pi=V("adminSetupExperiment"),mi=V("updateSubscriptionToEducationPlan"),fi=V("adminUpdateSubscription"),gi=V("adminCancelSubscription"),hi=V("allowEducationEmails"),vi=V("isEmailEducation"),bi=V("getPromoCode"),yi=V("getGenericEmbedBlockData"),Si=V("isUserDomainJoinable"),_i=V("adminChangeEmail"),wi=V("setPassword"),ki=V("logoutActiveSessions"),Ii=V("createSpace"),Ci=V("adminSetDisableSpacePublicAccess"),xi=V("adminSetSpaceDomain"),Ti=V("saveTransactions"),Mi=z("moveToSpace"),Pi=V("inviteGuestsToSpace"),Ai=V("refreshInviteLink"),Ri=V("adminAddPublicEmailDomains"),Di=V("adminShowCustomerInvoice"),Bi=V("adminSwapUserDomains"),Ei=V("adminSwapUserEmails"),Fi=V("getUserTasks"),Zi=V("getTasks"),Li=V("getTestFlightStatus"),ji=V("getAccessRequests"),Vi=V("getUnreadAccessRequestCount"),Ui=V("getAuthorizedEmailPreferenceCenterLink"),Oi=V("requestAccess"),Ni=V("submitCsatFeedback"),zi=V("getDataAccessConsent"),Hi=V("setDataAccessConsent"),Wi=V("getCsatMilestones"),qi=V("getTemplateChecklistForBlock"),Gi=V("getPageVisitors"),Ki=V("recordPageVisit"),$i=V("recordPageExit"),Qi=V("spaceAdminRestoreAccess"),Yi=V("trackConversionEvent"),Ji=V("updateSpaceDomain"),Xi=V("updatePublicHomePage"),er=V("getUserSharedPagesInSpace"),tr=V("getUserSignals"),nr=V("getUserHomePages"),or=V("getAvailableCountries"),ir=V("invalidateSubscriptionData"),rr=V("getUserAdminApiLog"),ar=V("getSpaceAdminApiLog"),sr=V("getBlockAdminApiLog"),lr=V("getAdminHistory"),cr=V("reportPage"),dr=V("adminGetOwnership"),ur=V("adminGetRateLimits"),pr=V("adminGetSamlConfig"),mr=V("adminPrimaryWorkspaceChange"),fr=V("adminDeleteFileFromS3"),gr=V("adminDescribeDeleteFileFromS3"),hr=V("adminGetSpacesForAllowedEmailDomain"),vr=V("adminResetRateLimits"),br=V("annotateRecentIntercomConversation"),yr=V("adminModifyBlock"),Sr=V("adminRestoreBlock"),_r=V("adminDescribeDeletedBlockPermissions"),wr=V("resolveAddress"),kr=V("getDeveloperBotsAndIntegrations"),Ir=V("getIntegrationDomainVerifications"),Cr=V("getIntegrationSecret"),xr=V("adminBulkAddPromotionCodes"),Tr=V("adminBulkRemoveSpaceGuests"),Mr=V("adminRemoveAllowedEducationEmails"),Pr=V("adminBulkApplyPromotionCodes"),Ar=V("adminBulkUpgradeEduPlusUser"),Rr=V("calculateTax"),Dr=V("checkSpaceDomain"),Br=V("deleteBot"),Er=V("deleteIntegration"),Fr=V("adminBlockEmailDomain"),Zr=V("adminSearchPermanentlyDeletedPages"),Lr=V("adminSearchSpaceActivity"),jr=V("adminCopyPageBetweenEnvironments"),Vr=V("adminCountWordsInPage"),Ur=V("getExternalIntegrations"),Or=V("getZendeskTicketConversation"),Nr=V("getUserSpaceExternalBots"),zr=V("createOauthAuthorizationCode"),Hr=V("adminGetPublicPages"),Wr=V("adminRestoreDeletedCollectionProperties"),qr=V("adminViewDeletedCollectionProperties"),Gr=V("unfurlUrl"),Kr=V("aiSourcePicker"),$r=V("resubscribeExternalCollection"),Qr=V("getExternalCollectionSyncState"),Yr=V("getEmailsWithoutAccessToBlock"),Jr=V("processShareActionToBlock"),Xr=V("updateExperimentOverride"),ea=V("resetExperimentOverrides"),ta=V("refetchExternalObjectInstanceBlocks"),na=V("listExternalCollections"),oa=V("listExternalObjects"),ia=V("createTeam"),ra=V("setAdminPrivilegedTeamMembership"),aa=V("updateTeamMembers"),sa=V("getTeams"),la=V("getAllTeamsInSpaceForAdmin"),ca=V("getPrivatePageInfo"),da=V("markDiscussionNotificationsRead"),ua=V("getIntegrationDataForGallery"),pa=V("getIntegrationIdsForGallery"),ma=V("recordCookieConsent"),fa=V("adminGetIntegrationData"),ga=V("adminUpdateIntegrationData"),ha=V("adminGetSlackIntegrationData"),va=V("adminGetSyncedDatabaseData"),ba=V("adminJoinSpacesForOauthRedirect"),ya=V("adminForceResyncExternalObjects"),Sa=V("getRecoverableSpaceUserContent"),_a=V("transferSpaceUserContent"),wa=V("adminCreateMarketingRoute"),ka=V("adminBanUser"),Ia=V("adminBulkBanUsers"),Ca=V("adminIsSpaceDomainClaimEligible"),xa=V("adminGetDomainClaimEligibleSpaces"),Ta=V("adminGetDomainManagementSettings"),Ma=V("adminClaimAndUpgradeForSalesAssisted"),Pa=V("adminDelayClaimSpaceDeletion"),Aa=V("adminRemoveChildFromExternalCollection"),Ra=V("adminRunSpaceConsolidation"),Da=V("deleteDomainVerificationCode"),Ba=V("verifyDomain"),Ea=V("createDomainVerificationCode"),Fa=V("getDomainVerificationCodesForSpace"),Za=V("updateWorkspaceCreationForEmailDomains"),La=V("validateUserCanCreateWorkspace"),ja=V("setSamlConfig"),Va=V("getSpacesCreatedByUserWithDomains"),Ua=V("initiateWorkspaceTransfer"),Oa=V("getCostForSpaceUpgrade"),Na=V("claimAndUpgradeSpace"),za=V("requestClaimAndUpgrade"),Ha=V("transferWorkspaceToUser"),Wa=V("deleteSpaceForDomain"),qa=V("cancelSpaceDeletionForDomain"),Ga=V("adminDowngradeFraudSubscription"),Ka=V("initiateMultipartUpload"),$a=V("completeMultipartUpload"),Qa=V("getTypedDatabases"),Ya=V("getCollectionViewBlocksByAppId"),Ja=V("getPageAnalytics"),Xa=V("getCustomerOffer"),es=V("applyCustomerOffer"),ts=V("getExternalIntegrationAccessToken"),ns=V("sendVerifyTransferEmail"),os=V("getDailyUsersAnalytics"),is=V("getUserEngagementAnalytics"),rs=V("getContentEngagementAnalytics"),as=V("loadWorkspaceAnalyticsUsers"),ss=V("loadContentAnalytics"),ls=V("loadSearchAnalytics"),cs=V("getVerifiedEmailDomain"),ds=V("getExternalNotificationChannels"),us=V("adminContentSearch"),ps=V("searchVectors"),ms=V("getInferenceTestExamples"),fs=V("isEligibleForGuestMembershipRequest"),gs=V("setSeenGuestMembershipRequests"),hs=V("getAboutNotionDevelopers"),vs=V("loadContacts"),bs=V("registerDesktopApp"),ys=V("getDesktopAppRegistration"),Ss=V("getPublicApiObject"),_s=V("authCreateTotp"),ws=V("authVerifyTotpLogin"),ks=V("authVerifyTotpEnroll"),Is=V("authCreateBackupCodes"),Cs=V("authVerifyBackupCodesLogin"),xs=V("authVerifyPassword"),Ts=V("setRecordKey"),Ms=V("isRecordKeyAvailable"),Ps=V("getIdFromUniqueId"),As=V("suggestRecordKey"),Rs=V("getInAppCategoriesAndTemplates"),Ds=V("adminUpdateAddOnSubscription"),Bs=V("adminReleaseSubscriptionSchedule"),Es=V("getAIUsageEligibility"),Fs=U("getCompletionForProperty"),Zs=V("getCompletionForSelectOption"),Ls=V("adminUpdateNotionAIAvailabilityForSpace"),js=V("adminGetSpaceMembershipUpdates"),Vs=V("adminBulkCreateTimedTrials"),Us=V("getGeoIpLocation"),Os=V("getTeamAccessRequestMetadata"),Ns=V("stripeAdvanceTestClock"),zs=V("stripeGetTestClock"),Hs=V("adminOptOutNotionAIDataSharing"),Ws=V("getTransitivePageRelations"),qs=V("getActiveExportTasks"),Gs=V("adminExplainPaymentStatus"),Ks=V("adminGetBulkIds"),$s=V("adminUpdatePaymentStatus"),Qs=V("getTemplateSearchResults"),Ys=V("getTemplateCreator"),Js=V("submitTemplate"),Xs=V("submitTemplateCreator"),el=V("validateTemplate"),tl=V("validateTemplateCreatorHandle"),nl=V("getSpaceMembershipUpdates"),ol=V("getUserContractionData"),il=V("testSetupWorkspace"),rl=V("testCreatePage"),al=V("testDeleteRecord"),sl=V("getPageAssistantPreferences"),ll=V("setPageAssistantPreferences"),cl=V("adminRestoreDeletedGuestPermissions"),dl=V("adminDescribeRestoreDeletedGuestPermissions"),ul=V("adminAddLinkPreviewToSpace"),pl=V("updateDisableGuestsOnSpace"),ml=V("submitEducationGroupApplication"),fl=V("getUniversitiesAndDomains"),gl=V("exportSpaceMembers"),hl=V("exportSpaceGuests"),vl=V("publishAiSession"),bl=V("getPublishedPagesForUser"),yl=V("adminIsWorkspaceInQnA"),Sl=V("adminMergeUsers"),_l=V("resolveAccessRequest"),wl=V("getExternalOrgData"),kl=V("addUserToWaitlist"),Il=V("adminGetWorkspaceWebhookSubscriptions"),Cl=new r.Z({performRequests:async e=>{const{environment:t}=e[0],n=e.map((e=>e.args)),o=await un(t,{requests:n});if("failed"===o.type)throw o.error;return[]},batchSize:50,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:10*v.C0});async function xl(e,t){return await Cl.enqueue({environment:e,args:t})}const Tl=new r.Z({performRequests:async e=>{const t=new Array(e.length),n=e.map(((e,t)=>({environment:e.environment,request:e.args,index:t}))),o=u.vM(n,(e=>e.request.userId));for(const[i,r]of Object.entries(o)){const e=r[0].environment,n=[];for(const{request:t}of r){const{pointer:e,version:o}=t;n.push({pointer:e,version:o})}const o=await ln(e,{requests:n},i);if("failed"===o.type)throw o.error;const a=m.PF.create(o.data.recordMap);x.Z.addFromRecordMapWithRole(a),x.Z.isEmpty()||E.dY({environment:e});for(const{request:i,index:s}of r)if(i.pointer){const e=a.getValue(i.pointer),n=a.getRole(i.pointer);n&&(t[s]={value:e,role:n})}}return t},batchSize:500,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:30*v.C0});async function Ml(e,t){if(t.pointer&&(0,f.Ok)(t.pointer))try{const n=await Tl.enqueue({environment:e,args:t});return n||-1!==t.version?n:{value:void 0,role:"editor"}}catch(n){}}const Pl=e=>[e.url,e.downloadName,e.download].filter(Boolean).join(":");const Al=new class{constructor(){this.lru=new(i())({max:1e3,maxAge:v.U6})}set(e,t){this.lru.set(Pl(e),t)}get(e){return this.lru.get(Pl(e))}},Rl=new r.Z({performRequests:async e=>{const t=e.map((e=>{let{url:t}=e;return t})),n=await En(e[0].environment,{urls:t});if("failed"===n.type)throw n.error;const{signedUrls:o}=n.data;return t.forEach(((e,t)=>{const n=o[t];Al.set(e,n)})),o},batchSize:500,maxWorkers:1});async function Dl(e,t,n){const o=Al.get(t);let i;return i=o||await Rl.enqueue({environment:e,url:t}),i&&(0,s.x$)(i)&&n&&(i=(0,h.NV)({httpUrl:i,protocol:b.default.protocol,includePort:!0})),i}const Bl=new a.Z},90287:(e,t,n)=>{n.d(t,{Bs:()=>ce,KJ:()=>pe,Uz:()=>de,_S:()=>ue,mc:()=>le,qY:()=>he});var o=n(50112),i=n(15145),r=n(82813),a=n(7406),s=n(68626),l=n(4615),c=n(99405),d=n(21202),u=n(13493),p=n(65311),m=n(19889),f=n(66079),g=n(28182),h=n(9852),v=n(54153),b=n(64002),y=n(63143),S=n(25320),_=n(17707),w=n(24215),k=n(19124),I=n(84210),C=n(98165),x=n(18514),T=n(51),M=n(80444),P=n(81258),A=n(69327),R=n(64970),D=n(93220),B=n(72014),E=n(89523),F=n(35661),Z=n(32470),L=n(87956),j=n(29026),V=n(34583),U=n(28517),O=n(50906),N=n(98688),z=n(50950),H=n(47307),W=n(57400),q=n(58188),G=n(94273),K=n(97977),$=n(98958),Q=n(17659),Y=n(31304),J=n(40277),X=n(75018),ee=n(87531),te=n(29974),ne=n(39699),oe=n(61202),ie=n(70782),re=n(12321),ae=n(37181),se=n(65452);function le(e){M.default.setState(M.default.getInitialState());const{id:t}=e.currentUser;(!M.default.state.currentUserStore||t&&t!==M.default.state.currentUserStore.id)&&(t?(re.j(e,t),G.Bk(e,t),pe(e,t)):(M.default.setState({...M.default.state,initialized:!0}),z.dd(e)))}function ce(){const{currentSpaceStore:e}=M.default.getState();return e?e.id:void 0}async function de(e){const{nextRoute:t,currentRoute:n,environment:m,query:f}=e,g=M.default.state.mainEditorCurrentBlockStore,v=M.default.state.currentCollectionViewStore,y=m.currentUser.id,C=e=>{M.default.state.lastUpdater===C&&M.default.setState({...M.default.state,...e})};M.default.setState({...M.default.state,lastUpdater:C});const x=e=>{M.default.state.lastUpdater===C&&T.Z.setState({publicPageData:e})};if("page"===t.name&&t.queryId&&L.Z.setState({queryId:t.queryId,pageId:t.blockId,timeEntered:new Date}),"page"===t.name||"space"===t.name||"nativeTab"===t.name||"quickSearch"===t.name||"workspaceSetup"===t.name){let e;G.nr(t,y);const u=async()=>{e||(e=J.I6({environment:m,request:{type:"block-space",...t}}));const[n]=await Promise.all([e.next(),M.default.waitUntil((()=>M.default.state.initialized))]),o=n.value;return x(o),o},v=(0,h.getAppRefreshed)();if((0,k.AC)(m),"page"===t.name&&(!g||g.id!==t.blockId||n&&"page"===n.name&&n.blockId!==t.blockId||g.userId!==y)){X.resetPageState(m),X.resetSidebarState(m),V.$B(),X.resetEditorState(m);const{blockId:e}=t,a=new F.G(m,{table:d.iU,id:e}),s=new D.Z;C({mainEditorCurrentBlockStore:a,currentLoadingContainerStore:s}),g||await ue({environment:m,store:a});const c=await u(),{currentUserSettingsStore:h}=M.default.state;if(ge({publicPageData:c}))return void function(e){const{store:t,environment:n}=e,o=(0,I.ZP)({store:t,preferPublicLink:!1,pageVisitSource:void 0});X.navigate({environment:n,url:o})}({store:a,environment:m});const{presenceStore:k,currentUserRootStore:x}=M.default.state;Y.E(k,m,B.$g,g),S.UX(m,{block:a,fromPageRefresh:v,pageVisitStore:M.default.state.pageVisitStore,timestamp:Date.now()}),_.Y0(a.id);const T=new E.Z;C({presenceStore:T});const P=B.$g.getCurrentPageVisitId();if(B.$g.initializeNewPageVisitId(),Y._({userId:y,rootStore:a,presenceStore:T,environment:m,pageVisitIdStore:B.$g}),x){if("root"===(null==n?void 0:n.name)){if(x.getSpaceViewStores().map((e=>e.getSpaceId())).indexOf(c.spaceId)<0){if(h)return void(await te.L5({environment:m,userRootStore:x,userSettingsStore:h,pageVisitSource:i.tY.BackForward}));if(y)return void(await K.logoutSingleAccount({environment:m,userId:y}))}}if(c.spaceId&&(c.canJoinSpace||c.userHasExplicitAccess)){const e=await te.j({environment:m,userRootStore:x,spaceId:c.spaceId,navigate:!1,analyticsFrom:"redirect",userSettingsStore:h});C({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}else if(!c.spaceId&&M.default.state.currentSpaceStore){const e=await te.j({environment:m,userRootStore:x,spaceId:M.default.state.currentSpaceStore.id,navigate:!1,analyticsFrom:"redirect",userSettingsStore:h});C({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}}c.spaceId&&y&&(se.h({environment:m,spaceId:c.spaceId,userId:y}),q.rg({environment:m,spaceId:c.spaceId,userId:y}),U.I({environment:m,spaceId:c.spaceId,userId:y}));const{currentSpaceStore:R}=M.default.state;R?(V.OR({environment:m,spaceId:R.id}).then((async()=>{await a.load(),fe(m,a,f,B.$g,P)})),w.Jq(m)):c&&c.spaceId&&(await a.load(),fe(m,a,f,B.$g,P)),async function(e,t,n){const a=(0,b.Qc)(t).query,s=a[o.gS];if(parseInt(a[i.$X])===i.tY.Email&&(s.includes("email_digest")||s.includes("email_push"))&&a[i.Qs]&&n){const t=(0,l.wr)(a[i.Qs]),o=F.Xo.createChildStore(n,{table:p.uX,id:t});await o.load();const s=o.getModel();if(!s)return;if((0,r.e)((0,w.mc)(e),{alreadyRead:s.getRead(),notificationId:t,activityId:s.getActivityId(),from:"email"}),!s.getRead()){const t={id:s.id,space_id:s.getSpaceId(),read:s.getRead()};ne.createAndCommit({userAction:"appActions.setNotificationAsReadFromEmail",environment:e,perform:e=>Q.$h({notification:t,rootStore:n,transaction:e,read:!0})})}}}(m,f,R);const Z=(null==R?void 0:R.id)||c.spaceId;Z&&(oe.pt({environment:m,spaceId:Z,force:!1}),N.L({environment:m,spaceId:Z,force:!1})),Z&&y&&(A.Z.isInitialized||A.Z.reinitializeState(m,y,Z))}else if("space"===t.name){const e=await u();if(e.publicHomePage){const t=new F.G(m,{table:d.iU,id:e.publicHomePage}),n=new D.Z;C({mainEditorCurrentBlockStore:t,currentLoadingContainerStore:n})}else if(C({mainEditorCurrentBlockStore:void 0,currentLoadingContainerStore:void 0}),ge({publicPageData:e}))return void he({spaceDomain:e.spaceDomain,environment:m})}else if("nativeTab"===t.name||"quickSearch"===t.name){X.resetPageState(m),X.resetSidebarState(m),V.$B(),X.resetEditorState(m),await M.default.waitUntil((()=>M.default.state.initialized));const e="spaceId"in t?t.spaceId:void 0;if((!e||!M.default.state.currentSpaceViewStore||!M.default.state.currentSpaceStore||M.default.state.currentSpaceStore.id!==e)&&M.default.state.currentUserRootStore){const n=M.default.state.currentUserRootStore.getSpaceViewStores(),o=e?n.find((t=>{var n;return(null===(n=t.getSpaceId())||void 0===n?void 0:n.replaceAll("-",""))===(null==e?void 0:e.replaceAll("-",""))})):n[0],i=null==o?void 0:o.getSpaceStore();if(o&&i){C({currentSpaceStore:i,currentSpaceViewStore:o});const e="nativeTab"===t.name&&"search"===t.tab&&y&&!1,n="quickSearch"===t.name&&y;(e||n)&&A.Z.reinitializeState(m,y,i.id)}}}else if((0,c.wO)(t)&&(X.resetPageState(m),X.resetSidebarState(m),V.$B(),X.resetEditorState(m),await M.default.waitUntil((()=>M.default.state.initialized)),t.spaceId&&M.default.state.currentUserRootStore)){const e=M.default.state.currentUserRootStore.getSpaceViewStores().find((e=>e.getSpaceId()===t.spaceId)),n=null==e?void 0:e.getSpaceStore();e&&n&&C({currentSpaceStore:n,currentSpaceViewStore:e,mainEditorCurrentBlockStore:void 0})}if("searchQuery"in t||"searchRequest"in t)if(t.searchQuery)ee.UT({environment:m,analyticsFrom:"query-args",renderAsPage:!1}),j.ZP.setState({...j.ZP.state,query:{...j.ZP.state.query,text:t.searchQuery}});else if(t.searchRequest)try{const e=JSON.parse(t.searchRequest),{text:n,sort:o,filters:i}=e;f&&j.ZP.setState({...j.ZP.state,query:{text:n,sort:o,filters:i}}),Z.ZP.setState({...Z.ZP.state,showDebugInfo:!0,debug:"everything"})}catch($){H.deprecatedShowErrorMessage("Invalid json in searchRequest param"),s.log({level:"error",from:"appActions",type:"JSONParseError",error:{miscDataString:(0,a.tg)($).message}})}if(e)for await(const t of e)x(t);W.Yh(m),(0,h.setAppRefreshed)(!1)}const O=v?v.id:void 0;if("page"===t.name&&O!==t.collectionViewId){const e=t.collectionViewId;C({currentCollectionViewStore:e?new F.Xr(m,{table:u.n,id:e}):void 0})}const z=(0,b.Qc)(f).query[i.RL];Boolean(z)&&(R.m.setState(!0),P.Z.setState({open:!0}))}async function ue(e){const{environment:t,store:n}=e,o=await async function(e){const{environment:t,blockId:n}=e,{currentUser:o}=t,i=(0,y.jj)([...o.id?[o.id]:[],...o.loggedInUserIds]);for(const r of i){const e=new F.G(t,{table:d.iU,id:n},{userId:r});if(await e.load(),e.isDefined())return o.id===r?void 0:r}}({environment:t,blockId:n.id});o&&await ie.f({newCurrentUserId:o,environment:t,store:n})}async function pe(e,t){const n=new F.U6(e,{table:m.KJ,id:t},{userId:t}),o=new F.vO(e,{table:g.Sr,id:t},{userId:t});o.addListener(me);const i=new F.r9(e,{table:f.dx,id:t},{userId:t});$.registerPushNotifications(e),M.default.setState({...M.default.state,currentUserStore:n,currentUserSettingsStore:o,currentUserRootStore:i,initialized:!1}),await re.w(),M.default.setState({...M.default.state,initialized:!0}),ae.fG(e),z.oG(e)}function me(e){const t=e.getSettingsStore().getKeyStore("preferred_locale").getValue();t||v.Z.set("preferredLocale",t)}function fe(e,t,n,o,i){var r,a;O.PBo(e,{query:n,page_id:t.id,is_peek:!1,peek_mode:void 0,type:"collection"===t.getParentTable()?"database_page":"page",collection_id:t.getParentCollectionId()??(null===(r=t.getCollectionViewCollectionStore())||void 0===r?void 0:r.id),team_id:null===(a=(0,C.VP)(t))||void 0===a?void 0:a.id,page_visit_id:o.getCurrentPageVisitId(),previous_page_visit_id:i})}function ge(e){const{publicPageData:t}=e;return!(!(0,x.Sr)()||"none"!==t.publicAccessRole||!t.spaceName)}function he(e){const{spaceDomain:t,environment:n}=e,o=(0,x.Rs)(t);X.navigate({environment:n,url:o,redirect:!0})}},48299:(e,t,n)=>{n.d(t,{JN:()=>W,NN:()=>q,vD:()=>z,Xi:()=>N,w0:()=>G,uR:()=>K});n(21703),n(57658);var o=n(67294),i=n(41892),r=n(8848),a=n(39068),s=n(45433),l=n(33907),c=n(88437),d=n(37612),u=n(72126),p=n(4615),m=n(89101),f=n(21202),g=n(15047),h=n(29369),v=n(97880),b=n(82990),y=n(64002),S=n(5366),_=n(86628),w=n(24405),k=n(1136),I=n(40235),C=n(85893);function x(e){window.__c={n:"AppTemplateRelatedDependenciesDelete"};const{relatedDependencies:t}=e,n=(0,w.Fg)(),i=(0,_.VK)((()=>{const e=null==t?void 0:t.viewDeps;return e?e.map((e=>({name:e.getName(),icon:e.getFormat().collection_view_icon,type:e.getType()}))):[]}),[t.viewDeps]),r=o.useCallback((e=>(0,C.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,C.jsx)(k.F,{color:"light",viewIcon:e.icon,viewType:e.type,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},size:13}),e.name]},e.name)),[]),s=[{key:"entity_type",header:void 0},{key:"entities",header:void 0}];return(0,C.jsx)(I.Z,{columns:s,rows:(()=>{const e=[],o=null==t?void 0:t.propertyDeps;if(o.length>0){const t=o.map((e=>(0,C.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,C.jsx)(a.ZP,{icon:e.icon,type:e.type,size:13,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},theme:n}),e.name]},e.name))),i=(0,C.jsx)(S.FormattedMessage,{id:"appTemplates.featureBundleDelete.properties",defaultMessage:"{count, plural, one {1 property} other {{count} properties}}",values:{count:t.length}});e.push({key:"bundledProperties",columns:[[i],t]})}if(i.length>0){const t=i.map((e=>r(e))),n=(0,C.jsx)(S.FormattedMessage,{id:"appTemplates.featureBundleDelete.views",defaultMessage:"{count, plural, one {1 view} other {{count} views}}",values:{count:t.length}});e.push({key:"bundledViews",columns:[[n],t]})}return e})(),hideHeader:!0,cellStyle:{width:"40%"}})}var T=n(76798),M=n(93959),P=n(33929),A=n(77907),R=n(95802),D=n(80444),B=n(35661),E=n(54642),F=n(16956),Z=n(47307),L=n(96802),j=n(75018),V=n(39699),U=n(37181);const O=(0,S.defineMessages)({multiDBNameConnector:{id:"appTemplateHelpers.multiDBNameConnector",defaultMessage:"and"}});function N(e,t){const{spaceViewStore:n}=t,o=n.getSpaceId();if(!o)return;const i=y.bf({url:m._j.workspaceSetup,query:{spaceId:p.cj(o)}});D.default.setState({...D.default.state,mainEditorCurrentBlockStore:void 0}),j.navigate({environment:e,url:i})}function z(e){const{environment:t,collectionViewBlockStore:n,collectionStore:o,databaseType:i,propertyMapping:r,typedPropertySchemas:a,transaction:l}=e;if(o.isTypedCollection())throw new Error("Collection is already typed");const c=s.LI[i].blockUri,d=i,u=Object.entries(r).filter((e=>{let[t,n]=e;return n===s.bK})).map((e=>{let[t,n]=e;return t})),m={};u.forEach((e=>{const t=a[e];t&&(m[e]=t)})),Object.entries(m).forEach((e=>{let[n,i]=e;const a=F.G3({environment:t,collectionStore:o,collectionViewArgs:void 0,propertyName:i.name,propertyType:i.type,transaction:l});r[n]=a})),L.FH({stores:[n],update:{app_id:(0,p.ZP)(),app_config_uri:c,app_uri_map:{[c]:n.id,[d]:o.id}},transaction:l}),L.FH({stores:[o],update:{app_config_uri:d,app_uri_map:r},transaction:l})}async function H(e){const{environment:t,blockStore:n}=e,o=n.getFormat().app_id;if(!o)return[n];const i=await E.getCollectionViewBlocksByAppId(t,{spaceId:n.getSpaceId(),appId:o}),r=n.getParentStore();return"success"!==i.type||void 0===r?[n]:i.data.result.map((e=>B.G.createChildStore(r,{table:f.iU,id:e.blockId,spaceId:n.getSpaceId()})))}async function W(e){const{environment:t,collectionViewBlockStore:n,databaseUri:o}=e,i=await H({environment:t,blockStore:n});for(const a of i){var r;if(a.isCollectionView()&&(null===(r=a.getCollectionStore())||void 0===r?void 0:r.getFormat().app_config_uri)===o)return a}}async function q(e){const{environment:t,block:n,action:o}=e,a=n.getFormat().app_config_uri||"";if(M.rC.includes(a)){const e=await async function(e){const{environment:t,blockStore:n}=e,o=n.getParentStore();if(!o)return[n];const i=await H({environment:t,blockStore:n}),r=o.id;return i.filter((e=>{var t;return(null===(t=e.getParentStore())||void 0===t?void 0:t.id)===r}))}({environment:t,blockStore:n});if(e.length<=1)return[n];const a=function(e,t,n){if("delete"===e)return{message:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.message",defaultMessage:"Are you sure you want to delete {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.description",defaultMessage:"{appName} work closely together. You can delete them together, or you might encounter issues after deletion.",values:{appName:n}}),allLabel:(0,C.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.allLabel",defaultMessage:"Delete {appName}",values:{appName:n}})}),cancelLabel:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,C.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.oneLabel",defaultMessage:"Delete {dbName} only",values:{dbName:t.getTitleValue()}})}),actionIcon:d.y};if("move"===e)return{message:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.message",defaultMessage:"Are you sure you want to move {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.description",defaultMessage:"{appName} work closely together. You can move them together, or you might encounter issues after separating.",values:{appName:n}}),allLabel:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.allLabel",defaultMessage:"Move together"}),cancelLabel:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.oneLabel",defaultMessage:"Only move {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:l.n};if("duplicate"===e)return{message:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.message",defaultMessage:"Are you sure you want to duplicate {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.description",defaultMessage:"{appName} work closely together. You can duplicate them together, or you might encounter issues after separating.",values:{appName:n}}),allLabel:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.allLabel",defaultMessage:"Duplicate together"}),cancelLabel:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.oneLabel",defaultMessage:"Only duplicate {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:c.a};throw(0,v.t1)(e)}(o,n,function(e){if(1===e.length)return e[0].getTitleValue().toString();let t="";for(let n=0;n<e.length-1;n++)t+=e[n].getTitleValue(),e.length>2?t+=", ":t+=" ";return t+=`${P.default.formatMessage(O.multiDBNameConnector)} ${e[e.length-1].getTitleValue()}`,t}(e)),s=await function(e,t){const{message:n,description:o,allLabel:a,cancelLabel:s,oneLabel:l,actionIcon:c}=e;return new Promise((e=>{Z.showDialog({showCancel:!1,keepFocus:!1,message:(0,C.jsxs)("div",{style:{textAlign:"center"},children:[(0,C.jsxs)("span",{style:{display:"inline-block",verticalAlign:"-0.15em",position:"relative"},children:[(0,C.jsx)("img",{src:i.Z.images.appPackages.projectsIconSvg,style:{width:"1.4em",height:"1.4em"}}),c({width:"0.9em",height:"0.9em",position:"absolute",fill:r.O9.red,right:"-0.3em",bottom:"0.05em"})]}),(0,C.jsx)("div",{style:{fontWeight:b.Z.fontWeight.semibold,margin:"0.7em"},children:n}),(0,C.jsx)("div",{style:{fontSize:14},children:o})]}),items:"delete"===t?[{label:l,color:"red",onAccept:()=>{e("one")}},{label:a,onAccept:()=>{e("all")}},{label:s,onAccept:()=>{e("cancel")}}]:[{label:a,color:"blue",onAccept:()=>{e("all")}},{label:l,onAccept:()=>{e("one")}},{label:s,onAccept:()=>{e("cancel")}}],handleCancel:()=>{e("cancel")}})}))}(a,o);if("cancel"===s)return"user_canceled";const u=[n];if("all"===s)for(const t of e)if(t.id!==n.id){const e=R.C.findSelectablesFromIds([t.id]);e.length>0?u.push(e[0].props.store):u.push(t)}return u}return[n]}async function G(e){var t;let{environment:n,property:o,collectionContextStore:i,theme:r,from:s}=e;const{appTemplatesSetupActions:l,appConfigs:c}=await A.deps.AppTemplates.loader(),d=i.collectionStore(),p=i.collectionViewBlockStore(),m=null==p?void 0:p.getCollectionViewStores();if(!(d&&p&&m&&p.getFormat().app_config_uri))return!1;const v=d.getSchema()[o],y=d.getFormat().app_config_uri;if(!v||!y)return!1;const _=(0,M.YB)(c(),y);if(!_)return!1;const w=u.oA([...Object.keys(d.getPropertyMapping()||{}),...Object.keys((null===(t=p.getFormat())||void 0===t?void 0:t.app_uri_map)||{})]),k=(0,M.TD)(w,_),I=u.oA([k.find((e=>e.uri===o))]),P=(0,M.K8)({validDependencies:I,dependencies:k,collectionStore:d,collectionViewBlockStore:p,viewStores:m}),{validDependencies:R}=P;if(0===R.length)return!1;const D=null==p?void 0:p.getParentStore();if(!d||!p||!D||D.table!==g.bx&&D.table!==f.iU&&D.table!==h.e0)return!1;const F=p.getFormat().app_id,L=F?await E.getCollectionViewBlocksByAppId(n,{spaceId:p.getSpaceId(),appId:F}):void 0,j="success"===(null==L?void 0:L.type)?L.data.result.map((e=>B.G.createChildStore(D,{table:f.iU,id:e.blockId,spaceId:p.getSpaceId()}))):[p],V=[{label:(0,C.jsx)(S.FormattedMessage,{id:"appTemplatesHelpers.bundledPropertyDelete.deleteMessage",defaultMessage:"{count, plural, one {Delete} other {Delete all}}",values:{count:R.length}}),color:"red",onAccept:()=>l.removeDependencies({environment:n,dependencies:R,appCollectionViewBlockStores:j,from:s})}],U=R.length>1&&(0,C.jsx)(x,{relatedDependencies:P,collectionContextStore:i});return Z.showDialog({message:(0,C.jsxs)("div",{style:{textAlign:"center"},children:[(0,C.jsx)("span",{style:{fontWeight:b.Z.fontWeight.medium},children:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.message",defaultMessage:"Delete {property} property for everyone on {databaseName}?",values:{databaseName:(0,C.jsx)(T.Z,{style:{display:"inline",fontWeight:b.Z.fontWeight.medium},shouldWrap:!0,store:d}),property:(0,C.jsxs)("span",{children:[(0,C.jsx)(a.ZP,{icon:v.icon,type:v.type,size:18,style:{verticalAlign:"middle",display:"inline-block",marginRight:3,marginBottom:2},theme:r}),v.name]})}})}),R.length>1&&(0,C.jsx)("div",{style:{margin:"0.17em"},children:(0,C.jsx)("span",{style:{fontSize:13,fontWeight:b.Z.fontWeight.light},children:(0,C.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.description",defaultMessage:"These related entities will also be deleted since they work together."})})})]}),description:U,showCancel:!0,keepFocus:!0,innerStyle:{width:480},items:V}),!0}function K(e){const{environment:t,requiredCurrPhase:n,nextPhase:o,currentUserSettingsStore:i,currentSpaceStore:r}=e,a=(0,M.jH)(i,r);n&&n!==a||V.createAndCommit({userAction:"ProjManagementIntroModal.updateProjManagementTooltipTourPhase",environment:t,perform:e=>{var t;U.d2({userSettingsStore:i,transaction:e,data:{proj_management_tooltip_tour_v1_phase_per_space:{...(null===(t=i.getSettings())||void 0===t?void 0:t.proj_management_tooltip_tour_v1_phase_per_space)??{},[r.id]:o}}})},userId:i.id})}},2449:(e,t,n)=>{n.d(t,{D$:()=>g,M0:()=>p,W$:()=>v,ac:()=>h,cM:()=>m,hC:()=>u,uG:()=>b});n(21703);var o=n(68626),i=n(9852),r=n(54153),a=n(63143),s=n(11342),l=n(95477),c=n(89087),d=n(47839);function u(e){var t;const{environment:n,url:r,version:a}=e,{AppUpdateStore:s,device:l}=n;l.isElectron&&r.startsWith("https:")?o.log({level:"error",from:"appUpdateActions",type:"installAppJsUpdate",error:{message:"Attempting to refresh app js on desktop for an https url",stack:(new Error).stack},data:{url:r}}):(s.setState({electronUpdate:s.state.electronUpdate,appUpdate:void 0}),a&&g(a),p(a)||(n.mobileNative&&n.mobileNative.showSplashscreen(),(0,i.setAppRefreshed)(!0),null!==(t=d.electronApi)&&void 0!==t&&t.installAppJsUpdate?d.electronApi.installAppJsUpdate(r):r!==window.location.href?window.location.href=r:window.location.reload()))}function p(e){return(0,s.isEqualVersion)(e,b())}function m(e,t){if(!t)return!1;if("ready"!==t.state)return!1;if(c.transactionQueue.hasTasks())return!1;if(!e.currentUser.isLoggedIn())return!1;if(t.type===s.UpdateType.Silent){if(e.device.isMobileNative)return!1;const t=v();if(t&&(Date.now()-t)/a.A0<7)return!1;o.log({level:"info",from:"appUpdateActions",type:"shouldUpdateOnNavigate",data:{lastKnownUpdateTime:t}})}return!0}const f="lastKnownAppJsVersion";function g(e){r.Z.set(f,{version:e,time:Date.now()})}function h(){const e=r.Z.get(f);if(e&&e.version)return e.version;{const e=(0,s.parseVersion)(l.default.version);return r.Z.set(f,{version:e,time:Date.now()}),e}}function v(){const e=r.Z.get(f);if(e&&e.time)return e.time}function b(){return(0,s.parseVersion)(l.default.version)}},35253:(e,t,n)=>{n.d(t,{Bw:()=>r,Js:()=>s,qL:()=>a});var o=n(97880),i=n(22294);const r=e=>{const{id:t,styleKey:n,contentKey:r,removeTimeout:s,bannerStore:l,blockStore:c,context:d,disabled:u}=e,{banners:p}=l.state;if(!p.find((e=>e.id===t))){let m;switch(r){case"template_in_page":case"template_in_button":m={id:t,contentKey:r,styleKey:n,blockStore:c,context:d,disabled:u};break;case"space_content_duplication":case"deleted_or_moved_page":case"importing_evernote":m={id:t,contentKey:r,styleKey:n,blockStore:c};break;case"over_free_block_limit":case"editing_page":case"subscription_trial_add_payment_method":case"upload_limit_exceeded":case"admin_mode":case"subscription_payment_status":case"minor_app_update":case"mobile_platform_unsupported":case"page_in_archived_team":case"crdt_page":case"invite_page":case"invite_space":case"test_clock":m={id:t,contentKey:r,styleKey:n};break;default:(0,o.t1)(r)}const f=e.prepend?[m,...p]:[...p,m];l.setState({banners:f}),i.Z.setKeyboardMode(!1),s&&setTimeout((()=>{a({bannerStore:l,id:t})}),s)}},a=e=>{const{id:t,bannerStore:n}=e,{banners:o}=n.state,i=o.filter((e=>e.id!==t));i.length!==o.length&&n.setState({banners:i})},s=e=>{e.bannerStore.state.banners.length>0&&e.bannerStore.setState({banners:[]})}},54564:(e,t,n)=>{n.d(t,{Ib:()=>w,LZ:()=>k,Xv:()=>I});var o=n(1302),i=n(72126),r=n(29477),a=n(33709),s=n(23867),l=n(17707),c=n(34047),d=n(65598),u=n(58202),p=n(46351),m=n(74948),f=n(24646),g=n(36391),h=n(24229),v=n(35661),b=n(50906),y=n(24677),S=n(98104);function _(e,t){const n=p.Z.find((e=>e.getStore().id===t));n&&(y.ZH(e),S.NX({store:n.getInputStore().state.textStore}))}async function w(e){var t;const{environment:n,blockStore:p,analyticsFrom:w,discussionIds:k,shouldFocusDiscussion:I,recursivelyLoadAllDiscussions:C}=e,x=(null==k?void 0:k.map((e=>v.t1.createChildStore(p,{table:a.qF,id:e,spaceId:(0,s.C)(p.pointer.spaceId)}))))||d.al(p,{recursivelyLoadAllDiscussions:C});let{rect:T}=e;const{resolved:M,unresolved:P}=d.bB(x),A=(0,c.uC)(P.length>0?P:M)||[],R=null==A||null===(t=A[0])||void 0===t?void 0:t.id,{device:D}=n;D.isMobile&&"updates_sidebar"!==w&&(y.ZH(n),D.isIOS&&S.sD()),l.AM(A.map((e=>e.id))),await o.default.afterNextFlush();const B=(0,f.Sx)(n);if(p.isNavigableBlock()){if(R){"PageDetailsStore"in n&&n.PageDetailsStore.setToggleState({type:"discussion",id:p.id,environment:n},!0);const e=v.t1.createChildStore(p,{table:a.qF,id:R,spaceId:(0,s.C)(p.pointer.spaceId)});if((0,f.Sx)(n)&&l.T4(R),e.getResolved())if((0,f.Sx)(n))m.setUpdateSidebarCommentsMode(g.F7.Resolved);else{const e=u.R.findBlockFromStoreWithMethod(p,"openResolvedDiscussionPopup");e&&(e.openResolvedDiscussionPopup(),await o.default.afterNextFlush(),l.T4(R))}b.ZW8(n,{from:w,discussion_id:e.id})}if(!B)return void l.T4(R)}if(!T&&!B&&"margin_comments"!==w){const e=u.R.getRect(p);if(!e)return;const t=e.width,n=e.height,o=e.right-t;T=new DOMRect(o,e.top,t,n)}let E=h.u.Open;if(R){const e=v.t1.createChildStore(p,{table:a.qF,id:R,spaceId:(0,s.C)(p.pointer.spaceId)});e.getResolved()&&(E=h.u.Resolved),e.getResolved()||(m.setUpdateSidebarCommentsMode(g.F7.Unresolved),m.setUpdateSidebarTab(g.gY.Comments))}else E=h.u.Resolved;if(D.isMobile&&"updates_sidebar"!==w&&(y.ZH(n),D.isIOS&&S.sD()),h.Z.setState({open:!0,rect:T,tab:E,blockStore:p,discussionIds:x.map((e=>e.id)),recursivelyLoadAllDiscussions:C}),b.ZW8(n,{from:w,discussion_id:R}),I)if(R){if(await r.Vs(10),await o.default.afterNextFlush(),l.T4(R),n.device.isMobile)return;(function(e){var t;const{blockStore:n,discussionIds:o}=e;return h.Z.state.open&&h.Z.state.blockStore.id===n.id&&i.Xy(null===(t=h.Z.state)||void 0===t?void 0:t.discussionIds,o)})(e)||_(n,R)}else{if(n.device.isMobile)return;P.length>0&&(await r.Vs(10),await o.default.afterNextFlush(),_(n,P[0].id))}}function k(){const e=h.Z.state;e.open&&h.Z.setState({open:!1,rect:e.rect})}function I(){const e=h.Z.state;if(e.open&&e.tab===h.u.Open){0===d.vV(e.blockStore,{recursivelyLoadAllDiscussions:!1}).length&&k()}}},6404:(e,t,n)=>{n.d(t,{$Z:()=>d,Qn:()=>c,xv:()=>u});var o=n(95802),i=n(8949),r=n(17903),a=n(83212),s=n(50628),l=n(50906);function c(e){const{environment:t,left:n,top:o,actionSectionGroupKey:s,showInput:c,stores:d,analyticsFrom:u,optionalAnalyticsProperties:p,pageAnnotationToken:m}=e,f=new DOMRect(n,o,1,1);i.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:s,stores:d,frameScrollTop:r.Z.state.scrollTop,originBlockRect:f,showInput:c,analyticsFrom:u,publicEditMode:d[0]?a.Z.getMode(t,d[0]):void 0,collectionContextStore:null==p?void 0:p.collectionContextStore,clickedPageAnnotation:m}),l.EDS(t,{from:u,block_type:d[0]&&d[0].getType(),optionalAnalyticsProperties:p})}const d=function(e){const{environment:t,analyticsFrom:n,actionSectionGroupKey:c,stores:d,showInput:u}=e,p=o.C.findSelectableFromStore(d[0]);if(!p)return;const m=s.Z.state.selectableRectMap.get(p);m&&i.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:c,stores:d,frameScrollTop:r.Z.state.scrollTop,originBlockRect:m,showInput:void 0===u||u,analyticsFrom:n,publicEditMode:d[0]?a.Z.getMode(t,d[0]):void 0}),t&&l.EDS(t,{from:n,block_type:d[0]&&d[0].getType()})},u=function(){i.Z.setState({isActive:!1})}},79554:(e,t,n)=>{n.d(t,{Dq:()=>A,H8:()=>R,RH:()=>T,_x:()=>I,kE:()=>k,ry:()=>D,wK:()=>M,xv:()=>C});n(21703);var o=n(15145),i=n(41432),r=n(1800),a=n(72126),s=n(606),l=n(21202),c=n(70203),d=n(97880),u=n(95477),p=n(28020),m=n(95802),f=n(61207),g=n(35661),h=n(52229),v=n(19785),b=n(9953),y=n(42858),S=n(24677),_=n(97444),w=n(39699);function k(e){const{blocks:t,copiedStores:n,pageSource:o}=e,i=a.Z$(t);if(!i)return;const r=m.C.getRectFromStore(i);r&&f.Z.setState({open:!0,type:"blocks",blocks:t,rect:r,copiedStores:n,pageSource:o})}function I(e){const{blocks:t,copiedLinks:n,rootStore:o}=e;if(!t.every(x))return!1;if(n.some((e=>e.blockId===o.id)))return!1;const i=a.Z$(t);if(!i)return!1;const r=m.C.getRectFromStore(i);return!!r&&(f.Z.setState({open:!0,type:"links",blocks:t,rect:r,copiedLinks:n}),!0)}function C(){f.Z.setState({open:!1})}function x(e){return!(e.isType(i.Ti.copyIndicator)||e.isTransclusionType()||e.isInsideCollection())}function T(e){const{blocks:t,pageSource:n,wasContiguousSelection:o,action:r,rootStore:a,copiedStores:l}=e;return"copy"===r&&o&&!(0,s.qo)(n,a.pointer)&&(M(e)||R({currentSpaceId:a.getSpaceId(),...e}))&&t.every(x)&&!l.every((e=>e.getType()===i.Ti.externalObjectInstance))}function M(e){const{blocks:t}=e;return 1===t.length}function P(e){const{transaction:t,blockUrl:n,spaceId:o,useCrdt:r,environment:a}=e,s=b.j4({environment:a,type:i.Ti.text,inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache,transaction:t,spaceId:o,useCrdt:r}),l=[(0,c.V3y)(n,[(0,c.edl)(n)])];return _.sO({environment:a,store:s.getBlockTitleStore(),value:l,transaction:t}),s}async function A(e){const{environment:t,blocks:n,source:i}=e,s=a.Ps(n);if(!s)return;const c=s.getParentBlockStore();if(!c)return;const p=s.getContentStore();let m;await w.createAndCommitAsync({environment:t,userAction:"blockPasteMenuActions.acceptLinkToPage",waitForServerCommit:!0,perform:async e=>{if("blocks"===i.type){const{copiedStores:n,pageSource:a}=i,d=s,f=n[0];if(!d||!f)return;const v=g.G.createChildStore(p,{table:l.iU,id:f.id});if(v.isNavigableBlock())await v.load(),m=[h.k({environment:t,parentBlock:c,targetStore:v,transaction:e})];else{const n=(0,r.Z)({pageId:a.id,scrollToBlockId:v.id,baseUrl:u.default.domainBaseUrl,pageVisitSource:o.tY.LinkInPage});m=[P({blockUrl:n,spaceId:s.getSpaceId(),useCrdt:s.useCrdt(),environment:t,transaction:e})]}}else if("links"===i.type){const{copiedLinks:a}=i;if(a.length!==n.length)return;m=await Promise.all(a.map((async n=>{const i=n.scrollToBlockId||n.peekViewBlockId||n.blockId,a=g.G.createChildStore(p,{table:l.iU,id:i});if(await a.load(),a.isNavigableBlock())return h.k({environment:t,parentBlock:c,targetStore:a,transaction:e});{const i=n.peekViewBlockId||n.blockId,c=g.G.createChildStore(p,{table:l.iU,id:i});await c.load();return P({blockUrl:(0,r.Z)({pageId:i,pageModel:c.getModel(),scrollToBlockId:a.id,baseUrl:u.default.domainBaseUrl,pageVisitSource:o.tY.LinkInPage}),spaceId:s.getSpaceId(),useCrdt:s.useCrdt(),environment:t,transaction:e})}})))}else(0,d.t1)(i);const a=y.is({environment:t,blocks:m,selection:n,replaceEmptyTextBlock:!0,transaction:e});y.Cl({environment:t,blocks:n,transaction:e}),S.Z5({environment:t,stores:a}),C()}})}function R(e){const{currentSpaceId:t,blocks:n,copiedStores:o}=e;return n.length>0&&!o.some((e=>e.isInsideCollection()))&&o.every((e=>e.canEdit()))&&o.every((e=>e.getSpaceId()===t))}async function D(e){const{environment:t,blocks:n,copiedBlockIds:o}=e,r=await Promise.all(o.map((async e=>{const t=g.G.createChildStore(n[0],{table:l.iU,id:e});await t.load();const o=t.getParentBlockStore();if(!o)throw new Error("Block has no parent.");await o.load();const i=o.getContentStore();return{store:g.G.createChildStore(i,{table:l.iU,id:e}),parentStore:o,parentContentStore:i}}))),a=r[0];if(!a)return;const{serverCommitResult:s}=w.createAndCommit({userAction:"blockPasteMenuActions.acceptCreateTransclusion",environment:t,perform:e=>{var o,s;let l;if(a.store.getType()===i.Ti.transclusionContainer)l=a.store;else if(a.store.getType()===i.Ti.transclusionReference){const e=a.store.getTransclusionReferenceTargetStore();if(!e)throw new Error("Could not find target");l=e}else if(a.parentStore.getType()===i.Ti.transclusionContainer)l=a.parentStore;else{l=b.j4({environment:t,type:i.Ti.transclusionContainer,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:a.store.pointer.spaceId,useCrdt:a.store.useCrdt()});const n=l.getContentStore();v.rS({parentStore:a.parentContentStore,oldChildStore:a.store,newChildStore:l,transaction:e});for(const{store:t}of r)v.jG({parentStore:n,childStore:t,transaction:e})}const c=b.j4({environment:t,type:i.Ti.transclusionReference,format:{transclusion_reference_pointer:l.pointer},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:0!==n.length?n[n.length-1].pointer.spaceId:null===(o=(0,p.RM)())||void 0===o?void 0:o.pointer.spaceId,useCrdt:0!==n.length?n[n.length-1].useCrdt():(null===(s=(0,p.RM)())||void 0===s?void 0:s.useCrdt())??!1}),d=y.is({environment:t,blocks:[c],selection:n,transaction:e,replaceEmptyTextBlock:!0});y.Cl({environment:t,blocks:n,transaction:e}),S.Z5({environment:t,stores:d}),C()}});await s}},51365:(e,t,n)=>{n.d(t,{$o:()=>b,RX:()=>y,bA:()=>g,fG:()=>w,gT:()=>S,i2:()=>_,mm:()=>k,vO:()=>v,xv:()=>h});var o=n(73935),i=n(1302),r=n(99036),a=n(80951),s=n(70203),l=n(58299),c=n(9953),d=n(61045),u=n(24677),p=n(97444),m=n(98104),f=n(39699);function g(e){const{environment:t,blockPropertyValueOverlayStore:n,store:a,additionalStores:c=[],property:g,format:h,preventClearSelection:v,insertChar:b,uploadFiles:y,disableHorizontalEdgeScroll:S,isNewBlock:_,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:I}=e,C=(a.getSchema()||{})[g],x=l.Z.findBlockPropertyValue(a,g);let T=e.rect;const M=null==x?void 0:x.getNode();if(M&&(d.bx({element:M,vertical:{reveal:"closest"},horizontal:S?void 0:{reveal:"closest"},scrollers:{verticalScroller:null==x?void 0:x.getContextVerticalScroller(),horizontalScroller:null==x?void 0:x.getContextHorizontalScroller()}}),!T)){const e=o.findDOMNode(M);e instanceof Element&&(T=e.getBoundingClientRect())}if(!T)return;const P=a.clone();if(n.setState({isOpen:!0,store:a,clonedStore:P,additionalStores:c,property:g,format:h,rect:T,preventClearSelection:v,insertChar:b,uploadFiles:y,isNewBlock:_,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:I}),!I||"title"!==(null==C?void 0:C.type)&&"text"!==(null==C?void 0:C.type)||null==I||I.setState({textStoresBeingEdited:[...c,a],lastBlockPropertyValueOverlayCloseTime:void 0}),C&&r.Yl(C.type)){v||u.ZH(t);const e=P.getNormalizedPropertyStore(g);b&&f.createAndCommit({userAction:"blockPropertyValueOverlayActions.open",environment:t,perform:n=>{p.sO({environment:t,store:e,value:s.TPx(b),transaction:n})}}),i.default.afterNextFlush((()=>{i.default.afterNextFlush((()=>{i.default.afterNextFlush((()=>{m.NX({store:e})}))}))}))}else v||u.ZH(t),m.ZH(t)}function h(e){const{environment:t,blockPropertyValueOverlayStore:n}=e,o=n.state;o.isOpen&&(o.preventClearSelection||u.ZH(t),n.reset(),i.default.afterNextFlush((()=>{var e;return null===(e=o.collectionsBulkActionsToolbarStore)||void 0===e?void 0:e.setState({textStoresBeingEdited:[],lastBlockPropertyValueOverlayCloseTime:Date.now()})})))}const v=function(e){const{stores:t,property:n,transaction:o}=e,i=t[0].getPropertyStore(n),r=(0,a.Ml)(i.getValue());for(const s of t)c.sO({store:s.getPropertyStore(n),value:(0,a._I)(!r),transaction:o})};function b(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onTab)null==a||null===(o=(i=a.getProps()).onTab)||void 0===o||o.call(i);else h(e)}}function y(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onUntab)null==a||null===(o=(i=a.getProps()).onUntab)||void 0===o||o.call(i);else h(e)}}function S(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onEnter)null==a||null===(o=(i=a.getProps()).onEnter)||void 0===o||o.call(i);else h(e)}}function _(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onEsc)null==a||null===(o=(i=a.getProps()).onEsc)||void 0===o||o.call(i);else h(e)}}function w(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onBgClick)null==a||null===(o=(i=a.getProps()).onBgClick)||void 0===o||o.call(i);else h(e)}}function k(e){const{blockPropertyValueOverlayStore:t,openProperty:n}=e,o=t.state;if(o.isOpen){var i,r;const{store:t,property:a}=o,s=l.Z.findBlockPropertyValue(t,a);(null==s||null===(i=(r=s.getProps()).onOpenProperty)||void 0===i?void 0:i.call(r,n))||h(e)}}},48948:(e,t,n)=>{n.d(t,{K:()=>u});var o=n(41432),i=n(29477),r=n(23867),a=n(70203),s=n(80444),l=n(54642),c=n(9953),d=n(39699);async function u(e){const{store:t,url:n,environment:u,teamId:p}=e,m=void 0!==e.transformTimeout?e.transformTimeout:3e3,{serverCommitResult:f}=d.createAndCommit({userAction:"bookmarkBlockActions.createBookmark",environment:u,perform:e=>{c.sW({store:t.getPropertiesStore(),data:{link:a.TPx(n),title:a.TPx(n)},transaction:e})}}),{winner:g,rest:h}=await i.S3([f,i.Vs(m)]);if(1===g&&(await async function(e,t){const{serverCommitResult:n}=d.createAndCommit({userAction:"bookmarkBlockActions.transformIntoBookmark",environment:e,perform:e=>{c.sW({store:t,data:{type:o.Ti.bookmark},transaction:e})}});await n}(u,t),await h),p){const{currentSpaceStore:e}=s.default.state;await l.setBookmarkMetadata(u,{type:"team-invite-bookmark",block:{id:t.id,spaceId:(0,r.C)(t.pointer.spaceId)},url:n,teamId:p,spaceId:e&&e.id})}else await l.setBookmarkMetadata(u,{type:"external-bookmark",block:{id:t.id,spaceId:(0,r.C)(t.pointer.spaceId)},url:n})}},14871:(e,t,n)=>{n.d(t,{AL:()=>Pt,Dw:()=>rn,Hs:()=>nn,IK:()=>an,JG:()=>Mt,Lh:()=>fn,Mt:()=>mn,Pm:()=>un,R$:()=>Ft,RD:()=>ln,VG:()=>on,by:()=>Tt,e0:()=>St,f4:()=>dn,g9:()=>sn,jm:()=>kt,of:()=>jt,tk:()=>Gt,tq:()=>Xe,v:()=>Xt,wc:()=>pn});n(57658),n(21703);var o=n(27856),i=n.n(o),r=n(1302),a=n(66897),s=n(15145),l=n(41432),c=n(99036),d=n(8848),u=n(97531),p=n(1800),m=n(15095),f=n(64962),g=n(61075),h=n(42509),v=n(43593),b=n(78106),y=n(68626),S=n(86678),_=n(42875),w=n(19531),k=n(64572),I=n(22808),C=n(30845),x=n(72126),T=n(25718),M=n(59753),P=n(482),A=n(33317),R=n(19233),D=n(4615),B=n(71644),E=n(45953),F=n(606),Z=n(82883),L=n(99405),j=n(21202),V=n(6287),U=n(70279),O=n(23867),N=n(54153),z=n(70203),H=n(44805),W=n(95371),q=n(374),G=n(70842),K=n(97880),$=n(64002),Q=n(82798),Y=n(5366),J=n(96313),X=n(94419),ee=n(95477),te=n(78791),ne=n(65273),oe=n(24990),ie=n(28020),re=n(56518),ae=n(44486),se=n(84210),le=n(33929),ce=n(68056),de=n(45162),ue=n(98165),pe=n(70219),me=n(65598),fe=n(69645),ge=n(73959),he=n(41984),ve=n(40150),be=n(89224),ye=n(89086),Se=n(28685),_e=n(95802),we=n(41662),ke=n(80444),Ie=n(87143),Ce=n(88632),xe=n(77080),Te=n(30874),Me=n(22294),Pe=n(35661),Ae=n(27724),Re=n(24666),De=n(34583),Be=n(50906),Ee=n(79554),Fe=n(42274),Ze=n(45264),Le=n(47307),je=n(54532),Ve=n(31781),Ue=n(89951),Oe=n(19358),Ne=n(9953),ze=n(42858),He=n(24677),We=n(64964),qe=n(80402),Ge=n(97444),Ke=n(98104),$e=n(39699),Qe=n(68422),Ye=n(61202);const Je=(0,Y.defineMessages)({offlineError:{id:"clipboardActions.offlineError.message",defaultMessage:"Please go online to copy this block."}}),Xe=(0,Y.defineMessages)({copiedQnAMessageToClipboard:{id:"action.copiedQnAMessageToClipboard",defaultMessage:"Copied response to clipboard"},copiedLinkToClipboard:{id:"action.copiedLinkToClipboard.snackBarMessage",defaultMessage:"Copied link to clipboard"},copiedBlockLinkToClipboard:{id:"action.copiedBlockLinkToClipboard.snackBarMessage",defaultMessage:"Copied block link to clipboard"},copiedLinksToClipboard:{id:"action.copiedLinksToClipboard.snackBarMessage",defaultMessage:"Copied links to clipboard"},copiedPropertyToClipboard:{id:"action.copiedPropertyToClipboard.snackBarMessage",defaultMessage:"Copied property to clipboard"},copiedCodeToClipboard:{id:"action.copiedCodeToClipboard.snackBarMessage",defaultMessage:"Copied code to clipboard"},copiedTokenToClipboard:{id:"action.copiedTokenToClipboard.snackBarMessage",defaultMessage:"Copied token to clipboard"},copiedToClipboard:{id:"action.copiedToClipboard.snackBarMessage",defaultMessage:"Copied to clipboard"},copiedApiObjectToClipboard:{id:"action.copiedApiObjectToClipboard.snackBarMessage",defaultMessage:"Copied API object to clipboard"}}),et={...R.Y,dockerfile:"Docker",javascriptreact:"JavaScript",jsonc:"JSON","objective-c":"Objective-C",proto:"Protobuf",shellscript:"Shell",typescriptreact:"TypeScript",vb:"Visual Basic"},tt="text/_notion-blocks-v3-production",nt="text/_notion-text-production",ot="text/_notion-multi-text-production",it="text/_notion-page-source-production",rt="vscode-editor-data",at=[tt,nt,ot,it],st=new Set(at);const lt={fromJson:e=>e,toJson:e=>e},ct=lt,dt=lt,ut=lt,pt={fromJson(e){const t=(0,W.MW)(e.tree,(e=>e)),n=mt.fromJson(e.blockSelection);return{...e,tree:t,blockSelection:n}},toJson(e){const t=mt.toJson(e.blockSelection);return{...e,blockSelection:t}}},mt={fromJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?E.Ak.create(e.blockSubtree):void 0})))}),toJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?e.blockSubtree.toJson({allowVersionDowngrade:!1}):void 0})))})},ft="VirtualClipboard:production";let gt;function ht(e){return e.isAndroid}function vt(e,t){if(!ht(t))return e;const n=(0,re.nZ)(e.getData("text/html"));if(n){gt||(gt=N.Z.get(ft));const t=gt;if(n===(null==t?void 0:t.id))return{getData(n){const o=e.getData(n);return!o&&function(e){return st.has(e)}(n)?t.mimeTypes[n]||"":o}}}return e}function bt(e,t,n,o){if(!e.clipboardData)return;const i=n.toJson(o),r=JSON.stringify(i);e.clipboardData.setData(t,r)}function yt(e,t,n){try{const o=e.getData(t),i=JSON.parse(o);return n.fromJson(i)}catch(o){return}}function St(e){const{clipboardData:t}=e,{text:n,html:o,isFromMicrosoftOffice:i}=function(e){const{clipboardData:t,tinyMceMicrosoftWordPasteFilter:n}=e,o=t.getData("text/uri-list").trim(),i=t.getData("text/plain").trim().replace(Jt,"\n")||o,r=t.getData("text/html").trim(),a=zt(r);if(!function(e){const t=document.createElement("div");return t.innerHTML=Ht(e),w.RE({node:t,window,emojiData:oe.Z.state})}({html:r,tinyMceMicrosoftWordPasteFilter:n})&&!function(e,t){return Yt.test(e)&&Yt.test(t)}(r,i))return{text:i,isFromMicrosoftOffice:a};return{text:i,html:r,isFromMicrosoftOffice:a}}(e);return{text:n,html:o,multiTextSelectionData:yt(t,ot,pt),textSelectionData:yt(t,nt,ct),blockSelectionData:yt(t,tt,mt),isFromMicrosoftOffice:i}}function _t(e){const{blocks:t,action:n,environment:o}=e;if(0===t.length)return{action:n,blocks:[],wasContiguousSelection:!1};const i=t[0],r=i.inMemoryRecordCache,a=x.jj(x.oA(t.map((e=>e.id)))),s=i.getParentBlockStore(),l=s?s.getRenderableContentIds():[],c=l.indexOf(i.id),d=Boolean(s&&t.every(((e,t)=>l.indexOf(e.id)===c+t)));if(r.isTemplatePreview){return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:je.K8(o,{blockId:e,inMemoryRecordCache:r,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:n,wasContiguousSelection:d}}if(r.snapshotData){Be.P_7(o,r.snapshotData);return{blocks:a.map((e=>({blockId:e,snapshotData:r.snapshotData,blockSubtree:je.K8(o,{blockId:e,inMemoryRecordCache:r,allowCopyCollections:!0,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:n,wasContiguousSelection:d}}{const e=(0,re.IU)(t),i=e&&function(e){var t;const{environment:n,multiColumnPasteInfo:o,inMemoryRecordCache:i}=e,{columnListId:r,columnIds:a,spaceId:s}=o,l=E.Ak.create(),c=null===(t=i.getEntry({pointer:{table:j.iU,id:r,spaceId:s},userId:n.currentUser.id}))||void 0===t?void 0:t.value.value;if("column_list"!==(null==c?void 0:c.type))return;const d={...c,content:(c.content||[]).filter((e=>a.has(e)))};l.setValue({table:j.iU,id:r,spaceId:s},d);for(const m of a){var u;const e=null===(u=i.getEntry({pointer:{table:j.iU,id:m,spaceId:s},userId:n.currentUser.id}))||void 0===u?void 0:u.value.value;if("column"!==(null==e?void 0:e.type))return;const t={...e,content:(e.content||[]).filter((e=>o.blockIds.has(e)))};l.setValue({table:j.iU,id:m,spaceId:s},t)}const p=[l];for(const m of o.blockIds){const e=je.K8(n,{blockId:m,inMemoryRecordCache:i,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!e)return;p.push(e)}return E.Ak.merge(p)}({environment:o,inMemoryRecordCache:r,multiColumnPasteInfo:e});if(e&&i){let t=!1;const s=[];for(const n of a)e.blockIds.has(n)?t||(s.push({blockId:e.columnListId,snapshotData:void 0,blockSubtree:i}),t=!0):s.push({blockId:n,snapshotData:void 0,blockSubtree:je.K8(o,{blockId:n,inMemoryRecordCache:r,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})});return{blocks:s,action:n,wasContiguousSelection:d}}return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:je.K8(o,{blockId:e,inMemoryRecordCache:r,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:n,wasContiguousSelection:d}}}function wt(e){const{markdown:t,markdownOptions:n,markdownLinkifyIt:o}=e;if(o)return T.c8({...o,markdown:t,plugin:null==n?void 0:n.plugin})}function kt(e){const{rootBlock:t,getRecordValue:n}=e,o=n(t);if(!o)return;const i=(0,S.ky)({block:o,getRecordValue:n});if(!i)return;const r=(0,re.ax)({rootBlock:t,getRecordValue:n}),a=(0,c.oC)(i),s=Object.keys(a),l=x.MR(s,(e=>{const t=a[e];return t&&t.name||""}));let d="";for(const c of l){const e=a[c];if(e&&"title"!==c){const t=(0,g.Wy)({property:c,schema:a,block:o,exportArgs:r,renderers:f.O});t&&(d+=`${e.name}: ${t}\n`)}}return d||void 0}function It(e){const{treePath:t,textPosition:n,endpoint:o}=e,{store:i,index:r}=n,a=t.map((e=>e.value.store.pointer)),s=n.store.path,l=z.xrQ(i.getValue(),r,r);return{copiedText:"end"===o?l.tokensBeforeRange:l.tokensAfterRange,textIndex:r,attributePath:s,pointerPath:a}}function Ct(e){var t;const{multiSelection:n,action:o,environment:i}=e;(0,ce.qS)(n)&&console.warn("Warning, serializeMultiTextSelectionToClipboardData() was called with a single-store text selection! This function should only be  called with a multi-selection that spans multiple blocks.");const r=null===(t=(0,de.tp)({filterCommonAncestors:!0,multiSelection:n,focus:void 0}))||void 0===t?void 0:t.stores;if(!r)return;const a=_t({action:o,blocks:r,environment:i});if(0===a.blocks.length)return;const s=(0,de.Nj)({multiSelection:n,includeNonSelectable:!1});if(!s)return;const{treeRange:l}=s,c=[],d=new Map,u=(e,t)=>{t.forEach((e=>u(e,[])));const n=d.get(e),o=n&&n.length>t.length?n:t;d.set(e,o)};for(const{start:v,end:b}of l.iterateAnalogousNodes()){if(v){const e=v.childrenBeforeRange.slice(-1).concat(v.childrenInsideRange);u(v.parent,e)}b&&(u(b.parent,b.childrenInsideRange),c.push(P.op.set({pointer:b.parent.value.store.pointer,path:["content"],args:b.childrenInsideRange.map((e=>e.value.store.id))})))}const p=It({textPosition:n.start,endpoint:"start",treePath:l.startPath}),m=It({textPosition:n.end,endpoint:"end",treePath:l.endPath});c.push(P.op.set({pointer:p.pointerPath[p.pointerPath.length-1],path:p.attributePath,args:p.copiedText})),c.push(P.op.set({pointer:m.pointerPath[m.pointerPath.length-1],path:m.attributePath,args:m.copiedText}));for(const v of[null===(f=a.blocks[0])||void 0===f?void 0:f.blockSubtree,null===(g=a.blocks[a.blocks.length-1])||void 0===g?void 0:g.blockSubtree]){var f,g;v&&(0,A.FS)({recordMap:v,operations:c,updateOnly:!0})}const h=(0,W.MW)(l.commonAncestor,(e=>{const t=d.get(e);if(t)return{value:e.value.store.pointer,children:t}}));return h?{blockSelection:a,tree:h,multiTextSelection:{start:p,end:m},action:o}:void 0}function xt(e){const{environment:t,event:n}=e,o=(0,D.ZP)();!function(e){const{environment:t,event:n,markdownLinkifyIt:o}=e;if(!n.clipboardData)return;const i=Ae.default.state.stores,r=Re.default.isEditingComment(),a=we.g$.getSimpleTableCellFromTextSelection(),s="empty"!==Re.default.state.mode&&Re.default.state.multiSelection,c=t.currentUser.id,u="copy"===n.type?"copy":"cut",p=ie.RM();p&&(0,F.$O)(p.pointer,j.iU)&&bt(n,it,dt,p.pointer);const m=s&&(0,ce.QY)(s);if(m&&m.selection.startIndex!==m.selection.endIndex){const e=le.default.getIntl(),{store:o,selection:i}=m,r=o.inMemoryRecordCache,a=o.getValue();if(n.preventDefault(),a&&!Gt()){var f;const e="title"===o.path[o.path.length-1],t=null===(f=(0,ge.sQ)(o))||void 0===f?void 0:f.getType(),r=e&&t&&(0,l.Zu)(t)?t:void 0;bt(n,nt,ct,{blockType:r,editing:a,selection:i,action:u})}const s=z.KU1(a,i.startIndex,i.endIndex),p=M.om.fromGetRecordValueFn(r.makeGetRecordValueFn(c)),g=r.makeGetRecordRoleFn(c),h=(0,Z.X)({intl:e,textValue:s,getRecordModel:p,userTimeZone:(0,_.r)()});n.clipboardData.setData("text/plain",(0,re.ZI)(t.device.isWindows,h));const v=H.hW({textValue:s&&{value:s,spaceId:(0,O.C)(o.pointer.spaceId)},getRecordModel:p,getRecordRole:g,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,d.Vx)(),intl:e,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,pe.b)(t),externalIntegrations:Te.Z.integrations.state,formulaValueTypes:[],emojiData:oe.Z.state});return void n.clipboardData.setData("text/html",(0,re.ZI)(t.device.isWindows,v))}if(s&&!(0,ce.iG)(s)&&!r&&s.start.store.table===j.iU&&s.end.store.table===j.iU){const e=Ct({environment:t,multiSelection:s,action:u});if(e){n.preventDefault(),bt(n,ot,pt,e);const i=s.start.store.inMemoryRecordCache,r=s.start.store.getRecordStoreUIRoot().getValue();if(!r)return;const{markdown:a,html:l}=(0,re.Ef)({clipboardData:e,rootBlock:{id:r.id,table:j.iU,spaceId:r.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:i.makeGetRecordValueFn(c),markdownLinkifyIt:o});return a&&n.clipboardData.setData("text/plain",a),void(l&&n.clipboardData.setData("text/html",l))}}if(s&&!(0,ce.iG)(s)&&!r&&s.start.store.table===U.x_&&s.end.store.table===U.x_){n.preventDefault();const e=(0,de.L5)(s),o=le.default.getIntl(),i=e.map((e=>{let{store:n,selection:i}=e;if(i.startIndex===i.endIndex)return;const r=n.inMemoryRecordCache,a=M.om.fromGetRecordValueFn(r.makeGetRecordValueFn(c)),s=r.makeGetRecordRoleFn(c),l=z.KU1(n.getValue(),i.startIndex,i.endIndex);return{plainText:(0,Z.X)({intl:o,textValue:l,getRecordModel:a,userTimeZone:(0,_.r)()}),htmlContent:H.hW({textValue:l&&{value:l,spaceId:(0,O.C)(n.pointer.spaceId)},getRecordModel:a,getRecordRole:s,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,d.Vx)(),intl:o,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,pe.b)(t),externalIntegrations:Te.Z.integrations.state,formulaValueTypes:[],emojiData:oe.Z.state}),textValue:l}})).filter(K.$K),r=i.map((e=>e.plainText)).join("\n\n"),a=`<div>${i.map((e=>e.htmlContent)).join("</div><div>")}</div>`;return n.clipboardData.setData("text/plain",(0,re.ZI)(t.device.isWindows,r)),void n.clipboardData.setData("text/html",(0,re.ZI)(t.device.isWindows,a))}if(i.length>0&&!r&&!a){n.preventDefault();const e=i[0],r=e.inMemoryRecordCache,a=_t({blocks:i,environment:t,action:u});if(bt(n,tt,mt,a),!e.isDefined())return;const s=x.oA(i.map((e=>e.computeWithRecordValues((t=>{let{getRecordValueAndSubscribe:n}=t;return n(e)}))))),l=r.makeGetRecordValueFn(c),{markdown:d,html:p}=(0,re.X4)({rootBlock:{id:e.id,table:j.iU,spaceId:e.getSpaceId()},blockValues:s,getRecordValue:l,isWindows:t.device.isWindows,markdownLinkifyIt:o});return d&&n.clipboardData.setData("text/plain",d),void(p&&n.clipboardData.setData("text/html",p))}}(e),(0,re.Li)(n,o),function(e){let{event:t,device:n,customEventId:o}=e;if(!t.clipboardData||!ht(n))return;const i={};for(const s of at)i[s]=t.clipboardData.getData(s);const r=t.clipboardData.getData("text/html");t.clipboardData.setData("text/html",`${r}${(0,re.Gp)(o)}`),gt={id:o,mimeTypes:i};try{N.Z.set(ft,gt)}catch(a){y.log({level:"error",from:"clipboardActions",type:"setVirtualClipboardData",error:{message:"Unable to persistently store virtual clipboard data."}})}}({event:n,device:t.device,customEventId:o})}async function Tt(e){const{event:t,environment:n,markdownLinkifyIt:o}=e;Ke.NG(n);const i=Ae.default.state.stores,r=Re.default.isEditingComment(),a=ie.JE(),s="editing"===Re.default.state.mode&&Re.default.state.multiSelection,{phase:l}=Ae.default.state;Mt({environment:n,event:t,disableSyncTextSelection:!0,markdownLinkifyIt:o}),s&&!(0,ce.iG)(s)?$e.createAndCommit({userAction:"clipboardActions.cutWithMaybeConfirmation",environment:n,perform:e=>{Ge.pz({environment:n,multiSelection:s,transaction:e})}}):(l===Ae.SelectionPhase.Selected||s)&&i.length>0&&!r&&!a&&await ze.Qw({environment:n,blocks:i}),Me.Z.setKeyboardMode(!0)}function Mt(e){const{environment:t,event:n,disableSyncTextSelection:o,markdownLinkifyIt:i}=e;o||Ke.NG(t),xt({environment:t,event:n,markdownLinkifyIt:i}),Me.Z.setKeyboardMode(!0)}function Pt(e){const{environment:t,files:n,transaction:o}=e,i=Ae.default.getCurrentRecordCache(),r=ie.qQ(t);if(i){var a,s;const e=Ae.default.state.stores,l=Ve.z({environment:t,files:n,inMemoryRecordCache:i,transaction:o,pageWidth:r,spaceId:0!==e.length?e[0].pointer.spaceId:null===(a=ie.RM())||void 0===a?void 0:a.pointer.spaceId,useCrdt:0!==e.length?e[0].useCrdt():(null===(s=ie.RM())||void 0===s?void 0:s.useCrdt())??!1});l.forEach((e=>{const n=e.getType();n&&Be.W2j(t,{from:"paste",type:n})})),Bt({environment:t,blocks:l,transaction:o,replaceEmptyTextBlock:!0})}}function At(e){const{environment:t,store:n,tokens:o,index:i,transaction:a,multiTextSelection:s,disableEmbedMenu:l,selectAll:c}=e,d=(0,ce.QY)(s),u=d?{value:d.store.getValue()}:void 0;Ge.mM({environment:t,store:n,tokens:o,index:i,transaction:a,selectAll:c});const p=Rt(o);!l&&u&&p&&function(e){const{environment:t,hyperlink:n,oldTextValue:o}=e,i="editing"===Re.default.state.mode&&(0,ce.QY)(Re.default.state.multiSelection),a=Ae.default.state;if(i&&a.stores.length>0){const e=i.store.getValue(),a=z.QaF(e),s=m.p4(a.substring(0,a.indexOf(n.text))).length,l=s+m.p4(n.text).length;if(i.store.isTable(j.iU)||i.store.isTable(U.x_)){if(Ye.KT({environment:t,blockStore:Ae.default.state.stores[0],textStore:i.store,textValueBeforePaste:o,url:n.url,urlSelection:{startIndex:s,endIndex:l}}))return;if(J.QZ({environment:t,textStore:i.store,blockStore:Ae.default.state.stores[0],oldTextValue:o,url:n.url,urlSelection:{startIndex:s,endIndex:l}}))return}r.default.afterNextFlush((()=>{let e=n.url;try{e=decodeURIComponent(n.url)}catch(r){y.log({level:"info",from:"clipboardActions",type:"activateMenuFromLink",error:{message:`Encountered error in decodeURIComponent ${n.url}`}})}Ue.KT({environment:t,textStore:i.store,oldTextValue:o,url:e,urlSelection:{startIndex:s,endIndex:l}})}))}}({environment:t,hyperlink:p,oldTextValue:u.value,transaction:a})}function Rt(e){if(1!==e.length)return;const t=e[0];if(!z.AJd(t))return;const[n,o]=t;if(1!==o.length)return;const i=o[0];if(!z.j0F(i))return;return{text:n,url:z.zW$(i)}}function Dt(e){const{environment:t,clipboardData:n,transaction:o,allowPasteIntoHeaderWithoutChildren:i,selectAll:a}=e;if(Re.default.isEditingComment()||Kt())return!1;if(n.blockSelection.blocks.some((e=>!e.blockSubtree)))return!1;const s=Re.default.state;if("editing"!==s.mode)return!1;const c=s.multiSelection.start.store;if(!c.isTable(j.iU))return!1;const d=(0,ge.sQ)(c);if(!d)return!1;if(c!==d.getBlockTitleStore())return!1;const u=d.getType(),p=d.getFormat();if(!u)return!1;if(!((0,l.Um)(u,p)||i&&(0,l.zp)(u)))return!1;if(i&&(0,l.zp)(u)){var m;const e=n.blockSelection.blocks[0],t=null==e?void 0:e.blockId,o=null==e?void 0:e.blockSubtree,i=t&&o?o.getValue({id:t,table:"block"}):void 0;if(Boolean(null==i||null===(m=i.content)||void 0===m?void 0:m.length))return!1}const f=(0,fe.dq)({includeNonSelectableListContainer:!0});if(!f)return!1;const g=(0,fe.v5)(d,[f]);if(!g)return!1;let h=0;for(let r=g.length-1;r>=0;r--){const e=g[r].value.store,t=_e.C.findSelectableFromStore(e),n=e.getModel();if(null!=n&&n.isType(l.$t)||t&&!t.props.canSelect){h=r;break}}const v=g.slice(h);if(0===v.length)return!1;const b=v[0].value.store,y=b.pointer.spaceId,S=b.isInsideTemplate()||b.isInsideFactoryOrDuplicateBlocksAction(),w=n.blockSelection.blocks.map((e=>{var n;let{blockId:i,blockSubtree:r}=e;if(!r)throw new Error("Missing data for local duplicate block during paste");const a=(null===(n=r.getValue({table:j.iU,id:i}))||void 0===n?void 0:n.type)===l.Ti.factory,s=!(S||a),c=Pe.G.createChildStore(b,{table:j.iU,id:i}),d=je.E9({environment:t,sourceBlockId:i,targetBlockPointer:{table:j.iU,id:(0,D.ZP)(),spaceId:y},sourceBlockSubtree:r,targetInMemoryRecordCache:b.inMemoryRecordCache,addCopyName:(0,he.Z)(c),deepCopyTransclusionContainers:!1,resolveTemplateVariables:s,transaction:o,useCrdt:b.useCrdt()}),u=d.targetBlock.getType();return u&&Be.W2j(t,{from:"paste",type:u,new_page_id:"page"===u?d.targetBlock.id:void 0}),d})),k=n.multiTextSelection.start.pointerPath,I=n.multiTextSelection.end.pointerPath,C=[],x=[],T=Math.max(k.length,I.length),M=(v[v.length-T]||v[0]).value.store,P=(0,W.MW)({node:n.tree,recordStoreParent:M},(e=>{let{node:t,recordStoreParent:n}=e;const o=((e,t)=>{let n;for(const{originalToDuplicate:o}of w)if(n=o.get(t),n)break;if(n)return Pe.G.createChildStore(e,n)})(n,t.value),i=C.length<k.length?k[C.length]:void 0,r=x.length<I.length?I[x.length]:void 0;let a=!1;if((null==i?void 0:i.id)===t.value.id&&(a=!0,C.push(o)),(null==r?void 0:r.id)===t.value.id&&(a=!0,x.push(o)),!a)return{value:{store:o}};const s=(null==o?void 0:o.getContentStore())||b;return{value:{store:o},children:t.children.map((e=>({node:e,recordStoreParent:s})))}}));if(C.length!==k.length||0===C.length)throw new Error(`Failed to hydrate start path during paste (found ${C.length} of ${k.length})`);if(x.length!==I.length||0===x.length)throw new Error(`Failed to hydrate end path during paste (found ${x.length} of ${I.length})`);const A=C[C.length-1],R=x[x.length-1];if(!A||!R)throw new Error(`Failed to hydrate position during paste (${A?"":"missing start"} ${R?"":"missing end"})`);const B=(0,W.DY)([P],(e=>e.value.store===A)),E=(0,W.DY)([P],(e=>e.value.store===R)),F=B&&E&&G.T.fromNearestCommonAncestor(B,E);if(!F)throw new Error(`Failed to build range for paths: ${B?"":"missing start"} ${E?"":"missing end"}`);Ge.pz({environment:t,multiSelection:s.multiSelection,transaction:o});const Z=Re.default.state,L="editing"===Z.mode?Z.multiSelection:s.multiSelection;if((0,me.PF)(d)&&0===n.multiTextSelection.start.textIndex){const e=A.getType();e&&(0,l.Zu)(e)&&Qe.Cj({environment:t,blocks:[d],blockType:e,transaction:o})}let V=0;const U=L.end.store,O=L.end.index,N=(0,ge.mh)(R);if(N){V=z.eeV(N.getValue()).length;const e=(0,Q.TO)((0,ge.sQ)(U)),n=(0,Q.TO)((0,ge.sQ)(N));ne.Ls({store:U,blockStore:e})&&ne.Ls({store:N,blockStore:n})?te.Wc({sourceBlockStore:e,targetBlockStore:n,splitAtGraphemeIndex:O,transaction:o,moveIntoNewBlock:!1}):Ge.gc({environment:t,sourceStore:U,sourceIndex:O,targetStore:N,targetIndex:V,transaction:o})}else Ge.pe({environment:t,transaction:o,store:U,selection:{startIndex:O,endIndex:1/0}});let H=z.OAI(n.multiTextSelection.start.copiedText);S||(H=z.KV2(H,{currentUserId:t.currentUser.id,currentTimeZone:(0,_.r)()})),Ge.mM({environment:t,index:L.start.index,store:L.start.store,tokens:H,transaction:o});for(const r of F.iterateInsertionAt(v))(0,fe.D_)({transaction:o,treeOperation:r,deleteFrom:"tree-parent"}),q.f.applyMutable(r);if(n.blockSelection.wasContiguousSelection&&n.blockSelection.blocks.length>0&&!d.hasContent())for(const r of A.getContentStores())X.R3({parent:d.getContentStore(),append:r,transaction:o});const K=new Set;for(const{originalToDuplicate:r}of w){const e=r.getByTable(j.iU);for(const{value:t}of e){if(!t||K.has(t.id))continue;K.add(t.id);const e=Pe.G.createChildStore(A,t);(0,ue.qA)(e).find((e=>e.id===b.id))||(e.id,A.id,Oe.YM({childStore:e,parentStore:b,alive:!1,transaction:o}))}}return r.default.afterNextFlush((()=>{const e=(0,fe.kC)({rootStore:b,root:f,target:F.end}),t=e&&(0,ge.mh)(e[e.length-1]);if(!t)return;const n={start:{index:a?L.start.index:V,store:a?L.start.store:t},end:{index:V,store:t}};Ke.NA({multiSelection:n})})),!0}function Bt(e){const{environment:t,blocks:n,transaction:o,replaceEmptyTextBlock:i}=e,r=Ae.default.state.stores;if(1===r.length){const e=r[0];if(e.getType()&&e.isType(l.hY)&&function(e){if("editing"!==Re.default.state.mode||!Re.default.state.multiSelection)return!1;const t=(0,ce.QY)(Re.default.state.multiSelection);if(!t)return!1;return t.store===e.getTitleStore()}(e)){const i=e.getContentStore(),r=x.d9(n).reverse().map((e=>X.Ce({parent:i,prepend:e,transaction:o}).child));return He.Z5({environment:t,stores:r}),r}}return ze.is({selection:r,environment:t,blocks:n,transaction:o,replaceEmptyTextBlock:i})}function Et(e,t,n,o){const i=(0,ie.RM)();if(!i)return;const a=Ae.default.state.stores,s=0!==a.length?a[0].pointer.spaceId:i.pointer.spaceId,c=0!==a.length?a[0].useCrdt():i.useCrdt();let d=function(e,t){if("cut"!==t.action||!xe.default.checkGate("convert_cut_paste_to_move"))return;const n=[];for(const o of t.blocks){const t=Pe.G.createChildStore(e,{table:j.iU,id:o.blockId});if(!t.isReady())return;const i=t.getModel();if(!i)return;if(i.getSpaceId()!==e.getSpaceId())return;if(!1!==i.alive)return;n.push(t)}return n}(i,t);d||(d=t.blocks.map((t=>{var n;let{blockId:r,blockSubtree:a,snapshotData:l}=t;const d=Pe.G.createChildStore(i,{table:j.iU,id:r});let u;if(d.isDefined())u=d.getModel();else{const e=null==a?void 0:a.getValue({table:j.iU,id:r});u=e&&M.kk.fromBlock(e)}const p=!(i.isInsideTemplate()||$t()||i.isInsideFactoryOrDuplicateBlocksAction()||null!==(n=u)&&void 0!==n&&n.isTemplateVariableContainerBlock());if(a){const t=je.E9({environment:e,sourceBlockId:r,targetBlockPointer:{table:j.iU,spaceId:s,id:(0,D.ZP)()},sourceBlockSubtree:a,targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,he.Z)(d),deepCopyTransclusionContainers:!1,resolveTemplateVariables:p,transaction:o,useCrdt:c}).targetBlock,n=t.getType();return n&&Be.W2j(e,{from:"paste",type:n,new_page_id:"page"===n?t.id:void 0}),t}{Ce.Z.state.online||Le.showErrorMessage(le.default.formatMessage(Je.offlineError));const[t,n]=je.WJ({environment:e,sourceBlocks:[{id:r,spaceId:(0,O.C)(void 0)}],targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,he.Z)(d),transaction:o,deepCopyTransclusionContainers:!1,resolveTemplateVariables:p,snapshotData:l,targetSpaceId:(0,O.C)(d.pointer.spaceId),convertExternalObjectInstancesToPlaceholders:!1,useCrdt:c}),i=t[0],a=i.getType();return n.then((t=>{t?Le.showErrorMessage(t):a&&Be.W2j(e,{from:"paste",type:a,new_page_id:"page"===a?i.id:void 0})})),i}}))),Bt({environment:e,blocks:d,transaction:o,replaceEmptyTextBlock:!0});const u=Ae.default.state.stores,p=u.length>0?u:[i],m=t.blocks.map((e=>{const t=p.length>0?p[0]:function(e){return e.isCollectionView()?e.getCollectionViewCollectionStore()||e:e.getContentStore()}(i);return Pe.G.createChildStore(t,{table:j.iU,id:e.blockId})}));r.default.afterNextFlush((async()=>{await Promise.all(p.map((e=>e.waitUntil((()=>{const t=e.getType();return Boolean(t&&t!==l.Ti.copyIndicator)}))))),await Promise.all(m.map((e=>e.load()))),n&&Ee.RH({environment:e,blocks:p,pageSource:n,copiedStores:m,action:t.action,wasContiguousSelection:t.wasContiguousSelection,rootStore:i})&&Ee.kE({copiedStores:m,blocks:p,pageSource:n})}))}function Ft(e){const{environment:t,disableEmbedMenu:n,transaction:o,overwrite:i,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c=e.text.trim(),d=c.includes("\n"),u=Re.default.state,p=qt(u);d&&"inline"!==p||"editing"!==u.mode?i?function(e){const{environment:t,text:n,transaction:o,selectAll:i,markdownOptions:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=wt({markdown:n,markdownOptions:r,markdownLinkifyIt:a});if(!l)return;let c=Lt({html:l,wrapInEmptyBlocks:!1,tinyMceMicrosoftWordPasteFilter:s});c||(c=Lt({html:l,wrapInEmptyBlocks:!0,tinyMceMicrosoftWordPasteFilter:s}));if(!c)return;Dt({environment:t,clipboardData:c,transaction:o,allowPasteIntoHeaderWithoutChildren:!0,selectAll:i})}({environment:t,text:c,transaction:o,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}):c&&function(e){const{environment:t,text:n,transaction:o,markdownOptions:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}=e,s=wt({markdown:n,markdownOptions:i,markdownLinkifyIt:r});if(s)Ut({environment:t,html:s,transaction:o,tinyMceMicrosoftWordPasteFilter:a})}({environment:t,text:c,transaction:o,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}):function(e){const{environment:t,text:n,disableEmbedMenu:o,transaction:i,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===Re.default.state.mode&&Re.default.state.multiSelection;if(c){const e=(0,ce.QY)(c);if(e&&function(e){const t=Re.default.state;return"editing"===t.mode&&!(0,ce.iG)(t.multiSelection)&&(0,ce.qS)(t.multiSelection)&&C.B(e,"url")}(n))Qt({environment:t,text:n,transaction:i,editingSelection:e,selectAll:r});else if((0,ye.Ld)("c"))Ge.hJ({environment:t,multiSelection:c,string:n,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0,transaction:i,selectAll:r});else{const e=s&&T.lM({...s,markdown:n,plugin:null==a?void 0:a.plugin});if(!e)return;Vt({environment:t,html:e,transaction:i,stripText:!0,disableEmbedMenu:o,selectAll:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})}}}({environment:t,text:c,disableEmbedMenu:n,transaction:o,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})}function Zt(e,t){const n=e.getValue({table:j.iU,id:t});if(!n)return;const o={table:j.iU,id:t,spaceId:n.space_id},i=(n.content??[]).map((t=>Zt(e,t))).filter(K.$K);return new W.mp(o,i)}function Lt(e){var t,n,o,i;const{html:r,wrapInEmptyBlocks:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=Nt({html:r,tinyMceMicrosoftWordPasteFilter:s,useCrdt:!1});if(!l)return;let{allOperations:c,rootContentIds:d}=l;if(a){const e=Ot(),t=Ot();if(!e||!t)return;c=[e.operation,...c,t.operation],d=[e.id,...d,t.id]}const u=E.Ak.create();(0,A.FS)({recordMap:u,operations:c,updateOnly:!1});const p=[];for(const _ of d)p.push({blockId:_,snapshotData:void 0,blockSubtree:u.clone()});const m=new W.mp({table:j.iU,id:(0,D.ZP)(),spaceId:void 0},d.map((e=>Zt(u,e))).filter(K.$K));if(0===m.children.length)return;const f=m.children[0],g=null===(t=(0,W.DY)([m],(e=>e===f)))||void 0===t?void 0:t.map((e=>e.value)),h=null===(n=u.getValue(f.value))||void 0===n||null===(n=n.properties)||void 0===n?void 0:n.title,v=(0,W.CY)(m),b=null===(o=(0,W.DY)([m],(e=>e===v)))||void 0===o?void 0:o.map((e=>e.value)),y=null===(i=u.getValue(v.value))||void 0===i||null===(i=i.properties)||void 0===i?void 0:i.title,S=y?z.QaF(y).length:0;return h&&g&&y&&b?{blockSelection:{blocks:p,wasContiguousSelection:!0,action:"copy"},tree:m,multiTextSelection:{start:{textIndex:0,copiedText:h,attributePath:["properties","title"],pointerPath:g},end:{textIndex:S,copiedText:y,attributePath:["properties","title"],pointerPath:b}},action:"copy"}:void 0}function jt(e){const{text:t,html:n,stripText:o,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:r}=e,a=n||(t?wt({markdown:t,markdownLinkifyIt:i}):void 0);if(!a)return;const s=document.createElement("div");return s.innerHTML=Ht({html:a,tinyMceMicrosoftWordPasteFilter:r}),w.xR({node:s,window,stripText:o,emojiData:oe.Z.state})}function Vt(e){const{environment:t,html:n,transaction:o,stripText:i,disableEmbedMenu:r,selectAll:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===Re.default.state.mode&&Re.default.state.multiSelection;if(c){const e=jt({html:n,stripText:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l});if(!e)return;const d=1===e.length;if(d){if(d&&(!e[0][1]||0===e[0][1].length)){const n=e[0][0];return void Ge.hJ({environment:t,multiSelection:c,string:n,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o,selectAll:a})}const n=(0,ce.QY)(c);if(n&&!(0,ce.iG)(c)){const[,i]=e[0],r=i&&z.rlz(i);if(r){return void Qt({environment:t,text:z.zW$(r),transaction:o,editingSelection:n,selectAll:a})}}}Ge.pz({environment:t,multiSelection:c,transaction:o}),At({environment:t,store:c.start.store,tokens:e,index:c.start.index,transaction:o,disableEmbedMenu:r,multiTextSelection:c,selectAll:a})}}function Ut(e){const{environment:t,html:n,transaction:o,tinyMceMicrosoftWordPasteFilter:i}=e,a=ie.RM();if(!a)return;const s=Nt({html:n,tinyMceMicrosoftWordPasteFilter:i,useCrdt:a.useCrdt()});if(!s)return;const{allOperations:c,rootContentIds:d}=s;for(const r of c){const e=(0,Pe.Kv)(a,r.pointer);$e.applyOperation({store:e,operation:r,transaction:o})}const u=d.map((e=>Pe.G.createChildStore(a,{table:j.iU,id:e})));u.forEach((e=>{const n=e.getType();n&&Be.W2j(t,{from:"paste",type:n})}));const p=Bt({environment:t,blocks:u,transaction:o,replaceEmptyTextBlock:!0}).slice().reverse();return r.default.afterNextFlush((()=>{const e=p.map((e=>{if(e.getType()!==l.Ti.text)return;const n=Rt(e.getTitleValue());if(!n)return;const o=(0,L.Wj)({url:n.url,baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,isMobile:t.device.isMobile,protocol:ee.default.protocol,currentUrl:window.location.href});return"page"===o.name?o:void 0})).filter(K.$K);e.length===p.length&&Ee._x({environment:t,rootStore:a,blocks:p,copiedLinks:e})})),u}function Ot(){const e=(0,D.ZP)(),{currentUserStore:t}=ke.default.state,n=ie.RM();if(!t||!n)return;const o=t.id;if(!o)return;const i=n.id,r=n.pointer.spaceId;return{operation:{pointer:{table:"block",id:e,spaceId:r},command:"set",path:[],args:{id:e,version:1,type:"text",properties:{title:[[""]]},parent_id:i,parent_table:"block",space_id:r,created_by_table:"notion_user",created_by_id:o,created_time:Date.now(),last_edited_by_table:"notion_user",last_edited_by_id:o,last_edited_time:Date.now(),alive:!0}},id:e}}function Nt(e){const{useCrdt:t,...n}=e,o=document.createElement("div");o.innerHTML=Ht(n);const{currentUserStore:i}=ke.default.state,r=ie.RM();if(!i||!r)return;const s=i.getValue();if(!s)return;const l=w.$O({actor:(0,a.dp)(s),parentId:r.id,parentTable:"block",spaceId:r.pointer.spaceId,rootNode:o,importFileMap:{},window,secureFileS3Url:ee.default.secureFileS3.url,secureFileS3UrlV2:ee.default.secureFileS3V2.url,ignoreBlockCount:!1,intl:le.default.getIntl(),randomID:D.ZP,randomShortID:B.ZP,isPhoneNumber:Wt,emojiData:oe.Z.state});if(!t)return l;const{allOperations:c,rootContentIds:d}=l;return{allOperations:c.map((e=>{var t;if(e.pointer.table!==j.iU||"set"!==e.command&&"update"!==e.command)return e;if(e.path.length>0)throw new Error("Block operation should modify root record.");if(null===(t=e.args.properties)||void 0===t||!t.title)return e;const n=x.Xh(e);return n.args.format={...n.args.format,...u.K(e.args.id,e.args.properties.title)},n})),rootContentIds:d}}function zt(e){return/schemas-microsoft-com:office/.test(e)||/xmlns:m="http:\/\/schemas.microsoft.com\/office\/2004\/12\/omml"/.test(e)}function Ht(e){const{html:t,tinyMceMicrosoftWordPasteFilter:n}=e;return i().sanitize(n&&zt(t)?n(t):t)}function Wt(e){return/^(\+\d{1,2}\s)?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function qt(e){const t="editing"===e.mode&&e.multiSelection;if(!t)return;const n=Se.E.findEditableWithStore(t.start.store),o=null==n?void 0:n.props;return o&&!o.disabled?o.pasteBehavior:void 0}function Gt(){if("editing"!==Re.default.state.mode)return;const e=Re.default.state.multiSelection.start,t=e.store.path;if("formula"!==t[t.length-1])return;const n=e.store.getRecordStoreAtRootPath();if(n.table!==j.iU)return;const o=n.getParentId();if(!o)return;const i={table:V.v,id:o,spaceId:n.getSpaceId()},r=n.getRecordModel(i);return r?{parentCollection:r,start:e,getRecordModel:n.getRecordModel}:void 0}function Kt(){if("editing"!==Re.default.state.mode)return!1;const e=(0,ce.QY)(Re.default.state.multiSelection);if(!e)return!1;if(!e.store.isTable(j.iU))return!1;if(0===Ae.default.state.stores.length)return!1;const t=e.store.getRecordStoreAtRootPath().getValue();return Boolean(t&&t.type===l.Ti.code)}function $t(){const e=Ae.default.state.stores;if("editing"!==Re.default.state.mode)return e.length>0&&e[0].isInsideFactoryOrDuplicateBlocksAction();if(0===e.length)return!1;const{multiSelection:t}=Re.default.state,n=t.start.store;if(!n.isTable(j.iU))return!1;const o=ae.W(n);return Boolean(o)}function Qt(e){const{text:t,transaction:n,environment:o,editingSelection:i,selectAll:r}=e,a=(0,L.Wj)({url:t,baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,isMobile:o.device.isMobile,protocol:ee.default.protocol,currentUrl:window.location.href}),s="page"===a.name?(0,k.nR)({pageId:a.blockId,peekViewBlockId:a.peekViewBlockId,peekMode:a.peekMode,discussionId:a.discussionId,scrollToBlockId:a.scrollToBlockId,collectionViewId:a.collectionViewId}):t;Ge.Be({environment:o,store:i.store,selection:i.selection,type:"a",transaction:n}),Ge.i8({environment:o,store:i.store,selection:i.selection,annotation:["a",s],transaction:n}),Ke.Z5({store:i.store,selection:{startIndex:r?i.selection.startIndex:i.selection.endIndex,endIndex:i.selection.endIndex}})}const Yt=/\<\!-- wp:/;const Jt=/\u2028/g;function Xt(e){const{environment:t,event:n,disableEmbedMenu:o,transaction:i,onPasteFiles:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e;if(n.preventDefault(),Ke.NG(t),!n.clipboardData)return;if(!De.M_(t))return;const c=vt(n.clipboardData,t.device),{text:d,html:u,multiTextSelectionData:p,textSelectionData:f,blockSelectionData:g,isFromMicrosoftOffice:h}=St({clipboardData:c,tinyMceMicrosoftWordPasteFilter:s}),v=yt(c,it,dt),y=function(e){return e.clipboardData?e.clipboardData.items?x.oA(x.UI(e.clipboardData.items,(e=>{const t=e.getAsFile();if(t&&t.size>0)return new File([t],"Untitled",{type:e.type})}))):m.p4(e.clipboardData.files):[]}(n),S=qt(Re.default.state),w=(null==g?void 0:g.action)||(null==p?void 0:p.action)||(null==f?void 0:f.action);i.annotateWithUserAction("cut"===w?"paste.from_cut":re.xF);const k=d.includes("\n"),I=function(e){const t=yt(e,rt,ut),n=null==t?void 0:t.mode;if(!n)return;return et[n]||"Plain Text"}(c),C=k&&I&&"inline"!==S&&!Kt()?function(e){const{codeLanguage:t,environment:n,transaction:o}=e,i=Re.default.state,r="editing"===i.mode&&i.multiSelection,a=Ae.default.state.stores;if(!r&&0===a.length)return;let s,c,d;r?(s=r.start.store,c=r.end.store,d=(0,ge.sQ)(c)):(s=a[0],c=a[a.length-1],d=c);if(!d)return;let u=d;if((0,me.PF)(d))!function(e){const{block:t,environment:n,transaction:o,codeLanguage:i}=e;Qe.Cj({environment:n,blocks:[t],blockType:"code",transaction:o}),Fe.E5({blocks:[t],language:i,transaction:o})}({block:d,environment:n,transaction:o,codeLanguage:t});else{const e=(0,ge.sQ)(d);if(!e)return;const t=s.inMemoryRecordCache;if(!t)return;u=Ne.j4({environment:n,type:l.Ti.code,inMemoryRecordCache:t,transaction:o,spaceId:e.pointer.spaceId,useCrdt:e.useCrdt()}),X.BE({parent:e.getContentStore(),after:c,insert:u,transaction:o})}be.clear(n);const p=(0,ge.mh)(u);p&&Ke.N_({store:p});return u}({codeLanguage:I,environment:t,transaction:i}):void 0;Be.bOx(t,{pastedText:d,source:"editor_paste"});const T=we.g$.getSimpleTableCellFromTextSelection(),M=n.clipboardData.getData(ve.mH),P=Gt();if(!h&&y.length>0)r({environment:t,files:y,transaction:i});else if(Kt()&&!f)en(t,d,i);else if(C)en(t,d,i);else if(P){const{parentCollection:e,start:n}=P,o=[[d]],r=e;if(!r)return void en(t,d,i);const a=Re.default.state;"multiSelection"in a&&Ge.pz({environment:t,multiSelection:a.multiSelection,transaction:i});const s=(0,b.UQ)(o,r,P.getRecordModel);Ge.mM({environment:t,tokens:s,store:n.store,index:n.index,transaction:i})}else if(p){(function(e){const{environment:t,transaction:n,multiTextSelectionData:o,disableEmbedMenu:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}=e,s=e.pasteBehavior||"inline",l=e.html||wt({markdown:e.text,markdownLinkifyIt:r});if("editing"===Re.default.state.mode)switch(s){case"inline":return!!l&&(Vt({environment:t,html:l,transaction:n,stripText:!1,disableEmbedMenu:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}),!0);case"block":return Dt({environment:t,clipboardData:o,transaction:n});default:(0,K.t1)(s)}})({multiTextSelectionData:p,environment:t,html:u,text:d,transaction:i,disableEmbedMenu:o,pasteBehavior:S,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s})||Et(t,p.blockSelection,v,i)}else if(f&&f.editing)!function(e){const{environment:t,textSelectionData:n,transaction:o,disableEmbedMenu:i}=e,r=Ae.default.getCurrentRecordCache(),{editing:a,selection:s}=n;let{tokensInsideRange:c}=z.xrQ(a,s.startIndex,s.endIndex);c=z.OAI(c);const d=(0,ie.RM)();if(d&&!(d.isInsideTemplate()||$t()||d.isInsideFactoryOrDuplicateBlocksAction())&&(c=z.KV2(c,{currentUserId:t.currentUser.id,currentTimeZone:(0,_.r)()})),Kt()){const e=z.vNd(c);e&&(c=e)}const u="editing"===Re.default.state.mode&&Re.default.state.multiSelection;if(u){Ge.pz({environment:t,multiSelection:u,transaction:o});const e=Re.default.state;if("editing"===e.mode){const r=e.multiSelection;if(n.blockType&&0===s.startIndex){const e=(0,ge.sQ)(r.start.store);e&&"page"!==n.blockType&&(0,me.PF)(e)&&Qe.Cj({environment:t,blocks:[e],blockType:n.blockType,transaction:o})}At({environment:t,store:r.end.store,tokens:c,index:r.end.index,transaction:o,disableEmbedMenu:i,multiTextSelection:u})}}else if(r){var p,m;const e=Ae.default.state.stores,n=Ne.j4({environment:t,type:l.Ti.text,inMemoryRecordCache:r,transaction:o,spaceId:0!==e.length?e[e.length-1].pointer.spaceId:null===(p=ie.RM())||void 0===p?void 0:p.pointer.spaceId,useCrdt:0!==e.length?e[e.length-1].useCrdt():(null===(m=ie.RM())||void 0===m?void 0:m.useCrdt())??!1}),i=n.getTitleStore();i&&Ge.mM({environment:t,store:i,tokens:c,index:0,transaction:o}),Be.W2j(t,{from:"paste",type:l.Ti.text}),Bt({environment:t,blocks:[n],transaction:o,replaceEmptyTextBlock:!1})}}({environment:t,textSelectionData:f,transaction:i,disableEmbedMenu:o});else if(g&&g.blocks.length>0&&"inline"!==S)Et(t,g,v,i);else if(T&&M){const{simpleTableStore:e,selection:o}=T.props,r=we.g$.getColumnOrder(e);o&&r&&qe.j0({environment:t,simpleTableStore:e,selection:o,currentRows:e.getContentStores(),columnOrder:r,event:n,transaction:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s})}else if(u)if(T){const{simpleTableStore:e,selection:o}=T.props,r=we.g$.getColumnOrder(e);o&&r&&qe.j0({environment:t,simpleTableStore:e,selection:o,currentRows:e.getContentStores(),columnOrder:r,event:n,transaction:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s})}else k&&"inline"!==S?Ut({environment:t,html:u,transaction:i,tinyMceMicrosoftWordPasteFilter:s}):Vt({environment:t,html:u,transaction:i,stripText:!1,disableEmbedMenu:o,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});else Ft({environment:t,text:d,disableEmbedMenu:o,transaction:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});Me.Z.setKeyboardMode(!0)}function en(e,t,n){const o="editing"===Re.default.state.mode&&Re.default.state.multiSelection;o&&Ge.hJ({environment:e,multiSelection:o,string:t,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:n})}function tn(e){const t=e.isType(l.Ti.alias)?e.getAliasTargetStore():e;if(t){if(!(t instanceof Pe.G)){const e=ue.uJ(t)[0],n=t.getRecordStoreUIParent();if(e&&!(e instanceof Pe.zX)&&n)return(0,se.Hu)({store:e,scrollToBlockId:n.id,fullyQualified:!0,pageVisitSource:s.tY.CopyLink});const o=t.getValue();if(!o)return;const i=(0,Pe.Kv)(t,{table:o.parent_table,id:o.parent_id,spaceId:o.space_id}).getValue();if(!i)return;const r=Pe.G.createChildStore(t,{table:j.iU,id:i.parent_id}),a=r.getNavigableBlockStore();if(!a)return;return(0,se.Hu)({store:a,scrollToBlockId:r.id===t.id?void 0:t.id,fullyQualified:!0,pageVisitSource:s.tY.CopyLink})}{const e=t.getNavigableBlockStore();if(e)return(0,se.Hu)({store:e,scrollToBlockId:e.id===t.id?void 0:t.id,fullyQualified:!0,pageVisitSource:s.tY.CopyLink})}}}function nn(e){const{environment:t,blocks:n}=e,o=n[0];Ze.wG(),we.HM.clearSelection();const i=tn(o);if(i){ln({environment:t,stringValue:i,copiedMessage:o.isPageBlock()?Xe.copiedLinkToClipboard:Xe.copiedBlockLinkToClipboard})}}function on(e){const{environment:t,blocks:n}=e,o=n[0];Ze.wG(),we.HM.clearSelection();const i=tn(o),r=function(e,t){var n;const o=tn(t);if(!o)return;const i=e.currentUser.id,r=(0,g.Ho)({blockId:t.id,intl:le.default.getIntl(),getRecordValue:t.inMemoryRecordCache.makeGetRecordValueFn(i),userTimeZone:(0,_.r)()}),a=null===(n=t.getBlockIconStore())||void 0===n?void 0:n.getValue(),s=[(0,I.Z)(a)?a:void 0,r].filter(K.$K).join(" ");return s?`<a href="${o}"><span>${s}</span></a>`:o}(t,o);if(i&&r){sn({environment:t,stringValue:i,htmlValue:r,copiedMessage:Xe.copiedLinkToClipboard})}}function rn(e){const{environment:t,blocks:n}=e;if(n.length<2)return nn(e);Ze.wG(),we.HM.clearSelection();const o=n.map(tn).filter(K.$K);if(o.some(Boolean)){const e=o.length>1?Xe.copiedLinksToClipboard:Xe.copiedLinkToClipboard;ln({environment:t,stringValue:o.join("\n\n"),copiedMessage:e})}}function an(e){const{environment:t,blocks:n}=e,o=n[0];if(!o.isDefined())return;const i=o.getModel(),r=o.getProperties(),a=o.getFormat();let s;if(o.isType(l.Ti.bookmark))s=null==r?void 0:r.link,s=z.QaF(s);else if(i.isType(l.Ok))s=null==r?void 0:r.source,s=z.QaF(s);else if(o.isType(l.Ti.file))s=null==r?void 0:r.source,s=z.QaF(s);else if(o.isType(l.Ti.externalObjectInstance)||o.isType(l.Ti.externalObjectInstancePage))s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);else if(o.isType(l.Ti.collectionView)){var c;const e=null===(c=o.getCollectionViewCollectionStore())||void 0===c?void 0:c.getValue();var d;if(e&&(0,h.Gq)(e))s=null===(d=e.format)||void 0===d?void 0:d.original_url}else{if(!o.isType(l.Ti.alias))return;s=null==a?void 0:a.comment_alias_url}if(!s)return;if(v.E$(s,[ee.default.secureFileS3.url,ee.default.secureFileS3V2.url]))return void y.log({level:"error",from:"clipboardActions",type:"copyDirectLinkToContent",error:{message:"Attempted to copy a direct signed url for S3-housed content."}});if(s=$.yn(s),!s)return;Ze.wG(),we.HM.clearSelection();ln({environment:t,stringValue:s,copiedMessage:Xe.copiedLinkToClipboard})}function sn(e){return cn(e)}function ln(e){return cn(e)}async function cn(e){const{environment:t,htmlValue:n,stringValue:o,copiedMessage:i,showCopyModal:r}=e;function a(){He.ZH(t),Ie.Z.setState({...Ie.Z.state,active:!0,stringValue:o})}if(r)a();else try{if("undefined"==typeof ClipboardItem)await navigator.clipboard.writeText(o);else{const e={"text/plain":new Blob([o],{type:"text/plain"})};n&&(e["text/html"]=new Blob([n],{type:"text/html"}));const t=new ClipboardItem(e);await navigator.clipboard.write([t])}We.oV({label:le.default.formatMessage(i)})}catch{a()}}function dn(){document.queryCommandSupported("copy")&&document.execCommand("copy")}async function un(e,t){let n;n="string"==typeof t?t:JSON.stringify(t),n&&await ln({environment:e,stringValue:n,copiedMessage:Xe.copiedToClipboard})}function pn(e){const{environment:t,textSelection:n,markdownSerializationOptions:o,markdownLinkifyIt:i}=e,r=(0,ce.QY)(n);if(r&&r.selection.startIndex!==r.selection.endIndex)return function(e){const{environment:t,singleStoreTextSelection:n,markdownSerializationOptions:o}=e,{store:i,selection:r}=n,a=t.currentUser.id,l=i.inMemoryRecordCache,c=le.default.getIntl(),d=i.getValue(),u=z.KU1(d,r.startIndex,r.endIndex),m=i.getRecordStoreUIRoot().getValue();if(!m)return;const f={id:m.id,table:j.iU,spaceId:m.space_id},g=l.makeGetRecordValueFn(a);return T.CK({textValue:u,exportArgs:{root:f,navigableBlockId:f.id,renderParentBlockId:void 0,blockId:f.id,userTimeZone:(0,_.r)(),intl:c,getRecordValue:g,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,p.Z)({pageId:t,pageValue:g({table:j.iU,id:t}),baseUrl:ee.default.domainBaseUrl,pageVisitSource:s.tY.Export})},baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,transformAnnotation:null==o?void 0:o.transformAnnotation,transformBlockMapping:null==o?void 0:o.transformBlockMapping}})}({environment:t,singleStoreTextSelection:r,markdownSerializationOptions:o});const a=Ct({environment:t,multiSelection:n,action:"copy"});if(!a)return;const l=n.start.store.inMemoryRecordCache,c=n.start.store.getRecordStoreUIRoot().getValue();if(!c)return;const d=t.currentUser.id,{markdown:u}=(0,re.Ef)({clipboardData:a,rootBlock:{id:c.id,table:j.iU,spaceId:c.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:l.makeGetRecordValueFn(d),markdownSerializationOptions:o,markdownLinkifyIt:i});return u}function mn(e){const{environment:t,inMemoryRecordCache:n,text:o,transaction:i,markdownOptions:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c=wt({markdown:o,markdownOptions:r,markdownLinkifyIt:s});if(!c)return;const d=document.createElement("div");d.innerHTML=Ht({html:c,tinyMceMicrosoftWordPasteFilter:l});const{currentUserStore:u}=ke.default.state,p=ie.RM();if(!u||!p)return;const m=u.getValue();if(!m)return;const{allOperations:f,rootContentIds:g}=w.$O({actor:(0,a.dp)(m),parentId:p.id,parentTable:"block",spaceId:p.pointer.spaceId,rootNode:d,importFileMap:{},window,secureFileS3Url:ee.default.secureFileS3.url,secureFileS3UrlV2:ee.default.secureFileS3V2.url,ignoreBlockCount:!1,intl:le.default.getIntl(),randomID:D.ZP,randomShortID:B.ZP,isPhoneNumber:Wt,emojiData:oe.Z.state});for(const a of f){const e=new Pe.ST({environment:t,pointer:a.pointer,inMemoryRecordCache:n,userId:m.id});$e.applyOperation({store:e,operation:a,transaction:i})}return g.map((e=>new Pe.G(t,{table:j.iU,id:e},{inMemoryRecordCache:n})))}function fn(e){const{environment:t,stores:n,inMemoryRecordCache:o,transaction:i}=e,r=new Pe.ST({environment:t,pointer:{table:j.iU,id:(0,D.ZP)()},inMemoryRecordCache:o,userId:t.currentUser.id,path:["content"]});for(const a of n)X.R3({parent:r,append:a,transaction:i}),Ne.sW({store:a,data:{parent_id:r.id,parent_table:r.table,alive:!0},transaction:i});return r}},42274:(e,t,n)=>{n.d(t,{Cn:()=>d,pZ:()=>c,E5:()=>l});const o={TypeScript:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"babel"}),JavaScript:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"babel"}),GraphQL:async()=>({plugins:[(await n.e(214).then(n.t.bind(n,80214,23))).default],parser:"graphql"}),HTML:async()=>({plugins:[(await n.e(2237).then(n.t.bind(n,72237,23))).default],parser:"html"}),CSS:async()=>({plugins:[(await n.e(5657).then(n.t.bind(n,45657,23))).default],parser:"css"}),Scss:async()=>({plugins:[(await n.e(5657).then(n.t.bind(n,45657,23))).default],parser:"scss"}),JSON:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"json"}),XML:async()=>({plugins:[await Promise.all([n.e(9236),n.e(4219)]).then(n.t.bind(n,84219,23))],parser:"xml",prettierOptionsOverride:{xmlWhitespaceSensitivity:"ignore"}}),Rust:async()=>({plugins:[await Promise.all([n.e(9236),n.e(6484)]).then(n.bind(n,73411))],parser:"jinx-rust"}),SQL:async()=>({plugins:[await Promise.all([n.e(3945),n.e(886)]).then(n.bind(n,80886))],parser:"sqlite"})};var i=n(70203),r=n(96802),a=n(9953),s=n(39699);function l(e){const{blocks:t,language:n,transaction:o}=e,r=i.TPx(n);for(const i of t)a.sW({store:i.getPropertiesStore(),data:{language:r},transaction:o})}function c(e){const{environment:t,blocks:n,previewFormat:o}=e;s.createAndCommit({userAction:"codeBlockActions.setPersistedCodePreviewFormat",environment:t,perform:e=>{r.FH({stores:n,update:{code_preview_format:o},transaction:e})}})}async function d(e){const{codeBlock:t,environment:r}=e,{title:l,language:c}=t.getProperties(),d=i.QaF(l);if(!d||0===d.length)return;const u=i.QaF(c),p=await async function(e){const{codeSnippet:t,language:i}=e,r=o[i];if(!r)return;const{parser:a,plugins:s,prettierOptionsOverride:l}=await r();let c="";try{c=(await n.e(3945).then(n.t.bind(n,73945,23))).format(t,{parser:a,plugins:s,...l})}finally{if(!c||c===t)return}return c=function(e){const t=e.split("\n");return t.length>0&&""===t[t.length-1].trim()&&t.pop(),t.join("\n")}(c),c}({codeSnippet:d,language:u});if(!p)return;const m=i.TPx(p);s.createAndCommit({userAction:"codeBlockActions.formatCode",environment:r,perform:e=>{a.sW({store:t.getPropertiesStore(),data:{title:m},transaction:e})}})}},74882:(e,t,n)=>{n.d(t,{K:()=>a});var o=n(68626),i=n(6287),r=n(54642);async function a(e){const{environment:t,collectionStore:n}=e,a={id:n.id,table:i.v,spaceId:n.getSpaceId()},s=await r.suggestRecordKey(t,{...a,shouldSetSuccessfullySuggestedRecord:!0});if("success"===s.type)return s.data.key;o.log({level:"error",from:"collectionAutoIncrementIdActions.suggestRecordKeyResponse",type:"JSONParseError",error:{miscDataString:s.error.message}})}},40778:(e,t,n)=>{n.d(t,{mO:()=>w,Ys:()=>k,k7:()=>I,ul:()=>M,iU:()=>C,RD:()=>T,_x:()=>x});n(67294);var o=n(1302),i=n(76205),r=n(14714),a=n(72126),s=n(97880),l=n(64964),c=n(480),d=n(5366),u=n(82007),p=n(6854),m=n(85893);function f(){return(0,m.jsx)(d.FormattedMessage,{defaultMessage:"Changes saved for everyone.",id:"database.filterBar.saved.title"})}function g(e){window.__c={n:"SaveChangesSnackbarUndoButton"};const{collectionContextStore:t,temporaryState:n}=e,o=(0,c.O7)();return(0,m.jsx)(p.Pn,{onClick:()=>{u.Yw(o,!0),l.rN(),C({environment:o,collectionContextStore:t,temporaryState:n})},children:(0,m.jsx)(d.FormattedMessage,{defaultMessage:"Undo",id:"database.filterBar.undo.title"})})}var h=n(97004),v=n(80444),b=n(5149),y=n(45264),S=n(39699),_=n(37181);let w=function(e){return e[e.All=0]="All",e[e.Filters=1]="Filters",e[e.Sorts=2]="Sorts",e}({});function k(e){const{environment:t,collectionContextStore:n,targetCollectionView:o,preventSnackbarNotification:i,type:r,transaction:a}=e,s=n.temporaryState.state,c=n.currentPropertyFiltersStore.state,d=o.getPropertyFiltersStore(),u=(0,h.Zh)(n,"persisted");if(r===w.All||r===w.Filters){u.combinatorFilter&&y.Es({collectionViewStore:o,update:{filter:u.combinatorFilter.value||null},transaction:a});for(const e of u.filters.removed)S.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListRemove",path:d.path,args:{remove:{id:e}}},transaction:a});for(const{id:e,beforeId:t}of u.filters.moveOps){const n=c.find((t=>t.id===e));n&&(t?S.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListBefore",path:d.path,args:{before:{id:t},value:n}},transaction:a}):S.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListAfter",path:d.path,args:{value:n}},transaction:a}))}for(const e of u.filters.updated){const t=c.find((t=>t.id===e));t&&S.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListUpdate",path:d.path,args:{value:t}},transaction:a})}}r!==w.All&&r!==w.Sorts||!u.sorts||y.Es({collectionViewStore:o,update:{sort:u.sorts.value||null},transaction:a}),x({environment:t,collectionContextStore:n,temporaryState:r===w.All?void 0:r===w.Filters?{...s,combinatorFilter:void 0,propertyFilters:void 0}:{...s,sorts:void 0}}),i||l.oV({label:(0,m.jsx)(f,{}),right:(0,m.jsx)(g,{collectionContextStore:n,temporaryState:s})})}function I(e){const{environment:t,intl:n,collectionContextStore:i,transaction:r}=e,a=i.collectionViewStore(),s=i.isFullScreen.state,l=i.isRootChild.state,c=i.isInPeekRenderer.state;if(!a)return;const d=y.tG({environment:t,collectionContextStore:i,collectionViewStore:a,intl:n,collectionSettingsStore:i.settingsStore,transaction:r});d&&(k({environment:t,type:w.All,collectionContextStore:i,targetCollectionView:d,transaction:r}),d&&(y.f8({environment:t,collectionContextStore:i,collectionViewId:d.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:c}),o.default.afterNextFlush((()=>{b.r$({collectionContextStore:i,collectionSettingsStore:i.settingsStore,selectViewNameInitial:!0})}))))}function C(e){x(e),function(e){const{environment:t,collectionContextStore:n}=e,o=n.collectionViewStore();if(!o)return;n.blockIsPrivateStore.state&&n.permissionScopes.state.canConfigureBlock&&S.createAndCommit({userAction:"collectionFilterActions.applyTemporaryStateIfPrivate",environment:t,perform:e=>{k({environment:t,collectionContextStore:n,type:w.All,targetCollectionView:o,preventSnackbarNotification:!0,transaction:e})}})}(e)}function x(e){const{environment:t,collectionContextStore:n,temporaryState:o}=e,i=n.collectionViewStore();if(!i)return;const r=t.currentUser.id;n.temporaryState.setState(o||{}),y.bu({currentUserId:r,collectionViewId:i.id,temporaryState:o}),n.groupsStore.resetAllLimits()}function T(e){const{environment:t,seen:n}=e,{currentUserSettingsStore:o}=v.default.state;o&&S.createAndCommit({userAction:"collectionFilterActions.setSeenFiltersIntroTooltip",environment:t,perform:e=>{_.d2({userSettingsStore:o,transaction:e,data:{seen_filters_tooltip:n}})}})}function M(e){var t;let{transaction:n,newGroups:o,collectionContextStore:l,environment:c}=e;const d=l.collectionViewStore(),u=l.currentCombinatorFilterStore.state,p=(0,a.Xh)(u),m=null==p||null===(t=p.filters)||void 0===t?void 0:t.find(i.s9),f=(0,h.yU)(l);if(!(d&&p&&p.filters&&m))return;const g=m.filter.value.filter((e=>"exact"===e.type)).map((e=>e.value)).filter(s.$K),v=o.map((e=>e.value)).filter(r.tL).map((e=>e.value)).filter(r.RA).map((e=>e.id)),b=(0,a.zu)(v,...g);0!==b.length&&(m.filter.value=[...m.filter.value,...b.map((e=>({type:"exact",value:e})))],x({environment:c,collectionContextStore:l,temporaryState:{...l.temporaryState.state,combinatorFilter:{value:p}}}),f||k({environment:c,collectionContextStore:l,type:w.Filters,targetCollectionView:d,preventSnackbarNotification:!0,transaction:n}))}},49865:(e,t,n)=>{n.d(t,{$D:()=>ge,$T:()=>ee,A6:()=>le,BN:()=>J,BO:()=>ae,ID:()=>_e,IW:()=>se,Od:()=>X,V$:()=>ve,by:()=>oe,hz:()=>ce,iE:()=>de,mp:()=>te,o3:()=>fe,tH:()=>Se,tQ:()=>ie,uo:()=>be,w$:()=>ye,yk:()=>ue});n(57658);var o=n(15145),i=n(41432),r=n(14248),a=n(14714),s=n(99036),l=n(45433),c=n(93824),d=n(43593),u=n(42875),p=n(15157),m=n(72126),f=n(21202),g=n(6287),h=n(23867),v=n(70203),b=n(95371),y=n(97880),S=n(5366),_=n(28020),w=n(75079),k=n(81849),I=n(52821),C=n(78316),x=n(77181),T=n(33929),M=n(18245),P=n(80444),A=n(55367),R=n(35661),D=n(8406),B=n(54642),E=n(40778),F=n(98834),Z=n(45264),L=n(47307),j=n(42239),V=n(31781),U=n(96802),O=n(94419),N=n(19785),z=n(9953),H=n(79978),W=n(75018),q=n(42858),G=n(24677),K=n(39699),$=n(27370),Q=n(37181);const Y=(0,S.defineMessages)({removeSortingConfirmation:{id:"databaseActions.removeSortingConfirmationDialog.prompt",defaultMessage:"Would you like to remove sorting?"},removeSortingButton:{id:"databaseActions.removeSortingConfirmationDialog.removeSortingButton.label",defaultMessage:"Remove"},removeSortingCancel:{id:"databaseActions.removeSortingConfirmationDialog.cancelRemoveSortingButton.label",defaultMessage:"Don't remove"}});function J(e){const{store:t,groupsPointer:n,environment:o,collectionContextStore:i,transaction:a}=e;if(!t.isDefined())return;const s=i.normalizedSchemaStore.state,l=i.relativeVariableStore.state;for(const c of n){const e=r.ND({block:t.getModel(),schema:s,propertyMapping:void 0,userFilterContext:{userId:o.currentUser.id,userTimeZone:(0,u.r)(),userStartOfWeek:_.AK.state},group:c,getRecordModel:t.getRecordModel,intl:T.default.getIntl(),relativeVariableResult:l});Object.keys(e).length>0&&z.sW({store:t.getPropertiesStore(),data:e,transaction:a})}}function X(e){const{store:t,transaction:n}=e;N.hh({childStore:t,transaction:n})}function ee(e){var t,n;const{environment:o,collectionContextStore:i,before:r,insertStores:a,store:s,groupsPointer:l,transaction:c,collectionStore:d}=e,u=i.collectionViewStore(),p=(null===(t=i.groupsStore.getGroupState(l))||void 0===t?void 0:t.resultsStore.state)||[],m=null===(n=i.groupsStore.getGroupState(l))||void 0===n?void 0:n.groupUiParentStore;if(!m)return[];const g=[];for(const y of a)te({environment:o,store:y,collectionStore:d,collectionContextStore:i,groupsPointer:l,coerce:!0,transaction:c}),g.push(R.G.createChildStore(m,{table:f.iU,id:y.id}));const h=p.indexOf(s),v=r?h:h+1,b=[...p.slice(0,v),...g,...p.slice(v)];return u&&ne({resultIds:b.map((e=>e.id)),collectionViewStore:u,collectionContextStore:i,transaction:c}),i.groupsStore.setLimitIfGreater(l,b.length),g}function te(e){var t;const{environment:n,store:o,collectionStore:a,collectionContextStore:l,groupsPointer:c,transaction:d,coerce:p,alreadyMovedToCollection:f}=e,g=a.getSchema(),h=a.getParentBlockStore(),v=h&&h.isLocked();let b=!p;const y=(null==l||null===(t=l.groupsStore.getGroupState(c))||void 0===t?void 0:t.resultsStore.state)||[];if(o.isDefined()){const e=f?(0,s.Kc)(T.default.getIntl()):o.getSchema()||{},t=r.Xq({blockProperties:o.getProperties(),oldSchema:e,newSchema:g});t.propertyUpdate&&Object.keys(t.propertyUpdate).length>0&&z.sW({store:o.getPropertiesStore(),data:t.propertyUpdate,transaction:d}),m.Xy(g,t.newSchema)||v||!C.eD({collectionStore:a,collectionViewBlockStore:h,checkNavigableAncestorLocked:!1})||Z.Rm({environment:n,collectionStore:a,update:{schema:t.newSchema},transaction:d})}if(o.getType()===i.Ti.page||o.getType()===i.Ti.collectionViewPage&&o.isAssociatedCollectionAPageTree()||a.isPageTreeCollection()||o.getType()===i.Ti.copyIndicator||o.getType()===i.Ti.externalObjectInstancePage||z.sW({store:o,data:{type:i.Ti.page},transaction:d}),l){if(l.collectionViewStore()){const e=l.remoteRequestStore.state,t=o.getModel(),i=l.relativeVariableStore.state;if(t&&e&&p){const s=r.RA({block:t,schema:l.normalizedSchemaStore.state,propertyMapping:a.getPropertyMapping(),filter:e.loader.filter,userFilterContext:{userId:n.currentUser.id,userTimeZone:(0,u.r)(),userStartOfWeek:_.AK.state},relativeVariableResult:i,groupsPointer:c,getRecordModel:a.getRecordModel,intl:T.default.getIntl()}),p=s.update;Object.keys(p).length>0&&z.sW({store:o.getPropertiesStore(),data:p,transaction:d}),b=s.coercionSucceeded}}}if(f?K.applyOperation({store:o,operation:{pointer:o.pointer,path:["alive"],command:"set",args:!0},transaction:d}):N.zw({childStore:o,parentStore:a,transaction:d}),l&&l.resultSet.addLocalChange([o.id]),l){var S;const e=null===(S=l.groupsStore.getGroupState(c))||void 0===S?void 0:S.currentLimit;if(e){const t=e.state,n=y.find((e=>e.id===o.id));y.length>=t&&!n&&e.setState(y.length+1)}}return b}function ne(e){const{resultIds:t,collectionViewStore:n,collectionContextStore:o,transaction:i}=e,r=n.getPageSortStore(),a=r.getValue()||[],{beforeOps:l}=(0,c.q)(a,t.slice(0,s.gq));for(const[s,c]of Object.entries(l))if(c){const e=(0,R.Kv)(n,{table:f.iU,id:c});O.Vt({parent:r,insert:(0,R.Kv)(n,{table:f.iU,id:s}),before:e,transaction:i})}else{const e=t.findIndex((e=>e===s)),o=t[e-1],a=o?(0,R.Kv)(n,{table:f.iU,id:o}):void 0;O.BE({parent:r,insert:(0,R.Kv)(n,{table:f.iU,id:s}),after:a,transaction:i})}!function(e){const{collectionContextStore:t,collectionViewStore:n,transaction:o}=e,i=n.getPageSortStore(),r=i.getValue(),a=t.groupsStore.getAllGroupStates(),l=new Set(a.flatMap((e=>e.resultsStore.state.map((e=>e.id))))),c=function(e){const{pageSort:t,currentResults:n}=e;if(!t||t.length<=s.gq)return[];const o=t.filter((e=>!n.has(e)));return m.jj([...o.reverse(),...m.d9(t).reverse()]).slice(0,t.length-s.gq)}({pageSort:r,currentResults:l});for(const s of c)O.Od({parent:i,childToRemove:(0,R.Kv)(i,{table:f.iU,id:s}),transaction:o})}({collectionContextStore:o,collectionViewStore:n,transaction:i})}function oe(e){var t,n,o,i;const{environment:r,collectionStore:a,targetStore:c,droppedDirection:d,droppedStores:u,transaction:p,duplicate:h,collectionContextStore:v,groupsPointer:y,subitemPath:S}=e,_=v.collectionViewStore();if(!_)return;if(!(null===(t=v.groupsStore.getGroupState(y))||void 0===t?void 0:t.groupUiParentStore))return;const w=(null===(n=v.groupsStore.getGroupState(y))||void 0===n?void 0:n.resultsStore.state)||[],k=u.every((e=>e.isExternalObjectInstancePageBlockStore()))&&!(a.isSyncedCollection()&&(null===(o=u[0])||void 0===o?void 0:o.getParentId())===(null==a?void 0:a.id))||h;if(d===A.vh.Onto){G.ZH(r);const e=c.getContentStore(),t=j.LQ({environment:r,droppedStores:u,duplicate:k,duplicateUseCrdt:c.useCrdt(),transaction:p,resolveTemplateVariables:!1});for(const n of t)O.R3({parent:e,append:n,transaction:p});return[]}let I=!1,C=[];if(!k){const e=function(e){const{environment:t,droppedStores:n,collectionStore:o,transaction:i}=e,r=fe({environment:t,stores:n,collectionStore:o,transaction:i});for(const a of r){if(a.getParentTable()===g.v||a.getAssociatedCollectionStore())return;if(!N.zw({childStore:a,parentStore:o,transaction:i}))return}return r}({environment:r,droppedStores:u,collectionStore:a,transaction:p});I=void 0!==e,C=e??[]}const T=j.LQ({environment:r,droppedStores:u,duplicate:k,duplicateUseCrdt:!1,transaction:p,resolveTemplateVariables:!1});I||(C=fe({environment:r,stores:T,transaction:p,collectionStore:a}));const M=(0,x.Af)([...(null==S?void 0:S.map((e=>e.value.store.pointer)))??[]]),D=v.subitemExpandedStore.state.get(M),B=S&&S.length>1||(null==D?void 0:D.isExpanded)&&d===A.vh.Below,E=null==v?void 0:v.currentSubitemFormatStore.state,F=null==E?void 0:E.inverse,Z=F&&v.normalizedSchemaStore.state[F],L=null===(i=v.collectionViewStore())||void 0===i?void 0:i.getType(),V=E&&L&&(0,x.Av)(L)&&Z&&(0,s.p_)(Z);for(const s of C){if(te({environment:r,store:s,collectionStore:a,collectionContextStore:v,groupsPointer:y,coerce:!0,transaction:p,alreadyMovedToCollection:I}),V){const e=(0,x.xb)({store:s,subitemFormat:E,propertySchema:Z});for(const t of e){const e=R.G.createChildStore(s,t);H.Bl({environment:r,sourceStore:e,destStore:s,propertyWithInverse:E,transaction:p})}}if(B){const e=null!=D&&D.isExpanded?"into":"below";pe({environment:r,collectionContextStore:v,collectionStore:a,subitemPath:S&&(null==S?void 0:S.length)>0?S:[new b.mp((0,x.SM)(c),[])],store:c,before:"into"===e,insertBlock:s,insertDirection:e,transaction:p})}}const U=w.filter((e=>!T.includes(e))),z=U.indexOf(c),W=d===A.vh.Above||d===A.vh.Left?z:z+1;ne({resultIds:[...U.slice(0,W),...C,...U.slice(W)].map((e=>e.id)),collectionViewStore:_,collectionContextStore:v,transaction:p}),re({environment:r,collectionContextStore:v});const q=v.collectionViewBlockStore();if(!q)return;const K=B?c:q,Q=m.UI(C,(e=>R.G.createChildStore(K,{table:f.iU,id:e.id})));return G.Z5({environment:r,stores:Q}),function(e,t){var n,o;(null===(n=e.collectionViewStore())||void 0===n?void 0:n.getFormat().app_config_uri)===l.g3&&"sprint_board"===(null===(o=P.default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.getFormat().special_page_for_pm_launch)&&$.tutorialAdvanceToStepAfter(t,"sprints-onboarding","sprint-task-tooltip")}(v,p),Q}function ie(e){const{environment:t,collectionStore:n,targetStore:o,droppedDirection:i,files:r,transaction:a,collectionContextStore:s,groupsPointer:l}=e,c=s.collectionViewStore(),u=_.qQ(t);if(!c)return;const p=n.inMemoryRecordCache,m=V.z({environment:t,files:r,inMemoryRecordCache:p,pageWidth:u,transaction:a,spaceId:n.pointer.spaceId,useCrdt:!1}).map(((e,o)=>{const i=r[o],s=z.j4({environment:t,type:"page",inMemoryRecordCache:p,properties:{title:(0,v.TPx)(d.AA(i.name))},transaction:a,spaceId:n.pointer.spaceId,useCrdt:!1});return O.R3({parent:s.getContentStore(),append:e,transaction:a}),s}));oe({environment:t,collectionStore:n,targetStore:o,droppedDirection:i,collectionContextStore:s,groupsPointer:l,droppedStores:m,duplicate:!1,transaction:a})}function re(e){const{environment:t,collectionContextStore:n}=e,o=n.collectionViewBlockStore(),i=n.collectionViewStore();if(!i||!o)return!1;const r=n.currentViewHasSort(),a=i.getType(),s=n.permissionScopes.state;return!!(r&&a&&I.Km[a]&&s.canConfigureBlock)&&(L.showDialog({message:T.default.formatMessage(Y.removeSortingConfirmation),items:[{label:T.default.formatMessage(Y.removeSortingButton),color:"red",onAccept:()=>{K.createAndCommit({userAction:"collectionGroupActions.offerToRemoveSort",environment:t,perform:e=>{Z.Es({collectionViewStore:i,update:{sort:[]},transaction:e})}})}},{label:T.default.formatMessage(Y.removeSortingCancel),onAccept:()=>{}}],showCancel:!1,keepFocus:!0}),!0)}function ae(e){const{environment:t,droppedStores:n,duplicate:o,collectionContextStore:i,groupsPointer:r,transaction:a}=e,s=i.collectionStore(),l=i.collectionViewStore(),c=j.LQ({environment:t,droppedStores:n,duplicate:o,duplicateUseCrdt:!1,transaction:a,resolveTemplateVariables:!1});if(s)for(const d of c)te({environment:t,store:d,collectionStore:s,collectionContextStore:i,groupsPointer:r,coerce:!0,transaction:a});return l&&ne({resultIds:c.map((e=>e.id)),collectionViewStore:l,collectionContextStore:i,transaction:a}),[]}function se(e){var t,n,o;const{environment:r,collectionContextStore:a,groupsPointer:s,insertAtIndex:l,coerce:c,initializeDefaultTemplate:d,transaction:u,from:p,tracker:m}=e,g=M.default.mark("collections.add_item_lag");M.default.measureAfterNextFlush(g,{environment:r,getData:()=>({...w.vS(a),from:p})});const h=null===(t=P.default.state.currentSpaceStore)||void 0===t?void 0:t.id,v=z.j4({environment:r,type:i.Ti.page,inMemoryRecordCache:r.defaultRecordCache.inMemoryRecordCache,transaction:u,spaceId:h,tracker:m,useCrdt:!1}),b=a.collectionStoresStore.state,y=a.databaseType,S="collectionTypedView"===a.contextType,_=b.length?b[0]:void 0,k=P.default.state.currentUserSettingsStore;!S&&y&&_&&Q.zq({transaction:u,dbType:y,collectionId:_.id});const I=S&&y&&h&&k?k.getPreferredCollection(h,y):void 0,C=(I?b.find((e=>e.id===I)):void 0)??_,x=a.collectionViewStore(),T=a.getViewType();if(!C||!x||!T)return{coercionSucceeded:!0,newStore:v};const A=null===(n=a.groupsStore.getGroupState(s))||void 0===n?void 0:n.groupUiParentStore;if(!A)return{coercionSucceeded:!0,newStore:v};const D=R.G.createChildStore(A,{table:f.iU,id:v.id});if(d){const e=a.defaultPageTemplateStore.state;e&&F.ob({title:"template",environment:r,store:v,templateStore:e,isKeyboard:!1,isCreateIn:!1,transaction:u,from:"collection_group_actions"})}const B=te({environment:r,store:v,collectionStore:C,collectionContextStore:a,groupsPointer:s,coerce:c,transaction:u}),E=(null===(o=a.groupsStore.getGroupState(s))||void 0===o||null===(o=o.reducerResultStore.state)||void 0===o?void 0:o.blockIds)||[],Z=void 0!==l?l:E.length;if(a.permissionScopes.state.canEditContent){ne({resultIds:[...E.slice(0,Z),D.id,...E.slice(Z)],collectionViewStore:x,collectionContextStore:a,transaction:u})}return{coercionSucceeded:B,newStore:D}}function le(e){const{collectionContextStore:t,newGroups:n,groupsFormatKey:o,transaction:i}=e,r=t.collectionViewStore();r&&U.FH({stores:[r],update:{[o]:n},transaction:i})}function ce(e){const{environment:t,collectionStore:n,property:o,oldValue:i,newValue:a,transaction:s}=e,l=n.getSchema(),c=t.currentUser.id;n.inMemoryRecordCache.forEachRecord(c,(e=>{var t;let{model:c}=e;if(c.table!==f.iU)return;const d=R.G.createChildStore(n,{table:f.iU,id:c.id});if((null===(t=d.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===n.id){const e=r.hz({block:c,schema:l,property:o,oldValue:i,newValue:a});if(Object.keys(e).length>0){const t=d.getPropertiesStore();z.sW({store:t,data:e,transaction:s})}}})),n.isDefaultRecordCache()&&s.postSubmitCallbacks.push((async e=>{const r=n.pointer,{value:s}=await B.renameGroup(t,{collection:{id:r.id,spaceId:(0,h.C)(r.spaceId)},property:o,oldValue:i,newValue:a}).next();if(s.error)throw s.error}))}function de(e){const{environment:t,collectionStore:n,groupsFormatKey:o,property:i,groupFormat:l,currentGroups:c,collectionContextStore:d,transaction:p,intl:m}=e,g=n.getSchema(),v=g[l.property];le({collectionContextStore:d,newGroups:c.filter((e=>!(0,a.we)(l.value,e.value))),groupsFormatKey:o,transaction:p});const b=l.value;if(v&&(0,s.cu)(v)&&b.type===v.type&&n){const e=(v.options||[]).filter((e=>e.value!==b.value)),o={...v,options:e},i={...g,[l.property]:o};Z.Rm({environment:t,collectionStore:n,update:{schema:i},transaction:p})}const y=t.currentUser.id;n.inMemoryRecordCache.forEachRecord(y,(async e=>{let{model:o}=e;if(o.table!==f.iU)return;const a=R.G.createChildStore(n,o.pointer);if(r.wg({block:o,schema:g,property:i,value:b,intl:m,timeZone:(0,u.r)(),getRecordModel:n.getRecordModel}))if(o.parent_id===n.id)N.hh({childStore:a,transaction:p});else{const e=a.getAssociatedCollectionStore();e&&e.id===n.id&&("page"===a.getType()||"collection_view_page"===a.getType()&&!a.isCollectionViewPageWithContent())&&await q.Qw({environment:t,blocks:[a]})}})),n.isDefaultRecordCache()&&p.postSubmitCallbacks.push((async e=>{const o=await B.deleteGroup(t,{collection:{id:n.id,spaceId:(0,h.C)(n.pointer.spaceId)},property:i,value:b}).next();if(o.value.error)throw o.value.error}))}function ue(e){const{environment:t,collectionContextStore:n,before:r,store:a,groupsPointer:s,collectionStore:l,transaction:c,subitemPath:d,subitemInsertDirection:u}=e,p=n.collectionViewStore();if(!p)return;const m=n.groupsStore.getGroupState(s),g=null==m?void 0:m.groupUiParentStore,h=(null==m?void 0:m.resultsStore.state)||[];if(!g)return;const v=z.j4({environment:t,type:i.Ti.page,inMemoryRecordCache:a.inMemoryRecordCache,transaction:c,spaceId:p.pointer.spaceId,useCrdt:!1}),b=te({environment:t,store:v,collectionStore:l,collectionContextStore:n,groupsPointer:s,coerce:!0,transaction:c}),y=n.defaultPageTemplateStore.state;y&&F.ob({title:"template",environment:t,store:v,templateStore:y,isKeyboard:!1,isCreateIn:!1,transaction:c,from:"collection_group_actions"});const S=R.G.createChildStore(g,{table:f.iU,id:v.id});d&&d.length>0&&pe({environment:t,collectionContextStore:n,subitemPath:d,collectionStore:l,store:a,before:!1,insertBlock:S,insertDirection:u,transaction:c});const _=h.indexOf(a),w=r?_:_+1;if(ne({resultIds:[...h.slice(0,w),S,...h.slice(w)].map((e=>e.id)),collectionViewStore:p,collectionContextStore:n,transaction:c}),b){if(d){var k;const e="into"===u?a:null===(k=d[d.length-2])||void 0===k?void 0:k.value.store;return e?R.G.createChildStore(e,S.pointer):S}return G.Ys({environment:t,store:S}),re({environment:t,collectionContextStore:n}),S}W.peekBlock({environment:t,store:S,peekMode:C.kr(p),resultsStore:null==m?void 0:m.resultsStore,collectionContextStore:n,pageVisitSource:o.tY.Create})}function pe(e){const{environment:t,collectionContextStore:n,subitemPath:o,collectionStore:i,store:r,before:a,insertBlock:s,insertDirection:l,transaction:c}=e,d=n.currentSubitemFormatStore.state;if(!d)return;const u=i.getSchema()[d.property];if(!u||"relation"!==u.type)return;if("into"===l){var p;const e=o[o.length-1],n=e.value.store;return void H.hE({environment:t,sourceStore:n,destStore:s,position:a?{type:"before",before:null===(p=e.children[0])||void 0===p?void 0:p.value.store.id}:{type:"after"},propertyWithInverse:d,transaction:c})}const m=o[o.length-2];if(!m)return;const f=m.value.store;H.hE({environment:t,sourceStore:f,destStore:s,propertyWithInverse:d,position:a?{type:"before",before:r.id}:{type:"after",after:r.id},transaction:c})}function me(e){const{environment:t,collectionContextStore:n,groupFormat:o,newGroupFormat:i,groupsFormatKey:r,currentGroups:s,transaction:l}=e,c=n.collectionStore();!(0,a.we)(o.value,i.value)&&c&&ce({environment:t,collectionStore:c,property:o.property,oldValue:o.value,newValue:i.value,transaction:l});le({collectionContextStore:n,newGroups:s.map((e=>(0,a.we)(o.value,e.value)?i:e)),groupsFormatKey:r,transaction:l})}function fe(e){const{environment:t,stores:n,transaction:o,collectionStore:r}=e;return n.map((e=>{const n=e.getType();if(n&&(i.Ok[n]||n===i.Ti.file||n===i.Ti.externalObjectInstance)){const n=z.j4({environment:t,type:"page",inMemoryRecordCache:e.inMemoryRecordCache,transaction:o,spaceId:r.pointer.spaceId,useCrdt:!1});return N.jG({parentStore:n,childStore:e,transaction:o}),n}return e}))}function ge(e){const{environment:t,format:n,groupsFormatKey:o,collectionContextStore:i,currentGroups:r}=e,a=n[o]||[];if(!i.permissionScopes.state.canConfigureBlock)return;if(0===r.length)return;const s=r.slice(0,k.XD),l=a.slice(0,k.XD);m.Xy(s,l)||K.createAndCommit({userAction:"collectionGroupActions.persistFormatGroups",environment:t,canUndo:!1,perform:e=>{le({collectionContextStore:i,newGroups:r,groupsFormatKey:o,transaction:e})}})}function he(e,t){return`group-${e}-${(0,a.mD)(t)}`}function ve(e){const{environment:t,groupFormat:n,collectionContextStore:o}=e,i=o.collectionViewStore();if(!i)return;const r=o.groupsStore.getGroupState(n);if(!r)return;const a=p.Z.get({userId:t.currentUser.id,key:he(i.id,n)});r.toggleStateStore.setState(a??!0)}function be(e){const{environment:t,groupFormat:n,toggleStateStore:o,newValue:i,collectionContextStore:r}=e,a=r.collectionViewStore();a&&(o.setState(i),p.Z.set({userId:t.currentUser.id,key:he(a.id,n),value:i}))}function ye(e){const{newGroupValue:t,groupFormat:n,schema:o,collectionContextStore:i,currentGroups:r,groupsFormatKey:l,collectionStore:c,environment:d}=e,u=o[n.property];if(!u)return;if(!(0,a.LG)(u))return;const p=n.value;if((0,s.cu)(u)){if(p.type!==u.type)return;if(t.type!==u.type)return;if(void 0===t.value)return;const e=u.options||[],a=t.value,s=e.map((e=>e.value===p.value?{...e,value:a}:e)),m={...u,options:s},f={...o,[n.property]:m},g={...n,value:{...p,value:a}};K.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:e=>{me({environment:d,collectionContextStore:i,groupFormat:n,newGroupFormat:g,currentGroups:r,transaction:e,groupsFormatKey:l}),Z.Rm({environment:d,collectionStore:c,update:{schema:f},transaction:e})}})}else if("person"!==u.type)if((0,a.HB)(u.type)){if(p.type!==u.type)return;if(t.type!==u.type)return;if(!t.value||"exact"!==t.value.type)return;const e={...n,value:t};K.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{me({environment:d,collectionContextStore:i,groupFormat:n,newGroupFormat:e,currentGroups:r,groupsFormatKey:l,transaction:t})}})}else"status"===u.type||(0,a.A1)(u.type)||"created_by"===u.type||"last_edited_by"===u.type||"number"===u.type||"checkbox"===u.type||"formula"===u.type||"relation"===u.type||"location"===u.type||(0,y.t1)(u.type);else{if(p.type!==u.type)return;if(t.type!==u.type)return;const e={...n,value:t};K.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{me({environment:d,collectionContextStore:i,groupFormat:n,newGroupFormat:e,currentGroups:r,groupsFormatKey:l,transaction:t})}})}}async function Se(e){const{update:t,collectionContextStore:n,groupsFormatKey:o,collectionStore:r,environment:a,schema:l,groupBy:c}=e,d=l[c.property];if(!d)return;const u="relation"===d.type&&(0,s.F0)(d),p=u&&new R.NW(a,{table:g.v,id:u});p&&await p.load(),K.createAndCommit({userAction:"collectionGroupActions.handleCollectionAddGroupButtonAccept",environment:a,perform:e=>{if(t.newGroups&&(le({collectionContextStore:n,newGroups:t.newGroups,groupsFormatKey:o,transaction:e}),E.ul({transaction:e,newGroups:t.newGroups,collectionContextStore:n,environment:a})),t.newSchema&&Z.Rm({environment:a,collectionStore:r,update:{schema:t.newSchema},transaction:e}),t.newPage&&"relation"===d.type&&p){const n=(0,v.TPx)(t.newPage.name),o={id:t.newPage.id,version:0,type:i.Ti.page,parent_id:u,parent_table:g.v,alive:!0,properties:{title:n},collection_id:void 0,space_id:t.newPage.spaceId},s=z.ae({environment:a,table:f.iU,value:o,inMemoryRecordCache:r.inMemoryRecordCache,transaction:e}),l=p.getDefaultTemplatePageStore();l&&F.ob({title:{text:n},environment:a,store:R.G.createChildStore(p,s.pointer),templateStore:l,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"collection_group_actions"})}}})}function _e(e){const{collectionContextStore:t,environment:n,incrementLimitArgs:o}=e;t.groupsStore.incrementLimit(e.incrementLimitArgs),t.loadingDetails.setState({type:"load_more_blocks",group:o.groupsPointer}),D.bn(n)}},16956:(e,t,n)=>{n.d(t,{Bv:()=>D,E2:()=>j,G3:()=>P,LC:()=>A,OK:()=>B,TI:()=>Z,bL:()=>R,er:()=>E,fH:()=>F,yV:()=>L});n(57658),n(67294);var o=n(99036),i=n(95200),r=n(46328),a=n(71644),s=n(6287),l=n(97880),c=n(82990),d=n(5366),u=n(76798),p=n(52821),m=n(78316),f=n(33929),g=n(29376),h=n(85526),v=n(35661),b=n(8406),y=n(48299),S=n(31869),_=n(5149),w=n(87085),k=n(45264),I=n(47307),C=n(96802),x=n(39699),T=n(29919),M=n(85893);function P(e){const{environment:t,collectionViewArgs:n,collectionStore:s,propertyName:c,propertyType:d,transaction:u}=e,m={},g=s.getSchema(),h=Object.keys(g),v=(0,i.Z)(c??p.SO[d],(e=>!h.find((t=>{const n=g[t];return Boolean(n&&n.name===e)})))),b=(0,a.ZP)();let y;const S=(0,p.k4)();if((0,o.XU)(d))switch(d){case"ai_custom_prompt":y={name:v,type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:S}};break;case"ai_summary":y={name:v,type:"text",ai_inference:{type:"summarize",auto_update_on_edit:S}};break;case"ai_extract":y={name:v,type:"text",ai_inference:{type:"extract",prompt:"",auto_update_on_edit:S}};break;case"ai_translate":y={name:v,type:"text",ai_inference:{type:"translate",targetProperties:["title"],toLanguage:"english",auto_update_on_edit:S}};break;default:(0,l.t1)(d)}else y={name:v,type:d};if(m[b]=y,o.iE(y)&&(h.includes(r.k.Owner)||(m[r.k.Owner]={name:f.default.formatMessage(T.Zi.ownerPropertyName),type:"person",default:"created_by"}),y.verifier_property=r.k.Owner),n){const{format:e,formatKey:t,collectionViewStore:o}=n,i=[...e[t]||[],{property:b,visible:!0}];C.FH({stores:[o],update:{[t]:i},transaction:u})}return k.xO({environment:t,collectionStore:s,update:m,transaction:u}),b}function A(e){const{environment:t,collectionStore:n,property:i,type:r,transaction:a}=e,s=n.getSchema()[i];if(!s||s.type===r)return;const l={...s};l.type=(0,o.TN)(r),k.xO({environment:t,collectionStore:n,update:{[i]:l},transaction:a})}function R(e){const{collectionStore:t,property:n,autoRelate:o,transaction:i}=e;t.getSchema()[n]&&x.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"autoRelate"],command:"set",args:o},transaction:i})}function D(e){const{collectionStore:t,property:n,name:o,transaction:i}=e;t.getSchema()[n]&&x.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"name"],command:"set",args:o},transaction:i})}function B(e){const{collectionStore:t,property:n,icon:o,transaction:i}=e;t.getSchema()[n]&&x.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"icon"],command:"set",args:o},transaction:i})}function E(e){const{formatStore:t,formatKey:n,property:o,update:i,transaction:r}=e,a=[...t.getFormat()[n]||[]],s=a.findIndex((e=>e.property===o));-1!==s?a[s]={...a[s],...i}:a.push({property:o,...i}),C.FH({stores:[t],update:{[n]:a},transaction:r})}function F(e){const{collectionContextStore:t,collectionStore:n,environment:i,isInPeekRenderer:r,onCloseMenu:a}=e,s=t.settingsStore;_.H4({collectionSettingsStore:s,item:{type:"propertyType",onAccept:(e,l)=>{if("relation"===e)return void _.H4({collectionSettingsStore:s,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});const{performResult:c}=x.createAndCommit({userAction:"PageProperties.handleAddPropertyClick",environment:i,perform:t=>P({environment:i,collectionStore:n,collectionViewArgs:void 0,propertyType:e,propertyName:l,transaction:t})});null==a||a(),_.FK({collectionSettingsStore:s,item:{type:"property",formatKey:"collection_page_properties",property:c,selectNameInitial:!i.device.isMobile}}),h.Z.setState({...h.Z.state,openProperty:{property:c,isInPeekRenderer:r},forceShowProperties:!0}),(0,o.XU)(e)&&w.K7({propertyType:e,propertyId:c,collectionContextStore:t}),b._H({environment:i,collectionContextStore:t,from:"page_properties",property_type:(0,o.TN)(e)})},propertyTypes:(0,p.TP)({isSyncedCollection:n.isSyncedCollection(),collectionContextStore:t,environment:i})}})}async function Z(e){const{environment:t,collectionContextStore:n,property:o,handleDeleteAccept:i}=e,r=n.collectionStore();if(!r)return;if(r.isTypedProperty(o)){if(await y.w0({environment:t,property:o,collectionContextStore:n,theme:e.theme,from:e.from}))return}const a=n.normalizedSchemaStore.state,s=a[o],l=g.ny(n,s);await(null==l?void 0:l.load());const p=l&&g.OP(n,o,l),m=l&&g.gZ(l),f=l&&r.id===l.id,h=[{label:(0,M.jsx)(d.FormattedMessage,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:i}];let v;if(p&&r&&m&&!f&&h.push({label:(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{x.createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,perform:e=>{if(s&&"relation"===s.type&&s.property&&l){const n=s.property,o=l.getSchema();S.q0({environment:t,collectionStore:l,propertySchema:o[n],property:n,targetPropertyID:void 0,autoRelate:r.isSyncedCollection()&&!l.isSyncedCollection()?{enabled:!1}:s.autoRelate,transaction:e})}S.kQ({environment:t,collectionStore:r,property:o,transaction:e})}})}}),"auto_increment_id"===(null==s?void 0:s.type))v=g.pR(a)?(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==s?void 0:s.type)){const e=g.Pi(a);if(e){const t=e.connectedRelation.automation;t&&t[o]&&(v=(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else l&&m&&!f&&p&&(v=(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,M.jsx)(u.Z,{style:{display:"inline",fontWeight:c.Z.fontWeight.medium},store:l})}}));I.showDialog({message:(0,M.jsx)("span",{children:(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property for everyone on {databaseName}?",values:{databaseName:(0,M.jsx)(u.Z,{style:{display:"inline",fontWeight:c.Z.fontWeight.medium},shouldWrap:!0,store:r})}})}),description:v,showCancel:!0,keepFocus:!0,items:h,mode:"wide"})}async function L(e){const{environment:t,collectionStore:n,schema:i,property:r,transaction:a}=e,s=i[r];if(s)if("relation"===s.type&&o.F0(s)&&s.property&&o.F0(s)!==n.id){const e=new v.NW(t,o.j0(s));await e.load(),j({environment:t,collectionStore:n,schema:i,property:r,transaction:a,targetCollectionStore:e})}else j({environment:t,collectionStore:n,schema:i,property:r,transaction:a})}function j(e){const{environment:t,collectionStore:n,schema:o,property:i,transaction:r,targetCollectionStore:a}=e;if(!n.isDefined())return;const l=m.zm({environment:t,collectionId:n.id,schema:o,property:i,targetCollectionStore:a});if(!l)return;k.Rm({environment:t,collectionStore:n,update:{schema:l.newSchema,...l.deletedSchema&&{deleted_schema:l.deletedSchema}},transaction:r}),l.otherCollectionId&&l.otherCollectionSchema&&k.Rm({environment:t,collectionStore:v.NW.createChildStore(n,{table:s.v,id:l.otherCollectionId}),update:{schema:l.otherCollectionSchema,...l.otherCollectionDeletedSchema&&{deleted_schema:l.otherCollectionDeletedSchema}},transaction:r});const c=o[i];"auto_increment_id"===(null==c?void 0:c.type)&&k.$N({collectionStore:n,update:{[i]:null},transaction:r})}},75134:(e,t,n)=>{n.d(t,{H:()=>C,r:()=>x});n(67294);var o=n(40682),i=n(52936),r=n(42875),a=n(72126),s=n(5366),l=(n(57658),n(21703),n(80951)),c=n(61158),d=n(45953);function*u(e){const{startingBlock:t,relationPropertyIdGroups:n,receiver:o}=e;let i,r=n.map((e=>function*(e){const{startingBlock:t,relationPropertyIds:n,receiver:o}=e,i=new Set,r=[{block:t}];let s=0;for(;;){const e=r.shift();if(!e)break;const{block:t}=e;if(i.has(t.id))continue;i.add(t.id);const c=n.flatMap((e=>{var n;return(0,l.rq)(null===(n=t.properties)||void 0===n?void 0:n[e])}));if(!o.receive(c))return;if(c.length>0){const{recordMap:e}=yield{recordPointers:c};r.push(...a.oA(c.map((t=>{const n=e.getValue(t);if(n&&n.alive)return{block:n}}))))}if(s++,s>500)throw new Error("Reached maximum number of iterations")}}({relationPropertyIds:e,startingBlock:t,receiver:o})));for(;r.length>0;){const e=[];r=r.filter((t=>{const n=i?t.next(i):t.next();return!n.done&&(e.push(n.value),!0)})),e.length>0&&(i=yield{recordPointers:e.flatMap((e=>e.recordPointers))})}}class p{constructor(e){this.blockPointerSet=new c.Z,this.limit=e}getBlockPointers(){return this.blockPointerSet.entries()}receive(e){return this.blockPointerSet.add(...e),this.blockPointerSet.size<this.limit}}function m(e){return function(e){const{startingBlock:t,relationPropertyIdGroups:n,getRecordValue:o,limit:i}=e,r=new p(i),a=u({startingBlock:t,relationPropertyIdGroups:n,receiver:r});let s=a.next();for(;!s.done;){const e=d.Ak.create();for(const t of s.value.recordPointers)e.setValue(t,o(t));s=a.next({recordMap:e})}return r.getBlockPointers()}(e).every((t=>Boolean(e.getRecordValue(t))))}var f=n(97880),g=n(6854),h=n(42937),v=n(80444),b=n(77080),y=n(35661),S=n(54642),_=n(64964),w=n(39699),k=n(85893);const I=100;function C(e){const{environment:t,store:n}=e;M({environment:t,store:n,change:{type:"date",...e}})}function x(e){const{environment:t,store:n}=e;M({environment:t,store:n,change:{type:"relation",...e}})}const T=new o.z(1);function M(e){const{environment:t,store:n,change:o}=e;if(!b.default.checkGate("dependency_date_shifting_by_space"))return;const l=n.getAssociatedCollectionStore();if(!l)return;const c=l.getDatabaseType(),d=l.getSchema(),u=l.getNormalizedDependencyDateShiftingConfig();if(!u)return;const p=l.getFormatStore().getKeyStore("collection_default_arrows_by").getValue();if(!p)return;const C=d[p];if("relation"!==(null==C?void 0:C.type))return;const x=C.property;x&&T.enqueue((()=>async function(e){var t,n;const{environment:o,store:l,dateShiftConfig:c,databaseType:d,blockedByPropertyId:u,blockingPropertyId:p,change:b,collectionSchema:C}=e,x={id:l.id,properties:l.getProperties()},T=null===(t=v.default.state.currentUserSettingsStore)||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.locale,M=(0,r.r)();let P,A,R;if("date"===b.type){var D;if(0===a.jV(a.oA([c.date_property,c.end_date_property]),a.oA([b.dateProperty.id,null===(D=b.otherDateProperty)||void 0===D?void 0:D.id])).length)return;const e=new Map;e.set(b.dateProperty.id,b.dateProperty),b.otherDateProperty&&e.set(b.otherDateProperty.id,b.otherDateProperty);const t=t=>{const n=e.get(t);if((0,f.$K)(n))return n;{var o;const e=null===(o=x.properties)||void 0===o?void 0:o[t];return{id:t,oldValue:e,newValue:e}}};P=t(c.date_property),(0,f.$K)(c.end_date_property)&&(A=t(c.end_date_property))}else if("relation"===b.type){if(b.relationPropertyId!==p&&b.relationPropertyId!==u)return;if("preserve_gap"===c.mode)return;P={id:c.date_property,oldValue:void 0,newValue:x.properties[c.date_property]},c.end_date_property&&(A={id:c.end_date_property,oldValue:void 0,newValue:x.properties[c.end_date_property]})}else(0,f.t1)(b);"preserve_gap"===c.mode?R=[[u,p]]:"consume_gap"===c.mode?R=[[u],[p]]:(0,f.t1)(c.mode);m({startingBlock:x,relationPropertyIdGroups:R,limit:I,getRecordValue:l.getRecordValue})?await Promise.resolve():await S.getTransitivePageRelations(o,{blockId:x.id,limit:I,relationPropertyIdGroups:R}).then((()=>{}));const B=(0,i.yu)({block:{id:x.id,properties:{...x.properties,...P.oldValue?{[P.id]:P.oldValue}:{},...null!==(n=A)&&void 0!==n&&n.oldValue?{[A.id]:A.oldValue}:{}}},blockingPropertyId:p,blockedByPropertyId:u,dateProperty:P,endDateProperty:A,getRecordValue:l.getRecordValue,timeZone:M,locale:T,options:c,collectionSchema:C,getRecordRole:l.getRecordRole}),{operations:E}=B;w.createAndCommit({userAction:"collectionDateActions.handleDependencyDateShifting",environment:o,perform:e=>{for(const t of E){const n=(0,y.Kv)(l,t.pointer);w.applyOperation({store:n,operation:t,transaction:e})}}});const F=(0,h.vi)({result:B,databaseType:d});F&&_.oV({label:(0,k.jsx)(s.FormattedMessage,{...F.message}),right:F.canUndo?(0,k.jsx)(g.ow,{}):void 0})}({environment:t,store:n,dateShiftConfig:u,databaseType:c,blockedByPropertyId:x,blockingPropertyId:p,change:o,collectionSchema:d}))).catch((e=>{console.error(e)}))}},31869:(e,t,n)=>{n.d(t,{gy:()=>b,kQ:()=>h,n7:()=>v,q0:()=>g,qK:()=>S,sf:()=>y});var o=n(80951),i=n(71644),r=n(50906),a=n(9953),s=n(29376),l=n(8406),c=n(16956),d=n(75134),u=n(45264),p=n(96802),m=n(39699);function f(e){const{environment:t,collectionStore:n,collectionPointer:o,property:i,name:r,autoRelate:a,limit:s,targetPropertyID:l,connectedRelation:c,transaction:d,hideByDefaultInUnconfiguredViews:p}=e,m={type:"relation",name:r,collection_id:o.id,collection_pointer:o,limit:"1"===s?1:void 0,property:l,version:"v2",autoRelate:a,connectedRelation:c,hideByDefaultInUnconfiguredViews:p};u.xO({environment:t,collectionStore:n,update:{[i]:m},transaction:d})}function g(e){const{environment:t,collectionStore:n,propertySchema:o,targetPropertyID:i,property:r,autoRelate:a,transaction:s}=e;u.xO({environment:t,collectionStore:n,update:{[r]:{...o,autoRelate:a,property:i,version:"v2"}},transaction:s})}function h(e){const{environment:t,collectionStore:n,property:o,transaction:i}=e,r=n.getSchema()[o];r&&"relation"===r.type&&(u.xO({environment:t,collectionStore:n,update:{[o]:null},transaction:i}),u.$N({collectionStore:n,update:{[o]:r},transaction:i}))}function v(e){const{environment:t,collectionContextStore:n,collectionStore:o,property:r,propertyName:a,propertyLimit:d,targetCollectionStore:u,hasInverseRelation:p,inverseName:m,autoRelate:g,intl:h,connectedRelation:v,transaction:b,from:y}=e,S=u.pointer.id===o.id&&Boolean(p)?"separate_property":"same_property",_=s.KV(n,r),w="subitem"===y||void 0,k=function(e){const{environment:t,collectionContextStore:n,property:o,limit:r,collectionPointer:a,selfRelationType:s,oneWay:l,autoRelate:c,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}=e,m=n.collectionStore();if(!m)return;const g=m.getSchema()[o];if(!g)return;const h=a.id===m.id?"same_property"===s?o:(0,i.ZP)():l?void 0:(0,i.ZP)();return f({environment:t,collectionStore:m,collectionPointer:a,property:o,name:g.name,autoRelate:c,limit:r,targetPropertyID:h,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}),h}({environment:t,collectionContextStore:n,property:r,limit:d,collectionPointer:u.pointer,selfRelationType:S,oneWay:!p,autoRelate:g,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:w});if((null==_?void 0:_.name)!==a&&(c.Bv({collectionStore:o,property:r,name:a,transaction:b}),l.$q({environment:t,collectionContextStore:n,property:r,from:"view_settings",action:"rename"})),p&&s.gZ(u)&&k){const e=s.rj({inverseName:m,collectionStore:o,propertySchema:_,intl:h,targetCollectionStore:u,from:y});f({environment:t,collectionStore:u,collectionPointer:o.pointer,property:k,name:e,autoRelate:g,limit:"no_limit",targetPropertyID:r,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:w})}}function b(e){const{environment:t,collectionContextStore:n,property:o,hasInverseRelation:r,inverseName:a,autoRelate:l,intl:d,transaction:u}=e,p=s.KV(n,o);if(!p||"relation"!==p.type)return;const m=s.ny(n,p),v=n.collectionStore();if(!v||!m)return;const b=s.rj({inverseName:a,collectionStore:v,propertySchema:p,intl:d,targetCollectionStore:m});if(r&&!s.OP(n,o,m)){const e=(0,i.ZP)();g({environment:t,collectionStore:v,propertySchema:p,property:o,targetPropertyID:e,autoRelate:l,transaction:u}),f({environment:t,collectionStore:m,collectionPointer:v.pointer,property:e,name:b,autoRelate:l,limit:"no_limit",targetPropertyID:o,transaction:u,hideByDefaultInUnconfiguredViews:void 0})}else if(r){const e=p.property;if(!e)return;c.Bv({collectionStore:m,property:e,name:b,transaction:u}),l&&(c.bL({collectionStore:v,property:o,autoRelate:l,transaction:u}),c.bL({collectionStore:m,property:e,autoRelate:l,transaction:u}))}else{l&&c.bL({collectionStore:v,property:o,autoRelate:l,transaction:u});const e=p.property;if(!e)return;g({environment:t,collectionStore:v,propertySchema:p,property:o,targetPropertyID:void 0,autoRelate:l,transaction:u}),h({environment:t,collectionStore:m,property:e,transaction:u})}}function y(e){var t;const{store:n,propertyId:i,value:r,environment:s,relatedPageId:c,propertySchema:u,transaction:p,collectionContextStore:m,analyticsData:f,isUnthrottled:g}=e,{analyticsFrom:h,isFromBulkActionsToolbar:v}=f,b=n.getPropertyStore(i),y=o.ow(r);a.sO({store:b,value:y,transaction:p}),l.rv({environment:s,block_id:c,property:i,property_type:u.type,from:h,collectionContextStore:m,isFromBulkActionsToolbar:v,isUnthrottled:g,integration_id:null===(t=u.connectedRelation)||void 0===t?void 0:t.integration_id,action:"remove"}),d.r({environment:s,store:n,relationPropertyId:i})}function S(e){const{propertyFormat:t,visibility:n,collectionStore:i,property:a,environment:l}=e,c=t.property,d=s.U1({collectionStore:i,property:a}),u=(0,o.pX)(d,c,!n),f={...s.ZI(i)};f[a]||(f[a]={}),f[a].related_properties=u,m.createAndCommit({userAction:"collectionRelationActions.updateRelationPropertyVisibility",environment:l,perform:e=>{p.FH({stores:[i],update:{collection_relation_options:f},transaction:e})}}),r.P$y(l,{collection_id:i.id,property_id:a,related_property_id:c,visible:!n})}},5149:(e,t,n)=>{n.d(t,{E3:()=>j,FK:()=>U,H4:()=>V,NG:()=>L,Ol:()=>q,R0:()=>K,TT:()=>H,iN:()=>G,nr:()=>$,qU:()=>z,r$:()=>Z,wl:()=>O,z$:()=>N,zt:()=>W});n(67294);var o=n(1302),i=n(15145),r=n(41432),a=n(45433),s=n(59730),l=n(15157),c=n(29477),d=n(21202),u=n(15047),p=n(29369),m=n(63143),f=n(5366),g=n(95477),h=n(93959),v=n(81849),b=n(84210),y=n(33929),S=n(16402),_=n(77907),w=n(80444),k=n(8406),I=n(54642),C=n(14871),x=n(45264),T=n(47307),M=n(96802),P=n(19785),A=n(9953),R=n(42858),D=n(64964),B=n(39699),E=n(85893);const F=(0,f.defineMessages)({copySuccessMessage:{defaultMessage:"Link to view copied to clipboard",id:"database.viewSettings.copyLinkSnackBarItem.title"}});function Z(e){const{collectionContextStore:t,selectViewNameInitial:n,collectionSettingsStore:o,hideSettingsPopup:i,fromBlock:r}=e,a=t.hasSingleCollection()&&!t.collectionStore()?{type:"createViewSource"}:{type:"main",selectViewNameInitial:n};o.setState({open:!0,hideSettingsPopup:i,stack:[a],fromBlock:r})}function L(e){const{collectionSettingsStore:t}=e;O({collectionSettingsStore:t,item:{type:"createSyncedViewSource"}})}function j(e){const{collectionSettingsStore:t}=e;t.setState({...t.state,open:!1,hideSettingsPopup:void 0,stack:[]})}function V(e){const{collectionSettingsStore:t,item:n,hideSettingsPopup:o}=e,i=t.state;t.setState({...i,open:!0,stack:[...i.stack,n],...void 0!==o?{hideSettingsPopup:o}:{}})}function U(e){const{collectionSettingsStore:t,item:n}=e,o=t.state;t.setState({open:!0,stack:[...o.stack.slice(0,o.stack.length-1),n]})}function O(e){const{collectionSettingsStore:t,item:n}=e;t.setState({open:!0,stack:[n]})}function N(e){const{collectionSettingsStore:t}=e,n=t.state,o=n.stack.slice(0,n.stack.length-1);0===o.length?j({collectionSettingsStore:t}):t.setState({open:!0,stack:o})}function z(e){const{collectionSettingsStore:t,property:n,formatKey:o,selectNameInitial:i}=e,r=t.state,a=r.stack.findIndex((e=>"property"===e.type));t.setState({open:!0,stack:[...a>=0?r.stack.slice(0,a):r.stack,{type:"property",property:n,formatKey:o,selectNameInitial:i}]})}function H(e){const{environment:t,collectionContextStore:n,collectionViewStore:o,collectionSettingsStore:i,from:r}=e,a=(0,c.UZ)();return T.showDialog({showCancel:!0,keepFocus:!1,message:(0,E.jsx)(f.FormattedMessage,{defaultMessage:"Are you sure you want to delete this view?",id:"database.viewSettings.mainTab.deleteViewConfirm.text"}),items:[{label:(0,E.jsx)(f.FormattedMessage,{defaultMessage:"Delete view",id:"database.viewSettings.deleteButton.text"}),color:"red",onAccept:()=>{const e=n.collectionViewStore(),s=n.collectionViewBlockStore(),l=n.isFullScreen.state,c=o.getType();e&&s&&c&&(B.createAndCommit({userAction:"collectionSettingsActions.handleDeleteCollectionView",environment:t,perform:a=>{if(x.dp({collectionViewBlockStore:s,collectionViewStore:o,transaction:a}),j({collectionSettingsStore:i}),e.id===o.id){const e=s.getCollectionViewStores()[0];e?x.f8({environment:t,collectionContextStore:n,collectionViewId:e.id,isFullScreen:n.isFullScreen.state,isRootChild:n.isRootChild.state,isInPeekRenderer:n.isInPeekRenderer.state}):(x.ME({environment:t,collectionContextStore:n,transaction:a}),l||R.Cl({environment:t,blocks:[s],transaction:a}))}k.Rc({environment:t,collectionContextStore:n,view_type:c,from:r})}}),a.resolve(!0))}}],handleCancel:()=>a.resolve(!1)}),a.promise}function W(e){const{environment:t,collectionContextStore:n,collectionViewStore:i,collectionSettingsStore:r,intl:a}=e,s=n.isFullScreen.state,l=n.isRootChild.state,c=n.isInPeekRenderer.state,{performResult:d}=B.createAndCommit({userAction:"collectionSettingsActions.newView",environment:t,perform:e=>x.tG({environment:t,collectionContextStore:n,collectionViewStore:i,collectionSettingsStore:r,intl:a,transaction:e})});d&&(x.f8({environment:t,collectionContextStore:n,collectionViewId:d.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:c}),o.default.afterNextFlush((()=>{Z({collectionContextStore:n,collectionSettingsStore:r,selectViewNameInitial:!0})})))}async function q(e){const{environment:t,collectionContextStore:n,collectionViewStore:o}=e,r=n.collectionViewBlockStore();if(!o||!r)return;const a=(0,b.ZP)({store:r,collectionViewId:o.id,fullyQualified:!0,pageVisitSource:i.tY.CopyLink});await C.RD({environment:t,stringValue:a,copiedMessage:C.tq.copiedLinkToClipboard}),D.oV({label:y.default.formatMessage(F.copySuccessMessage)})}function G(e){const{environment:t,collectionContextStore:n}=e,o=n.normalizedFormatStore.state.board_columns_by,i=n.collectionViewStore();if(!o||!i)return;const r=!(0,v.h6)(t,n);B.createAndCommit({userAction:"collectionSettingsActions.handleBoardGroupColorColumnsClick",environment:t,perform:e=>{M.FH({stores:[i],update:{board_columns_by:{...o,disableBoardColorColumns:r}},transaction:e})}}),k.wd({environment:t,collectionContextStore:n,action:"toggle_group_color_columns"})}async function K(e){const{environment:t,uri:n,botId:o,collectionId:i,isStale:r,nextSync:a,setNextSync:c}=e;if(!a||Date.now()>a){var d;let e=Date.now()+m.U6;const a=await I.resubscribeExternalCollection(t,{botId:o,uri:n,isStale:r,collectionId:i});if("failed"===a.type&&(0,s.A6)(a.body)&&"rate_limited"===(null===(d=a.body.clientData)||void 0===d?void 0:d.type)){const t=a.body.clientData.retryAfter;t&&(e=Date.now()+t*m.C0),D.oV({label:(0,E.jsx)(f.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.update.rateLimitError",defaultMessage:"This database was synced recently. You may try again in {time}.",values:{time:(0,S.hH)(Date.now(),e)}})})}if(g.default.isAdminMode)return;l.Z.set({userId:t.currentUser.id,key:`${o}:${n}`,value:e}),c(e)}}async function $(e){const{appTemplatesSetupActions:t,appConfigs:n}=await _.deps.AppTemplates.loader(),{environment:i,selectedDBType:s,collectionName:l,collectionContextStore:c,collectionViewBlockStore:m,collectionViewStore:f,useTemporaryRecordCache:g,temporaryRecordCache:v,baseViewType:b}=e,{currentSpaceViewStore:y}=w.default.state;let S=f,I=m,C=m.getParentStore();var T;g&&(S=f.clone(v),I=m.clone(v),C=null===(T=m.getParentStore())||void 0===T?void 0:T.clone(v));if(s===a.br)k.wd({environment:i,collectionContextStore:c,action:"select_new_collection"}),B.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:i,perform:e=>{if(g){A.sW({store:S,data:{name:void 0,format:void 0,query2:void 0,type:b??"table"},transaction:e}),A.sW({store:I,data:{properties:void 0},transaction:e});const t=I.getCollectionViewSourceCollectionStore();t&&x.A9({collectionViewBlockStore:I,collectionStore:t,transaction:e})}x.TM({environment:i,collectionViewStore:S,collectionViewBlockStore:I,name:l,transaction:e});const t=I.getCollectionViewSourceCollectionStore();c.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:t,collectionViewStore:f})}}),o.default.afterNextFlush((()=>{x.W1({environment:i,collectionContextStore:c})}));else{const e=s,o=(0,h.YB)(n(),e);if(!o)return;const a=(0,h.Zu)(o,e);if(!a)return;B.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:i,perform:e=>{if(!C||C.table!==u.bx&&C.table!==p.e0&&C.table!==d.iU||!y)return;if(!g&&v){i.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(v);I.getCollectionViewStores().forEach((t=>x.dp({collectionViewBlockStore:I,collectionViewStore:t,transaction:e})))}const s=(0,h.KC)(n(),a);t.applyFeatures({environment:i,spaceViewStore:y,appParentStore:C,appUri:o.uri,features:s,createOrModify:"create",initializeStore:I,transaction:e});const l=I.getCollectionViewSourceCollectionStore();if(l){const t=C.table===u.bx?C.id:C.getSpaceId();if(!t)return;for(let o=0;o<3;o++){const n=A.j4({environment:i,type:r.Ti.page,inMemoryRecordCache:I.inMemoryRecordCache,transaction:e,spaceId:t,useCrdt:!1});P.zw({childStore:n,parentStore:l,transaction:e})}const n=I.getCollectionViewStores()[0];c.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:l,collectionViewStore:n}),c.filtersBarOpen.setState(!1)}}})}}},87085:(e,t,n)=>{n.d(t,{G0:()=>B,Jw:()=>Z,K7:()=>E,PW:()=>F});n(57658),n(21703);var o=n(90559),i=n(99036),r=n(45433),a=n(77657),s=n(74181),l=n(72126),c=n(21202),d=n(9844),u=n(15047),p=n(29369),m=n(97880),f=n(5366),g=n(93959),h=n(78316),v=n(33929),b=n(77907),y=n(80444),S=n(30874),_=n(35661),w=n(8406),k=n(54642),I=n(74882),C=n(16956),x=n(31869),T=n(5149),M=n(45264),P=n(28673),A=n(96802),R=n(39699);const D=(0,f.defineMessages)({aiCustomPromptDefaultPropertyName:{id:"collectionSettingsCreatePropertyActions.createProperty",defaultMessage:"Text"}});async function B(e){var t;const{appTemplatesSetupActions:n,appTemplatesSprintBoardActions:i,appConfigs:l}=await b.deps.AppTemplates.loader(),{environment:m,collectionContextStore:f,feature:h}=e,{currentSpaceViewStore:v}=y.default.state,C=f.collectionStore(),x=f.collectionViewStore(),M=null==C?void 0:C.getParentBlockStore(),D=null==M?void 0:M.getParentStore(),B=null==C||null===(t=C.getFormat())||void 0===t?void 0:t.app_config_uri,E=B&&(0,g.YB)(l(),B);if(!C||!M||!D||D.table!==u.bx&&D.table!==c.iU&&D.table!==p.e0||!E)return;const F=C.getSchema(),Z=M.getFormat().app_id,L=Z?await k.getCollectionViewBlocksByAppId(m,{spaceId:M.getSpaceId(),appId:Z}):void 0,j="success"===(null==L?void 0:L.type)&&L.data.result.length?L.data.result.map((e=>_.G.createChildStore(D,{table:c.iU,id:e.blockId,spaceId:M.getSpaceId()}))):[M],V=h.integrationId;if(V){const e=S.Z.getIntegrationsAsRecordMap().getValue({table:d.K2,id:V});if(!e||!(0,s.VM)(e))return;await P.V(m,C,e,Boolean(h.canOnlyAdminAuth))}V===a.U9&&F&&0===(0,o.$z)(F).length&&await I.K({environment:m,collectionStore:C});const U=Date.now();R.createAndCommit({environment:m,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewSuggestedProperty",perform:e=>{var t;if(!E||!v)return;const o=null===(t=C.getFormat())||void 0===t?void 0:t.app_config_uri;if(!o)return;const a=n.applyFeatures({environment:m,spaceViewStore:v,appParentStore:D,appUri:E.uri,features:[{type:"simple",featureUri:h.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:j});if(i.createSprintPage({environment:m,spaceViewStore:v,appParentStore:D,transaction:e,blockStores:a,creationEntryPoint:{type:"sprint_relation"}}),"notion://tasks/sub_task_feature"===h.uri&&(A.FH({stores:[C],update:{collection_default_subitem:r.Es.SubTaskRelation},transaction:e}),x&&A.FH({stores:[x],update:{collection_view_subitem:{property:r.Es.SubTaskRelation}},transaction:e})),"notion://tasks/task_dependencies_feature"===h.uri&&(A.FH({stores:[C],update:{collection_default_arrows_by:r.Es.BlockingRelation},transaction:e}),x&&A.FH({stores:[x],update:{timeline_arrows_by:{property:r.Es.BlockingRelation}},transaction:e})),"dependencies"in h&&h.dependencies.forEach((e=>{"property"===e.type&&e.collectionUri===o&&w._H({environment:m,collectionContextStore:f,from:"view_settings",property:e.uri,property_type:e.propertySchema.type})})),"dependencies"in h&&h.dependencies.map((e=>e.type)).every((e=>"property"===e))){const t=f.collectionViewStore(),n=f.getPropertyFormatKey(),o=f.normalizedFormatStore.state;if(n&&t){const i=o[n]||[],r=[...i];h.dependencies.forEach((e=>{const t=i.findIndex((t=>t.property===e.uri));-1===t?r.push({visible:!0,property:e.uri}):r[t]={...i[t],visible:!0}})),A.FH({stores:[t],update:{[n]:r},transaction:e})}}if(void 0!==h.propertyIdCollectionSettingToNavigateTo){const e={type:"property",property:h.propertyIdCollectionSettingToNavigateTo,selectNameInitial:!1,formatKey:f.getPropertyFormatKey()};T.H4({collectionSettingsStore:f.settingsStore,item:e})}else T.E3({collectionSettingsStore:f.settingsStore});e.postSubmitCallbacks.push((e=>{w.mH(m,{collection_uri:h.collectionUri,feature_uri:h.uri,time:Date.now()-U,status:Boolean(e)?"fail":"success"})}))}})}function E(e){let{propertyType:t,collectionContextStore:n,propertyId:o}=e;switch(t){case"ai_custom_prompt":case"ai_summary":case"ai_extract":case"ai_translate":return T.H4({collectionSettingsStore:n.settingsStore,item:{type:"propertyAiAutofill",propertySchema:n.normalizedSchemaStore[o],property:o}});default:(0,m.t1)(t)}}function F(e){const{environment:t,collectionContextStore:n,propertyType:o,propertyName:r,from:a}=e,s=n.collectionStore(),l=n.collectionViewStore(),c=n.getPropertyFormatKey();if(!s||!c)return;if("relation"===o)return void T.H4({collectionSettingsStore:n.settingsStore,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});let d=r;"ai_custom_prompt"===o&&(d=v.default.formatMessage(D.aiCustomPromptDefaultPropertyName));const{performResult:u}=R.createAndCommit({userAction:"collectionSettingsCreatePropertyActions.handleCreateNewStandardProperty",environment:t,perform:e=>C.G3({environment:t,collectionStore:s,collectionViewArgs:l?{collectionViewStore:l,format:l.getFormat(),formatKey:c}:void 0,propertyName:d,propertyType:o,transaction:e})});(0,i.XU)(o)?E({propertyType:o,propertyId:u,collectionContextStore:n}):T.qU({collectionSettingsStore:n.settingsStore,property:u,formatKey:c,selectNameInitial:!0}),w._H({environment:t,collectionContextStore:n,from:a,property_type:(0,i.TN)(o)})}async function Z(e){const{environment:t,collectionContextStore:n,intl:r,connectedRelationProperty:s}=e,c=n.collectionStore(),d=n.collectionViewStore(),u=n.getPropertyFormatKey();if(!c||!u)return;const p=s.integration.id;[a.f3,a.mQ].includes(p)||await P.V(t,c,s.integration,Boolean(s.canOnlyAdminAuth));const f=c.getSchema();let g;s.integration.id===a.U9&&f&&0===(0,o.$z)(f).length&&(g=await I.K({environment:t,collectionStore:c})),R.createAndCommit({environment:t,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewConnectedRelationProperty",perform:e=>{g&&C.G3({environment:t,collectionStore:c,collectionViewArgs:d?{collectionViewStore:d,format:d.getFormat(),formatKey:u}:void 0,propertyType:"auto_increment_id",transaction:e});const o=c.getDeletedSchema(),p=(0,m.qP)(o).map((e=>{let[t,n]=e;if(n&&i.NK(n)&&n.connectedRelation.integration_id===a.U9)return{propertyId:t,propertySchema:n}})).filter(m.$K);if(!l.xb(p)){const{propertyId:i}=p[0],r=(0,h.D8)({deletedSchema:o,property:i});if(!r)throw new Error("Deleted property schema was not found");M.xO({environment:t,collectionStore:c,update:r.updateSchema,transaction:e}),M.$N({collectionStore:c,update:r.updateDeletedSchema,transaction:e});const a={type:"property",property:i,formatKey:u};return void T.H4({collectionSettingsStore:n.settingsStore,item:a})}const f=P.c({environment:t,pattern:s.pattern,integration:s.integration,parentCollectionStore:c,transaction:e}),v=C.G3({environment:t,collectionStore:c,collectionViewArgs:d&&u?{collectionViewStore:d,format:d.getFormat(),formatKey:u}:void 0,propertyType:"relation",transaction:e});x.n7({environment:t,collectionContextStore:n,collectionStore:c,property:v,propertyName:s.name,propertyLimit:"no_limit",targetCollectionStore:f,hasInverseRelation:!0,autoRelate:void 0,intl:r,connectedRelation:{integration_id:s.integration.id},transaction:e});const b={type:"property",property:v,formatKey:u};T.H4({collectionSettingsStore:n.settingsStore,item:b}),w._H({environment:t,collectionContextStore:n,from:"view_settings",property_type:"relation",integration_id:s.integration.id})}})}},98834:(e,t,n)=>{n.d(t,{$p:()=>M,R5:()=>x,Zh:()=>C,nx:()=>I,ob:()=>T});n(21703),n(57658);var o=n(41432),i=n(87444),r=n(42875),a=n(23867),s=n(70203),l=n(5366),c=n(33929),d=n(18245),u=n(94896),p=n(35661),m=n(50906),f=n(54642),g=n(47307),h=n(54532),v=n(96802),b=n(94419),y=n(9953),S=n(98724),_=n(29373);const w=(0,l.defineMessages)({duplicateTemplateError:{id:"databaseTemplatePickerActions.duplicateTemplateFailedError.message",defaultMessage:"Duplicate template failed."}});function k(e){const{environment:t,pageStore:n,copiedFromPointer:o,useInMemoryRecordCache:s,addCopyName:l,transaction:d,resolveTemplateVariables:m}=e,v=new p.G(t,o,{inMemoryRecordCache:s});if(s){const e=h.K8(t,{blockId:v.id,inMemoryRecordCache:v.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!e)throw new Error("Client copy could not be created.");h.E9({environment:t,sourceBlockId:v.id,targetBlockPointer:n.pointer,sourceBlockSubtree:e,targetInMemoryRecordCache:n.inMemoryRecordCache,addCopyName:l,transaction:d,deepCopyTransclusionContainers:!1,resolveTemplateVariables:m,useCrdt:n.useCrdt()})}else{if(y.sW({store:n.getPropertiesStore(),data:v.getProperties(),transaction:d}),m&&S.bt({store:n,context:{currentUserId:t.currentUser.id,currentTimeZone:(0,r.r)()},transaction:d}),l){const e=n.getTitleStore();e&&y.sO({store:e,value:i.eb(e.getValue()),transaction:d})}const e={copied_from:o.id};y.sW({store:n,data:e,transaction:d});const s={...v.getFormat(),copied_from_pointer:o};delete s.automation_id,delete s.app_config_uri,y.sW({store:n.getFormatStore(),data:s,transaction:d}),v.hasContent()&&(u.Z.setStatus(n.id,!0),d.postSubmitCallbacks.push((async e=>{if(e)return g.showErrorMessage(c.default.formatMessage(w.duplicateTemplateError)),void u.Z.setStatus(n.id,!1);await f.duplicateBlock(t,{sourceBlocks:[{id:o.id,spaceId:(0,a.C)(o.spaceId)}],targetBlocks:[{id:n.id,spaceId:(0,a.C)(n.pointer.spaceId)}],addCopyName:l,appendContentOnly:!0,isTemplateInstantiation:!0,resolveTemplateVariables:!!m&&{currentUserId:t.currentUser.id,currentTimeZone:(0,r.r)()},deepCopyTransclusionContainers:!1}).next().finally((()=>{u.Z.setStatus(n.id,!1)}))})))}return n}function I(e){const{environment:t,collectionStore:n,transaction:i,title:r}=e,a=y.j4({environment:t,type:o.Ti.page,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,spaceId:n.getTemplatePagesStore().pointer.spaceId,properties:{title:(0,s.TPx)(r||"")},useCrdt:!1});return y.sW({store:a,data:{is_template:!0},transaction:i}),b.R3({parent:n.getTemplatePagesStore(),append:a,transaction:i}),a}function C(e){const{environment:t,collectionStore:n,templateStore:i,transaction:r}=e,a=y.j4({environment:t,type:o.Ti.page,inMemoryRecordCache:i.inMemoryRecordCache,transaction:r,spaceId:n.getTemplatePagesStore().pointer.spaceId,useCrdt:!1});y.sW({store:a,data:{is_template:!0},transaction:r}),b.BE({parent:n.getTemplatePagesStore(),after:i,insert:a,transaction:r});try{k({environment:t,copiedFromPointer:i.pointer,pageStore:a,addCopyName:!0,transaction:r,resolveTemplateVariables:!1})}catch(s){g.showErrorMessage(c.default.formatMessage(w.duplicateTemplateError))}return a}function x(e){const{collectionStore:t,templateStore:n,transaction:o}=e;b.Od({parent:t.getTemplatePagesStore(),childToRemove:n,transaction:o})}function T(e){const{environment:t,store:n,templateStore:o,title:i,isKeyboard:r,isCreateIn:a,transaction:s,from:l}=e,c=n.getProperties(),u=d.default.mark("rum.initialize_collection_template");if(k({environment:t,pageStore:n,copiedFromPointer:o.pointer,useInMemoryRecordCache:n.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache?n.inMemoryRecordCache:void 0,transaction:s,resolveTemplateVariables:!0}),"template"!==i){const e="empty"===i?null:i.text;y.sW({store:n.getPropertiesStore(),data:{title:e},transaction:s})}y.sW({store:n.getPropertiesStore(),data:c,transaction:s}),y.sW({store:n,data:{is_template:null},transaction:s}),v.Wq({environment:t,store:n,isLocked:!1,transaction:s}),0===o.getContentLength()&&_.ls({environment:t,store:n,transaction:s}),d.default.measure(u,{environment:t}),m.XQ5(t,{template_id:o.id,collection_id:o.getParentId(),is_keyboard:r,is_create_in:a,from:l})}function M(e){const{collectionStore:t,newTemplateIds:n,transaction:o}=e;y.sW({store:t,data:{template_pages:n},transaction:o})}},45264:(e,t,n)=>{n.d(t,{zz:()=>ct,TM:()=>lt,wG:()=>_t,MO:()=>kt,pi:()=>ht,ME:()=>$e,Ki:()=>Ct,HW:()=>ut,dp:()=>Qe,ob:()=>He,IH:()=>It,tG:()=>Ke,dj:()=>ft,lG:()=>Tt,oh:()=>vt,C_:()=>pt,mS:()=>mt,fI:()=>xt,A9:()=>dt,Wu:()=>Ye,mc:()=>ze,Ip:()=>rt,n1:()=>at,W1:()=>St,bu:()=>Pt,f8:()=>yt,t5:()=>We,Z5:()=>wt,Rm:()=>et,$N:()=>nt,$D:()=>bt,xO:()=>tt,iG:()=>Je,Uy:()=>it,Es:()=>Xe,yc:()=>st,z2:()=>ot,Ug:()=>qe});n(21703),n(57658);var o=n(30120),i=n(1302),r=n(15145),a=n(41432),s=n(14248),l=n(76205),c=n(14714),d=n(99036),u=n(43690),p=n(10070),m=n(28155),f=n(45433),g=n(60310),h=n(21202),v=n(97880);function b(e){switch(e){case"trending":case"similarUsers":return{title:{name:"Name",type:"title"}};case"myTasks":return{};default:(0,v.t1)(e)}}function y(e){const{type:t}=e;return{id:(0,g.nZ)(e),parent_table:h.iU,parent_id:t,version:1,alive:!0,space_id:e.spaceId,format:{},schema:b(t)}}var S=n(53877),_=n(93824),w=n(87444),k=n(6695),I=n(68626),C=n(42875),x=n(74229),T=n(15157),M=n(72126),P=n(77897),A=n(59753),R=n(29477),D=n(4615),B=n(71644),E=n(45953),F=n(23014),Z=n(98963),L=n(18844),j=n(6287),V=n(13493),U=n(23867),O=n(54153),N=n(70203),z=n(63143),H=n(5366),W=n(2553),q=n(23823),G=n(28020),K=n(42),$=n(97004),Q=n(75079),Y=n(81849),J=n(52821),X=n(26991),ee=n(78316),te=n(77181);const ne=new class{constructor(){this.cache=new Map}get(e){return this.cache.get(e)}set(e,t){for(this.cache.delete(e),this.cache.set(e,t);this.cache.size>25;){const e=this.cache.keys().next().value;this.cache.delete(e)}}};var oe=n(33929),ie=n(45950),re=n(89796),ae=n(18514),se=n(77546),le=n(18245),ce=n(14654),de=n(58202),ue=n(5162),pe=n(80444),me=n(17746),fe=n(886),ge=n(6776),he=n(19511),ve=n(88632),be=n(77080),ye=n(79167),Se=n(37598),_e=n(89087),we=n(35661),ke=n(27724),Ie=n(54642),Ce=n(49865),xe=n(5149),Te=n(41433),Me=n(47307),Pe=n(96802),Ae=n(94419),Re=n(92625),De=n(19785),Be=n(9953),Ee=n(4408),Fe=n(75018),Ze=n(80402),Le=n(98104),je=n(39699),Ve=n(61202),Ue=n(53471);const Oe=(0,H.defineMessages)({importingCSV:{id:"databaseViewActions.importingCSV.loadingMessage",defaultMessage:"Importing"},uploadingCSV:{id:"databaseViewActions.uploadingCSV.loadingMessage",defaultMessage:"Uploading"},importFailed:{id:"databaseViewActions.importFailedError.message",defaultMessage:"Import failed."}}),Ne=(0,H.defineMessages)({renameButtonTitle:{defaultMessage:"Rename",id:"database.collectionEditViewButtonPopup.renameButtonTitle"},statusName:{defaultMessage:"Status",id:"database.collectionEditViewButtonPopup.statusNameProperty"},dateName:{defaultMessage:"Date",id:"database.collectionEditViewButtonPopup.dateNameProperty"}});function ze(e){const{environment:t,collectionViewBlockStore:n,collectionViewStore:r,collectionStore:a,collectionContextStore:s,isFullScreen:c,isRootChild:d,isInPeekRenderer:u}=e;He({collectionContextStore:s}),c&&(Fe.resetPageState(t),Fe.resetEditorState(t));const{remoteRequestStore:p,localResultStore:f}=s;if(r){var g;const e=Boolean(!s.isViewSpecificClientModeEnabled.state&&s.isClientModeEnabled.state&&a&&a.id===(null===(g=s.collectionStore())||void 0===g?void 0:g.id)),h=o.ou.fromMillis(me.Z.getLocalDateRangeStart({collectionViewId:r.id,currentUserId:t.currentUser.id}));let b;const y=()=>{i.default.afterNextFlush((()=>{const e=p.state;s.isViewSpecificClientModeEnabled.state&&b&&e&&!M.Xy(b.loader.filter,e.loader.filter)&&(s.isClientModeEnabled.setState(!1),s.isViewSpecificClientModeEnabled.setState(!1));const o=function(e,t){if(void 0===t)return;if(void 0===e)return"initial_load";if(!M.Xy(e.collectionView,t.collectionView))return"change_view";if(!M.Xy(e.loader.searchQuery,t.loader.searchQuery))return"change_search";if(!M.Xy(e.loader.sort,t.loader.sort))return"change_sort";if(!M.Xy(e.loader.filter,t.loader.filter))return"change_filter";const n=e&&"reducer"===e.loader.type&&e.loader.reducers||{},o=t&&"reducer"===t.loader.type&&t.loader.reducers||{};if(Object.keys(o).find((e=>{const t=n[e],i=o[e];return i&&(!t||!M.Xy(t,i))})))return"change_group";const i={reducers:void 0,filter:void 0,sort:void 0,reducerDependencies:void 0},r={...null==e?void 0:e.loader,...i},a={...null==t?void 0:t.loader,...i};return M.Xy(r,a)?void 0:"change_loader"}(b,e);void 0===o||s.isClientModeEnabled.state&&!function(e,t,n,o){if(!n)return!1;if(null!=t&&t.loader.filter&&(0,l.SH)(null==t?void 0:t.loader.filter,(e=>(0,l.aN)(e)&&(0,F.zy)(e,n.getSchema()))))return!0;return(0,X.ki)(null==t?void 0:t.loader.reducers,n.getSchema(),o)}(0,e,a,n)||ft(t,s,{src:o}),b=e}))};p.addListener(y);const _=()=>{if((0,P.lB)(1)){const e=le.default.mark("database_update_lag");le.default.measureAfterNextFlush(e,{environment:t})}};f.addListener(_),s.remoteResult.setState(void 0),s.isLoaded.setState(!1),s.searchQuery.setState(""),s.searchOpen.setState(!1),s.calendarByMenuOpen.setState(!1),s.timelineByMenuOpen.setState(!1),s.isFullScreen.setState(c),s.isRootChild.setState(d),s.reducers.setState({}),s.groupsStore.reset(),s.groupsLimit.setState(Y.XD),s.boardColumnsLimit.setState(Y.XD),s.filtersBarOpen.setState(void 0),s.isInPeekRenderer.setState(u),s.subitemExpandedStore.setState(new Map),s.isClientModeEnabled.setState(e),s.isViewSpecificClientModeEnabled.setState(!1),s.asyncAggregationStatus.reset(),s.dateRangeStart.setState((0,S.IS)(h.startOf("month").valueOf(),G.AK.state).valueOf()),s.dateRangeEnd.setState(c&&!t.device.isMobile?(0,S.V7)(h.endOf("month").plus({month:1}).valueOf(),G.AK.state).valueOf():(0,S.V7)(h.endOf("month").valueOf(),G.AK.state).valueOf());const w=null==r?void 0:r.getFormat(),k=null==w?void 0:w.collection_view_source;"typed"===(null==k?void 0:k.type)?s.setContext({type:"collectionTypedView",collectionViewBlockStore:n,databaseType:k.databaseType,collectionViewStore:r,pageVisitSourceOverride:(0,ce.ib)({blockOrCollectionId:r.id})}):(0,m.nx)(k)?a&&s.setContext({type:"collectionVirtualView",collectionViewBlockStore:n,collectionViewStore:r,collectionStore:a,pageVisitSourceOverride:(0,ce.ib)({blockOrCollectionId:r.id})}):k&&"collection"!==k.type?(0,v.t1)(k):s.setContext({type:"collectionView",collectionViewBlockStore:n,collectionStore:a,collectionViewStore:r}),s.remoteRequestStoreCallback=y,s.localResultStoreCallback=_;const I=ne.get(r.id);I&&(s.resetLoadingState(),s.resultSet.setState(M.Xh(I.resultSet)),s.remoteCollectionIds.setState(M.Xh(I.collectionIds)),s.remoteResult.setState(M.Xh(I.remoteResult)),s.isLoaded.setState(!0));const C=_e.transactionQueue.isPendingTransactionForRecord(r.pointer);s.wasCreatedThisSession.setState(C);const x=function(e){let{currentUserId:t,collectionViewId:n}=e;const o=T.Z.get({userId:t,key:At(n)});if(o)return(0,z.dj)(o)}({currentUserId:t.currentUser.id,collectionViewId:r.id});s.temporaryState.setState(x||{});const{currentSpaceStore:A}=pe.default.state;if(a&&A&&a.getSpaceId()===A.id&&a.isDefaultRecordCache()){!function(e){let{currentUserId:t,spaceId:n,collectionId:o}=e;const i=Tt({currentUserId:t,spaceId:n}),r=M.jj([o,...i]).slice(0,10);T.Z.set({userId:t,key:Mt(n),value:JSON.stringify(r)})}({currentUserId:t.currentUser.id,spaceId:A.id,collectionId:a.id})}c&&(a&&n.getCollectionViewSourceCollectionStore()&&!a.getName()&&(!t.device.isMobile||ae.NW(t)||(0,ue.Y)("supportsUntitledPageAutoSelectOnStart"))?St({environment:t,collectionContextStore:s}):!a&&s.hasSingleCollection()&&xe.r$({collectionContextStore:s,collectionSettingsStore:s.settingsStore})),s.frozoneStore.setState({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1})}}function He(e){const{collectionContextStore:t}=e,{localResultStore:n,remoteRequestStore:o,remoteRequestStoreCallback:i,localResultStoreCallback:r}=t;i&&o.removeListener(i),r&&n.removeListener(r)}function We(e){const{dateRangeStart:t,dateRangeEnd:n,collectionContextStore:o}=e;o.dateRangeStart.setState(t),o.dateRangeEnd.setState(n)}function qe(e){const{searchQuery:t,collectionContextStore:n}=e;n.collectionViewStore()&&(n.searchQuery.setState(t||""),n.groupsStore.resetAllLimits())}function Ge(e){const{environment:t,collectionViewBlockStore:n,collectionView:o,transaction:i}=e,r=Be.ae({environment:t,table:V.n,value:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i}),a=we.Xr.createChildStore(n,{table:V.n,id:r.id,spaceId:n.getSpaceId()});return Ae.R3({parent:n.getCollectionViewsStore(),append:a,transaction:i}),a}function Ke(e){const{environment:t,collectionContextStore:n,collectionViewStore:o,intl:i,transaction:r}=e,a=n.collectionViewBlockStore();if(!a)return;const s=o.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(o)}));if(!s)return;return Ge({environment:t,collectionViewBlockStore:a,collectionView:{...s,id:(0,D.ZP)(),name:(0,w.nM)(s.name||i.formatMessage(ee.b1[s.type]))},transaction:r})}function $e(e){var t,n,o;const{environment:r,collectionContextStore:a,transaction:s}=e,l=a.collectionViewBlockStore(),c=a.collectionViewStore(),d=a.settingsStore;if(!l)return;const u=null===(t=a.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_subitem,p=null===(n=a.collectionStore())||void 0===n||null===(n=n.getFormat())||void 0===n?void 0:n.collection_default_arrows_by,m=Ge({environment:r,collectionViewBlockStore:l,collectionView:{type:"table",parent_id:l.id,parent_table:h.iU,alive:!0,space_id:l.getSpaceId(),format:{table_properties:null==c||null===(o=c.getFormat())||void 0===o?void 0:o.table_properties,collection_view_subitem:u?{property:u}:void 0,timeline_arrows_by:p?{property:p}:void 0,table_subitem_toggle_column:"title",...c&&"collectionTypedView"===a.contextType?{collection_view_source:c.getFormat().collection_view_source,property_filters:c.getFormat().property_filters}:{}}},transaction:s});yt({environment:r,collectionContextStore:a,collectionViewId:m.id,isFullScreen:a.isFullScreen.state,isRootChild:a.isRootChild.state,isInPeekRenderer:a.isInPeekRenderer.state}),i.default.afterNextFlush((()=>{l.getCollectionViewSourceCollectionStore()?(xe.r$({collectionContextStore:a,collectionSettingsStore:d}),xe.wl({collectionSettingsStore:d,item:{type:"createView"}})):xe.r$({collectionContextStore:a,collectionSettingsStore:d})}))}function Qe(e){const{collectionViewBlockStore:t,collectionViewStore:n,transaction:o}=e,i=we.Xr.createChildStore(t,{table:V.n,id:n.id,spaceId:t.getSpaceId()}),r=n.getFormat().app_config_uri;if(r){var a;const e=null===(a=t.getFormat())||void 0===a?void 0:a.app_uri_map;e&&delete e[r],Pe.FH({stores:[t],update:{app_uri_map:e},transaction:o})}Ae.Od({parent:t.getCollectionViewsStore(),childToRemove:i,transaction:o})}function Ye(e){const{collectionViewBlockStore:t,newViewIds:n,transaction:o}=e,i=t.getCollectionViewStores(),{beforeOps:r}=(0,_.q)(i.map((e=>e.id)).slice(0,n.length),n);M.Ed(r,((e,i)=>{const r=we.Xr.createChildStore(t,{table:V.n,id:i,spaceId:t.getSpaceId()});if(e)Ae.Vt({parent:t.getCollectionViewsStore(),insert:r,before:we.Xr.createChildStore(t,{table:V.n,id:e,spaceId:t.getSpaceId()}),transaction:o});else{const e=M.Z$(n.filter((e=>e!==i)));Ae.BE({parent:t.getCollectionViewsStore(),insert:r,after:e?we.Xr.createChildStore(t,{table:V.n,id:e,spaceId:t.getSpaceId()}):void 0,transaction:o})}}))}function Je(e){const{collectionViewStore:t,update:n,transaction:o}=e;Be.sW({store:t,data:n,transaction:o})}function Xe(e){const{collectionViewStore:t,update:n,transaction:o}=e;Be.sW({store:t.getQueryStore(),data:n,transaction:o})}function et(e){const{environment:t,collectionStore:n,update:o,transaction:i}=e,r=n.getSchema();o.schema&&(o.schema=d.Fn(o.schema)),o.deleted_schema&&(o.deleted_schema=d.Fn(o.deleted_schema));const a={...o};if(o.deleted_schema){const e=n.getDeletedSchema(),t=(0,p.jf)({schemas:[e,o.deleted_schema]});t.error?I.log({level:"error",from:"collectionViewActions",type:"updateCollection",error:t.error}):a.deleted_schema=t.value}Be.sW({store:n,data:a,transaction:i}),o.schema&&pt({environment:t,collectionStore:n,oldSchema:r,newSchema:o.schema,transaction:i})}function tt(e){const{environment:t,collectionStore:n,update:o,transaction:i}=e,r=n.getSchema(),a=d.Fn(o);Be.sW({store:n.getSchemaStore(),data:a,transaction:i}),pt({environment:t,collectionStore:n,oldSchema:r,newSchema:n.getSchema(),transaction:i})}function nt(e){const{collectionStore:t,update:n,transaction:o}=e;Be.sW({store:(0,we._J)(t,t.pointer,["deleted_schema"]),data:n,transaction:o})}function ot(e){var t;const{environment:n,collectionContextStore:o,newViewType:i,transaction:r,intl:a}=e,s=o.collectionViewStore(),l=o.collectionViewBlockStore(),d=o.collectionStore();if(!s||!l)return;const u=o.normalizedSchemaStore.state;if(i===s.getType())return;const p=o.permissionScopes.state,m=s.getType();if(Be.sW({store:s,data:{type:i},transaction:r}),"board"===m&&Pe.FH({stores:[s],update:{board_columns_by:void 0,collection_group_by:s.getFormat().board_columns_by},transaction:r}),"table"===i)Be.sW({store:s.getQueryStore(),data:{aggregations:[{property:"title",aggregator:"count"}]},transaction:r});else if("board"===i){var f;let e=(null===(f=s.getFormat().collection_group_by)||void 0===f?void 0:f.property)??ee.Se(u);if(d&&!e){e=(0,B.ZP)();const t={name:a.formatMessage(Ne.statusName),type:"select",options:[]};p.canConfigureCollection&&tt({environment:n,collectionStore:d,update:{[e]:t},transaction:r})}const t=o.normalizedSchemaStore.state,i=e&&t[e];if(!e||!i||!(0,c.LG)(i))return;Pe.FH({stores:[s],update:{board_columns_by:(0,c.fw)(e,i,"collectionTypedView"===o.contextType),collection_group_by:void 0},transaction:r})}else if("calendar"===i){let e=ee.PD(u);if(d&&!e){e=(0,B.ZP)();const t={name:a.formatMessage(Ne.dateName),type:"date"};p.canConfigureCollection&&tt({environment:n,collectionStore:d,update:{[e]:t},transaction:r})}Be.sW({store:s.getQueryStore(),data:{aggregations:[],calendar_by:e},transaction:r})}else if("gallery"===i)Pe.FH({stores:[s],update:{gallery_cover:{type:"page_content"}},transaction:r}),Be.sW({store:s.getQueryStore(),data:{aggregations:[]},transaction:r});else if("list"===i){const e=Object.keys(u).find((e=>{const t=u[e];return Boolean(t&&(0,J.Rb)(t))}));Pe.FH({stores:[s],update:{list_properties:e?[{property:e,visible:!0}]:[]},transaction:r}),Be.sW({store:s.getQueryStore(),data:{aggregations:[]},transaction:r})}else if("timeline"===i){let e=ee.HI(u);if(d&&!e){e=(0,B.ZP)();const t={name:a.formatMessage(Ne.dateName),type:"date"};p.canConfigureCollection&&tt({environment:n,collectionStore:d,update:{[e]:t},transaction:r})}Be.sW({store:s.getQueryStore(),data:{aggregations:[{property:"title",aggregator:"count"}],timeline_by:e},transaction:r})}const g=null===(t=s.getFormat().collection_view_subitem)||void 0===t?void 0:t.property;if(g&&!(0,te.Av)(i)){const e=m&&!(0,te.Av)(i)?(0,k.oz)(m):void 0,t=(e?s.getFormat()[e]??[]:[]).find((e=>e.property===g))??{property:g,visible:!0},n=(0,k.oz)(i),o=s.getFormat()[n]??[];Pe.FH({stores:[s],update:{[n]:[...o,t]},transaction:r})}rt({collectionContextStore:o})}function it(e){const{icon:t,collectionViewBlockStore:n,transaction:o}=e;Pe.FH({stores:[n],update:{collection_view_icon:t},transaction:o})}function rt(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(!n)return;const o=de.R.findCollectionViewBlockFromStore(n);null!=o&&o.resetLeftScrollAfterFlush&&o.resetLeftScrollAfterFlush()}function at(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(n){const e=de.R.findCollectionViewBlockFromStore(n);if(e){const t=e.getNode();t&&(0,se.Wr)(t,{edgeDist:0,animate:!1})}}}function st(e){var t,n,o,i;const{collectionContextStore:r,collectionStore:a,transaction:s}=e,l=r.collectionViewStore();if(!l||!a.isDefined())return;const c=ee.Vv(a),d=null===(t=a.getFormat())||void 0===t?void 0:t.collection_default_subitem,u=null===(n=a.getFormat())||void 0===n?void 0:n.collection_default_arrows_by,p={table_properties:null==c||null===(o=c.getFormat())||void 0===o?void 0:o.table_properties,collection_pointer:{table:j.v,id:a.id,spaceId:a.getSpaceId()},collection_view_subitem:d?{property:d}:void 0,timeline_arrows_by:u?{property:u}:void 0,table_subitem_toggle_column:"title"},m=null==r?void 0:r.normalizedSchemaStore.state;Be.sW({store:l,data:(0,z.Q2)({format:p,query2:{sort:null==c||null===(i=c.getQuery(m))||void 0===i?void 0:i.sort}}),transaction:s})}function lt(e){var t;const{environment:n,name:o,collectionViewStore:i,collectionViewBlockStore:r,transaction:s}=e,l=i.getType();if(!l||!r.isDefined())return;const c=r.getCollectionPointer(),d=r.getFormat(),u=(0,N.QaF)(null===(t=r.getTitleStore())||void 0===t?void 0:t.getValue()),p=c||o||!u?o:u,m=(0,K.Yu)({environment:n,isInline:r.getType()===a.Ti.collectionView,name:p,viewType:l}),f=E.Ao.create();f.set({table:V.n,id:"collection_view"},i.pointer),Te.ZI({environment:n,sourceBlockId:"root",targetBlockPointer:r.pointer,sourceBlockSubtree:m?(0,E.R3)(m):E.Ak.create(),targetRecordCache:r.inMemoryRecordCache,transaction:s,recordPointerMap:f,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:r.useCrdt()});const g=f.get({table:j.v,id:"collection"});if(!g)return;Pe.FH({stores:[r],update:{collection_pointer:g},transaction:s});const h=r.getCollectionStore();h&&(et({collectionStore:h,update:{icon:null==d?void 0:d.page_icon,cover:null==d?void 0:d.page_cover},environment:n,transaction:s}),Pe.FH({stores:[h],update:{collection_cover_position:null==d?void 0:d.page_cover_position},transaction:s}))}function ct(e){const{collectionViewBlockStore:t,collectionStore:n,transaction:o}=e;if(!t.isDefined()||!n.isDefined())return;if(t.getCollectionPointer())throw new Error("CollectionViewBlock already has a collection");Pe.FH({stores:[t],update:{collection_pointer:n.pointer},transaction:o})}function dt(e){const{collectionViewBlockStore:t,collectionStore:n,transaction:o}=e;if(!t.isDefined()||!n.isDefined())return;[t].forEach((e=>{var t;e.getCollectionViewStores().filter((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===n.id})).forEach((t=>Qe({collectionViewBlockStore:e,collectionViewStore:t,transaction:o}))),(null===(t=e.getFormat().collection_pointer)||void 0===t?void 0:t.id)===n.id&&Be.sW({store:e,data:{format:{...e.getFormat(),collection_pointer:void 0},collection_id:null},transaction:o})})),De.hh({childStore:n,transaction:o})}function ut(e){const{environment:t,collectionStore:n,performTransaction:o}=e;return je.createAndCommit({userAction:"collectionViewActions.createSchemaUpdateTransaction",environment:t,perform:e=>{const i=n.getSchema(),r=o(e),a=n.getSchema();return pt({environment:t,collectionStore:n,oldSchema:i,newSchema:a,transaction:e}),r}}).performResult}function pt(e){const{environment:t,collectionStore:n,oldSchema:o,newSchema:i,transaction:r}=e,a=d.Fn(o),l=d.Fn(i),c=Object.keys(l);for(const p of c){const e=a[p],o=l[p];if(o){if("status"===o.type&&"status"!==(null==e?void 0:e.type)){let i;i="select"===(null==e?void 0:e.type)||"multi_select"===(null==e?void 0:e.type)?(0,s.r9)(o.name,e.options??[]):o.groups&&o.options&&o.defaultOption?o:d.I4(o.name);const a={...l,[p]:i};if(Be.sW({store:n,data:{schema:a},transaction:r}),"checkbox"===(null==e?void 0:e.type)&&"status"===o.type){const e=i.groups??[],o=e[e.length-1];o&&Ce.hz({environment:t,collectionStore:n,property:p,oldValue:{type:"checkbox",value:!0},newValue:{type:"status",value:{type:"by_group",group:o.name}},transaction:r})}}if("status"===(null==e?void 0:e.type)&&"checkbox"===o.type){const o=e.groups??[],i=e.options??[],a=o[o.length-1],s=i.filter((e=>{var t;return null==a||null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id)}));for(const e of s)Ce.hz({environment:t,collectionStore:n,property:p,newValue:{type:"checkbox",value:!0},oldValue:{type:"status",value:{type:"by_option",option:e.value}},transaction:r})}}}for(const s of c){const e=a[s],o=l[s];!o||e&&d.cu(e)||!d.cu(o)||Ie.getSelectPropertyValues(t,{collection:{id:n.id,spaceId:(0,U.C)(n.pointer.spaceId)},property:s}).then((e=>{if("failed"===e.type)throw e.error;const{results:i}=e.data,r=o.options||[],a=d.Fn(n.getSchema()),l=M.mN([...r,...i.map((e=>({id:(0,B.ZP)(),value:e})))],(e=>e.value)),c={...o,options:l},u={...a,[s]:c};je.createAndCommit({userAction:"collectionViewActions.handleCollectionSchemaUpdated",environment:t,perform:e=>{Be.sW({store:n,data:{schema:u},transaction:e})}})}))}const u=M.jj([...Object.keys(a),...Object.keys(l)]);for(const s of u){const e=a[s],o=l[s],i=e&&d.cu(e)||"status"===(null==e?void 0:e.type),c=o&&d.cu(o)||"status"===(null==o?void 0:o.type);if(i&&c&&e.type===o.type){const i=o,a=e.options||[],l=i.options||[],c=M.jj([...a.map((e=>e.id)),...l.map((e=>e.id))]);for(const d of c){const i=a.find((e=>e.id===d)),c=l.find((e=>e.id===d));if(i&&c&&i.value!==c.value){const a="status"===e.type?{type:"status",value:{type:"by_option",option:i.value}}:{type:e.type,value:i.value},l="status"===o.type?{type:"status",value:{type:"by_option",option:c.value}}:{type:o.type,value:c.value};Ce.hz({environment:t,collectionStore:n,property:s,oldValue:a,newValue:l,transaction:r})}}}}for(const s of u){const e=l[s];"button"!==(null==e?void 0:e.type)||e.automation_id||W.Hj({environment:t,collectionStore:n,property:s,transaction:r})}}function mt(e){const{store:t,environment:n}=e;let o;Ue.cR({environment:n,bucket:"temporary",onStart:e=>{o=e,Re.j({message:Oe.uploadingCSV})},onComplete:e=>{(async(e,o)=>{Re.j({message:Oe.importingCSV});const i=t.getCollectionViewCollectionStore();if(!i)return;if(!de.R.findCollectionViewBlockFromStore(t))return;const{value:r}=await Ie.importFile(n,{importType:"MergeIntoCollection",fileURL:e,fileName:o,collection:{id:i.id,spaceId:(0,U.C)(i.pointer.spaceId)}}).next();r.error&&Me.showErrorMessage(oe.default.formatMessage(Oe.importFailed)),Re.x()})(e[0],o[0].name)},onError:e=>{Re.x(),Me.showErrorMessage(oe.default.formatMessage(Oe.importFailed))}})}async function ft(e,t,n){const o=t.collectionViewStore(),{remoteRequestStore:i}=t;if(!i||!o)return;const r=i.state;if(!r)return;const a=t.createUpdateCounter(),s=t.remoteResult.state;ve.Z.state.online&&s&&await _e.transactionQueue.drain();const l=o.inMemoryRecordCache;if(!t.shouldUpdate(a))return;t.isLoading.setState(!0);const c=le.default.mark("collections.remote_query_collection_latency");let d;if(l===e.defaultRecordCache.inMemoryRecordCache&&ve.Z.state.online){const o="initial_load"===n.src?(0,J.Cg)(r):r,i=[];if(be.default.checkGate("collection_split_aggregation_v2")&&"msg"!==n.src&&!("initial_load"===n.src&&e.prefetchCache.hasPrefetchedRequest("queryCollection",(0,q.yX)({environment:e,eventName:"queryCollection",data:o,tracking:n,activeUserId:e.currentUser.id})))){let s=!1;const l={};if(Object.entries(o.loader.reducers||{}).forEach((e=>{let[t,n]=e;"aggregation"!==n.type?l[t]=n:s=!0})),d=Ie.queryCollection(e,{...o,loader:{...o.loader,reducers:l}},void 0,{...n,src:`${n.src}${s?"_no_aggregations":""}`},void 0,"queryCollection").then((o=>{const i=Q.vS(t,n.src);if(le.default.measure(c,{environment:e,data:i}),"success"===o.type)return"initial_load"===n.src&&O.Z.set((0,re.Z)(r.collectionView.id),r),gt({environment:e,remoteRequest:r,collectionContextStore:t,response:o.data,updateCounter:a,keepAggregationResults:s})})),i.push(d),s){t.asyncAggregationStatus.setState({...t.asyncAggregationStatus.state,calculating:!0});const o=d.then((()=>Ie.queryCollection(e,r,void 0,{...n,src:`${n.src}_with_aggregations`},void 0,"queryCollection").then((n=>{if("success"===n.type)return gt({environment:e,remoteRequest:r,collectionContextStore:t,response:n.data,updateCounter:a})})).finally((()=>{t.asyncAggregationStatus.setState({calculating:!1})}))));i.push(o)}}else d=Ie.queryCollection(e,o,void 0,n,void 0,"queryCollection").then((o=>{const i=Q.vS(t,n.src);if(le.default.measure(c,{environment:e,data:i}),"success"===o.type)return"initial_load"===n.src&&O.Z.set((0,re.Z)(r.collectionView.id),r),t.asyncAggregationStatus.setState({calculating:!1}),gt({environment:e,remoteRequest:r,collectionContextStore:t,response:o.data,updateCounter:a})})),i.push(d);if(!(await(0,R.OI)(1e4,i)).timeout)return}else try{const n=await async function(e,t,n){const{source:o,collectionView:i,loader:r}=t,a=e.currentUser.id;let s;if("collection"!==o.type)throw new Error("TODO: support typed source");s={table:j.v,id:o.id};const l=Date.now(),c=await ie.Ye({environment:e,pointer:s,inMemoryRecordCache:n});if(null==c||!c.model)throw new Error("Collection not found.");const d=c.model,p=await ie.Ye({environment:e,pointer:{table:V.n,id:i.id},inMemoryRecordCache:n});if(null==p||!p.model)throw new Error("Collection view not found.");const m=A.s8.fromMonomorphicFunctionUnsafe((async t=>{const n=await ie.Ye({environment:e,pointer:t});return null==n?void 0:n.model})),g=p.model,v=E.Ak.create(),b=A.om.fromRecordMap(v),y=d.getNormalizedSchema(),{groupsReducerIds:S,reducerIdsWithNoGroupDependencies:_}=u.x3(r.reducers,r.reducerDependencies),w=be.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),k={schema:y,pageSort:(null==g?void 0:g.getPageSort())||[],collectionViewId:i.id,loader:r,userId:a,userStartOfWeek:G.AK.state,currentTime:l,getRecordModel:b,intl:oe.default.getIntl(),isSorted:!1,relativeVariableResult:void 0,isSprintPlanningView:(null==g?void 0:g.getAppConfigUri())===f.sV,collectionSourceType:o.type,groupsReducerIds:S,reducerIdsWithNoGroupDependencies:_,formulaTimeoutMs:w,resultCache:{}},I=d.__IM_SORRY__getValue(),C=u.fk(k),x=(await ie.ne({environment:e,collection:d,inMemoryRecordCache:n})).filter((e=>{let{model:t}=e;return null==t?void 0:t.alive})),T=M.oA(x.map((e=>{let{model:t}=e;return null==t?void 0:t.__IM_SORRY__getValue()}))),P=(r.reducers?Object.values(r.reducers):[]).some((e=>Boolean("results"===e.type&&e.loadContentCover))),R=await u.Ct({collectionValue:I,loader:r,loadAllProperties:!1,recordMap:v,loadRecordModel:m});await u.c_({blocks:T,dependencies:R,recordMap:v,loadRecordModel:m}),P&&await u.jF({blocks:T,loadRecordModel:m,recordMap:v});for(const f of T)u.BW(f,I,k,C);const{result:D}=u.kk(k,C),B=E.PF.create(),F=u.aW({result:D});return await Promise.all(F.map((async t=>{const o=await ie.Ye({environment:e,pointer:{table:h.iU,id:t},inMemoryRecordCache:n});o&&B.setModelAndRole({table:h.iU,id:t},o.model,o.role)}))),B.setModelAndRole(s,c.model,c.role),B.setModelAndRole({table:V.n,id:i.id},p.model,p.role),{result:D,recordMap:B.toJson({allowVersionDowngrade:!1}),relativeVariableResult:void 0,collectionIds:void 0,shouldUseClientMode:!1,isViewSpecificClientMode:!1,allBlockIds:void 0}}(e,r,l),o=E.PF.create(n.recordMap);Ee.fL({environment:e,inMemoryRecordCache:l,recordMap:o,debugSource:"collectionViewActions.fetchRemoteResult (localResponse)"}),await gt({environment:e,collectionContextStore:t,remoteRequest:void 0,response:n,updateCounter:a})}catch(p){}finally{t.resetLoadingState()}d&&d.catch((e=>{}))}async function gt(e){const{environment:t,remoteRequest:n,collectionContextStore:o,response:i,updateCounter:r,keepAggregationResults:a}=e,s=o.collectionViewStore();if(!o.shouldUpdate(r))return;if(x.H1.is(i)){for await(const l of i)if("reducer"===l.type){const e=o.remoteResult.state,t=null==e?void 0:e.reducerResults[l.name];if(!t||!M.Xy(t,l.result)){const t={type:"reducer",reducerResults:{...null==e?void 0:e.reducerResults,[l.name]:l.result}};o.remoteResult.setState(t);const n=new Set(u.aW({result:t,onlyTypes:["results"]}));o.resultSet.resetWithRemote(n)}}else if("sizeHint"===l.type){const e=o.remoteResult.state,t={type:"reducer",reducerResults:(null==e?void 0:e.reducerResults)??{},sizeHint:l.sizeHint};o.remoteResult.setState(t)}else if("relativeVariableResult"===l.type)o.relativeVariables.setState({...o.relativeVariables.state,...l.relativeVariableResult});else if("collectionIds"===l.type){const e=o.remoteCollectionIds.state;M.Xy(e,l.collectionIds)||o.remoteCollectionIds.setState(l.collectionIds)}}else{const e=o.remoteResult.state;if(!e||!M.Xy(e,i.result)){const t=i.result;if("reducer"===i.result.type){if(a){const n=Object.entries((null==e?void 0:e.reducerResults)||{}).filter((e=>{let[t,n]=e;return"aggregation"===n.type})).reduce(((e,t)=>{let[n,o]=t;return e[n]=o,e}),{});t.reducerResults={...n,...t.reducerResults}}o.remoteResult.setState(t)}if(i.shouldUseClientMode)o.isClientModeEnabled.setState(!0),o.isViewSpecificClientModeEnabled.setState(Boolean(i.isViewSpecificClientMode)),o.resultSet.resetWithRemote(i.allBlockIds);else{const e=new Set(u.aW({result:i.result,onlyTypes:["results"]}));o.resultSet.resetWithRemote(e)}}if(i.collectionIds){const e=o.remoteCollectionIds.state;M.Xy(e,i.collectionIds)||o.remoteCollectionIds.setState(i.collectionIds)}ye.Z.addFromRecordMapWithRoleJson(i.recordMap),ye.Z.isEmpty()||Ve.dY({environment:t}),o.relativeVariables.setState({...o.relativeVariables.state,...i.relativeVariableResult})}o.remoteResult.state&&(o.resetLoadingState(),o.isLoaded.setState(!0),a||o.lastRemoteRequest.setState(n),s&&ne.set(s.id,{remoteResult:o.remoteResult.state,resultSet:o.resultSet.state,collectionIds:o.remoteCollectionIds.state}))}function ht(e,t){const{blockIds:n,hasLocalUpdates:o}=t.resultSet.state,i=t.collectionViewStore(),r=e.currentUser.id,a=t.remoteRequestStore.state,s=t.remoteResult.state;if(!i||!i.isDefined()||!a)return;const l=Date.now(),c=oe.default.getIntl(),d=i.getRecordModel,g=i.getFormat(),b=i.getType(),S=i.getCollectionSource();if(!S)return;const _=t.collectionStoresStore.state,w=[];for(const u of _){const e=d(u);e&&w.push(e)}if(0===w.length)return;t.isLoaded.setState(!1);const k=w.some((e=>Se.Z.getEditedBlocksForCollection(e.id).size>0)),I=M.Xy(t.lastRemoteRequest.state,a);if(!k&&s&&!o&&I)return t.isLoaded.setState(!0),s;const C=le.default.mark("collections.compute_local_result_latency");let x={};switch(t.contextType){case"collectionTypedView":const e=(t.databaseType&&(0,f.uV)(c))??{},n=(0,p.jf)({schemas:[...w.map((e=>{var t;const n=null==e||null===(t=e.getFormat())||void 0===t?void 0:t.app_uri_map,o=e.getNormalizedSchema();return p.aQ.toViewSchema(o,n)})),e],onlyPropertyIds:Object.keys(e)});if(n.error)throw n.error;x=n.value;break;case"collectionVirtualView":case"collectionView":case"collectionViewBlock":case"collectionPage":case void 0:x=w[0].getNormalizedSchema();break;default:(0,v.t1)(t.contextType)}const T=u.ps(g,b,x),P=t.relativeVariableStore.state,{groupsReducerIds:R,reducerIdsWithNoGroupDependencies:D}=u.x3(a.loader.reducers,a.loader.reducerDependencies),B=be.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),E={pageSort:i.getPageSort(),schema:x,loader:a.loader,userId:r,userStartOfWeek:G.AK.state,currentTime:l,getRecordModel:pe.default.getCurrentBlockModelFn(),intl:oe.default.getIntl(),isSorted:!1,visibleProperties:T,relativeVariableResult:P,isSprintPlanningView:g.app_config_uri===f.sV,collectionSourceType:S.type,groupsReducerIds:R,reducerIdsWithNoGroupDependencies:D,formulaTimeoutMs:B,resultCache:{}},F={...E,loader:{...a.loader,filter:void 0}},Z=s?new Set(u.aW({result:s,onlyTypes:["results"]})):new Set,L=u.fk(E);for(const p of n){const e=we.G.createChildStore(i,{table:h.iU,id:p}),n=e.getAssociatedCollectionStore();if(m.Sl.hasCollections(S)&&(!n||!_.find((e=>{let{id:t}=e;return n.id===t}))))continue;const o=d(e);let r;switch(t.contextType){case"collectionVirtualView":(0,m.nx)(S)&&(r=A.kk.fromCollection(y(S)));break;case"collectionTypedView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:r=n&&d(n);break;default:(0,v.t1)(t.contextType)}if(!r||!o)continue;const s=a.loader.upwardTraversalRelation&&Z.has(p)&&(0,te.uU)({block:A.kk.fromBlock(o),collectionContextStore:t})&&!t.isClientModeEnabled.state;u.BW(o,r,s?F:E,L)}for(const p of w){const e=Se.Z.getEditedBlocksForCollection(p.id);for(const t of e){if(n.has(t))continue;const e=d(we.G.createChildStore(i,{table:h.iU,id:t}));e&&u.BW(e,p,E,L)}}const{result:j}=u.kk(E,L);if(t.isLoaded.setState(!0),"reducer"!==j.type)return;const V=Q.vS(t);return le.default.measure(C,{environment:e,data:V}),j}function vt(e,t){const n=t.collectionViewStore(),o=t.searchQuery.state;if(!n)return;const i=t.currentSubitemFormatStore.state,r=n.getType(),a=(0,$.RL)({collectionContextStore:t,applySubitemFilter:Boolean(i)&&!(r&&(0,te.Av)(r))}),s=(0,l.kk)(a),c=t.currentSortsStore.state,u=function(e){const t=e.reducers.state,n={};return M.Ed(t,((e,t)=>{e&&(n[t]=e.reducer)})),n}(t);if(M.xb(u))return;let p;if(t.reducerDependencies.size>0){p={};for(const[e,n]of t.reducerDependencies)p[e]=[...n]}const m=(0,U.C)(n.pointer.spaceId),f=n.getCollectionSource();if(!f)return;const g=t.normalizedSchemaStore.state,h=(null==i?void 0:i.property)&&g[i.property];return{source:f,collectionView:{id:n.id,spaceId:m},loader:{type:"reducer",reducers:u,filter:s,sort:c,searchQuery:o,userId:e.currentUser.id,userTimeZone:(0,C.r)(),...h&&(0,d.p_)(h)&&r&&(0,te.Av)(r)&&{upwardTraversalRelation:h},reducerDependencies:p}}}function bt(e){const{reducerId:t,instanceId:n,reducer:o,collectionContextStore:i,groupsPointer:r}=e,a=i.reducers.state,s=a[t];let l,d;if(r&&r.length>0&&(l=(0,c.KW)(r)),o){if(d={instanceIds:M.jj([...(null==s?void 0:s.instanceIds)||[],n]),reducer:o},l){i.reducerDependencies.has(l)||i.reducerDependencies.set(l,new Set);const e=i.reducerDependencies.get(l);null==e||e.add(t)}}else{if(l){const e=i.reducerDependencies.get(l);e&&(e.delete(t),0===e.size&&i.reducerDependencies.delete(l))}const e=M.zu((null==s?void 0:s.instanceIds)||[],n);d=s&&e.length>0?{instanceIds:e,reducer:s.reducer}:void 0}M.Xy(s,d)||i.reducers.setState({...a,[t]:d})}function yt(e){const{environment:t,collectionViewId:n,openInNew:o,collectionContextStore:i,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}=e,c=i.collectionViewBlockStore();if(c){if(c===pe.default.state.mainEditorCurrentBlockStore||o)Fe.navigateToBlock({environment:t,store:c,openInNew:o,collectionViewId:n,pageVisitSource:r.tY.ChangeCollectionView});else{const e=new we.Xr(t,{table:V.n,id:n},{inMemoryRecordCache:c.inMemoryRecordCache}),o=e.getCollectionStore();ze({environment:t,collectionViewBlockStore:c,collectionViewStore:e,collectionStore:o,collectionContextStore:i,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}),T.Z.set({userId:t.currentUser.id,key:fe.Z.getLocalViewPreferenceKey(c.id),value:n})}rt({collectionContextStore:i})}}function St(e){const{environment:t,collectionContextStore:n}=e;let o=n.collectionStore();const i=n.collectionViewBlockStore();if(!o||!i)return;const{mainEditorCurrentBlockStore:r}=pe.default.state;r&&n.isFullScreen.state&&(o=we.NW.createChildStore(r,o.pointer)),Le.mT({environment:t,store:o.getNameStore(),canSelectAllBlocks:!1})}function _t(){Ze.MO(),function(){const e=he.Z.state,t=ke.default.state;if(e.isActive&&1===t.stores.length&&t.stores[0].id===e.store.id)return;kt()}()}function wt(e){const{store:t,transient:n}=e;he.Z.setState({isActive:!0,store:t,transient:Boolean(n)})}function kt(){he.Z.setState({...he.Z.state,isActive:!1})}function It(e){const{store:t}=e;"new"===ge.Z.state.editMode&&ge.Z.state.store.id===t.id&&ge.Z.reset()}function Ct(e){const{environment:t,update:n,transaction:o,collectionStore:i}=e;Be.ae({environment:t,table:Z.cv,value:n.newAutomationValue,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o});for(const r of n.newAutomationActionValues)Be.ae({environment:t,table:L.Xj,value:r,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o})}async function xt(e){const{environment:t,collectionContextStore:n,blockIdToMinimumVersion:o}=e;await async function(e,t){return await Promise.all((0,v.qP)(t).map((async t=>{let[n,o]=t;return Ee.bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:h.iU,id:n},userId:e.currentUser.id,minimumVersion:o})})))}(t,o),n.resultSet.addLocalChange(Object.keys(o))}function Tt(e){let{currentUserId:t,spaceId:n}=e;const o=T.Z.get({userId:t,key:Mt(n)});if(o){const e=(0,z.dj)(o);return Array.isArray(e)?e:[]}return[]}function Mt(e){return`getRecentlyNavigatedCollections:${e}`}function Pt(e){let{currentUserId:t,collectionViewId:n,temporaryState:o}=e;const i=At(n);o?T.Z.set({userId:t,key:i,value:JSON.stringify(o)}):T.Z.remove({userId:t,key:i})}function At(e){return`collectionViewTemporaryState2:${e}`}},30188:(e,t,n)=>{n.d(t,{FC:()=>z,R2:()=>K,VP:()=>Q,W9:()=>Y,Z3:()=>$,dR:()=>H,e2:()=>N,jA:()=>W,rT:()=>O,wA:()=>L,xr:()=>q});n(57658),n(21703),n(52262),n(24506),n(67294);var o=n(1302),i=n(99036),r=n(80951),a=n(45433),s=n(6695),l=n(72126),c=n(5366),d=n(4615),u=n(21202),p=n(23867),m=n(29369),f=n(95371),g=n(39721),h=n(73597),v=n(70842),b=n(97880),y=n(64369),S=n(78316),_=n(77181),w=n(35328),k=n(80444),I=n(89087),C=n(35661),x=n(50906),T=n(54642),M=n(47307),P=n(54532),A=n(96802),R=n(9953),D=n(79978),B=n(42858),E=n(24677),F=n(39699),Z=n(85893);function L(e){const{environment:t,transaction:n,blocks:o,action:i}=e,r=(0,S.fm)(o[0]);if(!r)return;const a=r.subitemTreeStore.state;if(!a)return;const s=r.currentSubitemFormatStore.state;if(!s||!s.property)return;const l=r.collectionViewBlockStore();if(!l)return;const c=new f.mp({store:l,pathKey:""},a.map((e=>e)).children),d=function(e,t){const n=new Set(e);let o,i;for(const r of h.JK(t)){if(!n.has(r.value.store)){if(o)return;continue}const e=(0,f.DY)([t],(e=>e===r));if(!e||e.length<2)return;if(o??=e,i=e,n.delete(r.value.store),0===n.size)break}if(o&&i)return v.T.fromNearestCommonAncestor(o,i)}(o,c);if(!d)return;const u=g.o.getIndentOperationsFromTreeRange(d,i),p=new Set,m=[],y="unindentSelf"===i?new Set(u.map((e=>e.target))):new Set;for(const h of u){const{target:e,operation:o}=h,i=(0,f.DY)([c],(t=>t===e));if(void 0===i)return;const a=i[i.length-2];if("indentSelfAndSubtree"===o){if(p.has(a)){p.add(e),m.push(e.value.store);continue}const o=a.children,i=o.indexOf(e);if(0===i)return;const l=o[i-1].value.store;j({environment:t,parentStore:a.value.store,previousSiblingStore:l,targetStore:e.value.store,subitemFormat:s,transaction:n}),m.push(C.G.createChildStore(l,e.value.store.pointer)),O({collectionContextStore:r,pathKey:(0,_.zV)(a.value.pathKey,l)})}else{if("unindentSelf"!==o)break;{var w;if(y.has(a)){y.delete(e),m.push(e.value.store);continue}if(1===i.length)return;const o=null===(w=i[i.length-3])||void 0===w?void 0:w.value.store;V({environment:t,parentStore:a.value.store,grandparentStore:o,targetStore:e.value.store,subitemFormat:s,transaction:n}),m.push(C.G.createChildStore(o&&o.isPageBlock()?o:r.collectionViewBlockStore(),e.value.store.pointer))}}if(g.F.applyMutable(c,h))if("indentSelfAndSubtree"===o)p.add(e);else if("unindentSelf"===o){const t=r.subitemExpandedStore.state,n=a.value.pathKey,o=t.get(n);0===a.children.length&&null!=o&&o.isExpanded&&(t.delete(n),r.subitemExpandedStore.emit()),y.delete(e)}else(0,b.t1)(o)}m&&E.Z5({environment:t,stores:m})}function j(e){const{environment:t,parentStore:n,previousSiblingStore:o,targetStore:i,subitemFormat:r,transaction:a}=e;n.isPageBlock()&&D.Bl({environment:t,sourceStore:n,destStore:i,propertyWithInverse:r,transaction:a}),D.hE({environment:t,sourceStore:o,destStore:i,propertyWithInverse:r,transaction:a,position:{type:"after"}})}function V(e){const{environment:t,parentStore:n,grandparentStore:o,targetStore:i,subitemFormat:r,transaction:a}=e;D.Bl({environment:t,sourceStore:n,destStore:i,propertyWithInverse:r,transaction:a}),o&&o.isPageBlock()&&D.hE({environment:t,sourceStore:o,destStore:i,propertyWithInverse:r,position:{type:"after",after:n.id},transaction:a})}function U(e){const{blocksToDuplicate:t,duplicatedBlocks:n,environment:o,transaction:i,migrateSubitemFormat:a}=e;if(t.length!==n.length)throw new Error("Error rebuilding relations. blocksToDuplicate and duplicatedBlocks must be the same length");const s=t.at(0);if(!s)return;const{from:c,to:d}=a||function(e){const t=(0,_.g0)(e);if(!t)throw new Error("Error rebuilding relations");const{subitemFormat:n}=t;return{from:n,to:n}}(s);const u=new Map(l.$R(t.map((e=>e.id)),n));l.$R(t,n).forEach((e=>{let[t,n]=e;const a=function(e){const t=e.getPropertyValue(c.property);return r.rq(t)}(t),s=function(e){const t=e.getPropertyValue(c.inverse);return r.rq(t)}(t);a.forEach((e=>{const t=C.G.createChildStore(n,e),r=u.get(e.id);r&&(D.Bl({environment:o,sourceStore:n,destStore:t,propertyWithInverse:c,transaction:i}),D.hE({environment:o,sourceStore:n,destStore:r,propertyWithInverse:d,transaction:i,position:{type:"after"}}))})),s.forEach((e=>{const t=C.G.createChildStore(n,e);u.get(e.id)&&D.Bl({environment:o,sourceStore:t,destStore:n,propertyWithInverse:c,transaction:i})}))}))}function O(e){const{collectionContextStore:t,pathKey:n}=e,o=t.subitemExpandedStore.state,i=o.get(n);null!=i&&i.isExpanded||(o.set(n,{isExpanded:!0,limit:20}),t.subitemExpandedStore.emit())}function N(e){const t=(0,S.fm)(e);if(!t)return;const n=t.subitemTreeStore.state,o=(0,f.DY)(n.children,(t=>t.value.store===e));if(!o)return;const i=o.map((e=>e.value.store.pointer)),r=(0,_.Af)(i),a=t.subitemExpandedStore.state,s=a.get(r);s&&s.isExpanded&&(a.delete(r),t.subitemExpandedStore.emit())}function z(e){var t;const n=(0,S.fm)(e);if(!n)return;const o=n.subitemTreeStore.state,i=(0,f.DY)(o.children,(t=>t.value.store===e));if(!i)return;const r=n.currentSubitemFormatStore.state;if(!r)return;const a=null===(t=n.collectionStore())||void 0===t?void 0:t.getSchema()[r.property];if(!a||"relation"!==a.type)return;if(0===(0,_.CJ)({store:e,subitemFormat:r,propertySchema:a}).length)return;const s=i.map((e=>e.value.store.pointer));O({collectionContextStore:n,pathKey:(0,_.Af)(s)})}function H(e){const{collectionViewStore:t,propertyId:n,transaction:o}=e,i=t.getType(),r=i&&!(0,_.Av)(i)?(0,s.oz)(i):void 0,a=r?t.getFormat()[r]??[]:[],l=(null==a?void 0:a.find((e=>e.property===n)))??{property:n,visible:!0},c=r?{[r]:[...a,l]}:{};A.FH({stores:[t],update:{collection_view_subitem:n?{property:n}:void 0,collection_view_toggle_by:n?{property:n}:void 0,...c},transaction:o})}function W(e){var t;const{collectionContextStore:n,relationPropertyId:o,transaction:i}=e,r=n.collectionStore();if(!r)return;const s=o?r.getSchema()[o]:void 0,l="relation"===(null==s?void 0:s.type)&&s.property&&"relation"===(null===(t=r.getSchema()[s.property])||void 0===t?void 0:t.type)?s.property:void 0;A.FH({stores:[r],update:{collection_default_subitem:o,...r.getFormat().app_config_uri===a.iS?{app_uri_map:{...r.getFormat().app_uri_map?r.getFormat().app_uri_map:{},[a.Es.SubTaskRelation]:o,[a.Es.ParentTaskRelation]:l}}:{}},transaction:i})}async function q(e){const{environment:t,blocks:n,options:o}=e;if(n.some((e=>!e.isPageBlock())))return[];const r=l.Ps(n);if(!r)return[];const a=(0,S.fm)(r);if(!a)return[];const s=a.collectionStore();if(!s)return[];const c=a.currentSubitemFormatStore.state,d=a.normalizedSchemaStore.state,u=(null==c?void 0:c.inverse)&&d[c.inverse];if(!u||!(0,i.p_)(u))return[];const p=u.property;if(!p)return[];const m=s.id,f=s.getSpaceId();if(!n.some((e=>(0,_.CJ)({store:e,subitemFormat:c,propertySchema:u}).length>0)))return[];await I.transactionQueue.drain();const g=await T.getSubitems(t,{collection:{id:m,spaceId:f},blocks:n.map((e=>({id:e.id,spaceId:f}))),childRelationProperty:p,canEdit:null==o?void 0:o.canEdit});return"failed"===g.type?[]:g.data.blocks.map((e=>C.G.createChildStore(s,{table:"block",...e})))}function G(e){const t=l.Ps(e);if(!t)return[];const n=(0,S.fm)(t);if(!n)return[];const o=n.collectionStore(),r=n.collectionViewBlockStore();if(!o||!r)return[];const a=n.currentSubitemFormatStore.state,s=n.normalizedSchemaStore.state,c=(null==a?void 0:a.inverse)&&s[a.inverse];if(!c||!(0,i.p_)(c))return[];if(!c.property)return[];const d=new Set(e.map((e=>e.id)));let u=e;const p=[];for(;u.length>0;){const e=l.xH(u.map((e=>(0,_.CJ)({store:e,subitemFormat:a,propertySchema:c})))).filter((e=>!d.has(e.id))).map((e=>C.G.createChildStore(r,e)));for(const t of e)d.add(t.id);p.push(...e),u=e}return p}function K(e){var t;let{environment:n,blocks:o,recordMaps:i,analyticsFrom:r,transaction:a,migrateSubitemFormat:s}=e;const l=o.at(0);if(!l)return[];if(!(0,_.g0)(l))return[];if(!(null===(t=(0,S.fm)(l))||void 0===t?void 0:t.collectionViewBlockStore()))return[];const c=e=>{const t=i?i.get(e.id):P.K8(n,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!t)throw new Error("Could not find cached copy of block during sub-item duplication.");return t};o.forEach((e=>{var t;const o=e.getModel();if(!o)return[];const{currentSpaceStore:i}=k.default.getState();let a;i&&o.getParentTable()===m.e0&&o.parent_id&&(a=C.zX.createChildStore(i,{table:m.e0,id:o.parent_id})),x.W2j(n,{from:r??"copy",type:o.type,teamStore:a,is_toggleable:(0,w._A)(o.type,o.getFormat()),collection_id:e.getParentCollectionId()??(null===(t=e.getCollectionViewCollectionStore())||void 0===t?void 0:t.id),new_page_id:"page"===o.type?e.id:void 0})}));const f=o.map((e=>P.E9({environment:n,transaction:a,sourceBlockId:e.id,targetBlockPointer:{id:(0,d.ZP)(),table:u.iU,spaceId:(0,p.C)(e.pointer.spaceId)},sourceBlockSubtree:c(e),targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:!1,deepCopyTransclusionContainers:!l.isTransclusionType(),resolveTemplateVariables:!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction()),useCrdt:!1}).targetBlock));return U({blocksToDuplicate:o,duplicatedBlocks:f,environment:n,transaction:a,migrateSubitemFormat:s}),f}function $(e){let{blocks:t,transaction:n,from:o,to:i}=e;for(const r of t){const e=r.getPropertiesStore(),t=e.getValue();t&&R.sW({store:e,data:{[i.property]:t[o.property],[i.inverse]:t[o.inverse]},transaction:n})}return t}async function Q(e){let{blocks:t,subitems:n,environment:o,canUndo:i,skipConfirmation:r}=e;const a=n||G(t),s=[...t,...a];B.zO(s);const l=n||await q({environment:o,blocks:t,options:{canEdit:!0}});if(!r&&l.length>0){const{accept:e}=await function(e){let{itemCount:t,subitemCount:n}=e;return M.confirmUserActionV2({message:(0,Z.jsx)(y.Z,{style:M.dialogStyles.title,children:(0,Z.jsx)(c.FormattedMessage,{id:"deleteSubitems.confirmation.message",defaultMessage:"Confirm delete"})}),description:(0,Z.jsx)(y.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,Z.jsx)(c.FormattedMessage,{id:"deleteSubitems.confirmation.description",defaultMessage:"You are about to delete <b>{itemCount}</b> items and <b>{subitemCount}</b> subitems.",values:{itemCount:t,subitemCount:n,b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,Z.jsx)("b",{children:t})}}})}),acceptLabel:(0,Z.jsx)(c.FormattedMessage,{id:"deleteSubitems.confirmation.acceptLabel",defaultMessage:"Delete"}),cancelLabel:(0,Z.jsx)(c.FormattedMessage,{id:"deleteSubitems.confirmation.cancelLabel",defaultMessage:"Cancel"})})}({itemCount:t.length,subitemCount:l.length});if(!e)return void B.bj(s)}const{serverCommitResult:d}=F.createAndCommit({userAction:"selectableBlockActions.removeBlocksWithMaybeConfirmation",environment:o,canUndo:i,perform:e=>{B.Cl({environment:o,blocks:t,transaction:e});for(const t of l)R.sW({store:t,data:{alive:!1},transaction:e})}});await d}async function Y(e){var t;let{environment:n,blocks:i}=e;const r=i.at(0);if(!r)return;const a=(0,_.g0)(r),s=null===(t=(0,S.fm)(r))||void 0===t?void 0:t.collectionViewBlockStore();if(!s||!a)return;const{parentRelationProperty:l,parentRelationSchema:c}=a,d=[...i,...G(i)];B.zO(d);const u=i.at(-1);if(!u)return;const p=await q({environment:n,blocks:i,options:{canEdit:!0}});let m=[];F.createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:n,perform:e=>{const t=K({blocks:[...i,...p],environment:n,transaction:e});m=B.is({environment:n,blocks:t,selection:i,transaction:e,replaceEmptyTextBlock:!1,insertAfterBlock:u,preventSetSelection:!0})}});const f=(0,_.T2)({blocks:m,parentRelationProperty:l,parentRelationSchema:c,collectionViewBlockStore:s});o.default.afterNextFlush((()=>{o.default.afterNextFlush((()=>{E.Z5({environment:n,stores:f})}))})),B.bj(d)}},98688:(e,t,n)=>{n.d(t,{L:()=>p,v:()=>u});n(21703);var o=n(72126),i=n(45953),r=n(9844),a=n(35794),s=n(80444),l=n(72371),c=n(54642),d=n(9377);async function u(e){const{currentSpaceStore:t}=s.default.state;t&&await p({environment:e.environment,spaceId:t.id,force:!0})}async function p(e){const{environment:t,spaceId:n,force:u}=e;await s.default.waitUntilRendered();const p=l.Z.state;if(!p.loaded&&!p.loading||p.loaded&&n!==p.spaceId||u){l.Z.setState({...l.Z.state,loading:!0});const[e,s]=await Promise.all([c.searchIntegrations(t,{query:"",type:"compliance",spaceId:n}),d.j({environment:t,spaceId:n})]);if("success"!==e.type)throw new Error("Request failed.");const u=i.PF.create(e.data.recordMap),p=i.PF.create(s.recordMap);l.Z.setState({loaded:!0,loading:!1,spaceId:n,integrations:o.MR(o.oA(e.data.integrationIds.map((e=>u.getModel({table:r.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),webhookSubscriptions:o.oA(s.webhookSubscriptionIds.map((e=>p.getModel({table:a.b,id:e,spaceId:n}))))})}}},86080:(e,t,n)=>{n.d(t,{b:()=>r,x:()=>a});var o=n(29477),i=n(81700);const r=function(e){const t=o.UZ();return i.Z.setState({...e,open:!0,onComplete:t.resolve,inputValue:""}),t.promise},a=function(e){const t=i.Z.state;t.open&&(t.onComplete(e.didConfirm),i.Z.reset())}},28673:(e,t,n)=>{n.d(t,{V:()=>h,c:()=>v});n(21703);var o=n(4615),i=n(6287),r=n(23867),a=n(97880),s=n(5366),l=n(70764),c=n(33929),d=n(32363),u=n(35661),p=n(47307),m=n(42631),f=n(9953);const g=(0,s.defineMessages)({authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.propertyTypeSection.connected.authFail"},mobileAdminError:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) app in settings to use this feature.",id:"database.viewSettings.propertyTypeSection.connected.mobileAdminError"},mobileError:{defaultMessage:"Please authorize this integration on the desktop app or a browser.",id:"database.viewSettings.propertyTypeSection.connected.mobileError"}});async function h(e,t,n,o){const i=e.device.isMobile,r=null==t?void 0:t.getSpaceStore();if(!r)return;const a=(0,l.NP)(n.id).length;if(i&&o&&!a){const e=c.default.formatMessage(g.mobileAdminError);throw p.showErrorMessage(e),new Error(e)}if(i&&!o&&!a){const e=c.default.formatMessage(g.mobileError);throw p.showErrorMessage(e),new Error(e)}if(!a&&o&&r.canAdmin()||!a&&!o)try{await m.hM({environment:e,integration:n,spaceId:r.id,from:"collection_settings_property_type"})}catch(s){const e=c.default.formatMessage(g.authError);throw p.showErrorMessage(e),new Error(e)}if(!(0,l.NP)(n.id).length){const e=c.default.formatMessage(g.authError);throw p.showErrorMessage(e),new Error(e)}}function v(e){const{environment:t,pattern:n,integration:s,parentCollectionStore:l,transaction:c}=e;if(!n.connected_relation_properties)throw new Error("Cannot create a connected relation collection without properties");const p=new u.NW(t,{table:i.v,id:(0,o.ZP)(),spaceId:l.pointer.spaceId}),m={};n.connected_relation_sub_schemas&&(0,a.qP)(n.connected_relation_sub_schemas).map((e=>{let[n,a]=e;const s=new u.NW(t,{table:i.v,id:(0,o.ZP)(),spaceId:l.pointer.spaceId}),d={bot_id:void 0,external_object_id:void 0,uri:n,integration_id:void 0,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:a,sync_state:void 0,pattern_name:void 0},g={id:s.id,version:0,space_id:(0,r.C)(l.pointer.spaceId),parent_table:i.v,parent_id:p.id,alive:!0,format:d,schema:{}};m[n]=s.id,f.sW({store:s,data:g,transaction:c})}));const g={id:p.id,version:0,space_id:(0,r.C)(l.pointer.spaceId),parent_table:i.v,parent_id:l.id,alive:!0,format:{attributes:[{id:"title",name:"title",type:"inline",format:{type:"title",section:"title"},values:[(0,d.ni)({pattern:n,integration:s})]}],bot_id:void 0,external_object_id:void 0,uri:`notion://user-defined-collection/${s.id}/${n.name}`,integration_id:s.id,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:n.connected_relation_properties,sync_state:void 0,pattern_name:n.name,related_external_object_uris_to_instance_ids:m},schema:{}};return f.sW({store:p,data:g,transaction:c}),p}},50950:(e,t,n)=>{n.d(t,{wk:()=>B,Tz:()=>F,OM:()=>O,qo:()=>N,oG:()=>z,dd:()=>H,Nh:()=>Z,a9:()=>j});n(67294);var o=n(15145),i=n(86658),r=n(74686),a=n(55632),s=n(68626),l=n(72126),c=n(91155),d=n(71644),u=n(63143),p=n(5366),m=n(54642),f=n(480),g=n(24405),h=n(56666),v=n(10182),b=n(89728),y=n(85893);const S=function(){window.__c={n:"CookieSnackbarButtons"};const e=(0,f.O7)(),t=(0,g.Fg)();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(b.Z,{onClick:()=>O(e,{necessary:!0,performance:!0,preference:!0,targeting:!0}),children:(0,y.jsx)("b",{style:{color:t.contentBackground},children:(0,y.jsx)(p.FormattedMessage,{...i.ze.acceptAllButtonLabel})})}),(0,y.jsx)(b.Z,{onClick:()=>O(e,{necessary:!0,performance:!1,preference:!1,targeting:!1}),children:(0,y.jsx)("b",{style:{color:t.contentBackground},children:(0,y.jsx)(p.FormattedMessage,{...i.ze.rejectAllButtonLabel})})}),(0,y.jsx)(v.Z,{hasDismissButton:!0,renderOrigin:e=>(0,y.jsx)(b.Z,{style:{paddingLeft:8,paddingRight:8},...e,children:(0,h.o)({width:14,marginLeft:4,fill:t.contentBackground})})})]})};var _=n(42402),w=n(24215),k=n(12955),I=n(33929),C=n(36867),x=n(80444),T=n(61893),M=n(45293),P=n(1310),A=n(50906),R=n(47307);const D=(0,p.defineMessages)({cookieConsentSaveError:{id:"cookieConsent.saveError",defaultMessage:"Cannot record cookie consent, please try again later."}});async function B(e){const{environment:t,onboardingState:n}=e;if(await E(t))return(0,C.g)(t.currentUser.id)>=2?(U(),M.Z.setState({open:!0}),A.xYN({environment:t,type:"modal",onboardingState:n}),void A.bmu(t)):void(P.ZP.state.currentItem||(P.ZP.setState({...P.ZP.state,currentItem:{key:(0,d.ZP)(),label:(0,y.jsx)("div",{children:(0,i.Fd)(F,"snackbar")}),right:(0,y.jsx)(S,{})}}),A.xYN({environment:t,type:"snackbar",onboardingState:n})))}async function E(e){if(!(0,k.canSetCookie)(e))return!1;if(!(0,k.canShowCookieUi)(e))return!1;const t=await(0,k.getHasPermissionArgs)(e);return"true"===(null==t?void 0:t.notion_check_cookie_consent)&&(null==t||!t.notion_cookie_consent)}function F(e,t){return(0,y.jsx)(_.Z,{href:e,children:t})}function Z(e,t){if("necessary"===t)return;const n={...T.Z.getState().permission};n[t]=!n[t],T.Z.setPermission(n),L(e,n)}const L=l.Ds(((e,t)=>{j(e,t)}),2e3);async function j(e,t){const n=await m.recordCookieConsent(e,{id:T.Z.getId(),permission:t,document_version:i.fV,userId:e.currentUser.id}).catch((e=>{V({type:"recordCookieConsentError",error:(0,c.Ui)(e)})}));if(!n)return void V({type:"recordCookieConsentEmptyResult"});if("success"!==n.type)return void V({type:"recordCookieConsentReturnsNonSuccess",data:{miscDataToConvertToString:{result:n}}});const s=n.data;await T.Z.setCookieConsent(e,s),o.e9();const l=await w.cG(e),d=o.Zk(l);await a.Pv(d);const{permission:u}=s;w.j(e,"record_cookie_consent",{permission:u,consent_type:(0,r.JT)(u)})}function V(e){let{type:t,data:n,error:o}=e;R.showErrorMessage(I.default.formatMessage(D.cookieConsentSaveError)),s.log({level:"error",from:"cookieActions",type:t,data:n,error:o})}function U(){P.ZP.setState({...P.ZP.state,currentItem:void 0})}function O(e,t){j(e,t),U(),N()}function N(){R.showMessage({message:I.default.formatMessage(i.ze.reloadAfterSaveMessage),onAccept:()=>{window.location.reload()}})}async function z(e){const{currentUserSettingsStore:t}=x.default.state;if(!t)return;await t.load();const n=t.getSettings();if(!n)return;const o=n.cookie_consent;o?(await T.Z.setCookieConsent(e,o),U()):(T.Z.clearCookieConsent(),await E(e)&&T.Z.setPermission(i.cW))}async function H(e){const t=await(0,k.getCookieConsentCookie)(e);if(!t)return;const n=(0,u.dj)(t);n&&T.Z.setState(n)}},41433:(e,t,n)=>{n.d(t,{Ns:()=>k,ZI:()=>C,fC:()=>I,jf:()=>x,nF:()=>w});n(21703),n(57658);var o=n(80951),i=n(87444),r=n(42875),a=n(59730),s=n(15157),l=n(19233),c=n(4615),d=n(45953),u=n(21202),p=n(19889),m=n(70203),f=n(95477),g=n(83960),h=n(80444),v=n(35661),b=n(50906),y=n(96802),S=n(9953),_=n(97444);const w="calloutBlockIcon",k="calloutBlockBackground";function I(e){var t,n,o;const{environment:i,createBlockItem:r,from:a,inMemoryRecordCache:s,transaction:l,useCrdt:p}=e;if(!r.templateRootBlockId||!r.createTemplate)throw new Error("Invalid createBlock item.");const m=(null===(t=h.default.state.currentSpaceStore)||void 0===t?void 0:t.id)??(null===(n=h.default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.getSpaceId()),{targetBlock:f}=C({environment:i,sourceBlockId:r.templateRootBlockId,targetBlockPointer:{id:(0,c.ZP)(),table:u.iU,spaceId:m},sourceBlockSubtree:(0,d.R3)(r.createTemplate(i)),targetRecordCache:s,transaction:l,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,useCrdt:p});var g;(null===(o=r.postCreateCallback)||void 0===o||o.call(r,f,i),x({store:f,transaction:l}),a&&r.blockType)&&b.W2j(i,{from:a,type:r.blockType,collection_id:f.getParentCollectionId()??(null===(g=f.getCollectionViewCollectionStore())||void 0===g?void 0:g.id),collection_view_type:r.collectionViewType,is_toggleable:r.isToggleable,automation_id:f.getAutomationId(),new_page_id:"page"===r.blockType?f.id:void 0});return f}function C(e){const{environment:t,sourceBlockId:n,sourceBlockSubtree:o,targetBlockPointer:s,targetRecordCache:l,transaction:c,deepCopyTransclusionContainers:d,resolveTemplateVariables:u,recordPointerMap:m,useCrdt:g}=e,{duplicateRecordMap:h,originalToDuplicate:b}=i.PZ({sourceBlockId:n,targetBlockPointer:s,recordMap:o,recordPointerMap:m,options:{deepCopyTransclusionContainers:d,resolveTemplateVariables:!!u&&{currentUserId:t.currentUser.id,currentTimeZone:(0,r.r)()},blocksShouldUseCrdt:g},baseUrl:f.default.domainBaseUrl,publicDomainName:f.default.publicDomainName,actor:t.currentUser.id?{table:p.KJ,id:t.currentUser.id}:void 0,getRecordRole:l.makeGetRecordRoleFn(t.currentUser.id)}),y=new v.G(t,s,{inMemoryRecordCache:l});c.postPerformAssertions.push((function(){if(c.isLocal)return;if(!y.getParentStore())throw new a.p8(`Initialized template was not given a parent before being committed in transaction ${c.getUserActionForAnalyticsPurposesOnly()}`)}));for(const{pointer:i,model:r}of h){const e=null==r?void 0:r.__IM_SORRY__getValue(),t=(0,v.Kv)(y,i);e&&S.sW({store:t,data:e,transaction:c})}return{targetBlock:y,originalToDuplicate:b}}function x(e){const{store:t,transaction:n}=e;"code"===t.getType()?function(e){const{store:t,transaction:n}=e,i=t.getProperties(),r=t.getFormat(),a=t.environment.currentUser.id,c=s.Z.get({userId:a,key:g.T.localLanguagePreferenceKey}),d=c&&l.W[c]?c:g.T.defaultLanguage,u=s.Z.get({userId:a,key:g.T.localCodeWrapPreferenceKey}),p=t.getBlockTitleStore(),f=p.getValue(),h=m.vNd(f);h&&_.sO({environment:t.environment,store:p,value:h,transaction:n});void 0===i.language&&S.sW({store:t.getPropertiesStore(),data:{language:o.O2(d)},transaction:n});void 0===r.code_wrap&&S.sW({store:t.getFormatStore(),data:{code_wrap:u},transaction:n})}({store:t,transaction:n}):"table_of_contents"===t.getType()?function(e){const{store:t,transaction:n}=e;void 0===t.getFormat().block_color&&y.FH({stores:[t],update:{block_color:"gray"},transaction:n})}({store:t,transaction:n}):"callout"===t.getType()?function(e){const{store:t,transaction:n}=e,o=t.environment.currentUser.id,i=s.Z.get({userId:o,key:w})||"💡",r=s.Z.get({userId:o,key:k})||"gray_background",a=t.getFormat();void 0===a.block_color&&y.FH({stores:[t],update:{block_color:r},transaction:n});void 0===a.page_icon&&y.FH({stores:[t],update:{page_icon:i},transaction:n})}({store:t,transaction:n}):"quote"===t.getType()&&function(e){const{store:t,transaction:n}=e,o=t.environment.currentUser.id,i=s.Z.get({userId:o,key:g.l.localSizePreferenceKey});void 0!==i&&S.sW({store:t.getFormatStore(),data:{quote_size:i},transaction:n})}({store:t,transaction:n})}},67133:(e,t,n)=>{n.d(t,{b:()=>a,x:()=>s});var o=n(28748),i=n(24677),r=n(98104);function a(e,t){i.ZH(e),r.ZH(e),o.Z.setState({open:!0,...t})}function s(){o.Z.setState({open:!1,originRect:o.Z.state.originRect})}},42239:(e,t,n)=>{n.d(t,{LQ:()=>F,_4:()=>D,cQ:()=>A,eN:()=>Z,f$:()=>E,fX:()=>R,td:()=>B});n(57658);var o=n(41432),i=n(8848),r=n(15095),a=n(42875),s=n(72126),l=n(4615),c=n(23867),d=n(97880),u=n(95477),p=n(24215),m=n(43250),f=n(78316),g=n(98165),h=n(41984),v=n(27406),b=n(81844),y=n(95802),S=n(55367),_=n(86486),w=n(27724),k=n(50906),I=n(47307),C=n(54532),x=n(42858),T=n(24677),M=n(98724),P=n(98104);function A(e,t){S.ZP.state.isDragging&&(S.ZP.reset(),T.$Y({environment:e,phase:w.SelectionPhase.Selected,preventClearEditingText:t}))}function R(e){if(S.ZP.state.isDragging){const{draggedStores:i,currentDropZone:r}=S.ZP.state,a=e.optionKey;let c;if(r){var t,n;const e=r.type===S.Dl.Selectable?y.C.findSelectablesFromStore(r.store):v.Z.findDropTargetsFromKey(r.key);null===(t=e.find((e=>Boolean(e.props.onSelectableDrop))))||void 0===t||null===(t=t.props)||void 0===t||null===(n=t.onSelectableDrop)||void 0===n||n.call(t,{droppedDirection:r.direction,droppedStores:i,duplicate:a}),c=function(e,t){const n=t.props,o="store"in n?n.store:void 0,i=o?b.Z.findOutlinerItemFromStore(o):void 0,r=o&&g.VP(o),a=r&&(0,p.nB)(r),s={...i&&{...a,type:i.type},..."analyticsName"in n&&{dropzone_from:n.analyticsName}};if(!e)return{...s,has_dropzone:!1};let c;switch(e.direction){case S.vh.Above:c="above";break;case S.vh.Below:c="below";break;case S.vh.Left:c="left";break;case S.vh.Onto:c="onto";break;case S.vh.Right:c="right";break;default:(0,d.t1)(e.direction)}if(e.type===S.Dl.Selectable)return{...s,has_dropzone:!0,dropzone_type:"selectable",dropzone_block_id:(0,l.cj)(e.store.id),dropzone_direction:c};return{...s,has_dropzone:!0,dropzone_type:"drop_target",dropzone_key:e.key,dropzone_direction:c}}(r,e[0])}const u=i.find((e=>{const t=e.getType();return Boolean(t&&(0,o.S9)(t))})),m=u&&g.VP(u),h=u&&(0,f.fm)(u);k.ROv(e.environment,{draggedTypes:s.oA(i.map((e=>e.getType()))),from:e.analyticsFrom,asCopy:a,draggableProps:{draggable_from:e.analyticsFrom,...m&&(0,p.nB)(m)},dropzoneProps:c,optionalAnalyticsProperties:{collectionContextStore:h}}),A(e.environment),e.environment.device.isPhone&&T.ZH(e.environment)}}function D(e){const{environment:t,files:n,analyticsFrom:o}=e;if(S.ZP.state.isDragging){var i;const e=S.ZP.state.currentDropZone;let s;var r,a;if(e)s=e.type===S.Dl.Selectable?y.C.findSelectableFromStore(e.store):v.Z.findDropTargetFromKey(e.key),null===(r=s)||void 0===r||null===(r=r.props)||void 0===r||null===(a=r.onNativeDrop)||void 0===a||a.call(r,{files:n,droppedDirection:e.direction});k.ROv(t,{draggedTypes:[],from:o,asCopy:!1}),A(t,null===(i=s)||void 0===i?void 0:i.props.keepTextSelectionOnDrop)}}function B(e,t){S.ZP.state.isDragging&&(P.ZH(e),S.ZP.setState({...S.ZP.state,...t}))}function E(e,t){if(S.ZP.state.isDragging)return!1;{const{startX:n,startY:o,isNativeDrag:i}=t,r=T.aw(t.stores);P.ZH(e);const a=y.C.getRectFromStore(r[0]);return S.ZP.setState({isDragging:!0,startX:n,startY:o,currentX:n,currentY:o,offsetX:n-(a&&a.left||0),offsetY:o-(a&&a.top||0),currentHintDropZones:[],draggedStores:r,isNativeDrag:i,ghostElements:r.map((e=>t.getGhostElement?t.getGhostElement(e):function(e){const{store:t}=e,n=y.C.findSelectablesFromStore(t);return s.oA(n.map((e=>{if(e.props.canSelect){const t=e.getNode();if(t)return Z(t)}})))}({store:e})))}),T.$Y({environment:e,phase:w.SelectionPhase.Selected}),_.default.reset(),!0}}function F(e){const{droppedStores:t,transaction:n,environment:i,duplicate:r,duplicateUseCrdt:s}=e,l=e.resolveTemplateVariables;return t.map((e=>{if(!y.C.findSelectableFromStore(e))return e;if(r){const t=!e.isTransclusionType(),[r,a]=C.Qi({environment:i,stores:[e],addCopyName:(0,h.Z)(e),transaction:n,deepCopyTransclusionContainers:t,targetSpaceId:(0,c.C)(e.pointer.spaceId),resolveTemplateVariables:e.getType()!==o.Ti.factory&&l,baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:s}),d=r[0];return a.then((e=>{e&&I.showErrorMessage(e)})),d}return l&&M.bt({store:e,context:{currentUserId:i.currentUser.id,currentTimeZone:(0,a.r)()},transaction:n}),x.Od({store:e,transaction:n}),e}))}function Z(e){const t=e.style.transform,n=e.style.transition;e.style.transform="",e.style.transition="";const o=e.getBoundingClientRect();e.style.transform=t,e.style.transition=n;const r=e.cloneNode(!0);!function(e,t){const{firstElementChild:n}=e;if(n&&n.hasAttribute("embed-ghost")){const n=L(e,[]);if(n){const r=j(e,n),a=j(t,n);if(r&&a)if(r.shadowRoot){const e=r.shadowRoot;let t=null;if(a.createShadowRoot)t=a.createShadowRoot();else if(a.attachShadow)try{t=a.attachShadow({mode:"open"})}catch(o){}t&&(t.innerHTML=e.innerHTML)}else if(!r.src&&r.contentDocument){const e=document.createElement("iframe");e.width=r.offsetWidth,e.height=r.offsetHeight,V(e,a),a.parentElement.replaceChild(e,a),e.onload=t=>{const n=e.contentDocument.children[0],o=r.contentDocument.children[0];V(n,o),n.innerHTML=o.innerHTML}}else a.width=r.offsetWidth,a.height=r.offsetHeight,a.style.backgroundColor=i.ZP.blackWithAlpha(.12),a.style.backgroundImage=null,a.src=""}}}(e,r);const a=getComputedStyle(e);for(let i=0;i<a.length;i++){const e=a[i],t=a.getPropertyValue(e);"app-region"===e&&"none"===t||(r.style[e]=t)}"absolute"!==a.position&&"relative"!==a.position||(r.style.position="",r.style.top="",r.style.left="",r.style.bottom="",r.style.right="");const s=r.querySelectorAll(`.${m.No6}`);for(const i of s)i.remove();r.style.pointerEvents="none";const l=r.querySelectorAll("*");for(const i of l)i.style&&(i.style.pointerEvents="none");return{cloned:r,rect:o}}function L(e,t){if(e.shadowRoot)return t;if(e instanceof HTMLIFrameElement)return t;{const{firstElementChild:n,nextElementSibling:o}=e;if(n){t.push(0);const e=L(n,t);if(e)return e;t.pop()}if(o){t[t.length-1]+=1;const e=L(o,t);if(e)return e}return null}}function j(e,t){return t.reduce(((e,t)=>e&&e.children&&e.children[t]?e.children[t]:null),e)}function V(e,t){r.p4(t.attributes).forEach((t=>{let{name:n,value:o}=t;e.setAttribute(n,o)}))}},91584:(e,t,n)=>{n.d(t,{O$:()=>k,Ui:()=>b,WO:()=>y,cR:()=>_,qN:()=>w,vQ:()=>S});var o=n(99405),i=n(23867),r=n(64002),a=n(5366),s=n(50906),l=n(47307),c=n(47839),d=n(95477),u=n(91924),p=n(7844),m=n(89087),f=n(54642),g=n(92625),h=n(15356);const v=(0,a.defineMessages)({authenticatingWithGoogle:{id:"googleDriveActions.authenticatingWithGoogle.loadingMessage",defaultMessage:"Authenticating with Google…"},googleLoginTitle:{defaultMessage:"Google login",id:"googleDriveActions.loginWithGoogleModal.title"}});async function b(e){const{environment:t,store:n,fileId:o,token:r}=e;await m.transactionQueue.awaitRecordTransaction(n.pointer);const a=await f.initializeGoogleDriveBlock(t,{block:{id:n.id,spaceId:(0,i.C)(n.pointer.spaceId)},fileId:o,token:r});if("failed"!==a.type)return a.data.file&&s.cV4(t,{file_type:a.data.file.mimeType??void 0}),a.data;l.showError(a)}function y(e,t){f.refreshGoogleDriveBlock(e,{block:t})}async function S(e){const t=await f.getGoogleDriveAccounts(e,{});return"success"===t.type&&t.data.accounts?t.data:{accounts:[]}}function _(e,t){const{onSuccess:n,onFailure:o}=t;p.Z.setState({open:!0,onConfirm:async()=>{const t=await w(e);t&&t.token?n(t.token):o&&o()},onDecline:o})}async function w(e){const t=(0,u.eC)(e);let n=(0,o.ZQ)(d.default.domainBaseUrl,{authType:t});if(n=t.redirectToAuth?n:await(0,u.HU)(e,n),e.device.isElectron)return void c.openExternalUrl(n);const i=await h.M(e,{width:610,height:700,url:n,titleMessage:v.googleLoginTitle});if(!i)return;const a=r.Qc(i);return await k(e,a.query.code)}async function k(e,t){if(!t)return;g.j({message:v.authenticatingWithGoogle});const n=await f.authWithGoogleForDrive(e,{code:t});if(g.x(),"failed"!==n.type)return s.L3B(e,{integration_name:"google"}),n.data;{const e=n.error;console.error(e),l.showError(n)}}},54532:(e,t,n)=>{n.d(t,{E9:()=>Z,K8:()=>V,Qi:()=>j,WJ:()=>L});n(21703),n(57658);var o=n(41432),i=n(87444),r=n(42875),a=n(59730),s=n(64572),l=n(59753),c=n(29477),d=n(4615),u=n(45953),p=n(606),m=n(98963),f=n(18844),g=n(21202),h=n(6287),v=n(13493),b=n(29369),y=n(70203),S=n(5366),_=n(95477),w=n(33954),k=n(33929),I=n(35328),C=n(80444),x=n(88632),T=n(35661),M=n(50906),P=n(54642),A=n(41433),R=n(47307),D=n(29533),B=n(9953),E=n(39865);const F=(0,S.defineMessages)({offlineError:{id:"duplicateActions.offlineError.message",defaultMessage:"Please go online to copy this block."},unknownError:{id:"duplicateActions.unknownError.message",defaultMessage:"An unknown error occurred."}});function Z(e){const{environment:t,sourceBlockId:n,targetBlockPointer:o,sourceBlockSubtree:r,targetInMemoryRecordCache:a,addCopyName:s,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,transaction:d,useCrdt:u}=e,{targetBlock:p,originalToDuplicate:m}=A.ZI({environment:t,sourceBlockId:n,targetBlockPointer:o,sourceBlockSubtree:r,targetRecordCache:a,transaction:d,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,useCrdt:u});if(s&&p&&p.isNavigableBlock()){const e=p.getTitleStore();if(e){const t=e.getValue(),n=i.eb(t);B.sO({store:e,value:n,transaction:d})}}return{targetBlock:p,originalToDuplicate:m}}function L(e){const{environment:t,sourceBlocks:n,targetInMemoryRecordCache:i,snapshotData:s,addCopyName:l,deepCopyTransclusionContainers:d,resolveTemplateVariables:u,transaction:p,targetSpaceId:m,convertExternalObjectInstancesToPlaceholders:f,useCrdt:g,duplicateOnlyCollectionSchema:h}=e;if(0===n.length)throw new Error("Must duplicate at least one block");const v=n.map(((e,n)=>B.j4({environment:t,type:o.Ti.copyIndicator,inMemoryRecordCache:i,transaction:p,spaceId:m,useCrdt:g}))),b=c.UZ();return p.postSubmitCallbacks.push((async e=>{if(e)(0,a.Jx)(e)?b.resolve((0,w.nX)(k.default.getIntl(),e)):b.resolve(k.default.formatMessage(F.unknownError));else{const e=P.duplicateBlock(t,{sourceBlocks:n,targetBlocks:v.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),snapshotData:s,addCopyName:l,deepCopyTransclusionContainers:d,resolveTemplateVariables:!!u&&{currentUserId:t.currentUser.id,currentTimeZone:(0,r.r)()},convertExternalObjectInstancesToPlaceholders:f,useCrdt:g,duplicateOnlyCollectionSchema:h});let o;for await(const t of e){for(const e of v)D.R(t,e.id);o=t}for(const t of v)D.h(t.id);if(!o)return void b.resolve(void 0);if(o.error){E.Tq({environment:t,blocks:v});const e=(0,w.HV)(k.default.getIntl(),o.error);b.resolve(e)}else b.resolve(void 0)}})),[v,b.promise]}function j(e){const{environment:t,stores:n,addCopyName:o,deepCopyTransclusionContainers:i,resolveTemplateVariables:r,transaction:a,targetSpaceId:s,preferDuplicateLocation:l,analyticsFrom:c,useCrdt:u,duplicateOnlyCollectionSchema:p}=e;if(0===n.length)throw new Error("Must duplicate at least one block");const m=n[0].getSpaceId();if(!n.every((e=>e.getSpaceId()===m)))throw new Error("All stores must be in the same space");if(n.length>1&&!n.every((e=>e.isTypedCollectionViewBlock())))throw new Error("Multiple source blocks only supported for grouped typed DB duplication");for(const d of n){const e=d.getRecordStoreAtRootPath().getValue();let n;const{currentSpaceStore:o}=C.default.getState();var f;if(o&&(null==e?void 0:e.parent_table)===b.e0&&(n=T.zX.createChildStore(o,{table:b.e0,id:e.parent_id})),e)M.W2j(t,{from:c??"copy",type:e.type,teamStore:n,is_toggleable:(0,I._A)(e.type,e.format),collection_id:d.getParentCollectionId()??(null===(f=d.getCollectionViewCollectionStore())||void 0===f?void 0:f.id),new_page_id:"page"===e.type?d.id:void 0})}const h=m!==s;if("local"===l&&1===n.length){const e=n[0],l=V(t,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!i,allowCopyExternalObjectInstances:!h});if(l){const{targetBlock:n}=Z({environment:t,sourceBlockId:e.id,targetBlockPointer:{id:(0,d.ZP)(),table:g.iU,spaceId:s},sourceBlockSubtree:l,targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:o,deepCopyTransclusionContainers:i,resolveTemplateVariables:r,transaction:a,useCrdt:u});return[[n],Promise.resolve(void 0)]}}for(const d of n)if(d.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache)throw new Error("Can only server duplicate from the environment.defaultRecordCache.inMemoryRecordCache.");const v=t.defaultRecordCache.inMemoryRecordCache;return x.Z.state.online||R.showErrorMessage(k.default.formatMessage(F.offlineError)),L({environment:t,sourceBlocks:n.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),targetInMemoryRecordCache:v,addCopyName:o,transaction:a,deepCopyTransclusionContainers:i,resolveTemplateVariables:r,targetSpaceId:s,convertExternalObjectInstancesToPlaceholders:h,useCrdt:u,duplicateOnlyCollectionSchema:p})}function V(e,t){const{blockId:n,inMemoryRecordCache:i,allowCopyCollections:r,requireFullSubtree:a,skipTransclusionContainerChildren:c,allowCopyExternalObjectInstances:d}=t,b=e.currentUser.id,S=u.Ak.create(),w=new Set,k=[{pointer:{table:g.iU,id:n},parentId:"doesn't matter"}];for(;k.length>0;){const e=k.shift();if(!e)continue;if(w.has(e.pointer.id))continue;w.add(e.pointer.id);const t=n===e.pointer.id;if((0,p.$O)(e.pointer,g.iU)){var I,C,x;const n=i.getRecord({pointer:e.pointer,userId:b});if(!n||!n.value){if(a)return;continue}const r=n.value;if(!t&&r.parent_id!==e.parentId)continue;if(r.type===o.Ti.externalObjectInstance&&!d)return;if(S.setValue(e.pointer,r),null!==(I=r.format)&&void 0!==I&&I.collection_pointer&&k.push({pointer:r.format.collection_pointer,parentId:r.id}),r.collection_id&&k.push({pointer:{table:h.v,id:r.collection_id},parentId:r.id}),r.view_ids)for(const e of r.view_ids)k.push({pointer:{table:v.n,id:e,spaceId:r.space_id},parentId:r.id});if(!c||"transclusion_container"!==r.type){const e=l.kk.fromBlock(r).getRenderableContentIds();for(const t of e)k.push({pointer:{table:g.iU,id:t},parentId:r.id})}if(r.type===o.Ti.externalObjectInstance){var T,M;const e=(null===(T=r.format)||void 0===T?void 0:T.related_external_object_uris_to_instance_ids)&&Object.values(null===(M=r.format)||void 0===M?void 0:M.related_external_object_uris_to_instance_ids)||[];for(const t of e)k.push({pointer:{table:g.iU,id:t,spaceId:r.space_id},parentId:r.id})}if(r.properties)for(const e of Object.values(r.properties))if(e)for(const t of e)for(const e of y.hDy(t)){if(y.STW(e)){const t=y.TOT(e);k.push({pointer:{table:g.iU,id:t},parentId:r.id})}if(y.j0F(e)){const t=y.zW$(e),n=(0,s.A5)({url:t,baseUrl:_.default.domainBaseUrl,publicDomainName:_.default.publicDomainName});n&&k.push({pointer:{table:g.iU,id:n},parentId:r.id})}if(y.nSN(e)){const t=y.frW(e);t&&k.push({pointer:{table:g.iU,id:t,spaceId:r.space_id},parentId:r.id})}}null!==(C=r.format)&&void 0!==C&&C.automation_id&&k.push({pointer:{table:m.cv,id:r.format.automation_id,spaceId:r.space_id},parentId:r.id}),null!==(x=r.format)&&void 0!==x&&x.ai_instructions_page_pointer&&k.push({pointer:r.format.ai_instructions_page_pointer,parentId:r.id})}else if((0,p.$O)(e.pointer,h.v)){var P;if(!r)return;const t=i.getRecord({pointer:e.pointer,userId:b});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;const n=t.value;S.setValue(e.pointer,n),i.forEachRecord(b,(t=>{let{model:n}=t;n.table===g.iU&&n&&n.parent_id===e.pointer.id&&n.alive&&k.push({pointer:n.pointer,parentId:e.pointer.id})}));const o=(null===(P=n.format)||void 0===P?void 0:P.automation_ids)??[];for(const e of o)k.push({pointer:{table:m.cv,id:e,spaceId:n.space_id},parentId:n.id})}else if((0,p.$O)(e.pointer,v.n)){const t=i.getRecord({pointer:e.pointer,userId:b});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;S.setValue(e.pointer,t.value)}else if((0,p.$O)(e.pointer,m.cv)){const t=i.getRecord({pointer:e.pointer,userId:b});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;S.setValue(e.pointer,t.value);for(const e of t.value.action_ids??[])k.push({pointer:{table:f.Xj,id:e,spaceId:t.value.space_id},parentId:t.value.id})}else if((0,p.$O)(e.pointer,f.Xj)){const t=i.getRecord({pointer:e.pointer,userId:b});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;S.setValue(e.pointer,t.value);for(const e of t.value.blocks??[])k.push({pointer:{table:g.iU,id:e,spaceId:t.value.space_id},parentId:t.value.id})}}return S}},47839:(e,t,n)=>{n.r(t),n.d(t,{appUpdateAvailable:()=>x,appUpdateChecking:()=>C,appUpdateError:()=>I,appUpdateFinished:()=>A,appUpdateInstall:()=>R,appUpdateNotAvailable:()=>T,appUpdateProgress:()=>P,appUpdateReady:()=>k,appUpdateReload:()=>M,checkForUpdates:()=>b,clearBrowserHistory:()=>f,clearCookies:()=>X,clearGoogleAuthCookies:()=>ee,closeGlobalSearchModal:()=>me,closeQuickSearch:()=>ge,downloadUrl:()=>ne,electronApi:()=>c,electronAppFeatures:()=>le,electronUpdateAvailable:()=>S,electronUpdateChecking:()=>y,electronUpdateError:()=>v,electronUpdateNotAvailable:()=>_,electronUpdateProgress:()=>w,electronUpdateReady:()=>h,fullscreen:()=>E,getAppPath:()=>te,getCurrentZoom:()=>V,getDesktopVersion:()=>d,getSubstitutions:()=>W,inPageSearch:()=>F,initializeElectron:()=>ae,installElectronUpdate:()=>D,isActiveTab:()=>ue,isMainTabOrWindow:()=>q,isRunningUnderArm64Translation:()=>B,onNewWindow:()=>$,openDevTools:()=>H,openExternalUrl:()=>m,openGoogleDrivePickerPopup:()=>Y,openInNewTab:()=>u,openInNewWindow:()=>p,openOauthPopup:()=>Q,openPageFromGlobalSearch:()=>fe,openQuickSearchResult:()=>he,openSearchModalFromQuickSearch:()=>ye,quickSearchReady:()=>ve,quickSearchVisibilityState:()=>be,ready:()=>re,refreshAll:()=>se,setBadge:()=>g,setLogglyData:()=>J,setTabColors:()=>K,setTheme:()=>G,sidebarState:()=>ce,subscribeToProtocolUrl:()=>oe,subscribeToSettingsMenuItem:()=>ie,toggleMaximized:()=>z,track:()=>pe,windowSidebarState:()=>de,zoomIn:()=>U,zoomOut:()=>O,zoomReset:()=>N});n(97391);var o=n(68626),i=n(72126),r=n(64002);function a(e){const t=e.match(/Mac OS X (\d+_\d+)/);if(t)return t[1].split("_").map((e=>parseInt(e,10)))}var s=n(63643);let l="lastProtocolUrlDeduplicationId";const c=s.electronApi,d=s.getDesktopVersion;function u(e){const t=r.T1(e.url);c&&(c.openInNewTab?c.openInNewTab(t,e.makeTabActive,e.position):c.openInNewWindow(t))}function p(e){const t=r.T1(e);c&&c.openInNewWindow(t)}function m(e){if(c){void 0!==r.yn(e)&&c.openExternalUrl(e)}}function f(){c&&c.clearBrowserHistory()}function g(e){if(c)return c.setBadge(e)}const h={addListener(e){c&&c.updateReady.addListener(e)},removeListener(e){c&&c.updateReady.removeListener(e)}},v={addListener(e){c&&c.updateError&&c.updateError.addListener(e)},removeListener(e){c&&c.updateError&&c.updateError.removeListener(e)}},b=()=>{c&&c.checkForUpdates&&c.checkForUpdates()},y={addListener(e){c&&c.updateChecking&&c.updateChecking.addListener(e)},removeListener(e){c&&c.updateChecking&&c.updateChecking.removeListener(e)}},S={addListener(e){c&&c.updateAvailable&&c.updateAvailable.addListener(e)},removeListener(e){c&&c.updateAvailable&&c.updateAvailable.removeListener(e)}},_={addListener(e){c&&c.updateNotAvailable&&c.updateNotAvailable.addListener(e)},removeListener(e){c&&c.updateNotAvailable&&c.updateNotAvailable.removeListener(e)}},w={addListener(e){c&&c.updateProgress&&c.updateProgress.addListener(e)},removeListener(e){c&&c.updateProgress&&c.updateProgress.removeListener(e)}},k={addListener(e){c&&c.appUpdateReady&&c.appUpdateReady.addListener(e)},removeListener(e){c&&c.appUpdateReady&&c.appUpdateReady.removeListener(e)}},I={addListener(e){c&&c.appUpdateError&&c.appUpdateError.addListener(e)},removeListener(e){c&&c.appUpdateError&&c.appUpdateError.removeListener(e)}},C={addListener(e){c&&c.appUpdateChecking&&c.appUpdateChecking.addListener(e)},removeListener(e){c&&c.appUpdateChecking&&c.appUpdateChecking.removeListener(e)}},x={addListener(e){c&&c.appUpdateAvailable&&c.appUpdateAvailable.addListener(e)},removeListener(e){c&&c.appUpdateAvailable&&c.appUpdateAvailable.removeListener(e)}},T={addListener(e){c&&c.appUpdateNotAvailable&&c.appUpdateNotAvailable.addListener(e)},removeListener(e){c&&c.appUpdateNotAvailable&&c.appUpdateNotAvailable.removeListener(e)}},M={emit:e=>{c&&c.appUpdateReload&&c.appUpdateReload.emit(e)},addListener(e){c&&c.appUpdateReload&&c.appUpdateReload.addListener(e)},removeListener(e){c&&c.appUpdateReload&&c.appUpdateReload.removeListener(e)}},P={addListener(e){c&&c.appUpdateProgress&&c.appUpdateProgress.addListener(e)},removeListener(e){c&&c.appUpdateProgress&&c.appUpdateProgress.removeListener(e)}},A={addListener(e){c&&c.appUpdateFinished&&c.appUpdateFinished.addListener(e)},removeListener(e){c&&c.appUpdateFinished&&c.appUpdateFinished.removeListener(e)}},R={addListener(e){c&&c.appUpdateInstall&&c.appUpdateInstall.addListener(e)},removeListener(e){c&&c.appUpdateInstall&&c.appUpdateInstall.removeListener(e)}};function D(){c&&c.installUpdate()}function B(){var e;return null==c||null===(e=c.isRunningUnderArm64Translation)||void 0===e?void 0:e.call(c)}const E={get(){if(c)return c.fullscreen.get()},addListener(e){c&&c.fullscreen.addListener(e)},removeListener(e){c&&c.fullscreen.removeListener(e)}},F={start(e){c&&c.inPageSearch&&c.inPageSearch.start(e)},stop(){c&&c.inPageSearch&&c.inPageSearch.stop()},started:{addListener(e){c&&c.inPageSearch&&c.inPageSearch.started.addListener(e)},removeListener(e){c&&c.inPageSearch&&c.inPageSearch.started.removeListener(e)}},stopped:{addListener(e){c&&c.inPageSearch&&c.inPageSearch.stopped.addListener(e)},removeListener(e){c&&c.inPageSearch&&c.inPageSearch.stopped.removeListener(e)}}},Z=(e,t,n)=>Math.min(Math.max(e,n),t);let L,j=1;function V(){return j}function U(){c&&c.zoom&&(j+=.1,c.zoom.set(Z(.1,4.9,j)))}function O(){c&&c.zoom&&(j-=.1,c.zoom.set(Z(.1,4.9,j)))}function N(){c&&c.zoom&&(j=1,c.zoom.set(j))}function z(){c&&c.toggleMaximized&&c.toggleMaximized()}function H(){c&&c.openDevTools&&c.openDevTools()}function W(){return L||[]}async function q(){return c&&c.isMainTab?c.isMainTab():!c||!c.isMainWindow||c.isMainWindow()}function G(e){c&&c.setTheme&&c.setTheme(e)}function K(e){c&&c.setTabColors&&c.setTabColors(e)}function $(e){c&&c.newWindow&&c.newWindow.addListener(e)}async function Q(e){if(c&&c.openOauthPopup)return c.openOauthPopup(e)}async function Y(e){if(c&&c.openGoogleDrivePickerPopup)return c.openGoogleDrivePickerPopup(e)}function J(e){c&&(c.setLoggerData?c.setLoggerData(e):c.setLogglyData&&c.setLogglyData(e))}function X(){c&&c.clearCookies&&c.clearCookies()}function ee(){c&&c.clearAllCookies&&c.clearAllCookies()}async function te(){if(c&&c.getAppPath)return c.getAppPath()}function ne(e){if(c&&c.downloadUrl)c.downloadUrl(e);else{const t=document.createElement("a");t.download=e,t.href=e,t.click()}}function oe(e){c&&c.onNavigate&&c.onNavigate.addListener(((t,n)=>{if("string"!=typeof n&&n.deduplicationID){const e=n.deduplicationID;if(l===e)return void o.log({level:"warning",from:"electronActions",type:"duplicateOnNavigateObjectDetected"});l=e}e(n)}))}function ie(e){c&&c.onOpenSettings&&c.onOpenSettings.addListener((t=>e()))}function re(){c&&c.ready&&c.ready()}async function ae(e){const{device:t,electronSqlite:n}=e;if(c){if(await s.getAndCacheDesktopVersionAsync(),c.zoom&&(j=await c.zoom.get()),n&&n.sqliteConnection&&(await n.sqliteConnection.ensureMigrated(),n.sqliteConnection.optimize()),c.getSubstitutions&&t.isElectronMac){const e=await c.getSubstitutions();L=e.filter((e=>e.replace!==e.with)).map((e=>({length:e.replace.length,replace:new RegExp(`\\b${i.hr(e.replace)} $`),with:`${e.with} `})))}t.isElectronMac&&function(){const e=a(arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.userAgent);return!!e&&10===e[0]&&e[1]<15}()&&le.setPreference("isAutoUpdaterDisabled",!0)}}function se(e){c&&c.refreshAll&&c.refreshAll(e.includeFocusedWindow)}const le={get(){if(c&&c.electronAppFeatures)return c.electronAppFeatures.get()},setPreference(e,t){var n;c&&null!==(n=c.electronAppFeatures)&&void 0!==n&&n.setPreference&&c.electronAppFeatures.setPreference(e,t)},addListener(e){c&&c.electronAppFeatures&&c.electronAppFeatures.addListener(e)},removeListener(e){c&&c.electronAppFeatures&&c.electronAppFeatures.removeListener(e)}},ce={set(e){c&&c.sidebarState&&c.sidebarState.set(e)},addToggleListener(e){c&&c.sidebarState&&c.sidebarState.addToggleListener(e)},removeToggleListener(e){c&&c.sidebarState&&c.sidebarState.removeToggleListener(e)}},de={get:()=>c&&c.windowSidebarState?c.windowSidebarState.get():Promise.resolve(void 0),set(e){c&&c.windowSidebarState&&c.windowSidebarState.set(e)},addListener(e){c&&c.windowSidebarState&&c.windowSidebarState.addListener(e)},removeListener(e){c&&c.windowSidebarState&&c.windowSidebarState.removeListener(e)}},ue={get:()=>c&&c.isActiveTab?c.isActiveTab.get():Promise.resolve(!1),addListener(e){c&&c.isActiveTab&&c.isActiveTab.addListener(e)},removeListener(e){c&&c.isActiveTab&&c.isActiveTab.removeListener(e)}},pe={addListener(e){c&&c.track&&c.track.addListener(e)},removeListener(e){c&&c.track&&c.track.removeListener(e)}};function me(){c&&c.closeGlobalSearchModal&&c.closeGlobalSearchModal()}function fe(e){c&&c.openPageFromGlobalSearch&&c.openPageFromGlobalSearch(e)}function ge(){c&&c.closeQuickSearch&&c.closeQuickSearch()}function he(e){c&&c.openQuickSearchResult&&c.openQuickSearchResult(e)}function ve(){c&&c.quickSearchReady&&c.quickSearchReady()}const be={isVisible:()=>c&&c.quickSearchVisibilityState?c.quickSearchVisibilityState.isVisible():Promise.resolve(!1),addListener(e){c&&c.quickSearchVisibilityState&&c.quickSearchVisibilityState.addListener(e)},removeListener(e){c&&c.quickSearchVisibilityState&&c.quickSearchVisibilityState.removeListener(e)}},ye={addListener(e){c&&c.openSearchModalFromQuickSearch&&c.openSearchModalFromQuickSearch.addListener(e)},removeListener(e){c&&c.openSearchModalFromQuickSearch&&c.openSearchModalFromQuickSearch.removeListener(e)}}},31781:(e,t,n)=>{n.d(t,{vW:()=>R,z:()=>B,TH:()=>V,I:()=>F,qC:()=>D,qL:()=>L,x1:()=>U,cT:()=>E});n(57658);var o=n(1302),i=n(41432),r=n(80951),a=n(95538),s=n(43593),l=n(70203),c=n(5366),d=n(54642),u=n(48948),p=n(95477),m=n(33929),f=n(45010),g=n(18245),h=n(58202),v=n(53809),b=n(30548);const y=new v.D({key:"urlTurnedBookmarkToastStatusSetting",namespace:b.$p,important:!0,trackingType:"preference"});var S=n(27411),_=n(50906),w=n(62365),k=n(96802),I=n(27153),C=n(9953),x=n(75018),T=n(64964),M=n(39699),P=n(53471);const A=(0,c.defineMessages)({urlTurnedBookmark:{id:"action.urlTurnedBookmark.snackBarMessage",defaultMessage:"Pasted url is not embeddable, turned to bookmark instead!"}});let R=function(e){return e[e.Page=0]="Page",e[e.PageComment=1]="PageComment",e[e.SidebarComment=2]="SidebarComment",e}({});function D(e){return e===R.PageComment||e===R.SidebarComment}function B(e){const{environment:t,files:n,inMemoryRecordCache:o,transaction:i,pageWidth:r,ignoreOversizedFiles:a,spaceId:s,useCrdt:l}=e;return n.filter((e=>{if(a){if(!P.Q7({environment:t,file:e,preventLimitFreeFileSize:!1}))return P.A3(t),!1}return!0})).map((e=>{if(!e.type||0!==e.type.indexOf("image")&&0!==e.type.indexOf("video")&&0!==e.type.indexOf("audio")||e.type.includes("photoshop")){const n=C.j4({environment:t,type:"file",inMemoryRecordCache:o,transaction:i,spaceId:s,useCrdt:l});return i.postSubmitCallbacks.push((o=>{o||w.c({environment:t,store:n,file:e})})),n}{const n=C.j4({environment:t,type:"embed",inMemoryRecordCache:o,transaction:i,spaceId:s,useCrdt:l});return i.postSubmitCallbacks.push((o=>{o||E({environment:t,store:n,file:e,pageWidth:r,preferredType:void 0})})),n}}))}function E(e){const{environment:t,store:n,file:i,pageWidth:r,preferredType:s}=e,l=S.default.getBlockKey(n.id);I.Z(),P.cT({environment:t,file:i,bucket:"secure",record:n.pointer,onStart:e=>{if(S.default.setKeyState(l,{progressPercent:0,file:i,name:e.name,size:e.size}),i.type.indexOf("image")>=0&&!(0,a.y_)(e.name,"tiff")&&!(0,a.y_)(e.name,"tif")){const e=URL.createObjectURL(i),a=new Image;a.onload=function(){Z(t,{store:n,width:a.naturalWidth,height:a.naturalHeight,scale:!0,type:"image",pageWidth:r}),t.device.isMobile&&o.default.afterNextFlush((()=>{f.Z.PageScroller&&f.Z.PageScroller.scrollerHack()})),URL.revokeObjectURL(e)},a.src=e}else{const e=(0,a.Dz)({url:i.name||"",baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferredType:s});Z(t,{store:n,width:r,type:e,pageWidth:r})}},onProgress:e=>{const t=S.default.getKeyState(l);t&&S.default.setKeyState(l,{...t,progressPercent:e.progressPercent})},onComplete:async e=>{const o=S.default.getKeyState(l);if(o){const i=Boolean(o.dataURL),a=o.name,c=o.size;await F(t,{source:e,store:n,isDataURL:i,pageWidth:r,preferredType:s,name:a,size:c}),S.default.setKeyState(l,void 0)}},onError:()=>{S.default.setKeyState(l,void 0)},retryWhenOffline:!0})}async function F(e,t){const{store:n,source:o,isDataURL:r,pageWidth:s,preferredType:c,name:f,size:h}=t;let v=r?"image":(0,a.Dz)({url:o,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferredType:c});const b=O(v,o),{properties:S,type:w,format:I}=await(0,a.Ol)({source:b,type:v,isDataURL:r,pageWidth:s,isMobileDevice:e.device.isMobile,getEmbedData:async t=>{const n=await d.getGenericEmbedBlockData(e,t);return"failed"===n.type?void console.error(n.error):n.data},trackEmbedType:t=>_.Jgl(e,{embedType:t})});if(v=w,v===i.Ti.bookmark){const o=n;return await u.K({environment:e,store:o,url:b,transformTimeout:0}),_.mCV(e),function(){if("do_not_prompt"===y.state)return;y.state?"displayed_once"===y.state?y.setState("displayed_twice"):"displayed_twice"===y.state&&y.setState("do_not_prompt"):y.setState("displayed_once");T.oV({label:m.default.formatMessage(A.urlTurnedBookmark)})}(),void(t.metric&&g.default.measure(t.metric,{environment:e,data:{embedType:v}}))}_.GlI(e,{embedType:w});const x=f&&h?{title:l.TPx(f),size:l.TPx(h)}:{},{serverCommitResult:P}=M.createAndCommit({userAction:"embedBlockActions.initializeEmbedBlock",environment:e,perform:e=>{C.sW({store:n.getPropertiesStore(),data:{...S||{},...x},transaction:e}),k.FH({stores:[n],update:I,transaction:e}),C.sW({store:n,data:{type:v},transaction:e})}});await P,t.metric&&g.default.measure(t.metric,{environment:e,data:{embedType:v}})}function Z(e,t){let{store:n,...o}=t;M.createAndCommit({userAction:"embedBlockActions.initializeFormat",environment:e,perform:e=>{k.FH({stores:[n],update:(0,a.tj)(o),transaction:e})}})}async function L(e,t){const{store:n}=t,o=n.getProperties();if(o){const u=n.getType();let p,m;if("file"===u){const t=await N({environment:e,store:n,calledFrom:"openSource"});t&&(m=t.url,p=t.fileName)}else{const e=u===i.Ti.bookmark?o.link:o.source,t=r.zB(e),a=l.QaF(o.title),{display_source:c,original_url:d}=n.getFormat();m=n.isExternalObjectInstanceBlockStore()?d:t||c,m&&(p=s.rF({title:a,source:m}))}var a,c,d="file";if("image"===u?d="image":"video"===u&&(d="video"),m)await x.openFileUrl(e,{url:m,downloadName:p,type:d,from:t.from,permissionRecord:t.store.pointer,download:(null===(a=p)||void 0===a?void 0:a.endsWith(".html"))||(null===(c=p)||void 0===c?void 0:c.endsWith(".htm"))})}}const j=(0,c.defineMessages)({downloadingImage:{id:"embedBlockActions.downloading.label",defaultMessage:"Downloading…"}});async function V(e){const{store:t,environment:n}=e,o=await N({store:t,environment:n,calledFrom:"downloadSource"});if(!o)return;const{url:i,fileName:r}=o;if(i){let o;_.Uk(n,{url:i,fileName:r,from:"embedBlockActions"}),o=s.E$(i,[p.default.secureFileS3.url,p.default.secureFileS3V2.url])?x.downloadFileUrl(n,{url:i,download:!0,downloadName:r,permissionRecord:t.pointer}):function(e){const{store:t,environment:n}=e;if(!n.currentUser.id)return Promise.resolve();const o=t.getProperties(),i=l.QaF(null==o?void 0:o.source),r=l.QaF(null==o?void 0:o.caption);return s.GN(i,t.pointer,p.default.domainBaseUrl,n.currentUser.id,r)}(e),T.oV({label:m.default.formatMessage(j.downloadingImage),durationMs:"keep"}),await o.finally((()=>{T.rN()}))}}const U=e=>{const{store:t}=e,n=h.R.findBlockFromStoreWithMethod(t,"replace");n&&n.replace()},O=function(e,t){return"maps"===e?/^https?:\/\//i.test(t)?t:`https://maps.google.com/maps/search/${encodeURIComponent(t)}`:(0,a.x$)(t)};async function N(e){let{store:t,environment:n,calledFrom:o}=e;const i=t.getNavigableBlockStore();if(!i)return;const r=await d.getBlockFileDownloadUrl(n,{blockId:t.id,pageBlockId:i.id,meta:{name:o}});if("success"!==r.type)return;const{url:a,fileName:s}=r.data;return{url:a,fileName:s}}},89951:(e,t,n)=>{n.d(t,{KT:()=>B,RL:()=>E,xv:()=>F});var o=n(1302),i=n(41432),r=n(43593),a=n(72126),s=n(99405),l=n(21202),c=n(13493),d=n(70203),u=n(95477),p=n(69783),m=n(28020),f=n(63085),g=n(89224),h=n(58202),v=n(64233),b=n(19111),y=n(35661),S=n(27724),_=n(10743),w=n(52229),k=n(50906),I=n(79554),C=n(48948),x=n(96802),T=n(72711),M=n(9953),P=n(42858),A=n(97444),R=n(39699),D=n(68422);function B(e){const{environment:t,textStore:n,url:o,oldTextValue:i,urlSelection:r}=e;if(_.Z.state.open||p.Z.state.open||b.Z.state.open||v.Z.state.open)return;const a=g.get();if(!a)return;const s=g.getRect(a);s&&(v.Z.setState({open:!0,textStore:n,url:o,oldTextValue:i,urlSelection:r,selectionRect:s}),k.elP(t,{url:o}))}async function E(e){const{environment:t}=e,n=v.Z.state;if(n.open){const{url:p,textStore:g,oldTextValue:v}=n,b=S.default.state.stores,_=b[0];if(!_)return;const k=(0,r.Wv)(p,u.default.secureFileS3.url,u.default.secureFileS3V2.url,u.default.secureFileConfig.rootPath,u.default.secureFileConfig.hostname),B=k?k.link:p,E=(0,s.Wj)({url:B,baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,isMobile:t.device.isMobile,protocol:u.default.protocol,currentUrl:window.location.href});if("page"===E.name)await R.createAndCommitAsync({environment:t,userAction:"embedMenuActions.embedPageAlias",waitForServerCommit:!1,perform:async i=>{let r;if(A.sO({environment:t,store:g,value:v,transaction:i}),E.peekViewBlockId){const e=y.G.createChildStore(g,{table:l.iU,id:E.peekViewBlockId});await e.load(),e.isPageBlock()&&(r=e)}if(r||(r=y.G.createChildStore(g,{table:l.iU,id:E.blockId})),r){if("mention-page"===e.type){const e=r.getRecordModel({id:r.id,table:l.iU});A.lZ({environment:t,store:g,selection:{startIndex:n.urlSelection.startIndex,endIndex:n.urlSelection.startIndex},annotation:d.$0A(E.scrollToBlockId??r.id,null==e?void 0:e.space_id),transaction:i,analyticsFrom:"block"})}else if("create-transclusion"===e.type){if(!E.scrollToBlockId)return;I.ry({environment:t,blocks:S.default.state.stores,copiedBlockIds:[E.scrollToBlockId]})}else if(r.isCollectionView()){const e=E.collectionViewId?y.Xr.createChildStore(r,{table:c.n,id:E.collectionViewId}):void 0;await Promise.all([r.load(),e?e.load():void 0]);const n=e?e.getCollectionStore():r.getCollectionViewCollectionStore();n&&(await n.load(),T.Y_({environment:t,store:_,collectionStore:n,collectionViewStore:e,transaction:i}))}else{const e=_.getParentBlockStore();if(e){const n=w.k({environment:t,parentBlock:e,targetStore:r,transaction:i});P.is({environment:t,blocks:[n],selection:b,transaction:i,replaceEmptyTextBlock:!0})}}o.default.afterNextFlush((()=>{R.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:b,transaction:e})}})}))}}});else if(e.type===i.Ti.bookmark||"teamsInvite"===E.name){const{performResult:e}=R.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;A.sO({environment:t,store:g,value:v,transaction:e});const r=M.j4({environment:t,type:i.Ti.bookmark,inMemoryRecordCache:_.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,m.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,m.RM)())||void 0===o?void 0:o.useCrdt())??!1}),a=P.is({environment:t,blocks:[r],selection:b,transaction:e,replaceEmptyTextBlock:!0});return x.FH({stores:[r],transaction:e,update:{bookmark_loading_ttl:Date.now()}}),a}});o.default.afterNextFlush((()=>{R.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:b,transaction:e})}})}));const n=e[0];"teamsInvite"===E.name?await C.K({environment:t,store:n,url:p,teamId:E.teamId}):await C.K({environment:t,store:n,url:p})}else if(e.type===i.Ti.drive){const{performResult:e}=R.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;A.sO({environment:t,store:g,value:v,transaction:e});const r=M.j4({environment:t,type:i.Ti.drive,inMemoryRecordCache:_.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,m.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,m.RM)())||void 0===o?void 0:o.useCrdt())??!1});return P.is({environment:t,blocks:[r],selection:b,transaction:e,replaceEmptyTextBlock:!0})}});o.default.afterNextFlush((()=>{R.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:b,transaction:e})}})}));const n=e[0];o.default.afterNextFlush((()=>{const e=h.R.find((e=>e.props.store===n));e&&e.initializeGoogleDriveBlockFromUrl(p)}))}else{const{performResult:n}=R.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;A.sO({environment:t,store:g,value:v,transaction:e});const r=M.j4({environment:t,type:i.Ti.copyIndicator,inMemoryRecordCache:_.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,m.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,m.RM)())||void 0===o?void 0:o.useCrdt())??!1});return P.is({environment:t,blocks:[r],selection:b,transaction:e,replaceEmptyTextBlock:!0})}});o.default.afterNextFlush((()=>{R.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:b,transaction:e})}})}));const r=n[0],s=n=>{R.createAndCommit({environment:t,userAction:"embedMenuActions.accept.insertExtractedData",perform:t=>{let o;e.type&&"mention-page"!==e.type&&"create-transclusion"!==e.type?o=e.type:(o=i.Ti.embed,n&&n.media&&("photo"===n.media.type?o=i.Ti.image:"video"===n.media.type&&(o=i.Ti.video))),D.vs({environment:e.environment,block:r,blockType:o,transaction:t})}}),o.default.afterNextFlush((()=>{const e=h.R.find((e=>e.props.store===r&&a.mf(e.embed)));e&&e.embed(B)}))};f.W4(t,B).then(s)}}F()}const F=function(){v.Z.setState({url:v.Z.getState().url,open:!1})}},4727:(e,t,n)=>{n.d(t,{RL:()=>g,_P:()=>f,jZ:()=>v,xv:()=>h});var o=n(70203),i=n(69783),r=n(68056),a=n(89224),s=n(64233),l=n(19111),c=n(10743),d=n(24666),u=n(50906),p=n(97444),m=n(39699);function f(e){const{environment:t,textStore:n,oldSelection:r,oldTextValue:d}=e,p=o.eeV(n.getValue()||[]),m=r.startIndex;if(":"!==p[m])return;const f=o.gPn(p,m-5,m).join("");if(/[0-9]$/.test(f[f.length-1]))return;if(f.endsWith("http")||f.endsWith("https"))return;if(f.endsWith(":"))return;if(c.Z.state.open||i.Z.state.open||l.Z.state.open||s.Z.state.open)return;if(t.device.isPhone)return;const g=a.get();if(!g)return;const h=a.getRect(g);h&&(i.Z.setState({open:!0,textStore:n,oldTextValue:d,oldSelection:r,selectionRect:h}),u.xud(t))}function g(e){const t=i.Z.state,{environment:n,emoji:o,transaction:r}=e;t.open&&(p.sO({environment:n,store:t.textStore,value:t.oldTextValue,transaction:r}),p.Q0({environment:n,store:t.textStore,selection:t.oldSelection,emoji:o,transaction:r}),h())}function h(){i.Z.setState({open:!1})}function v(e){p.N3({direction:"end"});const t=d.default.state;if("editing"!==t.mode)return;const n=(0,r.QY)(t.multiSelection);if(!n)return;let a=!1;if(n.selection.startIndex>0){const e=n.store.getValue()||[],t=o.eeV(e)[n.selection.startIndex-1];/[\s]/g.test(t)||(a=!0)}m.createAndCommit({userAction:"emojiMenuActions.triggerInsertEmojiMenu",environment:e,perform:t=>{a?(p.hJ({environment:e,store:n.store,string:" ",selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),p.hJ({environment:e,store:n.store,string:":",selection:{startIndex:n.selection.startIndex+1,endIndex:n.selection.endIndex+1},disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})):p.hJ({environment:e,store:n.store,string:":",selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})}});const s=i.Z.state;s.open&&i.Z.setState({...s,showPopupWithEmptyFilter:!0})}},36280:(e,t,n)=>{n.d(t,{Wj:()=>g,gt:()=>v,qn:()=>f});n(21703);var o=n(1302),i=n(70203),r=n(97880),a=n(83631),s=n(68056),l=n(89224),c=n(89086),d=n(66949),u=n(24666),p=n(97444),m=n(98104);function f(e){var t;const{environment:n,selectedToken:o,selectionRect:r,analyticsFrom:p}=e,f=l.get();if(!f)return;if("editing"!==u.default.state.mode)return;const g=null===(t=(0,s.QY)(u.default.state.multiSelection))||void 0===t?void 0:t.store;if(!g)return;const h=o||a.JT(u.default.state);h&&m.Z5({store:g,selection:h.position});const v=c.lV(u.default.state),b=h?i.o0h(h.token):a.Jf(v),y=a.by({environment:n,equation:b,displayMode:"inline"}),S=h?{editingToken:h.token}:{annotations:a.nk(u.default.state)};d.Z.setState({open:!0,value:b,error:y,savedTextSelectionState:u.default.state,savedTextSelectionRect:r||a.TJ({environment:n,selection:f}),...S,analyticsFrom:a.D9({source:p,currentEquationToken:Boolean(h),selectedText:v})}),u.default.setState({mode:"empty"})}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.P.Forward;d.Z.isOpen()&&(h({equationStore:d.Z,getNextSelection:t=>e===d.P.Forward?{startIndex:t.endIndex,endIndex:t.endIndex}:e===d.P.Backward?{startIndex:t.startIndex,endIndex:t.startIndex}:(0,r.t1)(e)}),d.Z.reset(),o.default.afterNextFlush((()=>{u.default.emit()})))}function h(e){const{equationStore:t,getNextSelection:n}=e;if(!t.isOpen())return;const{savedTextSelectionState:o}=t.state,i=(0,s.QY)(o.multiSelection);if(!i)return;const r=n(i.selection);if(m.Z5({store:i.store,selection:r}),"editing"!==u.default.state.mode)throw new Error("TextSelectionStore should have a selection after calling `setSelection`.");t.setState({...t.state,savedTextSelectionState:u.default.state})}function v(e){const{environment:t,equationStore:n,transaction:o}=e;n.isOpen()&&(n.state.error||n.state.editingToken&&i.o0h(n.state.editingToken)===n.state.value||(!function(e){const{environment:t,equationStore:n,transaction:o}=e;if(!n.isOpen())return;if(n.state.error)return;const{savedTextSelectionState:r}=n.state,{multiSelection:s}=r;let l;p.pz({environment:t,multiSelection:s,transaction:o}),n.state.value&&(l=a.qZ({equationState:n.state,isTemporary:!1}),p.mM({environment:t,store:s.start.store,index:s.start.index,tokens:[l],transaction:o})),h({equationStore:n,getNextSelection:e=>{const t=l?i.eeV([l]).length:0;return{startIndex:e.startIndex,endIndex:e.startIndex+t}}}),u.default.setState({mode:"empty"})}({environment:t,equationStore:d.Z,transaction:o}),h({equationStore:n,getNextSelection:e=>({startIndex:e.endIndex,endIndex:e.endIndex})}),a.ND({environment:t,equation:n.state.value,from:n.state.analyticsFrom})))}},57400:(e,t,n)=>{n.d(t,{BX:()=>f,Of:()=>g,Th:()=>p,Tm:()=>m,Yh:()=>u,mc:()=>v});var o=n(15157),i=n(12139),r=n(54642),a=n(47307),s=n(12955),l=n(64496),c=n(77080),d=n(7339);async function u(e){const t=await(0,s.getExperimentDeviceId)(e),n=e.currentUser.id;let i;const r=(0,l.qE)();if(i=(0,l._3)(e)&&r?(0,l.fP)(t,n,r):o.Z.get({userId:n,key:c.localExperimentsV2Key}),i){const e=i.deviceId!==t,o=i.userId!==n,r=Boolean(i.test);!e&&!o||r||(i=void 0,c.default.reset())}i?c.default.updateState(i,e):await p({environment:e,force:!1}),c.default.getState().isLoaded||c.default.updateState({experimentsBySpace:{},experimentsWithoutSpace:[],isLoaded:!0,userId:n,deviceId:t,test:!1},e),c.default.isStatsigEnabled()&&await d.C.initialize(e)}async function p(e){const{environment:t,force:n}=e;if((0,l._3)(t)&&!n){var o;if(null!==(o=t.mobileNative)&&void 0!==o&&o.api.getExperimentData){const e=await t.mobileNative.api.getExperimentData();e?c.default.updateState(e,t):b({message:"Attempt to get experiments from the mobile cache did not return a result."})}else b({message:"getExperimentData is not implemented in the react native API."})}else{const e=await h(t);"failed"!==e.type&&c.default.updateState(e.data,t)}}async function m(e){const t=await h(e);"failed"!==t.type&&o.Z.set({userId:t.data.userId,key:c.localExperimentsV2Key,value:t.data})}async function f(e,t,n){if(!c.default.state.isLoaded)return;const o=await(0,s.getExperimentDeviceId)(e),i=await r.updateExperimentOverride(e,{experimentId:t,experimentGroup:n,deviceId:o});"failed"!==i.type?await p({environment:e,force:!1}):a.showError(i)}async function g(e){if(!c.default.state.isLoaded)return;const t=await(0,s.getExperimentDeviceId)(e),n=await r.resetExperimentOverrides(e,{deviceId:t});"failed"!==n.type?(await p({environment:e,force:!1}),a.showMessage({message:"Successfully reset experiment overrides."})):a.showError(n)}async function h(e){const t=await(0,s.getExperimentDeviceId)(e),n=e.currentUser.id,o=await r.getClientExperimentsV2(e,{deviceId:t});return"failed"===o.type&&b(o,n,t),o}function v(){c.default.reset()}function b(e,t,n){i.rn(e,{from:"experimentActions",type:"ExperimentFetchError",data:{deviceId:n,userId:t}})}},42631:(e,t,n)=>{n.d(t,{hM:()=>D,$$:()=>R,cM:()=>B});n(21703);var o=n(77657),i=n(74181),r=n(149),a=n(99405),s=n(89101);const l={local:"http://localhost:3008",development:"https://integrations-api-dev.notion.com",staging:"https://integrations-api-stg.notion.com",production:"https://integrations-api.notion.com"};function c(e){return`${l[e]}/slack/install`}function d(e){return`${l[e]}/github/install`}var u=n(9852),p=n(94826),m=n(64002),f=n(5366),g=n(95477),h=n(91924),v=n(24608),b=n(77080),y=n(30874),S=n(92083),_=n(50906),w=n(54642),k=n(47307),I=n(47839),C=n(94273),x=n(15356),T=n(75018),M=n(97627),P=n(61202);const A=(0,f.defineMessages)({authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integration…"},titleMessage:{id:"externalIntegrationAuthActions.loginWithExternalIntegrationPopupModal.title",defaultMessage:"Authenticate"}});async function R(e){const{environment:t,integration:n,spaceId:o,from:i}=e,r=n.id,s=t.currentUser.id,l=(0,h.eC)(t);if(!s)throw new Error("No user id found");let c;_.IvM(t,{integrationId:r,from:i});const d=(0,p.I$)(r);if("dlp"===(null==d?void 0:d.type)){const e=await w.createOauthAuthorizationCode(t,{integrationId:r,spaceId:o});if("failed"===e.type)return k.showError(e),{error:`Unexpected error creating authorization code: ${(0,v.pO)(e)}`};c=e.data.code}await E({environment:t,notionAuthorizationCode:c,integration:n,spaceId:o,userId:s,authType:l,from:i,callbackRouteName:(null==d?void 0:d.id)===p.ZB.datadog.id?a.AY.datadogAuthCallback:a.AY.authCallback}),await P.pJ({environment:t}),"workspace_connections_redirect"===i&&S.Z.setState({open:!0,openedFrom:"workspace_connections_redirect",currentTab:"integrations",defaultSubtab:"workspace_connections",highlightedSetting:void 0})}async function D(e){const{environment:t,spaceId:n,integration:l,externalObjectInstanceBlockId:p,unfurlUrl:f,from:S}=e;u.setOauthAuthorizationParams(void 0);const R=l.id,D=R===o.nO?y.Z.completeSlackAuthentications.state:y.Z.externalAuthentications.state,B=new Set(D.filter((e=>{let{integration_id:t}=e;return t===R})).map((e=>e.parent_id)));R===o.f3&&M.pc(t);const F=(0,o.BP)({integrationId:R,env:"production"}),Z=(0,i.lT)(g.default.domainBaseUrl),L=l.redirect_uris.includes(Z)?Z:l.redirect_uris[0],j=await w.createOauthAuthorizationCode(t,{integrationId:R,spaceId:n,...F?{redirectUri:L}:{}});if("failed"===j.type)return k.showError(j),{error:`Unexpected error creating authorization code: ${(0,v.pO)(j)}`};const V=j.data.code,U=t.currentUser.id,O=(0,h.eC)(t),N=a.AY.authCallback;if(!U)return{error:"User must be signed in."};const z={environment:t,notionAuthorizationCode:V,integration:l,spaceId:n,externalObjectInstanceBlockId:p,unfurlUrl:f,authType:O,from:S,userId:U,callbackRouteName:N};(0,o.BP)({integrationId:R,env:"production"})?await async function(e){const{environment:t,redirectUri:n,notionAuthorizationCode:o,integration:i,spaceId:l,externalObjectInstanceBlockId:u,unfurlUrl:p,authType:f,userId:h}=e,v=await async function(e){const{integration:t}=e;if("external"===t.type&&void 0!==t.info.handled_by_integrations_server){if("github"===t.info.handled_by_integrations_server)return await async function(e){const{environment:t,notionAuthorizationCode:n,spaceId:o,authType:i}=e,r={notion_workspace_id:o,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:n,callback_type:i.callbackType,...i.redirectToAuth&&{redirectToAuth:"true"}},l=(0,m.bf)({url:d("production"),query:{...r}});if(t.device.isElectron)return void I.openExternalUrl(l);const c=await x.M(t,{width:610,height:700,url:l,titleMessage:A.titleMessage});if(!c)return;const u=(0,a.Wj)({url:c,isMobile:t.device.isMobile,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,protocol:g.default.protocol,currentUrl:window.location.href}),{url:p}=C.Vr(t);"externalAuthCallback"===u.name&&await T.handleFirstPartyExternalIntegrationAuthCallback({route:u,environment:t});T.navigate({url:p||s._j.root,environment:t})}(e),{value:{success:!0}};if("slack"===t.info.handled_by_integrations_server){return b.default.checkGate("link_preview_auth_with_server_integration")?(await async function(e){const{environment:t,userId:n,spaceId:o,authType:i,from:r,externalObjectInstanceBlockId:s,options:l}=e,d={notion_workspace_id:o,notion_user_id:n,notion_last_visited_url:window.location.href,auth_initiator:r,callback_type:i.callbackType,slack_workspace_id:null==l?void 0:l.slackWorkspaceId,external_object_instance_block_id:s,...i.redirectToAuth&&{redirectToAuth:"true"}},u=(0,m.bf)({url:c("production"),query:{...d}});if(t.mobileNative)return void t.mobileNative.openInAppBrowser(u);if(t.device.isElectron)return void I.openExternalUrl(u);const p=await x.M(t,{width:610,height:700,url:u,titleMessage:A.titleMessage});if(!p)return;const f=(0,a.Wj)({url:p,isMobile:t.device.isMobile,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,protocol:g.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===f.name&&await T.handleFirstPartyExternalIntegrationAuthCallback({route:f,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return"zendesk"===t.info.handled_by_integrations_server?(await async function(e){const{environment:t,notionAuthorizationCode:n,spaceId:o,authType:i,externalObjectInstanceBlockId:r}=e,l={notion_workspace_id:o,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:n,external_object_instance_block_id:r,callback_type:i.callbackType,integration_id:e.integration.id,...i.redirectToAuth&&{redirectToAuth:"true"}},c=(0,m.bf)({url:`${g.default.domainBaseUrl}/initiateExternalAuthentication`,query:{...l}});if(t.device.isElectron)return void I.openExternalUrl(c);const d=await x.M(t,{width:610,height:700,url:c,titleMessage:A.titleMessage});if(console.log(`The popup callback: ${d}`),!d)return;const u=(0,a.Wj)({url:d,isMobile:t.device.isMobile,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,protocol:g.default.protocol,currentUrl:window.location.href}),{url:p}=C.Vr(t);"externalAuthCallback"===u.name&&await T.handleFirstPartyExternalIntegrationAuthCallback({route:u,environment:t});T.navigate({url:p||s._j.root,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return{error:{success:!1}}}(e);if(r.x.isSuccess(v))return;const y={externalObjectInstanceBlockId:u,spaceId:l,userId:h,callbackType:f.callbackType,...f.redirectToAuth&&{redirectToAuth:"true"}},S={code:o,notion_state:JSON.stringify(y),integration_id:i.id,external_url:p,redirect_uri:n},_=(0,m.bf)({url:n,query:{...S}});if(t.device.isElectron)return void I.openExternalUrl(_);const w=await x.M(t,{width:610,height:700,url:_,titleMessage:A.titleMessage});if(!w)return;const k=(0,a.Wj)({url:w,isMobile:t.device.isMobile,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,protocol:g.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===k.name&&await T.handleFirstPartyExternalIntegrationAuthCallback({route:k,environment:t})}({...z,integration:l,notionAuthorizationCode:V,redirectUri:L}):await E(z),_.IvM(t,{integrationId:l.id,numberOfAccountsAlreadyConnected:B.size,from:S}),await P.pJ({environment:t});return{value:{externalAuthentication:y.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===R})).find((e=>!B.has(e.parent_id)))}}}function B(e){const{environment:t,notion_workspace_id:n,notion_user_id:o,notion_last_visited_url:i,notion_authorization_code:r,external_object_instance_block_id:a,callback_type:s,redirectToAuth:c,zendeskSubDomain:d}=e,u={notion_workspace_id:n,notion_user_id:o,notion_last_visited_url:i,notion_authorization_code:r,external_object_instance_block_id:a,callback_type:s,zendeskSubDomain:d,...c&&{redirectToAuth:"true"}},p=(0,m.bf)({url:(f="production",`${l[f]}/zendesk/install`),query:{...u}});var f;t.device.isElectron?I.openExternalUrl(p):window.location.href=p}async function E(e){const{environment:t,notionAuthorizationCode:n,integration:o,spaceId:i,userId:r,authType:l,externalObjectInstanceBlockId:c,from:d,callbackRouteName:u}=e,p=o.id,f={notionAuthorizationCode:n,userId:r,spaceId:i,integrationId:p,externalObjectInstanceBlockId:c,callbackType:l.callbackType,...l.redirectToAuth&&{redirectToAuth:"true"}};let v=(0,m.bf)({url:`${g.default.domainBaseUrl}${s._j.externalIntegrationPopupRedirect}`,query:{...f}});if(v=l.redirectToAuth?v:await(0,h.HU)(t,v),t.device.isElectron)return void I.openExternalUrl(v);const b=await x.M(t,{width:610,height:700,url:v,titleMessage:A.titleMessage});if(!b)return;const y=(0,a.Wj)({url:b,isMobile:t.device.isMobile,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,protocol:g.default.protocol,currentUrl:window.location.href});y.name===u&&await T.handleThirdPartyExternalIntegrationAuthCallback({route:y,environment:t,integrationId:p,from:d})}},62365:(e,t,n)=>{n.d(t,{c:()=>d,v:()=>u});var o=n(70203),i=n(64002),r=n(27411),a=n(27153),s=n(9953),l=n(39699),c=n(53471);function d(e){const{store:t,file:n,environment:o}=e,i=r.default.getBlockKey(t.id);a.Z(),c.cT({environment:o,file:n,bucket:"secure",record:t.pointer,onStart:e=>{r.default.setKeyState(i,{progressPercent:0,file:n,name:e.name,size:e.size})},onProgress:e=>{const t=r.default.getKeyState(i);t&&r.default.setKeyState(i,{...t,progressPercent:e.progressPercent})},onComplete:e=>{const n=r.default.getKeyState(i);n&&l.createAndCommit({userAction:"fileBlockActions.uploadFile",environment:o,perform:o=>{u({store:t,source:e,name:n.name,size:n.size,transaction:o}),r.default.setKeyState(i,void 0)}})},onError:()=>{r.default.setKeyState(i,void 0)},retryWhenOffline:!0})}const u=function(e){const{store:t,source:n,name:r,size:a,transaction:l}=e;let c;r?c=r:n&&(c=(0,i.je)(n)),s.sW({store:t.getPropertiesStore(),data:{source:o.TPx(n),title:o.TPx(c),size:o.TPx(a)},transaction:l})}},3297:(e,t,n)=>{n.d(t,{DK:()=>B,OH:()=>E,S:()=>R,VE:()=>F,nM:()=>Z,qd:()=>L,sC:()=>A});var o=n(15145),i=n(42875),r=n(15157),a=n(72126),s=n(29477),l=n(89101),c=n(97880),d=n(5366),u=n(35683),p=n(95477),m=n(24215),f=n(28020),g=n(84210),h=n(33929),v=n(80444),b=n(89256),y=n(50906),S=n(48299),_=n(47307),w=n(54532),k=n(92625),I=n(11302),C=n(19785),x=n(75018),T=n(28014),M=n(39699);const P="forkPageTemplate";function A(){b.Z.setState({open:!1})}async function R(e){const{environment:t,store:n,originRect:i}=e;y.ZzP(t,n.id);const{RouterStore:r}=t,a=r.state.route;if("page"===a.name&&a.requestedOnPublicDomain){const e=(0,g.ZP)({store:n,fullyQualified:!1,duplicate:!0,pageVisitSource:o.tY.Duplicate});return void x.navigateOnBaseUrl({environment:t,url:e,extraSearchParams:{...await x.generatePartnerStackPathParam(t),utm_source:"public_page",utm_content:"duplicate_button",tid:await(0,m.cG)(t),from:"public_page",n:"duplicate_public_page"}})}const{currentUserRootStore:s}=v.default.state;if(s){const e=f.o(s);if(1===e.length){const o=e[0],i=o.getSpaceStore();if(!i)return;B({environment:t,store:n,spaceStore:i,spaceViewStore:o,isPrivate:!0,context:"public_page_duplicate_single_workspace"})}else b.Z.setState({open:!0,store:n,originRect:i})}else Z({currentUserId:t.currentUser.id,blockId:n.id}),x.navigate({environment:t,url:l._j.login})}const D=(0,d.defineMessages)({untitledBlockRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledBlockRecordTitle"},untitledSpaceRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledSpaceRecordTitle"},loadingStateDisplayText:{defaultMessage:"Duplicating {blockTitle} to {spaceTitle}…",id:"forkPageActions.loadingStateDisplayText"}});async function B(e){var t,n;const{environment:r,store:a,spaceStore:l,context:c}=e,d=h.default.getIntl(),p=null===(t=a.getModel())||void 0===t?void 0:t.getRenderTitleWithEmoji({getRecordModel:a.getRecordModel,userTimeZone:(0,i.r)(),placeholder:d.formatMessage(D.untitledBlockRecordTitle),intl:d});if(void 0===p)return;const m=null===(n=l.getModel())||void 0===n?void 0:n.getRenderTitleWithEmoji({placeholder:d.formatMessage(D.untitledSpaceRecordTitle)});if(void 0===m)return;k.j({message:D.loadingStateDisplayText,interpolatedValues:{blockTitle:p,spaceTitle:m}});const f=Date.now();let g;const[v]=await Promise.all([E(e).then((e=>(g=Date.now()-f,e))),(0,s.Vs)(750)]);k.x();const b=Date.now()-f;"public_page_duplicate_multiple_workspace"!==c&&"public_page_duplicate_single_workspace"!==c&&"signin_after_duplicate"!==c||y.XyT(r,{from:"publicPage",success:!v.error,template_name:p,template_block_id:a.id,target_space_id:l.id,context:c,template_duplication_duration_ms:g,template_duplication_duration_with_minimum_ms:b}),void 0!==v.error?_.showErrorMessage(v.error):x.navigateToBlock({environment:r,store:v.value,visitType:u.vu.Link,pageVisitSource:o.tY.Duplicate})}async function E(e){const{environment:t,store:n,spaceStore:o,spaceViewStore:i,isPrivate:r,duplicateOnlyCollectionSchema:a}=e;return new Promise((e=>{M.createAndCommit({userAction:"forkPageActions.forkPage",environment:t,perform:s=>{const[l,c]=w.Qi({environment:t,stores:[n],transaction:s,addCopyName:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:o.id,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:!1,duplicateOnlyCollectionSchema:a}),d=l[0];c.then((t=>{e(t?{error:t}:{value:d})})),T.Hj({environment:t,spaceStore:o,spaceViewStore:i,pageStore:d,isPrivate:r,location:{type:"prepend"},transaction:s})}})}))}async function F(e){const{environment:t,store:n,duplicateOnlyCollectionSchema:i}=e,r=v.default.state.currentSpaceStore,s=v.default.state.currentSpaceViewStore,l=v.default.state.mainEditorCurrentBlockStore;if(!r||!s||!l)return;const d=await S.NN({environment:t,block:n,action:"duplicate"});if("user_canceled"===d)return;const m=await new Promise((o=>{M.createAndCommit({userAction:"forkPageActions.duplicateTo",environment:t,perform:l=>{const[u,m]=w.Qi({environment:t,stores:d,transaction:l,addCopyName:!0,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:r.id,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:"block"===e.newParent.table&&e.newParent.useCrdt(),duplicateOnlyCollectionSchema:i});m.then((e=>{o(e?{error:e}:{value:u})}));const f={type:"append",after:n.id},g=a.d9(u).reverse();if("team"===e.newParent.table)I.at({transaction:l,currentSpaceViewStore:s,teamStore:e.newParent,targets:u,environment:t,location:f,action:"move",value:{type:"team",id:e.newParent.id,spaceId:r.id}});else if("block"===e.newParent.table)for(const t of g)C.jG({parentStore:e.newParent,childStore:t,transaction:l,after:f.after});else if("space"===e.newParent.table)for(const e of g)T.Hj({environment:t,spaceStore:r,spaceViewStore:s,pageStore:e,isPrivate:!0,location:f,transaction:l});else(0,c.t1)(e.newParent);return u}})}));void 0!==m.error?_.showErrorMessage(m.error):x.navigateToBlock({environment:t,store:m.value[0],visitType:u.vu.Link,pageVisitSource:o.tY.Duplicate})}function Z(e){let{currentUserId:t,blockId:n}=e;r.Z.set({userId:t,key:P,value:n})}function L(e){return r.Z.get({userId:e,key:P})}},96802:(e,t,n)=>{n.d(t,{FH:()=>m,MF:()=>y,Mp:()=>S,Wq:()=>f,bf:()=>_,fs:()=>h,hc:()=>g,is:()=>b,zM:()=>v});var o=n(41432),i=n(43593),r=n(15157),a=n(72126),s=n(63143),l=n(95477),c=n(24990),d=n(35661),u=n(41433),p=n(9953);function m(e){const{stores:t,update:n,transaction:i}=e;for(const a of t)p.sW({store:a.getFormatStore(),data:(0,s.Q2)(n),transaction:i}),a instanceof d.G&&a.getType()===o.Ti.callout&&n.block_color&&r.Z.set({userId:a.environment.currentUser.id,key:u.Ns,value:n.block_color})}function f(e){const{environment:t,store:n,isLocked:o,transaction:i}=e,{id:r}=t.currentUser;if(!r)return;const a={block_locked:o,block_locked_by:r};p.sW({store:n.getFormatStore(),data:a,transaction:i})}function g(e){const{environment:t,store:n,alignment:o,transaction:i}=e,{id:r}=t.currentUser;if(!r)return;const a={block_alignment:o};p.sW({store:n.getFormatStore(),data:a,transaction:i})}function h(e){const{store:t,url:n,position:o,transaction:r}=e,a=(0,i.Wv)(n,l.default.secureFileS3.url,l.default.secureFileS3V2.url,l.default.secureFileConfig.rootPath,l.default.secureFileConfig.hostname),s=a?a.link:n;m({stores:[t],update:{page_cover_position:o},transaction:r});const c=t.getCoverStore();c&&p.sO({store:c,value:s,transaction:r})}function v(){const e=a.UP(["Activities","Objects","Travel & Places"]),t=c.Z.state.emojiByCategory[e];return a.UP(t)}function b(e){const{store:t,transaction:n}=e,o=t.getIconStore();if(o){if(!o.getValue()){const e=v();p.sO({store:o,value:e,transaction:n})}}}function y(e){const{store:t,transaction:n}=e,o=t.getCoverStore();o&&p.sO({store:o,value:null,transaction:n})}function S(e){const{store:t,coverPosition:n,transaction:o}=e;if(t.isCollectionView()){const e=t.getCollectionViewCollectionStore();if(e)return void p.sW({store:e.getFormatStore(),data:{collection_cover_position:n},transaction:o})}m({stores:[t],update:{page_cover_position:n},transaction:o})}function _(e){const{store:t,coverPosition:n,transaction:o}=e;m({stores:[t],update:{card_cover_position:n},transaction:o})}},47678:(e,t,n)=>{n.d(t,{Y:()=>u});var o=n(72126),i=n(45010),r=n(80444),a=n(24612),s=n(27724),l=n(77503),c=n(54564),d=n(42858);function u(e){const{RouterStore:t}=e,{PageScroller:n}=i.Z;if("page"===t.state.route.name&&r.default.state.currentLoadingContainerStore&&r.default.state.currentLoadingContainerStore.state.ready)if(a.Z.reset(),l.Z.reset(),t.state.route.scrollToBlockId){const n=[t.state.route.scrollToBlockId];d.WG(e,n);const o=s.default.state.stores[0];o&&t.state.route.discussionId&&c.Ib({environment:e,blockStore:o,discussionIds:[t.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1})}else t.state.route.discussionId&&r.default.state.mainEditorCurrentBlockStore?c.Ib({environment:e,blockStore:r.default.state.mainEditorCurrentBlockStore,discussionIds:[t.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):"pop"===t.state.action&&t.state.historyState&&(n&&o.hj(t.state.historyState.scrollTop)&&n.scrollTo(t.state.historyState.scrollTop,void 0),t.state.historyState.blockIds&&d.DQ(e,t.state.historyState.blockIds))}},54604:(e,t,n)=>{n.d(t,{ui:()=>a,xv:()=>s,zp:()=>l});var o=n(50906),i=n(17903),r=n(38302);function a(e){const{environment:t,renderFullScreenNode:n,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c}=e;o.Lfx(t,{type:"open"}),r.Z.setState({...r.Z.state,isOpen:!0,fullscreenNodeAnimationComplete:!1,backgroundAnimationComplete:!1,renderFullScreenNode:n,startScrollTop:i.Z.state.scrollTop,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c})}function s(){r.Z.setState({...r.Z.state,isOpen:!1})}function l(e){return e<1020?0:32}},58188:(e,t,n)=>{n.d(t,{N:()=>m,Rt:()=>f,aG:()=>p,rg:()=>u});var o=n(39699),i=n(95697),r=n(77907),a=n(30806),s=n(80444),l=n(28209),c=n(54642),d=n(72711);async function u(e){const{environment:t,spaceId:n}=e;if(!(0,i.QI)())return;const o=await c.getUserHomePages(t,{spaceId:n});"success"===o.type&&l.Z.setState({userHomePageId:o.data.homePageId,personalHomePageId:o.data.personalHomePageId})}function p(e){const{environment:t,currentSpaceViewStore:n,...i}=e,r=n.getModel();if(!r)return;const s=!r.showFeatureOnPersonalHome(e.feature);o.createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,perform:t=>{o.applyOperation({store:n,operation:{pointer:n.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:s}},transaction:t})}}),(0,a.cY)({environment:t,show:s,...i})}function m(e){let{environment:t,option:n,from:i,userAction:r}=e;const l=s.default.state.currentSpaceViewStore;if(!l)return!1;const c=l.getOnAppStartStore().getValue();return o.createAndCommit({userAction:r,environment:t,perform:e=>{o.applyOperation({store:l,operation:{pointer:l.pointer,path:["settings","on_app_start"],command:"set",args:n},transaction:e})}}),(0,a.BX)({environment:t,oldValue:c,newValue:n,from:i}),!0}async function f(e){const{environment:t,personalHomeStore:n}=e,i=null==n?void 0:n.getCoverStore();if(!n||!i||i.getValue())return;const a=(await r.deps.pageCovers.loader()).default;o.createAndCommit({userAction:"userHomeActions.addCoverPhoto",environment:t,perform:e=>{d.tk({transaction:e,store:n,coverStore:i,pageCovers:a})}})}},44886:(e,t,n)=>{n.d(t,{A1:()=>v,WY:()=>g,dD:()=>m,gq:()=>S,nt:()=>y,rB:()=>h,uv:()=>f,vi:()=>b});n(57658);var o=n(41432),i=n(72126),r=n(28020),a=n(73959),s=n(35328),l=n(94841),c=n(95802),d=n(26664),u=n(45131),p=n(94419);function m(e){const{parentStore:t,block:n,type:o,transaction:i}=e,r=t.getTransclusionReferenceTargetStore()??t,a=r.getContentStores(),l=a.indexOf(n);if(l<=0)return;const c=a[l-1];if(!c)return;if(!_(r)||!_(c))return;p.Od({parent:r.getContentStore(),childToRemove:n,transaction:i});const{child:d}=p.R3({parent:c.getContentStore(),append:n,transaction:i});if("self"===o&&!d.isType("table"))for(const s of d.getContentStores().reverse())p.Od({parent:d.getContentStore(),childToRemove:s,transaction:i}),p.BE({parent:c.getContentStore(),insert:s,after:d,transaction:i});return s.BX(c)&&u.Z.setOpen(c.id,!0),d}function f(e){const{grandparentStore:t,parentStore:n,block:o,transaction:i}=e,r=t.getTransclusionReferenceTargetStore()??t;if(r.getContentStores().indexOf(n)<0)return;const a=n.getContentStores(),s=a.indexOf(o);if(s<0)return;if(!_(r)||!_(n))return;if("transclusion_container"===n.getType()||"transclusion_reference"===n.getType())return;if(_(o))for(let c=s+1;c<a.length;c++){const e=a[c];p.Od({parent:n.getContentStore(),childToRemove:e,transaction:i}),p.R3({parent:o.getContentStore(),append:e,transaction:i})}p.Od({parent:n.getContentStore(),childToRemove:o,transaction:i});const{child:l}=p.BE({parent:r.getContentStore(),insert:o,after:n,transaction:i});return l}function g(e){const{transaction:t}=e,n=e.blocks,o=n[0];if(!o)return;const i=w(o);if(!i)return;const{previousChildStore:r}=i,a=r.getContentStore();return s.BX(r)&&u.Z.setOpen(r.id,!0),n.map((e=>{const n=e.getRecordStoreUIParent();null!=n&&n.valueIs(d.i)&&p.Od({parent:n,childToRemove:e,transaction:t});return p.R3({parent:a,append:e,transaction:t}).child}))}function h(e){const{transaction:t}=e;let n=e.blocks;const o=n[0];if(!o)return;const r=k(o);if(!r)return;const{closestParentStore:a,closestParentParentStore:s}=r,l=a.getContentStores(),c=s.getContentStore();if(l){let e;for(const[t,o]of l.entries())if(o.id===n[n.length-1].id){e=l.splice(t+1);break}n=i.d9(n).reverse(),n=n.map(((n,o)=>{const i=n.getRecordStoreUIParent();null!=i&&i.valueIs(d.i)&&p.Od({parent:i,childToRemove:n,transaction:t});const r=p.BE({parent:c,insert:n,after:a,transaction:t});if(0===o&&e&&_(n))for(const a of e){const e=a.getRecordStoreUIParent();null!=e&&e.valueIs(d.i)&&p.Od({parent:e,childToRemove:a,transaction:t}),p.BE({parent:n.getContentStore(),insert:a,transaction:t})}return r.child}))}return n}function v(e){const{transaction:t,blocks:n}=e,o=n[0];if(!o)return;const a=r.RM();if(!a)return;const s=C(a),l=i.cx(s,(e=>e.parent===o.getRecordStoreUIParent()&&e.after===o)),c=i.qr(s,((e,t)=>t<l&&e.parent===o.getRecordStoreUIParent())),d=i.dF(s,((e,t)=>t<c&&!o.uiContains(e.parent)));return d?T({blocks:n,listPosition:d,transaction:t}):void 0}function b(e){const{transaction:t,blocks:n}=e,o=i.Z$(n);if(!o)return;const a=r.RM();if(!a)return;const s=C(a),l=i.cx(s,(e=>e.parent===o.getRecordStoreUIParent()&&e.after===o)),c=s.find(((e,t)=>t>l&&!o.uiContains(e.parent)));return c?T({blocks:n,listPosition:c,transaction:t}):void 0}function y(e){return Boolean(e&&w(e))}function S(e){return Boolean(e&&k(e))}function _(e){const t=r.np(),n=e.getType(),i=e.getFormat(),a="page"===n&&(0,l.q0)();return n&&((0,o.TT)(n,i)||e===t||a)}function w(e){const t=(0,a.sQ)(e);if(null==t||!t.isDefined()||!_(t))return;const n=t.getContentStores(),o=n[n.indexOf(e)-1];return null!=o&&o.isDefined()&&_(o)?{previousChildStore:o}:void 0}function k(e){const t=(0,a.sQ)(e);if(!t)return;if(!t.isDefined()||!_(t))return;const n=(0,a.sQ)(t);return n&&n.isDefined()&&_(n)?{closestParentStore:t,closestParentParentStore:n}:void 0}function I(e,t){let n=[];const{store:o}=e.props;if(e.props.canDropAbove&&x(o)){const e=o.getRecordStoreUIParent();null!=e&&e.valueIs(d.i)&&n.push({parent:e})}const r=t.filter((t=>t.getContextClosestSelectable()===e));for(const a of r)n=i.G0(n,I(a,t));if(e.props.canDropBelow&&x(o)){const e=o.getRecordStoreUIParent();null!=e&&e.valueIs(d.i)&&(e.id===o.id?n.push({parent:e}):n.push({parent:e,after:o}))}return n}function C(e){let t=[];const n=c.C.getMembersByDOMOrder({filter:()=>!0}),o=e.getContentStores();for(const r of o){const e=n.find((e=>e.props.store===r));e&&(t=i.G0(t,I(e,n)))}return t}function x(e){return"collection"!==e.getParentTable()}function T(e){const{blocks:t,listPosition:n,transaction:o}=e,r=i.d9(t).reverse();for(const i of t){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(d.i)&&p.Od({parent:e,childToRemove:i,transaction:o})}let a;return a=n.after?r.map((e=>p.BE({insert:e,after:n.after,parent:n.parent,transaction:o}).child)):r.map((e=>p.Ce({prepend:e,parent:n.parent,transaction:o}).child)),a}},88295:(e,t,n)=>{n.d(t,{Hk:()=>M,c_:()=>C,f8:()=>I,gt:()=>T,lP:()=>x});var o=n(41432),i=n(21202),r=n(97880),a=n(82798),s=n(19785),l=n(68422),c=n(28020),d=n(98165),u=n(67669),p=n(80444),m=n(83212),f=n(35661),g=n(50906),h=n(49865),v=n(98834),b=n(94419),y=n(60870),S=n(11302),_=n(19358),w=n(9953),k=n(39699);function I(e){const{environment:t,transaction:n,titleText:o,recordStoreParent:r}=e,{databaseTemplate:s,createInValue:l}=function(e,t){let n;if("page"===e.type){const o=f.G.createChildStore(t,{table:i.iU,id:e.id});if(o.isTemplate()){const t=(0,d.Dg)(o,1);t&&(n=o,e={type:"page",id:t.id})}}return{databaseTemplate:n,createInValue:e}}(e.createInValue,r),c="block"===l.type?f.G.createChildStore(r,{table:i.iU,id:l.id}):void 0,u=w.j4({transaction:n,environment:t,type:"page",inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,properties:o?{title:[[o]]}:void 0,spaceId:r.pointer.spaceId,useCrdt:"block"===l.type&&(0,a.TO)(c).useCrdt()});let p;switch(l.type){case"block":_.YM({transaction:n,childStore:u,parentStore:(0,a.TO)(c),alive:!0});break;default:p=S.Ws({transaction:n,environment:t,targets:[u],value:l})}return{environment:t,databaseTemplate:s,createdPages:[u],moveToStorePromise:p}}async function C(e){const{environment:t,createdPages:n,databaseTemplate:o,moveToStorePromise:r}=e.createInState;let a;(null==n?void 0:n.length)>0&&(a=n[0].id),g.W2j(t,{type:"page",from:e.analyticsFrom,new_page_id:a});const{currentSpaceStore:s}=p.default.state;if(o)k.createAndCommit({userAction:"inlinePageActions.completeCreateIn",environment:t,perform:e=>{n.forEach((n=>v.ob({title:{text:n.getTitleValue()},environment:t,store:n,templateStore:o,isKeyboard:!1,isCreateIn:!0,transaction:e,from:"inline_page_action"})))}}),s&&await y.j2(s,s.id,o.id);else{const e=await r;s&&e&&e.table===i.iU&&await y.j2(s,s.id,e.id)}}function x(e){const{environment:t,transaction:n,parentStore:a,inlinePageIds:l}=e;if(0===l.length)return;const c=f.G.createChildStore(a,a.pointer),p=(0,d.qA)(c).find((e=>{if(e.table!==i.iU)return!1;const t=e.getType(),n=e.getFormat();return!(!t||!n)&&((0,o.Um)(t,n)||(0,o.S9)(t))})),g=p&&p.isCollectionView()?p.getCollectionViewCollectionStore():p,v=g&&m.Z.getMode(t,g);if(!g||(0,u.YF)(v)||!g.canEdit()){for(const e of l)s.nO({pageStore:f.G.createChildStore(a,{table:i.iU,id:e}),transaction:n});return}let y=a;for(const o of l){const e=f.G.createChildStore(a,{table:i.iU,id:o});if(e.isEmptyPage()){s.nO({pageStore:e,transaction:n});continue}const l=!e.isDefined()||Boolean(e.getAlive());_.YM({parentStore:g,childStore:e,transaction:n,alive:l}),"block"!==g.table?"collection"!==g.table?(0,r.t1)(g):h.mp({environment:t,store:e,collectionStore:g,coerce:!0,groupsPointer:[],transaction:n}):(b.BE({parent:g.getContentStore(),after:y,insert:e,transaction:n}),y=e)}}function T(e){const t=c.np();if(t){if(e&&e.table===i.iU)return{pageStore:(0,d.Dg)(e,0)||t,createInValue:{type:"block",id:e.id}};if(e&&(0,d.n3)(e)){const t=(0,d.Dg)(e,0);if(t)return{pageStore:t,createInValue:{type:"page",id:t.id}}}return{pageStore:t,createInValue:{type:"page",id:t.id}}}}async function M(e,t){const{createInValue:n,blocksToTransform:o}=t,r="page"===n.type?new f.G(e,{table:i.iU,id:n.id}):void 0,a=Boolean(r&&r.isTemplate()),{performResult:{transformedPages:s,pageStore:c}}=await k.createAndCommitAsync({environment:e,userAction:"inlinePageActions.createNewPageIn",waitForServerCommit:!0,perform:async t=>{const s=o.map((n=>l.vs({environment:e,block:n,blockType:"page",transaction:t})));let c;if("page"===n.type)if(r&&a){const n=r.getParentCollectionStore(),o=null==n?void 0:n.getParentPointer();o&&o.table===i.iU&&(c=await S.Y({transaction:t,environment:e,targets:s,value:{type:"page",id:o.id}}))}else{const{mainEditorCurrentBlockStore:o}=p.default.state;o&&o.id!==n.id&&(c=await S.Y({transaction:t,environment:e,targets:s,value:n}))}else"team"===n.type&&await S.Ws({transaction:t,environment:e,targets:s,value:n});return{transformedPages:s,pageStore:c}}});await C({analyticsFrom:"new_page_in",createInState:{environment:e,createdPages:s,databaseTemplate:a?r:void 0,moveToStorePromise:Promise.resolve(c)}})}},96313:(e,t,n)=>{n.d(t,{QZ:()=>D,az:()=>E,pg:()=>B});var o=n(26263),i=n(14577),r=n(41432),a=n(59753),s=n(99405),l=n(21202),c=n(33709),d=n(23867),u=n(70203),p=n(97880),m=n(9953),f=n(24677),g=n(98104),h=n(95477),v=n(69783),b=n(65598),y=n(89224),S=n(70726),_=n(64233),w=n(48863),k=n(19111),I=n(35661),C=n(10743),x=n(52229),T=n(50906),M=n(94419),P=n(4408),A=n(97444),R=n(39699);function D(e){const{environment:t,textStore:n,blockStore:r,url:a,oldTextValue:u,urlSelection:p}=e;if(C.Z.state.open||v.Z.state.open||k.Z.state.open||_.Z.state.open)return!1;const m=y.get();if(!m)return!1;const f=y.getRect(m);if(!f)return!1;const g=(0,s.Wj)({url:a,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,isMobile:t.device.isMobile,protocol:h.default.protocol,currentUrl:window.location.href});if("page"===g.name&&!!g.discussionId&&g.discussionId){const e=g.discussionId,s=g.blockId,m=r.getParentBlockStore();if(!m)return!1;const h=(0,I.Kv)(m,{table:l.iU,id:s,spaceId:(0,d.C)(m.pointer.spaceId)}),v=(0,I.Kv)(h,{table:c.qF,id:e,spaceId:(0,d.C)(r.pointer.spaceId)});if("none"===v.getRole())return!1;const y=new i.Z((()=>b.D4(v)[0]),{debugName:"firstCommentStore"}),_=new o.Z({name:"internalUnfurlingMenuActions.activate",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(_);const k=r.clone(_),C=n.clone(_),x=m.clone(_);return w.Z.setState({args:{commentStore:y},stores:{blockStore:r,textStore:n,parentStore:m},temporaryStores:{blockStore:k,textStore:C,parentStore:x},temporaryRecordCache:_,focusedIndex:S.Z.Preview,selectionRect:f,oldTextValue:u,open:!0,url:a,urlSelection:p}),T.elP(t,{url:a}),!0}return!1}function B(e){const{actionType:t,environment:n,commentStore:o,useTempStores:i}=e,r=w.Z.state;if(!r.open)return;const{oldTextValue:s}=r,l=i?r.temporaryStores:r.stores,{textStore:c,blockStore:m,parentStore:h}=l,v=n.currentUser.id;if(v){if(i){r.temporaryRecordCache.clearCache();for(const e in r.temporaryStores){const t=r.temporaryStores[e],o={userId:v,pointer:t.pointer},i=n.defaultRecordCache.inMemoryRecordCache.getRecord(o);i?P.Wl({environment:n,inMemoryRecordCache:r.temporaryRecordCache,pointer:t.pointer,model:a.kk.fromValue(t.pointer.table,i.value),role:i.role,updatePaths:[[]],userId:v,force:!0,debugSource:"setUnfurlType"}):P.uo({environment:n,inMemoryRecordCache:r.temporaryRecordCache,persistedRecordCache:void 0,pointer:t.pointer,userId:v})}}else n.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(r.temporaryRecordCache);switch(t){case S.Z.Link:f.eP({environment:n,store:r.stores.blockStore}),g.Z5({store:r.stores.textStore,selection:{startIndex:r.urlSelection.endIndex,endIndex:r.urlSelection.endIndex}}),w.Z.setState({...r,focusedIndex:S.Z.Link});break;case S.Z.Mention:if(!o)return;const e=(0,d.C)(c.pointer.spaceId);if(!e)return;const i=o.id;R.createAndCommit({environment:n,userAction:"internalUnfurlingMenuActions.mention",perform:t=>{A.sO({environment:n,store:c,value:s,transaction:t}),A.lZ({environment:n,store:c,selection:{startIndex:r.urlSelection.startIndex,endIndex:r.urlSelection.startIndex},annotation:u.mfJ(i,e),transaction:t,analyticsFrom:"block"})}}),w.Z.setState({...r,focusedIndex:S.Z.Mention});break;case S.Z.Preview:if(!o)return;R.createAndCommit({environment:n,userAction:"internalUnfurlingMenuActions.preview",perform:e=>{A.sO({environment:n,store:c,value:s,transaction:e});const t=b.GP(o);if(!t)return;if(!b.HK(t)||!h||!t.getParentId())return;const i=x.k({environment:n,parentBlock:h,targetStore:o,transaction:e});if(M.BE({parent:h.getContentStore(),insert:i,after:m,transaction:e}),0===u.QaF(r.oldTextValue).trim().length){const t=I.G.createChildStore(h.getContentStore(),r.stores.blockStore.pointer);M.Od({parent:h.getContentStore(),childToRemove:t,transaction:e})}}}),w.Z.setState({...r,focusedIndex:S.Z.Preview});break;default:throw(0,p.t1)(t)}i||w.Z.setState({open:!1})}}function E(e){var t,n;const{block:o,transaction:i}=e,a=o.getType(),s=o.getFormat(),l=o.getSpaceId();if(!o.isDefined()||a!==r.Ti.alias||null==s||null===(t=s.alias_pointer)||void 0===t||!t.id)return;const c=[u.YCD(u.mfJ(null==s||null===(n=s.alias_pointer)||void 0===n?void 0:n.id,l))];m.sO({store:o,value:{type:r.Ti.text,properties:{title:c},format:null},transaction:i})}},62134:(e,t,n)=>{n.d(t,{B4:()=>d,Fe:()=>a,Zm:()=>l,dJ:()=>r,fg:()=>c,ys:()=>s});n(57658);var o=n(72126);function i(e,t){return e.KeyboardShortcutStackStore.state.stack.some((e=>t===e.listener))}function r(e,t,n){const{stack:o}=e.KeyboardShortcutStackStore.state;for(let i=o.length-1;i>=0;i--){const e=o[i],r=e.shortcuts[n];if(e.enable&&r)return void r(t)}}function a(e){const{environment:t,stackItem:n}=e,r=t.KeyboardShortcutStackStore;if(i(t,n.listener)){const e=r.state.stack.map((e=>e.listener===n.listener?n:e));r.setState({...r.state,stack:e})}else r.state.stack.push(n),r.setState({stack:o.MR(r.state.stack,(e=>e.priority))})}function s(e,t){if(i(e,t)){const n=e.KeyboardShortcutStackStore,i=n.state.stack,r=o.d1(i,(e=>t===e.listener));n.setState({...n.state,stack:r})}}function l(e,t){r(e,t,t.type)}function c(e){return{command:e.device.isMac?"⌘":"ctrl",enter:"↵",delete:"del",backspace:"del",esc:"escape",left:"←",right:"→",up:"↑",down:"↓",tab:"⇥",alt:e.device.isMac?"⌥":"alt"}}function d(e){return{command:e.device.isMac?"command":"control",esc:"escape"}}},94273:(e,t,n)=>{n.d(t,{Bk:()=>p,Ie:()=>f,Vr:()=>m,nr:()=>g,vq:()=>h});var o=n(15145),i=n(99405),r=n(21202),a=n(54153),s=n(95477),l=n(84210),c=n(35661);const d="lastVisitedRoute",u="lastVisitedRouteUserId";function p(e,t){const n=i.Wj({url:window.location.href,isMobile:e.device.isMobile,baseUrl:s.default.domainBaseUrl,publicDomainName:s.default.publicDomainName,protocol:s.default.protocol,currentUrl:window.location.href}),{route:o,userId:a}=v();("root"===n.name||"new"===n.name||"nativeTab"===n.name)&&o&&"page"===o.name&&o.blockId&&a===t&&new c.G(e,{table:r.iU,id:o.blockId,spaceId:o.spaceId}).load()}function m(e){const{route:t,userId:n}=v();if(t&&"page"===t.name){return{url:(0,l.ZP)({fullyQualified:!1,store:new c.G(e,{table:r.iU,id:t.blockId,spaceId:t.spaceId},{userId:n}),scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:void 0}),userId:n}}if(t&&"space"===t.name){return{url:(0,i.Xs)({route:t}),userId:n}}return{}}async function f(e){const{route:t,userId:n}=v();let a,s;if(t)if("page"===t.name){const i=new c.G(e,{table:r.iU,id:t.blockId,spaceId:t.spaceId},{userId:n});a=(0,l.ZP)({fullyQualified:!1,store:i,scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:o.tY.LastVisitedPage}),await i.load(),s=i.getSpaceId()}else"space"===t.name?(s=t.spaceId,a=(0,i.Xs)({route:t})):("nativeTab"===t.name||"workspaceSetup"===t.name)&&(s=t.spaceId);return{url:a,userId:n,route:t,spaceId:s}}function g(e,t){a.Z.set(d,e),a.Z.set(u,t)}function h(){a.Z.remove(d),a.Z.remove(u)}function v(){return{route:a.Z.get(d),userId:a.Z.get(u)}}},20747:(e,t,n)=>{n.d(t,{FZ:()=>v,U_:()=>h,fU:()=>S});var o=n(41432),i=n(21202),r=n(82798),a=n(35661),s=n(26664),l=n(50906),c=n(96802),d=n(94419),u=n(9953);const p=function(e){const t=e.getRecordStoreUIAncestor(2);if(t&&t instanceof a.G&&t.isType(o.Ti.columnList))return t},m=function(e){return e&&e instanceof a.G&&e.isType(o.Ti.column)};function f(e){const{environment:t,targets:n,inMemoryRecordCache:i,transaction:a}=e;(0,r.T)(n.length>0);const s=u.j4({environment:t,type:o.Ti.columnList,properties:{},inMemoryRecordCache:i,transaction:a,spaceId:n[0].pointer.spaceId,useCrdt:n[0].useCrdt()}),c=s.getContentStore();for(const o of n)d.R3({parent:c,append:o,transaction:a});return l.xh4(t),s}function g(e){const{environment:t,targets:n,inMemoryRecordCache:i,transaction:a}=e;(0,r.T)(n.length>0);const s=u.j4({environment:t,type:o.Ti.column,format:{column_ratio:1},inMemoryRecordCache:i,transaction:a,spaceId:n[0].pointer.spaceId,useCrdt:n[0].useCrdt()}),l=s.getContentStore();for(const o of n)d.R3({parent:l,append:o,transaction:a});return s}function h(e){const{environment:t,parent:n,insertStores:o,left:r,transaction:s}=e;if(0===o.length)return[];let c,u;if(l.FT(t,{side:"left"}),m(r))c=r,u=p(r);else{c=g({environment:t,targets:[r],inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});const o=f({environment:t,targets:[c],inMemoryRecordCache:n.inMemoryRecordCache,transaction:e.transaction});u=d.rS({parent:n,oldChild:r,newChild:o,transaction:s}).child}const h=g({environment:t,targets:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});if(u){const t=u.getContentStore();d.Vt({parent:t,insert:h,before:c,transaction:e.transaction}),b({columnList:u,addedColumn:h,transaction:s});return a.G.createChildStore(t,{table:i.iU,id:h.id}).getContentStores()}return[]}function v(e){const{environment:t,parent:n,insertStores:o,right:r,transaction:s}=e;if(0===o.length)return[];let c,u;if(l.FT(t,{side:"right"}),m(r))c=r,u=p(r);else{c=g({environment:t,targets:[r],inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});const o=f({environment:t,targets:[c],inMemoryRecordCache:n.inMemoryRecordCache,transaction:e.transaction});u=d.rS({parent:n,oldChild:r,newChild:o,transaction:s}).child}const h=g({environment:t,targets:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});if(u){const t=u.getContentStore();d.BE({parent:t,insert:h,after:c,transaction:e.transaction}),b({columnList:u,addedColumn:h,transaction:s});return a.G.createChildStore(t,{table:i.iU,id:h.id}).getContentStores()}return[]}const b=function(e){const{columnList:t,addedColumn:n,transaction:o}=e,i=t.getContentStores(),r=1/i.length;c.FH({stores:[n],update:{column_ratio:r},transaction:o});for(const a of i)if(a.id!==n.id){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:(1-r)*e},transaction:o})}},y=function(e){const{columnList:t,removedColumn:n,transaction:o}=e,i=t.getContentStores(),r=n.getColumnRatio();for(const a of i){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:e/(1-r)},transaction:o})}},S=function(e){const{parent:t,transaction:n}=e,o=t.getRecordStoreUIParent();let i;if(m(o)&&(i=p(o)),i){const e=i.getContentStore(),t=i.getContentStores();for(const r of t){0===r.getContentStores().length&&(d.Od({parent:e,childToRemove:r,shouldGarbageCollect:!1,transaction:n}),y({columnList:i,removedColumn:r,transaction:n}))}const o=i.getContentStores();if(0===o.length){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(s.i)&&d.Od({parent:e,childToRemove:i,transaction:n,shouldGarbageCollect:!1})}else if(1===o.length){const e=i.getRecordStoreUIParent(),t=o[0],r=t.getContentStore(),a=t.getContentStores();if(a.reverse(),null!=e&&e.valueIs(s.i)){for(const t of a)d.Od({parent:r,childToRemove:t,shouldGarbageCollect:!1,transaction:n}),d.BE({parent:e,insert:t,after:i,transaction:n});d.Od({parent:e,childToRemove:i,transaction:n,shouldGarbageCollect:!1})}}}}},65770:(e,t,n)=>{n.d(t,{YJ:()=>y,Z2:()=>b});n(57658),n(21703),n(41432);var o=n(68626),i=n(91155),r=n(4615),a=n(21202),s=n(23867),l=(n(9953),n(42858)),c=(n(97444),n(39699)),d=n(95477),u=(n(28020),n(65598)),p=(n(41662),n(63208),n(35661)),m=(n(27724),n(50906)),f=n(54532),g=n(94419),h=n(24677);const v=new Set(["text","table_row","header","sub_header","sub_sub_header","to_do","bulleted_list","numbered_list"]);function b(e){const{parentStore:t,transaction:n,store:s,environment:l}=e,c=s.path[1];if(2!==s.path.length||"properties"!==s.path[0]||"string"!=typeof c)return;const d=s.getRecordStoreAtRootPath();if(!(d instanceof p.G))return;const u=d.getType();if(!u||!v.has(u))return;const h=function(e){var t;const{environment:n,store:o,parentStore:i,transaction:s}=e;if(o.getSpaceId()!==i.getSpaceId())return;const l=null===(t=i.getModel())||void 0===t?void 0:t.getContentIds();if(null==l||!l.includes(o.id))return;const c=f.K8(n,{blockId:o.id,inMemoryRecordCache:o.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!c)return;const d=f.E9({environment:n,sourceBlockId:o.id,targetBlockPointer:{table:a.iU,id:(0,r.ZP)(),spaceId:o.pointer.spaceId},sourceBlockSubtree:c,targetInMemoryRecordCache:o.inMemoryRecordCache,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1,transaction:s,useCrdt:i.getRecordStoreAtRootPath().useCrdt()});return g.rS({parent:i.getContentStore(),oldChild:o,newChild:d.targetBlock,transaction:s}),d.targetBlock}({environment:l,store:d,parentStore:t,transaction:n}),b=null==h?void 0:h.getPropertyStore(c);if(b)return n.postSubmitCallbacks.push((e=>{e&&o.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{miscErrorString:(0,i.LK)(e)}}),m.Gbs(l,{block_type:u,successful:!e})})),b;o.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{message:"copied transclusion block does not have expected property"}})}function y(e){const{environment:t,store:n}=e,o=n.getRecordStoreUIParent();o&&(0,u.dz)(o)&&c.createAndCommit({userAction:"legacyTransclusionActions.fixLegacyTransclusion",environment:t,perform:e=>{const[i]=f.Qi({environment:t,stores:[n],addCopyName:!1,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,s.C)(n.pointer.spaceId),baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:o.getRecordStoreAtRootPath().useCrdt()}),r=i[0],{child:a}=g.BE({parent:o,insert:r,after:n,transaction:e});l.Od({store:n,transaction:e}),h.Z5({environment:t,stores:[a]})}})}},45990:(e,t,n)=>{n.d(t,{F5:()=>h,PP:()=>f,dz:()=>p,gp:()=>m,iX:()=>g});var o=n(70203),i=n(48709),r=n(68056),a=n(89224),s=n(23178),l=n(24666),c=n(97444),d=n(98104),u=n(39699);const p=e=>{const t=l.default.state;if("editing"!==t.mode)return;const n="selectionFocus"===e.type?(0,r.TD)({store:e.store,selection:e.selection}):t.multiSelection,c=(0,r.QY)(n);if(!c)return;const{tokensInsideRange:d}=o.xrQ(c.store.getValue(),n.start.index,n.end.index),u=d.find((e=>Boolean(o.Hze(e)))),p=a.get();if(!p)return;const m=a.getRect(p);if(!m)return;const f=Boolean(u);s.Z.setState({open:!0,url:"",title:u&&(0,i.Ts)(u)||"",editingToken:u,savedTextSelectionState:{...t,multiSelection:n},selectionRect:m,focusLinkInput:!f&&e.focus,focusTitleInput:f&&e.focus})};function m(e){const{environment:t,transaction:n,url:o,title:i,editingToken:a,savedTextSelectionState:s}=e,l=(0,r.QY)(s.multiSelection);if(!l)return;a&&c.Be({environment:t,store:l.store,type:"a",selection:l.selection,transaction:n});const u=["a",o];return c.i8({environment:t,store:l.store,annotation:u,selection:l.selection,transaction:n}),d.Z5({store:l.store,selection:{startIndex:l.selection.startIndex,endIndex:l.selection.endIndex}}),i?{editingToken:[i,[u]]}:void 0}function f(e){const t=s.Z.state;if(!t.open)return;const{editingToken:n,savedTextSelectionState:o}=t;if(!n)return;const i=(0,r.QY)(o.multiSelection);i&&(u.createAndCommit({userAction:"linkAnnotationActions.unlinkSelection",environment:e,perform:t=>{c.Be({environment:e,store:i.store,type:"a",selection:i.selection,transaction:t})}}),l.default.emit(),s.Z.reset())}function g(e){const{environment:t,title:n,transaction:i,editingToken:a,savedTextSelectionState:s}=e;if(!n||!a)return;const l=(0,r.QY)(s.multiSelection);if(!l)return;const u=l.store;c.pz({environment:t,multiSelection:s.multiSelection,transaction:i});const p=l.selection.startIndex,m=p+n.length,f={startIndex:p,endIndex:m},g=["a",o.Hze(a)],h=o.V3y(n);return c.mM({environment:t,store:u,tokens:[h],index:p,transaction:i}),c.i8({environment:t,store:u,annotation:g,selection:f,transaction:i}),d.Z5({store:u,selection:f}),{editingToken:[n,[g]],savedTextSelectionState:{...s,multiSelection:{start:{store:u,index:p},end:{store:u,index:m}}}}}function h(){s.Z.setState({open:!1})}},94419:(e,t,n)=>{n.d(t,{BE:()=>s,Ce:()=>p,HP:()=>m,MK:()=>d,Od:()=>c,R3:()=>u,Vt:()=>l,rS:()=>a});n(57658);var o=n(20747),i=n(19358),r=n(39699);const a=function(e){const{parent:t,oldChild:n,newChild:o,transaction:a}=e,s=n.id,l=o.id,c=(t.getValue()||[]).indexOf(s);i.D0({parentStore:t,childStore:o,transaction:a}),i.If({parentStore:t,childStore:n,transaction:a}),c>=0&&(r.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:l,after:s}}}),r.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:s}}}));return{parent:t,child:o.cloneWithNewUIParent(t)}},s=function(e){const{parent:t,insert:n,after:o,transaction:a}=e;let s;o&&(s=o.id),i.D0({parentStore:t,childStore:n,transaction:a}),r.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{after:s,id:n.id}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},l=function(e){const{parent:t,insert:n,before:o,transaction:a}=e;let s;o&&(s=o.id),i.D0({parentStore:t,childStore:n,transaction:a}),r.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{before:s,id:n.id}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},c=function(e){void 0===e.shouldGarbageCollect&&(e.shouldGarbageCollect=!0);const{parent:t,childToRemove:n,shouldGarbageCollect:a,transaction:s}=e;i.If({parentStore:t,childStore:n,transaction:s}),r.applyOperation({transaction:s,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:n.id}}}),a&&s.preEnqueueActions.push((()=>{o.fU({parent:t,transaction:s})}));const l=n.cloneWithNewUIParent(t);return{parent:t,child:l}},d=function(e){const{parent:t,append:n,transaction:o}=e;i.D0({parentStore:t,childStore:n,transaction:o}),r.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"keyedObjectListAfter",args:{value:n.pointer,after:void 0}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},u=function(e){const{parent:t,append:n,transaction:o,after:a}=e;i.D0({parentStore:t,childStore:n,transaction:o}),r.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:n.id,after:a}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},p=function(e){const{parent:t,prepend:n,transaction:o,before:a}=e;i.D0({parentStore:t,childStore:n,transaction:o}),r.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{id:n.id,before:a}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},m=function(e){const{parent:t,current:n,after:o,transaction:i}=e;o?s({parent:t,insert:n,after:o,transaction:i}):p({parent:t,prepend:n,transaction:i});return{parent:t,child:n.cloneWithNewUIParent(t)}}},13084:(e,t,n)=>{n.d(t,{Bm:()=>M,DC:()=>T,HO:()=>P,LQ:()=>C,UG:()=>A,dM:()=>B,uQ:()=>x});n(21703);var o=n(1302),i=n(41432),r=n(14248),a=n(72126),s=n(21202),l=n(95371),c=n(28020),d=n(65598),u=n(69645),p=n(73959),m=n(55367),f=n(35661),g=n(34583),h=n(49865),v=n(42239),b=n(31781),y=n(20747),S=n(94419),_=n(9953),w=n(42858),k=n(24677),I=n(98104);function C(e){const{environment:t,droppedDirection:n,droppedStores:o,targetStore:l,targetParentStore:c,transaction:d,duplicate:u}=e,p=o.every((e=>e.isExternalObjectInstancePageBlockStore()))||u;if(l&&n===m.vh.Onto){k.ZH(t);const e=!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction()),n=v.LQ({environment:t,droppedStores:o,duplicate:p,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:l.useCrdt()});let a=l;if(l.isType(i.Ti.alias)){const e=l.getAliasTargetStore();if(!e)throw new Error("Alias has no target.");e instanceof f.G&&(a=e)}const s=a.getCollectionViewCollectionStore();if(a.isCollectionView()&&!a.isCollectionViewPageWithContent()){if(!s)throw new Error("CollectionStore is not defined.");const e=h.o3({environment:t,stores:n,transaction:d,collectionStore:s});for(const n of e)h.mp({environment:t,store:n,collectionStore:s,coerce:!0,groupsPointer:[],transaction:d});return e}{const e=a.getAssociatedCollectionStore();if(null!=e&&e.isPageTreeCollection())for(const o of n){if("page"!==o.getType())continue;if(!o.isDefined())continue;const t=r.Xq({blockProperties:o.getProperties(),oldSchema:o.getSchema(),newSchema:e.getSchema()});t.propertyUpdate&&Object.keys(t.propertyUpdate).length>0&&_.sW({store:o.getPropertiesStore(),data:t.propertyUpdate,transaction:d})}const t=a.getContentStore();for(const o of n)S.R3({parent:t,append:o,transaction:d});return n}}{const e=!!l&&!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction(!1)),i=c.getRecordStoreAtRootPath();let r=v.LQ({environment:t,droppedStores:o,duplicate:p,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:l?l.useCrdt():i.table===s.iU&&i.useCrdt()});return n===m.vh.Above?(r=a.d9(r),l?r=a.UI(r,(e=>S.Vt({parent:c,insert:e,before:l,transaction:d}).child)):(r.reverse(),r=a.UI(r,(e=>S.Ce({parent:c,prepend:e,transaction:d}).child)))):n===m.vh.Below?(r=a.d9(r),l?(r.reverse(),r=a.UI(r,(e=>S.BE({parent:c,insert:e,after:l,transaction:d}).child))):r=a.UI(r,(e=>S.R3({parent:c,append:e,transaction:d}).child))):l&&n===m.vh.Left?r=y.U_({environment:t,parent:c,insertStores:r,left:l,transaction:d}):l&&n===m.vh.Right&&(r=y.FZ({environment:t,parent:c,insertStores:r,right:l,transaction:d})),w.DV({environment:t,insertedStores:r}),k.Z5({environment:t,stores:r}),r}}function x(e){var t;const{environment:n,files:o,droppedDirection:i,targetStore:r,targetParentStore:a,transaction:s}=e,l=a.inMemoryRecordCache,d=c.qQ(n);C({environment:n,targetParentStore:a,targetStore:r,droppedDirection:i,droppedStores:b.z({environment:n,files:o,inMemoryRecordCache:l,pageWidth:d,transaction:s,spaceId:null==r?void 0:r.pointer.spaceId,useCrdt:(null===(t=(0,p.sQ)(a))||void 0===t?void 0:t.useCrdt())??!1}),duplicate:!1,transaction:s})}function T(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e;(function(e){const{environment:t,isClick:n,targetStore:o}=e;if(!n)return!1;const r=o.findRecordStoreUIAncestor((e=>e instanceof f.G&&e.isTransclusionType())).ancestor;if(r&&r instanceof f.G){const e=o.findRecordStoreUIAncestor((e=>e instanceof f.G&&e.getType()===i.Ti.transclusionReference)).ancestor,n=(e&&e instanceof f.G?e:void 0)||r,a=n.getRecordStoreUIParent();if(!a||!(0,d.dz)(a))return;return k.Z5({environment:t,stores:[n]}),!0}return!1})(e)||B({environment:t,store:n,isAtStartOfLine:o})||function(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e,i=k.KX(),r=i.indexOf(n);if(-1===r)return!1;if(o)for(let a=r;a>=0&&a>r-20;a--){if(B({environment:t,store:i[a],isAtStartOfLine:!1}))return!0}else for(let a=r;a<i.length&&a<r+20;a++){if(B({environment:t,store:i[a],isAtStartOfLine:!0}))return!0}}(e)}function M(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e;B({environment:t,store:n,isAtStartOfLine:o})||D({...e,placement:"after"})}function P(e){return R(e)}function A(e){return R(e)}function R(e){const{environment:t,container:n,store:o,transaction:r}=e,c=function(e){var t;const{container:n,store:o}=e;let r=(0,u.dq)({includeNonSelectableListContainer:!0,container:n});r&&o&&(r=a.Z$((0,l.DY)([r],(e=>e.value.store===o))));if(!r)return;let s=r;for(;s.children.length>0;){const e=a.Z$(s.children);if(0===e.children.length)break;const t=e.value.store.getType();if(t&&i.BT[t])break;s=e}return{parentStore:s.value.store,siblingStore:null===(t=a.Z$(s.children))||void 0===t?void 0:t.value.store}}({container:n,store:o});if(!c)return!1;const{parentStore:p,siblingStore:m}=c;if(m&&(0,d.PF)(m))return!1;const f=p.getParentStore();return D({environment:t,targetParentStore:(p.getType()===i.Ti.tab&&(null==f?void 0:f.table)===s.iU?f:p).getContentStore(),placement:"after",transaction:r})}function D(e){const{environment:t,targetStore:n,targetParentStore:r,placement:a,transaction:s}=e;if(r.getValue()&&g.M_(t)&&g.M_(t)){var l;const e=_.j4({environment:t,type:i.Ti.text,inMemoryRecordCache:r.inMemoryRecordCache,transaction:s,spaceId:r.pointer.spaceId,useCrdt:(null===(l=(0,p.sQ)(r))||void 0===l?void 0:l.useCrdt())??!1}),c="after"===a?S.BE({parent:r,after:n,insert:e,transaction:s}):S.Vt({parent:r,before:n,insert:e,transaction:s});return o.default.afterNextFlush((()=>{B({environment:t,store:c.child,isAtStartOfLine:!1})})),!0}return!1}function B(e){const{environment:t,store:n,isAtStartOfLine:o}=e,i=(0,p.mh)(n);return!!i&&(k.eP({environment:t,store:n}),o?I.N_({store:i}):I.NX({store:i}),!0)}},92625:(e,t,n)=>{n.d(t,{j:()=>r,x:()=>a});var o=n(33929),i=n(31104);const r=function(e){let{message:t,interpolatedValues:n,targetRecordId:r}=e;i.Z.setState({open:!0,message:o.default.formatMessage(t,n),targetRecordId:r})},a=function(){i.Z.setState({open:!1,targetRecordId:void 0})}},98730:(e,t,n)=>{n.d(t,{S:()=>a});var o=n(48141),i=n(80444),r=n(84166);const a=async e=>{const{hasPublicAccessPermission:t}=o.bC(e),n=i.default.state.currentSpaceStore,a=i.default.state.currentSpaceViewStore;if(t)return;if(!n)return;const s=await o.hb({environment:e,currentSpaceStore:n,currentSpaceViewStore:a,excludeCurrentPage:!0});r.Z.update((e=>({...e,localSearchableBlocksCache:s})))}},35979:(e,t,n)=>{n.d(t,{Be:()=>c,TR:()=>h,V_:()=>u,WA:()=>v,_5:()=>d,lJ:()=>m,nk:()=>g,wt:()=>f,z_:()=>l});var o=n(79946),i=n(50906),r=n(24215),a=n(77080);function s(e,t){r.j(e,t)}function l(e){s(e,"request_login_with_apple"),p(e,"login-with-apple")}function c(e){s(e,"request_login_with_google"),p(e,"login-with-google")}function d(e){s(e,"send_temporary_password"),p(e,"temporary-passcode")}function u(e){s(e,"redirect_to_saml_login"),p(e,"saml")}function p(e,t){r.j(e,"login_attempt",{login_method:t})}function m(e,t){i.o7O(e,"signup_login_button_clicked",t),a.default.logEvent("signup_login_button_clicked",t.login_method,t)}function f(e,t){r.j(e,"login_success",t,{dontWait:!0})}function g(e,t){const{isBannedGoogleSSOUserAgent:n,isSignup:r}=t;i.o7O(e,"onboarding_landing_page",{is_banned_google_sso_user_agent:n,is_signup:r}),r&&o.T1()}function h(e,t){const{actionType:n,isSignup:o}=t;r.j(e,"google_one_tap_login_button_click",{is_signup:Boolean(o),action_type:n},{dontWait:!0})}function v(e,t){r.lu(e,"login_email_input_updates","login_email_input_updates",1)}},97977:(e,t,n)=>{n.r(t),n.d(t,{actuallyLogoutAndDeleteAllLocalData:()=>we,clearCurrentUser:()=>_e,handleLoginFailureIfSamlRequired:()=>Re,handleLoginSuccess:()=>ke,handleLoginWithMfa:()=>Ie,handleLoginWithTemporaryPasscodeSuccess:()=>pe,initialize:()=>Te,loginPasswordReset:()=>ve,loginSamlUser:()=>be,loginSamlUserWithToken:()=>he,loginWithAppleAuth:()=>me,loginWithGoogleAuth:()=>fe,loginWithTemporaryPasscode:()=>ue,logout:()=>Se,logoutSingleAccount:()=>ye,openBrowserInMobileNative:()=>de,redirectToSaml:()=>ge,requestLoginWithGoogleOneTap:()=>ce,setLocalStorageUserId:()=>xe,shouldCreatePassword:()=>Pe,showSamlRedirectMessage:()=>De});n(57658),n(21703);var o=n(87997),i=n(79946),r=n(15145),a=n(53504),s=n(68626),l=n(72126),c=n(91155),d=n(29477),u=n(4615),p=n(99405),m=n(89101),f=n(19889),g=n(66079),h=n(9852),v=n(54153),b=n(64002),y=n(66504),S=n(5366),_=n(47839),w=n(29974),k=n(95477),I=n(24215),C=n(91924),x=n(12955),T=n(33954),M=n(87381),P=n(33929),A=n(28125),R=n(57491),D=n(78873),B=n(18514),E=n(15517),F=n(32223),Z=n(75538),L=n(18245),j=n(19034),V=n(78861),U=n(6451),O=n(58455),N=n(80444),z=n(77080),H=n(89087),W=n(35661),q=n(27724),G=n(24666),K=n(88893),$=n(50906),Q=n(54642),Y=n(90287),J=n(47307),X=n(57400),ee=n(3297),te=n(94273),ne=n(92625),oe=n(35979),ie=n(4408),re=n(75018),ae=n(70782);const se=(0,S.defineMessages)({unsavedChanges:{id:"loginActions.dialogError.logoutUnsavedChanges.message",defaultMessage:"You have unsaved changes. If you log out now, you could lose them."},logoutWithoutSaving:{defaultMessage:"Discard edits and log out",id:"loginActions.dialogError.logoutUnsavedChanges.confirmButton.label"},signupPendingMessage:{defaultMessage:"Creating Notion account…",id:"loginActions.signup.pending.message"},loginPendingMessage:{defaultMessage:"Logging in to Notion…",id:"loginActions.login.pending.message"},redirectSamlMessage:{defaultMessage:"SAML SSO required. Redirecting to the configured login page.",id:"loginActions.login.redirect.saml.message"}});async function le(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];if(t){const e=(0,h.getOauthAuthorizationParams)();sessionStorage.clear(),(0,h.setOauthAuthorizationParams)(e)}else sessionStorage.clear();if(E.ZL(),n&&o.push(_e(e)),o.push($.NMx()),e.mobileNative&&(o.push(e.mobileNative.logoutOfGoogle()),o.push(e.mobileNative.cancelUserBackgroundTasks())),e.device.isElectron&&(_.clearBrowserHistory(),t||_.clearCookies()),N.default.reset(),q.default.reset(),G.default.reset(),ie.LK(e),F.resetRecordSubscriptions(),j.Z.reset(),O.default.reset(),Z.default.reset(),o.push(H.transactionQueue.reset()),"on"===z.default.getGroup("clear-record-cache-on-login")){const t=e.defaultRecordCache.persistedRecordCache;t&&"reset"in t&&o.push(t.reset())}z.default.reset(),await Promise.all(o)}async function ce(e){const{environment:t,idToken:n,store:o,frontPathName:i}=e,r=await(0,M.loadCurrentUserId)(t),a=L.default.mark("login_time.google"),s=await Q.loginWithGoogleJwt(t,{idToken:n});if(L.default.measure(a,{environment:t}),"success"===s.type){const{isNewSignup:e,userId:n}=s.data;return await ke({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:r,loginMethod:"login-with-google-onetap",frontPathName:i}),{status:"success"}}{await Re(t,s);const e=(0,T.wf)(P.default.getIntl(),s);return o.setState({...o.state,alert:e}),{status:"fail"}}}function de(e,t){e.mobileNative&&((0,C.Q7)(e)?e.mobileNative.openAuthSessionBrowser(t):e.mobileNative.openInAppBrowser(t))}async function ue(e){const{environment:t,state:n,password:o,redirectURL:i,webBrowserDeviceId:r,passcodeEnterMethod:a,showInvitationVersion:s}=e,l=L.default.mark("login_time.passcode"),c=await(0,M.loadCurrentUserId)(t),d=await Q.loginWithEmail(t,{state:n,password:o});if(L.default.measure(l,{environment:t}),"success"!==d.type){await Re(t,d);return(0,T.wf)(P.default.getIntl(),d)}{const{isNewSignup:e,userId:n}=d.data;if(_.electronApi&&function(e){let{environment:t,isNewSignup:n,webBrowserDeviceId:o}=e;if(!t.device.isElectron||!n||o)return!1;return z.default.checkGate("desktop_app_login_with_email_redirect")}({environment:t,isNewSignup:e,webBrowserDeviceId:r})){const e=b.$U(b.bf({url:`${k.default.domainBaseUrl}${m._j.loginSuccess}`}));_.electronApi.openExternalUrl(e)}else await pe({environment:t,isNewSignup:e,userId:n,redirectURL:i,previousPersistedUserId:c,loginMethod:"temporary-passcode",webBrowserDeviceId:r,passcodeEnterMethod:a,showInvitationVersion:s})}}async function pe(e){const{environment:t}=e;await ke(e);const[n,o,i]=await Promise.all([Pe(t),Ae(t),Me()]);(n&&o||n&&i)&&D.E({environment:t})}async function me(e){const{environment:t,code:n,encryptedToken:o,encryptedNonce:i,encryptedUserObject:r,webBrowserDeviceId:a}=e,s=L.default.mark("login_time.apple"),l=await(0,M.loadCurrentUserId)(t),c=await Q.loginWithAppleAuth(t,{code:n,encryptedToken:o,encryptedNonce:i,encryptedUserObject:r});if(L.default.measure(s,{environment:t}),"success"!==c.type)return await Re(t,c),(0,T.wf)(P.default.getIntl(),c);{const{isNewSignup:e,userId:n}=c.data;await ke({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:l,loginMethod:"login-with-apple",webBrowserDeviceId:a})}}async function fe(e){const{environment:t,encryptedToken:n,code:o,callbackType:i,webBrowserDeviceId:r}=e,a=await(0,M.loadCurrentUserId)(t),s=await Q.loginWithGoogleAuth(t,{code:o,encryptedToken:n,callbackType:i});if("success"!==s.type)return await Re(t,s),(0,T.wf)(P.default.getIntl(),s);{const{isNewSignup:e,userId:n}=s.data;await ke({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:a,loginMethod:"login-with-google",webBrowserDeviceId:r})}}function ge(e,t){oe.V_(e),e.mobileNative?de(e,t):e.device.isElectron&&_.electronApi?_.electronApi.openExternalUrl(t):window.location.href=t}async function he(e){const{environment:t,csrfState:n,token:o,isNewSignup:i}=e,r=await(0,M.loadCurrentUserId)(t),a=await x.getBrowserId(t);n||o||s.log({level:"error",type:"loginSamlUserWithToken",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:a,isNewSignup:i}}});const l=await Q.loginWithEmail(t,{state:n,password:o});if("success"!==l.type)return await Re(t,l),(0,T.wf)(P.default.getIntl(),l);{const{userId:e}=l.data;await ke({environment:t,isNewSignup:i,userId:e,previousPersistedUserId:r,loginMethod:"saml"})}}async function ve(e){const{environment:t,csrfState:n,password:o,loginStore:i}=e,r=await(0,M.loadCurrentUserId)(t);if(!n){const e=await x.getCookie(t,"notion_browser_id");s.log({level:"error",type:"loginPasswordReset",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:e,previousPersistedUserId:r}}})}const a=await Q.loginWithEmail(t,{state:n,password:o,passwordReset:!0});if("success"!==a.type)return await Re(t,a),(0,T.wf)(P.default.getIntl(),a);{const{userId:e,enabledMfaSettings:n}=a.data;n&&n.length>0?(Ie({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:r,loginMethod:"password-reset",loginStore:i,mfaSettings:n}),re.navigateOnBaseUrl({environment:t,url:m._j.login}),D.E({environment:t})):(await ke({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:r,loginMethod:"password-reset"}),D.E({environment:t}))}}async function be(e){const{environment:t,userId:n,previousUserId:o,isNewSignup:i}=e;await ke({environment:t,isNewSignup:i,userId:n,previousPersistedUserId:o,loginMethod:"saml"})}async function ye(e){const{environment:t,userId:n}=e,{nextUserId:o,nextSpaceViewStore:i}=function(e){const{environment:t,userId:n}=e,o=t.currentUser.id;if(n===o){const e=V.Z.getAllSpaceViewStores(t).filter((e=>{const t=e.getUserRootParentId();return t&&t!==n}))[0];return{nextUserId:e&&e.getUserRootParentId(),nextSpaceViewStore:e}}{const{currentSpaceViewStore:e}=N.default.state;return{nextUserId:o,nextSpaceViewStore:e}}}(e);if(o&&i){if(await H.transactionQueue.hasTasksForUser(n)){if(!(await J.confirmUserAction({message:P.default.formatMessage(se.unsavedChanges),acceptLabel:P.default.formatMessage(se.logoutWithoutSaving)})))return}await Q.logout(t,{userId:n}),await H.transactionQueue.clearForUser(n),E.ZL(n);const e=await ae.x({environment:t,newCurrentUserId:o,loggedOutUserId:n}),{currentUserRootStore:a,currentUserSettingsStore:s}=N.default.state;a&&s&&w.y3({environment:e,spaceViewStore:i,userSettingsStore:s,userRootStore:a,pageVisitSource:r.tY.Login}),_.refreshAll({includeFocusedWindow:!1})}else await Se(t)}async function Se(e){if(await H.transactionQueue.anySessionHasTasks()){if(!(await J.confirmUserAction({message:P.default.formatMessage(se.unsavedChanges),acceptLabel:P.default.formatMessage(se.logoutWithoutSaving)})))return}(0,B.Sr)()?window.location.href=`${k.default.domainBaseUrl}/logout`:re.navigate({environment:e,url:m._j.logout})}async function _e(e){if(e.mobileNative&&await e.mobileNative.unregisterPushNotifications(),e.updateCurrentUserId){const t={environment:e,currentUserId:void 0,userIds:[]};e.updateCurrentUserId(t)}return{...e,currentUser:new o.CurrentUser}}async function we(e){const{environment:t,nextLocation:n,userId:o,doNotRedirect:i}=e;o?await Q.logout(t,{userId:o}):await Q.logout(t,{}),await le(t),_.clearGoogleAuthCookies(),_.refreshAll({includeFocusedWindow:!1}),i||(window.location.href=n||m._j.root)}async function ke(e){const{environment:t,isNewSignup:n,userId:o,redirectURL:r,previousPersistedUserId:l,frontPathName:c,webBrowserDeviceId:f,passcodeEnterMethod:g,showInvitationVersion:v}=e;n?ne.j({message:se.signupPendingMessage}):ne.j({message:se.loginPendingMessage});try{const b=A.k(t);if(ie.LK(t),t.device.isElectron&&(_.clearBrowserHistory(),_.refreshAll({includeFocusedWindow:!1})),l&&l!==o){const e=await H.transactionQueue.getTotalNumberOfTasks();e>5&&s.log({level:"warning",from:"loginActions",type:"setLoggedInUserId",data:{userId:o,currentUserId:l,clearedTransactionCount:e}}),await le(t,b,!t.currentUser.loggedInUserIds.includes(l))}if(!l){const e=ee.qd(void 0);ee.nM({currentUserId:o,blockId:e}),ee.nM({currentUserId:void 0,blockId:void 0})}const y=await Ce(t,o);if(oe.lJ(y,{is_new_signup:n,login_method:e.loginMethod,front_pathname:c}),n){$.ieV(y,{user_id:o,tags:(0,h.getSessionAnalyticsTags)(),origin_initial_page:re.getInitialPage(o)});const t=await(0,I.of)(y);await(0,d.OI)(200,[Q.initializeUserAnalyticsEmptySync(y,{isNewSignup:n,analyticsProperties:(0,a.Z)({...(0,I.Ts)(),...(0,I.eR)(),...(0,R.getMobileNativeDeviceInfo)(),...t,experiments:z.default.getExperimentsMap(),login_method:e.loginMethod,signup_from:t.route_name,front_pathname:c,web_browser_device_id:f,passcode_enter_method:g},"ignore-class-instances")})])}if(r){const e=p.Wj({url:r,isMobile:y.device.isMobile,baseUrl:k.default.domainBaseUrl,publicDomainName:k.default.publicDomainName,protocol:k.default.protocol,currentUrl:window.location.href});if(!e||"space"!==e.name&&"page"!==e.name){if(e&&"oauthAuthorization"===e.name){const{responseType:t,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s}=e;(0,h.setOauthAuthorizationParams)({responseType:t,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s})}}else te.nr(e,o)}if(Y.mc(y),X.mc(),await X.Yh(y),n&&(z.default.logEvent("sign_up",void 0,{login_method:e.loginMethod,device_type:t.device.deviceType}),z.default.logEvent("sign_up_by_login_method",e.loginMethod),z.default.logEvent("sign_up_by_device_type",t.device.deviceType)),oe.wt(y,{is_new_signup:n,login_method:e.loginMethod,logged_in_user_ids:y.currentUser.loggedInUserIds.map((e=>(0,u.F9)(e))),most_recent_user_id:(0,u.F9)(o),web_browser_device_id:f,passcode_enter_method:g}),i.j(y.device,{facebook:{eventName:"ViewContent"},google:{eventName:"loggedIn"}}),k.default.isAdminMode){if(!(await x.getGhostAdminUserId(t)))return void re.navigate({environment:t,url:"/__admin"})}const S=(0,h.getPostLoginRedirect)(k.default.secureFileConfig.protocol,k.default.secureFileConfig.hostname);S?((0,h.unsetPostLoginRedirect)(),window.location.href=S):!b&&l&&l!==o?window.location.href=m._j.root:n&&v?re.navigate({environment:y,url:m._j.onboarding}):re.navigate({environment:y,url:m._j.root})}finally{ne.x()}}function Ie(e){const{loginStore:t,userId:n}=e,o=new W.U6(e.environment,{table:f.KJ,id:n},{userId:n});t.setState({...t.state,settings:e.mfaSettings,loginType:"mfa",redirectURL:e.redirectURL,previousPersistedUserId:e.previousPersistedUserId,userStore:o})}async function Ce(e,t){await async function(e,t){await xe(e,t)}(e,t);let n=[t];const i=await(0,M.getUserIdsFromCookie)(e);i&&(i.push(t),n=l.jj(i));const r=await x.getGhostAdminUserId(e),a={...e,currentUser:new o.CurrentUser({id:t,loggedInUserIds:n,adminUserId:r})};if(e.updateCurrentUserId){const o={environment:e,currentUserId:t,userIds:n};await e.updateCurrentUserId(o)}return a.device.isFirefox||E.lr(),a}async function xe(e,t){const n=await(0,M.getUserIdsFromCookie)(e);n&&!n.includes(t)||v.Z.set(M.currentUserIdKey,t)}async function Te(e){const t=await(0,M.loadCurrentUserId)(e),{mobileNative:n,device:o,defaultRecordCache:i}=e;if(n&&n.sqliteConnection)try{await U.y6(n.sqliteConnection,t||y.I)}catch(r){s.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,c.Ui)(r),data:{}})}return o.isElectron&&o.electronVersion&&o.electronVersion[0]>=6&&i.persistedRecordCache&&await i.persistedRecordCache.initialize(t),t?await Ce(e,t):e}async function Me(){var e;const{currentUserStore:t}=N.default.state;if(!t)return!1;if(!t.getEmail())return!1;const{currentUserSettingsStore:n}=N.default.state;return!!n&&(await n.load(),Boolean(null===(e=n.getSettings())||void 0===e?void 0:e.should_set_password_on_login))}async function Pe(e){const{currentUserStore:t}=N.default.state;if(!t)return!1;const n=t.getEmail();if(!n)return!1;const o=await D.c({environment:e,userEmail:n});if(o.error)throw o.error;return!o.value.isSamlEnforced&&!o.value.hasPassword&&!o.value.didLogInWithSaml}async function Ae(e){const t=e.currentUser.id;if(!t)return!1;const n=new W.r9(e,{table:g.dx,id:t});await n.load();return(await(0,K.Gh)({environment:e,userRootStore:n})||[]).some((e=>e===k.default.pricing.student.productId))}async function Re(e,t){var n,o;if("saml_sso_required"===(null===(n=t.body.clientData)||void 0===n?void 0:n.type)&&null!==(o=t.body.clientData)&&void 0!==o&&o.redirectUrl){await De(2e3);ge(e,t.body.clientData.redirectUrl)}}async function De(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;ne.j({message:se.redirectSamlMessage}),await(0,d.Vs)(e),ne.x()}},27153:(e,t,n)=>{n.d(t,{$:()=>r,Z:()=>a});var o=n(91390),i=n(24677);function r(e,t){t.disableClearSelection||i.ZH(e),o.Z.setState({...t,isActive:!0})}function a(){const e=o.Z.state;e.isActive&&e.onCancel&&e.onCancel(),o.Z.reset()}},67060:(e,t,n)=>{n.d(t,{Br:()=>D,RL:()=>A,WI:()=>P,_P:()=>T,lZ:()=>M,xv:()=>R});var o=n(49085),i=n(72126),r=n(70203),a=n(69783),s=n(28020),l=n(82343),c=n(44486),d=n(68056),u=n(98165),p=n(89224),m=n(80444),f=n(64233),g=n(19111),h=n(83212),v=n(72087),b=n(10743),y=n(24666),S=n(34583),_=n(50906),w=n(88295),k=n(97444),I=n(39699);function C(e){const{textStore:t,environment:n}=e,o=(0,u.n3)(t)&&h.Z.getMode(n,t).hasPublicPermission,i=!o,r=!o;return{page:true,createPage:t.isDefaultRecordCache(),user:i,bot:i,date:!0,reminder:!0,templateVariable:x(t),group:r}}function x(e){const t=(0,s.RM)();if(!t||"block"!==e.table)return!1;if(t.isInsideTemplate())return!0;const n=c.W(e);if(n||t.isInsideFactoryOrDuplicateBlocksAction()){const t=null==n?void 0:n.getTitleStore();return!(n&&t&&t.id===e.id&&i.Xy(t.path,e.path))}return!!(0,l.td)(e)}function T(e){const{environment:t,textStore:n,oldSelection:i,oldTextValue:s,disableDateMentions:l,disableDateReminderMentions:c,disableTemplateVariableMentions:d}=e,u=function(e){const{textStore:t,oldSelection:n}=e;if(b.Z.state.open||a.Z.state.open||f.Z.state.open)return;const o=r.eeV(t.getValue()||[]),i=n.startIndex,s=(o[i]||"").normalize("NFKD"),l=(o[i-1]||"").normalize("NFKD"),c=g.Z.state;if(c.open)return"[["===c.insertionType&&"]"===s&&"]"===l?"]]":void 0;if("@"===s){if(l&&!/[\s\(\)\[\]]/g.test(l))return;return"@"}if("+"===s){if(l&&!/[\s\(\)\[\]]/g.test(l))return;return"+"}if("[["===o.slice(i-1,i+1).join("")){const e=o[i-1];if(e&&!/[\s\(\)\[\]]/g.test(e))return;return"[["}}(e);if(!u)return;const m=g.Z.state;if("]]"===u){if(m.open){const e=m.temporaryInputData.state;e&&m.temporaryInputData.setState({...e,suffix:"]]"}),g.Z.setState({...m,showCreateIn:!0})}return}const h=p.get();if(!h)return;const y=p.getRect(h);if(!y)return;const S=C({textStore:n,environment:t}),w=S.page,k=S.createPage,I=S.user&&"@"===u,x=S.bot&&"@"===u,T=S.date&&"@"===u&&!l,M=S.reminder&&"@"===u&&!l&&!c,P=S.templateVariable&&"@"===u&&!l&&!d,A=S.group&&"@"===u;(I||A||w||k||T||M||P)&&("+"!==u||k)&&(g.Z.setState({open:!0,openTime:Date.now(),insertionType:u,textStore:n,oldTextValue:s,oldSelection:i,selectionRect:y,userRequestStore:new v.Z,botRequestStore:new v.Z,pageRequestStore:new v.Z,temporaryInputData:o.default.createValue(void 0),mentionTypes:{page:w,createPage:k,user:I,bot:x,date:T,reminder:M,templateVariable:P,group:A},expandSection:void 0,showCreateIn:!1,createInQuery:"",isEmptyPageTitle:!1}),_.j1w(t))}function M(e,t){k.N3({direction:"end"});const n=y.default.state;if("editing"!==n.mode)return;const o=(0,d.QY)(n.multiSelection);if(!o)return;let i=!1;if(o.selection.startIndex>0){const e=o.store.getValue()||[],t=r.eeV(e)[o.selection.startIndex-1];/[\s]/g.test(t)||(i=!0)}I.createAndCommit({userAction:"mentionMenuActions.insertMention",environment:e,perform:t=>{i?(k.hJ({environment:e,store:o.store,string:" ",selection:o.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),k.hJ({environment:e,store:o.store,string:"@",selection:{startIndex:o.selection.startIndex+1,endIndex:o.selection.endIndex+1},disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})):k.hJ({environment:e,store:o.store,string:"@",selection:o.selection,disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}});const a=g.Z.state;if(!a.open)return;const s=C({environment:e,textStore:o.store});g.Z.setState({...a,mentionTypes:{page:s.page&&t.page,createPage:s.createPage&&t.createPage,user:s.user&&t.user,bot:s.bot&&t.bot,date:s.date&&t.date,reminder:s.reminder&&t.reminder,templateVariable:s.templateVariable&&t.templateVariable,group:s.group&&t.group}})}function P(){const e=g.Z.state;if(e.open){const{mainEditorCurrentBlockStore:t}=m.default.state;return t&&t.uiContains(e.textStore)?"block":"comment"}}function A(e){const t=g.Z.state,{environment:n,annotation:o,transaction:i,menuListItemAction:a,query:s,mentionType:l}=e;if(t.open){let e=t.oldTextValue,c=t.oldSelection;const d=t.insertionType.length-1;d>0&&(e=r._QS(e,t.oldSelection.startIndex-d,t.oldSelection.startIndex),c={startIndex:c.startIndex-d,endIndex:c.endIndex-d}),k.sO({environment:n,store:t.textStore,value:e,transaction:i});const u=P();o&&k.lZ({environment:n,store:t.textStore,selection:c,annotation:o,analyticsFrom:u,transaction:i}),l&&_.z7J(n,{clickIndexGlobal:null==a?void 0:a.index,clickIndexLocal:null==a?void 0:a.indexLocal.indexLocal,sectionIndex:null==a?void 0:a.indexLocal.section,analyticsFrom:u,timeToClickInMs:Date.now()-t.openTime,queryLength:s.length,mentionType:l}),R()}}function R(){g.Z.setState({open:!1,userRequestStore:g.Z.state.userRequestStore,botRequestStore:g.Z.state.botRequestStore,pageRequestStore:g.Z.state.pageRequestStore,mentionTypes:g.Z.state.mentionTypes})}async function D(e){const{environment:t,titleText:n,ignoreSelectionAreaStore:o,createInValue:i,onPageCreated:r,menuListItemAction:a}=e,s=g.Z.state;if(!s.open)return;if(!S.M_(t))return;o.reset();const{performResult:l}=await I.createAndCommitAsync({environment:t,userAction:"mentionMenuActions.acceptCreateIn",waitForServerCommit:!0,perform:async e=>{const o=w.f8({environment:t,transaction:e,titleText:n,createInValue:i,recordStoreParent:s.textStore}),l=o.createdPages[0];if(l)return r&&r(l),A({environment:t,annotation:["p",l.id],transaction:e,menuListItemAction:a,query:n,mentionType:"createPage"}),await o.moveToStorePromise,{createInState:o}}});if(l){const{createInState:e}=l;return await w.c_({analyticsFrom:"mention_menu",createInState:e}),e}}},91376:(e,t,n)=>{n.d(t,{CT:()=>l,r$:()=>s});var o=n(97799),i=n(80444),r=n(64404),a=n(92083);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{currentTab:t,subtab:n,isMobile:r,openedFrom:s}=e;if(r)"notifications"!==t&&"notifications_and_settings"!==t&&"user_settings"!==t||o.Z.setState({open:!0});else if(t)a.Z.setState({open:!0,openedFrom:s,...c({currentTab:t,subtab:n}),highlightedSetting:void 0});else{const{currentSpaceStore:e}=i.default.state;a.Z.setState({open:!0,openedFrom:s,currentTab:l(e),defaultSubtab:void 0,highlightedSetting:void 0})}}function l(e){return e&&e.canRead()?"members":"settings"}function c(e){const{currentTab:t,subtab:n}=e;if("members"===t){return{currentTab:"members",defaultSubtab:n===r.Q.Members||n===r.Q.Groups||n===r.Q.Guests||n===r.Q.Reprovisioning||n===r.Q.Requests?n:void 0}}if("integrations"===t){return{currentTab:"integrations",defaultSubtab:"member_connections"===n||"workspace_connections"===n?n:void 0}}return{currentTab:t,defaultSubtab:void 0}}},60971:(e,t,n)=>{n.d(t,{aV:()=>r,eV:()=>a,kW:()=>c,sv:()=>d});var o=n(72126),i=n(85818);function r(e){const{store:t,itemsPerRow:n,sections:o,disableKeyboardArrowWrap:i}=e,{focus:r}=t.state;if(void 0===r.indexLocal)return c({store:t,sections:o,indexGlobal:0});const a=r.indexLocal+n,d=o[r.section],u=d.items.length-1;if(a<=u)return c({store:t,sections:o,indexLocal:{section:r.section,indexLocal:a}});const p=function(e){const{indexLocal:t,section:n,itemsPerRow:o}=e,i=l({indexLocal:t,section:n,itemsPerRow:o});if(!i)return;const r=s({section:n,itemsPerRow:o});if(!r)return;return i.rowsBefore===r.rowsBefore}({indexLocal:r.indexLocal,section:d,itemsPerRow:n});if(void 0===p)return;if(!1===p)return c({store:t,sections:o,indexLocal:{section:r.section,indexLocal:u}});const m=function(e){const{currentSection:t,sections:n,disableWrap:o}=e;if(0===n.length)return;if(t&&t>=n.length&&o)return;const i=void 0===t?0:(t+1)%n.length,r=n[i];if(!r)return;return{index:i,section:r}}({currentSection:r.section,sections:o,disableWrap:i});if(!m)return;const f=r.indexLocal%n;return m.section.items.length<=f?c({store:t,sections:o,indexLocal:{section:m.index,indexLocal:0}}):c({store:t,sections:o,indexLocal:{section:m.index,indexLocal:f}})}function a(e){const{store:t,itemsPerRow:n,sections:o,disableKeyboardArrowWrap:r}=e,{focus:a}=t.state;if(void 0===a.indexLocal){return c({store:t,indexGlobal:i.tM(o)-1,sections:o})}const l=a.indexLocal-n;if(l>=0)return c({store:t,sections:o,indexLocal:{section:a.section,indexLocal:l}});const d=function(e){const{currentSection:t,sections:n,disableWrap:o}=e;if(0===n.length)return;if(0===t||void 0===t){if(o)return;const e=n.length-1,t=n[e];if(!t)return;return{index:e,section:t}}const i=n[t-1];if(!i)return;return{index:t-1,section:i}}({currentSection:a.section,sections:o,disableWrap:r});if(!d)return;const u=s({section:d.section,itemsPerRow:n});if(!u)return;const p=a.indexLocal%n;if(u.column<p)return c({store:t,sections:o,indexLocal:{section:d.index,indexLocal:u.indexLocal}});{const e=u.rowsBefore*n+p;return c({store:t,sections:o,indexLocal:{section:d.index,indexLocal:e}})}}function s(e){const{section:t,itemsPerRow:n}=e;if(0===t.items.length)return;if(0===n)return;const o=t.items.length-1,i=l({indexLocal:o,section:t,itemsPerRow:n});return i?{indexLocal:o,...i}:void 0}function l(e){const{indexLocal:t,section:n,itemsPerRow:o}=e;if(!(o<=0||t>=n.items.length))return{rowsBefore:Math.trunc(t/o),column:t%o}}function c(e){const{store:t,sections:n}=e;if(e.indexLocal){const o=i.$6(e.indexLocal,n);if(!i._K(e.indexLocal,n))return;t.setState({...t.state,focus:{...e.indexLocal,indexGlobal:o}})}else if(void 0===e.indexGlobal)t.unsetFocus();else{const o=i.Ds(e.indexGlobal,n);if(!o)return;t.setState({...t.state,focus:{...o.index,indexGlobal:e.indexGlobal}})}}function d(e){let{store:t,focus:n}=e;"number"==typeof t.state.focus.indexLocal&&(o.Xy(n,t.state.focus)||t.setState({...t.state,focus:n}))}},98958:(e,t,n)=>{n.r(t),n.d(t,{handleTokenRefresh:()=>m,initializeMobileNativeApp:()=>u,registerPushNotifications:()=>p,waitForCssInsets:()=>f});var o=n(68626),i=n(91155),r=n(29477),a=n(62643),s=(n(95477),n(24215)),l=n(54642),c=n(9953),d=n(39699);async function u(e){if(e.device.isMobileNative&&e.mobileNative&&(await f(e),e.mobileNative.updateReceiveApiHandlers({track:t=>{s.j(e,t.eventName,{...t.eventData,logging_source:"mobile_native"})}}),e.mobileNative&&e.mobileNative.sqliteConnection))try{await e.mobileNative.sqliteConnection.ensureMigrated(),e.mobileNative.sqliteConnection.optimize()}catch(t){o.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,i.Ui)(t),data:{}})}}async function p(e){const{mobileNative:t}=e;if(t&&t.api.registerPushNotifications){const n=await t.api.registerPushNotifications();n&&m(e,n,"registration")}}async function m(e,t,n){const o=e.currentUser.id;if(t&&o){const n=(0,a.r9)({user_id:o,token:t}),i=await l.syncRecordValue(e,{pointer:{table:a.q4,id:n},userId:o,version:-1});let r=!1;i&&(i.value&&!i.value.invalid||(d.createAndCommit({userAction:"mobileNativeActions.handleTokenRefresh",environment:e,perform:i=>{c.ae({environment:e,table:a.q4,value:{id:n,token:t,user_id:o,invalid:!1},inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,transaction:i})}}),r=!0))}}async function f(e){if(!e.device.isIOS||!e.device.isMobileNative)return;const t=document.createElement("div");t.style.width=`calc(${["env(safe-area-inset-top)","env(safe-area-inset-bottom)","env(safe-area-inset-left)","env(safe-area-inset-right)"].join(" + ")})`,t.style.visibility="hidden",document.body.appendChild(t);let n=0;for(;n<50&&!(t.offsetWidth>0);)await r.Vs(1),n++;document.body.removeChild(t),e.WindowSizeStore.updateWindowSize()}},29533:(e,t,n)=>{n.d(t,{R:()=>r,h:()=>a});var o=n(149),i=n(17294);function r(e,t){const n={taskStatus:e.taskStatus,...o.x.isSuccess(e)?{completeBlocks:e.value.completeBlocks,totalBlocks:e.value.totalBlocks}:{}};i.Z.update((e=>({...e,[t]:n})))}function a(e){i.Z.update((t=>({...t,[e]:void 0})))}},60870:(e,t,n)=>{n.d(t,{I0:()=>b,eX:()=>h,j2:()=>v,wS:()=>g});n(67294);var o=n(15157),i=n(72126),r=n(21202),a=n(63143),s=n(75770),l=n(98110),c=n(80444),d=n(35661),u=n(50906),p=n(76464),m=n(64964),f=n(85893);function g(e){const{environment:t,movedItems:n,previousParentIds:o,moveToLocation:i,disableSuccessToast:r,numSubitems:a}=e,c=n.some((e=>{const t=o[e.id],n=e.getParentId();return!(!t||t===n)}));!r&&c&&m.oV({label:(0,s.ah)({environment:t,movedItems:n,moveToLocation:i,numSubitems:a}),right:(0,f.jsx)(l.Z,{moveToLocation:i,movedItems:n})})}function h(e){const{environment:t,transaction:n,moveToStore:o,targetBlocks:i,from:r}=e,{currentUserStore:a}=c.default.state;null!=a&&a.isDefined()&&o.canEdit()&&!o.canAdmin()&&i.forEach((e=>{if(e.canAdmin())return u.Y8X(t,{from:r}),p.ep({transaction:n,store:e,environment:t,permissionItems:[{type:"user_permission",user_id:a.id,role:"editor"}]})}))}async function v(e,t,n){const r=await b(e,t),a=i.jj([n,...r]).slice(0,10);o.Z.set({userId:e.environment.currentUser.id,key:y(t),value:JSON.stringify(a)})}async function b(e,t){const n=o.Z.get({userId:e.environment.currentUser.id,key:y(t)});if(n){const t=(0,a.dj)(n);if(t){const n=await Promise.all(t.map((async t=>{const n=d.G.createChildStore(e,{table:r.iU,id:t});return await n.load(),n.canEdit()})));return t.filter(((e,t)=>n[t]))}}return[]}function y(e){return`recentMoveToTargets2:${e}`}},11302:(e,t,n)=>{n.d(t,{$X:()=>Y,QF:()=>J,RL:()=>ee,Ws:()=>ne,Y:()=>ie,at:()=>se,bA:()=>Q,kj:()=>oe,pB:()=>X,xv:()=>te,z1:()=>K});n(21703);var o=n(15145),i=n(41432),r=n(45433),a=n(59730),s=n(72126),l=n(4615),c=n(21202),d=n(6287),u=n(97880),p=n(5366),m=n(65273),f=n(19037),g=n(24215),h=n(33929),v=n(75770),b=n(98165),y=n(38755),S=n(5162),_=n(80444),w=n(77080),k=n(42330),I=n(98452),C=n(35661),x=n(52258),T=n(52229),M=n(50906),P=n(6404),A=n(49865),R=n(30188),D=n(47307),B=n(57400),E=n(94419),F=n(92625),Z=n(60870),L=n(72711),j=n(19785),V=n(9953),U=n(75018),O=n(24677),N=n(64964),z=n(29974),H=n(150),W=n(39699),q=n(68422),G=n(65452);const K=()=>[f._z,f.Gg,f.jl,f.ff(f.$I),f.ff(f.xw),f.ff(f.P9(i.Ti.externalObjectInstancePage)),f.ff(f.Vw),f.k5,f.ff(f.fS)],$=(0,p.defineMessages)({duplicatingContent:{id:"moveToMenuActions.duplicatingContent.loadingMessage",defaultMessage:"Duplicating content…"},duplicatedToSpace:{id:"moveToMenuActions.duplicatedToSpace.toast",defaultMessage:"Duplicated {name} to {spaceName}"}});function Q(e){const{environment:t,blocks:n,originRect:o,moveToContext:i,onAccept:a,isAddTo:s,isDefaultPrivateLocation:c,disableSuccessToast:d,forceUntyped:u}=e,p=Date.now(),m=(0,k.rJ)(n),f=function(e){const{hasDatabaseType:t,forceUntyped:n}=e;if(n)return r.br;if(t)return"typedUninitialized";return r.br}({forceUntyped:u,hasDatabaseType:Boolean(m)}),g=(0,l.ZP)();n.length&&(x.Z.reset(),I.Z.reset(),P.xv(),k.ZP.setState({variant:f,isOpen:!0,rect:o,targets:n,autocompleteQuery:"",moveToContext:i,onAccept:a,isAddTo:s,isDefaultPrivateLocation:c,lastPageId:k.ZP.state.lastPageId,disableSuccessToast:d,openedTimeMs:p,flowId:g}),M.rYq(t,{from:i,render_type:"web",target_block_ids:n.map((e=>e.id)),targets_database_type:m,flowId:g}))}async function Y(e){await async function(e){var t;const{environment:n,blocks:o,originRect:i,moveToContext:a,onAccept:s,isAddTo:c}=e,{currentSpaceStore:d}=_.default.state,u=Date.now(),p=k.ZP.state.isOpen?k.ZP.state.flowId:(0,l.ZP)(),m=(0,k.rJ)(o);if(m&&m!==r.GZ)return!1;if(!(0,S.Y)("supportsNativeMoveTo")||null===(t=n.mobileNative)||void 0===t||!t.api.moveTo||0===o.length||!d)return!1;const f=o.map((e=>e.id)),g=await n.mobileNative.moveTo({targets:f,spaceId:d.id,isAddTo:c||!1,moveToContext:a});if(!g)return!1;if(!g.supported||!g.destination)return g.supported;x.Z.reset(),I.Z.reset(),P.xv(),k.ZP.setState({variant:r.br,isOpen:!0,rect:i,targets:o,autocompleteQuery:"",moveToContext:a,onAccept:s,isAddTo:c,lastPageId:k.ZP.state.lastPageId,renderType:"mobileNative",openedTimeMs:u,flowId:p});const h=k.ZP.state.isOpen&&k.ZP.state.useSudoMode;return await X({environment:n,value:g.destination,useSudoMode:h,renderType:"native",isSearchResult:g.isSearchResult}),te(n),!0}(e)||Q(e)}function J(e,t,n){if("page"!==n.type)return!1;const o=new C.G(e,{table:c.iU,id:n.id}),i=(0,b.qA)(o);for(const r of i)if(t.includes(r.id))return!0;return!1}async function X(e){const{environment:t,value:n,useSudoMode:o,renderType:i,shouldClearPagePermissions:r,isSearchResult:a}=e;await W.createAndCommitAsync({environment:t,userAction:"MoveToMenuRenderer.completeMoveTransaction",waitForServerCommit:!1,useSudoMode:o,perform:async e=>{const o=k.ZP.state;if(!o.isOpen)return;const{targets:s,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,flowId:u,autocompleteQuery:p}=o;await ee({targets:s,value:n,transaction:e,environment:t,shouldClearPagePermissions:r,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,renderType:i,timeToSelectMs:Date.now()-o.openedTimeMs,flowId:u,isSearchResult:Boolean(p)||a}),o.onAccept&&o.onAccept(n)}})}async function ee(e){let{targets:t}=e;const{value:n,transaction:o,environment:r,shouldClearPagePermissions:a,disableSuccessToast:s,moveToContext:l,isDefaultPrivateLocation:p,renderType:m,timeToSelectMs:f,flowId:h,isSearchResult:y}=e,{currentSpaceStore:S}=_.default.state;if(!S)return;let I=[];w.default.checkGate("collection_subitem_nested_operations")&&(I=await R.xr({environment:r,blocks:t,options:{canEdit:!0}}),t=[...t,...I]),te(r);const C=S.id,x=function(e){const{type:t}=e;switch(t){case"page":case"collection":case"space-private-pages":case"team":return e.spaceId;case"space":return e.id;default:(0,u.t1)(t)}}(n);if(x&&C!==x){if(!(await(0,v.cJ)()))return}const T=t.find((e=>{const t=e.getType();return Boolean(t&&(0,i.S9)(t))})),P=T&&(0,b.VP)(T),A=(0,k.rJ)(t),D=Object.fromEntries(t.map((e=>[e.id,e.getParentId()]))),B=await oe({environment:r,value:n,targets:t,transaction:o,shouldClearPagePermissions:a});if(!B)return;const E=(0,v.HE)(n,r);Z.wS({environment:r,previousParentIds:D,movedItems:t,moveToLocation:E,disableSuccessToast:s,numSubitems:I.length});const F=T&&(0,b.VP)(T);M._T2(r,{table:B.table,from:l,type:null==E?void 0:E.type,team_before:P&&(0,g.nB)(P),team_after:F&&(0,g.nB)(F),targets_database_type:A,destination_database_type:B.table===d.v?B.getDatabaseType():void 0,isDefaultPrivateLocation:p,render_type:m,time_to_select_ms:f,flowId:h,isSearchResult:y}),B.table===c.iU&&await Z.j2(S,S.id,B.id)}function te(e){const t=k.ZP.state;k.ZP.setState({isOpen:!1,lastPageId:t.lastPageId}),O.ZH(e),t.isOpen&&"home_tab"===t.moveToContext&&U.navigateToHomeTab(e)}async function ne(e){return re({...e,action:"add"})}async function oe(e){return re({...e,action:"move"})}async function ie(e){return re({...e,action:"retain-alias"})}async function re(e){const{value:t,transaction:n,targets:i,shouldClearPagePermissions:r}=e;if("user_cancelled_move"===await H.Hl({transaction:n,moveStores:i,moveTargetStore:(0,v.uw)(t)}))return;r&&z.O2({blocks:i,transaction:n});const a=await async function(e){const{transaction:t,targets:n,value:i,environment:r,action:a}=e,{mainEditorCurrentBlockStore:s,currentSpaceStore:l,currentSpaceViewStore:d}=_.default.state,{id:p}=r.currentUser;if(!s||!p||!d)return;const f=(0,v.uw)(i);if(!f)return;if(f instanceof C.G&&w.default.checkGate("enable_text_crdt_client")&&(await f.load(),(0,m.iG)(f,n)))return void N.oV({label:"Cannot move a CRDT block into a non-CRDT parent or vice versa!"});let g;const{table:b}=f;switch(b){case"collection":case"block":g=await async function(e){const{environment:t,blockOrCollectionStore:n,targets:o,transaction:i,retainAliasInCurrentParent:r}=e;let a;await n.load(),a=n instanceof C.NW?n:n.isLinkedCollectionView()?n.getCollectionViewSourceOrLinkCollectionStores()[0]:n.isCollectionView()?n.getCollectionViewCollectionStore():n;if(!a)throw new Error("Move to store invalid.");for(const s of o){const e=s.getParentStore();if(e instanceof C.G&&r){const n=T.k({environment:t,parentBlock:e,targetStore:s,transaction:i});j.jG({parentStore:e.getContentStore(),after:s.id,childStore:n,transaction:i})}if(a instanceof C.G)j.jG({parentStore:a,childStore:s,transaction:i});else if(a instanceof C.NW){const e=A.o3({environment:t,stores:[s],collectionStore:a,transaction:i})[0];A.mp({environment:t,store:e,collectionStore:a,coerce:!0,groupsPointer:[],transaction:i}),j.zw({parentStore:a,childStore:e,transaction:i})}}return a}({environment:r,blockOrCollectionStore:f,targets:n,transaction:t,retainAliasInCurrentParent:"retain-alias"===a});break;case"space":g="space-private-pages"===i.type&&f.id===(null==l?void 0:l.id)?ae({environment:r,spaceStore:f,spaceViewStore:d,targets:n,transaction:t,currentUserId:p,retainAliasToBlock:"retain-alias"===a}):await async function(e){const{environment:t,transaction:n,currentSpaceViewStore:i,currentBlockStore:r,currentUserId:a,spaceStore:s,targets:l,action:d,value:u}=e;if("space"!==u.type&&u.spaceId&&u.spaceId!==s.id)throw new Error("Wrong value to move to another space");q._w({environment:t,blocks:l,transaction:n});const p=r.getSpaceId()||s.id;let m;if("move"===d&&("space"!==u.type&&u.spaceId&&u.spaceId!==p||"space"===u.type&&u.id!==p||"space-private-pages"!==u.type)){F.j({message:$.duplicatingContent,targetRecordId:s.id});const e=await z.eX({environment:t,blockStores:l,spaceId:s.id,targetParent:le(u)});if(F.x(),void 0!==e.error)return void D.showErrorMessage(e.error);m=e.value}else"space-private-pages"===u.type&&ae({environment:t,spaceStore:s,spaceViewStore:i,targets:l,transaction:n,currentUserId:a,retainAliasToBlock:"retain-alias"===d});await async function(e){const{environment:t,currentBlockStore:n,currentUserId:i,spaceStore:r,targets:a,crossSpaceTargetBlockId:s}=e,l=Boolean(a.find((e=>e.id===n.id))),d=(0,y.w3)(r.id);if(!l||!d)return;const u=s?C.G.createChildStore(n,{table:c.iU,id:s}):n;await G.l({environment:t,spaceId:r.id,userId:i}),await async function(e){const{environment:t,spaceStore:n,spaceViewStore:o,blockStore:i}=e;n&&o&&(_.default.setState({..._.default.state,currentSpaceStore:n,currentSpaceViewStore:o,mainEditorCurrentBlockStore:i}),await B.Yh(t))}({environment:t,spaceStore:r,spaceViewStore:d,blockStore:u}),L.ru({environment:t,blocks:[u],pageVisitSource:o.tY.Move})}({environment:t,currentBlockStore:r,currentUserId:a,targets:l,spaceStore:s,crossSpaceTargetBlockId:m}),m&&N.oV({label:h.default.formatMessage($.duplicatedToSpace,{name:(0,v.EC)({movedItems:l}),spaceName:s.getName()})});return s}({environment:r,transaction:t,currentSpaceViewStore:d,currentBlockStore:s,currentUserId:p,spaceStore:f,targets:n,value:i,action:a});break;case"team":g=se({environment:r,transaction:t,currentSpaceViewStore:d,teamStore:f,targets:n,value:i,action:a,location:{type:"append"}});break;default:(0,u.t1)(b)}"move"===a&&Z.eX({environment:r,transaction:t,moveToStore:f,targetBlocks:n,from:"move_to"});return g}({...e});return a||void 0}function ae(e){let{environment:t,spaceStore:n,spaceViewStore:o,targets:i,currentUserId:r,transaction:s,retainAliasToBlock:l}=e;for(const c of i){const e=c.getParentStore();if(e instanceof C.H2){if(e.id!==n.id)throw new a.D3("moveOrAddToPrivatePages: Try to move to a different space");E.Od({parent:e.getPagesStore(),childToRemove:c,transaction:s})}else if(e instanceof C.zX)H.sp({teamStore:e,store:c,transaction:s});else if(e instanceof C.G){if(l){const n=T.k({environment:t,parentBlock:e,targetStore:c,transaction:s});j.jG({parentStore:e.getContentStore(),after:c.id,childStore:n,transaction:s})}j.hr({parentStore:e,childStore:c,transaction:s})}const i={type:"user_permission",user_id:r,role:"editor"};V.sW({store:c,data:{permissions:[i]},transaction:s}),E.R3({parent:o.getPrivatePagesStore(),append:c,transaction:s})}return n}function se(e){let{transaction:t,currentSpaceViewStore:n,teamStore:o,targets:i,location:r,environment:a}=e;const l=n.getTeamsStores(),c=o.getTeamPagesStore();q._w({environment:a,blocks:i,transaction:t});for(const d of i){const e=s.sE(l,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(d.id)}));(null==e?void 0:e.id)!==o.id&&("append"===r.type?j.jG({parentStore:c,childStore:d,after:r.after,transaction:t}):"prepend"===r.type?j.SH({parentStore:c,childStore:d,before:r.before,transaction:t}):(0,u.t1)(r),e&&H.sp({teamStore:e,store:d,transaction:t}))}return o}function le(e){const{type:t}=e;switch(t){case"space":case"space-private-pages":return;case"page":return e.spaceId?{id:e.id,table:"block",spaceId:e.spaceId}:void 0;case"collection":case"team":return e.spaceId?{id:e.id,table:t,spaceId:e.spaceId}:void 0;default:(0,u.t1)(t)}}},17659:(e,t,n)=>{n.d(t,{$h:()=>R,E1:()=>A,G7:()=>E,Qy:()=>B,aY:()=>D,aZ:()=>P,go:()=>I,qQ:()=>F,rG:()=>T});var o=n(68626),i=n(91155),r=n(65311),a=n(5366),s=n(95477),l=n(33929),c=n(74948),d=n(24646),u=n(19034),p=n(80444),m=n(45325),f=n(88923),g=n(35661),h=n(4761),v=n(50906),b=n(19719),y=n(54642),S=n(47307),_=n(18957),w=n(39699);const k=(0,a.defineMessages)({archiveError:{id:"notificationActions.archiveNotification.errorMessage",defaultMessage:"Failed to archive. Please try again."},setReadError:{id:"notificationActions.setRead.errorMessage",defaultMessage:"Failed to mark notification as read. Please try again."},setAllAsReadError:{id:"notificationActions.setAllAsRead.errorMessage",defaultMessage:"Failed to mark all notifications as read. Please try again."},setUnreadError:{id:"notificationActions.setUnread.errorMessage",defaultMessage:"Failed to mark notification as unread. Please try again."}});async function I(e){const t=h.ZP.state.currentTab,{currentSpaceStore:n}=p.default.state;if(n&&!s.default.isAdminMode&&(0,h.g0)(t)){try{await y.setNotificationsAsRead(e,{spaceId:n.id,timestamp:Date.now(),type:t})}catch(r){return S.showErrorMessage(l.default.formatMessage(k.setAllAsReadError)),void o.log({level:"error",from:"notificationActions",type:"setCurrentUpdatesTabAsRead",error:(0,i.Ui)(r)})}x(t,n.id,C.decrementToZero)}}const C={incrementByOne:e=>e+1,decrementByOne:e=>Math.max(e-1,0),decrementToZero:e=>0};function x(e,t,n){const{results:o}=u.Z.state,i=o.map((o=>{if(o.spaceId===t){const t=o.unread[e];return void 0===t?o:{...o,unread:{...o.unread,[e]:n(t)}}}return o}));u.Z.setState({results:i})}async function T(e,t,n){const{currentSpaceStore:r}=p.default.state;if(r&&!s.default.isAdminMode){try{for(;;){if(!(await M({environment:e,currentSpaceStore:r,inbox:t,readFilter:n})).more)break}}catch(a){return S.showErrorMessage(l.default.formatMessage(k.archiveError)),void o.log({level:"error",from:"notificationActions",type:"archiveAll",error:(0,i.Ui)(a)})}"read"!==n&&x(t,r.id,C.decrementToZero)}}async function M(e){const{environment:t,currentSpaceStore:n,inbox:r,readFilter:a}=e,s=await y.getUnvisitedNotificationIds(t,{spaceId:n.id,timestamp:Date.now(),type:r,size:500,readFilter:a});if("failed"===s.type)return S.showErrorMessage(l.default.formatMessage(k.archiveError)),o.log({level:"error",from:"notificationActions",type:"archiveApiError",error:(0,i.Ui)(s.error)}),{more:!1};const{notificationIds:c}=s.data;return await async function(e){const{environment:t,notificationIds:n,rootStore:o}=e,{serverCommitResult:i}=w.createAndCommit({userAction:"notificationActions.archiveNotificationIds",environment:t,canUndo:!0,undoCheckpoint:!0,perform:e=>{for(const t of n)A({transaction:e,rootStore:o,visited:!0,notificationId:t})}});await i}({environment:t,notificationIds:c,rootStore:n}),c.length>=500?{more:!0}:{more:!1}}function P(e){const{notification:t,rootStore:n,transaction:a}=e;if(!t.visited){try{A({notificationId:t.id,rootStore:n,transaction:a,visited:!0})}catch(s){return S.showErrorMessage(l.default.formatMessage(k.archiveError)),void o.log({level:"error",from:"notificationActions",type:"archiveNotification",error:(0,i.Ui)(s)})}if(!t.read){x(r.hE[t.type],t.space_id,C.decrementByOne)}}}function A(e){const{transaction:t,notificationId:n,rootStore:o,visited:i}=e,a=(0,g.Kv)(o,{table:r.uX,id:n});w.applyOperation({transaction:t,store:a,operation:{command:"update",pointer:{table:r.uX,id:n},path:[],args:i?{visited:!0,read:!0,archived_at:Date.now()}:{visited:!1,archived_at:null}}})}function R(e){const{transaction:t,notification:n,rootStore:a,read:s}=e;if(n.read===s)return;const c=(0,g.Kv)(a,{table:r.uX,id:n.id});try{w.applyOperation({transaction:t,store:c,operation:{command:"update",pointer:{table:r.uX,id:n.id},path:[],args:{read:s}}})}catch(d){return e.suppressErrorMessage||S.showErrorMessage(l.default.formatMessage(s?k.setReadError:k.setUnreadError)),void o.log({level:"error",from:"notificationActions",type:"setRead",error:(0,i.Ui)(d)})}x("mentions",n.space_id,s?C.decrementByOne:C.incrementByOne)}function D(){return u.Z.getUnreadCountForCurrentSpace().mentions}async function B(e){const{environment:t}=e,{currentSpaceStore:n}=p.default.state;if(!n)return[];const o=await y.getUnvisitedNotificationIds(t,{spaceId:n.id,timestamp:Date.now(),type:"mentions",size:100,readFilter:"unread"});return"failed"===o.type?[]:o.data.notificationIds}function E(e){let{environment:t,newTab:n,shouldTrack:o}=e;const i=h.ZP.state.currentTab;if(i!==n&&("mentions"===n?h.ZP.update((e=>({...e,currentTab:n,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}))):h.ZP.update((e=>({...e,currentTab:n})))),o){const e=t.device.isMobile;b.GP({environment:t,forceRestartSession:!1,from:"updates-tab-click"}),e&&v.nBz(t,{itemName:"updates"})}"mentions"===i&&async function(e){const t=await y.getUserNotifications(e,{size:1e3});if("failed"===t.type)return;const{results:n}=t.data;u.Z.setState({results:n})}(t)}function F(e){const{environment:t,open:n}=e;n?(m.ZP.setState({...m.ZP.state,openState:"opening",currentTab:m.ez[0]}),(0,d.Sx)(t)&&c.setUpdateExpand({environment:t,isExpanded:!1,from:"close_for_space"}),f.default.isSidePeekOpen()&&_.xv(t,"inbox_panel_expand")):m.ZP.setState({...m.ZP.state,openState:"closing"})}},36110:(e,t,n)=>{n.d(t,{V:()=>f,g:()=>m});var o=n(74181),i=n(56589),r=n(82036),a=n(89101),s=n(9852),l=n(64002),c=n(63143),d=n(54642),u=n(47307),p=n(75018);function m(e){const{environment:t,responseType:n,integrationId:o,redirectUri:i,state:r,owner:s,userId:d,spaceId:u}=e,m=l.bf({url:a._j.oauthAuthorization,query:(0,c.m8)(Object.entries({response_type:n,client_id:o,redirect_uri:i,state:r,owner:s,user_id:d,space_id:u}).filter((e=>{let[,t]=e;return t})))});p.navigate({environment:t,url:m,redirect:!0})}async function f(e){const{environment:t,params:n,integration:c}=e;s.setOauthAuthorizationParams(void 0);const m=c&&i._(c,n.redirectUri);if(!m)return void p.navigate({environment:t,url:a._j.root,redirect:!0});let g;if("errorType"in e)g={error:e.errorType,state:n.state};else{const{integration:i,spaceId:a,blockIdsForBot:s,acceptedIntegrationCapabilities:l}=e;let c;if(c=(0,o.VM)(i)?await d.createOauthAuthorizationCode(t,{integrationId:i.id,spaceId:a,redirectUri:n.redirectUri,acceptedIntegrationCapabilities:l}):await d.createOauthAuthorizationCode(t,{integrationId:i.id,spaceId:a,redirectUri:n.redirectUri,blockIdsForBot:s,templatePageId:e.templatePageId,acceptedIntegrationCapabilities:l}),"failed"===c.type){u.showError(c);return f({environment:t,params:n,integration:i,errorType:503===c.status?r._.temporarily_unavailable:r._.server_error})}g={code:c.data.code,state:n.state}}const h=l.bf({url:m,query:{...g}});p.navigateToExternalURL({environment:t,url:h,targetSelf:!0})}},15356:(e,t,n)=>{n.d(t,{M:()=>m});var o=n(29477),i=n(89101),r=n(64002),a=n(5366),s=n(95477),l=n(33929),c=n(77080),d=n(47307),u=n(47839);const p=(0,a.defineMessages)({allowPopup:{id:"authAction.authorize.popupBlocked",defaultMessage:"It looks like your browser is currently blocking popups. Please allow pop-ups to continue"},dismissButtonLabel:{defaultMessage:"Okay",id:"dialog.dismissButton.label"}});async function m(e,t){const{width:n,height:a,url:c,titleMessage:m}=t,g=l.default.formatMessage(m);if(e.device.isElectron)return u.openOauthPopup({width:n,height:a,url:c,title:g});const h=e.device.isMobile,v=void 0!==window.screenX?window.screenX:window.screenLeft,b=void 0!==window.screenY?window.screenY:window.screenTop,y=void 0!==window.outerWidth?window.outerWidth:document.documentElement.clientWidth,S=void 0!==window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,_=h?0:n,w=h?0:a;let k="toolbar=0,menubar=0,location=0";0!==_&&(k+=`,width=${_}`),0!==w&&(k+=`,height=${w}`),k+=`,left=${(v<0?window.screen.width+v:v)+(y-_)/2}`,k+=`,top=${b+(S-w)/2.5}`,k+=",scrollbars=1";const I=f()?(0,r.bf)({url:`${s.default.domainBaseUrl}${i._j.verifyNoPopupBlockerHtmlAndRedirect}`,query:{redirectUri:c}}):c,C=window.open(I,g,k);if(C)C.focus();else if(f())return void d.showDialog({showCancel:!1,keepFocus:!1,message:l.default.formatMessage(p.allowPopup),items:[{label:l.default.formatMessage(p.dismissButtonLabel),onAccept:()=>{}}]});const x=o.UZ(),T=e=>{if(e&&e.data&&"popup-callback"===e.data.type){const t=e.data.url;x.resolve(t)}},M=setInterval((()=>{const e=localStorage.getItem("externalAuthCallback");e?x.resolve(e):C&&C.closed&&x.resolve(void 0)}),300);window.addEventListener("message",T,!1);const P=await x.promise;return window.removeEventListener("message",T,!1),localStorage.removeItem("externalAuthCallback"),clearInterval(M),C&&C.close(),window.focus(),P}function f(){return"on"===c.default.getEligibleGroup({experimentId:"show_instruction_on_auth_popup_blocked",defaultGroup:"control"})}},89858:(e,t,n)=>{n.d(t,{A5:()=>ee,B8:()=>W,D0:()=>q,Eo:()=>X,LR:()=>J,NP:()=>Y,kC:()=>G,mv:()=>K,pq:()=>$,v9:()=>Q});n(21703),n(57658),n(67294);var o=n(15145),i=n(41432),r=n(15157),a=n(72126),s=n(27006),l=n(29369),c=n(5366),d=n(35683),u=n(65273),p=n(75770),m=n(35026),f=n(38755),g=n(95697),h=n(81844),v=n(74948),b=n(80444),y=n(55367),S=n(42330),_=n(35661),w=n(78291),k=n(34583),I=n(88893),C=n(73292),x=n(50906),T=n(48299),M=n(98834),P=n(47307),A=n(94419),R=n(13084),D=n(60870),B=n(11302),E=n(19785),F=n(76464),Z=n(9953),L=n(75018),j=n(29974),V=n(28014),U=n(150),O=n(39699),N=n(68422),z=n(1742),H=n(85893);function W(e,t){return`${e.id}:${t}`}function q(e){var t;const{environment:n,store:r,transaction:a,navigateToParent:s}=e,l=Z.j4({environment:n,type:i.Ti.page,inMemoryRecordCache:r.inMemoryRecordCache,transaction:a,spaceId:r.isCollectionView()?null===(t=r.getCollectionViewCollectionStore())||void 0===t?void 0:t.pointer.spaceId:r.pointer.spaceId,useCrdt:!1}),c=r.getAssociatedCollectionStore();if(r.isCollectionView()){const e=r.getCollectionViewCollectionStore()||c;if(!e)throw new Error("getCollectionViewCollectionStore() returned undefined");if(!E.zw({parentStore:e,childStore:l,transaction:a}))throw new Error("parentChildActions.moveToCollection() returned false");const t=e.getDefaultTemplatePageStore();t&&M.ob({title:"template",environment:n,store:l,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:a,from:"outliner_actions"})}r.isCollectionView()||E.jG({parentStore:r.getContentStore(),childStore:l,transaction:a}),S.ZP.setState({...S.ZP.state,lastPageId:b.default.state.mainEditorCurrentBlockStore?b.default.state.mainEditorCurrentBlockStore.id:void 0}),n.device.isMobile?L.navigateToBlock({environment:n,store:l,showMoveTo:!1,saveParent:!1,visitType:d.vu.Link,pageVisitSource:o.tY.Create}):L.peekBlock({environment:n,store:l,showMoveTo:!0,saveParent:!1,currentBlockStore:s?r:void 0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:o.tY.Create}),x.W2j(n,{from:"sidebar_outliner_item",type:"page",new_page_id:l.id})}async function G(e){const{environment:t,spaceStore:n,spaceViewStore:i,type:r,prepend:a,outlinerToggleButtonStore:s,shouldPersistToggleState:l,title:u,useCrdt:p}=e,m=new z.sA(t,"createPageInSection");if(k.M_(t)){if("workspace"===r){const{data:e}=w.default.state,t=e?(0,I.su)(e):1;if(t>=10){if(!(await P.confirmUserAction({message:(0,H.jsx)("span",{children:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Are you sure you want to create a new top-level page? <strongtext>This page will be visible in the sidebar to all {memberCount} members of your workspace.</strongtext>",id:"sidebarActions.confirmDialog.newWorkspacePage.message",values:{strongtext:e=>(0,H.jsx)("strong",{children:e}),memberCount:t}})}),acceptLabel:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Create top-level page",id:"sidebarActions.confirmDialog.newWorkspacePage.confirmButton.label"})})))return null}}const{serverCommitResult:e,performResult:{createdPage:f}}=O.createAndCommit({userAction:"outlinerActions.createPageInSection",environment:t,perform:e=>{const o=V.KE({environment:t,spaceStore:n,spaceViewStore:i,isPrivate:"private"===r,prepend:a,transaction:e,title:u,tracker:m,useCrdt:p});return s&&X({environment:t,spaceViewStore:i,type:r,outlinerToggleButtonStore:s,newIsHidden:!1,shouldPersistToggleState:Boolean(l)}),t.device.isMobile&&v.close(),{createdPage:o}}});"private"===r?x.W2j(t,{from:"sidebar_private_section",type:"page",new_page_id:f.id}):"workspace"===r&&x.W2j(t,{from:"sidebar_workspace_section",type:"page",new_page_id:f.id});const g=n.getDisableSpacePageEdits();return"workspace"===r&&g&&await e,L.navigateToBlock({environment:t,store:f,visitType:d.vu.Link,pageVisitSource:o.tY.Create}),f}}async function K(e){const{environment:t,spaceStore:n,spaceViewStore:i,teamStore:r,andNavigate:a,from:s,outlinerToggleButtonStore:l,shouldPersistToggleState:c,title:u,loading:p,appendOrPrepend:m}=e,{serverCommitResult:f,performResult:{createdPage:g}}=O.createAndCommit({userAction:"outlinerActions.createPageInTeam",environment:t,perform:e=>({createdPage:$({environment:t,spaceStore:n,spaceViewStore:i,teamStore:r,from:s,title:u,loading:p,appendOrPrepend:m,transaction:e})})});return await f,a&&L.navigateToBlock({environment:t,store:g,visitType:d.vu.Link,pageVisitSource:o.tY.Create}),l&&C.k7({environment:t,spaceViewStore:i,teamStore:r,outlinerToggleButtonStore:l,newIsHidden:!1,shouldPersistToggleState:Boolean(c),isExplicitUserAction:!1}),g}function $(e){const{environment:t,spaceStore:n,spaceViewStore:o,teamStore:i,from:r,title:a,loading:s,appendOrPrepend:c,transaction:d}=e;if(!(0,m.si)({teamStore:i,environment:t}))throw new Error("User is not eligible to create top-level page in team");const u=V.KE({environment:t,spaceStore:n,spaceViewStore:o,isPrivate:!1,prepend:!1,title:a,loading:s,transaction:d});x.tPt(t,{teamStore:i,from:r,pageId:u.id,transaction:d}),F.u9({store:u,transaction:d});const f=(0,p.uw)({type:"team",id:i.id});if(f.table!==l.e0)throw new Error("Assertion failure, moveToStore table is not TeamTable!");return B.at({environment:t,transaction:d,action:"add",teamStore:f,currentSpaceViewStore:o,targets:[u],value:{type:"team",id:i.id},location:{type:c}}),u}async function Q(e){var t,n;const{environment:o,droppedStores:r,droppedDirection:a,type:l,targetStore:d,targetParentStore:m}=e,g=await(0,p.ed)({environment:e.environment,blocks:r,from:"dragAndDrop",dropArgs:{direction:a,destination:d,destinationOutlinerType:l}});if(!g.confirmed)return;const{shouldClearPagePermissions:v}=g;if(1===r.length&&(null===(t=m.getValue())||void 0===t||null===(n=t.includes)||void 0===n||!n.call(t,r[0].id))){let e=[];for(const n of r)if(e=await T.NN({environment:o,block:n,action:"move"}),"user_canceled"===e)return;const t=r[0].id;for(const n of e)n.id!==t&&r.push(n)}const S=Object.fromEntries(r.map((e=>[e.id,e.getParentId()]))),{performResult:{moved:k}}=await O.createAndCommitAsync({environment:o,userAction:"outlinerActions.confirmAndHandleDrop",waitForServerCommit:!0,perform:async t=>({moved:await async function(e){const{environment:t,type:n,droppedDirection:o,targetStore:r,targetParentStore:a,droppedStores:l,transaction:d,isTopLevelItem:m,shouldClearPagePermissions:g}=e,v=function(e){for(const t of e){const e=h.Z.findOutlinerItemFromStore(t);if(e)return e.type}}(l),{currentSpaceStore:S,currentUserStore:k}=b.default.state,C=null==S?void 0:S.id,{data:x}=w.default.state,T="bookmarks"===v&&"bookmarks"===n,M=te(e),A=C&&l.some((e=>e.isTopLevelWorkspacePage(C))),B=r&&C&&r.isTopLevelWorkspacePage(C),E=null==S?void 0:S.getDisableSpacePageEdits();if(C&&E&&(A||B)&&!T&&o!==y.vh.Onto&&null!=k&&k.isDefined()&&x){const e=(0,I.hn)(x).filter((e=>e.userId===k.id))[0];if(e&&!s.zz(e.role))return P.showErrorMessage((0,H.jsx)(c.FormattedMessage,{defaultMessage:"This workspace has locked top-level workspace page operations.",id:"sidebarActions.confirmDialog.lockedWorkspaceTopLevel.message"})),!1}const F=function(e){let{targetStore:t,targetParentStore:n}=e;if(t)return t;const{id:o,table:i}=n;let r;switch(i){case"space":case"space_view":r={type:"space",id:o};break;case"block":r={type:"page",id:o};break;case"team":r={type:"team",id:o};break;default:throw new Error("Unexpected table type")}return(0,p.uw)(r)}({targetStore:r,targetParentStore:a});if(function(e){const{droppedDirection:t,targetStore:n,droppedStores:o,targetParentStore:i}=e,r=t===y.vh.Onto?n:i.getRecordStoreAtRootPath();if(!(r instanceof _.G))return!1;return(0,u.iG)(r,o)}(e))return P.deprecatedShowErrorMessage("Cannot move a CRDT block into a non-CRDT parent or vice versa!"),!1;if(!T&&!M){if("user_cancelled_move"===await U.Hl({transaction:d,moveStores:l,moveTargetStore:F}))return!1}D.eX({environment:t,transaction:d,moveToStore:F,targetBlocks:l,from:"drag_and_drop"});const L=function(e){const{environment:t,type:n,targetStore:o,targetParentStore:r,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c}=e,{currentSpaceViewStore:d,currentSpaceStore:u,currentUserSettingsStore:p}=b.default.state;let m;const g=null==o?void 0:o.getModel();if(a===y.vh.Onto&&o&&r&&null!=g&&g.isType(i.m3))m=R.LQ({environment:t,targetParentStore:r,targetStore:o,droppedDirection:y.vh.Below,droppedStores:s,duplicate:l,transaction:c});else if(te(e)&&o){if(!d||!p)throw new Error("currentSpaceViewStore or currentUserSettingsStore not found");const{visibleSharedPagesStores:e}=(0,f.MC)({environment:t,spaceViewStore:d,userSettingsStore:p}).state,n=e.map((e=>e.id)),i=s.map((e=>e.id)),r=n.filter((e=>i.indexOf(e)<0)),l=r.findIndex((e=>e===o.id));let u=[];u=a===y.vh.Above?[...r.slice(0,l),...i,...r.slice(l)]:[...r.slice(0,l+1),...i,...r.slice(l+1)],Z.sW({store:d,data:{shared_pages:u},transaction:c}),m=s}else"private"===n&&u&&d&&V.OQ({environment:t,spaceStore:u,spaceViewStore:d,transaction:c}),m=R.LQ({environment:t,targetParentStore:r,targetStore:o,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c});return m}(e),O=L.filter((e=>e.isTopLevel()));g&&j.O2({blocks:L,transaction:d});"workspace"===n?j.lF({environment:t,blocks:O,transaction:d}):"private"===n&&j.IY({environment:t,blocks:O,transaction:d});m&&o!==y.vh.Onto&&N._w({environment:t,blocks:l,transaction:d});return!0}({...e,transaction:t,shouldClearPagePermissions:v})})});k&&D.wS({environment:o,movedItems:r,previousParentIds:S,moveToLocation:(0,p.vz)({targetStore:d,droppedDirection:a,outlinerSectionType:l,environment:o})})}async function Y(e){const{droppedStores:t,duplicate:n}=e.dropArgs,{environment:o,type:i,isTopLevel:r,parentStore:a}=e,s=y.vh.Below;return!!a&&(await Q({environment:o,type:i,targetParentStore:a,isTopLevelItem:r,droppedDirection:s,droppedStores:t,duplicate:n}),!0)}function J(e){const{environment:t,store:n,parentStore:o,insertStores:i,transaction:r,before:s,type:l}=e,{currentSpaceViewStore:c,currentSpaceStore:d}=b.default.state,u=a.d9(i).reverse();"private"===l&&d&&c&&V.OQ({environment:t,spaceStore:d,spaceViewStore:c,transaction:r});const p=s?i.map((e=>A.Vt({parent:o,insert:e,before:n,transaction:r}).child)):u.map((e=>A.BE({parent:o,insert:e,after:n,transaction:r}).child)),m=p.filter((e=>e.isTopLevel()));return"workspace"===l?j.lF({environment:t,blocks:m,transaction:r}):"private"===l&&j.IY({environment:t,blocks:m,transaction:r}),p}function X(e){const{environment:t,spaceViewStore:n,type:o,outlinerToggleButtonStore:i,newIsHidden:a,shouldPersistToggleState:s}=e;i.setState({...i.state,isHidden:a}),x.VSH(t,{is_toggled:!a,outliner_type:o}),s&&r.Z.set({userId:n.environment.currentUser.id,key:W(n,o),value:a})}function ee(e){const{type:t,targetStore:n,targetParentStore:o,transaction:i,isTopLevelItem:r}=e,a=(0,g.bq)()&&"team"===t&&o.table===l.e0&&r;if(A.Od({childToRemove:n,parent:o,transaction:i}),a&&n.getParentId()===o.id){const t=_.zX.createChildStore(e.targetParentStore,{...e.targetParentStore.pointer,table:l.e0});U.sp({teamStore:t,store:n,transaction:i})}}function te(e){let{type:t,droppedDirection:n,isTopLevelItem:o}=e;return"shared"===t&&n!==y.vh.Onto&&o}},65889:(e,t,n)=>{n.d(t,{I:()=>o,O:()=>i});const o=function(e){const{key:t,overlayContainerStore:n}=e;n.state.overlays.has(t)||(n.state.overlays.add(t),n.emit())},i=function(e){const{key:t,overlayContainerStore:n}=e;n.state.overlays.has(t)&&(n.state.overlays.delete(t),n.emit())}},72711:(e,t,n)=>{n.d(t,{Y_:()=>I,bo:()=>x,hc:()=>k,ru:()=>C,tk:()=>T});n(21703);var o=n(1302),i=n(41432),r=n(72126),a=n(4615),s=n(21202),l=n(6287),c=n(19889),d=n(78316),u=n(84210),p=n(89014),m=n(58202),f=n(80444),g=n(35661),h=n(26664),v=n(52229),b=n(96802),y=n(94419),S=n(9953),_=n(75018),w=n(39699);const k=function(e){const{environment:t,store:n,targetStore:o,transaction:i}=e,r=n.getParentBlockStore();if(r){const e=r.getContentStore(),a=v.k({environment:t,parentBlock:r,targetStore:o,transaction:i});return y.rS({parent:e,oldChild:n,newChild:a,transaction:i}).child}throw new Error("Could not create alias block.")};function I(e){const{environment:t,store:n,collectionStore:r,collectionViewStore:u,transaction:f}=e,{id:v}=t.currentUser,b=n.getRecordStoreUIParent();if(null!=b&&b.valueIs(h.i)){if(!n.isDefined())throw new Error("Block to replace was not defined.");if(b&&v){var _,w;const e=Date.now(),h=(0,a.ZP)(),k=null===(_=(0,d.Vv)(r))||void 0===_?void 0:_.getFormatStore().getKeyStore("table_properties").getValue(),I=null===(w=(0,d.Vv)(r))||void 0===w||null===(w=w.getQueryStore())||void 0===w?void 0:w.getKeyStore("sort").getValue(),C={id:(0,a.ZP)(),version:0,type:"table",parent_id:h,parent_table:"block",alive:!0,space_id:n.getSpaceId(),format:{table_properties:k,collection_pointer:{table:l.v,id:r.id,spaceId:r.pointer.spaceId}},query2:{sort:I}};S.ae({environment:t,table:"collection_view",value:C,inMemoryRecordCache:n.inMemoryRecordCache,transaction:f});const x={id:h,type:i.Ti.collectionView,view_ids:[C.id],properties:{},parent_id:b.id,parent_table:"block",alive:!0,created_by_table:c.KJ,created_by_id:v,created_time:e,last_edited_by_table:c.KJ,last_edited_by_id:v,last_edited_time:e,space_id:n.getSpaceId()};S.ae({environment:t,table:"block",value:x,inMemoryRecordCache:n.inMemoryRecordCache,transaction:f});const T=y.rS({parent:b,oldChild:n,newChild:g.G.createChildStore(b,{table:s.iU,id:h}),transaction:f}).child;return(0,p.u)(C.id,{viewPointer:null==u?void 0:u.pointer}),o.default.afterNextFlush((()=>{const e=m.R.findBlockFromStoreWithMethod(T,"handleCreated");e&&e.handleCreated()})),T}}}function C(e){const{environment:t,blocks:n,openInNew:o,pageVisitSource:i}=e,r=n[0];if(o){const e=(0,u.ZP)({store:r,pageVisitSource:i});_.navigate({environment:t,url:e,openInNew:o})}else{const e=r.recordStoreUIParentStore instanceof g.G&&r.recordStoreUIParentStore.isCollectionView(),{mainEditorCurrentBlockStore:n}=f.default.state;if(e&&n){const e=(0,u.ZP)({store:n,fullyQualified:!1,peekViewBlockId:r.id,pageVisitSource:i});_.navigate({environment:t,url:e})}else _.navigateToBlock({environment:t,store:r,pageVisitSource:i})}}function x(e){const{environment:t,store:n,lock:o}=e,{id:i}=t.currentUser;if(!i)return;const r={block_locked:o,block_locked_by:i};w.createAndCommit({userAction:"pageBlockActions.setPageLock",environment:t,perform:e=>{S.sW({store:n.getFormatStore(),data:r,transaction:e})}})}function T(e){const{transaction:t,store:n,coverStore:o,pageCovers:i}=e,a=Object.keys(i),s=i[a[r.MX(0,a.length-1)]],l=s.items[r.MX(0,s.items.length-1)],c=l.coverUrl,d=l.position;S.sO({store:o,value:c,transaction:t}),b.Mp({store:n,coverPosition:d,transaction:t})}},30581:(e,t,n)=>{n.d(t,{P:()=>a});var o=n(55320),i=n(50906),r=n(54642);function a(e,t,n){i.Pu8(t,{page_id:e.id,searchSessionId:o.default.state.sessionId,spaceId:e.getSpaceId(),pageVisitId:n.getCurrentPageVisitId()}),r.recordPageExit(t,{block:{id:e.id,spaceId:e.getSpaceId()},timestamp:Date.now()})}},25320:(e,t,n)=>{n.d(t,{Ri:()=>v,UX:()=>h,s4:()=>g});var o=n(72126),i=n(21202),r=n(70017),a=n(89470),s=n(23867),l=n(97880),c=n(67669),d=n(65598),u=n(80444),p=n(89087),m=n(35661),f=n(54642);const g=100;async function h(e,t){await u.default.waitUntilRendered();const{fromPageRefresh:n,block:o,pageVisitStore:l,timestamp:g}=t,h=e.currentUser.id;if(void 0===h||n)return;t.block.id!==l.state.pageId&&l.setState({...l.getInitialState(),pageId:t.block.id});const v=(0,m.Kv)(o,{table:a.UI,id:(0,a.Pv)({parent_id:o.id,user_id:h}),spaceId:(0,s.C)(o.pointer.spaceId)}),y=(0,m.Kv)(o,{table:r.Kk,id:(0,a.Pv)({parent_id:o.id,user_id:h}),spaceId:(0,s.C)(o.pointer.spaceId)});if(await p.transactionQueue.awaitRecordTransaction({table:i.iU,id:o.id}),await(0,d.M1)(o),!o.canRead()||(0,c.IJ)(e,o))return;await v.load(),await y.load();const S=v.getKeyStore("visited_at").getValue(),_=y.getKeyStore("exited_at").getValue(),w=await async function(e,t,n,o){const{id:i}=e.currentUser;var r;i&&(null==e||null===(r=e.mobileNative)||void 0===r||r.recordPageVisit(i,{blockId:t,spaceId:n,visitedAt:o}));return await f.recordPageVisit(e,{block:{id:t,spaceId:n},timestamp:o})}(e,o.id,(0,s.C)(o.pointer.spaceId),g);if("failed"===w.type)return;const k=b({pageVisits:w.data.pageVisits,omittedUserIds:[],currentState:l.state,block:o});l.state.pageId===o.id&&l.setState({...k,lastViewTime:S,lastExitTime:_})}async function v(e,t){await u.default.waitUntilRendered();const n=e.currentUser.id;if(void 0===n)return;const{block:i,pageVisitStore:r,incremental:a}=t,c=t.limit||32;let d;if(a){const{pageId:e,lastViewTime:t,lastExitTime:i,omittedUserIds:a,...s}=r.state,c=Object.entries(s).map((e=>{let[t,o]=e;if(n===t)return;const i=o.getVisitedAt();return void 0!==i?i+1:void 0}));d=o.Fp(c.filter(l.$K))}const p=await f.getPageVisitors(e,{block:{id:i.id,spaceId:(0,s.C)(i.pointer.spaceId)},sinceTimestamp:d,limit:c});if("failed"===p.type)return;const m=b({pageVisits:p.data.pageVisits,omittedUserIds:p.data.omittedUserIds,block:i,currentState:r.state});let h;if(Object.keys(m).length<=g)h=m;else{const{pageId:e,lastViewTime:t,lastExitTime:n,omittedUserIds:i,...r}=m,a=(0,l.qP)(r).map((e=>{let[t,n]=e;return[t,n.getVisitedAt()??0]}));h={pageId:e,omittedUserIds:i,lastViewTime:void 0,lastExitTime:void 0};const s=o.MR(a,(e=>{let[,t]=e;return-t})).slice(0,g);for(const[o]of s)h[o]=m[o]}r.state.pageId===m.pageId&&r.setState(h)}function b(e){const{block:t,pageVisits:n,currentState:o,omittedUserIds:i}=e,r={...o,pageId:t.id,omittedUserIds:[...o.omittedUserIds,...i]};for(const l of n){const{id:e,user_id:n}=l;n in r||(r[n]=m.t1.createChildStore(t,{table:a.UI,id:e,spaceId:(0,s.C)(t.pointer.spaceId)}))}return r}},19785:(e,t,n)=>{n.d(t,{SH:()=>p,hh:()=>l,hr:()=>d,jG:()=>u,nO:()=>c,rS:()=>m,zw:()=>s});n(21703);var o=n(79317),i=n(65598),r=n(9953),a=n(39699);const s=e=>{const{childStore:t,parentStore:n,transaction:o}=e,i=t.getRecordStoreAtRootPath().getValue(),r=n.getParentBlockStore();if(r&&r.isCollectionViewPageWithContent())return u({parentStore:r,childStore:t,transaction:o}),!0;if(i){const{parent_id:e,parent_table:r,alive:s}=i;if(e!==n.id||r!==n.table||!s)return a.applyOperation({store:n,operation:{pointer:t.pointer,path:[],command:"setParent",args:{parentId:n.id,parentTable:n.table}},transaction:o}),!0}return!1},l=e=>{const{childStore:t,transaction:n}=e;if((0,i.OY)(t)){const e=t,o=e.getAssociatedCollectionStore();if(null!=o&&o.isPageTreeCollection()){const o=t.getParentBlockStore();o&&d({childStore:e,parentStore:o,transaction:n})}}t.getRecordStoreAtRootPath().getAlive()&&r.sW({store:t,data:{alive:!1},transaction:n})},c=e=>{const{pageStore:t,transaction:n}=e;t.getRecordStoreAtRootPath().getAlive()&&r.sW({store:t,data:{alive:!1},transaction:n})},d=e=>{const{childStore:t,parentStore:n,transaction:i}=e,r=(0,o.A6)(n.table,t.table);if(!r)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:r,command:"removeChild",args:{id:t.id}},transaction:i})},u=e=>{const{childStore:t,parentStore:n,transaction:i}=e,r=(0,o.A6)(n.table,t.table);if(!r)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:r,command:"insertChildrenAfter",args:{ids:[t.id],after:e.after}},transaction:i})},p=e=>{const{childStore:t,parentStore:n,transaction:i}=e,r=(0,o.A6)(n.table,t.table);if(!r)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:r,command:"insertChildrenBefore",args:{ids:[t.id],before:e.before}},transaction:i})},m=function(e){const{parentStore:t,oldChildStore:n,newChildStore:o,transaction:i}=e,r=n.id;(t.getValue()||[]).indexOf(r)>=0&&(u({parentStore:t,childStore:o,transaction:i,after:r}),d({parentStore:t,childStore:n,transaction:i}))}},19358:(e,t,n)=>{n.d(t,{D0:()=>h,If:()=>v,YM:()=>g});n(57658);var o=n(73360),i=n(18844),r=n(21202),a=n(6287),s=n(70279),l=n(91644),c=n(15047),d=n(77858),u=n(29369),p=n(66079),m=n(65273),f=n(9953);function g(e){const{childStore:t,parentStore:n,transaction:o}=e,i=t.getRecordStoreAtRootPath().getValue();if(i){const{parent_id:r,parent_table:a,alive:s}=i;r===n.id&&a===n.table&&s===e.alive||(f.sW({store:t,data:{parent_id:n.id,parent_table:n.table,alive:e.alive},transaction:o}),o.postPerformAssertions.push((()=>{(0,m.be)({parentStore:n,childStore:t})})))}}function h(e){if((0,o.hL)(e.childStore.table)){const t=e.childStore;return function(e){const{childStore:t,parentStore:n,transaction:o}=e,m=t.getRecordStoreUIParent();if(n.table===c.bx&&t.table===r.iU||n.table===u.e0&&t.table===r.iU||n.table===p.dx&&t.table===d.zU||n.table===i.Xj&&t.table===r.iU||n.table===l.AT&&t.table===r.iU)g({childStore:t,parentStore:n,alive:!0,transaction:o});else if(n.table===d.zU&&n.path&&"private_pages"===n.path[0]&&t.table===r.iU){const e=n.getRecordStoreUIParent().getSpaceStore();e&&g({childStore:t,parentStore:e,alive:!0,transaction:o})}else n.table===r.iU&&m&&m.table===d.zU&&m.path&&"private_pages"===m.path[0]?g({childStore:t,parentStore:n,alive:!0,transaction:o}):n.table!==r.iU&&n.table!==a.v&&n.table!==s.x_||g({childStore:t,parentStore:n,alive:!0,transaction:o})}({...e,childStore:t})}{const{childStore:t,parentStore:n,transaction:o}=e,{parent_id:i,parent_table:r}=t.getValue()||{};i===n.id&&r===n.table||f.sW({store:t,data:{parent_id:n.id,parent_table:n.table},transaction:o})}}function v(e){const{childStore:t,parentStore:n,transaction:o}=e,{parent_id:i,parent_table:r,alive:a}=t.getValue()||{},s=n.table===d.zU&&n.path&&"private_pages"===n.path[0]&&a,l=i===n.id&&r===n.table&&a;(s||l)&&f.sW({store:t,data:{alive:!1},transaction:o})}},18957:(e,t,n)=>{n.d(t,{xv:()=>oe,ME:()=>ie,bA:()=>Y,Xd:()=>ae,Om:()=>re,Af:()=>X,jG:()=>ee,E5:()=>te,OP:()=>J});n(57658);var o=n(67294),i=n(15145),r=n(17215),a=n(45433),s=n(53877),l=n(18844),c=n(70279),d=n(91644),u=n(70203),p=n(82990),m=n(5366),f=n(480),g=n(24405),h=n(27714),v=n(58810),b=n(14871),y=n(75018),S=n(73744),_=n(6854),w=n(85893);const k=(0,m.defineMessages)({view:{id:"miniPeek.success.view",defaultMessage:"View"},copyLink:{id:"miniPeek.success.copyLink",defaultMessage:"Copy link"}});const I=function(e){window.__c={n:"PageCreationSuccessSnackbarButtons"};const{store:t}=e,n=(0,f.O7)(),r=(0,g.yK)((e=>({actionButtonsContainer:{display:"flex",marginLeft:80,gap:8},actionButton:{color:e.regularInvertedTextColor,fontSize:14},icon:{width:16,height:16,fill:e.regularInvertedTextColor}})),[]),a=(0,o.useCallback)((e=>{y.navigateToBlock({environment:n,store:t,openInNew:S.DJ(e),pageVisitSource:i.tY.Create})}),[n,t]),s=(0,o.useCallback)((e=>{b.Hs({event:e,environment:n,blocks:[t]})}),[n,t]);return(0,w.jsxs)("div",{style:r.actionButtonsContainer,children:[(0,w.jsx)(_.Pn,{onClick:a,style:r.actionButton,icon:v.Z,iconStyle:r.icon,children:(0,w.jsx)(m.FormattedMessage,{...k.view})}),(0,w.jsx)(_.Pn,{onClick:s,style:r.actionButton,icon:h.N,iconStyle:r.icon,children:(0,w.jsx)(m.FormattedMessage,{...k.copyLink})})]})};var C=n(28020),x=n(78316),T=n(84210),M=n(33929),P=n(75770),A=n(74948),R=n(38676),D=n(80444),B=n(77080),E=n(22294),F=n(38072),Z=n(45325),L=n(88923),j=n(35661),V=n(86486),U=n(27724),O=n(1310),N=n(29370),z=n(24666),H=n(50906),W=n(94419),q=n(17659),G=n(64964),K=n(39699),$=n(39865),Q=n(37181);function Y(e,t){const{mode:n,creationSource:o,target:r}=t,a=e.WindowSizeStore.state.width,s=L.default.state.preferredSidePeekWidth||a/2,l=function(e,t){if(e===L.PeekModeMini&&(!t||t===i.tY.SidebarQuickAdd||t===i.tY.Create&&"on"!==B.default.getEligibleGroup({experimentId:"quick_capture_tasks_with_layer",defaultGroup:"control"})))return L.PeekModeCenter;return e}(n,o);L.default.setState({...L.default.state,open:!0,preferredSidePeekWidth:Math.min(s,a/1.5),isOpening:!0,isClosing:!1,...t,mode:l,creationSource:o}),l===L.PeekModeSide?A.toggleLeftSidebarByWindowSize(e):l===L.PeekModeMini&&J(r),Z.ZP.isOpen()&&q.qQ({environment:e,open:!1})}function J(e){let t="page";const n=e.getAssociatedCollectionStore();if(n){const e=n.getFormat().app_config_uri;e===a.iS?t="tasks":e===a.wW&&(t="projects")}return F.Z.setState({...F.Z.state,pageType:t}),t}function X(e){const{resultsStore:t,collectionContextStore:n}=e;null==n||n.searchOpen.setState(!1),L.default.setState({...L.default.state,resultsStore:t,collectionContextStore:n})}function ee(e){(L.default.isSidePeekOpen()||L.default.isCenterPeekOpen()||L.default.isMiniPeekOpen())&&ne(e)}function te(e){L.default.isSidePeekOpen()&&ne(e)}function ne(e){C.kw.state&&!E.Z.state.isKeyboardMode||V.default.state.isOpen&&V.default.state.menuIsOpen||U.default.isSelected()||z.default.hasSelection()||oe(e,"empty_space_click")}function oe(e,t,n){const o=L.default.state;if(!o.open||o.isClosing)return;L.default.isSidePeekOpen()&&(L.default.setState({...o,isClosing:!0}),re({environment:e,seen:!0}));const{mode:a,target:f,showMoveTo:g,collectionContextStore:h,savedSelectionStoreState:v,savedTableSelectionStoreState:b,savedSidebarExpandedStoreState:S}=o,_=f.getContentStores(),k=1===_.length?_[0]:void 0,C=k&&k.isEmptyEditableBlock(),x=g&&f.isEmptyTitle()&&(f.isEmptyPage()||C)&&(o.mode!==L.PeekModeMini||o.creationSource===i.tY.SidebarQuickAdd);K.createAndCommit({userAction:"PeekRenderer.close",environment:e,perform:t=>{x?($.y8({environment:e,blocks:[o.target],transaction:t}),t.postSubmitCallbacks.push((t=>{t||H.dhV(e,{analyticsName:"delete",from:"peek_actions",block_id:f.id,block_type:"page"})}))):C&&W.Od({parent:f.getContentStore(),childToRemove:k,transaction:t})}}),t&&"side_peek"===a&&H.vcz(e,{from:t}),H.$CH(e,{peek_mode:a,from:t,target_page_id:f.id,target_parent_id:f.getParentId(),target_page_type:"mini_peek"===a?F.Z.state.pageType:void 0,page_source:n,should_delete:x});!x&&"mini_peek"===a&&function(e,t){const n=M.default.getIntl(),o=u.QaF(t.getTitleValue())||r.Q2(n);let i;const a=t.getSpaceStore();if(a&&a instanceof j.H2&&t.isTopLevelPrivatePage({spaceStore:a,environment:e}))i=n.formatMessage(P.NV.privateDestinationName);else{var f;const e=t.getParentStore(),o=null==e?void 0:e.table;if(!e||o===c.x_||o===l.Xj||o===d.AT)return;i=null===(f=e.getModel())||void 0===f?void 0:f.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:s.x7,intl:n})}G.oV({label:(0,w.jsx)(m.FormattedMessage,{defaultMessage:"Added <boldtext>{targetTitle}</boldtext> to <boldtext>{parentTitle}</boldtext>",id:"miniPeek.success.label",values:{boldtext:e=>(0,w.jsxs)("span",{style:{fontWeight:p.Z.fontWeight.semibold},children:[" ",e," "]}),targetTitle:o,parentTitle:i}}),right:(0,w.jsx)(I,{store:t}),durationMs:O.JY})}(e,f),y.resetPeekState(e,a),y.resetSidebarState(e),y.resetEditorState(e),U.default.setState({...U.default.state,...v}),b.isActive&&N.Z.setState(b),S&&R.gV.setState(!0);const{mainEditorCurrentBlockStore:A}=D.default.state,{RouterStore:B}=e,E=B.state.route;if(null!=h&&h.searchQuery.state&&(null==h||h.searchOpen.setState(!0)),A&&"page"===E.name){const t=(0,T.ZP)({store:A,fullyQualified:!1,scrollToBlockId:E.scrollToBlockId,collectionViewId:E.collectionViewId,discussionId:E.discussionId,showMoveTo:E.showMoveTo,saveParent:E.saveParent,pageVisitSource:i.tY.PeekClose});y.navigate({environment:e,url:t})}}function ie(){const e=L.default.state;e.open&&!e.isClosing&&L.default.setState({...e,open:!1,resultsStore:void 0,collectionContextStore:void 0})}function re(e){const{environment:t,seen:n}=e,{currentUserSettingsStore:o}=D.default.state;o&&K.createAndCommit({userAction:"peekActions.setSeenPeekModeIntroTooltip",environment:t,perform:e=>{Q.d2({userSettingsStore:o,transaction:e,data:{seen_peek_mode_tooltip:n}})}})}function ae(e){const{collectionContextStore:t,resultsStore:n}=e;(0,x.YG)(null==t?void 0:t.collectionViewStore())||X({collectionContextStore:t,resultsStore:n})}},76464:(e,t,n)=>{n.d(t,{GQ:()=>ie,Kh:()=>X,MX:()=>Y,Pk:()=>Q,ep:()=>G,hs:()=>J,n_:()=>ne,u9:()=>ae});n(57658);var o=n(1302),i=n(66897),r=n(59730),a=n(24211),s=n(72126),l=n(63306),c=n(26825),d=n(27006),u=n(4615),p=n(77420),m=n(84683),f=n(15047),g=n(29369),h=n(19889),v=n(94044),b=n(64684),y=n(97880),S=n(5366),_=n(15010),w=n(33954),k=n(33929),I=n(98165),C=n(67669),x=n(45101),T=n(65598),M=n(38755),P=n(95697),A=n(18245),R=n(28578),D=n(80444),B=n(35661),E=n(78291),F=n(34583),Z=n(88893),L=n(35057),j=n(9867),V=n(50906),U=n(91536),O=n(54642),N=n(47307),z=n(9953),H=n(29974),W=n(39699);const q=(0,S.defineMessages)({preventFullPageAccessDeletion:{id:"permissionsActions.preventRemovingAllFullAccess.message",defaultMessage:"Please give someone else Full Access before removing this permission."},preventUserOrGroupDeletion:{id:"permissionsActions.preventUserOrGroupDeletion.message",defaultMessage:"At least one person or group must have access."},confirmUpgradeMessage:{defaultMessage:"To add members to your workspace, you need to switch it to the Team plan. You will be charged a prorated amount based on your current billing interval and account balance.",id:"permissions.confirmDialog.upgradeToTeamWorkspace.message"},confirmUpgradeButtonLabel:{defaultMessage:"Upgrade to Team workspace",id:"permissions.confirmDialog.upgradeToTeamWorkspace.confirmButton.label"}});function G(e){const{environment:t,store:n,permissionItems:i,transaction:r,from:a,skipAnalytics:l,pagePermissionChangeLocation:u,fromPermissionWrapper:p}=e;if((0,C.Kz)(e))return!1;if(!n.isDefined())return!1;const m=n.getPermissionItems();let g=[...m];const{id:h}=t.currentUser,v=n instanceof B.H2,S=n instanceof B.G&&n.getParentTable()===f.bx,_=n instanceof B.G&&(S||n.isRestricted());l||(n instanceof B.G?U.kM({environment:t,store:n,newItems:i,location:u,inSudoMode:r.useSudoMode,fromPermissionWrapper:p}):i.forEach((e=>{v?V.dE3(t,e,{from:a}):n instanceof B.zX?V.gRe(t,{item:e,teamStore:n}):(0,y.t1)(n)}))),g=g.filter((e=>!i.some((t=>c.Kf(e,t)))));for(const o of i)g.push(o);g=g.filter((e=>"none"!==d.cY(e)));const w=Boolean(i.find((e=>"user_permission"===e.type&&e.user_id===h&&!d.zz(e.role))));if(n instanceof B.G&&_&&h){const e=I.Pj(n),t=e?(0,M.jv)(e):[],o=e?e.getPermissionGroups():[],a=Boolean(g.find((e=>"user_permission"===e.type&&d.zz(e.role)&&e.user_id===h))),s=I.VP(n),l=null==s?void 0:s.getMembers(),c=void 0!==l&&(0,b.pd)({membership:l},h),u=e&&s&&(0,P.AL)({teamStore:s,spaceStore:e,userId:h}),p=t.find((e=>"user_permission"===e.type&&e.user_id===h)),m=i.find((e=>"space_permission"===e.type&&d.zz(e.role))),f=i.find((e=>"space_permission"===e.type&&d.YX(e.role))),v=i.find((e=>"space_permission"===e.type&&!d.YX(e.role))),y=g.find((e=>Boolean("group_permission"===e.type&&d.zz(e.role)&&o.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(h)>=0)))))),S=(0,P.bq)();if(e&&e.canEdit()&&!S){const t=e.getPagesStore();f?W.applyOperation({transaction:r,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:n.id}}}):v&&W.applyOperation({transaction:r,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:n.id}}})}if(!S&&a&&p&&(m||y)&&(g=g.filter((e=>!("user_permission"===e.type&&e.user_id===h)))),!w){g.some((e=>!("space_permission"!==e.type||!d.zz(e.role)||!p)||(!("user_permission"!==e.type||!d.zz(e.role)||e.user_id!==h)||(!("group_permission"!==e.type||!d.zz(e.role)||!o.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(h)>=0))))||(!!((0,d.zU)(e)&&d.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&u)||!!((0,d.LW)(e)&&d.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&c))))))||r.useSudoMode||(g=g.filter((e=>!("user_permission"===e.type&&e.user_id===h))),g.push({type:"user_permission",user_id:h,role:"editor"}))}}if(!g.some((e=>{const t=d.cY(e);return d.zz(t)}))&&(v||_))return o.default.afterNextFlush((()=>{N.showErrorMessage(k.default.formatMessage(q.preventFullPageAccessDeletion))})),!1;const x=g.some((e=>(d.jg(e)||d.hV(e))&&"editor"===e.role));if((0,P.bq)()&&S&&!x)return o.default.afterNextFlush((()=>{N.showErrorMessage(k.default.formatMessage(q.preventUserOrGroupDeletion))})),!1;const T=(0,B.Vh)(n,n.pointer,"permissions"),R=[];for(const o of m){!g.find((e=>c.Kf(o,e)))&&d.C2(o)&&R.push({...o,role:"none"})}for(const o of g){const e=m.find((e=>c.Kf(o,e)));!d.C2(o)||e&&s.Xy(e,o)||R.push(o)}let D=[];const E=I.Om(n);if(n instanceof B.G&&!n.isRestricted()&&E&&E instanceof B.G){const e=(0,C.YO)(E);D=R.map((t=>e.find((e=>s.Xy(e.permissionItem,t)))?{...t,role:"none"}:t))}else D=R;for(const o of D)W.applyOperation({store:T,operation:{pointer:T.pointer,command:"setPermissionItem",path:T.path,args:o},transaction:r});return r.postSubmitCallbacks.push((async n=>{V.NLO(t,{status:Boolean(n)?"fail":"success",location:u}),n||await F.bi(t),e.metric&&A.default.measure(e.metric,{environment:t})})),!0}function K(e){var t;const{environment:n,store:o,permissionItems:i,transaction:r,inviteFlowId:a,inviteMessage:s,inviteOrigin:l}=e,c=null===(t=D.default.state.currentSpaceStore)||void 0===t?void 0:t.id,{id:d}=n.currentUser;for(const u of i)if(c&&"user_permission"===u.type&&u.invite_id){const{inviteeId:e,inviteeTable:t}=$({item:u,spaceId:c}),n={id:u.invite_id,version:1,flow_id:a,space_id:c,target_id:o.id,target_table:o.table,inviter_id:d,inviter_table:h.KJ,invitee_id:e,invitee_table_or_group:t,message:s,created_time:Date.now(),attributes:{permission:u,origin_type:l}};z.sW({store:(0,B.Kv)(o,{table:"invite",id:n.id,spaceId:c}),data:n,transaction:r})}return r.postSubmitCallbacks.push((e=>{V.bRx(n,{status:Boolean(e)?"fail":"success",origin:l})})),!0}function $(e){const{item:t,spaceId:n}=e;return d.jg(t)?{inviteeId:t.user_id,inviteeTable:h.KJ}:d.FB(t)?{inviteeId:t.bot_id,inviteeTable:p.cZ}:d.hV(t)?{inviteeId:t.group_id,inviteeTable:m._e}:d.ix(t)?{inviteeId:n,inviteeTable:f.bx}:d.zU(t)?{inviteeId:t.team_id,inviteeTable:g.e0}:{}}function Q(e){const{environment:t,store:n,permissionItem:o,transaction:r,shouldInherit:a,fromPermissionWrapper:s}=e;if(!n.isDefined())return;const u=[];if(a){const e=(0,C.YO)(n).map((e=>e.permissionItem)).filter((e=>!c.Kf(e,o)));for(const t of e)d.C2(t)&&(n.isCollectionView()||!d.WY(t.role)||d.FB(t)?u.push(t):u.push({...t,role:"read_and_write"}))}const p=t.currentUser.id,m=p?n.getRecordValue({table:h.KJ,id:p}):void 0,f=m&&(0,i.dp)(m),g=l.DW(n.pointer,n.getRecordModel);!p||c.ZO({actor:f,ancestors:g,updatedPermissionItem:o})||r.useSudoMode||u.push({type:"user_permission",user_id:p,role:"editor"}),u.push(o);const v=n.getPermissionItemsStore();U.kM({environment:t,store:n,newItems:[o],fromPermissionWrapper:s});for(const i of u)W.applyOperation({store:v,operation:{pointer:v.pointer,command:"setPermissionItem",path:v.path,args:i},transaction:r});W.applyOperation({store:v,operation:{pointer:v.pointer,command:"setSingletonPermissionItem",path:v.path,args:{singletonPermissionItem:{type:"restricted_permission"},set:!0}},transaction:r}),V.gl7(t,{type:"none"===o.role?"remove":"narrow"}),r.postSubmitCallbacks.push((e=>{e||F.bi(t)}))}function Y(e){const{environment:t,store:n,transaction:o}=e;if(!n.isDefined())return;const i=n.getPermissionItems(),r=I.Om(n),a=r?c.Wo(I.fJ(r)):[],s=c.Ub(n.getModel(),i,a),l=n.getPermissionItemsStore();for(const c of s)W.applyOperation({store:l,operation:c,transaction:o});V.TJp(t,{using_admin_api:!1}),o.postSubmitCallbacks.push((e=>{e||F.bi(t)}))}async function J(e){const{environment:t,store:n}=e,{currentSpaceStore:o}=D.default.state;if(o){const e=o.id,i=n.id,r=await O.spaceAdminRestoreAccess(t,{spaceId:e,blockId:i});V.TJp(t,{using_admin_api:!0}),"failed"===r.type&&N.showError(r)}}function X(e){const{environment:t,store:n,transaction:o}=e,i=n.getPermissionItems();if(!n.isTopLevelTeamPage()||0===i.length)return;const r=i.filter((e=>d.FB(e)));z.sW({store:n,transaction:o,data:{permissions:r}}),V.FNU(t,{store:I.VP(n)})}function ee(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function te(e){return d.jg(e.permissionItem)&&(0,x.OA)(e.inviteTarget)}async function ne(e){const{environment:t,isOnboarding:n,invite:o}=e;if(0===e.inviteTargets.length)return{success:!0,invitedUsers:{},requestedUsers:{}};const{data:i}=E.default.state,r=(0,Z.qX)();let a;if(ee(e))if((0,T.Mm)(e.store)){const t=e.inviteRole;a=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:t,bot_id:e.value.id}})))}else(0,T.OY)(e.store)?a=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:c.uH(e.value.capabilities),bot_id:e.value.id,parent_table:e.value.parent_table,parent_id:e.value.parent_id}}))):(0,y.t1)(e.store);else a=await async function(e){const{environment:t,inviteTargets:n,inviteRole:o}=e;return Promise.all(n.map((async n=>{if("newUser"===n.type){const e=await oe(t,n);return{inviteTarget:n,permissionItem:{type:"user_permission",role:o,user_id:e}}}if("existingUser"===n.type){return{inviteTarget:n,permissionItem:{type:"user_permission",role:e.inviteRole,user_id:n.value.id}}}if("group"===n.type){return{inviteTarget:n,permissionItem:{type:"group_permission",role:e.inviteRole,group_id:n.value.id}}}(0,y.t1)(n)})))}({environment:t,inviteTargets:e.inviteTargets,inviteRole:e.inviteRole,data:i});const{toInvite:s,toRequest:l}=function(e,t){if(!((0,M.Q6)(D.default.state.currentSpaceStore)&&e instanceof B.G))return{toInvite:t,toRequest:[]};const n=[],o=[];for(const i of t)te(i)?n.push(i):o.push(i);return{toInvite:o,toRequest:n}}(e.store,a),p={};if(e.store instanceof B.G&&l.length>0){if(!(await async function(e){const{environment:t,permissionItems:n,inviteMessage:o,store:i}=e;return!(await Promise.allSettled(n.map((async e=>O.requestAccess(t,{type:"guest-invite-request",block:{id:i.id,spaceId:i.getSpaceId()},forActorId:e.user_id,message:void 0,attributes:{role:e.role,inviteMessage:o}}))))).find((e=>"rejected"===e.status||"fulfilled"===e.status&&"failed"===e.value.type))}({environment:t,store:e.store,permissionItems:l.map((e=>e.permissionItem)),inviteMessage:o.inviteMessage})))return{success:!1};for(const e of l)p[e.inviteTarget.value.email]=e.permissionItem.user_id}if(0===s.length)return{success:!0,invitedUsers:{},requestedUsers:p};const m=s.map((e=>e.inviteTarget)),f=s.map((e=>e.permissionItem));var g;ee(e)||V.jBu(t,{role:e.inviteRole,is_space:e.store instanceof B.H2,invite_targets:m,is_onboarding:e.isOnboarding,invite_origin:o.inviteOrigin,permission_items:f,invite_message_length:(null===(g=o.inviteMessage)||void 0===g?void 0:g.length)??0,invite_flow_id:o.inviteFlowId,isProfessionalTeamUser:(0,_.QZ)(),domainType:(0,_.JF)(),share_menu_session_id:R.ZP.state.sessionId});let h;e.store instanceof B.G&&Z.He()?h=await async function(e){const{environment:t,store:n,permissionItems:o,invite:i}=e,{currentSpaceStore:r}=D.default.state;if(!r)return!1;if(!r.isDefined())return!1;const a=o.filter(d.jg).map((e=>({...e,invite_id:(0,u.ZP)()})));if("failed"===(await O.inviteGuestsToSpace(t,{block:{id:n.id,spaceId:r.id},permissionItems:a})).type)return!1;const{serverCommitResult:s}=W.createAndCommit({userAction:"permissionsActions.saveInvites",environment:t,perform:e=>{const{inviteFlowId:o,inviteMessage:r,inviteOrigin:s}=i;K({environment:t,store:n,permissionItems:a,transaction:e,inviteFlowId:o,inviteMessage:(0,v.my)(r),inviteOrigin:s})}});await s;const l=o.filter(d.FB);l.length>0&&await re({environment:t,store:n,permissionItems:l,invite:i});return!0}({environment:t,store:e.store,permissionItems:f,invite:o}):(await re({environment:t,store:e.store,sudoModeStore:e.sudoModeStore,permissionItems:f,invite:o}),h=!0),n||await F.bi(t);const b={};m.forEach(((e,t)=>{var n;const o=f[t];"newUser"!==e.type&&"existingUser"!==e.type||null===(n=e.value)||void 0===n||!n.email||"user_permission"!==o.type||(b[e.value.email]=o.user_id)}));const S=1===r&&(0,Z.qX)()>1;return(0,L.QM)()&&S&&H.sw(t),{success:h,invitedUsers:b,requestedUsers:p}}async function oe(e,t){const n=(0,a.E2)(k.default.getIntl()),o=t.value.email,i=await O.createEmailUser(e,{email:o,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:n});if("failed"===i.type){if((0,r.Jx)(i.error)){const e=(0,w.nX)(k.default.getIntl(),i.error);e?N.showErrorMessage(e):N.deprecatedShowErrorMessage(i.error.message)}else N.deprecatedShowErrorMessage(i.error.message);throw i.error}return i.data.userId}async function ie(e){let{environment:t,store:n,inviteTargets:o,inviteRole:i,createNewTeamFlowId:r}=e;const a=n.getSpaceId(),s=t.currentUser.id;if(0===o.length)return!0;if(!a||!s)return!1;const{data:l}=E.default.state,c=await async function(e){const{environment:t,inviteTargets:n,inviteRole:o}=e;return Promise.all(n.map((async e=>{if("newUser"===e.type){const n=await oe(t,e);return{entity_type:"user",type:o,user_id:n}}return"existingUser"===e.type?{entity_type:"user",type:o,user_id:e.value.id}:"group"===e.type?{entity_type:"group",type:"member",group_id:e.value.id}:void(0,y.t1)(e)})))}({environment:t,inviteTargets:o,inviteRole:i,data:l}),d=await j.Uj({environment:t,teamMemberInfos:c,teamStore:n,isSettingDefaultTeam:!1,createNewTeamFlowId:r});return d&&await F.bi(t),d}async function re(e){const{environment:t,store:n,sudoModeStore:o,permissionItems:i,invite:r}=e,{serverCommitResult:a}=W.createAndCommit({userAction:"permissionsActions.savePermissionItems",environment:t,useSudoMode:"block"===n.table&&(null==o?void 0:o.shouldSaveTransactionWithSudoMode(n)),perform:e=>{const o=i.map((e=>"user_permission"!==e.type?e:{...e,invite_id:(0,u.ZP)()})),{inviteFlowId:a,inviteMessage:s,inviteOrigin:l}=r;K({environment:t,store:n,permissionItems:o,transaction:e,inviteFlowId:a,inviteMessage:(0,v.my)(s),inviteOrigin:l}),G({environment:t,store:n,permissionItems:o,transaction:e,from:l})}});await a}const ae=function(e){const{store:t,transaction:n}=e;z.sW({store:t,data:{permissions:null},transaction:n})}},9700:(e,t,n)=>{n.d(t,{m:()=>m});var o=n(87078),i=n(4023),r=n(15723),a=n(31194);const{Top:s,Bottom:l,Left:c,Right:d}=i.u,{Start:u,Center:p}=i.v,m=function(e){const{store:t,placementToOrigin:n,alignmentToOrigin:i,popupRect:u,originRect:p,viewportPadding:m,placementFlipped:g,viewportAdditionalBottomPadding:h}=e,v=(0,o.Z)();let b=r.jn(v,-m||0);0!==h&&(b=new r.iL(b.x,b.y,b.width,b.height-h));const y=f(u,p,n,i),S=Math.max(b.left-y.left,0)+Math.min(b.right-y.right,0),_=Math.max(b.top-y.top,0)+Math.min(b.bottom-y.bottom,0),w=n===c&&Math.abs(S)>0&&r.aP(b,f(u,p,(0,a.FJ)(n),i)),k=n===d&&Math.abs(S)>0&&r.aP(b,f(u,p,(0,a.FJ)(n),i)),I=n===s&&Math.abs(_)>0&&r.aP(b,f(u,p,(0,a.FJ)(n),i)),C=n===l&&Math.abs(_)>0&&r.aP(b,f(u,p,(0,a.FJ)(n),i)),x={placementFlipped:!1,offsetX:0,offsetY:0};x.placementFlipped=g||w||k||I||C,(!x.placementFlipped||n!==c&&n!==d)&&(x.offsetX=Math.round(S)),(!x.placementFlipped||n!==s&&n!==l)&&(x.offsetY=Math.round(_)),t.setState({...t.state,...x})},f=function(e,t,n,o){if(n===s||n===l){let i,r;return i=o===u?t.left:o===p?t.left+t.width/2-e.width/2:t.right-e.width,r=n===s?t.top-e.height:t.bottom,new DOMRect(i,r,e.width,e.height)}{let i,r;return i=o===u?t.top:o===p?t.top+t.height/2-e.height/2:t.bottom-e.height,r=n===c?t.left-e.width:t.right,new DOMRect(r,i,e.width,e.height)}}},31304:(e,t,n)=>{n.d(t,{E:()=>_,_:()=>w});var o=n(18466),i=n(68626),r=n(72126),a=n(91155),s=n(75189),l=n(44615),c=n(63143),d=n(36054),u=n(41641),p=n(95477),m=n(2688),f=n(85844),g=n(35661),h=n(27724),v=n(24666),b=n(30581);const y=1*c.U6,S="presenceActions";function _(e,t,n,o){!function(e,t){const{persistAutoListener:n,rootStore:o,isActive:r,listenerReference:s,userId:c}=e.state;if(r){if(n&&n.destroy(),s&&m.Z.removeListener(s,t),c&&o&&C({userId:c,rootStore:o})){const e=(0,l.T0)(o.id);m.Z.updateField(e,c,{present:!1},y,t),m.Z.clearOnDisconnect(e,S,t).catch((e=>{i.log({level:"error",from:"destroyPresence",type:"SystemError",error:(0,a.Ui)(e)})}))}e.reset()}}(e,t),o&&b.P(o,t,n)}async function w(e){const{userId:t,rootStore:n,presenceStore:i,environment:a,pageVisitIdStore:c}=e;if(await n.load(),I({userId:t,rootStore:n})){i.setState({...i.state,isActive:!0,rootStore:n,userId:t});const e=r.P2((()=>{i&&i.state.isActive&&i.state.rootStore===n&&k(i,a)}),1e3),u=(e,t)=>{i&&i.state.isActive&&i.state.rootStore===n&&function(e,t){const{remotePresenceData:n}=t.state,o=e||{};r.Xy(n,o)||t.setState({...t.state,remotePresenceData:o})}(function(e){const t={};if(r.Kn(e)){const n=Object.keys(e);for(const o of n){const n=e[o];n&&!(0,d.Gu)(s.uP,n)&&(t[o]=n)}}return t}(t),i)},p=(0,l.T0)(n.id),f=m.Z.addListener(p,u,void 0,a);i.setState({...i.state,persistAutoListener:new o.Z({onChange:e}),listenerReference:f}),t&&C({userId:t,rootStore:n})&&await m.Z.onDisconnect(p,[{operation:"updateField",key:p,field:t,updates:{present:!1},ttl:y},{operation:"logPageExit",userId:t,blockId:n.id,spaceId:n.getSpaceId(),pageVisitId:c.getCurrentPageVisitId()}],S,a),k(i,a)}}function k(e,t){const{persistAutoListener:n,rootStore:o,userId:i}=e.state;if(n&&n.startListener({incrementCycle:!0}),!o||!C({userId:i,rootStore:o}))return;let r;if(i&&o.canEdit()){var a,s;let e;const t=h.default.state;t.stores.length&&(e=t.stores[0]);const n=v.default.state,l="editing"===n.mode&&n.multiSelection;l&&o.uiContains(l.start.store)&&"block"===l.start.store.table&&(e=l.start.store),e||t.pivot&&(e=t.pivot);const d=null===(a=e)||void 0===a?void 0:a.findRecordStoreUIAncestors((e=>e instanceof g.G)).map((e=>e.id)),u=c.ud(Date.now());r={userId:i,present:f.Z.state.isVisible,activityTimestampNearestMinuteMs:u,blockId:(null===(s=e)||void 0===s?void 0:s.id)||null,blockPath:d||null}}if(n&&n.stopListener({isEndOfCycle:!0}),r){const e=(0,l.T0)(o.id);i&&m.Z.updateField(e,i,r,y,t)}}function I(e){const{userId:t,rootStore:n}=e;return Boolean(n)&&(0,u.Z)(n.id)&&n.canEdit()&&t}function C(e){const{userId:t,rootStore:n}=e;return I({userId:t,rootStore:n})&&!p.default.isAdminMode}},40277:(e,t,n)=>{n.d(t,{th:()=>R,Jv:()=>T,I6:()=>M,Hr:()=>A});n(21703),n(57658);var o=n(7406),i=n(68626),r=n(15157),a=n(91155),s=n(63306),l=n(66897),c=n(33728),d=n(72126),u=n(59753),p=n(26825),m=n(27006),f=n(21202),g=n(6287),h=n(15047);function v(e,t){if(b(e,t))return!0;return t&&(0,l.pu)(t),!1}function b(e,t){if(!t)return!1;if(!t.isUser())return!1;let n=!1;const o=e.getEmailDomains()||[],i=e.getPermissionItems()||[];if(t&&t.email&&o){const e=(0,c.Gd)(t.email);n=d.q9(o,e)}return i.find((e=>"user_permission"===e.type&&e.user_id===t.id))&&(n=!0),n}function y(e){const{block:t,space:n,viewer:o}=e;if(!t)return;if(!b(n,o))return;const i=t.getPermissionItems().filter((e=>"user_permission"===e.type&&(0,m.zz)(e.role))).map((e=>e.user_id));if(0===i.length)return;const r=n.getUserPermissionItems();return i.find((e=>(0,p.GU)({spacePermissions:r,userId:e})))}var S=n(73360),_=n(19889),w=n(33929),k=n(45950),I=n(5659),C=n(54642);const x="publicAccessPageId";async function*T(e){const{environment:t,request:n}=e;if("block-space"===n.type){const e=await I.A.measure("loadPublicPageData",`block:${n.blockId} space:${n.spaceId}`,(()=>P(t,n)));"value"in e&&(yield e.value)}const o=await C.getPublicPageData(t,n);"success"===o.type?yield o.data:(i.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageData",error:(0,a.Ui)(o.error)}),yield)}async function*M(e){const{environment:t,request:n}=e;if("block-space"===n.type){const e=await I.A.measure("loadPublicPageData",`block:${n.blockId} space:${n.spaceId}`,(()=>P(t,n)));"value"in e&&(yield e.value)}const o=await C.getPublicPageData(t,n);if("success"!==o.type)throw i.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageDataUnsafely",error:(0,a.Ui)(o.error)}),o.error;yield o.data}async function P(e,t){if("block-space"!==t.type)return{error:Error("Shouldn't be looking for a non-block-space page")};const{blockId:n}=t,{id:i}=e.currentUser;if(n&&i){let t,a,l,c;try{const o=await k.yY({environment:e,recordPointers:[{table:f.iU,id:n},{table:_.KJ,id:i}],recurFn:e=>{const o=[];return e.table===f.iU&&e.id===n&&(t=e),e.table===h.bx&&(a=e),e.table===g.v&&t&&t.parent_id===e.id&&(l=e),e.table===_.KJ&&(c=e),(0,S.tz)(e)&&o.push(e.getParentPointer()),o},recordIsRequired:()=>!0});if(t&&a&&c){const e=s.om({table:f.iU,id:n},o),i=c,r=Boolean(s.YL(e,i)),d=s.YP(e);return{value:function(e){window.__c={n:"getPublicPageData"};const{spaceDomain:t,actor:n,userHasExplicitAccess:o,intl:i,requireInterstitial:r,requireLogin:a,publicAccessRole:s,publicHomePage:l,template:c}=e,d=u.kk.fromValue(f.iU,e.block),p=u.kk.fromValue(h.bx,e.space),m=u.kk.fromValue(g.v,e.associatedCollectionValue),S="none"!==s,_=b(p,n),w=m&&(o||S)?m.getNormalizedSchema():void 0,k=m&&(o||S)?m.id:void 0,I=m&&(o||S)?m.getFormat():void 0;return{pageId:null==d?void 0:d.id,spaceName:p.name||i.formatMessage({id:"publicPageDataHelpers.untitledWorkspace.placeholder",defaultMessage:"Untitled Workspace"}),spaceId:p.id,spaceDomain:t,canJoinSpace:_,icon:p.icon,userHasExplicitAccess:o,ownerUserId:y({block:d,space:p,viewer:n}),collectionId:k,collectionSchema:w,collectionFormat:I,betaEnabled:p.beta_enabled,canRequestAccess:v(p,n),requireInterstitial:r,requireLogin:Boolean(a),publicAccessRole:s,publicHomePage:l,template:c}}({block:t,space:a,spaceDomain:void 0,associatedCollectionValue:l,actor:i,userHasExplicitAccess:r,intl:w.default.getIntl(),requireInterstitial:void 0,publicAccessRole:d,publicHomePage:void 0,template:void 0})}}}catch(r){return{error:(0,o.tg)(r)}}}return{error:Error("No offline public page data found.")}}function A(e){let{currentUserId:t,blockId:n}=e;r.Z.set({userId:t,key:x,value:n})}function R(e){return r.Z.get({userId:e,key:x})}},68305:(e,t,n)=>{n.d(t,{tA:()=>_});n(21703);var o=n(43690),i=n(42875),r=n(606),a=n(149),s=n(21202),l=n(97880),c=n(28020),d=n(33929),u=n(80444),p=n(77080),m=n(37598),f=n(35661),g=n(54642);const h=1e3;class v extends Error{constructor(e,t){super(t),this.type=e}}class b extends v{constructor(){super("query_collection_limit_outside_range","Query collection limit must be between 0 and 1000")}}class y extends v{constructor(e){super("query_collection_failed",`Query collection failed: ${e.reason}`),this.data=e}}class S extends v{constructor(){super("query_collection_too_many_items","Query collection updating too many items")}}async function _(e,t){const{source:n,parentRecordStore:v,collectionPointer:_,filter:w,sort:k,limit:I,vectorSearch:C}=t,x=I??h;if(x<0||x>h)return{error:new b};const T=f.NW.createChildStore(v,_);await T.load();const M=T.getModel();if(!M)return{error:new y({reason:"no collection value"})};const P=T.getParentBlockStore();if(!P)return{error:new y({reason:"no collection parent"})};await P.load();const A=P.getCollectionViewStores()[0],R=A.getSpaceId();if(!A||!R)return{error:new y({reason:"no first collection view"})};const D="results",B={[D]:{type:"results",limit:x}},E=Object.keys(t.aggregations??{});for(const o of E){var F;if(o===D)return{error:new y({reason:"results is a reserved reducer keyword."})};const e=null===(F=t.aggregations)||void 0===F?void 0:F[o];if(!e)return{error:new y({reason:`no aggregation provided for ${o}.`})};e&&(B[o]={type:"aggregation",aggregation:e})}const Z=T.getSchema(),L={type:"reducer",filter:w&&o.Ih(w,Z),sort:k&&o.zh(k,Z),userId:e.currentUser.id,userTimeZone:(0,i.r)(),searchQuery:void 0,vectorSearch:C,reducers:B},j=await g.queryCollection(e,{source:{type:"collection",id:_.id,spaceId:_.spaceId},collectionView:{id:A.id,spaceId:R},loader:L},void 0,{src:n});if("failed"===j.type)return{error:new y({reason:"server query failed",cause:j.error})};const V=j.data.result.reducerResults.results;if(!V||"results"!==V.type)return{error:new y({reason:"unexpected server result"})};if(V.blockIds.length===h&&V.hasMore)return{error:new S};const{groupsReducerIds:U,reducerIdsWithNoGroupDependencies:O}=o.x3(L.reducers,L.reducerDependencies),N=p.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),z=Date.now(),H={pageSort:[],schema:Z,loader:L,userId:e.currentUser.id,userStartOfWeek:c.AK.state,currentTime:z,getRecordModel:u.default.getCurrentBlockModelFn(),intl:d.default.getIntl(),isSorted:!1,visibleProperties:void 0,relativeVariableResult:null==j?void 0:j.data.relativeVariableResult,isSprintPlanningView:!1,collectionSourceType:"collection",groupsReducerIds:U,reducerIdsWithNoGroupDependencies:O,formulaTimeoutMs:N,resultCache:{}},W=o.fk(H);for(const i of V.blockIds){var q;const e=f.G.createChildStore(v,{table:s.iU,id:i}),t=null===(q=e.getAssociatedCollectionStore())||void 0===q?void 0:q.pointer;if(!(t&&r.dr.isEqualIdTable(t,T.pointer)))continue;const n=v.getRecordModel(e);n&&o.BW(n,M,H,W)}const G=m.Z.getEditedBlocksForCollection(M.id),K=new Set(V.blockIds);for(const i of G){if(K.has(i))continue;const e=v.getRecordModel({table:s.iU,id:i});e&&o.BW(e,M,H,W)}const{result:$}=o.kk(H,W),Q=o.aW({result:$}),Y={};for(const i of E){var J;const e=o.Oi({expectedAggregator:null===(J=t.aggregations)||void 0===J||null===(J=J[i])||void 0===J?void 0:J.aggregator,aggregationReducerResult:j.data.result.reducerResults[i]});if(a.x.isFail(e)){const t="no aggregation provided"===e.error?`no aggregation provided for ${i}`:"unexpected response returned for aggregation"===e.error?`unexpected response returned for aggregation ${i}`:(0,l.t1)(e.error);return{error:new y({reason:t})}}Y[i]=e.value}return{value:{blockIds:Q,...Y}}}},9953:(e,t,n)=>{n.d(t,{Ue:()=>y,ae:()=>f,j4:()=>g,nj:()=>b,sO:()=>h,sW:()=>v});n(57658);var o=n(41432),i=n(97531),r=n(59730),a=n(59753),s=n(4615),l=n(73360),c=n(606),d=n(21202),u=n(35661),p=n(39699),m=n(1742);function f(e){const{environment:t,table:n,value:o,transaction:i,inMemoryRecordCache:r}=e;o.id||(o.id=(0,s.ZP)());const a=o,d=l.mk.create(n,a),m=c.dr.fromRecordWithTable(d),f=u.t1.createUniqueRootStore(t,m,{userId:i.userId,inMemoryRecordCache:r});return p.applyOperation({store:f,operation:{pointer:f.pointer,path:[],command:"set",args:o},transaction:i}),f}function g(e){var t;const{environment:n,type:a,properties:l,permissions:c,transaction:f,inMemoryRecordCache:g,useCrdt:v}=e;let b=e.tracker;const y=e.id||(0,s.ZP)(),S=e.format||v?{...e.format??{},...v?{use_crdt:!0}:{},...v&&o.h5(a)?i.K(y,null==l?void 0:l.title):{}}:void 0,_=e.spaceId||f.spaceId,w=new u.G(n,{table:d.iU,id:y,spaceId:_},{userId:f.userId,inMemoryRecordCache:g});if(!b&&!f.getUserFlowForAnalyticsPurposesOnly()){const e="page"===a?"user_flow_create_page":"user_flow_create_block";b=new m.BW({environment:n,entryPointName:"recordActions.createBlock",userFlow:e,succeedOnEnqueue:!0})}return null===(t=b)||void 0===t||t.track(w.pointer,f),h({store:w,transaction:f,value:{type:a,permissions:c,properties:l,format:S,space_id:_}}),p.updateMetadataForTransaction({environment:n,transaction:f}),f.postPerformAssertions.push((function(){if(f.isLocal)return;if(!w.getParentStore())throw new r.p8(`Created block was not given a parent before being committed in transaction ${f.getUserActionForAnalyticsPurposesOnly()}`)})),w}const h=function(e){const{store:t,value:n,transaction:o}=e,i=t.path;p.applyOperation({store:t,operation:{pointer:t.pointer,path:i,command:"set",args:n||null},transaction:o})};function v(e){const{store:t,data:n,transaction:o}=e,i=t.path;p.applyOperation({store:t,operation:{pointer:t.pointer,path:i,command:"update",args:n},transaction:o})}function b(e){const{store:t,source:n,fileIds:o,transaction:i}=e,r=t.path;for(const a of o)p.applyOperation({store:t,operation:{pointer:t.pointer,path:r,command:"copyFile",args:{source:n,fileId:a}},transaction:i})}function y(e){let{environment:t,table:n,args:o,transaction:i,inMemoryRecordCache:r}=e;const s=a.vk[n],{model:l,operation:c}=s.create(o),d=u.t1.createUniqueRootStore(t,l.pointer,{userId:i.userId,inMemoryRecordCache:r});return p.applyOperation({store:d,operation:c,transaction:i}),d}},4408:(e,t,n)=>{n.d(t,{HB:()=>se,LK:()=>ce,Wl:()=>ie,bG:()=>ae,fL:()=>re,uo:()=>le});var o=n(59753),i=n(27006),r=n(29477),a=n(54368),s=n(51650),l=n(98963),c=n(18844),d=n(21202),u=n(6359),p=n(44312),m=n(19639),f=n(73387),g=n(32161),h=n(82447),v=n(49953),b=n(14710),y=n(66726),S=n(30754),_=n(84683),w=n(80396),k=n(24836),I=n(86135),C=n(84323),x=n(83200),T=n(67627),M=n(65963),P=n(14130),A=n(34406),R=n(42314),D=n(16663),B=n(19221),E=n(93646),F=n(91644),Z=n(15047),L=n(96740),j=n(75990),V=n(57829),U=n(56877),O=n(47238),N=n(77858),z=n(26195),H=n(14718),W=n(14327),q=n(53412),G=n(19889),K=n(98897),$=n(66079),Q=n(58161),Y=n(28182),J=n(35794),X=n(70203),ee=n(44133),te=n(84709),ne=n(89087),oe=n(54642);function ie(e){const{environment:t,pointer:n,userId:o,inMemoryRecordCache:r,model:a,role:s,force:l,maybeStaleRecordMap:c,updatePaths:u,debugSource:p}=e;"block"===n.table&&(0,ee.setBlockIdDebugSource)(n.id,p);const m=o||t.currentUser.id,f=null==a?void 0:a.getVersion(),g=r.getRole({pointer:n,userId:m}),h=r.getVersion({pointer:n,userId:m}),v="number"==typeof f&&f>h;if(!(l||v||void 0!==s&&g!==s))return;let b=a;if(!l&&!v&&function(e){const{oldRole:t,newRole:n}=e;if(!i.YX(n))return!1;if(t&&!i.J5(t))return!1;return!0}({oldRole:g,newRole:s})){const e=r.getRecordModel({pointer:n,userId:m});e&&(b=e)}r.setModelAndRole({pointer:n,userId:m},b,s);for(const i of u)r.emitRecord(n,i);if(b){const e=b.__IM_SORRY__getValue();if(n.table===d.iU&&e){const t=e;t.properties&&t.properties.title&&(t.properties.title=t.properties.title.map((e=>X.Y_F(e))))}const o=t.defaultRecordCache.persistedRecordCache;if(o&&pe[n.table]){const r=function(e){const{environment:t,pointer:n,model:o,role:r}=e,{id:a}=t.currentUser;if((n.table===G.KJ||n.table===$.dx||n.table===Y.Sr)&&a===n.id)return de;if((null==o?void 0:o.table)===N.zU&&o.parent_id===a)return ue;if(n.table===Z.bx&&(0,i.Jy)(r))return ue;return}({environment:t,pointer:n,model:b,role:s}),a={value:e,role:s};o.set(n,a,r,m,c)}}r===t.defaultRecordCache.inMemoryRecordCache&&te.unsubscribeAfterDelay({pointer:n,userId:m,environment:t})}function re(e){const{environment:t,userId:n,recordMap:i,inMemoryRecordCache:a,force:s,maybeStaleRecordMap:l,debugSource:c}=e,d=t.defaultRecordCache.persistedRecordCache;(0,r.ON)(i,(async e=>{let{pointer:i,model:r,role:u}=e,p=r,m=u;if(ne.transactionQueue.isPendingTransactionForRecord(i)&&d){const e=await d.get(i,n||t.currentUser.id);e&&(p=o.kk.fromValue(i.table,e.value),m=u)}ie({environment:t,inMemoryRecordCache:a,pointer:i,userId:n,model:p,role:m,updatePaths:[[]],force:s,maybeStaleRecordMap:l,debugSource:c})}))}async function ae(e){const{inMemoryRecordCache:t,pointer:n,userId:i,environment:r,minimumVersion:a}=e,s=ne.transactionQueue.isPendingTransactionForRecord(n),l=r.defaultRecordCache.persistedRecordCache;if(s)return l&&await l.get(n,i);let c,d;l&&(c=await l.get(n,i),c&&ie({environment:r,inMemoryRecordCache:t,pointer:n,userId:i,model:o.kk.fromValue(n.table,c.value),role:c.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (localResult)"}));try{const e=t.getEntry({pointer:n,userId:i}),s=e?e.value:void 0,l=e?e.pointer:void 0;if(a&&null!=s&&s.value&&(null==s?void 0:s.value.version)>=a)return s;d=await oe.syncRecordValue(r,{userId:i,version:s&&s.value&&s.value.version?s.value.version:-1,pointer:l||n}),d&&ie({environment:r,inMemoryRecordCache:t,pointer:n,userId:i,model:o.kk.fromValue(n.table,d.value),role:d.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (remoteResult)"})}catch(u){console.error(u)}return d||c}async function se(e){const{inMemoryRecordCache:t,pointer:n,userId:i,environment:r}=e,{defaultRecordCache:a}=r,s=await oe.syncRecordValue(r,{pointer:n,userId:i,version:-1});s&&(le({environment:r,inMemoryRecordCache:t,persistedRecordCache:a.persistedRecordCache,pointer:n,userId:i}),ie({environment:r,inMemoryRecordCache:t,pointer:n,userId:i,model:o.kk.fromValue(n.table,s.value),role:s.role,updatePaths:[[]],debugSource:"forceFetchRemoteRecord"}))}function le(e){const{inMemoryRecordCache:t,persistedRecordCache:n,pointer:o,userId:i}=e;t.deleteRecord({pointer:o,userId:i}),t.emitRecord(o,[]),null==n||n.deleteRecord(o,i)}function ce(e){const t=e.defaultRecordCache.inMemoryRecordCache;for(const{pointer:n}of t.data)te.unsubscribeForAllUsers({pointer:n,environment:e});t.clearCache()}const de=100,ue=50,pe={block:!0,notion_user:!0,space:!0,organization:!0,organization_space:!0,space_view:!0,user_root:!0,collection:!0,collection_view:!0,follow:!0,discussion:!0,comment:!0,user_settings:!0,slack_integration:!0,bot:!0,integration:!0,space_invite_link:!0,template_checklist:!0,page_visit:!0,page_exit:!0,[g.P]:!0,team:!0,[w.yo]:!0,[a.y]:!0,[F.AT]:!0,activity:!1,notification:!1,access_request:!1,customer:!1,temporary_password:!1,password:!1,slack_notification:!1,snapshot:!1,credit:!1,used_credit:!1,space_recover_pages:!1,user_metadata:!1,saml_config:!1,experiment:!1,education_domain:!1,education_email:!1,public_email_domain:!1,user_data_consent_permissions:!1,token:!1,apple_token:!1,google_token:!1,firebase_token:!1,trello_token:!1,asana_token:!1,confluence_token:!1,monday_token:!1,external_entity:!1,external_integration_app:!1,external_token:!1,evernote_token:!1,drive_token:!1,block_token:!1,bot_token:!1,integration_token:!1,csat_feedback:!1,subscription:!1,space_domain:!1,admin_api_log:!1,admin_api_op_log:!1,oauth_authorization_code:!1,mfa_settings:!1,[b.Dw]:!1,[Q.t]:!1,[E.O]:!1,[u.H]:!1,[S.G]:!1,[y.l]:!1,[h.r]:!1,[v.r9]:!1,[p.Jd]:!1,[m.mz]:!1,[j.F]:!1,[_.Tu]:!1,[l.cv]:!1,[k.qV]:!1,[I.FM]:!1,[c.Xj]:!1,[f.k]:!1,[V.fF]:!1,[O.x]:!1,[K.pm]:!1,[L.L]:!1,[U.L9]:!1,[q.nt]:!1,[z.nE]:!1,[W.z]:!1,[H.u]:!1,[s.b]:!1,[J.b]:!1,[M.a]:!1,[D.h]:!1,[A.f1]:!1,[R.P]:!1,[x.w]:!1,[P.O]:!1,[T.m]:!1,[C.b]:!1,[B.a]:!1}},52989:(e,t,n)=>{n.d(t,{AI:()=>h,MZ:()=>v,qw:()=>b});n(57658);var o=n(72126),i=n(73744),r=n(28314),a=n(77546),s=n(95802),l=n(41662),c=n(15723),d=n(4926),u=n(69784),p=n(50628),m=n(27724),f=n(45264),g=n(24677);function h(e){const{environment:t,target:n,startX:o,startY:c,showSelectionRect:p,preventSelectStores:h,allowVerticalEdgeScroll:b,allowHorizontalEdgeScroll:y}=e,S=m.default.getDefaultContainerFromTarget(n);if(!S)return;if(o>=window.innerWidth-d.Z.state)return;if(c>=window.innerHeight-d.Z.state)return;const _=a.VW(n),w=a.xH(n),k=s.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===S}),I=()=>{u.Z.state.isActive&&(g.Jy(),v({environment:t,currentX:u.Z.state.currentX,currentY:u.Z.state.currentY,toggle:r.yA().shift}))};_&&i.lj(_,"scroll",I),w&&i.lj(w,"scroll",I),u.Z.setState({moved:!1,isActive:!0,startX:o,startY:c,currentX:o,currentY:c,currentRect:void 0,defaultContainer:S,startSelection:m.default.state.stores,startSelectables:k,verticalScrollerEl:_,horizontalScrollerEl:w,startScrollTop:_?_.scrollTop:0,startScrollLeft:w?w.scrollLeft:0,showSelectionRect:p,handleScroll:I,preventSelectStores:h,allowVerticalEdgeScroll:b,allowHorizontalEdgeScroll:y}),g.ZH(t),f.wG(),l.HM.clearSelection()}function v(e){const{environment:t}=e,n=u.Z.state;if(n.isActive){const{currentX:i,currentY:r,verticalScrollerEl:a,horizontalScrollerEl:s,startScrollTop:l,startScrollLeft:d,preventSelectStores:m}=n;let f=n.startY;if(a){f-=a.scrollTop-l}let h=n.startX;if(s){h-=s.scrollLeft-d}const v={top:Math.min(f,r),bottom:Math.max(f,r),left:Math.min(h,i),right:Math.max(h,i)},b=p.Z.state.selectableRectMap,y=n.startSelectables.filter((e=>{const t=b.get(e),o=e.props.store;return e.props.canSelect&&t&&c.kK(v,t)&&m.indexOf(o)<0&&(!n.showSelectionRect||o.isTransclusionType()||!o.isInsideTransclusion())})),_=S(y);let w=[];const k=_.find((e=>e.length>1));if(k)w=k;else{const e=o.Z$(_);e&&(w=e)}let I=o.UI(w,(e=>e.props.store));if(e.toggle)for(const e of n.startSelection)o.q9(I,e)?I=o.zu(I,e):I.push(e);u.Z.setState({...n,moved:!0,currentX:e.currentX,currentY:e.currentY,currentRect:v}),g.Z5({environment:t,stores:I})}}function b(e){const t=u.Z.state;if(t.isActive){const{moved:n,verticalScrollerEl:o,horizontalScrollerEl:r,handleScroll:a}=t;n||g.ZH(e),o&&i.ZV(o,"scroll",a),r&&i.ZV(r,"scroll",a),u.Z.setState({isActive:!1})}}const y=function(e){if(e)for(;;){if(!(e=e.getContextClosestSelectable()))return;if(e.props.canSelect)return e}},S=function(e){const t=new Map,n={root:!0};for(const o of e){const e=y(o)||n;t.get(e)||t.set(e,[]),t.get(e).push(o)}return Array.from(t.values())}},79978:(e,t,n)=>{n.d(t,{Bl:()=>u,hE:()=>d,tG:()=>c});var o=n(80951),i=n(75134),r=n(9953),a=n(39699);function s(e){const{environment:t,store:n,propertyId:o,id:r,position:s,transaction:l}=e;let c;c="before"===s.type?{pointer:n.pointer,path:["properties",o],command:"addRelationBefore",args:{id:r,spaceId:n.getSpaceId(),before:s.before}}:{pointer:n.pointer,path:["properties",o],command:"addRelationAfter",args:{id:r,spaceId:n.getSpaceId(),after:s.after}},a.applyOperation({store:n,operation:c,transaction:l}),i.r({environment:t,store:n,relationPropertyId:o})}function l(e){const{environment:t,store:n,propertyId:o,id:r,transaction:s}=e;a.applyOperation({store:n,operation:{pointer:n.pointer,path:["properties",o],command:"removeRelation",args:{id:r,spaceId:n.getSpaceId()}},transaction:s}),i.r({environment:t,store:n,relationPropertyId:o})}function c(e){const{environment:t,store:n,propertyId:a,transaction:s,pointers:l}=e,c=(0,o.ow)(l);r.sW({store:n.getPropertiesStore(),data:{[a]:c},transaction:s}),i.r({environment:t,relationPropertyId:a,store:n})}function d(e){const{environment:t,sourceStore:n,destStore:o,propertyWithInverse:i,position:r,transaction:a}=e;s({environment:t,store:n,propertyId:i.property,id:o.id,position:r,transaction:a}),s({environment:t,store:o,propertyId:i.inverse,id:n.id,transaction:a,position:{type:"after"}})}function u(e){const{environment:t,sourceStore:n,destStore:o,propertyWithInverse:i,transaction:r}=e;l({environment:t,store:n,propertyId:i.property,id:o.id,transaction:r}),l({environment:t,store:o,propertyId:i.inverse,id:n.id,transaction:r})}},43008:(e,t,n)=>{n.d(t,{g:()=>l,x:()=>c});var o=n(95802),i=n(80444),r=n(35661),a=n(64951),s=n(24677);const l=function(e){const{mainEditorCurrentBlockStore:t}=i.default.state;if(t){const n=r.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||o.C.getRectFromStore(e.blockStore),blockStore:n})}};function c(e){a.Z.reset(),s.ZH(e)}},52771:(e,t,n)=>{n.d(t,{$:()=>l,x:()=>c});var o=n(95802),i=n(80444),r=n(35661),a=n(82187),s=n(24677);const l=function(e){const{mainEditorCurrentBlockStore:t}=i.default.state;if(t){const n=r.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||o.C.getRectFromStore(e.blockStore),clonedBlockStore:n,originalBlockStore:e.blockStore,renderDelete:e.renderDelete})}};function c(e){a.Z.reset(),s.ZH(e)}},82007:(e,t,n)=>{n.d(t,{AZ:()=>x,L0:()=>C,hv:()=>A,K9:()=>S,dA:()=>k,mF:()=>I,M7:()=>P,XT:()=>M,KX:()=>w,Yw:()=>_,qB:()=>T});n(52262),n(24506);var o=n(76967),i=(n(57658),n(72126)),r=n(606),a=n(27724),s=n(24666),l=n(39699);function c(e){const{environment:t,revision:n,preventSelectText:o}=e;let{transactions:c}=n;l.createAndCommit({userAction:"revisionActions.undoRevision",environment:t,canUndo:!1,perform:e=>{c=i.d9(c),c.reverse();for(const t of c){l.DEBUG&&console.log("Undoing transaction",t.getUserActionForAnalyticsPurposesOnly());const n=i.d9(t.invertedOperations);n.reverse();for(const o of n){if("recordOperation"!==o.type){console.warn(`Legacy revisions only support inverting regular operations, skipping ${o.type}.`);continue}const n=t.stores.find((e=>(0,r.qo)(e.pointer,o.operation.pointer)));o&&n&&l.applyOperation({transaction:e,store:n,operation:o.operation})}t.beforeSelection&&a.default.setState({...a.default.state,...t.beforeSelection}),t.beforeTextSelection&&!o&&s.default.setState(t.beforeTextSelection)}}})}function d(e){const{undoStack:t,redoStack:n}=e;return{undoStack:t.slice(),redoStack:n.slice()}}function u(e,t,n){const{undoStack:i,redoStack:c}=d(n),u=c.pop();u&&(!function(e,t,n){const{transactions:o}=t;l.createAndCommit({userAction:"revisionActions.redoRevision",environment:e,canUndo:!1,perform:e=>{for(const t of o){for(const n of t.operations){const o=t.stores.find((e=>(0,r.qo)(e.pointer,n.pointer)));o&&l.applyOperation({transaction:e,store:o,operation:n})}t.afterSelection&&a.default.setState({...a.default.state,...t.afterSelection}),t.afterTextSelection&&!n&&s.default.setState(t.afterTextSelection)}}})}(e,u,t),i.push(u),o.default.setState({type:"legacy",undoStack:i,redoStack:c}))}var p=n(97880),m=n(97444),f=n(65273),g=n(28685);function h(e,t){const n=function(e,t){const n=[];g.E.forEach((e=>{const t=e.getContextClosestSelectable();if(!t)return;const o=t.props.store,i=e.props.store;o.useCrdt()&&(0,f.Ls)({store:i,blockStore:o})&&n.push(o)}));for(const o of n){const n=o.getTextSliceTree();if(!n)return;if(n.findTextSliceTreeContainingItemWithId(e,t))return{block:o,tree:n}}}(e,t);if(!n)return void console.warn("Unable to find block containing text instance OpId",e,t);const o=n.tree.findIndexOfItemId(e,t);if(void 0!==o)return{block:n.block,index:o};console.warn("Unable to find index of OpId",e,t)}function v(e){const{environment:t,transaction:n,operation:o}=e;switch(o.type){case"invertedInsertText":!function(e){const{environment:t,transaction:n,operation:o}=e,i=h(o.textInstanceId,o.startId);if(!i)return;const r=h(o.textInstanceId,o.endId);r&&m.pz({environment:t,multiSelection:{start:{store:i.block.getBlockTitleStore(),index:i.index},end:{store:r.block.getBlockTitleStore(),index:r.index+1}},transaction:n})}({environment:t,transaction:n,operation:o});break;case"unimplemented":console.log("TODO: Apply inverted text operation",o),n.invertedOperations.push({type:"invertedTextOperation",operation:{type:"unimplemented",comment:`inverse of: ${o.comment}`}});break;default:(0,p.t1)(o)}}function b(e){const{environment:t,revision:n,preventSelectText:o}=e;let{transactions:c}=n;l.DEBUG&&console.log("Undoing/redoing transactions with user actions",n.userActions.join(","));const{performResult:d}=l.createAndCommit({userAction:"revisionActions.performUndoRedoNewRevisionTransaction",environment:t,canUndo:!1,perform:e=>{c=i.d9(c),c.reverse();for(const n of c){const c=i.d9(n.invertedOperations);c.reverse();for(const o of c)if("recordOperation"===o.type){const t=n.stores.find((e=>(0,r.qo)(e.pointer,o.operation.pointer)));o&&t&&l.applyOperation({transaction:e,store:t,operation:o.operation})}else"invertedTextOperation"===o.type?v({environment:t,transaction:e,operation:o.operation}):(0,p.t1)(o);n.beforeSelection&&a.default.setState({...a.default.state,...n.beforeSelection}),n.beforeTextSelection&&!o&&s.default.setState(n.beforeTextSelection)}return e}});return{...n,transactions:[d],undoRedoCount:n.undoRedoCount+1}}function y(e){const{undoStack:t,redoStack:n}=e;return{undoStack:t.slice(),redoStack:n.slice()}}const S=function(e){const t=o.default.state;"legacy"===t.type?function(e,t){const{undoStack:n}=t,i=e.currentTime??Date.now();if("string"==typeof e.undoCheckpoint){const t=n.find((t=>t.namedRevisionId===e.undoCheckpoint));t?t.transactions.push(e.transaction):n.push({type:"legacy",transactions:[e.transaction],timestamp:i,namedRevisionId:e.undoCheckpoint})}else{const t=n.at(-1);!e.undoCheckpoint&&t&&!t.namedRevisionId&&i-t.timestamp<=o.groupIntervalMs&&t.transactions[0].isLocal===e.transaction.isLocal?t.transactions.push(e.transaction):n.push({type:"legacy",transactions:[e.transaction],timestamp:i})}o.default.setState({type:"legacy",undoStack:n,redoStack:[]})}(e,t):function(e,t){const{undoStack:n}=t,i=e.currentTime??Date.now(),r=e.transaction.getUserActionForAnalyticsPurposesOnly()??"unknown";if("string"==typeof e.undoCheckpoint){const t=n.find((t=>t.namedRevisionId===e.undoCheckpoint));t?(t.transactions.push(e.transaction),t.userActions.push(r)):n.push({type:"new",userActions:[r],transactions:[e.transaction],timestamp:i,namedRevisionId:e.undoCheckpoint,undoRedoCount:0})}else{const t=n.at(-1);!e.undoCheckpoint&&t&&!t.namedRevisionId&&i-t.timestamp<=o.groupIntervalMs&&0===t.undoRedoCount&&t.transactions[0].isLocal===e.transaction.isLocal?(t.transactions.push(e.transaction),t.userActions.push(r)):n.push({type:"new",userActions:[r],transactions:[e.transaction],timestamp:i,undoRedoCount:0})}o.default.setState({type:"new",undoStack:n,redoStack:[]})}(e,t)};function _(e,t){const n=o.default.state;"legacy"===n.type?function(e,t,n){const{undoStack:i,redoStack:r}=d(n),a=i.pop();a&&(c({environment:e,revision:a,preventSelectText:t}),r.push(a),o.default.setState({type:"legacy",undoStack:i,redoStack:r}))}(e,t,n):function(e,t,n){const{undoStack:i,redoStack:r}=y(n),a=i.pop();if(a){const n=b({environment:e,revision:a,preventSelectText:t});r.push(n),o.default.setState({type:"new",undoStack:i,redoStack:r})}}(e,t,n)}function w(e,t){const n=o.default.state;"legacy"===n.type?u(e,t,n):function(e,t,n){const{undoStack:i,redoStack:r}=y(n),a=r.pop();if(a){const n=b({environment:e,revision:a,preventSelectText:t});i.push(n),o.default.setState({type:"new",undoStack:i,redoStack:r})}}(e,t,n)}const k=function(e){const t=(null==e?void 0:e.type)??o.default.state.type;o.default.setState({type:t,undoStack:[],redoStack:[]})},I=function(){"new"!==o.default.state.type&&(console.log("Enabling new revision stack."),k({type:"new"}))},C=function(){return Boolean(M())},x=function(){return Boolean(P())};function T(e){const t=o.default.state;"legacy"===t.type?function(e,t){const{environment:n,namedRevisionId:i}=e,{undoStack:r,redoStack:a}=d(t),s=r.findIndex((e=>e.namedRevisionId===i));if(s<0)return;const l=r.splice(s,1)[0];a.push(l),c({environment:n,revision:l}),o.default.setState({type:"legacy",undoStack:r,redoStack:a})}(e,t):function(e,t){const{environment:n,namedRevisionId:i}=e,{undoStack:r,redoStack:a}=y(t),s=r.findIndex((e=>e.namedRevisionId===i));if(s<0)return;const l=b({environment:n,revision:r.splice(s,1)[0]});a.push(l),o.default.setState({type:"new",undoStack:r,redoStack:a})}(e,t)}function M(){const e=o.default.state.undoStack.at(-1);return e?R(e):void 0}function P(){const e=o.default.state.redoStack.at(-1);return e?R(e):void 0}function A(e){return o.default.state.undoStack.some((t=>t.namedRevisionId===e))}function R(e){return"legacy"===e.type?function(e){return{getUserActions:()=>e.transactions.map((e=>e.getUserActionForAnalyticsPurposesOnly()??"")),getFirstStore(){var t;return null==e||null===(t=e.transactions)||void 0===t||null===(t=t[0].stores)||void 0===t?void 0:t[0]}}}(e):function(e){return{getUserActions:()=>e.userActions.slice(),getFirstStore(){var t;return null==e||null===(t=e.transactions)||void 0===t||null===(t=t[0].stores)||void 0===t?void 0:t[0]}}}(e)}},56863:(e,t,n)=>{n.d(t,{w:()=>r});var o=n(49557),i=n(4935);const r=function(){o.Z.state.isActive&&(i.Z.setState({...i.Z.state,open:!1}),o.Z.setState({...o.Z.state,isActive:!1,isAnimatingClosed:!0}))}},75018:(e,t,n)=>{n.r(t),n.d(t,{back:()=>En,canGoUp:()=>Zn,clearHistoryState:()=>ln,downloadExportUrl:()=>Rn,downloadFileUrl:()=>An,downloadUrl:()=>Dn,forward:()=>Fn,generatePartnerStackPathParam:()=>dn,getInitialPage:()=>Qn,getTrackingParams:()=>un,goDownInPeekMode:()=>Cn,goUpInPeekMode:()=>In,handleFirstPartyExternalIntegrationAuthCallback:()=>Nn,handleNavigateWithinSamePage:()=>fn,handleRedirectToLastVisitedPage:()=>Hn,handleSlackAuthCallback:()=>On,handleThirdPartyExternalIntegrationAuthCallback:()=>zn,initialize:()=>Kn,navigate:()=>pn,navigateAwayIfCurrentPage:()=>Bn,navigateOnBaseUrl:()=>cn,navigateToBlock:()=>wn,navigateToExternalURL:()=>xn,navigateToHomeTab:()=>Sn,navigateToOnboarding:()=>mn,navigateToPage:()=>_n,navigateToSearchResult:()=>Xn,navigateToTab:()=>gn,openFileUrl:()=>Pn,openInNativeApp:()=>jn,peekBlock:()=>kn,potentialWebSearchAbandonEventEmitter:()=>vn,publicPageTopBarAction:()=>qn,resetEditorState:()=>nn,resetPageState:()=>en,resetPeekState:()=>tn,resetSidebarState:()=>on,setQueryParamRedirect:()=>Jn,up:()=>Ln,updateHistoryState:()=>sn,updateRouterState:()=>Vn,updateRouterStateForDocumentTitleChange:()=>yn});n(21703),n(82801),n(57658);var o=n(17673),i=n(1302),r=n(27328),a=n(50112),s=n(15145),l=n(7406),c=n(33147),d=n(43593),u=n(17755),p=n(68626),m=n(15157),f=n(72126),g=n(29477),h=n(90850),v=n(4615),b=n(71644),y=n(99405),S=n(89101),_=n(21202),w=n(7678),k=n(33709),I=n(23867),C=n(77858),x=n(19889),T=n(66079),M=n(32739),P=n(9852),A=n(54153),R=n(72128),D=n(94826),B=n(93724),E=n(12139),F=n(97880),Z=n(64002),L=n(63143),j=n(36054),V=n(74487),U=n(11342),O=n(5366),N=n(91584),z=n(3297),H=n(97977),W=n(36110),q=n(25320),G=n(18957),K=n(62878),$=n(18821),Q=n(95306),Y=n(9080),J=n(95477),X=n(24215),ee=n(28020),te=n(70764),ne=n(12955),oe=n(21969),ie=n(35683),re=n(84210),ae=n(15070),se=n(9844),le=n(80444),ce=n(49065);var de=n(33929),ue=n(17652),pe=n(78873),me=n(98165),fe=n(18514),ge=n(48141),he=n(38755),ve=n(55081),be=n(87480),ye=n(10929),Se=n(75538),_e=n(18245),we=n(30806),ke=n(95802),Ie=n(74948),Ce=n(24646),xe=n(38676),Te=n(36896),Me=n(36391),Pe=n(41662),Ae=n(5162),Re=n(51),De=n(19511),Be=n(16772),Ee=n(77080),Fe=n(89256),Ze=n(17903),Le=n(61738),je=n(73796),Ve=n(3418),Ue=n(33759),Oe=n(89403),Ne=n(49085);class ze extends Ne.default{getInitialState(){return{args:void 0}}}const He=new ze;var We=n(42330),qe=n(45946),Ge=n(19671),Ke=n(93220),$e=n(72014),Qe=n(30539),Ye=n(13023),Je=n(88923),Xe=n(98452),et=n(99332),tt=n(24612),nt=n(89523),ot=n(35661),it=n(55320),rt=n(87956),at=n(86486),st=n(27724),lt=n(1310),ct=n(92083),dt=n(29370),ut=n(52258),pt=n(66708),mt=n(77503),ft=n(62820),gt=n(29949),ht=n(22500),vt=n(50906),bt=n(19719),yt=n(54642),St=n(90287),_t=n(48299),wt=n(2449),kt=n(54564),It=n(6404),Ct=n(51365),xt=n(45264),Tt=n(47307),Mt=n(47839),Pt=n(47678),At=n(54604),Rt=n(94273),Dt=n(92625),Bt=n(91376),Et=n(30581),Ft=n(31304),Zt=n(40277),Lt=n(43008),jt=n(52771),Vt=n(82007),Ut=n(3898),Ot=n(87531),Nt=n(24677),zt=n(64964),Ht=n(29974),Wt=n(98104),qt=n(39699),Gt=n(39865),Kt=n(61202),$t=n(53471),Qt=n(39634);const Yt="queryParamsRedirect",Jt=(0,O.defineMessages)({errorSamlMessage:{defaultMessage:"Could not log you in.",id:"router.loginWithSamlError.message"},appleErrorMessage:{id:"loginActions.loggingInWithApple.errorMessage",defaultMessage:"Something went wrong while trying to log in with Apple."},authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integration…"},joinedTeamMessage:{id:"joinedTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},backToContent:{id:"router.joinSpaceError.acceptLabel.backToContent",defaultMessage:"Back to my content"},goBack:{id:"router.joinSpaceError.acceptLabel.goBack",defaultMessage:"Go back"}}),Xt=[`${s.tY.MentionInPage}`,`${s.tY.LinkInPage}`,`${s.tY.PeekOpen}`,`${s.tY.Expand}`,`${s.tY.Duplicate}`,`${s.tY.Move}`];function en(e){pt.Z.reset(),mt.Z.reset(),ut.Z.reset(),Fe.Z.reset(),Ct.xv({environment:e,blockPropertyValueOverlayStore:Ge.Z}),$t.W8(),zt.C1()}function tn(e,t){Xe.Z.reset(),et.Z.reset(),tt.Z.reset(),Ct.xv({environment:e,blockPropertyValueOverlayStore:Ye.Z}),"mini_peek"===t&&setTimeout((()=>{lt.ZP.reset()}),lt.JY+1)}function nn(e){var t;Mt.inPageSearch.stop(),Nt.ZH(e),Wt.ZH(e),xt.wG(),Pe.HM.clearSelection(),Nt.Fp({pivot:void 0}),It.xv(),at.default.reset(),Vt.dA(),kt.LZ(),jt.x(e),Lt.x(e),Be.default.resetStore({environment:e}),At.xv(),null===(t=e.NativeMobileActionBarStore)||void 0===t||t.clear(!1)}function on(e){Te.Z.reset(),it.default.reset(),ft.Z.state.open&&(ft.Z.reset(),e.device.isMobile&&Ie.close()),Y.Z.state.open&&Q.UZ(e),$.Cd(e)}function rn(){const{mainEditorCurrentBlockStore:e}=le.default.state;let t=0,n=[];if(e){const{stores:e}=st.default.state;n=f.oA(e.map((e=>e.id))),t=Ze.Z.state.scrollTop}return{scrollTop:t,blockIds:n}}function an(e){let{historyId:t,historyIndex:n,currentUserId:o}=e;const i={...rn(),index:n};m.Z.set({userId:o,key:t,value:i})}function sn(e){let{historyId:t,currentUserId:n}=e;const o=m.Z.get({userId:n,key:t});if(!o)return;const i={...rn(),index:o.index};m.Z.set({userId:n,key:t,value:i})}function ln(e){let{RouterStore:t,currentUserId:n}=e;const o=t.state.id;m.Z.remove({userId:n,key:o})}function cn(e){const t=function(e,t){try{const n=e.startsWith("/")?new URL(e,J.default.domainBaseUrl):new URL(e);if(t)for(const[e,o]of Object.entries(t))n.searchParams.append(e,o);return n.pathname+n.search+n.hash}catch{throw new Error(`${e} is neither a URL nor an absolute path`)}}(e.url,e.extraSearchParams);return pn({...e,url:`${J.default.domainBaseUrl}${t}`})}async function dn(e){const t=await ne.getPartnerStackCookie(e);if(t){return{gspk:window.btoa(t)}}const n=await ne.getS2STrackingCookie(e);if(n&&n.partnerKey){return{ps_partner_key:window.btoa(n.partnerKey),ps_xid:n.clickId}}return{}}async function un(e,t){const{utmContent:n,utmSource:o}=t,i={utm_source:o,utm_content:n,tid:await(0,X.cG)(e)},{mainEditorCurrentBlockStore:r}=le.default.state;return null!=r&&r.id&&(i.utm_campaign=(0,v.F9)(null==r?void 0:r.id)),i}function pn(e){var t,n;const{environment:o,openInNew:i,frontPreserveScrollPosition:r,queryId:a,callback:s}=e,{RouterStore:l,currentUser:c}=o,d=c.id,{savedSidebarExpandedStoreState:u}=Je.default.state;u&&xe.gV.setState(!0);const p=y.Wj({url:e.url,baseUrl:J.default.domainBaseUrl,publicDomainName:J.default.publicDomainName,isMobile:o.device.isMobile,protocol:J.default.protocol,currentUrl:window.location.href}),{redirect:f,updateMobileTabbedRouterArgs:g}=bn(e,p),h=Z.gy(window.location.href),v=Z.gy(e.url),S=Boolean((null==v?void 0:v.hostname)&&v.hostname!==(null==h?void 0:h.hostname));if("external"===p.name||S)return void xn({environment:o,url:e.url,targetSelf:S});const _=M.u5({schemeUrl:e.url,baseUrl:J.default.domainBaseUrl}),w=Z.T1(e.url);if("tab"===i)return void(o.device.isElectron&&"page"===p.name?Mt.openInNewTab({url:w,position:"after-children"}):xn({environment:o,url:_}));if("window"===i&&o.device.isElectron&&"page"===p.name)return void Mt.openInNewWindow(w);const k=l.state.route;if("quickSearch"===k.name&&o.device.isElectron)return void Mt.openQuickSearchResult(w);const I="page"===k.name&&"page"===p.name&&k.blockId===p.blockId,C="page"===k.name&&"page"===p.name&&k.spaceDomain!==p.spaceDomain&&(k.requestedOnPublicDomain||p.requestedOnPublicDomain),x=o.AppUpdateStore.state.appUpdate;if(!I&&!e.redirect&&wt.cM(o,x))return void wt.hC({environment:o,url:w,version:x.version});if(f||I||(sn({historyId:l.state.id,currentUserId:d}),(0,Ce.Sx)(o)&&(Ie.setUpdateExpand({environment:o,isExpanded:!1,from:"close_for_space"}),Me.ZP.update((e=>({...e,canRender:!1}))))),on(o),C)return void xn({environment:o,url:e.url,targetSelf:!0});const T=(0,b.ZP)();f?window.history.replaceState({id:T,currentUserId:o.currentUser.id},void 0,w):window.history.pushState({id:T,currentUserId:o.currentUser.id},void 0,w);const P=function(e){let{historyId:t,currentUserId:n}=e;const o=m.Z.get({userId:n,key:t});return o?o.index:0}({historyId:l.state.id,currentUserId:d});an({historyId:T,historyIndex:f?P:P+1,currentUserId:d}),"pageVisitSource"in p&&(0,F.DE)(Xt,p.pageVisitSource)&&vt.BR(o,k,p),!I&&"page"===k.name&&rt.Z.state&&(null===(t=rt.Z.state)||void 0===t?void 0:t.pageId)===k.blockId&&vt.Ebd(o,rt.Z.state),Vn({environment:o,id:T,action:f?"replace":"push",href:w,updateMobileTabbedRouterArgs:g}).then((()=>{"page"===p.name&&!I&&a?rt.Z.setState({queryId:a,pageId:p.blockId,timeEntered:new Date}):rt.Z.reset()})).then((()=>{s&&s()}));(I||"nativeTab"===k.name&&"page"===p.name&&(null===(n=le.default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.id)===p.blockId)&&fn(o),!r&&window.scrollTo(0,0),_e.default.markEitherOf(["navigation_page_render","navigation_database_render"]),_e.default.mark("initial_page_render_after_login")}function mn(e){pn({environment:e,url:S._j.onboarding})}async function fn(e){const{RouterStore:t}=e,n=le.default.state.mainEditorCurrentBlockStore;if(n&&"page"===t.state.route.name){if(t.state.route.scrollToBlockId){const e=[t.state.route.scrollToBlockId];0===f.oA(ke.C.findSelectablesFromIds(e)).length&&(await Ut.Nz(n,e),await i.default.afterNextFlush())}Pt.Y(e)}}function gn(e){var t,n,o;const{environment:i,tab:a,navigationAction:s,navigationSource:l}=e,{TabbedRouterStore:c,currentUser:d}=i;if(!fe.__(i))return;"updates"!==a&&bt.nI(i);const u=c.state.activeTab,p=(0,r.w_)(c.state),m=f.Xh(c.state);m.activeTab=a,m.navigationAction=s,m.navigationSource=l,void 0!==e.nativeRootPageOverrideEnabled&&(m.tabs[m.activeTab].nativeRootPageOverrideEnabled=e.nativeRootPageOverrideEnabled);let g=!1;if(void 0!==e.pages){const t=e.pages.map((e=>{const t=(0,r.Gt)(e,!0),n=y.Wj({url:t,baseUrl:J.default.domainBaseUrl,publicDomainName:J.default.publicDomainName,isMobile:i.device.isMobile,protocol:J.default.protocol,currentUrl:window.location.href});return{...e,route:n}})),n=m.tabs[m.activeTab].pages;g=!f.Xy(n,t),m.tabs[m.activeTab].pages=t}if(hn(p)&&!hn((0,r.w_)(m))&&vn.emit(Date.now()),c.setState(m),c.state.activeTab===u&&!g)return;const h=le.default.state.mainEditorCurrentBlockStore,v="web"===p.type&&(null===(t=p.redirectedTo)||void 0===t?void 0:t.route)&&"page"===(null===(n=p.redirectedTo)||void 0===n?void 0:n.route.name)&&(null===(o=p.redirectedTo)||void 0===o?void 0:o.route.showMoveTo),S=h&&(null==h?void 0:h.canEdit())&&h.isEmptyTitle()&&h.isEmptyPage();"addPage"===u&&v&&S&&d.isLoggedIn()&&qt.createAndCommit({userAction:"routerActions.navigateToTab",environment:i,perform:e=>{Gt.y8({environment:i,blocks:[h],transaction:e}),e.postSubmitCallbacks.push((e=>{e||vt.dhV(i,{analyticsName:"delete",from:"mobile_navigation",block_id:h.id,block_type:"page"})}))}});const _="addPage"===a,w=c.state.tabs[a],{rootPage:k,pages:I}=w;let C=!1;switch(k.type){case"native":break;case"web":if(0===I.length||_)pn({environment:i,redirect:!0,url:(0,r.Gt)(k,!0,{...e.queryParams,from:"mobile_bottom_bar"}),updateMobileTabbedRouterArgs:{restoringTab:!0}});else{C=!0;const e=(0,b.ZP)();window.history.replaceState({id:e,currentUserId:i.currentUser.id},void 0,(0,r.Gt)(k))}}if(_)return;const x=!0===m.tabs[m.activeTab].nativeRootPageOverrideEnabled;I.forEach(((e,t)=>{if(!x&&t===I.length-1)return void pn({environment:i,redirect:!C,url:(0,r.Gt)(e),updateMobileTabbedRouterArgs:{restoringTab:!0}});const n=(0,b.ZP)(),o=(0,r.Gt)(e);C?window.history.pushState({id:n,currentUserId:i.currentUser.id},void 0,o):(C=!0,window.history.replaceState({id:n,currentUserId:i.currentUser.id},void 0,o))}))}const hn=function(e){return"web"===e.type&&"nativeTab"===e.route.name&&"search"===e.route.tab},vn=new c.Z,bn=function(e,t){const n={redirect:e.redirect,updateMobileTabbedRouterArgs:e.updateMobileTabbedRouterArgs};return fe.__(e.environment)?("login"!==t.name&&"logout"!==t.name&&"onboarding"!==t.name||(n.redirect=!0,n.updateMobileTabbedRouterArgs={...n.updateMobileTabbedRouterArgs,clearNativeRootPageOverride:!0}),n):n};function yn(e){var t;const{environment:n,url:o}=e;if(!fe.__(n))return;const{TabbedRouterStore:i}=n,a=(0,r.w_)(i.state);if("web"!==a.type)return;const s=y.Wj({url:o,baseUrl:J.default.domainBaseUrl,publicDomainName:J.default.publicDomainName,isMobile:n.device.isMobile,protocol:J.default.protocol,currentUrl:window.location.href}),l=(null===(t=a.redirectedTo)||void 0===t?void 0:t.route)??a.route;if(s.name!==l.name)return;const c=Z.T1(e.url);a.redirectedTo?(a.redirectedTo.route=s,a.redirectedTo.url=c):(a.route=s,a.url=c)}function Sn(e,t){var n,o;if(fe.__(e))return e.device.isMobileNative&&e.device.isAndroid&&Ve.Z.closeAll(),gn({environment:e,tab:"home",nativeRootPageOverrideEnabled:!0}),void(t&&t());Boolean(null===(n=e.mobileNative)||void 0===n?void 0:n.supportsNativeHomeOnPhone())&&(null===(o=e.mobileNative)||void 0===o||o.showNativeHomeTab(t))}function _n(e){const{store:t,openInNew:n,environment:o,pageVisitSource:i,openInSidePeek:r}=e,{currentSpaceStore:a}=le.default.state;if(!t.isDefined())return;const s=t.isNavigableBlock(),{page:l,block:c}=s?{page:t,block:void 0}:{page:me.Dg(t),block:t};l&&(!c&&a&&function(e){let{currentUserId:t,spaceId:n,blockId:o}=e;const i=function(e){let{currentUserId:t,spaceId:n}=e;const o=m.Z.get({userId:t,key:Yn(n)});if(o){const e=(0,L.dj)(o);return Array.isArray(e)?e:[]}return[]}({currentUserId:t,spaceId:n}),r=f.jj([o,...i]).slice(0,10);m.Z.set({userId:t,key:Yn(n),value:JSON.stringify(r)})}({currentUserId:o.currentUser.id,spaceId:a.id,blockId:l.id}),wn({environment:o,store:l,scrollToBlockId:c&&c.id,openInNew:n,visitType:ie.vu.Search,pageVisitSource:i,queryId:e.queryId,openInSidePeek:r}))}function wn(e){const{environment:t,store:n,redirect:o,scrollToBlockId:i,collectionViewId:r,openInNew:a,discussionId:l,showMoveTo:c,saveParent:d,visitType:u,templateGalleryItem:p,projectManagementLaunch:m,pageVisitSource:f,openInSidePeek:g,queryId:h,callback:v,peekMode:b}=e,y=(0,re.Hu)({store:n,fullyQualified:!1,scrollToBlockId:i,collectionViewId:r,discussionId:l,showMoveTo:c,saveParent:d,templateGalleryItem:p,projectManagementLaunch:m,openInSidePeek:g,pageVisitSource:f,peekMode:b});n.isNavigableBlock()&&Le.Z.recordVisit({id:n.id,blockType:n.getType(),type:void 0!==u?u:ie.vu.Default,currentUserId:t.currentUser.id}),pn({environment:t,url:f?Z.SK(y,{[s.$X]:f,[s.Mf]:a?h:void 0}):y,redirect:o,openInNew:a,queryId:h,callback:v})}function kn(e){const{environment:t,store:n,peekMode:o,openInNew:i,showMoveTo:r,saveParent:a,resultsStore:s,collectionContextStore:l,pageVisitSource:c}=e,d=e.currentBlockStore??le.default.state.mainEditorCurrentBlockStore;if(!d)return;pn({environment:t,url:Boolean(i)||"full_page"===o?(0,re.Hu)({store:n,fullyQualified:!1,showMoveTo:r,saveParent:a,pageVisitSource:c}):(0,re.Hu)({store:d,peekViewBlockId:n.id,peekMode:(0,Je.getUrlParamFromPeekMode)(o),fullyQualified:!1,showMoveTo:r,saveParent:a,pageVisitSource:c}),openInNew:i}),G.Af({resultsStore:s,collectionContextStore:l})}function In(){const{resultsStore:e}=Je.default.state,t=null==e?void 0:e.getState();if(Je.default.state.open&&t){const{target:e}=Je.default.state,n=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:o}=le.default.state;if(o&&n>0){const e=(0,re.Hu)({store:o,fullyQualified:!1,peekViewBlockId:t[n-1].id,peekMode:(0,Je.getUrlParamFromPeekMode)(Je.default.state.mode),pageVisitSource:s.tY.PeekScroll});pn({environment:o.environment,url:e}),vt.zP(o.environment,{direction:"up"})}}}function Cn(){const{resultsStore:e}=Je.default.state,t=null==e?void 0:e.getState();if(Je.default.state.open&&t){const{target:e}=Je.default.state,n=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:o}=le.default.state;if(o&&n<t.length-1){const e=(0,re.Hu)({store:o,fullyQualified:!1,peekViewBlockId:t[n+1].id,peekMode:(0,Je.getUrlParamFromPeekMode)(Je.default.state.mode),pageVisitSource:s.tY.PeekScroll});pn({environment:o.environment,url:e}),vt.zP(o.environment,{direction:"down"})}}}function xn(e){const{environment:t,targetSelf:n}=e;let o=e.url;"/"===o[0]&&(o=J.default.domainBaseUrl+o);const i=Z.yn(o);if(i)if(t.device.isElectron)Mt.openExternalUrl(i);else if(t.mobileNative)i.startsWith("http:")||i.startsWith("https:")?t.mobileNative.openInAppBrowser(i):window.location.href=i;else{const t=document.createElement("a");t.href=e.url,t.classList.add("notion-link"),n||t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),document.body.appendChild(t),t.click(),t.remove()}}function Tn(e){if(!Boolean(e.mobileNative))return!1;const{device:t}=e,n=(0,U.parseMobileAppVersion)(t.mobileAppVersion,t.isAndroid);return!!n&&(t.isIOS?(0,U.isGreaterThanOrEqualToVersion)(n,[0,4,669]):!!t.isAndroid&&(0,U.isGreaterThanOrEqualToVersion)(n,[0,6,735]))}async function Mn(e,t){return e.device.isElectron||e.device.isMobileNative?await yt.getSignedFileUrl(e,t,!1):(0,u.g)({...t,baseURL:J.default.domainBaseUrl,currentUserId:e.currentUser&&e.currentUser.id})}async function Pn(e,t){vt.QIc(e,{from:"embedded_block_click",type:t.type});let n=t.url;const o=e.mobileNative&&Tn(e),i=d.E$(t.url,[J.default.secureFileS3.url,J.default.secureFileS3V2.url]);i&&(o&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"fetching"}),n=await Promise.race([Mn(e,t),g.Xb(u.nK,void 0)])),n?i&&o?e.mobileNative.showLightBoxV2({url:n,downloadName:t.downloadName,type:t.type,from:t.from,state:"url_ready"}):xn({environment:e,url:n}):(o&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"error"}),p.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}async function An(e,t){let n=t.url;const o=e.mobileNative&&Tn(e),i=d.E$(t.url,[J.default.secureFileS3.url,J.default.secureFileS3V2.url]);i&&(o&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"fetching"}),n=await Promise.race([Mn(e,t),g.Xb(u.nK,void 0)])),n?i&&o?e.mobileNative.showLightBoxV2({url:n,downloadName:t.downloadName,type:"file",from:"download",state:"url_ready"}):i?Dn({environment:e,url:n}):xn({environment:e,url:n}):(o&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"error"}),p.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}function Rn(e,t){e.mobileNative&&Tn(e),d.x$(t);Dn({environment:e,url:t})}function Dn(e){const{environment:t,url:n}=e;t.mobileNative?t.mobileNative.openInAppBrowser(n):t.device.isElectron?Mt.downloadUrl(n):window.location.href=n}async function Bn(e){const{environment:t,blocks:n}=e,{mainEditorCurrentBlockStore:o,currentSpaceViewStore:i,currentUserSettingsStore:r,currentUserRootStore:a}=le.default.state,l=o&&n.find((e=>e.id===o.id));if(l&&i){const e=me.Dg(l,1);(0,Ae.Y)("supportsNativeHome")?fe.NW(t)?En(t):Sn(t):e?wn({environment:t,store:e,pageVisitSource:s.tY.LeaveOrRemove}):await Ht.y3({environment:t,spaceViewStore:i,userSettingsStore:r,userRootStore:a,pageVisitSource:s.tY.LeaveOrRemove})}Boolean(n.find((e=>{var t;return e.id===(null===(t=Je.default.peekTarget.state)||void 0===t?void 0:t.id)})))&&o&&wn({environment:t,store:o,pageVisitSource:s.tY.LeaveOrRemove})}const En=function(e){fe.__(e)?function(e){const{TabbedRouterStore:t}=e,n=t.state,o=(0,r.Os)(n);if(!o)return;const i=o.type;"native"===i?t.updateWithNativePage({page:o,clearPages:!1,navigationAction:"pop",navigationSource:"mobile-back-navigation"}):"web"===i?window.history.back():(0,F.t1)(i)}(e):window.history.back()},Fn=function(){window.history.forward()},Zn=function(){const e=le.default.state.mainEditorCurrentBlockStore;return!!e&&!!me.Dg(e,1)},Ln=function(e){const t=le.default.state.mainEditorCurrentBlockStore;if(!t)return;const n=me.Dg(t,1);n&&wn({environment:e,store:ot.G.createChildStore(n,n.pointer),pageVisitSource:s.tY.Breadcrumb})};async function jn(e){const{environment:t,url:n}=e,o=Z.T1(n);t.device.isNative?pn({url:o,environment:t}):window.location.href=Z.SK(M.NV({httpUrl:o,protocol:J.default.protocol}),{di:await(0,X.cG)(t)})}async function Vn(e){const{id:t,action:n,href:i,environment:r,updateMobileTabbedRouterArgs:c}=e,{RouterStore:d,currentUser:u,TabbedRouterStore:f}=r,b=(null==c?void 0:c.restoringTab)||!1,[x,M]=y.DP({url:i,isMobile:r.device.isMobile,baseUrl:J.default.domainBaseUrl,publicDomainName:J.default.publicDomainName,protocol:J.default.protocol,currentUrl:window.location.href});E.FB(x.name),B.setRouteTags(x,M);const R=d.state.route,D=m.Z.get({userId:u.id,key:t});if(d.setState({id:t,historyState:D,action:n,route:x,initialRoute:d.state.initialRoute||x}),null!=c&&c.forceUpdate||fe.__(r)&&!b){const e={type:"web",url:Z.T1(i),route:x};f.updateWithWebPage({page:e,action:null!=c&&c.forceUpdate?"replace":n,updateMobileTabbedRouterArgs:c})}const F=Z.Qc(i),L=F.query[w.Vt];L&&(0,h.Zj)({currentUserId:u.id,promoCode:L});const U=F.query[a.gS];U&&((0,P.setSessionAnalyticsTags)(U),Gn(a.gS)),"page"===x.name||y.KV[x.name]||vt._Wj(r,i);const{target:O,subtarget:$}=function(e){if(!e)return{target:void 0};const t=null==e?void 0:e.indexOf(".");if(-1===t)return{target:e};return{target:e.substring(0,t),subtarget:e.substring(t+1)}}(F.query.target);"intercom"===O?(Qt.j({environment:r,from:"query_param"}),Gn("target")):"billing"===O||"plans"===O||"members"===O||"audit_log"===O||"connected_apps"===O||"identity_provisioning"===O||"analytics"===O||"admin_content_search"===O||"profile"===O||"notifications_and_settings"===O||"user_settings"===O||"notifications"===O||"language_and_region"===O||"settings"===O||"integrations"===O||"publishing"===O||"imports"===O?(Bt.r$({currentTab:O,subtab:$,isMobile:r.device.isMobile,openedFrom:"email"}),Gn("target")):"contact_us"===O?(je.Z.setState({open:!0}),Gn("target")):"quickfind"===O&&(Promise.race([async()=>{await le.default.waitUntil((()=>void 0!==le.default.state.currentUserSettingsStore&&void 0!==le.default.state.currentSpaceStore&&void 0!==le.default.state.currentSpaceViewStore&&void 0!==le.default.state.currentUserRootStore)),await le.default.waitUntilRendered(),Ot.UT({environment:r,analyticsFrom:"deeplink"})},g.Xb(1500,void 0).then((()=>{Ot.UT({environment:r,analyticsFrom:"deeplink"})}))]),Gn("target")),await Ee.default.waitUntil((()=>Ee.default.state.isLoaded));const Q=Z.T1(i),Y=o.parse(Q.split("?")[1]||"");if(e.enableDesktopAppRedirect&&function(e){const{route:t}=e.RouterStore.state;return y.c$[t.name]&&"always"===qe.Z.state&&e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows||!1)&&(!("configureOpenInDesktopApp"in t)||!t.configureOpenInDesktopApp)}(r))!function(e){let t;try{t=Z.$U((0,oe.W)(window.location.href))}catch{}t&&pn({environment:e,url:t})}(r);else if("root"===x.name){const e={templateGalleryItem:x.templateGalleryItem,projectManagementLaunch:"true"===(Array.isArray(Y.pjm)?Y.pjm[0]:Y.pjm)};!async function(e,t,n){const o=t.currentUser.isLoggedIn(),{RouterStore:i,device:r}=t,a=r.isMobileNative&&r.isIOS,l=i.state.route,c=(e,t)=>{a&&"root"!==i.state.route.name?p.log({level:"warning",from:"routerActions",type:"handleRootRedirect",data:{message:`Prevented ${e} as route has since changed to "${i.state.route.name}"]. Initial route at the start of handleRootRedirect was "${l.name}"}`}}):(a&&p.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:`Redirecting for ${e} as route is still root. Initial route at the start of handleRootRedirect was "${l.name}"}`}}),t())};if(o){a&&p.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:"Called handleRootRedirect"}});const e=await(0,he.iX)({environment:t,disableRedirectUrl:!1}),{firstSpaceView:i,lastVisitedSpaceView:r,forkPageBlockId:l,publicAccessPageId:d,oauthAuthorizationParams:u,userRootStore:f,redirectUrl:g,userSettingsStore:h,userStore:v,isPersonalHomeRedirect:b}=e;b&&(0,we.$X)({environment:t,from:"on_app_start_page"}),await Ee.default.waitUntil((()=>Ee.default.state.isLoaded));await ve.zJ(t,v)&&await ve.yH(t);const y=Se.default.state,S=t.currentUser.id,w=A.Z.get(ye.WX);if(w&&o)return void(await Wn(t,w));if(u&&i&&(e.onboardingCompleted||ye.BB(y))){const{responseType:e,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s}=u;return void W.g({environment:t,responseType:e,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s})}const k=function(e){return m.Z.get({userId:e,key:Yt})}(void 0);Jn({currentUserId:void 0,params:void 0});const I=(null==n?void 0:n.templateGalleryItem)||(null==k?void 0:k.tg),x=(null==n?void 0:n.projectManagementLaunch)||Boolean(null==k?void 0:k.pjm);if(y.isOnboarding)if(ye.BB(y)){if(y.spaceViewId){const e=new ot.V9(t,{table:C.zU,id:y.spaceViewId});"workspace_setup"===y.stage?_t.Xi(t,{spaceViewStore:e}):await Ht.y3({environment:t,spaceViewStore:e,userSettingsStore:h,userRootStore:f,templateGalleryItem:null==n?void 0:n.templateGalleryItem,projectManagementLaunch:null==n?void 0:n.projectManagementLaunch,pageVisitSource:s.tY.Onboarding})}}else mn(t);else if(u&&e.onboardingCompleted){const{responseType:e,integrationId:n,redirectUri:o,state:i,owner:r,userId:a,spaceId:s}=u;W.g({environment:t,responseType:e,integrationId:n,redirectUri:o,state:i,owner:r,userId:a,spaceId:s})}else if(d&&e.onboardingCompleted){Zt.Hr({currentUserId:S,blockId:void 0});const e=ot.G.createChildStore(f,{table:_.iU,id:d});await e.load(),wn({environment:t,store:e,pageVisitSource:s.tY.Direct})}else if(i&&e.onboardingCompleted){const n=g;if(t.device.isMobile&&!e.mobileOnboardingCompleted)await ve.I1(t,{type:"mobile-onboarding",redirectUrl:g});else if(l){z.nM({currentUserId:S,blockId:void 0});const e=ot.G.createChildStore(f,{table:_.iU,id:l});await e.load(),await ee.wU(f);const n=ee.o(f);if(1===n.length){const o=n[0],i=o.getSpaceStore();if(!i)return;z.DK({environment:t,store:e,spaceStore:i,spaceViewStore:o,isPrivate:!0,context:"signin_after_duplicate"})}else wn({environment:t,store:e,pageVisitSource:s.tY.Duplicate})}else if(n){let e=n;(x||I)&&(e=Z.SK(e,{tg:I,pjm:x})),c("redirectUrl",(()=>{pn({environment:t,url:e,redirect:!0})}))}else r?c("lastVisitedSpaceView",(()=>{Ht.y3({environment:t,spaceViewStore:r,userRootStore:f,userSettingsStore:h,templateGalleryItem:I,projectManagementLaunch:x,pageVisitSource:s.tY.Login})})):c("spaceActions.navigateToFirstSpace",(()=>{Ht.L5({environment:t,userRootStore:f,userSettingsStore:h,templateGalleryItem:I,projectManagementLaunch:x,pageVisitSource:s.tY.Login})}))}else await ve.I1(t,{type:"new-user",redirectUrl:g})}}(0,r,e)}else if("onboarding"===x.name)!async function(e){if(e.currentUser.isLoggedIn()){await ve.zJ(e)&&await ve.yH(e)}else{const t=Se.default.state,n=A.Z.get(ye.WX);t.isOnboarding||n?pn({environment:e,url:S._j.signup}):pn({environment:e,url:S._j.login})}}(r);else if("modal"===x.name)if(r.currentUser.isLoggedIn()){let e="/";x.projectManagementLaunch?e+="?tg=gallery":x.templateGalleryItem&&(e+=`?tg=${x.templateGalleryItem}`),pn({environment:r,url:e,redirect:!0})}else pn({environment:r,url:S._j.login,redirect:!0});else if("googleOneTapRedirect"===x.name)!async function(e,t){const{code:n,frontPathName:o}=t;if(!n)return void pn({environment:e,url:S._j.signup});"fail"===(await H.requestLoginWithGoogleOneTap({environment:e,store:Ue.Z,idToken:n,frontPathName:o})).status&&pn({environment:e,url:S._j.signup})}(r,{code:x.code,frontPathName:x.frontPathName});else if("samlAuthCallback"===x.name)!async function(e,t){let n;e.userId?await H.loginSamlUser({environment:t,userId:e.userId,isNewSignup:e.isNewSignup||!1,previousUserId:e.previousUserId}):n=e.token&&e.csrfState?await H.loginSamlUserWithToken({environment:t,csrfState:e.csrfState,token:e.token,isNewSignup:e.isNewSignup||!1}):e.error||de.default.formatMessage(Jt.errorSamlMessage);n&&(Ue.Z.setState({...Ue.Z.state,alert:n}),pn({environment:t,url:S._j.login}))}(x,r);else if("appleAuthCallback"===x.name)!async function(e,t){const{callbackType:n,encryptedToken:o,encryptedNonce:i,code:r,error:a,encryptedUserObject:s,webBrowserDeviceId:l}=e;if("native"===n&&!t.device.isNative)return void jn({url:window.location.href,environment:t});if("user_cancelled_authorize"===a)return Ue.Z.setState({...Ue.Z.state,loginType:"email"}),void pn({environment:t,url:S._j.login});if(a||!r||!o||!i){const e=de.default.formatMessage(Jt.appleErrorMessage);return Ue.Z.setState({...Ue.Z.state,alert:e}),void pn({environment:t,url:S._j.login})}const c=await H.loginWithAppleAuth({environment:t,encryptedToken:o,encryptedNonce:i,code:r,encryptedUserObject:s,webBrowserDeviceId:l});c&&(Ue.Z.setState({...Ue.Z.state,alert:c}),pn({url:S._j.login,environment:t}))}(x,r);else if("googleAuthCallback"===x.name)!async function(e,t){const{callbackType:n,encryptedToken:o,code:i,error:r,webBrowserDeviceId:a}=e;if("native"===n&&!t.device.isNative)return void jn({url:window.location.href,environment:t});"access_denied"===r&&Ue.Z.setState({...Ue.Z.state,loginType:"email"});if(r||!i||!o)return Ue.Z.setState({...Ue.Z.state,alert:r}),void pn({environment:t,url:S._j.login});const s=await H.loginWithGoogleAuth({environment:t,encryptedToken:o,code:i,callbackType:"native"===n||"nativeredirect"===n?n:void 0,webBrowserDeviceId:a});s&&(Ue.Z.setState({...Ue.Z.state,alert:s}),pn({url:S._j.login,environment:t}))}(x,r);else if("googleDriveAuthCallback"===x.name)!function(e,t){const{code:n,error:o}=e;!o&&n&&N.O$(t,n);const{url:i}=Rt.Vr(t);pn({url:i||S._j.root,environment:t})}(x,r);else if("slackAuthCallback"===x.name)On({route:x,environment:r});else if(x.name===y.AY.datadogAuthCallback)zn({route:x,environment:r});else if("externalAuthCallback"===x.name)Nn({route:x,environment:r});else if(x.name===y.AY.authCallback)zn({route:x,environment:r});else if("loginWithEmailCallback"===x.name)!async function(e,t){const{state:n,password:o,isSignup:i,redirectURL:r,webBrowserDeviceId:a}=e,s=await H.loginWithTemporaryPasscode({environment:t,state:n,password:o,redirectURL:r,webBrowserDeviceId:a,passcodeEnterMethod:"magic_link"});s&&(Ue.Z.setState({...Ue.Z.state,alert:s}),pn(i?{url:S._j.signup,environment:t}:{url:S._j.login,environment:t}))}(x,r);else if("loginSuccessCallback"===x.name)!async function(e,t){const{args:n}=He.getState(),{webBrowserDeviceId:o}=e;n?await H.handleLoginWithTemporaryPasscodeSuccess({environment:t,...n,webBrowserDeviceId:o}):(p.log({level:"error",from:"routerActions",type:"handleLoginSuccessRedirect",data:{message:"empty args for handleLoginSuccessRedirect"}}),pn({url:S._j.root,environment:t}))}(x,r);else if("passwordResetCallback"===x.name)!async function(e,t){const{state:n,password:o}=e,i=await H.loginPasswordReset({environment:t,csrfState:n,password:o,loginStore:Ue.Z});i&&(Ue.Z.setState({...Ue.Z.state,loginType:"email",alert:i}),pn({url:S._j.login,environment:t}))}(x,r);else if("passwordChangeRedirect"===x.name)cn({environment:r,url:S._j.login}),pe.E({environment:r});else if("logout"===x.name)!async function(e){await H.actuallyLogoutAndDeleteAllLocalData({environment:e})}(r);else if("login"===x.name||"signup"===x.name){Un(r,i),function(e,t){try{const n=new URL(t).searchParams.get("product")||void 0;n&&Ue.Z.setState({...Ue.Z.state,productType:n}),n===be.bz&&be.DP({currentUserId:e.currentUser.id,data:{onboarding_creator_no_joinable_spaces_v2:"on"}})}catch(n){}}(r,i);const e={doNotRedirectWhenLoggedIn:Boolean(Y.newSignup)};!function(e,t,n){if((0,fe.Sr)()){const t=Z.TW({publicDomainName:J.default.publicDomainName},window.location.host);St.qY({spaceDomain:t,environment:e})}else!e.currentUser.isLoggedIn()||null!=n&&n.doNotRedirectWhenLoggedIn?vt.Snv(e,t):pn({environment:e,url:S._j.root,redirect:!0})}(r,x.name,e)}else"oauthAuthorization"===x.name?async function(e,t){P.setOauthAuthorizationParams(e);const{userId:n,spaceId:o}=e;if(o){const e=n?[n]:t.currentUser.loggedInUserIds;for(const n of e){const e=new ot.r9(t,{table:T.dx,id:n},{userId:n});await e.load();const i=e.getSpaceViewStores();if(i.length>0){await Promise.all(i.map((e=>e.load())));const e=i.find((e=>e.getSpaceId()===o));if(e)return void(await Ht.ce({environment:t,spaceViewStore:e}))}}}const{currentUserRootStore:i}=le.default.state;if(i){await i.load();const e=i.getSpaceViewStores();if(e.length>0){const n=e.find((e=>e.canAdmin()))||e[0];if(n)return void(await Ht.ce({environment:t,spaceViewStore:n}))}}pn({environment:t,url:S._j.login,redirect:!0})}(x,r):"page"===x.name||"space"===x.name?(Un(r,i),function(e,t){if(!t)return;try{const{experimentGroups:n,inviteeEmail:o,inviterName:i}=JSON.parse(window.atob(t));vt.WCB(e,{invitee_email:o,invitation_experiment_groups:n}),Oe.Z.setState({...Oe.Z.state,inviteeEmail:o,inviterName:i}),o&&Ue.Z.setState({...Ue.Z.state,email:o})}catch(n){}}(r,x.state),St.Uz({nextRoute:x,currentRoute:R,environment:r,query:Q}),function(e,t,n){if(!e.device.isMobile){const{mainEditorCurrentBlockStore:r}=le.default.state;if(!r)return;const a=Je.default.state;let l,c=!1,d=!1;if("page"===t.name&&t.peekViewBlockId){const e=ot.G.createChildStore(r,{table:_.iU,id:t.peekViewBlockId});c=Boolean(t.showMoveTo),d=Boolean(t.saveParent),l=e}const u="page"===t.name&&t.peekMode?t.peekMode:void 0,p=(0,Je.getPeekModeFromUrlParam)(u);if(l&&(!a.open||l.id!==a.target.id||p!==a.mode)){var o,i;a.open&&Et.P(a.target,e,$e.jx);const r=$e.jx.getCurrentPageVisitId();$e.jx.initializeNewPageVisitId();const u=st.default.cloneState(),m=dt.Z.cloneState(),f=De.Z.cloneState(),g=e.currentUser.id;tn(e,a.mode),on(e),nn(e),vt.PBo(e,{page_id:l.id,collection_id:l.getParentCollectionId()??(null===(o=l.getCollectionViewCollectionStore())||void 0===o?void 0:o.id),team_id:null===(i=(0,me.VP)(l))||void 0===i?void 0:i.id,is_peek:!0,peek_mode:p,type:"page",query:n,page_visit_id:$e.jx.getCurrentPageVisitId(),previous_page_visit_id:r});const h=new ot.G(e,l.pointer),v=new Qe.Z,b=new nt.Z,y=new Ke.Z,S="page"===t.name&&t.pageVisitSource?parseInt(t.pageVisitSource):void 0,_=!S||S!==s.tY.Create&&S!==s.tY.SidebarQuickAdd?void 0:S;G.bA(e,{mode:p??Je.PeekModeCenter,target:h,pageVisitStore:v,presenceStore:b,showMoveTo:c,saveParent:d,loadingContainerStore:y,savedSelectionStoreState:u,savedTableSelectionStoreState:m,savedCollectionViewSelectionStoreState:f,savedSidebarExpandedStoreState:xe.gV.state,creationSource:_}),Ft._({userId:g,rootStore:h,presenceStore:b,environment:e,pageVisitIdStore:$e.jx}),q.UX(e,{block:h,pageVisitStore:v,timestamp:Date.now(),fromPageRefresh:(0,P.getAppRefreshed)()}),Le.Z.recordVisit({id:l.id,blockType:l.getType(),type:ie.vu.Default,currentUserId:g})}a.open&&!l&&(G.ME(),Ft.E(a.presenceStore,e,$e.jx,a.target),tn(e,a.mode))}}(r,x,Q),function(e,t){if(e.device.isMobile)return;const{mainEditorCurrentBlockStore:n}=le.default.state;if(!n)return;"page"===t.name&&t.templateGalleryItem?"closed"===gt.Z.state.status&&gt.Z.open({analyticsFrom:"direct_link",cloneTo:"destination_picker"}):"closed"!==gt.Z.state.status&&gt.Z.setState({...gt.Z.state,status:"closed"})}(r,x),async function(e,t){"configureOpenInDesktopApp"in t&&t.configureOpenInDesktopApp&&(await Ee.default.waitUntilStatsigReady(),e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows)&&((0,ue.r)()?ct.Z.setState({open:!0,openedFrom:"misc",currentTab:"user_settings",defaultSubtab:void 0,highlightedSetting:ct.R.OpenInDesktopApp}):ct.Z.setState({open:!0,openedFrom:"misc",currentTab:"notifications_and_settings",defaultSubtab:void 0,highlightedSetting:ct.R.OpenInDesktopApp})))}(r,x),await async function(e,t){const{mainEditorCurrentBlockStore:n}=le.default.state;if(!n)return;if("page"===t.name&&t.scrollToBlockId&&t.discussionId){const o=ot.G.createChildStore(n,{table:_.iU,id:t.blockId}),i=(0,ot.Kv)(o,{table:k.qF,id:t.discussionId,spaceId:(0,I.C)(o.pointer.spaceId)});await i.load(),i.getKeyStore("resolved").getValue()&&(Ie.setUpdateExpand({environment:e,isExpanded:!0,from:"resolved_comment"}),Ie.setUpdateSidebarCommentsMode(Me.F7.Resolved))}}(r,x)):"templatesRedirect"===x.name?pn({environment:r,url:(0,fe.UY)("templateGallery"),redirect:!0}):"communityRedirect"===x.name?pn({environment:r,url:(0,fe.UY)("community"),redirect:!1}):"guideRedirect"===x.name?pn({environment:r,url:(0,fe.UY)("guides.guides"),redirect:!0}):"invoiceRedirect"===x.name?pn({environment:r,url:S._j.root,redirect:!0}):"termsRedirect"===x.name?pn({environment:r,url:(0,fe.UY)("terms"),redirect:!0}):"contentPolicyRedirect"===x.name?pn({environment:r,url:(0,fe.UY)("contentPolicy"),redirect:!0}):"uiDoc"===x.name||"exportPreview"===x.name?pn({environment:r,url:S._j.root,redirect:!0}):"admin"===x.name?J.default.isAdminMode||pn({environment:r,url:S._j.root,redirect:!0}):"teamInvite"===x.name?Wn(r,x.inviteCode):"teamsInvite"===x.name?r.currentUser.isLoggedIn()||pn({environment:r,url:S._j.signup,redirect:!0}):"aiGtmFavoriteImport"===x.name?async function(e){const{environment:t,route:n}=e;pn({environment:t,url:S._j.root,redirect:!0}),await le.default.waitUntil((()=>void 0!==le.default.state.currentUserSettingsStore&&void 0!==le.default.state.currentSpaceStore&&void 0!==le.default.state.currentSpaceViewStore&&void 0!==le.default.state.currentUserRootStore)),await le.default.waitUntilRendered(),await(0,K.M)({environment:t,importArgs:n})}({environment:r,route:x}):"new"===x.name?async function(e,t){if(!e.currentUser.id)return void pn({environment:e,url:S._j.root,redirect:!0});const{id:n,type:o,from:i}=t;let r;if(t.spaceId)r=t.spaceId;else{const{spaceId:t}=await Rt.Ie(e);r=t}if(r){const{currentUserSettingsStore:t}=le.default.state,n=new ot.r9(e,{table:T.dx,id:e.currentUser.id});if(await n.load(),void 0===le.default.state.currentSpaceStore||le.default.state.currentSpaceStore.id!==r)try{await Ht.j({environment:e,userRootStore:n,spaceId:r,navigate:!0,analyticsFrom:"redirect",userSettingsStore:t})}catch(s){return void Tt.showMessage({message:(0,l.tg)(s).message,onAccept:()=>{En(e)}})}}else pn({environment:e,url:S._j.root,redirect:!0}),await le.default.waitUntil((()=>void 0!==le.default.state.currentSpaceStore&&void 0!==le.default.state.currentSpaceViewStore&&void 0!==le.default.state.currentUserRootStore));let a;if(o){if(!(0,j.Gu)(V.literals(...We.o1),o)){const e=o;switch(e){case"page":case"team":n&&(a={type:e,spaceId:r,id:n});break;case"space":n&&(a={type:e,id:n});break;case"space-private-pages":a={type:e,spaceId:r}}}}Ie.quickAddPage({environment:e,from:i||"route",redirect:!0,quickAddParentOverride:a})}(r,x):"myIntegrations"===x.name||"inAppTemplateSubmission"===x.name||"inAppTemplateCreatorSubmission"===x.name?function(e){e.currentUser.isLoggedIn()||pn({environment:e,url:S._j.login})}(r):"studentGroupSignup"===x.name?r.currentUser.isLoggedIn()||pn({environment:r,url:S._j.login}):"unknown"===x.name?pn({environment:r,url:S._j.root,redirect:!0}):"nativeTab"===x.name?async function(e,t,n,o){if(!e.currentUser.id)return void pn({environment:e,url:S._j.root,redirect:!0});let i;if(t.spaceId)i=t.spaceId;else{const{spaceId:t}=await Rt.Ie(e);i=t}if(St.Uz({nextRoute:{...t,spaceId:i},currentRoute:n,environment:e,query:""}),"search"===t.tab){if(!it.default.state.sessionId){const t=(0,v.ZP)();it.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:t}))),vt.wFN(e,{from:"pop"===o?"mobile-back-navigation":"mobile-bottom-bar",searchSessionId:t})}}else"updates"===t.tab&&bt.Up({environment:e,from:"pop"===o?"mobile-back-navigation":"mobile-bottom-bar"})}(r,x,R,n):"quickSearch"===x.name?function(e,t,n){if(!e.currentUser.id)return;if(St.Uz({nextRoute:t,currentRoute:n,environment:e,query:""}),!it.default.state.sessionId){const t=(0,v.ZP)();it.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:t}))),vt.wFN(e,{from:"quick-search",searchSessionId:t})}}(r,x,R):"workspaceSetup"===x.name?function(e,t,n){if(!e.currentUser.id)return void pn({environment:e,url:S._j.root,redirect:!0});t.spaceId&&Se.default.state.isOnboarding?St.Uz({nextRoute:t,currentRoute:n,environment:e,query:""}):pn({environment:e,url:S._j.root,redirect:!0})}(r,x,R):"uniqueId"===x.name?await async function(e,t){var n;const o=e.currentUser.id;if(!o)return void $n(e);const i=new ot.r9(e,{table:T.dx,id:o},{userId:o});await i.load();const r=null===(n=i.getSpaceViewStores())||void 0===n?void 0:n[0].getSpaceId();if(!r)return void $n(e);const a=await yt.getIdFromUniqueId(e,{spaceId:r,uniqueId:t});if("failed"===a.type||!a.data.id)return void $n(e);const l=a.data.id,c=ot.G.createChildStore(i,{table:_.iU,id:l});await c.load(),_n({environment:e,store:c,pageVisitSource:s.tY.Direct})}(r,x.uniqueId):"signupForPlus"===x.name?((0,ht.zQ)("plus"),pn({environment:r,url:S._j.signup,redirect:!0})):"signupForBusiness"===x.name&&((0,ht.zQ)("business"),pn({environment:r,url:S._j.signup,redirect:!0}))}function Un(e,t){if(ne.canSetCookie(e))try{const n=new URL(t),o=n.searchParams.get("ps_partner_key"),i=n.searchParams.get("ps_xid");if(i&&o){const t={partnerKey:window.atob(o),clickId:i};return ne.setS2STrackingCookie(e,t),void vt.Esd({partner_stack_key:t.partnerKey})}const r=n.searchParams.get("gspk");if(r){const t=window.atob(r);return ne.setPartnerStackCookie(e,t),void vt.Esd({partner_stack_key:t})}}catch(n){}}async function On(e){const{route:t,environment:n}=e;"legacy"===t.type?await async function(e){const{route:{code:t,state:n},environment:o}=e;let i;if(t&&n){const e=await yt.authWithSlack(o,{code:t,encryptedState:n});"failed"===e.type&&(i=e.error.message)}else i="Something went wrong.";i&&Tt.deprecatedShowErrorMessage(i);const{url:r}=Rt.Vr(o);pn({url:r||S._j.root,environment:o})}({environment:n,route:t}):"new"===t.type?await async function(e){const{route:{error:t},environment:n}=e;if(t){const e=de.default.formatMessage((0,te.mO)(t),{value:t});Tt.showErrorMessage(e)}else await Kt.pJ({environment:n});const{url:o}=Rt.Vr(n);pn({url:o||S._j.root,environment:n})}({environment:n,route:t}):(0,F.t1)(t)}async function Nn(e){const{route:t,environment:n}=e;let o=t.error?t.errorDescription||de.default.formatMessage((0,te.mO)(t.error),{value:t.error}):void 0;try{if(!t.notionState)throw new Error("No notionState.");const e=JSON.parse(decodeURIComponent(t.notionState));await Kt.pJ({environment:n}),await Kt.FD({environment:n,notionState:e})}catch(i){o||(o="An unknown error occurred.")}o&&Tt.deprecatedShowErrorMessage(o),Hn(n)}async function zn(e){const{route:t,environment:n,integrationId:o,from:i,options:r}=e;let a=t.error?t.errorDescription||de.default.formatMessage((0,te.mO)(t.error),{value:t.error}):void 0;try{if(!t.state)throw new Error("No state provided.");if(!t.code)throw new Error("No code provided.");Dt.j({message:Jt.authenticating});const e=await yt.authWithExternalIntegration(n,{code:t.code,state:t.state,...t.name===y.AY.datadogAuthCallback?{accountName:t.organizationName,accountId:t.organizationId,accountDomain:t.site}:void 0});if(Dt.x(),"failed"===e.type)Tt.showError(e);else{const{externalObjectInstanceBlockId:t,spaceId:o}=e.data;await Kt.pJ({environment:n}),await Kt.FD({environment:n,notionState:{externalObjectInstanceBlockId:t,spaceId:o}})}}catch(s){a||(a=(0,l.tg)(s).message)}a&&Tt.deprecatedShowErrorMessage(a),await async function(e){const{environment:t,integrationId:n,from:o}=e;if(function(e){const{currentUserRootStore:t}=le.default.state;if(!t||!e)return!1;const n=(0,ce.Kv)(t,{id:e,table:se.K2}).getKeyStore("capabilities").getValue();return(0,ae.ms)(n)}(n)&&!(0,D.uw)(n)){const{spaceId:e}=await Rt.Ie(t);W.g({environment:t,responseType:"code",spaceId:e,integrationId:n,redirectUri:void 0,state:void 0,owner:void 0,userId:void 0})}else"workspace_connections_redirect"!==o&&Hn(t)}({environment:n,integrationId:o,shouldOpenSettings:null==r?void 0:r.shouldOpenSettings,from:i})}function Hn(e){const{url:t}=Rt.Vr(e);pn({url:t||S._j.root,environment:e})}async function Wn(e,t){const n=Zt.I6({environment:e,request:{type:"invite-link",inviteLinkCode:t}}),o=(await n.next()).value;Re.Z.setState({publicPageData:o});const i=()=>{A.Z.set(ye.WX,t),mn(e)};if(e.currentUser.isLoggedIn()&&o.spaceId){const{id:n}=e.currentUser;if(n){const a=new ot.U6(e,{table:x.KJ,id:n});await a.load();if(!a.getFullName(de.default.getIntl())){i();const t=await(0,he.iX)({environment:e,disableRedirectUrl:!1});return void(await ve.I1(e,{type:"new-user",redirectUrl:t.redirectUrl}))}const c=new ot.r9(e,{table:T.dx,id:n});await c.load();try{const n=await Ht.j({environment:e,userRootStore:c,userSettingsStore:void 0,spaceId:o.spaceId,navigate:!1,analyticsFrom:"redirect",inviteCode:t});await Ht.y3({environment:e,spaceViewStore:n.spaceViewStore,userSettingsStore:void 0,userRootStore:c,pageVisitSource:s.tY.SwitchSpace})}catch(r){const{currentUserRootStore:t,currentUserSettingsStore:n}=le.default.state,o=t&&n;Tt.showMessage({message:(0,l.tg)(r).message,acceptLabel:o?de.default.formatMessage(Jt.backToContent):de.default.formatMessage(Jt.goBack),onAccept:()=>{A.Z.remove(ye.WX),o?Ht.L5({environment:e,userRootStore:t,userSettingsStore:n,pageVisitSource:s.tY.Onboarding}):En(e)}})}}}else i()}async function qn(e,t){const{utmContent:n,nextRoute:o}=t,[i,r]=await Promise.all([dn(e),un(e,{utmContent:n,utmSource:"public_page"})]);cn({environment:e,url:o,extraSearchParams:{...i,...r}})}function Gn(e){const t=Z.T1(Z.iO(window.location.href,e));window.history.replaceState(history.state,void 0,t)}const Kn=async function(e){const t=window.history.state&&window.history.state.id||(0,b.ZP)();if(!window.history.state){const n=e.currentUser.id;window.history.replaceState({id:t,currentUserId:n},void 0,window.location.href),an({historyId:t,historyIndex:0,currentUserId:n})}(0,Ae.Y)("supportsNativeSearch")&&e.TabbedRouterStore.setupWithNativeSearch(),await Vn({environment:e,id:t,action:"pop",href:window.location.href,updateMobileTabbedRouterArgs:{forceUpdate:!0,silenceErrors:!0,clearNativeRootPageOverride:"/"!==window.location.pathname},enableDesktopAppRedirect:!0});const n=e.currentUser.id,o=Qn(n);if(!o||"undefined"===o){const e=window.location.pathname;e&&function(e){let{currentUserId:t,value:n}=e;R.Z.set({userId:t,key:"sourceInitialPage",value:n})}({currentUserId:n,value:e})}};function $n(e){const t={name:"notFound"};e.RouterStore.setState({id:(0,b.ZP)(),route:t,action:"push",initialRoute:e.RouterStore.state.initialRoute||t})}function Qn(e){return R.Z.get({userId:e,key:"sourceInitialPage"})}function Yn(e){return`recentQuickJumps:${e}`}function Jn(e){let{currentUserId:t,params:n}=e;m.Z.set({userId:t,key:Yt,value:n})}function Xn(e){const{searchResult:t,environment:n,openInNew:o,pageVisitSource:i,queryId:r,openInSidePeek:a}=e,{store:s}=t,l=(0,ge.dy)(t);void 0===l?_n({store:s,openInNew:o,environment:n,pageVisitSource:i,queryId:r,openInSidePeek:a,peekMode:a?"s":void 0}):wn({environment:n,store:s,scrollToBlockId:l,openInNew:o,visitType:ie.vu.Search,pageVisitSource:i,queryId:r,openInSidePeek:a,peekMode:a?"s":void 0})}},3898:(e,t,n)=>{n.d(t,{Nz:()=>g,uE:()=>p});var o=n(72126),i=n(21202),r=n(98165),a=n(52315),s=n(35328),l=n(80444),c=n(35661),d=n(15690),u=n(29373);function p(e){const t=e.state;return"page"===t.route.name&&t.route.scrollToBlockId?[t.route.scrollToBlockId]:t.historyState?t.historyState.blockIds:[]}function m(e,t){const n=function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:i.iU,id:t}))).map((e=>r.qA(e))).filter((t=>{let n=!1;const o=t.slice(1).find((e=>{if("block"===e.table)return e.isTransclusionType()&&(n=!0),e.isNavigableBlock()}));return o&&(o.id===e.id||n)})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>"block"===e.table&&(0,s.BX)(e)))}));return o.mN(o.xH(n),(e=>e.id))}(e,t);for(const o of n)u.rd({blockId:o.id,state:!0,currentUserId:o.environment.currentUser.id});return n}function f(e,t){const n=function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:i.iU,id:t,spaceId:e.pointer.spaceId}))).map((e=>r.qA(e))).filter((t=>{const n=t.slice(1).find((e=>"block"===e.table&&e.isNavigableBlock()));return n&&n.id===e.id})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>{if("block"!==e.table)return!1;const t=e.getParentStore();return"block"===(null==t?void 0:t.table)&&"tab"===(null==t?void 0:t.getType())}))}));return o.mN(o.xH(n),(e=>e.id))}(e,t);for(const o of n){const e=o.getParentStore();var a;if((null==e?void 0:e.table)===i.iU&&"tab"===(null==e?void 0:e.getType()))d.x2({store:e,id:o.id,currentUserId:null===(a=l.default.state.currentUserStore)||void 0===a?void 0:a.id})}return n}async function g(e,t){await async function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:i.iU,id:t})));await Promise.all(n.map((e=>r.s(e))))}(e,t);const n=o.mN([...m(e,t),...f(e,t)],(e=>e.id));await async function(e){await Promise.all(e.map((e=>a.r(e))))}(n)}},61045:(e,t,n)=>{n.d(t,{NQ:()=>j,Q7:()=>G,YC:()=>H,Zv:()=>V,_4:()=>z,aB:()=>Z,bx:()=>L,hQ:()=>W,hl:()=>U});var o=n(73935),i=n(14577),r=n(72126),a=n(68056),s=n(77546),l=n(89224),c=n(47372),d=n(3994),u=n(75987),p=n(95802),m=n(55521),f=n(96198),g=n(5162),h=n(34859),v=n(80796),b=n(64233),y=n(65686),S=n(19111),_=n(69454),w=n(19671),k=n(13023),I=n(88923),C=n(35661),x=n(27724),T=n(10743),M=n(24666),P=n(50906);function A(e,t,n,o){const i=(n-t)/n,r=o/10/60,a=r+(3*o/60-r)*Math.min(i*i,1);return e.device.isIOS?Math.ceil(a):a}const R=1e3,D=r.P2((e=>{P.PL5(e,{direction:"top"})}),R),B=r.P2((e=>{P.PL5(e,{direction:"bottom"})}),R),E=r.P2((e=>{P.PL5(e,{direction:"left"})}),R),F=r.P2((e=>{P.PL5(e,{direction:"right"})}),R);function Z(e){const{environment:t,scroller:n,currentMouseX:o,currentMouseY:i,verticalEdgeThreshold:r,horizontalEdgeThreshold:a,disableVerticalEdgeScroll:s,disableHorizontalEdgeScroll:l}=e,{clientRect:c,scrollTop:d,scrollHeight:u,scrollLeft:p,scrollWidth:m}=n.stores.store.state;if(c){if(n.props.type!==h.Z.X&&!s){const e=i-c.top;let o,a;_.Z.state.phase!==_.i.shown?(o=r,a=(0,g.Y)("supportsNativeBottomBarOverlappingWebView")?c.bottom-_.Z.estimatedNativeWebBottomOverlap()-i:c.bottom-i):(o=.25*_.Z.state.estimatedKeyboardWebViewOverlap,a=c.bottom-_.Z.estimatedNativeWebBottomOverlap()+o-i);const s=0===d,l=d+c.height===u;if(e<r&&!s){const o=A(t,e,r,c.height);n.scrollTo(d-o,void 0),o>0&&D(t)}if(a<o&&!l){const e=A(t,a,o,c.height);n.scrollTo(d+e,void 0),e>0&&B(t)}}if(n.props.type!==h.Z.Y&&!l){const e=o-c.left,i=c.right-o,r=0===p,s=p+c.width===m;if(e<a&&!r){const o=A(t,e,a,c.width);n.scrollTo(void 0,p-o),o>0&&E(t)}if(i<a&&!s){const e=A(t,i,a,c.width);n.scrollTo(void 0,p+e),e>0&&F(t)}}}}function L(e){const{element:t,scrollers:n,vertical:o,horizontal:i,animate:r}=e,a=t.getBoundingClientRect();if(o&&n.verticalScroller){const{reveal:e}=o,t=o.paddingToTopEdge||64,i=o.paddingToBottomEdge||64,s=n.verticalScroller,l=s&&s.getClientRect();if(s&&l){const n=l.top+t,o=l.bottom-i,c=a.top>n&&a.top<o,d=a.bottom>n&&a.bottom<o,u=a.top<n&&a.bottom>o,p=a.bottom-o,m=a.top-n;"top"===e?c||s.scrollByOffset(m,0,{animate:r}):"bottom"===e?d||s.scrollByOffset(p,0,{animate:r}):c||d||u||(Math.abs(p)<Math.abs(m)?s.scrollByOffset(p,0,{animate:r}):s.scrollByOffset(m,0,{animate:r}))}}if(i&&n.horizontalScroller){const{reveal:e}=i,t=i.paddingToLeftEdge||64,o=i.paddingToRightEdge||64,s=n.horizontalScroller,l=s&&s.getClientRect();if(s&&l){const n=l.left+t,i=l.right-o,c=a.left>n&&a.left<i,d=a.right>n&&a.right<i,u=a.left<n&&a.right>i,p=a.right-i,m=a.left-n;"left"===e?c||s.scrollByOffset(0,m,{animate:r}):"right"===e?d||s.scrollByOffset(0,p,{animate:r}):c||d||u||(Math.abs(p)<Math.abs(m)?s.scrollByOffset(0,p,{animate:r}):s.scrollByOffset(0,m,{animate:r}))}}}function j(e){const{component:t,horizontal:n,vertical:i,animate:r}=e;if(!t)return;const a=o.findDOMNode(t);return a&&a instanceof Element?L({vertical:i,animate:r,horizontal:n,element:a,scrollers:{verticalScroller:t.getContextVerticalScroller?t.getContextVerticalScroller():void 0,horizontalScroller:t.getContextHorizontalScroller?t.getContextHorizontalScroller():void 0}}):void 0}function V(){if(x.default.state.pivot)U([x.default.state.pivot.id]);else{U(x.default.state.stores.map((e=>e.id)))}}function U(e,t){const n=p.C.findScrollToSelectablesFromIds(e)[0];if(n){const{disableScrollToRevealHorizontal:e}=n.props;j({component:n,vertical:{reveal:"closest"},horizontal:e?void 0:{reveal:"closest"},animate:t})}}let O=function(e){return e[e.top=0]="top",e[e.middle=1]="middle",e[e.bottom=2]="bottom",e[e.natural=3]="natural",e}({});function N(e){let{position:t}=e;const{paddingTop:n}=e;if("editing"!==M.default.state.mode)return;let o=e.paddingBottom;c.Z.find((e=>e.props.show))&&(o+=f.O);const i=l.get();if(i){const e=s.SD(i.commonAncestorContainer);if(!e)return;const r=s.hI(e).find((e=>e.scrollHeight>e.clientHeight));if(!r)return;const a=l.getRect(i);if(!a||!r)return;const c=r.getBoundingClientRect();if(!(i.startContainer instanceof Text)){const e=a;e.top+=4,e.bottom-=5,e.height-=9}const d=a.top<c.top+n,u=a.bottom>c.bottom-o;if(i.startContainer instanceof Text&&i.startOffset!==i.endOffset)return;if(t===O.natural)if(u)t=O.bottom;else{if(!d)return;t=O.top}if(t===O.top){const e=r.scrollTop+a.top,t=c.top+n;r.scrollTop=e-t}else if(t===O.bottom){const e=r.scrollTop+a.bottom,t=c.bottom-o;r.scrollTop=e-t}else if(t===O.middle){const e=r.scrollTop+a.top,t=c.top+c.height/2-10;r.scrollTop=e-t}}}function z(){return _.Z.estimatedNativeWebBottomOverlap()+20}function H(e){if(u.Z.isInlineAutocompleteOpen())return!0;const t=e.device.isMobile&&(!e.device.isNative||e.device.isTablet);return!!(!t&&S.Z.state.open||!t&&T.Z.state.open||!t&&function(){var e;const t="editing"===M.default.state.mode&&(null===(e=(0,a.QY)(M.default.state.multiSelection))||void 0===e?void 0:e.store);if(t){const e=t.getRecordStoreAtRootPath();if(e instanceof C.G){const t=e.getValue(),n=t&&t.type;return"link_to_page"===n||"link_to_collection"===n}}return!1}()||b.Z.state.open)}function W(e){const t=d.Z.shouldPreventMobileAutoScroll(e);H(e)?N({position:O.top,paddingTop:20,paddingBottom:z()}):t||w.Z.state.isOpen&&!I.default.state.open||k.Z.state.isOpen||N({position:O.natural,paddingTop:20,paddingBottom:z()})}const q=r.IH((e=>{const{device:t}=e;return new i.Z((()=>t.isMobile&&v.Z.state.isDragging||t.isMobile&&m.Z.state.swiping?h.Z.All:y.Z.getPreventScrollType()),{debugName:"preventScrollTypeStore"})}));function G(e){return q(e).state}},31299:(e,t,n)=>{n.d(t,{$w:()=>Q,CO:()=>ie,D7:()=>N,E5:()=>U,M0:()=>q,RF:()=>Y,RT:()=>$,Te:()=>re,UJ:()=>ce,WL:()=>le,Yu:()=>ne,bI:()=>G,bm:()=>K,df:()=>H,nJ:()=>z,pz:()=>te,ri:()=>se,sC:()=>ee,tw:()=>O,vp:()=>V,yy:()=>ae,zf:()=>de});n(57658);var o=n(43261),i=n.n(o),r=n(94568),a=n(15070),s=n(33728),l=n(77657),c=n(58573),d=n(72126),u=n(63306),p=n(27006),m=(n(4615),n(45953)),f=(n(99405),n(21202)),g=n(77420),h=n(6287),v=n(19889),b=n(92338),y=n(64684),S=n(70203),_=n(97880),w=n(7928),k=(n(95477),n(57254)),I=n(4708),C=n(19124),x=n(98165),T=n(67669),M=n(15447),P=n(48141),A=n(16639),R=n(80444),D=n(69327),B=n(35661),E=n(78291),F=n(34583),Z=n(88893),L=n(54642),j=n(45264);const V=300,U=75;async function O(e){const{currentSpaceStore:t,currentSpaceViewStore:n}=R.default.state;if(t)return await P.hb({environment:e,currentSpaceStore:t,currentSpaceViewStore:n})}async function N(e){const{environment:t,query:n,limit:o,spaceId:i,requireEditPermissions:r,excludeTemplates:a,source:s,boostRecentlyViewedPages:l}=e,{currentSpaceStore:c}=R.default.state,d={results:[],recordMap:m.PF.create().toJson({allowVersionDowngrade:!1}),total:0,trackEventProperties:{}};if(!c)return d;const u=await O(t),p=b.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:a,requireEditPermissions:r||void 0}),f={field:"relevance"};if(!n&&u){const e=P.iA({query:{query:{text:n,filters:p,sort:f},limit:o},localCachedPages:u,userId:t.currentUser.id,environment:t,applyRecallScoreThreshold:!1,canUseLtr:!1});return e||d}const g=await L.search(t,{type:b.n8.BlocksInSpace,query:n,spaceId:i,limit:o,filters:p,sort:f,source:s,recentPagesForBoosting:l?(0,M.Wk)(D.Z.getWithoutSubscribing(i)):void 0});if("failed"===g.type)throw g.error;return g.data}async function z(e){const t=await N(e);return{results:t.results.map((e=>e.id)),recordMap:t.recordMap}}async function H(e){const{environment:t,query:n,collectionId:o,limit:i,spaceId:r,excludeTemplates:a,source:s,includePublicPagesWithoutExplicitAccess:l,boostRecentlyViewedPages:c,ignoresHighlight:u}=e,p=new Array,m=await O(t),f=b.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,includePublicPagesWithoutExplicitAccess:l,excludeTemplates:a}),g={field:"relevance"},v=L.search(t,{type:b.n8.BlocksInCollection,query:n,spaceId:r,collectionId:o,limit:i,filters:f,sort:g,source:s,recentPagesForBoosting:c?(0,M.Wk)(D.Z.getWithoutSubscribing(r)):void 0,ignoresHighlight:u});if(m){const e={table:h.v,id:o,spaceId:r},a=new B.NW(t,e);await a.load();const s=P.iA({query:{query:{text:n,filters:a.isPageTreeCollection()?{...f,ancestors:[o]}:{...f,parentId:o},sort:g},limit:i},localCachedPages:m,userId:t.currentUser.id,environment:t,applyRecallScoreThreshold:!1,canUseLtr:!1});s&&p.push(...s.results)}const y=await v;if("failed"===y.type){if(0===p.length)throw y.error}else{let e=y.data.results;n||(e=P.YB({sort:g,batchSize:i,currentUserId:t.currentUser.id,unsorted:e})),p.push(...e)}return{results:d.oA(d.jj(p.map((e=>e.id))))}}async function W(e){const{environment:t,query:n,ancestorId:o,limit:i,excludeTemplates:r,source:a}=e,s=await L.search(t,{type:b.n8.BlocksInAncestor,query:n,ancestorId:o,filters:b.u4({navigableBlockContentOnly:!0,excludeTemplates:r}),sort:{field:"relevance"},limit:i,source:a});if("failed"===s.type)throw s.error;return s.data}async function q(e){return{results:(await W(e)).results.map((e=>e.id))}}async function G(e){const{environment:t,query:n,limit:o,ancestorId:i,spaceId:r}=e,a=0===n.trim().length?{field:"lastEdited",direction:"desc"}:{field:"relevance"},s={query:n,filters:b.u4({isDeletedOnly:!0,navigableBlockContentOnly:!0,excludeTemplates:!1,editedBy:e.editedById?[e.editedById]:[]}),sort:a,limit:o,spaceId:r,source:"trash"},l=i?L.search(t,{type:b.n8.BlocksInAncestor,...s,ancestorId:i}):L.search(t,{type:b.n8.BlocksInSpace,...s}),c=await l;if("failed"===c.type)throw c.error;{const{results:e,recordMap:t,total:n}=c.data;return{results:e.map((e=>e.id)),recordMap:m.PF.create(t),endOfResultsReached:n===e.length}}}async function K(e,t){const{query:n,limit:o,source:i,requireEditPermissions:r,databaseType:a}=t,{currentSpaceStore:s}=R.default.state;if(!s)return{results:[],total:0};const l=s.id,[c,u]=await Promise.all([ue(e,{...t,spaceId:l,requireEditPermissions:r,databaseType:a}),L.search(e,{type:b.n8.CollectionsInSpace,query:n,spaceId:s.id,limit:o,filters:{...b.u4({excludeTemplates:!0,requireEditPermissions:r,databaseType:a})},sort:{field:"relevance"},source:i,recentPagesForBoosting:(0,M.Wk)(D.Z.get(l))})]),p=d.G0("success"===u.type?d.oA(u.data.results.map((e=>e.collectionId))):[],c).slice(0,o);return{results:p,total:"success"===u.type?u.data.total:p.length}}async function $(e){const{environment:t,collectionViewBlockStore:n,parentStore:o,query:i,limit:r,requireEditPermissions:a,databaseType:s}=e;if(!o.isDefaultRecordCache())return{results:[],total:0};let l=[],c=0;if(!i){const{currentSpaceStore:e}=R.default.state,i=t.currentUser.id;e&&(l=[...j.lG({currentUserId:i,spaceId:e.id}).map((e=>B.NW.createChildStore(o,{table:h.v,id:e})))]),l=[...d.oA(null==n?void 0:n.getCollectionViewStores().map((e=>e.getCollectionStore()))),...l],s&&(l=l.filter((e=>{const t=e.getDatabaseType();return!!t&&s.includes(t)}))),l=d.mN(l,(e=>e.id)).filter((e=>!a||e.canEdit()))}const u=await K(t,{query:i,limit:r,source:"collection_settings_source",requireEditPermissions:a,databaseType:s});return l=[...l,...u.results.map((e=>B.NW.createChildStore(o,{table:h.v,id:e})))],c=u.total,l=l.filter((e=>!(0,x.wf)(e)&&e.canRead())),await Promise.all(l.map((async e=>{await e.load()}))),{results:d.oA([...d.mN(l,(e=>e.id)).slice(0,r).map((e=>e.id))]),total:c}}function Q(e){const{query:t,intl:n}=e,{currentSpaceStore:o}=R.default.state,i=null==o?void 0:o.getPermissionGroups();if(!i)return[];return t?(0,c.ZP)(t,i,(e=>(0,A.kF)({intl:n,group:e}))):i}async function Y(e){const{query:t}=e,{currentSpaceStore:n}=R.default.state;if(!n)return[];return X({currentSpaceStore:n,query:t,botIds:await J(e)})}async function J(e){const{environment:t}=e,{currentSpaceStore:n}=R.default.state;if(!n)return[];const o=n.id;await F.OR({environment:t,spaceId:o});const{data:i}=E.default.state;if(!i)return[];const r=(0,Z.NM)(i);return d.jj(r.map((e=>e.botId)))}async function X(e){const{currentSpaceStore:t,query:n,botIds:o}=e,i=d.oA(await Promise.all(o.map((async e=>{const n=(0,B.Kv)(t,{table:g.cZ,id:e,spaceId:t.id});return await n.load(),n.getValue()}))));return n?(0,c.ZP)(n,i,a.y2):i}async function ee(e){const{query:t,environment:n,spaceId:o,botSettings:i}=e;if(!o)return[];const r=await L.searchIntegrations(n,{query:t});if("success"===r.type){const e=r.data.integrationIds,t=i&&i.integration_approval_statuses?Object.keys(i.integration_approval_statuses):[],n=Boolean(null==i?void 0:i.integration_restrictions),o=Boolean("approved_or_built_by_notion"===(null==i?void 0:i.integration_restrictions));return n?e.filter((e=>o?t.includes(e)||(0,l.BP)({integrationId:e,env:"production"}):t.includes(e))):e}if("failed"===r.type)throw r.error;(0,_.t1)(r)}async function te(e){var t;let{currentSpaceStore:n,query:o,userIds:i}=e,a=d.oA(await Promise.all(i.map((async e=>{const t=B.U6.createChildStore(n,{table:v.KJ,id:e});return await t.load(),t.getValue()}))));(0,C.Gw)()&&(0,k.A)()&&(a=d.oA(a.map((e=>{const t=(0,r.OU)(e.email);if(t)return{...e,email:t}}))));const l=new Set(n.getEmailDomains()),u=(null===(t=E.default.state.data)||void 0===t?void 0:t.userSimilarity)??{},p=Math.max(...Object.values(u));function m(e){var t;return e===(null===(t=R.default.state.currentUserRootStore)||void 0===t?void 0:t.userId)?p+1e-5:u[e]??0}const f=d.xb(u)?a:a.sort(((e,t)=>{const n=m(e.id);return m(t.id)-n}));return o?(0,c.ZP)(o,f,w.of,{getSortScore:e=>{const{original:t,score:n}=e,o=t.email&&(0,s.Gd)(t.email);return n*(o&&l.has(o)?-2:-1)}}):a}async function ne(e){const{currentSpaceStore:t}=R.default.state;if(!t)return[];const n=e.query.startsWith("@")?e.query.slice(1):e.query,o=await oe(e);return await te({currentSpaceStore:t,query:n,userIds:o})}async function oe(e){const{environment:t,membersOnly:n}=e,{currentSpaceStore:o}=R.default.state;if(!o)return[];await F.OR({environment:t,spaceId:o.id});const{data:i}=E.default.state;if(!i)return[];const r=(0,Z.CM)(i).filter((e=>!(n&&!(0,p.Jy)(e.role)))),{mainEditorCurrentBlockStore:a,currentUserStore:s}=R.default.state,l=a&&!n?(0,T.YO)(a).flatMap((e=>{let{permissionItem:t}=e;return(0,p.jg)(t)?[t.user_id]:[]})):[],c=((0,I.F$)()&&a?function(e,t){const n=x.VP(e);if(n){const e=new Set((0,y.Hf)({membership:n.getRawMembership()}));return t.filter((t=>"none"!==t.role||t.isPageGuest||t.isTeamGuest&&e.has(t.userId)))}return t.filter((e=>"none"!==e.role||e.isPageGuest))}(a,r):r).map((e=>e.userId));return d.jj([...d.oA([null==s?void 0:s.userId]),...l,...c])}async function ie(e){const[t,n]=await Promise.all([ne(e),Y(e)]);return{users:t,bots:n}}async function re(e){const[t,n]=await Promise.all([oe(e),J(e)]);return{userIds:t,botIds:n}}async function ae(e,t){const n=(0,s.H3)(t);if((0,s.oH)(n)&&n){const t=await L.findUser(e,{email:n});if("failed"===t.type)throw t.error;const o=t.data;return o.value?{user:o.value.value}:{email:n}}return{}}async function se(e){const{query:t,userIds:n,botIds:o}=e,{currentSpaceStore:i}=R.default.state;if(!i)return{users:[],bots:[]};const[r,a]=await Promise.all([te({currentSpaceStore:i,query:t,userIds:n}),X({currentSpaceStore:i,query:t,botIds:o})]);return{users:r,bots:a}}async function le(e){const{nearBlock:t,environment:n,query:o,source:i}=e,{currentSpaceStore:r}=R.default.state,a=t&&(0,T.YO)(t).find((e=>{let{permissionItem:t}=e;return(0,p.$D)(t)}));if(r){return(await N({environment:n,query:o,limit:20,spaceId:r.id,requireEditPermissions:!1,excludeTemplates:!0,source:i,boostRecentlyViewedPages:!0})).results}if(a&&a.from.table===f.iU){return(await W({environment:n,query:o,limit:20,ancestorId:a.from.blockId,excludeTemplates:!0,source:i})).results}return[]}async function ce(e){const{environment:t,query:n,source:o,limit:i}=e,{currentSpaceStore:r}=R.default.state;if(!r)return[];return(await N({environment:t,query:n,limit:i||20,spaceId:r.id,requireEditPermissions:!0,excludeTemplates:!0,source:o,boostRecentlyViewedPages:!1})).results.filter((e=>{const t=B.G.createChildStore(r,{table:f.iU,id:e.id}),n=(0,x.fJ)(t);return(0,u.$t)(n)}))}async function de(e){let{spaceViewStore:t,query:n,teamStores:o}=e;const i=d.oA(await Promise.all(o.map((async e=>(await e.load(),e.getValue()))))),r=t.getTeamsStores(),a=new Set(r.map((e=>e.id)));return n?(0,c.ZP)(n,i,(e=>e.name),{getSortScore:e=>{const{original:t,score:n}=e;return n*(a.has(t.id)?-2:-1)}}):i}function ue(e,t){const{query:n,limit:o,spaceId:r,requireEditPermissions:a,databaseType:s}=t,l=[];return e.defaultRecordCache.inMemoryRecordCache.forEachRecord(e.currentUser.id,(e=>{let{model:t,role:c}=e;if(!(l.length>=o)&&t.table===h.v&&t&&t.space_id===r){if(a&&!(0,p.J5)(c))return;const e=(0,S.QaF)(t.getName()),o=t.getDatabaseType();i().test(n,e)&&(!s||s&&o&&s.includes(o))&&l.push(t.pointer.id),t.getDatabaseType}})),l}},87531:(e,t,n)=>{n.d(t,{IB:()=>w,Kf:()=>S,UT:()=>_,bn:()=>x,em:()=>k,ih:()=>T,yt:()=>C});var o=n(15157),i=n(4615),r=n(89101),a=n(94804),s=n(70203),l=n(33932),c=n(45317),d=n(19124),u=n(77907),p=n(80444),m=n(5737),f=n(77080),g=n(22294),h=n(55320),v=n(29026),b=n(50906),y=n(75018);function S(e){h.default.state.open?w():_(e)}function _(e){const{environment:t,renderAsPage:n,isQuickSearch:o,isPublicPageSearch:a}=e,s=(0,i.ZP)(),l=Date.now();if(Boolean(o))h.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:l,sessionId:s,isPublicPageSearch:a??!1,intentBasedSearch:{...I()}}))),v.ZP.update((e=>({...e,isSidePeekPanelOpen:T(t)})));else if(Boolean(n))y.navigate({environment:t,url:`${r.VP.nativeTab}/search`,redirect:!0}),h.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:l,sessionId:s,isPublicPageSearch:a??!1,intentBasedSearch:{...I()}}))),v.ZP.update((e=>({...e,isSidePeekPanelOpen:T(t)})));else{if(h.default.state.open)return;h.default.update((e=>({...e,open:!0,openAsPage:!1,openedTimeMs:l,sessionId:s,isPublicPageSearch:a??!1,intentBasedSearch:{...I()}}))),v.ZP.update((e=>({...e,isSidePeekPanelOpen:T(t)})))}b.wFN(e.environment,{from:e.analyticsFrom,searchSessionId:s})}const w=()=>{h.default.state.open&&(h.default.reset(),g.Z.setKeyboardMode(!1))};async function k(e){const{environment:t,shouldResetAssistantStore:n=!0,isQuickSearch:o}=e,i=p.default.state.mainEditorCurrentBlockStore??p.default.state.currentSpaceStore,r=v.ZP.state.query.text,a=h.default.state.sessionId;if(!i)return;const{assistantActions:f}=await u.deps.assistant.loader();n&&await f.resetAndInitializeAssistantStores({environment:t,primeTextInput:r.length<=6?r:void 0,clientSkill:c.lU}),(0,d.Fk)(o)&&h.default.state.open?v.ZP.update((e=>({...e,mode:"assistant"}))):(w(),l.O({view:"chat"}));const g=r.length>6;g&&f.commitHumanStep({environment:t,text:(0,s.TPx)(r)}),b.IR(t,{configurationState:m.NM.state,hasQuery:g,from:"search",searchSessionId:a})}function I(){return{enablesGrouping:!1,enablesSidePeekPanel:"on"===f.default.getGroup("search-intent-based-grouping-n-side-peek")}}function C(){return h.default.state.intentBasedSearch.enablesSidePeekPanel}function x(e){const t=v.ZP.state.isSidePeekPanelOpen;o.Z.set({userId:e,key:a.Y6,value:!t}),v.ZP.update((e=>({...e,isSidePeekPanelOpen:!t})))}function T(e){const t=C(),n=e.currentUser.id;if(!t||!n)return!1;return!f.default.checkGate("search_toggle_side_peek")||(0,a.w8)(n)}},5851:(e,t,n)=>{n.d(t,{n:()=>f,y:()=>g});n(57658);var o=n(72126),i=n(97880),r=n(5366),a=n(33929),s=n(50906),l=n(54642),c=n(47307),d=n(9953),u=n(29974),p=n(39699);const m=(0,r.defineMessages)({saveFieldError:{id:"securitySAMLSettings.saveSettingsError.message",defaultMessage:"Something went wrong."}});function f(e,t){const{securitySettingsState:n,spaceStore:o}=t,{disablePublicAccess:i,disableGuests:r,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:f,disableGuestMembershipRequests:g,enableAiFeature:h,disableTeamGuests:v,enableGuestInviteRequests:b}=n;return p.createAndCommit({userAction:"securitySettingsActions.saveSecuritySettings",environment:e,perform:t=>{u.Xr({environment:e,transaction:t,spaceStore:o,disablePublicAccess:i,disableGuests:r,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:f,disableGuestMembershipRequests:g,enableAiFeature:Boolean(h),disableTeamGuests:v,enableGuestInviteRequests:b})}})}function g(e,t){const{securitySettingsStore:n,spaceStore:r,fields:u}=t,f={...n.state},g={...n.state,...u};n.setState(g),void 0!==u.disableGuests&&(l.updateDisableGuestsOnSpace(e,{spaceId:r.id,newDisableGuestsValue:u.disableGuests,keepExistingGuests:Boolean(u.keepExistingGuests)}).then((e=>{if("failed"===e.type)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void n.setState(f)})),s.o8J(e,{new_value:u.disableGuests,keep_existing_guests_if_disabled:Boolean(u.keepExistingGuests)})),p.createAndCommit({userAction:"SecuritySettings.saveToggle",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{if(e)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void n.setState(f)}));const t=o.GM({disable_public_access:u.disablePublicAccess,disable_move_to_space:u.disableMoveToSpace,disable_export:u.disableExport,disable_space_page_edits:u.disableSpacePageEdits,disable_public_access_requests:u.disablePublicAccessRequests},(e=>o.kK(e)));d.sW({store:r,data:t,transaction:e});const s=o.GM({enable_guest_invite_requests:u.enableGuestInviteRequests,disable_membership_requests:u.disableMembershipRequests,disable_external_membership_requests:u.disableExternalMembershipRequests,disable_guest_membership_requests:u.disableGuestMembershipRequests},(e=>!(0,i.$K)(e)));Object.keys(s).length>0&&p.applyOperation({store:r,operation:{pointer:r.pointer,path:["settings"],command:"update",args:s},transaction:e})}}),(0,i.$K)(u.enableGuestInviteRequests)&&s.tBP(e,{new_value:u.enableGuestInviteRequests})}},42858:(e,t,n)=>{n.d(t,{Ah:()=>de,Cl:()=>ee,DQ:()=>me,DV:()=>be,MD:()=>Q,Od:()=>$,QZ:()=>ce,Qw:()=>X,VJ:()=>pe,WG:()=>fe,YP:()=>ge,ZJ:()=>he,aO:()=>oe,at:()=>re,bj:()=>J,dK:()=>le,is:()=>te,jQ:()=>ue,mp:()=>ne,nG:()=>ae,uE:()=>ve,zO:()=>Y});n(57658),n(21703),n(52262),n(24506);var o=n(1302),i=n(15145),r=n(41432),a=n(72126),s=n(5366),l=n(21202),c=n(23867),d=n(63143),u=n(69278),p=n(95477),m=n(19037),f=n(28020),g=n(77181),h=n(40959),v=n(35683),b=n(33929),y=n(65598),S=n(41984),_=n(58202),w=n(95802),k=n(80444),I=n(77080),C=n(88923),x=n(35661),T=n(27724),M=n(34583),P=n(50906),A=n(54642),R=n(48299),D=n(30188),B=n(41433),E=n(47307),F=n(54532),Z=n(54604),L=n(94419),j=n(18957),V=n(75018),U=n(61045),O=n(24677),N=n(84084),z=n(64964),H=n(15690),W=n(98104),q=n(39699),G=(n(68422),n(1742));const K=(0,s.defineMessages)({deletePages:{id:"action.deletePages.snackBarMessage",defaultMessage:"Moved to trash"}});function $(e){var t,n;const{store:o,transaction:i}=e,r=w.C.findSelectablesFromStore(o).find((e=>Boolean(e.props.onRemove)));null==r||null===(t=(n=r.props).onRemove)||void 0===t||t.call(n,{transaction:i})}function Q(e){const{blocks:t,transaction:n}=e;if(1===t.length){const e=t[0];e&&y.PF(e)&&$({store:e,transaction:n})}}function Y(e){const t=w.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const n of t)n.stores.selectableStore.setState({...n.stores.selectableStore.state,showActionIsInFlight:!0})}function J(e){const t=w.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const n of t)n.stores.selectableStore.setState({...n.stores.selectableStore.state,showActionIsInFlight:!1})}async function X(e){const{environment:t,blocks:n}=e;let o=!0;const i=[];for(const s of n){const e=_.R.findBlockFromStore(s);if(e&&a.mf(e.handleRemoveBlockFromComment)){if(await e.handleRemoveBlockFromComment())continue}else if(e&&a.mf(e.canRemoveBlock)){const t=await e.canRemoveBlock();if(!t.canRemove)return;o=t.canUndo}const n=await R.NN({environment:t,block:s,action:"delete"});if("user_canceled"===n)return;n.length>1?i.push(...n):i.push(s)}if(0===i.length)return;if(I.default.checkGate("collection_subitem_nested_operations"))await D.VP({environment:t,blocks:i,canUndo:o});else{const{serverCommitResult:e}=q.createAndCommit({userAction:"selectableBlockActions.removeBlocksWithMaybeConfirmation",environment:t,canUndo:o,perform:e=>{ee({environment:t,blocks:i,transaction:e})}});await e}const{currentSpaceStore:r}=k.default.state;r&&i.some((e=>e.isPageBlock()))&&z.d4({item:{label:b.default.formatMessage(K.deletePages)},undoFunc:()=>{for(const e of i)A.restoreBlock(t,{pointer:{table:l.iU,id:e.id,spaceId:e.pointer.spaceId||r.id}})}}),i.some((e=>{var t;return e.id===(null===(t=C.default.peekTarget.state)||void 0===t?void 0:t.id)}))&&j.xv(t,void 0)}function ee(e){const{environment:t,blocks:n,transaction:o,preventClearSelection:i}=e,s=n[0],l=function(e){const t=w.C.getMembersByDOMOrder({filter:()=>!0}),n=a.cx(t,(t=>t.props.store===e)),o=t[n];if(!o)return;const i=o.getContextSelectableContainer(),r=a.tP(t,0,n),s=a.dF(r,(e=>e.props.canSelect&&e.getContextSelectableContainer()===i));if(s)return s.props.store;const l=a.tP(t,n+1).find((e=>Boolean(e.props.canSelect&&e.getContextSelectableContainer()===i)));if(l)return l.props.store}(s);!function(e){const{environment:t,block:n,entryPointName:o}=e,i=new G.GD({environment:t,userFlow:"user_flow_delete_block",entryPointName:o,timeoutMs:90*d.C0});if(i.isDisabled())return;const r=()=>{n.pathIsDead()&&i.succeed()};i.postFinishCallbacks.push((()=>{n.removeListener(r)})),n.addListener(r)}({environment:t,block:s,entryPointName:o.getUserActionForAnalyticsPurposesOnly()||"selectableBlockActions.removeBlocks"});for(const r of n)$({store:r,transaction:o});if(i||(O.ZH(t),O.Fp({pivot:l})),m._J({environment:t,blocks:n,publicEditMode:void 0})||m.Nn({environment:t,blocks:n,publicEditMode:void 0})||m.oY({environment:t,blocks:n,publicEditMode:void 0})||n.some((e=>{var t;return e.getType()===r.Ti.transclusionContainer||(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))){o.postSubmitCallbacks.push((e=>{e||A.deleteBlocks(t,{blocks:n.map((e=>({id:e.id,spaceId:(0,c.C)(e.pointer.spaceId)}))),permanentlyDelete:!1})}));for(const e of n){const{app_id:n,app_config_uri:o}=e.getFormat();n&&o&&P.Cug(t,{block_id:e.id,app_id:n,app_config_uri:o})}V.navigateAwayIfCurrentPage({environment:t,blocks:n})}i||W.ZH(t)}function te(e){const{environment:t,blocks:n,selection:o,transaction:i,replaceEmptyTextBlock:r,preventSetSelection:s,insertAfterBlock:l}=e,c=f.RM();if(!c)throw new Error("No root store.");let d;if(o.length>0){const e=l||o.at(-1);let s=e;if(Boolean(n.find((e=>e.isType("column_list"))))){const t=null==e?void 0:e.findRecordStoreUIAncestor((e=>e&&e instanceof x.G&&e.isType("column_list"))).ancestor;t&&t instanceof x.G&&(s=t)}const u=w.C.find((e=>e.props.store===s&&e.props.canInsertBelow&&e.props.onInsertBelow));if(u&&u.props.onInsertBelow)d=a.oA(u.props.onInsertBelow({insertStores:n,transaction:i})),r&&e&&e.isEmptyTextBlock()&&ee({environment:t,blocks:[e],transaction:i});else{d=a.d9(n).reverse().map((e=>L.Ce({parent:c.getContentStore(),prepend:e,transaction:i}).child))}}else if(c.isCollectionView()){const e=_.R.findBlockFromStoreWithMethod(c,"insertBlocks");if(!e)throw new Error("No collection view found.");d=e.insertBlocks(n,i)}else{const e=c.getContentStore();d=n.map((t=>L.R3({parent:e,append:t,transaction:i}).child))}return Boolean(s)||(d=d.flatMap((e=>e.isType("column_list")?e.getContentStores().flatMap((e=>e.getContentStores())):[e])),O.Z5({environment:t,stores:d})),d}function ne(e){const{blocks:t}=e,n=t[0];if(n){const t=w.C.findSelectableFromStore(n);t&&t.props.onEnter&&t.props.onEnter(e)}}function oe(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:r,preventSetSelection:a}=e,s=T.default.getCurrentRecordCache(),l=new G.BW({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let c;if(M.M_(t)&&n&&s){var d;const e=B.fC({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:s,from:r,useCrdt:0!==o.length?o[0].useCrdt():(null===(d=f.RM())||void 0===d?void 0:d.useCrdt())??!1});l.track(e.pointer,i),c=te({environment:t,blocks:[e],selection:o,transaction:i,replaceEmptyTextBlock:!1,preventSetSelection:a})[0]}else l.fail("invalid_state");return c}function ie(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:r}=e,a=T.default.getCurrentRecordCache();let s;if(M.M_(t)&&n&&a){var l;s=function(e){const{environment:t,selection:n,transaction:o}=e,{blocks:i}=e,r=f.RM();if(!r)throw new Error("No root store.");if(n.length>0){const e=n[0],r=w.C.find((t=>t.props.store===e&&t.props.canInsertAbove&&t.props.onInsertAbove));if(!r||!r.props.onInsertAbove)throw new Error("No Selectable found.");const a=r.props.onInsertAbove({insertStores:i,transaction:o});return O.Z5({environment:t,stores:a}),a}{const e=r.getContentStore(),n=i.map((t=>L.R3({parent:e,append:t,transaction:o}).child));return O.Z5({environment:t,stores:n}),n}}({environment:t,blocks:[B.fC({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:a,from:r,useCrdt:0!==o.length?o[0].useCrdt():(null===(l=f.RM())||void 0===l?void 0:l.useCrdt())??!1})],selection:o,transaction:i})[0]}return s}function re(e){const{environment:t,selection:n,transaction:o}=e,i=oe({...e,preventSetSelection:!0});i&&be({environment:t,insertedStores:[i],isCreated:!0}),Q({transaction:o,blocks:n})}async function ae(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:i}=e;if(!M.M_(t))return;let r=n;if(1===n.length){const e=await R.NN({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return;r=e}const a=I.default.checkGate("collection_subitem_nested_operations"),s=r.at(0);s&&(a&&(0,g.wP)(s)?await D.W9({blocks:r,environment:t}):q.createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,perform:e=>{se({environment:t,blocks:r,transaction:e,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:i})},transactionTooBigFallback:e=>{se({environment:t,blocks:r,transaction:e,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:i})}}),o.default.afterNextFlush((()=>{U.Zv()})))}function se(e){const{environment:t,blocks:n,transaction:o,preferDuplicateLocation:i,lastTopLevelBlock:r,preventSetSelection:s,duplicateOnlyCollectionSchema:l}=e,d=a.vM(n,(e=>e.getFormat().app_id??e.id)),u=[];return a.Ed(d,(e=>{const r=e[0],a=!r.isTransclusionType(),[s,d]=F.Qi({environment:t,stores:e,addCopyName:(0,S.Z)(r),transaction:o,deepCopyTransclusionContainers:a,resolveTemplateVariables:!(r.isInsideTemplate()||r.isInsideFactoryOrDuplicateBlocksAction()),targetSpaceId:(0,c.C)(r.pointer.spaceId),baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferDuplicateLocation:i,useCrdt:0!==n.length&&n[0].useCrdt(),duplicateOnlyCollectionSchema:l});u.push(...s),d.then((e=>{e&&E.showErrorMessage(e)}))})),te({environment:t,blocks:u,selection:r?[r]:n,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:s}),u}function le(e){const t=e.blocks[0],{blockLocationOfTargetBlock:n}=e,o=_.R.find((e=>e instanceof u.Z&&e.props.store===t&&(!n||e.props.blockLocation===n)));o&&o.canRenderFullScreen()&&Z.ui({environment:o.environment,renderFullScreenNode:o.renderFullScreenNode,fullScreenNodeRect:o.getFullScreenNodeRect(),block:t})}function ce(e){let t;e.blocks.find((e=>{const n=_.R.findBlockFromStoreWithMethod(e,"activate");return!!n&&(t=n,!0)})),t&&t.activate()}function de(e){e.blocks.forEach((t=>{const n=t.getParentStore();n&&n.table===l.iU&&n.getType()===r.Ti.tab&&H.x2({store:n,id:t.id,currentUserId:e.environment.currentUser.id})}))}function ue(e){const t=e.blocks[0],n=_.R.findBlockFromStoreWithMethod(t,"configure");n&&(n.configure(),P.PEc(e.environment,{from:"block_action"}))}function pe(e){const t=e.blocks[0],n=_.R.findBlockFromStoreWithMethod(t,"caption");n&&n.caption()}function me(e,t){const n=a.oA(w.C.findSelectablesFromIds(t)).map((e=>e.props.store));O.Z5({environment:e,stores:n})}function fe(e,t){const n=w.C.findScrollToSelectablesFromIds(t);n[0]&&(U.NQ({component:n[0],vertical:{reveal:"top"},horizontal:{reveal:"closest"}}),O.Z5({environment:e,stores:n.map((e=>e.props.store))}))}function ge(e){const{environment:t,blocks:n}=e,o=n[0].findRecordStoreUIAncestor((e=>e instanceof x.G&&e.isCollectionView())).ancestor;o&&V.navigateToBlock({environment:t,store:o,visitType:v.vu.Link,pageVisitSource:i.tY.Expand})}function he(e){const{blocks:t,transaction:n,environment:i}=e,r=oe({environment:i,selection:t,createBlockItem:h.Hc.text,analyticsFrom:"text_insert_below",transaction:n});return r&&o.default.afterNextFlush((()=>{N.hb({environment:i,blockStore:r})})),r}function ve(e){const{blocks:t,transaction:n,environment:i}=e,r=ie({environment:i,selection:t,createBlockItem:h.Hc.text,analyticsFrom:"text_insert_above",transaction:n});return r&&o.default.afterNextFlush((()=>{N.hb({environment:i,blockStore:r})})),r}function be(e){const{environment:t,insertedStores:n,isCreated:i}=e;i?o.default.afterNextFlush((()=>{const e=n[0];if(!e)return;const o=_.R.findBlockFromStoreWithMethod(e,"handleCreated");o?o.handleCreated():(O.Ys({environment:t,store:e}),O.Db(t))})):O.Z5({environment:t,stores:n})}},24677:(e,t,n)=>{n.d(t,{$Y:()=>E,Af:()=>F,Ch:()=>ee,DI:()=>G,Db:()=>O,FC:()=>$,Fp:()=>Z,Jy:()=>X,KX:()=>M,OS:()=>R,Ys:()=>V,Z5:()=>j,ZH:()=>z,aw:()=>B,e2:()=>q,eP:()=>U,hn:()=>J,ji:()=>A,rs:()=>D,td:()=>Q,w5:()=>Y,wI:()=>L,yu:()=>N,zJ:()=>H});n(57658);var o=n(55010),i=n(1302),r=n(72126),a=n(95371),s=n(77181),l=n(28314),c=n(69645),d=n(35328),u=n(27406),p=n(16339),m=n(95802),f=n(41662),g=n(12211),h=n(50628),v=n(27724),b=n(45131),y=n(45264),S=n(30188),_=n(89951),w=n(67060),k=n(61045),I=n(84084),C=n(98104),x=n(29373),T=n(39699);function M(){const e=v.default.getCurrentDefaultContainer();if(e){return m.C.getMembersByDOMOrder({filter:t=>t.getContextSelectableContainer()===e&&t.props.canSelect}).map((e=>e.props.store))}return[]}function P(e){const t=v.default.state.stores,n=v.default.state.pivot,o=r.oA(r.zu(t,n));let i;i=n===r.Z$(t)?t[t.length-2]:t[1],j({environment:e,stores:o,pivot:i})}function A(e){const t=l.yA();return e.device.isMac?t.shift&&t.command:t.shift&&t.option}function R(){return l.yA().shift}function D(e){e.sort(((e,t)=>(0,o.Z)(m.C.findNodeFromStore(e),m.C.findNodeFromStore(t))))}function B(e){const t=new Array(e.length);return m.C.forEach((n=>{if(n.props.canSelect){const o=e.indexOf(n.props.store);if(o>=0){const e=n.getNode();e&&(t[o]=e)}}})),e.filter(((n,o)=>{const i=t[o];return n&&!e.some(((e,n)=>{const o=t[n];return Boolean(o&&o!==i&&i&&o.contains(i))}))}))}function E(e){v.default.setState({...v.default.state,phase:e.phase}),e.phase===v.SelectionPhase.Editing||e.preventClearEditingText||C.ZH(e.environment)}function F(e){const{stores:t}=e,n=v.default.state.stores,o=r.G0(t,n);o.length===t.length&&o.length===n.length||v.default.setState({...v.default.state,stores:e.stores}),t.length>0&&(y.wG(),f.g$.blockSelectionInSimpleTable(t)||f.HM.clearSelection())}function Z(e){v.default.setState({...v.default.state,pivot:e.pivot})}function L(e){const{stores:t}=v.default.state;F({stores:t.map((t=>t===e.store?e.replace:t))})}function j(e){const{environment:t}=e,n=B(e.stores);F({stores:n}),E({environment:e.environment,phase:e.phase||v.SelectionPhase.Selected}),1===n.length&&function(e){var t;const n=e.anchor,o=null===(t=m.C.findSelectableFromStore(n))||void 0===t?void 0:t.getNode();let i;o&&(i=v.default.getDefaultContainerFromTarget(o)),v.default.setState({...v.default.state,anchor:n,anchorContainer:i})}({anchor:n[0]});const o=e.pivot||n[0];if(Z({pivot:o}),i.default.afterNextFlush((()=>{D(n)})),e.phase===v.SelectionPhase.Editing&&o)if(t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=m.C.findScrollToSelectableFromStore(o);e&&k.NQ({component:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function V(e){void 0===e.toggle&&(e.toggle=!1),void 0===e.selectBetween&&(e.selectBetween=!1);const{stores:t}=v.default.state;if(e.toggle)r.q9(t,e.store)?j({environment:e.environment,stores:r.zu(t,e.store)}):j({environment:e.environment,stores:r.G0(t,[e.store])});else if(e.selectBetween){let n=r.d9(t);const o=M(),i=o.indexOf(e.store);r.q9(n,e.store)||n.push(e.store);const a=t[0];if(a){const e=o.indexOf(a);if(e>=0){const t=r.tP(o,i,e);n=r.G0(n,t)}}const s=r.Z$(t);if(s){const e=o.indexOf(s);if(e>=0){const t=r.tP(o,e,i);n=r.G0(n,t)}}j({environment:e.environment,stores:n})}else r.q9(t,e.store)||j({environment:e.environment,stores:[e.store]});E({environment:e.environment,phase:v.SelectionPhase.Selected})}function U(e){const{environment:t,store:n}=e;if(n)if(F({stores:[n]}),Z({pivot:void 0}),E({environment:t,phase:v.SelectionPhase.Editing}),t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=m.C.findScrollToSelectableFromStore(n);e&&k.NQ({component:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function O(e){const{stores:t}=v.default.state,n=t[0];if(!n)return;const o=m.C.findSelectableFromStore(n);if(o&&o.props.onEditText){const t=o.props.onEditText;T.createAndCommit({userAction:"selectionActions.editSelection",environment:e,perform:e=>{t({isAtStartOfLine:!1,isClick:!1,transaction:e})}})}}function N(e){const{environment:t,stores:n}=e,o=r.Z$(n);if(!o)return;const i=m.C.findSelectableFromStore(o);if(i&&i.props.onEditText){const e=i.props.onEditText;T.createAndCommit({userAction:"selectionActions.editStoresAtEnd",environment:t,perform:t=>{e({isAtStartOfLine:!1,isClick:!1,transaction:t})}})}}function z(e){F({stores:[]}),E({environment:e,phase:v.SelectionPhase.Selected}),w.xv(),I.xv(),_.xv()}function H(e){const{environment:t}=e,n=v.default.state.stores;D(n);const o=v.default.state.pivot,i=n[0];if(i)if(e.shiftKey)if(o===i){const o=(0,c.Bj)({includeNonSelectableListContainer:!1}),s=(0,c.v5)(i,o.children),{prev:l,parent:d}=e.altKey?(0,a.Sr)(o,s):(0,a.YL)(o,s);if(l){const e=l.value.store;j({environment:t,stores:r.G0(n,[e]),pivot:e})}else if(d){const e=d.value.store;j({environment:t,stores:r.G0(n.filter((e=>!(0,a.Yz)(d,(t=>t.store===e)))),[e]),pivot:e})}}else P(e.environment);else{const n=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(i,n.children),{prev:r,parent:s}=e.altKey?(0,a.Sr)(n,o):(0,a.YL)(n,o);if(r){const e=r.value.store;j({environment:t,stores:[e],pivot:e})}else if(s){const e=s.value.store;j({environment:t,stores:[e],pivot:e})}else j({environment:t,stores:[i],pivot:i})}else if(o)j({environment:t,stores:[o]});else{const e=M(),n=r.Z$(e);n&&j({environment:t,stores:[n],pivot:n})}W()}function W(){const e=v.default.state.pivot||v.default.state.stores[0],t=m.C.findScrollToSelectableFromStore(e);t&&k.NQ({component:t,vertical:{reveal:"top"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}function q(e){const t=v.default.state.stores;D(t);const n=v.default.state.pivot;if(0!==t.length&&n)if((0,d.BX)(n)&&b.Z.isOpen(n.id))j({environment:e,stores:[n],pivot:n}),x.rd({blockId:n.id,state:!1,currentUserId:e.currentUser.id});else if((0,s.bX)(n))S.e2(n);else{const t=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(n,t.children),i=(0,a.ub)(o);if(i){const t=i.value.store;j({environment:e,stores:[t],pivot:t})}else j({environment:e,stores:[n],pivot:n})}else if(n)j({environment:e,stores:[n]});else{const t=M(),n=r.Z$(t);n&&j({environment:e,stores:[n],pivot:n})}W()}function G(e){const{environment:t}=e,n=v.default.state.stores;D(n);const o=v.default.state.pivot,i=r.Z$(n);if(i)if(e.shiftKey)if(o===i){const e=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(i,e.children),{next:s}=(0,a.Xf)(e,o);if(s){const e=s.value.store;j({environment:t,stores:r.G0(n,[e]),pivot:e})}}else P(t);else{const n=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(i,n.children),{next:r}=e.altKey?(0,a.Xf)(n,o):(0,a.lj)(n,o);if(r){const e=r.value.store;j({environment:t,stores:[e],pivot:e})}else j({environment:t,stores:[i],pivot:i})}else if(o)j({environment:t,stores:[o]});else{const e=M()[0];e&&j({environment:t,stores:[e],pivot:e})}K()}function K(){const e=v.default.state.pivot||r.Z$(v.default.state.stores);if(e){const t=m.C.findScrollToSelectableFromStore(e);t&&k.NQ({component:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function $(e){const t=v.default.state.stores;D(t);const n=v.default.state.pivot;if(0!==t.length&&n)if((0,d.BX)(n)&&!b.Z.isOpen(n.id))j({environment:e,stores:[n],pivot:n}),x.rd({blockId:n.id,state:!0,currentUserId:e.currentUser.id});else if((0,s.bX)(n))S.FC(n);else{const t=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(n,t.children),i=(0,a.si)(o);if(i){const t=i.value.store;j({environment:e,stores:[t],pivot:t})}else j({environment:e,stores:[n],pivot:n})}else if(n)j({environment:e,stores:[n]});else{const t=M()[0];t&&j({environment:e,stores:[t],pivot:t})}K()}function Q(e){const t=M();j({environment:e,stores:t,pivot:t[0]})}function Y(e){const t=M()[0];if(t){j({environment:e,stores:[t],pivot:t});const n=m.C.findScrollToSelectableFromStore(t);n&&k.NQ({component:n,vertical:{reveal:"top"},horizontal:n.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function J(e){const t=M(),n=t[t.length-1];if(n){j({environment:e,stores:[n],pivot:n});const t=m.C.findScrollToSelectableFromStore(n);t&&k.NQ({component:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function X(){const e=performance.now(),t=new Map,n=new Map;m.C.forEach((e=>{const o=e.getNode();if(o&&o instanceof Element){const i=o.getBoundingClientRect();t.set(e,i),n.set(o,i)}}));const o=new Map;p.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&o.set(e,t.getBoundingClientRect())}));const i=new Map;u.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&i.set(e,t.getBoundingClientRect())})),h.Z.setState({...h.Z.state,selectableRectMap:t,selectableContainerRectMap:o,selectableElementRectMap:n,lastUpdate:e}),g.Z.setState({...g.Z.state,dropTargetRectMap:i})}const ee=r.P2(X,200)},84084:(e,t,n)=>{n.d(t,{RL:()=>S,_P:()=>b,hb:()=>y,xv:()=>_});var o=n(13991),i=n(70203),r=n(69783),a=n(73959),s=n(89224),l=n(95802),c=n(64233),d=n(19111),u=n(10743),p=n(50906),m=n(24677),f=n(97444),g=n(98104);const h=new Set(["/","／"]),v={"ja-JP":new Set(["；"])};function b(e){const{environment:t,textStore:n,oldSelection:a,oldTextValue:l}=e,m=i.eeV(n.getValue()||[]),f=a.startIndex,g=m[f],b=v[o.SP]||new Set;if(!h.has(g)&&!b.has(g))return;const y=i.gPn(m,f-10,f).join("");if(/[0-9]$/.test(y[y.length-1]))return;if(y.endsWith("http:")||y.endsWith("http:/")||y.endsWith("https:")||y.endsWith("https:/"))return;if(u.Z.state.open||r.Z.state.open||d.Z.state.open||c.Z.state.open)return;if(t.device.isPhone)return;const S=s.get();if(!S)return;const _=s.getRect(S);_&&(u.Z.setState({open:!0,isAddMenu:!1,textStore:n,oldTextValue:l,oldSelection:a,selectionRect:_,lettersAtLastResult:0,filter:""}),p.V_i(t))}function y(e){const{environment:t,blockStore:n}=e,o=u.Z.state;if(m.eP({environment:t,store:n}),g.N_({store:n.getBlockTitleStore()}),!o.open&&!t.device.isPhone){const e=n.getBlockTitleStore(),t=l.C.getRectFromStore(n);t&&u.Z.setState({open:!0,isAddMenu:!0,textStore:e,oldTextValue:e.getValue(),oldSelection:{startIndex:0,endIndex:0},selectionRect:t,lettersAtLastResult:0,filter:""})}}function S(e){const{transaction:t,environment:n}=e,o=u.Z.state;if(o.open){const{textStore:e,oldTextValue:i,oldSelection:r}=o;f.sO({environment:n,store:e,value:i,transaction:t}),_();const s=(0,a.sQ)(e);s&&m.eP({environment:n,store:s}),g.Z5({store:e,selection:r})}}function _(){u.Z.setState({open:!1,previousFilter:u.Z.state.open?u.Z.state.filter:void 0})}},64964:(e,t,n)=>{n.d(t,{C1:()=>d,d4:()=>c,oV:()=>s,rN:()=>l});n(67294);var o=n(71644),i=n(6854),r=n(1310),a=n(85893);function s(e){const t={...e,key:(0,o.ZP)()};r.ZP.setState({...r.ZP.state,currentItem:t}),"keep"!==t.durationMs&&setTimeout((()=>{r.ZP.state.currentItem===t&&"keep"!==r.ZP.state.currentItem.durationMs&&r.ZP.setState({...r.ZP.state,currentItem:void 0})}),t.durationMs??r.Ty)}function l(){r.ZP.setState({...r.ZP.state,currentItem:void 0})}function c(e){const{item:t,undoFunc:n}=e;s({...t,right:(0,a.jsx)(i.ow,{onUndo:n})})}function d(){r.ZP.state.shouldReset&&r.ZP.reset()}},29974:(e,t,n)=>{n.d(t,{$F:()=>fe,$U:()=>je,F1:()=>ue,IY:()=>Ie,L5:()=>pe,LV:()=>Le,Ns:()=>ke,O2:()=>xe,OF:()=>be,Xr:()=>ye,Xv:()=>Pe,Y5:()=>Be,Yi:()=>me,_Q:()=>Ae,_u:()=>ve,bf:()=>we,cU:()=>Ze,ce:()=>ce,eX:()=>le,j:()=>_e,jF:()=>Me,lF:()=>Ce,mo:()=>Te,oy:()=>Re,sw:()=>Fe,wg:()=>Ee,wh:()=>se,y3:()=>de,ys:()=>Se});n(21703),n(57658),n(67294);var o=n(15145),i=n(68626),r=n(72126),a=n(91155),s=n(27006),l=n(4615),c=n(45953),d=n(21202),u=n(15047),p=n(77858),m=n(29369),f=n(66079),g=n(62965),h=n(90965),v=n(54153),b=n(97880),y=n(5366),S=n(95477),_=n(24215),w=n(15010),k=n(33929),I=n(38755),C=n(95697),x=n(55081),T=n(10929),M=n(75538),P=n(30806),A=n(94841),R=n(78861),D=n(80444),B=n(88632),E=n(73329),F=n(69327),Z=n(81236),L=n(35661),j=n(34583),V=n(70060),U=n(33493),O=n(60027),N=n(50906),z=n(54642),H=n(35253),W=n(47307),q=n(57400),G=n(94273),K=n(94419),$=n(92625),Q=n(29533),Y=n(76464),J=n(9953),X=n(4408),ee=n(75018),te=n(5851),ne=n(28014),oe=n(39699),ie=n(70782),re=n(85893);const ae=(0,y.defineMessages)({deletingWorkspace:{id:"spaceActions.deletingWorkspace.loadingMessage",defaultMessage:"Deleting workspace…"},goOnlineCreateSpace:{defaultMessage:"Please go online to create your workspace.",id:"spaceActions.dialogError.createWorkspaceError.goOnline.message"},createSpaceError:{defaultMessage:"Sorry! We could not create your workspace. Please try again.",id:"spaceActions.dialogError.createWorkspaceError.message"},loginToCreateSpace:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.createWorkspaceError.notLoggedIn.message"},moveToSpaceOnlineError:{defaultMessage:"Please go online to move content to another space.",id:"spaceActions.dialogError.moveContentError.goOnline.message"},cannotMoveShardRestriction:{defaultMessage:"Cannot move these pages at once.",id:"spaceActions.dialogError.moveContentError.cannotMovePages.message"},cannotMoveContent:{defaultMessage:"Sorry! We could not move this content. Please try again.",id:"spaceActions.dialogError.couldNotMoveContentError.message"},loginToMoveContent:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.movetoWorkspace.notLoggedIn.message"},invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnNavigate:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.navigateToWorkspace.invalidStorage.message"},noSpaceViewOnJoin:{defaultMessage:"No space view data was created.",id:"spaceActions.dialogError.joinWorkspace.invalidWorkspaceStorage.message"},noLocalDataForPermissionGroup:{defaultMessage:"No local data about this workspace.",id:"spaceActions.dialogError.createOrUpdatePermissionGroup.invalidWorkspaceStorage.message"}});async function se(e){const{environment:t,name:n,domain:o,userRootStore:i,emailDomains:a,analyticsFrom:s,icon:l,planType:c,userPersona:d,shouldCreateUserPersonaTeam:g,shouldMakeUserPersonaTeamDefault:h}=e,{id:v}=t.currentUser;if(v){const e=await z.createSpace(t,{name:n,domain:o,emailDomains:a,icon:l,planType:c,initialPersona:d,shouldCreateUserPersonaTeam:g,shouldMakeUserPersonaTeamDefault:h});if("failed"===e.type){if(e.offline)throw new Error(k.default.formatMessage(ae.goOnlineCreateSpace));throw new Error(k.default.formatMessage(ae.createSpaceError))}const{spaceId:b,teamId:y,personaTeamId:S,inviteLinkCode:_}=e.data,I=new L.H2(t,{table:u.bx,id:b}),C=y?L.zX.createChildStore(I,{table:m.e0,id:y}):void 0,x=S?L.zX.createChildStore(I,{table:m.e0,id:S}):void 0,{serverCommitResult:T,performResult:{spaceViewStore:M}}=oe.createAndCommit({userAction:"spaceActions.createSpace",environment:t,perform:e=>{const n=J.ae({environment:t,table:p.zU,value:{space_id:I.id,notify_mobile:!0,notify_desktop:!0,notify_email:!0,parent_id:v,parent_table:f.dx,alive:!0,joined:!0,joined_teams:(C||x)&&r.oA([null==C?void 0:C.id,null==x?void 0:x.id]),settings:{notify_email_digest:!0}},inMemoryRecordCache:i.inMemoryRecordCache,transaction:e}),o=new L.V9(t,n.pointer);return K.R3({parent:i.getSpaceViewsStore(),append:n,transaction:e}),K.MK({parent:i.getSpaceViewPointersStore(),append:n,transaction:e}),D.default.setState({...D.default.state,currentSpaceStore:I,currentSpaceViewStore:o}),N.VTb(t,{from:s,planType:c,isProfessionalTeamUser:(0,w.QZ)(),domain_type:(0,w.JF)()}),{spaceViewStore:o}}});return await T,await q.Yh(t),{spaceViewStore:M,spaceStore:I,inviteLinkCode:_,teamStore:C,personaTeamStore:x}}throw new Error(k.default.formatMessage(ae.loginToCreateSpace))}async function le(e){const{environment:t,blockStores:n,spaceId:o,targetParent:s}=e,{id:l}=t.currentUser;if(l){if(!B.Z.state.online)return{error:k.default.formatMessage(ae.moveToSpaceOnlineError)};const e=[],m=[];for(const t of n)t.isDefined()&&(e.push({id:t.id,spaceId:t.getSpaceId()}),m.push(o));if(r.jj(m).length>1)return{error:k.default.formatMessage(ae.cannotMoveShardRestriction)};if(s&&s.spaceId!==o)return{error:k.default.formatMessage(ae.cannotMoveShardRestriction)};const f=z.moveToSpace(t,{blocks:e,targetSpaceId:o,targetParent:s,clearPermissions:(0,C.bq)()});let g;for await(const n of f){if(Q.R(n,o),n.error)return _.j(t,"move_to_space_error",{}),i.log({level:"error",from:"spaceActions",type:"moveSpaceError",error:(0,a.Ui)(n.error),data:{userId:l,blocks:e,spaceId:o}}),{error:k.default.formatMessage(ae.cannotMoveContent)};{const e=c.PF.create(n.value.recordMap).getByTable(d.iU);for(const{value:t}of e){var u,p;if("copy_indicator"===(null==t||null===(u=t.value)||void 0===u?void 0:u.type))g=null==t||null===(p=t.value)||void 0===p?void 0:p.id}}}return Q.h(o),{value:g}}return{error:k.default.formatMessage(ae.loginToMoveContent)}}async function ce(e){const{environment:t,spaceViewStore:n,openInNew:o,isNewlyCreatedSpace:i,leavingSpace:r}=e;await n.awaitNonNullValue();const a=n.getSpaceStore();if(!a)throw new Error(k.default.formatMessage(ae.invalidSpaceStoreOnNavigate));if(!o&&(H.qL({bannerStore:E.Z,id:"SubscriptionEditingBlocker"}),D.default.setState({...D.default.state,currentSpaceStore:a,currentSpaceViewStore:n}),r)){const e=await(0,I.rg)(t,n);D.default.setState({...D.default.state,mainEditorCurrentBlockStore:e})}U.Z.reset();const s=t.currentUser.id,l=n.getUserRootParentId();if(l&&s!==l){const e=await ie.x({environment:t,newCurrentUserId:l});await j.OR({environment:e,spaceId:a.id,isNewlyCreatedSpace:i});const{currentUserSettingsStore:n,currentUserRootStore:o}=D.default.state;return{switchedUser:!0,newEnvironment:e,newUserRootStore:o,newUserSettingsStore:n}}return await j.OR({environment:t,spaceId:a.id,isNewlyCreatedSpace:i}),{switchedUser:!1}}async function de(e){var t;const{spaceViewStore:n,redirectPageId:i,openInNew:r,isNewlyCreatedSpace:a,templateGalleryItem:s,projectManagementLaunch:l,leavingSpace:c,pageVisitSource:u}=e;let{environment:p,userSettingsStore:m,userRootStore:f}=e;const g=n.getSpaceStore();if(!g)throw new Error(k.default.formatMessage(ae.invalidSpaceStoreOnNavigate));const h=await ce({environment:p,spaceViewStore:n,openInNew:r,isNewlyCreatedSpace:a,leavingSpace:c});h.switchedUser&&(p=h.newEnvironment,m=h.newUserSettingsStore,f=h.newUserRootStore);const v=f&&f.getSpaceViewStores(),b=I.g4(p,n),y=A.Al(n),S=M.default.getState();if(S.isOnboarding&&"on"===(null===(t=S.onboardingExperiments)||void 0===t?void 0:t.onboarding_creator_no_joinable_spaces_v2)&&(M.default.setState({...S,shouldTriggerPostInviteAnimations:!0}),await new Promise((e=>setTimeout(e,800)))),i)return void ee.navigateToBlock({environment:p,store:new L.G(p,{table:d.iU,id:i}),openInNew:r,pageVisitSource:u});if("last_visited_page"===b){f&&await F.Z.reinitializeState(p,f.id,g.id);const e=ue({environment:p,spaceId:g.id});if(e&&e.canRead()&&e.pathIsAccessibleAndAlive())return void ee.navigateToBlock({environment:p,store:e,openInNew:r,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:o.tY.LastVisitedPage})}if("personal_home"===b&&y&&(await y.load(),y.canRead()))return ee.navigateToBlock({environment:p,store:y,openInNew:r,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:u}),void(0,P.$X)({environment:p,from:"on_app_start_page"});const _=await(0,I.rg)(p,n);if(_)ee.navigateToBlock({environment:p,store:_,openInNew:r,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:u});else if(g.canEdit()){const{performResult:e}=oe.createAndCommit({userAction:"spaceActions.createdPage",environment:p,perform:e=>ne.KE({environment:p,spaceStore:g,spaceViewStore:n,isPrivate:!0,transaction:e,prepend:!1})});ee.navigateToBlock({environment:p,store:e,openInNew:r,pageVisitSource:u})}else{if(m&&f&&v&&v.length>0&&v[0]&&v[0].id!==n.id)return G.vq(),void(await pe({environment:p,userRootStore:f,userSettingsStore:m,openInNew:r,pageVisitSource:u}));G.vq(),await x.xN(p)}}function ue(e){const{spaceId:t}=e,n=F.Z.getWithoutSubscribing(t);if(!Array.isArray(n))return;const o=n[0];return void 0!==(null==o?void 0:o.pageId)?o.store:void 0}async function pe(e){const{environment:t,userRootStore:n,ignoreSpaceId:o,userSettingsStore:i,openInNew:r,skipPendingTransferWorkspaces:a,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d}=e;await n.load();const u=n.getSpaceViewStores();await Promise.all(u.map((e=>e.load())));const p=u.filter((e=>{var t;return!!e.isDefined()&&(o?e.getSpaceId()!==o:!a||!(0,h.DI)(null===(t=e.getSpaceStore())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.space_request))}));let m;for(const f of p){if(!I.Cx(f.getSpaceStore())){m=f;break}{const e=await(0,I.rg)(t,f);if(e&&e.isDefined()){m=f;break}}}m?await de({environment:t,spaceViewStore:m,userSettingsStore:i,userRootStore:n,openInNew:r,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d}):(G.vq(),await x.xN(t))}async function me(e){const{environment:t,index:n,userRootStore:i,userSettingsStore:r}=e,a=R.Z.getAllSpaceViewStores(t)[n];a&&await de({environment:t,spaceViewStore:a,userSettingsStore:r,userRootStore:i,pageVisitSource:o.tY.SwitchSpace})}async function fe(e){const{environment:t,spaceStore:n}=e;n.isDefined()&&!(0,g.Z)(n.getEmailDomains(),e.emailDomains)&&N.xGP(t,{domains:e.emailDomains||[],confirmed:!0});const o={email_domains:e.emailDomains};e.name&&(o.name=e.name);const i={};for(const a of(0,b.Yd)(o)){const e=n.getKeyStore(a).getValue(),t=o[a];r.Xy(e,t)||(i[a]=t||null)}r.xb(i)||await new Promise(((e,o)=>{oe.createAndCommit({userAction:"spaceActions.updateSpace",environment:t,perform:t=>{J.sW({store:n,data:i,transaction:t}),t.postSubmitCallbacks.push((t=>{t?o(t):e()}))}})}))}async function ge(e){var t;const{environment:n,spaceStore:o,domain:i}=e;(null===(t=Z.Z.state.publicSpaceDataMap[o.id])||void 0===t?void 0:t.domain)!==i&&(await z.updateSpaceDomain(n,{spaceId:o.id,domain:i}),Z.Z.getPublicSpaceData(n,o.id,!0))}async function he(e){var t;const{environment:n,spaceStore:o,publicHomePage:i}=e;(null===(t=Z.Z.state.publicSpaceDataMap[o.id])||void 0===t?void 0:t.publicHomePage)!==i&&(await z.updatePublicHomePage(n,{spaceId:o.id,publicHomePage:i}),Z.Z.getPublicSpaceData(n,o.id,!0))}function ve(e){const{environment:t,spaceStore:n,domain:o}=e,{currentUserStore:i}=D.default.state;return z.checkSpaceDomain(t,{spaceId:n.id,domain:o},null==i?void 0:i.id)}async function be(e){const{environment:t,spaceStore:n,spaceBasicSettingsStore:o,securitySettingsStore:i}=e,{name:r,domain:a,emailDomains:s,publicHomePage:l}=o.state;await Promise.all([fe({environment:t,spaceStore:n,name:r,emailDomains:s}),ge({environment:t,spaceStore:n,domain:a}),he({environment:t,spaceStore:n,publicHomePage:l}),i?te.n(t,{spaceStore:n,securitySettingsState:i.state}):Promise.resolve()])}const ye=function(e){const{environment:t,transaction:n,spaceStore:o,disablePublicAccess:i,disableGuests:r,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:u,disableExternalMembershipRequests:p,disableGuestMembershipRequests:m,enableAiFeature:f,disableTeamGuests:g,enableGuestInviteRequests:h}=e;J.sW({store:o,data:{disable_public_access:i,disable_guests:r,disable_move_to_space:a,disable_export:s,disable_space_page_edits:l,disable_public_access_requests:c,settings:{...o.getSettings(),enable_ai_feature:f,disable_team_guests:g,enable_guest_invite_requests:h},disable_team_creation:d},transaction:n}),oe.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_membership_requests"],command:"set",args:u},transaction:n}),oe.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_external_membership_requests"],command:"set",args:p},transaction:n}),oe.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_guest_membership_requests"],command:"set",args:m},transaction:n}),c&&N.JpJ(t,{disable_public_access_requests:c})},Se=function(e){const{transaction:t,spaceStore:n,inviteLinkEnabled:o}=e;J.sW({store:n,data:{invite_link_enabled:o},transaction:t})};async function _e(e){const{environment:t,spaceId:n,userRootStore:r,navigate:s,analyticsFrom:l,userSettingsStore:c,redirectPageId:d,inviteCode:u}=e,p=r.getSpaceViewStores().find((e=>e.getSpaceId()===n));if(S.default.isAdminMode||z.setSpaceNotificationsAsRead(t,{timestamp:Date.now(),spaceId:n}),p)return!0!==p.getJoined()&&oe.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{De({spaceViewStore:p,transaction:e})}}),s&&await de({environment:t,spaceViewStore:p,userSettingsStore:c,redirectPageId:d,userRootStore:r,pageVisitSource:o.tY.SwitchSpace}),{spaceViewStore:p};{const p=await z.addUsersToSpace(t,{userIds:[r.id],spaceId:e.spaceId,inviteCode:u});if("failed"===p.type)throw p.body&&p.body.clientData&&"invite_link_disabled"===p.body.clientData.type&&v.Z.remove(T.WX),i.log({level:"error",from:"spaceActions",type:"addUsersToSpace",error:(0,a.Ui)(p.error),data:{miscDataToConvertToString:{response:p}}}),p.error;const m=r.getSpaceViewStores();await Promise.all(m.map((e=>e.load())));const f=m.find((e=>e.getSpaceId()===n));if(!f)throw new Error(k.default.formatMessage(ae.noSpaceViewOnJoin));const g=f.getJoined();if(!0!==g&&oe.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{De({spaceViewStore:f,transaction:e})}}),s&&await de({environment:t,spaceViewStore:f,userSettingsStore:c,redirectPageId:d,userRootStore:r,pageVisitSource:o.tY.SwitchSpace}),j.OR({environment:t,spaceId:e.spaceId}).then((()=>{N.kjl(t,{from:l})})),v.Z.remove(T.WX),D.default.setState({...D.default.state,currentSpaceStore:f.getSpaceStore(),currentSpaceViewStore:f}),q.Th({environment:t,force:!0}),await q.Yh(t),!0!==g){const e=u?"shareable_link_join":"verified_domain_join";N.JkE(t,{is_space:!0,invite_origin:e,domainType:(0,w.JF)(),new_workspace_member_count:1})}return{spaceViewStore:f}}}async function we(e){const{environment:t,spaceId:n,userSettingsStore:i}=e,{currentUserRootStore:r,currentUserStore:a}=D.default.state;if(r&&a){const e=await z.removeUsersFromSpace(t,{userIds:[a.id],spaceId:n,removePagePermissions:!0,revokeUserTokens:!1});return"success"===e.type?(pe({environment:t,userRootStore:r,ignoreSpaceId:n,userSettingsStore:i,leavingSpace:!0,pageVisitSource:o.tY.SwitchSpace}),!0):(W.showError(e),!1)}}async function ke(e){const{environment:t,spaceId:n,userSettingsStore:i}=e,{currentUserRootStore:r,currentUserStore:a}=D.default.state;if(r&&a){$.j({message:ae.deletingWorkspace});try{const{value:e}=await z.deleteSpace(t,{spaceId:n}).next();if(e.error)throw e.error;await X.bG({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:{table:f.dx,id:r.id},userId:t.currentUser.id}),pe({environment:t,userRootStore:r,ignoreSpaceId:n,userSettingsStore:i,pageVisitSource:o.tY.SwitchSpace})}finally{$.x()}}}function Ie(e){const{environment:t,blocks:n,transaction:o}=e,i=t.currentUser.id;if(i)for(const r of n){const e=r.getPermissionItems().filter((e=>(0,s.FB)(e)));J.sW({store:r,data:{permissions:[...e,{type:"user_permission",role:"editor",user_id:i}]},transaction:o})}}function Ce(e){const{environment:t,blocks:n,transaction:o}=e;if(t.currentUser.id)for(const i of n){const e=i.getPermissionItems(),n=e.find((e=>"space_permission"===e.type)),r=e.filter((e=>(0,s.FB)(e)));n||Y.ep({environment:t,store:i,permissionItems:[...r,{type:"space_permission",role:"editor"}],transaction:o})}}function xe(e){const{blocks:t,transaction:n}=e;for(const o of t){const e=o.getPermissionItems().filter((e=>(0,s.FB)(e)));J.sW({store:o,data:{permissions:e.length>0?e:null},transaction:n})}}function Te(e){const{spaceStore:t,transaction:n}=e;if(!t.isDefined())throw new Error(k.default.formatMessage(ae.noLocalDataForPermissionGroup));const o=Date.now(),i={id:(0,l.ZP)(),last_edited_time:o},r=[i,...t.getPermissionGroups()];return J.sW({store:t,data:{permission_groups:r},transaction:n}),i}function Me(e){const{spaceStore:t,group:n,transaction:o}=e;if(!t.isDefined())throw new Error(k.default.formatMessage(ae.noLocalDataForPermissionGroup));const i=t.getPermissionGroups();let r;r=i.findIndex((e=>e.id===n.id))>=0?i.map((e=>e.id===n.id?n:e)):[...i,n],J.sW({store:t,data:{permission_groups:r},transaction:o})}async function Pe(e){const{environment:t,spaceStore:n,group:o,transaction:i}=e;if(!n.isDefined())throw new Error(k.default.formatMessage(ae.noLocalDataForPermissionGroup));const r=n.getPermissionGroups().filter((e=>e.id!==o.id));J.sW({store:n,data:{permission_groups:r},transaction:i}),await z.transferPermissionGroup(t,{spaceId:n.id,groupId:o.id})}const Ae=function(e){const{userRootStore:t,spaceViewIds:n,transaction:o,spaceViewPointers:i}=e;J.sW({store:t,data:{space_views:n,space_view_pointers:i},transaction:o})};function Re(e){const{planType:t,spaceStore:n,transaction:o}=e;J.sW({store:n,data:{plan_type:t},transaction:o})}function De(e){J.sW({store:e.spaceViewStore,data:{joined:!0},transaction:e.transaction})}function Be(e){let{spaceBasicSettingsStore:t,environment:n,spaceId:o}=e;return new Promise(((e,i)=>{const r=Z.Z.getPublicSpaceData(n,o);t.state.domain!==(null==r?void 0:r.domain)&&null!=r&&r.hasPublicPages?W.showDialog({message:(0,re.jsxs)("div",{style:{overflowWrap:"anywhere"},children:[(0,re.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.prompt",defaultMessage:"This workspace has public pages. If you proceed with changing the domain, any existing links starting with {current_domain}.notion.site will no longer work.",values:{current_domain:(null==r?void 0:r.domain)||"your_domain"}}),(0,re.jsx)("p",{}),(0,re.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.areYouSure",defaultMessage:"Are you sure you want to change your domain?"})]}),showCancel:!1,keepFocus:!0,items:[{label:(0,re.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.changeButton.label",defaultMessage:"Change"}),color:"red",onAccept:()=>e(!0)},{label:(0,re.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.cancelButton.label",defaultMessage:"Cancel"}),color:void 0,onAccept:()=>e(!1)}]}):e(!0)}))}function Ee(e,t,n){const o=n||D.default.state.currentSpaceStore;if(!o)throw i.log({level:"error",from:"spaceActions",type:"setSpaceSurveyData",error:{message:"Couldn't find a SpaceStore."}}),new Error;oe.createAndCommit({userAction:"spaceActions.setSpaceSurveyData",environment:e,perform:e=>{Ve(o,e,{space_survey_data:t})}})}function Fe(e){var t;const n=D.default.state.currentSpaceStore;n?null!==(t=n.getSettings())&&void 0!==t&&t.seen_block_limit_reduction_v2||((0,V.KC)(),oe.createAndCommit({userAction:"spaceActions.setBlockLimitIncrease",environment:e,perform:e=>{Ve(n,e,{seen_block_limit_increase:!0})}})):i.log({level:"error",from:"spaceActions",type:"setBlockLimitIncrease",error:{message:"Couldn't find a SpaceStore to set block increase experiment."}})}async function Ze(e){const t=D.default.state.currentSpaceStore;return t?!e.device.isMobile&&(!(await(0,O.n)(e))&&(!(0,V.Z$)()&&((0,V.bI)(),oe.createAndCommit({userAction:"spaceActions.setTimedTrialsInOnboarding",environment:e,perform:e=>{Ve(t,e,{exposed_to_timed_trials_in_onboarding:!0})}}),!0))):(i.log({level:"error",from:"spaceActions",type:"initializeTimedTrialsOnboardingExp",error:{message:"Couldn't find a SpaceStore to initialize the TT onboarding experiment."}}),!1)}function Le(e){const t=e.getEditDomain();return t?`${window.location.host}/${t}`:null}function je(e){return e=(e=e.toLowerCase()).replace(/[^a-z0-9-]/g,"")}function Ve(e,t,n){oe.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...n}},transaction:t})}},28014:(e,t,n)=>{n.d(t,{Hj:()=>w,KE:()=>_,OQ:()=>k,cc:()=>I,sY:()=>S,ux:()=>C});n(21703);var o=n(41432),i=n(4615),r=n(21202),a=n(70203),s=n(97880),l=n(5366),c=n(33929),d=n(38755),u=n(77080),p=n(35661),m=n(50906),f=n(54532),g=n(3297),h=n(94419),v=n(9953),b=n(4408),y=n(97444);const S=(0,l.defineMessages)({createAndDuplicatePageError:{defaultMessage:"Duplicated page could not be created.",id:"spaceActions.createAndDuplicatePageInSpace.copyNotCreated.error"},forkPageError:{defaultMessage:"Could not fork page.",id:"spaceActions.dialogError.forkPageError.message"}});function _(e){const{environment:t,spaceViewStore:n,spaceStore:i,isPrivate:r,prepend:a,title:s,transaction:l,loading:c,tracker:d}=e,p=Boolean(u.default.checkGate("enable_text_crdt_client")&&e.useCrdt),m=v.j4({environment:t,type:c?o.Ti.copyIndicator:o.Ti.page,inMemoryRecordCache:i.inMemoryRecordCache,transaction:l,spaceId:i.id,tracker:d,useCrdt:p});return s&&y.sO({environment:t,store:m.getBlockTitleStore(),value:[[s]],transaction:l}),w({environment:t,spaceStore:i,spaceViewStore:n,pageStore:m,isPrivate:r,location:{type:a?"prepend":"append"},transaction:l}),m}function w(e){const{environment:t,spaceStore:n,spaceViewStore:o,pageStore:i,isPrivate:r,location:a,transaction:l}=e,{id:c}=t.currentUser;let d;r?c&&(d={type:"user_permission",role:"editor",user_id:c}):d={type:"space_permission",role:"editor"},v.sW({store:i,data:{permissions:d?[d]:[]},transaction:l}),r&&k({environment:t,spaceStore:n,spaceViewStore:o,transaction:l});const u=a||{type:"append"};"prepend"===u.type?h.Ce({parent:r?o.getPrivatePagesStore():n.getPagesStore(),prepend:i,before:u.before,transaction:l}):"append"===u.type?h.R3({parent:r?o.getPrivatePagesStore():n.getPagesStore(),append:i,after:u.after,transaction:l}):(0,s.t1)(u)}function k(e){const{environment:t,spaceStore:n,spaceViewStore:o,transaction:i}=e,r=new Set(o.getPrivatePageStores().map((e=>e.id)));(0,d.XD)(t,n).filter((e=>e.isTopLevelPrivatePage({spaceStore:n,environment:t}))).forEach((e=>{r.has(e.id)||h.R3({parent:o.getPrivatePagesStore(),append:e,transaction:i})}))}function I(e){const{environment:t,spaceStore:n,spaceViewStore:o,transaction:i,copyPageId:r,recordMap:a,isPrivate:s,allowCopyExternalObjectInstances:l}=e,d=_({environment:t,spaceStore:n,spaceViewStore:o,isPrivate:s,loading:!0,transaction:i});b.fL({environment:t,inMemoryRecordCache:d.inMemoryRecordCache,recordMap:a,debugSource:"spaceActions.createAndDuplicatePageInSpace"});const u=f.K8(t,{blockId:r,inMemoryRecordCache:d.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:l});if(!u)throw new Error(c.default.formatMessage(S.createAndDuplicatePageError));return f.E9({environment:t,sourceBlockId:r,targetBlockPointer:d.pointer,sourceBlockSubtree:u,targetInMemoryRecordCache:d.inMemoryRecordCache,transaction:i,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:d.useCrdt()}),d}async function C(e){const{environment:t,userRootStore:n,isPrivate:o,forkedPageId:s,spaceStore:l,spaceViewStore:d}=e;if(l.canEdit()){const e=p.G.createChildStore(n,{table:r.iU,id:s});g.nM({currentUserId:t.currentUser.id,blockId:void 0});const c=Date.now(),u=await g.OH({environment:t,store:e,spaceStore:l,spaceViewStore:d,isPrivate:o}),f=Date.now()-c;if(m.XyT(t,{from:"publicPage",success:!u.error,template_name:a.QaF(e.getTitleValue()),template_block_id:s,target_space_id:(0,i.F9)(l.id),context:"public_page_duplicate",template_duplication_duration_ms:f}),void 0===u.error)return u.value}throw new Error(c.default.formatMessage(S.forkPageError))}},97627:(e,t,n)=>{n.d(t,{E6:()=>p,GZ:()=>u,MA:()=>h,NY:()=>v,Q1:()=>y,TY:()=>d,ZJ:()=>m,kY:()=>f,lo:()=>l,pE:()=>c,pc:()=>b,pu:()=>g});n(21703);var o=n(68626),i=n(24215),r=n(80444),a=n(39699);function s(e,t,n){a.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...n}},transaction:t})}function l(e){var t;const{currentSpaceViewStore:n}=r.default.state;n&&void 0===(null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt)&&a.createAndCommit({userAction:"userSettingsActions.initializeSpaceAnalyticsPromptSettings",environment:e,perform:e=>{s(n,e,{space_analytics_settings_prompt:{status:"showing",num_times_shown:0}})}})}function c(e){var t;const{currentSpaceViewStore:n}=r.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;if(!o||"dismissed"===o.status||"hidden"===o.status)return;const i={...o,num_times_shown:o.num_times_shown+1};i.num_times_shown>3&&(i.status="hidden"),a.createAndCommit({userAction:"spaceViewActions.incrementSpaceAnalyticsSettings",environment:e,perform:e=>{s(n,e,{space_analytics_settings_prompt:i})}})}function d(e){var t;const{currentSpaceViewStore:n}=r.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;o&&"dismissed"!==o.status&&a.createAndCommit({userAction:"spaceViewActions.incrementspaceAnalyticsSettings",environment:e,perform:e=>{s(n,e,{space_analytics_settings_prompt:{status:"dismissed"}})}})}function u(e){var t;const{currentSpaceViewStore:n}=r.default.state;n&&void 0===(null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt)&&a.createAndCommit({userAction:"userSettingsActions.initializeMfaPromptSettings",environment:e,perform:e=>{s(n,e,{mfa_settings_prompt:{status:"showing",num_times_shown:0}})}})}function p(e){var t;const{currentSpaceViewStore:n}=r.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;if(!o||"dismissed"===o.status||"hidden"===o.status)return;const i={...o,num_times_shown:o.num_times_shown+1};i.num_times_shown>3&&(i.status="hidden"),a.createAndCommit({userAction:"spaceViewActions.incrementOrHideMfaPrompt",environment:e,perform:e=>{s(n,e,{mfa_settings_prompt:i})}})}function m(e){var t;const{currentSpaceViewStore:n}=r.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;o&&"dismissed"!==o.status&&a.createAndCommit({userAction:"spaceViewActions.dismissMfaPromptSetting",environment:e,perform:e=>{s(n,e,{mfa_settings_prompt:{status:"dismissed"}})}})}function f(e,t){var n;const{currentSpaceViewStore:o}=r.default.state;if(!o)return;const l=(null===(n=o.getSettings())||void 0===n?void 0:n.page_analytics_opt_out_list)||[];l.includes(t)||(a.createAndCommit({userAction:"spaceViewActions.optOutOfPageAnalyticsForPage",environment:e,perform:e=>{s(o,e,{page_analytics_opt_out_list:[...l,t]})}}),i.j(e,"page_analytics_page_opt_out"))}function g(e,t){var n;const{currentSpaceViewStore:o}=r.default.state;if(!o)return;const l=(null===(n=o.getSettings())||void 0===n?void 0:n.page_analytics_opt_out_list)||[];l.includes(t)&&(a.createAndCommit({userAction:"spaceViewActions.optInToPageAnalyticsForPage",environment:e,perform:e=>{s(o,e,{page_analytics_opt_out_list:l.filter((e=>e!==t))})}}),i.j(e,"page_analytics_page_opt_in"))}function h(e,t){const{currentSpaceViewStore:n}=r.default.state;n&&a.createAndCommit({userAction:"userSettingsActions.emailDigestSetting.onToggle",environment:e,perform:e=>{s(n,e,{notify_email_digest:t})}})}function v(e){const{currentSpaceViewStore:t}=r.default.state;t&&a.createAndCommit({userAction:"spaceViewActions.confirmAdminContentSearchAcknowledgement",environment:e,perform:e=>{s(t,e,{admin_content_search_acknowledgement:!0})}})}function b(e){var t;const{currentSpaceViewStore:n}=r.default.state;n&&(null!==(t=n.getSettings())&&void 0!==t&&t.has_migrated_to_google_drive_external_integration||a.createAndCommit({userAction:"spaceViewActions.setUserMigratedToGoogleDriveExternalIntegrationInSpace",environment:e,perform:e=>{s(n,e,{has_migrated_to_google_drive_external_integration:!0})}}))}function y(e,t,n){const i=n||r.default.state.currentSpaceViewStore;if(!i)throw o.log({level:"error",from:"spaceActions",type:"setUserSurveyData",error:{message:"Couldn't find a SpaceViewStore."}}),new Error;a.createAndCommit({userAction:"spaceViewActions.setUserSurveyData",environment:e,perform:e=>{s(i,e,{user_survey_data:t})}})}},15690:(e,t,n)=>{n.d(t,{gG:()=>_,jL:()=>f,nz:()=>b,ls:()=>y,x2:()=>h,a:()=>g});var o=n(41432),i=n(15157),r=n(5366),a=n(33929),s=n(49085);class l extends s.default{getInitialState(){return{}}setSelected(e,t){this.setState({...this.state,[e]:t})}getSelectedTab(e){return this.state[e]}}const c=new l;var d=n(94419),u=n(9953),p=n(24677),m=n(98104);function f(e){const t=e.getContentStores(),n=e.id,o=c.getSelectedTab(n);return o?t.findIndex((e=>e.id===o)):0}function g(e){const{store:t,index:n,currentUserId:o}=e,i=t.getContentStores()[n];i&&h({store:t,id:i.id,currentUserId:o})}function h(e){const{store:t,id:n,currentUserId:o}=e;c.setSelected(t.id,n),i.Z.set({userId:o,key:v(t.id),value:n})}function v(e){return`TabBlock-${e}`}function b(e){const{blockId:t,currentUserId:n}=e,o=i.Z.get({userId:n,key:v(t)});o&&c.setSelected(t,o)}function y(e){const{environment:t,store:n,transaction:i}=e,r=u.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,useCrdt:n.useCrdt()});d.R3({parent:n.getContentStore(),append:r,transaction:i});const a=n.getContentStores()[0];p.eP({environment:t,store:a});const s=a.getBlockTitleStore();m.N_({store:s})}const S=(0,r.defineMessages)({newTab:{id:"tabBlockActions.addTab.title",defaultMessage:"New tab"}});function _(e){const{environment:t,store:n,transaction:i}=e,r=u.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,properties:{title:[[a.default.formatMessage(S.newTab)]]},useCrdt:n.useCrdt()});return d.R3({parent:n.getContentStore(),append:r,transaction:i}),c.setSelected(n.id,r.id),r}},80402:(e,t,n)=>{n.d(t,{AU:()=>J,DI:()=>U,FC:()=>j,K4:()=>te,MO:()=>Z,NE:()=>N,Z5:()=>F,d1:()=>X,e2:()=>L,j0:()=>G,nA:()=>z,oz:()=>ne,qY:()=>ee,qn:()=>H,zJ:()=>V});n(57658),n(21703);var o=n(15145),i=n(68497),r=n(35011),a=n(80951),s=n(1800),l=n(53877),c=n(61075),d=n(78106),u=n(84682),p=n(42875),m=n(5773),f=n(72126),g=n(59753),h=n(82883),v=n(21202),b=n(23867),y=n(19889),S=n(70203),_=n(95477),w=n(17809),k=n(33929),I=n(40150),C=n(41662),x=n(29370),T=n(8406),M=n(14871),P=n(49865),A=n(45264),R=n(96802),D=n(9953),B=n(24677),E=n(39699);function F(e){const{environment:t,selectionKey:n,selection:o}=e;x.Z.setState({isActive:!0,selectionKey:n,selection:o}),B.ZH(t)}function Z(){x.Z.setState({isActive:!1})}function L(e){const{environment:t,selectionKey:n,shiftKey:o,columnCount:i,selection:r}=e;if(o&&r.end.col>0){const e={col:r.end.col-1,row:r.end.row};F({environment:t,selectionKey:n,selection:{start:r.start,end:e}})}else if(!o&&r.start.col>0){const e={col:r.start.col-1,row:r.start.row};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}else if(!o&&0===r.start.col&&r.start.row>0){const e={col:i-1,row:r.start.row-1};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function j(e){const{environment:t,selectionKey:n,shiftKey:o,columnCount:i,rowCount:r,selection:a}=e;if(o&&a.end.col<i-1){const e={col:a.end.col+1,row:a.end.row};F({environment:t,selectionKey:n,selection:{start:a.start,end:e}})}else if(!o&&a.start.col<i-1){const e={col:a.start.col+1,row:a.start.row};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}else if(!o&&a.start.col>=i-1&&a.start.row<r-1){const e={col:0,row:a.start.row+1};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function V(e){const{environment:t,selectionKey:n,shiftKey:o,selection:i}=e;if(o&&i.end.row>0){const e={col:i.end.col,row:i.end.row-1};F({environment:t,selectionKey:n,selection:{start:i.start,end:e}})}else if(!o&&i.start.row>0){const e={col:i.start.col,row:i.start.row-1};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function U(e){const{environment:t,selectionKey:n,shiftKey:o,rowCount:i,selection:r}=e;if(o&&r.end.row<i-1){const e={col:r.end.col,row:r.end.row+1};F({environment:t,selectionKey:n,selection:{start:r.start,end:e}})}else if(!o&&r.start.row<i-1){const e={col:r.start.col,row:r.start.row+1};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}}const O=new Set(["auto_increment_id"]);function N(e){const{selection:t,schema:n,currentRows:o,currentPropertyFormats:i,transaction:r}=e,a=I.AV(t);for(let s=a.minRow;s<=a.maxRow;s++){const e=o[s];if(e)for(let t=a.minCol;t<=a.maxCol;t++){const o=i[t],a=n[o.property];null!=a&&a.type&&O.has(a.type)||D.sO({store:e.getPropertyStore(o.property),value:null,transaction:r})}}}const z=e=>{H(e),N(e)},H=e=>{const{selection:t,currentRows:n,event:i}=e;if(null===i.clipboardData)return;const r=I.AV(t);let a="";const l=[],d=n.slice(Math.max(0,r.minRow),r.maxRow+1).filter((e=>e&&e.isDefined()));for(const o of d){const t=[];l.push(t);for(let n=r.minCol;n<=r.maxCol;n++){const[i,s]="selectionKey"in e?W({row:o,x:n,collectionViewBlockStore:e.selectionKey.collectionViewBlockStore,...e}):q({row:o,x:n,...e});t.push([i,o.pointer]),s&&(a+=s),n<r.maxCol&&(a+="\t")}o!==f.Z$(d)&&(a+="\n")}if(i.preventDefault(),i.clipboardData.setData("text/plain",a),function(e,t){if(null===e.clipboardData)return;e.clipboardData.setData(I.mH,JSON.stringify(t))}(i,l),"simpleTableStore"in e){const{environment:t,simpleTableStore:n,columnOrder:a,exportJsxRenderer:l}=e;if(!l)return;const{default:u,jsxToStaticMarkup:m}=l,f=t.currentUser.id,h=t.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(f),y=g.om.fromGetRecordValueFn(h),S=a.slice(r.minCol,r.maxCol+1).filter((e=>void 0!==e)),w=(0,c._2)({exportArgs:{root:{table:v.iU,id:n.id,spaceId:(0,b.C)(n.pointer.spaceId)},navigableBlockId:n.id,renderParentBlockId:void 0,blockId:n.id,userTimeZone:(0,p.r)(),intl:k.default.getIntl(),getRecordValue:h,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,s.Z)({pageId:t,pageModel:y({table:v.iU,id:t}),baseUrl:_.default.domainBaseUrl,pageVisitSource:o.tY.Export})},baseUrl:_.default.domainBaseUrl,publicDomainName:_.default.publicDomainName,table:{[n.id]:{renderRows:d.map((e=>e.id)),renderColumns:S}},katex:t.KatexStore.getKatex()},renderers:u});if(w){const e=m(w);i.clipboardData.setData("text/html",e)}}};function W(e){const{row:t,x:n,collectionViewBlockStore:o,schema:r,currentPropertyFormats:a}=e,s=a[n],l=Y(t,r,s.property);if(!t.isDefined())return[l,void 0];return[l,(0,i.L)({property:s.property,schema:r,block:t.getModel(),getRecordModel:o.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,p.r)(),depth:0,intl:k.default.getIntl(),visitedProperties:new Set,resultCache:{}},exportedFilePaths:!1})]}function q(e){const{row:t,x:n,columnOrder:o,simpleTableStore:i}=e,r=t.getPropertyStore(o[n]);return[r.getValue()||[],(0,h.X)({textValue:r.getValue(),getRecordModel:i.getRecordModel,userTimeZone:(0,p.r)(),intl:k.default.getIntl()})]}function G(e){const{environment:t,selection:n,currentRows:o,event:i,transaction:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e;if(!i.clipboardData)return;let l;const c=i.clipboardData.getData(I.mH),d=i.clipboardData.getData("text/html");if(c)l=JSON.parse(c);else if(d){const e=document.createElement("div");e.innerHTML=d;const t=e.querySelector("table");if(t){const e=t.querySelectorAll("tr");l=[];for(const t of Array.from(e)){const e=[],n=t.querySelectorAll("td, th");for(const t of Array.from(n)){const n=S.TPx(t.textContent||"");e.push([n,void 0])}l.push(e)}}}if(!l){const e=function(e){const{event:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}=e;if(!t.clipboardData)return;const{text:i,html:r,multiTextSelectionData:a,textSelectionData:s,blockSelectionData:l}=M.e0({clipboardData:t.clipboardData,tinyMceMicrosoftWordPasteFilter:o});if(a)return M.of({text:i,html:r,stripText:!1,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o});if(s){const{editing:e,selection:t}=s;return S.OAI(S.xrQ(e,t.startIndex,t.endIndex).tokensInsideRange)}if(r||i)return function(e){const{text:t,html:n,blockSelectionData:o,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:r}=e;return t.includes("\n")||o&&o.blocks.length>0?S.TPx(t):M.of({text:t,html:n,stripText:!1,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:r})}({text:i,html:r,blockSelectionData:l,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}({event:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});e&&(l=[[[e,void 0]]])}if(l){const i=I.AV(n),a=l[0].length;let s=Math.floor((i.maxCol-i.minCol+1)/a);0===s&&(s=1);const c=l.length;let d=Math.floor((i.maxRow-i.minRow+1)/c);0===d&&(d=1);for(let t=0;t<d;t++)for(let n=0;n<s;n++){const s=i.minCol+n*a,d=i.minRow+t*c;for(let t=0;t<c;t++){let n=o[d+t];if(!n){const t="selectionKey"in e?K(e):C.HM.appendRow(e);t&&(e.currentRows.push(t),n=t)}for(let o=0;o<a;o++){const i=l[t][o];if(!i)continue;const a=s+o;"currentPropertyFormats"in e?$({row:n,x:a,serializedValue:i,currentPropertyFormats:e.currentPropertyFormats,transaction:r,schema:e.schema}):Q({row:n,x:a,serializedValue:i,columnOrder:e.columnOrder,transaction:r})}}}const u={start:{col:i.minCol,row:i.minRow},end:{col:i.minCol+a*s-1,row:i.minRow+c*d-1}};"selectionKey"in e?F({environment:t,selectionKey:e.selectionKey,selection:u}):C.HM.selectMultiCell({environment:t,start:u.start,end:u.end,simpleTableStore:e.simpleTableStore})}}function K(e){const{environment:t,currentRows:n,collectionContextStore:o,selectionKey:i,transaction:r}=e,{groupFormat:a}=i,s=P.IW({environment:t,collectionContextStore:o,groupsPointer:a?[a]:[],insertAtIndex:n.length,coerce:!0,initializeDefaultTemplate:!1,transaction:r,from:"table_paste_selection"});return null==s?void 0:s.newStore}function $(e){var t;const{row:n,x:o,serializedValue:i,currentPropertyFormats:r,transaction:s,schema:l}=e,c=r[o];if(!c)return;if("verification"===(null===(t=l[c.property])||void 0===t?void 0:t.type))return;const[d,u]=i;if(D.sO({store:n.getPropertyStore(c.property),value:d,transaction:s}),u){var p;const e=d?a.g(d):void 0,t=(0,m.jy)(e,[_.default.secureFileS3.url,_.default.secureFileS3V2.url],(null===(p=_.default.secureFileConfig)||void 0===p?void 0:p.rootPath)??"");D.nj({store:n,source:u,fileIds:t.map((e=>e.id)),transaction:s})}}function Q(e){const{row:t,x:n,serializedValue:o,transaction:i,columnOrder:r}=e,a=r[n];if(!a)return;const[s,l]=o;D.sO({store:t.getPropertyStore(a),value:S.OAI(s),transaction:i})}const Y=function(e,t,n){const o=t[n];if(!o)throw new Error("Property not found");if(!e.isDefined())return[];const i=e.getPropertyValue(n);if("formula"===o.type){if("v2"===o.version&&(0,w.V1)()){if(!o.formula2)return[];const t=(0,r.EC)({block:e.getModel(),property:n,formulaCode:o.formula2.code,getRecordModel:e.getRecordModel,intl:k.default.getIntl(),userTimeZone:(0,p.r)(),depth:0,visitedProperties:new Set});return t?(0,d.j4)(t):[]}{const o=(0,u.y4)({property:n,schema:t,block:e.getModel(),getRecordModel:e.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,p.r)(),depth:0,intl:k.default.getIntl(),resultCache:{},visitedProperties:new Set}});return S.TPx(o)}}if("created_time"===o.type&&e.getCreatedTime())return a.d7(l.CQ(e.getCreatedTime(),(0,p.r)()));if("created_by"===o.type&&e.getCreatedByPointer()){const{table:t,id:n}=e.getCreatedByPointer()??{};return n&&t===y.KJ?[S.YCD(["u",n])]:n?[S.YCD(["r",n])]:[]}if("last_edited_time"===o.type&&e.getLastEditedTime())return a.d7(l.CQ(e.getLastEditedTime(),(0,p.r)()));if("last_edited_by"===o.type&&e.getLastEditedByPointer()){const{table:t,id:n}=e.getLastEditedByPointer()??{};return n&&t===y.KJ?[S.YCD(["u",n])]:n?[S.YCD(["r",n])]:[]}return i||[]};function J(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;E.createAndCommit({userAction:"tableActions.toggleTableVerticalLines",environment:t,perform:e=>{R.FH({stores:[n],update:{hide_table_vertical_lines:!o},transaction:e})}})}function X(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;const i="title"===o?void 0:"title";E.createAndCommit({userAction:"tableActions.toggleTableSubitemToggleOnTitle",environment:t,perform:e=>{R.FH({stores:[n],update:{table_subitem_toggle_column:i},transaction:e})}})}function ee(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;const i=n.getFormat().table_properties,r=null==i?void 0:i.map((e=>({...e,wrap:!o})));E.createAndCommit({userAction:"tableActions.toggleTableWrapCells",environment:t,perform:e=>{R.FH({stores:[n],update:{table_wrap:!o,table_properties:r},transaction:e})}})}function te(e){let{property:t,collectionViewStore:n,format:o,formatKey:i,environment:r,currentValue:a}=e;const s=!a,l=n.getFormat().table_wrap,c=o[i]||[];let d=!0;const u=c.map((e=>{let n;return n=e.property===t?s:Boolean(l||e.wrap),n||(d=!1),{...e,wrap:n}})),p={...o,[i]:u,table_wrap:d};E.createAndCommit({userAction:"tableActions.toggleWrapColumn",environment:r,perform:e=>{A.iG({collectionViewStore:n,update:{format:p},transaction:e})}})}function ne(e){let{environment:t,collectionContextStore:n,currentIndex:o,entrypoint:i,transaction:r,propertyAction:a}=e;const s=n.collectionViewStore(),l=n.normalizedFormatStore.state;if(!s||void 0===o)return;const c=n.frozoneStore.state.frozenIndex;let d;switch(a){case"toggle":c!==o?d=o:c===o&&(d=-1);break;case"delete":case"hide":if(!(void 0!==c&&o<=c))return;d=c-1;break;case"duplicate":if(!(void 0!==c&&o<=c))return;d=c+1;break;case void 0:if(c!==o)d=o;else if(c===o)return}const u={...l,table_frozen_column_index:d};n.frozoneStore.setState({...n.frozoneStore.state,frozenIndex:d}),T.wd({environment:t,collectionContextStore:n,action:void 0===d?"table_unfreeze_columns":"table_freeze_column",entrypoint:i,propertyIndex:d}),D.sW({store:s.getFormatStore(),data:u,transaction:r})}},150:(e,t,n)=>{n.d(t,{Ct:()=>g,Hl:()=>h,c0:()=>b,sp:()=>y});n(57658),n(67294);var o=n(5366),i=n(27006),r=n(29369),a=n(64684),s=n(98165),l=n(35661),c=n(50906),d=n(47307),u=n(94419),p=n(9953),m=n(39699),f=n(85893);function g(e){const{environment:t,currentSpaceViewStore:n,orderedTeamIds:o,userAction:i}=e;if(m.createAndCommit({userAction:i,environment:t,perform:e=>{p.sW({store:n,data:{joined_teams:o},transaction:e})}}),e.isExplicitUserAction){const{key:o,startPosition:i,endPosition:a}=e.dropArgs,s=l.zX.createChildStore(n,{table:r.e0,id:o});c.ers(t,{store:s,start_position:i,end_position:a})}}async function h(e){let{transaction:t,...n}=e;const{moveToTeam:i,permissionsUpdateItems:r}=function(e){let{moveStores:t,moveTargetStore:n}=e;const o=t.reduce(((e,t)=>(e[t.id]=(0,s.VP)(t),e)),{}),i=(0,s.VP)(n),r=[];for(const a of t){const e=v({blockStore:a,moveFromTeam:o[a.id],moveToTeam:i});e&&r.push(e)}return{moveToTeam:i,permissionsUpdateItems:r}}(n);if(0===r.length)return"not_cleared";if(!(await async function(e){let{numPagesMoved:t,moveToTeam:n,permissionsUpdateItems:i}=e;if(0===i.length)return!0;if(!n)return!0;const r=n.getName(),a=i.some((e=>{let{isRemovingRestricted:t}=e;return!0===t}))&&(0,f.jsx)(o.FormattedMessage,{id:"teamActions.confirmMoveToTeam.removeRestrictedDescription",defaultMessage:" {numPagesMoved, plural, one {This page} other {These pages}} will no longer have restricted access.",values:{numPagesMoved:t}});return await d.confirmUserAction({message:(0,f.jsx)(o.FormattedMessage,{defaultMessage:"Are you sure you want to move {numPagesMoved, plural, one {this page} other {these pages}} to {moveToTeamName}?",id:"teamActions.confirmMoveToTeam.title",values:{moveToTeamName:r,numPagesMoved:t}}),description:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(o.FormattedMessage,{id:"teamActions.confirmMoveFromTeam.description",defaultMessage:"This will transfer the permissions on {numPagesMoved, plural, one {this page} other {these pages}} to members of {moveToTeamName}. ",values:{moveToTeamName:r,numPagesMoved:t}}),a]})})}({numPagesMoved:n.moveStores.length,moveToTeam:i,permissionsUpdateItems:r})))return"user_cancelled_move";for(const{blockStore:o,permissions:a}of r)p.sW({store:o,data:{permissions:a},transaction:t});return"cleared"}function v(e){let{blockStore:t,moveFromTeam:n,moveToTeam:o}=e;if(void 0===n&&void 0===o)return;if((null==n?void 0:n.id)===(null==o?void 0:o.id))return;const r=t.getPermissionItems();let s=!1;const l=r.filter((e=>(0,i.Le)(e)?(s=!0,!1):!(0,i.ix)(e)&&(!n||!(0,a.J2)(e,n.id)&&!(0,a.jc)(e,n.id))));return r.length!==l.length?{blockStore:t,permissions:l,moveFromTeam:n,isRemovingRestricted:s}:void 0}function b(e){const{store:t,teamStore:n,transaction:o,location:i}=e,r=n.getTeamPagesStore(),a=l.G.createChildStore(r,t.pointer);"append"===i.type?u.R3({parent:r,append:a,transaction:o,after:i.after}):"prepend"===i.type&&u.Ce({parent:r,prepend:a,transaction:o,before:i.before})}function y(e){const{store:t,teamStore:n,transaction:o}=e,i=n.getTeamPagesStore(),r=l.G.createChildStore(i,t.pointer);u.Od({childToRemove:r,parent:i,transaction:o})}},97444:(e,t,n)=>{n.d(t,{i8:()=>Me,Du:()=>Pe,MY:()=>Te,QT:()=>Ae,YV:()=>Le,aS:()=>je,N3:()=>Se,pz:()=>ve,pe:()=>be,VO:()=>We,ON:()=>qe,Zl:()=>Ke,Nh:()=>Ge,wA:()=>Ne,Q0:()=>Oe,lZ:()=>Ue,hJ:()=>_e,mM:()=>we,gc:()=>Ee,fs:()=>Ze,vE:()=>Ye,Be:()=>De,gy:()=>Qe,AE:()=>He,sO:()=>Ie,g2:()=>Ve,n2:()=>Fe,O5:()=>ze});n(57658),n(21703),n(30541);var o=n(1302),i=n(15145),r=n(1800),a=n(15095),s=n(78106),l=n(64572),c=n(72126),d=n(99405),u=n(21202),p=n(70279),m=n(33709),f=n(23867),g=n(70203),h=n(39721),v=n(64002),b=n(82798),y=n(54564),S=n(67133),_=n(75018),w=n(62878),k=n(17707),I=n(95477),C=n(78791),x=n(65273),T=n(14976),M=n(73744),P=n(84210),A=n(68056),R=n(45162),D=n(98165),B=n(65598),E=n(18514),F=n(69645),Z=n(73959),L=n(60846),j=n(89224),V=n(89086),U=n(35328),O=n(89574),N=n(95802),z=n(24229),H=n(66949),W=n(77080),q=n(72014),G=n(88923),K=n(81236),$=n(35661),Q=n(27724),Y=n(24666),J=n(45131),X=n(67175),ee=n(39699);function te(e){const{transaction:t,store:n,crdtOperations:o,invertedOperations:i}=e;ee.applyCrdtTextOperations({transaction:t,store:n,operations:o.map((e=>(0,X.W5)({pointer:n.pointer,crdtOperation:e}))),invertedOperations:i})}var ne=n(50906),oe=n(6404),ie=n(14871),re=n(4727),ae=n(36280),se=n(44886),le=n(88295),ce=n(67060),de=n(9953),ue=n(61045),pe=n(24677),me=n(84084),fe=n(17269),ge=n(98104),he=n(32741);function ve(e){const{multiSelection:t,environment:n,transaction:o}=e,i=(0,R.L5)(t);if(0===i.length)return;if(1===i.length){const{store:e,selection:t}=i[0];return be({environment:n,transaction:o,store:e,selection:t})}const r=t.start.store,a=x.FX(r),s=(0,R.Nj)({multiSelection:t,includeNonSelectable:!1});if(!s)return;const l=new Set,c=[],{treeRange:d}=s;for(const f of d.iterateDeletion())(0,F.D_)({transaction:o,treeOperation:f,deleteFrom:"record-store-parent",observer:{onRemove(e,t){c.push(t.childToRemove)},onMove(e){for(const t of e.movingChildren)t.value.store&&l.add(t.value.store)}}});a&&C.Cf({environment:n,transaction:o,multiSelection:t,removedBlocks:c,movedBlocks:l});const{start:u,end:p}=t;be({environment:n,transaction:o,selection:{startIndex:u.index,endIndex:1/0},store:u.store});const m=(0,V.x0)(u.store);if(a){const e=(0,b.TO)((0,Z.sQ)(p.store),"End of selection must be in a block");be({environment:n,transaction:o,selection:{startIndex:0,endIndex:p.index},store:p.store}),C.tE({transaction:o,block:e,targetStore:r})}else m?Ee({environment:n,transaction:o,sourceStore:p.store,sourceIndex:p.index,targetStore:u.store,targetIndex:m.endIndex}):be({environment:n,transaction:o,store:p.store,selection:{startIndex:p.index,endIndex:1/0}});ge.Z5({store:u.store,selection:m}),pe.eP({environment:n,store:d.start.value.store})}function be(e){ye({...e,updateSelection:!0,removeInlineRecords:!0})}function ye(e){const{environment:t,store:n,selection:o,transaction:i,updateSelection:r,removeInlineRecords:s}=e,l=n.getValue(),c=g.Ulv(l,o);if(c.startIndex===c.endIndex)return void(r&&ge.Z5({store:n,selection:c}));let d;const p=n.isTable(u.iU)&&(0,Z.sQ)(n)||n.getRecordStoreAtRootPath();if(p instanceof $.G&&x.Ls({store:n,blockStore:p})){const t=(0,b.TO)(p.getTextSliceTree()),o=new a.W3(g.eeV(l)),{startIndex:r,endIndex:s}=o.getInclusiveStringRangeForSelection(c);te({transaction:i,store:p,crdtOperations:t.getOperationsForDeleteText(r,s),invertedOperations:[{type:"unimplemented",comment:"TODO implement deleteSingleStoreSelectionInternal inverse"}]}),xe(e),d=(0,b.TO)(n.getValue())}else d=g._QS(l,o.startIndex,o.endIndex),Ce({environment:t,store:n,value:d,transaction:i});$e({environment:t,store:n,oldTextValue:l,newTextValue:d,transaction:i,rootStore:p,removeInlineRecords:s}),r&&ge.Z5({store:n,selection:{startIndex:c.startIndex,endIndex:c.startIndex}})}function Se(e){const t=Y.default.state;if("editing"!==t.mode)return;if((0,A.iG)(t.multiSelection))return;const{start:n,end:o}=t.multiSelection,i="start"===e.direction?n:o;Y.default.setState({...t,multiSelection:{start:i,end:i}})}function _e(e){const{environment:t,disableMentions:n,disableDateMentions:o,disableDateReminderMentions:i,disableSlashCommands:r,disableEmojiCommands:s,disableFilters:l,disableTemplateVariableMentions:c,string:d,transaction:u,selectAll:p}=e;if("editing"!==Y.default.state.mode)return;const m="multiSelection"in e?e.multiSelection:(0,A.TD)(e),f=(0,A.QY)(m),h=f?{canRestore:!0,oldSelection:f,toTextValue:f.store.getValue()}:{canRestore:!1};ve({environment:t,multiSelection:m,transaction:u});const v=g.vJ3(d),b=a.p4(v).length;if(0===b)return;const y=(0,V.bj)(),S=g.V3y(v,y);ke({environment:t,store:m.start.store,tokens:[S],index:m.start.index,transaction:u,updateSelection:!1});const _={startIndex:p?m.start.index:m.start.index+b,endIndex:m.start.index+b};ge.Z5({store:m.start.store,selection:_}),l||fe.f({environment:t,store:m.start.store,transaction:u}),h.canRestore&&(n||ce._P({environment:t,textStore:h.oldSelection.store,oldSelection:h.oldSelection.selection,oldTextValue:h.toTextValue,disableDateMentions:o,disableDateReminderMentions:o||Boolean(i),disableTemplateVariableMentions:Boolean(c)}),r||me._P({environment:t,textStore:h.oldSelection.store,oldSelection:h.oldSelection.selection,oldTextValue:h.toTextValue}),s||re._P({environment:t,textStore:h.oldSelection.store,oldSelection:h.oldSelection.selection,oldTextValue:h.toTextValue}))}function we(e){ke({...e,updateSelection:!0})}function ke(e){const{environment:t,store:n,index:o,transaction:i,selectAll:r,updateSelection:s}=e,l=e.tokens.map(g.Y_F);if(l.length){const r=n.getValue()||[];if(x.FX(n)){const t=(0,b.TO)((0,Z.sQ)(n)),r=(0,b.TO)(t.getTextSliceTree()),s=new a.W3(g.eeV(n.getValue())).getStringStartIndex(o),{operations:c,invertedOperations:d}=r.getOperationsForInsertTextValue(s,l);te({transaction:i,store:t,crdtOperations:c,invertedOperations:d}),xe(e)}else{Ce({environment:t,store:n,value:g.P$X(r,l,o),transaction:i})}const s=n.getRecordStoreAtRootPath();if(s instanceof $.G){const e=c.zu(g.llS(l),...g.llS(r));for(const t of e){const e=B.x8(s);ee.applyOperation({transaction:i,store:e,operation:{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:t,after:void 0}}})}}}if(s){const e=g.eeV(l).length;ge.Z5({store:n,selection:{startIndex:r?o:o+e,endIndex:o+e}})}}function Ie(e){const{environment:t,store:n,value:o,transaction:i}=e;x.FX(n)?(ye({environment:t,store:n,selection:{startIndex:0,endIndex:1/0},transaction:i,updateSelection:!1,removeInlineRecords:!0}),o&&g.VrM(o)&&ke({environment:t,store:n,tokens:o,index:0,transaction:i,updateSelection:!1}),xe(e)):Ce(e)}function Ce(e){const{store:t,value:n,transaction:o}=e;de.sO({store:t,transaction:o,value:g.Zxt(n)}),xe(e)}function xe(e){const{environment:t,store:n,transaction:o}=e;if(!n.isTable("block"))return;const i=n.getRecordStoreAtRootPath().getValue();i&&ne.ctm(t,{user_action:o.getUserActionForAnalyticsPurposesOnly(),block_id:i.id,type:i.type,is_toggleable:(0,U._A)(i.type,i.format)})}function Te(e){const{environment:t,multiSelection:n,annotation:o,transaction:i}=e,r=g.J7s(o),a=(0,R.L5)(n),s=Boolean((0,V.a6)(r,n,{}));a.forEach((e=>{let{store:n,selection:a}=e;s?Be({environment:t,store:n,type:r,selection:a,transaction:i,updateSelection:!1}):Re({environment:t,store:n,annotation:o,selection:a,transaction:i})}))}function Me(e){const{environment:t,store:n,selection:o,annotation:i,transaction:r}=e;Te({environment:t,annotation:i,transaction:r,multiSelection:(0,A.TD)({store:n,selection:o})})}function Pe(e){const{environment:t,blocks:n,annotation:o,transaction:i}=e,r=g.J7s(o),a=c.oA(n.map((e=>{const t=e.getTitleStore();if(!t)return;const n=t.getValue();return n?{block:e,titleStore:t,titleValue:n}:void 0}))),s=a.every((e=>{let{titleValue:t}=e;return t.every((e=>g.hDy(e).some((e=>g.J7s(e)===r))))}));for(const{titleStore:l}of a)Ae({environment:t,annotation:o,textStore:l,action:s?"removeAnnotationType":"annotate",transaction:i})}function Ae(e){const{environment:t,annotation:n,transaction:o,textStore:i,action:r}=e;"annotate"===r?Re({environment:t,store:i,annotation:n,selection:{startIndex:0,endIndex:1/0},transaction:o}):Be({environment:t,store:i,type:g.J7s(n),selection:{startIndex:0,endIndex:1/0},transaction:o,updateSelection:!1})}function Re(e){const{environment:t,store:n,annotation:o,selection:i,transaction:r}=e,s=n.getValue();if(s)if(x.FX(n)){!function(e){const{blockStore:t,selection:n,annotation:o,transaction:i}=e;(0,b.T)(t.useCrdt());const r=t.getBlockTitleStore().getValue(),s=g.Ulv(r,n);if((0,V.wd)(s))return;const l=(0,b.TO)(t.getTextSliceTree()),c=new a.W3(g.eeV(r)),{startIndex:d,endIndex:u}=c.getInclusiveStringRangeForSelection(s),p=l.getOperationsForAddAnnotation(d,u,o);te({transaction:i,store:t,crdtOperations:p,invertedOperations:[{type:"unimplemented",comment:"TODO implement addAnnotationToSelectionInTextSliceTree inverse"}]})}({blockStore:(0,b.TO)((0,Z.sQ)(n)),selection:i,annotation:o,transaction:r})}else{Ce({environment:t,store:n,value:g.aSf({textValue:s,selection:i,annotation:o}),transaction:r})}}function De(e){Be({...e,updateSelection:!0})}function Be(e){const{environment:t,store:n,selection:o,type:i,transaction:r,updateSelection:s}=e,l=n.getValue();if(!l)return;let c;const d=n.isTable(u.iU)&&(0,Z.sQ)(n)||n.getRecordStoreAtRootPath();d instanceof $.G&&x.Ls({store:n,blockStore:d})?(!function(e){const{blockStore:t,selection:n,annotationType:o,transaction:i}=e;(0,b.T)(t.useCrdt());const r=t.getBlockTitleStore().getValue(),s=g.Ulv(r,n);if((0,V.wd)(s))return;const l=(0,b.TO)(t.getTextSliceTree()),c=new a.W3(g.eeV(r));let d=[];if(g.WU4(o)){d=g.fWo({textValue:r,startIndex:s.startIndex,endIndex:s.endIndex,annotationType:o}).map((e=>{let{startIndex:t,endIndex:n,annotationKey:o}=e;const{startIndex:i,endIndex:r}=c.getInclusiveStringRangeForSelection({startIndex:t,endIndex:n});return l.getOperationsForRemoveAnnotation(i,r,o)})).flat()}else{const{startIndex:e,endIndex:t}=c.getInclusiveStringRangeForSelection(s);d=l.getOperationsForRemoveAnnotation(e,t,o)}te({transaction:i,store:t,crdtOperations:d,invertedOperations:[{type:"unimplemented",comment:"TODO implement removeAnnotationTypeFromSelectionInTextSliceTree inverse"}]})}({blockStore:d,selection:o,annotationType:i,transaction:r}),c=(0,b.TO)(n.getValue())):(c=g.BeD({textValue:l,selection:o,annotationType:i}),Ie({environment:t,store:n,value:c,transaction:r})),s&&ge.Z5({store:n,selection:o}),$e({environment:t,store:n,oldTextValue:l,newTextValue:c,transaction:r,rootStore:d,removeInlineRecords:!0})}function Ee(e){const{environment:t,sourceStore:n,sourceIndex:o,targetStore:i,targetIndex:r,transaction:a}=e,s=g.lzi(n.getValue()),l=g.QaF(s).length,{tokensInsideRange:c}=g.xrQ(s,o,l);c.length>0&&(ye({environment:t,store:n,selection:{startIndex:o,endIndex:l},transaction:a,updateSelection:!0,removeInlineRecords:!1}),we({environment:t,store:i,tokens:c,index:r,transaction:a}))}function Fe(e){const{environment:t,closestSelectable:n,shiftKey:i,transaction:r}=e;if((0,R.Aw)(t))return void function(e){const{transaction:t}=e,n=Y.default.state;if("editing"!==n.mode)return;const{multiSelection:i}=n,r=(0,R.Nj)({multiSelection:i,includeNonSelectable:!0});if(!r)return;const{tree:a,treeRange:s}=r,l=a.value.store,c=h.o.getIndentOperationsFromTreeRange(s,e.direction);for(const o of c){const{target:e,operation:n}=o,i=(0,F.kC)({rootStore:l,root:a,target:e});if(void 0===i)throw new Error("Cannot find node to indent");let r=!1;switch(n){case"indentSelf":case"indentSelfAndSubtree":if(i.length>=2){const e=i[i.length-2],o=i[i.length-1];if(o){let i="indentSelf"===n?"self":"subtree";(0,U.BX)(o)&&!J.Z.isOpen(o.id)&&(i="subtree");void 0!==se.dD({block:o,parentStore:e,transaction:t,type:i})&&(r=!0)}}break;case"unindentSelfAndUpdateSiblings":if(i.length>=3){const e=i[i.length-3],n=i[i.length-2],o=i[i.length-1];if(n&&o){void 0!==se.uv({block:o,parentStore:n,grandparentStore:e,transaction:t})&&(r=!0)}}}r&&h.F.applyMutable(a,o)}o.default.afterNextFlush((()=>{const e=(0,F.kC)({rootStore:l,root:a,target:s.start}),t=(0,F.kC)({rootStore:l,root:a,target:s.end}),n=e&&(0,Z.mh)(e[e.length-1]),o=t&&(0,Z.mh)(t[t.length-1]);if(n&&o){const e={start:{store:n,index:i.start.index},end:{store:o,index:i.end.index}};ge.NA({multiSelection:e})}}))}({environment:t,transaction:r,direction:e.shiftKey?"unindent":"indent"});const a=i?se.rB({environment:t,blocks:[n],transaction:r}):se.WY({environment:t,blocks:[n],transaction:r});if(!a)return;const s=Y.default.state;if("editing"===s.mode){var l;const e=null===(l=(0,R.xI)("textActions",s.multiSelection))||void 0===l?void 0:l.selection;if(!e)return;o.default.afterNextFlush((()=>{const o=N.C.findSelectableFromStore(a[0]);if(pe.wI({store:n,replace:a[0]}),o){const n=(0,Z.mh)(o.props.store);n?ge.Z5({store:n,selection:e}):pe.$Y({environment:t,phase:Q.SelectionPhase.Selected})}}))}}function Ze(e){const{transaction:t,direction:n}=e,i=Y.default.state;if("editing"!==i.mode)return;const{multiSelection:r}=i,a=(0,R.tp)({multiSelection:r,filterCommonAncestors:!0,focus:void 0});if(!a)return;const s=a.stores;("up"===n?se.A1({transaction:t,blocks:s}):se.vi({transaction:t,blocks:s}))&&o.default.afterNextFlush((()=>{const[e,t]=N.C.findSelectablesFromIds([r.start.store.id,r.end.store.id]),n=(null==e?void 0:e.props.store)&&(0,Z.mh)(null==e?void 0:e.props.store),o=(null==t?void 0:t.props.store)&&(0,Z.mh)(null==t?void 0:t.props.store);n&&o&&(ge.NA({multiSelection:{start:{store:n,index:r.start.index},end:{store:o,index:r.end.index}},forceEmit:!0}),ue.Zv())}))}function Le(e){const{transaction:t,environment:n,multiSelection:o}=e;o&&!(0,A.qS)(o)&&ve({environment:n,transaction:t,multiSelection:o}),je({...e,usingMultiSelection:!0})}function je(e){const{environment:t,store:n,newValue:o,disableMentions:i,disableDateMentions:r,disableSlashCommands:s,disableEmojiCommands:l,disableDateReminderMentions:c,disableFilters:d,disableTemplateVariableMentions:u,transaction:p,usingMultiSelection:m}=e,f=n.getValue(),h=g.QaF(f),v=L.UZ(h,o),b=Y.default.state;if("editing"!==b.mode)return;const y=b.multiSelection.start.index;let S=0;for(let g=0;g<v.length;g++){const e=v[g];if(S+a.p4(e[1]).length>y){if(e[0]===L.JZ){const t=v[g-1],n=v[g+1];let o=v[g-2],i=v[g+2];if(n&&n[0]===L.D$)for(i||(i=[L.JZ,""],v.push(i));S+a.p4(e[1]).length>y&&e[1].endsWith(n[1]);)e[1]=e[1].slice(0,e[1].length-n[1].length),i[1]=n[1]+i[1];else if(t&&t[0]===L.D$)for(o||(o=[L.JZ,""],v.unshift(o));S+a.p4(e[1]).length>y&&e[1].startsWith(t[1]);)e[1]=e[1].slice(t[1].length),o[1]=o[1]+t[1],S-=a.p4(t[1]).length}break}S+=a.p4(e[1]).length}let _=!1,w=!1,k=0;for(const[I,C]of v)if(I===L.D$)_=!0,_e({environment:t,store:n,selection:{startIndex:k,endIndex:k},string:C,disableMentions:i,disableDateMentions:r,disableDateReminderMentions:c,disableSlashCommands:s,disableEmojiCommands:l,disableFilters:d,disableTemplateVariableMentions:u,transaction:p}),k+=a.p4(C).length;else if(I===L.NL){_=!0,w=C===g.qyI;be({environment:t,store:n,selection:{startIndex:k,endIndex:k+a.p4(C).length},transaction:p})}else I===L.JZ&&(k+=a.p4(C).length);!_||w||t.TextSelectionCompositionStore.state.isComposing||Ve({environment:t,store:n,usingMultiSelection:m})}function Ve(e){const{environment:t,usingMultiSelection:n,store:o}=e;if(n){const e=j.get(),t=(0,R.fx)({range:e,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0});t&&ge.NA(t)}else{const e=T.Ut(t);e&&(ge.Z5({store:o,selection:e.selection}),e.forceEmitSelectionStore&&Y.default.emit())}}function Ue(e){const{environment:t,store:n,selection:o,annotation:i,analyticsFrom:r,transaction:a}=e;be({environment:t,store:n,selection:o,transaction:a});const s=(0,V.yj)(o,n),l=[g.YCD(i,s),g.V3y(" ",s)];if(we({environment:t,store:n,tokens:l,index:o.startIndex,transaction:a}),ge.Z5({store:n,selection:{startIndex:o.startIndex+l.length,endIndex:o.startIndex+l.length}}),g.IWo(i)&&(n.isTable("block")||n.isTable("comment"))){const e=t.currentUser.id,o=g.zEN(i),a=n.getRecordStoreAtRootPath();e&&ne.TIz(t,{is_current_user:o===e,user_id:o,from:r,block_type:a instanceof $.G?a.getType():void 0})}else if(g._bk(i)&&(n.isTable("block")||n.isTable("comment"))){var c;const e=null===(c=g.kxk(i))||void 0===c?void 0:c.groupId,o=n.getRecordStoreAtRootPath();e&&ne.Z0d(t,{group_id:e,from:r,block_type:o instanceof $.G?o.getType():void 0})}else if(g.fpG(i)&&(n.isTable("block")||n.isTable("comment"))){const e=g.zyO(i),o=n.getRecordStoreAtRootPath();ne.VN$(t,{date:e,from:r,block_type:o instanceof $.G?o.getType():void 0})}else if(g.STW(i)&&(n.isTable("block")||n.isTable("comment"))){const e=g.TOT(i),o=n.getRecordStoreAtRootPath();ne.Qqh(t,{page_id:e,from:r,block_type:o instanceof $.G?o.getType():void 0})}}function Oe(e){const{environment:t,store:n,selection:o,emoji:i,transaction:r}=e;be({environment:t,store:n,selection:o,transaction:r});const a=[g.V3y(i)];we({environment:t,store:n,tokens:a,index:o.startIndex,transaction:r}),ge.Z5({store:n,selection:{startIndex:o.startIndex+a.length,endIndex:o.startIndex+a.length}})}function Ne(e){const{environment:t,shouldStripTokens:n,disableFilters:o,store:i,selection:r,transaction:s}=e,l=(0,V.fM)(i,r,n),d=n?g.Jcv(i.getValue()):g.QaF(i.getValue());let u=a.p4(d),p=0;for(const a of l)if(p++,0===a)u.unshift("\t");else{const e=a+p;u=[...c.tP(u,0,e),"\t",...c.tP(u,e)]}je({environment:t,store:i,newValue:g.vJ3(u.join("")),disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:o,transaction:s}),ge.Z5({store:i,selection:{startIndex:r.startIndex+1,endIndex:r.endIndex+p}})}function ze(e){const{environment:t,shouldStripTokens:n,disableFilters:o,store:i,selection:r,transaction:s}=e,l=(0,V.fM)(i,r,n),d=n?g.Jcv(i.getValue()):g.QaF(i.getValue());let u=a.p4(d),p=0,m=0;for(const a of l){const e=a-p;0===e?"\t"===u[0]?(u=c.tP(u,1),p+=1):" "===u[0]&&" "===u[1]?(u=c.tP(u,2),p+=2):" "===u[0]&&(u=c.tP(u,1),p+=1):"\t"===u[e+1]?(u=[...c.tP(u,0,e+1),...c.tP(u,e+2)],p+=1):" "===u[e+1]&&" "===u[e+2]?(u=[...c.tP(u,0,e+1),...c.tP(u,e+3)],p+=2):" "===u[e+1]&&(u=[...c.tP(u,0,e+1),...c.tP(u,e+2)],p+=1),a<=r.startIndex&&(m=p)}je({environment:t,store:i,newValue:g.vJ3(u.join("")),disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:o,transaction:s}),ge.Z5({store:i,selection:{startIndex:r.startIndex-m,endIndex:r.endIndex-p}})}function He(e){const{token:t,store:n,readOnly:o}=e;let i=0,r=0;if(t.textValue){let e=0;for(;e<t.tokenIndex;)i+=g.J1x(t.textValue[e]),e++;r=i+g.J1x(t.textValue[e])}ge.Z5({store:n,selection:{startIndex:i,endIndex:r},readOnly:o})}function We(e){const{environment:t,event:n,interactiveToken:a,store:s,parentStore:l,canEdit:c}=e,h=g.hDy(a.textToken),b=g.rlz(h),k=g.wPk(h),C=g.V8Y(h),x=g.jC0(h),T=g.zrg(h).map((e=>g.h19(e)));if(g.YrK(a.textToken)&&!n.shiftKey&&!n.altKey){if(n.preventDefault(),H.Z.state.open)ae.Wj();else{const e=a.textToken,n=document.createRange(),i=a.node.parentNode,r=a.tokenIndex+1;n.setStart(i,a.tokenIndex),n.setEnd(i,r),j.set(n,t.device),ge.dd({store:s}),o.default.afterNextFlush((()=>{if("editing"!==Y.default.state.mode)return;const n=(0,A.QY)(Y.default.state.multiSelection);n&&ae.qn({environment:t,selectedToken:{token:e,position:n.selection},selectionRect:a.node.getBoundingClientRect(),analyticsFrom:"click_token"})}))}return}const R=T.map((e=>{const t=l||s;return $.t1.createChildStore(t,{table:m.qF,id:e,spaceId:(0,f.C)(t.pointer.spaceId)})})),{unresolved:F}=B.bB(R);if(F.length>0){const e=Boolean(b||C),o=z.Z.state.open||t.device.isMobile,i=(0,Z.sQ)(s);if(e&&o)y.LZ();else if(i){const r=n.target&&n.target.getBoundingClientRect();if(y.Ib({environment:t,blockStore:i,analyticsFrom:"existing_comment",discussionIds:F.map((e=>e.id)),rect:r,shouldFocusDiscussion:!1,recursivelyLoadAllDiscussions:!1}),e&&!o)return void n.preventDefault()}}else{B.dv(s)||O.Z.find((e=>e.isEditing()))||y.LZ()}let L,V;b&&(L=v.Nm({str:g.zW$(b),allowNoProtocol:!0}));let U=!1;if(C){V=g.TOT(C);const e=$.G.createChildStore(l||s,{table:u.iU,id:V});U=e.isNavigableBlock();const o=(n.altKey||G.default.isSidePeekOpen())&&!n.metaKey;L=(0,P.ZP)({store:e,openInSidePeek:o,preferPublicLink:(0,E.Sr)(),getSpaceDomain:()=>{var n;return null===(n=K.Z.getPublicSpaceData(t,e.getSpaceId()))||void 0===n?void 0:n.domain},pageVisitSource:i.tY.LinkInPage})}if(x){const{blockId:e}=g.Vv0(x);if(e){const n=$.G.createChildStore(l||s,{table:u.iU,id:e});U=n.isNavigableBlock(),L=(0,P.ZP)({store:n,openInSidePeek:!1,preferPublicLink:(0,E.Sr)(),getSpaceDomain:()=>{var e;return null===(e=K.Z.getPublicSpaceData(t,n.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:i.tY.LinkInPage})}}if(L){n.preventDefault(),ge.ZH(t),he.lY();const{device:e}=t;if(e.isIOS&&ge.sD(),n.shiftKey&&!n.altKey)return;const o=(0,d.Wj)({url:L,baseUrl:I.default.domainBaseUrl,publicDomainName:I.default.publicDomainName,isMobile:t.device.isMobile,protocol:I.default.protocol,currentUrl:window.location.href});if("page"===o.name){const e=M.DJ(n);_.navigate({environment:t,url:L,openInNew:e}),C&&V&&ne.SK1(t,{page_visit_id:q.$g.getCurrentPageVisitId(),mentioned_page_id:V,source_type:"inline_page_mention_token",hover_preview_enabled:W.default.checkGate("first_party_links"),is_navigable_block:U})}else{if("aiGtmFavoriteImport"===o.name&&t.currentUser.isLoggedIn())return void(0,w.M)({environment:t,importArgs:o});_.navigateToExternalURL({environment:t,url:L})}}else{if(c){const{textToken:e,node:o,tokenIndex:i}=a,r=g.hDy(e);if(g.K9C(r))return he.lY(),S.b(t,{originRect:o.getBoundingClientRect(),textStore:s,tokenIndex:i,allowReminders:"comment"!==s.table}),void n.preventDefault()}if(k){const e=$.T5.createChildStore(s,{table:p.x_,id:k[1],spaceId:k[2]}),o=e.getModel();if(!o)return;const a=D.Dg(e);if(!a)return;const l=$.jQ.createChildStore(a,o.getParentPointer()).getModel();if(!l)return;const c=$.G.createChildStore(a,l.getParentPointer()).getModel(),d=c&&"table_row"===c.getType()?c.getParentId():l.getParentId(),u=(0,r.Z)({pageId:a.id,scrollToBlockId:d,pageModel:a.getModel(),baseUrl:void 0,discussionId:l.id,pageVisitSource:i.tY.MentionInPage});n.preventDefault(),_.navigate({environment:t,url:u})}}}function qe(e){const{environment:t,event:n,interactiveToken:o,store:i,parentStore:r}=e;if(!r)return;const a=g.hDy(o.textToken),s=g.V8Y(a);if(s){const e=g.yrl(s);if(!e)return;const o=$.G.createChildStore(r||i,e);n.preventDefault(),oe.Qn({environment:t,stores:[o],left:n.clientX,top:n.clientY,showInput:!1,actionSectionGroupKey:"page_mention",analyticsFrom:"page_mention_block_menu",pageAnnotationToken:{parentStore:r,pageAnnotation:s}})}}function Ge(e){he.HM({token:e.interactiveToken,store:e.store})}function Ke(e){he.lY()}function $e(e){const{store:t,environment:n,oldTextValue:o,newTextValue:i,transaction:r,rootStore:a,removeInlineRecords:s}=e;if(a instanceof $.G){const e=new Set(c.zu(g.llS(o),...g.llS(i)));for(const t of e){const e=$.t1.createChildStore(a,{table:m.qF,id:t,spaceId:(0,f.C)(a.pointer.spaceId)});k.Gu({discussionStore:e,blockStore:a,transaction:r})}}if(s){if(a instanceof $.G){const e=a.getValue();if(e){const s=(0,l.m3)({parentBlock:e,oldTextValue:o,newTextValue:i,getRecordValue:t.getRecordValue,baseUrl:I.default.domainBaseUrl,publicDomainName:I.default.publicDomainName});le.lP({environment:n,transaction:r,parentStore:a,inlinePageIds:s})}}const e=c.zu(g.zUo(o),...g.zUo(i));for(const t of e){const e=$.G.createChildStore(a,{table:u.iU,id:t,spaceId:(0,f.C)(a.pointer.spaceId)});de.sW({store:e,data:{alive:!1},transaction:r})}}}function Qe(e){const{block:t,transaction:n,tokenIndex:o}=e,i=t.getBlockTitleStore();if(!t.getTitleStore()||!i.isDefined()||!i.getValue()||i.getValue().length<o)return!1;const r=i.getValue(),a=g.VrM(r.slice(0,o)),s=g.VrM(r.slice(0,o+1));return ye({environment:t.environment,store:i,selection:{startIndex:a,endIndex:s},transaction:n,updateSelection:!1,removeInlineRecords:!0}),!0}function Ye(e){var t;const{store:n,transaction:o}=e,i=ie.tk();if(!i)return;if(!("editing"===Y.default.state.mode&&(null===(t=(0,A.QY)(Y.default.state.multiSelection))||void 0===t?void 0:t.selection)))return;const r=n.getValue();if(!r)return;const a=(0,s.UQ)(r,i.parentCollection,n.getRecordModel);Ie({environment:n.environment,store:n,value:a,transaction:o})}},98724:(e,t,n)=>{n.d(t,{V$:()=>h,aS:()=>f,bt:()=>v,mX:()=>g});var o=n(72126),i=n(70203),r=n(63143),a=n(46888),s=n(45162),l=n(89086),c=n(24666),d=n(9953),u=n(97444),p=n(98104),m=n(39699);function f(e){const{environment:t,annotation:n}=e,o=c.default.state;if("editing"!==o.mode)return;if(c.default.isEmptySelection())return void p.Km({annotation:n});const{multiSelection:i}=o;(0,s.L5)(i).length>0&&(m.createAndCommit({userAction:"textAnnotationActions.annotateSelection",environment:t,perform:e=>{u.MY({environment:t,annotation:n,multiSelection:i,transaction:e})}}),p.NA({multiSelection:i}))}function g(e){const{environment:t,annotationType:n}=e,o=c.default.state;if("editing"!==o.mode)return;if(c.default.isEmptySelection())return;const{multiSelection:i}=o,r=(0,s.L5)(i);r.length>0&&(m.createAndCommit({userAction:"textAnnotationActions.unannotateSelection",environment:t,perform:e=>{for(const{selection:o,store:i}of r)u.Be({environment:t,store:i,type:n,selection:o,transaction:e})}}),p.NA({multiSelection:i}))}function h(e){const{environment:t,annotationType:n,blocks:o,transaction:i}=e;for(const r of(0,a.V)(o)){const e=(0,l.P2)(r);e&&u.Be({environment:t,store:r,type:n,selection:e,transaction:i})}}function v(e){const{store:t,context:n,transaction:a}=e;if(!t.canEdit())return;const s=(0,r.m8)(o.oA(Object.entries(t.getProperties()).map((e=>{let[t,r]=e;if(!r)return;const a=r.map((e=>i.sBO(e,n))),s=i.L1A(a);return o.Xy(r,s)?void 0:[t,s]}))));o.xb(s)||d.sW({store:t.getPropertiesStore(),data:s,transaction:a})}},56971:(e,t,n)=>{n.d(t,{YV:()=>M,as:()=>T,ew:()=>x});n(67635);var o=n(1302),i=n(41432),r=n(72126),a=n(78791),s=n(65273),l=n(68056),c=n(73959),d=n(89086),u=n(35328),p=n(28685),m=n(95802),f=n(77080),g=n(24666),h=n(96802),v=n(44886),b=n(94419),y=n(42858),S=n(24677),_=n(97444),w=n(98104),k=n(68422);function I(e){const{transaction:t,store:n,block:o,targetStore:i}=e;o&&(0,s.Ls)({store:n,blockStore:o})?a.tE({transaction:t,targetStore:i,block:o}):C(e)}function C(e){const{environment:t,transaction:n,store:o,targetStore:i}=e,r=(0,d.x0)(i);r?_.gc({environment:t,sourceStore:o,sourceIndex:0,targetStore:i,targetIndex:r.endIndex,transaction:n}):_.pe({environment:t,transaction:n,store:o,selection:{startIndex:0,endIndex:1/0}})}function x(e){const{environment:t,store:n,transaction:r}=e;r.annotateWithUserAction("textBackspaceActions.annotatedContentBlockBackspaceAtBeginning");const a=(0,c.sQ)(n);if(a){"callout"===a.getType()&&h.FH({stores:[a],update:{block_color:void 0},transaction:r});let e=a,n=i.Ti.text;if(u.fn(a)){const e=a.getType();e&&(n=e)}e=k.vs({environment:t,block:a,blockType:n,transaction:r}),o.default.afterNextFlush((()=>{const n=m.C.findEditableStoreWithin(e);n&&(w.N_({store:n}),S.eP({environment:t,store:e}))}))}return n}function T(e){const{environment:t,multiSelection:n,transaction:a,deleteForwards:s,event:k}=e,T=t.device.isApple&&k.metaKey,M=!(t.device.isIOS&&(0,l.iG)(n));w.aJ();const P=(0,l.QY)(n);if(P&&0===P.selection.startIndex&&0===P.selection.endIndex&&!s){const{store:e}=P;k.preventDefault();const n=(0,c.sQ)(e);if(n){const s=n.getModel();if(s){const n=s.isType(i.q7);n&&!T?x({environment:t,store:e,transaction:a}):s.isType(i.Q3)||n&&T?function(e){const{store:t,transaction:n,environment:i}=e;n.annotateWithUserAction("textBackspaceActions.textBackspaceAtBeginning");const a=(0,c.sQ)(t);if(!a)return;const s=(0,c.sQ)(a),l=s&&(0,c.sQ)(s);if(s&&l){const e=s.getRenderableContentIds()??[];if(!(r.Z$(e)!==a.id||s.isTransclusionType()||u.BX(s)&&r.Ps(e)===a.id||"tab"===l.getType())){const e=v.uv({block:a,parentStore:s,grandparentStore:l,transaction:n});if(e)return void o.default.afterNextFlush((()=>{if(e){const t=m.C.findEditableStoreWithin(e);t&&(S.eP({environment:i,store:e}),w.N_({store:t}))}}))}}if(f.default.checkGate("text_align")){if("center"===a.getFormat().block_alignment)return void h.hc({environment:i,store:a,alignment:"left",transaction:n});if("right"===a.getFormat().block_alignment)return void h.hc({environment:i,store:a,alignment:"center",transaction:n})}const g=p.E.getMembersByDOMOrder({filter:e=>!e.props.store.inMemoryRecordCache.isMockTextStore}),_=r.cx(g,(e=>e.props.store===t)),k=r.dF(g,((e,t)=>t<_&&e.props.canInsertText));let C;if(k&&(C=k.props.store),C&&a){const e=(0,d.x0)(C);I({environment:i,transaction:n,store:t,block:a,targetStore:C}),w.Z5({store:C,selection:e});const o=(0,c.sQ)(C);if(S.eP({environment:i,store:o}),!u.BX(a)&&s){const e=a.getContentStores();for(const i of e)b.Vt({parent:s.getContentStore(),before:a,insert:i,transaction:n});const t=a.getContentStore(),o=a.getContentStores();for(const i of o)b.Od({parent:t,childToRemove:i,transaction:n})}y.Od({store:a,transaction:n})}}({environment:t,store:e,transaction:a}):s.isType(i.oe)&&function(e){const{environment:t,store:n,transaction:o}=e;o.annotateWithUserAction("textBackspaceActions.captionBackspaceAtBeginning");const i=p.E.getMembersByDOMOrder({filter:()=>!0}),r=i.findIndex((e=>e.props.store===n)),a=i.findLast(((e,t)=>t<r&&e.props.canInsertText)),s=null==a?void 0:a.props.store;if(!s)return;if(!(0,c.sQ)(n))return;const l=(0,d.x0)(s);C({environment:t,store:n,targetStore:s,transaction:o}),w.Z5({store:s,selection:l});const u=(0,c.sQ)(s);S.eP({environment:t,store:u})}({environment:t,store:e,transaction:a})}}}else P&&(0,d.J_)(P.store,P.selection)&&s?(k.preventDefault(),function(e){const{environment:t,store:n,transaction:o}=e;o.annotateWithUserAction("textBackspaceActions.textDeleteAtEnd");const i=p.E.getMembersByDOMOrder({filter:()=>!0}),a=r.cx(i,(e=>e.props.store===n)),s=i.find(((e,t)=>Boolean(t>a&&e.props.canInsertText)));let l;if(s&&(l=s.props.store),(0,c.sQ)(n)&&l){const e="readOnly"===g.default.state.mode,i="empty"!==g.default.state.mode&&g.default.state.multiSelection;I({environment:t,transaction:o,store:l,block:(0,c.sQ)(l),targetStore:n});const r=(0,c.sQ)(l);if(r){const t=(0,c.sQ)(r);if(t){const e=r.getContentStore(),n=r.getContentStores();for(const i of n)b.Od({parent:e,childToRemove:i,transaction:o}),b.Vt({parent:t.getContentStore(),before:r,insert:i,transaction:o})}y.Od({store:r,transaction:o}),i&&w.NA({multiSelection:i,readOnly:e})}}}({environment:t,store:P.store,transaction:a})):M&&(k.preventDefault(),function(e){const{environment:t,multiSelection:n,transaction:o,deleteForwards:i}=e;let r;o.annotateWithUserAction("textBackspaceActions.textBackspaceWithinContent"),r=(0,l.iG)(n)?i?{start:n.start,end:{store:n.start.store,index:n.start.index+1}}:{start:{store:n.start.store,index:n.start.index-1},end:n.start}:n,_.pz({environment:t,multiSelection:r,transaction:o})}({environment:t,multiSelection:n,deleteForwards:s,transaction:a}));const A=g.default.state;"editing"===A.mode&&(0,d.ST)(A.multiSelection.start.store.getValue(),A.multiSelection.start.index-1,"c")&&w.aR({annotation:["c"],extend:!0})}function M(e){const{event:t,multiSelection:n,device:o}=e;return(o.isApple&&t.metaKey||!o.isApple&&t.ctrlKey||o.isApple&&t.altKey)&&!(0,d.dQ)(n)}},74284:(e,t,n)=>{n.d(t,{IO:()=>P,PF:()=>D});n(52262),n(24506);var o=n(1302),i=n(41432),r=n(97531),a=n(72126),s=n(21202),l=n(70203),c=n(78791),d=n(68056),u=n(73959),p=n(35328),m=n(77080),f=n(35661),g=n(24666),h=n(45131),v=n(34583),b=n(50906),y=n(44886),S=n(94419),_=n(9953),w=n(61045),k=n(24677),I=n(97444),C=n(56971),x=n(98104),T=n(29373);function M(e){const t=(0,u.sQ)(e.store);if(t&&function(e){var t;const n=e.getType();return!!n&&(!!(0,i.he)(n)&&!(e.id!==(null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getRenderableContentIds().at(-1))))}(t)){const n=y.rB({environment:e.environment,blocks:[t],transaction:e.transaction});if(n)return void o.default.afterNextFlush((()=>{const e=n[0].getTitleStore();e&&x.NA({multiSelection:{start:{store:e,index:0},end:{store:e,index:0}}})}))}C.ew(e)}function P(e){const{environment:t,transaction:n,multiSelection:r}=e;v.M_(t)&&((0,u.x7)(r.start.store)?function(e){const{environment:t,transaction:n}=e;let r=e.multiSelection;const a=(0,u.sQ)(r.start.store);if(!a||a.isCollectionView())return;I.pz({environment:t,multiSelection:r,transaction:n});const s=g.default.state;r="editing"===s.mode&&s.multiSelection||r;const l=r.start.store,c=_.j4({environment:t,type:i.Ti.text,inMemoryRecordCache:l.inMemoryRecordCache,transaction:n,spaceId:a.pointer.spaceId,useCrdt:a.useCrdt()}),d=S.Ce({parent:a.getContentStore(),prepend:c,transaction:n}).child;D({environment:t,block:a,store:l,targetBlock:d,splitAtIndex:r.start.index,transaction:n}),k.eP({environment:t,store:d}),o.default.afterNextFlush((()=>{x.N_({store:d.getBlockTitleStore()})})),b.W2j(t,{from:"text_enter",type:i.Ti.text})}(e):(0,d.iG)(r)&&function(e){const t=e.getRecordStoreUIParent();return t instanceof f.G&&e&&t.isType(i.q7)&&0===l.QaF(t.getTitleValue()).length}(r.start.store)?M({environment:t,transaction:n,store:r.start.store}):(0,d.ko)(r)&&A(r.start.store)&&R(r.start.store)?function(e){var t;const{environment:n,transaction:r,multiSelection:s}=e,c=s.start.store,d=(0,u.sQ)(c);if(!d)return;const m=d.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(d)})),f=(0,u.sQ)(d);if(!m||!f)return;const g=_.j4({environment:n,type:m.type,inMemoryRecordCache:c.inMemoryRecordCache,transaction:r,spaceId:f.pointer.spaceId,properties:m.properties?B(m.properties):void 0,format:m.format?E(m.format):void 0,permissions:m.permissions,useCrdt:Boolean(null===(t=m.format)||void 0===t?void 0:t.use_crdt)}),{id:v,space_id:y,properties:I,format:C,permissions:M,discussions:P,...R}=m,F=a.zu(P,...l.llS(c.getValue()));_.sW({store:g,data:{...R,discussions:F},transaction:r});const Z=S.BE({parent:f.getContentStore(),after:d,insert:g,transaction:r}).child;if(A(c)&&d){const e=d.getContentStores(),t=d.getContentStore(),n=g.getContentStore();for(const o of e)S.Od({parent:t,childToRemove:o,transaction:r}),S.R3({parent:n,append:o,transaction:r})}(0,p.BX)(d)&&T.rd({blockId:g.id,state:h.Z.isOpen(d.id),currentUserId:n.currentUser.id}),(0,i.he)(m.type)||_.sW({store:d,transaction:r,data:{type:i.Ti.text}}),_.sO({store:d.getDiscussionsStore(),transaction:r,value:[]}),D({environment:n,block:d,store:c,targetBlock:Z,splitAtIndex:s.start.index,transaction:r}),k.eP({environment:n,store:Z});const L=(0,u.mh)(Z);L&&x.N_({store:L}),b.W2j(n,{from:"text_enter",type:i.Ti.text}),n.device.isMobile&&o.default.afterNextFlush((()=>w.hQ(n)))}(e):function(e){var t;const{environment:n,transaction:o}=e;let r=e.multiSelection;const a=(0,u.sQ)(r.start.store);if(!a)return;const s=(0,u.sQ)(a);if(!s)return;I.pz(e);const l=g.default.state;r="editing"===l.mode&&l.multiSelection||r;const c=r.start.store,d=a.getType(),f=a.getContentLength(),v=a.getModel();let y;if((0,p.BX)(a)&&h.Z.isOpen(a.id))y=i.Ti.text;else if(v&&f>0&&v.isType(i.nH)){y=i.Ti.text;const e=a.getContentStores()[0];if(e){const t=e.getType();e.isDefined()&&t&&i.kC[t]&&(y=t)}}else y=!(d&&v&&!v.isType(i.Q2)&&A(c)&&R(c)&&"code"!==d)||v.isType("ai_block")&&v.isSkillBlock()?i.Ti.text:d;const w=_.j4({environment:n,type:y,inMemoryRecordCache:c.inMemoryRecordCache,transaction:o,spaceId:s.pointer.spaceId,format:{block_alignment:m.default.checkGate("text_align")?null===(t=a.getFormat())||void 0===t?void 0:t.block_alignment:void 0},useCrdt:a.useCrdt()}),C=s.getRenderableContentIds()||[];let T,M=!1;if((0,p.BX)(a)&&h.Z.isOpen(a.id)){const e=a.getContentStore();M=!0,T=S.Ce({parent:e,prepend:w,transaction:o})}else if(v&&f&&v.isType(i.nH)){const e=a.getContentStore();M=!0,T=S.Ce({parent:e,prepend:w,transaction:o})}else if(null!=v&&v.isType("ai_block")&&v.isSkillBlock()){const e=a.getContentStore();M=!0,T=S.Ce({parent:e,prepend:w,transaction:o})}else T=C.indexOf(a.id)>=0?S.BE({parent:s.getContentStore(),after:a,insert:w,transaction:o}):S.Ce({parent:s.getContentStore(),prepend:w,transaction:o});const P=T.child;if(A(c)&&d&&!M&&!(0,p.BX)(a)){const e=a.getContentStores(),t=a.getContentStore(),n=P.getContentStore();for(const i of e)S.Od({parent:t,childToRemove:i,transaction:o}),S.R3({parent:n,append:i,transaction:o})}D({environment:n,block:a,store:r.start.store,targetBlock:P,splitAtIndex:r.start.index,transaction:o}),k.eP({environment:n,store:P}),x.N_({store:P.getBlockTitleStore()}),b.W2j(n,{from:"text_enter",type:y,is_toggleable:(0,p._A)(y,w.getFormat())})}(e),t.device.isMobile||o.default.afterNextFlush((()=>{w.Zv()})))}function A(e){if(e.table===s.iU){const t=f.G.createChildStore(e,{table:s.iU,id:e.id}).getType();return t&&!(0,i.S9)(t)}return!1}function R(e){if(e.table===s.iU){const t=f.G.createChildStore(e,{table:s.iU,id:e.id}).getModel();return t&&!t.isType(i.oe)&&!t.isType(i.Ok)}return!1}function D(e){const{environment:t,block:n,store:o,targetBlock:i,splitAtIndex:a,transaction:s}=e,l={store:o,index:a},u={start:l,end:l};if(n.useCrdt()&&n.getBlockTitleStore()===o){(0,d.NV)(u)?_.sW({store:i.getFormatStore(),transaction:s,data:r.K(i.id)}):c.Wc({sourceBlockStore:n,targetBlockStore:i,splitAtGraphemeIndex:a,transaction:s,moveIntoNewBlock:!0})}else I.gc({environment:t,sourceStore:u.end.store,sourceIndex:u.end.index,targetStore:i.getBlockTitleStore(),targetIndex:0,transaction:s});x.N_({store:i.getBlockTitleStore()})}function B(e){const{title:t,...n}=e;return n}function E(e){const{text_slice_tree:t,text_clocks:n,...o}=e;return o}},17269:(e,t,n)=>{n.d(t,{G:()=>W,f:()=>q});n(97391),n(57658);var o=n(41432),i=n(15095),r=n(72126),a=n(32056),s=n(21202),l=n(70203),c=n(82798),d=n(11342),u=n(40959),p=n(83631);function m(e,t){return i.p4(e.substring(0,t)).length}var f=n(68056),g=n(99445),h=n(73959),v=n(35328),b=n(35661),y=n(27724),S=n(24666),_=n(50906),w=n(47839),k=n(96802),I=n(42858),C=n(24677),x=n(97444),T=n(74284),M=n(98104),P=n(39699),A=n(68422);function R(e){var t;const{environment:n,store:r,toBlockType:a,matchRegex:s,insertTextAfter:d,transaction:p,postTransformAction:m}=e,g="editing"===S.default.state.mode&&(null===(t=(0,f.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!g)return;const w=i.p4(l.QaF(r.getValue())).slice(0,g.endIndex).join(""),k=s.exec(w);if(!k)return;const P=r.getRecordStoreUIParent();if(!(P&&P instanceof b.G))return;const R=P.getType();if(!R)return;if(R!==o.Ti.text&&!o.q7[R])return;const D=a(k);if(void 0===D||D===R)return;let B=D;P instanceof b.G&&("toggle"===D&&(0,o.zp)(P.getType())?B=v.m1(R):"toggle"===R&&v.JO(D)&&(B=v.m1(D)),A.vs({environment:n,block:P,blockType:B,transaction:p}));const E={startIndex:0,endIndex:k&&i.p4(k[0]).length||0};if(x.pe({environment:n,store:r,selection:E,transaction:p}),d){const e=I.aO({environment:n,selection:y.default.state.stores,createBlockItem:u.Hc[o.Ti.text],analyticsFrom:"text_filter_actions",transaction:p});e&&(T.PF({environment:n,block:(0,c.TO)((0,h.sQ)(r)),store:r,targetBlock:e,splitAtIndex:0,transaction:p}),C.eP({environment:n,store:e}),M.N_({store:e.getBlockTitleStore()}))}m&&m(k),_.g_k(n,{type:D})}function D(e){var t,n;const{environment:o,store:r,transaction:a,regex:s,length:c,analyticsType:d,replace:u}=e,p="editing"===S.default.state.mode&&(null===(t=(0,f.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!p)return;const g=r.getValue()||[],h=l.QaF(g),v=i.p4(h).slice(0,p.endIndex).join(""),b=s.exec(v);if(!b)return;const y=m(h,b.index),w={startIndex:y,endIndex:y+c},k=r.getValue()||[];if(l.oP(k,w.startIndex,w.endIndex,"c"))return;const I="function"==typeof u?u({match:b,matchIndex:y,textValue:g}):u;if(void 0===I)return;if(x.pe({environment:o,store:r,selection:w,transaction:a}),"editing"!==S.default.state.mode)return;const C=null===(n=(0,f.QY)(S.default.state.multiSelection))||void 0===n?void 0:n.selection;C&&(x.hJ({environment:o,store:r,selection:C,string:I,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:a}),_.Af_(o,{type:d}))}function B(e){var t;const{environment:n,store:o,delimiter:r,annotation:a,transaction:s}=e,c="editing"===S.default.state.mode&&(null===(t=(0,f.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!c)return;const d=o.getValue(),u=E({delimiter:r,storeValue:d,selectionEndIndex:c.endIndex});if(!u)return;if(!F({delimiter:r,storeValue:d,...u}))return;if(l.p9b(d,u.startIndex,u.endIndex,l.GKr.Code))return;const{textValue:p,startIndex:g,endIndex:h}=u,v=m(p,g),b=p.slice(g,h),y=i.p4(b).length,w={startIndex:v,endIndex:v+r.length};x.pe({environment:n,store:o,selection:w,transaction:s});const k={startIndex:v+y-r.length-r.length,endIndex:v+y-r.length};x.pe({environment:n,store:o,selection:k,transaction:s});const I={startIndex:w.startIndex,endIndex:k.startIndex};x.i8({environment:n,store:o,selection:I,annotation:a,transaction:s});const C=I.endIndex;M.Z5({store:o,selection:{startIndex:C,endIndex:C}}),M.aR({annotation:a,extend:!1}),_.tn$(n,{type:l.J7s(a)})}function E(e){const{delimiter:t,storeValue:n,selectionEndIndex:o}=e,a=i.p4(l.QaF(n)).slice(0,o).join("");if(0===a.length||!a.endsWith(t))return;const s=a.split(t);if(s.length<=2)return;s.reverse();const[c,...d]=s.slice(1),u=r.Sm(d.map((e=>e.length+t.length)))-t.length;return{textValue:a,matchString:c,startIndex:u,endIndex:u+c.length+2*t.length}}function F(e){const{delimiter:t,matchString:n,startIndex:o,endIndex:i,textValue:r}=e;return n.length>0&&!/\s/g.test(n[0])&&!/\s/g.test(n[n.length-1])&&!n.startsWith(t)&&!n.endsWith(t)&&(!r[o-1]||/[\s(]/g.test(r[o-1]))&&(!r[i]||/[\s)]/g.test(r[i]))}function Z(e){var t;const{environment:n,delimiter:o,store:r,transaction:a}=e,s="editing"===S.default.state.mode&&(null===(t=(0,f.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!s)return;const c=r.getValue(),d=E({delimiter:o,storeValue:c,selectionEndIndex:s.endIndex});if(!d)return;if(!function(e){const{storeValue:t,startIndex:n,endIndex:o,delimiter:i}=e;if(!F(e))return!1;const r={[l.GKr.User]:l.GKr.User,[l.GKr.Page]:l.GKr.Page,[l.GKr.Comment]:l.GKr.Comment,[l.GKr.Bot]:l.GKr.Bot,[l.GKr.ExternalObjectInstance]:l.GKr.ExternalObjectInstance,[l.GKr.Date]:l.GKr.Date,[l.GKr.TemporaryPage]:l.GKr.TemporaryPage,[l.GKr.TemplateVariable]:l.GKr.TemplateVariable,[l.GKr.FormulaPageProperty]:l.GKr.FormulaPageProperty,[l.GKr.FormulaContextValue]:l.GKr.FormulaContextValue,[l.GKr.Group]:l.GKr.Group,[l.GKr.Citation]:l.GKr.Citation};for(const a of Object.values(r))if(l.oP(t,n,o,a))return!1;if(l.oP(t,n,n+i.length,l.GKr.Code)&&l.oP(t,o-i.length,o,l.GKr.Code))return!1;return!0}({delimiter:o,storeValue:c,...d}))return;const{textValue:u,matchString:g,startIndex:h,endIndex:v}=d,b=m(u,h),y=u.slice(h,v);x.pe({environment:n,store:r,selection:{startIndex:b,endIndex:b+i.p4(y).length},transaction:a});const w=l.qZ6(g);x.mM({environment:n,store:r,tokens:[w],index:b,transaction:a});const k=b+i.p4(l.WiV(w)).length;M.Z5({store:r,selection:{startIndex:k,endIndex:k}}),_.tn$(n,{type:l.GKr.Equation}),p.ND({environment:n,equation:g,from:{type:"create",source:"text_filter",selection:!0}})}const L=["\\.",",",";","\\?","!","\\)","\\]"," "].join("|"),j=new RegExp(` (${L})$`);function V(e){const t=l.xrQ(e.textValue,e.matchIndex-1,e.matchIndex),n=r.Z$(t.tokensInsideRange);if(n&&l.km_(n))return e.match[1]}const U=[{delimiter:"**",type:l.GKr.Bold},{delimiter:"＊＊",type:l.GKr.Bold},{delimiter:"*",type:l.GKr.Italic},{delimiter:"＊",type:l.GKr.Italic},{delimiter:"__",type:l.GKr.Bold},{delimiter:"＿＿",type:l.GKr.Bold},{delimiter:"_",type:l.GKr.Italic},{delimiter:"＿",type:l.GKr.Italic},{delimiter:"~",type:l.GKr.Strike},{delimiter:"〜",type:l.GKr.Strike},{delimiter:"～",type:l.GKr.Strike}],O=[{toBlockType:()=>o.Ti.toDo,matchRegex:/^(\[\] |\「\」　)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.subSubHeader,matchRegex:/^(### |＃＃＃)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.subHeader,matchRegex:/^(## |＃＃)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.header,matchRegex:/^(# |＃)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.toggle,matchRegex:/^(> |＞)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.quote,matchRegex:/^(\| |\" |\“ |\”)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.bulletedList,matchRegex:/^(\* |\- |\+ |\＊|\ー|\＋|\・)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.divider,matchRegex:/^—-$/,insertTextAfter:!0}],N=[{annotationDelimiter:"`",blockMatchRegex:/^```$/},{annotationDelimiter:"´",blockMatchRegex:/^´´´$/},{annotationDelimiter:"｀",blockMatchRegex:/^｀｀｀$/}],z=[{regex:/^'$/,length:1,replace:"‘",analyticsType:"sentence_start_single_quote"},{regex:/ '$/,length:2,replace:" ‘",analyticsType:"start_single_quote"},{regex:/'$/,length:1,replace:"’",analyticsType:"middle_single_quote"}],H=[{regex:/^"$/,length:1,replace:"“",analyticsType:"sentence_start_double_quote"},{regex:/ "$/,length:2,replace:" “",analyticsType:"start_double_quote"},{regex:/"$/,length:1,replace:"”",analyticsType:"end_double_quote"},{regex:/--$/,length:2,replace:"—",analyticsType:"em_dash"},{regex:/->$/,length:2,replace:"→",analyticsType:"right_arrow"},{regex:/<->$/,length:3,replace:"↔",analyticsType:"right_left_arrow"},{regex:/←>$/,length:2,replace:"↔",analyticsType:"right_left_arrow"},{regex:/=>$/,length:2,replace:"⇒",analyticsType:"right_arrow_double"},{regex:/<-$/,length:2,replace:"←",analyticsType:"left_arrow"},{regex:/>=$/,length:2,replace:"≥",analyticsType:"greater_than_or_equal_to"},{regex:/<=$/,length:2,replace:"≤",analyticsType:"less_than_or_equal_to"},{regex:/!=$/,length:2,replace:"≠",analyticsType:"not_equal"},{regex:/\.\.\.$/,length:3,replace:"…",analyticsType:"ellipsis"}];function W(e){const{environment:t,store:n,transaction:c}=e,u=n.getRecordStoreAtRootPath(),p=u instanceof b.G?u.getType():void 0;if("code"!==p||S.default.isEditingCaption()){if("callout"!==p){for(const e of O)R({environment:t,store:n,toBlockType:e.toBlockType,matchRegex:e.matchRegex,insertTextAfter:e.insertTextAfter,transaction:c});R({environment:t,store:n,matchRegex:/^(\d+|[\uff10-\uff19]+)(\. |\。|\．)$/,insertTextAfter:!1,transaction:c,toBlockType:t=>{var n;const o=t[1],i=(0,a.DA)(o);return null===(n=G(e,parseInt(i)))||void 0===n?void 0:n.type},postTransformAction:t=>{var o;const i=t[1],r=(0,a.DA)(i),l=null===(o=G(e,parseInt(r)))||void 0===o?void 0:o.number;if(n.table!==s.iU)return;const d=n.getRecordStoreAtRootPath();if(!(d instanceof b.G))return;const u=l&&l>1?l:void 0;k.FH({stores:[d],update:{list_start_index:u},transaction:c})}}),R({environment:t,store:n,matchRegex:/^([a-z]+)(\. |\。|\．)$/,insertTextAfter:!1,transaction:c,toBlockType:t=>{const n=(0,g.UF)(t[1]),o=G(e,n);if(1===n||void 0===(null==o?void 0:o.number))return null==o?void 0:o.type},postTransformAction:()=>{if(!(n instanceof b.G))return;const e=n.getRecordStoreAtRootPath();k.FH({stores:[e],update:{list_format:"roman"},transaction:c})}}),R({environment:t,store:n,matchRegex:/^([a-z]+)(\. |\。|\．)$/,insertTextAfter:!1,transaction:c,toBlockType:t=>{const n=(0,g.yk)(t[1]),o=G(e,n);if(1===n||void 0===(null==o?void 0:o.number))return null==o?void 0:o.type},postTransformAction:()=>{if(!(n instanceof b.G))return;const e=n.getRecordStoreAtRootPath();k.FH({stores:[e],update:{list_format:"letters"},transaction:c})}});for(const{blockMatchRegex:e}of N)R({environment:t,store:n,toBlockType:()=>o.Ti.code,matchRegex:e,insertTextAfter:!1,transaction:c})}if(!function(e){var t;const n="editing"===S.default.state.mode&&(null===(t=(0,f.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!n)return!1;const o=e.getValue()||[],i=l.xrQ(o,0,n.endIndex),a=r.qr(i.tokensInsideRange,(e=>l.hDy(e).some((e=>l.fTS(e))))),s=i.tokensInsideRange.slice(-1===a?0:a,i.tokensInsideRange.length),c=l.QaF(s);return Boolean(c.match(/(^| )`[^ ]/))}(n)){const e=w.getSubstitutions();for(const i of e)D({environment:t,store:n,transaction:c,regex:i.replace,length:i.length,replace:i.with,analyticsType:"custom_substitution"});for(const i of H)D({environment:t,store:n,transaction:c,regex:i.regex,length:i.length,replace:i.replace,analyticsType:i.analyticsType});const o=t.device.browserVersion.split(".").map((e=>parseInt(e,10)));if(!t.device.isSafari||(0,d.isGreaterThanOrEqualToVersion)(o,[16,4]))for(const i of z)D({environment:t,store:n,transaction:c,regex:i.regex,length:i.length,replace:i.replace,analyticsType:i.analyticsType});!function(e){D({environment:e.environment,store:e.store,transaction:e.transaction,regex:j,length:2,replace:V,analyticsType:"mention_punctuation"})}({environment:t,store:n,transaction:c})}for(const{annotationDelimiter:e}of N)B({environment:t,delimiter:e,annotation:[l.GKr.Code],store:n,transaction:c});for(const{delimiter:e,type:o}of U)B({environment:t,delimiter:e,annotation:[o],store:n,transaction:c});Z({environment:t,delimiter:"$$",store:n,transaction:c}),Z({environment:t,delimiter:"＄＄",store:n,transaction:c}),function(e){var t;const{environment:n,store:o,transaction:r}=e,a="editing"===S.default.state.mode&&(null===(t=(0,f.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!a)return;const s=o.getValue(),c=i.p4(l.QaF(s)).slice(0,a.endIndex).join("");if(l.oP(s,a.startIndex,a.endIndex,"c"))return;const d=/([^ ]+) $/.exec(c);if(!d)return;const u=d[1],p=l.rOz(u);if(!p)return;const{value:g,href:h}=p,v=m(c,c.indexOf(g)),b=v+i.p4(g).length,y={startIndex:v,endIndex:b};l.oP(s,v,b,"a")||(x.i8({environment:n,store:o,annotation:["a",h],selection:y,transaction:r}),M.Z5({store:o,selection:a}),_.Hcc(n,{href:h}))}({environment:t,store:n,transaction:c})}}function q(e){const{store:t,transaction:n,environment:o}=e;n.postEnqueueActions.push((()=>{P.createAndCommit({userAction:"textFilterActions.runAllFiltersAfterTransaction",environment:o,undoCheckpoint:!0,perform:e=>{W({environment:o,store:t,transaction:e})}})}))}function G(e,t){const{store:n}=e;if(n.table!==s.iU)return;const i=n.getRecordStoreAtRootPath();if(!(i instanceof b.G))return;const r=i.getType();if(r===o.Ti.header||r===o.Ti.subHeader||r===o.Ti.subSubHeader)return;const a=i.getParentBlockStore();if(!a)return;const l=a.getContentStores(),c=l.findIndex((e=>e.id===i.id));if(-1===c)return;const d=l.slice(0,c);let u=-1,p=1;for(let s=0;s<d.length;s++){const e=d[s];if(e.getType()!==o.Ti.numberedList)p=1,u=s;else{var m;const t=null===(m=e.getFormat())||void 0===m?void 0:m.list_start_index;t?p=t+1:p++}}return p===t?{type:o.Ti.numberedList,number:void 0}:c===u+1?{type:o.Ti.numberedList,number:t}:void 0}},98104:(e,t,n)=>{n.d(t,{AL:()=>G,D1:()=>$,DI:()=>q,FC:()=>Q,FG:()=>W,J9:()=>Y,Km:()=>M,LG:()=>X,N3:()=>z,NA:()=>C,NG:()=>oe,NX:()=>D,N_:()=>R,UV:()=>B,Z5:()=>T,ZH:()=>V,aJ:()=>A,aR:()=>P,bc:()=>te,dd:()=>L,e2:()=>K,jh:()=>J,ls:()=>Z,mT:()=>E,o9:()=>U,sD:()=>j,z9:()=>x,zJ:()=>H});var o=n(1302),i=n(72126),r=n(70203),a=n(4827),s=n(14976),l=n(46150),c=n(28314),d=n(68056),u=n(45162),p=n(73959),m=n(89224),f=n(89086),g=n(28685),h=n(95802),v=n(41662),b=n(27724),y=n(24666),S=n(36280),_=n(45990),w=n(13084),k=n(24677),I=n(39699);function C(e){const{multiSelection:t,readOnly:n,forceEmit:o}=e,i=y.default.state,r="empty"!==i.mode&&i.savedSelectionXPosition||void 0,a="editing"===i.mode&&(0,d.e6)(i.multiSelection,t)?i.forceExtendAnnotations:{},s=n?{mode:"readOnly",multiSelection:t,savedSelectionXPosition:r}:{mode:"editing",multiSelection:t,savedSelectionXPosition:r,forceExtendAnnotations:a};if(s.mode!==i.mode||!(0,d._v)(i.multiSelection,t))return y.default.setState(s),void v.HM.updateCellSelectionFromTextSelection();o&&y.default.emit()}function x(e,t){if(!("always"===(0,u.Aw)(e)))return;const{TextSelectionCompositionStore:n}=e;n.setState({isComposing:t})}function T(e){const{store:t,selection:n,readOnly:o}=e;if(t&&n){C({multiSelection:(0,d.TD)({store:t,selection:n}),readOnly:o})}else if(t&&!n){const e={store:t,index:0},n={start:e,end:e};o?y.default.setState({mode:"readOnly",multiSelection:n,savedSelectionXPosition:0}):y.default.setState({mode:"editing",multiSelection:n,forceExtendAnnotations:{},savedSelectionXPosition:0})}else"empty"!==y.default.state.mode&&y.default.setState({mode:"empty"})}function M(e){const{annotation:t}=e;if(r.k87[t[0]])return;const n=r.J7s(t),o=(0,f.bj)().find((e=>r.J7s(e)===n));P(o?{annotation:o,extend:!1}:{annotation:t,extend:!0})}function P(e){const{annotation:t,extend:n}=e,o=y.default.state,i=r.J7s(t);"editing"===o.mode&&y.default.setState({...o,forceExtendAnnotations:{...o.forceExtendAnnotations,[i]:{annotation:t,extend:n}}})}function A(){const e=y.default.state;"editing"===e.mode&&y.default.setState({...e,forceExtendAnnotations:{}})}function R(e){const{store:t}=e;T({store:t,selection:{startIndex:0,endIndex:0}})}function D(e){const{store:t}=e;T({store:t,selection:(0,f.x0)(t)})}function B(e){var t;A();const{environment:n,store:o,canSelectAllBlocks:i,contentEditableContextId:r}=e,a=y.default.state;let s;s="empty"===a.mode?{start:{store:o,index:0},end:{store:o,index:0}}:a.multiSelection;const l={start:{store:s.start.store,index:0},end:{store:s.end.store,index:(null===(t=(0,f.x0)(s.end.store))||void 0===t?void 0:t.endIndex)||0}};if((0,d._v)(l,s)){if(r){const e=(0,f.Ov)(),t=e=>{var t;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===r},n=e.find(t),o=e.reverse().find(t);if(n&&o){const e=n.props.store,t=o.props.store;if(e&&t){var c;return void C({multiSelection:{start:{store:e,index:0},end:{store:t,index:(null===(c=(0,f.x0)(t))||void 0===c?void 0:c.endIndex)||0}}})}}}i&&(0,p.Mn)(n.device)&&k.td(n)}else C({multiSelection:l})}function E(e){var t;A();const{environment:n,store:o,canSelectAllBlocks:i}=e,r=(0,f.x0)(o),a={startIndex:0,endIndex:r?r.endIndex:0};i&&"empty"!==y.default.state.mode&&(0,f.fu)(null===(t=(0,u.xI)("textSelectionActions",y.default.state.multiSelection))||void 0===t?void 0:t.selection,a)?k.td(n):T({store:o,selection:a})}function F(e){const t=y.default.state;"empty"===t.mode||t.savedSelectionXPosition||y.default.setState({...t,savedSelectionXPosition:e.savedSelectionXPosition})}function Z(){"empty"!==y.default.state.mode&&y.default.setState({...y.default.state,savedSelectionXPosition:void 0})}function L(e){const{store:t,contentEditableLeafRegistry:n}=e;o.default.afterNextFlush((()=>{const e=m.get(),o=(0,u.fx)({contentEditableLeafRegistry:n,range:e,allowInvisibleEndSelection:(0,c.yA)().shift});o?C(o):T({store:t})}))}function j(){const e=document.activeElement;e instanceof HTMLElement&&e.blur()}function V(e){m.clear(e),U()}function U(){T({store:void 0,selection:void 0})}function O(e){const{currentEditableTopBottomPadding:t,targetEdge:n,targetEditable:o,selectionXPosition:r}=e,s=o.getNode();if(!(s&&s instanceof Element))return;const l=s.getBoundingClientRect(),c=Math.min(Math.max(r,l.left),l.right),d=Math.min(t,o.props.topBottomPadding),u="top"===n?l.top:l.bottom;return function(e,t,n){const o=new Map,r={visibility:"hidden"},s=Object.keys(r);let l;try{for(;l=m.rangeFromPoint(e,t);){if(n.contains(l.commonAncestorContainer))return l;const e=a.Z.getParentOverlayNode(l.commonAncestorContainer);if(!e)return;if(o.has(e))return;const t=i.ei(e.style,s);o.set(e,t),Object.assign(e.style,r)}}finally{for(const[e,t]of o)Object.assign(e.style,t)}}(c,"top"===n?u+d:u-d,s)}function N(e){const{focusContainerOffset:t,focusStore:n,edge:o,topBottomPadding:i}=e,r=g.E.findNodeFromStore(n);if(!(r&&r instanceof Element))return;const a=m.getRect(m.rangeFromContainerOffsets({start:t,end:t})),s=r.getBoundingClientRect();if(!a||!s)return;const[l,c]="top"===o?[a.top,s.top]:[a.bottom,s.bottom];return{focusIsAtEdge:Math.abs(l-c)<=i,focusSelectionRect:a,renderedNode:r,renderedNodeRect:s}}function z(e){const{environment:t,event:n,topBottomPadding:o,contentEditableLeafRegistry:i}=e,r=m.get();if(!r)return;A();const a=y.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:p}=(0,u.uZ)(s),h=N({focusContainerOffset:m.rangeToContainerOffsets(r).focus,focusStore:c.store,topBottomPadding:o,edge:"top"});if(!h)return;const{focusIsAtEdge:b,focusSelectionRect:S}=h,_=v.g$.getSimpleTableCellFromTextSelection(),w=_?v.g$.getPreviousEditableStoreForSimpleTable(_):(0,f.mK)(c.store),I=w&&g.E.findEditableWithStore(w);if(b&&I){var C;const e=Math.max(a.savedSelectionXPosition||0,S.left),i=O({targetEditable:I,targetEdge:"bottom",currentEditableTopBottomPadding:o,selectionXPosition:e}),s=(null===(C=(0,u.fx)({range:i,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===C?void 0:C.multiSelection)||(0,d.TD)({store:I.props.store,selection:(0,f.x0)(I.props.store)});if(n.shiftKey&&!n.altKey&&s&&(0,l.D1)(I.getNode(),r.commonAncestorContainer))return n.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,multiSelection:(0,u.$r)(s.start,p),focus:s.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&s)return n.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,forceEmit:!1,multiSelection:s,focus:"start"})}if(n.shiftKey&&!n.altKey&&(0,f.e7)(c,s.start.store)){if(ne(t))return void v.HM.handleUpDownKey({environment:t,direction:"up",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}L({store:c.store,contentEditableLeafRegistry:i})}function H(e){const{environment:t,store:n,event:o,topBottomPadding:i}=e,r=m.get();if(!r)return;A();const a=m.getRect(r),l=g.E.findNodeFromStore(n),c=y.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,u.xI)("textSelectionActions",c.multiSelection);if(!d)return;const h=l.getBoundingClientRect(),b=v.g$.getSimpleTableCellFromTextSelection(),S=b?v.g$.getPreviousEditableStoreForSimpleTable(b):(0,f.mK)(n);if(a&&h){const e=Math.abs(a.top-h.top),l={startIndex:d.selection.startIndex,endIndex:d.selection.startIndex},u=(0,p.sQ)(n);if(!o.altKey&&o.shiftKey&&(0,f.Rw)(l)&&(m.selectionIsBackwards()||r.collapsed)&&u)k.Z5({environment:t,stores:[u]});else if(!o.altKey&&!o.shiftKey&&e<=i&&S){o.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);F({savedSelectionXPosition:e});const n=g.E.findNodeFromStore(S);if(n&&n instanceof Element){const o=n.getBoundingClientRect(),r=Math.min(Math.max(e,o.left),o.right),a=o.bottom-i,l=m.rangeFromPoint(r,a),c=s.Ut(t,l);c&&(ee({environment:t,store:S,selection:c.selection}),c.forceEmitSelectionStore&&y.default.emit())}}else L({store:n})}}function W(e){const{environment:t,event:n,topBottomPadding:o,contentEditableLeafRegistry:i}=e,r=m.get();if(!r)return;A();const a=y.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:h}=(0,u.uZ)(s),b=N({focusContainerOffset:m.rangeToContainerOffsets(r).focus,focusStore:c.store,topBottomPadding:o,edge:"bottom"});if(!b)return;const{focusIsAtEdge:S,focusSelectionRect:_}=b,w=v.g$.getSimpleTableCellFromTextSelection(),I=w?v.g$.getNextEditableStoreForSimpleTable(w):(0,f.hn)(c.store),C=I&&g.E.findEditableWithStore(I);if(S&&C){var x;const e=Math.max(a.savedSelectionXPosition||0,_.left),i=O({targetEditable:C,targetEdge:"top",currentEditableTopBottomPadding:o,selectionXPosition:e}),s=(null===(x=(0,u.fx)({range:i,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===x?void 0:x.multiSelection)||(0,d.TD)({store:C.props.store,selection:{startIndex:0,endIndex:0}});if(n.shiftKey&&!n.altKey&&s&&(0,l.D1)(C.getNode(),r.commonAncestorContainer))return n.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,multiSelection:(0,u.$r)(s.start,h),focus:s.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&s)return n.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,forceEmit:!1,multiSelection:s,focus:"end"})}const T=(0,p.sQ)(s.start.store);if(n.shiftKey&&!n.altKey&&(0,f.iB)(c,s.end.store)&&T){if(ne(t))return void v.HM.handleUpDownKey({environment:t,direction:"down",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}L({store:c.store,contentEditableLeafRegistry:i})}function q(e){const{environment:t,store:n,event:o,topBottomPadding:i}=e,r=m.get();if(!r)return;A();const a=m.getRect(r),l=g.E.findNodeFromStore(n),c=y.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,u.xI)("textSelectionActions",c.multiSelection);if(!d)return;const h=l.getBoundingClientRect();if(a&&h){const e=v.g$.getSimpleTableCellFromTextSelection(),l=e?v.g$.getNextEditableStoreForSimpleTable(e):(0,f.hn)(n),u=Math.abs(a.bottom-h.bottom),b={startIndex:d.selection.endIndex,endIndex:d.selection.endIndex},S=(0,p.sQ)(n);if(!o.altKey&&o.shiftKey&&(0,f.J_)(n,b)&&(!m.selectionIsBackwards()||r.collapsed)&&S)k.Z5({environment:t,stores:[S]});else if(!o.altKey&&!o.shiftKey&&u<=i&&l){o.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);F({savedSelectionXPosition:e});const n=g.E.findNodeFromStore(l);if(n&&n instanceof Element){const o=n.getBoundingClientRect(),r=Math.min(Math.max(e,o.left),o.right),a=o.top+i,c=m.rangeFromPoint(r,a),d=s.Ut(t,c);d&&(ee({environment:t,store:l,selection:d.selection}),d.forceEmitSelectionStore&&y.default.emit())}}else L({store:n})}}function G(e){o.default.afterNextFlush((()=>{Z()})),A();const{environment:t,event:n,contentEditableLeafRegistry:i}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const{multiSelection:c}=s,{focus:p,anchor:h}=(0,u.uZ)(c),b=(0,f.mK)(p.store),w=b&&g.E.findEditableWithStore(b);if((0,f.e7)(p,p.store)&&w){const e=(0,d.TD)({store:w.props.store,selection:(0,f.x0)(w.props.store)});if(n.shiftKey&&!n.altKey&&e&&(0,l.D1)(w.getNode(),null==a?void 0:a.commonAncestorContainer))return n.preventDefault(),void te({environment:t,multiSelection:(0,u.$r)(e.start,h),focus:e.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&e&&(0,d.iG)(c))return n.preventDefault(),void te({environment:t,forceEmit:!1,multiSelection:e,focus:"start"})}if(n.shiftKey&&!n.altKey&&(0,f.e7)(p,c.start.store)){if(ne(t))return void v.HM.handleLeftRightKey({environment:t,direction:"left",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:c,focus:p,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}if(n.altKey||n.shiftKey||n.ctrlKey||n.metaKey||!a||!a.collapsed)L({store:p.store,contentEditableLeafRegistry:i});else{const e=p.index-1,i=r.b1T(c.start.store.getValue(),e);if(i&&r.tk7(i)){n.preventDefault(),C({multiSelection:{start:{...p,index:e},end:p}});const a={startIndex:e,endIndex:p.index};r.YrK(i)&&o.default.afterNextFlush((()=>{S.qn({environment:t,selectedToken:{token:i,position:a},analyticsFrom:"arrow_keys"})}))}const a=r.hpT(p.store.getValue(),e,((e,t)=>{const n=r.Hze(e);return t?Boolean(n&&r.Hze(t)===n):Boolean(n)}));a&&_.dz({type:"selectionFocus",store:p.store,focus:!1,selection:a})}}function K(e){o.default.afterNextFlush((()=>{Z()})),A();const{environment:t,store:n,event:i}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const l=(0,u.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.startIndex,endIndex:l.selection.startIndex},d=(0,p.sQ)(n);if(!i.altKey&&i.shiftKey&&a&&(0,f.Rw)(c)&&(m.selectionIsBackwards()||a.collapsed)&&d)k.Z5({environment:t,stores:[d]});else if(i.altKey||i.shiftKey||l.store!==n||!(0,f.Rw)(l.selection))if(i.altKey||i.shiftKey||i.ctrlKey||i.metaKey||!a||!a.collapsed)L({store:n});else{const e=r.b1T(n.getValue(),c.startIndex-1);if(e&&r.tk7(e)){i.preventDefault();const a={startIndex:c.startIndex-1,endIndex:c.startIndex};T({store:n,selection:a}),r.YrK(e)&&o.default.afterNextFlush((()=>{S.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=r.hpT(n.getValue(),c.startIndex-1,((e,t)=>{const n=r.Hze(e);return t?Boolean(n&&r.Hze(t)===n):Boolean(n)}));a&&_.dz({type:"selectionFocus",store:n,focus:!1,selection:a})}else{i.preventDefault();const e=(0,f.mK)(n);if(e){const n=(0,f.x0)(e);n&&ee({environment:t,store:e,selection:n})}}}function $(e){o.default.afterNextFlush((()=>{Z()})),A();const{environment:t,event:n,contentEditableLeafRegistry:i}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const{multiSelection:c}=s,{focus:p,anchor:h}=(0,u.uZ)(c),b=(0,f.hn)(p.store),w=b&&g.E.findEditableWithStore(b);if((0,f.iB)(p,p.store)&&w){const e=(0,d.TD)({store:w.props.store,selection:{startIndex:0,endIndex:0}});if(n.shiftKey&&!n.altKey&&e&&(0,l.D1)(w.getNode(),null==a?void 0:a.commonAncestorContainer))return n.preventDefault(),void te({environment:t,multiSelection:(0,u.$r)(e.start,h),focus:e.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&e&&(0,d.iG)(c))return n.preventDefault(),void te({environment:t,forceEmit:!1,multiSelection:e,focus:"end"})}if(n.shiftKey&&!n.altKey&&(0,f.iB)(p,c.end.store)){if(ne(t))return void v.HM.handleLeftRightKey({environment:t,direction:"right",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:c,focus:p,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}if(n.altKey||n.shiftKey||n.ctrlKey||n.metaKey||!a||!a.collapsed)L({store:p.store,contentEditableLeafRegistry:i});else{const e=p.index,i=p.index+1,a=r.b1T(c.start.store.getValue(),e);if(a&&r.tk7(a)){n.preventDefault(),C({multiSelection:{start:p,end:{...p,index:i}}});const s={startIndex:e,endIndex:i};r.YrK(a)&&o.default.afterNextFlush((()=>{S.qn({environment:t,selectedToken:{token:a,position:s},analyticsFrom:"arrow_keys"})}))}const s=r.hpT(p.store.getValue(),e,((e,t)=>{const n=r.Hze(e);return t?Boolean(n&&r.Hze(t)===n):Boolean(n)}));s&&_.dz({type:"selectionFocus",store:p.store,focus:!1,selection:s})}}function Q(e){o.default.afterNextFlush((()=>{Z()})),A();const{environment:t,store:n,event:i}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const l=(0,u.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.endIndex,endIndex:l.selection.endIndex},d=(0,p.sQ)(n);if(!i.altKey&&i.shiftKey&&a&&(0,f.J_)(n,c)&&(!m.selectionIsBackwards()||a.collapsed)&&d)k.Z5({environment:t,stores:[d]});else if(i.altKey||i.shiftKey||l.store!==n||!(0,f.J_)(n,l.selection))if(i.altKey||i.shiftKey||i.ctrlKey||i.metaKey||!a||!a.collapsed)L({store:n});else{const e=r.b1T(n.getValue(),c.startIndex);if(e&&r.tk7(e)){i.preventDefault();const a={startIndex:c.startIndex,endIndex:c.startIndex+1};T({store:n,selection:a}),r.YrK(e)&&o.default.afterNextFlush((()=>{S.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=r.hpT(n.getValue(),c.startIndex+1,((e,t)=>{const n=r.Hze(e);return t?Boolean(n&&r.Hze(t)===n):Boolean(n)}));a&&_.dz({type:"selectionFocus",store:n,focus:!1,selection:a})}else{i.preventDefault();const e=(0,f.hn)(n);e&&ee({environment:t,store:e,selection:{startIndex:0,endIndex:0}})}}function Y(e,t){const{x:n,y:o,target:i}=t,r=(0,f.fx)(n,o,i);r&&r.selectable.props.onEditText&&I.createAndCommit({userAction:"textSelectionActions.editNearestBlock",environment:e,perform:e=>{r.selectable.props.onEditText&&r.selectable.props.onEditText({isAtStartOfLine:n<=r.rect.left,isClick:!0,transaction:e})}})}function J(e,t,n){const{x:o,y:i,target:r}=t,a=r?b.default.getDefaultContainerFromTarget(r):void 0;if(a&&(0,f.Q3)(i,a)&&w.HO({environment:e,container:a,transaction:n}))return;const s=(0,f.fx)(o,i,r);if(s&&s.selectable.props.onEditText){const e=i<=s.rect.top;s.selectable.props.onEditText({isAtStartOfLine:o<=s.rect.left,isAtStartOfContainer:e,isClick:!0,transaction:n})}}function X(e,t,n,o){const{y:i,target:r}=t,a=r?b.default.getDefaultContainerFromTarget(r):void 0,s=h.C.findSelectableFromStore(n);a&&s&&(0,f.qh)(i,s)&&w.UG({environment:e,container:a,store:n,transaction:o})}function ee(e){const{environment:t,store:n,selection:o}=e;T({store:n,selection:o});const i=(0,p.sQ)(n);i&&k.eP({environment:t,store:i})}function te(e){const{environment:t,multiSelection:n,forceEmit:o,readOnly:i,focus:r}=e;C({multiSelection:n,forceEmit:o,readOnly:"infer"===i?(0,u.L5)(n).some((e=>{let{editable:t}=e;return!t.props.store.canEdit()})):i});const a=(0,u.tp)({multiSelection:n,filterCommonAncestors:!1,focus:r});a&&k.Z5({environment:t,phase:b.SelectionPhase.Editing,...a})}function ne(e){const t=v.g$.getSimpleTableCellFromTextSelection();if(t){const{rowIndex:n,columnIndex:o,simpleTableStore:i}=t.props;return v.HM.selectCell({environment:e,rowIndex:n,columnIndex:o,simpleTableStore:i}),V(e),!0}return!1}function oe(e){var t;if(!m.isMouseSelecting()||!(0,u.Aw)(e))return;const n=m.get(),o=null===(t=(0,u.fx)({range:n,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection;o&&C({multiSelection:o})}},29373:(e,t,n)=>{n.d(t,{LO:()=>S,X_:()=>w,ls:()=>v,nz:()=>y,rd:()=>b});n(57658);var o=n(41432),i=n(15157),r=n(72126),a=n(23867),s=n(35328),l=n(58202),c=n(45131),d=n(54642),u=n(49865),p=n(94419),m=n(9953),f=n(24677),g=n(98104);function h(e){return`ToggleBlock-${e}`}function v(e){const{environment:t,store:n,transaction:i}=e,r=m.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()});p.R3({parent:n.getContentStore(),append:r,transaction:i});const a=n.getContentStores()[0];f.eP({environment:t,store:a});const s=a.getBlockTitleStore();g.N_({store:s})}function b(e){let{blockId:t,state:n,currentUserId:o}=e;c.Z.setOpen(t,n),i.Z.set({userId:o,key:h(t),value:n})}function y(e){let{blockId:t,currentUserId:n}=e;const o=i.Z.get({userId:n,key:h(t)});c.Z.setOpen(t,o)}function S(e,t){d.loadCachedPageChunkBatched(e,{page:{id:t.id,spaceId:(0,a.C)(t.spaceId)},limit:25,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1})}function _(e,t){const n=(null==t?void 0:t.toggleBlockIds)||[],i=(null==t?void 0:t.collectionBlockIds)||[],r=e.getType();if((0,s.BX)(e)&&n.push(e.id),"collection_view"!==r&&"collection_view_page"!==r||i.push(e.id),r===o.Ti.transclusionReference){const t=e.getTransclusionReferenceTargetStore();t&&_(t,{toggleBlockIds:n,collectionBlockIds:i})}else{const t=e.getContentStores();for(const e of t)e.isNavigableBlock()||_(e,{toggleBlockIds:n,collectionBlockIds:i}),"collection_view"===e.getType()&&i.push(e.id)}return{toggleBlockIds:n,collectionIds:i}}function w(e,t){const{toggleBlockIds:n,collectionIds:o}=_(t),i=t.environment.currentUser.id;n.forEach((e=>y({blockId:e,currentUserId:i})));const a=r.oA(o.map((e=>function(e){const t=l.R.findCollectionViewBlockFromId(e);if(t)return t.collectionContextStore}(e)))),s=a.flatMap((e=>e.groupsStore.getAllGroupStates())),d=n.every((e=>c.Z.isOpen(e))),p=s.every((e=>e.toggleStateStore.state)),m=!(d&&p);n.forEach((e=>b({blockId:e,state:m,currentUserId:i}))),function(e,t,n){for(const o of t)for(const t of o.groupsStore.getAllGroupStates())u.uo({environment:e,collectionContextStore:o,groupFormat:t.groupsPointer[0],toggleStateStore:t.toggleStateStore,newValue:n})}(e,a,m)}},32741:(e,t,n)=>{n.d(t,{lY:()=>m,qA:()=>f,HM:()=>p});var o=n(70203),i=n(44805),r=n(97880),a=n(92120);var s=n(4708),l=n(80444),c=n(77080),d=n(96049),u=n(48588);function p(e){var t;if(d.Z.state)return;const n=c.default.checkGate("first_party_links"),p=(0,s.En)(),{token:f,store:g}=e,h=o.hDy(f.textToken),v=null===(t=l.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId(),b=v?o.zrg(h).filter((e=>!(0,i.vz)({annotation:e,spaceId:v,getRecordModel:g.getRecordModel}))):[],y=[o.rlz(h),o.K9C(h),o.QGY(h),o.frE(h),o.xat(h),n&&o.V8Y(h)||void 0,p&&o.hH9(h)||void 0,...b,o.jC0(h)].filter(r.$K);y.length>0?(u.Z.setState({token:f,store:g,annotations:y}),b.length>0&&function(e){let{source:t,discussionAnnotations:n}=e;a.Z.setState({source:t,discussionIds:n.map(o.h19)})}({discussionAnnotations:b,source:"editor"})):m()}function m(){var e,t;u.Z.state&&u.Z.setState(void 0),e="editor",(null===(t=a.Z.state)||void 0===t?void 0:t.source)===e&&a.Z.setState(void 0)}function f(e){e&&u.Z.state&&u.Z.state.store===e&&m()}},39699:(e,t,n)=>{n.r(t),n.d(t,{DEBUG:()=>ce,MetadataUpdateManager:()=>he,applyCrdtTextOperations:()=>Se,applyOperation:()=>ye,createAndCommit:()=>xe,createAndCommitAsync:()=>Te,updateConnectionState:()=>fe,updateMetadataForTransaction:()=>ge});n(57658),n(21703);var o=n(18466),i=n(45060),r=n(63144),a=n(68626),s=n(86678),l=n(5773),c=n(43593);var d=n(79317),u=n(59730),p=n(72126),m=n(91155),f=n(59753),g=n(482),h=n(33317),v=n(606),b=n(98963),y=n(21202),S=n(6287),_=n(13493),w=n(70279),k=n(15047),I=n(19889),C=n(67175),x=n(12139),T=n(97880),M=n(63143),P=n(82798),A=n(5366),R=n(95477),D=n(21830),B=n(33929),E=n(98165),F=n(4615),Z=n(45953);class L{constructor(e){this.id=(0,F.ZP)(),this.spaceId=void 0,this.userId=void 0,this.committed=!1,this.isLocal=!1,this.useSudoMode=void 0,this.deadlockWarningTimeout=void 0,this.operations=[],this.stores=[],this.initialRecordMap=Z.PF.create(),this.invertedOperations=[],this.postPerformAssertions=[],this.preEnqueueActions=[],this.postEnqueueActions=[],this.postSubmitCallbacks=[],this.postCancelCallbacks=[],this.userAction=void 0,this.userFlow=void 0;const{spaceId:t,userId:n,deadlockTimeoutMs:o,onDeadlockWarning:i}=e;t&&n&&(this.spaceId=t,this.userId=n),i&&(this.deadlockWarningTimeout=window.setTimeout(i,o))}isEmpty(){return 0===this.operations.length}annotateWithUserAction(e){this.userAction=e}getUserActionForAnalyticsPurposesOnly(){return this.userAction}annotateWithUserFlow(e){this.userFlow=e}getUserFlowForAnalyticsPurposesOnly(){return this.userFlow}cancelDeadlockWarning(){void 0!==this.deadlockWarningTimeout&&(window.clearTimeout(this.deadlockWarningTimeout),this.deadlockWarningTimeout=void 0)}done(e){this.cancelDeadlockWarning();for(const t of this.postSubmitCallbacks)t(e)}}var j=n(99341),V=n(88632),U=n(37598),O=n(89087),N=n(35661),z=n(27724),H=n(24666),W=n(34583),q=n(68955),G=n(70203),K=n(26109);function $(e){const{transaction:t,inMemoryRecordCache:n,store:o,operation:i}=e,r=i.command;switch(r){case"insertText":case"deleteText":case"addAnnotation":case"removeAnnotation":case"splitText":return Q({inMemoryRecordCache:n,textSliceTreeToMutate:(0,P.TO)(o.getTextSliceTree()),store:o,operation:i});case"splitTextIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i}=e;(0,P.T)(i.args.targetBlockId!==i.pointer.id,"Target block should be different from source block.");const r=(0,P.TO)(o.getTextSliceTree()),[{newValue:a,role:s}]=Q({inMemoryRecordCache:n,store:o,textSliceTreeToMutate:r,operation:{command:"splitText",pointer:i.pointer,path:[],args:i.args}}),l=new N.G(o.environment,{table:y.iU,id:i.args.targetBlockId});return J({transaction:t,inMemoryRecordCache:n,sourceValue:a,sourceRole:s,sourceRootTextSliceTree:r,targetStore:l,operation:{command:"moveTextSlice",pointer:{table:y.iU,id:i.args.targetBlockId},path:[],args:{textInstanceId:i.args.textInstanceId,textSliceStartItemId:i.args.id,targetBlockId:i.args.targetBlockId,targetTextInstanceId:i.args.targetBlockId,targetTextSliceEndItemId:"end"}}})}({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i});case"moveTextSlice":return Y({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i});case"moveTextSliceIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i}=e;return(0,P.T)(i.args.targetBlockId!==i.pointer.id,"Target block should be different from source block."),Y({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:{...i,command:"moveTextSlice",args:{...i.args,targetTextInstanceId:i.args.targetBlockId,targetTextSliceEndItemId:"end"}}})}({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i});default:(0,T.t1)(r)}}function Q(e){const{inMemoryRecordCache:t,store:n,operation:o,textSliceTreeToMutate:i}=e,r=i.getTextValue(),a=o.command;switch(a){case"insertText":i.applyInsertTextOperation({type:a,...o.args});break;case"deleteText":i.applyDeleteOperation({type:a,...o.args});break;case"addAnnotation":case"removeAnnotation":i.applyAnnotationOperation({type:a,...o.args});break;case"splitText":i.applySplitOperation({type:a,...o.args});break;default:(0,T.t1)(a)}const s=X((0,P.TO)(n.getValue()),i);"addAnnotation"===o.command&&G.J7s(o.args.annotation)===G.GKr.Discussion&&(s.discussions=K.Og({existingDiscussions:s.discussions,oldTextValue:r,newTextValue:i.getTextValue()})),"removeAnnotation"===o.command&&G.JA7(o.args.annotationKey)===G.GKr.Discussion&&(s.discussions=K.NL({existingDiscussions:s.discussions,oldTextValue:r,newTextValue:i.getTextValue()}));const l=ee(t,n);return[{pointer:n.pointer,newValue:s,role:l,updatePaths:[["format","text_slice_tree"],["discussions"]]}]}function Y(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i}=e;return J({transaction:t,inMemoryRecordCache:n,sourceValue:(0,P.TO)(o.getValue()),sourceRole:ee(n,o),sourceRootTextSliceTree:(0,P.TO)(o.getTextSliceTree()),targetStore:i.args.targetBlockId===o.id?o:new N.G(o.environment,{table:y.iU,id:i.args.targetBlockId}),operation:i})}function J(e){const{transaction:t,inMemoryRecordCache:n,sourceRole:o,sourceValue:i,sourceRootTextSliceTree:r,targetStore:a,operation:s}=e,l=(0,P.TO)(r.findTextSliceTreeContainingItemWithId(s.args.textInstanceId,s.args.textSliceStartItemId));(0,P.T)(l!==r,"Can not move root node of text slice tree.");const c=r.getTextValue();!function(e,t){const n=t.getRecordStoreAtRootPath().getValue(),o=t.getRecordStoreAtRootPath().getRole();e.initialRecordMap.getRole(t.pointer)||(o?e.initialRecordMap.setValueAndRole(t.pointer,n,o):e.initialRecordMap.delete(t.pointer))}(t,a);const d=s.args.targetBlockId===i.id,u=d?r:(0,P.TO)(a.getTextSliceTree()),p=(0,P.TO)(u.findTextSliceTreeContainingItemWithId(s.args.targetTextInstanceId,s.args.targetTextSliceEndItemId,{includeEndItem:!0})),m=d?c:u.getTextValue();l.detachFromParent(),p.appendChild(l);const f=X(i,r);f.discussions=d?f.discussions:f.discussions=K.NL({existingDiscussions:f.discussions,oldTextValue:c,newTextValue:r.getTextValue()});const g=[{pointer:{table:y.iU,id:i.id,spaceId:i.space_id},newValue:f,role:o,updatePaths:[["format","text_slice_tree"],["discussions"]]}];if(!d){const e=u.getTextValue(),t=X((0,P.TO)(a.getValue()),u);t.discussions=K.Og({existingDiscussions:t.discussions,oldTextValue:m,newTextValue:e}),g.push({pointer:a.pointer,newValue:t,role:ee(n,a),updatePaths:[["format","text_slice_tree"],["discussions"]]})}return g}function X(e,t){const n=p.Xh(e),o=(0,P.TO)(n.format);return(0,P.T)(o.use_crdt),t?(o.text_slice_tree=q.Z.serialize(t),o.text_clocks=q.Z.serializeClocks(t)):(o.text_slice_tree=void 0,o.text_clocks=void 0),n.version++,n}function ee(e,t){return e.getRole({pointer:t.pointer,userId:t.userId})??"editor"}var te=n(50906),ne=n(90287),oe=n(36576),ie=n(74446),re=n(33361);var ae=n(47307),se=n(4408),le=n(82007);const ce=!1,de=new Set;let ue=0;const pe=(0,A.defineMessages)({invalidBlockOperation:{defaultMessage:"Hey there! Blocks cannot be moved inside of themselves.",id:"saveChanges.errorDialog.blocksCannotBeMovedInsideSelf.message"},saveEditsError:{id:"saveEditsError.message",defaultMessage:"There was an issue persisting your edits. Please message us for help."}}),me=25*M.C0;function fe(e){V.Z.state.online&&e.currentUser.id&&O.transactionQueue.unpause()}function ge(e){const{environment:t,transaction:n,skipUpdatingEditedMetadata:o}=e,i=t.currentUser.adminUserId?I.el.id:t.currentUser.id,a=new he({transaction:n,userId:i,skipUpdatingEditedMetadata:o,timeMs:Date.now()}),s=p.mN(n.stores,(e=>e.id));for(const l of s)if(l.table===y.iU){const e=N.G.createChildStore(l,l.pointer);if(e.canEdit()&&a.addStore(e),!e.isNavigableBlock()){const t=E.Dg(e);t&&t.canEdit()&&a.addStoreWithLargeSubtree(t)}}else if(l.table===w.x_){if(l.path.length)continue;const e=l.pointer,t=n.initialRecordMap.getValue(e),o=l.getValue();(void 0===t||r.P(f.kk.fromValue(w.x_,t),f.kk.fromValue(w.x_,o)))&&a.addStore(N.T5.createChildStore(l,l.pointer))}else if(l.table===k.bx)a.addStoreWithLargeSubtree(N.H2.createChildStore(l,l.pointer));else if(l.table===S.v){const e=N.NW.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStore(e)}else if(l.table===_.n){const e=N.Xr.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStoreWithLargeSubtree(e)}else if(l.table===b.cv&&l.canEdit()){const e=N.Mz.createChildStore(l,l.pointer);a.addStore(e);const t=e.getParentBlockStore();t&&t.canEdit()&&a.addStore(t)}a.getAllOperations().forEach((e=>{let[t,o]=e;return ye({transaction:n,store:t,operation:o})}))}class he{constructor(e){this.transaction=void 0,this.timeMs=void 0,this.userId=void 0,this.skipUpdatingEditedMetadata=void 0,this.seenStoreIds=void 0,this.operations=void 0,this.transaction=e.transaction,this.timeMs=e.timeMs,this.userId=e.userId,this.skipUpdatingEditedMetadata=e.skipUpdatingEditedMetadata,this.seenStoreIds=new Set,this.operations=new Map}addStoreWithLargeSubtree(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!0})}addStore(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!1})}getAllOperations(){return Array.from(this.operations.entries())}addStoreInternal(e,t){if(e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:this.transaction.userId}))return;if(this.seenStoreIds.has(e.id))return;this.seenStoreIds.add(e.id);const n={};p.TS(n,this.collectCreationMetadata(e),this.skipUpdatingEditedMetadata?{}:this.collectEditionMetadata(e,t.shouldDebounceEditedTime)),Object.keys(n).length>0&&this.operations.set(e,{pointer:e.pointer,path:[],command:"update",args:n})}collectCreationMetadata(e){const t={};(e.isDefined()?e.getCreatedById():void 0)||(t.created_by_id=this.userId,t.created_by_table=I.KJ);return(e.isDefined()?e.getCreatedTime():void 0)||(t.created_time=this.timeMs),t}collectEditionMetadata(e,t){const n={},o=e.isDefined()?e.getLastEditedTime():-1;if((t?this.hasDebounceEnded(o,this.timeMs):o!==this.timeMs)&&(n.last_edited_time=this.timeMs),e instanceof N.G||e instanceof N.H2||e instanceof N.Mz){const t=n;(e.isDefined()?e.getLastEditedById():void 0)!==this.userId&&(t.last_edited_by_id=this.userId,t.last_edited_by_table=I.KJ)}return n}hasDebounceEnded(e,t){return M.ud(e)!==M.ud(t)}}const ve=function(e){p.mN(e.stores,(e=>e.id)).forEach((t=>{if(!t.inMemoryRecordCache.recordHasOverride({pointer:t.pointer,userId:e.userId}))if(t.table===y.iU){const n=N.G.fromRecordStore(t),o=n.getProperties(),i=n.getFormat();if(n.isDefined()){const t=(0,l.xN)({properties:o,format:i},R.default.secureFileS3.url,R.default.secureFileS3V2.url,R.default.secureFileConfig.rootPath,R.default.secureFileConfig.hostname,n.pointer),r=t.files,a=t.operations,s=n.getFileIds();for(const o of r)s.indexOf(o.id)<0&&ye({transaction:e,store:n,operation:{pointer:n.pointer,path:["file_ids"],command:"listAfter",args:{id:o.id}}});for(const o of a)ye({transaction:e,store:n,operation:o})}}else if(t.table===S.v){const n=N.NW.fromRecordStore(t),o=n.getFileIds(),i=n.getIconStore().getValue(),r=n.getCoverStore().getValue();if(n.isDefined()){const t=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(n&&!e.file_ids)return[];const r=[],{cover:a,icon:s}=e;if(a){const e=(0,c.mV)(a,t,o,i);e&&r.push(e)}if(s){const e=(0,c.mV)(s,t,o,i);e&&r.push(e)}return r}({cover:r,icon:i,file_ids:o},[R.default.secureFileS3.url,R.default.secureFileS3V2.url],!1,R.default.secureFileConfig.rootPath,R.default.secureFileConfig.hostname),a=o;for(const o of t)a.indexOf(o.id)<0&&ye({transaction:e,store:n,operation:{pointer:n.pointer,path:["file_ids"],command:"listAfter",args:{id:o.id}}})}}}))};const be=function(e,t){const n=ne.Bs(),o=new Error("Potential transaction deadlock"),r=new L({spaceId:n,userId:t||e.currentUser.id,deadlockTimeoutMs:me,onDeadlockWarning:()=>{de.delete(r);const t=r.getUserActionForAnalyticsPurposesOnly();(0,i.XY)(`A ${t} transaction hasn't been committed in ${me} ms.`,[["stack =",o.stack]]),x.IE(o,{extra:{operations_count:r.operations.length},tags:{userAction:t}}),te.y9R(e,{operations_count:r.operations.length,user_action:t});const n=r.operations.map((e=>({command:e.command,stringifiedArgs:(0,m.LK)({path:e.path,pointer:e.pointer})})));a.log({level:"warning",from:"transactionActions",type:"transactionDeadlockWarning",data:{userAction:t,operations:n}})}});return r.beforeSelection=z.default.cloneState(),r.beforeTextSelection=H.default.cloneState(),de.add(r),r};function ye(e){const{store:t,operation:n,transaction:o}=e,{inMemoryRecordCache:r}=t;if((0,C.Qf)(n)&&(0,i.XY)(`In ${o.getUserActionForAnalyticsPurposesOnly()}, use applyCrdtTextOperations() for text operations!`),(0,g.S)(n)){const i=(0,d.rb)(n,r.makeGetRecordValueFn(o.userId)).map(j.LP),a=(0,d.T1)(n,r.makeGetRecordValueFn(o.userId));for(const o of a)n.additionalUpdatedPointers||(n.additionalUpdatedPointers=[]),n.additionalUpdatedPointers.push(o.pointer),_e({...e,operation:o,isInvertible:!1,store:(0,N.Kv)(t,o.pointer)});return o.operations.push(n),void o.invertedOperations.push(...i)}_e({store:t,operation:n,transaction:o,isInvertible:!0})}function Se(e){const{store:t,operations:n,transaction:o}=e,i=e.invertedOperations.map((e=>({type:"invertedTextOperation",operation:e})));o.invertedOperations.push(...i);for(const r of n)_e({store:t,operation:r,transaction:o,isInvertible:!0})}function _e(e){const{store:t,operation:n,transaction:o}=e,{inMemoryRecordCache:i,environment:r,pointer:a,userId:l}=t;if(o.committed)throw new Error("Transaction has already been committed.");const c=t.getRecordStoreAtRootPath().getValue(),d=t.getRecordStoreAtRootPath().getRole(),u=(0,C.Qf)(n)?[]:e.isInvertible?[h.bv(n,c)].filter(T.$K).map(j.LP):[];let p;if(o.initialRecordMap.getRole(a)||(d?o.initialRecordMap.setValueAndRole(a,c,d):o.initialRecordMap.delete(a)),(0,C.Qf)(n))p=$({transaction:o,inMemoryRecordCache:i,store:(0,P.R9)(t,N.G),operation:n});else{p=[{pointer:a,newValue:h.lK(n,c),role:i.getRole({pointer:a,userId:l})??"editor",updatePaths:"update"===n.command?Object.keys(n.args).map((e=>n.path.concat([e]))):[n.path]}]}for(const m of p){const{pointer:e,newValue:n,role:a,updatePaths:c}=m;if(se.Wl({environment:r,inMemoryRecordCache:i,pointer:e,userId:l,force:!0,model:f.kk.fromValue(t.pointer.table,n),role:a,updatePaths:c,debugSource:o.getUserActionForAnalyticsPurposesOnly()??"applyOperation"}),"block"===t.table){const e=n;if(e){const t=(0,s.ky)({block:e,getRecordValue:i.makeGetRecordValueFn(o.userId)});t&&U.Z.setEditedBlock(t.id,e.id)}0}}o.isLocal=!t.shouldCacheReceiveUpdates(),e.isInvertible&&(o.operations.push(n),o.invertedOperations.push(...u)),o.stores.push(t),i.appliedTransaction=!0}const we=[{type:"userAction",allowedUserAction:"revisionActions.undoRevision"},{type:"userAction",allowedUserAction:"revisionActions.redoRevision"}];function ke(e){e.cancelDeadlockWarning(),de.delete(e);const t=p.mN(e.stores,(e=>e.id));for(const n of t){se.uo({inMemoryRecordCache:n.inMemoryRecordCache,persistedRecordCache:n.environment.defaultRecordCache.persistedRecordCache,pointer:n.pointer,userId:n.userId,environment:n.environment});const t=e.initialRecordMap.getValue(n.pointer),o=e.initialRecordMap.getRole(n.pointer);o&&se.Wl({environment:n.environment,inMemoryRecordCache:n.inMemoryRecordCache,pointer:n.pointer,userId:n.userId,updatePaths:[[]],model:f.kk.fromValue(n.pointer.table,t),role:o,debugSource:"cancelTransaction"})}for(const n of e.postCancelCallbacks)n()}const Ie=p.P2(((e,t)=>{te.Y_F(e,{errorType:t.type||t.name}),t.type===D.vZ?ae.showThrottledErrorMessage(t.message):ae.showThrottledErrorMessage(B.default.formatMessage(pe.saveEditsError))}),3e4);function Ce(e){return new Promise(((t,n)=>{de.delete(e.transaction);const o=Array.from(de).filter((e=>e.operations.length>0));var i;if(o.length>0&&te.iBN(e.environment,{committed_transaction_user_action:e.transaction.getUserActionForAnalyticsPurposesOnly(),first_uncommitted_transaction_user_action:o[0].getUserActionForAnalyticsPurposesOnly(),uncommitted_transaction_count:o.length}),0===e.transaction.operations.length)return null===(i=O.transactionQueue.logEmptyTaskForDebugging)||void 0===i||i.call(O.transactionQueue,e.transaction.getUserActionForAnalyticsPurposesOnly()),e.transaction.committed=!0,e.transaction.done(),t();void 0===e.canUndo&&(e.canUndo=!0);const{transaction:r,canUndo:s}=e,l=function(e){for(const t of e.stores)if("block"===t.table){const e=E.Om(t);if(e&&E.qA(e).find((e=>e.table===t.table&&e.id===t.id)))return B.default.formatMessage(pe.invalidBlockOperation)}}(r);if(l)return ke(r),ae.showErrorMessage(l),void t();r.cancelDeadlockWarning();for(const e of r.preEnqueueActions)e();if(ge({environment:e.environment,transaction:r,skipUpdatingEditedMetadata:e.skipUpdatingEditedMetadata}),ve(r),function(e,t){const n=t.operations.filter((e=>e.pointer.table===_.n));n.length>0&&v.dr.uniq(n.map((e=>e.pointer))).map((e=>t.initialRecordMap.getRole(e))).includes(void 0)&&t.postSubmitCallbacks.push((()=>{W.bi(e)}))}(e.environment,r),r.afterSelection=z.default.cloneState(),r.afterTextSelection=H.default.cloneState(),s&&le.K9({transaction:r,undoCheckpoint:e.undoCheckpoint}),ce&&console.log("Committing transaction",r),r.isLocal){for(const e of r.postEnqueueActions)e();r.done(),t()}else{const o=e=>{r.done(e),e?n(e):t()},{LocalBacklinkStore:i,currentUser:s}=e.environment;i&&async function(e,t){const{LocalBacklinkStore:n,currentUser:o}=e;if(0===t.stores.length)return;const i=t.stores[0].inMemoryRecordCache,r=[],a=Z.Ak.create(),s=new Set;for(const p of t.stores)s.has(p.id)||(s.add(p.id),r.push(p.pointer),a.setValue(p.pointer,p.getRecordStoreAtRootPath().getValue()));const l=re.DI(t.initialRecordMap),{createdBacklinks:c,deletedBacklinks:d}=await(0,oe.xU)({loadRecordValue:ie.zF.fromGetRecordValueFn(i.makeGetRecordValueFn(o.id)),operationPointers:r,getInitialRecordModel:f.om.fromRecordMap(l),getFinalRecordModel:f.om.fromRecordMap(a)}),u=n.updateBacklinks({createdBacklinks:c,deletedBacklinks:d,currentUserId:o.id});t.postSubmitCallbacks.push((e=>{e&&n.resetBacklinkState({blockIds:u,currentUserId:o.id})}))}({LocalBacklinkStore:i,currentUser:s},r);const l=Date.now();l<ue&&te.vtR(e.environment,{regression_amount:ue-l}),ue=l,O.transactionQueue.enqueueTask((0,j.JG)({transaction:r,timestamp:l,callback:o})).catch((t=>{a.log({level:"error",from:"transactionActions",type:"enqueueTask",error:(0,m.Ui)(t)}),e.environment.device.isMobileNative&&"SqliteOutOfSpace"===t.name||Ie(e.environment,t),ke(r),o(t)}));for(const e of r.postEnqueueActions)e()}r.committed=!0}))}function xe(e){const{userAction:t,environment:n,userId:i,perform:r,canUndo:s,undoCheckpoint:l,transactionTooBigFallback:c,skipUpdatingEditedMetadata:d,useSudoMode:p}=e;return o.Z.withListenerIgnored((()=>{const o=be(n,i);let f;o.annotateWithUserAction(t),p&&(o.useSudoMode=!0);try{f=r(o),function(e){if(e.isLocal)return;for(const t of e.stores){const n=t.inMemoryRecordCache.checkRecordForTemporaryData(t);if(n)throw new u.p8(`Transaction "${e.getUserActionForAnalyticsPurposesOnly()}" is manipulating a store with temporary local changes from an in-memory record cache named "${n.name}"!`)}}(o);for(const e of o.postPerformAssertions)e()}catch(g){ke(o);const e=o.getUserActionForAnalyticsPurposesOnly(),t=o.getUserFlowForAnalyticsPurposesOnly();throw x.IE(g,{tags:{userAction:e,userFlow:t}}),a.log({level:"error",from:"transactionActions",type:"createAndCommit",error:(0,m.Ui)(g),data:{userAction:e,userFlow:t,spaceId:o.spaceId}}),g}finally{0}if(c&&(0,j.jQ)(o))return ke(o),xe({...e,perform:c,transactionTooBigFallback:void 0,userAction:`${t} transactionTooBigFallback`});return{performResult:f,serverCommitResult:Ce({environment:n,transaction:o,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:d})}}))}async function Te(e){const{environment:t,perform:n,waitForServerCommit:o,userAction:i,userId:r,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c,useSudoMode:d}=e,u=be(t,r);let p;u.annotateWithUserAction(i),d&&(u.useSudoMode=!0);try{p=await n(u);for(const e of u.postPerformAssertions)e()}catch(g){const t=u.getUserActionForAnalyticsPurposesOnly();de.delete(u);const n=u.operations.length>0;throw n&&te.kY8(e.environment,{user_action:t,operation_count:u.operations.length}),x.IE(g,{tags:{userAction:t,transactionOperationCount:u.operations.length}}),a.log({level:"error",from:"transactionActions",type:"createAndCommitAsync",error:(0,m.Ui)(g),data:{message:n?`POSSIBLE DATA LOSS: asynchronous transaction had ${u.operations.length} operations`:void 0,userAction:t}}),g}const f=Ce({environment:t,transaction:u,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c});return o&&await f,{performResult:p,serverCommitResult:f}}},68422:(e,t,n)=>{n.d(t,{_w:()=>B,vs:()=>A,Cj:()=>R});var o=n(1302),i=n(41432),r=n(72126),a=n(27006),s=n(4615),l=n(21202),c=n(70203),d=n(42274),u=n(65598),p=n(35328),m=n(35661),f=n(26664),g=n(34583),h=n(41433),v=n(94419),b=n(76464),y=n(9953),S=n(42858),_=n(24677),w=n(98104),k=n(29373),I=n(73959),C=n(55367),x=n(96802),T=n(13084);function M(e,t){const{store:n,transaction:o,disableAutoChildrenMove:i}=e;return i||function(e){const{environment:t,store:n,transaction:o}=e,i=(0,I.sQ)(n),r=(null==i?void 0:i.getContentStores())||[];let a=!1;const s=r.filter((e=>{return a?(t=e.getType(),o=n.getType(),!(!t||!o||t===o||"divider"===t||"collection_view"===t||"sub_header"===o&&"header"===t||"sub_sub_header"===o&&("header"===t||"sub_header"===t))||(a=!1,!1)):(e===n&&(a=!0),!1);var t,o}));T.LQ({environment:t,targetParentStore:n.getContentStore(),droppedDirection:C.vh.Below,droppedStores:s,duplicate:!1,transaction:o})}(e),x.FH({stores:[n],update:{toggleable:t},transaction:o})}var P=n(39699);function A(e){const{environment:t,block:n,blockType:o,transaction:s,isMultiBlockTransformation:l}=e,u=n.getType(),m=n.getFormat(),f=n.recordStoreUIParentStore;if(g.M_(t)&&u&&!function(e,t){const n=e.type,o=e.format;if(p.ih(t)){var r;return"mermaid_code_block"===t?e.type===i.Ti.code&&"Mermaid"===c.QaF(null===(r=e.properties)||void 0===r?void 0:r.language):(0,i.Fx)(t)?p.tZ(t)===e.type&&(0,i.eJ)(n,o):p.tZ(t)===e.type}return e.type===t&&!(0,i.eJ)(n,o)}({type:u,format:m,properties:n.getProperties()},o)){const e=u,c=p.ih(o)?p.tZ(o):o;if(y.sW({store:n,data:{type:c},transaction:s}),(0,i.Fx)(o)&&!p.fn(n)?function(e){M(e,!0)}({environment:t,store:n,transaction:s,disableAutoChildrenMove:Boolean(l)}):!(0,i.Fx)(o)&&p.fn(n)&&function(e){const{store:t}=e;t.recordStoreUIParentStore&&M(e,!1)}({environment:t,store:n,transaction:s,disableAutoChildrenMove:Boolean(l)}),"mermaid_code_block"===o&&d.E5({blocks:[n],language:"Mermaid",transaction:s}),i.Z7[e]&&!i.Z7[o]){n.getPermissionItems().some(a.Le)&&b.MX({environment:t,store:n,transaction:s})}p.BX(n)&&k.rd({blockId:n.id,state:!0,currentUserId:t.currentUser.id});const g=n.getType();g&&f&&u&&(0,i.Um)(u,m)&&!(0,i.Um)(g,n.getFormat())&&function(e){let{environment:t,block:n,parentStore:o}=e;(async()=>{const e=n.getContentStores();await Promise.all(e.map((e=>e.load()))),P.createAndCommit({userAction:"transformActions.runAsync",environment:t,perform:t=>{const i=r.d9(e).reverse();for(const e of i)v.Od({parent:n.getContentStore(),childToRemove:e,transaction:t}),v.BE({parent:o,insert:e,after:n,transaction:t})}})})()}({environment:t,parentStore:f,block:n}),h.jf({store:n,transaction:s})}return n}function R(e){const{environment:t,blocks:n,blockType:a,transaction:c}=e;if(a!==i.Ti.transclusionContainer)if(a!==i.Ti.columnList)if((0,i.sX)(a)){const e=parseInt(a.replace("column","").replace("block","")),i=r.oA(r.DZ(e-1,(()=>S.ZJ({environment:t,blocks:n,transaction:c})))),s=[...n,...i],l=D({environment:t,blocks:s,transaction:c});o.default.afterNextFlush((()=>{w.N_({store:l[0].getBlockTitleStore()})}))}else for(const o of n)A({environment:t,block:o,blockType:a,transaction:c,isMultiBlockTransformation:n.length>1});else D({environment:t,blocks:n,transaction:c});else!function(e){const{environment:t,blocks:n,transaction:o}=e,r=n[0];if(!r)return;const a=r.getRecordStoreUIParent();if(!a||!(0,u.dz)(a))return;const c=a.getRecordStoreUIParent();if(!c||!(0,u.OY)(c))return;if(!c.isDefined())return;const d=(0,s.ZP)(),p={id:d,type:i.Ti.transclusionContainer,parent_id:a.id,parent_table:"block",space_id:c.getSpaceId(),alive:!0};y.ae({environment:t,table:"block",value:p,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o});const g=m.G.createChildStore(a,{table:l.iU,id:d}),h=g.getContentStore();v.BE({parent:a,insert:g,after:r,transaction:o}),function(e){const{newParent:t,blocks:n,transaction:o}=e;for(const i of n){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(f.i)&&(v.Od({parent:e,childToRemove:i,transaction:o}),v.R3({parent:t,append:i,transaction:o}))}}({newParent:h,blocks:n,transaction:o}),w.ZH(t),_.ZH(t),_.Z5({environment:t,stores:[g]})}({environment:t,blocks:n,transaction:c})}function D(e){const{environment:t,blocks:n,transaction:o}=e,r=n[0];if(!r)return[];const a=r.recordStoreUIParentStore;if(null==a||!a.valueIs(f.i))return[];const c=(0,s.ZP)(),d={id:c,type:i.Ti.columnList,parent_id:a.id,parent_table:"block",space_id:r.getSpaceId(),alive:!0};y.ae({environment:t,table:"block",value:d,inMemoryRecordCache:r.inMemoryRecordCache,transaction:o});const u=m.G.createChildStore(a,{table:l.iU,id:c}),{child:p}=v.Vt({parent:a,insert:u,before:r,transaction:o});return n.map((e=>{const n=(0,s.ZP)(),r={id:n,type:i.Ti.column,parent_id:u.id,parent_table:"block",space_id:e.getSpaceId(),alive:!0};y.ae({environment:t,table:"block",value:r,inMemoryRecordCache:e.inMemoryRecordCache,transaction:o});const c=m.G.createChildStore(p.getContentStore(),{table:l.iU,id:n}),{child:d}=v.Od({parent:a,childToRemove:e,transaction:o}),{child:f}=v.BE({parent:p.getContentStore(),insert:c,transaction:o}),{child:g}=v.BE({parent:f.getContentStore(),insert:d,transaction:o});return g}))}function B(e){let{environment:t,blocks:n,transaction:o}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(n)&&R({environment:t,blocks:n,blockType:"collection_view_page",transaction:o})}},39865:(e,t,n)=>{n.d(t,{DV:()=>w,Rn:()=>I,Tq:()=>C,y8:()=>k});n(57658);var o=n(15145),i=n(79317),r=n(59730),a=n(21202),s=n(23867),l=n(5366),c=n(33929),d=n(74948),u=n(44604),p=n(80444),m=n(1310),f=n(50906),g=n(54642),h=n(47307),v=n(19785),b=n(75018),y=n(64964),S=n(65452);const _=(0,l.defineMessages)({deletePageConfirmationMessage:{id:"trashActions.deletePagePermanentlyDialog.prompt",defaultMessage:"Are you sure you want to delete this page permanently?"},deletePageConfirmationButton:{id:"trashActions.deletePagePermanentlyDialog.confirmDeleteButton.label",defaultMessage:"Yes. Delete this page"},permanentlyDeleteFailedToast:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.toast",defaultMessage:"Failed to delete, please try again later."},permanentlyDeletePermissionsFailure:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.permissions",defaultMessage:"You do not have sufficient permissions to permanently delete this page."}});async function w(e){const{environment:t,block:n,spaceId:i}=e;u.Z.state.excludePages.add(n.id),u.Z.emit(),await g.restoreBlock(t,{pointer:{table:a.iU,id:n.id,spaceId:i}}),b.navigateToBlock({environment:t,store:n,pageVisitSource:o.tY.Restore}),t.device.isMobile&&d.close(),f.Y35(t)}function k(e){const{environment:t,blocks:n,transaction:o}=e;for(const r of n){const e=r.getParentStore();e&&((0,i.A6)(e.table,r.table)?v.hr({parentStore:e,childStore:r,transaction:o}):v.hh({childStore:r,transaction:o}))}o.postSubmitCallbacks.push((async e=>{e||await g.deleteBlocks(t,{blocks:n.map((e=>({id:e.id,spaceId:(0,s.C)(e.pointer.spaceId)}))),permanentlyDelete:!1})}))}function I(e){h.showDialog({message:c.default.formatMessage(_.deletePageConfirmationMessage),showCancel:!0,keepFocus:!1,items:[{label:c.default.formatMessage(_.deletePageConfirmationButton),color:"red",onAccept:()=>C(e)}]})}async function C(e){const{blocks:t,environment:n}=e,{currentSpaceStore:o}=p.default.state,i=e.environment.currentUser.id;if(o&&i){await g.deleteBlocks(e.environment,{blocks:t.map((e=>({id:e.id,spaceId:(0,s.C)(e.pointer.spaceId)}))),permanentlyDelete:!0}).then((e=>{if("failed"===e.type)throw function(e){let t=_.permanentlyDeleteFailedToast;(0,r.QW)(e)&&(t=_.permanentlyDeletePermissionsFailure);y.oV({label:c.default.formatMessage(t),durationMs:m.JY})}(e.body),e.error}));for(const e of t)u.Z.state.excludePages.add(e.id),u.Z.emit();await S.l({environment:n,spaceId:o.id,userId:i}),b.navigateAwayIfCurrentPage({environment:e.environment,blocks:t}),f.tZo(n)}}},27370:(e,t,n)=>{n.r(t),n.d(t,{dismissTutorial:()=>d,resetTutorials:()=>u,tutorialAdvanceToStep:()=>p,tutorialAdvanceToStepAfter:()=>m,tutorialGoToNextStep:()=>l,tutorialGoToPrevStep:()=>c});var o=n(9163),i=n(39699),r=n(37181),a=n(64856),s=n(80444);function l(e,t){var n;const{currentUserSettingsStore:o}=s.default.state;if(!o)return;const i=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{r.d2({userSettingsStore:o,transaction:e,data:{tutorials:{...i,[t]:(0,a.ox)(o,t)}}})},userId:o.id})}function c(e,t){var n;const{currentUserSettingsStore:o}=s.default.state;if(!o)return;const i=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{r.d2({userSettingsStore:o,transaction:e,data:{tutorials:{...i,[t]:(0,a.IJ)(o,t)}}})},userId:o.id})}function d(e,t){var n;const{currentUserSettingsStore:i}=s.default.state;if(!i)return;const a=null===(n=i.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{r.d2({userSettingsStore:i,transaction:e,data:{tutorials:{...a,[t]:o.lR}}})},userId:i.id})}function u(e){const{currentUserSettingsStore:t}=s.default.state;t&&f({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{r.d2({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function p(e,t,n){var i;const{currentUserSettingsStore:l}=s.default.state;if(!l||(0,a.W$)(l,t))return;const c=(0,a.wF)(l,t);o.eU[t].steps.findIndex((e=>e.id===c))>=o.eU[t].steps.findIndex((e=>e.id===n))||r.d2({userSettingsStore:l,transaction:e,data:{tutorials:{...null===(i=l.getSettings())||void 0===i?void 0:i.tutorials,[t]:n}}})}function m(e,t,n){if((0,a.AK)(n))return;const o=(0,a.Xv)(t,n);o&&p(e,t,o)}function f(e){return i.createAndCommit({...e,canUndo:!1})}},61202:(e,t,n)=>{n.d(t,{KT:()=>he,FD:()=>ye,xv:()=>ve,jh:()=>Ce,pt:()=>me,os:()=>Ae,dY:()=>Ie,pJ:()=>ge,hJ:()=>be,UY:()=>we,yp:()=>_e,sz:()=>De,aV:()=>Be,qK:()=>Ee});n(21703),n(57658);var o=n(26263),i=n(1302),r=n(41432),a=n(99036),s=n(80951),l=n(95538),c=n(77657),d=n(2864),u=n(68626),p=n(20270),m=n(72126),f=n(59753),g=n(4615),h=n(45953),v=n(21202),b=n(77420),y=n(6287),S=n(13493),_=n(32161),w=n(9844),k=n(23867),I=n(90965),C=n(70203),x=n(97880),T=n(44876),M=n(64002),P=n(63143),A=n(5366),R=n(14871),D=n(94419),B=n(9953),E=n(24677),F=n(97444),Z=n(98104),L=n(39699),j=(n(95477),n(69783)),V=n(65454),U=n(77080);var O=n(70764),N=n(41232),z=n(28415),H=n(33929),W=n(65598),q=n(89224),G=n(58202),K=n(80444),$=n(30874),Q=n(79167),Y=n(19111),J=n(35661),X=n(1634),ee=n(80064),te=n(40671),ne=n(34583),oe=n(50906),ie=n(54642),re=n(90287),ae=n(5149),se=n(47307),le=n(42631),ce=n(27153),de=n(4408),ue=n(64964);const pe=(0,A.defineMessages)({browse:{id:"externalBlock.mediaPicker.browseTab.title",defaultMessage:"Browse {appName}"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"externalActions.dialogError.openFilePicker.errorMessage"},copyDebuggingInformation:{id:"externalActions.dialogItem.openFilePicker.copyDebugData",defaultMessage:"Copy debugging information"},copiedDebuggingInfo:{id:"externalActions.dialogError.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."},userReAuth:{id:"externalActions.dialogError.userReAuth",defaultMessage:"Authentication Expired. Please Re-Authenticate to continue."}});async function me(e){const{environment:t,spaceId:n,force:o}=e;await K.default.waitUntilRendered();const i=$.Z.state,r=t.currentUser.id;if(!i.loaded&&!i.loading||i.loaded&&n!==i.spaceId||i.loaded&&r!==i.userId||o){$.Z.setState({...$.Z.state,loading:!0});const[e,o]=await Promise.all([ie.getExternalIntegrations(t,{spaceId:n}),fe({environment:t,spaceId:n})]);if("success"!==e.type||"success"!==o.type)throw new Error("Request failed.");const i=h.PF.create(e.data.recordMap),r=h.PF.create(o.data.recordMap);$.Z.setState({loaded:!0,loading:!1,spaceId:n,userId:t.currentUser.id,integrations:m.MR(m.oA(e.data.integrationIds.map((e=>i.getValue({table:w.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),externalAuthentications:m.MR(m.oA(o.data.externalAuthenticationIds.map((e=>r.getValue({table:_.P,id:e})))),(e=>{let{created_at:t}=e;return t})),bots:m.Xo(m.oA(o.data.botIds.map((e=>r.getValue({table:b.cZ,id:e})))),(e=>{let{last_edited_at:t,created_at:n}=e;return t||n}),"desc"),completeSlackAuthentications:m.MR(m.oA(o.data.completeSlackAuthenticationIds.map((e=>r.getValue({table:_.P,id:e})))),(e=>{let{created_at:t}=e;return t}))})}}async function fe(e){const{environment:t,spaceId:n}=e;return t.currentUser.isLoggedIn()?await ie.getUserSpaceExternalBots(t,{spaceId:n}):{type:"success",status:200,headers:{},data:{botIds:[],externalAuthenticationIds:[],recordMap:{},completeSlackAuthenticationIds:[]}}}async function ge(e){const{environment:t}=e,{currentSpaceStore:n}=K.default.state;n&&await me({environment:t,spaceId:n.id,force:!0})}function he(e){const{environment:t,blockStore:n,textStore:a,url:s,textValueBeforePaste:d,urlSelection:p}=e,f=q.get();if(!n||j.Z.state.open||Y.Z.state.open||ee.Z.state.open||!f)return!1;const{currentSpaceStore:h}=K.default.state,b=(0,l.x$)(s),_=(0,M.Qc)(b);if(!_.host)return!1;const w=t.currentUser.id;if(null==h||!h.isDefined()||!w)return!1;const x=$.Z.integrations.state.filter((e=>e.id!==c.U9)),P=(0,T.ny)({url:b,integrations:x,currentSpaceId:h.id});if("partial"===P.type)return function(e){const{environment:t,parsedUrl:n,urlDomain:o,integrationId:i}=e;oe.ppr(t,{integrationId:i,urlDomain:o}),u.log({level:"debug",from:"activateFromLinkCreation",type:"linkPreviewUrlMiss",data:{miscDataToConvertToString:{integrationId:i,urlDomain:o,path:n.path}}})}({...P,integrationId:P.integration.id,environment:t}),!1;if("failure"===P.type)return!1;const{integration:A,pattern:R}=P;if(!(0,I.wv)({permissions:h.getPermissionItems()},w)&&!(0,I.hU)({spaceBotSettings:h.getBotSettingsStore().getValue(),integrationId:A.id,env:"production"}))return!1;const D=(0,O.NP)(A.id),B=function(e){var t;const{integration:n,pattern:o,blockStore:i,textValueBeforePaste:a}=e,s=i&&i.getType()===r.Ti.text&&0===(0,C.QaF)(a).trim().length,l=Boolean(null===(t=o.additional_types)||void 0===t?void 0:t.collection);return s?m.oA(["preview","mention","link",l&&"collection"]):m.oA(["mention","preview","link",l&&"collection"])}({blockStore:n,integration:A,pattern:R,textValueBeforePaste:d}),E=q.getRect(f);if(!E)return!1;const F=n.getRecordStoreUIParent();if(!F||!(0,W.dz)(F))return!1;const Z=new o.Z({name:"unfurlingActions.activateFromLinkCreation",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(Z);const V=F.clone(Z),U=n.clone(Z),N=a.clone(Z),z=new J.G(t,{table:v.iU,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}),G=z.clone(Z),Q=m.w6(T.wh).map((()=>new J.G(t,{table:v.iU,id:(0,g.ZP)(),spaceId:(0,k.C)(n.pointer.spaceId)}))),X=Q.map((e=>e.clone(Z))),te=new J.NW(t,{table:y.v,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}),ne=te.clone(Z);let ie;ie=R.defaultViews?R.defaultViews.map((e=>new J.Xr(t,{table:S.n,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}))):[new J.Xr(t,{table:S.n,id:(0,g.ZP)(),spaceId:n.pointer.spaceId})];const re=ie.map((e=>e.clone(Z))),ae=m.w6(T.wh).map((()=>new J.NW(t,{table:y.v,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}))),se=ae.map((e=>e.clone(Z))),le=m.w6(T.wh).map((()=>new J.Xr(t,{table:S.n,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}))),ce=le.map((e=>e.clone(Z)));return ee.Z.setState({open:!0,url:b,textValueBeforePaste:d,textValueAfterPaste:a.getValue(),urlSelection:p,renderRect:E,integration:A,pattern:R,currentOption:{type:"link"},allOptionTypes:B,temporaryRecordCache:Z,stores:{blockStore:n,blockParentStore:F,textStore:a,externalObjectInstanceBlockStore:z,subExternalObjectInstanceBlockStores:Q,externalCollectionStore:te,externalCollectionViewStores:ie,subExternalCollectionStores:ae,subExternalCollectionViewStores:le},temporaryStores:{blockParentStore:V,blockStore:U,textStore:N,externalObjectInstanceBlockStore:G,subExternalObjectInstanceBlockStores:X,externalCollectionStore:ne,externalCollectionViewStores:re,subExternalCollectionStores:se,subExternalCollectionViewStores:ce},unfurlResponse:void 0}),D.length>0&&Se({environment:t,url:s,botIds:D.map((e=>{let{id:t}=e;return t})),integrationId:A.id,externalObjectInstanceBlockStore:z}),oe._xm(t,{integrationId:A.id,entity:R.name,domain:_.host,from:"link_paste"}),i.default.afterNextFlush((()=>{L.createAndCommit({userAction:"unfurlingActions.activateFromLinkCreation",environment:t,perform:e=>{be({environment:t,type:B[0],useTemporaryRecordCache:!0,transaction:e,intl:H.default.getIntl()})}})})),!0}function ve(e){const{environment:t,setType:n,transaction:o}=e,{currentUserSettingsStore:i}=K.default.state,r=ee.Z.state;if(!r.open)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(r.temporaryRecordCache);const a=(0,O.NP)(r.integration.id).length>0;if(be({environment:t,type:n||r.currentOption.type,useTemporaryRecordCache:!1,transaction:o,intl:H.default.getIntl()}),"preview"===r.currentOption.type&&E.Z5({environment:t,stores:[r.currentOption.externalObjectInstanceBlockStore]}),r.integration&&!a){(null==i?void 0:i.hasDismissedIntegrationPopup({integrationId:r.integration.id}))||X.Z.setState({open:!0,integration:r.integration,externalObjectInstanceBlockId:r.stores.externalObjectInstanceBlockStore.id,unfurlUrl:r.url})}ee.Z.setState({open:!1})}function be(e){const{environment:t,type:n,transaction:o,useTemporaryRecordCache:c}=e,u=ee.Z.state;if(!u.open)return;const p=t.currentUser.id;if(!p)return;const g=c?u.temporaryStores:u.stores;if(c){u.temporaryRecordCache.clearCache();for(const e in u.temporaryStores){const n=u.temporaryStores[e],o=Array.isArray(n)?n:[n];for(const e of o){const n={userId:p,pointer:e.pointer},o=t.defaultRecordCache.inMemoryRecordCache.getRecord(n);o?de.Wl({environment:t,inMemoryRecordCache:u.temporaryRecordCache,pointer:e.pointer,model:f.kk.fromValue(e.pointer.table,o.value),role:o.role,updatePaths:[[]],userId:p,force:!0,debugSource:"setUnfurlingOptionType"}):de.uo({environment:t,inMemoryRecordCache:u.temporaryRecordCache,persistedRecordCache:void 0,pointer:e.pointer,userId:p})}}}const h=(0,l.x$)(u.url),{host:b}=(0,M.Qc)(h);if(b){if("preview"===n||"mention"===n){const{unfurlResponse:e}=u,t=Fe({externalObjectInstanceBlockStore:g.externalObjectInstanceBlockStore,parentId:g.blockParentStore.id}),n={original_url:h,domain:b};let i;if(e){const a=(0,P.m8)(m.oA(e.relations.map(((e,t)=>{if(e.external_schema)return;const n=g.subExternalObjectInstanceBlockStores[t];if(!n)return;const i=e,a={id:n.id,type:r.Ti.externalObjectInstance,space_id:(0,k.C)(g.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:g.externalObjectInstanceBlockStore.id,alive:!0,format:i};return B.sW({store:n,data:a,transaction:o}),[e.uri,n.id]})))),{external_object_id:s,uri:l,bot_id:c}=e.root;if(s&&l&&c){let o,r;const u=(0,d.o)(e.root.attributes,(0,N.o$)());u&&(o=u.block_width,r=u.block_height);const p={...n,...{...e.root,block_width:o,block_height:r,external_schema:void 0},related_external_object_uris_to_instance_ids:a,external_object_id:s,uri:l,bot_id:c};i={...t,format:p}}else{var S;const o={...n,attributes:e.root.attributes,error:e.root.error,auth_refresh_in_progress:439===(null===(S=e.root.error)||void 0===S?void 0:S.status_code)||null};i={...t,format:o}}}else{const e=n;i={...t,format:e}}B.sW({store:g.externalObjectInstanceBlockStore,data:i,transaction:o})}else if("collection"===n){const{unfurlResponse:e}=u,t={id:g.externalObjectInstanceBlockStore.id,version:0,type:r.Ti.collectionView,format:{collection_pointer:g.externalCollectionStore.pointer},collection_id:g.externalCollectionStore.pointer.id,space_id:(0,k.C)(g.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:g.blockParentStore.id,alive:!0,view_ids:g.externalCollectionViewStores.map((e=>e.id))},n=g.externalCollectionViewStores.map(((e,t)=>{var n,o,i;return{id:e.id,version:0,space_id:(0,k.C)(g.blockStore.pointer.spaceId),type:(null===(n=u.pattern.defaultViews)||void 0===n?void 0:n[t].type)||"table",format:null===(o=u.pattern.defaultViews)||void 0===o?void 0:o[t].format,query2:null===(i=u.pattern.defaultViews)||void 0===i?void 0:i[t].query2,parent_table:v.iU,parent_id:g.externalObjectInstanceBlockStore.id,alive:!0}}));let l;if(e){const{external_object_id:n,uri:i,bot_id:r}=e.root;if(n&&i&&r)if("collectionId"in e&&e.collectionId){l={id:e.collectionId,version:0,space_id:(0,k.C)(g.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:g.externalObjectInstanceBlockStore.id,alive:!0,schema:{}},t.format=void 0,t.collection_id=e.collectionId}else{const t={};e.relations.forEach(((e,n)=>{const i=g.subExternalCollectionStores[n],r=e,a={id:i.id,version:0,space_id:(0,k.C)(g.blockStore.pointer.spaceId),parent_table:y.v,parent_id:g.externalCollectionStore.id,alive:!0,format:r,schema:{}};t[e.uri]=i.id,B.sW({store:i,data:a,transaction:o})}));l={id:g.externalCollectionStore.id,version:0,space_id:(0,k.C)(g.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:g.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:h,domain:b,...e.root,related_external_object_uris_to_instance_ids:{...t}},schema:{}}}else{l={id:g.externalCollectionStore.id,version:0,space_id:(0,k.C)(g.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:g.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:h,domain:b,error:e.root.error},schema:{}}}}else{l={id:g.externalCollectionStore.id,version:0,space_id:(0,k.C)(g.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:g.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:h,domain:b},schema:{}}}B.sW({store:g.externalObjectInstanceBlockStore,data:t,transaction:o});const c=U.default.checkGate("is_visibility_enabled_for_db_sync");g.externalCollectionViewStores.forEach(((t,i)=>{var r;e&&"collectionId"in e&&e.collectionId&&n[i].format&&(n[i].format={collection_pointer:{id:e.collectionId,table:y.v}}),c&&e&&"table"===n[i].type&&(n[i].format={...n[i].format,table_properties:(r=e.root.external_schema,r&&Object.entries(r).flatMap((e=>{let[t,n]=e;return(0,a.HF)(t)?[]:"hidden"===(null==n?void 0:n.visibility)?{property:`${s.UU}${t}`,visible:!1}:{property:`${s.UU}${t}`,visible:!0}})))}),B.sW({store:t,data:n[i],transaction:o})})),B.sW({store:g.externalCollectionStore,data:l,transaction:o});const d=u.integration;i.default.afterNextFlush((()=>{const e=G.R.findCollectionViewBlockFromId(g.externalObjectInstanceBlockStore.id);if(e){const t=e.collectionContextStore.settingsStore;ae.wl({collectionSettingsStore:t,item:{type:"shareSyncedView",integrationName:d.name,integrationIcon:d.info.icon}})}}))}if("preview"===n){F.sO({environment:t,store:g.textStore,value:u.textValueBeforePaste,transaction:o});const e=J.G.createChildStore(g.blockParentStore,g.externalObjectInstanceBlockStore.pointer);if(D.BE({parent:g.blockParentStore,insert:e,after:g.blockStore,transaction:o}),0===(0,C.QaF)(u.textValueBeforePaste).trim().length){const e=J.G.createChildStore(g.blockParentStore,u.stores.blockStore.pointer);D.Od({parent:g.blockParentStore,childToRemove:e,transaction:o})}const i=J.G.createChildStore(u.stores.blockParentStore,u.stores.externalObjectInstanceBlockStore.pointer);E.ZH(t),ee.Z.setState({...u,currentOption:{type:n,externalObjectInstanceBlockStore:i}})}else if("mention"===n){const e=(0,C.x36)(g.externalObjectInstanceBlockStore.id),n=(0,C.YCD)(e),i=(0,C.P$X)(u.textValueBeforePaste,[n],u.urlSelection.startIndex),r={startIndex:u.urlSelection.startIndex+1,endIndex:u.urlSelection.startIndex+1};F.sO({environment:t,store:g.textStore,value:i,transaction:o}),B.sW({store:g.externalObjectInstanceBlockStore,data:{parent_id:g.textStore.id,parent_table:v.iU,alive:!0},transaction:o}),E.eP({environment:t,store:u.stores.blockStore}),Z.Z5({store:u.stores.textStore,selection:r}),ee.Z.setState({...u,currentOption:{type:"mention",mentionTokenSelection:r}})}else if("link"===n)ee.Z.setState({...u,currentOption:{type:"link"}}),E.eP({environment:t,store:u.stores.blockStore}),Z.Z5({store:u.stores.textStore,selection:{startIndex:u.urlSelection.endIndex,endIndex:u.urlSelection.endIndex}});else if("collection"===n){F.sO({environment:t,store:g.textStore,value:u.textValueBeforePaste,transaction:o});const e=J.G.createChildStore(g.blockParentStore,g.externalObjectInstanceBlockStore.pointer);if(D.BE({parent:g.blockParentStore,insert:e,after:g.blockStore,transaction:o}),0===(0,C.QaF)(u.textValueBeforePaste).trim().length){const e=J.G.createChildStore(g.blockParentStore,u.stores.blockStore.pointer);D.Od({parent:g.blockParentStore,childToRemove:e,transaction:o})}E.ZH(t),ee.Z.setState({...u,currentOption:{type:n}})}else(0,x.t1)(n);if(!c){const{unfurlResponse:e}=u;oe.Mp(t,{integrationId:u.integration.id,type:n,entity:u.pattern.name,domain:b,from:"unfurl_menu",...e&&{status:null!=e&&e.root.error?"failure":"success"},collection_id:"collection"===n?g.externalCollectionStore.pointer.id:void 0,collection_view_block_id:"collection"===n&&g.blockStore.isCollectionView()?g.blockStore.id:void 0})}}}async function ye(e){const{environment:t,notionState:n}=e,{externalObjectInstanceBlockId:o,spaceId:i}=n;if(o){const e=new J.G(t,{table:v.iU,id:o,spaceId:i});let n;if(await Promise.all([e.load(),$.Z.waitUntil((()=>$.Z.state.loaded))]),e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())n=e.getFormat();else if(e.isCollectionView()){var r;n=null===(r=e.getCollectionViewSourceCollectionStore())||void 0===r?void 0:r.getFormat()}if(!n)throw new Error("External object instance has no value.");const a=n.original_url||n.uri;if(!a)throw new Error("External object instance has no original_url.");const s=(0,T.ny)({url:a,integrations:$.Z.integrations.state,currentSpaceId:i});if("success"!==s.type)throw new Error("Could not find integration.");const{integration:l}=s,c=(0,O.NP)(l.id);if(0===c.length)throw new Error("Could not find bot.");if(e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())await Se({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),integrationId:l.id,externalObjectInstanceBlockStore:e});else{if(!e.isCollectionView())throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${e.getType()}`);{const n=e.getCollectionViewSourceCollectionStore();if(!n)throw new Error("Could not find collection store.");await we({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),externalCollectionViewBlockStore:e,externalCollectionStore:n})}}}}async function Se(e){const{environment:t,url:n,botIds:o,integrationId:i,externalObjectInstanceBlockStore:a}=e;te.Z.add(n);const s=await ie.unfurlUrl(t,{url:n,botIds:o,integrationId:i,spaceId:re.Bs()});te.Z.delete(n);const c=ee.Z.state,u="success"===s.type?s.data:{root:{error:{status_code:s.status}},relations:[]};if(c.open&&c.stores.externalObjectInstanceBlockStore===a)ee.Z.setState({...c,unfurlResponse:u}),L.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:e=>{be({environment:t,type:c.currentOption.type,useTemporaryRecordCache:!0,transaction:e,intl:H.default.getIntl()})}});else if(a.isExternalObjectInstanceBlockStore())!function(e){const{environment:t,unfurlResponse:n,url:o,externalObjectInstanceBlockStore:i}=e,a=i.pointer.spaceId;if(!t.currentUser.id)return;const s=(0,l.x$)(o),{host:c}=(0,M.Qc)(s);if(!c)return;if("collectionId"in n)return;const u=i.getFormat().related_external_object_uris_to_instance_ids,p=(0,P.m8)(Object.entries(u||{}).map((e=>{let[t,n]=e;return[t,J.G.createChildStore(i,{id:n,table:v.iU,spaceId:i.getSpaceId()})]})));L.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstanceFromInitialUnfurl",environment:t,perform:e=>{const s=(0,P.m8)(m.oA(n.relations.map((n=>{var o;if(n.external_schema)return;const s=(null===(o=p[n.uri])||void 0===o?void 0:o.id)||(0,g.ZP)(),l=new J.G(t,{table:v.iU,id:s,spaceId:a}),c=n,d={id:l.id,type:r.Ti.externalObjectInstance,space_id:a,parent_table:v.iU,parent_id:i.id,alive:!0,format:c};return B.sW({store:l,data:d,transaction:e}),[n.uri,l.id]})))),l=i.getFormatStore().getValue();let c,u;if(l&&(c=l.block_width,u=l.block_height),!c&&!u){const e=(0,d.o)(n.root.attributes,(0,N.o$)());e&&(c=e.block_width,u=e.block_height)}B.sW({store:i.getFormatStore(),data:{...{...n.root,block_width:c,block_height:u,external_schema:void 0,integration_id:null,original_url:o,is_placeholder:null,error:n.root.error??null},related_external_object_uris_to_instance_ids:s},transaction:e})}})}({environment:t,unfurlResponse:u,url:n,externalObjectInstanceBlockStore:a}),function(e){const{environment:t,url:n,spaceId:o,status:i}=e,r=(0,N.GQ)(n,o),a=(0,l.x$)(n),s=(0,M.Qc)(a);r&&s.host&&oe.Mp(t,{integrationId:r.integration.id,type:"preview",entity:r.pattern.name,domain:s.host,from:"link_preview_placeholder",...i&&{status:i}})}({environment:t,url:n,spaceId:a.getSpaceId(),...u&&{status:u.root.error?"failure":"success"}});else{if(!a.isCollectionView()){if(a.isExternalObjectInstancePageBlockStore())return;throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${a.getType()}`)}{const e=a.getCollectionViewSourceCollectionStore();if(!e)throw new Error("Could not find collection store.");L.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:o=>{ke({environment:t,unfurlResponse:u,url:n,externalCollectionStore:e,externalCollectionViewBlockStore:a,transaction:o})}})}}}async function _e(e){const{environment:t,url:n,botIds:o,userDefinedExternalCollectionStore:i,relatedPageId:a}=e,s=i.getFormat();if(!s.uri||void 0!==s.external_object_id)return;te.Z.add(n);const c=await ie.unfurlUrl(t,{url:n,botIds:o,spaceId:i.getSpaceId(),targetCollectionId:i.id,relatedPageId:a});if("failed"===c.type)return void se.showError(c);te.Z.delete(n);const d=c.data;let u;return"pageId"in d&&d.pageId?u=new J.G(t,{table:v.iU,id:d.pageId,spaceId:i.getSpaceId()}):(u=new J.G(t,{table:v.iU,id:(0,g.ZP)(),spaceId:i.getSpaceId()}),function(e){const{environment:t,unfurlResponse:n,url:o,rootUserDefinedExternalCollectionStore:i,rootExternalObjectInstancePageStore:a}=e,s=i.pointer.spaceId;if(!t.currentUser.id)return;const c=(0,l.x$)(o),{host:d}=(0,M.Qc)(c);if(!d)return;if(!n.root.external_object_id)return;const u=n.root;L.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstancePageFromInitialUnfurl",environment:t,perform:e=>{const t={id:a.id,type:r.Ti.externalObjectInstancePage,space_id:s,parent_table:y.v,parent_id:i.id,alive:!0,format:u};B.sW({store:a,data:t,transaction:e})}})}({environment:t,unfurlResponse:d,url:n,rootUserDefinedExternalCollectionStore:i,rootExternalObjectInstancePageStore:u})),u}async function we(e){const{environment:t,url:n,botIds:o,externalCollectionStore:i,externalCollectionViewBlockStore:r}=e;te.Z.add(n);const a=await ie.unfurlUrl(t,{url:n,botIds:o,spaceId:re.Bs()});te.Z.delete(n);const s="success"===a.type?a.data:{root:{error:{status_code:a.status}},relations:[]};L.createAndCommit({userAction:"unfurlingActions.startUnfurlRequestForCollection",environment:t,perform:e=>{ke({environment:t,unfurlResponse:s,url:n,externalCollectionStore:i,externalCollectionViewBlockStore:r,transaction:e})}})}function ke(e){const{environment:t,unfurlResponse:n,url:o,externalCollectionStore:i,externalCollectionViewBlockStore:r,transaction:c}=e,d=(0,l.x$)(o),{host:u}=(0,M.Qc)(d);if(!u)return;const{external_object_id:p,uri:f,bot_id:h}=n.root;if(!p||!f||!h)return;const b=m.w6(T.wh).map((()=>new J.NW(t,{table:y.v,id:(0,g.ZP)(),spaceId:r.pointer.spaceId}))),S={};n.relations.forEach(((e,t)=>{const n=b[t],o=e,a={id:n.id,version:0,space_id:(0,k.C)(r.pointer.spaceId),parent_table:y.v,parent_id:i.id,alive:!0,format:o,schema:{}};S[e.uri]=n.id,B.sW({store:n,data:a,transaction:c})}));const _={id:i.id,version:0,space_id:(0,k.C)(r.pointer.spaceId),parent_table:v.iU,parent_id:r.id,alive:!0,format:{original_url:d,domain:u,...n.root,property_visibility:(w=n.root.external_schema,w&&Object.keys(w).flatMap((e=>(0,a.HF)(e)?[]:{property:`${s.UU}${e}`,visibility:"hide_if_empty"}))),related_external_object_uris_to_instance_ids:{...S},is_placeholder:void 0,integration_id:void 0},schema:{}};var w;B.sW({store:i,data:_,transaction:c})}async function Ie(e){const{environment:t}=e,{externalObjectInstanceBlockPointersMap:n,externalCollectionInstancePointersMap:o}=Q.Z.state;await ie.refetchExternalObjectInstanceBlocks(t,{recordPointers:[...Object.values(n),...Object.values(o)]}),Q.Z.reset()}async function Ce(e){const{environment:t,externalAuthenticationValue:n}=e;let o=await ie.getExternalIntegrationAccessToken(t,{botId:n.id,integrationId:n.integration_id,spaceId:n.space_id});if("failed"===o.type){const e=$.Z.integrations.state.find((e=>e.id===n.integration_id));if(!e)return;ue.oV({label:H.default.formatMessage(pe.userReAuth)}),await le.hM({environment:t,integration:e,spaceId:n.space_id,from:"integration_file_picker"});const i=$.Z.bots.state.filter((e=>e.integration_id===n.integration_id))[0];if(!i)return;o=await ie.getExternalIntegrationAccessToken(t,{botId:i.id,integrationId:i.integration_id,spaceId:i.space_id})}return o}function xe(e){const{integration:t}=e;return t.id===c.YM&&"on"===U.default.getEligibleGroup({experimentId:"box_file_picker",defaultGroup:"control"})?Te({integrationType:"box",...e}):t.id===c.f3&&(0,z.qH)()?Te({integrationType:"drive",...e}):void 0}function Te(e){const{integrationType:t,integration:n}=e;return"box"===t?{type:t,title:H.default.formatMessage(pe.browse,{appName:n.name}),accounts:$.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===n.id})),onSelect:Me(e)}:"drive"===t?{type:t,title:H.default.formatMessage(pe.browse,{appName:n.name}),accounts:$.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===n.id})),onSelect:Me(e)}:void 0}function Me(e){const{integration:t,environment:n,externalObjectTokenStore:o,externalObjectInstanceBlockStore:i}=e;return async e=>{let r=e?e.id:void 0;if(!e){const{currentSpaceStore:e}=K.default.state,o=$.Z.integrations.state.find((e=>{let{id:n}=e;return n===t.id}));if(o&&e){const i=$.Z.bots.state;await le.hM({environment:n,integration:o,spaceId:e.id,from:"integration_file_picker"});const a=function(e,t){const n=$.Z.bots.state;var o;if(e.length!==n.length)return null===(o=n.filter((e=>e.integration_id===t))[0])||void 0===o?void 0:o.id}(i,t.id);a&&(r=a)}}const a=$.Z.externalAuthentications.state.find((e=>e.id===r));if(a){const e=await async function(e,t,n,o,i){if(!$.Z.state.loaded)return;i.setState({error:!1,loading:!0});const r=await Ce({environment:e,externalAuthenticationValue:o});if(i.setState({error:!r||"success"!==r.type,loading:!1}),r&&"failed"!==r.type)return r.data;se.showDialog({message:H.default.formatMessage(pe.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:H.default.formatMessage(pe.copyDebuggingInformation),color:void 0,onAccept:()=>{const t={statusCode:null==r?void 0:r.status,integrationId:n.id,botId:o.id};R.RD({environment:e,stringValue:JSON.stringify(t,null,2),copiedMessage:pe.copiedDebuggingInfo})}}]})}(n,0,t,a,o);e&&(ce.Z(),await function(e){const{integration:t,tokenDetails:n,environment:o,externalObjectInstanceBlockStore:i,botId:r}=e;if(t.id===c.YM)return async function(e,t){const{access_token:n}=e;try{await(0,V.ZP)("https://cdn01.boxcdn.net/polyfills/core-js/2.5.3/core.min.js",{resourceType:V._g.Javascript});const e=[{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.js",resourcetype:V._g.Javascript},{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.css",resourcetype:V._g.Stylesheet}];await Promise.all(e.map((e=>{let{url:t,resourcetype:n}=e;return(0,V.ZP)(t,{resourceType:n})})))}catch(a){return void t(!0,"")}const o=document.createElement("div");o.setAttribute("id","box-app-container"),document.body.appendChild(o);const i=new Box.FilePicker;i.show("0",n,{size:"small",container:"#box-app-container",maxSelectable:1,logoUrl:"box"});const r=()=>{i.hide(),o.remove()};i.addListener("choose",(function(e){var n;const o=null==e||null===(n=e[0])||void 0===n?void 0:n.id;o&&t(!1,`https://app.box.com/file/${o}`),r()})),i.addListener("cancel",r)}(n,Pe({environment:o,externalObjectInstanceBlockStore:i,botId:r}));if(t.id===c.f3)return(0,z.vE)({environment:o,accessToken:n.access_token,callback:Pe({environment:o,externalObjectInstanceBlockStore:i,botId:r}),integration:t,from:"link_preview_placeholder"});return void t.id}({integration:t,environment:n,externalObjectInstanceBlockStore:i,externalObjectTokenStore:o,botId:a.id,tokenDetails:e}))}}}function Pe(e){const{environment:t,externalObjectInstanceBlockStore:n,botId:o}=e;return(e,i)=>{if(e)return se.showDialog({message:H.default.formatMessage(pe.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:H.default.formatMessage(pe.copyDebuggingInformation),color:void 0,onAccept:()=>{const n={err:e,botId:o};R.RD({environment:t,stringValue:JSON.stringify(n,null,2),copiedMessage:pe.copiedDebuggingInfo})}}]});Re({environment:t,externalObjectInstanceBlockStore:n,url:i,botId:o})}}function Ae(e){const{environment:t,originRect:n,externalObjectInstanceBlockStore:o,integration:i}=e,r=[{type:"embed",onChange:n=>{Re({environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:e.placeholderIntegrationId}),ce.Z()}}];if(U.default.checkGate("ai_source_picker")&&((null==i?void 0:i.id)===c.Gw||(null==i?void 0:i.id)===c.mC)){const n=(null==i?void 0:i.id)===c.Gw?"/images/external_integrations/github-icon.png":"/images/external_integrations/jira-icon.png";r.push({type:"aiSourcePicker",integration:null==i?void 0:i.id,defaultAvatar:n,onChange:n=>{Re({environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:e.placeholderIntegrationId}),ce.Z()},getResults:async(e,n)=>await async function(e){const{environment:t,query:n,integrationId:o,botId:i}=e,r=i?[i]:$.Z.bots.state.filter((e=>e.integration_id===o)).map((e=>{let{id:t}=e;return t}));if(0===r.length)return{root:{error:{status_code:500,messages:["No bot found for this integration"]}},relations:[]};return await async function(e){const{environment:t,query:n,botIds:o}=e,i=await ie.aiSourcePicker(t,{query:n,botIds:o,spaceId:re.Bs()}),r="success"===i.type?i.data:{root:{error:{status_code:i.status}},relations:[]};return"failed"===i.type&&se.showError(i),r}({environment:t,query:n,botIds:r})}({environment:t,query:e,integrationId:n})})}if(i&&!t.device.isMobile){const n=xe({integration:i,environment:t,externalObjectInstanceBlockStore:o,externalObjectTokenStore:e.externalObjectTokenStore});n&&r.push(n)}ce.$(t,{originGap:0,originRect:n,title:"Embed Link Preview",currentTab:"embed",tabs:r})}function Re(e){const{environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:i,botId:r}=e,a=(0,T.ny)({url:n,integrations:$.Z.integrations.state,currentSpaceId:o.getSpaceId()});if("success"===a.type){const{integration:e,pattern:i}=a,s=r?[r]:$.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t}));if(s.length>0){const r=o.getParentId(),a=(0,l.x$)(n),{host:c}=(0,M.Qc)(a);if(c&&r){const a={...Fe({externalObjectInstanceBlockStore:o,parentId:r}),format:{original_url:n,domain:c}};L.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{B.sW({store:o,data:a,transaction:e})}}),oe._xm(t,{integrationId:e.id,entity:i.name,domain:c,from:"placeholder"})}Se({environment:t,url:n,botIds:s,integrationId:e.id,externalObjectInstanceBlockStore:o})}else L.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{B.sW({store:o.getFormatStore(),data:{integration_id:null,original_url:n,is_placeholder:null},transaction:e})}})}else if("partial"===a.type){const{integration:e}=a;L.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:t=>{B.sW({store:o.getFormatStore(),data:{is_placeholder:null,integration_id:e.id,original_url:n,error:{status_code:p.Rl.UNPROCESSABLE_ENTITY}},transaction:t})}})}else"failure"===a.type?L.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{B.sW({store:o.getFormatStore(),data:{is_placeholder:null,original_url:n,integration_id:i,error:{status_code:p.Rl.UNPROCESSABLE_ENTITY}},transaction:e})}}):(0,x.t1)(a)}function De(e){const{environment:t,block:n,transaction:o}=e;if(!n.isDefined()||!ne.M_(t)||!n.isType(r.Ti.externalObjectInstance))return;const i=(0,g.ZP)(),a={id:i,type:r.Ti.externalObjectInstance,parent_id:n.id,parent_table:n.table,space_id:n.getSpaceId(),alive:!0,format:n.getFormat()};B.ae({environment:t,table:v.iU,value:a,inMemoryRecordCache:n.inMemoryRecordCache,transaction:o});const s=n.getFormatStore().getKeyStore("related_external_object_uris_to_instance_ids").getValue();if(s)for(const r of Object.values(s)){const e={table:v.iU,id:r,spaceId:n.getSpaceId()};L.applyOperation({store:(0,J.Kv)(n,e),operation:{pointer:e,path:[],command:"update",args:{parent_table:v.iU,parent_id:i}},transaction:o})}const l=[(0,C.YCD)((0,C.x36)(i))];B.sO({store:n,value:{type:r.Ti.text,properties:{title:l},format:null},transaction:o})}function Be(e){var t;const{block:n,transaction:o,token:i,parentStore:r}=e,{tokenIndex:a}=i;if(!n.isDefined())return;const s=null===(t=r.getParentBlockStore())||void 0===t?void 0:t.getContentStore();if(!s)return;F.gy({block:r,transaction:o,tokenIndex:a})&&D.BE({parent:s,insert:n,after:r,transaction:o})}function Ee(e){const{environment:t,spaceId:n,from:o,store:i,bypassCache:r}=e,a=(0,N.y6)(i),s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);if(!s)return;const l=(0,N.GQ)(s,n),d=(0,N.Ue)(s,n);if(!l||0===d.length)return;const u=i.getCollectionViewCollectionStore(),{integration:p,pattern:m}=l;i.isCollectionView()&&u?ie.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...u.pointer,spaceId:n}],bypassCache:r}):i.isExternalObjectInstancePageBlockStore()?c.tO.includes(p.id)?Se({environment:t,url:s,botIds:d.map((e=>{let{id:t}=e;return t})),integrationId:p.id,externalObjectInstanceBlockStore:i}):ie.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...i.pointer,spaceId:n}],bypassCache:r}):i.isExternalObjectInstanceBlockStore()&&Se({environment:t,url:s,botIds:d.map((e=>{let{id:t}=e;return t})),integrationId:p.id,externalObjectInstanceBlockStore:i}),oe.B3N(t,{integrationId:p.id,entity:m.name,from:o})}function Fe(e){const{externalObjectInstanceBlockStore:t,parentId:n}=e;return{id:t.id,version:0,type:r.Ti.externalObjectInstance,space_id:(0,k.C)(t.pointer.spaceId),parent_table:v.iU,parent_id:n,alive:!0}}},53471:(e,t,n)=>{n.d(t,{A3:()=>O,IL:()=>E,K_:()=>z,Q7:()=>F,W8:()=>N,Xo:()=>D,cR:()=>V,cT:()=>L,dm:()=>K,nQ:()=>R,y:()=>U});n(21703),n(57658);var o=n(15095),i=n(7406),r=n(68626),a=n(72126),s=n(29477),l=n(4615),c=n(149),d=n(53770),u=n(23867),p=n(70203),m=n(63143),f=n(5366),g=n(91754),h=n(33954),v=n(33929),b=n(52533),y=n(2414),S=n(77080),_=n(73329),w=n(89087),k=n(91551),I=n(88923),C=n(78291),x=n(88893),T=n(50906),M=n(54642),P=n(35253);const A=(0,f.defineMessages)({uploadFileFailed:{defaultMessage:"Upload failed.",id:"uploadActions.uploadFailedError.message"}});function R(e){return e.filter((e=>e.getAlive())).map((e=>{const{source:t,title:n,size:o}=e.getProperties()||{};return{type:"remote",id:e.id,source:p.QaF(t),name:p.QaF(n),size:p.QaF(o),store:e}}))}function D(e){return{...B(e),id:(0,l.ZP)(),dataURL:URL.createObjectURL(e),type:"local"}}function B(e){return{file:e,name:e.name,size:`${(e.size/1024).toFixed(1)}KB`}}function E(e){var t;const n=e.files.map(B);null===(t=e.onBatchStart)||void 0===t||t.call(e,n);const o={};let r=0;s.dC(e.files,W,(t=>Promise.all(t.map((t=>{const n=(0,l.ZP)();return new Promise(((s,l)=>{const u={environment:e.environment,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},file:t,onStart:t=>{var o;null===(o=e.onSingleFileStart)||void 0===o||o.call(e,t,n)},onProgress:t=>{var o,i;let{progressPercent:a,uploadedFiles:s}=t;null===(o=e.onBatchProgress)||void 0===o||o.call(e,{progressPercent:a,uploadedFiles:r}),null===(i=e.onSingleFileProgress)||void 0===i||i.call(e,{progressPercent:a,uploadedFiles:s},n)},onComplete:i=>{var a;r++,o[t.name]=i,null===(a=e.onSingleFileComplete)||void 0===a||a.call(e,i,n),s()},onError:t=>{var o;const i=new Error(t.message);null===(o=e.onSingleFileError)||void 0===o||o.call(e,i,n),l(i)},preventLimitFreeFileSize:e.preventLimitFreeFileSize};"confluence"===e.uploadType?async function(e){const{environment:t,file:n,preventLimitFreeFileSize:o}=e,r=n.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:o,environment:t,file:n})){var s;null===(s=e.onStart)||void 0===s||s.call(e,B(n));const o=Math.floor(n.size/Z)+1,f={bucket:e.bucket,name:n.name,contentType:r,supportExtraHeaders:!0,contentLength:n.size,numberOfFileChunks:o},g=await M.initiateMultipartUpload(t,f);var l;if("failed"===g.type)return void(null===(l=e.onError)||void 0===l||l.call(e,{message:g.error.message,offline:g.offline}));const h=await async function(e){const{file:t,signedUrlsForChunks:n}=e,o=[];let r,s,l,c=[];const u=[];for(let i=0;i<n.length;i++){r=i*Z,s=(i+1)*Z,l=i+1<n.length?t.slice(r,s):t.slice(r);const e=n[i],a=fetch(e,{method:"PUT",body:new Blob([l],{type:t.type})});o.push(a)}const p=a.yo(o,3);for(const[a,g]of p.entries()){var m;try{const e=await(0,d.Yb)((()=>Promise.all(g)),[100,1e3,3e3]);c=[...c,...e]}catch(f){return{error:(0,i.tg)(f)}}null===(m=e.onProgress)||void 0===m||m.call(e,{progressPercent:Math.floor(a/p.length*100),uploadedFiles:0})}return c.forEach(((e,t)=>{const n=e.headers.get("etag");n&&u.push({ETag:n,PartNumber:t+1})})),{value:u}}({file:n,signedUrlsForChunks:g.data.signedUrlsForChunks,onProgress:e.onProgress});var u;if(c.x.isFail(h))return void(null===(u=e.onError)||void 0===u||u.call(e,{message:h.error.message,offline:void 0}));const v={...f,multipartUploadEtags:h.value,fileKey:g.data.key,uploadId:g.data.uploadId},b=await M.completeMultipartUpload(t,v);var p,m;if("success"===b.type)null===(p=e.onComplete)||void 0===p||p.call(e,g.data.url);else null===(m=e.onError)||void 0===m||m.call(e,{message:b.error.message,offline:b.offline})}else O(e.environment)}(u):j(u)}))}))))).then((()=>{var t;const n=e.files.map((e=>o[e.name]));null===(t=e.onBatchComplete)||void 0===t||t.call(e,n)})).catch((t=>{var n;"confluence"===e.uploadType&&T.a1y(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:t,fileSize:e.files[0].size},flowId:e.flowId}),null===(n=e.onBatchError)||void 0===n||n.call(e,t)}))}function F(e){const{preventLimitFreeFileSize:t,environment:n,file:o}=e,{data:i}=C.default.state;let r=!1;if(n.device.isMobileNative){const e="personal"===x.M9(n);r=!((0,b.S$)({environment:n})&&e)}return!(!t&&i&&x.Bu(i)&&!r&&o.size>H)}const Z=20971520;function L(e){const{retryWhenOffline:t,backoffController:n=new y.h(void 0)}=e;j({...e,onComplete:t=>{var o;n.getFailures()>0&&S.default.logEvent("upload_offline_success_after_retries",n.getFailures()),null===(o=e.onComplete)||void 0===o||o.call(e,t)},onError:o=>{var i;if(t&&o.offline){if(S.default.checkGate("autoretry_file_uploads"))return void n.backOffOnFailure(10*m.C0).then((()=>{L({...e,backoffController:n})}));S.default.logEvent("upload_offline_failure")}null===(i=e.onError)||void 0===i||i.call(e,o)}})}async function j(e){const{environment:t,file:n,preventLimitFreeFileSize:o}=e,i=n.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:o,environment:t,file:n})){e.onStart&&e.onStart(B(n));const o="secure"===e.bucket?{bucket:e.bucket,name:n.name,contentType:i,record:{table:e.record.table,id:e.record.id,spaceId:(0,u.C)(e.record.spaceId)},supportExtraHeaders:!0,contentLength:n.size}:{bucket:e.bucket,name:n.name,contentType:i,supportExtraHeaders:!0,contentLength:n.size};"secure"===e.bucket&&await w.transactionQueue.awaitRecordTransaction(e.record);const a=await M.getUploadFileUrl(t,o);if("success"===a.type){const{url:t,signedPutUrl:o,putHeaders:l}=a.data,c=s.UZ(),d=new XMLHttpRequest;d.open("PUT",o),d.setRequestHeader("Content-type",i);for(const e of l)d.setRequestHeader(e.name,e.value);d.upload.addEventListener("progress",(t=>{if(t.lengthComputable){const n=Math.round(100*t.loaded/t.total);e.onProgress&&e.onProgress({progressPercent:n,uploadedFiles:0})}})),d.onreadystatechange=function(){4===d.readyState&&(200===d.status?c.resolve({value:t}):(r.log({level:"error",from:"uploadActions",type:"ClientUploadError",data:{miscDataToConvertToString:{status:d.status,responseText:d.responseText}}}),c.resolve({error:{message:v.default.formatMessage(A.uploadFileFailed),offline:0===d.status}})))},d.send(n);const u=await c.promise;u.error?e.onError&&e.onError(u.error):e.onComplete&&(e.onComplete(t),r.log({level:"info",from:"uploadActions",type:"ClientUploadSuccess",data:{miscDataToConvertToString:{url:t}}}))}else if(e.onError){const t=(0,h.wf)(v.default.getIntl(),a);e.onError({message:t,offline:a.offline})}}else O(e.environment)}function V(e){G({...e,onChange:t=>{if(!t.files||0===t.files.length)return;const n=Array.from(t.files);E({environment:e.environment,files:n,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},onBatchStart:e.onStart,onBatchProgress:e.onProgress,onBatchComplete:e.onComplete,onBatchError:e.onError,preventLimitFreeFileSize:e.preventLimitFreeFileSize})}})}async function U(e){const t=s.UZ();return G({...e,onChange:e=>{const n=o.p4(e.files);t.resolve(n)}}),t.promise}function O(e){P.Bw({bannerStore:I.default.state.open?k.Z:_.Z,id:"SubscriptionEditingBlocker",styleKey:g.v.Red,contentKey:"upload_limit_exceeded"})}function N(){P.qL({bannerStore:_.Z,id:"SubscriptionEditingBlocker"}),P.qL({bannerStore:k.Z,id:"SubscriptionEditingBlocker"})}const z=5,H=1e6*z,W=5;let q;const G=function(e){q&&q.remove(),q=document.createElement("input"),q.type="file",q.style.opacity="0",q.style.pointerEvents="none",q.style.position="fixed",q.style.left="-1000px",q.style.top="-1000px",q.ariaHidden="true",document.body.appendChild(q),e.multiple?q.setAttribute("multiple",""):q.removeAttribute("multiple"),e.accept&&q.setAttribute("accept",e.accept),q.addEventListener("change",(()=>{e.onChange&&e.onChange(q)})),q.addEventListener("blur",(()=>{e.onBlur&&e.onBlur(q)})),q.addEventListener("click",(e=>{e.stopPropagation()})),q.click(),q.focus({preventScroll:!0})};function K(e){return e.filter($).map((e=>e.file))}function $(e){return"local"===e.type}},70782:(e,t,n)=>{n.d(t,{f:()=>y,x:()=>b});var o=n(87997),i=n(15145),r=n(9852),a=n(54153),s=n(12955),l=n(87381),c=n(32223),d=n(55081),u=n(75538),p=n(80444),m=n(77080),f=n(35661),g=n(90287),h=n(97977),v=n(75018);async function b(e){const{newCurrentUserId:t,loggedOutUserId:n,environment:i}=e;await h.setLocalStorageUserId(i,t),(0,r.setSessionUserId)(t),await s.setCookie(i,{name:"notion_user_id",value:t});const p=i.currentUser.loggedInUserIds.filter((e=>e!==n)),f=await s.getGhostAdminUserId(i),v={...i,currentUser:new o.CurrentUser({id:t,loggedInUserIds:p,adminUserId:f})};if(i.updateCurrentUserId){const e={environment:i,currentUserId:t,userIds:p};"on"!==m.default.getGroup("await-update-user-id")?await i.updateCurrentUserId(e):i.updateCurrentUserId(e)}a.Z.set(l.currentUserIdKey,t),c.resetRecordSubscriptions(),u.default.reset();return await d.zJ(i)&&d.yH(v),await g.KJ(v,t),v}async function y(e){const{newCurrentUserId:t,environment:n,store:o}=e,{mainEditorCurrentBlockStore:r}=p.default.state,a=await b({environment:n,newCurrentUserId:t});if(r){const e=new f.G(a,o.pointer);p.default.setState({...p.default.state,mainEditorCurrentBlockStore:void 0}),v.navigateToBlock({environment:a,store:e,pageVisitSource:i.tY.SwitchSpace})}}},12321:(e,t,n)=>{n.d(t,{j:()=>g,w:()=>h});n(21703),n(57658);var o=n(45953),i=n(21202),r=n(15047),a=n(77858),s=n(66079),l=n(45950),c=n(5659),d=n(88310),u=n(88632),p=n(29226),m=n(54642),f=n(4408);function g(e,t){!function(){v&&u.Z.removeListener(v);p.Z.reset()}(),async function(e,t){try{const n=await c.A.measure("loadUserContent","(current user)",(()=>async function(e){const{defaultRecordCache:t,currentUser:n}=e;if(!t.persistedRecordCache)throw new Error("No local database found.");const o=n.id;if(!o)throw new Error("User is not logged in.");const i=[],c=await l.yY({environment:e,recordPointers:[{table:s.dx,id:o}],recurFn:e=>{const t=[],n=e=>{e&&(e.table!==a.zU&&e.table!==s.dx||i.push(e),t.push(e))};return e.table===s.dx?(n(e.getUserPointer()),e.getSpaceViewPointers().forEach(n)):e.table===a.zU?(e.getBookmarkedPagePointers().forEach(n),e.getSharedPagePointers().forEach(n),n(e.getSpacePointer())):e.table===r.bx&&e.getPagePointers().forEach(n),t},recordIsRequired:e=>e.table===s.dx||e.table===a.zU});for(const r of i){const e=c.getModel(r);if(c.getRole(r)&&!e)throw new Error(`Not defined: ${r.table}, ${r.id}`)}return{recordMap:c.toJson({allowVersionDowngrade:!1})}}(e))),i=o.PF.create(n.recordMap);f.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:i,debugSource:"fetchLocalUserContent"}),p.Z.setState({...p.Z.state,localSpaceInaccessiblePages:y(i,t)}),p.Z.state.readyPromise.resolve()}catch(n){}}(e,t),b(e);let n=u.Z.state.online;v=()=>{const t=u.Z.state.online;!t||n||p.Z.state.remoteSpaceInaccessiblePages||b(e),n=t},u.Z.addListener(v)}async function h(){await p.Z.state.readyPromise.promise}let v;async function b(e){d.$L("await_get_spaces_start");const t=await m.getSpaces(e,{},void 0,void 0,void 0,"getSpaces");d.$L("await_get_spaces_end");const n=e.currentUser.id;if("success"===t.type)for(const[i,r]of Object.entries(t.data)){const t=o.PF.create(r);f.fL({environment:e,userId:i,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:t,debugSource:"fetchAllUserSpaces"}),i===n&&(p.Z.setState({...p.Z.state,remoteSpaceInaccessiblePages:y(t,i)}),p.Z.state.readyPromise.resolve())}}function y(e,t){const n={};for(const{pointer:o}of e.getByTable(r.bx)){const a=o.id,s=e.getValue({table:r.bx,id:a});if(s){const o=new Set;if(s.pages){for(const t of s.pages){e.getValue({table:i.iU,id:t})||o.add(t)}n[t]||(n[t]={}),n[t][a]=o}}}return n}},39634:(e,t,n)=>{n.d(t,{j:()=>_,z:()=>w});var o=n(13991),i=n(24211),r=n(7250),a=n(7928),s=n(88642),l=n(75018),c=n(24215),d=n(28020),u=n(79897),p=n(33929),m=n(5162),f=n(58455),g=n(80444),h=n(77080),v=n(78291),b=n(50906),y=n(54642),S=n(98958);function _(e){const{environment:t,from:n,prepopulatedContent:i}=e;b.Otz(t,{from:n});const a=(0,d.Fv)(),p=f.default.state;if(t.device.isMobileNative){const e=(0,d.B7)(t),n=`${t.device.os} v${t.device.mobileAppVersion}(${t.device.version})`,o="team@makenotion.com",i=`Help with my account ${null==e?void 0:e.getEmail()} on ${n}`,r=()=>{const e=encodeURIComponent(i);l.navigateToExternalURL({environment:t,url:`mailto:${o}?subject=${e}`})},a=t.mobileNative;a&&(0,m.Y)("supportsNativeSubmitUserFeedback")&&a.api.submitUserFeedback?a.submitUserFeedback({sendToEmailAddress:o,subject:i},r):r()}else if(p.isZendeskEnabled&&(0,c.Ug)()){const{userHighestPlanType:e,isSalesAssistedPlan:n}=(0,u.r)(t);(0,s.g)({locale:o.SP,analyticsSettings:p,isForethoughtEnabled:h.default.checkGate("forethought"),forethoughtInitializeArgs:w(),userHighestPlanType:e,isSalesAssistedPlan:n}),b.LSY(t)}else if(p.isIntercomEnabled){function e(){if(a&&a.id)return y.annotateRecentIntercomConversation(t,{page:a})}let n=0;const o=3,s=60;async function l(){n++;const t=await e();t&&"success"===t.type&&"not_found"===t.data.status&&n<o&&setTimeout(l,s)}r.Nv({prepopulatedContent:i,waitForCssInsets:()=>S.waitForCssInsets(t)}),setTimeout(l,1e3*s)}}function w(){var e,t,n;const o=p.default.getIntl(),r=null===(e=g.default.state.currentUserStore)||void 0===e?void 0:e.getValue(),s=r?(0,a.Nz)(o,r,!0):void 0,l=null===(t=v.default.state.data)||void 0===t?void 0:t.subscriptionTier,c=(null===(n=g.default.state.currentUserSettingsStore)||void 0===n||null===(n=n.getSettings())||void 0===n?void 0:n.preferred_locale)||i.al;return{fullName:s,email:null==r?void 0:r.email,planType:l,locale:c}}},1742:(e,t,n)=>{n.d(t,{BW:()=>f,GD:()=>m,sA:()=>g,uO:()=>v});n(57658);var o=n(68626),i=n(77897),r=n(63143),a=n(68056),s=n(77080),l=n(24666),c=n(50906);const d=15*r.C0,u={user_flow_edit_block:.005,user_flow_edit_page_title:.01,user_flow_create_block:.01,user_flow_delete_block:.01};function p(e){const t=u[e];if(void 0!==t)return(0,i.aw)(t);const n=s.default.getConfigKey("event_trail_events",e);if("object"==typeof n&&"number"==typeof n.sampleRate)return(0,i.aw)(n.sampleRate);const o=s.default.getConfigKey("event_trail_events","defaultSampleRateUserFlows");return"number"==typeof o&&(0,i.aw)(o)}class m{constructor(e){this.stage=void 0,this.timeout=void 0,this.error=void 0,this.logDataInCaseOfFailure=void 0,this.postFinishCallbacks=[],this.environment=void 0,this.userFlow=void 0,this.entryPointName=void 0,this.handleTimeout=()=>{this.fail("timeout")};const{environment:t,userFlow:n,entryPointName:o,timeoutMs:i}=e;this.environment=t,this.userFlow=n,this.entryPointName=o;e.isEnabled??p(n)?(this.stage="inProgress",this.timeout=window.setTimeout(this.handleTimeout,i??d),this.debugLog("constructed")):this.stage="disable"}isDisabled(){return"disable"===this.stage}updateLogDataInCaseOfFailure(e){this.logDataInCaseOfFailure={...this.logDataInCaseOfFailure,...e}}succeed(){"inProgress"===this.stage&&this.finish("success")}fail(e){"inProgress"===this.stage&&(this.error=e,this.finish("fail"))}finish(e){this.stage=e,this.debugLog("finish"),"number"==typeof this.timeout&&window.clearTimeout(this.timeout),this.timeout=void 0,c.rTg(this.environment,this.userFlow,{status:e,error:this.error,entryPointName:this.entryPointName}),"fail"===e&&o.log({level:"error",from:"userFlowActions",type:"userFlowFailed",data:{userFlow:this.userFlow,userFlowEntrypointName:this.entryPointName,userFlowError:this.error,...this.logDataInCaseOfFailure}});for(const t of this.postFinishCallbacks)t()}debugLog(){}}class f extends m{constructor(e){super(e),this.pointer=void 0,this.succeedOnEnqueue=void 0,this.trackCallbacks=[];const{succeedOnEnqueue:t}=e;this.succeedOnEnqueue=t}track(e,t){if("inProgress"===this.stage&&void 0===this.pointer){this.pointer=e,h({tracker:this,transaction:t,succeedOnEnqueue:this.succeedOnEnqueue});for(const e of this.trackCallbacks)e();this.debugLog("track",e.id)}}}class g extends f{constructor(e,t){super({environment:e,userFlow:"user_flow_create_page",entryPointName:t,succeedOnEnqueue:!1}),this.handleTextSelectionChange=e=>{"inProgress"===this.stage&&this.pointer&&"editing"===e.state.mode&&(0,a.qS)(e.state.multiSelection)&&e.state.multiSelection.start.store.pointer.id===this.pointer.id&&this.succeed()},"inProgress"===this.stage&&this.trackCallbacks.push((()=>{l.default.addListener(this.handleTextSelectionChange),this.postFinishCallbacks.push((()=>{l.default.removeListener(this.handleTextSelectionChange)}))}))}}function h(e){const{tracker:t,transaction:n,succeedOnEnqueue:o}=e;"inProgress"===t.stage&&(t.updateLogDataInCaseOfFailure({transactionId:n.id,transactionUserAction:n.getUserActionForAnalyticsPurposesOnly()}),n.annotateWithUserFlow(t.userFlow),n.postCancelCallbacks.push((()=>{t.fail("cancelled_transaction")})),n.postEnqueueActions.push((()=>{n.isEmpty()?t.fail("empty_transaction"):o&&t.succeed()})))}function v(e,t,n,o){if(!p(t))return;h({tracker:new m({environment:e,userFlow:t,isEnabled:!0,entryPointName:o}),transaction:n,succeedOnEnqueue:!0})}},37181:(e,t,n)=>{n.d(t,{$n:()=>k,GK:()=>S,Kq:()=>I,Nb:()=>b,Qm:()=>w,Zf:()=>h,d2:()=>g,dM:()=>_,fG:()=>f,rx:()=>v,zq:()=>y});n(57658);var o=n(79946),i=n(42875),r=n(95477),a=n(15010),s=n(95697),l=n(80444),c=n(35661),d=n(75769),u=n(50906),p=n(9953),m=n(39699);async function f(e){if(!r.default.isAdminMode)return;const{currentUserSettingsStore:t}=l.default.state;if(!t)return;await t.load();const n=t.getSettings();if(!n)return;const{device:o}=e,a={};(0,i.r)()!==n.time_zone&&(a.time_zone=(0,i.r)()),o.isDesktopBrowser&&!n.used_desktop_web_app&&(a.used_desktop_web_app=!0),o.isMobileBrowser&&!n.used_mobile_web_app&&(a.used_mobile_web_app=!0),o.isElectron&&o.isMac&&!n.used_mac_app&&(a.used_mac_app=!0),o.isElectron&&o.isWindows&&!n.used_windows_app&&(a.used_windows_app=!0),o.isMobileNative&&o.isIOS&&!n.used_ios_app&&(a.used_ios_app=!0),o.isMobileNative&&o.isAndroid&&!n.used_android_app&&(a.used_android_app=!0),Object.keys(a).length>0&&m.createAndCommit({userAction:"userSettingsActions.updateUserSettingsOnReset",environment:e,perform:e=>{g({userSettingsStore:t,data:a,transaction:e})}})}const g=function(e){const{userSettingsStore:t,data:n,transaction:o}=e;p.sW({store:t.getSettingsStore(),data:n,transaction:o})};function h(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToMonday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&g({userSettingsStore:t,data:{start_day_of_week:1},transaction:e})}})}function v(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToSunday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&g({userSettingsStore:t,data:{start_day_of_week:0},transaction:e})}})}function b(e){const{transaction:t,userSettingsStore:n,spaceId:o,type:i}=e;p.sO({store:(0,c._J)(n,n.pointer,["settings","sidebar_outliner_settings",o,i,"has_pinned"]),value:!0,transaction:t})}function y(e){var t;const n=null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=l.default.state.currentUserSettingsStore;if(n&&o){var i;const t=(null===(i=o.getSettings())||void 0===i?void 0:i.lastUsedTypedDatabases)||{},r=t[n]||{};g({userSettingsStore:o,transaction:e.transaction,data:{lastUsedTypedDatabases:{...t,[n]:{...r,[e.dbType]:e.collectionId}}}})}}function S(e){const{transaction:t,userSettingsStore:n,integrationId:o}=e;p.sO({store:(0,c._J)(n,n.pointer,["settings","dismissed_link_preview_integration_popup",o]),value:!0,transaction:t})}function _(e,t){const n=(0,o.SY)(),i=(0,o.Q3)();if(!n||!i)return;const r={};i&&(r.fbp=i),n&&(r.click_ids=n),m.createAndCommit({userAction:"userSettingsActions.persistAdClick",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{e||((0,o.iI)(),(0,o.HR)())})),g({userSettingsStore:t,data:r,transaction:e})}})}function w(e){const t=l.default.state.currentUserSettingsStore;if(!t)return;const n=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();Boolean(n)||m.createAndCommit({userAction:"dismissShareButtonTooltip",environment:e,userId:t.id,perform:e=>{g({userSettingsStore:t,data:{seen_share_button_tooltip_at:Date.now()},transaction:e})}})}function k(e){let{environment:t,teamId:n}=e;if(!d.Z.hasShownTootlip(n))return;if((0,s.wP)(t))return;const o=(0,a.WD)(t);if(!o)return!1;m.createAndCommit({userAction:"userSettingsActions.dismissTeamAddAppTemplateTooltip",environment:t,userId:o.id,perform:e=>{g({userSettingsStore:o,data:{seen_team_add_app_template_tooltip_at:Date.now()},transaction:e})}}),u.yeF(t,{from:"team_add_app_template"})}function I(e,t){const{phase:n,transactionUserAction:o,userSettingsStore:i}=t;m.createAndCommit({environment:e,userAction:o,perform:e=>{g({userSettingsStore:i,transaction:e,data:{enterprise_launch_modal_phase:n}})}})}},65452:(e,t,n)=>{n.d(t,{h:()=>g,l:()=>h});n(21703);var o=n(15157),i=n(72126),r=n(44615),a=n(29477),s=n(45953),l=n(21202),c=n(45950),d=n(5659),u=n(2688),p=n(92425),m=n(54642),f=n(4408);async function g(e){const{environment:t,userId:n,spaceId:o}=e,a=(0,r.NP)({userId:n,spaceId:o});if(!y||y!==a){let n;!function(e){b&&u.Z.removeListener(b,e)}(t);const o=(t,o)=>{void 0!==n&&n!==o&&h(e),n=o},r=i.P2(o,5e3);b=u.Z.addListener(a,r,void 0,t),y=a;if(!p.Z.getSharedPagesState(e))return h(e)}}async function h(e){const{environment:t,userId:n,spaceId:i}=e,r=p.Z.getSharedPagesState(e);if(r&&r.loadingDone)return r.loadingDone;const u=(0,a.UZ)();p.Z.setSharedPagesState({spaceId:i,userId:n,state:{currentPageIds:null==r?void 0:r.currentPageIds,loadingDone:u.promise}});try{const r=async function*(e,t,n){try{const n=await d.A.measure("loadUserSharedPages","(current user)",(()=>async function(e,t){const{id:n}=e.currentUser;if(!n)throw new Error("Must be logged in.");if(!e.defaultRecordCache.persistedRecordCache)throw new Error("No local database found.");const i=o.Z.get({userId:n,key:v({userId:n,spaceId:t.spaceId})})||void 0;if(!i)throw new Error("No local shared pages found.");const r=await c.yY({environment:e,recordPointers:i.map((e=>({table:l.iU,id:e}))),recurFn:()=>[],recordIsRequired:()=>!1});return{pages:i,recordMap:r.toJson({allowVersionDowngrade:!1})}}(e,{spaceId:t})));f.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:s.PF.create(n.recordMap),debugSource:"loadUserSharedPagesInSpace"}),yield n}catch(r){}const i=await m.getUserSharedPagesInSpace(e,{spaceId:t,includeDeleted:!0},n);"success"===i.type&&(e.defaultRecordCache.persistedRecordCache&&o.Z.set({userId:e.currentUser.id,key:v({userId:n,spaceId:t}),value:i.data.pages}),yield i.data)}(t,i,n);for await(const e of r)p.Z.setSharedPagesState({spaceId:i,userId:n,state:{currentPageIds:e.pages,loadingDone:u.promise}});const a=p.Z.getSharedPagesState(e);a&&a.currentPageIds?p.Z.setSharedPagesState({spaceId:i,userId:n,state:{currentPageIds:a.currentPageIds,loadingDone:void 0}}):p.Z.setSharedPagesState({spaceId:i,userId:n,state:void 0})}catch(g){p.Z.setSharedPagesState({spaceId:i,userId:n,state:void 0})}}function v(e){return`UserSharedPagesInSpace:${e.userId}:${e.spaceId}`}let b,y},9377:(e,t,n)=>{n.d(t,{E:()=>_,j:()=>w});var o=n(74487);const i=["2021-05-11","2021-05-13","2021-08-16","2022-02-22","2022-06-28"],r=i[i.length-1];o.literals(...i);var a=n(4615),s=n(77420),l=n(19889),c=n(35794),d=n(5366),u=n(50906),p=n(33929),m=n(80444),f=n(77080),g=n(35661),h=n(54642),v=n(47307),b=n(9953),y=n(39699);const S=(0,d.defineMessages)({webhookUrlError:{id:"webhookActions.webhookUrlError",defaultMessage:"Connection failed. Please wait and try again or try another URL."}});async function _(e){const{environment:t,integration:n,webhookUrl:o,webhookSecret:i,webhookSubscriptionId:d,onError:f,onSuccess:_=(()=>{})}=e,{currentUserRootStore:w,currentSpaceStore:k}=m.default.state;if(!w||!k)return{error:{success:!1}};if("failed"===(await h.testWebhookConnection(t,{integrationId:n.id,webhookUrl:o,webhookSecret:i||void 0})).type)return v.showErrorMessage(p.default.formatMessage(S.webhookUrlError)),{error:{success:!1}};const{serverCommitResult:I}=y.createAndCommit({userAction:"webhookActions.createWebhookSubscription",environment:t,perform:p=>{p.postSubmitCallbacks=[f];const h=Date.now(),v=k.id;if(e.webhookSubscriptionId){const e=m.default.state.currentSpaceStore,r=d&&e?g.n4.createChildStore(e,{id:d,table:c.b,spaceId:e.id}):void 0;if(r){const e=r.getWebhookUrl()!==o,a=r.getWebhookSecret()!==i;(e||a)&&(u.ASv(t,{integration_id:n.id,has_updated_webhook_url:e||void 0,has_updated_webhook_secret:a||void 0}),b.sW({transaction:p,data:{webhook_url:o,webhook_secret:i},store:r}))}}else{const e=a.ZP();b.ae({environment:t,table:s.cZ,value:{id:e,space_id:v,parent_id:k.id,parent_table:"space",type:"external",alive:!0,name:n.getName(),icon:n.getInfo().icon,integration_id:n.id,capabilities:n.getCapabilities(),created_at:h,last_edited_at:h,last_edited_by_id:w.id,created_by_id:w.id,created_by_table:l.KJ,last_edited_by_table:l.KJ},inMemoryRecordCache:k.inMemoryRecordCache,transaction:p}),b.ae({environment:t,table:c.b,value:{id:a.ZP(),bot_id:e,space_id:v,parent_id:k.id,api_version:r,webhook_url:o,webhook_secret:i,parent_table:"space",last_edited_time:h,last_edited_by_id:w.id,created_by_id:w.id,created_time:h,created_by_table:l.KJ,last_edited_by_table:l.KJ},inMemoryRecordCache:k.inMemoryRecordCache,transaction:p}),u.eRW(t,{integration_id:n.id,configuration_type:"manual"})}}});return await I,_(),{value:{success:!0}}}async function w(e){const t=f.default.checkGate("webhooks_beta"),{environment:n,spaceId:o}=e;if(!n.currentUser.isLoggedIn()||!t)return{webhookSubscriptionIds:[],recordMap:{}};const i=await h.getWebhookSubscriptions(n,{spaceId:o});if("failed"===i.type)throw v.showError(i),i;return i.data}},29919:(e,t,n)=>{n.d(t,{Cq:()=>M,Y:()=>T,Zi:()=>x});var o=n(41432),i=n(45433),r=n(46328),a=n(5366),s=n(4615),l=n(71644),c=n(21202),d=n(6287),u=n(13493),p=n(70203),m=n(52821),f=n(33929),g=n(45010),h=n(35661),v=n(1310),b=n(50906),y=n(45264),S=n(47307),_=n(9953),w=n(64964),k=n(39699),I=n(68422),C=n(73060);const x=(0,a.defineMessages)({home:{id:"wikiActions.collectionView.home",defaultMessage:"Home"},allPages:{id:"wikiActions.collectionView.allPages",defaultMessage:"All pages"},pagesIOwn:{id:"wikiActions.collectionView.pagesIOwn",defaultMessage:"Pages I own"},pagePropertyName:{id:"wikiActions.collectionView.pagePropertyName",defaultMessage:"Page"},ownerPropertyName:{id:"wikiActions.collectionView.ownerPropertyName",defaultMessage:"Owner"},tagsPropertyName:{id:"wikiActions.collectionView.tagsPropertyName",defaultMessage:"Tags"},tagsDesignValue:{id:"wikiActions.collectionView.tagsDesignValue",defaultMessage:"Design"},tagsOnboardingValue:{id:"wikiActions.collectionView.tagsOnboardingValue",defaultMessage:"Onboarding"},verificationPropertyName:{id:"wikiActions.collectionView.verificationPropertyName",defaultMessage:"Verification"},undoToast:{id:"wikiActions.convertToWiki.undo.toastMessage",defaultMessage:"Turned {pageName} into a wiki"}});function T(e){const{blocks:t,transaction:n,environment:a,source:y}=e,S=(0,s.ZP)(),I=t[0];if(!I||!I.isPageBlock())return;const T=I.getSpaceId(),P=(0,s.ZP)(),A=I.getFormat().page_icon,R=(0,l.ZP)(),D=r.k.Owner,B=(0,l.ZP)(),E=(0,l.ZP)(),F={title:{name:f.default.formatMessage(x.pagePropertyName),type:"title"},[D]:{name:f.default.formatMessage(x.ownerPropertyName),type:"person",default:"created_by"},[E]:{name:f.default.formatMessage(x.tagsPropertyName),type:"multi_select",options:[{id:(0,s.ZP)(),value:f.default.formatMessage(x.tagsOnboardingValue),color:"blue"},{id:(0,s.ZP)(),value:f.default.formatMessage(x.tagsDesignValue),color:"green"}]},[R]:{name:m.SO.last_edited_time,type:"last_edited_time",date_format:"relative"}},Z=[{visible:!0,property:"title",width:300},{visible:!0,property:D,width:150},{visible:!0,property:B,width:150},{visible:!0,property:E,width:150},{visible:!0,property:R,width:250}];F[B]={name:f.default.formatMessage(x.verificationPropertyName),type:"verification",verifier_property:D};const L={table:d.v,id:P,spaceId:T};k.applyOperation({store:(0,h.Kv)(I,L),operation:{pointer:L,command:"set",path:[],args:{id:P,version:0,parent_table:c.iU,parent_id:I.id,space_id:T,name:I.getTitleValue(),schema:F,cover:I.getFormat().page_cover,format:{...I.getFormat(),collection_mode:{type:"page_tree",root_page_pointer:{table:c.iU,id:I.id,spaceId:T}},app_config_uri:i.GZ,property_visibility:[{property:R,visibility:"hide"},{property:E,visibility:"show"},{property:D,visibility:"show"},{property:B,visibility:"show"}],collection_page_properties:Z,collection_cover_position:I.getFormat().page_cover_position},icon:A,alive:!0}},transaction:n});const j=(0,s.ZP)(),V=(0,s.ZP)(),U=(0,s.ZP)();_.sW({store:I,data:{type:o.Ti.collectionViewPage,collection_id:P,format:{...I.getFormat(),collection_pointer:L,app_config_uri:i.FF,app_uri_map:{[i.GZ]:P},app_id:S},view_ids:[j,V,U]},transaction:n});const O={table:u.n,id:j,spaceId:T};k.applyOperation({store:(0,h.Kv)(I,O),operation:{pointer:O,command:"set",path:[],args:{id:j,version:0,type:"page",name:f.default.formatMessage(x.home),parent_id:I.id,parent_table:"block",space_id:T,format:{page_pointer:{id:(0,s.Mt)(I.id),spaceId:T,table:"block"}},alive:!0}},transaction:n});const N={table:u.n,id:V,spaceId:T};k.applyOperation({store:(0,h.Kv)(I,N),operation:{pointer:N,command:"set",path:[],args:{id:V,version:0,type:"table",name:f.default.formatMessage(x.allPages),parent_id:I.id,parent_table:"block",space_id:T,format:{table_properties:Z},query2:{sort:[{property:R,direction:"descending"}]},alive:!0}},transaction:n});const z={table:u.n,id:U,spaceId:T};k.applyOperation({store:(0,h.Kv)(I,z),operation:{pointer:z,command:"set",path:[],args:{id:U,version:0,type:"table",name:f.default.formatMessage(x.pagesIOwn),parent_id:I.id,parent_table:"block",space_id:T,format:{table_properties:Z,property_filters:[{id:(0,s.ZP)(),filter:{filter:{value:{type:"relative",value:"me"},operator:"person_contains"},property:D}}]},query2:{sort:[{property:R,direction:"descending"}]},alive:!0}},transaction:n});const H=g.Z.PageScroller;H&&H.scrollToTop({animate:!0}),C.rm(n),b.wtf(a,{source:y,root_page_id:I.id,collection_id:P}),function(e){const{environment:t,blocks:n}=e,o=n[0];if(!o||!o.isCollectionViewPageWithContent())return;const i=(0,p.QaF)(o.getTitleValue());v.ZP.setState({...v.ZP.state,shouldReset:!1}),w.d4({item:{label:f.default.formatMessage(x.undoToast,{pageName:i}),durationMs:v.JY},undoFunc:()=>{k.createAndCommit({userAction:"wikiActions.wikiConversionToast.undo",environment:t,perform:e=>{M({environment:t,blocks:n,transaction:e,source:"snackbar"})}})}})}({environment:a,blocks:t})}function M(e){var t;const{environment:n,blocks:i,transaction:r,source:a}=e,s=i[0];if(!s||!s.isCollectionView())return void S.deprecatedShowErrorMessage("Something went wrong");const l=s.getFormat().collection_pointer;if(!l)return void S.deprecatedShowErrorMessage("Something went wrong");const c=h.NW.createChildStore(s,l),d=null===(t=s.getCover())||void 0===t?void 0:t.cover,u=c.getFormat().collection_cover_position,p=c.getName();I.vs({environment:n,block:s,blockType:o.Ti.page,transaction:r}),_.sW({store:s,data:{format:{...s.getFormat(),app_config_uri:void 0,app_uri_map:void 0,app_id:void 0,page_cover:d,page_cover_position:u},properties:{...s.getProperties(),title:p}},transaction:r}),y.A9({collectionViewBlockStore:s,collectionStore:c,transaction:r}),b.qA6(n,{source:a,root_page_id:s.id,collection_id:l.id})}},73060:(e,t,n)=>{n.d(t,{B1:()=>s,FO:()=>c,Rg:()=>l,nX:()=>u,rm:()=>d});var o=n(28182),i=n(80444),r=n(39699),a=n(37181);function s(){const{currentUserSettingsStore:e}=i.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.wiki_onboarding_phase??"unseen":void 0}function l(e){const t=s();if(void 0===t)return;const n=o.dF.indexOf(t);if(-1!==n&&n<o.dF.length-1){const{currentUserSettingsStore:t}=i.default.state;if(!t)return;r.createAndCommit({userAction:"wikiOnboardingActions.advanceOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:o.dF[n+1]}})}})}}function c(e){const t=s();if(void 0===t)return;const n=o.dF.indexOf(t);if(-1!==n&&n>1){const{currentUserSettingsStore:t}=i.default.state;if(!t)return;r.createAndCommit({userAction:"wikiOnboardingActions.previousOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:o.dF[n-1]}})}})}}function d(e){const{currentUserSettingsStore:t}=i.default.state;t&&"unseen"===s()&&a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"home"}})}function u(e){if("complete"===s())return;const{currentUserSettingsStore:t}=i.default.state;t&&r.createAndCommit({userAction:"wikiOnboardingActions.completeOnboarding",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"complete"}})},userId:t.id})}},89626:(e,t,n)=>{n.d(t,{ON:()=>m,__:()=>u,h1:()=>f,lZ:()=>h,sy:()=>p,w9:()=>g});n(21703);var o=n(67294),i=n(480),r=n(49085),a=n(66673),s=n(28182),l=n(39699),c=n(37181),d=n(80444);const u=r.default.createValue(void 0);function p(){const{currentUserSettingsStore:e}=d.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.ai_onboarding_phase??"space_for_ai":void 0}function m(e){"space_for_ai"===p()&&f(e)}function f(e){const t=p();if(void 0===t)throw new Error("Assertion failure, AI onboarding state is undefined!");const n=s.AQ.indexOf(t);if(-1===n)throw new Error(`Assertion failure, ${t} is not a valid AI onboarding state!`);if(n<s.AQ.length-1){const{currentUserSettingsStore:t}=d.default.state;if(!t)return;l.createAndCommit({userAction:"AiOnboardingActions.advanceAIOnboardingStage",environment:e,perform:e=>{c.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:s.AQ[n+1]}})},userId:t.id})}}function g(e){const t=(0,i.O7)(),n="completionPopup"===e.type&&"results"===e.stage&&!e.loading,r=(0,a.D9)(n);(0,o.useEffect)((()=>{r&&!n&&"refine_ai_response"===p()&&f(t)}),[n,r,t])}function h(e){const t=(0,i.O7)(),n="results"===e.stage&&e.loading,r=(0,a.D9)(n);(0,o.useEffect)((()=>{n&&!r&&"ask_ai_anything"===p()&&f(t)}),[n,r,t])}},92022:(e,t,n)=>{n.d(t,{fz:()=>b,hr:()=>_,jn:()=>v,kL:()=>w,sj:()=>y,yd:()=>S});var o=n(4615),i=n(50906),r=n(54642),a=n(84084),s=n(98104),l=n(78663),c=n(19124),d=n(68056),u=n(80444),p=n(16772),m=n(27724),f=n(24666),g=n(89626);function h(e){"completionPopup"!==e.type||"initialPrompt"!==e.stage||"textSelection"!==e.context.type&&"cursor"!==e.context.type||s.NA({multiSelection:e.context.textSelection})}function v(e){p.default.invalidateLastUpdater();const{environment:t}=e,{state:n}=p.default;if("completionPopup"!==n.type||"results"!==n.stage)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(n.inMemoryRecordCache);const o={type:"completionPopup",stage:"initialPrompt",prefilledValue:"",context:n.context,sessionId:n.sessionId,from:n.from,futureRevisions:[...n.revisions,...n.futureRevisions]};p.default.setState(o)}function b(){h(p.default.state),p.default.setState({type:"closed"})}function y(){const{state:e}=p.default;h(e),"completionPopup"===e.type&&"initialPrompt"===e.stage&&p.default.setState({type:"closedWithContext",context:e.context,sessionId:e.sessionId,futureRevisions:e.futureRevisions}),setTimeout((()=>{"closedWithContext"===p.default.state.type&&p.default.reset()}),1)}function S(e){p.default.setState({...e,type:"completionPopup",stage:"initialPromptForAIBlock",from:"ai_block",prefilledValue:"",sessionId:(0,o.ZP)()}),k({environment:e.environment,promptForAnalytics:e.clientPrompt})}function _(e){const{environment:t,from:n}=e;let{context:i,prefilledValue:a,sessionId:s}=e,c={type:"closed"};if("closed"===p.default.state.type){if(!i&&m.default.state.stores.length>0){const e=f.default.state;i="empty"===e.mode?(0,l.Xc)():(0,d.iG)(e.multiSelection)?(0,l.FD)():(0,l.Fu)()}i&&(a||(a=""),s||(s=(0,o.ZP)()),c={type:"completionPopup",stage:"initialPrompt",context:i,from:n,prefilledValue:a,sessionId:s,futureRevisions:[]},u.default.state.currentSpaceStore&&r.publishAiSession(t,{inference_type:"writer",spaceId:u.default.state.currentSpaceStore.id,id:c.sessionId,metadata:{from:n}}),"spacebar"===n&&(0,g.ON)(t))}p.default.setState(c),k(e)}function w(e){const{title:t,environment:n}=e,i=(0,l.FD)();if(!i)return;const r=t?(0,c.qB)({customPrompt:t,isPageEmpty:!0}):c.eL;_({environment:n,from:"page_menu",prefilledValue:(0,l.$W)(r),promptForAnalytics:r,sessionId:(0,o.ZP)(),context:i})}function k(e){const{environment:t,promptForAnalytics:n}=e,{state:o}=p.default;"completionPopup"===o.type&&"results"!==o.stage&&("initialPromptForAIBlock"!==o.stage&&s.ZH(t),i.Tlp(t,{session_id:o.sessionId,prompt_key:(null==n?void 0:n.key)??(o.prefilledValue?"unknown":"alternative_ui_empty_input"),from:o.from}),a.xv())}},71184:(e,t,n)=>{n.d(t,{Gl:()=>l,JS:()=>c,QC:()=>d,gC:()=>s,kg:()=>u});n(30541);var o=n(4615),i=n(37181),r=n(30793);function a(e,t){return e.id===t.id}function s(e,t,n){const o=c(t).slice(),s=o.findIndex((t=>a(e,t)));-1===s?o.unshift(e):o.splice(s,1,e),(0,r.lG)(e.action,t,n),i.d2({userSettingsStore:t,transaction:n,data:{favorite_ai_actions:o}})}function l(e,t){for(const n of c(e))if((0,r.YK)(n.action,t))return n}function c(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.favorite_ai_actions)??[]}function d(e,t,n){const o=c(t).filter((t=>!a(t,e)));i.d2({userSettingsStore:t,transaction:n,data:{favorite_ai_actions:o}})}function u(e){return{id:(0,o.ZP)(),name:e.promptTitle??"",action:{...e,promptTitle:void 0}}}},62878:(e,t,n)=>{n.d(t,{M:()=>f});n(67294);var o=n(5366),i=n(50906),r=n(47307),a=n(64964),s=n(39699),l=n(80444),c=n(71184),d=n(24405),u=n(85893);function p(e){window.__c={n:"FavoriteImportContent"};const{favorite:t,isReplacingFavorite:n}=e,i=(0,d.yK)((e=>({title:{fontWeight:700,marginBottom:"1em"},prompt:{color:e.lightTextColor,maxHeight:"5em",overflowY:"scroll",whiteSpace:"pre-wrap"}})),[]),r=n?(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Overwrite “{favoriteName}” AI action?",id:"ai.favoriteActions.importFavorite.overwriteMessage",values:{favoriteName:t.name}}):(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Add “{favoriteName}” AI action?",id:"ai.favoriteActions.importFavorite.addMessage",values:{favoriteName:t.name}}),a=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"“{favoritePrompt}”",id:"ai.favoriteActions.importFavorite.prompt",values:{favoritePrompt:t.action.prompt}});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:i.title,children:r}),(0,u.jsx)("div",{style:i.prompt,children:a})]})}var m=n(13555);async function f(e){const{environment:t}=e,n=await(0,m.cx)({environment:t,blockId:e.importArgs.blockId});"error"!==n.type?await async function(e){const{environment:t,newFavorite:n}=e,{currentUserSettingsStore:d}=l.default.state;if(!d)return;const m=(0,c.JS)(d);let f=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Add AI action",id:"ai.favoriteActions.importFavorite.addAction"}),g=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Cancel",id:"ai.favoriteActions.importFavorite.cancelAction"}),h=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"“{favoriteName}” AI action added to your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteAdded",values:{favoriteName:n.name}}),v=!1;for(const i of m)if(i.name===n.name){if(i.action.type===n.action.type&&i.action.prompt===n.action.prompt)return void a.oV({label:(0,u.jsx)(o.FormattedMessage,{defaultMessage:"“{favoriteName}” AI action is already in your Favorites.",id:"ai.favoriteActions.importFavorite.alreadyInFavorites",values:{favoriteName:n.name}})});n.id=i.id,v=!0,f=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Overwrite existing AI action",id:"ai.favoriteActions.importFavorite.overwriteAction"}),g=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Keep existing AI action",id:"ai.favoriteActions.importFavorite.keepExistingAction"}),h=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"“{favoriteName}” AI action updated in your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteUpdated",values:{favoriteName:n.name}});break}if(!(await r.confirmUserAction({message:(0,u.jsx)(p,{favorite:n,isReplacingFavorite:v}),acceptLabel:f,cancelLabel:g})))return;s.createAndCommit({userAction:"favoriteActions.handleFavoriteImport",environment:t,perform(e){(0,c.gC)(n,d,e)}}),a.oV({label:h}),i.VoR(t,{type:"create_from_url",session_id:void 0,gtm_favorite_id:n.gtmFavoriteId})}({environment:t,newFavorite:n.favorite}):a.oV({label:(0,u.jsx)(o.FormattedMessage,{defaultMessage:"An error occurred when loading the AI action. ({errorCode})",id:"ai.favoriteActions.importFavorite.favoriteFailedToLoad",values:{errorCode:n.code}})})}},13555:(e,t,n)=>{n.d(t,{OF:()=>c,cx:()=>p});var o=n(4615),i=n(45953),r=n(70203),a=n(54642),s=(n(95477),n(77080));let l=function(e){return e[e.NoConfig=100]="NoConfig",e[e.LoadPageChunkFailed=101]="LoadPageChunkFailed",e[e.MissingPageRecord=103]="MissingPageRecord",e[e.InvalidPageParent=104]="InvalidPageParent",e[e.MissingTitle=105]="MissingTitle",e[e.MissingPromptText=106]="MissingPromptText",e[e.MissingCollectionSchema=107]="MissingCollectionSchema",e[e.MissingPromptType=108]="MissingPromptType",e[e.InvalidPromptType=109]="InvalidPromptType",e[e.FavoritesDisabled=110]="FavoritesDisabled",e}({});function c(){{const e=s.default.getConfigKey("gtm_ai_favorites","space_id"),t=s.default.getConfigKey("gtm_ai_favorites","collection_id");if(e&&t)return{spaceId:e,collectionId:t}}}function d(e,t,n){const o=function(e,t,n){for(const i in e){const r=e[i];var o;if(r&&r.name===n)return null===(o=t.properties)||void 0===o?void 0:o[i]}}(e,t,n);if(o)return(0,r.Jcv)(o)}function u(e){return{type:"error",code:e}}async function p(e){var t;const{environment:n,blockId:p}=e;if(await s.default.waitUntilStatsigReady(),!s.default.checkGate("ai_favorites"))return u(l.FavoritesDisabled);const m=c();if(!m)return u(l.NoConfig);const{spaceId:f,collectionId:g}=m,h=await a.loadCachedPageChunk(n,{page:{spaceId:f,id:p},limit:0,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1});if("success"!==h.type)return u(l.LoadPageChunkFailed);const v=i.PF.create(h.data.recordMap),b=v.getValue({table:"block",id:p,spaceId:f});if(!b)return u(l.MissingPageRecord);if(b.parent_id!==g)return u(l.InvalidPageParent);const y=(0,r.Jcv)(null===(t=b.properties)||void 0===t?void 0:t.title);if(!y)return u(l.MissingTitle);const S=await async function(e){const{environment:t,recordMap:n,blockId:o,spaceId:i,collectionId:r}=e,s=n.getValue({table:"collection",id:r,spaceId:i});if(null!=s&&s.schema)return s.schema;const l=await a.getPublicPageData(t,{type:"block-space",blockId:o,spaceId:i});return"failed"!==l.type?l.data.collectionSchema:void 0}({environment:n,recordMap:v,blockId:p,spaceId:f,collectionId:g});if(!S)return u(l.MissingCollectionSchema);const _=d(S,b,"Prompt text");if(!_)return u(l.MissingPromptText);const w=d(S,b,"Prompt type");if(!w)return u(l.MissingPromptType);const k="Help me edit"===(I=w)?"helpMeEdit":"Help me write"===I?"helpMeWrite":void 0;var I;if(!k)return u(l.InvalidPromptType);const C=function(e,t,n){return"Yes"===d(e,t,n)}(S,b,"Run immediately");return{type:"success",favorite:{id:(0,o.ZP)(),name:y,executeImmediately:C,gtmFavoriteId:p,action:{type:k,prompt:_,promptTitle:void 0}}}}},57819:(e,t,n)=>{n.d(t,{$b:()=>v,Dj:()=>y,RR:()=>m,Tq:()=>h,VZ:()=>f,bJ:()=>p,jq:()=>b,rR:()=>g});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(66673),l=n(89224),c=n(80444),d=n(17903),u=n(42057);function p(){const e=(0,i.O7)(),t=(0,r.VK)((()=>e.device.isPhone),[e]);return(0,a.yK)((e=>{const n="dark"===e.mode?e.accentColors.purple[900]:e.accentColors.purple[400];return{purpleButton:{padding:4,fontWeight:600,color:n},keyboardShortcut:{textTransform:"uppercase",fontWeight:500,fontSize:11,marginLeft:6,color:e.lightTextColor,display:t?"none":void 0},lightweightButton:{display:"flex",alignItems:"baseline",justifyContent:"center",fontSize:14,padding:"5px 8px",borderRadius:4,color:e.mediumTextColor,height:32,marginTop:2},returnIndicatorIconStyles:{width:14,height:14,paddingLeft:4,fill:e.lightIconColor},keyboardShortcutInverted:{color:e.mediumInvertedTextColor,paddingLeft:4},writingLabel:{flex:1,color:n,fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center"},inputActions:{height:36,display:"flex",alignSelf:"flex-end",alignItems:"center"},loadingDots:{backgroundColor:n}}}),[t])}function m(e){if("completionPopup"===e.type)return e}function f(e){return"initialPromptForAIBlock"===e.stage?"aiBlock":e.context.type}function g(e){return"initialPromptForAIBlock"===e.stage?"write":function(e){switch(e.type){case"cursor":return"write";case"blockSelection":case"textSelection":return"edit"}}(e.context)}function h(e){l.clear(e)}function v(e){if("initialPromptForAIBlock"===e.stage){const t=e.originRef.current;if(!t)return;return{origin:t.getBoundingClientRect(),scrollerStore:y(e.store.getRecordStoreUIRoot())}}return e.context}function b(e){const{areWeLoading:t,scrollerStore:n,resetWhenScrolledToBottom:i}=e,a=(0,s.D9)(t);(0,o.useEffect)((()=>{t!==a&&c(!1)}),[t,a]);const[l,c]=(0,o.useState)(!1),d=(0,r.VK)((()=>null==n?void 0:n.state.scrollTop),[n]),u=(0,s.D9)(d),p=(0,r.VK)((()=>{const e=null==n?void 0:n.state.clientRect;if(e)return n.state.scrollHeight-e.height}),[n]);return(0,o.useEffect)((()=>{void 0!==u&&void 0!==d&&u-d>1&&c(!0)}),[d,u]),(0,o.useEffect)((()=>{i&&void 0!==d&&void 0!==p&&Math.abs(d-p)<1&&c(!1)}),[p,d,i]),l}function y(e){return e===c.default.state.mainEditorCurrentBlockStore?d.Z:u.Z}},72899:(e,t,n)=>{n.d(t,{GC:()=>i,gr:()=>s,l4:()=>r,oF:()=>a});var o=n(77907);const i=(0,o.lazyComponent)(o.deps.ai,(e=>e.CompletionPopup)),r=(0,o.createDependency)("propertyCompletionsActions",(async()=>Promise.all([n.e(2774),n.e(2743),n.e(7597),n.e(3690),n.e(2655),n.e(9933),n.e(2111),n.e(8848),n.e(9447),n.e(9434),n.e(5728),n.e(954),n.e(3678),n.e(4254),n.e(5741)]).then(n.bind(n,44866)))),a=(0,o.lazyComponent)(o.deps.ai,(e=>e.AiEligibilityUpdater)),s=(0,o.createDependency)("completionActions",(async()=>Promise.all([n.e(2774),n.e(2743),n.e(7597),n.e(3690),n.e(2655),n.e(9933),n.e(2111),n.e(8848),n.e(9447),n.e(9434),n.e(5728),n.e(954),n.e(3678),n.e(4254),n.e(5741)]).then(n.bind(n,84254))))},30793:(e,t,n)=>{n.d(t,{BG:()=>l,Nv:()=>r,TE:()=>d,YK:()=>i,lG:()=>s,pz:()=>a});var o=n(37181);function i(e,t){return e.prompt===t.prompt&&e.type===t.type}function r(e,t,n){const r=a(t).filter((t=>!i(t,e)));o.d2({userSettingsStore:t,transaction:n,data:{recent_ai_actions:[e,...r].slice(0,100)}})}function a(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.recent_ai_actions)??[]}function s(e,t,n){const r=a(t),s=r.filter((t=>!i(t,e)));r.length!==s.length&&o.d2({userSettingsStore:t,transaction:n,data:{recent_ai_actions:s}})}function l(e){const{clientPrompt:t,additionalContext:n,promptTitle:o}=e,i=null==n?void 0:n.prompt;if(("helpMeWrite"===t.key||"helpMeEdit"===t.key||"helpMeDraft"===t.key)&&i)return{type:"helpMeDraft"===t.key?"helpMeWrite":t.key,prompt:i,promptTitle:o};const r=function(e,t){if(!d(e.key))return;return null==t?void 0:t.topic}(t,n);return r?{type:"helpMeWrite",prompt:r,promptTitle:o}:void 0}const c={brainstormIdeas:!0,blogPost:!0,outline:!0,socialMediaPost:!0,pressRelease:!0,creativeStory:!0,essay:!0,poem:!0,todoList:!0,meetingAgenda:!0,prosConsList:!0,jobDescription:!0,salesEmail:!0,recruitingEmail:!0};function d(e){return c[e]}},33932:(e,t,n)=>{n.d(t,{O:()=>i,W:()=>r});var o=n(56206);function i(e){o.d.setState({open:!0,currentView:e.view})}function r(){o.d.setState({...o.d.state,open:!1})}},45317:(e,t,n)=>{n.d(t,{WE:()=>k,lJ:()=>x,Qv:()=>I,lU:()=>C,AN:()=>P,jo:()=>M});n(57658);var o=n(91644);const i={type:"custom",version:1,getPersistedInAppSkillTrigger:()=>({requiresInput:!0}),getSlackSkillTriggers:e=>{let{skillValue:t}=e;if("custom"!==t.type)return;return[{skillPointer:{table:o.AT,id:t.id,spaceId:t.space_id},name:"custom",messageTrigger:"only_when_mentioned_after_first",loadAdditionalPages:[]}]}},r={type:"qna",version:1,getGlobalInAppSkillTrigger:()=>({instructionsPageContext:{type:"qna"},requiresInput:!0}),getSlackSkillTriggers(e){let{skillValue:t}=e;if("qna"!==t.type)return;return[{skillPointer:{table:o.AT,id:t.id,spaceId:t.space_id},instructionsPageContext:{type:"qna"},name:"answer",messageTrigger:"only_when_mentioned_after_first",loadAdditionalPages:[]}]}};var a=n(21202);const s={type:"tasks_slack",version:1,getSlackSkillTriggers(e){var t,n;let{skillValue:i}=e;if("tasks_slack"!==i.type)return;const r={table:o.AT,id:i.id,spaceId:i.space_id},{team_block_id:s,tag_ids:l}=(null===(t=i.settings)||void 0===t?void 0:t.tasks_team_options)??{};return[{skillPointer:r,name:"taskFiling",messageTrigger:"only_when_mentioned_after_first",loadAdditionalPages:[null===(n=i.settings)||void 0===n?void 0:n.tasks_collection_view_block_id,s,...l??[]].map((e=>e?{table:a.iU,id:e,spaceId:i.space_id}:void 0)).filter((e=>Boolean(e))),instructionsPageContext:{type:"tasks_slack",teamBlockId:s}}]}};var l=n(72126),c=n(15047),d=n(97880),u=n(63143);const p={custom:i,summarize:{type:"summarize",version:1,getGlobalInAppSkillTrigger:()=>({instructionsPageContext:{type:"summarize"},requiresInput:!1})},wiki_slack:{type:"wiki_slack",version:1,getSlackSkillTriggers(e){let{skillValue:t}=e;if("wiki_slack"!==t.type)return;const{search_context:n,qna_collection_view_block_id:i,qna_ingestion_confirm_edits:r}=t.settings??{},s={table:o.AT,id:t.id,spaceId:t.space_id},p=i?{table:a.iU,id:i,spaceId:t.space_id}:void 0,m=[];return n&&(n.table===a.iU?m.push(n.id):n.table===c.bx||(0,d.t1)(n)),l.oA([{skillPointer:s,instructionsPageContext:{type:"wiki_slack_answer"},name:"answer",messageTrigger:"only_when_mentioned_after_first",loadAdditionalPages:[],searchFilters:{ancestors:m}},p&&{skillPointer:s,instructionsPageContext:{type:"wiki_slack_qna_ingestion"},name:"qnaIngestion",messageTrigger:"always",delaySeconds:u.d,...r?{autoConfirmEdits:!1,isBackground:!1}:{autoConfirmEdits:!0,isBackground:!0},loadAdditionalPages:l.oA([p]),searchFilters:{ancestors:m}}])}},tasks_slack:s,qna:r,meeting_summary:{type:"meeting_summary",version:1,getLocalInEditorSkillTrigger:e=>{let{positionBlockId:t}=e;return{instructionsPageContext:{type:"meeting_summary",positionBlockId:t},loadAdditionalPages:[]}}},meeting_action_items:{type:"meeting_action_items",version:1,getLocalInEditorSkillTrigger:e=>{let{positionBlockId:t}=e;return{instructionsPageContext:{type:"meeting_action_items",positionBlockId:t},loadAdditionalPages:[]}}}};var m=n(91856),f=n(20669),g=n(74600),h=n(24600),v=n(5366),b=n(98165),y=n(80444),S=n(21273),_=n(35661),w=n(89912);function k(e){const t=e.getValue();if(t&&t.alive){var n,o;const i=p[t.type],r=null===(n=i.getPersistedInAppSkillTrigger)||void 0===n?void 0:n.call(i,{skillValue:t}),a=null===(o=i.getSlackSkillTriggers)||void 0===o?void 0:o.call(i,{skillValue:t});if(r||a)return{key:e.id,type:"persisted",skillType:t.type,skillStore:e,inAppSkillTrigger:r,slackSkillTriggers:a}}}(0,d.AO)((e=>"persisted"===e.type?{true:e}:{false:e}));function I(){const{currentSpaceStore:e,mainEditorCurrentBlockStore:t}=y.default.state;if(!e)return[];const n=(t?(0,b.uJ)(t):[]).map((e=>e.id)),i=S.Z.allowCustomSkillCreation(),r=[];for(const o of Object.values(p)){var a;const e=null===(a=o.getGlobalInAppSkillTrigger)||void 0===a?void 0:a.call(o,{});e&&r.push({key:o.type,type:"global",skillType:o.type,inAppSkillTrigger:e})}const s=w.L.getSkillIds();for(const d of s){const t=_.Vf.createChildStore(e,{table:o.AT,id:d,spaceId:e.id}),a=t.getValue();if(a&&a.alive){var l,c;const e=p[a.type],o=i||n.includes(a.parent_id)?null===(l=e.getPersistedInAppSkillTrigger)||void 0===l?void 0:l.call(e,{skillValue:a}):void 0,s=null===(c=e.getSlackSkillTriggers)||void 0===c?void 0:c.call(e,{skillValue:a});(o||s)&&r.push({key:d,type:"persisted",skillType:a.type,skillStore:t,inAppSkillTrigger:o,slackSkillTriggers:s})}}return r}const C=function(){var e;const t=null===(e=r.getGlobalInAppSkillTrigger)||void 0===e?void 0:e.call(r,{});if(t)return{key:r.type,type:"global",skillType:"qna",inAppSkillTrigger:t}}();function x(e){var t,n;const o=e.getCurrentSkillType();if(!o)return;const i=null===(t=p[o])||void 0===t||null===(n=t.getLocalInEditorSkillTrigger)||void 0===n?void 0:n.call(t,{positionBlockId:e.id});return i?{key:o,type:"local",skillType:o,inEditorSkillTrigger:i}:void 0}const T=(0,v.defineMessages)({summarize:{defaultMessage:"Summarize",id:"skills.summarize"},custom:{defaultMessage:"Custom skill",id:"skills.custom"},wikiSlack:{defaultMessage:"Answer questions from Slack",id:"skills.wikiSlack"},tasksSlack:{defaultMessage:"Add tasks from Slack",id:"skills.tasksSlack"},qna:{defaultMessage:"Ask a question",id:"skills.qna"},meeting_summary:{defaultMessage:"Summarize your meeting",id:"skills.meeting_summary"},meeting_action_items:{defaultMessage:"Extract action items from your meeting",id:"skill.meeting_action_items"}}),M={summarize:T.summarize,custom:T.custom,wiki_slack:T.wikiSlack,tasks_slack:T.tasksSlack,qna:T.qna,meeting_summary:T.meeting_summary,meeting_action_items:T.meeting_action_items},P={summarize:m.Y,custom:f.y,wiki_slack:h.P,tasks_slack:h.P,qna:g.L,meeting_summary:f.y,meeting_action_items:f.y}},56206:(e,t,n)=>{n.d(t,{d:()=>a});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{open:!1,currentView:"chat"}}}const a=new r;(0,i.exposeDebugValue)("AssistantMenuStore",a)},89912:(e,t,n)=>{n.d(t,{L:()=>a});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{serverSkillIds:new Set,locallyCreatedSkillIds:new Set}}getSkillIds(){return Array.from(new Set([...this.state.serverSkillIds,...this.state.locallyCreatedSkillIds]))}addLocallyCreatedSkillId(e){this.state.locallyCreatedSkillIds.add(e),this.emit()}}const a=new r;(0,i.exposeDebugValue)("AssistantSkillsStore",a)},2553:(e,t,n)=>{n.d(t,{zY:()=>ce,Hj:()=>le,AN:()=>de,oS:()=>fe,Nj:()=>ge,sl:()=>pe,kM:()=>ue});n(57658),n(67294);var o=n(1302),i=n(15145),r=n(63362),a=n(80700),s=n(81730);var l=n(94412),c=n(10450),d=n(41432),u=n(84116),p=n(78106),m=n(76218),f=n(68626),g=n(42875),h=n(5366),v=n(4615),b=n(149),y=n(98963),S=n(18844),_=n(21202),w=n(23867),k=n(70203),I=n(97880),C=n(50906),x=n(98834),T=n(47307),M=n(54532),P=n(94419),A=n(13084),R=n(19785),D=n(68305),B=n(9953),E=n(82007),F=n(75018),Z=n(24677),L=n(64964),j=n(98104),V=n(39699),U=n(6854),O=n(95477),N=n(24215),z=n(82343),H=n(84210),W=n(33929),q=n(73959),G=n(77907),K=n(95802),$=n(80444),Q=n(58454),Y=n(88923),J=n(35661),X=n(35057),ee=n(45433);const te=(0,h.defineMessages)({genericSuccessMessage:{id:"automations.buttonTrigger.genericSuccessMessage",defaultMessage:"Button automation ran successfully"},createdBlocks:{defaultMessage:"Created {numBlocksDuplicated, plural, one {1 block} other {{numBlocksDuplicated} blocks}} on page",id:"automations.buttonTrigger.createdBlocks"},createdSprintsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprints"},updatedSprintsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprints"},createdSprintsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprintsLowercase"},updatedSprintsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprintsLowercase"},createdTasksUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasks"},updatedTasksUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasks"},createdTasksLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasksLowercase"},updatedTasksLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasksLowercase"},createdProjectsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjects"},updatedProjectsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjects"},createdProjectsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjectsLowercase"},updatedProjectsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjectsLowercase"},createdPagesUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPages"},updatedPagesUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPages"},createdPagesLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPagesLowercase"},updatedPagesLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPagesLowercase"}}),ne=["sprint","task","project","page"],oe={[ee.wW]:"project",[ee.iS]:"task",[ee.zU]:"page",[ee.Fi]:"page",[ee.p$]:"sprint",[ee.GZ]:"page",[ee.nG]:"page",[ee.Be]:"page"};function ie(e){const{typedAutomationExecutionSummary:t,numBlocksDuplicated:n,intl:o}=e,i=function(e){const{typedAutomationExecutionSummary:t,intl:n}=e,o=[];for(const r of ne){const e=t[r];if(e){const{numPagesCreated:t,numPagesEdited:n}=e;t>0&&o.push({pageType:r,modificationType:"created",numPagesModified:t}),n>0&&o.push({pageType:r,modificationType:"updated",numPagesModified:n})}}const i=o.slice(0,3).map(((e,t)=>{let{pageType:o,modificationType:i,numPagesModified:r}=e;const a=re[o][i],s=0===t?a.start:a.append;return n.formatMessage(s,{numPagesModified:r})}));if(i.length>0)return n.formatList(i,{type:"conjunction",style:"long"})}({typedAutomationExecutionSummary:t,intl:o});return i||(n>0?o.formatMessage(te.createdBlocks,{numBlocksDuplicated:n}):o.formatMessage(te.genericSuccessMessage))}const re={sprint:{created:{start:te.createdSprintsUppercase,append:te.createdSprintsLowercase},updated:{start:te.updatedSprintsUppercase,append:te.updatedSprintsLowercase}},task:{created:{start:te.createdTasksUppercase,append:te.createdTasksLowercase},updated:{start:te.updatedTasksUppercase,append:te.updatedTasksLowercase}},project:{created:{start:te.createdProjectsUppercase,append:te.createdProjectsLowercase},updated:{start:te.updatedProjectsUppercase,append:te.updatedProjectsLowercase}},page:{created:{start:te.createdPagesUppercase,append:te.createdPagesLowercase},updated:{start:te.updatedPagesUppercase,append:te.updatedPagesLowercase}}};var ae=n(85893);const se=(0,h.defineMessages)({genericErrorMessage:{id:"automations.buttonTrigger.genericErrorMessage",defaultMessage:"Button failed to execute"},open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"},defaultConfirmationWorkflowText:{defaultMessage:"Are you sure you want to continue?",id:"automations.buttonTrigger.defaultConfirmationWorkflowText"},defaultContinueWorkflowMessage:{defaultMessage:"Continue",id:"automations.buttonTrigger.defaultContinueWorkflowMessage"},defaultStopWorkflowMessage:{defaultMessage:"Cancel",id:"automations.buttonTrigger.defaultStopWorkflowMessage"},errorQueryCollectionTooManyPages:{defaultMessage:"Button impacts too many pages",id:"automations.buttonTrigger.errorQueryCollectionTooManyPages"},errorUserCancelled:{defaultMessage:"Button was cancelled",id:"automations.buttonTrigger.errorUserCancelled"}});function le(e){const{environment:t,collectionStore:n,property:o,transaction:i}=e,r=(0,v.ZP)(),a=n.getSchema()[o];a&&"button"===a.type&&(B.ae({environment:t,table:y.cv,inMemoryRecordCache:n.inMemoryRecordCache,value:{id:r,parent_id:n.id,parent_table:n.table,alive:!0,space_id:n.getSpaceId(),status:"active",trigger:{id:(0,v.ZP)(),type:"button"}},transaction:i}),B.sW({store:n.getSchemaStore(),data:{[o]:{...a,automation_id:r}},transaction:i}))}function ce(e){const{actionId:t,environment:n,intl:o,automationStore:i,actionType:r,transaction:a,insertionPoint:s,config:l,createDuplicateBlocksContainer:c=!0}=e,d=i.getSpaceId();if(!d)return;let u;"duplicate_blocks"===r&&c&&(u=B.j4({environment:n,inMemoryRecordCache:i.inMemoryRecordCache,transaction:a,type:"text",useCrdt:!1}));const p=l??function(e){const{actionType:t,intl:n}=e;if("modal_confirmation"===t)return{continue_button:{text:n.formatMessage(se.defaultContinueWorkflowMessage)},cancel_button:{text:n.formatMessage(se.defaultStopWorkflowMessage)},text:{type:"simple",value:(0,k.TPx)(n.formatMessage(se.defaultConfirmationWorkflowText))}}}({actionType:r,intl:o})??{},m=B.ae({environment:n,inMemoryRecordCache:i.inMemoryRecordCache,table:S.Xj,transaction:a,value:{id:t,type:r,parent_id:i.id,parent_table:y.cv,alive:!0,space_id:d,config:p,blocks:u?[u.id]:[]}});return u&&P.R3({transaction:a,parent:m.getKeyStore("blocks"),append:u}),!s||"afterActionId"in s?P.R3({transaction:a,parent:i.getActionIdsStore(),append:m,after:null==s?void 0:s.afterActionId}):"beforeActionId"in s?P.Ce({transaction:a,parent:i.getActionIdsStore(),prepend:m,before:s.beforeActionId}):(0,I.t1)(s),m}function de(e){const{actionStore:t,automationStore:n,environment:o,intl:i,transaction:r}=e,a=(0,v.ZP)(),s=t.getType(),l=t.getConfig();if(!s)return{onComplete:Promise.resolve([])};const c=ce({actionId:a,actionType:s,automationStore:n,config:l,environment:o,insertionPoint:{afterActionId:t.id},intl:i,transaction:r,createDuplicateBlocksContainer:!1});if(!c)return{onComplete:Promise.resolve([])};const d=t.getBlockStores().map((e=>{const[t,n]=M.Qi({environment:o,stores:[e],transaction:r,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1,targetSpaceId:(0,w.C)(e.pointer.spaceId),baseUrl:O.default.domainBaseUrl,publicDomainName:O.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:!1}),i=t[0];return R.jG({transaction:r,parentStore:c,childStore:i}),n}));return{onComplete:Promise.all(d)}}function ue(e){const{clientContext:t,transaction:n,newActionIds:o}=e,{automationStore:i}=t,r=i.getValue();if(!r)return;B.sW({store:i,transaction:n,data:{action_ids:o}});me({clientContext:t,transaction:n,automationValue:{...r,action_ids:o}})}function pe(e){var t;const{clientContext:n,actionStore:o,transaction:i}=e,r=n.automationStore.getValue();if(!r)return;R.hr({parentStore:n.automationStore,childStore:o,transaction:i});me({clientContext:n,transaction:i,automationValue:{...r,action_ids:null===(t=r.action_ids)||void 0===t?void 0:t.filter((e=>e!==o.id))}})}function me(e){const{clientContext:t,automationValue:n,transaction:o}=e,i=t.automationStore.getSpaceId();if(!i)return;const r=(0,z.pt)({context:t,automationValue:n});if(!b.x.isFail(r))for(const s of n.action_ids??[]){const e=t.automationStore.getRecordStore(t.automationStore,{table:S.Xj,id:s,spaceId:i});if(!e.isDefined())continue;const n=e.getModel(),l=new Set(r.value.actionInputValueTypes[s].map((e=>{if(e.kind===u.yp.Binding||e.kind===u.yp.ContextValue)return e.id;e.kind!==u.yp.ThisRow&&(0,I.t1)(e)})).filter(I.$K)),c=(0,a.z)(n.getType()).acceptFormulaVisitor({action:n,visitor:{visitVariableOutsideOfFormula:e=>l.has(e)?{type:"keep"}:{type:"replace",value:void 0},visitFormula:e=>e.value&&(0,m.UB)(e).some((e=>!l.has(e)))?{type:"replace",value:void 0}:{type:"keep"}}});for(const t of c)V.applyOperation({store:e,operation:t,transaction:o})}}async function fe(e){const{environment:t,store:n,clientContext:o}=e;let i,s;const d=await G.deps.formulas.loader();if(o.persisted){await o.automationStore.load();const e=o.automationStore.getModel();if(!e)return;i=e,s=o.automationStore.getActionStores().map((e=>e.getModel())).filter(I.$K)}else i=new l.X({triggerType:"button",actions:o.actions,parentPointer:o.parentPointer,spaceId:o.parentPointer.spaceId}),s=o.actions.map((e=>new l.e(e,o.parentPointer.spaceId)));const u=i.getTriggerType();if("event"===u)return;const m=(0,N.mc)(t),h=(0,X.zt)();(0,r.rg)(m,{actions:s.map((e=>e.getType())),automation_id:i.id,block_id:n.id,space_id:i.getSpaceId(),subscription_tier:h,trigger:u});const v=new he({automationModel:i,clientContext:o,environment:t}),y=(0,p.yf)(o.parentRecordStore.getRecordModel,o.parentRecordStore.loadRecordModel);if(!t.currentUser.id)return;let S;if("button_property"===o.type?S=(0,c.dG)({blockPointer:{...n.pointer,spaceId:(0,w.C)(n.pointer.spaceId)},currentUserId:t.currentUser.id,userTimeZone:(0,g.r)()}):"button_block"===o.type?S=(0,c.io)({currentUserId:t.currentUser.id,userTimeZone:(0,g.r)(),pagePointer:o.pageStore.pointer}):"structured_automation"===o.type||"event"===o.type?S={value:{values:[]}}:(0,I.t1)(o),b.x.isFail(S))return f.log({level:"error",from:"automationActions",type:"TriggerError",error:{miscDataString:JSON.stringify(S)}}),(0,r.By)(m,{automation_id:i.id,block_id:n.id,error_type:S.error.type,execution_duration_ms:0,subscription_tier:h,trigger:u}),void T.deprecatedShowErrorMessage("There was an error executing this automation");const k={automationModel:i,actionModels:s,values:S.value.values,executeEffectMap:v,executeContextualFormula:async(e,t)=>{if(!t)return{value:{type:"undefined"}};return await d.executeFormulaAsync(t,{values:e.values,handleDataRequest:y,userTimeZone:(0,g.r)(),intl:o.intl,depth:0,visitedProperties:new Set})},handleDataRequest:y,loadRecordModel:o.parentRecordStore.loadRecordModel,userTimeZone:(0,g.r)(),intl:o.intl,depth:0,visitedProperties:new Set},C=performance.now(),x=await async function(e){const{context:t}=e,{actionModels:n}=t;let o=t.values;for(const i of n){const e=(0,a.z)(i.getType()),n=await e.execute({...t,values:o},i);if(n.error)return n.error;o=o.concat(n.value.values)}}({context:k}),M=Math.trunc(performance.now()-C);if(x){0,f.log({level:"error",from:"automationActions",type:"AutomationExecutionError",error:{miscDataString:JSON.stringify({error:x,automationId:i.id})}}),(0,r.By)(m,{automation_id:i.id,block_id:n.id,error_type:x.type,execution_duration_ms:M,subscription_tier:h,trigger:u});const e=function(e){if("user_cancelled"===e.type)return se.errorUserCancelled;if("query_collection_too_many_items"===e.type)return se.errorQueryCollectionTooManyPages;return se.genericErrorMessage}(x),t=W.default.formatMessage(e);L.oV({label:t})}else(0,r.Cz)(m,{automation_id:i.id,block_id:n.id,execution_duration_ms:M,subscription_tier:h,trigger:u}),await async function(e){const{environment:t,saveTransactionInfos:n,clientContext:o,undoCheckpointName:i,numBlocksDuplicated:r}=e,a=function(e){const{saveTransactionInfos:t,parentRecordStore:n}=e,o={};for(const l of t)if("create_page"===l.type){var i,r;const e=J.NW.createChildStore(n,l.collection).getDatabaseType(),t=(e&&oe[e])??"page",a=(null===(i=o[t])||void 0===i?void 0:i.numPagesEdited)??0,s=(null===(r=o[t])||void 0===r?void 0:r.numPagesCreated)??0;o[t]={numPagesCreated:s+1,numPagesEdited:a}}else if("update_pages"===l.type){var a,s;const e=J.NW.createChildStore(n,l.collection).getDatabaseType(),t=(e&&oe[e])??"page",i=(null===(a=o[t])||void 0===a?void 0:a.numPagesEdited)??0,r=(null===(s=o[t])||void 0===s?void 0:s.numPagesCreated)??0;o[t]={numPagesCreated:r,numPagesEdited:i+l.pageIds.length}}else(0,I.t1)(l);return o}({saveTransactionInfos:n,parentRecordStore:o.parentRecordStore});let s;for(const m of n.slice().reverse()){if("create_page"===m.type){var l;s=J.G.createChildStore(o.parentRecordStore,{table:_.iU,id:m.pageId,spaceId:null===(l=m.collection)||void 0===l?void 0:l.spaceId});break}if("update_pages"===m.type){if(1===m.pageIds.length){var c;s=J.G.createChildStore(o.parentRecordStore,{table:_.iU,id:m.pageIds[0],spaceId:null===(c=m.collection)||void 0===c?void 0:c.spaceId})}else{const e=J.NW.createChildStore(o.parentRecordStore,m.collection);await e.load();const t=e.getParentBlockStore();if(!t)continue;s=t}break}(0,I.t1)(m)}const d=ie({typedAutomationExecutionSummary:a,numBlocksDuplicated:r,intl:o.intl}),u=()=>{E.qB({environment:t,namedRevisionId:i}),L.rN()},p=E.hv(i);L.oV({label:d,right:(0,ae.jsx)(U.wr,{blockStoreToOpen:s,...p?{performUndo:u}:{}})})}({environment:t,saveTransactionInfos:v.saveTransactionInfos,clientContext:o,undoCheckpointName:v.undoCheckpointName,numBlocksDuplicated:v.getNumBlocksDuplicated()})}function ge(e){var t;const{environment:n,parentStore:o,transaction:i}=e,r=B.j4({environment:n,type:"text",inMemoryRecordCache:o.inMemoryRecordCache,transaction:i,spaceId:o.pointer.spaceId,useCrdt:(null===(t=(0,q.sQ)(o))||void 0===t?void 0:t.useCrdt())??!1}),a=P.R3({parent:o,append:r,transaction:i}).child;Z.eP({environment:n,store:a});const s=a.getBlockTitleStore();j.N_({store:s})}class he{constructor(e){this.environment=void 0,this.clientContext=void 0,this.automationModel=void 0,this.numBlocksDuplicated=0,this.saveTransactionInfos=[],this.undoCheckpointName=void 0,this.getCollectionSchema=async e=>{const t=await this.clientContext.parentRecordStore.loadRecordModel(e.pointer);return t?{value:{collectionSchema:t.getNormalizedSchema()}}:{error:new s.Do({actionId:e.actionId,pointer:e.pointer})}},this.queryCollection=async e=>{const t=await D.tA(this.environment,{source:"automation",parentRecordStore:this.clientContext.parentRecordStore,collectionPointer:e.collection,filter:e.filter,sort:e.sort,limit:e.limit});return b.x.isFail(t)?{error:new s.Pn({actionId:e.actionId,type:t.error.type,message:t.error.message,cause:t.error})}:{value:{blockIds:t.value.blockIds}}},this.saveTransaction=e=>{if(this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.saveTransaction",environment:this.environment,perform:t=>{for(const n of e.operations){const e=(0,J.Kv)(this.clientContext.parentRecordStore,n.pointer);V.applyOperation({store:e,operation:n,transaction:t})}}}),this.saveTransactionInfos.push(e.info),"create_page"===e.info.type)C.W2j(this.environment,{type:"page",automation_id:this.automationModel.id,from:"button_automation",new_page_id:e.info.pageId});else if("update_pages"===e.info.type){const{editedProperties:t,pageIds:n}=e.info;for(const e of n)for(const{id:n,type:o}of t)C.rvl(this.environment,{block_id:e,property:n,property_type:o,from:"button_automation",automation_id:this.automationModel.id},!1)}else(0,I.t1)(e.info);return{value:{}}},this.navigateToPage=e=>{const t=$.default.state.mainEditorCurrentBlockStore;if(!t)return;const n=J.G.createChildStore(t,e.page),o="full_page"===e.openIn?(0,H.ZP)({store:n,fullyQualified:!1,pageVisitSource:i.tY.ButtonAutomation}):(0,H.ZP)({store:t,peekViewBlockId:n.id,peekMode:(0,Y.getUrlParamFromPeekMode)(e.openIn),fullyQualified:!1,pageVisitSource:i.tY.ButtonAutomation});F.navigate({environment:this.environment,url:o})},this.duplicateBlockChildren=async e=>{if("button_block"!==this.clientContext.type)return{error:new s.iR({contextType:this.clientContext.type})};const t=this.clientContext.blockStore,n=t.getRecordStoreUIParent();if(!n)return{value:{}};let i;"before"===e.insertionPoint?i=!0:"after"===e.insertionPoint?i=!1:(0,I.t1)(e.insertionPoint);const r=J.G.createChildStore(n,e.blockPointer);await r.load();const a=r.getContentStores();i||a.reverse();const l=K.C.findSelectableFromStore(t),c=[],d=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.duplicateBlockChildren",environment:this.environment,perform:e=>a.map((n=>{const[o,r]=M.Qi({environment:this.environment,stores:[n],transaction:e,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!0,targetSpaceId:(0,w.C)(n.pointer.spaceId),baseUrl:O.default.domainBaseUrl,publicDomainName:O.default.publicDomainName,preferDuplicateLocation:"local",analyticsFrom:"button_automation",useCrdt:t.useCrdt()}),a=o[0];return l&&(i?l.props.onInsertAbove&&c.push(l.props.onInsertAbove({insertStores:[a],transaction:e})[0]):l.props.onInsertBelow&&c.push(l.props.onInsertBelow({insertStores:[a],transaction:e})[0])),{copy:a,onComplete:r}}))}).performResult;return i||c.reverse(),Z.Z5({environment:this.environment,stores:c}),await Promise.all(d.map((e=>e.onComplete))),o.default.afterNextFlush((()=>{for(const e of c){if(A.dM({environment:this.environment,isAtStartOfLine:!1,store:e}))break}})),this.numBlocksDuplicated+=c.length,{value:{}}},this.displayModal=async e=>{Q.Z.setState({open:!0,format:e.format,recordStore:this.clientContext.parentRecordStore}),await Q.Z.waitUntil((()=>!Q.Z.state.open));const t=Q.Z.state;let n;return t.open||(n=t.result),n=n??"continue",n},this.initializeTemplateInDatabase=async e=>{const t=(0,v.ZP)(),n=this.clientContext.parentRecordStore,o=J.G.createChildStore(n,{table:_.iU,id:e.templateId});await o.load();const i=J.NW.createChildStore(n,e.collection);return this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.initializeTemplateInDatabase",environment:this.environment,perform:r=>{const a=B.j4({environment:this.environment,transaction:r,inMemoryRecordCache:n.inMemoryRecordCache,type:d.Ti.page,id:t,useCrdt:!1});R.zw({parentStore:i,childStore:a,transaction:r}),x.ob({environment:this.environment,store:a,transaction:r,templateStore:o,title:"template",isCreateIn:!1,isKeyboard:!1,from:"automation_actions"}),B.sW({transaction:r,store:a.getPropertiesStore(),data:e.propertyUpdates})}}),this.saveTransactionInfos.push({type:"create_page",pageId:t,collection:e.collection}),{value:{pageId:t}}},this.environment=e.environment,this.clientContext=e.clientContext,this.automationModel=e.automationModel,this.undoCheckpointName=`execute-client-automation-${(0,v.ZP)()}`}getNumBlocksDuplicated(){return this.numBlocksDuplicated}createAndCommitForEffect(e){return V.createAndCommit({...e,undoCheckpoint:this.undoCheckpointName})}}},41301:(e,t,n)=>{n.d(t,{Fp:()=>d,Mm:()=>c,So:()=>p,TU:()=>u});n(67294);var o=n(86628),i=n(24405),r=n(72126),a=n(5366),s=n(97880),l=n(85893);const c=(0,a.defineMessages)({missingTargetDatabase:{id:"clientAutomationHelpers.errorMessages.missingTargetDatabase",defaultMessage:"Missing a target database"},missingTargetPage:{id:"clientAutomationHelpers.errorMessages.missingTargetPage",defaultMessage:"Missing a target page"},invalidTemplatePage:{id:"clientAutomationHelpers.errorMessages.invalidTemplatePage",defaultMessage:"Invalid template."},noActions:{id:"clientAutomationHelpers.errorMessages.noActions",defaultMessage:"This button has no actions"},createPageButtonError:{id:"clientAutomationHelpers.errorMessages.createPageButtonError",defaultMessage:"Add page is missing a target database"},createPageButtonTemplateError:{id:"clientAutomationHelpers.errorMessages.createPageWithTemplateError",defaultMessage:"Add page has an invalid template"},openPageButtonError:{id:"clientAutomationHelpers.errorMessages.openPageButtonError",defaultMessage:"Open page is missing a target page"},updatePagesButtonError:{id:"clientAutomationHelpers.errorMessages.editPagesButtonError",defaultMessage:"Edit pages is missing a target database"},slackNotificationAuthenticationError:{id:"clientAutomationHelpers.errorMessages.slackNotificationError",defaultMessage:"Slack notification is missing an authentication."}});function d(e){if("create_page"===e.actionType)if("missing_required_config"===e.type){if("collection"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.createPageButtonError};(0,s.t1)(e)}else{if("invalid_optional_config"===e.type)return{forAction:c.invalidTemplatePage,forButtonTooltip:c.createPageButtonTemplateError};(0,s.t1)(e)}else if("update_pages"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.updatePagesButtonError};(0,s.t1)(e)}else(0,s.t1)(e);else if("open_page"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetPage,forButtonTooltip:c.openPageButtonError};(0,s.t1)(e)}else(0,s.t1)(e);else if("slack_notification"===e.actionType)if("missing_required_config"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};(0,s.t1)(e)}else if("missing_required_value"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};(0,s.t1)(e)}else(0,s.t1)(e);else(0,s.t1)(e)}function u(e){const{contextStore:t,actionId:n,shouldShow:i,errorKey:s}=e;return(0,o.VK)((()=>{if(!i)return;let e=t.getValidationErrorsForAction(n);s&&(e=e.filter((e=>e.key===s)));const o=r.Ps(e);if(!o)return;const c=d(o);return(0,l.jsx)(p,{content:(0,l.jsx)(a.FormattedMessage,{...c.forAction})})}),[i,t,n,s])}function p(e){window.__c={n:"TooltipWithSubtitle"};const{content:t,subtitle:n}=e,o=(0,i.yK)((e=>({wrap:{display:"flex",flexDirection:"column",alignItems:"center"},subtitle:{color:e.mediumInvertedTextColor}})),[]);return(0,l.jsxs)("div",{style:o.wrap,children:[(0,l.jsx)("div",{children:t}),n&&(0,l.jsx)("div",{style:o.subtitle,children:n})]})}},93174:(e,t,n)=>{n.d(t,{C:()=>o.LazyAutomationButtonActionList,O:()=>o.LazyPlacedButtonBlockEditor});var o=n(77907)},87686:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(24405),i=n(85893);function r(){window.__c={n:"BreadcrumbDivider"};const e=(0,o.yK)((e=>({span:{marginLeft:2,marginRight:2,color:e.lightTextColor}})),[]);return(0,i.jsx)("span",{style:e.span,children:"/"})}},25238:(e,t,n)=>{n.d(t,{Z:()=>p});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(82990),s=n(31278),l=n(76798),c=n(35661),d=n(74016),u=n(85893);function p(e){window.__c={n:"BreadcrumbIconTitle"};const{store:t,ignoreMaxLength:n,maxWidth:p,iconSize:m,titleStyle:f,iconStyle:g,highlighter:h}=e,{device:v}=(0,o.O7)(),b=m??(v.isMobile?24:20),{hasIcon:y,pageIcon:S,isEmptyPage:_}=(0,i.VK)((()=>({hasIcon:t.hasIcon(),pageIcon:t.getIcon(),isEmptyPage:t instanceof c.G&&t.isEmptyPage()})),[t]),w=(0,r.yK)((()=>({containerStyle:{display:"flex",alignItems:"center",minWidth:0},teamRecordTitle:{maxWidth:p,...f},pageRecordTitle:{maxWidth:n?"none":p,...f},recordIconStyle:{marginRight:6,fontWeight:a.Z.fontWeight.medium,...g}})),[n,p,f,g]);return t instanceof c.zX?(0,u.jsxs)("div",{style:w.containerStyle,children:[(0,u.jsx)(d.p,{disabled:!0,store:t,size:b,style:w.recordIconStyle}),(0,u.jsx)(l.Z,{store:t,style:w.teamRecordTitle,highlighter:h,enableHover:!0})]}):(0,u.jsxs)("div",{style:w.containerStyle,children:[y&&(0,u.jsx)(s.Z,{disabled:!0,icon:S,isEmptyPage:_,size:b,style:w.recordIconStyle,largeIcon:!0}),(0,u.jsx)(l.Z,{store:t,style:w.pageRecordTitle,highlighter:h,enableHover:!0})]},`breadcrumb-recordtitle-${t.id}`)}},7692:(e,t,n)=>{n.d(t,{Z:()=>b});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(15145),l=n(13084),c=n(39699),d=n(31945),u=n(89728),p=n(79954),m=n(84210),f=n(46837),g=n(87686),h=n(25238),v=n(85893);function b(e){window.__c={n:"BreadcrumbPageButton"};const t=(0,i.O7)(),{device:n}=t,{store:b,showDivider:y,maxWidth:S,popupRenderer:_,iconSize:w,titleStyle:k,iconStyle:I,highlighter:C,onClick:x}=e,T=(0,a.yK)((()=>({selectable:{display:"flex",alignItems:"center",minWidth:0},button:{display:"flex",minWidth:0,fontSize:"inherit",padding:2}})),[]),{url:M,canEdit:P,isPersonalHome:A}=(0,r.VK)((()=>({url:(0,m.ZP)({store:b,fullyQualified:!1,pageVisitSource:s.tY.Breadcrumb}),canEdit:b.canEdit(),isPersonalHome:"personal_home_page"===b.getType()})),[b]),R=(0,o.useCallback)((e=>{const{droppedDirection:n,droppedStores:o,duplicate:i}=e;c.createAndCommit({userAction:"SearchPathBreadcrumb.onDrop",environment:t,perform:e=>l.LQ({environment:t,targetParentStore:b.getContentStore(),targetStore:b,droppedDirection:n,droppedStores:o,duplicate:i,transaction:e})})}),[t,b]);return(0,v.jsxs)(o.Fragment,{children:[(0,v.jsx)(p.Z,{store:b,canDropOnto:P,onSelectableDrop:R,style:T.selectable,analyticsName:"breadcrumb",shouldShowDropZone:!0,children:_?(0,v.jsx)(d.ZP,{originGap:4,popupType:n.isMobile?d.Z4.SlideUp:d.Z4.Popup,render:_,renderOrigin:e=>(0,v.jsx)(u.Z,{...e,style:T.button,isSmall:!0,shouldShrink:!0,mobileFeedback:n.isMobile,children:(0,v.jsx)(h.Z,{store:b,maxWidth:S,iconSize:w,titleStyle:k,iconStyle:I,highlighter:C})})}):(0,v.jsx)(u.Z,{href:M,external:!1,style:T.button,isSmall:!0,shouldShrink:!0,mobileFeedback:n.isMobile,onClick:x,children:A?(0,v.jsx)(f.Z,{}):(0,v.jsx)(h.Z,{store:b,maxWidth:S,iconSize:w,titleStyle:k,iconStyle:I,highlighter:C})})}),y&&(0,v.jsx)(g.f,{})]},b.id)}},24946:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(31945),l=n(68785),c=n(89728),d=n(95697),u=n(77907),p=n(87686),m=n(25238),f=n(85893);function g(e){window.__c={n:"BreadcrumbTeamButton"};const{device:t}=(0,i.O7)(),{store:n,showDivider:g,popupRenderer:h,iconSize:v,iconStyle:b,highlighter:y}=e,S=(0,a.yK)((()=>({button:{fontSize:"inherit",padding:2},loadingPopupBackground:{width:280,paddingTop:8,paddingBottom:8,display:"flex",justifyContent:"center"}})),[]),{teamsEnabled:_,storeIsDefined:w}=(0,r.VK)((()=>({teamsEnabled:(0,d.bq)(),storeIsDefined:n.isDefined()})),[n]);if(!w||!_)return null;return(0,f.jsxs)(o.Fragment,{children:[(0,f.jsx)(s.ZP,{originGap:4,popupType:t.isMobile?s.Z4.SlideUp:s.Z4.Popup,render:h??(e=>(0,f.jsx)(u.LazyTeamBreadcrumbPopup,{renderLoading:e=>(0,f.jsx)("div",{style:S.loadingPopupBackground,children:e&&(0,f.jsx)(l.Z,{})}),teamStore:n,parent:e})),renderOrigin:o=>(0,f.jsx)(c.Z,{style:S.button,isSmall:!0,shouldShrink:!0,mobileFeedback:t.isMobile,...o,children:(0,f.jsx)(m.Z,{store:n,maxWidth:e.maxWidth,iconSize:v,titleStyle:e.titleStyle,iconStyle:b,highlighter:y})})}),g&&(0,f.jsx)(p.f,{})]},n.id)}},3043:(e,t,n)=>{n.d(t,{Qe:()=>r.Z,Yo:()=>i.Z,fY:()=>o.f,l2:()=>s});var o=n(87686),i=n(24946),r=n(7692),a=n(77907);const s=(0,a.lazyComponent)(a.deps.Breadcrumb,(e=>e.Breadcrumb))},17707:(e,t,n)=>{n.d(t,{AM:()=>K,DF:()=>R,DX:()=>E,Gu:()=>B,Ri:()=>q,T4:()=>j,Xi:()=>Z,Y0:()=>G,YF:()=>D,Zo:()=>N,bh:()=>F,cj:()=>U,en:()=>W,tR:()=>V});n(57658);var o=n(1302),i=n(22491),r=n(72126),a=n(4615),s=n(70279),l=n(33709),c=n(23867),d=n(70203),u=n(63143),p=n(50906),m=n(54564),f=n(31781),g=n(94419),h=n(9953),v=n(61045),b=n(3898),y=n(39699),S=n(53471),_=n(28020),w=n(65598),k=n(77546),I=n(89224),C=n(46351),x=n(95802),T=n(24229),M=n(56681),P=n(35661),A=n(92120);function R(e){var t;const{environment:n,store:o,text:i,files:r,transaction:a,discussionLocation:s}=e,{filesToCreate:l,fileStoresToDelete:c}=function(e,t){const n=[],o=new Set;t.forEach((e=>{"local"===e.type?n.push(e.file):o.add(e.id)}));const i=w.le(e).filter((e=>e.getAlive()&&!o.has(e.id)));return{filesToCreate:n,fileStoresToDelete:i}}(o,r);N({commentStore:o,fileBlocks:c,transaction:a}),H({commentStore:o,files:l,environment:n,transaction:a});const d=w.zP(o);h.sO({store:d,value:i,transaction:a}),z(o,a),p.zdn(n,{from:s,comment_id:o.id,discussion_id:o.getParentId(),parent_block_id:null===(t=o.getParentStore())||void 0===t?void 0:t.getParentId()})}function D(e){const{environment:t,commentStore:n,transaction:o}=e,i=w.GP(n);if(!i)return;const r=w.ak(i),a=r.getValue();if(!a)return;N({commentStore:n,fileBlocks:w.le(n),transaction:o}),h.sW({store:n,transaction:o,data:{alive:!1}}),y.applyOperation({store:r,operation:{pointer:r.pointer,path:r.path,command:"listRemove",args:{id:n.id}},transaction:o}),(0===a.length||1===a.length&&a[0]===n.id)&&function(e){const{discussionStore:t,transaction:n}=e,o=w.HK(t);o&&B({discussionStore:t,transaction:n,blockStore:o});const i=_.RM();if(i){const e=w.MI(i);for(const i of e){if(o&&i.table===o.table&&i.id===o.id)continue;const e=w.x8(i).getValue();null!=e&&e.includes(t.id)&&B({discussionStore:t,transaction:n,blockStore:i})}}}({discussionStore:i,transaction:o}),z(n,o),p.k$J(t,{from:e.discussionLocation,discussion_id:i.id,comment_id:n.id,parent_block_id:i.getParentId()})}function B(e){const{discussionStore:t,blockStore:n,transaction:o}=e,i=w.x8(n);y.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listRemove",args:{id:t.id}},transaction:o}),L({store:n,discussionId:t.id,transaction:o})}function E(e){var t;const{environment:n,commentStore:o,discussionStore:i,transaction:r}=e;if(T.Z.state.open){var a;const e=null===(a=T.Z.state.discussionIds)||void 0===a?void 0:a.filter((e=>e!==i.id));T.Z.setState({...T.Z.state,discussionIds:e,open:((null==e?void 0:e.length)||0)>0})}h.sW({store:i,data:{resolved:!0},transaction:r}),A.Z.setState({...A.Z.state,discussionIds:(null===(t=A.Z.state)||void 0===t||null===(t=t.discussionIds)||void 0===t?void 0:t.filter((e=>e!==i.id)))||[]}),p.hJ5(n,{comment_id:o.id,discussion_id:i.id,parent_block_id:i.getParentId(),from:e.discussionLocation})}function F(e){const{environment:t,commentStore:n,discussionStore:o,transaction:i}=e;h.sW({store:o,data:{resolved:!1},transaction:i}),p.SUR(t,{comment_id:n.id,discussion_id:o.id,from:e.discussionLocation,parent_block_id:o.getParentId()})}function Z(e){const{environment:t,discussionStore:n,textValue:o,transaction:i,files:a}=e,{id:s}=t.currentUser;if(!s)return;const l=S.dm(a);if(r.Xy(o,[])&&0===l.length)return;const c=O({discussionStore:n,text:o,files:l,environment:t,transaction:i});p.d2c(t,{from:e.discussionLocation,comment_id:c.id,discussion_id:n.id,parent_block_id:n.getParentId()})}const L=e=>{const{store:t,transaction:n,discussionId:o}=e,i=w.p9(t),r=i.getValue()||{},a=d.xcl({properties:r,discussionId:o});for(const[s,l]of Object.entries(a))h.sW({store:i,data:{[s]:l},transaction:n})};function j(e){const t=C.Z.find((t=>t.getStore().id===e&&!t.isSidebarFormat()&&!t.isMarginFormat()));if(t){const e=t.getNode();if(e&&e.parentElement){const t=Array.from(e.parentElement.children).indexOf(e);k.Wr(e,{edgeDist:0===t?0:-1,animate:!1})}}}function V(e){const{transaction:t,blockStore:n,discussionId:o}=e,i=w.x8(n);y.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listAfter",args:{id:o}},transaction:t})}function U(e){const{context:t,blockStore:n,environment:o,transaction:i,commentTextValue:r,files:s,discussionId:l=(0,a.ZP)()}=e,d=h.ae({environment:o,table:"discussion",value:{id:l,parent_id:n.id,parent_table:n.table,resolved:!1,context:t,space_id:(0,c.C)(n.pointer.spaceId)},inMemoryRecordCache:n.inMemoryRecordCache,transaction:i});V({transaction:i,blockStore:n,discussionId:d.id});return{discussionStore:d,commentStore:O({discussionStore:d,text:r,files:s,environment:o,transaction:i})}}function O(e){const{discussionStore:t,files:n,text:o,environment:i,transaction:r}=e,a=h.Ue({environment:i,table:s.x_,args:{parent:t.pointer},inMemoryRecordCache:t.inMemoryRecordCache,transaction:r}),l=w.ak(t);g.R3({parent:l,append:a,transaction:r});const c=w.zP(a);return h.sO({store:c,value:o,transaction:r}),H({commentStore:a,files:n,environment:i,transaction:r}),z(a,r),a}function N(e){const{commentStore:t,fileBlocks:n,transaction:o}=e,i=w.ig(t);n.forEach((e=>{h.sW({store:e,data:{alive:!1},transaction:o}),g.Od({parent:i,childToRemove:e,transaction:o})}))}function z(e,t){const n=w.bQ(e);h.sO({store:n,value:(0,u.ud)(Date.now()),transaction:t})}function H(e){const{environment:t,files:n,commentStore:o,transaction:i}=e,r=_.qQ(t),a=w.ig(o);f.z({files:n,environment:t,inMemoryRecordCache:o.inMemoryRecordCache,transaction:i,pageWidth:r,ignoreOversizedFiles:!0,spaceId:a.pointer.spaceId,useCrdt:!1}).forEach((e=>{g.R3({parent:a,append:e,transaction:i})}))}async function W(e){let{discussionId:t,currentBlockStore:n,environment:o,analyticsFrom:i,currentEl:r}=e;return q({discussionStore:P.t1.createChildStore(n,{table:l.qF,id:t,spaceId:(0,c.C)(n.pointer.spaceId)}),currentBlockStore:n,environment:o,analyticsFrom:i,currentEl:r})}async function q(e){var t;let{discussionStore:n,currentBlockStore:r,environment:a,analyticsFrom:s,currentEl:l}=e;if(!r)return null;if(!n.isDefined())return;function c(e){const t=function(e){var t;let n,{discussionId:o,blockId:r}=e;const a=null===(t=document.getElementsByClassName(`${(0,i.dk)({discussionId:o})}`))||void 0===t?void 0:t[0];a&&(n=x.C.findSelectableFromChildNode(a)),n||(n=x.C.findScrollToSelectablesFromIds([r])[0]);return n}({discussionId:n.id,blockId:e});if(!t)return;const o=document.getElementsByClassName(`discussion-id-${n.id}`)[0];return o?v.bx({element:o,scrollers:{verticalScroller:t.getContextVerticalScroller(),horizontalScroller:t.getContextHorizontalScroller()},vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}):v.NQ({component:t,vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}),t.displaySelectionHalo(750),t}const d=(null===(t=n.getRecordStoreUIParent())||void 0===t?void 0:t.id)??n.getParentId();c(d)||(await b.Nz(r,[d]),await o.default.afterNextFlush(),c(d));const u=P.G.createChildStore(r,n.getParentPointer()),p=I.get(),f=null==p?void 0:p.commonAncestorContainer,g=!(null!=p&&p.collapsed)&&f&&(l===f||(null==l?void 0:l.contains(f)));m.Ib({environment:a,blockStore:u||r,analyticsFrom:s,discussionIds:[n.id],shouldFocusDiscussion:!g,recursivelyLoadAllDiscussions:!1})}function G(e){e!==M.Z.state.pageId&&M.Z.reset()}function K(e){const t={};e.forEach((e=>{t[e]=Date.now()})),M.Z.setState({...M.Z.state,...t})}},18821:(e,t,n)=>{n.d(t,{Cd:()=>A,WD:()=>M,ZL:()=>D,i8:()=>R,uK:()=>E,yw:()=>P});n(57658);var o=n(1302),i=n(41432),r=n(4615),a=n(21202),s=n(23867),l=n(70203),c=n(5366),d=n(50906),u=n(47307),p=n(56863),m=n(24677),f=n(97444),g=n(98104),h=n(39699),v=n(53471),b=n(33929),y=n(45162),S=n(89224),_=n(58202),w=n(35661),k=n(34047),I=n(82994),C=n(48514),x=n(17707);const T=(0,c.defineMessages)({discardCommentConfirmationPrompt:{id:"newDiscussionMenu.discardCommentConfirmationDialog.prompt",defaultMessage:"Do you want to discard the comment?"},discardCommentButtonLabel:{id:"newDiscussionMenu.discardCommentConfirmationDialog.discardButton.label",defaultMessage:"Discard"}});async function M(e){const{environment:t,blockStore:n,multiSelection:o,rect:i}=e;let r=i;if(!r){const e=S.get();if(!e)return;r=S.getRect(e)}if(!r)return;const a=r.width,l=r.height,c=r.right-a,u=new I.Z(t,(0,s.C)(n.pointer.spaceId));C.Z.setState({open:!0,rect:new DOMRect(c,r.top,a,l),type:"inline",blockStore:n,multiSelection:o,discussionInputStore:u}),p.w(),await B(u,t),d.$5Z(t)}async function P(e){const{environment:t,blockStore:n}=e,o=_.R.getRect(n);if(!o)return;const i=new I.Z(t,(0,s.C)(n.pointer.spaceId)),r=o.width,a=o.height,l=o.right-r;C.Z.setState({open:!0,rect:new DOMRect(l,o.top,r,a),type:"block",blockStore:n,discussionInputStore:i}),await B(i,t),d.yrm(t)}function A(e){const t=C.Z.state;t.open&&C.Z.setState({open:!1,rect:t.rect})}function R(e){const{environment:t,blockStore:n,commentTextValue:o,transaction:r,files:a}=e,{id:s}=t.currentUser;if(!s)return;let c;const u=n.getType();if(u&&(0,i.XD)(u)&&!(0,i.S9)(u)){const e=n.getTitleValue();c=l.O1u(l.OAI(e))}const{discussionStore:p,commentStore:m}=x.cj({context:c,blockStore:n,environment:t,transaction:r,commentTextValue:o,files:v.dm(a)});return d.bRy(t,{discussion_id:p.id,comment_id:m.id,parent_block_id:p.getParentId()}),p}function D(e){const t=C.Z.state;if(t.open){const n=t.discussionInputStore.state.textStore.getValue(),o=t.discussionInputStore.state.files;(n&&n.length>0||o.length>0)&&("inline"===t.type?h.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:s=>{!function(e){const{environment:t,multiSelection:n,commentTextValue:o,transaction:s,files:c}=e,{id:u}=t.currentUser;if(!u)return;const p=(0,r.ZP)(),m=(0,y.L5)(n).filter((e=>{let{store:t}=e;return t.table===a.iU}));if(0===m.length)return;const g=m[0].store.getRecordStoreAtRootPath(),h=[],b=new Set;m.forEach(((e,n)=>{let{store:o,selection:r}=e;b.add(o.id);const a=o.getRecordStoreAtRootPath();if(!(a instanceof w.G))return;const c=a.getType(),d=a.getFormat();if(c&&(0,i._T)(c,d))return;let u=o.getValue();const m=l.Ulv(u,r);f.i8({environment:t,store:o,selection:m,annotation:[l.GKr.Discussion,p],transaction:s}),u=o.getValue();const g=l.KU1(u,m.startIndex,m.endIndex),v=0===n?[]:[l.V3y("\n")];h.push(...v,...g),n>0&&x.tR({blockStore:a,discussionId:p,transaction:s})}));const S=(0,y.tp)({multiSelection:n,filterCommonAncestors:!1,focus:void 0});if(S)for(const r of S.stores){if(b.has(r.id))continue;const e=r.getType(),t=r.getFormat();e&&(0,i._T)(e,t)||x.tR({blockStore:r,discussionId:p,transaction:s})}const{discussionStore:_,commentStore:k}=x.cj({context:h,blockStore:g,environment:t,transaction:s,commentTextValue:o,files:v.dm(c),discussionId:p});d.x6y(t,{discussion_id:_.id,comment_id:k.id,parent_block_id:_.getParentId()})}({environment:e,multiSelection:t.multiSelection,commentTextValue:n||[],files:o,transaction:s})},skipUpdatingEditedMetadata:!0}):"block"===t.type&&h.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:i=>{R({environment:e,blockStore:t.blockStore,commentTextValue:n||[],files:o,transaction:i})},skipUpdatingEditedMetadata:!0})),A()}}async function B(e,t){await o.default.afterNextFlush(),m.ZH(t),g.N_({store:e.state.textStore})}function E(e,t){(0,k.hu)(e)?(d.lLZ(t),u.showDialog({message:b.default.formatMessage(T.discardCommentConfirmationPrompt),showCancel:!0,handleCancel:()=>d.jXQ(t),keepFocus:!0,items:[{label:b.default.formatMessage(T.discardCommentButtonLabel),color:"red",onAccept:()=>{d.Yz2(t),A()}}]})):A()}},95306:(e,t,n)=>{n.d(t,{Cd:()=>m,UZ:()=>p,oK:()=>u});var o=n(1302),i=n(29477),r=n(23867),a=n(50906),s=n(24677),l=n(98104),c=n(82994),d=n(9080);async function u(e){const{environment:t,discussionStore:n,rect:u,blockStore:p,discussionLocation:m,activityId:f,notificationId:g}=e,h=new c.Z(t,(0,r.C)(p.pointer.spaceId));d.Z.setState({open:!0,rect:u,discussionStore:n,discussionInputStore:h,blockStore:p,discussionLocation:m,activityId:f,notificationId:g}),s.ZH(t),await o.default.afterNextFlush(),await(0,i.Vs)(10),l.NX({store:h.state.textStore}),a.Jed({environment:t,from:m,activityId:f,notificationId:g})}function p(e){const t=d.Z.state;if(t.open){const{discussionLocation:n,activityId:o,notificationId:i}=t;d.Z.setState({open:!1,rect:t.rect}),s.ZH(e),a.RnH({environment:e,from:n,activityId:o,notificationId:i})}}function m(e){const t=d.Z.state;if(t.open){0===t.discussionStore.getComments().length&&p(e)}}},25487:(e,t,n)=>{n.r(t),n.d(t,{DiscussionIndicatorFormat:()=>f,default:()=>h});n(67294);var o=n(83355),i=n(95855),r=n(82990),a=n(54564),s=n(24677),l=n(68709),c=n(73063),d=n(28020),u=n(65598),p=n(24229),m=n(85893);let f=function(e){return e[e.PushContent=0]="PushContent",e[e.FloatRight=1]="FloatRight",e}({});class g extends o.Z{constructor(){super(...arguments),this.handleClick=()=>{s.ZH(this.environment),a.Ib({environment:this.environment,blockStore:this.props.store,analyticsFrom:"discussion_indicator",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:this.props.recursivelyLoadAllDiscussions})},this.selectedDiscussionIdStore=this.createComputedStore((()=>p.Z.getFramePageFirstSelectedDiscussionId())),this.numberOfCommentsStore=this.createComputedStore((()=>{const{store:e,recursivelyLoadAllDiscussions:t,onlyCountBlockLevelDiscussions:n}=this.props,o=u.vV(e,{recursivelyLoadAllDiscussions:t,onlyIncludeBlockLevelDiscussions:n});if(0===o.length)return 0;const i=new Set(o.map((e=>e.id))),r=this.selectedDiscussionIdStore.state;if(r&&i.has(r))return 0;const a=d.RM();if(a){const t=u.MI(a),n=t.indexOf(e),o=new Set(i);for(let e=n-1;e>=0;e--){const n=t[e],r=u.vV(n,{recursivelyLoadAllDiscussions:!1,excludeSelf:!1,onlyIncludeBlockLevelDiscussions:!1,includeLoadingDiscussions:!0}).map((e=>e.id));for(const e of o)r.includes(e)?i.delete(e):o.delete(e);if(0===i.size)return 0;if(0===o.size)break}}return u.Xp(e,{recursivelyLoadAllDiscussions:t,onlyIncludeBlockLevelDiscussions:n})}))}renderComponent(){const e=this.numberOfCommentsStore.state;if(0===e)return null;return this.props.getFormat()===f.FloatRight?(0,m.jsx)(l.p,{allowSelectionWithin:!1,style:{width:0,height:0},children:this.renderButton(e)}):this.renderButton(e)}renderButton(e){return(0,m.jsx)(c.Z,{icon:i.z,style:{position:"relative",alignSelf:"flex-start",marginLeft:4,marginTop:3},onClick:this.handleClick,caption:this.renderNumberOfComments(e)})}renderNumberOfComments(e){const t=e>9?"9+":e;return(0,m.jsx)("span",{style:{marginLeft:2,color:this.theme.lightTextColor,fontWeight:r.Z.fontWeight.semibold},children:t})}}g.displayName="DiscussionIndicator";const h=g},34047:(e,t,n)=>{n.d(t,{DF:()=>m,De:()=>f,Je:()=>x,KL:()=>k,NI:()=>h,O2:()=>d,QT:()=>p,Qg:()=>u,W5:()=>w,ad:()=>I,hu:()=>_,n9:()=>S,p9:()=>C,uC:()=>y});var o=n(72126),i=n(70279),r=n(70203),a=n(97880),s=n(65598),l=n(35661);const c=n(60809);let d=function(e){return e[e.Menu=0]="Menu",e[e.Page=1]="Page",e[e.Sidebar=2]="Sidebar",e[e.Margin=3]="Margin",e[e.Unfurl=4]="Unfurl",e}({});function u(e){let{recordStore:t,currentUserId:n}=e;return b({recordStore:t,currentUserId:n})||h(t)[0]}function p(e){return e>1?3:6}function m(e){let{blockStore:t,ignoreAfterTime:n,currentUserId:o}=e;if(!t)return[];return s.al(t,{recursivelyLoadAllDiscussions:!0,includeLoadingDiscussions:!0}).sort(((e,t)=>{const n=u({recordStore:e,currentUserId:o}),i=u({recordStore:t,currentUserId:o});return null!=n&&n.isDefined()?null!=i&&i.isDefined()?-(n.getCreatedTime()-i.getCreatedTime()):1:-1}))}function f(e){if(!e.isDefined())return!1;const t=e.getContext();if(!t)return!0;return(e=>0===r.llS(e).length)(r.VP_(t,(t=>!r.xw5(t)||r.h19(t)===e.id)))}function g(e,t){return e&&e.isDefined()?t&&t.isDefined()?e.getCreatedTime()-t.getCreatedTime():1:-1}function h(e){return s.D4(e).sort(((e,t)=>g(e,t)))}function v(e){return b({recordStore:e,currentUserId:void 0})}function b(e){let{recordStore:t,currentUserId:n}=e;const o=s.D4(t).filter((e=>e.isDefined()&&e.getCreatedById()!==n)).sort(((e,t)=>g(e,t)));return o[o.length-1]}function y(e){return e.sort(((e,t)=>g(v(e),v(t))))}function S(e){const t=e.state.textStore.getValue(),n=(e.state.files??[]).length>0,o=t&&t.length>0;return!n&&!o}function _(e,t){const n=e.state.textStore.getValue(),i=e.state.files;if(!t)return n&&0!==n.length||i&&i.length>0;const r=s.zP(t).getValue();return!o.Xy(r,n)||function(e,t){const n=e.state.files,o=s.le(t);if(o.length!==n.length)return!0;return o.some(((e,t)=>e.id!==n[t].id))}(e,t)}function w(e){if(e.some((e=>!e.isReady())))return!0;return!!e.map((e=>s.D4(e))).flat().some((e=>!e.isReady()||!e.getCreatedTime()))}function k(e){const t=s.ak(e),n=t.getValue()||[];if(0===n.length)return;const o=n[0];return l.t1.createChildStore(t,{table:i.x_,id:o,spaceId:t.pointer.spaceId}).getCreatedTime()}function I(e){switch(e){case"block_menu":return d.Menu;case"page_discussion":return d.Page;case"reply_menu_mentions_comments":case"reply_menu_all_updates":case"reply_menu_archive":case"reply_menu_updates_sidebar":case"updates_menu_mentions_comments":case"updates_menu_all_updates":case"updates_menu_archive":return d.Menu;case"updates_sidebar":return d.Sidebar;case"margin_comments":return d.Margin;case"comment_unfurl":return d.Unfurl;default:(0,a.t1)(e)}}function C(e){var t;if(e.length>1)return!1;const n=e[0];if(!n.length)return!1;const o=n[0].trim(),i=c();return(null===(t=o.match(i))||void 0===t?void 0:t.join(""))===o}const x={updates_menu_all_updates:28,updates_menu_mentions_comments:28,updates_menu_archive:28,block_menu:20,reply_menu_all_updates:20,reply_menu_mentions_comments:20,reply_menu_archive:20,reply_menu_updates_sidebar:20,page_discussion:20,updates_sidebar:23,margin_comments:20,comment_unfurl:32}},92650:(e,t,n)=>{n.d(t,{fS:()=>L,QB:()=>Z,Z:()=>j,Vs:()=>B,wo:()=>R,az:()=>z,oS:()=>O,H0:()=>q,ui:()=>U,gC:()=>V,fg:()=>H,EM:()=>N});n(57658);var o=n(18466),i=n(14577),r=n(41432),a=n(22491),s=n(72126),l=n(21202),c=n(97880),d=n(43250),u=n(78316),p=n(11599),m=n(65598),f=n(58202),g=n(49427),h=n(95802),v=n(24646),b=n(15723),y=n(80444),S=n(17903),_=n(45325),w=n(88923),k=n(35661),I=n(49085),C=n(92595);class x extends I.default{getInitialState(){return{visible:!0}}}const T=new x;(0,C.exposeDebugValue)("MarginCommentsStore",T);const M=T;var P=n(48514),A=n(34047);const R=10,D="temp-margin-comment-discussion",B=50,E=`.${d.x9t} .notion-collection_view-block`,F=`.${d.OE$}`,Z=372,L=16,j=Z-4*L;function V(e,t,n){const o=U(e,t);return o>=1500||n&&!w.default.isSidePeekClosing.state||t?0:(1500-o)/2}function U(e,t){return t&&w.default.isSidePeekOpen()?(0,v.vJ)(e):e.WindowSizeStore.state.width-(0,v.Wk)(e)-(0,v.vJ)(e)-_.ZP.getPanelWidthReturnZeroForClosingState()}function O(e,t,n){return(U(e,t)-1600)/2+2*L+V(e,t,n)}const N=new i.Z((()=>{var e;let t=y.default.state.mainEditorCurrentBlockStore;return null!==(e=t)&&void 0!==e&&e.isCollectionView()&&(t=(0,u.SY)(t)||t),t?(0,m.vV)(t,{recursivelyLoadAllDiscussions:!0,excludeSelf:!0}):[]}),{debugName:"mainEditorBlockUnresolvedDiscussionStore"});function z(e,t){const n=M.state.visible;return Boolean(!e.device.isMobile&&U(e,(0,u.en)(t))>=1150&&n&&!(0,v.Sx)(e)&&!w.default.isSidePeekOpen()&&g.Z.isBlockInFrame(t)&&(0,p.A$)("margin_comments","inline"))}function H(e,t){const n=N.state.length>0,o=P.Z.state.open&&P.Z.state.rect;return Boolean(z(e,t)&&(n||o))}function W(e,t){return e.offsetTop!==t.offsetTop?e.offsetTop<t.offsetTop?-1:1:e.createdTimeMs&&t.createdTimeMs&&e.createdTimeMs!==t.createdTimeMs?e.createdTimeMs<t.createdTimeMs?-1:1:e.id<t.id?-1:1}const q=(0,s.Ds)((function(e){let{discussionStores:t,pageContentStores:n,marginDiscussionItemRefs:i,selectedDiscussionId:s,newMarginDiscussionArgs:u,marginContainerElement:p,pageViewBlockElement:m,onComputeComplete:g,computedOnce:v,prevSelectedDiscussionId:y,isFullWidth:_,topbarHeight:w,windowHeight:I,previousDiscussionElements:C}=e;const x=new Map;let T=0,M=0;if(!p||!m)return;if(0===t.length&&!u)return;const P=o.Z.withListenerIgnored((()=>S.Z.state.scrollTop)),R=p.getBoundingClientRect(),B=G({currentScrollTop:P,rect:R});let Z=function(e){const t=new Map,n=[];return e.forEach((e=>{if(e.shouldGroup){const n=t.get(e.parentBlockStore.id)||[];n.push(e),t.set(e.parentBlockStore.id,n)}else n.push(e)})),t.forEach((e=>{n.push({offsetTop:e[0].offsetTop,groupedDiscussionsData:e,parentBlockStore:e[0].parentBlockStore,type:"grouped",id:e[0].id,createdTimeMs:e[0].createdTimeMs})})),n}(t.map((e=>function(e){let{discussionStore:t,currentScrollTop:n,topbarHeight:o,windowHeight:i,pageViewBlockElement:r,previousDiscussionElements:s,currentDiscussionElements:c,selectedDiscussionId:d}=e;const u=t.id,p=function(e){const{topbarHeight:t,windowHeight:n,pageViewBlockElement:o,discussionId:i,previousDiscussionElements:r,currentDiscussionElements:s,selectedDiscussionId:l}=e,c=o.getElementsByClassName((0,a.dk)({discussionId:i})),d=e=>(s.set(i,e),e);if(c.length>0){if(l===i){let e;for(let o=0;o<c.length;o++){const i=c[o];if(i instanceof HTMLElement){const o=i.getBoundingClientRect();if(o.bottom<t||o.top>n){if(e)return d(e)}else{if(o.top>t)return d(i);e=i}}}}const e=r.get(i);return e&&Array.from(c).includes(e)?d(e):d(c[0])}}({topbarHeight:o,windowHeight:i,pageViewBlockElement:r,discussionId:u,previousDiscussionElements:s,currentDiscussionElements:c,selectedDiscussionId:d}),m=t.recordStoreUIParentStore;if(!(m&&m.id&&m.table===l.iU&&m instanceof k.G))return;if(!m.isReady())return;const f={offsetTop:0,discussionStore:t,parentBlockStore:m,type:"existing",id:t.id,createdTimeMs:(0,A.KL)(t)};if(p instanceof HTMLElement)return f.offsetTop=G({rect:p.getBoundingClientRect(),currentScrollTop:n}),f;const g=h.C.findNodeFromStore(m);if(g instanceof HTMLElement)return f.offsetTop=G({rect:g.getBoundingClientRect(),currentScrollTop:n}),f;const{node:v,blockStore:b}=function(e){let t=e.getParentBlockStore();for(;t;){const e=t.getParentBlockStore();if(!e)return{};const n=h.C.findNodeFromBlockId(t.id);if(n)return{node:n,blockStore:t};t=e}return{}}(m);if(v instanceof HTMLElement&&b)return f.offsetTop=G({rect:v.getBoundingClientRect(),currentScrollTop:n})+10,f.parentBlockStore=b,f.shouldGroup=!0,f.closestVisibleParentId=b.id,f}({discussionStore:e,currentScrollTop:P,topbarHeight:w,windowHeight:I,pageViewBlockElement:m,previousDiscussionElements:C,currentDiscussionElements:x,selectedDiscussionId:s}))).filter(c.$K));const L=u&&function(e){var t;let n,{blockStore:o,discussionInputStore:i,currentScrollTop:r,pageViewBlockElement:a}=e;const s=null===(t=a.getElementsByClassName(d.dXl))||void 0===t?void 0:t[0];n=s instanceof HTMLElement?s.getBoundingClientRect():f.R.getRect(o);if(!n)return;return{offsetTop:G({rect:n,currentScrollTop:r}),parentBlockStore:o,discussionInputStore:i,type:"new",id:D,createdTimeMs:Date.now()}}({...u,currentScrollTop:P,pageViewBlockElement:m}),j=L?L.id:s;let V;L&&Z.push(L);const U=j||y?void 0:function(e){let{pageContentStores:t,currentScrollTop:n,marginContainerRect:o,isFullWidth:i}=e;return t.map((e=>{const t=e.getType();if(!t)return;let n;var a;if(r.Ok[t]||"column_list"===t)n=null===(a=h.C.findSelectableFromStore(e))||void 0===a||null===(a=a.getNode())||void 0===a?void 0:a.getBoundingClientRect();else if(t===r.Ti.table){var s,l;const t=null===(s=h.C.findSelectableFromStore(e))||void 0===s?void 0:s.getNode(),o=null==t?void 0:t.getBoundingClientRect(),r=null==t||null===(l=t.querySelector(F))||void 0===l?void 0:l.getBoundingClientRect();n=i?o:o&&r?o.width<r.width?o:r:o||r}else if(e.isInlineCollectionView()){var c,d;const t=null===(c=h.C.findSelectableFromStore(e))||void 0===c?void 0:c.getNode();n=i?null==t?void 0:t.getBoundingClientRect():null==t||null===(d=t.querySelector(E))||void 0===d?void 0:d.getBoundingClientRect()}return n&&n.right>o.left?n:void 0})).filter(c.$K).map((e=>{const t=G({rect:e,currentScrollTop:n});return new DOMRect(e.left,t,e.width,e.height)}))}({pageContentStores:n,currentScrollTop:P,marginContainerRect:R,isFullWidth:_}).sort((e=>-e.top));Z=Z.sort(W).map(((e,t)=>{e.offsetTop-B>=18&&(e.offsetTop-=18);const n=e.id,o=i.get(e.id);if(!o)return"new"===e.type||v||(e.offsetTop=-9999,e.hide=!0),e;const r=o.getBoundingClientRect(),a=r.height;let s=e.offsetTop;return s<=T&&(s=T),U&&(s=function(e,t){const n={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,left:e.left,bottom:e.bottom,right:e.right};let o=t[t.length-1];for(;o;)if((0,b.dQ)(n,o))n.top=o.bottom+10,n.bottom=n.top+n.height,t.pop(),o=t[t.length-1];else{if(n.bottom<o.top)return n.top;t.pop(),o=t[t.length-1]}return n.top}(new DOMRect(r.left,s,r.width,r.height),U)),n===j&&0===M&&(M+=s-e.offsetTop,e.selected=!0,V=t),e.offsetTop=s,e.height=a,T=e.offsetTop+a,e}));const O=Z.map((e=>(e.offsetTop=e.offsetTop-B,e)));let N;if(M>0&&void 0!==V)for(let o=V;o>=0;o--){const e=O[o];if(e.height){if(e.id===j)e.offsetTop-=M;else{if(!(N&&N.offsetTop<=e.offsetTop+e.height))break;e.offsetTop-=M}N=e}}g({data:O,hasNewDiscussion:Boolean(L),selectedDiscussion:s},x)}),100);function G(e){let{rect:t,currentScrollTop:n}=e;return t.top+n}},92120:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){}getFirstSelectedDiscussionId(){var e;return null===(e=this.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0]}}const a=new r;(0,i.exposeDebugValue)("DiscussionHoverStore",a);const s=a},82994:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(26263),i=n(49085),r=n(4615),a=n(70279),s=n(35661);class l extends i.default{constructor(e,t){super(),this.environment=void 0,this.spaceId=void 0,this.environment=e,this.spaceId=t,this.reset()}getInitialState(){if(!this.environment)return;const e=new o.Z({name:"DiscussionInputStore"});return{textStore:new s.ST({environment:this.environment,pointer:{table:a.x_,id:(0,r.ZP)(),spaceId:this.spaceId},path:["text"],inMemoryRecordCache:e}),localRecordCache:e,files:[],showAttachFileIntro:!1,renderFileAttachIntro:!1}}isEmpty(){const e=this.state.textStore.getValue();return!e||0===e.length}}const c=l},48514:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(49085),i=n(92595),r=n(15723);class a extends o.default{getInitialState(){return{open:!1,rect:r.bM}}}const s=new a;(0,i.exposeDebugValue)("NewDiscussionMenuStore",s);const l=s},9080:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(15723);class r extends o.default{getInitialState(){return{open:!1,rect:i.bM}}}const a=new r},24736:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(24405),i=n(56666),r=n(64921),a=n(85893);function s(e){let{onClick:t,className:n,isMobile:s,style:l,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:p,onMouseLeave:m}=e;window.__c={n:"ActionMenuButton"};const{buttonStyle:f,iconStyle:g}=(0,o.yK)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:3,width:s?45:24,height:s?45:24,marginRight:s?-8:-6,...l},iconStyle:{width:s?18:14,height:s?18:14,fill:e.mediumIconColor}})),[s,l]);return(0,a.jsx)(r.Z,{onClick:t,style:f,className:n,mobileFeedback:s,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:p,onMouseLeave:m,children:(0,i.o)(g)})}},1292:(e,t,n)=>{n.d(t,{Z:()=>V});var o=n(67294),i=n(73935),r=n(83355),a=n(15145),s=n(70037),l=n(21202),c=n(33709),d=n(23867),u=n(82990),p=n(5366),m=n(50906),f=n(75018),g=n(97444),h=n(32741),v=n(95477),b=n(66213),y=n(14976),S=n(35683),_=n(84210),w=n(98165),k=n(77907),I=n(77080),C=n(61738),x=n(72014),T=n(31194),M=n(35661),P=n(24736),A=n(85854),R=n(68709),D=n(31945),B=n(84076),E=n(31278),F=n(76798),Z=n(24813),L=n(85893);class j extends A.Z{constructor(){super(...arguments),this.nodeRef=o.createRef(),this.state={isHovered:!1},this.origin=o.createRef(),this.handlePageClick=()=>{const{store:e}=this.props;m.Se(this.environment),C.Z.recordVisit({id:e.id,blockType:e.getType(),type:S.vu.Link,currentUserId:this.environment.currentUser.id}),m.SK1(this.environment,{page_visit_id:x.$g.getCurrentPageVisitId(),mentioned_page_id:e.id,source_type:"alias_block",hover_preview_enabled:I.default.checkGate("first_party_links"),is_navigable_block:e.isNavigableBlock()})},this.handlePageMouseOver=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&g.Nh({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handlePageMouseOut=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&g.Zl({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}activate(){const{store:e}=this.props;this.navigate(e)}willUnmount(){super.willUnmount(),h.qA(this.props.store.getTitleStore())}navigate(e){if(this.context.overrideLinkClick){const t=(0,_.ZP)({store:e,pageVisitSource:a.tY.LinkInPage});this.context.overrideLinkClick(t)}else f.navigateToBlock({environment:this.environment,store:e,visitType:S.vu.Link,pageVisitSource:a.tY.LinkInPage})}renderPersisted(){const{disabled:e,store:t}=this.props,n=t.getAliasTargetStore();if(!n)return;if(n instanceof M.G)return(0,L.jsx)(R.p,{allowSelectionWithin:!1,onMouseOver:this.handlePageMouseOver,onMouseOut:this.handlePageMouseOut,children:(0,L.jsx)(Z.Z,{ref:this.nodeRef,store:n,style:{...this.getBlockColorStyle(),...this.props.style},isAlias:!0,aliasStore:t,disabled:e,onClick:this.handlePageClick})});const o=w.Dg(n);if("none"===n.getRole())return(0,L.jsx)(R.p,{allowSelectionWithin:!1,children:(0,L.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:3},children:(0,L.jsx)(B.Z,{ref:this.origin,style:{width:"100%"},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:(0,L.jsxs)("div",{style:{display:"flex",padding:9},children:[(0,s.h)({width:30,height:30,marginRight:10,marginLeft:5}),(0,L.jsxs)("div",{style:{fontSize:14},children:[(0,L.jsx)("div",{style:{fontWeight:u.Z.fontWeight.medium},children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"No access to page comments",id:"aliasBlock.comment.noAccess.title"})}),(0,L.jsx)(p.FormattedMessage,{defaultMessage:"You don't have permission to view this page and its comments",id:"aliasBlock.comment.noAccess.subtitle"})]})]})})})});if(!o||!n.isDefined())return this.renderShimmerState();const i=M.t1.createChildStore(o,{table:c.qF,id:n.getParentId(),spaceId:(0,d.C)(o.pointer.spaceId)});if(null==i||!i.isDefined())return;const r=i.getModel(),m=M.G.createChildStore(o,r.getParentPointer()).getModel(),f=m&&"table_row"===m.getType()?m.getParentId():r.getParentId(),g=M.t1.createChildStore(o,{table:l.iU,id:f,spaceId:(0,d.C)(o.pointer.spaceId)});if(!g.isDefined())return;const h=o.isDefined()?g.getModel().getRenderUrl({getRecordModel:t.getRecordModel,baseUrl:v.default.domainBaseUrl,discussionId:i.id,pageVisitSource:a.tY.LinkInPage}):void 0,{isMobile:b}=this.environment.device;return(0,L.jsx)(R.p,{allowSelectionWithin:!1,children:(0,L.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,cursor:"pointer",borderRadius:3},children:(0,L.jsxs)(B.Z,{ref:this.origin,style:{display:"flex",flexDirection:"column"},href:h,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,L.jsxs)("div",{style:{display:"flex"},children:[(0,L.jsx)(k.LazyComment,{store:n,discussionStore:i,showResolveButtonByDefaultIfPossible:!1,blockStore:t,hoveringDiscussion:!1,discussionLocation:"comment_unfurl",collapsed:!0,maxLines:2},n.id),(0,L.jsx)(D.ZP,{popupType:b?D.Z4.SlideUp:D.Z4.Popup,renderOrigin:e=>(0,L.jsx)(P.Z,{...e,isMobile:b,style:{margin:8,opacity:b||this.state.isHovered?1:0}}),placementToOrigin:T.Iw.Top,render:e=>(0,L.jsx)(k.LazyAliasBlockPopupMenu,{onAccept:e.close,block:t})})]}),o&&(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:"50px",marginBottom:"10px"},children:[(0,L.jsx)(E.Z,{disabled:!0,icon:o.getIcon(),isEmptyPage:o.isEmptyPage(),size:14,style:{marginLeft:2,marginRight:2}}),(0,L.jsx)(F.Z,{store:o,style:{color:"gray",fontSize:"smaller"}})]})]})})})}getInteractiveToken(){const e=this.props.store.getAliasTargetStore();if(!(this.nodeRef&&this.nodeRef.current&&e instanceof M.G))return;const t=i.findDOMNode(this.nodeRef.current);return(0,y.We)(e,t)}renderShimmerState(){return(0,L.jsxs)(B.Z,{external:!0,style:{flexGrow:1,minWidth:0},children:[this.renderShimmerbox({width:38,height:38}),(0,L.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[this.renderShimmerbox({width:"50%",height:14,margin:4}),this.renderShimmerbox({width:"40%",height:12,margin:4})]})]})}renderShimmerbox(e){return(0,L.jsx)("div",{style:{overflow:"hidden",position:"relative",background:this.theme.selectLightGray[30],...e},children:(0,L.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${this.theme.selectLightGray[30]} 0%, ${this.theme.selectLightGray[50]} 20%, ${this.theme.selectLightGray[30]} 40%, ${this.theme.selectLightGray[30]} 100%)`}})})}}j.contextTypes={...b.wK,...r.w};const V=j},77933:(e,t,n)=>{n.d(t,{Z:()=>P});n(67294);var o=n(83355),i=n(49085),r=n(56666),a=n(5366),s=n(80365),l=n(15145),c=n(9999),d=n(82990),u=n(84210),p=n(67669),m=n(18514),f=n(80444),g=n(81236),h=n(84076),v=n(31278),b=n(76798),y=n(94096),S=n(78454),_=n(32469),w=n(85893);class k extends o.Z{constructor(){super(...arguments),this.isPrivate=this.createComputedStore((()=>!(0,p.yi)(this.environment,this.props.currentBlockStore)&&(0,p.yi)(this.environment,this.props.backlinkStore)))}renderComponent(){const{backlinkStore:e,scrollToBlockId:t,discussionId:n}=this.props,{mainEditorCurrentBlockStore:o}=f.default.state,i=o&&o.id===e.id,r=(0,u.ZP)({store:e,scrollToBlockId:t,discussionId:n,fullyQualified:!0,preferPublicLink:(0,m.Sr)(),getSpaceDomain:()=>{var t;return null===(t=g.Z.getPublicSpaceData(this.environment,e.getSpaceId()))||void 0===t?void 0:t.domain},pageVisitSource:l.tY.LinkInPage});return(0,w.jsx)(h.Z,{href:r,external:!1,innerStyle:{paddingLeft:8,paddingRight:16},children:(0,w.jsx)(S.ZP,{childrenStyle:this.getChildrenStyle(),alignment:S.v2.Center,style:{marginBottom:2,marginRight:4},right:(0,w.jsxs)(w.Fragment,{children:[this.props.showOriginalToken&&(0,w.jsx)("div",{style:this.getTokenStyle(),children:(0,w.jsx)(a.FormattedMessage,{defaultMessage:"Original",id:"backlink.originalTokenLabel"})}),i&&!this.props.disableCurrentPageToken&&(0,w.jsx)("div",{style:this.getTokenStyle(),children:(0,w.jsx)(a.FormattedMessage,{defaultMessage:"This page",id:"backlink.currentPageTokenLabel"})})]}),children:(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[!this.props.disableArrow&&this.renderArrowIcon(),this.renderIcon(),(0,w.jsx)(b.Z,{store:e,style:this.getTitleStyle()}),(0,w.jsxs)("div",{style:{marginTop:-2,minWidth:0,display:"flex",alignItems:"baseline",flex:"2 0 40%",paddingTop:"0.1em"},children:[(0,w.jsx)(y.Z,{store:e,style:{paddingLeft:8}}),this.renderPrivate()]})]})})})}renderArrowIcon(){return(0,w.jsx)("div",{style:{marginLeft:4,transform:"rotate(180deg)",fill:this.theme.regularIconColor},children:(0,c.J)({width:15,height:15})})}renderIcon(){const{backlinkStore:e}=this.props;return(0,w.jsx)(v.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:20,style:{marginLeft:4,marginRight:4}})}renderPrivate(){if(this.isPrivate.state)return(0,w.jsx)(_.Z,{style:{paddingRight:4,marginLeft:12}})}getTitleStyle(){return{fontWeight:d.Z.fontWeight.medium,fontSize:d.Z.fontSize.UIRegular.desktop,lineHeight:1.3,borderBottom:`1px solid ${this.theme.darkDividerColor}`,flexShrink:1}}getChildrenStyle(){return{padding:"4px 2px"}}getTokenStyle(){const{device:e}=this.environment;return{padding:"2px 6px",borderRadius:3,color:this.theme.mediumTextColor,background:this.theme.legacyDefaultSelectColor,fontSize:e.isMobile?11:9,lineHeight:e.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",whiteSpace:"nowrap",marginLeft:4}}}k.displayName="Backlink";const I=(0,a.injectIntl)(k);var C=n(89728),x=n(26388),T=n(64369);class M extends o.Z{constructor(){super(...arguments),this.storeTypes={showMore:i.default.createClass(10),hovered:i.default.createClass(!1)},this.handleMouseMove=()=>{this.stores.hovered.setState(!0)},this.handleMouseLeave=()=>{this.stores.hovered.setState(!1)},this.handleShowMore=()=>{this.stores.showMore.setState(this.stores.showMore.state+10)},this.backlinksState=this.createComputedStore((()=>(0,s.L)(this.props.store,this.environment)),!0)}renderComponent(){const{originalTransclusionStore:e,disableInaccessiblePages:t}=this.props,n=this.backlinksState.state,o=this.stores.showMore.state,i=e?e.getNavigableBlockStore():void 0;if(0===n.backlinks.length&&!e)return;const s=n.backlinks.length>o,l=n.inaccessibleBacklinkCount>0&&!t;return(0,w.jsxs)("div",{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[this.props.headerText&&this.renderHeader(),e&&i&&(0,w.jsx)(I,{currentBlockStore:this.props.store,disableArrow:this.props.disableArrow,disableCurrentPageToken:this.props.disableCurrentPageToken,backlinkStore:i,scrollToBlockId:e.id,showOriginalToken:!0}),n.backlinks.slice(0,o).map((e=>(0,w.jsx)(I,{currentBlockStore:this.props.store,disableArrow:this.props.disableArrow,disableCurrentPageToken:this.props.disableCurrentPageToken,...e},e.backlinkStore.id))),(s||l)&&(0,w.jsx)(x.Z,{disableTooltip:s,renderTooltip:()=>(0,w.jsx)(a.FormattedMessage,{defaultMessage:"Synced in pages that you don't have access to.",id:"page.backlinks.privatePagesTooltip"}),render:e=>(0,w.jsx)(C.Z,{icon:r.o,isGray:!0,onClick:this.handleShowMore,style:{padding:`2px ${this.props.disableArrow?17:14}px`,width:"100%"},disabled:!s,...e,children:s?(0,w.jsx)(a.FormattedMessage,{defaultMessage:"{count} more",id:"page.backlinks.more",values:{count:n.backlinks.length-o}}):(0,w.jsx)(a.FormattedMessage,{id:"page.backlinks.privatePages",defaultMessage:"{count, plural, one {{count} private page} other {{count} private pages}}",values:{count:n.inaccessibleBacklinkCount}})})})]})}renderHeader(){return(0,w.jsx)("div",{style:{display:"flex"},children:(0,w.jsx)(T.Z,{isSmall:!0,style:{marginTop:12,marginBottom:8,marginLeft:4,flex:1,paddingLeft:8},children:this.props.headerText})})}}M.displayName="Backlinks";const P=M},4350:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(83355),i=n(23867),r=n(80444);class a extends o.Z{willMount(){this.shouldDisableBacklinks()||this.environment.LocalBacklinkStore.initializeBacklinks({block:{id:this.props.store.pointer.id,spaceId:(0,i.C)(this.props.store.pointer.spaceId)},currentUserId:this.environment.currentUser.id,environment:this.environment})}willUnmount(){this.shouldDisableBacklinks()||this.environment.LocalBacklinkStore.destroyBacklinks(this.props.store.id,this.environment)}shouldDisableBacklinks(){const{mainEditorCurrentBlockStore:e}=r.default.state;return Boolean(e&&"15776535-3f2c-4705-bd45-474e5ba8b46c"===e.id)}}a.displayName="BacklinksListener";const s=a},85854:(e,t,n)=>{n.d(t,{Z:()=>C});var o=n(67294),i=n(83355),r=n(13991),a=n(8848),s=n(82990),l=n(92650),c=n(67669),d=n(65598),u=n(58202),p=n(35661),m=n(99757),f=n(480),g=n(86628),h=n(41432),v=n(25487),b=n(78175),y=n(98165),S=n(77907),_=n(24646),w=n(85893);function k(e){let{disableCommentMenu:t,hideContent:n,hideIfSidebarOrMarginCommentsVisible:i,recursivelyLoadAllDiscussions:r,store:a,style:s}=e;window.__c={n:"BlockDiscussionIndicator"};const c=(0,f.O7)(),d=(0,f.Fy)(),u=(0,g.VK)((()=>{const e=a.getModel();return Boolean(null==e?void 0:e.isType(h.eh))}),[a]),m=(0,g.VK)((()=>{const e=(0,y.qA)(a);let t,n,o,i;for(const r of e){if(r instanceof p.G&&t){const e=r.getType();if(e&&(0,h.S9)(e)&&r.id!==a.id)break;if("column_list"===e){const e=r.getContentStore().getValue()||[];n=e.indexOf(t.id),o=e.length,i=(0,b.Po)(r,c)}}t=r}return{columnListIndex:n,columnListColumnCount:o,columnListResizable:i}}),[c,a]),k=(0,o.useCallback)((()=>{if(!d.isMobile){if(void 0===m.columnListIndex)return v.DiscussionIndicatorFormat.FloatRight;if(!m.columnListResizable&&m.columnListColumnCount&&m.columnListIndex===m.columnListColumnCount-1)return v.DiscussionIndicatorFormat.FloatRight}return v.DiscussionIndicatorFormat.PushContent}),[m.columnListColumnCount,m.columnListIndex,m.columnListResizable,d.isMobile]),I=(0,g.VK)((()=>(0,_.Sx)(c)),[c]),C=(0,g.VK)((()=>(0,l.fg)(c,a)),[c,a]);return t||n||(u||i)&&(I||C)?null:(0,w.jsx)(S.LazyDiscussionIndicator,{store:a,getFormat:k,style:s,recursivelyLoadAllDiscussions:Boolean(r),onlyCountBlockLevelDiscussions:I},"DiscussionIndicator")}class I extends i.Z{constructor(){super(...arguments),this.blockStore=()=>this.props.store,this.canEditComputedStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(m.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,c.YF)(e)&&this.props.store.canEdit()})),this.marginCommentsVisible=this.createComputedStore((()=>(0,l.fg)(this.environment,this.props.store))),this.rootStorePageFont=this.createComputedStore((()=>{const e=this.props.store.getRecordStoreUIRoot();if(!(e instanceof p.G))return;const t=e.getFormatStore().getKeyStore("page_font").getValue();return s.Z.getHeaderFontFamily({pageFont:t,locale:r.SP})}))}get registries(){return[u.R]}canEdit(){return this.canEditComputedStore.state}canEditCollection(){if(this.props.disabled)return!1;if(m.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,c.YF)(e)&&this.props.store.canEditCollection()}canComment(){return!this.props.disabled&&(!m.n.state&&this.props.store.canComment())}canAdmin(){return!this.props.disabled&&(!m.n.state&&this.props.store.canAdmin())}canView(){const{store:e}=this.props;return e.canRead()}isRootOrDirectChild(){return this.props.store.isRootOrDirectChild()}renderComponent(){const{store:e}=this.props;if(e)return e?(0,d.SJ)(e)?void 0:this.renderPersisted():void 0}renderPersisted(){}renderDiscussion(e){const{style:t,recursivelyLoadAllDiscussions:n,hideIfSidebarOrMarginCommentsVisible:o}=e||{};return(0,w.jsx)(k,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,hideIfSidebarOrMarginCommentsVisible:o,recursivelyLoadAllDiscussions:n,store:this.props.store,style:t})}getBlockColorStyle(){const e=this.props.store.getFormat().block_color||"default";return(0,a.fi)(e,this.theme)}}I.displayName="Block";const C=I},13966:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(83355),i=n(56666),r=n(6404),a=n(24677),s=n(43250),l=n(98742),c=n(27724),d=n(64921),u=n(26388),p=n(85893);class m extends o.Z{constructor(){super(...arguments),this.renderButton=e=>(0,p.jsx)(d.Z,{className:this.props.fadeIn?s.JiD:void 0,style:this.getButtonStyle(),hoveredStyle:this.props.hoveredStyle,onClick:this.handleActionButtonClick,...(0,l.Z)(e,{onFocus:this.props.onFocus,onBlur:this.props.onBlur}),children:(0,i.o)({width:14,height:14,...this.props.iconStyle})}),this.handleActionButtonClick=e=>{const{store:t,onClick:n,extraAnalyticsData:o}=this.props;a.Ys({environment:this.environment,store:t}),r.Qn({environment:this.environment,stores:c.default.state.stores,left:e.clientX,top:e.clientY,showInput:!this.props.hideFilterActionsInput,actionSectionGroupKey:this.props.actionSectionGroupKey||"default",analyticsFrom:"block_more_menu",optionalAnalyticsProperties:{isFromBulkActionsToolbar:o?o.isFromBulkActionsToolbar:void 0}}),null==n||n()}}renderComponent(){return this.props.tooltipContent?(0,p.jsx)(u.Z,{renderTooltip:()=>this.props.tooltipContent,delayThreshold:300,render:this.renderButton}):this.renderButton({})}getButtonStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:24,height:24,borderRadius:3,fill:e.isMobile?this.theme.lightIconColor:this.theme.mediumIconColor,transition:"opacity 200ms ease-in",...this.props.style}}}m.displayName="BlockActionMenuButton";const f=m},91893:(e,t,n)=>{n.d(t,{Z:()=>h});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(5366),c=n(92650),d=n(68056),u=n(24646),p=n(24666),m=n(65187),f=n(85893);const g=(0,l.defineMessages)({imageCaption:{defaultMessage:"Write a caption…",id:"block.imageCaption.placeholder"}});function h(e){let{captionAriaId:t,disabled:n,store:h}=e;window.__c={n:"BlockCaption"};const v=(0,i.O7)(),b=(0,i.Fy)(),y=(0,l.useIntl)(),S=(0,o.useMemo)((()=>h.getPropertyStore("caption")),[h]),_=(0,r.VK)((()=>{var e;const t=S.getValue(),n=!t||0===t.length,o="editing"===p.default.state.mode&&(null===(e=(0,d.QY)(p.default.state.multiSelection))||void 0===e?void 0:e.store)===S;return!n||o}),[S]),w=(0,r.VK)((()=>{const{block_full_width:e,block_width:t,block_page_width:n}=h.getFormat();if(b.isMobile)return!1;if(n)return!1;if(e)return!0;const o=(0,c.fg)(v,h);return(t||0)>=v.WindowSizeStore.state.width-(0,u.Wk)(v)-(o&&h.isFullWidth()?c.QB:0)}),[b.isMobile,v,h]),k=(0,a.yK)((e=>({root:{fontSize:14,lineHeight:1.4,color:e.mediumTextColor,paddingTop:6,paddingBottom:6,paddingLeft:s.ZD.paddingLeft,...w&&{paddingLeft:26,paddingRight:26}}})),[w]);return _?(0,f.jsx)(m.Z,{id:t,disabled:n,style:k.root,placeholderStyle:k.root,placeholder:y.formatMessage(g.imageCaption),disableSlashCommands:!0,disableEmbedMenu:!0,store:S,pasteBehavior:"block"}):null}},70518:(e,t,n)=>{n.d(t,{IS:()=>k,ZP:()=>x,bZ:()=>I});n(21703),n(67294);var o=n(73935),i=n(83355),r=n(41432),a=n(95538),s=n(72126),l=n(50906),c=n(96802),d=n(24677),u=n(39699),p=n(28020),m=n(43250),f=n(77546),g=n(58202),h=n(49427),v=n(68859),b=n(35661),y=n(91681),S=n(27724),_=n(6685),w=n(85893);let k=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Corner=2]="Corner",e}({}),I=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class C extends i.Z{constructor(){super(...arguments),this.dragState=void 0,this.domElm=null,this.storeTypes={blockResizerStore:v.Z},this.handleRef=e=>{this.domElm=e},this.handleDragStart=e=>{e.preventDefault();const t=o.findDOMNode(this.props.resizeComponent);if(!(t&&t instanceof Element))return;let n=0;if(this.domElm){const e=(0,f.VW)(this.domElm);e&&(n=e.getBoundingClientRect().width)}let i=0;const r=this.props.store.getRecordStoreUIParent(),a=r&&r.findRecordStoreUIAncestor((e=>e instanceof b.G)).ancestor;if(a){const e=g.R.getRect(a);e&&(i=e.width);const t=a.getRecordStoreUIParent(),n=t&&t.findRecordStoreUIAncestor((e=>e instanceof b.G)).ancestor;if("tab"===(null==n?void 0:n.getType())){const e=g.R.getRect(n);e&&(i=e.width)}}const l=this.getPageViewWrapWidth()||0,c=S.default.state.stores.filter((e=>this.isResizable(e)));let u;u=s.q9(c,this.props.store)?c:[this.props.store];const{block_width:p,block_height:m,block_full_width:h,block_page_width:v}=this.props.store.getFormat();this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,dragging:!0,temporaryHeight:m,temporaryWidth:p,temporaryFullWidth:h,temporaryPageWidth:v}),y.Z.setState({...y.Z.state,isResizing:!0}),d.ZH(this.environment);const _=t.getBoundingClientRect();this.dragState={resizingBlocks:u,startWidth:_.width,startHeight:_.height,parentWidth:i,pageWidth:l,isRootChild:this.props.store.isChildOfRecordStoreUIRoot(),startScrollerWidth:n,didDragMove:!1}},this.handleHorizontalDragMove=e=>{let{diffX:t}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{temporaryHeight:n}=this.stores.blockResizerStore.state,{width:o,isFullWidth:i,isPageWidth:r}=this.getNewWidthStyleValue(t);if(this.props.preserveScale){const e=i?n||a.QA:n;this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:o,temporaryFullWidth:i,temporaryPageWidth:r,temporaryHeight:e})}else this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:o,temporaryFullWidth:i,temporaryPageWidth:r})},this.handleVerticalDragMove=e=>{let{diffY:t}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{height:n}=this.getNewHeightStyleValue(t);this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryHeight:n})},this.handleCornerDragMove=e=>{let{diffX:t,diffY:n}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{width:o,isFullWidth:i,isPageWidth:r}=this.getNewWidthStyleValue(t),{height:a}=this.getNewHeightStyleValue(n);this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:o,temporaryHeight:a,temporaryFullWidth:i,temporaryPageWidth:r})},this.handleDragMove=e=>this.props.resizerType===k.Horizontal?this.handleHorizontalDragMove(e):this.props.resizerType===k.Vertical?this.handleVerticalDragMove(e):this.props.resizerType===k.Corner?this.handleCornerDragMove(e):void 0,this.handleDragEnd=e=>{if(!this.dragState)return;const t=this.stores.blockResizerStore.state;if(this.dragState.didDragMove&&t.dragging){const{temporaryPageWidth:e,temporaryFullWidth:t,temporaryWidth:n,temporaryHeight:o}=this.stores.blockResizerStore.state;u.createAndCommit({userAction:"BlockResizer.handleDragEnd",environment:this.environment,perform:i=>{this.dragState&&c.FH({stores:this.dragState.resizingBlocks,update:{block_height:o,block_width:n,block_full_width:t,block_page_width:e},transaction:i})}});const i=this.props.store.getType();i&&l.Wlu(this.environment,{block_type:i,block_height:o,block_width:n,block_full_width:t,block_page_width:e})}this.endDrag()},this.handleDragCancel=e=>this.endDrag()}renderComponent(){return(0,w.jsx)(_.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,preventSidebar:!0,render:e=>(0,w.jsx)("div",{ref:this.handleRef,style:C.style,className:m.Ep8,...e,children:this.props.children})})}isResizable(e){const t=e&&e.getType();return t&&r.Ok[t]}isCenterAligned(){const e=this.props.store.getModel();return this.props.store.isChildOfRecordStoreUIRoot()&&(null==e?void 0:e.isType(r.ib))}endDrag(){this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,dragging:!1,temporaryPageWidth:void 0,temporaryFullWidth:void 0,temporaryWidth:void 0,temporaryHeight:void 0}),d.ZH(this.environment),y.Z.setState({...y.Z.state,isResizing:!1}),this.dragState=void 0}getNewHeightStyleValue(e){const t=this.getNewPixelHeight(e);return{height:Math.min(t,a.Kz)}}getNewPixelHeight(e){if(this.dragState){if(this.props.resizeVertically){const t=this.props.store.getType(),n=t&&C.minHeightMap[t]||C.defaultMinHeight;return Math.max(this.dragState.startHeight+e,n)}return this.dragState.startHeight}return 0}getNewWidthStyleValue(e){const t=this.getNewPixelWidth(e),n=this.getRound(t),o=Math.round(t/n)*n,i=this.isPageWidth(t,n);return{width:o,isFullWidth:this.isFullWidth(t,n)&&!i,isPageWidth:i}}isPageWidth(e,t){return!!this.dragState&&(this.dragState.isRootChild?this.dragState.pageWidth<e+t&&this.dragState.pageWidth>e-t:this.dragState.parentWidth<e+t)}isFullWidth(e,t){if(this.dragState&&this.dragState.isRootChild){let n=this.dragState.startScrollerWidth;const o=this.props.store.getModel();return o&&!o.isType(r.GP)&&(n-=2*(0,p.ui)(this.environment)),n<e+t}return!1}getNewPixelWidth(e){if(!this.dragState)throw new Error("No start rect.");this.isCenterAligned()&&(e*=2);let t=this.dragState.startWidth;this.props.resizeHorizontally&&(this.props.resizerAlignment===I.Left?t-=e:this.props.resizerAlignment===I.Right&&(t+=e));const n=this.props.store.getType(),o=n&&C.minWidthMap[n]||C.defaultMinWidth,i="page_width"===o?Math.min(this.dragState.parentWidth,this.dragState.pageWidth):o;return i&&t<i&&(t=i),t}getRound(e){return e<144?12:48}getPageViewWrapWidth(){const e=this.props.store.getRecordStoreUIRoot(),t=h.Z.find((t=>t.props.store===e));if(t)return t.getContentInnerWidth()}}C.displayName="BlockResizer",C.defaultMinWidth=96,C.minWidthMap={[r.Ti.image]:36,[r.Ti.video]:96,[r.Ti.embed]:246,[r.Ti.maps]:96,[r.Ti.framer]:96,[r.Ti.tweet]:250,[r.Ti.gist]:96,[r.Ti.audio]:96,[r.Ti.drive]:300,[r.Ti.invision]:96,[r.Ti.pdf]:96,[r.Ti.columnList]:"page_width",[r.Ti.drawing]:300},C.defaultMinHeight=96,C.minHeightMap={[r.Ti.image]:36,[r.Ti.audio]:24,[r.Ti.video]:96,[r.Ti.embed]:96,[r.Ti.drive]:96,[r.Ti.tweet]:96,[r.Ti.framer]:96,[r.Ti.maps]:96,[r.Ti.gist]:96,[r.Ti.invision]:96,[r.Ti.pdf]:96,[r.Ti.drawing]:200},C.style={display:"contents"};const x=C},7825:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(49271),i=n(22491),r=n(5366),a=n(33929),s=n(85854),l=n(55217),c=n(78454),d=n(65187),u=n(85893);const p=(0,r.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"bulletedListBlock.placeholder.label"}});class m extends s.Z{constructor(){super(...arguments),this.bulletStore=this.createComputedStore((()=>{var e;const t=null===(e=this.props.bulletedListFormatStore)||void 0===e?void 0:e.getState();return function(e,t){switch(e){case"disc":return'"•"';case"circle":return'"◦"';case"square":return'"▪"';default:return t%3==0?'"•"':t%3==1?'"◦"':'"▪"'}}(null==t?void 0:t.blockIdFormats.get(this.props.store.id),(null==t?void 0:t.depth)||0)}))}renderPersisted(){const{store:e,disabled:t}=this.props;return(0,u.jsxs)(c.ZP,{style:this.getStyle(),left:(0,u.jsx)("div",{...(0,i.iv)({fontSize:"1.5em",lineHeight:1,marginBottom:0,pseudoBefore:{fontFamily:"Arial",content:this.bulletStore.state}})}),childrenStyle:{display:"flex",flexDirection:"column"},children:[(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsx)(d.Z,{style:c.R8,disabled:t,store:e.getBlockTitleStore(),placeholder:a.default.formatMessage(p.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),this.renderDiscussion({style:m.discussionIndicatorStyle})]}),!this.props.hideContent&&(0,u.jsx)(l.Z,{disabled:t,store:e.getContentStore(),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag,bulletedListFormatStore:this.props.bulletedListFormatStore})]})}getStyle(){return{...{paddingLeft:o.ZD.paddingLeft},...this.getBlockColorStyle(),...this.props.style}}}m.discussionIndicatorStyle={paddingLeft:0,marginLeft:-6,paddingBottom:2};const f=m},27755:(e,t,n)=>{n.d(t,{y:()=>z,Z:()=>q});n(57658);var o=n(67294),i=n(1302),r=n(480),a=n(86628),s=n(24405),l=n(63362),c=n(18442),d=n(54497),u=n(72126),p=n(5366),m=n(97880),f=n(82990),g=n(24677),h=n(98104),v=n(93174),b=n(2553),y=n(41301),S=n(82343),_=n(33929),w=n(98742),k=n(52315),I=n(63474),C=n(49085);class x extends C.default{getInitialState(){return{editing:!1,suppressErrorsForActionIds:[]}}startEditing(e){this.setState({editing:!0,suppressErrorsForActionIds:[],placement:e.placement})}stopEditing(){this.setState({editing:!1,suppressErrorsForActionIds:[]})}suppressErrorsForAction(e){this.setState({...this.state,suppressErrorsForActionIds:u.jj([...this.state.suppressErrorsForActionIds,e])})}}const T=x;var M=n(31792),P=n(35661),A=n(77794),R=n(85854),D=n(13966),B=n(68709),E=n(73063),F=n(68785),Z=n(63296),L=n(31278),j=n(26388),V=n(59557),U=n(33831),O=n(85893);const N=function(){window.__c={n:"SettingsIconWithNotificationBadge"};const e=(0,s.yK)((e=>({settingsIcon:{fill:e.mediumIconColor},notificationBadge:{fill:e.blueColor,stroke:e.buttonBackground}})),[]);return(0,O.jsxs)(U.Z,{className:"settingsIconWithNotificationBadge",viewBox:"0 0 16 16",style:{width:16,height:16},children:[(0,O.jsx)("path",{d:"M6.406 15.36c-.492 0-.867-.299-.978-.762l-.24-1.037-.159-.059-.902.557c-.404.258-.885.193-1.23-.152l-.82-.82c-.347-.346-.411-.827-.153-1.231l.562-.896-.058-.147-1.032-.24a.981.981 0 01-.761-.979V8.44c0-.48.293-.861.761-.979l1.02-.246.064-.152-.562-.897c-.258-.404-.193-.878.152-1.236l.82-.82a.972.972 0 011.231-.153l.902.551.165-.064.24-1.037c.111-.463.486-.762.978-.762H7.59c.486 0 .867.299.978.762l.24 1.037.165.064.902-.55c.404-.252.885-.188 1.225.152l.82.82c.346.358.41.832.152 1.236l-.556.897.058.152 1.026.246a.981.981 0 01.761.979v1.154c0 .48-.304.862-.761.979l-1.037.24-.053.146.556.897c.258.404.2.885-.152 1.23l-.82.82c-.34.346-.82.41-1.23.153l-.903-.557-.152.059-.24 1.037a.972.972 0 01-.98.762H6.407zm.14-1.06h.903c.1 0 .147-.042.158-.136l.352-1.44c.387-.089.72-.235 1.008-.417l1.265.78c.07.046.141.04.217-.03l.621-.627c.065-.058.065-.129.018-.205l-.773-1.265a3.85 3.85 0 00.404-.997l1.447-.345c.088-.018.135-.065.135-.164v-.88c0-.105-.041-.146-.135-.17l-1.441-.34a3.878 3.878 0 00-.405-1.007l.774-1.26c.053-.082.053-.152-.018-.216l-.627-.616c-.07-.07-.129-.076-.217-.029l-1.26.768a3.782 3.782 0 00-1.013-.41L7.607 3.84c-.011-.093-.058-.134-.158-.134h-.902c-.1 0-.147.046-.164.134l-.346 1.442a4.07 4.07 0 00-1.02.416l-1.26-.768c-.087-.047-.146-.035-.222.03l-.62.615c-.071.07-.071.14-.019.222l.774 1.26a3.94 3.94 0 00-.399 1.008l-1.447.34c-.088.023-.129.064-.129.17v.879c0 .1.041.146.13.164l1.446.345c.088.37.247.721.41.997l-.779 1.265c-.052.076-.047.147.018.211l.621.621c.076.07.147.076.217.03l1.265-.78a3.35 3.35 0 001.014.416l.346 1.441c.017.088.064.135.164.135zm.452-3.071a2.233 2.233 0 01-2.227-2.227c0-1.212 1.008-2.214 2.227-2.214a2.23 2.23 0 012.22 2.214 2.232 2.232 0 01-2.22 2.227zm0-1.002c.656 0 1.201-.557 1.201-1.225 0-.662-.545-1.207-1.2-1.207a1.22 1.22 0 00-1.22 1.207c0 .674.551 1.225 1.22 1.225z",...e.settingsIcon}),(0,O.jsx)("circle",{cx:"12",cy:"4",r:"3.5",...e.notificationBadge})]})},z=(0,p.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You don’t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});class H extends R.Z{constructor(){super(...arguments),this.sizeObserver=new A.E,this.buttonRef=o.createRef(),this.storeTypes={mouseStore:M.Z,buttonBlockStore:T},this.handleContainerMount=e=>{e&&this.sizeObserver.observe(e)},this.configureButtonBlock=e=>{const{buttonBlockStore:t}=this.stores;h.ZH(this.environment),g.ZH(this.environment);this.sizeObserver.rect.state.width<300&&!this.environment.device.isPhone&&e?t.startEditing({placement:{type:"popup",originRect:e}}):t.startEditing({placement:{type:"inline"}})},this.allActionDependenciesLoaded=this.createComputedStore((()=>{var e;const t=(null===(e=this.props.store.getAutomationStore())||void 0===e?void 0:e.getActionStores())??[];for(const n of t){const e=n.getBlockStores();for(const t of e)k.b(t)}}))}handleCreated(){i.default.afterNextFlush((()=>{var e;this.configureButtonBlock(null===(e=this.buttonRef.current)||void 0===e?void 0:e.getBoundingClientRect())}))}willUnmount(){this.sizeObserver.destroy()}willMountOrUpdate(e){super.willMountOrUpdate(e),this.allActionDependenciesLoaded.state}activate(){var e;null===(e=this.buttonRef.current)||void 0===e||e.activate()}renderPersisted(){const{disabled:e,store:t}=this.props,{mouseStore:n,buttonBlockStore:o}=this.stores;return(0,O.jsxs)(B.p,{allowSelectionWithin:!0,style:{display:"flex"},ref:this.handleContainerMount,children:[(0,O.jsxs)("div",{style:{flexGrow:1,flexShrink:1,minWidth:0},children:[(0,O.jsx)(W,{store:t,mouseStore:n,buttonBlockStore:o,onConfigure:this.configureButtonBlock,ref:this.buttonRef,disabledFromEditing:e}),(0,O.jsx)(v.O,{store:t,disabled:e,buttonBlockStore:o})]}),this.renderDiscussion({recursivelyLoadAllDiscussions:!0})]})}}const W=o.forwardRef(((e,t)=>{window.__c={n:"ButtonBlockButton"};const{store:n,mouseStore:i,buttonBlockStore:v,onConfigure:k,disabledFromEditing:C}=e,x=(0,p.useIntl)(),T=(0,r.O7)(),{isMobile:M}=(0,r.Fy)(),[A,R]=(0,o.useState)(!1),B=(0,a.VK)((()=>i.state.mouseEntered),[i]),U=(0,a.VK)((()=>n.getAutomationStore()),[n]),H=(0,a.VK)((()=>(null==U?void 0:U.getNameStore().getValue())??""),[U]),W=(0,a.VK)((()=>null==U?void 0:U.getIconStore().getValue()),[U]),q=function(e){const{store:t,automationStore:n,buttonBlockStore:o}=e,i=function(e){const{store:t,automationStore:n}=e,o=(0,r.O7)().currentUser.id;return(0,a.VK)((()=>{const e=t.getRecordStoreUIRoot();if(n&&e instanceof P.G)return(0,S.Gb)({type:"button_block",persisted:!0,automationStore:n,blockStore:t,pageStore:e,intl:_.default.getIntl(),parentRecordStore:n,currentUserId:o})}),[n,t,o])}({store:t,automationStore:n});return(0,a.VK)((()=>{const e=null==i?void 0:i.state;if(!e)return{type:"disabled"};if("insufficient"===e.executionPermissionStatus||"unknown"===e.executionPermissionStatus)return{type:"disabled",tooltip:z.buttonInsufficientPermissions};if("sufficient"===e.executionPermissionStatus){if(0===((null==n?void 0:n.getActionIds())??[]).length)return{type:"error",tooltip:y.Mm.noActions,hideErrorIconWhenEditorIsOpen:!0};const t=e.typecheckResult.value.actionValidationFailures,i=Object.entries(t).filter((e=>{let[t]=e;return!o.state.suppressErrorsForActionIds.includes(t)})).flatMap((e=>{let[,t]=e;return t})),r=u.Ps(i);return r?{type:"error",tooltip:(0,y.Fp)(r).forButtonTooltip}:{type:"enabled"}}(0,m.t1)(e)}),[i,n,o])}({store:n,automationStore:U,buttonBlockStore:v}),G="disabled"===q.type||A||"error"===q.type&&C,K=(0,a.VK)((()=>"error"===q.type&&!(q.hideErrorIconWhenEditorIsOpen&&v.state.editing)),[q,v]),{showFactoryButtonDeprecationBadge:$,setHasSeenFactoryButtonDeprecationBadge:Q}=(0,V.N)({blockStore:n}),Y=(0,s.yK)((e=>{const t=M?"52px":"28px";return{wrap:{display:"flex",alignItems:"center",padding:"2px 0"},configureWrap:{display:"flex",alignItems:"center",marginLeft:4},label:{pointerEvents:"none",...f.Z.textOverflowStyle},button:{display:"flex",gap:6,minWidth:50,maxWidth:`calc(100% - ${t})`,padding:"8px 12px",fontWeight:500,...G?{cursor:"not-allowed"}:{}},labelPlaceholder:{color:e.lightTextColor},warningIcon:{width:16,height:16,fill:e.errorText,color:e.errorText},spinnerWrap:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",marginLeft:-4}}}),[G,M]),J=(0,I.D)(),X=(0,o.useRef)(null),ee=(0,o.useCallback)((()=>{i.setState({...i.state,mouseEntered:!0})}),[i]),te=(0,o.useCallback)((()=>{i.setState({...i.state,mouseEntered:!1})}),[i]),ne=(0,o.useCallback)((()=>{var e;k(null===(e=X.current)||void 0===e?void 0:e.getBoundingClientRect())}),[k,X]),oe=(0,o.useCallback)((()=>{v.state.editing?(v.stopEditing(),(0,l.lN)(J,{block_id:n.id,automation_id:null==U?void 0:U.id})):(ne(),Q(),(0,l.yK)(J,{block_id:n.id,automation_id:null==U?void 0:U.id}))}),[v,J,n.id,null==U?void 0:U.id,ne,Q]),ie=(0,o.useCallback)((async()=>{const e=n.getRecordStoreUIRoot();if(U&&e instanceof P.G)if(h.ZH(T),g.ZH(T),"error"===q.type)C||ne();else if("enabled"===q.type)try{R(!0),await b.oS({environment:T,store:n,clientContext:{type:"button_block",persisted:!0,automationStore:U,blockStore:n,pageStore:e,intl:_.default.getIntl(),parentRecordStore:U,currentUserId:T.currentUser.id}})}finally{R(!1)}else"disabled"===q.type||(0,m.t1)(q)}),[n,U,T,q,C,ne]);(0,o.useImperativeHandle)(t,(()=>({activate:()=>{ie()},getBoundingClientRect:()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.getBoundingClientRect()}})),[ie]);const re=()=>(0,O.jsx)("div",{style:Y.spinnerWrap,children:(0,O.jsx)(F.Z,{})}),ae=[];var se;W&&(A?ae.push({key:"left",comp:re()}):ae.push({key:"left",comp:(se=W,(0,O.jsx)(L.Z,{largeIcon:!0,disabled:!0,isEmptyPage:!1,size:20,icon:{icon:se,pointer:n.pointer},style:{marginLeft:H?-4:0}}))})),H?ae.push({key:"name",comp:(0,O.jsx)("div",{style:Y.label,children:H})}):W||ae.push({key:"placeholder",comp:(0,O.jsx)("div",{style:Y.labelPlaceholder,children:(0,O.jsx)(p.FormattedMessage,{...z.buttonPlaceholder})})}),!W&&A&&ae.push({key:"right",comp:re()}),K&&ae.push({key:"error",comp:(0,O.jsx)("div",{children:(0,d.t)(Y.warningIcon)})});const le=e=>(0,O.jsx)(Z.Z,{disabled:G,disabledFeedback:!0,style:Y.button,ref:X,...(0,w.Z)(e??{},{onClick:ie}),children:ae.map((e=>{let{key:t,comp:n}=e;return(0,O.jsx)(o.Fragment,{children:n},t)}))});return(0,O.jsxs)("div",{style:Y.wrap,onMouseMove:ee,onMouseLeave:te,children:[q.tooltip?(0,O.jsx)(j.Z,{renderTooltip:()=>(0,O.jsx)(y.So,{content:(0,O.jsx)(p.FormattedMessage,{...q.tooltip}),subtitle:"error"!==q.type||C?null:(0,O.jsx)(p.FormattedMessage,{...z.clickToEdit})}),delayThreshold:0,render:le,placement:j.Z.Placement.Bottom}):le(),!C&&(T.device.isMobile||B)&&(0,O.jsxs)("div",{style:Y.configureWrap,children:[(0,O.jsx)(j.Z,{renderTooltip:()=>(0,O.jsx)(p.FormattedMessage,{defaultMessage:"Edit button",id:"buttonBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,O.jsx)(E.Z,{ariaLabel:x.formatMessage(z.editButtonAriaLabel),icon:$?()=>(0,O.jsx)(N,{}):c.H,onClick:oe,...e})}),T.device.isMobile&&(0,O.jsx)(D.Z,{tooltipContent:(0,O.jsx)(p.FormattedMessage,{defaultMessage:"More actions…",id:"buttonBlock.moreActions.button.label"}),store:n,fadeIn:!1})]})]})}));const q=H},38376:(e,t,n)=>{n.d(t,{Z:()=>y});n(67294);var o=n(49271),i=n(8848),r=n(22808),a=n(15157),s=n(5366),l=n(41433),c=n(9953),d=n(39699),u=n(33929),p=n(85854),m=n(31278),f=n(55217),g=n(65187),h=n(85893);const v=(0,s.defineMessages)({inputPlaceholder:{defaultMessage:"Type something…",id:"calloutBlock.inputPlaceholder"},changeIconLabel:{defaultMessage:"Change callout icon",id:"calloutBlock.changeIconLabel"},disabledIconLabel:{defaultMessage:"Callout icon",id:"calloutBlock.disabledIconLabel"}});class b extends p.Z{constructor(){super(...arguments),this.handleChange=async e=>{const{store:t}=this.props,n=t.getIconStore();if(n){const{serverCommitResult:t}=d.createAndCommit({userAction:"CalloutBlock.handleEmojiChange",environment:this.environment,perform:t=>{c.sO({store:n,value:e,transaction:t}),(0,r.Z)(e)&&a.Z.set({userId:this.environment.currentUser.id,key:l.nF,value:e})}});await t}}}renderPersisted(){const{disabled:e}=this.props;return(0,h.jsxs)("div",{role:"note",style:{display:"flex"},children:[(0,h.jsxs)("div",{style:this.getStyle(),children:[(0,h.jsx)("div",{children:this.renderIcon()}),(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,marginLeft:8,width:"100%"},children:[(0,h.jsx)(g.Z,{style:{paddingLeft:o.ZD.paddingLeft,paddingRight:o.ZD.paddingRight},disabled:e,store:this.props.store.getBlockTitleStore(),placeholder:u.default.formatMessage(v.inputPlaceholder),pasteBehavior:"block"}),!this.props.hideContent&&(0,h.jsx)(f.Z,{disabled:e,store:this.props.store.getContentStore(),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})]})]}),this.renderDiscussion()]})}renderIcon(){const{store:e}=this.props,t=e.getIcon();return this.canEdit()?(0,h.jsx)(m.Z,{bucket:"secure",store:e,isEmptyPage:!1,onChange:this.handleChange,disableRemoveIcon:!0,isCallout:!0,icon:e.getIcon(),size:24,disabled:!1,label:u.default.formatMessage(v.changeIconLabel)}):(0,h.jsx)(m.Z,{icon:t,isEmptyPage:!1,size:24,disabled:!0,label:u.default.formatMessage(v.disabledIconLabel)})}getStyle(){const e=this.props.store.getFormat().block_color||"default",t=(0,i.x7)(e,this.theme);return{...this.props.style,display:"flex",width:"100%",borderRadius:3,border:(0,i.jS)(e)?void 0:`1px solid ${this.theme.darkDividerColor}`,backgroundColor:"transparent",paddingLeft:12,paddingTop:16,paddingBottom:16,paddingRight:16,...t}}}const y=b},53223:(e,t,n)=>{n.d(t,{D:()=>o.LazyCollectionViewBlock,w:()=>i});var o=n(77907);function i(e){return"isCollectionViewBlock"in e&&"boolean"==typeof e.isCollectionViewBlock&&e.isCollectionViewBlock}},1136:(e,t,n)=>{n.d(t,{F:()=>c});n(67294);var o=n(480),i=n(24405),r=n(62760),a=n(79362),s=n(52821),l=n(85893);function c(e){window.__c={n:"CollectionViewIcon"};const{device:t}=(0,o.O7)(),n=(0,i.Fg)(),{color:c,viewIcon:d,viewType:u,size:p,style:m}=e,f=(e=>({regular:e.regularTextColor,light:e.mediumTextColor,gray:a.Lr[e.mode].gray,lightGray:e.lightTextColor}))(n)[c];return u?d?(0,l.jsx)(r.Z,{style:{fill:f,backfaceVisibility:void 0,...m},size:p??(t.isMobile?18:16),theme:n,icon:d}):s.aW[u]({width:p??(t.isMobile?18:16),height:p??(t.isMobile?18:16),backfaceVisibility:void 0,fill:f,...m}):null}},27627:(e,t,n)=>{n.d(t,{Z:()=>I});var o=n(67294),i=n(73935),r=n(83355),a=n(15145),s=n(35683),l=n(50906),c=n(75018),d=n(97444),u=n(32741),p=n(66213),m=n(14976),f=n(84210),g=n(77080),h=n(61738),v=n(22294),b=n(72014),y=n(85854),S=n(68709),_=n(24813),w=n(85893);class k extends y.Z{constructor(){super(...arguments),this.nodeRef=o.createRef(),this.handleClick=()=>{const{store:e}=this.props;h.Z.recordVisit({id:e.id,blockType:e.getType(),type:s.vu.Link,currentUserId:this.environment.currentUser.id}),l.SK1(this.environment,{page_visit_id:b.$g.getCurrentPageVisitId(),mentioned_page_id:e.id,source_type:"collection_view_page_block",hover_preview_enabled:g.default.checkGate("first_party_links"),is_navigable_block:e.isNavigableBlock()})},this.handleMouseOver=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&d.Nh({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handleMouseOut=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&d.Zl({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})}}handleCreated(){this.activate(),v.Z.setKeyboardMode(!1)}activate(){if(this.context.overrideLinkClick){const{store:e}=this.props,t=(0,f.ZP)({store:e,pageVisitSource:a.tY.Create});this.context.overrideLinkClick(t)}else c.navigateToBlock({environment:this.environment,store:this.props.store,visitType:s.vu.Link,pageVisitSource:a.tY.Create})}willUnmount(){super.willUnmount(),u.qA(this.props.store.getTitleStore())}renderPersisted(){const{disabled:e}=this.props,t=this.props.store.getCollectionViewSourceCollectionStore();return(0,w.jsx)(S.p,{allowSelectionWithin:!1,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:(0,w.jsx)(_.Z,{ref:this.nodeRef,store:this.props.store,style:{...this.getBlockColorStyle(),...this.props.style},isAlias:this.props.store.isCollectionViewAlias()||this.props.store.recordStoreParentDiffersFromPersistedParent(),disabled:Boolean(e||(null==t?void 0:t.isSyncedCollection())),onClick:this.handleClick})})}getInteractiveToken(){if(!this.nodeRef||!this.nodeRef.current)return;const e=i.findDOMNode(this.nodeRef.current);return(0,m.We)(this.props.store,e)}}k.contextTypes={...p.wK,...r.w};const I=k},69015:(e,t,n)=>{n.d(t,{b:()=>c,Z:()=>w});n(67294);var o=n(73935),i=n(83355),r=n(1302),a=n(72126),s=n(14976),l=n(97880);let c=function(e){return e.Inline="Inline",e.InlineWrap="InlineWrap",e.Textarea="Textarea",e}({}),d=function(e){return e.Submit="Submit",e.Newline="Newline",e}({});function u(e){const{device:t,e:n,action:o,onSubmit:i}=e;if(o===d.Submit)i&&i(n);else if(o===d.Newline){if(!t.isIOS)return;n.preventDefault&&n.preventDefault(),document.execCommand("insertLineBreak")}else(0,l.t1)(o)}var p=n(73744),m=n(89224),f=n(49085);class g extends f.default{getInitialState(){return{}}}const h=g;var v=n(24666),b=n(29595),y=n(3386),S=n(85893);class _ extends i.Z{constructor(){super(...arguments),this.storeTypes={store:h},this.handleWindowMouseDown=e=>{const t=o.findDOMNode(this);t&&!t.contains(e.target)&&this.props.onBlur&&this.props.onBlur()},this.handleEsc=e=>{this.handleKeyEvent(),this.props.onCancel&&this.props.onCancel(e)},this.handleShiftEnter=e=>{const{device:t}=this.environment;t.isIOS&&!("shiftKey"in e)?u({device:t,e,action:d.Newline}):this.handleEnter(e)},this.handleEnter=e=>{const{type:t,onSubmit:n}=this.props,{device:o}=this.environment;if(this.getDisabled())return;u({device:o,e,action:function(e){const{device:t,type:n,e:o}=e;return n===c.Inline?d.Submit:n===c.InlineWrap?t.isPhone?d.Submit:"altKey"in o&&o.altKey||"shiftKey"in o&&o.shiftKey?d.Newline:d.Submit:n===c.Textarea?d.Newline:void(0,l.t1)(n)}({device:o,type:t,e}),onSubmit:n})},this.handleLeft=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onLeft&&this.props.onLeft(e))},this.handleRight=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onRight&&this.props.onRight(e))},this.handleKeyEvent=()=>{r.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.getDisabled=()=>!!this.props.disabled||!this.props.focus,this.getHtml=()=>{const e=a.YU(this.props.value+(this.props.value.length>0?"\n":""));return this.props.getHtml?this.props.getHtml(e):e},this.getSelection=()=>{const e=this.stores.store.state.selection;return e&&{type:"contain",selection:e}},this.handleMutation=e=>{let{newValue:t}=e;this.saveSerializedTextSelection(),this.props.onChange(t)},this.saveSerializedTextSelection=()=>{const{store:e}=this.stores,t=s.Ut(this.environment,m.get());t&&(a.Xy(t.selection,e.state.selection)||this.stores.store.setState({selection:t.selection}),t.forceEmitSelectionStore&&v.default.emit())}}willMount(e){super.willMount(e),p.lj(window,"mousedown",this.handleWindowMouseDown)}willMountOrUpdate(e){super.willMountOrUpdate(e);const{store:t}=this.stores;e.focus&&!t.state.selection&&(e.selectAll?t.setState({selection:{startIndex:0,endIndex:e.value.length}}):t.setState({selection:{startIndex:e.value.length,endIndex:e.value.length}}))}willUnmount(){super.willUnmount(),p.ZV(window,"mousedown",this.handleWindowMouseDown)}renderComponent(){const{type:e}=this.props;return(0,S.jsx)(y.Z,{capture:!this.getDisabled(),onDelete:this.handleKeyEvent,onBackspace:this.handleKeyEvent,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onCommandEnter:this.handleKeyEvent,onCommandShiftEnter:this.handleKeyEvent,onUp:this.handleKeyEvent,onDown:this.handleKeyEvent,onLeft:this.handleLeft,onRight:this.handleRight,onTab:this.handleKeyEvent,onUntab:this.handleKeyEvent,onSelectAll:this.handleKeyEvent,onToggleBold:this.handleKeyEvent,onToggleItalics:this.handleKeyEvent,onToggleStrike:this.handleKeyEvent,onToggleCode:this.handleKeyEvent,onUndo:this.handleKeyEvent,onRedo:this.handleKeyEvent,onEsc:this.handleEsc,onCut:this.handleKeyEvent,onCopy:this.handleKeyEvent,onPaste:this.handleKeyEvent,onKeypress:this.handleKeyEvent,onHome:this.handleKeyEvent,onEnd:this.handleKeyEvent,onGoToBeginningOfLine:this.handleKeyEvent,onGoToEndOfLine:this.handleKeyEvent,onGoForwardOneChar:this.handleKeyEvent,onGoBackwardOneChar:this.handleKeyEvent,children:(0,S.jsx)(b.Z,{style:{...this.props.style,whiteSpace:"pre-wrap"},placeholder:this.props.placeholder,placeholderStyle:this.props.placeholderStyle,spellCheck:!1,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,getDisabled:this.getDisabled,getHtml:this.getHtml,getSelection:this.getSelection,onMutation:this.handleMutation,suppressNewlineEvents:e===c.Inline})})}}_.displayName="ContentEditableInput",_.Type=c;const w=_},29595:(e,t,n)=>{n.d(t,{Z:()=>v});n(21703),n(67294);var o=n(83355),i=n(18466),r=n(1302),a=n(22491),s=n(97880),l=n(14976),c=n(46150),d=n(62619),u=n(45162),p=(n(60846),n(89224)),m=n(24666),f=n(85893);let g=!1;class h extends o.Z{constructor(e){super(e),this.root=null,this.ownNodeIsComposing=!1,this.testDiv=document.createElement("div"),this.shouldDisableContentEditableForMobile=!1,this.handleRootMount=e=>{this.root=e},this.handleTextSelectionEditingStoreForMobile=()=>{this.shouldDisableContentEditableForMobile=!m.default.isEditingStore.state,this.root&&this.updateContentEditableAttribute(this.root)},this.handleCompositionStart=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!0,this.props.onCompositionStart&&this.props.onCompositionStart())},this.handleCompositionEnd=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!1,this.handleInput(),this.props.onCompositionEnd&&this.props.onCompositionEnd())},this.handleBeforeInput=e=>{const{suppressNewlineEvents:t}=this.props;if(!d.kA(e))throw new Error("Invalid event");var n;if(t&&("insertLineBreak"!==e.inputType&&"insertParagraph"!==e.inputType||e.preventDefault(),this.environment.device.isAndroid&&"insertCompositionText"===e.inputType&&null!==(n=e.data)&&void 0!==n&&n.endsWith("\n")&&e.target===this.root)){var o;g;const e=()=>{var t;this.delegateMutation({insertedLine:!0,deletedLine:!1,newValue:this.getText(),multiSelection:void 0,isComposing:this.isComposing}),null===(t=this.root)||void 0===t||t.removeEventListener("input",e)};null===(o=this.root)||void 0===o||o.addEventListener("input",e)}},this.handleSelect=e=>{this.delegateSelection("contain")},this.handleClick=e=>{var t,n;3===e.nativeEvent.detail&&(l.TQ(this.environment.device),this.delegateSelection("contain")),null===(t=(n=this.props).onClick)||void 0===t||t.call(n,e)},this.handleInput=this.handleInput.bind(this)}get isComposing(){var e;return Boolean(this.ownNodeIsComposing||(null===(e=this.contentEditableContext)||void 0===e?void 0:e.isComposing()))}get registries(){var e;return[null===(e=this.contentEditableContext)||void 0===e?void 0:e.contentEditableLeafRegistry]}getText(){return l.n$(this.environment,this.root)}delegateSelection(e){var t,n;this.isComposing||(null===(t=(n=this.props).onSelect)||void 0===t||t.call(n,{endpoint:e,component:this}))}delegateMutation(e){this.handleMutation(e)}delegateBeforeInput(e){this.handleBeforeInput(e)}delegateKeyDown(e){var t,n;null===(t=(n=this.props).onKeyDown)||void 0===t||t.call(n,e)}delegateCompositionEnd(e){var t,n;null===(t=(n=this.props).onCompositionEnd)||void 0===t||t.call(n)}getNode(){return this.root}willMount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&(this.shouldDisableContentEditableForMobile=i.Z.withListenerIgnored((()=>!m.default.isEditingStore.state)),m.default.isEditingStore.addListener(this.handleTextSelectionEditingStoreForMobile))}willMountOrUpdate(e){this.selection=e.getSelection(),this.disabled=e.getDisabled(),this.html=e.getHtml()}didMount(){this.updateContainer(!0),this.root&&d.OW&&this.root.addEventListener("beforeinput",this.handleBeforeInput)}didUpdate(){this.updateContainer(!1)}willUnmount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&m.default.isEditingStore.removeListener(this.handleTextSelectionEditingStoreForMobile),this.root&&d.OW&&this.root.removeEventListener("beforeinput",this.handleBeforeInput)}updateContentEditableAttribute(e){const t=e.getAttribute("contenteditable");this.disabled||this.shouldDisableContentEditableForMobile?"false"!==t&&this.mutateDOM((function(){e.contentEditable="false"})):"true"!==t&&this.mutateDOM((function(){e.contentEditable="true"}))}updateContainer(e){var t;const{device:n}=this.environment;if(null===(t=this.contentEditableContext)||void 0===t||t.contentEditableLeafRegistry.register(this),this.root&&(this.updateContentEditableAttribute(this.root),!this.isComposing)){if(e)this.root.innerHTML=this.html;else{this.previousHtml!==this.html&&(this.previousHtml=this.html,this.testDiv.innerHTML=this.html);const e=this.root.innerHTML,t=this.testDiv.innerHTML;e!==t&&(this.root.innerHTML=this.html)}if(this.disabled)return;if(p.isMouseSelecting())return;if(p.isMouseRightClicking())return void p.resetMouseRightClicking();if(this.selection)switch(this.selection.type){case"start":case"end":{var o;null===(o=this.contentEditableContext)||void 0===o||o.tryEnableMultiSelection();const e=l.bD(this.root,this.selection.index),t={endpoint:this.selection.type,onlyIfEqual:this.contentEditableContext,position:e};p.setDOMEndpoint(t,this.environment.device),this.updateSelectionEndpoint(t);break}case"contain":{const e=l.lw(this.root,this.selection.selection.startIndex,this.selection.selection.endIndex),t=p.get();l.Dn(t,e)||(n.isAndroid&&document.activeElement!==this.root&&this.root.focus(),p.set(e,n));break}default:(0,s.t1)(this.selection)}else if(!e){const e=p.get(),t=!n.isAndroid||i.Z.withListenerIgnored((()=>"empty"===m.default.state.mode));e&&e.commonAncestorContainer&&d.UG(e.commonAncestorContainer)&&this.root.contains(e.commonAncestorContainer)&&t&&p.clear(this.environment)}}}updateSelectionEndpoint(e){const t=p.get(),n=p.getIncompleteDOMEndpoint();if(t&&n===e)switch(e.endpoint){case"start":return void p.setDOMEndpoint({endpoint:"end",onlyIfEqual:this.contentEditableContext,position:{container:t.endContainer,offset:t.endOffset}},this.environment.device);case"end":return void p.setDOMEndpoint({endpoint:"start",onlyIfEqual:this.contentEditableContext,position:{container:t.startContainer,offset:t.startOffset}},this.environment.device);default:(0,s.t1)(e.endpoint)}}renderComponent(){const{onContextMenu:e,onKeyDown:t,onDoubleClick:n,onMouseDown:o,onTouchStart:i,placeholder:r,onBlur:s,onFocus:l,onMouseOver:d,onMouseOut:p}=this.props,m=Boolean(!this.html),g=(!(0,u.ri)(this.environment.device)||!(0,u.Aw)(this.environment))&&this.props.spellCheck,h=this.props.tagName??"div";return(0,f.jsx)(h,{id:this.props.id,ref:this.handleRootMount,...(0,a.iv)(this.props.className,m&&this.props.placeholderStyle?this.props.placeholderStyle:this.props.style,!this.disabled&&"notranslate"),onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onInput:this.handleInput,spellCheck:g,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,onSelect:this.handleSelect,onClick:this.handleClick,onBlur:s,onFocus:l,onContextMenu:e,onKeyDown:t,onDoubleClick:n,onMouseDown:o,onTouchStart:i,onMouseOver:d,onMouseOut:p,placeholder:r,...c.GF})}handleMutation(e){this.props.onMutation&&this.props.onMutation(e),r.default.flush()}handleInput(){this.handleMutation({newValue:this.getText(),insertedLine:!1,isComposing:this.isComposing})}}h.displayName="ContentEditableLeaf";const v=h},15201:(e,t,n)=>{n.d(t,{O:()=>O});n(57658),n(21703);var o=n(27537),i=n.n(o),r=n(67294),a=n(60177),s=n(64338),l=n(480),c=n(86628),d=n(24405),u=n(41432),p=n(22491),m=n(72126),f=n(44805),g=n(97880),h=n(62134),v=n(98104),b=n(95477),y=n(14976),S=n(46150),_=n(62619),w=n(89224);const k=["initial","keyDown","compositionStart","beforeInput","compositionUpdate","domMutations","input","compositionEnd","keyUp"],I={keyDown:"keyUp",beforeInput:"input",input:"domMutations",domMutations:"input",compositionStart:"compositionEnd"},C={compositionUpdate:"beforeInput"};class x{constructor(){this.flowData=new Map,this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.listeners=new Set,this.handleSelectionChange=()=>{this.nextFlow.beforeRange=w.toStaticRange(w.get())},this.handleKeyDown=e=>{this.advanceToPhase("keyDown").keyDown=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionStart=e=>{this.advanceToPhase("compositionStart").compositionStart=e,this.emitUpdate(),this.endIfComplete()},this.handleBeforeInput=e=>{var t;if(!(0,_.kA)(e))return;const n=(null===(t=e.getTargetRanges)||void 0===t?void 0:t.call(e))||[];this.advanceToPhase("beforeInput").beforeInput={event:e,targetRanges:n},this.emitUpdate(),this.endIfComplete()},this.handleCompositionUpdate=e=>{this.advanceToPhase("compositionUpdate").compositionUpdate=e,this.emitUpdate()},this.handleInput=e=>{this.advanceToPhase("input").input=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionEnd=e=>{this.advanceToPhase("compositionEnd").compositionEnd=e,this.emitUpdate(),this.endIfComplete()},this.handleKeyUp=e=>{this.advanceToPhase("keyUp").keyUp=e,this.emitUpdate(),this.endFlow()},this.handleMutations=e=>{let{currentFlow:t}=this;t&&!t.domMutations||(t=this.advanceToPhase("initial")),t.domMutations={afterPhase:t.phase,mutations:e},this.emitUpdate(),this.endIfComplete()}}attachEventListeners(e){const{div:t,document:n}=e;return n.addEventListener("selectionchange",this.handleSelectionChange),t.addEventListener("input",this.handleInput),t.addEventListener("keydown",this.handleKeyDown),t.addEventListener("keyup",this.handleKeyUp),t.addEventListener("beforeinput",this.handleBeforeInput),t.addEventListener("compositionstart",this.handleCompositionStart),t.addEventListener("compositionupdate",this.handleCompositionUpdate),t.addEventListener("compositionend",this.handleCompositionEnd),()=>{n.removeEventListener("selectionchange",this.handleSelectionChange),t.removeEventListener("input",this.handleInput),t.removeEventListener("keydown",this.handleKeyDown),t.removeEventListener("keyup",this.handleKeyUp),t.removeEventListener("beforeinput",this.handleBeforeInput),t.removeEventListener("compositionstart",this.handleCompositionStart),t.removeEventListener("compositionupdate",this.handleCompositionUpdate),t.removeEventListener("compositionend",this.handleCompositionEnd)}}onInputFlowChange(e){return this.listeners.add(e),()=>this.listeners.delete(e)}isComposing(){var e;return this.currentFlow&&!this.currentFlow.isPhase("initial")?this.currentFlow.isComposing():(null===(e=this.previousFlow)||void 0===e?void 0:e.isComposing())||!1}reset(){this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.flowData=new Map}getCurrentFlow(){const e=this.currentFlow;if(!e)return;return{flow:e,data:this.getData(e)}}getData(e){const t=this.flowData.get(e);if(t)return t;const n={};return this.flowData.set(e,n),n}endIfComplete(){const{currentFlow:e}=this;e&&e.isComplete()&&this.endFlow()}emitUpdate(){const{currentFlow:e}=this;if(e){const t={type:"update",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(t)))}}endFlow(){const{currentFlow:e}=this;if(e){const t=this.previousFlow;this.previousFlow=e,this.currentFlow=void 0;const n={type:"end",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(n))),t&&this.flowData.delete(t)}}advanceToPhase(e){return this.currentFlow&&this.currentFlow.canTransitionToPhase(e)||(this.endFlow(),this.currentFlow=this.nextFlow,this.nextFlow=new T),this.currentFlow.phase=e,this.currentFlow}}class T{constructor(){this.phase="initial",this.beforeRange=w.toStaticRange(w.get()),this.initial=void 0,this.keyDown=void 0,this.compositionStart=void 0,this.beforeInput=void 0,this.compositionUpdate=void 0,this.input=void 0,this.compositionEnd=void 0,this.domMutations=void 0,this.keyUp=void 0}isPhase(e){return this.phase===e}hasEvents(){return Boolean(this.compositionStart||this.compositionEnd||this.compositionUpdate||this.keyDown||this.keyUp||this.beforeInput||this.input)}isComposing(){var e,t;switch(this.phase){case"compositionStart":case"compositionUpdate":return!0;case"compositionEnd":return!1;case"beforeInput":return Boolean(null===(e=this.beforeInput)||void 0===e?void 0:e.event.isComposing);case"input":case"keyDown":case"keyUp":return Boolean(null===(t=this[this.phase])||void 0===t?void 0:t.isComposing);case"initial":return!1;default:(0,g.t1)(this.phase)}}transitionToPhase(e,t){return!!this.canTransitionToPhase(e)&&(this.phase=e,this[e]=t,!0)}canTransitionToPhase(e){return!this[e]&&(C[this.phase]===e||1===function(e,t){const n=k.indexOf(e),o=k.indexOf(t),i=n-o;if(i<0)return-1;if(i>0)return 1;return 0}(e,this.phase))}isComplete(){for(const[e,t]of(0,g.qP)(I))if(this[e]&&!this[t])return!1;return!0}getTargetRanges(){var e;const t=null===(e=this.beforeInput)||void 0===e?void 0:e.targetRanges;return null!=t&&t.length?t:this.beforeRange?[this.beforeRange]:[]}}var M=n(68056),P=n(45162),A=n(55010),R=n(35431),D=n(59730);let B,E;B=Symbol.iterator;class F{constructor(e){if(this.leftToRight=new Map,this.rightToLeft=new Map,e)for(const[t,n]of e)this.assoc(t,n)}assoc(e,t){const n=[];if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);n.push((()=>this.rightToLeft.delete(t)))}if(this.rightToLeft.has(t)){const e=this.rightToLeft.get(t);n.push((()=>this.leftToRight.delete(e)))}for(const o of n)o();return this.leftToRight.set(e,t),this.rightToLeft.set(t,e),this}getLeft(e){return this.leftToRight.get(e)}getRight(e){return this.rightToLeft.get(e)}hasLeft(e){return this.leftToRight.has(e)}hasRight(e){return this.rightToLeft.has(e)}deleteLeft(e){if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);return this.leftToRight.delete(e),this.rightToLeft.delete(t),!0}return!1}deleteRight(e){if(this.rightToLeft.has(e)){const t=this.rightToLeft.get(e);return this.leftToRight.delete(t),this.rightToLeft.delete(e),!0}return!1}*[B](){for(const[e,t]of this.leftToRight)yield[e,t]}}E=Symbol.iterator;class Z{constructor(e,t,n){if(this.leftName=void 0,this.rightName=void 0,this.biMap=void 0,e===t)throw new D.D3("NamedBiMap left and right names are equal",{data:{name:e}});if(this.leftName=e,this.rightName=t,this.biMap=new F,n)for(const[o,i]of n)this.biMap.assoc(o,i)}assoc(e){const t=e[this.leftName],n=e[this.rightName];return this.biMap.assoc(t,n),this}get(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.getLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.getRight(t)}throw new D.D3("NamedBiMap.get fallthrough should never occur",{data:e})}delete(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.deleteLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.deleteRight(t)}throw new D.D3("NamedBiMap.delete fallthrough should never occur",{data:e})}has(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.hasLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.hasRight(t)}throw new D.D3("NamedBiMap.has fallthrough should never occur",{data:e})}[E](){return this.biMap[Symbol.iterator]()}}class L extends R.Z{constructor(){super(...arguments),this.nodeMap=new Z("node","component",new F)}register(e){const t=super.register(e),n=e.getNode();return n?this.nodeMap.assoc({node:n,component:e}):this.nodeMap.delete({component:e}),t}unregister(e){super.unregister(e),this.nodeMap.delete({component:e})}getByDOMOrder(){const e=Array.from(this.nodeMap.biMap.rightToLeft.entries());return e.sort(((e,t)=>{const n=e[1],o=t[1];return(0,A.Z)(n,o)})),e.map((e=>{let[t,n]=e;return{node:n,leaf:t}}))}getParentContentEditableLeaf(e){const t=(0,S.X1)(e),n=t&&this.nodeMap.get({node:t});if(t&&n)return{node:t,leaf:n}}}var j=n(35661),V=n(24666),U=n(85893);function O(e){window.__c={n:"ContentEditableRoot"};const{children:t,style:n,displayName:o,shouldSelectOnEnter:_}=e,k=!e.disabled,I=(0,r.useRef)(null),C=(0,r.useRef)(0),[T,A]=(0,r.useState)(null),R=(0,r.useRef)(!1),D=(0,r.useRef)(!1),[B]=(0,r.useState)((()=>function(e){return`${e}-${W++}`}(o))),E=(0,r.useRef)(void 0),F=(0,r.useRef)({displayName:B}),[Z]=(0,r.useState)((()=>new x)),[O]=(0,r.useState)((()=>new L)),[q]=(0,r.useState)((()=>new s.T7({onMutations(e){Z.handleMutations(e)},enableLogging:!1}))),G=(0,r.useRef)(!1),K=(0,r.useCallback)((e=>{G.current!==e&&(G.current=e,q.mutate((()=>{var t,n;e?null===(t=I.current)||void 0===t||t.setAttribute(S.HM,"true"):null===(n=I.current)||void 0===n||n.removeAttribute(S.HM)})))}),[q]),$=(0,r.useRef)(!1),Q=(0,r.useCallback)((e=>{$.current!==e&&($.current=e,q.mutate((()=>{var t,n;e?null===(t=I.current)||void 0===t||t.setAttribute(S._F,"true"):null===(n=I.current)||void 0===n||n.removeAttribute(S._F)})))}),[q]),Y=(0,r.useCallback)((e=>{I.current=e,q.setNode(e),A(e)}),[q]),J=(0,l.O7)(),X=(0,c.VK)((()=>(0,P.Aw)(J)),[J]);(0,r.useEffect)((()=>{if(T&&X)return Z.attachEventListeners({div:T,document:window.document})}),[Z,X,T]);const{isFirefox:ee,isAndroid:te}=J.device;(0,r.useEffect)((()=>{const e=e=>{var t;const n=w.get(),o=(0,P.Zb)({range:n,contentEditableLeafRegistry:O,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:I.current||void 0}),i=V.default.state,r="editing"===i.mode?i.multiSelection:void 0;return{leafs:o,multiSelection:te&&e.isPhase("beforeInput")&&(!r||(0,M.iG)(r))&&w.isExpanded(n)?null===(t=(0,P.fx)({range:n,contentEditableLeafRegistry:O,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection:r,range:w.toStaticRange(n)}};return Z.onInputFlowChange((t=>{Q(Z.isComposing());const{flow:n,type:o,data:r}=t;if("end"!==o){if("update"!==o||!n.isPhase("beforeInput")&&r.target||(r.target=e(n)),"update"===o&&n.domMutations&&!r.handledMutations){var a,l;r.handledMutations=!0;const t=n.domMutations.mutations,o=r.target||e(n),m=!ee||o.multiSelection&&(0,M.iG)(o.multiSelection)?null===(a=o.leafs)||void 0===a?void 0:a.start:N(O,I.current),f=null===(l=o.leafs)||void 0===l?void 0:l.start,h=null==m?void 0:m.leaf.getText();z("onMutations",r,h,n,m);const v=n.hasEvents(),y=b.default.isLocalhost||!v;let _=!1,w=!1,k=!1;for(let e=t.length-1;e>=0;e--){const n=t[e];H(n,m);const o=(0,S.xp)(n.target),i=(0,S.X1)(n.target);if(o===I.current){if((v||"attributes"!==n.type||"style"!==n.attributeName)&&("attributes"!==n.type||"dir"!==n.attributeName))if(m){if("childList"===n.type){const e=Array.from(n.removedNodes);w||=e.some(S.eD)||e.some(S.C7);const t=Array.from(n.addedNodes);k||=t.some(S.eD)}if(i&&i===m.node){switch(n.type){case"attributes":(0,s.AJ)(n,y);continue;case"characterData":case"childList":break;default:(0,g.t1)(n.type)}_=!0}else(0,s.AJ)(n,y)}else(0,s.AJ)(n,y)}else z("allowed mutation on interior region",o,n)}if(f&&(_||w)){var c,d,u,p;if("string"!=typeof h)throw new Error("focusedLeafText must be string");const e=null===(c=n.beforeInput)||void 0===c?void 0:c.event,t=null===(d=n.keyDown)||void 0===d?void 0:d.keyCode,o="enter"!==(void 0!==t&&i()(t))&&("insertLineBreak"===(null==e?void 0:e.inputType)||"insertParagraph"===(null==e?void 0:e.inputType)||"insertCompositionText"===(null==e?void 0:e.inputType)&&(null==e||null===(u=e.data)||void 0===u?void 0:u.endsWith("\n"))||k),a={multiSelection:null===(p=r.target)||void 0===p?void 0:p.multiSelection,newValue:h,deletedLine:w,insertedLine:o,isComposing:Z.isComposing()};z("delegateMutation",a),f.leaf.delegateMutation(a)}}}else z("flow ended",r,n)}))}),[O,Z,te,ee,Q]),(0,r.useEffect)((()=>{const e=I.current;e&&X&&R.current&&q.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable")}))}),[k,X,q]);const ne=(0,r.useCallback)((()=>{const e=I.current;return!(!e||!X)&&(R.current?("always"===X&&K(!0),!1):(q.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable"),(0,P.ri)(J.device)&&(e.spellcheck=!1)})),q.lock(F.current),R.current=!0,K("gesture"===X),z("enableMultiSelection"),!0))}),[q,X,K,J.device,k]),oe=(0,r.useCallback)((()=>{const e=I.current;return!(!R.current||!e)&&("always"===X?(K(!1),!1):!Z.isComposing()&&(q.unlock(F.current),e.removeAttribute("contenteditable"),K(!1),z("disableMultiSelection"),R.current=!1,!0))}),[q,X,K,Z]);(0,r.useEffect)((()=>{let e=w.get();function t(){var t;const n=null===(t=w.get())||void 0===t?void 0:t.cloneRange(),o=e;e=n;const i=I.current;i&&w.isExpanded(n)&&!w.isExpanded(o)&&(0,S.xp)(n.commonAncestorContainer)===i&&(0,S.X1)(n.commonAncestorContainer)&&ne()&&(i.focus(),w.isExpanded(w.get())||w.set(n,J.device))}return document.addEventListener("selectionchange",t),()=>document.removeEventListener("selectionchange",t)}),[ne,J.device]);const ie=(0,r.useCallback)((function(){const e=w.get();if(!w.isExpanded(e)&&oe()&&e){const t=N(O,I.current,e);t&&t.node&&t.node instanceof HTMLElement&&t.node.focus(),w.set(e,J.device)}}),[O,oe,J.device]),re=(0,r.useMemo)((()=>m.Ds(ie,50)),[ie]),{KeyboardShortcutStackStore:ae}=J,se=(0,r.useRef)(),le=(0,r.useCallback)((function(e){const t=I.current;if(!t)return;if(!R.current)return;const n=w.get();if(z("onSelect (react selection)",w.toStaticRange(n)),!se.current&&n&&he.current&&n.commonAncestorContainer===he.current)w.clear(J);else if(!(se.current&&n&&w.areRangesEqual(n,se.current))){if(se.current=w.toStaticRange(n),n){const o=n.startContainer===t&&0===n.startOffset&&n.endContainer===t&&0===n.endOffset,i=he.current&&n.startContainer===he.current&&be.current&&n.endContainer===be.current,r=J.device.isIOS&&J.device.isMobileNative&&e.timeStamp-C.current>500&&function(e,t,n){if(!e.collapsed||0!==e.startOffset)return!1;const o=(0,P.Zb)({range:e,contentEditableLeafRegistry:t,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:n}),i=t.getByDOMOrder()[0];return Boolean(i&&o&&o.start.leaf===i.leaf)}(n,O,t);if(o||i||r)return z("onSelect: propagateShortcut selectAll"),void h.dJ({KeyboardShortcutStackStore:ae},new KeyboardEvent("keydown"),"selectAll")}if("contextmenu"!==e.nativeEvent.type){if(n&&(w.isExpanded(n)||"always"===X)&&(0,S.xp)(n.commonAncestorContainer)===t){if(D.current)return void(E.current=e);const t=N(O,I.current,n);t&&(z("onSelect: delegateSelection",t),t.leaf.delegateSelection("start"))}w.isExpanded(n)||re()}}}),[X,O,re,ae,J]);(0,r.useEffect)((()=>{if(X&&!k){function e(){const e=w.get(),t=I.current;if(!t||!e)return;const n=(0,P.fx)({contentEditableLeafRegistry:O,range:e,allowInvisibleEndSelection:!0});n&&(0,S.xp)(e.commonAncestorContainer)===t&&v.bc({...n,environment:J,focus:"start",readOnly:!0})}return document.addEventListener("selectionchange",e),()=>document.removeEventListener("selectionchange",e)}}),[J,X,k,O]);const ce=(0,r.useCallback)((()=>{D.current=!0,E.current=void 0}),[]),de=(0,r.useCallback)((e=>{const t=E.current;if(D.current=!1,E.current=void 0,C.current=e.timeStamp,t){const e=N(O,I.current);z("handleTouchEnd: delegateSelection",e),null==e||e.leaf.delegateSelection("start")}}),[O]),ue=(0,r.useCallback)((e=>{if(C.current=e.timeStamp,!R.current)return;e.target!==I.current||"Enter"!==e.key||!1!==e.ctrlKey||!1!==e.metaKey||!1!==e.altKey||!1!==e.shiftKey||_&&!_()||void 0!==w.get()||!he.current||w.setOnNode(he.current,J.device);const t=N(O,I.current);z("handleKeyDown: delegateKeyDown",t),null==t||t.leaf.delegateKeyDown(e)}),[O,J.device,_]);(0,r.useEffect)((()=>{const e=I.current;if(e)return e.addEventListener("beforeinput",t),()=>e.removeEventListener("beforeinput",t);function t(e){if(!R.current)return;const t=N(O,I.current);null==t||t.leaf.delegateBeforeInput(e)}}),[O]);const pe=(0,r.useCallback)((()=>{const e=I.current;if(!e)return;const t=function(){document.removeEventListener("selectionchange",t);const n=w.get();if(null!=n&&n.collapsed&&(0,S.xp)(n.commonAncestorContainer)===e){const e=(0,S.X1)(n.commonAncestorContainer),t=n.startContainer,o=n.startOffset;if(e&&t&&(0,y.x9)(e,t,o)){const i=e.getElementsByClassName(f.$A)[0];i&&(z("Move collapsed selection before EOL marker",{parentLeafNode:e,caretContainer:t,caretOffset:o}),n.setStartBefore(i),n.setEndBefore(i),w.set(n,J.device))}}};document.addEventListener("selectionchange",t)}),[J.device]);(0,r.useEffect)((()=>{"always"!==X||R.current||ne()}),[ne,X]);const me=(0,r.useCallback)((()=>{const e=w.get();return!w.isExpanded(e)&&oe()}),[oe]),fe=(0,r.useCallback)((()=>!te&&Boolean(Z.isComposing())),[Z,te]),ge=(0,d.yK)((e=>({div:{caretColor:e.regularTextColor,...n},whenContentEditable:{WebkitUserModify:"read-write-plaintext-only"},selectionTrap:{height:"1px",width:"1px",caretColor:"transparent"}})),[n]),he=(0,r.useRef)(null),ve=(0,U.jsx)("span",{style:ge.selectionTrap,ref:he}),be=(0,r.useRef)(null),ye=(0,U.jsx)("span",{style:ge.selectionTrap,ref:be}),Se=(0,r.useCallback)((()=>{if(!w.get()&&"editing"===V.default.state.mode){const e=V.default.state.multiSelection.start.store;if(e instanceof j.G){const t=e.getType();if(t===u.Ti.linkToPage||t===u.Ti.linkToCollection)return}v.ZH(J)}}),[J]),_e=(0,r.useCallback)((()=>{!I.current||w.get()&&"empty"!==V.default.state.mode||I.current.blur()}),[]);return(0,U.jsx)("div",{onBlur:J.device.isIOS?Se:void 0,onFocus:J.device.isIOS?_e:void 0,onTouchStart:X?ce:void 0,onTouchEnd:X?de:void 0,onTouchCancel:X?de:void 0,onKeyDown:X?ue:void 0,onCompositionEnd:X?function(e){if(!R.current)return;const t=N(O,I.current);null==t||t.leaf.delegateCompositionEnd(e)}:void 0,ref:Y,...(0,p.iv)(ge.div,{whenContentEditable:ge.whenContentEditable}),onMouseDown:pe,onSelect:le,...S.GZ,children:(0,U.jsxs)(a.c1,{id:B,tryEnableMultiSelection:ne,tryDisableMultiSelection:me,isComposing:fe,domLock:q,contentEditableLeafRegistry:O,children:[ve,t,ye]})})}function N(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.get();const o=(0,P.Zb)({range:n,contentEditableLeafRegistry:e,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:t||void 0});if(o)return o.start}function z(){}function H(e){const t={};if(t.type=e.type,t.target=e.target,t.targetIsText=e.target.nodeType===Node.TEXT_NODE,t.targetIsLeaf=(0,S.eD)(e.target),e.addedNodes.length){const n=Array.from(e.addedNodes);t.added=n,t.addedALeaf=n.some(S.eD),t.addedAText=n.some((e=>e.nodeType===Node.TEXT_NODE))}if(e.removedNodes.length){const n=Array.from(e.removedNodes);t.removed=n,t.removedALeaf=n.some(S.eD),t.removedAText=n.some((e=>e.nodeType===Node.TEXT_NODE))}"characterData"===e.type&&(t.newChars=e.target.textContent,t.oldChars=e.oldValue),t.mutation=e;for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i]}let W=0},68709:(e,t,n)=>{n.d(t,{p:()=>c});var o=n(67294),i=n(60177),r=n(22491),a=n(46150),s=n(85893);const l={WebkitUserSelect:"none",userSelect:"none",pseudoSelection:{background:"transparent"}},c=o.forwardRef(((e,t)=>{window.__c={n:"ContentEditableVoid"};const{allowSelectionWithin:n,style:o,className:c,...d}=e,u=(0,i.Dl)(),p=(0,s.jsx)("div",{ref:t,contentEditable:!1,...(0,r.iv)(c,!n&&l,o),...a.G0,...d});return u?(0,s.jsx)(i.c1,{void:!0,children:p}):p}));c.displayName="ContentEditableVoid"},10182:(e,t,n)=>{n.d(t,{Z:()=>x});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(86658),l=n(53028),c=n(5366),d=n(50950),u=n(43250),p=n(87279),m=n(61893),f=n(31194),g=n(52275),h=n(31945),v=n(78140),b=n(32163),y=n(89728),S=n(72495),_=n(24006),w=n(64369),k=n(85893);function I(e){let{hasDismissButton:t,onDismiss:n}=e;window.__c={n:"CookieConsentMenu"};const r=(0,i.O7)(),f=(0,a.Fg)(),g=(0,c.useIntl)(),[h,_]=(0,o.useState)(!1);(0,o.useEffect)((()=>()=>{t||h&&d.qo()}),[g,h,t]);const I=[{key:"trackingTypes",render:e=>(0,k.jsx)(S.Z,{...e,topBorder:0!==e.index}),items:l.m4.map((e=>({key:e,render:t=>(0,k.jsx)(C,{menuListItemProps:t,trackingType:e,setShowReloadOnMenuClose:_,isNativeiOSApp:r.device.isMobileNative&&r.device.isIOS}),action:()=>d.Nh(r,e)})))}];return(0,k.jsxs)(v.Z,{className:u.N7t,menuType:p.og.Popup,width:260,children:[(0,k.jsx)("div",{style:{display:"flex",alignItems:"center",paddingTop:t?4:0},children:t&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(w.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",paddingLeft:14},children:(0,k.jsx)("b",{children:(0,k.jsx)(c.FormattedMessage,{...s.ze.customizeCookiesHeader})})}),(0,k.jsx)(y.Z,{style:{float:"right",marginLeft:-8,paddingLeft:8,paddingRight:8,color:f.blueColor},onClick:()=>{d.OM(r,m.Z.getPermission()),n&&n()},children:(0,k.jsx)(c.FormattedMessage,{...s.ze.cookieDismissButtonLabel})})]})}),(0,k.jsx)(b.Z,{type:b.i.Vertical,initialFocus:void 0,sections:I})]})}function C(e){window.__c={n:"TrackingTypeToggle"};const{menuListItemProps:t,trackingType:n,setShowReloadOnMenuClose:o,isNativeiOSApp:l}=e,{title:u,caption:p,subtitle:f}=(0,s.G_)(n,l),[{permission:h}]=(0,r.AF)(m.Z),v=(0,a.Fg)(),b=(0,i.O7)();return(0,k.jsx)(g.Z,{...t,title:(0,k.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,k.jsx)("div",{style:{marginRight:0},children:(0,k.jsx)(c.FormattedMessage,{...u})})}),caption:(0,k.jsxs)("div",{children:[f&&(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:v.errorText},children:(0,k.jsx)(c.FormattedMessage,{...f})})}),(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:v.mediumTextColor},children:(0,k.jsx)(c.FormattedMessage,{...p})})})]}),shouldWrapCaption:!0,right:(0,k.jsx)("div",{style:{display:"flex",width:"100%",alignItems:"center",cursor:"pointer"},children:(0,k.jsx)(_.Z,{on:h[n],disabled:"necessary"===n,onClick:()=>{o(!0),d.Nh(b,n)}})})})}const x=function(e){let{renderOrigin:t,hasDismissButton:n,onDismiss:o}=e;return(0,k.jsx)(h.ZP,{popupType:h.Z4.Popup,placementToOrigin:f.Iw.Bottom,alignmentToOrigin:f.lU.Start,renderOrigin:t,render:()=>(0,k.jsx)(I,{hasDismissButton:n,onDismiss:o})})}},93262:(e,t,n)=>{n.d(t,{Z:()=>L});var o=n(67294),i=n(83355),r=n(1302),a=n(72126),s=n(70203),l=n(97880),c=n(42239),d=n(18957),u=n(52989),p=n(82007),m=n(24677),f=n(98104),g=n(84064),h=n(14976),v=n(12534),b=n(28314),y=n(98742),S=n(39500),_=n(45162),w=n(89224),k=n(89086),I=n(28685),C=n(95802),x=n(15723),T=n(55367),M=n(22294),P=n(88923),A=n(69784),R=n(27724),D=n(24666),B=n(6685),E=n(3386),F=n(85893);class Z extends i.Z{constructor(){super(...arguments),this.isSelected=!1,this.shouldEditOnClick=!0,this.shouldDisableMultiSelectionOnDragEnd=!1,this.contentEditableLeafRef=o.createRef(),this.wrapperRef=o.createRef(),this.handleKeyDown=e=>{e.metaKey||e.ctrlKey||e.altKey||M.Z.setKeyboardMode(!0)},this.handleDragStart=e=>{const t=this.getContextClosestSelectableStore();e.shiftKey&&!this.isEditing.state&&t?(e.preventDefault(),m.Ys({environment:this.environment,store:t,toggle:m.ji(this.environment),selectBetween:m.OS()}),this.shouldEditOnClick=!1):this.shouldEditOnClick=!0},this.handleDragMove=e=>{if(T.ZP.state.isDragging)c.td(this.environment,{currentX:e.currentX,currentY:e.currentY});else if(e.shiftKey)S.X9()&&c.f$(this.environment,{startX:e.startX,startY:e.startY,stores:R.default.state.stores,isNativeDrag:!1,getGhostElement:void 0});else if(!A.Z.state.isActive){if(!this.props.canSelectionDrag)return;const n=this.getNode();if(!n)return;const o=x.jn(n.getBoundingClientRect(),Z.minDragDist);if(x.uh(o,e.currentX,e.currentY))return;var t;if((0,_.Aw)(this.environment))return void("mouse"===e.device&&null!==(t=this.contentEditableContext)&&void 0!==t&&t.tryEnableMultiSelection()&&(this.shouldDisableMultiSelectionOnDragEnd=!0));this.shouldEditOnClick=!1,u.AI({environment:this.environment,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!1,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}},this.handleDragEnd=e=>{var t;this.shouldDisableMultiSelectionOnDragEnd&&(null===(t=this.contentEditableContext)||void 0===t||t.tryDisableMultiSelection(),this.shouldDisableMultiSelectionOnDragEnd=!1);T.ZP.state.isDragging?c.fX({environment:this.environment,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:"page_content"}):f.aJ()},this.handleClick=e=>{const{device:t}=this.environment;this.props.disabled||(0,v.ZP)({event:e,context:v.Af.EditorClick,callback:()=>{if(this.props.onClick&&this.props.onClick(e),e.defaultPrevented)return;const n=R.default.getDefaultContainerFromTarget(e.target);if(!P.default.isSidePeekOpen()||null!=n&&n.isPeekRenderer()||d.E5(this.environment),this.shouldEditOnClick){const n=this.getContextClosestSelectableStore();if(n?m.eP({environment:this.environment,store:n}):(m.Af({stores:[]}),m.$Y({environment:this.environment,phase:R.SelectionPhase.Selected,preventClearEditingText:!0})),t.isMobile&&!this.isEditing.state&&!this.isPartOfSelection.state){const t=this.getNode();if(t){let n;if(this.mutateDOM((()=>{t.classList.add("editor-force-select"),n=w.rangeFromPoint(e.clientX,e.clientY),t.classList.remove("editor-force-select")})),n){const e=this.getTextSelectionFromRange(n);e&&(f.Z5({store:this.props.store,selection:e.selection}),e.forceEmitSelectionStore&&D.default.emit())}}}this.saveSerializedTextSelectionAfterFlush()}else this.shouldEditOnClick=!0}})},this.handleDragCancel=e=>{T.ZP.state.isDragging&&(c.cQ(this.environment),m.ZH(this.environment))},this.handleContextMenu=e=>{this.props.onContextMenu&&(0,v.ZP)({event:e,context:v.Af.EditorContextMenu,callback:()=>{var t,n;if(null===(t=(n=this.props).onContextMenu)||void 0===t||t.call(n,e),!e.defaultPrevented)return"unhandled"}}),this.isEditing.state&&(0,v.ZP)({event:e,context:v.Af.EditorContextMenu,callback:()=>{this.saveSerializedTextSelectionAfterFlush()}})},this.handleDoubleClick=e=>{(0,v.ZP)({event:e,context:v.Af.EditorDoubleClick,callback:()=>{}})},this.handleSelect=e=>{const{device:t}=this.environment;t.isMobile?this.handleMobileSelect(e):this.handleDesktopSelect(e)},this.handleMobileSelect=e=>{if(!this.props.disabled){if(!w.get())return;const t=this.getContextClosestSelectableStore();this.isEditing.state||m.eP({environment:this.environment,store:t}),this.saveSerializedTextSelection(e),r.default.flush()}},this.handleDesktopSelect=e=>{this.props.disabled||!this.isEditing.state&&"contain"===e.endpoint||this.saveSerializedTextSelection(e)},this.defaultShortcutHandlers={onEsc:e=>{if(this.props.disabled)return;if(e.preventDefault(),(0,_.Aw)(this.environment)){const e="empty"!==D.default.state.mode&&D.default.state.multiSelection,t=e&&(0,_.tp)({multiSelection:e,filterCommonAncestors:!0,focus:void 0});if(t)return void m.Z5({environment:this.environment,...t})}const t=this.getContextClosestSelectableStore();if(t){const e=C.C.findSelectableFromStore(t);e&&e.props.canSelect&&m.Z5({environment:this.environment,stores:[t]})}},onUp:e=>{var t;this.props.disabled||((0,_.Aw)(this.environment)?f.N3({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):f.zJ({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onDown:e=>{var t;this.props.disabled||((0,_.Aw)(this.environment)?f.FG({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):f.DI({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onLeft:e=>{if(!this.props.disabled){var t;if((0,_.Aw)(this.environment))return f.AL({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry});f.e2({environment:this.environment,store:this.props.store,event:e})}},onRight:e=>{if(!this.props.disabled){var t;if((0,_.Aw)(this.environment))return f.D1({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry});f.FC({environment:this.environment,store:this.props.store,event:e})}},onSelectAll:e=>{if(!this.props.disabled){var t;if(e.preventDefault(),(0,_.Aw)(this.environment))return f.UV({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks,contentEditableContextId:null===(t=this.contentEditableContext)||void 0===t?void 0:t.id});f.mT({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks})}},onUndo:e=>{e.preventDefault(),p.Yw(this.environment)},onRedo:e=>{e.preventDefault(),p.KX(this.environment)},onGoToBeginningOfLine:e=>{this.setTextSelectionAfterFlush("start",e.shiftKey)},onGoToEndOfLine:e=>{this.setTextSelectionAfterFlush("end",e.shiftKey)}},this.saveSerializedTextSelectionAfterFlush=()=>{r.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.setTextSelectionAfterFlush=(e,t)=>{const n=D.default.state;"empty"!==n.mode&&r.default.afterNextFlush((()=>{const{start:o,end:i}=n.multiSelection;switch(e){case"start":{const e=o.store.getValue();if(!e)return;const n=s.Oqk({textValue:e,substring:"\n",ignoreCase:!1}).reverse().find((e=>{let{endIndex:t}=e;return t<=o.index})),r=(null==n?void 0:n.endIndex)??0,a={store:o.store,index:r};f.NA({multiSelection:{start:a,end:t?i:a}});break}case"end":{const e=(0,k.x0)(i.store);if(!e)return;const n=o.store.getValue();if(!n)return;const r=s.Oqk({textValue:n,substring:"\n",ignoreCase:!1}).find((e=>{let{startIndex:t}=e;return t>=i.index})),a=(null==r?void 0:r.startIndex)??e.endIndex,l={store:i.store,index:a};f.NA({multiSelection:{start:t?o:l,end:l}});break}default:(0,l.t1)(e)}}))},this.isPartOfSelection=this.createComputedStore((()=>(0,k.ZZ)(this.props.store)),!1,"isPartOfSelection"),this.isEditing=this.createComputedStore((()=>(0,k.J5)(this.props.store)),!1,"isEditing")}get registries(){return[I.E]}getContentEditableLeaf(){return this.contentEditableLeafRef.current||void 0}getNode(){return this.wrapperRef.current?this.wrapperRef.current:this.contentEditableLeafRef.current?this.contentEditableLeafRef.current.getNode():super.getNode()}didMountOrUpdate(){this.isEditing.state?this.isSelected||(this.isSelected=!0,this.props.onSelected&&this.props.onSelected()):this.isSelected&&(this.isSelected=!1,this.clearBrowserSelection(),this.props.onDeselected&&this.props.onDeselected())}willUnmount(){if(this.isSelected){this.isSelected=!1,this.props.onDeselected&&this.props.onDeselected();const e=this.isEditing.state;r.default.afterNextFlush((()=>{const t=I.E.findEditableWithStore(this.props.store),n=this.isEditing.state;e&&n&&!this.componentIsMounted&&!t&&f.ZH(this.environment)}))}}shouldComponentUpdate(e){return!0}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextClosestSelectableStore(){var e;return null===(e=this.context.selectable)||void 0===e||null===(e=e.closestSelectable)||void 0===e||null===(e=e.props)||void 0===e?void 0:e.store}renderComponent(){const{disabled:e,disableUpDownArrows:t,disableEnter:n}=this.props,o=this.isEditing.state;return(0,F.jsx)(E.Z,{capture:o&&!e,onDelete:this.getShortcutHandler("onDelete"),onDeleteToEndOfLine:this.getShortcutHandler("onDeleteToEndOfLine"),onDeleteNextWord:this.getShortcutHandler("onDeleteNextWord"),onBackspace:this.getShortcutHandler("onBackspace"),onEnter:n?void 0:this.getShortcutHandler("onEnter"),onShiftEnter:this.getShortcutHandler("onShiftEnter"),onCommandEnter:this.getShortcutHandler("onCommandEnter"),onCommandShiftEnter:this.getShortcutHandler("onCommandShiftEnter"),onUp:t?void 0:this.getShortcutHandler("onUp"),onDown:t?void 0:this.getShortcutHandler("onDown"),onLeft:this.getShortcutHandler("onLeft"),onRight:this.getShortcutHandler("onRight"),onCommandLeft:this.getShortcutHandler("onCommandLeft"),onCommandRight:this.getShortcutHandler("onCommandRight"),onTab:this.getShortcutHandler("onTab"),onUntab:this.getShortcutHandler("onUntab"),onSelectAll:this.getShortcutHandler("onSelectAll"),onToggleUnderline:this.getShortcutHandler("onToggleUnderline"),onToggleHighlight:this.getShortcutHandler("onToggleHighlight"),onToggleBold:this.getShortcutHandler("onToggleBold"),onToggleItalics:this.getShortcutHandler("onToggleItalics"),onToggleStrike:this.getShortcutHandler("onToggleStrike"),onToggleCode:this.getShortcutHandler("onToggleCode"),onUndo:this.getShortcutHandler("onUndo"),onRedo:this.getShortcutHandler("onRedo"),onEsc:this.getShortcutHandler("onEsc"),onCut:this.getShortcutHandler("onCut"),onCopy:this.getShortcutHandler("onCopy"),onPaste:this.getShortcutHandler("onPaste"),onKeypress:this.getShortcutHandler("onKeyPress"),onMoveUp:this.getShortcutHandler("onMoveUp"),onMoveDown:this.getShortcutHandler("onMoveDown"),onHome:this.saveSerializedTextSelectionAfterFlush,onEnd:this.saveSerializedTextSelectionAfterFlush,onGoToBeginningOfLine:this.getShortcutHandler("onGoToBeginningOfLine"),onGoToEndOfLine:this.getShortcutHandler("onGoToEndOfLine"),onGoForwardOneChar:this.saveSerializedTextSelectionAfterFlush,onGoBackwardOneChar:this.saveSerializedTextSelectionAfterFlush,children:this.renderDraggable()})}renderDraggable(){const e=this.isEditing.state;return(0,F.jsx)(B.Z,{disabled:this.props.disableDrag,onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,cursor:"text",render:t=>this.props.render((0,y.Z)(t,{leafRef:this.contentEditableLeafRef,wrapperRef:this.wrapperRef,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onKeyDown:this.handleKeyDown,onDoubleClick:this.handleDoubleClick}),this.handleSelect,Boolean(e)),enableAndroidContextMenu:this.props.disabled,disableHorizontalEdgeScroll:this.props.disableHorizontalEdgeScroll})}getShortcutHandler(e){const t=this.props[e],n=this.defaultShortcutHandlers[e];return t??n}getTextSelectionFromRange(e){return(0,h.Ut)(this.environment,e)}saveSerializedTextSelection(e){const t=w.get();if((0,_.Aw)(this.environment)){var n;const e=(0,_.fx)({contentEditableLeafRegistry:null===(n=this.contentEditableContext)||void 0===n?void 0:n.contentEditableLeafRegistry,range:t,allowInvisibleEndSelection:(0,b.yA)().shift});return e?void f.bc({environment:this.environment,...e,readOnly:"infer",focus:void 0}):void 0}const o=this.getTextSelectionFromRange(t);if(o){const e="empty"!==D.default.state.mode&&(0,_.xI)("Editable",D.default.state.multiSelection);if(e&&e.store===this.props.store&&a.Xy(e.selection,o.selection)&&!o.forceEmitSelectionStore)return;f.Z5({store:this.props.store,selection:o.selection,readOnly:this.props.disabled}),o.forceEmitSelectionStore&&D.default.emit()}}clearBrowserSelection(){this.props.clearBrowserSelection()}}Z.displayName="Editable",Z.minDragDist=20,Z.contextTypes={...g.Tf,...i.w};const L=Z},69278:(e,t,n)=>{n.d(t,{Z:()=>Ot});var o=n(67294),i=n(73935),r=n(18466),a=n(13991),s=n(53150),l=n(6740),c=n(49085),d=n(41432),u=n(84939),p=n(8848),m=n(95538),f=n(9999),g=n(82477),h=n(70622),v=n(53376),b=n(49089),y=n(42853),S=n(25654),_=n(86215),w=n(64330),k=n(37240),I=n(95855),C=n(30845),x=n(72126),T=n(23210),M=n(70203),P=n(82990),A=n(5366),R=n(50906),D=n(54564),B=n(47307),E=n(31781),F=n(96802),Z=n(27153),L=n(42858),j=n(24677),V=n(98104),U=n(39699),O=n(18821),N=n(95477),z=n(28020),H=n(43250),W=n(41232),q=n(33929),G=n(98742),K=n(17504),$=n(65598),Q=n(18245),Y=n(68859),J=n(61766),X=n(88632),ee=n(80796);class te extends c.default{getInitialState(){return{hovered:!1,focused:!1,isInFrame:!1}}}const ne=te;var oe=n(27411),ie=n(69784),re=n(83355),ae=n(12534),se=n(96049),le=n(43593),ce=n(80750),de=n(37250),ue=n(59401),pe=n(97880),me=n(64002),fe=n(24608),ge=n(18514),he=n(16354),ve=n(64369),be=n(85893);function ye(e){switch(e){case"image":return de.D;case"audio":case"video":return ue.K;default:return ce.l}}function Se(e,t){if(e&&e instanceof fe.Gg){let n=t||e.data.url;return me.j3(n)&&(n=me.O_({relativeUrl:n,baseUrl:N.default.domainBaseUrl})),e.data.offline?me.j3(e.data.url)||e.data.url.startsWith(N.default.domainBaseUrl)?{type:"offline"}:{type:"unknown",source:n}:{type:"http",source:n,statusCode:e.data.status}}}function _e(e,t){const n=e.error,o=t||e.src;if(n)return n.code===n.MEDIA_ERR_DECODE||n.code===n.MEDIA_ERR_SRC_NOT_SUPPORTED?{type:"unsupported_content_type",extension:o&&(0,le.mD)(o)}:n.code===n.MEDIA_ERR_NETWORK?{type:"offline"}:void 0}function we(){return(0,be.jsx)(A.FormattedMessage,{id:"embedError.extension.unknown",defaultMessage:"unknown"})}function ke(e){const{source:t,statusCode:n}=e,o=me.Qc(t).hostname;return(0,be.jsx)(A.FormattedMessage,{defaultMessage:"{hostname} (Error {statusCode})",id:"embedError.hostnameAndStatusCode",values:{hostname:o,statusCode:n}})}function Ie(e){switch(e){case"audio":return(0,ge.UY)("guides.audioFaqs");case"video":return(0,ge.UY)("guides.videosFaqs");case"image":return(0,ge.UY)("guides.imagesFaqs");default:return(0,ge.UY)("guides.embedsFaqs")}}class Ce extends re.Z{didMount(){R.QUd(this.environment,{embedType:this.props.family,embedErrorType:this.props.error.type})}renderComponent(){const{style:e,error:t,family:n,isSmall:o}=this.props,i={background:this.theme.embedPlaceholderBackground,cursor:"default",...e||{},position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",alignContent:"center",alignItems:"center",justifyContent:o?"flex-start":"center",padding:o?"7px 14px":"0.5em 1em",textAlign:"center",flexDirection:o?"row":"column",overflow:"hidden"},r=o?25:48,a=o?"0px 14px 0 0":"0 0 14px 0",s=function(e,t){return"image"===t?"unsupported_content_type"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This image format ({extension}) can't be played on this device.",id:"embedError.image.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this image",id:"embedError.image.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.unknown"}):404===e.statusCode?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This image couldn't be found.",id:"embedError.image.notFound"}):401===e.statusCode||403===e.statusCode?(0,be.jsx)(A.FormattedMessage,{id:"embedError.image.permissionDenied",defaultMessage:"Permission denied."}):(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.serverError"}):"audio"===t?"unsupported_content_type"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This audio format ({extension}) can't be played on this device.",id:"embedError.audio.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this audio",id:"embedError.audio.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.unknown"}):404===e.statusCode?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This audio couldn't be found.",id:"embedError.audio.notFound"}):401===e.statusCode||403===e.statusCode?(0,be.jsx)(A.FormattedMessage,{id:"embedError.audio.permissionDenied",defaultMessage:"Permission denied."}):(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.serverError"}):"video"===t?"unsupported_content_type"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This video format ({extension}) can't be played on this device.",id:"embedError.video.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this video",id:"embedError.video.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.unknown"}):404===e.statusCode?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This video couldn't be found.",id:"embedError.video.notFound"}):401===e.statusCode||403===e.statusCode?(0,be.jsx)(A.FormattedMessage,{id:"embedError.video.permissionDenied",defaultMessage:"Permission denied."}):(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.serverError"}):"file"===t?"unsupported_content_type"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This file format ({extension}) can't be played on this device.",id:"embedError.file.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this file",id:"embedError.file.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.unknown"}):404===e.statusCode?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This file couldn't be found.",id:"embedError.file.notFound"}):401===e.statusCode||403===e.statusCode?(0,be.jsx)(A.FormattedMessage,{id:"embedError.file.permissionDenied",defaultMessage:"Permission denied."}):(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.serverError"}):"embed"===t?"unsupported_content_type"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This embed format ({extension}) can't be played on this device.",id:"embedError.embed.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this embed",id:"embedError.embed.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.unknown"}):404===e.statusCode?(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This embed couldn't be found.",id:"embedError.embed.notFound"}):401===e.statusCode||403===e.statusCode?(0,be.jsx)(A.FormattedMessage,{id:"embedError.embed.permissionDenied",defaultMessage:"Permission denied."}):(0,be.jsx)(A.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.serverError"}):void(0,pe.t1)(t)}(t,n);return(0,be.jsxs)("div",{style:i,children:[ye(n)({fill:this.theme.lightTextColor,width:r,height:r,margin:a}),(0,be.jsxs)(ve.Z,{isSecondaryColor:!0,isMultiline:!o,style:{margin:a},children:[(0,be.jsx)("div",{style:{display:o?"inline-block":"block",marginRight:o?"14px":void 0},children:s}),"offline"!==t.type&&(0,be.jsx)(he.Z,{style:{display:"inline",pointerEvents:"auto",cursor:"auto",borderBottom:`1px solid ${this.theme.lightTextColor}`},href:Ie(n),external:!0,onClick:()=>{R.Fsx(this.environment,{from:"embed_error"})},children:(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Learn more",id:"embedError.learnMore"})})]}),!o&&"http"===t.type&&(0,be.jsx)(ve.Z,{isSmall:!0,isSecondaryColor:!0,children:ke(t)}),!o&&"unknown"===t.type&&t.source&&(0,be.jsx)(ve.Z,{isSmall:!0,isSecondaryColor:!0,children:me.Qc(t.source).hostname})]})}}Ce.displayName="EmbedErrorBox";const xe=Ce;var Te=n(35021);let Me=null;class Pe extends re.Z{constructor(){super(...arguments),this.storeTypes={error:c.default.createClass(void 0)},this.onPlay=e=>{Me&&Me.pause(),Me=e.currentTarget},this.onPause=e=>{Me===e.currentTarget&&(Me=null)},this.onError=e=>{const t=_e(e.currentTarget,this.props.source);t&&this.stores.error.setState(t)}}renderComponent(){const{contentWrapStyle:e,source:t,handleEmbedComp:n}=this.props;return(0,be.jsx)("div",{style:e,onMouseDown:ae.$0,onTouchStart:ae.$0,children:(0,be.jsxs)("div",{style:this.getStyle(),children:[(0,be.jsx)("audio",{ref:e=>n(e),style:this.getStyle(),controls:!0,preload:"none",onError:this.onError,onPlay:this.onPlay,onPause:this.onPause,src:t}),this.renderError()]})})}renderError(){const e=this.stores.error.state;if(e)return(0,be.jsx)(xe,{family:"audio",error:e,isSmall:!0})}getStyle(){const{contentStyle:e}=this.props;return{...e,pointerEvents:se.Z.state?"none":"auto",position:"relative"}}}Pe.displayName="AudioBox",Pe.containerStyle={position:"relative",borderColor:p.ZP.contentBorder,borderRadius:3,borderWidth:1,borderStyle:"solid"};const Ae={render:function(e){const{contentStyle:t,contentWrapStyle:n,handleEmbedComp:o}=e;return(0,be.jsx)(Te.Z,{url:e.source,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,render:(e,i,r)=>r?i?(0,be.jsx)(Pe,{contentStyle:t,contentWrapStyle:n,source:i,handleEmbedComp:o}):void 0:(0,be.jsx)("div",{})})},resizable:!1,hideActions:!0,rendererType:"audio"};var Re=n(85854),De=n(13966),Be=n(91893),Ee=n(70518),Fe=n(68709),Ze=n(64921),Le=n(31945),je=n(89728),Ve=n(26388),Ue=n(480),Oe=n(86628),Ne=n(24405),ze=n(73959),He=n(77907),We=n(27724),qe=n(21199),Ge=n(1743);function Ke(e){window.__c={n:"DrawingBox"};const t=(0,Ue.O7)(),n=(0,Oe.VK)((()=>(0,ze.iZ)(e.store)),[e.store]),i=(0,Ne.yK)((t=>({sizer:{height:e.height,display:"flex",borderRadius:3,paddingTop:2,paddingLeft:10,paddingRight:10,paddingBottom:10},border:{display:"flex",flex:1,margin:2,padding:3,boxShadow:n?t.outlineBlueInputBoxShadow:void 0,outline:`1px solid ${t.regularDividerColor}`,transition:"box-shadow 0.1s ease-in-out",willChange:"box-shadow",borderRadius:3},ignoreClickArea:{flex:1,position:"relative"}})),[n,e.height]),r=(0,o.useCallback)((()=>{V.ZH({device:t.device}),j.Z5({environment:t,stores:[e.store],phase:We.SelectionPhase.Editing})}),[t,e.store]),a=(0,o.useCallback)((t=>(0,be.jsx)("div",{...t,style:i.ignoreClickArea,className:"notion-disable-webkit-user-select",children:(0,be.jsx)(He.LazyTldrawAdapter,{...e,isEditing:n})})),[i.ignoreClickArea,e,n]);return(0,be.jsx)("div",{style:i.sizer,onPointerDown:r,children:(0,be.jsx)("div",{style:i.border,children:(0,be.jsx)(Ge.Z,{capture:n,allowEsc:!0,children:(0,be.jsx)(qe.Z,{capture:!0,render:a})})})})}const $e={render:e=>(0,be.jsx)(Ke,{...e}),resizable:!0,hideActions:!0,rendererType:"drawing"};var Qe=n(86329),Ye=n(29477);let Je=0;function Xe(e){const t=Ye.UZ(),n=document.createElement("script");n.type="text/javascript";const o=function(){const e="notion_jsonp_callback_"+Je;return Je++,e}();window[o]=e=>{delete window[o],n.parentNode&&n.parentNode.removeChild(n),t.resolve(e)};const i=me.SK(e,{callback:o});return n.src=i,n.onerror=e=>{delete window[o],n.parentNode&&n.parentNode.removeChild(n),t.reject(e)},document.head&&document.head.appendChild(n),t.promise}class et extends c.default{getInitialState(){return{loading:!0,error:!1,html:void 0}}}const tt=et;var nt=n(68785),ot=n(33411);class it extends re.Z{constructor(){super(...arguments),this.storeTypes={store:tt}}async didMount(){const e=`https://gist.github.com/${this.getGistId()}.json`;try{const n=await Xe(e);this.stores.store.setState({loading:!1,error:!1,html:n.div});if(!document.querySelector(`link[href="${n.stylesheet}"]`)){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=n.stylesheet,document.head&&document.head.appendChild(t)}}catch(n){this.stores.store.setState({loading:!1,error:!0,html:void 0})}}renderComponent(){return(0,be.jsx)("div",{children:(0,be.jsx)(qe.Z,{capture:!0,render:e=>(0,be.jsx)("div",{...e,ref:this.props.handleEmbedComp,style:this.getStyle(),children:this.renderGist()})})})}renderGist(){return(0,be.jsx)(ot.Z,{show:this.stores.store.state.loading,showDelay:1e3,showHold:500,render:e=>e||this.stores.store.state.loading?(0,be.jsx)("div",{style:{marginBottom:"1em"},children:(0,be.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",opacity:e?1:0,...it.loadingStyle},children:[(0,be.jsx)(nt.Z,{}),(0,be.jsx)("div",{style:{marginLeft:8},children:(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Loading gist",id:"githubGistRenderer.loading.message"})})]})}):this.stores.store.state.error?(0,be.jsx)("div",{style:{marginBottom:"1em"},children:(0,be.jsx)("div",{style:it.loadingStyle,children:(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Error loading gist",id:"githubGistRenderer.errorLoading.message"})})}):(0,be.jsx)("div",{dangerouslySetInnerHTML:{__html:this.stores.store.state.html},className:"notion-gist-block"})})}getStyle(){return this.stores.store.state.html?{width:"100%",marginBottom:"-1em",overflowY:"auto",height:"100%",pointerEvents:se.Z.state?"none":"auto"}:{width:"100%",marginBottom:"-1em"}}getGistId(){const{source:e}=this.props,{pathname:t}=me.Qc(e);return(t||"").split("/").pop()}}it.displayName="GistBox",it.loadingStyle={userSelect:"none",padding:"6px 10px",borderRadius:3,border:"1px solid #dddddd",fontSize:14,width:"100%"};const rt={render:function(e){const{source:t,handleEmbedComp:n}=e;return(0,be.jsx)(it,{source:t,handleEmbedComp:n})},renderFullScreen:void 0,resizable:!0,embedGhost:!0,hideActions:!0};var at=n(63085),st=n(25777),lt=n(49271),ct=n(69721);const dt=function(e){const{signedUrl:t,dataSize:n,dataName:o,contentWrapStyle:i,disabled:r,viewOriginal:a}=e,s={paddingTop:lt.ZD.paddingTop,paddingBottom:lt.ZD.paddingBottom,paddingLeft:lt.ZD.paddingLeft};return(0,be.jsx)("div",{style:i,onClick:void 0,onMouseDown:ae.$0,children:(0,be.jsx)("div",{style:{position:"relative"},children:t&&(0,be.jsx)(ct.S,{title:o,url:t,size:n,onClick:r?void 0:a,style:s})})})};var ut=n(84456),pt=n(77137),mt=n(87111);const ft=e=>{let{url:t,metadata:n}=e;window.__c={n:"IFramePreviewRenderer"};const o=(0,Ne.yK)((e=>({previewWrapper:{display:"flex",flexDirection:"column",border:`1px solid ${e.darkDividerColor}`,borderRadius:"3px",height:"100%"},previewImageArea:{flex:1,backgroundColor:e.embedPlaceholderBackground},previewInfoArea:{padding:"0.75em 1em",backgroundColor:e.regularInvertedTextColor,display:"flex",flexDirection:"column",gap:"0.25em"},previewTitle:{fontWeight:P.Z.fontWeight.medium,color:e.darkTextColor},previewUrl:{display:"flex",alignItems:"center",gap:"0.75em"},previewUrlText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e.lightTextColor},previewUrlFavicon:{width:"1.25em",height:"1.25em"}})),[]),i=null!=n&&n.images&&n.images.length>0?n.images[0].url:void 0;return(0,be.jsxs)("div",{style:o.previewWrapper,children:[(0,be.jsx)("div",{style:o.previewImageArea,children:i?(0,be.jsx)(gt,{imageUrl:i}):(0,be.jsx)(ht,{})}),(0,be.jsxs)("div",{style:o.previewInfoArea,children:[(null==n?void 0:n.title)&&(0,be.jsx)("div",{style:o.previewTitle,children:n.title}),(0,be.jsxs)("div",{style:o.previewUrl,children:[(null==n?void 0:n.favicon_url)&&(0,be.jsx)("img",{style:o.previewUrlFavicon,src:n.favicon_url}),(0,be.jsx)("div",{style:o.previewUrlText,children:t})]})]})]})},gt=e=>{let{imageUrl:t}=e;window.__c={n:"EmbedPreviewArea"};const n=(0,Ne.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",height:"100%",backgroundSize:"cover",backgroundImage:`url(${t})`},pill:{backgroundColor:e.accentColors.gray[800],color:e.accentColors.gray[50],borderRadius:"99em",padding:"0.5em 1em",margin:"1em",display:"flex",alignItems:"center",gap:"0.75em",fontWeight:P.Z.fontWeight.medium},playButton:{width:"1em",height:"1em",fill:e.accentColors.gray[50]}})),[t]);return(0,be.jsx)("div",{style:n.wrapper,children:(0,be.jsxs)("div",{style:n.pill,children:[(0,mt.I)(n.playButton),(0,be.jsx)("span",{children:(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Load embed",id:"iFramePreview.pillLabel"})})]})})},ht=()=>{window.__c={n:"ImagelessArea"};const e=(0,Ne.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:e.mediumTextColor,height:"100%"},message:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:"0.75em",fontWeight:P.Z.fontWeight.medium},playButtonWrapper:{backgroundColor:e.mediumTextColor,borderRadius:"2em",width:"2.5em",height:"2.5em",display:"flex",justifyContent:"center",alignItems:"center"},playButton:{marginLeft:"0.1em",width:"1em",height:"1em",fill:e.embedPlaceholderBackground}})),[]);return(0,be.jsx)("div",{style:e.wrapper,children:(0,be.jsxs)("div",{style:e.message,children:[(0,be.jsx)("div",{style:e.playButtonWrapper,children:(0,mt.I)(e.playButton)}),(0,be.jsx)("span",{children:(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Tap to load embed",id:"iFramePreview.imagelessAreaLabel"})})]})})};class vt extends re.Z{constructor(){super(...arguments),this.renderPreviewContent=(e,t,n)=>{if(n)return(0,be.jsx)(ft,{url:this.props.source,metadata:t})},this.peformPreviewRequest=async e=>(0,at.W4)(this.environment,e)}renderComponent(){const e={request:this.props.source,performRequest:this.peformPreviewRequest,render:this.renderPreviewContent};return(0,be.jsx)(pt.Z,{...e})}}function bt(e){window.__c={n:"FullScreenIFrameRenderer"};const{height:t,source:n,contentStyle:i,dataName:r,dataSize:a}=e,[s,l]=(0,o.useState)(!1);return(0,be.jsx)(Te.Z,{url:n,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,render:(o,c)=>s&&r&&a?dt({...e,dataName:r,dataSize:a,signedUrl:c}):(0,be.jsx)(ut.Z,{source:n,isFullWidth:!0,isFullHeight:!0,height:t,style:i,background:!0,onContentLoadTimeout:()=>l(!0)})})}vt.displayName="IFramePreview";const yt={render:function(e){window.__c={n:"IFrameRenderer"};const{disabled:t,contentStyle:n,contentWrapStyle:i,handleFullScreen:r,handleEmbedComp:a,height:s,preserveScale:l,isFullWidth:c,source:d,dataName:u,dataSize:p}=e,[m,f]=(0,o.useState)(!1);return(0,be.jsx)(Te.Z,{url:d,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,render:(o,d,g)=>{if(!g||o){const e={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};return(0,be.jsx)(st.Z,{innerStyle:{height:"100%",width:"100%"},loaded:g,style:e,spinnerSize:"1em",showSpinnerTimeout:500})}return m&&u&&p?dt({...e,dataName:u,dataSize:p,signedUrl:d}):(0,be.jsx)("div",{style:i,onClick:t?r:void 0,onMouseDown:ae.$0,children:(0,be.jsx)("div",{style:{position:"relative"},children:d&&(0,be.jsx)(ut.Z,{ref:e=>a(e),source:d,height:s,style:n,preserveScale:l,isFullWidth:c,background:!0,renderPreview:()=>(0,be.jsx)(vt,{source:(0,at.cJ)(e)}),onContentLoadTimeout:()=>f(!0)})})})}})},embedGhost:!0,renderFullScreen:e=>(0,be.jsx)(bt,{...e}),resizable:!0};var St=n(10517),_t=n.n(St),wt=n(54642),kt=n(5162),It=n(24042),Ct=n(12981),xt=n(32854),Tt=n(81865);class Mt extends re.Z{constructor(){super(...arguments),this.storeTypes={error:c.default.createClass(void 0)},this.previousImageURL=void 0,this.previousSourceURL=void 0,this.signedOriginalURL=void 0,this.useNativeLightbox=(0,kt.Y)("supportsMobileImageLightbox"),this.getSignedOriginalUrlIfNecessary=(e,t)=>{this.useNativeLightbox&&e&&this.environment.mobileNative&&(this.signedOriginalURL&&e===this.previousSourceURL||(this.previousSourceURL=e,wt.getSignedFileUrl(this.environment,{url:e,download:!1,downloadName:"image",permissionRecord:t.pointer},Boolean(It.Z.state.isNotionProtocolBugFixed)).then((e=>{this.signedOriginalURL=e}))))},this.renderURL=(e,t)=>{const n=t||this.previousImageURL;this.previousImageURL=t;const{isFullScreen:o}=this.props,i=Se(e,void 0)||(0,at.sj)(e)||this.stores.error.state;return o?this.renderFullScreen(i,n):this.renderInline(i,n)},this.handleClickWithoutPropagation=e=>{e.stopPropagation(),this.props.handleFullScreen()},this.onImageError=async(e,t)=>{const n=le.E$(this.props.source,[N.default.secureFileS3.url,N.default.secureFileS3V2.url])?t:this.props.source;if(t){const e=await(0,fe.ZP)({url:t,environment:this.environment,method:"HEAD",format:"text"});if("failed"===e.type){const t=Se(e.error,n);if(t)return void this.stores.error.setState(t)}}this.stores.error.setState({type:"unknown",source:n})},this.onImageLoad=()=>{this.stores.error.setState(void 0)}}renderComponent(){const{store:e,dataURL:t,source:n,isFullWidth:o,dragging:i,blockWidth:r,isFullScreen:a}=this.props;if(t)return this.renderURL(void 0,t);this.getSignedOriginalUrlIfNecessary(n,e);const s=o&&!i?void 0:r,l=window.innerWidth,c=s?Math.min(s,window.innerWidth):window.innerWidth;return(0,be.jsx)(Tt.Z,{url:n,width:a?l:c,render:this.renderURL,isAuthenticated:!0,permissionRecord:e.pointer},`width-${this.props.contentStyle.width}`)}renderInline(e,t){const{progressPercent:n,disabled:o,isLoading:i,contentStyle:r,contentWrapStyle:a,handleFullScreen:s,handleEmbedComp:l,isFullWidth:c,isRootChild:d,height:u,inlineContentStyle:p,blockLocation:m,imageBoxRef:f}=this.props,g=E.qC(m),h=this.useNativeLightbox?()=>{var e;if(R.QIc(this.environment,{from:"embedded_block_click",type:"image"}),!t)return;const n=0===t.indexOf("https:")?t:`${N.default.domainBaseUrl}${t}`;null===(e=this.environment.mobileNative)||void 0===e||e.showLightBox({items:[{type:"image",previewUrl:_t()(n),originalUrl:_t()(this.signedOriginalURL??n)}],startingIndex:0,from:"embedded_block_click"}),j.ZH(this.environment),V.sD()}:void 0,v=this.environment.mobileNative&&this.useNativeLightbox&&!1===(null==t?void 0:t.startsWith("data:")),b=v?h:g?void 0:s,y=g?this.handleClickWithoutPropagation:void 0,S=v?h:y,_=g?this.handleClickWithoutPropagation:s;return(0,be.jsx)("div",{ref:e=>l(e),style:a,onClick:o&&!v?_:void 0,children:(0,be.jsxs)("div",{children:[(0,be.jsx)(Ct.Z,{ref:f,src:t,loading:"lazy",isFullScreen:!1,style:{...r,...p},placeholderStyle:this.getPlaceholderStyle(),onDoubleClick:b,onClick:S,height:c&&d?u:void 0,capMaxHeight:c&&d,onError:this.onImageError,onLoad:this.onImageLoad}),e&&(0,be.jsx)(xe,{error:e,family:"image"}),i&&(0,be.jsxs)("div",{style:Ct.Z.loadingContainerStyle,children:[(0,be.jsx)(nt.Z,{style:{width:16,height:16,marginRight:4}}),(0,be.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,be.jsx)(xt.Z,{percentage:n})})]})]})})}renderFullScreen(e,t){const{contentStyle:n}=this.props,o=Math.min(500,window.innerWidth-50);return(0,be.jsx)("div",{style:{alignSelf:"center",margin:0,position:"relative",minWidth:e?o:void 0},children:(0,be.jsxs)("div",{children:[(0,be.jsx)(Ct.Z,{src:t,isFullScreen:!0,style:{...n,background:this.theme.contentBackground},placeholderStyle:this.getPlaceholderStyle(),capMaxHeight:!1,onError:this.onImageError,onLoad:this.onImageLoad}),e&&(0,be.jsx)(xe,{error:e,family:"image"})]})})}getPlaceholderStyle(){const{isFullWidth:e,isRootChild:t,aspectRatio:n,height:o}=this.props,i={};return e&&t||!n?o&&(i.height=o,i.background=p.ZP.contentGrayBackground):(i.height=0,i.paddingBottom=100*n+"%",i.background=p.ZP.contentGrayBackground),i}}Mt.displayName="EmbedImageRenderer";const Pt={render:e=>(0,be.jsx)(Mt,{...e,isFullScreen:!1}),renderFullScreen:e=>(0,be.jsx)(Mt,{...e,isFullScreen:!0}),resizable:!0};const At={render:function(e){const{disabled:t,contentStyle:n,contentWrapStyle:o,handleFullScreen:i,source:r,handleEmbedComp:a,height:s}=e;return(0,be.jsx)("div",{style:o,onClick:t?i:void 0,children:(0,be.jsx)("div",{style:{position:"relative"},children:(0,be.jsx)(ut.Z,{ref:e=>a(e),source:r,height:s,style:n,background:!1,renderPreview:()=>(0,be.jsx)(vt,{source:(0,at.cJ)(e)})})})})},renderFullScreen:function(e){const{source:t,height:n,contentStyle:o}=e;return(0,be.jsx)(ut.Z,{source:t,isFullWidth:!0,height:n,style:o,background:!0})},resizable:!0};var Rt=n(53238),Dt=n(83785);function Bt(e){window.__c={n:"TweetBox"};const{handleEmbedComp:t,source:r,fullScreen:a}=e,s=(0,Ne.Fg)(),l=(0,Ne.yK)((e=>({main:{width:a?520:"100%",minWidth:"100%",pointerEvents:"auto",margin:a?"-10px auto":"-10px 0"},loading:{userSelect:"none",borderRadius:3,border:"1px solid #dddddd",fontSize:14,width:"100%",padding:"6px 10px"}})),[a]),c=(0,o.useCallback)((async e=>{if(!e)return;const{pathname:t}=me.Qc(r),n=(t||"").split("/")[3],o={dnt:!0,lang:"en",width:"100%",theme:"dark"===s.mode?"dark":"light"};if(n&&window.twttr){e.innerHTML="";if(await window.twttr.widgets.createTweetEmbed(n,e,o))return}i.render((0,be.jsx)("div",{style:l.loading,children:"Error loading tweet"}),e)}),[r,l.loading,s.mode]);return(0,be.jsx)("div",{style:{display:"flex"},children:(0,be.jsx)("div",{style:{marginLeft:"auto",marginRight:"auto",maxWidth:420,minWidth:0,width:"100%"},children:(0,be.jsx)(qe.Z,{capture:!0,render:e=>(0,be.jsx)("div",{...e,ref:e=>e&&t(e),style:l.main,children:(0,be.jsx)(Dt.Z,{fetch:()=>n.e(898).then(n.bind(n,22062)),loading:e=>e&&(0,be.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",...l.loading},children:[(0,be.jsx)(nt.Z,{}),(0,be.jsx)("div",{style:{marginLeft:8},children:(0,be.jsx)(A.FormattedMessage,{id:"tweetRenderer.loadingTweet.message",defaultMessage:"Loading Tweet"})})]}),render:()=>(0,be.jsx)("div",{ref:c})})})})})})}const Et={render:function(e){const{source:t,handleEmbedComp:n}=e;return(0,be.jsx)(Bt,{source:t,handleEmbedComp:n,fullScreen:!1})},renderFullScreen:function(e){const{source:t,handleEmbedComp:n}=e;return(0,be.jsx)(Bt,{source:t,handleEmbedComp:n,fullScreen:!0})},resizable:!1,embedGhost:!0,hideActions:!0};class Ft extends re.Z{constructor(){super(...arguments),this.storeTypes={played:c.default.createClass(!1),error:c.default.createClass(void 0)},this.handlePlay=e=>{this.stores.played.setState(!0)},this.handlePause=e=>{const{device:t}=this.environment;t.isMobile&&this.stores.played.setState(!1)},this.handleEnded=e=>{const{device:t}=this.environment;t.isAndroid&&document.fullscreenElement&&document.exitFullscreen()},this.handleLoadStart=e=>{const{device:t}=this.environment;t.isIOS&&this.video&&this.video.pause()},this.handleError=e=>{const t=_e(e.currentTarget,this.props.source);t&&this.stores.error.setState(t)},this.handleRef=e=>{this.props.handleEmbedComp(e),this.video=e},this.handlePlayVideo=e=>{this.video&&(0,ae.ZP)({event:e,context:ae.Af.EditorClick,callback:()=>{this.video.play()}})}}renderComponent(){const{store:e,source:t,contentWrapStyle:n,handleFullScreen:o,aspectRatio:i,height:r,handleEmbedComp:a,isFullWidth:s,preserveScale:l,mediaType:c,useS3Url:d}=this.props;return(0,be.jsx)(Te.Z,{url:t,permissionRecord:e.pointer,useS3Url:d,render:(e,d,u)=>{if(!u)return(0,be.jsx)("div",{});const p=Se(e,void 0)||this.stores.error.state;return d?"video"===c||(0,m.xL)({url:t})?(0,be.jsx)("div",{style:n,onMouseDown:ae.$0,children:(0,be.jsxs)("div",{style:{position:"relative"},onDoubleClick:o,children:[this.renderVideo(d),p&&this.renderError(p),this.renderOverlay()]})}):(0,be.jsx)("div",{style:n,onDoubleClick:o,children:(0,be.jsx)("div",{style:{position:"relative"},children:(0,be.jsx)(ut.Z,{ref:e=>a(e),source:d,height:r,style:this.getContentStyle("embed_url"),isFullWidth:s,preserveScale:l,aspectRatio:i,background:!0})})}):void 0}})}renderPlayButton(){const{device:e}=this.environment;return e.isFirefox||e.isMobile?null:(0,be.jsx)(Zt,{})}getContentStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"embed_url";const{isFullWidth:t,isRootChild:n,preserveScale:o,height:i}=this.props,r={...this.props.contentStyle};return t&&n&&o&&(r.height=i),"video_file"!==e||this.stores.played.state||(r.pointerEvents="none"),E.qC(this.props.blockLocation)&&(r.maxHeight=240),r.backgroundColor=this.theme.embedPlaceholderBackground,r}renderVideo(e){return(0,be.jsx)("video",{ref:this.handleRef,style:this.getContentStyle("video_file"),autoPlay:this.environment.device.isIOS,playsInline:!0,controls:!0,preload:"metadata",onPause:this.handlePause,onPlay:this.handlePlay,onEnded:this.handleEnded,onLoadStart:this.handleLoadStart,onError:this.handleError,src:e})}renderError(e){return(0,be.jsx)(xe,{family:"video",error:e})}renderOverlay(){return this.stores.played.state||this.stores.error.state?null:(0,be.jsx)("div",{onClick:this.handlePlayVideo,style:Ft.overlayStyle,children:this.renderPlayButton()})}}function Zt(e){return(0,be.jsx)("div",{style:{...Ft.buttonContainerStyle,...e.style},children:(0,be.jsx)("div",{style:Ft.buttonTriangleStyle})})}Ft.displayName="VideoRenderer",Ft.overlayStyle={position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},Ft.buttonContainerStyle={position:"relative",height:70,width:70,borderWidth:3,borderStyle:"solid",borderColor:p.ZP.uiBlack,borderRadius:70},Ft.buttonTriangleStyle={position:"absolute",left:"50%",top:"50%",transform:"translate(-30%, -50%)",height:0,width:0,borderStyle:"solid",borderColor:p.ZP.uiBlack,borderRightWidth:0,borderLeftWidth:24.5,borderTopWidth:16.1,borderBottomWidth:16.1,borderTopColor:p.ZP.transparent,borderBottomColor:p.ZP.transparent};const Lt={render:e=>(0,be.jsx)(Ft,{...e}),resizable:!0,embedGhost:!0},jt=(0,A.defineMessages)({embedButtonText:{defaultMessage:"Embed link",id:"embedBlock.embedButton.label"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePen…",id:"embedBlock.linkPrompt.caption"},pastePrompt:{defaultMessage:"Paste in https://…",id:"embedBlock.pastePrompt"},validLink:{defaultMessage:"Please enter a valid link.",id:"embedBlock.invalidLinkError.message"},embedTitle:{defaultMessage:"Embed",id:"embedBlock.embedTab.title"}}),Vt={tweet:Et,gist:rt,video:Lt,image:Pt,audio:Ae,invision:At,mixpanel:yt,maps:yt,drive:yt,framer:yt,figma:yt,loom:yt,typeform:yt,codepen:yt,embed:yt,pdf:Rt.Z,whimsical:yt,miro:yt,abstract:yt,sketch:yt,excalidraw:yt,replit:yt,hex:yt,deepnote:yt,drawing:$e};class Ut extends Re.Z{constructor(){super(...arguments),this.embedComp=null,this.embedContainerWidth=c.default.createValue(0),this.didHaveNonZeroWidth=c.default.createValue(!1),this.imageBoxRef=o.createRef(),this.isStoreNavigableAncestorLocked=this.createComputedStore((()=>this.props.store.isNavigableAncestorLocked())),this.captionAriaId=(0,s.Z)(),this.getImageDimensions=()=>{var e;return null===(e=this.imageBoxRef.current)||void 0===e?void 0:e.getImageDimensions()},this.openMenu=()=>{const{device:e}=this.environment;if(!this.props.disableMediaMenu&&this.canEdit()){const{popupWidth:t,maxHeight:n}=this.props,o=this.props.mediaMenuCurrentTab||"embed",r=(this.props.mediaMenuTabs||[{type:"embed"},{type:"file",fileUpload:!0,imageUpload:e.isAndroid,videoUpload:e.isAndroid}]).map((e=>this.createTabFromDefinition(e))),a=i.findDOMNode(this);if(a&&a instanceof Element){const e=a.getBoundingClientRect();Z.$(this.environment,{originRect:e,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:o,tabs:r,title:q.default.formatMessage(jt.embedTitle),...t?{popupWidth:t}:{},...n?{maxHeight:n}:{}})}}},this.replace=()=>{this.openMenu();const e=this.props.store.getType();e&&R.Fn4(this.environment,{type:"replace",block_type:e,block_id:this.props.store.id})},this.caption=()=>{this.handleEditCaption()},this.getFullScreenNodeRect=()=>{const{isFullWidth:e,aspectRatio:t}=this.getDimensions();if(this.embedComp){const n=i.findDOMNode(this.embedComp);if(n&&n instanceof Element){const o=n.getBoundingClientRect();return e&&t?{...x.Go(o),width:o.width,height:o.width*t}:o}}},this.renderFullScreenNode=()=>{const e=this.getSource(),t=this.getRendererBySource(this.getSource());if(!e)return;const n=this.getRenderArgs({source:e});return t&&t.renderFullScreen?t.renderFullScreen(n):void 0},this.storeTypes={embedBlockStore:ne,blockResizerStore:Y.Z,alignmentPopupStore:J.Z},this.renderAlignmentButtons=()=>(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ze.Z,{style:{...Ut.actionButtonStyle,...this.getAlignmentButtonStyle("left"),borderRight:"none"},hoveredStyle:{...Ut.hoveredActionButtonStyle,opacity:1},onClick:()=>this.handleAlignment("left"),children:this.getAlignmentIcon("left")}),(0,be.jsx)("span",{style:{borderRight:`1px solid ${p.ZP.whiteWithAlpha(.2)}`}}),(0,be.jsx)(Ze.Z,{style:{...Ut.actionButtonStyle,...this.getAlignmentButtonStyle("center"),borderRight:"none"},hoveredStyle:{...Ut.hoveredActionButtonStyle,opacity:1},onClick:()=>this.handleAlignment("center"),children:this.getAlignmentIcon("center")}),(0,be.jsx)("span",{style:{borderRight:`1px solid ${p.ZP.whiteWithAlpha(.2)}`}}),(0,be.jsx)(Ze.Z,{style:{...Ut.actionButtonStyle,...this.getAlignmentButtonStyle("right"),borderRight:"none"},hoveredStyle:{...Ut.hoveredActionButtonStyle,opacity:1},onClick:()=>this.handleAlignment("right"),children:this.getAlignmentIcon("right")})]}),this.handleEditCaption=()=>{const e=this.props.store.getPropertyStore("caption");j.eP({environment:this.environment,store:this.props.store}),V.NX({store:e});const t=this.props.store.getType();t&&R.Fn4(this.environment,{type:"caption",block_type:t,block_id:this.props.store.id})},this.handleMouseEnter=e=>{ee.Z.state.isDragging||ie.Z.state.isActive||this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,hovered:!0})},this.handleMouseLeave=e=>{ee.Z.state.isDragging||ie.Z.state.isActive||this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,hovered:!1})},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,l.E)(t)&&this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,focused:!0})},this.handleBlur=e=>{this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,focused:!1})},this.handleFullScreen=()=>{L.dK({blocks:[this.props.store],blockLocationOfTargetBlock:this.props.blockLocation});const e=this.props.store.getType();e&&R.Fn4(this.environment,{type:"full_screen",block_type:e,block_id:this.props.store.id})},this.handleAlignment=e=>{const t=this.getActionableStoreData(),{alignmentPopupStore:n}=this.stores;n.reset(),t&&U.createAndCommit({userAction:"EmbedBlock.handleAlignment",environment:this.environment,perform:n=>{F.hc({environment:this.environment,store:t,alignment:e,transaction:n})}});const o=this.props.store.getType(),i=this.props.store.getFormat(),r=i.block_alignment,a=i.block_width,s=i.block_height,l=this.props.store.isRootOrDirectChild()?"center":"left";o&&R.Fn4(this.environment,{type:"alignment",block_type:o,block_id:this.props.store.id,block_alignment:e,block_height:s,block_width:a,previous_alignment:r,default_alignment:l}),j.Jy()},this.handleOriginalClick=()=>{const e=this.getActionableStoreData();if(e){E.qL(this.environment,{store:e,from:"view_original"});const t=e.getType();t&&R.Fn4(this.environment,{type:"original",block_type:t,block_id:this.props.store.id})}},this.handleDownload=()=>{const e=this.getActionableStoreData();if(e){E.TH({environment:this.environment,store:e});const t=e.getType();t&&R.Fn4(this.environment,{type:"download",block_type:t,block_id:this.props.store.id})}},this.handleUpload=e=>{const t=this.getActionableStoreData();if(t){const n=z.qQ(this.environment);E.cT({environment:this.environment,store:t,file:e,pageWidth:n,preferredType:t.getType()})}},this.fileUploadStore=this.createComputedStore((()=>oe.default.getKeyState(oe.default.getBlockKey(this.props.store.id)))),this.getContainerStyle=e=>{const t={display:"flex"};return E.qC(this.props.blockLocation)&&(t.display="inline-flex",t.maxHeight=240),"audio"===e.rendererType&&(t.display="flex"),t}}handleCreated(){this.openMenu()}edit(){this.openMenu()}embed(e){this.embedSource(e)}async handleRemoveBlockFromComment(){return!!this.props.onRemoveBlockFromComment&&(await this.props.onRemoveBlockFromComment(this.props.store),!0)}activate(){this.getRendererBySource(this.getSource())?this.handleFullScreen():this.replace()}canRenderFullScreen(){const e=this.getRendererBySource(this.getSource());return!(!e||!e.renderFullScreen)}renderPersisted(){const e=this.getSource(),t=this.fileUploadStore.state;return t&&t.dataURL?this.renderSource(t.dataURL):e?this.renderSource(e):this.renderPlaceholder()}renderSource(e){const{device:t}=this.environment,n=this.canEdit(),{preserveScale:o,isFullWidth:i}=this.getDimensions(),r=this.isRootOrDirectChild(),a=this.getRendererBySource(e);if(a){const{resizable:s}=a,l=n&&s&&!this.props.disableResizers,c=l&&(!o||i&&r),d=l&&r,u=c&&!i,p=u&&r,{Left:m,Right:f}=Ee.bZ,{Vertical:g,Horizontal:h,Corner:v}=Ee.IS;return(0,K.Z)((n=>(0,be.jsxs)(Fe.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,ref:t=>{if(t){this.attachGhost(t,e);const{width:n}=t.getBoundingClientRect();this.embedContainerWidth.setState(n),this.didHaveNonZeroWidth.update((e=>e||n>0))}},...n,children:[this.didHaveNonZeroWidth?(0,be.jsxs)("div",{style:this.getContainerStyle(a),children:[(0,be.jsxs)("div",{className:H.QSt,style:{position:"relative",overflow:s?"hidden":"visible",flexGrow:1},onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:[this.renderEmbed(e),d&&this.renderResizer("LeftResizer",h,m,o),l&&this.renderResizer("RightResizer",h,f,o),u&&this.renderResizer("RightCornerResizer",v,f,o),p&&this.renderResizer("LeftCornerResizer",v,m,o),c&&this.renderResizer("BottomResizer",g,null,o),!this.props.disableActions&&this.renderActions(e),this.props.disableActions&&this.props.showExpandButton&&a.renderFullScreen&&this.renderExpandButton(),this.props.contentBelowSource]}),!i&&!t.isMobile&&this.renderDiscussion()]}):null,(0,be.jsx)(Be.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})))}}renderPlaceholder(){const{device:e}=this.environment,t=!X.Z.state.online,n=e.isMobile||this.stores.embedBlockStore.state.hovered,o=this.fileUploadStore.state;return(0,be.jsxs)("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:this.getPlaceholderContainerStyle(),children:[(0,be.jsx)(Qe.Z,{style:this.getContentWrapStyle(),disabled:!this.canEdit()||t,iconSvg:void 0!==this.props.iconSvg?this.props.iconSvg:S.m,shouldHideRight:!n,right:this.canEdit()&&this.renderBlockMenuActionButton(!0),onClick:this.openMenu,isLoading:Boolean(o),progressPercent:o?o.progressPercent:0,file:o?o.file:void 0,name:o?o.name:void 0,size:o?o.size:void 0,children:this.props.children||(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Embed anything (PDFs, Google Docs, Google Maps, Spotify…)",id:"embedBlock.embedAnything.placeholder"})}),this.renderDiscussion()]})}renderEmbed(e){const t=this.getRendererBySource(e);if(t){const n=this.getRenderArgs({source:e}),o=t.render;return(0,be.jsx)(o,{...n})}}renderBlockMenuActionButton(e){const{blockLocation:t}=this.props,n=E.qC(t),o=n?"comment_media":"default";return(0,be.jsx)(De.Z,{store:this.props.store,fadeIn:!1,iconStyle:e?void 0:{fill:p.ZP.white},actionSectionGroupKey:o,hideFilterActionsInput:n,hoveredStyle:Ut.hoveredActionButtonStyle,tooltipContent:(0,be.jsx)(A.FormattedMessage,{defaultMessage:"More actions",id:"embedBlock.actionButton.tooltip.blockActionMenu"})})}renderExpandButton(){return(0,be.jsx)(je.Z,{style:{position:"absolute",right:12,top:12,background:this.theme.buttonBackground},icon:e=>(0,k.s)({...e,width:16,height:16}),hoveredStyle:{background:this.theme.buttonHoveredBackground},pressedStyle:{background:this.theme.buttonPressedBackground},onClick:this.handleFullScreen,children:(0,be.jsx)(A.FormattedMessage,{id:"embedBlock.expandFullScreen.button.label",defaultMessage:"Expand"})})}renderActions(e){const{device:t}=this.environment,{blockLocation:n}=this.props,{isFullWidth:o,width:i,isPageWidth:r}=this.getDimensions(),a=this.props.store.canEdit(),s=this.props.store.canComment(),l=this.props.store.isExternalObjectInstanceBlockStore(),c=this.getRendererBySource(e),u=this.shouldHideActions(),m=this.fileUploadStore.state,g=this.stores.blockResizerStore.state.dragging,h=E.qC(n),v=!t.isMobile&&!h&&!l,S=i&&!r&&!o&&!t.isPhone&&!h,_=!t.isMobile&&(null==c?void 0:c.renderFullScreen)&&l;if(!(m||g||c&&c.hideActions)){const e=$.Xp(this.props.store,{recursivelyLoadAllDiscussions:!1});if(this.isStoreNavigableAncestorLocked.state)return(0,be.jsx)("div",{style:this.getActionsStyle(),children:(0,be.jsx)(Ze.Z,{style:Ut.actionButtonStyle,hoveredStyle:Ut.hoveredActionButtonStyle,onClick:this.handleOriginalClick,children:(0,be.jsx)(A.FormattedMessage,{defaultMessage:"View original",id:"embedBlock.viewOriginalLink.button.label"})})});if(u)return(0,be.jsx)("div",{style:this.getActionsStyle(),children:this.renderBlockMenuActionButton()});{const n=300,o=Ve.Z.Placement.Top;let i;const r=this.props.store.getType();return i=(0,d.VB)(r)?(0,be.jsx)(Ve.Z,{renderTooltip:()=>(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Download",id:"embedBlock.actionButton.tooltip.download"}),placement:o,delayThreshold:n,render:e=>(0,be.jsx)(Ze.Z,{...e,style:Ut.actionButtonStyle,hoveredStyle:Ut.hoveredActionButtonStyle,onClick:this.handleDownload,children:(0,w.a)({width:14,height:14,marginRight:0,fill:p.ZP.white})})}):(0,be.jsx)(Ve.Z,{renderTooltip:()=>(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Original",id:"embedBlock.actionButton.tooltip.original"}),placement:o,delayThreshold:n,render:e=>(0,be.jsx)(Ze.Z,{...e,style:Ut.actionButtonStyle,hoveredStyle:Ut.hoveredActionButtonStyle,onClick:this.handleOriginalClick,children:(0,f.J)({width:14,height:14,marginRight:0,fill:p.ZP.white})})}),(0,be.jsxs)("div",{style:this.getActionsStyle(),children:[!h&&!l&&s&&(0,be.jsx)(Ve.Z,{renderTooltip:()=>(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Comment",id:"embedBlock.actionButton.tooltip.comment"}),placement:o,delayThreshold:n,render:n=>(0,be.jsxs)(Ze.Z,{...n,style:{...Ut.actionButtonStyle,...t.isMobile&&{paddingLeft:8,paddingRight:8}},hoveredStyle:Ut.hoveredActionButtonStyle,onClick:()=>{j.ZH(this.environment),e>0?D.Ib({environment:this.environment,blockStore:this.props.store,analyticsFrom:"embed_menu",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):O.yw({environment:this.environment,blockStore:this.props.store})},children:[(0,I.z)({width:14,height:14,marginRight:e>0?4:0,fill:p.ZP.white}),e>0&&e]})}),a&&S&&(0,be.jsx)(Ve.Z,{renderTooltip:()=>(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Align",id:"embedBlock.actionButton.tooltip.align"}),placement:o,delayThreshold:n,render:e=>(0,be.jsx)(Le.ZP,{popupType:Le.Z4.Popup,buttonPopupStore:this.stores.alignmentPopupStore,originGap:1,renderOrigin:t=>(0,be.jsxs)(Ze.Z,{style:Ut.actionButtonStyle,hoveredStyle:Ut.hoveredActionButtonStyle,...(0,G.Z)(t,e),children:[this.getAlignmentIcon(this.getBlockAlignment()),(0,y.i)({width:8,fill:p.ZP.white,marginLeft:4})]}),borderRadius:3,render:this.renderAlignmentButtons,popupWrapStyle:{background:Ut.actionButtonBackground(this.environment),display:"flex"}})}),a&&v&&(0,be.jsx)(Ve.Z,{renderTooltip:()=>(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Caption",id:"embedBlock.actionButton.tooltip.caption"}),placement:o,delayThreshold:n,render:e=>(0,be.jsx)(Ze.Z,{...e,style:Ut.actionButtonStyle,hoveredStyle:Ut.hoveredActionButtonStyle,onClick:this.handleEditCaption,children:(0,b.o)({width:14,height:14,marginRight:0,fill:p.ZP.white})})}),_&&(0,be.jsx)(Ve.Z,{renderTooltip:()=>(0,be.jsx)(A.FormattedMessage,{defaultMessage:"Expand",id:"embedBlock.actionButton.tooltip.expand"}),placement:o,delayThreshold:n,render:e=>(0,be.jsx)(Ze.Z,{...e,style:Ut.actionButtonStyle,hoveredStyle:Ut.hoveredActionButtonStyle,onClick:this.handleFullScreen,children:(0,k.s)({width:14,height:14,marginRight:0,fill:p.ZP.white})})}),!t.isMobile&&i,this.renderBlockMenuActionButton()]})}}}getAlignmentIcon(e){const t={width:14,height:14,marginRight:0,fill:p.ZP.white};return Ut.alignmentIconMap[e](t)}renderResizer(e,t,n,o){const i={position:"absolute"},{Vertical:r,Horizontal:a,Corner:s}=Ee.IS,{Left:l,Right:c}=Ee.bZ;let d;return t===r||t===s?i.bottom=Ut.resizerOffset:t===a&&(i.top=Ut.resizerOffset),n===l?i.left=Ut.resizerOffset:n===c&&(i.right=Ut.resizerOffset),d=t===s?(0,_.u)({stroke:p.ZP.whiteWithAlpha(.5),fill:p.ZP.blackWithAlpha(.65),width:Ut.cornerResizeSize,height:Ut.cornerResizeSize,transition:`opacity ${Ut.transition}`,opacity:this.shouldShowResizer()?1:0,position:"relative",bottom:3,left:n===l?3:-3,transform:n===l?"rotate(90deg)":"none"}):(0,be.jsx)("div",{style:this.getResizerInnerStyle(t)}),(0,be.jsx)(Ee.ZP,{store:this.props.store,preserveScale:o,resizerType:t,resizerAlignment:n,resizeComponent:this,blockResizerStore:this.stores.blockResizerStore,resizeHorizontally:!0,resizeVertically:!0,disabled:!1,children:(0,be.jsx)("div",{style:{...this.getResizeStyle(t,n),...i},children:d})},e)}createTabFromDefinition(e){switch(e.type){case"embed":const t=this.props.embedButtonText||q.default.formatMessage(jt.embedButtonText);return{type:"embed",caption:this.props.mediaMenuEmbedCaption||q.default.formatMessage(jt.embedCaption),buttonText:t,inputPlaceholder:this.props.urlInputPlaceholder||q.default.formatMessage(jt.pastePrompt),onChange:e=>{const t=(0,T.D)(e);C.B(t,"url")?(Z.Z(),this.embedSource(t)):B.showErrorMessage(q.default.formatMessage(jt.validLink))}};case"file":return{type:"file",fileUpload:Boolean(e.fileUpload),imageUpload:Boolean(e.imageUpload),videoUpload:Boolean(e.videoUpload),onUpload:this.handleUpload};case"unsplash":return{type:"unsplash",onChange:e=>{let{url:t}=e;Z.Z(),this.embedSource(t)}};case"giphy":return{type:"giphy",onChange:e=>{let{url:t}=e;Z.Z(),this.embedSource(t)}}}}shouldShowResizer(){const{device:e}=this.environment,{hovered:t}=this.stores.embedBlockStore.state,{isMobile:n}=e;return!n&&t}attachGhost(e,t){const n=this.getRendererBySource(t);e&&n&&n.embedGhost&&this.mutateDOM((()=>e.setAttribute("embed-ghost","")))}shouldHideActions(){const{block_width:e}=this.props.store.getFormat(),{temporaryWidth:t}=this.stores.blockResizerStore.state;return void 0!==t?t<=Ut.minWidthForActions:void 0!==e&&e<=Ut.minWidthForActions}getDimensions(){const{block_height:e,block_width:t,block_preserve_scale:n,block_full_width:o,block_page_width:i,block_aspect_ratio:r}=this.props.store.getFormat(),{dragging:a,temporaryHeight:s,temporaryWidth:l,temporaryFullWidth:c,temporaryPageWidth:d}=this.stores.blockResizerStore.state,u=a?l:t??this.embedContainerWidth.state,p=a?s:e,f=Boolean(a?c:o),g=Boolean(a?d:i),h=Boolean(this.props.preserveScale||n);return{blockWidth:t,blockHeight:e,width:u,height:this.props.store.isExternalObjectInstanceBlockStore()&&"image"!==this.props.mediaType?p||m.QA:p,dragging:a,preserveScale:h,isFullWidth:f,isPageWidth:g,aspectRatio:r}}getSource(){return this.props.source||Ut.getEmbedSourceFromBlockStore(this.props.store)}static getEmbedSourceFromBlockStore(e){const t=e.getProperties(),n=null==t?void 0:t.source,o=M.QaF(n),{display_source:i}=e.getFormat();return(0,m.Z8)(i||o)}getRenderArgs(e){const{source:t}=e,n=this.props.store.getProperties(),o=M.Jcv(n&&n.title),i=M.Jcv(n&&n.size),r=this.fileUploadStore.state,{blockWidth:a,blockHeight:s,width:l,height:c,dragging:d,preserveScale:u,isFullWidth:p,isPageWidth:m,aspectRatio:f}=this.getDimensions(),g=this.isRootOrDirectChild(),{device:h}=this.environment;return{store:this.props.store,source:t,blockWidth:a,blockHeight:s,aspectRatio:f,width:l,height:c,dragging:d,preserveScale:u,isFullWidth:p,isPageWidth:m,isRootChild:g,dataURL:r?r.dataURL:void 0,dataName:o,dataSize:i,disabled:!this.canEdit(),contentStyle:this.getContentStyle(),contentWrapStyle:this.getContentWrapStyle(),isLoading:Boolean(r),progressPercent:r?r.progressPercent:0,handleFullScreen:this.handleFullScreen,handleEmbedComp:e=>this.embedComp=e,viewOriginal:this.handleOriginalClick,inlineContentStyle:this.props.inlineContentStyle,blockLocation:this.props.blockLocation,mediaType:this.props.mediaType,imageBoxRef:this.imageBoxRef,useS3Url:h.isIOS&&h.isMobileNative}}getRendererBySource(e){var t,n;return Ut.getRenderer(e,null===(t=this.fileUploadStore.state)||void 0===t?void 0:t.dataURL,this.props.mediaType??(null===(n=this.getActionableStoreData())||void 0===n?void 0:n.getType()))}static hasRendererForStore(e){return r.Z.withListenerIgnored((()=>Boolean(Ut.getRenderer(Ut.getEmbedSourceFromBlockStore(e),void 0,e.getType()))))}static getRenderer(e,t,n){if(t)return Vt.image;if(e){if(e.startsWith("data:")||e.startsWith("<img"))return;const t=(0,m.Dz)({url:e,baseUrl:N.default.domainBaseUrl,publicDomainName:N.default.publicDomainName,preferredType:n});if("embed"!==t)return Vt[t]}return n&&e?Vt[n]:yt}embedSource(e){const t=this.getActionableStoreData();if(!t)return;const n=z.qQ(this.environment);R.bOx(this.environment,{pastedText:e,source:"embed_block_menu"});const o=Q.default.mark("embed_render_complete");E.I(this.environment,{source:e,isDataURL:!1,store:t,pageWidth:n,preferredType:t.getType(),metric:o})}getActionableStoreData(){if("external_object_instance"!==this.props.store.getType()||(0,W.Xg)())return this.props.store}static actionButtonBackground(e){const{device:t}=e;return t.isMobile?p.ZP.blackWithAlpha(.3):p.ZP.blackWithAlpha(.6)}getPlaceholderContainerStyle(){const e={display:"flex"};return E.qC(this.props.blockLocation)&&(e.borderWidth=1,e.borderColor=this.theme.regularDividerColor,e.marginBottom=10,e.borderRadius=3),e}getContentWrapStyle(){const e={position:"relative"};return this.canEdit()&&(e.cursor="pointer"),this.props.centerWrappedContent&&(e.display="flex",e.justifyContent="center",e.alignItems="center",e.minHeight=220),e}getContentStyle(){const{dragging:e}=this.stores.blockResizerStore.state;return{display:"block",pointerEvents:e?"none":"auto",width:"100%"}}getResizeStyle(e,t){const n={position:"absolute",pointerEvents:this.shouldShowResizer()?"auto":"none",display:"flex",alignItems:"center",justifyContent:"center"};return t===Ee.bZ.Right?n.right=0:t===Ee.bZ.Left&&(n.left=0),e===Ee.IS.Horizontal?(n.top=0,n.zIndex=1,n.height="100%",n.width=Ut.resizerWidth,n.cursor="col-resize"):e===Ee.IS.Vertical?(n.bottom=0,n.zIndex=1,n.width="100%",n.height=Ut.resizerWidth,n.cursor="row-resize"):e===Ee.IS.Corner&&(n.zIndex=2,n.bottom=0,n.width=n.height=Ut.cornerResizeSize,t===Ee.bZ.Left?n.cursor="nesw-resize":t===Ee.bZ.Right&&(n.cursor="nwse-resize")),n}getResizerInnerStyle(e){const{ThemeStore:t}=this.environment,n=t.state.mode,o={opacity:this.shouldShowResizer()?1:0,transition:Ut.transition,borderRadius:20,background:(0,u.Fq)(p.se[n].black,.6),border:`1px solid ${p.ZP.whiteWithAlpha(.9)}`};return e===Ee.IS.Horizontal?(o.width=6,o.height=48,o.maxHeight="50%"):e===Ee.IS.Vertical&&(o.height=6,o.width=48,o.maxWidth="50%"),o}getActionsStyle(){const{device:e}=this.environment,{focused:t,hovered:n}=this.stores.embedBlockStore.state,{isMobile:o}=e;return{position:"absolute",top:4,right:4,borderRadius:3,color:p.ZP.white,fill:p.ZP.white,fontSize:11.5,background:Ut.actionButtonBackground(this.environment),display:"flex",whiteSpace:"nowrap",height:26,maxWidth:"calc(100% - 16px)",overflow:"hidden",pointerEvents:t||n||o?"auto":"none",opacity:t||n||o?1:0,transition:e.isSafari?void 0:Ut.transition,fontFamily:P.Z.getCompositeFontFamily(a.SP).sans,zIndex:2}}getBlockAlignment(){const{block_alignment:e}=this.props.store.getFormat(),t=this.isRootOrDirectChild();return e||(t?"center":"left")}getAlignmentButtonStyle(e){let t=.6;return this.getBlockAlignment()===e&&(t=1),{width:26,height:26,opacity:t}}}Ut.minWidthForActions=230,Ut.alignmentIconMap={left:h.$,center:g.L,right:v.g},Ut.resizerWidth=15,Ut.resizerOffset=0,Ut.cornerResizeSize=20,Ut.actionButtonStyle={display:"flex",alignItems:"center",justifyContent:"center",padding:"4px 6px",borderRight:`1px solid ${p.ZP.whiteWithAlpha(.2)}`},Ut.hoveredActionButtonStyle={background:"rgba(255, 255, 255, 0.055)"},Ut.centerPromptStyle={color:p.ZP.white,fontSize:14,fontFamily:P.Z.getCompositeFontFamily(a.SP).sans,padding:"0.3em 1.5em 0.3em",background:p.ZP.blackWithAlpha(.4),borderRadius:3},Ut.transition="opacity 300ms ease-in";const Ot=Ut},86329:(e,t,n)=>{n.d(t,{Z:()=>u});n(67294);var o=n(83355),i=n(68709),r=n(64921),a=n(68785),s=n(32854),l=n(40148),c=n(85893);class d extends o.Z{renderComponent(){return this.props.isLoading?this.renderLoading():(0,c.jsx)(i.p,{allowSelectionWithin:!1,style:this.getBackgroundStyle(),children:(0,c.jsx)(r.Z,{onClick:this.props.onClick,disabled:this.props.disabled,children:(0,c.jsx)(l.ZP,{style:{background:void 0,...this.props.style},iconSvg:this.props.iconSvg,right:this.props.right,shouldHideRight:this.props.shouldHideRight,children:this.props.children})})})}renderLoading(){const{file:e,name:t,size:n,progressPercent:o}=this.props;let i;return i=e?(0,c.jsxs)("div",{children:[t,(0,c.jsx)("div",{style:l.Lw,children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)("div",{children:[n," ","–"," "]}),(0,c.jsx)(a.Z,{style:{marginLeft:3,marginRight:3}}),(0,c.jsx)(s.Z,{percentage:o})]})})]},"FileLoadingSpinner"):(0,c.jsx)("div",{children:(0,c.jsx)(a.Z,{style:{marginLeft:3,marginRight:3}})},"LoadingSpinner"),(0,c.jsx)(l.ZP,{style:this.props.style,iconSvg:this.props.iconSvg,children:i})}getBackgroundStyle(){return{background:this.theme.embedPlaceholderBackground,width:"100%",borderRadius:3}}}d.displayName="EmbedPlaceholder",d.captionStyle=l.HB;const u=d},3702:(e,t,n)=>{n.d(t,{Z:()=>I});var o=n(67294),i=n(83355),r=n(13991),a=n(8848),s=n(75e3),l=n(72126),c=n(20852),d=n(70203),u=n(82990),p=n(5366),m=n(50906),f=n(83631),g=n(18514),h=n(69015),v=n(42922),b=n(36488),y=n(16354),S=n(53437),_=n(22492),w=n(85893);class k extends i.Z{constructor(){super(...arguments),this.input=o.createRef(),this.renderPopup=()=>{const{isOpen:e}=this.props,t=this.getThemeColors(),n={...this.styles.popupInputForm,...t.popupInputForm},i=(0,w.jsxs)("div",{style:n,children:[this.renderInput(),this.renderPopupSubmitButton()]});return(0,w.jsx)(b.Z,{capture:e,allowEsc:!0,render:()=>this.getPopupType()===S.ZP.PopupType.SlideUp?(0,w.jsxs)(o.Fragment,{children:[this.renderMobilePreview(),i]}):(0,w.jsxs)(o.Fragment,{children:[i,this.renderEquationError()]})})},this.handleInputChange=e=>{const{isOpen:t,onChange:n,displayMode:o}=this.props;t&&n(e,f.by({environment:this.environment,equation:e,displayMode:o}))},this.handleSubmit=e=>{const{isOpen:t,disabled:n,error:o,onSubmit:i,onDismiss:r}=this.props;e.preventDefault&&e.preventDefault(),n||t&&(o||(i(),r()))},this.getHighlightedHtml=e=>{const{Prism:t}=this.props;return t.highlight(l.AK(e),t.languages[c.PrismLanguages.latex],c.PrismLanguages.latex)},this.styles={popup:{width:400,display:"flex",flexDirection:"column"},popupInputForm:{display:"flex",alignItems:"center",padding:"8px 10px",width:"100%"},mobilePreview:{padding:"4px 8px",height:80,display:"flex",alignItems:"center",justifyContent:"center"},mobilePreviewValue:{overflow:"auto"},equationInput:{fontFamily:u.Z.getCompositeFontFamily(r.SP).mono,fontSize:14,marginRight:8,flex:1,wordBreak:"break-word",maxHeight:"50vh",overflow:"auto"},equationInputBlock:{minHeight:60},equationInputSlideUp:{height:100},submitButton:{alignSelf:"flex-start"},enterIcon:{height:14,width:14,fill:"currentColor",marginLeft:6,marginTop:2},errorContainer:{color:a.ZP.redWithAlpha(.8),fontSize:12,padding:"8px 10px"},errorLabel:{fontWeight:600},learnMoreLink:{display:"inline",textDecoration:"underline"}}}didMount(){this.environment.KatexStore.loadIfNeeded((()=>[(0,d.qZ6)("")]))}getSelection(){if(!this.input)return;if(!this.input.current)return;const e=this.input.current.getSelection();return"contain"===(null==e?void 0:e.type)?e.selection:void 0}renderComponent(){const{isOpen:e,onDismiss:t,origin:n,originRect:o,originGap:i,popupStyle:r}=this.props,a=this.getPopupType();return(0,w.jsx)(S.ZP,{popupType:a,open:e,origin:n,originRect:o,originGap:i,keepFocus:a===S.ZP.PopupType.SlideUp,onDismiss:t,style:{...this.styles.popup,...r},render:()=>this.renderPopup()})}renderInput(){const{disabled:e,isOpen:t,equationValue:n,onLeft:o,onRight:i,onDismiss:r,displayMode:a}=this.props,s=this.getThemeColors(),l=this.getPopupType()===S.ZP.PopupType.SlideUp,c=!e&&!l,d=l?{type:h.b.Textarea}:{type:h.b.InlineWrap,onSubmit:this.handleSubmit},u={...this.styles.equationInput,..."block"===a&&this.styles.equationInputBlock,...l&&this.styles.equationInputSlideUp},p={...u,...s.equationInputPlaceholder};return(0,w.jsx)(h.Z,{ref:this.input,...d,disabled:e,focus:t,selectAll:c,value:n||"",placeholder:this.getPlaceholderEquation(),getHtml:this.getHighlightedHtml,onChange:this.handleInputChange,onCancel:r,onLeft:o,onRight:i,placeholderStyle:p,style:u,autoCorrect:"off",autoCapitalize:"off"})}getPlaceholderEquation(){const{displayMode:e}=this.props;return"block"===e?"|x| = \\begin{cases}             \n  x, &\\quad x \\geq 0 \\\\           \n -x, &\\quad x < 0             \n\\end{cases}":"E = mc^2"}renderPopupSubmitButton(){const{error:e,disabled:t}=this.props;if(!t)return(0,w.jsxs)(v.Z,{onClick:this.handleSubmit,disabled:t||Boolean(e),style:this.styles.submitButton,children:[(0,w.jsx)(p.FormattedMessage,{defaultMessage:"Done",id:"equationInput.submitButton.label"}),(0,s.U)(this.styles.enterIcon)]})}renderEquationError(){if(!this.props.isOpen)return;const{error:e}=this.props,t=this.getPopupType()===S.ZP.PopupType.Popup;if(!e)return;const n=e.message.replace("KaTeX parse error: ",""),o={...this.styles.errorContainer,...t&&this.getThemeColors().errorContainerDesktop};return(0,w.jsxs)("div",{role:"alert",style:o,children:[(0,w.jsx)("span",{style:this.styles.errorLabel,children:(0,w.jsx)(p.FormattedMessage,{defaultMessage:"Invalid equation:",id:"equationInput.inputError.label"})})," ",n,". ",(0,w.jsx)(y.Z,{href:(0,g.UY)("guides.equations"),external:!0,onClick:()=>{m.Fsx(this.environment,{from:"equation_input"})},style:this.styles.learnMoreLink,children:(0,w.jsx)(p.FormattedMessage,{defaultMessage:"Learn more",id:"equationInput.inputError.learnMore"})})]})}renderMobilePreview(){const{equationValue:e,error:t,displayMode:n}=this.props;if(e)return(0,w.jsx)("div",{style:this.styles.mobilePreview,children:t?this.renderEquationError():"block"===n?(0,w.jsx)(_.Z,{display:n,equation:e,style:this.styles.mobilePreviewValue,theme:this.theme}):(0,w.jsx)(_.Z,{display:n,equation:e,style:this.styles.mobilePreviewValue,theme:this.theme,index:0,isTemporary:!1})})}getPopupType(){const{device:e}=this.environment,t=e.isPhone&&e.isIOS&&e.isMobileBrowser;return e.isPhone&&!t?S.ZP.PopupType.SlideUp:S.ZP.PopupType.Popup}getThemeColors(){return{popupInputForm:{background:this.theme.inputBackground},errorContainerDesktop:{boxShadow:`0 -1px ${this.theme.lightDividerColor}`},equationInputPlaceholder:{color:this.theme.lightTextColor}}}}k.displayName="EquationInputPopup";const I=k},22492:(e,t,n)=>{n.d(t,{Z:()=>d});n(67294);var o=n(83355),i=n(98923),r=n(5366),a=n(83631),s=n(77907),l=n(85893);class c extends o.Z{didMount(){super.didMount(),a.bc()}renderComponent(){return(0,l.jsx)(s.DependencyConsumer,{dependency:s.deps.katex,children:e=>(0,l.jsx)(i.MW,{katex:e,...this.props})})}}c.displayName="EquationValue";const d=(0,r.injectIntl)(c)},42782:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),i=n(73935),r=n(480),a=n(98742),s=n(3386),l=n(53437);const c=()=>{const[e,t]=o.useState({x:0,y:0});return o.useEffect((()=>{const e=e=>{t({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]),e};var d=n(85893);const u=e=>{let{x:t,mouseX:n}=e;return n>t?void 0:-Math.max(t-n,10)+"px"},p=e=>{let{x:t,width:n,mouseX:o}=e;return o>t?-Math.max(o-(t+n),10)+"px":void 0},m=e=>{let{x:t,width:n,mouseX:o}=e;return o>t?`${Math.max(o-(t+n),10)}px`:`${Math.max(t-o,10)}px`},f=e=>{let{x:t,y:n,height:o,mouseX:i,mouseY:r}=e;return i>t?`polygon(0% 0%, 0% 100%, 100% ${100*(r-n)/o}%)`:`polygon(100% 0%, 0% ${100*(r-n)/o}%, 100% 100%)`};function g(e){window.__c={n:"ExtensionMenuSafeArea"};const{x:t=0,y:n=0,height:o=0,width:i=0}=e.el.getBoundingClientRect()||{},{x:r,y:a}=c(),s={x:t,y:n,height:o,width:i,mouseX:r,mouseY:a},l={right:p(s),left:u(s),height:o,width:m(s),clipPath:f(s)};return(0,d.jsx)("div",{style:{cursor:"pointer",position:"absolute",top:0,...l}})}function h(e,t){let{onClick:n,renderOrigin:c,renderExtension:u,...p}=e;window.__c={n:"ExtensionMenuItem"};const{disableDefaultClick:m,onFocus:f,focused:h,openOnFocus:v}=p,b=(0,r.Fy)(),[y,S]=(0,o.useState)(!1),_=(0,o.useRef)(null),w=(0,o.useRef)(null),k=(0,o.useRef)(null),I=(0,o.useRef)(null),C=(0,o.useCallback)((()=>{k.current&&window.clearTimeout(k.current),I.current&&window.clearTimeout(I.current),k.current=null,I.current=null}),[]),x=(0,o.useCallback)((()=>{C(),y||S(!0)}),[y,C]),T=(0,o.useCallback)((()=>{C(),y&&S(!1)}),[y,C]),M=(0,o.useCallback)((e=>{C(),y||(e&&e.preventDefault&&e.preventDefault(),k.current=window.setTimeout(x,120))}),[y,C,x]),P=(0,o.useCallback)((()=>{C(),y&&(I.current=window.setTimeout(T,100))}),[y,T,C]),A=(0,o.useCallback)((()=>{f(),x()}),[f,x]),R=(0,o.useCallback)((e=>{M()}),[M]),D=(0,o.useCallback)((e=>{f(),M()}),[f,M]),B=(0,o.useCallback)((e=>{if(b.isPhone)return;const t=i.findDOMNode(_.current);y&&t&&!t.contains(e.target)&&T()}),[y,T,b.isPhone]),E=(0,o.useCallback)((e=>{13===e.keyCode&&y&&T()}),[y,T]);(0,o.useEffect)((()=>{if(!Boolean(m))return window.addEventListener("click",B),()=>{window.removeEventListener("click",B)}}),[m,B]),(0,o.useEffect)((()=>(window.addEventListener("keydown",E),()=>{window.removeEventListener("keydown",E)})),[E]);const F=(0,o.useRef)(h);(0,o.useEffect)((()=>{b.isMobile||(v&&!F.current&&h?M():h||P(),F.current=h)}),[h,v,M,P,b.isMobile]);const Z={...(0,a.Z)({onMouseEnter:R,onClick:A},p),showExtensionArrow:!0};return(0,d.jsx)(s.Z,{capture:h,onEnter:y?void 0:M,onRight:M,onLeft:y?P:void 0,onEsc:y?P:void 0,children:(0,d.jsx)(l.ZP,{popupType:b.isPhone?l.ZP.PopupType.SlideUp:l.ZP.PopupType.Popup,open:y,origin:c(Z,t),placementToOrigin:l.ZP.Placement.Right,alignmentToOrigin:l.ZP.Alignment.Center,originGap:0,disableMouseCapture:!0,preventBlockRenderQueueOnEnter:!0,preventScaleTransition:!b.isPhone,preventCaptureEsc:!0,ref:_,render:()=>(0,d.jsxs)(d.Fragment,{children:[w.current&&(0,d.jsx)(g,{el:w.current}),(0,d.jsx)("div",{ref:w,children:u({onMouseEnter:D},{close:P})})]}),style:{overflow:"visible"},trapFocus:!0})})}const v=o.forwardRef(h)},19987:(e,t,n)=>{n.d(t,{Z:()=>ee});var o=n(67294),i=n(83355),r=n(86628),a=n(24405),s=n(84939),l=n(8848),c=n(77657),d=n(42853),u=n(56666),p=n(44495),m=n(60291),f=n(54497),g=n(90965),h=n(82990),v=n(5366),b=n(50906),y=n(42631),S=n(42858),_=n(39699),w=n(61202),k=(n(95477),n(70764)),I=n(41232),C=n(33929),x=n(77907),T=n(80444),M=n(30874),P=n(31194),A=n(1634),R=n(64921),D=n(31945),B=n(51077),E=n(89728),F=(n(57658),n(480)),Z=n(74155),L=n(37612),j=n(14871),V=n(47307),U=n(75018),O=n(87279),N=n(18514),z=n(52275),H=n(78140),W=n(32163),q=n(72495),G=n(85893);const K=(0,v.defineMessages)({copiedDebuggingInfo:{id:"externalObjectBlock.errorDropdown.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."}});function $(e){window.__c={n:"ExternalObjectInstanceErrorMenu"};const{state:t,store:n,onUpdate:o,onReplace:i,onAuthenticate:s,onRemove:d,description:u,statusCode:p,errorDescription:f,isInlineMenu:g}=e,{userHasBotForIntegration:h,pattern:y,integration:S,botIds:_,originalUrl:w}=t,k=(0,F.Fy)(),I=(0,F.O7)(),C=(0,a.yK)((e=>({menuIcon:{fill:e.regularIconColor,width:16},redThemeColor:(0,l.fi)("red",e)})),[]),x=(0,r.VK)((()=>{var e;return Boolean(null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit())}),[]),M=(0,r.VK)((()=>n.isExternalObjectInstanceBlockStore()),[n]),P=(0,r.VK)((()=>n.isExternalObjectInstancePageBlockStore()),[n]);let A;A=k.isMobile?{menuType:O.og.ActionSheet}:{menuType:O.og.Popup,minWidth:220};const R={key:"remove",render:e=>(0,G.jsx)(z.Z,{title:(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Remove",id:"unfurling.errorOptions.removeAction.title"}),style:{color:C.redThemeColor.color},icon:(0,L.y)({fill:C.redThemeColor.fill,width:16}),...e}),action:()=>{null==d||d()}},D={key:"replace",render:e=>(0,G.jsx)(z.Z,{title:(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Change URL",id:"unfurling.errorOptions.replace.title"}),icon:(0,m.b)(C.menuIcon),...e}),action:()=>{i()}},E={key:"update",render:e=>(0,G.jsx)(z.Z,{title:(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Try again",id:"unfurling.errorOptions.tryAgainAction.title"}),icon:(0,m.b)(C.menuIcon),...e}),action:()=>{null==o||o()}},$={key:"authenticate",render:e=>(0,G.jsx)(z.Z,{title:h?401===p?(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Re-authenticate account",id:"unfurling.errorOptions.authenticateAction.reAuthenticate.title"}):g?(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Connect a different account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticatedCompact.title"}):(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Connect a different {integration} account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticated.title",values:{integration:S.name}}):(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Connect {integration} account",id:"unfurling.errorOptions.authenticateAction.notAuthenticated.title",values:{integration:S.name}}),icon:(0,G.jsx)(B.Z,{type:"image_url",imageURL:S.icon,size:16}),...e}),action:()=>{null==s||s()}},Q=[{key:"learn",render:e=>(0,G.jsx)(z.Z,{title:(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Learn more about this error",id:"unfurling.errorOptions.learnMore.title"}),icon:(0,Z.u)(C.menuIcon),...e}),action:()=>{V.showDialog({items:[{label:(0,G.jsx)(v.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.reviewGuide",defaultMessage:"View guide"}),color:"blue",onAccept:()=>{U.navigateToExternalURL({environment:I,url:(0,N.UY)("guides.unfurling")}),b.SCe(I,{integrationId:S.id,entity:null==y?void 0:y.name,statusCode:p})}},{label:(0,G.jsx)(v.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.copyDebugData",defaultMessage:"Copy debugging information"}),color:void 0,onAccept:()=>{const e={statusCode:p,integrationId:S.id,botIds:_,url:w,debugMessage:f};j.RD({environment:I,stringValue:JSON.stringify(e,null,2),copiedMessage:K.copiedDebuggingInfo})}}],showCancel:!0,keepFocus:!1,message:u})}}];return x&&("error"===t.type?Q.push(D):("placeholder"===t.type?Q.push(D):Q.push(E),(M||P&&[c.f3,c.mQ].includes(S.id))&&Q.push($))),d&&Q.push(R),(0,G.jsx)(H.Z,{...A,children:(0,G.jsx)(W.Z,{type:W.i.Vertical,initialFocus:g?void 0:0,sections:[{key:0,render:e=>(0,G.jsx)(q.Z,{...e,disableDesktopPadding:g,title:(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Try these options",id:"unfurling.errorOptions.menuTitle"})}),items:Q}]})})}class Q extends i.Z{constructor(){super(...arguments),this.renderComponent=()=>{var e,t;const n=this.stateStore.state;if(!n)return;const{integration:o,action:i}=n,{r,g:a,b:l}=o.accentColor,c=`rgba(${r},${a},${l},${this.isInDarkMode()?.6:1})`,d=Boolean(null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()),u=T.default.state.currentSpaceStore&&this.environment.currentUser.id&&(0,g.wv)({permissions:T.default.state.currentSpaceStore.getPermissionItems()},this.environment.currentUser.id)||(0,g.hU)({spaceBotSettings:null===(t=T.default.state.currentSpaceStore)||void 0===t?void 0:t.getBotSettingsStore().getValue(),integrationId:o.id,env:"production"}),p={state:n,store:this.props.store,onUpdate:()=>{this.handleUpdateClick({from:"external_object_instance_block_error_dropdown"})},onAuthenticate:()=>{this.handleAuthenticateClick({from:"external_object_instance_block_error_dropdown"})},onReplace:()=>{var e,t;null===(e=(t=this.props).openPlaceholderMenu)||void 0===e||e.call(t)}},m={...p,onRemove:()=>{this.handleRemove()}};return(0,G.jsxs)(G.Fragment,{children:["authenticate"===i&&(0,k.sw)(this.environment)&&d&&u&&(0,G.jsx)(E.Z,{icon:e=>(0,G.jsx)(B.Z,{type:"image_url",imageURL:o.accentIcon,size:20,style:{...e,width:16,height:16,marginRight:8,marginLeft:2}}),onClick:()=>this.handleAuthenticateClick({from:"external_object_instance_block"}),style:{...this.getActionButtonStyle(),background:c,fontSize:14,height:32,paddingRight:12,color:this.isInDarkMode()?this.theme.regularTextColor:this.theme.regularInvertedTextColor},hoveredStyle:{background:(0,s._j)(c,.4)},pressedStyle:{background:(0,s._j)(c,.9)},children:(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Connect to {integration} to update",id:"unfurling.authenticateButton.title",values:{integration:n.integration.name}})}),"update"===i&&this.renderUpdateAction(),"error"===i&&(this.props.isHoverPreview?(0,G.jsx)(X,{...p}):(0,G.jsx)(J,{...m,style:this.getActionButtonStyle()})),!i&&this.props.renderDefaultAction?this.renderDefaultAction():null]})},this.handleAuthenticateClick=e=>{var t,n,o,i;let{from:r}=e;const a=null===(t=this.stateStore.state)||void 0===t?void 0:t.originalUrl,{currentSpaceStore:s}=T.default.state;if(!s)return;const l=null===(n=(0,I.GQ)(a,s.id))||void 0===n?void 0:n.integration;l&&a&&(y.hM({environment:this.environment,integration:l,spaceId:s.id,unfurlUrl:a,externalObjectInstanceBlockId:this.props.store.id,from:r}),A.Z.reset(),null===(o=(i=this.props).postActionCallback)||void 0===o||o.call(i))},this.handleUpdateClick=e=>{var t,n,o;let{from:i}=e;const r=null===(t=T.default.state.currentSpaceStore)||void 0===t?void 0:t.id;r&&(w.qK({environment:this.environment,from:i,store:this.props.store,spaceId:r,bypassCache:"external_object_instance_block_error_dropdown"===i}),null===(n=(o=this.props).postActionCallback)||void 0===n||n.call(o))},this.stateStore=this.createComputedStore((()=>(0,I._l)({store:this.props.store,isInDarkMode:this.isInDarkMode(),canEdit:this.props.canEdit,currentUserId:this.environment.currentUser.id,showAction:this.props.forceActionForUIDoc})),!0)}renderDefaultAction(){const e=this.environment,{isMobile:t}=e.device;return(0,G.jsx)(D.ZP,{popupType:t?D.Z4.SlideUp:D.Z4.Popup,renderOrigin:e=>(0,G.jsx)(R.Z,{...e,mobileFeedback:t,style:{display:"flex",alignItems:"center",justifyContent:"center",width:t?36:28,height:t?36:28,borderRadius:3,flexShrink:0,opacity:"shown"===this.props.renderDefaultAction?1:0,...this.getActionButtonStyle()},children:(0,u.o)({width:t?18:14,color:this.theme.mediumIconColor})}),placementToOrigin:P.Iw.Bottom,render:e=>(0,G.jsx)(x.LazyExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,G.jsx)(v.FormattedMessage,{id:"linkPreview.reload",defaultMessage:"Reload preview"}),store:this.props.store,onAccept:()=>e.close(),extraSecondaryItemKey:"preview_to_mention"})})}renderUpdateAction(){const e=(0,G.jsx)(E.Z,{onClick:()=>this.handleUpdateClick({from:"external_object_instance_block"}),style:this.getActionButtonStyle(),icon:e=>(0,m.b)({...e}),children:(0,G.jsx)(v.FormattedMessage,{defaultMessage:"Update",id:"unfurling.updateButton.title"})});return this.props.isHoverPreview?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:h.Z.fontSize.UIRegular.desktop,marginBottom:4},children:[(0,p.D)({width:18,height:18,marginRight:6}),(0,G.jsx)("span",{children:(0,G.jsx)(v.FormattedMessage,{defaultMessage:"This link preview is out-of-date.",id:"unfurling.updateButton.header"})})]}),e]}):e}handleRemove(){var e,t;_.createAndCommit({userAction:"ExternalObjectInstanceAction.handleRemove",environment:this.environment,perform:e=>{S.Cl({environment:this.environment,blocks:[this.props.store],transaction:e})}});const n=this.stateStore.state;var o;n&&b.oQL(this.environment,{integrationId:n.integration.id,entity:null===(o=n.pattern)||void 0===o?void 0:o.name});null===(e=(t=this.props).postActionCallback)||void 0===e||e.call(t)}isInDarkMode(){return"dark"===this.environment.ThemeStore.state.mode}getActionButtonStyle(){return{marginRight:4,color:this.theme.mediumTextColor,...this.props.buttonStyle}}}function Y(e){const t=(0,r.VK)((()=>{var t;return e.isCollectionView()?null===(t=e.getCollectionViewCollectionStore())||void 0===t||null===(t=t.getFormat().error)||void 0===t?void 0:t.status_code:e.getFormatStore().getKeyStore("error").getKeyStore("status_code").getValue()}),[e]),n=(0,r.VK)((()=>{let t;var n;e.isCollectionView()?t=null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.getFormat().bot_id:t=e.getFormat().bot_id;const o=M.Z.bots.state.find((e=>e.id===t));if(o)return(0,c.s9)(o.integration_id)}),[e]),{message:i,description:a}=o.useMemo((()=>(0,k.xt)(t,n)),[t,n]);return{statusCode:t,message:i,description:a}}function J(e){window.__c={n:"ErrorPopupButton"};const{onAuthenticate:t,onReplace:n,onUpdate:o,state:i,store:r,onRemove:s,style:c}=e,u=(0,a.yK)((e=>({orangeThemeColor:(0,l.fi)("orange",e),dropdownIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),{statusCode:p,message:m,description:g}=Y(r);return(0,G.jsx)(D.ZP,{popupType:D.Z4.Popup,originGap:4,renderOrigin:e=>(0,G.jsxs)(E.Z,{style:c,icon:e=>(0,f.t)({...e,fill:u.orangeThemeColor.fill}),...e,children:[(0,G.jsx)("span",{children:C.default.formatMessage(m)}),(0,d.i)(u.dropdownIcon)]}),render:e=>(0,G.jsx)($,{state:i,store:r,onUpdate:o?()=>{o(),e.close()}:void 0,onAuthenticate:t?()=>{t(),e.close()}:void 0,onReplace:()=>{n(),e.close()},onRemove:s?()=>{s(),e.close()}:void 0,statusCode:p,errorDescription:g.description,description:C.default.formatMessage(g,{integrationName:i.integration.name,statusCode:p})})})}function X(e){window.__c={n:"ErrorInlineMenu"};const{onAuthenticate:t,onReplace:n,onUpdate:o,state:i,store:r,onRemove:s}=e,c=(0,a.yK)((e=>({orangeThemeColor:(0,l.fi)("orange",e)})),[]),{statusCode:d,message:u,description:p}=Y(r);return(0,G.jsxs)("div",{style:{alignSelf:"stretch"},children:[(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:h.Z.fontSize.UIRegular.desktop,fontWeight:h.Z.fontWeight.medium,marginBottom:4},children:[(0,f.t)({width:18,height:18,marginRight:6,fill:c.orangeThemeColor.fill}),(0,G.jsx)("span",{children:C.default.formatMessage(u)})]}),(0,G.jsx)("div",{style:{margin:"0 -14px"},children:(0,G.jsx)($,{state:i,store:r,onUpdate:o,onAuthenticate:t,onReplace:n,onRemove:s,statusCode:d,errorDescription:p.description,description:C.default.formatMessage(p,{integrationName:i.integration.name,statusCode:d}),isInlineMenu:!0})})]})}Q.displayName="ExternalObjectInstanceAction";const ee=Q},14562:(e,t,n)=>{n.d(t,{Z:()=>M});var o=n(67294),i=n(8848),r=n(76725),a=n(72126),s=n(97880),l=n(82990),c=n(44876),d=n(61202),u=n(41232),p=n(6398),m=n(68859),f=n(49085);class g extends f.default{getInitialState(){return{error:!1,loading:!1}}}const h=g;var v=n(85854),b=n(68709),y=n(51077),S=n(12981),_=n(84076),w=n(68785),k=n(81865),I=n(69278),C=n(19987),x=n(85893);class T extends v.Z{constructor(){super(...arguments),this.origin=o.createRef(),this.storeTypes={externalObjectTokenStore:h,blockResizerStore:m.Z},this.state={isHovered:!1},this.renderSubheaderIconAttribute=e=>{if((0,c.li)(e)){const t=e.values[0];return(0,x.jsx)(k.Z,{isAuthenticated:!1,url:t,width:32,render:(e,t)=>(0,x.jsx)(S.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})})}if((0,c.hW)(e)){const t=e.values[0],n=t?`rgb(${t.r},${t.g},${t.b})`:"gray",{colorName:o,shade:r}=(0,i.lL)(n);return(0,x.jsx)("div",{style:{width:12,height:12,marginRight:4,background:this.theme.accentColors[o][r],borderRadius:3}})}},this.renderSubheaderAttribute=e=>(0,x.jsx)(p.ox,{...e,store:this.props.store}),this.stateStore=this.createComputedStore((()=>(0,u._l)({store:this.props.store,isInDarkMode:this.isInDarkMode(),canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,showAction:this.props.forceActionForUIDoc})),!0),this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}renderPersisted(){const e=this.stateStore.state;if(!e)return this.renderShimmerState();const t=(0,u.y6)(this.props.store);if("error"===e.type&&(null==t||!t.integration_id))return this.renderShimmerState();const{renderConfig:n}=e;return(0,x.jsx)(b.p,{allowSelectionWithin:!0,children:n.previewAttributes&&(0,s.Of)(n.previewAttributes)?this.renderEmbedPreview({attributes:n.previewAttributes,state:e}):this.renderLinkBox(e)})}renderLinkBox(e){var t;const{originalUrl:n,renderConfig:o,integration:i,updating:a}=e,{store:l}=this.props,c="placeholder"===e.type,d="error"===e.type,m=this.state.isHovered||this.environment.device.isMobile,f=n&&(0,u.pI)(n,l.pointer.spaceId);return(0,x.jsxs)(_.Z,{ref:this.origin,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{flexGrow:1,minWidth:0,...(c||d)&&{background:this.theme.embedPlaceholderBackground}},innerStyle:this.getStyle({hasPreview:!(!Boolean(o.previewAttributes)||!o.previewAttributes)&&(0,s.Of)(o.previewAttributes)}),...c||d?{onClick:()=>{const e=this.getPlaceholderNode();e&&this.openLinkEmbedMenu(e)}}:{href:f,external:!0},children:[(0,x.jsx)("div",{style:{display:"flex",alignSelf:"start",height:32,width:32,marginRight:12,marginLeft:4,marginTop:3,marginBottom:3,position:"relative"},children:this.renderBlockIcon(o,i.icon)}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1,flexShrink:1,overflow:"hidden"},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"baseline",fontSize:14},children:[(0,r.Z)((null===(t=o.headerAttributes)||void 0===t?void 0:t.map(((e,t)=>(0,x.jsx)(p.ox,{...e,store:this.props.store,style:0===t?this.getTitleStyle():{}},`attribute-${t}`))))||[],(e=>(0,x.jsx)("span",{style:{marginRight:6}},`spacer-${e}`))),(a||this.stores.externalObjectTokenStore.state.loading)&&(0,x.jsx)(w.Z,{style:{marginLeft:6}})]}),o.bodyAttribute&&(0,x.jsx)(p.hx,{attribute:o.bodyAttribute}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",color:this.theme.mediumTextColor,fontSize:12},children:[o.subheaderIcon&&this.renderSubheaderIconAttribute(o.subheaderIcon),o.subheaderAttributes&&(0,r.Z)(o.subheaderAttributes.map(this.renderSubheaderAttribute),(e=>(0,x.jsx)("span",{style:{marginLeft:3,marginRight:3},children:"•"},e)))]})]}),(0,x.jsx)(C.Z,{canEdit:this.canEdit(),forceActionForUIDoc:this.props.forceActionForUIDoc,store:this.props.store,renderDefaultAction:m?"shown":"invisible",buttonStyle:o.bodyAttribute?{alignSelf:"flex-start",marginTop:4}:{},openPlaceholderMenu:()=>{const e=this.getPlaceholderNode();e&&this.openLinkEmbedMenu(e)}})]})}renderShimmerState(){var e;return(0,x.jsxs)(_.Z,{href:null===(e=this.stateStore.state)||void 0===e?void 0:e.originalUrl,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:this.getStyle(),children:[this.renderShimmerbox({width:38,height:38}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[this.renderShimmerbox({width:"50%",height:14,margin:4}),this.renderShimmerbox({width:"40%",height:12,margin:4})]})]})}renderBlockIcon(e,t){const n=a.mN(e.icons||[],(e=>`${e.type}:${e.values[0].toString()}`));return n.length>=2?(0,x.jsxs)("div",{style:{width:32,height:32},children:[(0,x.jsx)(p.lf,{attribute:n[0],isSmall:!0}),(0,x.jsx)(p.lf,{attribute:n[1],isSmall:!0,style:{position:"absolute",bottom:0,right:2}}),(0,x.jsx)(y.Z,{type:"image_url",imageURL:t,size:16,style:{position:"absolute",bottom:-3,right:-3},imageStyle:this.getAvatarSubIconStyle()})]}):1===n.length?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(p.lf,{attribute:n[0],isSmall:!1}),(0,x.jsx)(y.Z,{type:"image_url",imageURL:t,size:16,style:{position:"absolute",bottom:-2,right:-2},imageStyle:this.getAvatarSubIconStyle()})]}):(0,x.jsx)(y.Z,{type:"image_url",imageURL:t,size:38})}renderEmbedPreview(e){const{attributes:t}=e,n=t[0],{values:o,mimeType:i}=n,r=o[0];let a;"image/*"===i?a="image":"audio/*"===i?a="audio":"video/*"===i?a="video":"application/pdf"===i?a="pdf":"text/html"===i?a="embed":(0,s.t1)(i);const l="image"===a||"pdf"===a||"embed"===a,c=this.props.store;return c.isExternalObjectInstanceBlockStore()?(0,x.jsx)("div",{style:{overflow:"hidden",borderRadius:"3px 3px 4px 4px",border:`1px solid ${this.theme.darkDividerColor}`,borderBottom:void 0,position:"relative"},children:(0,x.jsx)(I.Z,{store:c,source:r,showExpandButton:l,mediaType:a,...(0,u.Xg)()?{disabled:!1,preserveScale:"image"===a,blockResizerStore:this.stores.blockResizerStore}:{disabled:!0,preserveScale:!0,disableActions:!0,..."image"===a&&{centerWrappedContent:!0}},contentBelowSource:this.renderLinkBox(e.state)})}):void 0}renderShimmerbox(e){return(0,x.jsx)("div",{style:{overflow:"hidden",position:"relative",background:this.theme.selectLightGray[30],...e},children:(0,x.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${this.theme.selectLightGray[30]} 0%, ${this.theme.selectLightGray[50]} 20%, ${this.theme.selectLightGray[30]} 40%, ${this.theme.selectLightGray[30]} 100%)`}})})}isInDarkMode(){return"dark"===this.environment.ThemeStore.state.mode}handleCreated(){const e=this.getPlaceholderNode();e&&this.openLinkEmbedMenu(e)}getPlaceholderNode(){var e,t;if("placeholder"===(null===(e=this.stateStore.state)||void 0===e?void 0:e.type)||"error"===(null===(t=this.stateStore.state)||void 0===t?void 0:t.type)){const e=this.origin.current;if(e&&e instanceof Element)return e}}openLinkEmbedMenu(e){var t;const n=(0,u.y6)(this.props.store);d.os({originRect:e.getBoundingClientRect(),environment:this.environment,externalObjectInstanceBlockStore:this.props.store,placeholderIntegrationId:null==n?void 0:n.integration_id,integration:null===(t=this.stateStore.state)||void 0===t?void 0:t.integration,externalObjectTokenStore:this.stores.externalObjectTokenStore})}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hasPreview:t}=e;return{display:"flex",alignItems:"center",border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:t?"0px 0px 3px 3px":3,borderLeft:t?"none":`1px solid ${this.theme.darkDividerColor}`,borderRight:t?"none":`1px solid ${this.theme.darkDividerColor}`,padding:6,...this.getBlockColorStyle(),...this.props.style}}getAvatarSubIconStyle(){return{filter:`\n\t\t\t\tdrop-shadow(0px 0px 1px ${this.theme.contentBackground})\n\t\t\t\tdrop-shadow(0px 0px 1px ${this.theme.contentBackground})\n\t\t\t\tdrop-shadow(0px 0px 1px ${this.theme.contentBackground})\n\t\t\t`}}getTitleStyle(){return{fontWeight:l.Z.fontWeight.medium,...l.Z.textOverflowStyle,color:this.theme.regularTextColor}}}const M=T},69721:(e,t,n)=>{n.d(t,{S:()=>D,Z:()=>B});n(67294);var o=n(73935),i=n(53150),r=n(49271),a=n(43593),s=n(50066),l=n(72126),c=n(70203),d=n(82990),u=n(5366),p=n(50906),m=n(31781),f=n(62365),g=n(27153),h=n(24677),v=n(98104),b=n(39699),y=n(33929),S=n(27411),_=n(31792),w=n(85854),k=n(13966),I=n(91893),C=n(64921),x=n(64369),T=n(86329),M=n(78454),P=n(85893);const A=(0,u.defineMessages)({fileTitle:{defaultMessage:"File",id:"fileBlock.fileTab.title"},embedButtonText:{defaultMessage:"Embed link",id:"fileBlock.embedButton.label"},embedFilePrompt:{defaultMessage:"Paste a file link…",id:"fileBlock.linkPrompt.placeholder"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePen…",id:"fileBlock.linkPrompt.caption"}});class R extends w.Z{constructor(){super(...arguments),this.captionAriaId=(0,i.Z)(),this.caption=()=>{this.handleEditCaption()},this.storeTypes={mouseStore:_.Z},this.handleEditCaption=()=>{const e=this.props.store.getPropertyStore("caption");h.eP({environment:this.environment,store:this.props.store}),v.NX({store:e})},this.handleOpenMenu=()=>{const{device:e}=this.environment;if(this.canEdit()){const t=o.findDOMNode(this);if(t&&t instanceof Element){const n=t.getBoundingClientRect();g.$(this.environment,{originRect:n,originGap:0,isSmallWidth:!0,showArrow:!0,title:y.default.formatMessage(A.fileTitle),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:e.isAndroid,videoUpload:e.isAndroid,onUpload:this.handleUpload},{type:"embed",buttonText:y.default.formatMessage(A.embedButtonText),inputPlaceholder:y.default.formatMessage(A.embedFilePrompt),caption:y.default.formatMessage(A.embedCaption),onChange:e=>{g.Z(),b.createAndCommit({userAction:"FileBlock.handleOpenMenu",environment:this.environment,perform:t=>{f.v({store:this.props.store,source:e,name:void 0,size:void 0,transaction:t})}}),p.bOx(this.environment,{pastedText:e,source:"file_block_menu"})}}]})}}},this.handleMouseEnter=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.handleClick=()=>{m.qL(this.environment,{store:this.props.store,from:"embedded_block_click"})},this.handleUpload=e=>{const{store:t}=this.props;b.createAndCommit({userAction:"FileBlock.handleUpload",environment:this.environment,perform:e=>{f.v({store:this.props.store,source:void 0,name:void 0,size:void 0,transaction:e})}}),f.c({environment:this.environment,store:t,file:e})},this.fileUploadStore=this.createComputedStore((()=>S.default.getKeyState(S.default.getBlockKey(this.props.store.id))))}handleCreated(){this.edit()}edit(){this.handleOpenMenu()}activate(){this.handleOpenMenu()}replace(){this.handleOpenMenu()}renderPersisted(){const e=this.getSource();return e?this.renderFile(e):this.renderUploader()}renderFile(e){const{device:t}=this.environment,n=this.props.store.getProperties(),o=c.Jcv(n&&n.title),i=c.Jcv(n&&n.size),r=(this.stores.mouseStore.state.mouseEntered||t.isMobile)&&this.canEdit()&&(0,P.jsx)(k.Z,{style:{marginRight:4},store:this.props.store,fadeIn:!0});return(0,P.jsxs)("div",{role:"figure","aria-labelledby":this.captionAriaId,children:[(0,P.jsxs)("div",{onMouseMove:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{display:"flex"},children:[(0,P.jsx)(D,{title:o,url:e,size:i,onClick:this.handleClick,right:r,style:this.getStyle()}),this.renderDiscussion()]}),(0,P.jsx)(I.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})}renderUploader(){const{device:e}=this.environment,{disabled:t}=this.props,n=this.fileUploadStore.state,o=e.isMobile||this.stores.mouseStore.state.mouseEntered;return(0,P.jsxs)("div",{onMouseMove:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}),style:{display:"flex"},children:[(0,P.jsx)(T.Z,{disabled:t,iconSvg:s.R,shouldHideRight:!o,right:this.canEdit()&&(0,P.jsx)(k.Z,{store:this.props.store,fadeIn:!1}),isLoading:Boolean(n),progressPercent:n?n.progressPercent:0,file:n?n.file:void 0,name:n?n.name:void 0,size:n?n.size:void 0,onClick:this.handleOpenMenu,children:(0,P.jsx)(u.FormattedMessage,{defaultMessage:"Upload or embed a file",id:"fileBlock.uploadOrEmbed.placeholder"})}),this.renderDiscussion()]})}getSource(){const e=this.props.store.getProperties(),t=e&&e.source,n=c.QaF(t),{display_source:o}=this.props.store.getFormat();return o||n}getStyle(){return{flexGrow:1,minWidth:0,borderRadius:3,...l.CE(this.getBlockColorStyle(),["fontSize","lineHeight"])}}}function D(e){const{style:t,right:n,title:o,url:i,size:l,onClick:c}=e,u={paddingTop:r.ZD.paddingTop,paddingBottom:r.ZD.paddingBottom,paddingLeft:r.ZD.paddingLeft};return(0,P.jsx)(C.Z,{style:t,onClick:c,children:(0,P.jsx)(M.ZP,{style:u,left:(0,s.R)(),leftStyle:{width:"1.35em",height:"1.35em"},alignment:M.v2.Center,right:n,children:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[(0,P.jsx)("div",{style:{...d.Z.textOverflowStyle},children:a.rF({title:o,source:i})}),l&&(0,P.jsx)(x.Z,{isSmall:!0,style:{marginLeft:6,whiteSpace:"nowrap"},children:l})]})})})}const B=R},65453:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(49271),i=n(76490),r=n(5366),a=n(33929),s=n(35328),l=n(85854),c=n(65187),d=n(17377),u=n(85893);const p=(0,r.defineMessages)({placeholder:{defaultMessage:"Heading 1",id:"header1Block.placeholder"}});class m extends l.Z{constructor(){super(...arguments),this.getHeaderTextStyle=()=>{const{device:e}=this.environment,t=this.rootStorePageFont.state,n=e.isMobile?1.5:i.eV;return(0,i.DK)({fontSizeValue:n,fontFamily:t})}}activate(){s.th(this)}renderPersisted(){const{disabled:e}=this.props;return(0,u.jsx)("div",{style:this.getStyle(),children:(0,u.jsxs)(d.Z,{blockComponent:this,toggleStyle:this.getToggleStyle(),childrenStyleWhenToggleable:{display:"flex"},children:[(0,u.jsx)(c.Z,{tagName:"h2",disabled:e,store:this.props.store.getBlockTitleStore(),placeholder:a.default.formatMessage(p.placeholder),placeholderStyle:{WebkitTextFillColor:this.theme.headerBlockPlaceholderTextColor},style:{...o.ZD,...this.getHeaderTextStyle()},pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),this.renderDiscussion()]})})}getStyle(){return{display:"flex",width:"100%",...this.getBlockColorStyle(),...this.props.style}}getToggleStyle(){const{device:e}=this.environment;return{height:`${(e.isMobile?1.5:i.eV)*i.u9}em`,marginTop:3}}}const f=m},83182:(e,t,n)=>{n.d(t,{Z:()=>u});n(67294);var o=n(83355),i=n(84169),r=n(50906),a=n(87279),s=n(52275),l=n(16354),c=n(85893);class d extends o.Z{renderComponent(){return(0,c.jsx)(l.Z,{href:this.props.href,external:!0,onClick:()=>r.Fsx(this.environment,{from:this.props.analyticsFrom}),children:(0,c.jsx)(s.Z,{icon:!this.props.left&&this.renderIcon(),title:this.renderTitle(),focused:!1})})}renderIcon(){const{device:e}=this.environment;return(0,i.m)({width:e.isPhone?16:14,fill:this.theme.lightIconColor,marginRight:this.props.left?6:0})}renderTitle(){const{left:e}=this.props;return e?(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{...this.getTitleStyle(),marginRight:"auto"},children:this.props.left}),this.renderIcon(),(0,c.jsx)("span",{style:this.getTitleStyle(),children:this.props.title})]}):(0,c.jsx)("span",{style:this.getTitleStyle(),children:this.props.title})}getTitleStyle(){const{device:e}=this.environment;return{fontSize:e.isPhone?14:12,verticalAlign:1,color:this.theme.lightTextColor}}}d.displayName="HelpButtonMenuItem",d.contextTypes={...a.mw,...o.w};const u=d},74523:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),i=n(480),r=n(24405),a=n(84169),s=n(50906),l=n(73063),c=n(16354),d=n(89728),u=n(85893);function p(e){let{title:t,href:n,analyticsFrom:p,shouldShrink:m,style:f,buttonStyle:g,isBlue:h,onClick:v,onFocus:b,onBlur:y,onMouseDown:S,onMouseEnter:_,onMouseLeave:w}=e;window.__c={n:"HelpButtonSettingsCaption"};const k=(0,i.O7)(),I={onFocus:b,onBlur:y,onMouseDown:S,onMouseEnter:_,onMouseLeave:w},C=(0,o.useCallback)((()=>{void 0!==v&&v(),s.Fsx(k,{from:p})}),[p,k,v]),x=(0,r.yK)((()=>({link:{display:"flex",marginLeft:-6,...f}})),[f]);return(0,u.jsx)(c.Z,{style:x.link,className:"notion-print-ignore",href:n,external:!0,onClick:C,...I,children:t?(0,u.jsx)(d.Z,{icon:a.m,isSmall:!0,isBlue:h,isLightGray:!h,shouldShrink:m,style:g,children:t}):(0,u.jsx)(l.Z,{icon:a.m,isBlue:h,style:g,...I})})}const m=o.memo(p)},84456:(e,t,n)=>{n.d(t,{Z:()=>_});var o=n(67294),i=n(83355),r=n(480),a=n(88464),s=n(64002),l=n(26198),c=n(12534),d=n(55367),u=n(80796),p=n(77080),m=n(49085);class f extends m.default{getInitialState(){return{disabled:!1,loaded:!1,hasPreviewBeenDismissed:!1,isVisible:!1}}}const g=f;var h=n(69784),v=n(25777),b=n(85893);class y extends i.Z{constructor(){super(...arguments),this.iframe=null,this.storeTypes={iframeStore:g},this.handleMouseMove=e=>{const t=d.ZP.state.isDragging,n=u.Z.state.isDragging,o=h.Z.state.isActive,i=t||n||o;this.stores.iframeStore.setState({...this.stores.iframeStore.state,disabled:i})},this.releaseFocus=()=>{document.activeElement&&document.activeElement===this.iframe&&document.activeElement.blur()},this.getSanitizedSource=()=>{let e=s.yn(this.props.source);if(e||this.props.source.includes(":")||(e=s.yn(`https:${this.props.source}`)),e&&new URL(e).origin!==location.origin)return e},this.handlePreviewMouseDown=e=>{e.preventDefault(),(0,c.ZP)({event:e,context:c.Af.EditorClick,callback:()=>{this.stores.iframeStore.setState({...this.stores.iframeStore.state,hasPreviewBeenDismissed:!0})}})}}didMountOrUpdate(){super.didMountOrUpdate(),this.releaseFocus()}renderComponent(){return(0,b.jsx)("div",{style:this.props.style,onMouseMove:this.handleMouseMove,onMouseEnter:this.handleMouseMove,onMouseLeave:this.releaseFocus,children:(0,b.jsx)("div",{style:this.getAspectRatioContainerStyle(),children:this.renderInnerContent()})})}renderInnerContent(){if(this.shouldRenderPreview())return this.renderPreview();const e=this.getSanitizedSource(),t=this.getIframeStyle();return(0,b.jsx)(v.Z,{innerStyle:{height:"100%",width:"100%"},loaded:this.stores.iframeStore.state.loaded,style:y.aspectRatioInnerStyle,spinnerSize:"1em",showSpinnerTimeout:500,children:e&&(0,b.jsx)(S,{ref:e=>{this.iframe=e},sourceUrl:e,wrapperStyle:{...t,backgroundColor:"none"},style:this.getIframeStyle(),allow:this.props.allow,iframeStore:this.stores.iframeStore,onContentLoadTimeout:this.props.onContentLoadTimeout})})}renderPreview(){var e,t;return(0,b.jsx)("div",{style:{...this.getIframeStyle(),backgroundColor:"none"},onMouseDown:this.handlePreviewMouseDown,children:null===(e=(t=this.props).renderPreview)||void 0===e?void 0:e.call(t)})}willUnmount(){super.willUnmount()}shouldRenderPreview(){return!(!window.__webViewTerminatedWhileAppActive&&"on"!==p.default.getGroup("embed-previews"))&&(!this.stores.iframeStore.state.hasPreviewBeenDismissed&&Boolean(this.props.renderPreview))}getAspectRatioContainerStyle(){const{height:e,isFullWidth:t,isFullHeight:n,aspectRatio:o,preserveScale:i}=this.props,r={position:"relative",display:"flex",justifyContent:"center",width:"100%",minHeight:100};return n?(r.height="100%",r.position=void 0):t||!i?r.height=e:(r.height=0,r.paddingBottom=100*(o||.75)+"%"),r}getIframeStyle(){return{...y.aspectRatioInnerStyle,pointerEvents:this.stores.iframeStore.state.disabled?"none":"auto",backgroundColor:this.props.background?this.theme.contentBackground:"none"}}}y.displayName="IFrameBox",y.aspectRatioInnerStyle={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};const S=o.forwardRef((function(e,t){window.__c={n:"ManagedIFrame"};const{sourceUrl:n,style:i,allow:s,iframeStore:c,onContentLoadTimeout:d,wrapperStyle:u}=e,m=(0,r.O7)(),[f,g]=(0,l.jo)(),h=(0,o.useRef)(void 0),v=(0,a.Z)(t,h),y=(0,o.useRef)(void 0),S=m.device.isElectron?"allow-scripts allow-popups allow-forms allow-same-origin":"allow-scripts allow-popups allow-top-navigation-by-user-activation allow-forms allow-same-origin allow-storage-access-by-user-activation",_=(0,o.useCallback)((()=>{if(p.default.checkGate("embed_block_fallback")){var e;h.current&&(h.current.contentDocument||(null===(e=h.current.contentWindow)||void 0===e?void 0:e.document))||null==d||d()}}),[d]),w=(0,o.useCallback)((()=>{c.setState({...c.state,loaded:!0}),_()}),[_,c]);return(0,o.useEffect)((()=>(y.current=setTimeout(_,7e3),()=>{clearTimeout(y.current)})),[_]),(0,b.jsx)("div",{ref:f,style:u,children:g&&(0,b.jsx)("iframe",{ref:v,style:i,src:n,frameBorder:"0",onLoad:()=>{clearTimeout(y.current),w()},sandbox:S,allowFullScreen:!0,allow:s})})})),_=y},56813:(e,t,n)=>{n.d(t,{Z:()=>m});n(57658),n(67294);var o=n(44597),i=n(5366),r=n(33929),a=n(68859),s=n(77080),l=n(85854),c=n(69278),d=n(85893);const u=(0,i.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the image link…",id:"imageBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed image",id:"imageBlock.embedImage.button.label"}});class p extends l.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:a.Z}}renderPersisted(){const{disabled:e}=this.props,t=[{type:"file",imageUpload:!0},{type:"embed"},{type:"unsplash"}];return s.default.checkGate("enable_giphy_feature_gate")&&t.push({type:"giphy"}),(0,d.jsx)(c.Z,{...this.props,...this.stores,store:this.props.store,urlInputPlaceholder:r.default.formatMessage(u.urlPlaceholder),iconSvg:o.U,disabled:e,preserveScale:!0,mediaMenuCurrentTab:"file",mediaMenuTabs:t,mediaMenuEmbedCaption:(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Works with any image from the web",id:"imageBlock.linkInput.caption"}),embedButtonText:r.default.formatMessage(u.embedButtonText),popupWidth:540,maxHeight:420,children:(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Add an image",id:"imageBlock.placeholder"})})}}const m=p},42402:(e,t,n)=>{n.d(t,{Z:()=>a});n(67294);var o=n(8848),i=n(16354),r=n(85893);const a=function(e){const t={display:"inline",textDecoration:"underline",color:o.ZP.inherit};return(0,r.jsx)(i.Z,{href:e.href,external:e.external,style:{...t,...e.style,...e.disableUnderline&&{textDecoration:"none"}},onClick:e.onClick,className:e.disableHover?void 0:e.showAIVersion?"notion-link-ai-version":"notion-link",onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,children:e.children})}},83785:(e,t,n)=>{n.d(t,{Z:()=>g});n(67294);var o=n(83355),i=n(68626),r=n(91155),a=n(29477),s=n(88632),l=n(49085);class c extends l.default{getInitialState(){return{loaded:!1}}}const d=c;var u=n(68785),p=n(33411),m=n(85893);class f extends o.Z{constructor(e,t){super(e,t),this.storeTypes={store:d}}didMount(){this.fetch()}renderComponent(){return(0,m.jsx)(p.Z,{show:!this.stores.store.state.loaded,showDelay:300,showHold:0,render:e=>this.stores.store.state.loaded?(this.props.willRender&&this.props.willRender(),this.props.render(this.stores.store.state.result)):this.props.loading?this.props.loading(e):e?(0,m.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,m.jsx)(u.Z,{})}):void 0})}async fetch(){let e=1e3;for(;;)try{const e=await this.props.fetch();this.stores.store.setState({loaded:!0,result:e});break}catch(t){i.log({level:"warning",from:"LazyLoader",type:"fetchError",error:(0,r.Ui)(t),data:{miscDataToConvertToString:{waitMs:e}}}),await a.Vs(e),await s.Z.waitUntil((()=>s.Z.state.online)),e=Math.min(2*e,3e4)}}}f.displayName="LazyLoader";const g=f},55217:(e,t,n)=>{n.d(t,{Z:()=>ie});n(57658);var o,i=n(67294),r=n(83355),a=n(27531),s=n(41432),l=n(72126),c=n(4615),d=n(21202),u=n(13084),p=n(39699),m=n(98165),f=n(67669),g=n(23883),h=n(35661),v=n(99757),b=n(25821),y=n(45697),S=n.n(y),_=n(45060),w=n(95538),k=n(606),I=n(18844),C=n(15047),x=n(50906),T=n(94419),M=n(1742),P=n(92650),A=n(19037),R=n(28020),D=n(78316),B=n(78175),E=n(41232),F=n(78429),Z=n(17504),L=n(65598),j=n(73959),V=n(35328),U=n(24646),O=n(41662),N=n(68859),z=n(4926),H=n(77080),W=n(88923),q=n(26664),G=n(27724),K=n(45131),$=n(60981),Q=n(53223),Y=n(23063),J=n(45952),X=n(79954),ee=n(85893);class te extends r.Z{constructor(){super(...arguments),this.blockRef=i.createRef(),this.storeTypes={blockResizerStore:N.Z},this.renderPreventSidebar=()=>{const{isInlineCollectionView:e}=this.renderStateStore.state;return e?this.renderSelectable():(0,Z.Z)(this.renderSelectable)},this.renderSelectable=e=>{const{store:t,canEditList:n,isFirstItem:o,experimentalLayout:i}=this.props,{canDropOnto:r,canDropLeftRight:a,shouldShowParentHalo:l,showHoverMenu:c,canDrag:d,canSelect:u,shouldShowSelectionHalo:p,isColumnList:m,isSimpleTable:f,showCommentMenu:g,preventBackgroundDrag:h,shouldDisableHoverMenuDrag:v,disableForceTouch:b}=this.renderStateStore.state;return(0,ee.jsx)(X.Z,{style:this.getStyle.state,store:t,canSelect:u,canEditText:this.canEdit(),shouldShowHalo:p,shouldShowParentHalo:l,canDrag:d,canDropAbove:n&&o,canDropBelow:n,canDropLeft:a,canDropRight:a,canDropOnto:n&&r,canNativeDropAbove:n&&o,canNativeDropBelow:n,canNativeDropLeft:a,canNativeDropRight:a,onSelectableDrop:this.handleDrop,onNativeDrop:this.handleNativeDrop,canTriggerContextMenu:n&&!m,onInsertBelow:this.handleInsertBelow,onInsertAbove:this.handleInsertAbove,canInsertAbove:n,canInsertBelow:n,onEditText:this.handleEditText,onEnter:this.handleEnter,onRemove:this.handleRemove,showBlockMenuInput:!0,shouldShowHoverMenu:c,shouldDisableHoverMenuDrag:v,disableForceTouch:b,shouldShowCommentMenu:g,shouldShowDropZone:!f,isListContainer:!0,preventBackgroundDrag:h,analyticsName:"page_content",...e,useGrid:i&&t.getType()===s.Ti.collectionView&&t.isRootOrDirectChild(),children:this.renderBlock()})},this.handleInsertAbove=e=>{const{insertStores:t,transaction:n}=e;return l.d9(t).reverse().map((e=>T.Vt({parent:this.props.listStore,insert:e,before:this.props.store,transaction:n}).child))},this.handleInsertBelow=e=>{const{insertStores:t,transaction:n}=e;return l.d9(t).reverse().map((e=>T.BE({parent:this.props.listStore,insert:e,after:this.props.store,transaction:n}).child))},this.handleDrop=e=>{const{droppedDirection:t,droppedStores:n,duplicate:o}=e;p.createAndCommit({userAction:"ListItemBlock.handleDrop",environment:this.environment,perform:e=>{u.LQ({environment:this.environment,targetParentStore:this.props.listStore,targetStore:this.props.store,droppedDirection:t,droppedStores:n,duplicate:o,transaction:e})}})},this.handleNativeDrop=e=>{const{files:t,droppedDirection:n}=e;p.createAndCommit({userAction:"ListItemBlock.handleNativeDrop",environment:this.environment,perform:e=>u.uQ({environment:this.environment,files:t,targetParentStore:this.props.listStore,targetStore:this.props.store,droppedDirection:n,transaction:e})})},this.handleEditText=e=>{u.DC({environment:this.environment,targetStore:this.props.store,targetParentStore:this.props.listStore,isAtStartOfLine:e.isAtStartOfLine,isAtStartOfContainer:e.isAtStartOfContainer,isClick:e.isClick,transaction:e.transaction})},this.handleEnter=e=>{this.blockRef.current&&this.blockRef.current.edit?this.blockRef.current.edit():u.Bm({environment:this.environment,targetStore:this.props.store,targetParentStore:this.props.listStore,isAtStartOfLine:!1,isClick:!1,transaction:e.transaction})},this.handleRemove=e=>{const{store:t}=this.props,{transaction:n}=e,o=t.getRecordStoreUIParent();o&&(o.table!==d.iU&&o.table!==C.bx&&o.table!==I.Xj||!o.valueIs(q.i)||(M.uO(this.environment,"user_flow_delete_block",n,"ListItemBlock.handleRemove"),T.Od({parent:o,childToRemove:t,transaction:n})))},this.legacyTransclusionParentStore=this.createComputedStore((()=>{if(!this.isLegacyTransclusionStore.state)return;const e=this.props.listStore.getRecordStoreAtRootPath();return(0,L.OY)(e)?e:void 0})),this.isPageFullWidth=this.createComputedStore((()=>{var e;return null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.isFullWidth()})),this.canEditStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!this.props.disabled&&(!(0,f.YF)(e)&&this.props.store.canEdit())})),this.isLegacyTransclusionStore=this.createComputedStore((()=>{const e=this.props.store.getParentId();return Boolean(e&&this.props.listStore.id!==e)})),this.isReadOnlyBlockInReadWritePageStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return this.props.canEditList&&!A.OO({environment:this.environment,blocks:[this.props.store],publicEditMode:e})})),this.renderStateStore=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t,canEditList:n,disableSelection:o,disableHoverMenu:i,disableCommentMenu:r}=this.props,a=t.getFormat(),l=t.getType(),{dragging:c,temporaryFullWidth:u}=this.stores.blockResizerStore.state,p=(0,$.h)(this.props.store),m=c?u:a.block_full_width,g=l===s.Ti.page||l===s.Ti.collectionViewPage||a.alias_pointer&&(0,k.$O)(a.alias_pointer,d.iU)||l&&(0,V._A)(l,a)&&!K.Z.isOpen(t.id),h=Boolean(l&&(0,s.dM)(l)),v=l===s.Ti.table,b=l===s.Ti.columnList,y=p===Q.D,S=y,_=this.isRootOrDirectChild()&&!b&&!v&&n&&!e.isPhone,w=this.pageContext&&this.pageContext.publicEditModeStore.state,I=(0,f.BZ)(w);let C=!o&&t.canRead()&&!b&&!y&&!v&&!this.isReadOnlyBlockInReadWritePageStore.state;if(this.isGhostBlockOn.state){const e=y&&t.getCollectionStore();let n=y;if(e){void 0===e.getKeyStore("version").getValue()&&(n=!1)}C=!o&&t.canRead()&&!v&&!this.isReadOnlyBlockInReadWritePageStore.state&&!n}const x=!I&&C&&!y&&!v,T=x,M=!(I||i||b||y||v||(l===s.Ti.transclusionContainer||l===s.Ti.transclusionReference||l===s.Ti.aiBlock)&&this.descendantIsSelected()),P=!r&&("comment_only"===t.getRole()||"comment"===(null==w?void 0:w.permission))&&!n&&!b&&!h&&this.environment.currentUser.isLoggedIn()&&!v,A=v?O.g$.getNumberOfUnresolvedComments({simpleTableStore:t,environment:this.environment,includeInline:!this.marginCommentsVisible.state}):0,R=n&&!b&&!this.props.disableDrag,D=Boolean(this.props.store.findRecordStoreUIAncestor((e=>e===W.default.peekTarget.state)).ancestor),B=l&&(0,s.OY)(l)&&!t.getProperties().source,E="drawing"===l&&(0,j.iZ)(t),F=a.block_alignment;return{type:l,isFullWidth:m,canDropOnto:g,canDropLeftRight:_,shouldShowParentHalo:T,showHoverMenu:M,canDrag:R,canSelect:C,shouldShowSelectionHalo:x,isColumnList:b,showCommentMenu:P,numSimpleTableComments:A,isInlineCollectionView:y,isSimpleTable:v,isInPeekRenderer:D,isMediaWithoutSource:B,preventBackgroundDrag:S,disableForceTouch:E,shouldDisableHoverMenuDrag:this.isReadOnlyBlockInReadWritePageStore.state,alignStyle:F}}),!0,"renderStateStore"),this.blockRendererStore=this.createComputedStore((()=>(0,$.h)(this.props.store))),this.appRenderState=this.createComputedStore((()=>R.h1(this.environment))),this.getStyle=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t,experimentalLayout:n}=this.props,{type:o,isInPeekRenderer:i,isFullWidth:r,isInlineCollectionView:a,isSimpleTable:l,numSimpleTableComments:c,isMediaWithoutSource:d,alignStyle:u}=this.renderStateStore.state,p={};if(this.externalObjectStateStore.state){const e=this.externalObjectStateStore.state;p.minWidth=w.B9,"image/*"!==e&&(p.width="100%")}else p.width="100%";n||(p.maxWidth=this.getFullWidth()),(e.isMobile&&!r||this.isInColumnList()||!this.isRootOrDirectChild())&&(p.maxWidth="100%"),u&&!r&&!e.isPhone&&te.alignmentStyleMap[u]?p.alignSelf=te.alignmentStyleMap[u]:this.isRootOrDirectChild()&&o&&s.ib[o]?p.alignSelf="center":o&&s.Ok[o]&&(p.alignSelf="flex-start");const{topGap:m,gap:f,bottomGap:g}=te;if(p.marginTop=this.props.isFirstItem?m:f,p.marginBottom=this.props.isLastItem?g:f,d?p.marginTop=te.marginStyle.marginTop:o&&te.defaultMarginTop[o]&&(p.marginTop=te.defaultMarginTop[o]),d&&!this.props.isLastItem?p.marginBottom=te.marginStyle.marginBottom:!this.props.isLastItem&&o&&te.defaultMarginBottom[o]&&(p.marginBottom=te.defaultMarginBottom[o]),!n&&(a||l&&0===c)&&(this.isRootOrDirectChild()||e.isPhone)){const e=this.getFullWidth();p.maxWidth=i?this.getInlineCollectionInPeekViewMaxWidth():(0,D.Ks)(t)&&!this.isPageFullWidth.state?R.CC:e,p.width=(0,D.Ks)(t)&&!this.isPageFullWidth.state?R.CC:e,p.alignSelf="center"}return this.isRootOrDirectChild()&&this.marginCommentsVisible.state&&a&&(p.zIndex=1),(0,F.H)()&&this.isLegacyTransclusionStore.state&&(p.border="3px dashed deeppink"),p})),this.externalObjectStateStore=this.createComputedStore((()=>{if((0,E.Xg)()&&this.props.store.isExternalObjectInstanceBlockStore()){var e;const t=(0,E._l)({store:this.props.store,canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,isInDarkMode:"dark"===this.environment.ThemeStore.state.mode,showAction:void 0});return(null==t?void 0:t.renderConfig.previewAttributes)&&(null===(e=t.renderConfig.previewAttributes[0])||void 0===e?void 0:e.mimeType)}}),!0),this.marginCommentsVisible=this.createComputedStore((()=>(0,P.fg)(this.environment,this.props.store))),this.sidePeekWidth=this.createComputedStore((()=>(0,U.vJ)(this.environment))),this.isGhostBlockOn=this.createComputedStore((()=>H.default.checkGate("ghost_block_explorations")))}willMount(e){super.willMount(e),this.isCopyIndicatorWithoutPendingTransaction=(0,R.hq)(e.store)}didMount(){this.isLegacyTransclusionStore.state&&(x.vkP(this.environment,{block_type:this.props.store.getType()}),(0,_.XY)("Found a potential legacy transclusion--a block's parent is not its rendered parent!",[["block",this.props.store],["block parent id = ",this.props.store.getParentId()],["rendered parent id = ",this.props.listStore.id]]))}renderComponent(){if(!this.isCopyIndicatorWithoutPendingTransaction||this.renderStateStore.state.type!==s.Ti.copyIndicator)return this.isResizableType()?(0,ee.jsx)(Y.Z,{isVisible:!0,animationStyle:this.getResizeAnimationStyle(),render:()=>this.renderPreventSidebar()}):this.renderPreventSidebar()}renderBlock(){const{renderItem:e,disabled:t,store:n,disableHoverMenu:o,disableDrag:i,disableCommentMenu:r,numberedListCounterStore:a,bulletedListFormatStore:s,experimentalLayout:l}=this.props,c=this.blockRendererStore.state;return!m.Pj(n)&&H.default.checkGate("hide_orphan_blocks")?null:e?e(n):c?(0,ee.jsx)(c,{ref:this.blockRef,store:this.props.store,disabled:t,isFirstItem:this.props.isFirstItem,isLastItem:this.props.isLastItem,blockResizerStore:this.stores.blockResizerStore,disableCommentMenu:r,numberedListCounterStore:a,bulletedListFormatStore:s,disableHoverMenu:o,disableDrag:i,legacyTransclusionParent:this.legacyTransclusionParentStore.state,experimentalLayout:l}):void 0}isRootOrDirectChild(){return this.props.store.isRootOrDirectChild()}descendantIsSelected(){const{store:e}=this.props;return G.default.state.stores.some((t=>t!==e&&e.uiContains(t)))}isInHistoryModal(){return Boolean(this.props.store.inMemoryRecordCache.snapshotData)}isResizableType(){const e=this.renderStateStore.state.type;return!!e&&(Boolean(s.Ok[e])||this.props.store.isType("column_list")&&(0,B.Po)(this.props.store,this.environment)||this.props.store.isType("external_object_instance")&&(0,E.Xg)())}isOverflowEdgeBlockType(){const e=this.renderStateStore.state.type;return!!e&&(s.GP[e]||this.props.store.isType("column_list")&&(0,B.Po)(this.props.store,this.environment)&&this.props.store.getFormat().block_full_width)}isInColumnList(){return this.context.isInColumnList}canEdit(){return this.canEditStore.state}getResizeAnimationStyle(){const{type:e}=this.renderStateStore.state;if(e&&(0,J.x)({environment:this.environment,type:e}))return{width:"100%"};const{dragging:t,temporaryWidth:n,temporaryFullWidth:o,temporaryPageWidth:i}=this.stores.blockResizerStore.state,{block_width:r,block_full_width:a,block_page_width:s}=this.props.store.getFormat(),l=t?n:r,c=t?i:s;return{width:(t?o:a)?this.getFullWidth():c?"100%":l}}getFullWidth(){const{device:e}=this.environment,{isInPeekRenderer:t}=this.renderStateStore.state,n=this.environment.WindowSizeStore.state.width,o=(0,U.ll)(this.environment,t)-this.sidePeekWidth.state,i=n-z.Z.state-o;if(this.isInHistoryModal()&&!e.isPhone)return.8*n-240-z.Z.state;if(this.isInColumnList()||!this.isRootOrDirectChild())return"100%";if(t)return W.default.getPeekModeWidth(n)-z.Z.state;if((0,U.Jr)(this.environment)){let n=i;const{state:{shouldShowSidebar:o}}=this.appRenderState;return(!e.isMobile||e.isTablet)&&o&&(0,U.in)(this.environment)&&(n-=(0,U.Wk)(this.environment)),!this.renderStateStore.state.isInlineCollectionView&&this.marginCommentsVisible.state&&(this.isPageFullWidth.state?n-=P.QB:n-=2*(0,P.gC)(this.environment,t,(0,D.Ks)(this.props.store))),this.isOverflowEdgeBlockType()||(n-=2*(0,R.ui)(this.environment)),n}return i}getInlineCollectionInPeekViewMaxWidth(){return`calc(100vw - ${2*W.PeekModeOuterPadding-z.Z.state}px)`}}o=te,te.displayName="ListItemBlock",te.contextTypes={...r.w,isInColumnList:S().any},te.marginStyle={marginTop:4,marginBottom:4},te.alignmentStyleMap={left:"flex-start",center:"center",right:"flex-end"},te.defaultMarginTop={quote:o.marginStyle.marginTop,code:o.marginStyle.marginTop,bookmark:o.marginStyle.marginTop,external_object_instance:o.marginStyle.marginTop,file:void 0,video:o.marginStyle.marginTop,embed:o.marginStyle.marginTop,tweet:o.marginStyle.marginTop,audio:o.marginStyle.marginTop,drive:o.marginStyle.marginTop,gist:o.marginStyle.marginTop,maps:o.marginStyle.marginTop,framer:o.marginStyle.marginTop,invision:o.marginStyle.marginTop,figma:o.marginStyle.marginTop,loom:o.marginStyle.marginTop,typeform:o.marginStyle.marginTop,codepen:o.marginStyle.marginTop,equation:o.marginStyle.marginTop,pdf:o.marginStyle.marginTop,header:"2em",sub_header:"1.4em",sub_sub_header:"1em",image:o.marginStyle.marginTop,page:void 0,personal_home_page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:o.marginStyle.marginTop,table_of_contents:o.marginStyle.marginTop,whimsical:o.marginStyle.marginTop,miro:o.marginStyle.marginTop,abstract:o.marginStyle.marginTop,mixpanel:o.marginStyle.marginTop,sketch:o.marginStyle.marginTop,excalidraw:o.marginStyle.marginTop,replit:o.marginStyle.marginTop,table:1,table_row:void 0,tab:o.marginStyle.marginTop,hex:o.marginStyle.marginTop,deepnote:o.marginStyle.marginTop,external_object_instance_page:o.marginStyle.marginTop,button:void 0,ai_block:1,drawing:o.marginStyle.marginTop},te.defaultMarginBottom={quote:o.marginStyle.marginBottom,code:o.marginStyle.marginBottom,header:o.marginStyle.marginBottom,bookmark:o.marginStyle.marginBottom,external_object_instance:o.marginStyle.marginBottom,file:void 0,video:o.marginStyle.marginBottom,embed:o.marginStyle.marginBottom,tweet:o.marginStyle.marginBottom,drive:o.marginStyle.marginBottom,audio:o.marginStyle.marginBottom,gist:o.marginStyle.marginBottom,maps:o.marginStyle.marginBottom,framer:o.marginStyle.marginBottom,invision:o.marginStyle.marginBottom,figma:o.marginStyle.marginBottom,loom:o.marginStyle.marginBottom,typeform:o.marginStyle.marginBottom,mixpanel:o.marginStyle.marginBottom,codepen:o.marginStyle.marginBottom,equation:o.marginStyle.marginBottom,pdf:o.marginStyle.marginBottom,image:o.marginStyle.marginBottom,sub_header:void 0,sub_sub_header:void 0,page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,personal_home_page:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:o.marginStyle.marginBottom,table_of_contents:o.marginStyle.marginBottom,whimsical:o.marginStyle.marginBottom,miro:o.marginStyle.marginBottom,abstract:o.marginStyle.marginBottom,sketch:o.marginStyle.marginBottom,excalidraw:o.marginStyle.marginBottom,replit:o.marginStyle.marginBottom,hex:o.marginStyle.marginBottom,deepnote:o.marginStyle.marginBottom,table:1,table_row:void 0,tab:o.marginStyle.marginBottom,external_object_instance_page:o.marginStyle.marginBottom,button:void 0,ai_block:1,drawing:o.marginStyle.marginBottom},te.topGap=2,te.gap=1,te.bottomGap=0;const ne=te;class oe extends r.Z{constructor(){super(...arguments),this.renderItem=(e,t,n)=>e===oe.emptyDroppableKey?this.props.experimentalLayout?(0,ee.jsx)(b.bU,{children:this.renderEmptyDroppable()},e):(0,ee.jsx)(i.Fragment,{children:this.renderEmptyDroppable()},e):e===oe.placeholderKey?this.props.experimentalLayout?(0,ee.jsx)(b.bU,{children:this.props.emptyPlaceholder},e):(0,ee.jsx)(i.Fragment,{children:this.props.emptyPlaceholder},e):(0,ee.jsx)(i.Fragment,{children:this.renderChild(e,t,n)},e),this.handleEmptyDrop=e=>{const{droppedDirection:t,droppedStores:n,duplicate:o}=e;p.createAndCommit({userAction:"List.handleEmptyDrop",environment:this.environment,perform:e=>{u.LQ({environment:this.environment,targetParentStore:this.props.store,targetStore:void 0,droppedDirection:t,droppedStores:n,duplicate:o,transaction:e})}})},this.handleEmptyNativeDrop=e=>{const{files:t,droppedDirection:n}=e;p.createAndCommit({userAction:"List.handleEmptyNativeDrop",environment:this.environment,perform:e=>{u.uQ({environment:this.environment,files:t,targetParentStore:this.props.store,targetStore:void 0,droppedDirection:n,transaction:e})}})},this.bulletedListFormatStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,n=null===(e=this.props.bulletedListFormatStore)||void 0===e?void 0:e.getState().depth,o="number"==typeof n?n+1:0,i=new Map;let r;for(const a of t){const e=this.createStoreForItemId(a);r=e.getType()===s.Ti.bulletedList?e.getFormat().bullet_list_format||r:void 0,r&&i.set(a,r)}return{depth:o,blockIdFormats:i}})),this.numberedListCounterStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,n=[],o=t.length?t[0]:void 0,i=o?this.createStoreForItemId(o):void 0,r=null==i?void 0:i.getParentId(),a=null===(e=this.props.numberedListCounterStore)||void 0===e?void 0:e.state.numberedListBlockIdsWithFormat.find((e=>e.id===r)),l=null==a?void 0:a.format;let c=void 0===(null==a?void 0:a.depth)?0:(null==a?void 0:a.depth)+1,d=l,u=0;for(const p of t)if(p!==oe.emptyDroppableKey&&p!==oe.placeholderKey){const e=this.createStoreForItemId(p),t=e.getType(),o=e.getFormat();if(d=(null==o?void 0:o.list_format)??d,t===s.Ti.numberedList){let e=o.list_start_index;e&&0!==u&&(e=void 0),u=e||u+1,n.push({id:p,format:d,depth:c||0,index:u})}else d=void 0,n.push({id:void 0,format:d,depth:0,index:u}),c=0,u=0}return{depth:c||0,numberedListBlockIdsWithFormat:n}})),this.canEditStore=this.createComputedStore((()=>{const e=(0,m.n3)(this.props.store)&&this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,f.YF)(e)&&this.props.store.canEdit()})),this.itemKeysStore=this.createComputedStore((()=>{const e=this.props.store.getValue()||[];let t=e;const n=this.getChildrenLimit(),o=this.canEdit(),i=0===e.length;return void 0!==n&&(t=l.tP(t,0,n)),o&&i&&t.push(oe.emptyDroppableKey),o&&i&&this.props.emptyPlaceholder&&t.push(oe.placeholderKey),t}))}renderComponent(){if(!this.props.disableContent){var e;const t=null===(e=this.context.restrictedContentContext)||void 0===e?void 0:e.state;return t?this.itemKeysStore.state.reduce(((e,n,o,i)=>(t.indexOf(n)>=0&&e.push(this.renderItem(n,o,i)),e)),[]):this.itemKeysStore.state.map(this.renderItem)}}renderChild(e,t,n){const{disabled:o}=this.props,i=this.createStoreForItemId(e),r=i.getType(),a=l.qr(n,(e=>(0,c.e)(e))),d=(0,ee.jsx)(ne,{store:i,renderItem:this.props.renderItem,listStore:this.props.store,isFirstItem:0===t,isLastItem:t===a,disabled:o,disableLayout:this.props.disableLayout,canEditList:this.canEdit(),disableSelection:this.props.disableSelection,disableHoverMenu:this.props.disableHoverMenu,disableCommentMenu:this.props.disableCommentMenu,disableDrag:this.props.disableDrag,numberedListCounterStore:this.numberedListCounterStore,bulletedListFormatStore:this.bulletedListFormatStore,experimentalLayout:this.props.experimentalLayout});if(!this.props.experimentalLayout)return d;switch(r){case s.Ti.table:return(0,ee.jsx)(b.i2,{style:{marginLeft:-8},children:d});case s.Ti.collectionView:return i.isRootOrDirectChild()?(0,ee.jsx)(b.cx,{children:d}):d;default:return(0,ee.jsx)(b.bU,{children:(0,ee.jsx)("div",{style:{width:"100%"},children:d})})}}renderEmptyDroppable(){const e=h.G.createChildStore(this.props.store,{table:d.iU,id:this.props.store.id}),t=this.canEdit();return(0,ee.jsx)(X.Z,{store:e,canDropBelow:t,canNativeDropBelow:t,onSelectableDrop:this.handleEmptyDrop,onNativeDrop:this.handleEmptyNativeDrop,style:this.props.emptyDroppableStyle,analyticsName:"page_content",shouldShowDropZone:!0})}canEdit(){return!this.props.disabled&&(!v.n.state&&this.canEditStore.state)}getChildrenLimit(){const{limitParents:e}=g.Z.state,t=this.props.store.id;let n;return this.props.store.findRecordStoreUIAncestor((o=>{const i=e.get(o);return!(!i||!i.hasOwnProperty(t))&&(n=i[t],!0)})),n}createStoreForItemId(e){return h.G.createChildStore(this.props.store,{table:d.iU,id:e})}}oe.displayName="List",oe.placeholderKey="placeholder",oe.emptyDroppableKey="emptyDroppableKey",oe.contextTypes={...a.J,...r.w};const ie=oe},78454:(e,t,n)=>{n.d(t,{LK:()=>f,R8:()=>g,ZP:()=>w,v2:()=>l});n(67294);var o=n(49271),i=n(63143),r=n(89086),a=n(68709),s=n(85893);let l=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({});const{Start:c,Center:d,End:u}=l,p=function(e){return(0,s.jsx)(a.p,{...(0,r.td)("start"),allowSelectionWithin:!1,style:y(e),children:e.left})},m=function(e){return(0,s.jsx)(a.p,{...(0,r.td)("end"),allowSelectionWithin:!1,style:S(e),children:e.right})},f=24,g={...o.ZD,textAlign:"left"},h={[c]:"flex-start",[d]:"center",[u]:"flex-end"},v=function(e){return{display:"flex",alignItems:i.z4(e.alignment)?h[l.Start]:h[e.alignment],width:"100%",...e.style}},b=function(e){const t={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0};return(e.leftRightMinHeight||i.z4(e.leftRightMinHeight))&&(t.minHeight=`calc(1.5em + ${o.ZD.paddingTop}px + ${o.ZD.paddingTop}px)`),t},y=e=>({marginRight:2,width:f,...b(e),...e.leftStyle}),S=e=>({marginLeft:4,...b(e),...e.rightStyle}),_=e=>({flexGrow:1,flexShrink:1,flexBasis:0,minWidth:1,...e.childrenStyle}),w=function(e){return(0,s.jsxs)("div",{onClick:e.onClick,onMouseMove:e.onMouseMove,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onMouseDown:e.onMouseDown,style:v(e),children:[e.left&&p(e),e.children&&(0,s.jsx)("div",{style:_(e),children:e.children}),e.right&&m(e)]})}},40148:(e,t,n)=>{n.d(t,{HB:()=>c,Lw:()=>d,ZP:()=>u});var o=n(67294),i=n(13991),r=n(6740),a=n(24405),s=n(82990),l=n(85893);const c={fontSize:12,paddingTop:2,paddingBottom:2},d=c;function u(e){window.__c={n:"MediaPlaceholder"};const[t,n]=(0,o.useState)(!1),c=(0,a.yK)((n=>({root:{width:"100%",fontSize:14,fontFamily:s.Z.getCompositeFontFamily(i.SP).sans,color:n.mediumTextColor,borderRadius:3,background:n.embedPlaceholderBackground,position:"relative",...e.style},right:{position:"absolute",top:4,right:4,transition:"opacity 200ms ease-in",opacity:e.shouldHideRight&&!t?0:1},inner:{padding:12,paddingRight:36,display:"flex",alignItems:"center",textAlign:"left",width:"100%",overflow:"hidden"},icon:{width:25,height:25,flexShrink:0,marginRight:12,fill:n.mediumIconColor,...e.iconStyle}})),[e.style,e.shouldHideRight,e.iconStyle,t]);return(0,l.jsxs)("div",{style:c.root,onFocus:e=>{const t=e.target;t instanceof HTMLElement&&(0,r.E)(t)&&n(!0)},onBlur:()=>n(!1),children:[(0,l.jsxs)("div",{style:c.inner,children:[e.iconSvg(c.icon),(0,l.jsx)("div",{style:{...s.Z.textOverflowStyle},children:e.children})]}),e.right&&(0,l.jsx)("div",{style:c.right,children:e.right})]})}},71474:(e,t,n)=>{n.d(t,{M:()=>r,Z:()=>s});var o=n(67294),i=n(480);const r=new Set;function a(){for(const e of r)e()}const s=function(){window.__c={n:"MobileScrollListener"};const e=(0,i.Fy)();return(0,o.useEffect)((()=>{if(e.isMobile)return document.addEventListener("scroll",a,!0),()=>{document.removeEventListener("scroll",a,!0)}}),[e.isMobile]),null}},65085:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(67294),i=n(24405),r=n(42402),a=n(85893);function s(e){window.__c={n:"MultiLineTextOverflow"};const{children:t,maxLines:n,onMore:r,onLess:s}=e,c=(0,o.useRef)(null),d=(0,o.useRef)(null),u=(0,o.useRef)(null),[p,m]=(0,o.useState)(!1),[f,g]=(0,o.useState)(!n),[h,v]=(0,o.useState)(0),[b,y]=(0,o.useState)(0);(0,o.useEffect)((()=>{if(p){var e;const t=null===(e=d.current)||void 0===e?void 0:e.getClientRects()[0];v((null==t?void 0:t.height)??0),y((null==t?void 0:t.width)??0)}}),[p]);const S=(0,o.useCallback)((()=>{c.current&&m(c.current.scrollHeight>c.current.clientHeight)}),[]);(0,o.useEffect)((()=>{!f&&n&&S()}),[f,n,S]),(0,o.useEffect)((()=>{if(u.current){const e=new MutationObserver((()=>{f||S()})),t=new ResizeObserver((()=>{f||S()}));return t.observe(u.current),e.observe(u.current,{childList:!0,subtree:!0}),()=>{t.disconnect(),e.disconnect()}}}),[f,S]);const _=(0,o.useCallback)((e=>{r?r(e):(e.preventDefault(),e.stopPropagation(),g(!0))}),[r]),w=(0,o.useCallback)((e=>{s?s(e):(e.preventDefault(),e.stopPropagation(),g(!1))}),[s]),k=(0,o.useMemo)((()=>(0,a.jsx)(l,{style:{position:"absolute",right:0,bottom:0},onClick:_,children:(0,a.jsx)("div",{ref:d,children:e.moreElement})})),[e.moreElement,_]),I=(0,o.useMemo)((()=>(0,a.jsx)(l,{onClick:w,children:e.lessElement})),[e.lessElement,w]),C=(0,i.yK)((e=>({base:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:f?void 0:n},clamped:{WebkitMaskPosition:"right bottom",WebkitMask:`linear-gradient(0deg,transparent 0,transparent ${h}px,#000 ${h}px),\n\t\t\t\t\t\t\t linear-gradient(270deg,transparent 0,transparent ${b}px,#000 ${2*b}px)`}})),[n,f,h,b]);return(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsxs)("div",{ref:c,style:{...C.base,...p&&!f&&C.clamped,...e.style},children:[(0,a.jsx)("div",{ref:u,children:t}),p&&f&&I]}),p&&!f&&k]})}function l(e){let{onClick:t,style:n,children:o}=e;return(0,a.jsx)(r.Z,{disableUnderline:!0,style:n,onClick:e=>{t(e)},children:o})}},54321:(e,t,n)=>{n.d(t,{Z:()=>S});n(67294);var o=n(49271),i=n(5366),r=n(33929),a=n(85854),s=n(7825),l=n(55217),c=n(78454),d=n(83355),u=n(22491),p=n(99445),m=n(85893);class f extends d.Z{constructor(){super(...arguments),this.counterStore=this.createComputedStore((()=>{if(!this.props.numberedListCounterStore)return g({rank:0,index:1,listFormat:void 0});const e=this.props.numberedListCounterStore.state.numberedListBlockIdsWithFormat.find((e=>e.id===this.props.store.id));return g({rank:(null==e?void 0:e.depth)||0,index:(null==e?void 0:e.index)||0,listFormat:null==e?void 0:e.format})}))}renderComponent(){const e=this.counterStore.state.index.toString().length;let t=24;return"roman"===this.counterStore.state.listFormat?t=56:3===e?t=32:4===e?t=42:e>4&&(t="unset"),(0,m.jsx)("span",{...(0,u.iv)({pseudoBefore:{content:`"${this.counterStore.state.index}."`},textAlign:"center",whiteSpace:"nowrap",width:t})})}}function g(e){const{rank:t,index:n,listFormat:o}=e;if("numbers"===o)return{index:n,listFormat:o};if("letters"===o)return{index:(0,p.yt)(n),listFormat:o};if("roman"===o)return{index:(0,p.bW)(n),listFormat:o};{const e=t%3;return 0===e?{index:n,listFormat:"numbers"}:1===e?{index:(0,p.yt)(n),listFormat:"letters"}:{index:(0,p.bW)(n),listFormat:"roman"}}}f.displayName="NumberedListCounter";const h=f;var v=n(65187);const b=(0,i.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"numberedListBlock.placeholder.label"}});class y extends a.Z{renderPersisted(){const{store:e,disabled:t,numberedListCounterStore:n}=this.props,o=e.getBlockTitleStore();return(0,m.jsxs)(c.ZP,{style:this.getStyle(),left:(0,m.jsx)(h,{store:e,numberedListCounterStore:n}),leftStyle:{width:"unset"},childrenStyle:{display:"flex",flexDirection:"column"},children:[(0,m.jsxs)("div",{style:{display:"flex"},children:[(0,m.jsx)(v.Z,{style:c.R8,disabled:t,store:o,placeholder:r.default.formatMessage(b.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),this.renderDiscussion({style:s.Z.discussionIndicatorStyle})]}),!this.props.hideContent&&(0,m.jsx)(l.Z,{disabled:t,store:this.props.store.getContentStore(),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag,numberedListCounterStore:this.props.numberedListCounterStore})]})}getStyle(){return{paddingLeft:o.ZD.paddingLeft,...this.getBlockColorStyle(),...this.props.style}}}const S=y},45952:(e,t,n)=>{n.d(t,{Z:()=>f,x:()=>p});n(67294);var o=n(87292),i=n(5366),r=n(33929),a=n(68859),s=n(85854),l=n(69278),c=n(69721),d=n(85893);const u=(0,i.defineMessages)({embedButtonText:{defaultMessage:"Embed PDF",id:"pdfBlock.embeds.button.label"}});function p(e){const{type:t,environment:n}=e;return"pdf"===t&&n.device.isMobile}class m extends s.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:a.Z}}renderPersisted(){const e=this.props.store.getType();return e&&p({environment:this.environment,type:e})?(0,d.jsx)(c.Z,{store:this.props.store,disabled:this.props.disabled}):(0,d.jsx)(l.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:o.B,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Embed a PDF file",id:"pdfBlock.embeds.caption"}),embedButtonText:r.default.formatMessage(u.embedButtonText),urlInputPlaceholder:"https://...",children:(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Embed a PDF",id:"pdfBlock.placeholder"})})}}const f=m},53238:(e,t,n)=>{n.d(t,{Z:()=>R});n(67294);var o=n(83355),i=n(480),r=n(8848),a=n(43593),s=n(17755),l=n(59054),c=n(72126),d=n(54642),u=n(31781),p=n(24677),m=n(95477),f=n(98742),g=n(18514),h=n(77907),v=n(34859),b=n(4926),y=n(24042),S=n(89087),_=n(49085);class w extends _.default{getInitialState(){return{ready:!1,pages:0,renderWidth:0,showPages:0}}}const k=w;var I=n(21199),C=n(68785),x=n(53336),T=n(43145),M=n(85893);class P extends o.Z{constructor(){super(...arguments),this.ReactPDF=void 0,this.storeTypes={store:k},this.handleMouseDown=()=>{p.ZH(this.environment)},this.handleDocumentLoadSuccess=e=>{e&&e._pdfInfo&&this.stores.store.setState({...this.stores.store.state,pages:e._pdfInfo.numPages,showPages:1})},this.handlePageRenderSuccess=()=>{this.stores.store.setState({...this.stores.store.state,ready:!0})},this.handleScrollOffsetChange=e=>{e<P.loadMoreOffset&&this.stores.store.state.ready&&this.renderNextPage()},this.updateRenderWidth=()=>{this.stores.store.setState({...this.stores.store.state,renderWidth:this.props.width})},this.updateRenderWidthDebounced=c.Ds(this.updateRenderWidth,1e3)}async willMount(e){super.willMount(e),this.stores.store.setState({...this.stores.store.state,renderWidth:e.width}),this.ReactPDF=await h.deps.reactPDF.loader(),this.enqueueForceUpdate()}willUpdate(e){super.willUpdate(e),this.updateRenderWidthDebounced()}renderComponent(){if(!this.ReactPDF)return;const{source:e}=this.props,t=this.stores.store.state,{Document:n,Page:o}=this.ReactPDF,i=(0,a.x$)(e)&&!(0,g.Sr)();return(0,M.jsx)(I.Z,{capture:!0,render:r=>(0,M.jsxs)(x.Z,{type:v.Z.All,style:this.getStyle(),...(0,f.Z)(r,{onMouseDown:this.handleMouseDown}),children:[e&&(0,M.jsx)(n,{file:e,loading:(0,M.jsx)(C.Z,{style:P.loadingSpinnerStyle}),onLoadSuccess:this.handleDocumentLoadSuccess,options:{cMapUrl:"/notion-assets/cmaps/",cMapPacked:!0,withCredentials:i},children:c.w6(t.showPages).map((e=>(0,M.jsx)(o,{pageNumber:e+1,width:this.getPageWidth(),loading:"",renderAnnotationLayer:!1,renderInteractiveForms:!1,onRenderSuccess:this.handlePageRenderSuccess},e+1)))}),(0,M.jsx)(T.Z,{onChange:this.handleScrollOffsetChange})]})})}getPageWidth(){const e=this.stores.store.state;return Math.min(window.innerWidth,e.renderWidth)-2*P.leftRightPadding-b.Z.state}renderNextPage(){const{showPages:e,pages:t}=this.stores.store.state;e<t&&this.stores.store.setState({...this.stores.store.state,ready:!1,showPages:e+1})}getStyle(){const{device:e}=this.environment;return{position:"relative",height:this.props.height,maxHeight:e.isMobile?"75vh":void 0,background:r.ZP.uiExtraLightGray,paddingTop:P.topBottomPadding,paddingBottom:P.topBottomPadding,paddingLeft:P.leftRightPadding,paddingRight:P.leftRightPadding,overflow:"visible"}}}P.displayName="PDFRenderer",P.loadMoreOffset=200,P.topBottomPadding=8,P.leftRightPadding=16,P.loadingSpinnerStyle={position:"absolute",top:"calc(50% - 9px)",left:"calc(50% - 9px)",width:18,height:18};function A(e){window.__c={n:"ProxiedPDFRendererWrapper"};const{contentWrapStyle:t,width:n,height:o,blockLocation:r,source:c}=e,p=e.store.pointer,f=(0,i.O7)(),[{value:g}]=(0,l.r5)((async()=>{if(await S.transactionQueue.awaitRecordTransaction(p),(0,a.E$)(c,[m.default.secureFileS3.url,m.default.secureFileS3V2.url])){const e=f.device;return await d.getSignedFileUrl(f,{url:c,permissionRecord:p,useS3Url:e.isIOS&&e.isMobileNative},Boolean(y.Z.state.isNotionProtocolBugFixed))}return(0,s.EK)({url:c,permissionRecord:p,baseUrl:m.default.domainBaseUrl,fullyQualified:!1,userId:f.currentUser.id})}),[f,p,c]);return(0,M.jsx)("div",{style:t,children:(0,M.jsx)(P,{source:g,width:n||500,height:o||(u.qC(r)?240:500)})})}const R={render:e=>(0,M.jsx)(A,{...e}),embedGhost:!0,resizable:!0}},24813:(e,t,n)=>{n.d(t,{Z:()=>T});n(67294);var o=n(83355),i=n(15145),r=n(49271),a=n(39567),s=n(44805),l=n(82990),c=n(5366),d=n(3297),u=n(9953),p=n(39699),m=n(84210),f=n(98165),g=n(67669),h=n(77080),v=n(31792),b=n(88923),y=n(13966),S=n(84076),_=n(31278),w=n(76798),k=n(26388),I=n(78454),C=n(85893);class x extends o.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:v.Z},this.handleRecordIconChange=e=>{const{store:t}=this.props,n=t.getIconStore();n&&p.createAndCommit({userAction:"Page.handleRecordIconChange",environment:this.environment,perform:t=>{u.sO({store:n,value:e,transaction:t})}})},this.onMouseMove=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.onMouseLeave=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})}}didMount(){const{RouterStore:e,currentUser:t}=this.environment,{route:n}=e.state;"page"===n.name&&n.shouldDuplicate&&d.nM({currentUserId:null==t?void 0:t.id,blockId:n.blockId})}renderComponent(){const{store:e,onClick:t}=this.props,n=(0,m.Hu)({store:e,fullyQualified:!1,pageVisitSource:i.tY.LinkInPage}),o=(0,m.Hu)({store:this.props.store,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:i.tY.PeekOpen}),r=h.default.checkGate("enable_deleted_page_indicator"),a=f.wf(e),s=r&&a;return(0,C.jsx)(S.Z,{href:n,altHref:o,forceAltHref:b.default.isSidePeekOpen(),external:!1,onClick:t,style:this.props.style,children:(0,C.jsx)(I.ZP,{childrenStyle:x.childrenStyle,alignment:I.v2.Center,right:this.renderActionButton(),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[this.renderIconWithArrow(s),(0,C.jsx)(w.Z,{store:e,style:this.getTitleStyle(s)})]})})})}renderIconWithArrow(e){if(e){const e=this.environment.device.isSafari||this.environment.device.isIOS;return(0,s.tr)({isSafariOrIOS:e,theme:this.theme})}return(0,C.jsxs)("div",{style:{position:"relative",width:24,height:24,marginRight:4},children:[this.renderIcon(),this.renderArrowIcon()]})}renderArrowIcon(){if(this.props.isAlias)return(0,C.jsx)("div",{children:(0,a.Y)({position:"absolute",width:"50%",height:"50%",right:0,bottom:0})})}renderIcon(){const{store:e,disabled:t}=this.props;return(0,C.jsx)(k.Z,{renderTooltip:()=>(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Change icon",id:"page.changeIcon.tooltip"}),placement:k.Z.Placement.Top,disableTooltip:t||!this.canEdit(),render:n=>t||!this.canEdit()?(0,C.jsx)(_.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),role:e.getRole(),size:22,style:{width:"100%",height:"100%"},...n,largeIcon:!0}):(0,C.jsx)(_.Z,{disabled:!1,bucket:"secure",store:e,icon:e.getIcon(),role:e.getRole(),isEmptyPage:e.isEmptyPage(),size:22,style:{width:"100%",height:"100%"},iconLoggingData:{recordTable:e.table,source:"subpage",block_type:e.getType()},onChange:this.handleRecordIconChange,...n,largeIcon:!0})})}renderActionButton(){const{device:e}=this.environment;return this.canEdit()&&(this.stores.mouseStore.state.mouseEntered||e.isMobile)?(0,C.jsx)(y.Z,{store:this.props.aliasStore??this.props.store,tooltipContent:(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Rename, delete, and more…",id:"page.blockActionMenu.tooltip"}),style:{marginRight:4},fadeIn:!0}):(0,C.jsx)("div",{style:{width:28}})}canEdit(){const{store:e}=this.props,t=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,g.YF)(t)&&(e.canEdit()&&!this.props.disabled)}getTitleStyle(e){return{fontWeight:l.Z.fontWeight.medium,lineHeight:1.3,borderBottom:this.props.disableUnderline?"none":`1px solid ${this.theme.darkDividerColor}`,...e&&{color:this.theme.mediumTextColor}}}}x.displayName="Page",x.childrenStyle={paddingTop:r.ZD.paddingTop,paddingBottom:r.ZD.paddingBottom,paddingLeft:r.ZD.paddingLeft};const T=x},4382:(e,t,n)=>{n.d(t,{Z:()=>C});var o=n(67294),i=n(73935),r=n(83355),a=n(15145),s=n(50906),l=n(75018),c=n(97444),d=n(32741),u=n(66213),p=n(14976),m=n(35683),f=n(84210),g=n(77080),h=n(61738),v=n(22294),b=n(72014),y=n(88923),S=n(85854),_=n(68709),w=n(24813),k=n(85893);class I extends S.Z{constructor(){super(...arguments),this.nodeRef=o.createRef(),this.handleClick=()=>{const{store:e}=this.props;s.Se(this.environment),s.SK1(this.environment,{page_visit_id:b.$g.getCurrentPageVisitId(),mentioned_page_id:e.id,source_type:"page_block",hover_preview_enabled:g.default.checkGate("first_party_links"),is_navigable_block:e.isNavigableBlock()}),h.Z.recordVisit({id:e.id,blockType:e.getType(),type:m.vu.Link,currentUserId:this.environment.currentUser.id})},this.handleMouseOver=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&c.Nh({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handleMouseOut=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&c.Zl({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})}}handleCreated(){this.activate(),v.Z.setKeyboardMode(!1)}activate(){const{store:e}=this.props;this.navigate(e)}willUnmount(){super.willUnmount(),d.qA(this.props.store.getTitleStore())}navigate(e){if(this.context.overrideLinkClick){const t=(0,f.ZP)({store:e,pageVisitSource:a.tY.Create});this.context.overrideLinkClick(t)}else l.navigateToBlock({environment:this.environment,store:e,visitType:m.vu.Link,openInSidePeek:y.default.isSidePeekOpen(),pageVisitSource:a.tY.Create})}renderPersisted(){const{disabled:e}=this.props;return(0,k.jsx)(_.p,{allowSelectionWithin:!1,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:(0,k.jsx)(w.Z,{ref:this.nodeRef,store:this.props.store,style:{...this.getBlockColorStyle(),...this.props.style},isAlias:this.props.store.recordStoreParentDiffersFromPersistedParent(),disabled:e,onClick:this.handleClick})})}getInteractiveToken(){if(!this.nodeRef||!this.nodeRef.current)return;const e=i.findDOMNode(this.nodeRef.current);return(0,p.We)(this.props.store,e)}}I.contextTypes={...u.wK,...r.w};const C=I},35541:(e,t,n)=>{n.d(t,{u:()=>x});n(67294);var o=n(86628),i=n(24405),r=n(41892),a=n(70203),s=n(1292),l=n(7825),c=n(38376),d=n(27627),u=n(51077),p=n(36596),m=n(65453),f=n(54321),g=n(4382),h=n(16472),v=n(99571),b=n(51704),y=n(17970),S=n(11620),_=n(4859),w=n(91791),k=n(91497),I=n(85893);let C;function x(e){const t=e.getType();if(t){if(!C){const e={text:y.Z,page:g.Z,collection_view_page:d.Z,bulleted_list:l.Z,numbered_list:f.Z,toggle:_.Z,quote:h.Z,to_do:S.Z,header:m.Z,sub_header:v.Z,sub_sub_header:b.Z,callout:c.Z,transclusion_container:w.Z,transclusion_reference:k.Z,alias:s.Z};C={...e,...{abstract:T,audio:T,code:T,codepen:T,equation:T,figma:T,file:T,pdf:T,video:T,deepnote:T,drive:T,excalidraw:T,framer:T,gist:T,hex:T,invision:T,loom:T,maps:T,miro:T,mixpanel:T,replit:T,sketch:T,tweet:T,typeform:T,whimsical:T},copy_indicator:void 0,personal_home_page:void 0,button:void 0,image:void 0,bookmark:void 0,factory:void 0,divider:void 0,column_list:void 0,embed:void 0,breadcrumb:void 0,collection_view:void 0,link_to_page:void 0,link_to_collection:void 0,column:void 0,table_of_contents:void 0,external_object_instance:void 0,table:void 0,table_row:void 0,tab:void 0,external_object_instance_page:void 0,ai_block:void 0,drawing:void 0}}return C[t]}}const T=e=>{let{store:t}=e;window.__c={n:"MultiMediaAndIntegrationPreview"};const[n,s]=(0,o.VK)((()=>{var e;const n=t.getType(),o=null===(e=t.getTitleStore())||void 0===e?void 0:e.getValue();return[n,a.QaF(o)]}),[t]),l=(0,i.yK)((e=>({card:{display:"flex",padding:10,border:"1px solid #E3E2E0",borderRadius:5,marginBottom:6,gap:10},shimmer:{backgroundColor:e.largeShimmerColor,width:150,borderRadius:10}})),[]),c=function(e){const t=e&&M[e];if("string"==typeof t)return t;return r.Z.images.icons.unknownTypePng}(n);return(0,I.jsxs)("div",{style:l.card,children:[(0,I.jsx)(u.Z,{type:"image_url",imageURL:c,size:25,imageStyle:{marginLeft:4,marginRight:4}}),s.length>0?(0,I.jsx)("span",{children:s}):(0,I.jsx)(p.Z,{emphasized:!0,style:l.shimmer})]})};const M={equation:r.Z.images.blocks.texPng,audio:r.Z.images.blocks.audioPng,file:r.Z.images.blocks.filePng,pdf:r.Z.images.blocks.pdfPng,code:r.Z.images.blocks.codePng,video:r.Z.images.blocks.videoPng,abstract:r.Z.images.blocks.abstractPng,codepen:r.Z.images.blocks.codepenPng,deepnote:r.Z.images.blocks.deepnotePng,drive:r.Z.images.blocks.drivePng,excalidraw:r.Z.images.blocks.excalidrawPng,figma:r.Z.images.externalIntegrations.figmaIconPng,framer:r.Z.images.blocks.framerPng,gist:r.Z.images.blocks.githubPng,hex:r.Z.images.blocks.hexPng,invision:r.Z.images.blocks.invisionPng,loom:r.Z.images.blocks.loomPng,maps:r.Z.images.blocks.mapsPng,miro:r.Z.images.blocks.miroPng,mixpanel:r.Z.images.blocks.mixpanelPng,replit:r.Z.images.blocks.replitPng,sketch:r.Z.images.blocks.sketchPng,typeform:r.Z.images.blocks.typeformPng,tweet:r.Z.images.blocks.twitterPng,whimsical:r.Z.images.blocks.whimsicalPng}},32469:(e,t,n)=>{n.d(t,{Z:()=>u});n(67294);var o=n(83355),i=n(8848),r=n(90199),a=n(82990),s=n(5366),l=n(26388),c=n(85893);class d extends o.Z{constructor(){super(...arguments),this.storeTypes={}}renderComponent(){return(0,c.jsx)(l.Z,{renderTooltip:()=>(0,c.jsx)(s.FormattedMessage,{defaultMessage:"Only you can see this page",id:"privatePageBadge.tooltip"}),render:e=>(0,c.jsx)("div",{style:{display:"flex",alignItems:"flex-start",...this.props.style||{}},...e,children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("div",{style:{flexShrink:0,marginTop:-1,marginRight:4,fill:i.ZP.red},children:(0,r.b)({width:12})}),(0,c.jsx)("span",{style:{fontSize:12,fontWeight:a.Z.fontWeight.semibold,color:i.ZP.red},children:(0,c.jsx)(s.FormattedMessage,{defaultMessage:"Private",id:"privatePageBadge.label"})})]})})})}}d.displayName="PrivatePageBadge",d.style={};const u=d},16472:(e,t,n)=>{n.d(t,{Z:()=>m});n(67294);var o,i=n(49271),r=n(5366),a=n(33929),s=n(85854),l=n(55217),c=n(65187),d=n(85893);const u=(0,r.defineMessages)({emptyPlaceholder:{defaultMessage:"Empty quote",id:"quoteBlock.emptyQuote.placeholder"}});class p extends s.Z{renderPersisted(){const{disabled:e}=this.props;return(0,d.jsxs)("blockquote",{style:this.getStyle(),children:[(0,d.jsxs)("div",{style:p.innerStyle,children:[(0,d.jsx)(c.Z,{style:p.padding,placeholderStyle:{left:p.innerStyle.paddingLeft,width:"auto",right:p.innerStyle.paddingLeft},disabled:e,store:this.props.store.getBlockTitleStore(),placeholder:a.default.formatMessage(u.emptyPlaceholder),pasteBehavior:"block"}),!this.props.hideContent&&(0,d.jsx)(l.Z,{disabled:e,store:this.props.store.getContentStore(),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})]}),this.renderDiscussion()]})}getStyle(){const e=this.props.store.getFormat();return{margin:0,fontSize:"large"===(null==e?void 0:e.quote_size)?"1.2em":"1em",...i.ZD,...this.getBlockColorStyle(),display:"flex",...this.props.style}}}o=p,p.borderWidth=3,p.horizontalPadding=14,p.padding={paddingLeft:i.ZD.paddingLeft,paddingRight:i.ZD.paddingRight},p.innerStyle={borderLeft:`${o.borderWidth}px solid currentColor`,paddingLeft:o.horizontalPadding,paddingRight:o.horizontalPadding,width:"100%"};const m=p},79954:(e,t,n)=>{n.d(t,{Z:()=>W});var o=n(67294),i=n(83355),r=n(45060),a=n(8848),s=n(89789),l=n(63143),c=n(51454),d=n(6404),u=n(42239),p=n(18957),m=n(52989),f=n(24677),g=n(39699),h=n(11368),v=n(84064),b=n(43250),y=n(78316),S=n(12534),_=n(98742),w=n(39500),k=n(45162),I=n(73959),C=n(89224),x=n(89086),T=n(95802),M=n(21273),P=n(82375),A=n(55367),R=n(10084),D=n(80796),B=n(20144),E=n(35661),F=n(69784),Z=n(49085);class L extends Z.default{getInitialState(){return{shouldShowSelectionHalo:!1,shouldShowDropParentHalo:!1,shouldShowDropZone:!1,shouldShowDropZoneHint:!1,forceRenderSelectionHalo:!1,showActionIsInFlight:!1}}}const j=L;var V=n(27724),U=n(24666),O=n(23063),N=n(6685),z=n(85893);class H extends i.Z{constructor(){super(...arguments),this.lastDropZoneHintIndex=void 0,this.selectableDivRef=o.createRef(),this.storeTypes={draggableStore:R.Z,selectableStore:j},this.renderSelectionHaloContent=()=>(0,z.jsx)("div",{className:b.No6,style:this.getSelectionHaloStyle()}),this.renderDropParentHaloContent=()=>(0,z.jsx)("div",{className:b.No6,style:this.getDropParentHaloStyle()}),this.handleDragStart=e=>{const{mobileNative:t}=this.environment;this.props.canDrag&&(e.preventDefault(),t&&t.buzz()),this.props.onDraggableDragStart&&this.props.onDraggableDragStart(e)},this.handleDragMove=e=>{const{device:t}=this.environment;this.props.canDrag&&!this.props.preventBackgroundDrag?A.ZP.state.isDragging?u.td(this.environment,{currentX:e.currentX,currentY:e.currentY}):w.X9()&&(f.Ys({environment:this.environment,store:this.props.store,toggle:f.ji(this.environment),selectBetween:f.OS()}),u.f$(this.environment,{startX:e.startX,startY:e.startY,stores:this.props.contextMenuAndDragStores||V.default.state.stores,isNativeDrag:!1,getGhostElement:this.props.getGhostElement})):F.Z.state.isActive||t.isPhone||m.AI({environment:this.environment,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!this.props.disableScrollToRevealHorizontal}),this.props.onDraggableDragMove&&this.props.onDraggableDragMove(e)},this.handleDragEnd=e=>{const{device:t}=this.environment;t.isMobile&&D.Z.state.isDragging&&e.preventDefault(),this.props.canDrag&&A.ZP.state.isDragging&&u.fX({environment:this.environment,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:this.props.analyticsName}),this.props.onDraggableDragEnd&&this.props.onDraggableDragEnd(e)},this.handleDragCancel=e=>{this.props.canDrag&&A.ZP.state.isDragging&&(u.cQ(this.environment),f.ZH(this.environment)),this.props.onDraggableDragCancel&&this.props.onDraggableDragCancel(e)},this.handleClick=e=>{(0,S.ZP)({event:e,context:S.Af.EditorClick,callback:()=>{var t;if(null!==(t=V.default.getDefaultContainerFromTarget(e.target))&&void 0!==t&&t.isPeekRenderer()||p.E5(this.environment),(0,I.Mn)(this.environment.device))w.X9()||!this.props.canSelect||this.props.store.isInlineCollectionView()||f.Ys({environment:this.environment,store:this.props.store,toggle:f.ji(this.environment),selectBetween:f.OS()});else{const{onEditText:t}=this.props;if(t){const n=(0,x.Rb)(e.target);n&&g.createAndCommit({userAction:"Selectable.handleClick",environment:this.environment,perform:e=>{t({isAtStartOfLine:"start"===n,isClick:!0,transaction:e})}})}}this.props.onClick&&this.props.onClick(e)}})},this.handleContextMenu=e=>{const{device:t}=this.environment;if(t.isAndroid){const t=U.default.state,n=(0,I.mh)(this.props.store),o=n&&"empty"!==t.mode&&(0,k.r)(t.multiSelection,n);if("editing"!==t.mode||!o)return C.isExpanded(C.get())||e.preventDefault(),e.stopPropagation(),!1}if(this.props.canTriggerContextMenu){const t=(0,y.fm)(this.props.store);(0,S.ZP)({event:e,context:S.Af.EditorContextMenu,callback:()=>{e.preventDefault(),f.Ys({environment:this.environment,store:this.props.store}),d.Qn({environment:this.environment,stores:this.props.contextMenuAndDragStores||V.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:this.props.actionSectionGroupKey||"default",showInput:Boolean(this.props.showBlockMenuInput),analyticsFrom:"content_block_menu",optionalAnalyticsProperties:{collectionContextStore:t}})}})}},this.handleDoubleClick=e=>{this.props.canSelect||(0,S.ZP)({event:e,context:S.Af.EditorDoubleClick,callback:()=>{this.props.onDoubleClick&&this.props.onDoubleClick(e)}})},this.handleMouseOver=e=>{this.props.canSelect&&(0,S.ZP)({event:e,context:S.Af.EditorMouseOver,callback:()=>{B.Z.setState({...B.Z.state,hoveredStore:this.props.store,lastHoveredStore:this.props.store})}})},this.handleMouseOut=()=>{B.Z.state.hoveredStore===this.props.store&&B.Z.setState({...B.Z.state,hoveredStore:void 0})},this.computedStore=this.createComputedStore((()=>{const e=this.getDropZoneHintIndex();!l.z4(e)&&e>=0&&(this.lastDropZoneHintIndex=e);const t=this.shouldShowSelectionHalo(),n=this.shouldShowDropParentHalo(),o=this.getCurrentDropZone(),i=this.getDropZoneHint(),r=this.lastDropZoneHintIndex,a=this.stores.draggableStore.state.dragging,s=this.stores.draggableStore.hasDragged(),c=this.stores.draggableStore.state.initiator,d=this.stores.selectableStore.state,u=this.props.store.getType()||"unknown";return{isDragging:a,initiator:c,hasDragged:s,shouldShowSelectionHalo:t||d.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldShowDropParentHalo:n,currentDropZone:o,dropZoneHint:i,dropZoneHintIndex:r,shouldRenderSelectionHalo:t||d.shouldShowSelectionHalo||d.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldRenderDropParentHalo:n||d.shouldShowDropParentHalo,shouldRenderDropZoneHint:!l.z4(i)||d.shouldShowDropZoneHint,shouldRenderDropZone:!l.z4(o)||d.shouldShowDropZone,propStoreType:u,showActionIsInFlight:d.showActionIsInFlight}}))}get registries(){return[T.C]}getNode(){return this.props.nodeRef?this.props.nodeRef.current:this.selectableDivRef.current}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextSelectableContainer(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer}getContextVerticalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.verticalScroller}getContextHorizontalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.horizontalScroller}renderComponent(){var e;const{isDragging:t,initiator:n,hasDragged:o,shouldShowDropParentHalo:i,shouldShowSelectionHalo:r,currentDropZone:a,dropZoneHint:s,dropZoneHintIndex:l,shouldRenderSelectionHalo:c,shouldRenderDropParentHalo:d,shouldRenderDropZoneHint:u,shouldRenderDropZone:p,propStoreType:m,showActionIsInFlight:f}=this.computedStore.state,g=c||d||u||p,h=`${b.euV} notion-${m}-block`,y=this.renderDraggable((e=>(0,z.jsxs)("div",{ref:this.selectableDivRef,style:this.getStyle({isPositionRelative:g,isDragging:t,hasDragged:o,initiator:n,useGrid:this.props.useGrid,showActionIsInFlight:f}),"data-block-id":this.props.store.id,className:this.props.className?`${h} ${this.props.className}`:h,...(0,_.Z)(e||{},{onDoubleClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.handleClick,onMouseMove:this.props.onMouseMove,onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave}),children:[this.props.children,c&&this.renderSelectionHalo(r),d&&this.renderDropParentHalo(i),u&&this.renderDropZoneHint(s,l),p&&this.renderCurrentDropZone(a)]})));return(0,z.jsx)(v.ld,{value:{selectableContainer:null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer,closestSelectable:this},children:y})}displaySelectionHalo(e){this.stores.selectableStore.state.forceRenderSelectionHalo||(this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!0}))),window.setTimeout((()=>{this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!1})))}),e))}renderDraggable(e){const{device:t}=this.environment;return this.props.canDrag?(0,z.jsx)(N.Z,{draggableStore:this.stores.draggableStore,forceTouch:t.isMobile&&!this.props.disableForceTouch,touchDragOnly:this.props.touchDragOnly,onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disableHorizontalEdgeScroll:this.props.disableHorizontalDragEdgeScroll,render:e}):e(void 0)}renderSelectionHalo(e){return(0,z.jsx)(O.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:H.opacitySpringConfig},onAnimationStart:()=>{this.stores.selectableStore.setState({...this.stores.selectableStore.state,shouldShowSelectionHalo:!0})},onAnimationEnd:()=>{e||this.stores.selectableStore.setState({...this.stores.selectableStore.state,shouldShowSelectionHalo:!1})},render:this.renderSelectionHaloContent},"halo")}renderDropParentHalo(e){return(0,z.jsx)(O.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:H.opacitySpringConfig},onAnimationStart:()=>{this.stores.selectableStore.setState({...this.stores.selectableStore.state,shouldShowDropParentHalo:!0})},onAnimationEnd:()=>{e||this.stores.selectableStore.setState({...this.stores.selectableStore.state,shouldShowDropParentHalo:!1})},render:this.renderDropParentHaloContent},"parent")}renderCurrentDropZone(e){const t=void 0!==e;return(0,z.jsx)(O.Z,{isVisible:t,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:H.opacitySpringConfig},onAnimationStart:()=>{this.stores.selectableStore.setState({...this.stores.selectableStore.state,shouldShowDropZone:!0})},onAnimationEnd:()=>{t||this.stores.selectableStore.setState({...this.stores.selectableStore.state,shouldShowDropZone:!1})},render:()=>(0,z.jsx)("div",{style:this.getDropZoneStyle(e,0),children:e!==A.vh.Onto&&(0,z.jsx)("div",{style:this.getHintGapBoxStyle(e)})})},"dropZone")}renderDropZoneHint(e,t){const n=!l.z4(e);return(0,z.jsx)(O.Z,{isVisible:n,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:H.opacitySpringConfig},onAnimationStart:()=>{this.stores.selectableStore.setState({...this.stores.selectableStore.state,shouldShowDropZoneHint:!0})},onAnimationEnd:()=>{n||this.stores.selectableStore.setState({...this.stores.selectableStore.state,shouldShowDropZoneHint:!1})},render:()=>(0,z.jsx)("div",{style:this.getDropZoneStyle(e,(t||0)+1),children:(0,z.jsx)("div",{style:this.getHintGapBoxStyle(e)})})},"hint")}shouldShowSelectionHalo(){const{device:e}=this.environment,{store:t,shouldShowHalo:n}=this.props;if(!n||!(0,I.Mn)(e))return!1;const{stores:o,phase:i}=V.default.state;if(i===V.SelectionPhase.Selected&&o.indexOf(t)>=0&&!A.ZP.state.isDragging)return!0;const r=P.XN.state;return!(null==r||!r.selectedBlocks.has(t))}shouldShowDropParentHalo(){const{store:e,shouldShowHalo:t}=this.props;if(!t)return!1;const n=A.ZP.state;if(!n.isDragging)return!1;const{currentParentStore:o,currentHintDropZones:i,currentDropZone:r}=n;return(!r||r.type!==A.Dl.DropTarget)&&(i.some((e=>e.direction===A.vh.Left||e.direction===A.vh.Right))?Boolean(r&&r.store===e):o===e)}getCurrentDropZone(){const{store:e,shouldShowDropZone:t}=this.props,n=A.ZP.state;if(!n.isDragging)return;const{currentDropZone:o}=n;return o&&o.type===A.Dl.Selectable&&o.store===e&&t?o.direction:void 0}getDropZoneHint(){const{store:e,shouldShowDropZone:t}=this.props,n=A.ZP.state;if(!n.isDragging)return;const{currentHintDropZones:o}=n;if(o&&t){const t=o.find((t=>t.type===A.Dl.Selectable&&t.store===e));if(t)return t.direction}}getDropZoneHintIndex(){const{store:e}=this.props,t=A.ZP.state;if(!t.isDragging)return;const{currentHintDropZones:n}=t;return n?n.findIndex((t=>t.type===A.Dl.Selectable&&t.store===e)):void 0}getStyle(e){const{isPositionRelative:t,isDragging:n,hasDragged:o,useGrid:i,showActionIsInFlight:r,initiator:a}=e,l={};"touch"===a&&(l.transition="transform 200ms ease-out",this.props.canDrag&&n&&!o&&(l.boxShadow=this.theme.mediumBoxShadow,l.transform="scale(1.05)",l.borderRadius=3)),t&&(l.position="relative"),i&&(l.display="grid",l.gridTemplateColumns="inherit",l.gridColumn="full"),r&&(l.opacity=.5);M.Z.shouldAttributeChangesToAI()&&this.props.store.getCreatedById()===s.GR.id&&this.props.store.getLastEditedById()===s.GR.id&&this.theme.accentColors.purple[50];return{...l,...this.props.style}}getSelectionHaloStyle(){return{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:a.ZP.blueWithAlpha(.14),zIndex:c.py,borderRadius:3,...this.props.haloStyle}}getDropParentHaloStyle(){return{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:a.ZP.blueWithAlpha(.07),borderRadius:3}}getHintGapBoxStyle(e){const{device:t}=this.environment;if(void 0===e)return{};const n=t.isMobile?3:2;return e===A.vh.Above||e===A.vh.Below?{position:"relative",left:-n,width:n,height:H.dropzoneSize,background:this.theme.contentBackground,transform:"translateZ(100px)"}:{position:"relative",top:-n,width:H.dropzoneSize,height:n,background:this.theme.contentBackground,transform:"translateZ(100px)"}}getDropZoneStyle(e,t){const n={position:"absolute",pointerEvents:"none",background:a.ZP.blueWithAlpha(.43),zIndex:c.S1-t};if(e===A.vh.Onto)n.left=0,n.top=0,n.right=0,n.bottom=0,n.background=a.ZP.blueWithAlpha(.14);else if(e===A.vh.Above||e===A.vh.Below){const t=4;n.left=0,n.right=0,e===A.vh.Above?(n.top=-t,this.props.aboveDropZoneMargin&&(n.top-=this.props.aboveDropZoneMargin)):(n.bottom=-t,this.props.belowDropZoneMargin&&(n.bottom-=this.props.belowDropZoneMargin)),n.height=H.dropzoneSize}else{const t=8;n.top=0,n.bottom=0,e===A.vh.Left?n.left=this.props.dropzoneGap?-this.props.dropzoneGap:-t:n.right=this.props.dropzoneGap?-this.props.dropzoneGap:-t,n.width=H.dropzoneSize}return n}}H.displayName="Selectable",H.contextTypes={...h.I3,...v.Tf,...i.w},H.opacitySpringConfig={stiffness:70,damping:10,precision:.001},H.dropzoneSize=4;const W=H;(0,r.Rw)({canFormat:e=>Boolean(e&&e instanceof E.G),header(e){const{tr:t,td:n,object:o,objectSummary:i}=r.TI,a=T.C.findSelectableFromStore(e)||void 0,s=e.getTitleValue(),l=e.getType();return(0,E.KS)(e,s&&t({},n({},"block title:"),n({},i(s,{asJSON:!0}))),l&&t({},n({},"block type:"),n({},o(l))),a&&t({},n({},"<Selectable>:"),n({},o(a))))},hasBody:()=>!1,body:()=>null})},23189:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(24405),i=n(8848),r=n(82990),a=n(85893);const s=function(e){window.__c={n:"SettingHeader"};const t=(0,o.Fg)(),{divider:n,large:s,block:l,children:c,hasMarginTop:d,small:u,style:p,smallMarginBottom:m,isCritical:f}=e,g="full"===n;return(0,a.jsx)("div",{style:{borderBottom:g?`1px solid ${t.regularDividerColor}`:0,marginBottom:g?16:m?2:8,marginTop:d?16:0,paddingBottom:g?12:0,fontSize:g?16:s?14:u?12:14,fontWeight:g?r.Z.fontWeight.medium:400,width:l?"100%":"auto",color:f?i.ZP.red:t.regularTextColor,...p},children:c})}},13490:(e,t,n)=>{n.d(t,{Z:()=>r});n(67294);var o=n(24405),i=n(85893);const r=function(e){window.__c={n:"SettingLabel"};const t=(0,o.yK)((t=>{const{hasMarginTop:n}=e,o={display:"block",marginBottom:4,fontSize:12,color:t.mediumTextColor};return n&&(o.marginTop=14),{style:o}}),[e]),{forId:n,children:r,style:a}=e;return(0,i.jsx)("label",{style:{...t.style,...a},htmlFor:n,children:r})}},35021:(e,t,n)=>{n.d(t,{Z:()=>p});n(67294);var o=n(83355),i=n(43593),r=n(54642),a=n(95477),s=n(24042),l=n(89087),c=n(77137),d=n(85893);class u extends o.Z{constructor(){super(...arguments),this.performRequest=async e=>i.E$(e.url,[a.default.secureFileS3.url,a.default.secureFileS3V2.url])?(e.permissionRecord&&await l.transactionQueue.awaitRecordTransaction(e.permissionRecord),r.getSignedFileUrl(this.environment,e,Boolean(s.Z.state.isNotionProtocolBugFixed))):e.url}renderComponent(){return(0,d.jsx)(c.Z,{request:{url:this.props.url,permissionRecord:this.props.permissionRecord,useS3Url:this.props.useS3Url},performRequest:this.performRequest,render:this.props.render})}}u.displayName="SignedUrl";const p=u},6854:(e,t,n)=>{n.d(t,{Pn:()=>b,ow:()=>y,wr:()=>S});var o=n(67294),i=n(480),r=n(24405),a=n(15145),s=n(1436),l=n(55863),c=n(5366),d=n(82007),u=n(75018),p=n(64964),m=(n(84076),n(89728)),f=n(73744),g=n(35683),h=n(85893);const v=(0,c.defineMessages)({open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"}});function b(e){window.__c={n:"SnackbarButton"};const t=(0,r.Fg)();return(0,h.jsx)(m.Z,{...e,style:{color:t.regularInvertedTextColor,fontWeight:500,height:void 0,marginLeft:0,...e.style}})}function y(e){window.__c={n:"SnackbarUndoButton"};const{onUndo:t}=e,n=(0,i.O7)();return(0,h.jsx)(b,{onClick:()=>{d.Yw(n,!0),p.rN(),null==t||t()},children:(0,h.jsx)(c.FormattedMessage,{defaultMessage:"Undo",id:"snackbar.undo.title"})})}function S(e){window.__c={n:"SuccessSnackbarButtons"};const{blockStoreToOpen:t,performUndo:n}=e,d=(0,i.O7)(),p=(0,r.yK)((e=>({icon:{fill:e.regularInvertedTextColor},wrap:{display:"flex",columnGap:8}})),[]),m=(0,o.useMemo)((()=>t?e=>{u.navigateToBlock({environment:d,openInNew:(0,f.DJ)(e),store:t,visitType:g.vu.Link,pageVisitSource:a.tY.ButtonAutomation})}:void 0),[t,d]);return(0,h.jsxs)("div",{style:p.wrap,children:[m&&(0,h.jsx)(b,{onClick:m,icon:e=>(0,s.g)({...e,...p.icon,width:16,height:16}),style:{paddingRight:0},children:(0,h.jsx)(c.FormattedMessage,{...v.open})}),n&&(0,h.jsx)(b,{onClick:n,icon:e=>(0,l.s)({...e,...p.icon,marginTop:-2,width:16,height:16}),children:(0,h.jsx)(c.FormattedMessage,{...v.undo})})]})}},99571:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(49271),i=n(76490),r=n(5366),a=n(33929),s=n(35328),l=n(85854),c=n(65187),d=n(17377),u=n(85893);const p=(0,r.defineMessages)({placeholder:{defaultMessage:"Heading 2",id:"subheaderBlock.placeholder"}});class m extends l.Z{constructor(){super(...arguments),this.getHeaderTextStyle=()=>{const{device:e}=this.environment,t=this.rootStorePageFont.state,n=e.isMobile?1.25:i.Lh;return(0,i.HV)({fontSizeValue:n,fontFamily:t})}}activate(){s.th(this)}renderPersisted(){const{disabled:e}=this.props;return(0,u.jsx)("div",{style:this.getStyle(),children:(0,u.jsxs)(d.Z,{blockComponent:this,toggleStyle:this.getToggleStyle(),childrenStyleWhenToggleable:{display:"flex"},children:[(0,u.jsx)(c.Z,{tagName:"h3",disabled:e,store:this.props.store.getBlockTitleStore(),placeholder:a.default.formatMessage(p.placeholder),placeholderStyle:{WebkitTextFillColor:this.theme.headerBlockPlaceholderTextColor},style:{...o.ZD,...this.getHeaderTextStyle()},pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),this.renderDiscussion()]})})}getStyle(){return{display:"flex",width:"100%",...this.getBlockColorStyle(),...this.props.style}}getToggleStyle(){const{device:e}=this.environment;return{height:`${(e.isMobile?1.25:i.Lh)*i.u9}em`,marginTop:e.isMobile?1:o.ZD.paddingTop,marginBottom:o.ZD.paddingBottom}}}const f=m},51704:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(49271),i=n(76490),r=n(5366),a=n(33929),s=n(35328),l=n(85854),c=n(65187),d=n(17377),u=n(85893);const p=(0,r.defineMessages)({placeholder:{defaultMessage:"Heading 3",id:"subsubheaderBlock.placeholder"}});class m extends l.Z{constructor(){super(...arguments),this.getHeaderTextStyle=()=>{const{device:e}=this.environment,t=this.rootStorePageFont.state,n=e.isMobile?1.17:i.C;return(0,i.Jr)({fontSizeValue:n,fontFamily:t})}}activate(){s.th(this)}renderPersisted(){const{disabled:e}=this.props;return(0,u.jsx)("div",{style:this.getStyle(),children:(0,u.jsxs)(d.Z,{blockComponent:this,toggleStyle:this.getToggleStyle(),childrenStyleWhenToggleable:{display:"flex"},children:[(0,u.jsx)(c.Z,{tagName:"h4",disabled:e,store:this.props.store.getBlockTitleStore(),placeholder:a.default.formatMessage(p.placeholder),placeholderStyle:{WebkitTextFillColor:this.theme.headerBlockPlaceholderTextColor},style:{...o.ZD,...this.getHeaderTextStyle()},pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),this.renderDiscussion()]})})}getStyle(){return{display:"flex",width:"100%",...this.getBlockColorStyle(),...this.props.style}}getToggleStyle(){const{device:e}=this.environment;return{height:`${(e.isMobile?1.17:i.C)*i.u9}em`,marginTop:.5}}}const f=m},40235:(e,t,n)=>{n.d(t,{Z:()=>c});n(67294);var o,i=n(83355),r=n(82990),a=n(64369),s=n(85893);class l extends i.Z{renderComponent(){const{columns:e,rows:t,cellStyle:n,tableStyle:o,hideHeader:i}=this.props;return(0,s.jsxs)("table",{style:{...this.getStyle(),...o},children:[!i&&(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{style:l.headerRowStyle,children:e.map((e=>(0,s.jsx)("th",{style:{...l.tableHeaderStyle,...e.style},children:(0,s.jsx)(a.Z,{isSmall:!0,children:e.header})},e.key)))})}),(0,s.jsx)("tbody",{children:t.map((t=>(0,s.jsx)("tr",{style:this.getRowStyle(),children:t.columns.map(((t,o)=>{const i=e[o];return(0,s.jsx)("td",{style:{...l.cellStyle,...n},children:t},i.key)}))},t.key)))})]})}getStyle(){return{width:"100%",fontSize:13,borderTop:`1px solid ${this.theme.regularDividerColor}`,borderBottom:`1px solid ${this.theme.regularDividerColor}`}}getRowStyle(){return{width:"100%",borderTop:`1px solid ${this.theme.regularDividerColor}`}}}o=l,l.displayName="TableBox",l.cellPaddingTopBottom=8,l.headerRowStyle={height:32,width:"100%"},l.tableHeaderStyle={fontWeight:r.Z.fontWeight.regular,textAlign:"left",paddingTop:o.cellPaddingTopBottom,paddingBottom:o.cellPaddingTopBottom},l.cellStyle={paddingTop:o.cellPaddingTopBottom,paddingBottom:o.cellPaddingTopBottom};const c=l},65187:(e,t,n)=>{n.d(t,{Z:()=>ce});var o=n(67294),i=n(83355),r=n(1302),a=n(41432),s=n(8848),l=n(22491),c=n(53877),d=n(42875),u=n(72126),p=n(62193),m=n(6746),f=n(21202),g=n(23867),h=n(70203),v=n(63143),b=n(5366),y=n(50906),S=n(14871),_=n(65770),w=n(97444),k=n(98724),I=n(56971),C=n(74284),x=n(17269),T=n(98104),M=n(32741),P=n(39699),A=n(1742),R=n(92022),D=n(48514),B=n(60682),E=n(82343),F=n(14976),Z=n(19124),L=n(62619),j=n(33929),V=n(68056),U=n(45162),O=n(73959),N=n(89086),z=n(66638),H=n(77907),W=n(8949),q=n(16772),G=n(66949),K=n(77080),$=n(69316),Q=n(52689),Y=n(23178),J=n(19111),X=n(35661),ee=n(10743),te=n(99757),ne=n(24666),oe=n(29595),ie=n(93262),re=n(42402),ae=n(85893);const se=(0,b.defineMessages)({typeTextPlaceholder:{defaultMessage:"Press ‘/’ for commands…",id:"text.commandsMenuNotOpen.placeholder"},typeAiTextPlaceholder:{defaultMessage:"Press ‘space’ for AI, ‘/’ for commands…",id:"text.commandsMenuNotOpen.placeholder.ai"},typeTextAiPlaceholder:{defaultMessage:"Press ‘/’ for commands, ‘space’ for AI…",id:"text.commandsMenuNotOpen.placeholder.textAi"},filterPlaceholder:{defaultMessage:"Type to filter…",id:"text.commandsMenuOpen.placeholder"}});class le extends i.Z{constructor(e){super(e),this.editor=null,this.mergeEditorRefs=(0,p.sH)(),this.triggeredAnalytics=!1,this.reminderTimers={},this.renderContentContainer=(e,t)=>(0,ae.jsx)(oe.Z,{...this.classNameAndStyleStore.state,onBlur:this.props.onBlur,onFocus:this.props.onFocus,getDisabled:this.getDisabled,spellCheck:!this.canExclusivelyComment(),getHtml:this.getHtml,getSelection:this.getContainerSelection,onMutation:this.handleMutation,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onSelect:t,placeholder:this.getCurrentPlaceholder(),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!0,disableContentEditableWhenNotEditingTextOnMobile:!0,id:this.props.id,tagName:this.props.tagName,...e,ref:this.mergeEditorRefs(this.handleEditorRef,e.leafRef)}),this.handleEditorRef=e=>{this.editor=e},this.handleCompositionStart=()=>{T.z9(this.environment,!0),this.props.onChange&&this.props.onChange()},this.isSpaceComposition=()=>{if(!this.shouldRenderInteractiveAiPlaceholder.state)return!1;const e=h.eeV(this.getTextValue());return 1===e.length&&("　"===e[0]||" "===e[0])},this.handleCompositionEnd=()=>{T.z9(this.environment,!1),(0,U.Aw)(this.environment)&&w.g2({environment:this.environment,store:this.props.store,usingMultiSelection:!0}),this.props.onChange&&this.props.onChange(),this.isSpaceComposition()?(0,R.hr)({from:"spacebar",environment:this.environment}):P.createAndCommit({userAction:"Text.runAllFiltersAfterCompositionEnd",environment:this.environment,perform:e=>{x.G({environment:this.environment,store:this.props.store,transaction:e})}})},this.handleDelete=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_delete");const{store:t}=this.props,n=ne.default.state;if("editing"===n.mode){const o=n.multiSelection;o.start.store===t&&P.createAndCommit({userAction:"Text.handleDelete",environment:this.environment,perform:t=>{I.as({environment:this.environment,multiSelection:o,deleteForwards:!0,transaction:t,event:e})}})}this.flushRenderQueue(),this.props.onChange&&this.props.onChange()},this.handleForwardDeleteAtEndOfLine=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const{store:t}=this.props,n=ne.default.state;if("editing"!==n.mode)return;const o=n.multiSelection;(0,V.iG)(o)&&(0,N.J_)(t,{startIndex:o.start.index,endIndex:o.end.index})&&this.handleDelete(e)},this.handleBackspace=e=>{if(!this.canEditStore.state||this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_backspace");const{store:t}=this.props,n=ne.default.state;if("editing"===n.mode){const o=n.multiSelection;if(o.start.store===t){if(I.YV({device:this.environment.device,event:e,multiSelection:o}))return;P.createAndCommit({userAction:"Text.handleBackspace",environment:this.environment,perform:t=>{I.as({environment:this.environment,multiSelection:o,deleteForwards:!1,transaction:t,event:e})}})}}this.flushRenderQueue(),this.props.onChange&&this.props.onChange()},this.handleEnter=e=>{if(!this.canEditStore.state)return;if(this.logTypingLag("typing_enter"),L.IL(e),this.editor&&this.editor.isComposing)return;const t=ne.default.state;if("editing"===t.mode)if(this.props.onEnter)this.props.onEnter(e);else{const{multiSelection:e}=t;P.createAndCommit({userAction:"Text.handleEnter",environment:this.environment,perform:t=>{C.IO({environment:this.environment,multiSelection:e,transaction:t})}}),this.flushRenderQueue()}this.props.onChange&&this.props.onChange(e)},this.handleShiftEnter=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const t=ne.default.state;if("editing"===t.mode){const{device:n}=this.environment;if(!("shiftKey"in e)||e.shiftKey&&!n.isIOS){if(this.props.disableShiftEnter)return;P.createAndCommit({userAction:"Text.handleShiftEnter",environment:this.environment,perform:e=>{w.hJ({environment:this.environment,string:"\n",multiSelection:t.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}}),this.props.onChange&&this.props.onChange(e)}else this.handleEnter(e)}},this.handleTab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_tab"),this.props.onTab){this.props.onTab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,O.sQ)(this.props.store);t&&(P.createAndCommit({userAction:"Text.handleTab",environment:this.environment,perform:e=>{w.n2({environment:this.environment,closestSelectable:t,shiftKey:!1,transaction:e})}}),this.flushRenderQueue())}this.props.onChange&&this.props.onChange()}},this.handleUntab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_untab"),this.props.onUntab){this.props.onUntab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,O.sQ)(this.props.store);t&&(P.createAndCommit({userAction:"Text.handleUntab",environment:this.environment,perform:e=>{w.n2({environment:this.environment,closestSelectable:t,shiftKey:!0,transaction:e})}}),this.flushRenderQueue())}this.props.onChange&&this.props.onChange()}},this.handleAnnotation=(e,t)=>{this.canEditStore.state&&(t.preventDefault(),k.aS({environment:this.environment,annotation:e}),this.flushRenderQueue(),this.props.onChange&&this.props.onChange(),y.duO(this.environment,{type:h.J7s(e)}))},this.handleToggleHighlight=e=>this.handleAnnotation(["h",Q.Z.state.color],e),this.handleToggleBold=e=>this.handleAnnotation(["b"],e),this.handleToggleItalics=e=>this.handleAnnotation(["i"],e),this.handleToggleStrike=e=>this.handleAnnotation(["s"],e),this.handleToggleUnderline=e=>this.handleAnnotation(["_"],e),this.handleToggleCode=e=>this.handleAnnotation(["c"],e),this.handleClick=e=>{this.handleClickActions(e),this.props.onClick&&this.props.onClick(e)},this.handleContextMenu=e=>{const t=this.parentBlockStore.state;t&&F.li({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:t,canEdit:this.canEditStore.state})},this.handleMouseOver=e=>{F.vO({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleMouseOut=e=>{F.kV({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleCopy=e=>{this.props.onCopy?this.props.onCopy(e):S.JG({environment:this.environment,event:e,markdownLinkifyIt:this.props.markdownLinkifyIt})},this.handleCut=e=>{if(this.canEditStore.state){if(this.props.onCut)return this.props.onCut(e),void this.flushRenderQueue();S.by({environment:this.environment,event:e,markdownLinkifyIt:this.props.markdownLinkifyIt}),this.flushRenderQueue(),this.props.onChange&&this.props.onChange()}else e.preventDefault()},this.handlePaste=e=>{this.canEditStore.state&&(P.createAndCommit({userAction:"Text.handlePaste",environment:this.environment,perform:t=>{S.v({environment:this.environment,event:e,disableEmbedMenu:Boolean(this.props.disableEmbedMenu),transaction:t,onPasteFiles:this.props.onPasteFiles||S.AL,markdownLinkifyIt:this.props.markdownLinkifyIt,tinyMceMicrosoftWordPasteFilter:this.props.tinyMceMicrosoftWordPasteFilter})}}),this.flushRenderQueue(),this.props.onChange&&this.props.onChange())},this.handleKeyPress=e=>{if(" "===e.key&&!e.shiftKey&&!e.ctrlKey&&!e.altKey&&!this.getTextValue()&&this.shouldRenderInteractiveAiPlaceholder.state)return e.preventDefault(),void(0,R.hr)({from:"spacebar",environment:this.environment});this.canEditStore.state||e.metaKey&&"c"===e.key||e.preventDefault()},this.handleMoveUp=e=>{e.preventDefault(),P.createAndCommit({userAction:"Text.handleMoveUp",environment:this.environment,perform:e=>{w.fs({environment:this.environment,transaction:e,direction:"up"})}})},this.handleMoveDown=e=>{P.createAndCommit({userAction:"Text.handleMoveDown",environment:this.environment,perform:e=>{w.fs({environment:this.environment,transaction:e,direction:"down"})}})},this.aiTextPlaceholderMessage=this.createComputedStore((()=>"on"===K.default.getEligibleGroup({experimentId:"prioritize_slash_menu_block_placeholder",defaultGroup:"control"})?j.default.formatMessage(se.typeTextAiPlaceholder):j.default.formatMessage(se.typeAiTextPlaceholder)),!1,"aiTextPlaceholderMessageStore"),this.canEditStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(te.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return(!this.props.isDiscussionInput||null==e||!e.hasPublicPermission||"view"!==e.permission)&&(!(!this.props.isDiscussionInput&&null!=e&&e.hasPublicPermission&&"edit"!==e.permission)&&this.props.store.canEdit())}),!1,"canEditStore"),this.getDisabled=()=>!this.canEditStore.state,this.getDefaultTruncateElement=()=>(0,ae.jsxs)(re.Z,{disableUnderline:!0,style:{color:this.theme.mediumTextColor},onClick:e=>{e.preventDefault(),e.stopPropagation()},children:["…"," ",(0,ae.jsx)("span",{children:(0,ae.jsx)(b.FormattedMessage,{id:"text.truncated.showMoreLabel",defaultMessage:"more"})})]}),this.getHtml=()=>{var e;let t=this.getTextValue(),n=!1;if(this.props.canTruncate&&void 0!==this.props.maxChars){h.eeV(t).length>this.props.maxChars&&(t=h.KU1(this.getTextValue(),0,this.props.maxChars),n=!0)}const i=F.IY({environment:this.environment,textValue:t&&{value:t,spaceId:(0,g.C)(this.props.store.pointer.spaceId)},parentStore:this.props.parentStore||this.props.store,disableHover:!1,disableStyleAnnotations:Boolean(this.props.disableStyleAnnotations),disableDateStyleAnnotations:Boolean(this.props.disableDateMentions),disabled:!this.canEditStore.state,theme:this.theme,emojiType:(0,B.e_)(this.environment),katex:this.environment.KatexStore.getKatex(),parentBlockId:this.getParentBlockId(),renderedPageBlockId:null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.id,formulaValueTypes:[],useExperimentalLinksToNonPageBlocks:this.useExperimentalLinksToNonPageBlocks.state}),r=(0,ae.jsxs)(o.Fragment,{children:[i,n&&this.getDefaultTruncateElement()]});return m.Z.renderToStaticMarkup(r)},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.getTextValue=()=>F.Rl({store:this.props.store,textValue:this.getTextValueHelper()}),this.getTextValueHelper=()=>{if(this.isNewDiscussionMenuTarget.state)return F.Gj({store:this.props.store});if(this.isInlineEquationOverlayTarget.state)return F.PY({store:this.props.store,equationStore:G.Z});if(this.isMentionMenuTarget.state)return F.Ob({store:this.props.store,mentionMenuState:this.isMentionMenuTarget.state});if(this.linkingMenuSelectionStore.state)return F.So({store:this.props.store,selection:this.linkingMenuSelectionStore.state});if(this.findAndReplaceStore.state){const e=this.findAndReplaceStore.state;return F.cD({store:this.props.store,find:e})}if(this.isCompletionPopupTarget.state)return F.fm({store:this.props.store,temporaryAnnotation:h.GKr.TemporarySelection,multiSelection:this.getCompletionTextSelection()});const e=this.pageAnnotationBlockMenuStore.state;if(e)return e;if(this.isEditing.state){const e=ne.default.state;if("editing"===e.mode){const t=(0,V.QY)(e.multiSelection);if(t)return F.xX({store:this.props.store,selection:t.selection})}}return this.props.store.getValue()},this.useExperimentalLinksToNonPageBlocks=this.createComputedStore((()=>K.default.checkGate("experimental_non_page_block_links")),!1,"useExperimentalLinksToNonPageBlocks"),this.parentBlockStore=this.createComputedStore((()=>{const{store:e}=this.props;if(e.pointer.table===f.iU)return X.G.createChildStore(e,e.pointer)}),!1,"parentBlockStore"),this.isEditing=this.createComputedStore((()=>(0,N.J5)(this.props.store)),!1,"isEditing"),this.isSelectionEndpoint=this.createComputedStore((()=>(0,N.Gq)(this.props.store)),!1,"isSelectionEndpoint"),this.isCompletionsEnabledStore=this.createComputedStore((()=>{var e;const t=null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state;return(0,Z.GD)(t)}),!1,"isCompletionsEnabledStore"),this.shouldRenderInteractiveAiPlaceholder=this.createComputedStore((()=>{if(this.environment.device.isMobile||this.environment.device.isMobileNative)return!1;if(this.props.disabled)return!1;if(!this.isCompletionsEnabledStore.state)return!1;const e=this.parentBlockStore.state,t=e&&e.getType();return Boolean(t&&(0,a.hD)(t))&&"contains-selection"===this.isEditing.state&&!(e&&(0,E.td)(e))}),!1,"shouldRenderInteractiveAiPlaceholder"),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{const e=D.Z.state;return e.open&&"inline"===e.type&&Boolean((0,U.r)(e.multiSelection,this.props.store))}),!1,"isNewDiscussionMenuTarget"),this.isCompletionPopupTarget=this.createComputedStore((()=>{const e=this.getCompletionTextSelection();return e&&Boolean((0,U.r)(e,this.props.store))}),!1,"isCompletionPopupTarget"),this.isInlineEquationOverlayTarget=this.createComputedStore((()=>{var e;return G.Z.isOpen()&&(null===(e=(0,V.QY)(G.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store)===this.props.store}),!1,"isInlineEquationOverlayTarget"),this.isMentionMenuTarget=this.createComputedStore((()=>{const e=J.Z.state;return!!e.open&&(e.textStore===this.props.store&&e)}),!1,"isMentionMenuTarget"),this.linkingMenuSelectionStore=this.createComputedStore((()=>{const e=Y.Z.state;if(!e.open)return!1;if(!e.focusLinkInput&&!e.focusTitleInput)return!1;if(!this.isEditing.state)return!1;const t=(0,V.QY)(e.savedTextSelectionState.multiSelection);return!!t&&t.selection}),!1,"linkingMenuSelectionStore"),this.findAndReplaceStore=this.createComputedStore((()=>{const e=$.Z.state;return e.open&&e.findQuery.length>0?e.findQuery:void 0})),this.pageAnnotationBlockMenuStore=this.createComputedStore((()=>{const e=W.Z.state;if(!e.isActive)return;const{clickedPageAnnotation:t}=e;if(!t)return;const{parentStore:n,pageAnnotation:o}=t;if(n!==this.parentBlockStore.state)return;const i=this.props.store.getValue();return i?null==i?void 0:i.map((e=>h.km_(e)?[e[0],e[1].flatMap((e=>h.STW(e)&&e===o?[o,h.EPB()]:[e]))]:e)):void 0}),!1,"pageAnnotationBlockMenuStore"),this.getContainerSelection=()=>{const e=Boolean(this.linkingMenuSelectionStore.state);if((0,U.Aw)(this.environment)&&this.isSelectionEndpoint.state){if(e)return;return(0,N.HE)(this.props.store)}if(this.isEditing.state&&!e){const{store:e}=this.props,t=ne.default.state;if("editing"===t.mode){const n=(0,U.xI)("Text",t.multiSelection);if(n){const{selection:t}=n,o=e.getValue(),i=h.eeV(o).length;return{type:"contain",selection:{startIndex:Math.min(t.startIndex,i),endIndex:Math.min(t.endIndex,i)}}}}}},this.getEndSelection=()=>{const e=h.eeV(this.getTextValue());return{startIndex:e.length,endIndex:e.length}},this.classNameAndStyleStore=this.createComputedStore((()=>(0,l.iv)(this.getStyle(),this.props.className)),!1,"classNameAndStyleStore"),this.handleMutation=this.handleMutation.bind(this)}willMountOrUpdate(){this.createReminderTimers(),this.environment.KatexStore.loadIfNeeded(this.getTextValue)}willUnmount(){this.clearReminderTimers(),M.qA(this.props.store)}isComposing(){return this.editor&&this.editor.isComposing}createReminderTimers(){const e=this.getTextValue(),t=h.nai(e),n=u.oA(t.map((e=>{const t=(0,c.KR)(e,(0,d.r)());return null==t?void 0:t.toMillis()}))),o=Date.now();for(const i of n){const e=i-o;e>0&&e<v.A0&&(i in this.reminderTimers||(this.reminderTimers[i]=setTimeout(this.enqueueForceUpdate,e)))}for(const i in this.reminderTimers)n.includes(parseInt(i))||(clearTimeout(this.reminderTimers[i]),delete this.reminderTimers[i])}clearReminderTimers(){for(const e in this.reminderTimers)clearTimeout(this.reminderTimers[e]),delete this.reminderTimers[e]}renderComponent(){const{disableInsertText:e,disableStyleAnnotations:t,disableSelectAllBlocks:n,disableSelectionDrag:o,disableDrag:i,disabled:r}=this.props;return(0,ae.jsx)(ie.Z,{...this.props,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.getEndSelection,canInsertText:!r&&!e,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onDelete:this.handleDelete,onDeleteToEndOfLine:this.handleForwardDeleteAtEndOfLine,onDeleteNextWord:this.handleForwardDeleteAtEndOfLine,onBackspace:this.handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onTab:this.handleTab,onUntab:this.handleUntab,onToggleHighlight:this.handleToggleHighlight,onToggleBold:this.handleToggleBold,onToggleItalics:this.handleToggleItalics,onToggleStrike:this.handleToggleStrike,onToggleUnderline:this.handleToggleUnderline,onToggleCode:this.handleToggleCode,onCopy:this.handleCopy,onCut:this.handleCut,onPaste:this.handlePaste,onKeyPress:this.handleKeyPress,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,render:this.renderContentContainer,disableAnnotation:t,canSelectAllBlocks:!n,canSelectionDrag:!o,disableDrag:i,topBottomPadding:9})}getCurrentPlaceholder(){const{device:e}=this.environment;if(this.shouldRenderInteractiveAiPlaceholder.state)return this.aiTextPlaceholderMessage.state;if(this.props.placeholder)return this.props.placeholder;if(!this.props.disabled){if(!this.props.disableSlashCommands&&"contains-selection"===this.isEditing.state&&this.canEditStore.state){if(ee.Z.state.open)return j.default.formatMessage(se.filterPlaceholder);if(!e.isMobile)return j.default.formatMessage(se.typeTextPlaceholder)}return" "}}handleMutation(e){if(this.logTypingLag("typing_lag"),!this.canEditStore.state)return;(0,U.Aw)(this.environment)?P.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{let n=this.props.store;const{multiSelection:o}=e;if(o&&!(0,V.qS)(o))n=o.start.store;else if(this.props.legacyTransclusionParent&&!e.insertedLine&&!e.isComposing&&!e.deletedLine){const e=_.Z2({environment:this.environment,store:n,parentStore:this.props.legacyTransclusionParent,transaction:t});e&&(n=e)}if(w.YV({environment:this.environment,store:n,newValue:e.newValue,disableMentions:Boolean(this.props.disableMentions),disableDateMentions:Boolean(this.props.disableDateMentions),disableDateReminderMentions:Boolean(this.props.disableDateReminderMentions),disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableFilters:e.isComposing,disableTemplateVariableMentions:Boolean(this.props.disableTemplateVariableMentions),transaction:t,multiSelection:o}),e.insertedLine){const e="editing"===ne.default.state.mode&&ne.default.state.multiSelection;e&&C.IO({environment:this.environment,multiSelection:e,transaction:t})}this.props.trackEditsToUserFlow&&!t.isEmpty()&&A.uO(this.environment,this.props.trackEditsToUserFlow,t)}}):P.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{w.aS({environment:this.environment,store:this.props.store,newValue:e.newValue,disableMentions:Boolean(this.props.disableMentions),disableDateMentions:Boolean(this.props.disableDateMentions),disableDateReminderMentions:Boolean(this.props.disableDateReminderMentions),disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableTemplateVariableMentions:Boolean(this.props.disableTemplateVariableMentions),disableFilters:e.isComposing,transaction:t})}});const{store:t}=this.props,n=this.parentBlockStore.state;if(n){if(n.getType()){const e=n.getSchema()||{};if("properties"===t.path[0]&&t.path[1]){e[t.path[1]]&&!this.triggeredAnalytics&&(this.triggeredAnalytics=!0)}}}this.props.onChange&&this.props.onChange()}handleClickActions(e){F.SD({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state,disableEquationInteraction:this.props.disableEquationInteraction})}canComment(){return!this.props.disabled&&this.props.store.canComment()}canExclusivelyComment(){return this.canComment()&&!this.canEditStore.state}focus(){this.isEditing.state||T.NX({store:this.props.store})}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}getCompletionTextSelection(){const e=q.default.state;return("closedWithContext"===e.type||"completionPopup"===e.type&&"initialPromptForAIBlock"!==e.stage)&&"textSelection"===e.context.type?e.context.textSelection:void 0}getParentBlockId(){const{store:e}=this.props;if(e.table===f.iU)return e.id;const{ancestor:t}=e.findRecordStoreUIAncestor((e=>{let{table:t}=e;return t===f.iU}));return t?t.id:void 0}isEmpty(){return 0===h.lzi(this.getTextValue()).length}logTypingLag(e){const t=!this.props.disabled&&"inline"===this.props.pasteBehavior;(0,z.u)({type:e,environment:this.environment,blockStore:this.parentBlockStore.state,store:this.props.store,isInCollectionView:t})}flushRenderQueue(){r.default.flush()}getStyle(){const{device:e}=this.environment;let t={maxWidth:"100%",width:"100%",whiteSpace:"pre-wrap",wordBreak:"break-word",caretColor:this.canExclusivelyComment()?s.ZP.transparent:this.theme.regularTextColor,...this.props.style};return this.isEmpty()&&(t.minHeight="1em",t={...t,color:this.theme.regularTextColor,WebkitTextFillColor:this.theme.lightTextColor,...this.props.placeholderStyle}),e.isMobile&&this.canEditStore.state&&(this.isEditing.state?t.WebkitUserModify="read-write-plaintext-only":(t.userSelect="none",t.WebkitUserSelect="none",t.whenFocusedEditable={userSelect:"text",WebkitUserSelect:"text",WebkitUserModify:"read-write-plaintext-only"})),t}}le.displayName="Text";const ce=o.forwardRef((function(e,t){const{value:n}=(0,H.useDependency)(H.deps.markdownLinkifyIt),{value:o}=(0,H.useDependency)(H.deps.tinyMceMicrosoftWordPasteFilter);return(0,ae.jsx)(le,{...e,ref:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}))},17970:(e,t,n)=>{n.d(t,{Z:()=>d});n(67294);var o=n(49271),i=n(77080),r=n(85854),a=n(55217),s=n(65187),l=n(85893);class c extends r.Z{renderPersisted(){const{store:e,hideContent:t,disabled:n}=this.props;return(0,l.jsxs)("div",{style:this.getStyle(),children:[(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsx)(s.Z,{style:o.ZD,placeholderStyle:this.getPlaceholderStyle(),disabled:n,store:e.getBlockTitleStore(),pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent,trackEditsToUserFlow:"user_flow_edit_block"}),this.renderDiscussion()]}),!t&&this.renderContent()]})}renderContent(){const{store:e,disabled:t}=this.props,n=e.getContentStore();return(n.getValue()||[]).length>0?(0,l.jsx)("div",{style:c.listStyle,children:(0,l.jsx)(a.Z,{disabled:t,store:n,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})}):(0,l.jsx)(a.Z,{disabled:!0,store:n})}getBlockAlignment(){if(!i.default.checkGate("text_align"))return{};const{block_alignment:e}=this.props.store.getFormat();switch(e){case"right":case"center":return{textAlign:this.props.store.getFormat().block_alignment};default:return{textAlign:"left"}}}getPlaceholderStyle(){if(!i.default.checkGate("text_align"))return{};const{block_alignment:e}=this.props.store.getFormat();switch(e){case"center":return{textAlign:"left",paddingLeft:"50%"};case"right":return{textAlign:"right"};default:return{textAlign:"left"}}}getStyle(){return{...this.getBlockAlignment(),...this.getBlockColorStyle(),...this.props.style}}}c.listStyle={paddingLeft:"1.5em",display:"flex",flexDirection:"column"};const d=c},11620:(e,t,n)=>{n.d(t,{Z:()=>w});n(67294);var o=n(53150),i=n(49271),r=n(80951),a=n(72126),s=n(5366),l=n(50906),c=n(9953);var d=n(39699),u=n(33929),p=n(27724),m=n(85854),f=n(7825),g=n(60458),h=n(55217),v=n(78454),b=n(65187),y=n(85893);const S=(0,s.defineMessages)({placeholder:{defaultMessage:"To-do",id:"todoBlock.placeholder"}});class _ extends m.Z{constructor(){super(...arguments),this.labelAriaId=(0,o.Z)(),this.handleCheckboxClick=e=>{this.toggleChecked()}}activate(){this.toggleChecked()}renderPersisted(){return(0,y.jsxs)(v.ZP,{style:this.getStyle(),left:this.renderCheckbox(),childrenStyle:{display:"flex",flexDirection:"column"},children:[(0,y.jsxs)("div",{style:{display:"flex"},children:[this.renderTitle(),this.renderDiscussion({style:f.Z.discussionIndicatorStyle})]}),!this.props.hideContent&&this.renderContent()]})}renderCheckbox(){return(0,y.jsx)(g.Z,{"aria-labelledby":this.labelAriaId,checked:this.isChecked(),onClick:this.handleCheckboxClick,disabled:!this.canEdit(),size:16,fill:this.getBlockColorStyle().color,tapArea:this.environment.device.isMobile?{size:30}:void 0})}renderTitle(){return(0,y.jsx)(b.Z,{id:this.labelAriaId,style:this.getTitleStyle(),disabled:this.props.disabled,store:this.props.store.getBlockTitleStore(),placeholder:u.default.formatMessage(S.placeholder),pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent})}renderContent(){const{disabled:e}=this.props;return(0,y.jsx)(h.Z,{disabled:e,store:this.props.store.getContentStore(),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})}isChecked(){const e=this.props.store.getProperties();return!!e&&r.Ml(e.checked)}toggleChecked(){if(this.canEdit()){let e;e=a.q9(p.default.state.stores,this.props.store)?p.default.state.stores:[this.props.store],this.isChecked()?d.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:this.environment,perform:t=>{!function(e){const{environment:t,blocks:n,transaction:o}=e;for(const i of n)c.sW({store:i.getPropertiesStore(),data:{checked:r._I(!1)},transaction:o});l.JrP(t,{is_checked:!1})}({environment:this.environment,blocks:e,transaction:t})}}):d.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:this.environment,perform:t=>{!function(e){const{blocks:t,transaction:n,environment:o}=e;for(const i of t)c.sW({store:i.getPropertiesStore(),data:{checked:r._I(!0)},transaction:n});l.JrP(o,{is_checked:!0})}({environment:this.environment,blocks:e,transaction:t})}})}}getStyle(){return{paddingLeft:i.ZD.paddingLeft,...this.getBlockColorStyle(),...this.props.style}}getTitleStyle(){return{...v.R8,width:void 0,flexGrow:1,...this.isChecked()&&{textDecoration:"line-through",textDecorationColor:this.theme.strikethroughLineColor,opacity:1,color:this.theme.mediumTextColor}}}}const w=_},4859:(e,t,n)=>{n.d(t,{Z:()=>x});n(67294);var o=n(53150),i=n(49271),r=n(72126),a=n(5366),s=n(50906),l=n(29373),c=n(39699),d=n(28020),u=n(33929),p=n(52315),m=n(77080),f=n(27724),g=n(45131),h=n(85854),v=n(64921),b=n(25777),y=n(55217),S=n(78454),_=n(65187),w=n(5210),k=n(85893);const I=(0,a.defineMessages)({placeholder:{defaultMessage:"Toggle",id:"toggleBlock.placeholder"}});class C extends h.Z{constructor(){super(...arguments),this.descriptionAriaId=(0,o.Z)(),this.contentAriaId=(0,o.Z)(),this.isOpen=this.createComputedStore((()=>g.Z.isOpen(this.props.store.id)&&!this.props.hideContent)),this.isEmpty=this.createComputedStore((()=>!this.props.store.hasContent())),this.handlePlaceholderClick=()=>{c.createAndCommit({userAction:"ToggleBlock.handlePlaceholderClick",environment:this.environment,perform:e=>{l.ls({environment:this.environment,store:this.props.store,transaction:e})}})},this.handleToggleButtonClick=e=>{if(e.shiftKey){const e=d.np();e&&l.X_(this.environment,e)}else this.toggle()}}activate(){this.toggle()}willMount(e){l.nz({blockId:e.store.id,currentUserId:this.environment.currentUser.id}),e.store.isDefaultRecordCache()&&l.LO(this.environment,e.store.pointer)}renderPersisted(){const{store:e,disabled:t}=this.props,n=this.isOpen.state,o=e.getBlockTitleStore();return(0,k.jsxs)(S.ZP,{style:this.getStyle(),left:this.renderToggleButton(),leftStyle:{paddingRight:2},children:[(0,k.jsxs)("div",{style:{display:"flex"},children:[(0,k.jsx)(_.Z,{id:this.descriptionAriaId,style:S.R8,disabled:t,store:o,placeholder:u.default.formatMessage(I.placeholder),pasteBehavior:"block"}),this.renderDiscussion({style:C.discussionIndicatorStyle,recursivelyLoadAllDiscussions:!this.isOpen.state})]}),n&&this.renderContent(),!n&&(0,k.jsx)(y.Z,{store:this.props.store.getContentStore(),disabled:t,disableContent:!0})]})}renderToggleButton(){return(0,k.jsx)(w.Z,{"aria-describedby":this.descriptionAriaId,"aria-controls":this.contentAriaId,isSidebar:!1,open:this.isOpen.state,fill:!this.isEmpty.state,onClick:this.handleToggleButtonClick,tapArea:this.environment.device.isMobile?{size:30}:void 0})}renderContent(){const{disabled:e,store:t}=this.props,n=p.b(t)||!t.isDefaultRecordCache(),o=m.default.checkGate("layout_toggles");return(0,k.jsx)(b.Z,{id:this.contentAriaId,loaded:n,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:C.getContentStyle(o),style:C.getContainerStyle(o),children:(0,k.jsx)(y.Z,{store:this.props.store.getContentStore(),emptyPlaceholder:this.renderPlaceHolder(),disabled:e,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})}renderPlaceHolder(){const{disabled:e}=this.props;return(0,k.jsx)(v.Z,{style:this.getPlaceholderButtonStyle(),onClick:this.handlePlaceholderClick,disabled:e,children:(0,k.jsx)("span",{style:{color:this.theme.lightTextColor},children:(0,k.jsx)(a.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlock.emptyBlock.placeholderText"})})})}toggle(){let e;e=r.q9(f.default.state.stores,this.props.store)?f.default.state.stores:[this.props.store];const t=!this.isOpen.state;for(const n of e)l.rd({blockId:n.id,state:t,currentUserId:this.environment.currentUser.id});s.jRT(this.environment,{is_toggled:t})}getStyle(){return{paddingLeft:i.ZD.paddingLeft,...this.getBlockColorStyle(),...this.props.style}}getPlaceholderButtonStyle(){return{fontSize:"inherit",width:"100%",borderRadius:3,caretColor:this.theme.lightTextColor,...i.ZD,marginTop:2}}static getContainerStyle(e){return e?{display:"flex"}:void 0}static getContentStyle(e){return e?{display:"flex",flexDirection:"column",width:"100%"}:{display:"flex",flexDirection:"column"}}}C.discussionIndicatorStyle={paddingLeft:0,marginLeft:-6,paddingBottom:2};const x=C},5210:(e,t,n)=>{n.d(t,{Z:()=>m,q:()=>u});var o=n(67294),i=n(480),r=n(24405),a=n(17693),s=n(91),l=n(5366),c=n(64921),d=n(85893);function u(e){let{isSidebar:t,isMobile:n}=e;return t&&!n?20:24}const p=(0,l.defineMessages)({open:{defaultMessage:"Open",id:"toggleButton.open"},close:{defaultMessage:"Close",id:"toggleButton.close"}});function m(e){window.__c={n:"ToggleButton"};const t=(0,i.Fy)(),n=(0,l.useIntl)(),m=(0,o.useMemo)((()=>u({isSidebar:e.isSidebar,isMobile:t.isMobile})),[t.isMobile,e.isSidebar]),f=(0,r.yK)((()=>{const n=e.color||"inherit",o="chevron"===e.icon?`rotateZ(${e.open?0:-90}deg)`:`rotateZ(${e.open?180:90}deg)`,i="chevron"===e.icon,r=i&&t.isMobile;return{button:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:m,height:m,borderRadius:3,...e.style},arrow:{width:r?14:i?12:"0.6875em",height:r?14:i?12:"0.6875em",transition:"transform 200ms ease-out",transform:o,fill:n,opacity:e.fill?1:.5}}}),[t.isMobile,e.color,e.fill,e.icon,e.open,e.style,m]),g=(0,o.useMemo)((()=>{switch(e.icon){case"chevron":return(0,a.A)(f.arrow);case"triangle":default:return(0,s.L)(f.arrow)}}),[e.icon,f.arrow]);return(0,d.jsxs)(c.Z,{ariaLabel:e.open?n.formatMessage(p.close):n.formatMessage(p.open),"aria-describedby":e["aria-describedby"],"aria-expanded":e.open,"aria-controls":e.open?e["aria-controls"]:void 0,style:f.button,onClick:e.onClick,onMouseDown:e.onMouseDown,disabled:e.disabled,allowShiftClick:!0,children:[e.tapArea&&(0,d.jsx)("div",{style:{position:"absolute",opacity:0,width:e.tapArea.size,height:e.tapArea.size,top:-(e.tapArea.size-m)/2,left:-(e.tapArea.size-m)/2}}),g]})}},85567:(e,t,n)=>{n.d(t,{Z:()=>h});var o=n(67294),i=n(83355),r=n(84939),a=n(8848),s=n(84619),l=n(19525),c=n(82990),d=n(43224),u=n(4023),p=n(64921),m=n(26388),f=n(85893);class g extends i.Z{constructor(){super(...arguments),this.tokenTextRef=o.createRef(),this.shouldShowFullValueTooltip=()=>Boolean(this.props.showFullValueTooltip&&this.tokenTextRef.current&&this.tokenTextRef.current.offsetWidth<this.tokenTextRef.current.scrollWidth)}renderComponent(){const e=this.theme;if(this.props.showFullValueTooltip||void 0!==this.props.tooltip)return(0,f.jsx)(m.Z,{placement:this.props.tooltipPlacement??u.u.Right,renderTooltip:t=>(0,f.jsxs)("div",{...t,style:d.F,children:[this.props.showFullValueTooltip&&(0,f.jsx)("div",{children:this.props.value}),void 0!==this.props.tooltip&&(0,f.jsx)("div",{style:{color:this.props.showFullValueTooltip?e.mediumInvertedTextColor:void 0},children:this.props.tooltip})]}),originGap:20,textWrap:!0,render:e=>(0,f.jsx)("div",{style:this.getStyle(),...e,onMouseEnter:t=>{(this.shouldShowFullValueTooltip()||void 0!==this.props.tooltip)&&e.onMouseEnter&&e.onMouseEnter(t)},children:this.renderTokenContent()})});if(this.props.onClick){const e=this.props.backgroundColor?{background:(0,r._j)(this.props.backgroundColor,1)}:void 0,t=this.props.backgroundColor?{background:(0,r._j)(this.props.backgroundColor,2)}:void 0;return(0,f.jsx)(p.Z,{style:this.getStyle(),hoveredStyle:e,pressedStyle:t,onClick:this.props.onClick,children:this.renderTokenContent()})}return(0,f.jsx)("div",{style:this.getStyle(),children:this.renderTokenContent()})}renderTokenContent(){const{height:e}=s.Z.styles[this.props.format];return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{style:{...this.props.shouldWrap?{overflowWrap:"anywhere"}:c.Z.textOverflowStyle,textDecoration:this.props.isStrikedThrough?"line-through":void 0,display:"inline-flex",alignItems:"center",height:e,lineHeight:`${e}px`},children:[this.renderColoredDot(),(0,f.jsx)("span",{style:{...c.Z.textOverflowStyle},ref:this.tokenTextRef,children:this.props.value})]}),this.renderRemoveButton()]})}renderColoredDot(){if(this.props.showColoredDot)return(0,f.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,f.jsx)("div",{style:this.getDotStyle(this.props.showColoredDot)})})}renderRemoveButton(){const{height:e,removeIconSize:t}=s.Z.styles[this.props.format];if(this.props.showRemoveButton)return(0,f.jsx)(p.Z,{onClick:this.props.onClickRemove,style:{...g.removeButtonStyle,width:e,height:e},disabled:this.props.disabled,disabledFeedback:!1,mobileFeedback:!0,className:"notion-token-remove-button",children:(0,l.b)({width:t,height:t,opacity:.5})})}getStyle(){const{format:e,isSingle:t,shouldShrink:n,isRound:o,shouldWrap:i}=this.props,{height:r,fontSize:l,paddingLeftRight:c,margin:d}=s.Z.styles[e],{ThemeStore:u}=this.environment,p=o?c+1:c;return{display:t?"inline-flex":"flex",alignItems:"center",flexShrink:t||n?1:0,minWidth:0,maxWidth:"100%",height:r,borderRadius:o?r/2:3,paddingLeft:p,paddingRight:this.props.showRemoveButton?0:o?p+2:p,fontSize:l,lineHeight:"120%",opacity:this.props.disabled&&this.props.disabledFeedback?.4:void 0,color:this.props.color||("light"===u.state.mode?this.theme.regularTextColor:a.ZP.whiteWithAlpha(.7)),background:this.props.backgroundColor||this.theme.legacyDefaultSelectColor,margin:t?0:d,...i&&{height:void 0,paddingTop:4,paddingBottom:4},...this.props.style}}getDotStyle(e){const{format:t}=this.props,{dotSize:n}=s.Z.styles[t],o="default"===e?"gray":e;return void 0===o?{}:{marginRight:5,borderRadius:99,height:n,width:n,backgroundColor:"light"===this.theme.mode?this.theme.accentColors[o][400]:this.theme.accentColors[o][700],display:"inline-flex",flexShrink:0}}}g.displayName="Token",g.removeButtonStyle={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,marginLeft:2,marginRight:2};const h=g},91791:(e,t,n)=>{n.d(t,{Z:()=>he});var o=n(45697),i=n.n(o),r=n(67294),a=n(83355),s=n(13991),l=n(49085),c=n(15145),d=n(41432),u=n(8848),p=n(9999),m=n(42853),f=n(61061),g=n(44495),h=n(54497),v=n(26825),b=n(27006),y=n(82990),S=n(51454),_=n(5366),w=n(50906),k=n(14871),I=n(47307),C=n(24677),x=n(64964),T=n(98104),M=n(29373),P=n(39699),A=n(95477),R=n(80365),D=n(35683),B=n(84210),E=n(12534),F=n(87290),Z=n(33929),L=n(87279),j=n(39500),V=n(67669),U=n(18514),O=n(89224),N=n(61766),z=n(88632),H=n(55367),W=n(80796),q=n(61738),G=n(22294),K=n(88923),$=n(35661),Q=n(69784),Y=n(49557),J=n(77933),X=n(4350),ee=n(85854),te=n(13966),ne=n(23063),oe=n(64921),ie=n(31945),re=n(84076),ae=n(78140),se=n(76798),le=n(72495),ce=n(83182),de=n(29551),ue=n(55217),pe=n(79954),me=n(85893);const fe=(0,_.defineMessages)({copySuccessMessage:{defaultMessage:"Copied! Now paste in any page to sync content.",id:"transclusionContainerBlock.actions.copySuccessMessage"}});class ge extends ee.Z{constructor(){super(...arguments),this.storeTypes={hovered:l.default.createClass(!1),haloShouldBeVisible:l.default.createClass(!1),actionBarShouldBeVisible:l.default.createClass(!1),backlinksIndicatorButtonPopupStore:N.Z},this.fakeSelectionTrapRef=r.createRef(),this.renderHaloContent=()=>(0,me.jsx)("div",{style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:6,border:`2px solid ${this.theme.transclusionBorderColor}`}}),this.renderActionBarContent=()=>{const e=this.numberOfBacklinks.state,t=z.Z.state.online,n=this.hasDifferingReadPermissionsFromSource.state,{isDesktop:o}=this.environment.device;return(0,me.jsxs)("div",{style:this.getActionBarStyle(),children:[t&&(0,me.jsx)(ie.ZP,{popupType:ie.Z4.Popup,onClick:this.handleActionBarBacklinksClick,originGap:4,renderOrigin:t=>(0,me.jsxs)(oe.Z,{style:this.getActionButtonStyle(),...t,children:[e>0?(0,me.jsx)(_.FormattedMessage,{defaultMessage:"Editing in {icon} {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}",id:"transclusionContainerBlock.editingMultiple",values:{icon:(0,p.J)({width:14,transform:"rotate(180deg)",marginLeft:4,marginRight:4}),numberOfBacklinks:e}}):(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.editingOriginal",defaultMessage:"Editing original"}),n&&(0,h.t)({width:14,fill:(0,u.fi)("orange",this.theme).fill,marginLeft:6}),(0,m.i)({width:10,fill:this.theme.mediumIconColor,marginLeft:4})]}),render:this.renderBacklinksMenu}),o&&(0,me.jsx)(oe.Z,{style:this.getActionButtonStyle(),onClick:this.handleCopyClick,children:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.copy",defaultMessage:"Copy and sync"})}),(0,me.jsx)(te.Z,{store:this.getParentStore(),fadeIn:!1,style:{width:30,height:void 0},iconStyle:{marginTop:1,fill:this.theme.regularTextColor}})]})},this.renderBacklinksMenu=()=>{const{store:e}=this.props,t={menuType:L.og.Popup,width:400},n=this.hasDifferingReadPermissionsFromSource.state,o=e.getNavigableBlockStore(),i=n&&o?(0,me.jsx)(re.Z,{underline:!0,inline:!0,href:(0,B.ZP)({store:o,fullyQualified:!1,pageVisitSource:c.tY.Breadcrumb}),style:{color:this.theme.mediumTextColor},children:(0,me.jsx)(se.Z,{store:o,style:{display:"inline"}})}):void 0;return(0,me.jsxs)(ae.Z,{...t,children:[n&&o&&(0,me.jsx)(le.Z,{style:{background:this.theme.sidebarSecondaryBackground},children:(0,me.jsxs)("div",{style:{display:"flex",fontSize:12,padding:"6px 16px"},children:[(0,f.B)({width:16,marginTop:6,marginRight:8,color:this.theme.regularIconColor}),(0,me.jsx)("div",{children:(0,me.jsx)(_.FormattedMessage,{defaultMessage:"Viewership permissions on this page are different from the original page <page></page>. Some members might not have access.",id:"transclusionContainerBlock.differingPermissionsWarning",values:{page:()=>i}})})]})}),(0,me.jsx)(le.Z,{topBorder:n,children:(0,me.jsx)(J.Z,{type:"transclusion_container",store:this.props.store,originalTransclusionStore:this.props.store,disableArrow:!0})}),this.renderLearnMoreMenuSection()]})},this.handleCopyClick=()=>{C.Z5({environment:this.environment,stores:[this.getParentStore()]});const e=this.fakeSelectionTrapRef.current;e&&this.environment.device.isSafari?(O.setOnNode(e,this.environment.device),k.f4(),O.clear(this.environment)):k.f4(),w.EVQ(this.environment),x.oV({label:Z.default.formatMessage(fe.copySuccessMessage),helpUrl:(0,U.UY)("guides.transclusions")})},this.handleMouseEnter=()=>{W.Z.state.isDragging||Q.Z.state.isActive||this.disableTransclusionUI.state||this.stores.hovered.setState(!0)},this.handleMouseLeave=()=>{W.Z.state.isDragging||Q.Z.state.isActive||this.disableTransclusionUI.state||this.stores.hovered.setState(!1)},this.handleEmptyClick=e=>{(0,E.ZP)({event:e,context:E.Af.EditorClick,callback:()=>{(0,j.uG)(e)||P.createAndCommit({userAction:"TransclusionContainerBlock.handleEmptyClick",environment:this.environment,perform:e=>{M.ls({environment:this.environment,store:this.props.store,transaction:e})}})}})},this.handleActionBarBacklinksClick=()=>{C.Z5({environment:this.environment,stores:[this.getParentStore()]}),w.llH(this.environment,{from:"action_bar"})},this.handleDeletedPageClick=()=>{const{store:e}=this.props;w.Se(this.environment),q.Z.recordVisit({id:e.id,blockType:e.getType(),type:D.vu.Link,currentUserId:this.environment.currentUser.id})},this.currentState=this.createComputedStore((()=>{const e=this.getParentStore();return(0,F.B)(e,this.stores.hovered.state)})),this.showActionBar=this.createComputedStore((()=>{const e=this.currentState.state;return!(e!==F.x.Selected&&e!==F.x.SelectedDescendant||Y.Z.state.isActive||H.ZP.state.isDragging||Q.Z.state.isActive||G.Z.state.isKeyboardMode)})),this.numberOfBacklinks=this.createComputedStore((()=>{const e=(0,R.L)(this.props.store,this.environment);return e.backlinks.length+e.inaccessibleBacklinkCount})),this.disableTransclusionUI=this.createComputedStore((()=>{if(A.default.isAdminMode)return!1;const{disabled:e}=this.props;if(e)return!0;const t=this.getParentStore();if(!t.canEdit())return!0;const n=t.findRecordStoreUIAncestor((e=>e!==t&&e instanceof $.G&&e.getType()===d.Ti.transclusionContainer));return Boolean(n.ancestor)})),this.hasDifferingReadPermissionsFromSource=this.createComputedStore((()=>{const{store:e,referenceStore:t}=this.props;if(!t||!e.canEdit()||!t.canEdit())return!1;const n=(0,V.YO)(e).map((e=>{let{permissionItem:t}=e;return t})),o=(0,V.YO)(t).map((e=>{let{permissionItem:t}=e;return t})),i=(0,v.L2)(n,o).created.find((e=>!(0,b.FB)(e)));return Boolean(i)}))}handleCreated(){this.stores.hovered.setState(!1),C.ZH({device:this.environment.device});const{store:e}=this.props,t=e.getContentStores()[0];t&&t.getType()===d.Ti.text&&(C.eP({environment:this.environment,store:t}),T.N_({store:t.getBlockTitleStore()}))}async canRemoveBlock(){const e=this.numberOfBacklinks.state;if(0===e)return{canRemove:!0,canUndo:!0};const t=await this.confirm({header:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.header",defaultMessage:"Delete original?"}),text:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.text",defaultMessage:"These blocks are synced in {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}. If you delete the original, the blocks will no longer be synced.",values:{numberOfBacklinks:e}}),acceptLabel:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.confirm",defaultMessage:"Delete and unsync copies"})});return{canRemove:t,canUndo:t}}async confirmUnsyncTransclusionReference(){return 0===this.numberOfBacklinks.state||this.confirm({header:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.header",defaultMessage:"Unsync this?"}),text:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.text",defaultMessage:"The selected blocks will no longer be synced with the original."}),acceptLabel:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.confirm",defaultMessage:"Unsync"})})}async confirmUnsyncTransclusionContainer(){const e=this.numberOfBacklinks.state;return 0===e||this.confirm({header:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.header",defaultMessage:"Unsync all?"}),text:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.text",defaultMessage:"{numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}} will no longer sync with these blocks.",values:{numberOfBacklinks:e}}),acceptLabel:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.confirm",defaultMessage:"Unsync all"})})}renderPersisted(){const{store:e}=this.props,{device:t}=this.environment,n=this.disableTransclusionUI.state,o=Boolean(this.props.referenceStore);if(e.pathIsDead()&&o)return this.renderDeletedContainerBanner();if(n)return(0,me.jsx)(ue.Z,{disabled:this.props.disabled,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,store:this.props.store.getContentStore()});{const n=this.currentState.state,o=n!==F.x.Default||this.stores.haloShouldBeVisible.state||this.stores.actionBarShouldBeVisible.state,i=this.showActionBar.state,r=!e.hasContent();return this.hasDifferingReadPermissionsFromSource.state,(0,me.jsxs)("div",{style:{display:"flex"},children:[(0,me.jsx)("span",{ref:this.fakeSelectionTrapRef,style:{height:"1px",width:"1px"}}),(0,me.jsxs)("div",{style:{position:o?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%"},onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,onClick:r?this.handleEmptyClick:void 0,children:[(0,me.jsx)(ue.Z,{disabled:!1,store:this.props.store.getContentStore(),emptyPlaceholder:this.renderEmptyEditingPlaceholder(),disableHoverMenu:this.props.disableHoverMenu||n!==F.x.SelectedDescendant,disableDrag:t.isMobile}),(0,me.jsx)(X.Z,{store:e},e.id),o&&this.renderHalo(n),o&&this.renderActionBar(i)]})]})}}renderDeletedContainerBanner(){const e=(0,B.ZP)({store:this.props.store,fullyQualified:!1,pageVisitSource:c.tY.LinkInPage}),t=(0,B.ZP)({store:this.props.store,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:c.tY.PeekOpen}),n=(0,me.jsx)(re.Z,{href:e,altHref:t,forceAltHref:K.default.isSidePeekOpen(),external:!1,inline:!0,underline:!0,children:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.viewDeletedPage",defaultMessage:"View deleted page"})});return(0,me.jsxs)(de.gq,{style:{color:this.theme.text.secondary,background:this.theme.accentColors.gray[30],padding:"16px 16px 16px 12px",borderRadius:3},alignItems:"center",children:[(0,g.D)({width:24,height:24,flexShrink:0,marginRight:10,padding:2}),(0,me.jsx)("div",{style:{fontSize:14},children:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.syncedContentPageDeleted",defaultMessage:"The page with the original synced block has been deleted. {pageLink}",values:{pageLink:n}})})]})}renderHalo(e){const t=e!==F.x.Default;return(0,me.jsx)(ne.Z,{isVisible:t,enterAnimationStyle:{opacity:0},animationStyle:{opacity:e===F.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:pe.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.haloShouldBeVisible.setState(!0)},onAnimationEnd:()=>{t||this.stores.haloShouldBeVisible.setState(!1)},render:this.renderHaloContent})}renderActionBar(e){return(0,me.jsx)(ne.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:pe.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.actionBarShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.actionBarShouldBeVisible.setState(!1)},render:this.renderActionBarContent})}renderLearnMoreMenuSection(){return(0,me.jsx)(le.Z,{topBorder:!0,children:(0,me.jsx)(ce.Z,{title:this.renderLearnMoreMessage(),href:(0,U.UY)("guides.transclusions"),analyticsFrom:"transclusion_container_block"})})}renderLearnMoreMessage(){return(0,me.jsx)(_.FormattedMessage,{defaultMessage:"Learn more about Synced blocks",id:"transclusionContainerBlock.learnMoreLabel"})}renderEmptyEditingPlaceholder(){return(0,me.jsx)("div",{style:{caretColor:this.theme.lightTextColor,color:this.theme.lightTextColor},children:(0,me.jsx)(_.FormattedMessage,{defaultMessage:"Click or drag blocks here, then paste in another page to sync content.",id:"transclusionContainerBlock.emptyEditingPlaceholder"})})}getParentStore(){const{store:e,referenceStore:t}=this.props;return t||e}confirm(e){const{header:t,text:n,acceptLabel:o}=e;return new Promise((e=>{I.showDialog({showCancel:!0,keepFocus:!1,message:(0,me.jsxs)("div",{children:[(0,me.jsx)("div",{style:{fontWeight:y.Z.fontWeight.semibold},children:t}),n]}),items:[{label:o,color:"red",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}))}getActionBarStyle(){return{position:"absolute",zIndex:S.t8,top:-40,right:-2,borderRadius:3,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:y.Z.getCompositeFontFamily(s.SP).sans,background:this.theme.popoverBackground,boxShadow:this.theme.mediumBoxShadow}}getActionButtonStyle(){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${u.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`,marginRight:1}}}ge.contextTypes={...a.w,isInColumnList:i().any};const he=ge},91497:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(85854),i=n(91791),r=n(85893);class a extends o.Z{renderPersisted(){const{disabled:e,store:t}=this.props,n=t.getTransclusionReferenceTargetStore();if(n&&n.canRead())return(0,r.jsx)(i.Z,{store:n,disabled:e,intl:this.props.intl,referenceStore:this.props.store,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu})}}const s=a},60981:(e,t,n)=>{n.d(t,{h:()=>va});var o=n(41662),i=n(67294),r=n(45208),a=n(5366),s=n(33929),l=n(68859),c=n(85854),d=n(69278),u=n(85893);const p=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Abstract",id:"abstractBlock.embeds.button.label"}});class m extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:r.f,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Abstract links with public access enabled",id:"abstractBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(p.embedButtonText),urlInputPlaceholder:"https://abstract.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Abstract",id:"abstractBlock.placeholder"})})}}const f=m;var g=n(13991),h=n(49085),v=n(8848),b=n(42853),y=n(11751),S=n(82990),_=n(51454),w=n(50906),k=n(72899),I=n(92022),C=n(43250),x=n(14976),T=n(19124),M=n(87290),P=n(16402),A=n(61766),R=n(16772),D=n(55367),B=n(80796),E=n(22294),F=n(69784),Z=n(49557),L=n(77794),j=n(41432),V=n(97880),U=n(94419),O=n(9953),N=n(24677),z=n(98104),H=n(39699),W=n(12534),q=n(68056),G=n(77907),K=n(51214),$=n(23063),Q=n(73420),Y=n(55217),J=n(79954),X=n(51704);class ee extends c.Z{constructor(){super(...arguments),this.containerRef=i.createRef(),this.sizeObserver=new L.E,this.storeTypes={isHovering:h.default.createClass(!1),haloShouldBeVisible:h.default.createClass(!1)},this.renderHaloContent=()=>{const e="light"===this.theme.mode?this.theme.aiBlockBorderColor:this.theme.aiPurpleColor;return(0,u.jsx)("div",{style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:6,border:`2px solid ${e}`}})},this.handleMouseEnter=()=>{B.Z.state.isDragging||F.Z.state.isActive||this.stores.isHovering.setState(!0)},this.handleMouseLeave=()=>{B.Z.state.isDragging||F.Z.state.isActive||this.stores.isHovering.setState(!1)},this.handleHeaderRightMarginClick=e=>{e.stopPropagation();const t=(0,q.TD)({store:this.props.store.getTitleStore()});t&&z.bc({environment:this.environment,multiSelection:t,forceEmit:!1,focus:"end",readOnly:"infer"})},this.handlePlaceholderClick=e=>{(0,W.ZP)({event:e,context:W.Af.EditorClick,callback:()=>{const e=this.props.store.getContentStore();if(!e)return;(e.getValue()||[]).length>0||H.createAndCommit({userAction:"aiSection.handlePlaceholderClick",environment:this.environment,perform:t=>{const n=O.j4({environment:this.environment,type:j.Ti.text,inMemoryRecordCache:e.inMemoryRecordCache,transaction:t,spaceId:this.props.store.getSpaceId(),useCrdt:this.props.store.useCrdt()}),o=U.R3({parent:e,append:n,transaction:t}).child;N.eP({environment:this.environment,store:o});const i=o.getBlockTitleStore();z.N_({store:i})}})}})},this.currentState=this.createComputedStore((()=>(0,M.B)(this.props.store,this.stores.isHovering.state))),this.isCompact=this.createComputedStore((()=>this.sizeObserver.rect.state.width<400)),this.isHaloVisible=this.createComputedStore((()=>{if(K.Z.isGeneratingFor(this.props.store.pointer))return!0;const e=this.currentState.state;if(e===M.x.Default)return!1;if(e===M.x.Hovered){var t;const e=D.ZP.state;return!!(e&&e.isDragging&&e.currentDropZone&&e.currentDropZone.type===D.Dl.Selectable&&null!==(t=e.currentDropZone)&&void 0!==t&&t.store&&this.props.store.uiContains(e.currentDropZone.store))}return e===M.x.Selected||e===M.x.SelectedDescendant||(0,V.t1)(e)}))}renderPersisted(){const e=this.currentState.state,t=e!==M.x.Default||this.stores.haloShouldBeVisible.state;return this.props.store.isSkillBlock()?(0,u.jsx)("div",{className:C.zov,style:{display:"flex"},ref:this.containerRef,children:(0,u.jsxs)("div",{style:{position:t?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%",marginTop:4,marginBottom:4},onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:[(0,u.jsxs)(Q.X2,{gap:void 0,wrap:this.isCompact.state?"wrap":"initial",children:[(0,u.jsx)(X.Z,{store:this.props.store,disabled:!this.canEdit(),style:{width:void 0}}),(0,u.jsx)("div",{style:{paddingLeft:8,flexGrow:1},onClick:this.handleHeaderRightMarginClick,children:(0,u.jsx)(G.LazyBlockSkillButton,{blockStore:this.props.store})})]}),(0,u.jsx)("div",{onClick:this.handlePlaceholderClick,children:(0,u.jsx)(Y.Z,{disabled:this.props.disabled,store:this.props.store.getContentStore(),disableHoverMenu:this.props.disableHoverMenu||e!==M.x.SelectedDescendant,disableDrag:this.environment.device.isMobile,emptyPlaceholder:this.renderEmptyPlaceholder()})}),this.renderHalo()]})}):(0,u.jsx)(le,{...this.props})}renderEmptyPlaceholder(){return(0,u.jsx)("div",{style:{marginTop:2,padding:"3px 2px",display:"inline-block",color:this.theme.lightTextColor},children:this.renderPlaceholderMessage()})}renderPlaceholderMessage(){const e=this.props.store.getCurrentSkillType();return"meeting_action_items"===e?(0,u.jsx)(a.FormattedMessage,{id:"aiSection.meetingActionItems.textPlaceholder",defaultMessage:"Add action items or fill with AI"}):"meeting_summary"===e?(0,u.jsx)(a.FormattedMessage,{id:"aiSection.meetingSummary.textPlaceholder",defaultMessage:"Add summary or fill with AI"}):(0,u.jsx)(a.FormattedMessage,{id:"aiSection.noSkill.emptyCannotDropPlaceholder",defaultMessage:"Add blocks or fill with AI"})}renderHalo(){const e=this.isHaloVisible.getState();return(0,u.jsx)($.Z,{isVisible:e,enterAnimationStyle:{opacity:0,scale:.995},animationStyle:{opacity:.45,scale:1},exitAnimationStyle:{opacity:0,scale:.995},springConfig:{opacity:J.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.haloShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.haloShouldBeVisible.setState(!1)},render:this.renderHaloContent})}didMount(){const e=this.getNode();e instanceof Element&&this.sizeObserver.observe(e)}willUnmount(){this.sizeObserver.destroy()}}const te=ee;var ne=n(68709),oe=n(64921),ie=n(63296),re=n(65187);const ae=(0,a.defineMessages)({summarize:{id:"aiBlock.summarize",defaultMessage:"Summarize this page with AI"},findActionItems:{id:"aiBlock.findActionItems",defaultMessage:"Find action items on this page with AI"},helpMeWrite:{id:"aiBlock.helpMeWrite",defaultMessage:"Tell the AI what to write…"},summarizeMeetingTranscript:{id:"aiBlock.summarizeMeetingTranscript",defaultMessage:"Summarize this meeting with any action items and decisions taken"}});class se extends c.Z{constructor(){super(...arguments),this.containerRef=i.createRef(),this.sizeObserver=new L.E,this.storeTypes={isGenerating:h.default.createClass(!1),isHovering:h.default.createClass(!1),haloShouldBeVisible:h.default.createClass(!1),actionBarShouldBeVisible:h.default.createClass(!1),backlinksIndicatorButtonPopupStore:A.Z},this.renderHaloContent=()=>(0,u.jsx)("div",{style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:6,border:`2px solid ${this.theme.aiBlockBorderColor}`}}),this.renderActionBarContent=()=>{const e=this.lastEditedTime.state;return(0,u.jsxs)("div",{style:this.getActionBarStyle(),children:[(0,u.jsxs)(oe.Z,{style:{...this.getActionButtonStyle(),display:"flex",gap:4},onClick:this.handleEditPromptClick,disabled:this.disableButton.state,children:[(0,y.t)({width:16,height:16,fill:this.theme.accentColors.purple[400]}),(0,u.jsx)("span",{style:{color:this.theme.accentColors.purple[500],fontWeight:500},children:(0,u.jsx)(a.FormattedMessage,{id:"aiBlock.generated",defaultMessage:"Generated by AI"})}),e?(0,u.jsx)("span",{style:{color:this.theme.accentColors.purple[300]},children:(0,P.IS)(e,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0})}):null,this.disableButton.state?null:(0,b.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]}),(0,u.jsx)(oe.Z,{onClick:this.handleGenerateClick,disabled:this.disableButton.state,style:{...this.getActionButtonStyle(),opacity:this.disableButton.state?.5:1,cursor:this.disableButton.state?"not-allowed":"pointer"},children:this.stores.isGenerating.state?(0,u.jsx)(a.FormattedMessage,{id:"aiBlockBlock.update.loading",defaultMessage:"Updating…"}):(0,u.jsx)(a.FormattedMessage,{id:"aiBlockBlock.update",defaultMessage:"Update"})})]})},this.handleMouseEnter=()=>{B.Z.state.isDragging||F.Z.state.isActive||this.stores.isHovering.setState(!0)},this.handleMouseLeave=()=>{B.Z.state.isDragging||F.Z.state.isActive||this.stores.isHovering.setState(!1)},this.handleGenerateClick=async()=>{w.RLv(this.environment,{type:"generate",prompt_key:this.prompt.state.key}),this.stores.isGenerating.setState(!0);const e=await k.gr.loader();await e.triggerCompletionForAiBlock({environment:this.environment,store:this.props.store,prompt:this.prompt.state,additionalContext:this.additionalContext.state}),this.stores.isGenerating.setState(!1)},this.handleEditPromptClick=()=>{var e;w.RLv(this.environment,{type:"edit_prompt"}),(0,I.yd)({environment:this.environment,store:this.props.store,originRef:this.containerRef,prompt:null===(e=this.additionalContext.state)||void 0===e?void 0:e.prompt,clientPrompt:this.prompt.state})},this.handleFocus=()=>{var e;(0,I.yd)({environment:this.environment,store:this.props.store,originRef:this.containerRef,prompt:null===(e=this.additionalContext.state)||void 0===e?void 0:e.prompt,clientPrompt:this.prompt.state})},this.currentState=this.createComputedStore((()=>this.isEmpty.state?M.x.Hovered:(0,M.B)(this.props.store,this.stores.isHovering.state))),this.showActionBar=this.createComputedStore((()=>{const e=this.currentState.state;return!(e!==M.x.Selected&&e!==M.x.SelectedDescendant||Z.Z.state.isActive||D.ZP.state.isDragging||F.Z.state.isActive||E.Z.state.isKeyboardMode)})),this.lastEditedTime=this.createComputedStore((()=>this.props.store.getFormat().ai_last_edited)),this.isEmpty=this.createComputedStore((()=>!this.props.store.hasContent())),this.prompt=this.createComputedStore((()=>{const e=(0,T.z1)(),t=e.summarize,n=this.props.store.getFormat().ai_prompt_key;if(!n)return t;const o=e[n];return o||t})),this.titleValue=this.createComputedStore((()=>this.props.store.getBlockTitleStore().getValue())),this.additionalContext=this.createComputedStore((()=>{const e=this.titleValue.state;if(e)return{prompt:(0,x.Xh)(e,this.props.store)}})),this.disableButton=this.createComputedStore((()=>{var e;const t=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,T.GD)(t)||(!!this.stores.isGenerating.state||(!(this.props.store.canEdit()&&!this.props.store.isLocked())||"helpMeWrite"===this.prompt.state.key&&(null===(e=this.additionalContext.state)||void 0===e||!e.prompt)))})),this.isCompact=this.createComputedStore((()=>this.sizeObserver.rect.state.width<400))}renderPersisted(){const e=this.currentState.state,t=e!==M.x.Default||this.stores.haloShouldBeVisible.state||this.stores.actionBarShouldBeVisible.state,n=R.default.state,o="completionPopup"===n.type&&"results"===n.stage&&n.loading;return this.props.store.isSkillBlock()?(0,u.jsx)(te,{...this.props}):(0,u.jsx)("div",{className:C.zov,style:{display:"flex"},ref:this.containerRef,children:(0,u.jsx)("div",{style:{position:t?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%",marginTop:4,marginBottom:4},onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:this.isEmpty.state?(0,u.jsxs)(ne.p,{allowSelectionWithin:!0,children:[(0,u.jsxs)(Q.X2,{justifyContent:"space-between",padding:8,gap:8,wrap:this.isCompact.state?"wrap":"initial",children:[(0,u.jsxs)(Q.X2,{gap:12,alignItems:"baseline",grow:1,children:[this.renderIcon(),"helpMeWrite"===this.prompt.state.key?(0,u.jsx)(re.Z,{onFocus:this.handleFocus,disabled:!this.canEdit(),store:this.props.store.getBlockTitleStore(),placeholder:s.default.formatMessage(ae.helpMeWrite),pasteBehavior:"block",style:{flexGrow:1,flexBasis:0},onEnter:this.handleGenerateClick}):this.renderPrompt()]}),(0,u.jsx)(ie.Z,{disabled:this.disableButton.state,onClick:this.handleGenerateClick,style:{fontWeight:500,color:this.theme.accentColors.purple[500],opacity:this.disableButton.state?.5:1,cursor:this.disableButton.state?"not-allowed":"pointer"},children:this.stores.isGenerating.state?(0,u.jsx)(a.FormattedMessage,{id:"aiBlock.generate.loading.label",defaultMessage:"Generating…"}):(0,u.jsx)(a.FormattedMessage,{id:"aiBlock.generate.label",defaultMessage:"Generate"})})]}),this.renderHalo(e)]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Y.Z,{disabled:this.props.disabled,store:this.props.store.getContentStore(),disableHoverMenu:this.props.disableHoverMenu||e!==M.x.SelectedDescendant,disableDrag:this.environment.device.isMobile}),t&&this.renderHalo(e),!o&&t&&this.renderActionBar(this.showActionBar.state)]})})})}renderIcon(){var e,t;const n={fill:this.theme.accentColors.purple[300],width:21,height:21,position:"relative",top:5};return(null===(e=(t=this.prompt.state).svg)||void 0===e?void 0:e.call(t,n))??(0,y.t)(n)}renderPrompt(){var e;return"helpMeWrite"===this.prompt.state.key?(null===(e=this.additionalContext.state)||void 0===e?void 0:e.prompt)||s.default.formatMessage(ae.helpMeWrite):ae[this.prompt.state.key]?s.default.formatMessage(ae[this.prompt.state.key]):void 0}renderHalo(e){const t=e!==M.x.Default;return(0,u.jsx)($.Z,{isVisible:t,enterAnimationStyle:{opacity:0,scale:.995},animationStyle:{opacity:e===M.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0,scale:.995},springConfig:{opacity:J.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.haloShouldBeVisible.setState(!0)},onAnimationEnd:()=>{t||this.stores.haloShouldBeVisible.setState(!1)},render:this.renderHaloContent})}renderActionBar(e){return(0,u.jsx)($.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:J.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.actionBarShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.actionBarShouldBeVisible.setState(!1)},render:this.renderActionBarContent})}didMount(){const e=this.getNode();e instanceof Element&&this.sizeObserver.observe(e)}willUnmount(){this.sizeObserver.destroy()}getActionBarStyle(){return{position:"absolute",zIndex:_.t8,top:-40,right:-2,borderRadius:3,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:S.Z.getCompositeFontFamily(g.SP).sans,background:this.theme.popoverBackground,boxShadow:this.theme.mediumBoxShadow}}getActionButtonStyle(){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${v.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`,marginRight:1}}}const le=se;var ce=n(1292),de=n(12436);const ue=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed audio",id:"audioBlock.embedAudio.button.label"}});class pe extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:de.l,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with .MP3s, .WAVs, and .OGGs",id:"audioBlock.embed.caption"}),embedButtonText:s.default.formatMessage(ue.embedButtonText),urlInputPlaceholder:"https://…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Add an audio file",id:"audioBlock.placeholder"})})}}const me=pe;var fe=n(73935),ge=n(53150),he=n(83096),ve=n(30845),be=n(23210),ye=n(70203),Se=n(64002),_e=n(63143),we=n(48948),ke=n(47307),Ie=n(27153),Ce=n(75018),xe=n(31792),Te=n(13966),Me=n(91893),Pe=n(12981),Ae=n(84076),Re=n(68785),De=n(81865),Be=n(64369),Ee=n(86329),Fe=n(35021);const Ze=2*_e.hM,Le=(0,a.defineMessages)({linkPlaceholder:{defaultMessage:"Paste in https://…",id:"bookmarkBlock.editBookmark.linkPlaceholder"},bookmarkTitle:{defaultMessage:"Bookmark",id:"bookmarkBlock.bookmark.title"},errorMessage:{defaultMessage:"Please enter a valid link",id:"bookmarkBlock.invalidLinkError.message"}});class je extends c.Z{constructor(){super(...arguments),this.captionAriaId=(0,ge.Z)(),this.caption=()=>{const e=this.props.store.getPropertyStore("caption");N.eP({environment:this.environment,store:this.props.store}),z.NX({store:e})},this.storeTypes={stringInputButtonPopupStore:A.Z,mouseStore:xe.Z},this.handleEmbedConfirm=e=>this.embed(e),this.handleOpenMenu=()=>{if(this.canEdit()){const e=fe.findDOMNode(this);if(!e)return;if(!(e instanceof Element))return;const t=e.getBoundingClientRect();Ie.$(this.environment,{originRect:t,originGap:0,isSmallWidth:!0,showArrow:!0,title:s.default.formatMessage(Le.bookmarkTitle),currentTab:"embed",tabs:[{type:"embed",caption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Create a visual bookmark from a link.",id:"bookmarkBlock.visualBookmark.prompt"}),buttonText:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Create bookmark",id:"bookmarkBlock.visualBookmark.create"}),inputPlaceholder:s.default.formatMessage(Le.linkPlaceholder),onChange:e=>{const t=be.D(e);ve.B(t,"url")?(Ie.Z(),this.handleEmbedConfirm(t)):ke.showErrorMessage(s.default.formatMessage(Le.errorMessage))}}]})}},this.handleMouseMove=()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),this.handleMouseLeave=()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})}handleCreated(){this.edit()}edit(){this.handleOpenMenu()}embed(e){return w.bOx(this.environment,{pastedText:e,source:"bookmark_block_menu"}),we.K({environment:this.environment,store:this.props.store,url:e})}activate(){const e=this.props.store.getProperties(),t=ye.QaF(e&&e.link||[]);t&&Ce.navigateToExternalURL({environment:this.environment,url:t})}didMount(){const e=this.props.store.getFormat().bookmark_loading_ttl;if(e){const t=e-Date.now()-Ze;t>0&&setTimeout(this.enqueueForceUpdate,t+1e3)}}renderPersisted(){const e=this.props.store.getProperties();return e&&e.link?this.renderContent():this.renderPlaceholder()}renderContent(){const{store:e}=this.props,t=e.getProperties(),n=ye.Jcv(t&&t.link);let o=ye.Jcv(t&&t.title);if(n===o||!o){const e=Se.Qc(n);e.hostname&&(o=e.hostname)}const i=ye.Jcv(t&&t.description),r=e.getFormat(),s=r.bookmark_cover,l=r.bookmark_icon,c=r.bookmark_loading_ttl,p=c&&c>Date.now()-Ze;return(0,u.jsxs)(ne.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,children:[(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsx)(Fe.Z,{permissionRecord:e.pointer,url:n,render:(e,t)=>(0,u.jsxs)(Ae.Z,{href:t,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:this.getContentStyle(),onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[(0,u.jsxs)("div",{style:je.textWrapStyle,children:[p?(0,u.jsxs)(Be.Z,{style:{minHeight:24,marginBottom:2,display:"inline-flex",alignItems:"center",color:this.theme.mediumTextColor},children:[(0,u.jsx)(Re.Z,{style:{marginRight:8}})," ",(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Fetching preview",id:"bookmarkBlock.loadWhileFetching.message"})]}):(0,u.jsx)(Be.Z,{style:{minHeight:24,marginBottom:2},children:o}),i&&(0,u.jsx)(Be.Z,{isSmall:!0,isMultiline:!0,style:{height:32,overflow:"hidden"},children:i}),(0,u.jsxs)("div",{style:{display:"flex",marginTop:6},children:[l&&l.length>0&&(0,u.jsx)(De.Z,{url:l,isAuthenticated:!0,permissionRecord:this.props.store.pointer,render:(e,t)=>t&&(0,u.jsx)("img",{src:t,style:je.linkFaviconStyle})}),(0,u.jsx)(Be.Z,{style:{color:this.theme.regularTextColor},isSmall:!0,children:n})]})]}),s&&this.renderImage(s),this.shouldShowActionButton()&&this.canEdit()&&(0,u.jsx)(Te.Z,{store:this.props.store,style:{position:"absolute",top:4,right:4,background:d.Z.actionButtonBackground(this.environment)},iconStyle:{fill:v.ZP.white},fadeIn:!0})]})}),this.renderDiscussion()]}),(0,u.jsx)(Me.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})}renderImage(e){return(0,u.jsx)("div",{style:je.imageLinkWrapStyle,children:(0,u.jsx)("div",{style:je.imageLinkInnerStyle,children:(0,u.jsx)(De.Z,{url:e,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:250,render:(e,t)=>t&&(0,u.jsx)(Pe.Z,{style:je.imageStyle,src:t})})})})}renderPlaceholder(){const{disabled:e}=this.props;return(0,u.jsxs)(ne.p,{allowSelectionWithin:!1,onMouseEnter:e=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:e=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}),style:{display:"flex"},children:[(0,u.jsx)(Ee.Z,{iconSvg:he.Q,disabled:e,shouldHideRight:!this.shouldShowActionButton(),right:this.canEdit()&&(0,u.jsx)(Te.Z,{store:this.props.store,fadeIn:!1}),onClick:this.handleOpenMenu,isLoading:!1,progressPercent:0,children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Add a web bookmark",id:"bookmarkBlock.addWebBookmark.placeholder"})}),this.renderDiscussion()]})}shouldShowActionButton(){const{device:e}=this.environment;return e.isMobile||this.stores.mouseStore.state.mouseEntered}getContentStyle(){return{display:"flex",flexWrap:"wrap-reverse",alignItems:"stretch",textAlign:"left",overflow:"hidden",border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:3,position:"relative",...this.getBlockColorStyle()}}}je.imageLinkWrapStyle={flexGrow:1,flexShrink:1,flexBasis:180,display:"block",position:"relative"},je.imageLinkInnerStyle={position:"absolute",top:0,left:0,right:0,bottom:0},je.imageStyle={display:"block",width:"100%",height:"100%",objectFit:"cover"},je.textWrapStyle={flexGrow:4,flexShrink:1,flexBasis:180,padding:14,paddingTop:12,overflow:"hidden",textAlign:"left"},je.linkFaviconStyle={width:16,height:16,minWidth:16,marginRight:6};const Ve=je;var Ue=n(49271),Oe=n(3043);class Ne extends c.Z{renderPersisted(){const{device:e}=this.environment,t=this.props.store.getNavigableBlockStore(),n=this.canEdit();if(t)return(0,u.jsxs)(ne.p,{allowSelectionWithin:!0,style:{display:"flex",paddingTop:Ue.ZD.paddingTop,paddingBottom:Ue.ZD.paddingBottom},children:[(0,u.jsx)(Oe.l2,{showCurrentPageControls:!1,ancestorMaxWidth:200,currentPageMaxWidth:300,store:t,maxAncestorCount:3,isMobile:e.isMobile,style:{flexGrow:1,minWidth:0,fontSize:"inherit"}}),e.isMobile&&n&&(0,u.jsx)(Te.Z,{store:this.props.store,fadeIn:!0,style:{marginTop:2,marginRight:4}}),this.renderDiscussion()]})}}const ze=Ne;var He=n(7825),We=n(27755),qe=n(38376),Ge=n(6740),Ke=n(17397),$e=n(99036),Qe=n(80951),Ye=n(75553),Je=n(15157),Xe=n(19233),et=n(23867),tt=n(3124),nt=n(5049),ot=n(87784),it=n(42274),rt=n(72495),at=n(62967);const st=(0,a.defineMessages)({showCodePreviewSection:{id:"action.codePreviewSection.name",defaultMessage:"Show in block"}}),lt=(0,at.cN)({key:"show code",displayName:at.RE.showOnlyCodeFormat,analyticsName:at.RE.showOnlyCodeFormat.defaultMessage,svg:tt._,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;it.pZ({environment:n,blocks:t,previewFormat:"code"})}}),ct=(0,at.cN)({key:"show preview on code block",displayName:at.RE.showCodePreviewFormat,analyticsName:at.RE.showCodePreviewFormat.defaultMessage,svg:nt.s,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;it.pZ({environment:n,blocks:t,previewFormat:"preview"})}}),dt=(0,at.cN)({key:"show code and preview",displayName:at.RE.showSplitViewFormat,analyticsName:at.RE.showSplitViewFormat.defaultMessage,svg:ot.s,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;it.pZ({environment:n,blocks:t,previewFormat:"split_view"})}}),ut=[{key:"code preview actions block",render:e=>(0,u.jsx)(rt.Z,{isTitleUppercase:!1,...e}),title:s.default.formatMessage(st.showCodePreviewSection),actions:[lt,ct,dt]}];var pt=n(14871),mt=n(95477),ft=n(87279),gt=n(83960),ht=n(77080),vt=n(33846),bt=n(31194),yt=n(83355),St=n(1302),_t=n(15095),wt=n(72126),kt=n(62193),It=n(20852),Ct=n(6746),xt=n(44805),Tt=n(97444),Mt=n(98724),Pt=n(56971),At=n(74284),Rt=n(48514),Dt=n(62619),Bt=n(67669),Et=n(55227),Ft=n(89086),Zt=n(66638),Lt=n(52689),jt=n(24666),Vt=n(29595),Ut=n(93262);class Ot extends yt.Z{constructor(){super(...arguments),this.editor=null,this.mergeEditorRefs=(0,kt.sH)(),this.renderContentContainer=(e,t,n)=>{let{leafRef:o,wrapperRef:i,...r}=e;return(0,u.jsx)("div",{ref:i,style:{display:"flex",...!this.props.codeWrap&&{overflowX:"auto",WebkitOverflowScrolling:"touch"}},className:"line-numbers notion-code-block",...r,children:(0,u.jsx)(Vt.Z,{ref:this.mergeEditorRefs(this.editorRef,o),style:{...this.getContentEditableStyle(),...this.props.isQuickFind&&{paddingTop:12},...this.props.codeWrap?{whiteSpace:"pre-wrap",wordBreak:"break-all",minWidth:0}:{whiteSpace:"pre"}},getDisabled:this.getDisabled,getHtml:this.getHtml,getSelection:this.getContainerSelection,onMutation:this.handleMutation,spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:t,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!1,placeholder:" ",disableContentEditableWhenNotEditingTextOnMobile:!0})})},this.renderSyntaxTokens=(e,t)=>{const n=xt.Mw(t&&{value:t,spaceId:this.props.parentSpaceId},this.props.store.getRecordModel),o=Et.kF(n,e),i=n.map(ye.hDy).map(((e,t)=>xt.fn({annotations:e,theme:this.theme,spaceId:this.props.parentSpaceId,getRecordModel:this.props.store.getRecordModel})));return o.map(((e,t)=>(0,u.jsx)("span",{className:[e.classNames||"",...i[e.textTokenIndex].classNames].join(" "),style:i[e.textTokenIndex].style,"data-token-index":e.textTokenIndex,children:e.value},t)))},this.handleClick=e=>{x.SD({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,canEdit:this.canEdit()})},this.handleMutation=e=>{let{newValue:t}=e;this.logTypingLag("typing_lag"),H.createAndCommit({userAction:"CodeBlockValue.handleMutation",environment:this.environment,perform:e=>{Tt.aS({environment:this.environment,store:this.props.store,newValue:t,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})},this.handleDelete=e=>{if(!this.canEdit())return;this.logTypingLag("typing_delete");const{store:t}=this.props,n=jt.default.state;"editing"===n.mode&&n.multiSelection.start.store===t&&H.createAndCommit({userAction:"CodeBlockValue.handleDelete",environment:this.environment,perform:t=>{Pt.as({environment:this.environment,multiSelection:n.multiSelection,deleteForwards:!0,transaction:t,event:e})}})},this.handleBackspace=e=>{if(!this.canEdit())return;this.logTypingLag("typing_backspace");const{store:t}=this.props,n=jt.default.state;if("editing"===n.mode&&n.multiSelection.start.store===t){if(Pt.YV({device:this.environment.device,event:e,multiSelection:n.multiSelection}))return;H.createAndCommit({userAction:"CodeBlockValue.handleBackspace",environment:this.environment,perform:t=>{Pt.as({environment:this.environment,multiSelection:n.multiSelection,deleteForwards:!1,transaction:t,event:e})}})}},this.handleEnter=e=>{var t;if(!this.canEdit())return;if(this.logTypingLag("typing_enter"),null===(t=e.preventDefault)||void 0===t||t.call(e),this.editor&&this.editor.isComposing)return;const n=jt.default.state,o="editing"===n.mode&&(0,q.QY)(n.multiSelection);o&&H.createAndCommit({userAction:"CodeBlockValue.handleEnter",environment:this.environment,perform:e=>{Tt.hJ({environment:this.environment,store:this.props.store,string:"\n",selection:o.selection,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})},this.handleShiftEnter=e=>{var t;if(!this.canEdit())return;this.logTypingLag("typing_enter"),null===(t=e.preventDefault)||void 0===t||t.call(e);const n=jt.default.state;"editing"===n.mode&&(H.createAndCommit({userAction:"CodeBlockValue.handleShiftEnter",environment:this.environment,perform:e=>{At.IO({environment:this.environment,multiSelection:n.multiSelection,transaction:e})}}),this.flushRenderQueue())},this.handleTab=e=>{if(!this.canEdit())return;this.logTypingLag("typing_tab"),e.preventDefault();const t=jt.default.state,n="editing"===t.mode&&(0,q.QY)(t.multiSelection);n&&H.createAndCommit({userAction:"CodeBlockValue.handleTab",environment:this.environment,perform:e=>{Tt.wA({environment:this.environment,store:this.props.store,selection:n.selection,transaction:e,shouldStripTokens:!0})}})},this.handleUntab=e=>{if(!this.canEdit())return;this.logTypingLag("typing_untab"),e.preventDefault();const t=jt.default.state,n="editing"===t.mode&&(0,q.QY)(t.multiSelection);n&&H.createAndCommit({userAction:"CodeBlockValue.handleUntab",environment:this.environment,perform:e=>{Tt.O5({environment:this.environment,store:this.props.store,selection:n.selection,transaction:e,shouldStripTokens:!0})}})},this.handleAnnotation=(e,t)=>{this.canEdit()&&(t.preventDefault(),Mt.aS({environment:this.environment,annotation:e}),this.flushRenderQueue())},this.handleCopy=e=>{const{markdownLinkifyIt:t}=this.props;pt.JG({environment:this.environment,event:e,markdownLinkifyIt:t})},this.handleCut=e=>{const{markdownLinkifyIt:t}=this.props;this.canEdit()?pt.by({environment:this.environment,event:e,markdownLinkifyIt:t}):e.preventDefault()},this.handlePaste=e=>{const{markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:n}=this.props;this.canEdit()?H.createAndCommit({userAction:"CodeBlockValue.handlePaste",environment:this.environment,perform:o=>{pt.v({environment:this.environment,event:e,disableEmbedMenu:!0,transaction:o,onPasteFiles:pt.AL,markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:n})}}):e.preventDefault()},this.handleMoveUp=e=>{H.createAndCommit({userAction:"CodeBlockValue.handleMoveUp",environment:this.environment,perform:e=>{Tt.fs({environment:this.environment,transaction:e,direction:"up"})}})},this.handleMoveDown=e=>{H.createAndCommit({userAction:"CodeBlockValue.handleMoveDown",environment:this.environment,perform:e=>{Tt.fs({environment:this.environment,transaction:e,direction:"down"})}})},this.handleMouseOver=e=>{x.vO({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,canEdit:this.canEdit()})},this.handleMouseOut=e=>{x.kV({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,canEdit:this.canEdit()})},this.getDisabled=()=>!this.canEdit(),this.createSyntaxToken=e=>Dt.Gs(e)?[e.data]:Dt.kK(e)?[e.textContent||"",e.className]:void 0,this.getHtml=()=>{const{store:e,Prism:t}=this.props,n=this.getTextValue(),o=ye.QaF(n),r=t.languages[this.props.language];if(this.props.language!==It.PrismLanguages.html&&this.props.language!==It.PrismLanguages.markup||(t.languages.markup.tag.addInlined("style","css"),t.languages.markup.tag.addInlined("script","javascript")),o&&r&&o.length<1e4){const e=document.createElement("div"),a=t.highlight(o,r,this.props.language);e.innerHTML=Et.g7(a);const s=Array.from(e.childNodes).map(this.createSyntaxToken),l=this.renderSyntaxTokens(wt.oA(s),n),c=(0,u.jsxs)(i.Fragment,{children:[l,(0,u.jsx)("span",{children:"\n"})]});return Ct.Z.renderToStaticMarkup(c)}{const t=x.IY({environment:this.environment,textValue:n&&{value:n,spaceId:this.props.parentSpaceId},parentStore:e,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!0,disabled:!this.canEdit(),theme:this.theme,emojiType:"raw",katex:void 0,formulaValueTypes:[]});return Ct.Z.renderToStaticMarkup((0,u.jsx)(u.Fragment,{children:t}))}},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.isEditing=this.createComputedStore((()=>{var e;const t=jt.default.state;return"editing"===t.mode&&(null===(e=(0,q.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{var e;const t=Rt.Z.state;return t.open&&"inline"===t.type&&(null===(e=(0,q.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.getContainerSelection=()=>{if(this.isEditing.state)return(0,Ft.HE)(this.props.store)},this.getEndSelection=()=>{const e=_t.p4(ye.QaF(this.getTextValue()));return{startIndex:e.length,endIndex:e.length}},this.editorRef=e=>{this.editor=e}}renderComponent(){const{disabled:e}=this.props;return(0,u.jsx)(Ut.Z,{store:this.props.store,disabled:e,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.getEndSelection,onClick:this.handleClick,onDelete:this.handleDelete,onBackspace:this.handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onCommandEnter:wt.yR,onCommandShiftEnter:wt.yR,onTab:this.handleTab,onUntab:this.handleUntab,onToggleHighlight:e=>this.handleAnnotation(["h",Lt.Z.state.color],e),onToggleBold:e=>this.handleAnnotation(["b"],e),onToggleItalics:e=>this.handleAnnotation(["i"],e),onToggleUnderline:e=>this.handleAnnotation(["_"],e),onToggleStrike:e=>this.handleAnnotation(["s"],e),onToggleCode:wt.yR,onCopy:this.handleCopy,onCut:this.handleCut,onPaste:this.handlePaste,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,render:this.renderContentContainer,disableMentions:!0,disableSlashCommands:!0,canSelectAllBlocks:!0,canInsertText:!0,canSelectionDrag:!0,topBottomPadding:40,pasteBehavior:"inline"})}canEdit(){const{disabled:e,store:t}=this.props,n=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,Bt.YF)(n)&&Boolean(!e&&t.canEdit())}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}getTextValue(){return this.isNewDiscussionMenuTarget.state?x.Gj({store:this.props.store}):this.props.store.getValue()}flushRenderQueue(){St.default.flush()}logTypingLag(e){(0,Zt.u)({type:e,environment:this.environment,blockStore:this.props.blockStore,store:this.props.store,isInCollectionView:!1})}getContentEditableStyle(){return{flexGrow:1,flexShrink:1,textAlign:"left",fontFamily:S.Z.getCompositeFontFamily(g.SP).githubMono,fontSize:"85%",tabSize:2,padding:"34px 16px 32px 32px",minHeight:"1em",color:this.theme.regularTextColor}}}function Nt(e){window.__c={n:"CodeBlockValueWithDeps"};const{value:t}=(0,G.useDependency)(G.deps.prismjs),{value:n}=(0,G.useDependency)(G.deps.markdownLinkifyIt),{value:o}=(0,G.useDependency)(G.deps.tinyMceMicrosoftWordPasteFilter);return t?(0,u.jsx)(Ot,{...e,Prism:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}):null}Ot.displayName="CodeBlockValue";var zt=n(48019),Ht=n(52275),Wt=n(31945),qt=n(68894),Gt=n(78140),Kt=n(62385),$t=n(24405),Qt=n(7406),Yt=n(66673),Jt=n(4615);const Xt="\n---\n";var en=n(42402),tn=n(29551);function nn(e){window.__c={n:"MermaidRenderer"};const{source:t}=e,n=(0,Yt.Kt)(t,300,Object.is),o=(0,G.useDependency)(G.deps.mermaidAPI);return(0,u.jsx)("div",{children:o.error?(0,u.jsx)(rn,{error:o.error}):(0,u.jsx)(on,{mermaidAPI:o.value,source:n})})}function on(e){window.__c={n:"MermaidDOMRenderer"};const{mermaidAPI:t,source:n}=e,o=(0,i.useRef)(null),r=(0,i.useRef)(`mermaid-${(0,Jt.ZP)()}`),[a,s]=(0,i.useState)(),l=(0,$t.yK)((e=>({diagram:tn.gq.styles({alignContent:"center",justifyContent:"center"})})),[]),c=function(e){switch(e){case"dark":return"dark";case"light":return"neutral";default:(0,V.t1)(e)}}((0,$t.Fg)().mode),d=(0,i.useMemo)((()=>function(e){const{source:t,theme:n}=e,o=`%%{init: {'theme':'${n}'}}%%\n`;return t.startsWith("---\n")&&t.includes(Xt)?t.replace(Xt,`\n---\n${o}`):`${o}${t}`}({source:n,theme:c})),[n,c]);return(0,i.useLayoutEffect)((()=>{if(!t)return;let e=!1;try{t.render(r.current,d).then((t=>{const n=t.svg,i=t.bindFunctions;if(e)return;if(!o.current)return;o.current.innerHTML=n;const r=o.current.firstChild;r&&r instanceof SVGSVGElement&&r.removeAttribute("height");try{i&&i(o.current),s(void 0)}catch(a){s((0,Qt.tg)(a))}}),(e=>{s((0,Qt.tg)(e))}))}catch(n){s((0,Qt.tg)(n))}return()=>{e=!0}}),[d,t]),(0,u.jsxs)(u.Fragment,{children:[a&&(0,u.jsx)(rn,{error:a}),(0,u.jsx)("div",{style:l.diagram,ref:o})]})}function rn(e){window.__c={n:"MermaidError"};const{error:t}=e,n=(0,$t.yK)((e=>({label:{color:e.errorText,marginBottom:4,whiteSpace:"pre-wrap"}})),[]);return"str"in t?(0,u.jsx)("div",{children:(0,u.jsxs)(Be.Z,{isMultiline:!0,style:n.label,children:[t.str,(0,u.jsx)("div",{children:(0,u.jsx)(en.Z,{external:!0,href:"https://mermaid-js.github.io/mermaid/#/examples",children:(0,u.jsx)(a.FormattedMessage,{id:"mermaidRenderer.error.seeMermaidExamples",defaultMessage:"See Mermaid examples"})})})]})}):(0,u.jsx)(Be.Z,{isMultiline:!0,style:n.label,children:(0,u.jsx)(a.FormattedMessage,{id:"mermaidRenderer.error.unknownError",defaultMessage:"Unknown error: {error}",values:{error:`${t.name}: ${t.message}`}})})}class an extends c.Z{constructor(){super(...arguments),this.captionAriaId=(0,ge.Z)(),this.storeTypes={focusStore:h.default.createClass(!1),mouseStore:xe.Z,languageSelectorButtonPopupStore:A.Z,codePreviewFormatSelectorButtonPopupStore:A.Z,inputStore:vt.Z},this.enableMermaidRenderer=this.createComputedStore((()=>"on"===ht.default.getGroup("mermaid"))),this.CustomRenderedLanguages={Mermaid:{component:nn,gate:this.enableMermaidRenderer}},this.renderLanguageSelectorPopup=e=>{const{device:t}=this.environment,n=this.getCurrentLanguage(),o=Ke.X0.filter((e=>"Java/C/C++/C#"!==e)),i=[{key:0,render:e=>(0,u.jsx)(rt.Z,{...e}),actions:o.map((t=>({key:t,displayName:t,analyticsName:t,searchName:t,render:e=>(0,u.jsx)(Ht.Z,{title:t,...e}),action:()=>{this.setPersistedLanguage(t),e.close()},closeParentMenu:!0})))}],r=this.stores.inputStore.state.inputValue,l=(0,u.jsx)(zt.Z,{filter:r,context:{blocks:[],environment:this.environment,publicEditMode:void 0},sections:i,initialFocus:r?0:o.findIndex((e=>e===n))}),c=(0,u.jsx)(rt.Z,{isInput:!0,children:(0,u.jsx)(qt.ZP,{value:r,onChange:this.handleInputChange,focus:!t.isMobile||void 0,placeholder:s.default.formatMessage(at.RE.searchPlaceholder),focusAfterAnimation:!0})});let d;return d=t.isMobile?{menuType:ft.og.Modal,title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Language",id:"codeBlock.mobileLanguageMenu.title"}),right:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Done",id:"codeBlock.mobileLanguageMenu.doneButton.label"}),onClickRight:e.close,header:c}:{menuType:ft.og.Popup,width:240,maxHeight:"50vh",header:c},(0,u.jsx)(Gt.Z,{...d,children:l})},this.renderCodePreviewFormatsPopup=e=>{const{device:t}=this.environment,n=this.props.store.getFormat().code_preview_format,o=(0,u.jsx)(zt.Z,{context:{blocks:[this.props.store],environment:this.environment,publicEditMode:void 0},sections:ut,initialFocus:["code","preview","split_view"].findIndex((e=>e===n))});let i;return i=t.isMobile?{menuType:ft.og.ActionSheet}:{menuType:ft.og.Popup,width:167,maxHeight:"50vh"},(0,u.jsx)(Gt.Z,{...i,children:o})},this.caption=()=>{this.handleEditCaption()},this.handleEditCaption=()=>{const e=this.props.store.getPropertyStore("caption");N.eP({environment:this.environment,store:this.props.store}),z.NX({store:e})},this.handleCopy=()=>{const e=this.props.store,t=ye.Jcv(e.getBlockTitleStore().getValue());pt.RD({environment:this.environment,stringValue:t,copiedMessage:pt.tq.copiedCodeToClipboard})},this.handleInputChange=e=>{this.stores.inputStore.setState({inputValue:e.target.value,focus:!1})},this.handlePopupClose=()=>{this.stores.inputStore.reset()},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,Ge.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=()=>{this.stores.focusStore.setState(!1)}}renderPersisted(){const{device:e}=this.environment,{store:t,disabled:n}=this.props,o=this.getCurrentLanguage(),i=Xe.W[o],r=this.getCurrentCodePreviewFormat(o),a=t.getFormat().code_wrap;return(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsxs)(ne.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,style:this.getStyle(),onMouseMove:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},children:[(0,u.jsxs)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,style:this.getLanguageSelectorStyle(),children:[this.renderLanguageSelector(),this.renderCodePreviewSelector()]}),(0,u.jsx)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,style:this.getHeaderStyle(),children:(0,u.jsxs)("div",{style:{color:this.theme.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,marginTop:4,marginRight:4},children:[!e.isMobile&&this.renderCopyToClipboardButton(),!e.isMobile&&this.canEdit()&&this.renderCaptionButton(),this.canEdit()&&(0,u.jsx)(Te.Z,{style:{height:25,background:this.theme.codeBlockButtonBackground,borderTopLeftRadius:e.isMobile?3:0,borderBottomLeftRadius:e.isMobile?3:0,paddingLeft:8,paddingRight:8},store:this.props.store,fadeIn:!1})]})}),(0,u.jsxs)("div",{style:this.getCodeContainerStyle(),children:[this.shouldShowCodeBlock(o,r)&&(0,u.jsx)(Nt,{store:t.getBlockTitleStore(),blockStore:t,language:i,disabled:n,codeWrap:Boolean(a),isQuickFind:Boolean(this.props.isQuickFind),parentSpaceId:(0,et.C)(t.pointer.spaceId)}),this.renderCustomCodePreview()]}),(0,u.jsx)("div",{style:this.getCaptionContainerStyle(),children:(0,u.jsx)(Me.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})})]}),this.renderDiscussion(),"​"]})}hasCustomRenderer(e){return Boolean(this.getCustomRenderer(e))}getCustomRenderer(e){const t=this.CustomRenderedLanguages[e];if(t&&t.gate.state)return t}renderCustomCodePreview(){const{store:e}=this.props,t=this.getCurrentLanguage(),n=e.getBlockTitleStore(),o=this.getCurrentCodePreviewFormat(t),i="code"===o,r=this.getCustomRenderer(t);if(!i&&n.getValue()&&r)return(0,u.jsx)("div",{style:this.getCustomPreviewWrapperStyle(o),children:(0,u.jsx)(r.component,{source:x.Xh(n.getValue(),n)})})}getCustomPreviewWrapperStyle(e){switch(e){case"split_view":return{padding:16,flexGrow:1,flexShrink:0};case"preview":return{padding:16,paddingTop:40,alignSelf:"center",flexGrow:1,flexShrink:0};case"code":return{};default:(0,V.t1)(e)}}renderCodePreviewSelector(){const{device:e}=this.environment,t=this.getCurrentLanguage();if(this.hasCustomRenderer(t)){const n=this.getCurrentCodePreviewFormat(t);return(0,u.jsx)(Wt.ZP,{popupType:e.isMobile?Wt.Z4.SlideUp:Wt.Z4.Popup,renderOrigin:e=>(0,u.jsxs)(Kt.Z,{disabled:!this.canEdit(),style:{marginRight:5},...e,children:[this.getCodePreviewFormatText(n),(0,b.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]}),buttonPopupStore:this.stores.codePreviewFormatSelectorButtonPopupStore,placementToOrigin:bt.Iw.Bottom,render:this.renderCodePreviewFormatsPopup})}}renderLanguageSelector(){const{device:e}=this.environment,t=this.getCurrentLanguage();return(0,u.jsx)(Wt.ZP,{popupType:e.isMobile?Wt.Z4.SlideUp:Wt.Z4.Popup,renderOrigin:e=>(0,u.jsxs)(Kt.Z,{disabled:!this.canEdit(),style:{marginRight:5},...e,children:[t,(0,b.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]}),buttonPopupStore:this.stores.languageSelectorButtonPopupStore,placementToOrigin:bt.Iw.Bottom,render:this.renderLanguageSelectorPopup,onClose:this.handlePopupClose})}renderCopyToClipboardButton(){return(0,u.jsxs)(Kt.Z,{onClick:this.handleCopy,style:{...this.getButtonStyle(),borderTopRightRadius:0,borderBottomRightRadius:0},children:[(0,Ye.U)({height:16,width:16,paddingRight:4}),(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]})}renderCaptionButton(){return(0,u.jsx)(Kt.Z,{onClick:this.handleEditCaption,style:{...this.getButtonStyle(),marginLeft:1,marginRight:1,borderRadius:0},children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Caption",id:"codeBlock.caption.button"})})}getCurrentLanguage(){const e=this.getPersistedLanguage();return e&&(0,Ke.L9)(e)?e:gt.T.defaultLanguage}getPersistedLanguage(){const e=this.props.store.getProperties()||{};return Qe.Sj(e.language,$e.fG)}setPersistedLanguage(e){H.createAndCommit({userAction:"CodeBlock.setPersistedLanguage",environment:this.environment,perform:t=>{it.E5({blocks:[this.props.store],language:e,transaction:t})}}),Je.Z.set({userId:this.environment.currentUser.id,key:gt.T.localLanguagePreferenceKey,value:e})}getCurrentCodePreviewFormat(e){return this.hasCustomRenderer(e)?this.props.store.getFormat().code_preview_format??"split_view":gt.T.defaultCodePreviewFormat}shouldShowCodeBlock(e,t){return!this.hasCustomRenderer(e)||"preview"!==t}getCodePreviewFormatText(e){let t;switch(e){case"split_view":t=at.RE.showSplitViewFormat;break;case"preview":t=at.RE.showCodePreviewFormat;break;case"code":t=at.RE.showOnlyCodeFormat;break;default:(0,V.t1)(e)}return(0,u.jsx)(a.FormattedMessage,{defaultMessage:t.defaultMessage,id:t.id})}getStyle(){return{flexGrow:1,borderRadius:3,textAlign:"left",position:"relative",background:this.theme.codeBlockBackground,minWidth:0,width:"100%",...this.props.style}}getButtonStyle(){return{height:25,background:this.theme.codeBlockButtonBackground,color:this.theme.regularTextColor,fontWeight:S.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5}}getHeaderStyle(){const{mouseEntered:e}=this.stores.mouseStore.state,t=this.stores.focusStore.state,{isMobile:n}=this.environment.device,o=E.Z.state.isKeyboardMode,i=n||t||!o&&e;return{position:"absolute",top:3,right:1,zIndex:1,color:this.theme.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",height:25,fontSize:11.5,opacity:i?1:0,transition:an.transition}}getLanguageSelectorStyle(){const{mouseEntered:e}=this.stores.mouseStore.state,t=this.stores.focusStore.state,{isMobile:n}=this.environment.device,o=e||t||n;return{position:"absolute",top:8,left:8,zIndex:1,color:this.theme.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",opacity:o?1:0,transition:an.transition}}getCaptionContainerStyle(){return{background:this.theme.contentBackground,paddingRight:105}}getCodeContainerStyle(){return{}}}an.transition="opacity 300ms ease-in";const sn=an;var ln=n(43661);class cn extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:ln.O,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with any public CodePen link…",id:"codepenBlock.embed.caption"}),children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed CodePen",id:"codepenBlock.placeholder"})})}}const dn=cn;var un=n(53223),pn=n(27627),mn=n(13084),fn=n(52989),gn=n(78175),hn=n(39500),vn=n(50628),bn=n(480),yn=n(86628),Sn=n(96049);const _n=46,wn=4;function kn(e){window.__c={n:"ColumnDivider"};const t=(0,yn.qz)(e.mouseStore,xe.Z),{showHandle:n,onMouseDown:o,onTouchStart:r,onContextMenu:a,onDoubleClick:s}=e,l=(0,bn.O7)(),c=(0,yn.VK)((()=>n&&(t.state.mouseEntered||l.device.isMobile&&Sn.Z.state)),[n,t,l.device]),d=(0,i.useCallback)((()=>{t.setState({...t.state,mouseEntered:!1}),Sn.Z.removeListener(d)}),[t]),p=(0,i.useCallback)((()=>{Sn.Z.removeListener(d),Sn.Z.state||t.setState({...t.state,mouseEntered:!0})}),[d,t]),m=(0,i.useCallback)((()=>{Sn.Z.state?Sn.Z.addListener(d):t.setState({...t.state,mouseEntered:!1})}),[d,t]),f=(0,$t.yK)((e=>{const t={position:"relative",width:_n,flexGrow:0,flexShrink:0,transition:"opacity 200ms ease-out",opacity:0};return{base:t,hovered:{...t,opacity:1,cursor:"col-resize"},handle:{position:"absolute",top:0,bottom:0,left:_n/2-wn/2,width:wn,height:"100%",background:e.darkDividerColor}}}),[]),g=c?f.hovered:f.base;return(0,u.jsx)("div",{style:g,onDoubleClick:s,onMouseDown:o,onTouchStart:r,onContextMenu:a,onMouseEnter:p,onMouseLeave:m,children:n&&(0,u.jsx)("div",{style:f.handle})})}const In=i.memo(kn);n(57658);var Cn=n(45697),xn=n.n(Cn),Tn=n(96802);class Mn extends h.default{getInitialState(){return{dragging:!1}}}const Pn=Mn;var An=n(23883),Rn=n(70518),Dn=n(12137),Bn=n(58202);const En=function(e){const{columnListStore:t}=e;t.setState({dragging:!1})},Fn=function(e){const{columnListBlockStore:t,diffX:n,columnListStore:o,leftColumn:i,rightColumn:r}=e;if(o.state.dragging){const{leftColumnStartWidth:e}=o.state,a=(0,Dn.Z)(o.state.leftColumnStartRatio,0,1),{rightColumnStartWidth:s}=o.state,l=(0,Dn.Z)(o.state.rightColumnStartRatio,0,1),c=e+s,d=a+l,u=(0,Dn.Z)(e+n,0,c),p=(0,Dn.Z)(s-n,0,c),m=d*(u/c),f=d*(p/c);if(0===u&&0===p)return o.setState({...o.state,temporaryRatios:{}}),{leftColumnNewRatio:a,rightColumnNewRatio:l};{const e=1/(8*t.getContentLength());let n=Math.round(m/e)*e,s=f+(m-n);return n<e&&(n=e,s=a+l-e),s<e&&(s=e,n=l+a-e),o.setState({...o.state,temporaryRatios:{[i.id]:n,[r.id]:s}}),{leftColumnNewRatio:n,rightColumnNewRatio:s}}}};var Zn=n(6685);function Ln(e){window.__c={n:"ColumnDraggableDivider"};const t=(0,yn.qz)(e.mouseStore,xe.Z),{canDrag:n,columnList:o,leftColumn:r,rightColumn:a,columnListStore:s}=e,l=(0,bn.O7)(),c=(0,i.useCallback)((e=>{n&&(e.preventDefault(),function(e){const{environment:t,columnListStore:n,leftColumn:o,rightColumn:i}=e,r=Bn.R.getRect(o),a=Bn.R.getRect(i);r&&a&&(n.setState({dragging:!0,temporaryRatios:{},leftColumnStartWidth:r.width,leftColumnStartRatio:o.getColumnRatio(),rightColumnStartWidth:a.width,rightColumnStartRatio:i.getColumnRatio()}),N.ZH(t),z.ZH(t))}({environment:l,columnListStore:s,leftColumn:r,rightColumn:a}),N.ZH(l),z.sD())}),[n,l,r,s,a]),d=(0,i.useCallback)((e=>{n&&Fn({columnListBlockStore:o,columnListStore:s,leftColumn:r,rightColumn:a,diffX:e.diffX})}),[n,o,s,r,a]),p=(0,i.useCallback)((e=>{H.createAndCommit({userAction:"ColumnDivider.handleDragEnd",environment:l,perform:t=>{n&&function(e){const{environment:t,columnListStore:n,transaction:o,leftColumn:i,rightColumn:r}=e,a=Fn(e);if(a){const{leftColumnNewRatio:e,rightColumnNewRatio:s}=a;Tn.FH({stores:[i],update:{column_ratio:e},transaction:o}),Tn.FH({stores:[r],update:{column_ratio:s},transaction:o}),n.state.dragging&&n.setState({...n.state,temporaryRatios:{}}),w.wy9(t)}}({environment:l,columnListBlockStore:o,columnListStore:s,leftColumn:r,rightColumn:a,diffX:e.diffX,transaction:t})}}),En({columnListStore:s})}),[n,o,s,l,r,a]),m=(0,i.useCallback)((()=>{En({columnListStore:s})}),[s]),f=(0,i.useCallback)((()=>{H.createAndCommit({userAction:"ColumnDivider.handleDoubleClick",environment:l,perform:e=>{n&&function(e){const{columnListBlockStore:t,transaction:n,environment:o}=e,i=1/t.getContentLength();Tn.FH({stores:t.getContentStores(),update:{column_ratio:i},transaction:n}),w.UJm(o)}({environment:l,columnListBlockStore:o,transaction:e})}})}),[n,o,l]);return n?(0,u.jsx)(Zn.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:c,onDraggableDragMove:d,onDraggableDragEnd:p,onDraggableDragCancel:m,disableHorizontalEdgeScroll:!0,disableVerticalEdgeScroll:!0,render:e=>(0,u.jsx)(In,{showHandle:!0,mouseStore:t,onDoubleClick:f,...e})}):(0,u.jsx)(In,{mouseStore:t,showHandle:!1})}const jn=i.memo(Ln);class Vn extends c.Z{constructor(){super(...arguments),this.storeTypes={columnListStore:Pn,blockResizerStore:l.Z},this.handleResizeDoubleClick=()=>{H.createAndCommit({userAction:"ColumnList.handleResizeDoubleClick",environment:this.environment,perform:e=>{if(this.props.store.canEdit()){const t=!this.props.store.getFormat().block_full_width;Tn.FH({stores:[this.props.store],transaction:e,update:{block_full_width:t}})}}})},this.getChildrenLimit=this.createComputedStore((()=>{const{limitParents:e}=An.Z.state;let t;return this.props.store.findRecordStoreUIAncestor((n=>{const o=e.get(n);return!!o&&(t=o[this.props.store.id],!0)})),t})),this.isColumnListResizableStore=this.createComputedStore((()=>this.props.store.canEdit()&&(0,gn.Po)(this.props.store,this.environment)))}getChildContext(){return{...this.context,isInColumnList:!0}}renderPersisted(){const{disabled:e}=this.props,t=this.stores.columnListStore.state,n=this.getChildrenLimit.state;let o=this.props.store.getContentStores();wt.hj(n)&&(o=wt.tP(o,0,n));let i=o.map(((e,n)=>{let o;return o=t.dragging&&t.temporaryRatios.hasOwnProperty(e.id)?t.temporaryRatios[e.id]:e.getColumnRatio(),o}));const r=wt.Sm(i);i=wt.UI(i,(e=>e/r));const a=[];return o.forEach(((t,n)=>{const r=0===n,s=n===o.length-1;a.push((0,u.jsx)(Nn,{store:t,isFirstItem:r,isLastItem:s,numColumns:o.length,ratio:i[n],disabled:e,columnListStore:this.props.store},t.id)),s||a.push((0,u.jsx)(jn,{canDrag:this.canEdit(),columnList:this.props.store,leftColumn:t,rightColumn:o[n+1],columnListStore:this.stores.columnListStore},`divider${t.id}`))})),this.renderContainer(a)}renderContainer(e){return this.isColumnListResizableStore.state?(0,u.jsx)("div",{style:this.getResizableWrapperStyle(),children:(0,u.jsxs)("div",{style:Vn.columnRowStyle,children:[(0,u.jsx)(Rn.ZP,{disabled:!this.canEdit(),blockResizerStore:this.stores.blockResizerStore,resizeComponent:this,resizerType:Rn.IS.Horizontal,resizerAlignment:Rn.bZ.Left,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,children:(0,u.jsx)("div",{style:this.getResizableEdgeHandleStyle("left"),children:(0,u.jsx)(In,{onDoubleClick:this.handleResizeDoubleClick,showHandle:this.canEdit()})})},"divider-left-edge"),e,(0,u.jsx)(Rn.ZP,{disabled:!this.canEdit(),resizeComponent:this,resizerType:Rn.IS.Horizontal,resizerAlignment:Rn.bZ.Right,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,blockResizerStore:this.stores.blockResizerStore,children:(0,u.jsx)("div",{style:this.getResizableEdgeHandleStyle("right"),children:(0,u.jsx)(In,{onDoubleClick:this.handleResizeDoubleClick,showHandle:this.canEdit()})})},"divider-right-edge")]})}):(0,u.jsx)("div",{style:this.getColumnListStyle(),children:e})}handleCreated(){const{store:e}=this.props,t=e.getContentStores()[0];if(t&&t.getType()===j.Ti.column){const e=t.getContentStores()[0];e&&e.getType()===j.Ti.text&&(N.eP({environment:this.environment,store:e}),z.N_({store:e.getBlockTitleStore()}))}}getColumnListStyle(){const e={display:"flex"};return(0,gn.zE)(this.props.store,this.environment)||(e.display="block"),e}getResizableWrapperStyle(){const e={position:"relative",transition:"padding 0.2s linear"},t=Boolean(this.props.store.getFormat().block_full_width);return(t&&this.stores.blockResizerStore.state.dragging?this.stores.blockResizerStore.state.temporaryFullWidth:t)&&(e.paddingLeft=_n,e.paddingRight=_n),e}getResizableEdgeHandleStyle(e){return{display:"flex",position:"absolute",top:0,bottom:0,right:"left"===e?"100%":"auto",left:"right"===e?"100%":"auto"}}}Vn.contextTypes=yt.w,Vn.childContextTypes={isInColumnList:xn().any,...yt.w},Vn.topBottomPadding=12,Vn.columnRowStyle={display:"flex",position:"relative",flexGrow:1};const Un=Vn;class On extends c.Z{constructor(){super(...arguments),this.handleDrop=e=>{const{droppedDirection:t,droppedStores:n,duplicate:o}=e;H.createAndCommit({userAction:"Column.handleDrop",environment:this.environment,perform:e=>{mn.LQ({environment:this.environment,droppedDirection:t,droppedStores:n,targetParentStore:this.props.columnListStore.getContentStore(),targetStore:this.props.store,duplicate:o,transaction:e})}})},this.handleMouseDown=e=>{(0,gn.zE)(this.props.store,this.environment)&&(0,W.ZP)({event:e,context:W.Af.EditorMouseDown,callback:()=>{this.capturedMouseDown=!0,e.preventDefault(),fn.AI({environment:this.environment,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}})},this.handleMouseUp=e=>{if(this.capturedMouseDown&&!hn.uG(e)){const{clientX:t,clientY:n,target:o}=e;St.default.afterNextFlush((()=>{z.J9(this.environment,{x:t,y:n,target:o instanceof Element?o:void 0}),this.capturedMouseDown=!1}))}},this.handleClick=e=>{if(!vn.Z.hasBeenUpdatedSince(e.timeStamp)&&this.props.store.canEdit()){const{clientX:t,clientY:n,target:o}=e;St.default.afterNextFlush((()=>{H.createAndCommit({userAction:"Column.handleClick",environment:this.environment,perform:e=>{z.LG(this.environment,{x:t,y:n,target:o instanceof Element?o:void 0},this.props.store,e)}})}))}}}renderComponent(){const{ratio:e,store:t,isLastItem:n,disabled:o}=this.props,i=1===t.getContentLength(),r=this.canEdit();return(0,u.jsx)($.Z,{isVisible:!0,animationStyle:this.getAnimationStyle({ratio:e}),render:()=>(0,u.jsx)("div",{style:this.getStyle(),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,children:(0,u.jsx)(J.Z,{store:t,canDropLeft:r&&(0,gn.zE)(this.props.store,this.environment),canDropRight:n&&r&&(0,gn.zE)(this.props.store,this.environment),onSelectableDrop:this.handleDrop,analyticsName:"column",style:{display:"flex",flexDirection:"column"},shouldShowDropZone:!0,isListContainer:!0,children:(0,u.jsx)(Y.Z,{store:t.getContentStore(),disabled:o,disableLayout:i,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})})})}getStyle(){const e={paddingTop:Un.topBottomPadding,paddingBottom:Un.topBottomPadding};return(0,gn.zE)(this.props.store,this.environment)&&wt.f0(e,{flexGrow:0,flexShrink:0}),e}getAnimationStyle(e){let{ratio:t}=e;const n={width:"100%"};return this.props.numColumns>1&&(n.width=`calc((100% - ${_n*(this.props.numColumns-1)}px) * ${t})`),(0,gn.zE)(this.props.store,this.environment)||(n.width="100%"),n}}const Nn=On;var zn=n(91948);class Hn extends c.Z{renderPersisted(){return(0,u.jsx)(ne.p,{allowSelectionWithin:!1,style:Hn.wrapStyle,children:(0,u.jsxs)("div",{style:Hn.style,children:[(0,u.jsx)(Re.Z,{}),(0,u.jsx)("div",{style:Hn.progressBarStyle,children:(0,u.jsx)(zn.Z,{targetRecordId:this.blockStore().id})})]})})}}Hn.style={minHeight:"1.5em",display:"flex",alignItems:"center"},Hn.progressBarStyle={flex:1,margin:"0 8px"},Hn.wrapStyle={...Ue.ZD};const Wn=Hn;var qn=n(90827);const Gn=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.embeds.button.label"}});class Kn extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:qn.N,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Deepnote blocks with public links",id:"deepnoteBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(Gn.embedButtonText),urlInputPlaceholder:"https://deepnote.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.placeholder"})})}}const $n=Kn;var Qn=n(6404),Yn=n(27724),Jn=n(61519);class Xn extends c.Z{constructor(){super(...arguments),this.handleClick=e=>{const{device:t}=this.environment;t.isMobile&&(N.Ys({environment:this.environment,store:this.props.store}),Qn.Qn({environment:this.environment,stores:Yn.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:"default",showInput:!0,analyticsFrom:"content_block_menu"}))}}handleCreated(){H.createAndCommit({userAction:"DividerBlock.handleCreated",environment:this.environment,perform:e=>mn.Bm({environment:this.environment,targetStore:this.props.store,targetParentStore:this.props.store.getRecordStoreUIParent(),isAtStartOfLine:!1,isClick:!1,transaction:e})})}renderPersisted(){return(0,u.jsx)(Jn.Z,{className:C.QSt,size:13,style:{color:this.theme.darkDividerColor,pointerEvents:"auto"},onClick:this.handleClick})}}const eo=Xn;var to=n(4708);class no extends c.Z{constructor(){super(...arguments),this.handleCreated=()=>{this.edit()}}renderPersisted(){const e=(0,to.A3)()?this.getFeatureEnabledProps():this.getFeatureDisabledProps();return(0,u.jsx)(d.Z,{...this.props,...e,mediaMenuTabs:[],disableMediaMenu:!0,preserveScale:!1,showURLInput:!1})}edit(){z.ZH({device:this.environment.device}),N.Z5({environment:this.environment,stores:[this.props.store],phase:Yn.SelectionPhase.Editing})}getFeatureEnabledProps(){return{source:"https://www.notion.so/product/drawing"}}getFeatureDisabledProps(){return{}}}const oo=no;var io=n(7057),ro=n(84869),ao=n(91584),so=n(68422),lo=n(63085),co=n(28415);class uo extends h.default{getInitialState(){return{error:!1,loading:!1}}}const po=uo,mo=(0,a.defineMessages)({menuTitle:{defaultMessage:"Embed",id:"googleDriveBlock.mediaMenuActions.embedTab.title"}});class fo extends c.Z{constructor(){super(...arguments),this.captionAriaId=(0,ge.Z)(),this.storeTypes={mouseStore:xe.Z,driveStore:po},this.openGoogleDriveFilePicker=e=>{co.vE({environment:this.environment,accessToken:e.accessToken,callback:t=>{this.loadAndInitializeGoogleDrive(t,e)}})},this.handleMouseEnter=e=>{B.Z.state.isDragging||F.Z.state.isActive||this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{B.Z.state.isDragging||F.Z.state.isActive||this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.openMenu=()=>{const{device:e}=this.environment;if(this.canEdit()){const t=fe.findDOMNode(this);if(t&&t instanceof Element){const n=t.getBoundingClientRect();Ie.$(this.environment,{originRect:n,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:e.isMobile?"embed":"drive",tabs:this.mediaPickerTabs(),title:s.default.formatMessage(mo.menuTitle),popupWidth:320,maxHeight:420})}}}}handleCreated(){this.openMenu()}didMount(){super.didMount();const e=this.props.store.getFormat();e&&e.drive_properties&&e.drive_properties.file_id&&e.drive_status&&e.drive_status.last_fetched+5*_e.hM<Date.now()&&ao.WO(this.environment,{id:this.props.store.id,spaceId:(0,et.C)(this.props.store.pointer.spaceId)})}renderPersisted(){const e=this.props.store.getProperties(),t=this.props.store.getFormat();return t&&t.drive_properties&&t.drive_status?this.renderBlock(t.drive_properties):e&&e.source?this.renderLegacy():this.renderPlaceholder()}renderBlock(e){const t=e.url;return(0,u.jsxs)("div",{role:"figure","aria-labelledby":this.captionAriaId,children:[(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsxs)(Ae.Z,{href:t,external:!0,style:this.getContentStyle(),onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:[this.renderThumbnail(e),this.renderFile(e),this.shouldShowActionButton()&&this.canEdit()&&this.renderActionMenuButton()]}),this.renderDiscussion()]}),(0,u.jsx)(Me.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})}renderThumbnail(e){const t=e.thumbnail,n=this.stores.driveStore.state.error;return t&&!n?(0,u.jsx)("div",{style:fo.imageLinkWrapStyle,children:(0,u.jsx)("div",{style:fo.imageLinkInnerStyle,children:(0,u.jsx)(De.Z,{url:t,width:1e3,isAuthenticated:!0,permissionRecord:this.props.store.pointer,render:(t,n)=>{if(n){const t=Se.SK(n,{v:e.version});return(0,u.jsx)("img",{src:t,style:fo.imageStyle,onError:e=>{this.stores.driveStore.setState({error:!0,loading:!1})}})}t&&this.stores.driveStore.setState({error:!0,loading:!1})}})})}):(0,u.jsx)("div",{style:this.placeholderStyle()})}renderFile(e){const t=e.title,n=e.url,o=Se.Qc(n).hostname;return(0,u.jsxs)("div",{style:this.getTextWrapStyle(),children:[t&&(0,u.jsx)(Be.Z,{style:{marginBottom:2},children:t}),this.renderDescription(e),(0,u.jsxs)("div",{style:this.getLinkStyle(),children:[e.icon&&(0,u.jsx)("div",{style:this.getIconStyle(e.icon)}),(0,u.jsx)(Be.Z,{style:{color:this.theme.regularTextColor},isSmall:!0,children:o})]})]})}renderDescription(e){const t=e.user_name||e.modified_time?(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Last modified {hasUserName, select, true {by {userName}} other {}} {hasLastModifiedTime, select, true {{lastModifiedTime}} other {}}",id:"googleDriveBlock.pageDescription",values:{hasUserName:Boolean(e.user_name),userName:e.user_name,hasLastModifiedTime:Boolean(e.modified_time),lastModifiedTime:e.modified_time&&(0,io.tv)(e.modified_time,g.SP)}}):void 0;return(0,u.jsxs)("div",{style:this.getDescriptionStyle(),children:[e.trashed&&(0,u.jsx)(a.FormattedMessage,{defaultMessage:"This file is in trash.",id:"googleDriveBlock.pageDeleted.caption"}),t]})}renderActionMenuButton(){return(0,u.jsx)(Te.Z,{store:this.props.store,style:{position:"absolute",top:4,right:4,background:d.Z.actionButtonBackground(this.environment)},iconStyle:{fill:v.ZP.white},fadeIn:!0})}renderLegacy(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:ro.c,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Google Docs, Google Sheets…",id:"googleDriveBlock.legacyLinkInput.caption"}),children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed a file from Google Drive",id:"googleDriveBlock.legacy.placeholder"})})}renderPlaceholder(){const{disabled:e}=this.props,t=this.props.store.getFormat().drive_status,n=!(!t||!t.authed);return(0,u.jsxs)("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{display:"flex"},children:[(0,u.jsx)(Ee.Z,{iconSvg:ro.c,disabled:e,shouldHideRight:!this.shouldShowActionButton(),right:this.canEdit()&&(0,u.jsx)(Te.Z,{store:this.props.store,fadeIn:!1}),onClick:this.openMenu,isLoading:this.stores.driveStore.state.loading,progressPercent:0,children:n?(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Choose a file to embed from Google Drive",id:"googleDriveBlock.placeholder.authenticated"}):(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Connect Google Drive to Notion to embed a file",id:"googleDriveBlock.placeholder.notAuthenticated"})}),this.renderDiscussion()]})}shouldShowActionButton(){const{device:e}=this.environment;return e.isMobile||this.stores.mouseStore.state.mouseEntered}async loadAndInitializeGoogleDrive(e,t){this.stores.driveStore.setState({loading:!0,error:!1});const n=await ao.Ui({environment:this.environment,store:this.props.store,fileId:e,token:t});this.stores.driveStore.setState({loading:!1,error:!n||!!n.auth_error})}async initializeGoogleDriveBlockFromUrl(e){const t=lo.id(e);if(!t)return void this.convertToTextBlock(e);const n=await ao.Ui({environment:this.environment,store:this.props.store,fileId:t});n&&n.auth_error&&(ao.cR(this.environment,{onSuccess:e=>{this.loadAndInitializeGoogleDrive(t,e)},onFailure:()=>{this.convertToTextBlock(e)}}),this.trackAuthPrompt("url_embed"))}convertToTextBlock(e){H.createAndCommit({userAction:"DriveBlock.convertToTextBlock",environment:this.environment,perform:t=>{O.sW({store:this.props.store.getPropertiesStore(),data:{title:[ye.V3y(e,[ye.edl(e)])]},transaction:t}),so.Cj({environment:this.environment,blocks:[this.props.store],blockType:"text",transaction:t})}})}mediaPickerTabs(){const{device:e}=this.environment,t=[];return t.push({type:"embed",caption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with any file in your Google Drive",id:"googleDriveBlock.embedTab.caption"}),buttonText:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Google Drive file",id:"googleDriveBlock.embedTab.embedButton.label"}),onChange:e=>{Ie.Z(),this.initializeGoogleDriveBlockFromUrl(e)}}),e.isMobile||t.push({type:"drive",title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Browse Google Drive",id:"googleDriveBlock.mediaPicker.googleDriveTab.title"}),onSelect:async e=>{if(Ie.Z(),e&&e.token)this.openGoogleDriveFilePicker(e.token),w.uul(this.environment);else{const e=await ao.qN(this.environment);e&&e.token&&this.openGoogleDriveFilePicker(e.token),this.trackAuthPrompt("drive_file_picker")}}}),t}trackAuthPrompt(e){w.SOV(this.environment,{integration_name:"google",from:e})}getContentStyle(){return{display:"flex",flexDirection:"column",width:"100%",border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:3,position:"relative"}}placeholderStyle(){return{...fo.imageLinkWrapStyle,paddingBottom:"20%",minHeight:80,background:this.theme.embedPlaceholderBackground}}getIconStyle(e){return{flexShrink:0,backgroundImage:`url(${e})`,backgroundSize:"cover",width:16,height:16,marginRight:6}}getTextWrapStyle(){return{width:"100%",minHeight:60,padding:14,paddingTop:12,overflow:"hidden",borderTop:`1px solid ${this.theme.darkDividerColor}`}}getDescriptionStyle(){return{fontSize:12,lineHeight:1.3,color:this.theme.mediumTextColor,maxHeight:32,overflow:"hidden"}}getLinkStyle(){return{display:"flex",alignItems:"center",marginTop:6}}}fo.imageLinkWrapStyle={display:"block",position:"relative",width:"100%",paddingBottom:"55%"},fo.imageLinkInnerStyle={position:"absolute",top:0,left:0,right:0,bottom:0},fo.imageStyle={display:"block",width:"100%",height:"100%",objectFit:"cover",objectPosition:"top"};const go=fo;var ho=n(63003),vo=n(83631),bo=n(3702),yo=n(22492),So=n(40148);class _o extends c.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:xe.Z,focusStore:h.default.createClass(!1),buttonPopupStore:A.Z},this.renderOrigin=()=>{const{device:e}=this.environment,{store:t}=this.props,n=this.getValue();let o,i={};n?o=(0,u.jsx)(yo.Z,{display:"block",equation:n,style:this.getContainerStyle(!1),errorStyle:this.getContainerStyle(!0),theme:this.theme}):(o=(0,u.jsx)(So.ZP,{iconSvg:ho.f,iconStyle:{width:28,height:28,marginRight:8},style:{background:void 0},children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Add a TeX equation",id:"equationBlock.empty.placeholder"})},"button"),i={background:this.theme.sidebarBackground});const r=e.isMobile||this.stores.mouseStore.state.mouseEntered||this.stores.focusStore.state;return(0,u.jsxs)(oe.Z,{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onClick:this.handleOpen,style:{position:"relative",width:"100%",borderRadius:3,...i},children:[o,this.canEdit()&&(0,u.jsx)(Te.Z,{onFocus:this.handleFocus,onBlur:this.handleBlur,store:t,tooltipContent:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Rename, delete, and more…",id:"equationBlock.actions.tooltip"}),style:{position:"absolute",top:4,right:4,color:this.theme.mediumTextColor,opacity:r?1:0},fadeIn:!1})]})},this.handleChange=e=>{H.createAndCommit({userAction:"EquationBlock.handleChange",environment:this.environment,perform:t=>{O.sW({store:this.props.store.getPropertiesStore(),data:{title:ye.TPx(e)},transaction:t})}})},this.handleOpen=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})},this.handleClose=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!1}),N.Ys({environment:this.environment,store:this.props.store})},this.handleMouseMove=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,Ge.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=()=>{this.stores.focusStore.setState(!1)},this.handleSubmit=()=>{w.PyM(this.environment,{equation:this.getValue()})}}handleCreated(){this.handleOpen()}edit(){this.handleOpen()}activate(){this.stores.buttonPopupStore.state.open?this.handleClose():this.handleOpen()}renderPersisted(){const e=this.getValue(),t=this.stores.buttonPopupStore.state.open?{isOpen:!0,equationValue:e,error:vo.by({environment:this.environment,equation:e,displayMode:"block"})}:{isOpen:!1,equationValue:void 0,error:void 0},n=!this.canEdit(),o=this.renderOrigin();return(0,u.jsxs)(ne.p,{allowSelectionWithin:!0,style:{display:"flex",position:"relative"},children:[(0,u.jsx)(G.DependencyConsumer,{dependency:G.deps.prismjs,children:e=>(0,u.jsx)(bo.Z,{...t,Prism:e,displayMode:"block",disabled:n,origin:o,onDismiss:this.handleClose,onChange:this.handleChange,onSubmit:this.handleSubmit})}),this.renderDiscussion()]})}getValue(){const e=this.props.store.getProperties();return ye.Jcv(e&&e.title)}getContainerStyle(e){const t={display:"flex",padding:"4px 8px",width:"100%"};return this.getValue()?(t.flexDirection="column",t.overflow="auto"):t.color=v.ZP.contentPlaceholder,e&&(t.background=this.theme.equationErrorPlaceholderBackground),{...t,...this.getBlockColorStyle()}}}const wo=_o;var ko=n(56185);const Io=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.embeds.button.label"}});class Co extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:ko.F,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Excalidraw whiteboards.",id:"excalidrawBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(Io.embedButtonText),urlInputPlaceholder:"https://excalidraw.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.placeholder"})})}}const xo=Co;var To=n(14562),Mo=n(13797),Po=n(47453),Ao=n(95802),Ro=n(26664),Do=n(54532),Bo=n(42858);var Eo=n(52315);class Fo extends h.default{getInitialState(){return{open:!1}}}const Zo=Fo;var Lo=n(35661),jo=n(34583),Vo=n(42922),Uo=n(23189),Oo=n(13490);class No extends yt.Z{constructor(){super(...arguments),this.storeTypes={store:Zo},this.renderProperty=(e,t)=>{let{title:n,subtitle:o,value:i}=e;return(0,u.jsxs)("div",{children:[(0,u.jsx)(Jn.Z,{size:36}),(0,u.jsx)(Oo.Z,{children:n}),(0,u.jsx)(Be.Z,{isSmall:!0,children:o}),(0,u.jsx)("div",{style:{marginTop:8,padding:6,background:this.theme.sidebarBackground,borderRadius:3},children:i})]},t)},this.handleCloseClick=()=>{this.stores.store.setState({...this.stores.store.state,open:!1})}}renderComponent(){return this.stores.store.state.open?(0,u.jsxs)("div",{style:{flexGrow:1,minWidth:0},children:[this.props.origin,(0,u.jsxs)("div",{style:{position:"relative",boxShadow:`inset 0 0 0 1px ${this.theme.regularDividerColor}`,padding:12,borderRadius:3,overflow:"hidden"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,u.jsx)(Uo.Z,{style:{flex:1,marginRight:16,marginBottom:0},children:this.props.title}),(0,u.jsx)(Vo.Z,{onClick:this.handleCloseClick,children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Close",id:"factoryBlock.configureMenu.closeButton.label"})})]}),this.props.properties.map(this.renderProperty)]})]}):this.props.origin}}No.displayName="Configurable",No.headStyle={display:"flex",alignItems:"center"},No.titleStyle={flex:1,fontSize:14,userSelect:"none",WebKitUserSelect:"none",cursor:"default"};const zo=No;var Ho=n(15201),Wo=n(73063),qo=n(89728),Go=n(26388);const Ko=(0,a.defineMessages)({addNewItem:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.label"},buttonPlaceholder:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.placeholder"}});class $o extends c.Z{constructor(){super(...arguments),this.storeTypes={configurableStore:Zo,mouseStore:xe.Z},this.handleMouseMove=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.handleButtonClick=()=>{this.canEdit()&&jo.M_(this.environment)&&H.createAndCommit({userAction:"FactoryBlock.handleButtonClick",environment:this.environment,perform:e=>{!function(e){const{store:t,transaction:n,environment:o}=e,i=t.getRecordStoreUIParent();let r=!1;i&&i.valueIs(Ro.i)&&wt.YM(i.getValue())!==t.id&&wt.Z$(i.getValue())===t.id&&(r=!0);const a=t.getContentStores().filter((e=>e.isDefined()));r||a.reverse();const s=Ao.C.findSelectableFromStore(t),l=[],c=Promise.all(a.map((e=>new Promise((i=>{const a=e.getModel(),c=!a||!a.isTemplateVariableContainerBlock(),[d,u]=Do.Qi({environment:o,stores:[e],transaction:n,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:c,targetSpaceId:(0,et.C)(e.pointer.spaceId),baseUrl:mt.default.domainBaseUrl,publicDomainName:mt.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:t.useCrdt()}),p=d[0];u.then((e=>{e&&ke.showErrorMessage(e),i()})),s&&(r?s.props.onInsertAbove&&s.props.canInsertAbove&&l.push(s.props.onInsertAbove({insertStores:[p],transaction:n})[0]):s.props.onInsertBelow&&s.props.canInsertBelow&&l.push(s.props.onInsertBelow({insertStores:[p],transaction:n})[0]))})))));r||l.reverse(),N.Z5({environment:o,stores:l}),c.then((()=>{St.default.afterNextFlush((()=>{Bo.DV({environment:o,insertedStores:l,isCreated:!0})}))}))}({environment:this.environment,store:this.props.store,transaction:e})}})},this.handleToggleConfigure=()=>{this.stores.configurableStore.state.open?this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!1}):(w.PEc(this.environment,{from:"gear_button"}),this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!0}))}}willMountOrUpdate(e){super.willMountOrUpdate(e),Eo.b(e.store)}handleCreated(){this.configure()}activate(){this.handleButtonClick()}configure(){this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!0})}renderPersisted(){const e=this.getDisabled();return(0,u.jsxs)(ne.p,{allowSelectionWithin:!0,style:{display:"flex"},children:[(0,u.jsx)(zo,{title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Configure template button",id:"factoryBlock.configureButton.label"}),origin:this.renderFactory(),store:this.stores.configurableStore,properties:[{title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Button name",id:"factoryBlock.buttonName.title"}),subtitle:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"What should this button be called?",id:"factoryBlock.buttonName.subtitle"}),value:(0,u.jsx)(re.Z,{disabled:e,store:this.getInteriorTitleStore(),placeholder:s.default.formatMessage(Ko.addNewItem),onEnter:wt.yR,pasteBehavior:"inline"})},{title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Template",id:"factoryBlock.templateArea.title"}),subtitle:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Drop blocks here that you want to duplicate whenever the button is clicked.",id:"factoryBlock.templateArea.subtitle."}),value:(0,u.jsx)(Ho.O,{displayName:"FactoryBlockContent",disabled:e,children:(0,u.jsx)(Y.Z,{disabled:e,store:this.props.store.getContentStore(),emptyPlaceholder:(0,u.jsx)("div",{style:{caretColor:this.theme.regularTextColor,color:this.theme.regularTextColor},children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Empty. Drop blocks here…",id:"factoryBlock.emptyTemplate.placeholder"})}),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})}]}),this.renderDiscussion()]})}renderFactory(){const{device:e}=this.environment,t=this.getDisabled();return(0,u.jsxs)(qo.Z,{icon:Po.R,isGray:!0,isLarge:!0,style:{fontSize:"inherit",width:"100%"},shouldShrink:!0,onClick:this.handleButtonClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,disabled:t,children:[(0,u.jsx)(re.Z,{disabled:!0,store:this.props.store.getBlockTitleStore(),placeholder:s.default.formatMessage(Ko.buttonPlaceholder),style:$o.buttonTextStyle,placeholderStyle:this.getPlaceholderStyle()}),!t&&(e.isMobile||this.stores.mouseStore.state.mouseEntered)&&(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center"},className:C.JiD,children:[!e.isMobile&&this.renderConfigureButton(),(0,u.jsx)(Te.Z,{tooltipContent:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"More actions…",id:"factoryBlock.moreActions.button.label"}),store:this.props.store,fadeIn:!0})]})]})}renderConfigureButton(){return(0,u.jsx)(Go.Z,{renderTooltip:()=>(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Configure template",id:"factoryBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,u.jsx)(Wo.Z,{icon:Mo.F,onClick:this.handleToggleConfigure,...e})})}getDisabled(){return this.props.disabled||!this.canEdit()}getInteriorTitleStore(){return Lo.G.createChildStore(this.props.store,this.props.store.pointer).getBlockTitleStore()}getPlaceholderStyle(){return{width:"100%",display:"block",caretColor:this.theme.regularTextColor,color:this.theme.regularTextColor,...S.Z.textOverflowStyle}}}$o.buttonTextStyle={pointerEvents:"none",...S.Z.textOverflowStyle};const Qo=$o;var Yo=n(71441);class Jo extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:Yo.O,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with any public Figma shareable link",id:"figmaBlock.caption"}),children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Figma",id:"figmaBlock.placeholder"})})}}const Xo=Jo;var ei=n(69721),ti=n(60997);const ni=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Framer",id:"framerBlock.embedFramer.button.label"}});class oi extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:ti.B,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Framer prototypes",id:"framerBlock.linkInput.caption"}),embedButtonText:s.default.formatMessage(ni.embedButtonText),urlInputPlaceholder:"https://framer.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed a Framer prototype",id:"framerBlock.placeholder"})})}}const ii=oi;var ri=n(69578);const ai=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Gist",id:"gistBlock.embedButton.label"}});class si extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:ri.f,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with links to Gists on GitHub",id:"gistBlock.linkInput.caption"}),embedButtonText:s.default.formatMessage(ai.embedButtonText),urlInputPlaceholder:"https://gist.github.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed a Gist",id:"gistBlock.placeholder"})})}}const li=si;var ci=n(65453),di=n(64258);const ui=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Hex",id:"hexBlock.embeds.button.label"}});class pi extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:di.p,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Hex cell links with public access.",id:"hexBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(ui.embedButtonText),urlInputPlaceholder:"https://hex.tech/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Hex",id:"hexBlock.placeholder"})})}}const mi=pi;var fi=n(56813),gi=n(48964);const hi=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Invision",id:"invisionBlock.embeds.button.label"}});class vi extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:gi.v,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Invision projects",id:"invisionBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(hi.embedButtonText),urlInputPlaceholder:"https://invis.io/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed an Invision project",id:"invisionBlock.placeholder"})})}}const bi=vi;var yi=n(6287),Si=n(72711),_i=n(31299);class wi extends h.default{getInitialState(){return{query:""}}}const ki=wi;var Ii=n(69454),Ci=n(3386),xi=n(32163),Ti=n(43765),Mi=n(11470),Pi=n(77137),Ai=n(75987),Ri=n(36488),Di=n(74194),Bi=n(53437);class Ei extends yt.Z{constructor(){super(...arguments),this.storeTypes={store:ki},this.handleQueryUpdateDebounced=void 0,this.handleInputChange=e=>{const t=e.target.value;this.stores.store.setState({...this.stores.store.state,query:t}),this.handleQueryUpdateDebounced(t)},this.handleQueryUpdate=e=>{this.props.onQueryUpdate&&this.props.onQueryUpdate({query:e,autocompleteStore:this.stores.store})}}get registries(){return[Ai.Z]}willMount(e){super.willMount(e),this.handleQueryUpdateDebounced=wt.Ds(this.handleQueryUpdate,this.props.queryUpdateDebounce)}renderComponent(){const{device:e}=this.environment;return(0,u.jsx)(Bi.ZP,{popupType:e.isPhone?Bi.ZP.PopupType.SlideUp:Bi.ZP.PopupType.Popup,open:this.props.isOpen,origin:this.renderInput(),placementToOrigin:Bi.ZP.Placement.Bottom,alignmentToOrigin:Bi.ZP.Alignment.Start,originGap:4,disableDarkOverlayBackground:e.isPhone,onDismiss:this.props.onBgClick,render:this.props.renderPopup,preventCaptureEsc:this.props.preventCaptureEsc,disableMouseCapture:this.props.disableMouseCapture,style:this.props.popupStyle})}renderInput(){const e=this.props.isOpen;return(0,u.jsx)(Ri.Z,{capture:e,allowMenuList:!0,render:e=>(0,u.jsx)(ne.p,{allowSelectionWithin:!0,...e,children:(0,u.jsx)(Di.Z,{style:this.props.inputStyle,format:void 0!==this.props.format?this.props.format:Di.Z.Format.Transparent,value:this.stores.store.state.query,onClick:this.props.onInputClick,onFocus:this.props.onInputFocus,onBlur:this.props.onInputBlur,onChange:this.handleInputChange,placeholder:this.props.inputPlaceholder,focus:this.props.focus})})})}}Ei.displayName="InlineAutocomplete";const Fi=Ei,Zi=(0,a.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a database…",id:"linkToCollectionBlock.input.placeholder"}});class Li extends c.Z{constructor(){super(...arguments),this.didPerformAction=!1,this.storeTypes={autocompleteStore:ki,mouseStore:xe.Z},this.handleBlur=()=>{z.ZH(this.environment),this.didPerformAction||(this.didPerformAction=!0,H.createAndCommit({userAction:"LinkToCollectionBlock.handleBlur",environment:this.environment,perform:e=>{Bo.Od({store:this.props.store,transaction:e})}}))},this.isEditing=this.createComputedStore((()=>{const{store:e}=this.props,t=jt.default.state;return Boolean("editing"===t.mode&&(0,q.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.id)})),this.performQuery=async e=>this.props.store.isDefaultRecordCache()?(await _i.bm(this.environment,{query:e,limit:20,source:"link_to_collection_block"})).results:[]}handleCreated(){N.$Y({environment:this.environment,phase:Yn.SelectionPhase.Editing}),z.Z5({store:this.props.store,selection:void 0})}renderComponent(){if(this.isEditing.state)return this.renderSearchInput()}renderSearchInput(){const{device:e}=this.environment,{query:t}=this.stores.autocompleteStore.state;return(0,u.jsx)(Pi.Z,{request:t,performRequest:this.performQuery,debounce:_i.vp,render:(t,n,o)=>{const i=(n||[]).map((e=>{const t=Lo.NW.createChildStore(this.props.store,{table:yi.v,id:e});return{key:e,render:e=>(0,u.jsx)(Mi.Z,{...e,store:t}),action:()=>{if(!this.didPerformAction){this.didPerformAction=!0;const{store:e}=this.props;H.createAndCommit({userAction:"LinkToCollectionBlock.menuListItem",environment:this.environment,perform:n=>{const o=Si.Y_({environment:this.environment,store:e,collectionStore:t,collectionViewStore:void 0,transaction:n});o&&N.Z5({environment:this.environment,stores:[o]})}})}}}}));return(0,u.jsx)(Ci.Z,{capture:this.isEditing.state,children:(0,u.jsx)(Fi,{loading:!o,isOpen:!0,store:this.stores.autocompleteStore,queryUpdateDebounce:_i.vp,inputPlaceholder:s.default.formatMessage(Zi.inputPlaceholder),focus:!0,inputStyle:this.getInputStyle(),onBgClick:this.handleBlur,renderPopup:()=>{let t,r;return t=n&&0===i.length?(0,u.jsx)(rt.Z,{title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.noResults.title"}),loading:!o,children:(0,u.jsx)(Ti.Z,{title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"No results",id:"linkToCollectionBlock.menuItem.noResults.label"})})}):(0,u.jsx)(xi.Z,{type:xi.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,u.jsx)(rt.Z,{...e,title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.showResults.title"}),loading:!o}),items:i}]}),r=e.isPhone?{menuType:ft.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${Ii.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:ft.og.Popup,width:460,maxHeight:e.isPhone?"30vh":"40vh"},(0,u.jsx)(Gt.Z,{...r,children:t})}})})}})}getTitleStyle(){return{lineHeight:1.3}}getInputStyle(){return{...this.getTitleStyle(),borderBottom:void 0}}}const ji=Li;var Vi=n(27006),Ui=n(21202),Oi=n(61045),Ni=n(28020),zi=n(80444);const Hi=(0,a.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a page…",id:"linkToPageBlock.searchPlaceholder"}});class Wi extends c.Z{constructor(){super(...arguments),this.didPerformAction=!1,this.storeTypes={autocompleteStore:ki,mouseStore:xe.Z},this.handleBlur=()=>{z.ZH(this.environment),this.didPerformAction||(this.didPerformAction=!0,H.createAndCommit({userAction:"LinkToPageBlock.handleBlur",environment:this.environment,perform:e=>{Bo.Od({store:this.props.store,transaction:e})}}))},this.isEditing=this.createComputedStore((()=>{const{store:e}=this.props,t=jt.default.state;return Boolean("editing"===t.mode&&(0,q.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.id)})),this.performQuery=async e=>{const{currentSpaceStore:t,mainEditorCurrentBlockStore:n}=zi.default.state,{store:o}=this.props,i=(0,Bt.YO)(o).find((e=>{let{permissionItem:t}=e;return(0,Vi.$D)(t)}));if(this.props.store.isDefaultRecordCache()&&(t||i)){if(!e)return i&&!t&&n?[n.id]:Ni._u(this.environment).map((e=>e.id));if(t){return(await _i.nJ({environment:this.environment,query:e,limit:20,spaceId:t.id,requireEditPermissions:!1,excludeTemplates:!1,source:"link_to_page_block",boostRecentlyViewedPages:!0})).results}if(i&&i.from.table===Ui.iU){return(await _i.M0({environment:this.environment,query:e,limit:20,ancestorId:i.from.blockId,excludeTemplates:!1,source:"link_to_page_block"})).results}}return[]}}handleCreated(){const{device:e}=this.environment;N.$Y({environment:this.environment,phase:Yn.SelectionPhase.Editing}),z.Z5({store:this.props.store,selection:void 0}),e.isMobile&&Ii.Z.onShow((()=>Oi.hQ(this.environment)))}renderComponent(){if(this.isEditing.state)return this.renderSearchInput()}renderSearchInput(){const{device:e}=this.environment,{query:t}=this.stores.autocompleteStore.state,n={request:t,performRequest:this.performQuery,debounce:_i.vp,render:(t,n,o)=>{const i=(n||[]).map((e=>{const t=Lo.G.createChildStore(this.props.store,{table:Ui.iU,id:e});return{key:e,render:e=>(0,u.jsx)(Mi.Z,{...e,store:t}),action:()=>{this.didPerformAction||(this.didPerformAction=!0,H.createAndCommit({userAction:"LinkToPageBlock.menuListItem",environment:this.environment,perform:e=>{const n=Si.hc({environment:this.environment,store:this.props.store,targetStore:t,transaction:e});n&&N.Z5({environment:this.environment,stores:[n]})}}))}}}));return(0,u.jsx)(Ci.Z,{capture:this.isEditing.state,children:(0,u.jsx)(Fi,{loading:!o,isOpen:!0,store:this.stores.autocompleteStore,queryUpdateDebounce:_i.vp,inputPlaceholder:s.default.formatMessage(Hi.inputPlaceholder),focus:!0,inputStyle:this.getInputStyle(),onBgClick:this.handleBlur,renderPopup:()=>{let t,r;return t=n&&0===i.length?(0,u.jsx)(rt.Z,{title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt"}),loading:!o,children:(0,u.jsx)(Ti.Z,{title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"No results",id:"linkToPageBlock.noSearchResults"})})}):(0,u.jsx)(xi.Z,{type:xi.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,u.jsx)(rt.Z,{...e,title:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt.withContents"}),loading:!o}),items:i}]}),r=e.isPhone?{menuType:ft.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${Ii.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:ft.og.Popup,width:460,maxHeight:e.isMobile?"30vh":"40vh"},(0,u.jsx)(Gt.Z,{...r,children:t})}})})}};return(0,u.jsx)(Pi.Z,{...n})}getTitleStyle(){return{lineHeight:1.3}}getInputStyle(){return{...this.getTitleStyle(),borderBottom:void 0}}}const qi=Wi;var Gi=n(97485);class Ki extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:Gi.p,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with any Loom shareable link",id:"loomBlock.embed.caption"}),children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Loom",id:"loomBlock.placeholder"})})}}const $i=Ki;var Qi=n(81822);const Yi=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Map",id:"googleMapsBlock.embedButton.label"}});class Ji extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:Qi.h,urlInputPlaceholder:"https://www.google.com/maps…",embedButtonText:s.default.formatMessage(Yi.embedButtonText),mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with places on Google Maps",id:"googleMapsBlock.embed.caption"}),children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed a Google Map",id:"googleMapsBlock.placeholder"})})}}const Xi=Ji;var er=n(15289);const tr=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Miro",id:"miroBlock.embeds.button.label"}});class nr extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:er.M,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Miro links with public access enabled",id:"miroBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(tr.embedButtonText),urlInputPlaceholder:"https://miro.com/app/board/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Miro",id:"miroBlock.placeholder"})})}}const or=nr;var ir=n(78810);const rr=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Mixpanel",id:"mixpanelBlock.embeds.button.label"}});class ar extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:ir.n,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Mixpanel projects",id:"mixpanelBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(rr.embedButtonText),urlInputPlaceholder:"https://mixpanel.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed a Mixpanel project",id:"mixpanelBlock.placeholder"})})}}const sr=ar;var lr=n(54321),cr=n(4382),dr=n(45952),ur=n(16472),pr=n(36067);const mr=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed a repl",id:"replitBlock.embeds.button.label"}});class fr extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:pr.J,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Replit.",id:"replitBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(mr.embedButtonText),urlInputPlaceholder:"https://replit.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed a repl",id:"replitBlock.placeholder"})})}}const gr=fr;var hr=n(31317);const vr=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Sketch",id:"sketchBlock.embeds.button.label"}});class br extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:hr.j,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Sketch links with Public Link Access enabled",id:"sketchBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(vr.embedButtonText),urlInputPlaceholder:"https://sketch.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Sketch",id:"sketchBlock.placeholder"})})}}const yr=br;var Sr=n(99571),_r=n(15690),wr=n(25777),kr=n(33709),Ir=n(52771),Cr=n(92120),xr=n(98165),Tr=n(34859),Mr=n(79131),Pr=n(31278),Ar=n(76798),Rr=n(53336);function Dr(e){window.__c={n:"TabBlockMenu"};const t=(0,a.useIntl)(),n=(0,bn.O7)(),o=(0,$t.Fg)(),r=(0,$t.yK)((e=>({baseStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},mobileStyle:Lr(e),desktopStyle:Zr(e),scrollerOverlayStyle:jr(e)})),[]),s=(0,i.useRef)(null);return(0,u.jsxs)("div",{style:{...n.device.isMobile?r.mobileStyle:r.desktopStyle,...r.baseStyle},children:[(0,u.jsx)(Rr.Z,{role:"tablist","aria-label":t.formatMessage(Fr.tabListLabel),type:Tr.Z.X,ref:s,showLeftRightOverlay:!0,rightOverlayStyle:r.scrollerOverlayStyle,children:(0,u.jsx)(Mr.ZP,{disabled:e.disabled,direction:"horizontal",keys:e.tabs.map((e=>e.id)),renderKey:(t,n)=>(0,u.jsx)(Br,{index:n,...e}),onDrop:(t,o)=>function(e){const{environment:t,parentStore:n,onDropArgs:o,newTabs:i}=e;H.createAndCommit({userAction:"TabBlockMenu.handleTabReorder",environment:t,perform:e=>{const{key:t,endPosition:r}=o,a=n.getContentStores().find((e=>e.id===t)),s=i[r-1],l=n.getContentStores().find((e=>e.id===s));if(a){const t=n;U.HP({parent:t.getContentStore(),after:l,current:a,transaction:e})}}})}({environment:n,newTabs:t,parentStore:e.parentStore,onDropArgs:o}),disableHorizontalEdgeScroll:!1})}),!e.disabled&&(0,u.jsx)(qo.Z,{"aria-label":t.formatMessage(Fr.addTab),style:{height:28,width:28,marginTop:6,display:"flex",justifyContent:"center"},onClick:()=>{!function(e,t,n){const{performResult:o}=H.createAndCommit({userAction:"TabBlockMenu.newTab",environment:e,perform:n=>_r.gG({environment:e,store:t,transaction:n})}),i=()=>{const e=t.getContentStores(),n=e[e.length-1];Ir.$({blockStore:o,renderDelete:!0,originRect:n?Ao.C.getRectFromStore(n):void 0})};n.current?n.current.scrollToRight({animate:!0,animationCallback:()=>{i()}}):i()}(n,e.parentStore,s)},children:(0,Po.R)({fill:o.mediumIconColor,width:16,height:16})})]})}function Br(e){window.__c={n:"TabItem"};const t=(0,bn.O7)(),n=(0,a.useIntl)(),{index:o,parentStore:i,selectedIndex:r,tabs:s}=e,l=s[o],c=(0,$t.yK)((e=>({selectedTab:{...{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},position:"relative"},tab:{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},border:Vr(e)})),[]),d=(0,yn.VK)((()=>{const e=Cr.Z.getFirstSelectedDiscussionId();if(!e)return!1;const t=Lo.jQ.createChildStore(l,{table:kr.qF,id:e,spaceId:l.getSpaceId()});return(0,xr.qA)(t).map((e=>e.id)).includes(l.id)}),[l]),{device:p}=t,m=r===o,f=o===s.length-1,g=0===o,h=s.length;return(0,u.jsx)(J.Z,{store:l,analyticsName:"tab",canSelect:!0,canDrag:!1,canDropBelow:!1,canDropLeft:!g,canDropAbove:!1,canNativeDropBelow:!1,canNativeDropLeft:!g,canNativeDropRight:!f,canDropOnto:!0,dropzoneShouldNeverUseOrigin:!0,dropzoneMustBeWithinHorizontalBound:!0,canInsertAbove:!g,canDropRight:!f,canInsertBelow:!f,shouldShowHalo:!0,shouldShowDropZone:!0,shouldShowParentHalo:!0,dropzoneGap:10,onSelectableDrop:e=>{const{droppedDirection:n,droppedStores:o,duplicate:i}=e;H.createAndCommit({userAction:"TabBlockMenu.dropOntoTab",environment:t,perform:e=>{mn.LQ({environment:t,targetParentStore:l.getContentStore(),targetStore:l,droppedDirection:n,droppedStores:o,duplicate:i,transaction:e})}})},onRemove:()=>{!function(e){const{environment:t,parentStore:n,tabStore:o,index:i}=e;H.createAndCommit({userAction:"TabBlockMenu.handleRemoveTab",environment:t,perform:e=>{const r=n.getContentStores();if(1===r.length){const t=n.getRecordStoreUIParent();"block"!==(null==t?void 0:t.table)&&"space"!==(null==t?void 0:t.table)||null==t||!t.valueIs(Ro.i)||U.Od({parent:t,childToRemove:n,transaction:e})}else{const e=i<r.length-1?r[i+1]:r[i-1];_r.x2({store:n,id:e.id,currentUserId:t.currentUser.id})}U.Od({parent:n.getContentStore(),childToRemove:o,transaction:e})}})}({environment:t,parentStore:i,tabStore:l,index:o})},children:(0,u.jsxs)("div",{style:{...m?c.selectedTab:c.tab},children:[(0,u.jsxs)(qo.Z,{role:"tab","aria-selected":m,"aria-controls":m?e.contentAriaId:void 0,"aria-posinset":o+1,"aria-setsize":h,id:m?e.selectedTabAriaId:void 0,style:{fontSize:16},onClick:()=>function(e,t,n){if(e.onChange(t),n&&!e.disabled){const n=e.parentStore.getContentStores()[t];Ir.$({blockStore:n,renderDelete:!0})}}(e,o,m),disabled:e.readOnly,mobileFeedback:p.isMobile,hovered:d,isGray:!m,children:[(0,u.jsx)(Er,{store:l}),(0,u.jsx)(Ar.Z,{store:l,placeholder:n.formatMessage(Fr.untitledTab)})]}),m&&(0,u.jsx)("div",{style:c.border})]},o)},o)}function Er(e){window.__c={n:"TabIcon"};const{store:t}=e,{icon:n,isEmptyPage:o}=(0,yn.VK)((()=>({icon:t.hasIcon()&&t.getIcon(),isEmptyPage:t.isEmptyPage()})),[t]);return n?(0,u.jsx)(Pr.Z,{disabled:!0,icon:n,isEmptyPage:o,size:20,style:{marginRight:6}}):null}const Fr=(0,a.defineMessages)({untitledTab:{id:"tabMenuBlock.title.placeholder",defaultMessage:"Untitled"},addTab:{id:"tabMenuBlock.addTab",defaultMessage:"Add tab"},tabListLabel:{defaultMessage:"Tab block",id:"tabBlockMenu.tabListLabel"}});function Zr(e){return{display:"flex",fontSize:14,width:"100%",paddingLeft:8,paddingRight:8,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:1}}function Lr(e){return{display:"flex",fontSize:16,width:"100%",paddingTop:2,paddingLeft:16,paddingRight:16,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:2,height:44,background:e.popoverBackground}}function jr(e){return{background:e.regularDividerColor,right:28,opacity:1,marginTop:6,marginBottom:12,width:1}}function Vr(e){return{borderBottom:`2px solid ${e.regularTextColor}`,position:"absolute",bottom:0,left:0,right:0}}class Ur extends c.Z{constructor(){super(...arguments),this.contentAriaId=(0,ge.Z)(),this.selectedTabAriaId=(0,ge.Z)(),this.storeTypes={shouldShowBottomBorder:h.default.createClass(!1)},this.handleTabClick=e=>{_r.a({store:this.props.store,index:e,currentUserId:this.environment.currentUser.id})},this.handlePlaceholderClick=e=>{H.createAndCommit({userAction:"TabBlock.handlePlaceholderClick",environment:this.environment,perform:t=>{_r.ls({environment:this.environment,store:e,transaction:t})}})},this.handleMouseMove=e=>{const t=e.currentTarget.getBoundingClientRect();this.stores.shouldShowBottomBorder.setState(this.getHoveredState(t,e.clientY))},this.handleMouseEnter=e=>{const t=e.currentTarget.getBoundingClientRect();this.stores.shouldShowBottomBorder.setState(this.getHoveredState(t,e.clientY))},this.handleMouseLeave=()=>{this.stores.shouldShowBottomBorder.setState(!1)},this.getSelectedTabStore=()=>{const e=_r.jL(this.props.store),t=this.props.store.getContentStores();return t.length>e?t[e]:t[0]}}handleCreated(){this.stores.shouldShowBottomBorder.setState(!1)}willMount(e){const t=this.environment.currentUser.id;_r.nz({blockId:this.props.store.id,currentUserId:t})}renderPersisted(){return(0,u.jsxs)("div",{style:this.getStyle(),children:[(0,u.jsxs)("div",{onMouseMove:this.handleMouseMove,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:this.renderTabs()}),this.renderCurrentTab()]}),this.renderDiscussion({style:He.Z.discussionIndicatorStyle,hideIfSidebarOrMarginCommentsVisible:!0})]})}renderCurrentTab(){const e=Eo.b(this.props.store);return(0,u.jsx)("div",{role:"tabpanel",id:this.contentAriaId,"aria-labelledby":this.selectedTabAriaId,style:{position:"relative"},children:(0,u.jsx)(wr.Z,{loaded:e,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:{display:"flex",flexDirection:"column"},children:this.renderLoadedContent()})})}renderLoadedContent(){const e=this.getSelectedTabStore();return e?(0,u.jsx)(J.Z,{store:e,analyticsName:"page_content",canSelect:!1,canDrag:!1,isListContainer:!0,style:{display:"flex",flexDirection:"column"},children:(0,u.jsx)(Y.Z,{store:e.getContentStore(),disabled:this.props.disabled,disableContent:!1,emptyPlaceholder:this.renderPlaceHolder(e)})},e.id):null}renderPlaceHolder(e){return(0,u.jsx)(oe.Z,{style:this.getPlaceholderButtonStyle(),onClick:()=>this.handlePlaceholderClick(e),disabled:!this.canEdit(),children:(0,u.jsx)("span",{style:{color:this.theme.lightTextColor},children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Empty tab. Click or drop blocks inside.",id:"tabBlock.emptyBlock.placeholderText"})})})}renderTabs(){return(0,u.jsx)(Dr,{contentAriaId:this.contentAriaId,selectedTabAriaId:this.selectedTabAriaId,disabled:!this.canEdit(),parentStore:this.props.store,tabs:this.props.store.getContentStores(),selectedIndex:_r.jL(this.props.store),onChange:this.handleTabClick})}getHoveredState(e,t){return!this.props.disabled&&(!!B.Z.state.isDragging||(!!F.Z.state.isActive||t<=e.bottom+20&&t>=e.bottom-20))}getStyle(){return{paddingLeft:Ue.ZD.paddingLeft,flex:1,...this.getBottomBorderStyle(),...this.getBlockColorStyle(),...this.props.style}}getBottomBorderStyle(){return this.stores.shouldShowBottomBorder.state?{boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`}:{}}getPlaceholderButtonStyle(){return{fontSize:"inherit",width:"100%",borderRadius:3,caretColor:this.theme.lightTextColor,...Ue.ZD,marginTop:2}}}const Or=Ur;var Nr=n(15145),zr=n(85031),Hr=n(84210),Wr=n(18514),qr=n(88923),Gr=n(78454);class Kr extends c.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:xe.Z},this.renderHeader=(e,t,n)=>{const o=this.getNavigableAncestor();if(!o)return;const i=(0,Hr.ZP)({store:o,scrollToBlockId:e.id,fullyQualified:!1,pageVisitSource:Nr.tY.LinkInPage}),r=zr.y({headerBlockId:e.id,headerBlockIds:n.map((e=>e.id)),index:t,getRecordModel:this.props.store.getRecordModel});return(0,u.jsx)("div",{style:this.getContainerStyle(),children:(0,u.jsx)(Ae.Z,{href:i,external:!1,children:(0,u.jsx)("div",{style:this.getInnerHeaderStyle(r),children:(0,u.jsx)(Ar.Z,{store:e,shouldWrap:!1,underline:!0})})},e.id)},e.id)},this.handleMouseMove=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.pageHeaderIdsStore=this.createComputedStore((()=>{const e=this.getNavigableAncestor();return e?zr.Q(e.id,this.props.store.getRecordModel):[]}))}renderPersisted(){const{device:e}=this.environment,t=this.getDisabled(),{store:n}=this.props,o=this.pageHeaderIdsStore.state.map((e=>Lo.G.createChildStore(n,{table:Ui.iU,id:e})));return(0,u.jsxs)(ne.p,{allowSelectionWithin:!0,style:Kr.style,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[o.map(this.renderHeader),0===o.length&&(0,u.jsx)("div",{style:{...this.getPlaceholderStyle(),...!t&&e.isMobile&&{marginRight:36}},children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Add headings to create a table of contents. <linktohelpbutton>Learn more</linktohelpbutton>.",id:"tableOfContentsBlock.placeholder",values:{linktohelpbutton:e=>(0,u.jsx)(en.Z,{href:(0,Wr.UY)("guides.tableOfContents"),external:!0,onClick:()=>w.Fsx(this.environment,{from:"table_of_contents_placeholder"}),children:e})}})}),!t&&e.isMobile&&(0,u.jsx)(Te.Z,{style:Kr.actionMenuButtonStyle,tooltipContent:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"More actions…",id:"tableOfContentsBlock.mobileActionMenu.button.label"}),store:this.props.store,fadeIn:!1})]})}getDisabled(){return this.props.disabled||!this.canEdit()}getNavigableAncestor(){const e=this.props.store.getRecordStoreUIRoot(),{mainEditorCurrentBlockStore:t}=zi.default.state;return e===t?t:qr.default.peekTarget.state===e?qr.default.peekTarget.state:void 0}getContainerStyle(){return{...this.getBlockColorStyle(),...this.props.style}}getInnerHeaderStyle(e){return{...Kr.headerTextStyle,display:"flex",alignItems:"center",marginLeft:Gr.LK*e,paddingTop:2*Ue.ZD.paddingTop,paddingBottom:2*Ue.ZD.paddingBottom}}getPlaceholderStyle(){return{...Kr.headerTextStyle,paddingTop:Ue.ZD.paddingTop,paddingBottom:Ue.ZD.paddingBottom,color:this.theme.lightTextColor}}}Kr.style={position:"relative"},Kr.actionMenuButtonStyle={position:"absolute",top:3,right:6},Kr.headerTextStyle={paddingRight:Ue.ZD.paddingRight,paddingLeft:Ue.ZD.paddingLeft,fontSize:14,lineHeight:1.3};const $r=Kr;var Qr=n(17970),Yr=n(11620),Jr=n(4859),Xr=n(91791),ea=n(91497),ta=n(77926);const na=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Tweet",id:"tweetBlock.embedTweet.button.label"}});class oa extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){const{disabled:e}=this.props;return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:ta.l,disabled:e,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with links to Tweets",id:"tweetBlock.linkInput.caption"}),embedButtonText:s.default.formatMessage(na.embedButtonText),urlInputPlaceholder:"https://twitter.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed a Tweet",id:"tweetBlock.placeholder"})})}}const ia=oa;var ra=n(51929);class aa extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:ra.G,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with any public Typeform link",id:"typeformBlock.embed.caption"}),children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Typeform",id:"typeformBlock.placeholder"})})}}const sa=aa;var la=n(95097);const ca=(0,a.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the video link…",id:"videoBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed video",id:"videoBlock.embedVideo.button.label"}});class da extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:la.H,preserveScale:!0,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"},{type:"file",videoUpload:!0}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with YouTube, Vimeo, and more",id:"videoBlock.linkInput.caption"}),embedButtonText:s.default.formatMessage(ca.embedButtonText),urlInputPlaceholder:s.default.formatMessage(ca.urlPlaceholder),children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed or upload a video",id:"videoBlock.placeholder"})})}}const ua=da;var pa=n(98616);const ma=(0,a.defineMessages)({embedButtonText:{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.embeds.button.label"}});class fa extends c.Z{constructor(){super(...arguments),this.storeTypes={blockResizerStore:l.Z}}renderPersisted(){return(0,u.jsx)(d.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:pa.A,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Works with Whimsical links with Public Link Access enabled",id:"whimsicalBlock.embeds.caption"}),embedButtonText:s.default.formatMessage(ma.embedButtonText),urlInputPlaceholder:"https://whimsical.com/…",children:(0,u.jsx)(a.FormattedMessage,{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.placeholder"})})}}const ga=fa;let ha;function va(e){const t=e.getType();if(t)return"collection_view"===t&&e.recordStoreParentDiffersFromPersistedParent()?pn.Z:(ha||(ha={text:Qr.Z,image:fi.Z,video:ua,bookmark:Ve,drive:go,audio:me,tweet:ia,gist:li,maps:Xi,framer:ii,invision:bi,file:ei.Z,page:cr.Z,to_do:Yr.Z,toggle:Jr.Z,bulleted_list:He.Z,numbered_list:lr.Z,code:sn,factory:Qo,button:We.Z,divider:eo,column_list:Un,copy_indicator:Wn,embed:d.Z,breadcrumb:ze,equation:wo,header:ci.Z,sub_header:Sr.Z,sub_sub_header:X.Z,quote:ur.Z,collection_view:un.D,collection_view_page:pn.Z,link_to_page:qi,link_to_collection:ji,figma:Xo,loom:$i,codepen:dn,typeform:sa,column:Nn,pdf:dr.Z,callout:qe.Z,table_of_contents:$r,whimsical:ga,miro:or,abstract:f,sketch:yr,excalidraw:xo,alias:ce.Z,transclusion_container:Xr.Z,transclusion_reference:ea.Z,replit:gr,external_object_instance:To.Z,table:o.Wv,table_row:o.fZ,tab:Or,hex:mi,deepnote:$n,mixpanel:sr,external_object_instance_page:To.Z,ai_block:le,drawing:oo,personal_home_page:void 0}),ha[t])}},59557:(e,t,n)=>{n.d(t,{N:()=>d});var o=n(67294),i=n(480),r=n(86628),a=n(97880),s=n(39699),l=n(37181),c=n(80444);function d(e){const{blockStore:t}=e,n=(0,i.O7)(),d=(0,r.VK)((()=>c.default.state.currentUserSettingsStore),[]),u=(0,r.VK)((()=>{var e;return(0,a.$K)(null===(e=t.getModel())||void 0===e?void 0:e.getProperty("title"))}),[t]),p=(0,o.useCallback)((()=>{d&&s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:n,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{dismissed_factory_button_deprecation_banner:!0}})}})}),[d,n]),m=(0,o.useCallback)((()=>{if(!d)return;d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue()||s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:n,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{seen_factory_button_deprecation_badge:!0}})}})}),[d,n]);return{showFactoryButtonDeprecationBadge:(0,r.VK)((()=>u&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue())),[d,u]),showFactoryButtonDeprecationBanner:(0,r.VK)((()=>u&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("dismissed_factory_button_deprecation_banner").getValue())),[d,u]),handleDismissFactoryButtonMigrationBanner:p,setHasSeenFactoryButtonDeprecationBadge:m}}},97053:(e,t,n)=>{n.d(t,{Bt:()=>_,Nr:()=>b,Qg:()=>S,h9:()=>v,m4:()=>h,xC:()=>y});var o=n(480),i=n(97511),r=n(86628),a=n(41432),s=n(61045),l=n(57819),c=n(19124),d=n(12534),u=n(80444),p=n(16772),m=n(19111),f=n(94896),g=n(17963);function h(e){(0,d.ZP)({event:e,context:d.Af.EditorMouseDown,callback:()=>{}})}function v(e){(0,d.ZP)({event:e,context:d.Af.EditorClick,callback:()=>{}})}function b(e){return(0,r.VK)((()=>Boolean(g.Z.state.pageMap[e.id])||f.Z.state.pages.has(e.id)),[e.id])}function y(e){const t=(0,o.O7)(),n=(0,i.l)(),a=b(e),s=(0,r.VK)((()=>u.default.state.currentLoadingContainerStore),[]),l=S(e);return(0,r.VK)((()=>{const o=t.currentUser.isLoggedIn(),i=n&&n.publicEditModeStore.state;return Boolean(e&&s&&e.isDefined()&&!e.isLocked()&&e.canEdit()&&!e.hasContent()&&o&&(!(null!=i&&i.hasPublicPermission)||"edit"===(null==i?void 0:i.permission))&&!a&&s.state.ready&&!l&&(!(0,c.GD)(i)||"completionPopup"!==p.default.state.type))}),[t,l,s,n,a,e])}function S(e){return(0,r.VK)((()=>{if(e.isCollectionView()){const t=e.getCollectionViewSourceCollectionStore();return!!t&&t.isSyncedCollection()}return e.isType(a.Ti.externalObjectInstancePage)}),[e])}function _(e){const{device:t,WindowSizeStore:n}=(0,o.O7)(),i=(0,r.VK)((()=>{const e=n.state.height,o=t.isMobile&&m.Z.state.open?e:0;return s._4()+o}),[n,t.isMobile]);return(0,r.VK)((()=>Boolean((0,l.RR)(p.default.state))?600:t.isTablet?380:t.isIOS?Math.max(350,i):t.isMobile?400:"side-peek"===e||"center-peek"===e||"home"===e?80:"30vh"),[t,i,e])}},29551:(e,t,n)=>{n.d(t,{Ht:()=>s,gq:()=>a});var o=n(67294),i=n(85893);function r(e){const{style:t,row:n,column:o,reverse:i,inline:r,...a}=e,s={display:r?"inline-flex":"flex"};return o?s.flexDirection=i?"column-reverse":"column":n?s.flexDirection=i?"row-reverse":"row":i&&(s.flexDirection="row-reverse"),Object.assign(s,a,t)}class a extends o.Component{static styles(){return r({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},row:!0})}render(){const{children:e,className:t,...n}=this.props;return(0,i.jsx)("div",{className:t,style:a.styles(n),children:e})}}class s extends o.Component{static styles(){return r({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},column:!0})}render(){const{children:e,className:t,...n}=this.props;return(0,i.jsx)("div",{className:t,style:s.styles(n),children:e})}}},17377:(e,t,n)=>{n.d(t,{Z:()=>_});n(67294);var o=n(83355),i=n(53150),r=n(49271),a=n(5366),s=n(29373),l=n(39699),c=n(52315),d=n(35328),u=n(77080),p=n(45131),m=n(64921),f=n(25777),g=n(55217),h=n(78454),v=n(4859),b=n(5210),y=n(85893);class S extends o.Z{constructor(){super(...arguments),this.descriptionAriaId=(0,i.Z)(),this.contentAriaId=(0,i.Z)(),this.isToggleable=this.createComputedStore((()=>{const{store:e}=this.props.blockComponent.props;return d.fn(e)})),this.blockHasContent=this.createComputedStore((()=>{var e;const{store:t}=this.props.blockComponent.props;return null===(e=t.getFormat())||void 0===e?void 0:e.toggleable})),this.toggle=()=>{d.th(this.props.blockComponent)},this.isOpen=this.createComputedStore((()=>{const{store:e,hideContent:t}=this.props.blockComponent.props;return p.Z.isOpen(e.id)&&!t})),this.isEmpty=this.createComputedStore((()=>{const{store:e}=this.props.blockComponent.props;return!e.hasContent()})),this.handlePlaceholderClick=()=>{const{store:e}=this.props.blockComponent.props;l.createAndCommit({userAction:"FormatToggleable.handlePlaceholderClick",environment:this.environment,perform:t=>{s.ls({environment:this.environment,store:e,transaction:t})}})}}willMount(){const{store:e}=this.props.blockComponent.props;s.nz({blockId:e.id,currentUserId:this.environment.currentUser.id}),e.isDefaultRecordCache()&&s.LO(this.environment,e.pointer)}renderToggleButton(){return(0,y.jsx)(b.Z,{"aria-describedby":this.descriptionAriaId,"aria-controls":this.contentAriaId,isSidebar:!1,open:this.isOpen.state,fill:!this.isEmpty.state,onClick:this.toggle,tapArea:this.environment.device.isMobile?{size:30}:void 0})}renderPlaceHolder(){const{disabled:e}=this.props.blockComponent.props;return(0,y.jsx)(m.Z,{style:{fontSize:"inherit",width:"100%",borderRadius:3,caretColor:this.theme.lightTextColor,...r.ZD,marginTop:2},onClick:this.handlePlaceholderClick,disabled:e,children:(0,y.jsx)("span",{style:{color:this.theme.lightTextColor},children:(0,y.jsx)(a.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlockFormat.emptyBlock.placeholderText"})})})}renderContent(){const{disabled:e,store:t,disableCommentMenu:n,disableHoverMenu:o,disableDrag:i}=this.props.blockComponent.props,r=c.b(t)||!t.isDefaultRecordCache(),a=u.default.checkGate("layout_toggles");return this.isOpen.state?(0,y.jsx)(f.Z,{id:this.contentAriaId,loaded:r,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:v.Z.getContentStyle(a),style:v.Z.getContainerStyle(a),children:(0,y.jsx)(g.Z,{store:t.getContentStore(),emptyPlaceholder:this.isToggleable.state?this.renderPlaceHolder():void 0,disabled:e,disableCommentMenu:n,disableHoverMenu:o,disableDrag:i})}):(0,y.jsx)(g.Z,{store:t.getContentStore(),disabled:e,disableContent:!0})}renderComponent(){const{children:e,childrenStyleWhenToggleable:t}=this.props;return this.isToggleable.state?(0,y.jsxs)(h.ZP,{style:{paddingLeft:r.ZD.paddingLeft},left:this.renderToggleButton(),leftStyle:{paddingRight:2,...this.props.toggleStyle},children:[(0,y.jsx)("div",{id:this.descriptionAriaId,style:t,children:e}),this.renderContent()]}):this.blockHasContent.state?(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,y.jsx)("div",{style:t,children:e}),this.renderContent()]}):e}}S.displayName="FormatToggleable";const _=S},26198:(e,t,n)=>{n.d(t,{Lr:()=>a,jo:()=>l,uf:()=>r});var o=n(67294),i=n(67381);const r={track(e,t){t(!0)},untrack(e){}},a=(0,i.Q)({modernContextDefaultValue:r,displayName:"IFrameManagerContext",legacyContextKey:"iFrameManagerContext"}),s=(a.legacyPropTypes,a.context);function l(){const e=(0,o.useContext)(s),[t,n]=(0,o.useState)(!1),i=(0,o.useRef)(null);return[(0,o.useCallback)((t=>{i.current&&(e.untrack(i.current),i.current=null),t&&(i.current=t,e.track(t,n))}),[e]),t]}},66213:(e,t,n)=>{n.d(t,{LF:()=>i,ZO:()=>a,wK:()=>r});const o=(0,n(67381).Q)({modernContextDefaultValue:void 0,displayName:"OverrideLinkClickContext",legacyContextKey:"overrideLinkClick"}),i=o.Provider,r=o.legacyPropTypes,a=o.context},11368:(e,t,n)=>{n.d(t,{I3:()=>r,Ue:()=>a,zR:()=>i});const o=(0,n(67381).Q)({displayName:"ScrollerContext",legacyContextKey:"scrollerContext",modernContextDefaultValue:void 0}),i=o.Provider,r=o.legacyPropTypes,a=o.context},84064:(e,t,n)=>{n.d(t,{Tf:()=>s,aT:()=>a,ld:()=>l});const o={selectableContainer:void 0,closestSelectable:void 0},i="selectable",r=(0,n(67381).Q)({modernContextDefaultValue:o,displayName:i,legacyContextKey:i}),a=r.context,s=r.legacyPropTypes,l=r.Provider},78791:(e,t,n)=>{n.d(t,{Cf:()=>g,Wc:()=>h,tE:()=>f});var o=n(41432),i=n(15095),r=n(59730),a=n(70203),s=n(97880),l=n(82798),c=n(97444),d=n(39699),u=n(46888),p=n(73959),m=n(65273);function f(e){const{transaction:t,targetStore:n,block:o}=e,i=(0,l.TO)(o.getTextSliceTree()),a=(0,p.sQ)(n);if(!a||!m.Ls({store:n,blockStore:a}))throw new r.p8("Previous block should exist and use CRDT");const c=(0,l.TO)(a.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal(),u=i.getOperationsForSplitAtIndex(0);if("splitNodeEnd"===u.type){const{newTextSliceTree:e,textSliceTreesToMove:n}=u;d.applyOperation({transaction:t,store:o,operation:{command:"moveTextSlice",pointer:o.pointer,path:[],args:{textInstanceId:e.getTextSlice().textInstanceId,textSliceStartItemId:e.getTextSlice().getStartItem().id,targetBlockId:a.id,targetTextInstanceId:c.getTextSlice().textInstanceId,targetTextSliceEndItemId:c.getTextSlice().getEndItem().id}}});for(const i of n)d.applyOperation({transaction:t,store:o,operation:{command:"moveTextSlice",pointer:o.pointer,path:[],args:{textInstanceId:i.getTextSlice().textInstanceId,textSliceStartItemId:i.getTextSlice().getStartItem().id,targetBlockId:a.id,targetTextInstanceId:e.getTextSlice().textInstanceId,targetTextSliceEndItemId:e.getTextSlice().getEndItem().id}}})}else"splitWithinNode"===u.type?((0,l.T)(0===u.textSliceTreesToMove.length,"Root nodes should have no siblings to move"),d.applyOperation({transaction:t,store:o,operation:{command:"splitText",pointer:o.pointer,path:[],args:u.splitOp}}),d.applyOperation({transaction:t,store:o,operation:{command:"moveTextSlice",pointer:o.pointer,path:[],args:{textInstanceId:u.splitOp.textInstanceId,textSliceStartItemId:u.splitOp.id,targetBlockId:a.id,targetTextInstanceId:c.getTextSlice().textInstanceId,targetTextSliceEndItemId:c.getTextSlice().getEndItem().id}}})):(0,s.t1)(u)}function g(e){const{environment:t,transaction:n,multiSelection:i,removedBlocks:r,movedBlocks:a}=e,s=i.start.store;function d(e){if(a.has(e))return;const r=e.getModel();if(null==r||!r.isType(o.wL))return;const d=e.getBlockTitleStore();(0,l.T)(m.FX(d)),d!==i.end.store&&(c.pe({environment:t,transaction:n,selection:{startIndex:0,endIndex:1/0},store:d}),f({transaction:n,block:e,targetStore:s}))}(0,l.T)(m.FX(s));for(const o of r){d(o);for(const e of(0,u.c)([o]))d(e)}}function h(e){const{sourceBlockStore:t,targetBlockStore:n,splitAtGraphemeIndex:o,transaction:r,moveIntoNewBlock:s}=e;(0,l.T)(t.useCrdt()&&n.useCrdt());const c=t.getBlockTitleStore().getValue(),u=new i.W3(a.eeV(c)).getStringStartIndex(o),p=(0,l.TO)(t.getTextSliceTree()).getOperationsForSplitAtIndex(u);!function(e){const{blockStore:t,splitInfo:n,transaction:o}=e,i=n.textSliceTreesToMove,r="splitWithinNode"===n.type?n.textSliceTreeToSplit:n.newTextSliceTree;for(const a of i){const e=t.id,n=r.getTextSlice().textInstanceId,i=r.getTextSlice().getEndItem().id;d.applyOperation({transaction:o,store:t,operation:{command:"moveTextSlice",pointer:t.pointer,path:[],args:{textInstanceId:a.getTextSlice().textInstanceId,textSliceStartItemId:a.getTextSlice().getStartItem().id,targetBlockId:e,targetTextInstanceId:n,targetTextSliceEndItemId:i}}})}}({blockStore:t,splitInfo:p,transaction:r}),s?function(e){const{sourceBlockStore:t,targetBlockStore:n,splitInfo:o,transaction:i}=e;if("splitNodeEnd"===o.type){const e=o.newTextSliceTree;d.applyOperation({transaction:i,store:t,operation:{command:"moveTextSliceIntoBlock",path:[],pointer:t.pointer,args:{textInstanceId:e.getTextSlice().textInstanceId,textSliceStartItemId:e.getTextSlice().getStartItem().id,targetBlockId:n.id}}})}else{const e=o.splitOp;d.applyOperation({transaction:i,store:t,operation:{command:"splitTextIntoBlock",pointer:t.pointer,path:[],args:{...e,targetBlockId:n.id}}})}}({sourceBlockStore:t,targetBlockStore:n,splitInfo:p,transaction:r}):function(e){const{sourceBlockStore:t,targetBlockStore:n,splitInfo:o,transaction:i}=e;let r,a;if("splitNodeEnd"===o.type){const e=o.newTextSliceTree;r=e.getTextSlice().textInstanceId,a=e.getTextSlice().getStartItem().id}else d.applyOperation({transaction:i,store:t,operation:{command:"splitText",pointer:t.pointer,path:[],args:o.splitOp}}),r=o.splitOp.textInstanceId,a=o.splitOp.id;const s=(0,l.TO)(n.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal();d.applyOperation({transaction:i,store:t,operation:{command:"moveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:r,textSliceStartItemId:a,targetBlockId:n.id,targetTextInstanceId:s.getTextSlice().textInstanceId,targetTextSliceEndItemId:s.getTextSlice().getEndItem().id}}})}({sourceBlockStore:t,targetBlockStore:n,splitInfo:p,transaction:r})}},65273:(e,t,n)=>{n.d(t,{PR:()=>m,FX:()=>c,Ls:()=>d,iG:()=>u,be:()=>p});var o=n(19056),i=n(59730),r=n(21202),a=n(73959),s=n(82798);class l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;this.value=e,this.textInstanceId=t;const n=l.overrides.get(t);n&&e>n&&this.updateOverride()}get(){return l.overrides.get(this.textInstanceId)??this.value}set(e){const t=this.get();(0,s.T)(e>=t),this.value=e,this.updateOverride()}updateOverride(){l.overrides.set(this.textInstanceId,this.value)}static TEST_ONLY__clearOverrides(){this.overrides.clear()}}function c(e){if(!e.isTable(r.iU))return!1;const t=(0,a.sQ)(e);return!!t&&(t.useCrdt()&&t.getBlockTitleStore()===e)}function d(e){const{store:t,blockStore:n}=e;return n.useCrdt()&&n.getBlockTitleStore()===t}function u(e,t){const n=e.useCrdt(),o=t.some((e=>e.useCrdt()));return n&&!o||!n&&o}function p(e){const{parentStore:t,childStore:n}=e,o=(0,a.sQ)(t,!0),r=(0,a.sQ)(n,!0);if(o&&r&&u(o,[r]))throw new i.p8("A CRDT block cannot be parented to a non-CRDT block or vice versa!")}function m(e){const t={};for(const[n,i]of Object.entries(e))t[n]=new o.Z(new l(i,n));return t}l.overrides=new Map},11059:(e,t,n)=>{n.d(t,{Z:()=>c});n(67294);var o=n(480),i=n(86628),r=n(22377),a=n(60682),s=n(24990),l=n(85893);const c=function(e){let{char:t,size:n,sprite:c}=e;window.__c={n:"Emoji"};const d=(0,o.O7)(),u=(0,i.VK)((()=>c||(0,a.e_)(d)),[d,c]),p=(0,i.VK)((()=>s.Z.state),[]);return(0,l.jsx)(r.Z,{char:t,size:n,type:u,emojiData:p})}},72187:(e,t,n)=>{n.d(t,{$P:()=>b,FZ:()=>f,II:()=>a,IQ:()=>o,Nm:()=>r,PS:()=>m,T8:()=>l,VJ:()=>v,WB:()=>c,fG:()=>h,jo:()=>u,kX:()=>p,mz:()=>d,pq:()=>s,qJ:()=>y,tg:()=>i,vP:()=>g});const o=12,i=9,r=2,a=12,s=16,l=32,c=24,d=44,u=32,p=356,m=12,f=l*o+2*m,g=9,h=f,v=270,b=10,y=2},60682:(e,t,n)=>{n.d(t,{e_:()=>a,kw:()=>s,sg:()=>l});var o=n(480),i=n(86628),r=n(80444);function a(e){const{device:t}=e;return t.isAndroid&&t.browserVersion.startsWith("73.")&&t.browserName.startsWith("Chrome")||t.isAndroid?"google":t.isWindows||t.isLinux?"twitter":"raw"}function s(){const e=(0,o.O7)();return(0,i.VK)((()=>a(e)),[e])}function l(){var e;return null===(e=r.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}},24990:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(2991);class r extends o.default{getInitialState(){return{positionalEmojiData:{},emojiByName:{},emojiByCategory:{}}}async waitUntilLoaded(){await(0,i.MH)()}}const a=new r},69783:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},21830:(e,t,n)=>{n.d(t,{XH:()=>y,pz:()=>h,qv:()=>g,vZ:()=>p,zp:()=>f});n(21703);var o=n(37599),i=n(92595),r=n(7406),a=n(68626),s=n(91155),l=n(29477),c=n(63143),d=n(5366),u=n(33929);const p="NotionTransactionTimeout",m=(0,d.defineMessages)({ReloadAllTabs:{defaultMessage:"Try closing and re-opening all Notion tabs or windows. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.reloadAllTabs"},ReloadThisTab:{defaultMessage:"Try reloading Notion. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.reloadThisTab"},AppProfileCorrupted:{defaultMessage:"Notion's local storage may be damaged. See (?) > Help & documentation > Reset Notion. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.helpAndSupportPrompt"},FirefoxProfileCorrupted:{defaultMessage:"Your Firefox profile may be damaged. Visit https://firefox-storage-test.glitch.me/ to diagnose. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.firefoxSettingsDamaged"},ChromeProfileCorrupted:{defaultMessage:"Your Chrome profile may be damaged. If you changed any chrome://flags then please reset them, then restart your browser. If issues persist, try making a new Chrome user. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.chromeSettingsDamaged"},ChromeIndexedDBBucketError:{defaultMessage:"Your Chrome profile may be damaged. For a more consistent experience download the Notion desktop app: https://notion.so/desktop",id:"localDatabase.errorFixes.chromeUpgradeCorruptedSettings"},noDiskSpace:{defaultMessage:"No disk space remaining. Contact support if that doesn’t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemaining"},noDiskSpaceBrowserLimit:{defaultMessage:"No disk space remaining. Your browser settings may restrict the storage Notion can use. Contact support if that doesn’t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemainingBrowserLimit"}});function f(e){return e}function g(e){return Promise.all(e)}class h{constructor(e,t,n,o){this.databaseName=void 0,this.databaseVersion=void 0,this.debugLogger=new a.BatchedLogger({from:"IndexedDBWrapper",type:"BulkDebug",level:"info",maxLength:100,logToConsole:false}),this.latestTransactionId=0,this.openDbCallbacks=void 0,this.db=void 0,this.getDBPromise=void 0,this.environment=e,this.databaseName=t,this.databaseVersion=n,this.openDbCallbacks=o}async reset(){try{return await(0,o.Lj)(this.databaseName),{value:void 0}}catch(e){return{error:v({environment:this.environment,error:(0,r.tg)(e),details:`Failed to reset database ${this.databaseName}`,closed:!1,aborted:!1})}}finally{this.teardown()}}async startTransaction(e,t){const n="startTransaction";let o,i=0;const r=`${e.name}.${this.latestTransactionId++}`;do{try{const s=`${r} attempt #${i+1}`;if(this.debugLogInfo(n,`${s} starting`),o=await this.startTransactionAttempt({...e,name:r},t),!o.error){this.debugLogInfo(n,`${s} succeeded`);break}const c=`${s} errored, type=${o.error.type}`;if(!o.error.closed){this.debugLogInfo(n,`${c}, closed=false`);break}if(this.debugLogInfo(n,`${c}, closed=true`),this.db)try{this.db.close()}catch(a){this.debugLogInfo(n,`db.close() threw ${a}`)}if(this.teardown(),4===i)break;await l.Vs(250)}catch(a){return{error:a}}i++}while(i<5);return o}async startTransactionAttempt(e,t){const{storeNames:n,name:o,mode:i,timeoutMs:l}=e,c=`${o} failed`,d="startTransactionAttempt",u=await this.getDB();if(u.error)return u;const p=u.value,m=[];let f;try{f=p.transaction(n,i);const e=Date.now(),t=window.setTimeout((()=>{const t=Date.now()-e,n=`${o} has not completed after ${t} ms, which may prevent other transactions from running.`;this.debugLogInfo(d,n),a.log({from:"IndexedDBWrapper",type:"LongRunningTransactionWarning",level:"warning",data:{message:n,miscDataToConvertToString:{transactionLog:m}}})}),h.longRunningTimeoutMs);f.addEventListener("complete",(function(){window.clearTimeout(t)}));const r=e=>{e.stopPropagation(),window.clearTimeout(t)};f.addEventListener("error",r),f.addEventListener("abort",r)}catch(b){const e=(0,r.tg)(b);return{error:v({environment:this.environment,details:`Failed to create ${i} transaction on ${this.databaseName}.${n}`,error:e,aborted:!0,closed:"InvalidStateError"===e.name})}}const g=await this.runTransaction(f,t,o,l,(e=>{a.pushWithMaxLength(m,e,100)}));if("error"in g||g.abort){this.debugLogInfo(d,`${o} command returned failed/aborted status`);try{f.abort()}catch(y){this.debugLogInfo(d,`transaction.abort() threw ${y}`)}return f.done.catch((e=>{e&&a.log({from:"IndexedDBWrapper",type:"TransactionFailure",level:"error",error:(0,s.Ui)(v({environment:this.environment,details:c,error:e,aborted:!0,closed:!1}))})})),g}if(this.debugLogInfo(d,`${o} command returned successful status`),"readwrite"===i)try{await f.done}catch(y){return{error:v({environment:this.environment,error:(0,r.tg)(y),details:`In await transaction.done: ${c}`,aborted:null===y,closed:!1})}}else f.done.catch((e=>{a.log({from:"IndexedDBWrapper",type:"ReadOnlyTransactonFailureIgnored",level:"error",error:(0,s.Ui)(v({environment:this.environment,error:e,details:c,aborted:null===e,closed:!1}))})}));return{value:g.value}}freezeListener(){Boolean(this.db)&&(this.debugLogInfo("freezeListener"),a.log({level:"warning",from:"IndexedDBWrapper",type:"document.freeze",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}))}teardown(){this.debugLogInfo("teardown"),this.db=void 0,this.getDBPromise=void 0,document.removeEventListener("freeze",this.freezeListener)}debugLogInfo(e,t){this.debugLogger.log({from:"IndexedDBWrapper",level:"info",type:e,data:{message:t}})}async initDB(){try{this.debugLogInfo("initDB","Starting openDB()");const e=await(0,o.X3)(this.databaseName,this.databaseVersion,this.openDbCallbacks);return this.debugLogInfo("initDB","Completed openDB()"),document.addEventListener("freeze",this.freezeListener),e.addEventListener("close",(e=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onclose",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,s.Ui)(b(e))}),this.teardown()})),e.addEventListener("abort",(e=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onabort",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}})})),e.addEventListener("error",(e=>{a.log({level:"error",from:"IndexedDBWrapper",type:"db.onerror",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,s.Ui)(b(e))})})),e.addEventListener("versionchange",(()=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onversionchange",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}),e.close(),this.teardown()})),{value:e}}catch(e){return{error:v({environment:this.environment,details:"Unable to initialize database",error:(0,r.tg)(e),aborted:!1,closed:!1})}}}async getDB(){let e=this.db;if(!e){this.getDBPromise||(this.getDBPromise=this.initDB().then((e=>(e.error?this.teardown():(this.db=e.value,this.getDBPromise=void 0),e)),(e=>(this.teardown(),{error:{type:"InitDBException",message:"An unexpected error occurred trying to create the database.",details:"Exception in initDB",error:e,closed:!1,aborted:!1}}))));const t=await this.getDBPromise;if(t&&t.error)return t;e=t.value}return{value:e}}async runTransaction(e,t,n,o,i){try{const r=Date.now(),a=t(e,(e=>{this.debugLogInfo("runTransaction",`${n} command: ${e}`),i(e)}));if(void 0!==o&&o>=0){const e=await l.aM(a,o);if(e.timeout){const e=Date.now()-r,t=new Error(`Timeout after ${e}ms: exceeded limit ${o}ms by ${e-o}ms`);throw t.name=p,this.debugLogInfo("runTransaction",`${n} ${t.name}: ${t.message}`),this.debugLogger.flush(),t}return e.result}i("Awaiting commandResultPromise.");const s=await a;return i("Done awaiting commandResultPromise."),s}catch(a){return{error:v({environment:this.environment,error:(0,r.tg)(a),details:`In runTransaction catch: ${n} failed`,closed:!1,aborted:!1})}}}}function v(e){const{environment:t,error:n,details:o,closed:i,aborted:r}=e;if(n){if(n.name===p)return{type:p,details:o,message:`Storage operation did not complete. ${u.default.formatMessage(m.ReloadAllTabs)}`,error:n,closed:!1,aborted:!1};if("TimeoutError"===n.name&&"Transaction timed out due to inactivity."===n.message)return{type:"TransactionTimeout",details:o,message:`IndexedDB access attempt timed out. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:i,aborted:r};if("VersionError"===n.name)return{type:"OutdatedSchemaVersion",details:o,message:`This tab is running an outdated version of Notion. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:i,aborted:r};if("UnknownError"===n.name&&"Internal error opening backing store for indexedDB.open."===n.message)return{type:"ChromeUnknownInternalError",details:o,message:`Cannot open IndexedDB. ${t.device.isNative?u.default.formatMessage(m.AppProfileCorrupted):u.default.formatMessage(m.ChromeProfileCorrupted)}`,error:n,closed:i,aborted:r};if(t.device.isBrowser&&"UnknownError"===n.name&&"Internal error retrieving bucket data directory."===n.message)return{type:"ChromeUnknownInternalError",details:o,message:u.default.formatMessage(m.ChromeIndexedDBBucketError),error:n,closed:i,aborted:r};if("SecurityError"===n.name&&"IDBFactory.open() called in an invalid security context"===n.message)return{type:"SafariIframeSecurityError",details:o,message:"Cannot access IndexedDB in an iframe in your browser. Try opening Notion in a new window or use a different browser.",error:n,closed:i,aborted:r};if("UnknownError"===n.name&&"Connection to Indexed Database server lost. Refresh the page to try again"===n.message)return{type:"SafariIndexedDatabaseServerLost",details:o,message:`Cannot access IndexedDB due to a bug in Safari/WebKit. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:i,aborted:r};if("InvalidStateError"===n.name&&"A mutation operation was attempted on a database that did not allow mutations."===n.message)return{type:"FirefoxPrivateBrowsing",details:o,message:"Firefox does not allow IndexedDB in Private Browsing. Try opening Notion in a normal window.",error:n,closed:i,aborted:r};if("NotFoundError"===n.name&&"The operation failed because the requested database object could not be found. For example, an object store did not exist but was being opened."===n.message)return{type:"FirefoxObjectStoreNotFound",details:o,message:`An IndexedDB object store does not exist. ${u.default.formatMessage(m.ReloadAllTabs)} ${u.default.formatMessage(m.FirefoxProfileCorrupted)}`,error:n,closed:!0,aborted:r};if("QuotaExceededError"===n.name){let e=u.default.formatMessage(m.noDiskSpace);return t.device.isBrowser&&(e=u.default.formatMessage(m.noDiskSpaceBrowserLimit)),{type:"QuotaFull",details:o,message:e,error:n,closed:i,aborted:r}}if(window.navigator.userAgent.includes("WindowsWechat")&&"AbortError"===n.name&&"Version change transaction was aborted in upgradeneeded event handler."===n.message)return{type:"UnsupportedWechat",details:o,message:"This device or application is unsupported.",error:n,closed:i,aborted:r}}return{type:"UnknownIndexedDBError",details:o,message:`An unknown IndexedDB error occurred. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n||new Error("createIndexedDBError: error was falsy"),closed:i,aborted:r}}function b(e){if(e&&e.target&&"error"in e.target){const t=e.target.error;if(!t)return;return`${t.name}: ${t.message}`}}function y(e,t){if(e.stack)return e;try{const n=new Error(`${e.message} (${t})`);throw n.name=e.name,n}catch(n){return e.stack=(0,r.tg)(n).stack,e}}h.longRunningTimeoutMs=5*c.hM,(0,i.exposeDebugValue)("idbUnwrap",o.Wg)},2414:(e,t,n)=>{n.d(t,{h:()=>i});var o=n(29477);class i{constructor(e){this.SCALE=1.5,this.MAX=15,this.waitable=new o.a6,this.failures=0,this.observer=e}getDelay(e){return Math.min(this.MAX,Math.pow(this.SCALE,e))}reset(){var e;this.waitable.trigger(),this.waitable=new o.a6,this.failures=0,null===(e=this.observer)||void 0===e||e.onReset()}async backOffOnFailure(e,t){var n;const i=this.failures;this.failures++;const r=e*this.getDelay(i)-e;null===(n=this.observer)||void 0===n||n.onBackoff(r,t),await this.waitable.wait(e,r),this.waitable=new o.a6}getFailures(){return this.failures}}},68204:(e,t,n)=>{n.d(t,{E$:()=>a,L1:()=>l,RP:()=>s,sG:()=>r,vG:()=>c});n(57658);var o=n(58573),i=n(72126);function r(e){const{sections:t,context:n,query:r}=e;let a=r.trim().toLowerCase();if(a.startsWith("/")&&(a=a.slice(1)),!a)return l(t,n);const s=function(e){return e.map((e=>({...e,actions:e.actions.map((t=>{const n=t.searchName||t.displayName||"",o=[n,e.searchTitle||e.title||"",n].join(" ");return{...t,searchName:o}}))})))}(l(function(e,t){const n=[];for(const o of e){const e={...o,actions:[]};for(const i of o.actions)if(i.subActions){if(i.collapseSubActionsIntoParent){for(const n of i.subActions(t))for(const t of n.actions)e.actions.push(t);continue}const r=i.subActions(t).map((e=>({...e,key:`${o.key} ${i.key} ${e.key}`,title:e.title||i.displayName,searchTitle:[i.searchName||i.displayName,e.searchTitle||e.title].filter(Boolean).join(" ")})));for(const e of r)n.push(e)}else e.actions.push(i);e.actions.length&&n.push(e)}return n}(t,n),n)),c=[],d=new Map;for(const o of s)for(const e of o.actions)d.set(e,o),c.push(e);const u=(0,o.ZP)(a,c,(e=>e.searchName||""),{minThreshold:25,getSortScore:e=>-e.score*(e.original.sortScoreMultiplier??1)}),p=new Set(u),m=c.filter((e=>Boolean(e.alwaysShowInSearch)&&!p.has(e))),f=m.filter((e=>"start"===e.alwaysShowInSearch)),g=m.filter((e=>"end"===e.alwaysShowInSearch)),h=i.vM([...f,...u,...g],(e=>{const t=d.get(e);if(t)return t.title})),v=[];for(const o of Object.keys(h)){const e=h[o],t=d.get(e[0]);t&&v.push({...t,actions:e})}return v}function a(e,t){if(!t)return e;let n=0;const o=[];for(const i of e){if(n>=t)break;const e=i.actions.slice(0,t-n);e.length>0&&(n+=e.length,o.push({...i,actions:e}))}return o}function s(e,t){const n=[];for(const o of e){const e=o.actions.filter(t);e.length>0&&n.push({...o,actions:e})}return n}function l(e,t){return s(e,(e=>c(e,t)))}function c(e,t){if(e.validators){return e.validators.every((e=>e(t)))}return!0}},19037:(e,t,n)=>{n.d(t,{S4:()=>Jt,xD:()=>de,AK:()=>an,j2:()=>cn,XQ:()=>tt,Eo:()=>et,v_:()=>ln,wF:()=>Ge,ro:()=>$e,sR:()=>Ot,O4:()=>Ut,_J:()=>Kt,cW:()=>Nt,nW:()=>Ce,zz:()=>ke,RF:()=>Ie,U4:()=>Lt,U_:()=>be,eo:()=>Se,OO:()=>vn,J5:()=>ve,k5:()=>ye,KE:()=>he,M:()=>ge,NW:()=>Pt,vy:()=>At,Zk:()=>gn,IT:()=>nt,FS:()=>Fe,YB:()=>Xe,iJ:()=>Mt,TK:()=>Tt,IC:()=>Wn,xk:()=>Pe,ry:()=>Me,Kb:()=>pn,Jl:()=>fn,Kh:()=>Rt,T2:()=>Dt,lr:()=>Kn,OT:()=>Rn,W3:()=>En,p4:()=>Bn,zO:()=>Zn,l$:()=>He,KJ:()=>Ue,z2:()=>Dn,EJ:()=>Fn,W5:()=>Pn,y9:()=>sn,iK:()=>Yt,_T:()=>ft,lA:()=>Le,b4:()=>je,Dt:()=>lt,k6:()=>_n,Vw:()=>zt,UI:()=>$t,W2:()=>ze,fy:()=>jn,xw:()=>bt,YG:()=>kt,f7:()=>St,dM:()=>xt,p5:()=>Hn,zX:()=>We,oY:()=>Qt,Vf:()=>Ze,VB:()=>Ne,P5:()=>Nn,FY:()=>qe,D:()=>Ft,RO:()=>un,d:()=>ot,ar:()=>it,Vc:()=>qn,QL:()=>Ye,K5:()=>_e,LH:()=>we,$H:()=>Ve,J8:()=>Je,Mg:()=>Ct,nJ:()=>Vt,gn:()=>st,US:()=>An,IZ:()=>_t,Nn:()=>en,vj:()=>It,OX:()=>Gn,JF:()=>Ee,fI:()=>Be,wT:()=>yn,Gz:()=>Qe,sz:()=>fe,HB:()=>zn,p1:()=>Re,b1:()=>Ht,jl:()=>gt,V5:()=>at,Cj:()=>Oe,I:()=>dn,tq:()=>dt,Fx:()=>ct,_z:()=>De,EC:()=>me,fS:()=>on,tY:()=>pt,DF:()=>nn,F6:()=>rn,KH:()=>jt,vd:()=>Wt,YZ:()=>mt,Id:()=>Tn,$I:()=>vt,lv:()=>Xt,vM:()=>Ln,Gg:()=>ht,Mn:()=>ut,AT:()=>$n,lP:()=>Yn,X:()=>xe,FO:()=>Qn,_n:()=>Mn,U7:()=>pe,pl:()=>Vn,c2:()=>Te,$c:()=>Sn,P9:()=>Ke,Rg:()=>yt,ED:()=>rt,OF:()=>In,YP:()=>kn,ur:()=>Cn,Rd:()=>xn,tJ:()=>wn,DU:()=>Bt,ff:()=>ue,or:()=>ce,Tx:()=>tn,eM:()=>hn,uq:()=>bn,jp:()=>On,KS:()=>Un,QY:()=>Et,KL:()=>Zt,zl:()=>Gt});var o=n(41432),i=n(80951),r=n(42509),a=n(43593),s=n(74181),l=n(72126),c=n(26825),d=n(27006);const u=["TypeScript","JavaScript","GraphQL","HTML","CSS","Scss","JSON","XML","Rust","SQL"];var p=n(21202),m=n(6287),f=n(70279),g=n(63921),h=n(29369),v=n(90965),b=n(64684),y=n(70203),S=n(95477),_=n(69783),w=n(28020),k=n(78429),I=n(75770),C=n(85957),x=n(67669),T=n(18514),M=n(95697),P=n(58202),A=n(81844),R=n(41662),D=n(63208),B=n(80444),E=n(16772),F=n(88632),Z=n(24042),L=n(64233),j=n(77080),V=n(19111),U=n(88923),O=n(83212),N=n(81236),z=n(35661),H=(n(49557),n(55320)),W=n(27724),q=n(10743),G=n(99757),K=n(24666),$=n(35057),Q=n(82343),Y=n(78316),J=n(77181),X=n(12955),ee=n(11599),te=n(92783),ne=n(68056),oe=n(35026),ie=n(98165),re=n(28187),ae=n(38755),se=n(89086),le=n(85644);const ce=function(e){return t=>e.some((e=>e(t)))},de=function(e){return t=>e.every((e=>e(t)))},ue=function(e){return t=>!e(t)},pe=e=>e.blocks&&1===e.blocks.length,me=e=>e.blocks&&e.blocks.length>1,fe=e=>!!(0,k.H)()&&e.blocks.every((e=>{const t=e.getParentId(),n=e.recordStoreUIParentStore,o=null==n?void 0:n.id;return t&&o&&t!==o})),ge=e=>e.blocks.every((t=>{const n=t.recordStoreUIParentStore;if(!n)return!1;const o=e.publicEditMode?e.publicEditMode:(0,ie.n3)(n)&&O.Z.getMode(e.environment,n);return!x.YF(o)&&n.canEdit()})),he=e=>{const{environment:t}=e;return e.blocks.every((e=>x.KE({environment:t,block:e})))},ve=e=>!G.n.state&&e.blocks.every((t=>!x.YF(e.publicEditMode)&&t.canEdit())),be=e=>!G.n.state&&e.blocks.every((t=>{if(x.YF(e.publicEditMode))return!1;const n=ee.$0();return n?n.canEditCollection():t.canEdit()})),ye=e=>!G.n.state&&e.blocks.every((t=>!x.YF(e.publicEditMode)&&(t.isCollectionView()?t.canEditCollection():t.canEdit()))),Se=e=>{let{environment:t,publicEditMode:n,blocks:o}=e;if(G.n.state)return!1;const{id:i}=t.currentUser;return!!i&&(!x.YF(n)&&o.every((e=>(0,x.WE)({userId:i,store:e}).filter((t=>{let{type:n,role:o}=t;if(!o)return!1;const i=e.isCollectionView()||e.isTemplate()?d.D7(o):d.J5(o);return"public_permission"!==n&&i})).length>0&&x.KE({environment:t,block:e}))))},_e=e=>{if(e.blocks&&1===e.blocks.length){const[n]=e.blocks;if(n.isCollectionView()){var t;const e=null===(t=n.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,r.Gq)(e)||(0,r.Ev)(e)||(0,r.OY)(e)}}return!1},we=e=>{if(e.blocks&&1===e.blocks.length){const[n]=e.blocks;if(n.isCollectionView()){var t;const e=null===(t=n.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,r.Ev)(e)}}return!1},ke=e=>!G.n.state&&e.blocks.every((e=>e.canAdmin())),Ie=e=>!G.n.state&&e.blocks.every((e=>e.canComment())),Ce=e=>e.blocks.some((e=>Boolean(P.R.findBlockFromStoreWithMethod(e,"activate")))),xe=e=>e.blocks.every((e=>e.isRestricted())),Te=e=>{const{currentSpaceStore:t}=B.default.state,{currentUser:n}=e.environment;return(t?t.getPermissionItems():[]).some((e=>d.jg(e)&&e.user_id===n.id&&d.zz(e.role)))},Me=function(){const e=w.np();return!e||!e.isLocked()},Pe=()=>{const e=w.np();return Ae(e)},Ae=e=>{if(!e)return!1;return!!e.getParentCollectionStore()},Re=e=>e.blocks.length>0&&e.blocks.some((e=>e.isLocked())),De=e=>e.blocks.length>0,Be=e=>e.blocks.some((e=>{const t=w.np();return!!(t&&t.isPageBlock()&&t.isLocked()&&t.uiContains(e)&&t!==e)})),Ee=e=>e.blocks.some((e=>{const{mainEditorCurrentBlockStore:t}=B.default.state;return Boolean(t&&t.isCollectionView()&&t.isLocked()&&t.uiContains(e)&&t!==e)})),Fe=e=>e.blocks.every((e=>{const t=e.getType();return Boolean(t&&(0,o.XD)(t)&&!(0,o.S9)(t))})),Ze=e=>{var t;const n=null===(t=B.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id;if(e.blocks[0]){const t=e.blocks[0].getType(),i=e.blocks[0].id;return Boolean(t&&i===n&&(0,o.XD)(t))}return!1},Le=e=>e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&e.isDefined()&&e.getParentId()!==t.id)})),je=e=>e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&t.canEdit()&&e.isDefined()&&e.getParentId()!==t.id)})),Ve=e=>{if(e.blocks){const t=e.blocks[0];return Boolean(t&&t.isDefined()&&t.getType()===o.Ti.file&&t.getProperties().source)}return!1},Ue=e=>{if(!e.blocks)return!1;const t=e.blocks[0],n=t&&t.getProperties().source;if(!n)return!1;const o=i.zB(n);return!!o&&a.E$(o,[S.default.secureFileS3.url,S.default.secureFileS3V2.url])},Oe=e=>{if(e.blocks){const t=e.blocks[0];if(t.isType(o.Ok))return Boolean(t.getProperties())}return!1},Ne=e=>{if(e.blocks){const t=e.blocks[0],n=t&&t.getType();return Boolean(n&&(0,o.VB)(n))}return!1},ze=e=>{if(e.blocks){const t=e.blocks[0].getModel();return Boolean(null==t?void 0:t.isType(o.oe))}return!1},He=e=>t=>{if(t.blocks){const n=t.blocks[0];return Boolean(n&&n.getProperties()[e])}return!1},We=(He("source"),e=>{if(e.blocks){const t=e.blocks[0],n=null==t?void 0:t.getModel();return Boolean(null==n?void 0:n.isType(o.f4))}return!1}),qe=e=>{if(e.blocks){const t=e.blocks[0];if(t&&t.getType()===o.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();return Boolean(e&&e.canEdit())}return!1}return!1},Ge=e=>e.blocks.every((e=>{const t=e.getModel(),n=e.getRecordStoreUIParent();return Boolean(t&&t.isType(o.Zi)&&t.getType()!==o.Ti.transclusionContainer&&e.getParentTable()!==m.v&&n&&n.id===e.getParentId())})),Ke=e=>t=>t.blocks&&t.blocks[0]&&l.mf(t.blocks[0].getType)&&t.blocks[0].getType()===e,$e=e=>t=>l.yW(t.blocks,(t=>t&&l.mf(t.getType)&&t.getType()===e)),Qe=e=>{const t=e.blocks[0],{language:n}=t.getProperties(),o=(0,y.QaF)(n);return u.includes(o)},Ye=e=>()=>j.default.checkGate(e),Je=e=>t=>{if(1!==t.blocks.length)return!1;const n=t.blocks[0],o=n.getParentBlockStore(),i=null==o?void 0:o.getContentStores(),r=null==i?void 0:i.map((t=>t.getType()===e));if(!r||0===(null==r?void 0:r.length))return!1;const a=null==i?void 0:i.map((e=>e.id)).indexOf(n.id);return void 0!==a&&(0===a||!r[a-1])},Xe=e=>e.blocks.every((e=>{const t=null==e?void 0:e.getModel();return Boolean((null==t?void 0:t.isType(o.Zj))&&e.getParentTable()!==m.v)})),et=e=>{const t=w.RM();return!!t&&e.blocks.every((e=>t.uiContains(e)&&t.id!==e.id))},tt=e=>{const t=e.blocks[0],n=null==t?void 0:t.getRecordStoreUIRoot();return!!n&&e.blocks.every((e=>n.uiContains(e)&&n.id!==e.id))},nt=e=>e.blocks.every((e=>{const t=P.R.findBlockFromStoreWithMethod(e,"canRenderFullScreen");return Boolean(t&&t.canRenderFullScreen())})),ot=function(e){let{environment:{device:t}}=e;return t.isElectron},it=function(){return Boolean(Z.Z.state.isElectronHandlingZoom)},rt=function(e){let{environment:{device:t}}=e;return t.isWindows},at=function(e){let{environment:{device:t}}=e;return t.isMac},st=function(e){let{environment:{device:t}}=e;return t.isIOS},lt=function(e){let{environment:{device:t}}=e;return t.isAndroid},ct=function(e){let{environment:{device:t}}=e;return t.isMobileNative},dt=function(e){let{environment:{device:t}}=e;return t.isMobile},ut=function(e){let{environment:{device:t}}=e;return t.isPhone},pt=function(e){let{environment:{device:t}}=e;return t.isNative},mt=function(e){let{environment:{device:t}}=e;return!t.isMobile},ft=()=>S.default.isAdminMode,gt=e=>{let{environment:t}=e;return Boolean(t.currentUser.isLoggedIn()||(0,X.getPublicDomainUserId)(t))},ht=function(){return F.Z.state.online},vt=e=>!e.blocks.every((t=>{const n=t.inMemoryRecordCache===e.environment.defaultRecordCache.inMemoryRecordCache,o=t.inMemoryRecordCache.cacheFallbacks.has(e.environment.defaultRecordCache.inMemoryRecordCache);return n||o})),bt=e=>e.blocks.some((e=>e.isTemplate())),yt=e=>e.blocks.some((e=>e.isTypedCollectionViewBlock())),St=e=>e.blocks.some((e=>e.isCollectionViewPageWithContent())),_t=e=>e.blocks.every((()=>!wt()||cn("page",!1)(e))),wt=()=>{const e=w.np();return null==e?void 0:e.isCollectionViewPageWithContent()},kt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isCollectionView()}return!1},It=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(o.Ti.collectionView)}return!1},Ct=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(o.Ti.collectionViewPage)}return!1},xt=function(e){return t=>{if(t.blocks&&1===t.blocks.length){const[n]=t.blocks,o=P.R.findCollectionViewBlockFromStore(n);return!!o&&o.collectionContextStore.getViewType()===e}return!1}},Tt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return 1===t.getCollectionViewStores().length}return!1},Mt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks,n=t.getCollectionViewCollectionStore();if(!n)return!1;const o=n.getSchema();return Object.values(o).map((e=>null==e?void 0:e.type)).every((e=>e&&R.g$.isPropertyTypeConvertableToSimpleTable[e]))}return!0},Pt=e=>T.NW(e.environment),At=e=>T.vy(e.environment),Rt=function(){return L.Z.state.open},Dt=function(){return _.Z.state.open},Bt=function(){return V.Z.state.open},Et=function(){return q.Z.state.open},Ft=function(){return"editing"===K.default.state.mode},Zt=function(){return"empty"!==K.default.state.mode&&!(0,ne.iG)(K.default.state.multiSelection)},Lt=function(){return!((0,se.J6)(y.GKr.User)||(0,se.J6)(y.GKr.Bot)||(0,se.J6)(y.GKr.Date)||(0,se.J6)(y.GKr.Page))},jt=function(){return W.default.state.stores.length>0},Vt=e=>{const t=B.default.state.currentSpaceStore;return(0,ae.Cx)(t)},Ut=e=>e.blocks.every((e=>Boolean(A.Z.findOutlinerItemFromStore(e)))),Ot=e=>e.blocks.every((e=>{const t=A.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"bookmarks"===t.type)})),Nt=e=>e.blocks.every((e=>{const t=A.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"shared"===t.type)})),zt=e=>{const t=e.blocks[0];if(!t)return!1;const n=t.getParentBlockStore();return!!n&&n.isLocked()},Ht=e=>!Wt(e),Wt=e=>{if(!(0,M.bq)())return!0;const t=e.blocks[0];if(t){if(t.getParentTable()===h.e0){const n=(0,ie.VP)(t);if(!n||!(0,oe.si)({teamStore:n,environment:e.environment}))return!1}}return!0};function qt(e){if(!e)return;const t=e.getParentPointer(),n=e.getRecordStoreUIParent();return(null==t?void 0:t.table)===h.e0&&n?z.zX.createChildStore(n,t):qt(e.getParentBlockStore())}const Gt=e=>{const{id:t}=e.environment.currentUser;return!!t&&e.blocks.every((e=>{const n=e.getPermissionItems();return(0,c.ws)(n,t)}))},Kt=e=>e.blocks.every((e=>{const t=A.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem)})),$t=e=>{const{currentSpaceViewStore:t}=B.default.state,n=e.blocks[0];return Boolean(t&&n&&(0,te.Z)({spaceViewStore:t,pageId:n.id}))},Qt=e=>{const t=w.np();return e.blocks[0]&&e.blocks[0]===t},Yt=e=>e.blocks.every((t=>Boolean(x.IJ(e.environment,t)))),Jt=e=>e.blocks.every((e=>x.S4(e))),Xt=e=>Boolean(B.default.state.mainEditorCurrentBlockStore),en=e=>C.Tx()&&e.blocks[0]&&e.blocks[0]===U.default.peekTarget.state,tn=e=>C.Tx(),nn=e=>e.blocks.every((e=>{const t=null==e?void 0:e.getType();return Boolean(t&&(0,o.S9)(t))})),on=e=>1===e.blocks.length&&(0,w.qG)(e.blocks[0].id),rn=e=>e.blocks.every((e=>{const t=e.getType(),n=e.getFormat();return Boolean(t&&(0,o._T)(t,n))})),an=e=>e.blocks.every((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof z.Xr||e instanceof z.G&&e.isCollectionView())).ancestor))),sn=e=>{let{blocks:t}=e;return t.length>0&&(0,J.bX)(t[0])},ln=e=>{let{blocks:t}=e;return Y.v_(t)};function cn(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=n=>n.blocks.every((n=>{const o=Y.fm(n,t),i=null==o?void 0:o.collectionViewStore();return(null==i?void 0:i.getType())===e}));return n}const dn=function(){const{currentSpaceStore:e}=B.default.state;return Boolean(e&&e.canRead())},un=function(){const{currentSpaceStore:e}=B.default.state;return Boolean(e&&e.canEdit())},pn=e=>{if(S.default.isAdminMode)return!0;if(Vt(e)&&!ve(e))return!1;const t=mn(e),{environment:n,blocks:o}=e;return o.every((e=>{const o=(0,ie.VP)(e);if(o){if(n.currentUser.id&&(0,b.s8)({team:{membership:o.getRawMembership()},userId:n.currentUser.id}))return!1;if(n.currentUser.id){const t=e.getUserPermissionForId(n.currentUser.id);if(t&&"editor"!==t.role)return!1}return!o.getDisableExport()}return t}))},mn=function(e){let{environment:t}=e;const{currentSpaceStore:n}=B.default.state;if(!n)return!1;const o=N.Z.getPublicSpaceData(t,n.id);return n.isDefined()?!n.getDisableExport():o?!o.disableExport:ft()},fn=()=>{const{currentSpaceStore:e}=B.default.state;return!!e&&!e.getDisableMoveToSpace()},gn=e=>!G.n.state&&(!!e.blocks.every((e=>e.canEdit()))&&!!Yt(e)),hn=e=>e.blocks.every((t=>{var n;return"edit"===(null===(n=O.Z.getMode(e.environment,t))||void 0===n?void 0:n.permission)})),vn=e=>{if(!ge(e))return!1;const t=e.blocks.filter((e=>{const t=e.recordStoreUIParentStore,n=e.getParentStore();return t&&n&&t.id===n.id}));return 0===t.length||ve({...e,blocks:t})},bn=e=>{let{environment:t}=e;const n=(0,w.k_)(t).state;return Boolean(n&&n.showSharedOverflowButton)},yn=e=>{let{blocks:t}=e;return t.some((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof z.G&&e.isTransclusionType())).ancestor)))},Sn=e=>{let{environment:t}=e;return"on"===j.default.getGroup("lucy-in-the-sky-with-tab-blocks")},_n=e=>{let{blocks:t}=e;if(!t||0===t.length)return!1;const n=t[0].getType(),i=t[0].getFormat();return Boolean(i.block_width)&&!Boolean(i.block_page_width)&&!Boolean(i.block_full_width)&&Boolean(n&&(0,o._7)(n))},wn=function(e){var t;let{blocks:n}=e;return Boolean(null===(t=(0,re.Jk)(n[0]))||void 0===t||null===(t=t.slackIntegrationStore)||void 0===t?void 0:t.isReady())},kn=function(){var e;const{currentSpaceStore:t}=B.default.state,n=null==t||null===(e=t.getBotSettingsStore())||void 0===e?void 0:e.getValue();return!(0,v.CJ)(n)||Boolean((null==n?void 0:n.integration_approval_statuses)&&n.integration_approval_statuses[s.T0])},In=function(e){var t;let{blocks:n}=e;const{slackIntegrationStore:o}=(0,re.Jk)(n[0]);return Boolean(o.isReady()&&!(null!=o&&null!==(t=o.getKeyStore("enabled"))&&void 0!==t&&t.getValue()))},Cn=function(e){var t;let{blocks:n}=e;const{blockStore:o,slackIntegrationStore:i}=(0,re.Jk)(n[0]);return Boolean(i.isReady()&&(null==i||null===(t=i.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&o.id!==n[0].id)},xn=function(e){var t;let{blocks:n}=e;const{blockStore:o,slackIntegrationStore:i}=(0,re.Jk)(n[0]);return Boolean(i.isReady()&&(null==i||null===(t=i.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&o.id===n[0].id)},Tn=function(e){var t;let{blocks:n}=e;return(null===(t=n[0])||void 0===t?void 0:t.getSpaceId())!==g.N3},Mn=e=>1===e.blocks.length&&e.blocks[0].getType()===o.Ti.table,Pn=e=>{const t=D.Z.state;return t.isActive&&1===e.blocks.length&&e.blocks[0]===t.simpleTableStore},An=e=>{let{blocks:t}=e;return t.some((e=>Boolean(e.isImmediateColumnChild())))},Rn=e=>{const t=D.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return R.g$.getNumberOfColumns(n)>1},Dn=e=>{const t=D.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.row&&o.end.row===R.g$.getNumberOfRows(n)-1,r=0<=o.start.col&&o.start.col<=o.end.col&&o.start.col<=R.g$.getNumberOfColumns(n)-1;return"column"===o.type&&r&&i},Bn=e=>{const t=D.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.row&&o.end.row===R.g$.getNumberOfRows(n)-1,r=0===o.start.col&&0===o.end.col;return"column"===o.type&&r&&i},En=e=>{const t=D.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return R.g$.getNumberOfRows(n)>1},Fn=e=>{const t=D.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.col&&o.end.col===R.g$.getNumberOfColumns(n)-1,r=0<=o.start.row&&o.start.row<=o.end.row&&o.start.row<=R.g$.getNumberOfRows(n)-1;return"row"===o.type&&r&&i},Zn=e=>{const t=D.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.col&&o.end.col===R.g$.getNumberOfColumns(n)-1,r=0===o.start.row&&0===o.end.row;return"row"===o.type&&r&&i},Ln=e=>{let{environment:t}=e;return(0,$.QM)()},jn=e=>{if(1!==e.blocks.length)return!1;const t=e.blocks[0].getParentStore();return!(!t||t.table!==p.iU)&&t.isType(o.Ti.tab)},Vn=e=>{const t=e.blocks[0];return Boolean(t&&t.isCollectionView()&&t.getCollectionViewSourceCollectionStore())},Un=e=>{if(!pe(e))return!1;const t=e.blocks[0];return(0,le.zg)(t)},On=e=>(e=>{let{environment:t,blocks:n}=e;if(!(0,M.bq)())return!1;if(!I.lQ({environment:t,blocks:n}))return!1;const o=t.currentUser.id,{currentSpaceStore:i}=B.default.state;if(!o||null==i||!i.isDefined())return!1;if(!M.Xq({environment:t,spaceStore:i}))return!1;for(const s of n){var r,a;if(!s.isPageBlock())return!1;if("team"!==(null===(r=A.Z.findOutlinerItemFromStore(s))||void 0===r?void 0:r.type))return!1;const e=null===(a=qt(s))||void 0===a?void 0:a.getMembers();if(!e||!(0,b.pd)({membership:e},o))return!1}return!0})(e)&&mt(e);function Nn(){const{currentSpaceStore:e}=B.default.state,t=null==e?void 0:e.getBotSettingsStore().getValue();return!(0,v.CJ)(t)||Boolean((null==t?void 0:t.integration_approval_statuses)&&t.integration_approval_statuses[s._o])}const zn=e=>Boolean(e.blocks[0].getFormat().is_placeholder),Hn=e=>{var t;return Boolean((null===(t=e.blocks[0].getFormat().alias_pointer)||void 0===t?void 0:t.table)===f.x_)},Wn=()=>{const e=w.np();if(!e||!e.hasContent())return!1;if(1===e.getContentLength()){const t=e.getContentStores()[0].getTitleStore();if(q.Z.state.open&&q.Z.state.textStore===t)return!1;if(E.default.isEditingEmptyBlock())return!1}return!0};function qn(){return Boolean(Z.Z.state.isElectronUsingCommandNumber)}const Gn=e=>e.blocks.some(Q.td),Kn=e=>e.blocks.every((e=>e.isType("page")||e.isType("callout")));function $n(){return H.default.state.open}function Qn(){return H.default.isSidePeekPanelEnabled()}const Yn=e=>{const{environment:t}=e,{device:n}=t,o="quickSearch"===t.RouterStore.state.route.name;return n.isElectron&&o}},24215:(e,t,n)=>{n.d(t,{NM:()=>ee,ls:()=>xe,mc:()=>ce,Cd:()=>Ee,of:()=>pe,Ts:()=>ve,eR:()=>be,cG:()=>Pe,nZ:()=>Ce,nB:()=>Be,fK:()=>J,$A:()=>X,Jq:()=>te,pH:()=>we,Ug:()=>De,ci:()=>Fe,j:()=>le,lu:()=>ue,Zf:()=>ne});n(57658);var o=n(82496),i=n(65680);function r(e){let t=[];if(e.length>0){if(t=e.filter((e=>{let{code:t}=e;return(0,i.Qh)(t)})),0===t.length)return"en-US";const n=t[0].quality,o=t.filter((e=>{let{quality:t}=e;return t===n}));let r=o.find((e=>"en"===e.code));return r||(r=o[0]),function(e){let t=i.vi[e.code];return"es"===e.code?t="ES"===e.region?"es-ES":"es-LA":"zh"===e.code&&(t="TW"===e.region||"HK"===e.region?"zh-TW":"zh-CN"),t}(r)}return"en-US"}function a(e){return`v2/${function(e){return r(o.parse(e))}(e)}`}var s=n(93214),l=n(15145),c=n(29450),d=n(53504),u=n(33728),p=n(55632),m=n(68626),f=n(15157),g=n(72126),h=(n(77897),n(27006)),v=n(29477),b=n(4615),y=n(9852),S=n(47425),_=n(64684),w=n(62992),k=n(7250),I=n(97880),C=n(64002),x=n(73123),T=n(54642),M=(n(95477),n(28020)),P=n(33929),A=n(98165),R=n(85957),D=n(75538),B=n(12252),E=n(58455),F=n(51),Z=n(80444),L=n(77080),j=n(88923),V=n(81236),U=n(35661),O=n(87956),N=n(78291),z=n(88893),H=n(35057),W=n(99334),q=n(12955),G=n(57491);var K=n(67669),$=n(38755);var Q=n(36867);const Y="not_defined";async function J(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=E.default.verboseAnalytics;if(await p.fK({traits:e}),t)for(const n of e)console.log("track:%c identify","font-weight: bold;",n)}async function X(e){const{environment:t,userId:n,traits:o,skipIntercom:i}=e,r=E.default.shouldRefresh(n)?await we(t):E.default.state,a=function(e){const t=be();if(!t.user_id)return;const{user_id:n,email:o,name:i,...r}=e;return{...r,user_id:t.user_id,email:t.email,name:t.name}}(o);if(!a)return void m.rateLimitedLog({level:"warning",from:"analyticsHelpers",type:"noCleanAnalyticsUser"});const s=(0,b.F9)(a.user_id);if(!i){var l;const e=P.default.getIntl(),t=null===(l=Z.default.state.currentUserStore)||void 0===l?void 0:l.getFullName(e);k.$A({userId:s,userName:t,traits:a,settings:r})}if(null!=r&&r.isLoggingEnabled){const e=M.VU().map(b.F9),n=await ye(t),o=await pe(t),i=await async function(e){if(await(0,q.hasPermissionForThirdPartyServiceClient)("mutiny",e)){const e="mutiny.user.token",t=(0,c.getCookie)(e)||window.localStorage.getItem(e);if(t)return{mutinyVisitorId:t}}return{}}(t),{accept_language_raw:r,accept_language_preference:l}=o,u=(0,d.Z)({accept_language_raw:r,accept_language_preference:l},"ignore-class-instances"),m={...o,...i,space_has_paid_nonzero:!(!n||!("space_has_paid_nonzero"in n))&&n.space_has_paid_nonzero,integrations:{All:!0}},f={...a,user_email:a.email,...u,...m};p.$A({userId:s,traits:f,spaceIds:e})}E.default.verboseAnalytics&&console.log("identify:",JSON.stringify(o))}const ee=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.default.verboseAnalytics;await p.HX(),e&&console.log("deidentify user")};async function te(e){const t=await ye(e);if(E.default.state.isIntercomEnabled){const e=await async function(e){const{currentUserRootStore:t,currentUserStore:n}=Z.default.state;if(n&&t&&e){await Promise.all([t.load(),n.load()]);const o=t.getSpaceViewStores();await Promise.all(o.map((e=>e.load())));const i=g.oA(o.map((e=>e.getSpaceStore())));return await Promise.all(i.map((e=>e.load()))),g.oA(i.map((t=>{const o=t.isDefined()?{id:t.id,plan_type:t.getPlanType(),beta_enabled:t.getBetaEnabled()}:void 0;if(o){const i=(0,b.F9)(o.id);if(i===e.space_id){const i=N.default.state.data,r=z.XX(i),a={id:e.space_id,name:Ie(n,o.plan_type),size:(0,$.jv)(t).length,is_subscribed:"space_is_subscribed"in e&&e.space_is_subscribed,is_beta:Boolean(o.beta_enabled)};return r&&(a.plan=r.plan),"space_data_not_loaded"!==e.space_analytics_data_type&&e.space_created_time&&(a.company_created_at=e.space_created_time),a}return{id:i,name:Ie(n,o.plan_type),size:(0,$.jv)(t).length}}})))}return[]}(t);k.Jq({companiesData:e})}t&&E.default.state.isLoggingEnabled&&p.Jq({spaceId:t.space_id,spaceData:t})}async function ne(e,t){if(!e.currentUser.id)return;const n=(0,b.F9)(e.currentUser.id);return X({environment:e,userId:n,traits:{...t,user_id:n},skipIntercom:!0})}const oe={};function ie(e){const{spaceId:t,userId:n,deviceId:o,eventName:i}=e,r=(0,b.Ul)(`${t}:${n}:${o}:${i}`),a=oe[r],s=Date.now();if(!a)return oe[r]=s,!0;const l=new Date(a),c=new Date(s);return l.getUTCDate()!==c.getUTCDate()?(oe[r]=s,!0):void 0}function re(){const e=O.Z.state;if(e)return{queryId:e.queryId}}function ae(e){const{userId:t,spaceId:n}=e;if(!t||!n)return;const o=Ee({userId:t,spaceId:n});return o?{notion_session_id:o.id,notion_session_start_ts:o.sessionStartTime}:void 0}async function se(e,t,n){const o=await pe(e),{preboot:i,dontWait:r}=n||{};r||i||await async function(e){e.currentUser.isLoggedIn()&&Z.default.state.mainEditorCurrentBlockStore&&(await Z.default.waitUntil((()=>Boolean(Z.default.state.mainEditorCurrentBlockStore&&Z.default.state.mainEditorCurrentBlockStore.isReady))),Z.default.state.currentSpaceStore&&await N.default.waitUntilLoaded()),E.default.shouldRefresh(e.currentUser.id)&&await we(e)}(e);const a=r?void 0:await ye(e),l=be(),{currentUserRootStore:d,currentUserStore:u,currentSpaceStore:p}=Z.default.state,m=d&&d.isReady()?g.jj(d.getSpaceViewStores().map((e=>e.getSpaceId()))).length:null;let f;L.default.state.isLoaded&&(f=L.default.getStatsigExperimentsMap());const{width:h,height:v}=e.WindowSizeStore.state,S=(0,G.getMobileNativeDeviceInfo)(),_=window.__mobileNativeSessionInfo??{},w=(null==a?void 0:a.space_id)||void 0,k=(0,s.LC)();return{data:{...ge(),...o,...a,...Se(),...ve(),...he(),...re(),...ae({userId:null==u?void 0:u.id,spaceId:null==p?void 0:p.id}),...S,..._,...l,experiments:f,experimentStoreLoaded:L.default.state.isLoaded,current_space_view_count:m,appSource:"client",windowWidth:h,windowHeight:v,unique_event_marker:ie({spaceId:w,userId:Te(),deviceId:o.device_id,eventName:t}),isActive:B.Z.state.active,fired_during_onboarding:D.default.state.isOnboarding,tab_id:(0,y.getSessionTabId)(),tab_count:(0,W.K)(),is_foreground:document.hasFocus(),is_user_consent_to_track:(0,c.hasPermissionForAmplitudeBrowser)(),tid:k&&(0,b.F9)(k)},spaceId:null==a?void 0:a.space_id}}async function le(e,t,n,o){try{const i=E.default.verboseAnalytics;0;const{data:r,spaceId:a}=await se(e,t,o);!function(e,t,n){if(!n)return;for(const[o,i]of Object.entries(n))t[o]!==i&&m.log({level:"info",from:"analyticsHelpers",type:"forceOverrideMismatch",data:{eventName:e,miscDataToConvertToString:{forceOverrideKey:o,forceOverrideValue:i,autoTrackedValue:t[o]}}})}(t,r,null==o?void 0:o.forceOverrideAutomaticEventData);const s=(0,d.Z)(g.Xh({...n,...r,...null==o?void 0:o.forceOverrideAutomaticEventData}),"ignore-class-instances");k.j({eventName:t,eventData:s});const c={eventName:t,eventData:{...l.ni(s),__context:{locale:r.preferred_locale,page:{referrer:window.document.referrer,search:window.location.search}},sharedUUID:(0,b.ZP)()},spaceId:a};p.j(c),i&&console.log(`track:%c ${t}`,"font-weight: bold;",n)}catch(i){m.log({level:"error",from:"analyticsHelpers",type:"track",data:{eventName:t,miscDataToConvertToString:{e:i}}})}}function ce(e){return{trackEvent:t=>{le(e,t.eventName,t.properties)}}}const de={};function ue(e,t,n,o,i,r){const a=de[n],s=Date.now();return(!a||s-a>1e3*o)&&(de[n]=s,le(e,t,i,r),!0)}async function pe(e){var t,n,o,i;const{device:r,RouterStore:a}=e,s=null===(t=a.getState())||void 0===t||null===(t=t.route)||void 0===t?void 0:t.name,l=await Pe(e),{pathname:c,...d}=(0,C.nx)(null===(n=document.location)||void 0===n?void 0:n.href,(0,y.getUrlAnalyticsFromSessionStorage)())||{},u={app_version:r.version,desktop_app_version:r.desktopAppVersion,mobile_app_version:r.mobileAppVersion,is_desktop_app_or_browser:!r.isMobile,is_desktop:r.isElectron,is_mobile:r.isMobile,is_tablet:r.isTablet,is_react_native:r.isMobileNative,is_ios:r.isIOS,is_logged_in:Me(e),deviceType:r.os,device_type:r.deviceType,device_os:r.os,platform:r.platform,browser:r.browserName,browser_version:r.browserVersion,browser_version_bucketized:fe(r.browserVersion,r.browserName),dnt:r.doNotTrackEnabled,device_id:l&&(0,b.F9)(l),tags:(0,y.getSessionAnalyticsTags)(),host:null===(o=document.location)||void 0===o?void 0:o.host,route_name:s,notion_top_level_domain:null===(i=document.location)||void 0===i||null===(i=i.host)||void 0===i||null===(i=i.split(".notion."))||void 0===i?void 0:i[1],referrer:document.referrer||"none",accept_language_raw:Ae(),accept_language_preference:Re(),...d};return g.GM(u,g.o8)}const me=new Set(["Safari","Mobile Safari"]);function fe(e,t){const n=e.split(".");return me.has(t)?n.slice(0,2).join("."):n[0]}const ge=function(){const{currentSpaceViewStore:e}=Z.default.state;return e&&e.isDefined()?{notify_desktop:e.getNotifyDesktop(),notify_email:e.getNotifyEmail(),notify_mobile:e.getNotifyMobile(),notify_email_digest:e.getNotifyEmailDigest()}:{}},he=function(){const{mainEditorCurrentBlockStore:e}=Z.default.state;if(e){const t=A.VP(e);if(t)return{team_id:(0,b.cj)(t.id)}}return{}},ve=function(){const{currentUserSettingsStore:e}=Z.default.state;if(e&&e.isDefined()){let n={};const o=e.getSettings();return o&&(n={user_persona:o.persona,user_source:o.source,user_use_case:o.use_case,time_zone:o.time_zone,time_zone_region:"string"==typeof o.time_zone?(t=o.time_zone,"N/A"===t?t:t.split("/")[0]):void 0,locale:o.locale,preferred_locale:o.preferred_locale,signup_time:o.signup_time,used_desktop_web_app:o.used_desktop_web_app,used_mobile_web_app:o.used_mobile_web_app,used_mac_app:o.used_mac_app,used_windows_app:o.used_windows_app,used_ios_app:o.used_ios_app,used_android_app:o.used_android_app,user_session_count:(0,Q.g)(e.id)}),g.GM(n,g.o8)}var t},be=function(){const e={user_id:Te(),user_email:E.default.state.user_email,email:E.default.state.user_email,name:E.default.state.user_name};return g.GM(e,g.o8)};async function ye(e){var t;await(0,v.OI)(2e3,[Promise.all([N.default.waitUntilLoaded(),F.Z.waitUntilLoaded()])]);const{data:n}=N.default.state,{currentUserStore:o,currentSpaceStore:i}=Z.default.state,{publicPageData:r}=F.Z.state,a=(0,M.zj)(),s=a?(0,b.F9)(a):void 0,{mainEditorCurrentBlockStore:l}=Z.default.state,c=null!=i&&i.isDefined()?{id:null==i?void 0:i.id,settings:null==i?void 0:i.getSettings(),email_domains:null==i?void 0:i.getEmailDomains(),plan_type:null==i?void 0:i.getPlanType(),initial_use_cases:null==i?void 0:i.getInitialUseCases(),invite_link_enabled:null==i?void 0:i.getInviteLinkEnabled(),created_by_id:null==i?void 0:i.getCreatedById(),created_time:i.getCreatedTime()}:void 0,d=(null==i?void 0:i.id)||(null==r?void 0:r.spaceId)||(null==l?void 0:l.getSpaceId()),u=Boolean(null==c||null===(t=c.settings)||void 0===t?void 0:t.is_teams_enabled);if(d&&o&&i&&n){const t=V.Z.getPublicSpaceData(e,d),o=z.YK(n),r=z.CM(n).length||0,a=z.su(n),l=z.lk(n),p=n.hasPaidNonzero,m=t?t.domain:void 0,f=c&&c.email_domains?c.email_domains:void 0,h=z.zl(e,n),v=(0,$.Ib)(t),y=(0,$.ww)(t),S=g.hj(h)&&!Number.isNaN(h)&&h!==1/0?h:0;return{space_analytics_data_type:"space_member_data",subscription_tier:(0,H.zt)(),page_id:s,space_id:(0,b.F9)(d),space_is_subscribed:o,space_visible_total:r,space_visible_members:a,space_visible_guests:l,space_visible_members_bucketized:(0,x.aT)(a),space_block_usage:z.Lz(e,n),space_block_usage_over_limit:z.Ln(e,n),space_role:i.getRole(),space_block_usage_percent:S,space_timeline_view_usage:z._9(n)?n.timelineViewUsage:void 0,space_created_time:v,available_credit:0,space_domain:m,space_email_domains:f,space_has_paid_nonzero:p,space_plan_type:y,space_initial_use_cases:c?c.initial_use_cases:void 0,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,b.F9)(c.created_by_id):void 0,teams_is_enabled:u}}if(r){const t=r.spaceId?V.Z.getPublicSpaceData(e,r.spaceId):void 0,n=(0,$.Ib)(t),o=(0,$.ww)(t);return{space_analytics_data_type:"space_nonmember_data",space_id:d?(0,b.F9)(d):void 0,space_domain:r.spaceDomain,page_id:s,subscription_tier:(0,H.zt)(),space_created_time:n,space_plan_type:o,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,b.F9)(c.created_by_id):void 0,teams_is_enabled:u}}return c?{space_analytics_data_type:"base_space_data",space_id:(0,b.F9)(c.id),space_created_time:c.created_time,space_plan_type:c.plan_type,space_invite_link_enabled:c.invite_link_enabled,space_created_by:c.created_by_id?(0,b.F9)(c.created_by_id):void 0,teams_is_enabled:u}:{space_analytics_data_type:"space_data_not_loaded",space_id:null!=i&&i.id?(0,b.F9)(null==i?void 0:i.id):void 0}}const Se=function(){const e=j.default.state,t=R.mH(),n=M.np();if(n){const o=K.YO(n).map((e=>{let{permissionItem:t}=e;return t})),i=o.find((e=>"public_permission"===e.type)),r=o.find((e=>"space_permission"===e.type)),a=o.filter((e=>"user_permission"===e.type&&(0,h.rz)(e.role))),s=o.filter((e=>"user_permission"===e.type&&(0,h.J5)(e.role))),l=function(e){const t=A.uJ(e),n=[];return g.xH(t.map((e=>{if(e instanceof U.zX)return;const t=e.getCopiedFromPointer();return t&&w.J(t)&&n.push(t.id),n})))}(n),c=Boolean(l)&&l.length>0,d=e.open?void 0:Z.default.state.currentCollectionViewStore,{publicPageData:u}=F.Z.state,p=n.getCopiedFromPointer();return{page_id:n.id,page_public_role:i?i.role:Y,page_space_role:r?r.role:Y,page_all_collaborator_count:s.length+a.length,page_editor_collaborator_count:s.length,page_read_only_collaborator_count:a.length,page_content_count:n.getContentLength(),page_current_user_role:n.getRole(),page_is_peek:t,page_copied_from:p?(0,b.F9)(p.id):void 0,page_is_notion_template:!!p&&w.J(p),page_is_template:n.isTemplate(),page_is_prepopulated:c,page_prepopulated_template_ids:l,page_is_database:n.isCollectionView(),page_view_type:d?d.getType():void 0,page_user_has_explicit_access:u?u.userHasExplicitAccess:Y}}};const _e=new Map;async function we(e){const t=e.currentUser.id;if(t){if(!_e.has(t)){const n=ke(e,{loggedIn:!0});_e.set(t,n),n.then((()=>{_e.delete(t)})).catch((e=>{throw _e.delete(t),e}))}return _e.get(t)}return ke(e,{loggedIn:!1})}async function ke(e,t){t.loggedIn&&await Z.default.waitUntilRendered();const n=await T.getUserAnalyticsSettings(e,{});if("success"!==n.type)return void m.log({level:"warning",from:"analyticsHelpers",type:"fetchAnalyticsSettings",data:{miscDataToConvertToString:{response:n}}});const o=n.data;return E.default.setState(o),o}const Ie=function(e,t){const n=e.getEmail();return n&&"team"===t?(0,u.Gd)(n):n||void 0};function Ce(e){return e.map((e=>(0,$.cD)(e))).filter(I.lm).some((e=>S.QM(e)))}function xe(e){const t=e.map((e=>(0,$.cD)(e))),n=new Set(g.oA(t));return n.has("enterprise")?"enterprise":n.has("business")?"business":n.has("plus")?"plus":n.has("personal")?"personal_pro":n.has("team_free")?"team_free":n.has("personal_free")?"personal_free":n.has("free")?"free":"none"}function Te(){const e=E.default.state.user_id;return e?(0,b.F9)(e):void 0}function Me(e){const t=function(e){var t;return(null==e||null===(t=e.currentUser)||void 0===t?void 0:t.id)||(0,q.getPublicDomainUserId)(e)}(e);return Boolean(t)}async function Pe(e){const t=await(0,q.getBrowserId)(e);return t&&(0,b.F9)(t)}function Ae(){return L.default.getAcceptLanguageHeader()}function Re(){return a(Ae()||"")}function De(){return"on"===L.default.getEligibleGroup({experimentId:"zendesk",defaultGroup:"unassigned"})}function Be(e){var t;const n=e.id,o=e.isDefined()?{membership:e.getMembers(),settings:e.getSettingsStore().getValue(),is_default:e.isDefault(),description:e.getDescription(),icon:e.getIcon(),team_pages:e.getTeamPagesStore().getValue()}:void 0;if(!o||!o.settings)return{team_id:(0,b.cj)(n),no_team_value:!0};const i=o.membership||[];return{team_id:(0,b.cj)(n),team_current_size:i.length,team_current_num_users:i.filter((e=>"user"===e.entity_type)).length,team_current_num_groups:i.filter((e=>"group"===e.entity_type)).length,team_access_level:(0,_.B5)(o.settings),team_is_default:o.is_default,team_has_description:Boolean(o.description),team_has_icon:Boolean(o.icon),team_top_pages:(null===(t=o.team_pages)||void 0===t?void 0:t.length)??0}}function Ee(e){const t=f.Z.get({userId:e.userId,key:`${e.spaceId}:analytics_session`});if(!(t&&Date.now()-t.lastFocusedTime>18e5))return t}function Fe(e){f.Z.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}},28020:(e,t,n)=>{n.d(t,{$A:()=>ne,AK:()=>ke,B7:()=>ee,CC:()=>ge,CP:()=>he,Fv:()=>Q,JE:()=>be,RM:()=>te,VU:()=>Se,VV:()=>ye,Xb:()=>le,Zy:()=>Ie,_H:()=>X,_u:()=>ce,aT:()=>oe,h1:()=>ae,hq:()=>de,k_:()=>ue,kw:()=>pe,np:()=>Y,o:()=>_e,p5:()=>Ce,qG:()=>ie,qQ:()=>ve,tu:()=>se,ui:()=>fe,wU:()=>we,yn:()=>me,zj:()=>J});var o=n(14577),i=n(41432),r=n(53877),a=n(60310),s=n(72126),l=n(27006),c=n(99405),d=(n(21202),n(23867)),u=n(19889),p=n(53323),m=n(94841),f=n(49427),g=n(34859),h=n(51),v=n(80444),b=n(80641),y=n(33784),S=n(55367),_=n(64233),w=n(73329),k=n(3418),I=n(42653),C=n(94416),x=n(48863),T=n(22294),M=n(19111),P=n(89087),A=n(19671),R=n(13023),D=n(88923),B=n(35661),E=n(69784),F=n(13105),Z=n(82187),L=n(55320),j=n(27724),V=n(10743),U=n(24666),O=n(16194),N=n(4708),z=n(78316),H=n(85957),W=n(67669),q=n(65598),G=n(77546),K=n(38755),$=n(95697);function Q(){if(v.default.state.mainEditorCurrentBlockStore)return{id:v.default.state.mainEditorCurrentBlockStore.id,spaceId:(0,d.C)(v.default.state.mainEditorCurrentBlockStore.pointer.spaceId)}}function Y(){const e=D.default.state,t=H.mH();return e.open&&t?e.target:v.default.state.mainEditorCurrentBlockStore}function J(){if(v.default.state.mainEditorCurrentBlockStore)return v.default.state.mainEditorCurrentBlockStore.id}function X(){return H.Tx()?R.Z:A.Z}function ee(e){let t;return v.default.state.currentUserStore?t=v.default.state.currentUserStore:e.currentUser.id&&(t=new B.U6(e,{table:u.KJ,id:e.currentUser.id})),t}function te(){const e=j.default.getCurrentRootStore();if(e&&e instanceof B.G)return e}function ne(e){return ie(e)&&(0,m.q0)()}function oe(e){const{currentSpaceViewStore:t,currentUserStore:n}=v.default.state;return!(!t||!t.getSpaceId())&&(!!n&&((0,m.q0)()&&(0,a.Vy)({userId:n.id,spaceId:t.getSpaceId(),pageId:e})))}function ie(e){const{currentSpaceViewStore:t,currentUserStore:n}=v.default.state;if(!t||!t.getSpaceId())return!1;if(!n)return!1;return e===(0,a.Lb)({userId:n.id,spaceId:t.getSpaceId(),type:"myTasks"})}const re=new F.P({debugName:"getAppRenderState",memoizeRecursion:!0,deepEquals:!1,compute:function(e){var t;const{mainEditorCurrentBlockStore:n,initialized:o}=v.default.state,i=e.currentUser.isLoggedIn(),r=e.RouterStore.state.route,a=Boolean(n&&n.canRead()&&n.isDefined()),s=Boolean(n&&n.canEdit()&&n.isDefined()),d=Boolean(n&&(0,q.Oh)(n)),u=n&&a&&(0,W.IJ)(e,n),p=Boolean(u),m=u&&(0,l.J5)(u.permissionItem.role),f=s&&!m,g=(null==n||null===(t=n.getModel())||void 0===t?void 0:t.isNonverifiedContentClassification())&&!(n&&b.Z.bypassedPage(n.id))&&!f,{publicPageData:y}=h.Z.state,S=!o||!d,_=Boolean((0,c.HK)(r)&&(!(0,c.wO)(r)&&!n||n&&n.isReady()&&!a||g||(null==y?void 0:y.requireInterstitial)||(null==y?void 0:y.requireLogin)&&!i));return{shouldShowSidebar:function(){if((0,N.GH)())return Boolean(null==y?void 0:y.template);const e="quickSearch"===r.name;return Boolean(!e&&!_&&i&&(S||(0,c.wO)(r)||a&&(s&&!p||d&&!p)&&!g&&!(null!=y&&y.requireInterstitial)))}(),shouldShowFrame:!_,shouldShowError:_}}}),ae=e=>re.getStateFor(e),se=new o.Z((()=>{const{mainEditorCurrentBlockStore:e}=v.default.state,t=e&&e.isCollectionView();return T.Z.state.isKeyboardMode&&!O.Z.state&&!Z.Z.isActive()&&!t&&!L.default.state.open&&!C.Z.state.open&&!(0,p.n)()&&0===w.Z.state.banners.length}),{debugName:"appHelpers.shouldHideTopbarStore"});function le(e){const{currentSpaceViewStore:t}=v.default.state;if(t){return s.G0(t.getWorkspacePages(),(0,K.KA)(e,t),t.getPrivatePages(e)).filter((e=>e.isNavigableBlock()))}return[]}function ce(e){const{currentSpaceViewStore:t}=v.default.state;return t?s.mN([...t.getBookmarkedPages(),...t.getWorkspacePages(),...(0,K.KA)(e,t),...t.getPrivatePages(e)],"id"):[]}function de(e){return e.getType()===i.Ti.copyIndicator&&!P.transactionQueue.isPendingTransactionForRecord(e.pointer)}const ue=s.HP((e=>new o.Z((()=>function(e){const{currentSpaceStore:t,currentSpaceViewStore:n,currentUserRootStore:o,currentUserSettingsStore:i}=v.default.state;if(!(n&&o&&t&&i))return;const r=(0,K.jv)(t),a=n.getBookmarkedPages(),s=n.getWorkspacePages(),l=n.getTeamsStores(),{allSharedPagesStores:c,visibleSharedPagesStores:d}=(0,K.MC)({environment:e,spaceViewStore:n,userSettingsStore:i}).state,u=n.getPrivatePages(e),p=(0,K.Cx)(t),m=1===r.length&&0===s.length&&"personal"===t.getPlanType(),f=a.length>0,g=!p&&!(0,$.bq)()&&s.length>0,h=c.length>0,b=i.hasUserPinnedToOutliner({spaceId:t.id,type:"shared"}),y=(0,$.bq)();return{isGuest:p,isPersonalSpace:m,showBookmarksSection:f,showWorkspaceSection:g,showSharedSection:h,showPrivateSection:!p,showOnlyPrivateSection:!(f||g||h||y),showSharedOverflowButton:c.length>K.G$||b,stickTemplateItemsToBottom:a.length+c.length+s.length+u.length>=8,allSharedPagesStores:c,visibleSharedPagesStores:d,showTeamSection:y,userJoinedTeamsStores:l}}(e)),{useDeepEqual:!0,debugName:"sidebarStateStore"}))),pe=new o.Z((()=>T.Z.state.isKeyboardMode||E.Z.state.isActive||S.ZP.state.isDragging||V.Z.state.open||M.Z.state.open||_.Z.state.open||x.Z.state.open||k.Z.hasOpenMouseCapturePopup()||A.Z.state.isOpen&&!D.default.isMiniOrCenterPeekOpen()||R.Z.state.isOpen||y.Z.state.open||I.Z.state.isPinned),{debugName:"menuIsOpenStore"}),me=new o.Z((()=>{const{currentSpaceViewStore:e,currentUserStore:t}=v.default.state,n=new Set;if(!e||!t)return n;for(const o of e.getTeamsStores()){o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===t.id))&&n.add(o.id)}return n}),{useDeepEqual:!0,debugName:"userTeamsInCurrentSpace"});function fe(e){return e.device.isPhone?24:96}const ge=900;function he(e){return fe(e)}function ve(e){const t=j.default.getCurrentDefaultContainer(),n=ge-2*fe(e);if(t){const e=f.Z.find((e=>e.props.store===t.props.store));if(e){const t=e.getContentInnerWidth();if(t)return Math.min(n,t)}}return n}function be(){const e=Y(),t=U.default.state;if("editing"!==t.mode)return!1;const n=t.multiSelection.start.store;return e&&e.id===n.id&&n.path.includes("title")||!1}function ye(){const e=U.default.state;if("editing"!==e.mode)return!1;const t=e.multiSelection.start.store,n="collection"===t.table;return t.path.includes("name")&&n||!1}function Se(){const{currentUserRootStore:e}=v.default.state;if(e){const t=e.getSpaceViewStores();return s.oA(t.map((e=>e.getSpaceId())))}return[]}function _e(e){return s.mN(e.getSpaceViewStores(),(e=>e.getSpaceId())).filter((e=>{const t=e.getSpaceStore();return e.isDefined()&&t&&t.canEdit()}))}async function we(e){await e.load();const t=e.getSpaceViewStores();await Promise.all(t.map((async e=>{await e.load();const t=e.getSpaceStore();t&&await t.load()})))}const ke=new o.Z((function(){const{currentUserSettingsStore:e}=v.default.state,t=(0,r.aN)();if(e){const n=e.getSettings();return void 0===(null==n?void 0:n.start_day_of_week)?t:null==n?void 0:n.start_day_of_week}return t}),{debugName:"userSettingsStartOfWeek"});function Ie(e){const{environment:t,store:n}=e;return n.isCollectionView()?(0,G.eA)(t)?g.Z.All:g.Z.Y:!(0,z.en)(n)&&D.default.isSidePeekOpen()?g.Z.All:g.Z.Y}function Ce(e){const{isFullScreen:t,environment:n}=e;return t&&(0,G.eA)(n)?g.Z.None:g.Z.X}},93959:(e,t,n)=>{n.d(t,{$4:()=>X,$Q:()=>U,$j:()=>ne,AG:()=>B,Au:()=>D,EE:()=>j,F0:()=>w,FQ:()=>q,FW:()=>C,Hw:()=>L,K8:()=>$,KC:()=>I,Mi:()=>A,RN:()=>z,Ru:()=>Y,TD:()=>E,Th:()=>ee,VL:()=>y,Wo:()=>S,YB:()=>k,YC:()=>oe,Z0:()=>J,Zu:()=>R,_3:()=>P,cR:()=>Z,ck:()=>M,h7:()=>F,hZ:()=>G,iX:()=>_,jH:()=>te,oX:()=>x,rC:()=>K,rm:()=>Q,xB:()=>V});n(57658),n(21703);var o=n(76205),i=n(35011),r=n(10070),a=n(45433),s=n(46328),l=n(53877),c=n(77657),d=n(42875),u=n(72126),p=n(23014),m=n(9844),f=n(97880),g=n(80444),h=n(77080),v=n(30874),b=n(26991);const y=16803324e5;function S(e,t){return e.find((e=>e.uri===t))}function _(e,t){return e.find((e=>e.presets.some((e=>e.uri===t))))}function w(e,t){return e.flatMap((e=>e.presets)).find((e=>e.uri===t))}function k(e,t){if(!t)return;return e.find((e=>e.allFeatures.find((e=>{if(x(e))for(const n of e.dependencies)if("collection"===n.type&&n.uri===t)return!0}))))}function I(e,t){const n=_(e,t.uri);if(!n)return[];return[...t.requiredFeatures,...t.defaultOnFeatures].filter((e=>{const t=n.allFeatures.find((t=>t.uri===e.featureUri));if(!t)return!1;const{type:o}=e;return"simple"===o?"dependencies"in t:"with_variant"===o?"variants"in t:void(0,f.t1)(o)}))}function C(e){return"variants"in e}function x(e){return"dependencies"in e}const T=[s.k.Owner];function M(e,t){const n=k(e,t);if(n)for(const o of n.allFeatures)if(x(o)){const e=o.dependencies.find((e=>"collection"===e.type&&e.uri===t));if(e)return e.value.schema??{}}}function P(e){let{featurePointers:t,appConfig:n}=e;const o=u.oA(t.map((e=>{const{type:t}=e;return"simple"===t?e.featureUri:"with_variant"===t?e.defaultVariantUri:void(0,f.t1)(t)}))),i={};for(const s of n.allFeatures)i[s.uri]=s;const r=o.map((e=>i[e])),a={};for(const s of r)for(const e of s.dependencies)a[e.uri]=e;return Object.values(a)}function A(e){return e.endsWith(a.WN)}function R(e,t){return e.presets.find((e=>e.uri===`${t}${a.WN}`))}function D(e,t){const n={},o=Object.entries(t);for(const[i,r]of Object.entries(e)){if(!i.startsWith("notion://"))continue;const e=null==r?void 0:r.type;if(e){const t=o.filter((t=>{let[n,o]=t;if(o)return o.type===e}));1===t.length&&(n[i]=t[0][0])}}return n}function B(e,t,n){const i=e.allFeatures.filter((e=>(e=>{var i,s,l,c,d,u,p,m;if(!x(e)||1!==e.dependencies.length||"collection_view"!==e.dependencies[0].type)return!1;const g=e.dependencies[0],h=n.getFormat().app_config_uri,v=t.getFormat().app_config_uri,y=(null===(i=n.getFormat())||void 0===i?void 0:i.app_uri_map)??{};if(!h||!v)return!1;if(g.blockUri!==h||g.collectionUri!==v)return!1;if(g.uri in y)return!1;const S=r.aQ.deriveTypeUris((null==t?void 0:t.getSchema())??{},null==t?void 0:t.getPropertyMapping()),_=g.value;switch(_.type){case"table":case"list":case"gallery":case"timeline":if(null!==(s=_.format)&&void 0!==s&&s.collection_group_by){const e=_.format.collection_group_by.property;if(!(0,a.jP)(e)||!S.has(e))return!1}if(null!==(l=_.query2)&&void 0!==l&&l.timeline_by){const e=_.query2.timeline_by;if(!(0,a.jP)(e)||!S.has(e))return!1}break;case"board":if(null!==(c=_.format)&&void 0!==c&&c.board_columns_by){const e=_.format.board_columns_by.property;if(!(0,a.jP)(e)||!S.has(e))return!1}if(null!==(d=_.format)&&void 0!==d&&d.collection_group_by){const e=_.format.collection_group_by.property;if(!(0,a.jP)(e)||!S.has(e))return!1}break;case"calendar":if(null!==(u=_.query2)&&void 0!==u&&u.calendar_by){const e=_.query2.calendar_by;if(!(0,a.jP)(e)||!S.has(e))return!1}break;case"page":return!1;default:(0,f.t1)(_.type)}const w=e=>!!(0,o.Oo)(e)||(0,a.jP)(e.property)&&S.has(e.property);if(null!==(p=_.format)&&void 0!==p&&p.property_filters)for(const n of _.format.property_filters){if(!O(n.filter,w))return!1;if(!(0,b.qf)(n.filter,t))return!1}if(null!==(m=_.query2)&&void 0!==m&&m.filter){const e=_.query2.filter;if(e.filters)for(const t of e.filters)if(!N(t,w))return!1}return!0})(e)));return u.mN(i,"uri")}function E(e,t){const n=u.xH(u.oA(t.allFeatures.map((e=>{if(x(e))return e.dependencies}))));return u.mN(n.filter((t=>e.includes(t.uri))),(e=>e.uri))}function F(e){return"app_container"===e.getFormatStore().getKeyStore("collection_view_sub_type").getValue()}function Z(e,t,n,o){if(t===a.GZ&&n===s.k.Owner)return!0;const i=r.aQ.deriveTypeUri(n,o.getPropertyMapping());if(!i)return!1;const l=function(e,t){if(t===a.GZ)return T;const n=M(e,t);return n?Object.keys(n):void 0}(e,t);return!!l&&l.includes(i)}function L(e,t,n){return(0,p.un)(e,t,n)}function j(e){return e===a.Kk||e===a.tD||e===a._1}function V(e){return e===a.g3}function U(e,t){const n=[];for(const i of t)"property"===i.type||"database_template"===i.type?e.has(i.collectionUri)&&n.push(i):"block"===i.type?e.has(i.parentUri)&&n.push(i):"blockUri"in i&&e.has(i.blockUri)&&n.push(i);let o=[];return n.length>0&&(o=U(new Set(n.map((e=>e.uri))),t)),[...n,...o]}function O(e,t){return!!t(e)}function N(e,t){if((0,o.aN)(e)){if(!O(e,t))return!1}else{if((0,o.Mm)(e))return!0;if(e.filters)for(const n of e.filters){if(!N(n,t))return!1}}return!0}function z(e,t){const n=[];if(e.filters)for(const o of e.filters){const e=H(o,t);if(!e)throw new Error("Invalid filter");n.push(e)}return{...e,filters:n}}function H(e,t){if((0,o.aN)(e))return null!=t&&t[e.property]?{...e,property:t[e.property]}:e;if((0,o.Mm)(e))return e;if((0,o.vA)(e)){if(e.filters){const n=[];for(const o of e.filters){const e=H(o,t);if(!e)throw new Error("Invalid filter");n.push(e)}return{operator:e.operator,filters:n}}}else(0,f.t1)(e)}function W(e,t,n){const i=t.getQuery(n.getSchema()),r=t.getFormat(),a=null==i?void 0:i.sort;if(a){if(a.some((t=>e.uri===t.property)))return!0}const s=t.getFormat().property_filters;if(s){const t=t=>!(0,o.Oo)(t)&&t.property===e.uri;if(s.some((e=>O(e.filter,t))))return!0}const l=null==i?void 0:i.filter;if(void 0!==l&&l.filters){const t=t=>!!(0,o.Oo)(t)||t.property!==e.uri;for(const e of l.filters){if(!N(e,t))return!0}}switch(t.getType()){case"table":case"list":case"gallery":case"timeline":if(r.collection_group_by){if(r.collection_group_by.property===e.uri)return!0}if(null!=i&&i.timeline_by){if(i.timeline_by===e.uri)return!0}break;case"board":if(r.board_columns_by){if(r.board_columns_by.property===e.uri)return!0}if(r.collection_group_by){if(r.collection_group_by.property===e.uri)return!0}break;case"calendar":if(null!=i&&i.calendar_by){if(i.calendar_by===e.uri)return!0}}return!1}function q(e,t){const n=(0,d.r)(),o=(0,l.em)(e,1,n);return(0,l.fZ)(o.valueOf(),o.plus({weeks:t}).minus({days:1}).valueOf(),n)}function G(e,t){const n=(0,l.DF)(e,(0,d.r)()).plus({days:t});return(0,l.ME)(n)}const K=[a.TZ,a.k$,a.pz];function $(e){var t;const{dependencies:n,collectionStore:o,collectionViewBlockStore:a,viewStores:s,validDependencies:l}=e,c=n.filter((e=>"property"===e.type)),d=[...c.filter((e=>"rollup"===e.propertySchema.type)),...c.filter((e=>"formula"===e.propertySchema.type))],u=n.filter((e=>"collection_view"===e.type)),p=r.aQ.deriveTypeUris(o.getSchema(),o.getPropertyMapping()),m=null===(t=a.getFormat())||void 0===t?void 0:t.app_uri_map,f={validDependencies:l,propertyDeps:[],viewDeps:[]};if(!p||!m)return f;for(const r of d){if(!p.has(r.uri))continue;const e=o.getSchema()[r.uri];if(e){if("rollup"===e.type){l.some((t=>t.uri===e.relation_property))&&(l.push(r),f.propertyDeps.push(e))}if("formula"===e.type){(0,i.pV)(e).some((e=>{for(const t of l)if(t.uri===e)return!0}))&&(l.push(r),f.propertyDeps.push(e))}}}for(const i of u){if(!m[i.uri])continue;const e=s.find((e=>e.id===m[i.uri]));if(!e)continue;l.some((t=>"property"===t.type&&W(t,e,o)))&&(l.push(i),f.viewDeps.push(e))}return f.validDependencies=l,f}function Q(){return h.default.checkGate("typed_db_migration")}function Y(){return h.default.checkGate("proj_management_sprints_upgrade")}function J(){const{currentSpaceStore:e}=g.default.state;return!Boolean(e&&!e.canEdit())&&h.default.checkGate("proj_management_tooltip_tour")}function X(){return h.default.checkGate("proj_management_tooltip_tour")}function ee(){return v.Z.getIntegrationsAsRecordMap().getModel({table:m.K2,id:c.Dv})&&h.default.checkGate("cron_connected_relation")}function te(e,t){var n;if(t&&e)return null===(n=e.getSettings())||void 0===n||null===(n=n.proj_management_tooltip_tour_v1_phase_per_space)||void 0===n?void 0:n[t.id]}function ne(e,t){return{create_a_task:"assign_to_someone",assign_to_someone:"change_task_status",change_task_status:t?"select_a_project":"click_view_settings",select_a_project:"complete",click_view_settings:"complete"}[e]}function oe(e,t){const n=w(e,t);if(!n)throw new Error(`Preset not found for URI: ${t}`);const{name:o,icon:i}=n;return{name:o,icon:i}}},91924:(e,t,n)=>{n.d(t,{HU:()=>u,IJ:()=>c,Q7:()=>l,eC:()=>d,k2:()=>p});var o=n(6495),i=n(32739),r=n(95477),a=n(77080),s=n(18514);function l(e){return!!e.device.isMobileNative&&(e.device.isIOS&&"on"===a.default.getEligibleGroup({experimentId:"ios_3rd_party_login_with_external_browser",defaultGroup:"control"})||e.device.isAndroid&&"on"===a.default.getEligibleGroup({experimentId:"android_3rd_party_login_with_external_browser",defaultGroup:"control"}))}function c(e){const{device:t}=e,n=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:n?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}return{redirectToAuth:!0,callbackType:"redirect"}}function d(e){const{device:t}=e,n=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:n?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}if(t.isMobileBrowser||(0,s.Sr)()){return{redirectToAuth:!0,callbackType:"redirect"}}return{redirectToAuth:!0,callbackType:"popup"}}async function u(e,t,n){if(e.device.isHttpApp){const e=await fetch(t);return(await e.json()).url}{const e=await fetch(i.NV({httpUrl:t,protocol:r.default.protocol,includePort:n}));return(await e.json()).url}}function p(e){return i.jP({url:o.tu[e],isLocalHost:"local"===e})}},80365:(e,t,n)=>{n.d(t,{L:()=>f});var o=n(18466),i=n(66897),r=n(36576),a=n(72126),s=n(21202),l=n(70279),c=n(23867),d=n(19889),u=n(97880),p=n(35661);function m(e,t){const n=a.oA(e.map((e=>function(e,t){if("comment_mention"===e.mentioned_from.type){const n=p.t1.createChildStore(t,{table:l.x_,id:e.mentioned_from.comment_id,spaceId:(0,c.C)(void 0)});if(!n.isDefined())return;const o=p.t1.createChildStore(t,n.getParentPointer());if(!o.isDefined())return;const i=p.G.createChildStore(t,{table:s.iU,id:o.getParentId()}),r=i.getNavigableBlockStore();if(!r)return;return i.id===r.id?{backlinkStore:r,timestamp:n.getLastEditedTime()}:{backlinkStore:r,scrollToBlockId:i.id,discussionId:o.id,timestamp:n.getLastEditedTime()}}if("reference"===e.mentioned_from.type){const n=p.G.createChildStore(t,{table:s.iU,id:e.mentioned_from.parent_block_id}).getNavigableBlockStore();if(!n)return;const o=n.getLastEditedTime();return{backlinkStore:n,scrollToBlockId:e.block_id,timestamp:o||0}}if("property_mention"===e.mentioned_from.type){const{block_id:n}=e.mentioned_from,o=p.G.createChildStore(t,{table:s.iU,id:n});if(!o.isDefined())return;const i=o.getNavigableBlockStore();if(!i)return;return i.id===o.id?{backlinkStore:i,timestamp:o.getLastEditedTime()}:{backlinkStore:i,scrollToBlockId:o.id,timestamp:o.getLastEditedTime()}}if("collection_reference"===e.mentioned_from.type){const{block_id:n}=e.mentioned_from,o=p.G.createChildStore(t,{table:s.iU,id:n});if(!o.isDefined())return;const i=o.getNavigableBlockStore();if(!i)return;return i.id===o.id?{backlinkStore:i,timestamp:o.getLastEditedTime()}:{backlinkStore:i,scrollToBlockId:o.id,timestamp:o.getLastEditedTime()}}if("alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type){const n=p.G.createChildStore(t,{table:s.iU,id:e.mentioned_from.pointer.id}),o=n.getNavigableBlockStore();if(!o)return;return{backlinkStore:o,scrollToBlockId:n.id,timestamp:o.getLastEditedTime()}}(0,u.t1)(e.mentioned_from)}(e,t)))),o=a.vM(n,(e=>{let{backlinkStore:t}=e;return t.id})),i=Object.values(o).map((e=>a.MR(e,(e=>e.discussionId?2:e.scrollToBlockId?1:0))[0]));return i.sort(((e,t)=>t.timestamp-e.timestamp)),i}function f(e,t){const{id:n}=t.currentUser;let a;if(n){const t=e.getRecordValue({table:d.KJ,id:n});t&&(a=(0,i.dp)(t))}const s=t.LocalBacklinkStore.getBacklinkState({blockId:e.id,currentUserId:t.currentUser.id}),l=o.Z.withListenerIgnored((()=>(0,r.sU)({actor:a,blockId:e.id,backlinks:s.backlinks,getRecordModel:e.getRecordModel})));return 0===l.length?{backlinks:[],inaccessibleBacklinkCount:s.inaccessibleBacklinkCount}:{backlinks:m(l,e),inaccessibleBacklinkCount:s.inaccessibleBacklinkCount}}},46888:(e,t,n)=>{n.d(t,{V:()=>a,c:()=>s});var o=n(73597),i=n(69645);function*r(e){const{blocks:t,includeOriginalBlocks:n,includeNonSelectableListContainer:r}=e;if(0===t.length)return;const a=(0,i.dq)({includeNonSelectableListContainer:r,root:t[0].getHighestContentBlockUIAncestor()});if(a)for(const s of t){const e=(0,i.Ib)(s,a);if(!e)continue;const t=(0,o.JK)(e);if(n||!t.next().done)for(const n of t)yield n.value.store}}function*a(e){for(const t of r({blocks:e,includeOriginalBlocks:!0,includeNonSelectableListContainer:!1})){const e=t.getTitleStore();e&&(yield e)}}function*s(e){yield*r({blocks:e,includeOriginalBlocks:!1,includeNonSelectableListContainer:!1})}},42:(e,t,n)=>{n.d(t,{Fr:()=>V,Jy:()=>D,S7:()=>E,UG:()=>L,W_:()=>w,Yu:()=>M,ZW:()=>Z,_Z:()=>R,ax:()=>S,d6:()=>U,iC:()=>P,iD:()=>j,n_:()=>B,sU:()=>A,sw:()=>y});var o=n(30120),i=n(99036),r=n(80951),a=n(53877),s=n(42875),l=n(72126),c=n(4615),d=n(71644),u=n(45953),p=n(21202),m=n(6287),f=n(70203),g=n(97880),h=n(5366),v=n(33929);const b=(0,h.defineMessages)({addNewTodoTitle:{defaultMessage:"Add a new to-do",id:"blockTemplates.templateButton.addNewTodoTitle"}});function y(){return u.Ao.create({block:{root:{id:"root",version:27,type:"factory",properties:{title:[[v.default.formatMessage(b.addNewTodoTitle)]]},content:["to_do"]},to_do:{id:"to_do",version:4,type:"to_do",parent_table:"block",parent_id:"root",alive:!0}}})}function S(){return u.Ao.create({block:{root:{id:"root",version:0,type:"button",format:{automation_id:"automation"}}},automation:{automation:{id:"automation",parent_id:"root",parent_table:p.iU,alive:!0,status:"active",trigger:{id:(0,c.ZP)(),type:"button"},action_ids:[],properties:{name:""}}}})}const _=(0,h.defineMessages)({namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.table.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.table.tagsPropertyTitle"}});function w(e){const{isInline:t,name:n}=e,o=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0}},collection_view:{view:{id:"view",version:0,type:"table",format:{collection_pointer:{table:m.v,id:"collection"},table_properties:[{property:"title",visible:!0,width:276},{property:o,visible:!0}],table_wrap:!0},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(_.namePropertyTitle),type:"title"},[o]:{name:v.default.formatMessage(_.tagsPropertyTitle),type:"multi_select"}},format:{collection_page_properties:[{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}const k=(0,h.defineMessages)({viewTitle:{defaultMessage:"Board view",id:"blockTemplates.board.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.board.namePropertyTitle"},assignPropertyTitle:{defaultMessage:"Assign",id:"blockTemplates.board.assignPropertyTitle"},statusPropertyTitle:{defaultMessage:"Status",id:"blockTemplates.board.statusPropertyTitle"},statusPropertyRedOptionTitle:{defaultMessage:"Not started",id:"blockTemplates.board.statusPropertyRedOptionTitle"},statusPropertyYellowOptionTitle:{defaultMessage:"In progress",id:"blockTemplates.board.statusPropertyYellowOptionTitle"},statusPropertyGreenOptionTitle:{defaultMessage:"Completed",id:"blockTemplates.board.statusPropertyGreenOptionTitle"},card1Title:{defaultMessage:"Card 1",id:"blockTemplates.board.card1Title"},card2Title:{defaultMessage:"Card 2",id:"blockTemplates.board.card2Title"},card3Title:{defaultMessage:"Card 3",id:"blockTemplates.board.card3Title"}});const I=(0,h.defineMessages)({viewTitle:{defaultMessage:"Calendar view",id:"blockTemplates.calendar.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.calendar.namePropertyTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.calendar.datePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.calendar.tagsPropertyTitle"}});const C=(0,h.defineMessages)({viewTitle:{defaultMessage:"Timeline view",id:"blockTemplates.timeline.viewTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.timeline.datePropertyTitle"}});const x=(0,h.defineMessages)({viewTitle:{defaultMessage:"Gallery view",id:"blockTemplates.gallery.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.gallery.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.gallery.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.gallery.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.gallery.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.gallery.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.gallery.page3Title"},page1TodoTitle:{defaultMessage:"To-do",id:"blockTemplates.gallery.page1TodoTitle"},page1CompletedTodoTitle:{defaultMessage:"Completed To-do",id:"blockTemplates.gallery.page1CompletedTodoTitle"}});const T=(0,h.defineMessages)({viewTitle:{defaultMessage:"List view",id:"blockTemplates.list.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.list.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.list.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.list.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.list.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.list.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.list.page3Title"}});function M(e){const{environment:t,isInline:n,viewType:l,name:c}=e;return"table"===l?w({environment:t,isInline:n,name:c}):"board"===l?function(e){const{isInline:t,name:n}=e,o=(0,d.ZP)(),r=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(k.card1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(k.card2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(k.card3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"board",name:v.default.formatMessage(k.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:m.v,id:"collection"},board_columns_by:{property:o,type:"status",groupBy:"group",sort:{type:"ascending"}},board_columns:[{property:o,value:{type:"status",value:{type:"by_group",group:"To-do"}}},{property:o,value:{type:"status",value:{type:"by_group",group:"In progress"}}},{property:o,value:{type:"status",value:{type:"by_group",group:"Complete"}}}],board_properties:[{property:o,visible:!1},{property:r,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(k.namePropertyTitle),type:"title"},[r]:{name:v.default.formatMessage(k.assignPropertyTitle),type:"person"},[o]:(0,i.I4)(v.default.formatMessage(k.statusPropertyTitle))},format:{collection_page_properties:[{property:o,visible:!0},{property:r,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):"calendar"===l?function(e){const{isInline:t,name:n}=e,o=(0,d.ZP)(),i=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:"calendar",name:v.default.formatMessage(I.viewTitle),format:{collection_pointer:{table:m.v,id:"collection"}},query2:{calendar_by:o},parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(I.namePropertyTitle),type:"title"},[o]:{name:v.default.formatMessage(I.datePropertyTitle),type:"date"},[i]:{name:v.default.formatMessage(I.tagsPropertyTitle),type:"multi_select"}},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):"list"===l?function(e){const{isInline:t,name:n}=e,o=(0,d.ZP)(),i=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(T.page1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(T.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(T.page3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"list",name:v.default.formatMessage(T.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:m.v,id:"collection"},list_properties:[{property:o,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(T.namePropertyTitle),type:"title"},[o]:{name:v.default.formatMessage(T.tagsPropertyTitle),type:"multi_select",options:[]},[i]:{name:v.default.formatMessage(T.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:i,visible:!0},{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):"gallery"===l?function(e){const{isInline:t,name:n}=e,o=(0,d.ZP)(),i=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(x.page1Title)]]},content:["to_do_1","to_do_2"]},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(x.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(x.page3Title)]]}},to_do_1:{id:"to_do_1",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[v.default.formatMessage(x.page1TodoTitle)]]}},to_do_2:{id:"to_do_2",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[v.default.formatMessage(x.page1CompletedTodoTitle)]],checked:[["Yes"]]}}},collection_view:{view:{id:"view",version:0,type:"gallery",name:v.default.formatMessage(x.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:m.v,id:"collection"},gallery_cover:{type:"page_content"}},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(x.namePropertyTitle),type:"title"},[o]:{name:v.default.formatMessage(x.tagsPropertyTitle),type:"multi_select",options:[]},[i]:{name:v.default.formatMessage(x.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:i,visible:!0},{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):"timeline"===l?function(e){const{isInline:t,name:n}=e,i=(0,d.ZP)(),l=(0,d.ZP)(),c=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[v.default.formatMessage(k.card1Title)]],[i]:(0,r.d7)((0,a.fZ)(o.ou.now().minus({days:5}).startOf("day").valueOf(),o.ou.now().minus({days:2}).startOf("day").valueOf(),(0,s.r)()))},alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[v.default.formatMessage(k.card2Title)]],[i]:(0,r.d7)((0,a.fZ)(o.ou.now().minus({days:3}).startOf("day").valueOf(),o.ou.now().startOf("day").valueOf(),(0,s.r)()))},alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[v.default.formatMessage(k.card3Title)]],[i]:(0,r.d7)((0,a.fZ)(o.ou.now().minus({days:1}).startOf("day").valueOf(),o.ou.now().plus({days:2}).startOf("day").valueOf(),(0,s.r)()))},alive:!0}},collection_view:{view:{id:"view",version:0,type:"timeline",name:v.default.formatMessage(C.viewTitle),format:{collection_pointer:{table:m.v,id:"collection"},timeline_show_table:!t,timeline_properties:[{property:"title",visible:!0}],timeline_table_properties:[{property:"title",visible:!0,width:280},{property:i,visible:!1,width:180},{property:l,visible:!1,width:180},{property:c,visible:!1,width:180}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(k.namePropertyTitle),type:"title"},[i]:{name:v.default.formatMessage(C.datePropertyTitle),type:"date"},[l]:{name:v.default.formatMessage(k.assignPropertyTitle),type:"person"},[c]:{name:v.default.formatMessage(k.statusPropertyTitle),type:"select",options:[{id:"1",value:v.default.formatMessage(k.statusPropertyRedOptionTitle),color:"red"},{id:"2",value:v.default.formatMessage(k.statusPropertyYellowOptionTitle),color:"yellow"},{id:"3",value:v.default.formatMessage(k.statusPropertyGreenOptionTitle),color:"green"}]}},format:{collection_page_properties:[{property:i,visible:!0},{property:l,visible:!0},{property:c,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):void("page"!==l&&(0,g.t1)(l))}function P(e){const{isInline:t,viewType:n}=e;return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:n,parent_id:"root",parent_table:"block",alive:!0}}})}function A(e){const{isInline:t,viewType:n,integrationId:o}=e;return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0}},collection:{collection:{id:"collection",name:void 0,schema:{},format:{is_placeholder:!0,integration_id:o},parent_id:"root",parent_table:"block",alive:!0}},collection_view:{view:{id:"view",version:0,type:n,format:{collection_pointer:{table:m.v,id:"collection"}},parent_id:"root",parent_table:"block",alive:!0}}})}function R(){return u.Ao.create({block:{root:{id:"root",type:"transclusion_container",content:["empty_text"],alive:!0},empty_text:{id:"empty_text",type:"text",parent_id:"root",parent_table:"block",alive:!0}}})}function D(e){return u.Ao.create({block:{root:{id:"root",type:"ai_block",content:[],alive:!0,format:{ai_prompt_key:e}}}})}function B(e){const t=l.DZ(e,(e=>`column${e+1}`));return u.Ao.create({block:{root:{id:"root",type:"column_list",content:t,alive:!0},...Object.assign({},...t.map((t=>{const n=`${t}_text`;return{[t]:{id:t,type:"column",parent_id:"root",parent_table:"block",content:[n],alive:!0,format:{column_ratio:1/e}},[n]:{id:n,type:"text",parent_id:t,parent_table:"block",alive:!0}}})))}})}function E(){const e=[(0,d.ZP)(),(0,d.ZP)()];return u.Ao.create({block:{root:{id:"root",type:"table",content:["row_1","row_2","row_3"],alive:!0,format:{table_block_column_order:e}},row_1:{id:"row_1",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_2:{id:"row_2",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_3:{id:"row_3",type:"table_row",parent_id:"root",parent_table:"block",alive:!0}}})}const F=(0,h.defineMessages)({tab1Title:{defaultMessage:"Tab 1",id:"blockTemplates.list.tab1Title"},tab2Title:{defaultMessage:"Tab 2",id:"blockTemplates.list.tab2Title"},tab3Title:{defaultMessage:"Tab 3",id:"blockTemplates.list.tab3Title"}});function Z(){return u.Ao.create({block:{root:{id:"root",type:"tab",alive:!0,content:["tab1","tab2","tab3"]},tab1:{id:"tab1",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[v.default.formatMessage(F.tab1Title)]]}},tab2:{id:"tab2",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[v.default.formatMessage(F.tab2Title)]]}},tab3:{id:"tab3",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[v.default.formatMessage(F.tab3Title)]]}}}})}function L(e){return u.Ao.create({[p.iU]:{root:{id:"root",type:e,format:{toggleable:!0}}}})}function j(e,t){return u.Ao.create({[p.iU]:{root:{id:"root",type:"code",properties:{title:f.TPx(t),language:f.TPx(e)}}}})}function V(){return u.Ao.create({[p.iU]:{root:{id:"root",type:"drawing",format:{drawing_value:void 0,block_page_width:!0,block_height:480}}}})}function U(){return u.Ao.create({[p.iU]:{root:{id:"root",type:"ai_block",format:{ai_skill:{ai_show_skill_picker:!0,ai_skill_type:"meeting_summary"}}}}})}},43250:(e,t,n)=>{n.d(t,{$ji:()=>Qt,A_D:()=>R,Apy:()=>sn,Aur:()=>St,B8p:()=>D,BEs:()=>we,BKn:()=>Ne,BaY:()=>He,C18:()=>Ue,CBT:()=>Ke,CZG:()=>me,C_N:()=>Yt,Cjq:()=>pt,D$4:()=>nt,Dkf:()=>Wt,EGJ:()=>Bt,Ep8:()=>v,F4o:()=>Te,FJA:()=>N,FLq:()=>ht,FoE:()=>ue,G6g:()=>oe,GNl:()=>H,GZn:()=>vn,GbT:()=>Z,Gcz:()=>At,GfL:()=>W,HKr:()=>X,HwD:()=>Jt,I2F:()=>Y,I9j:()=>Ye,IAq:()=>bt,Iiy:()=>cn,IpQ:()=>le,J2F:()=>_t,JR_:()=>Rt,JUE:()=>je,JiD:()=>r,JkF:()=>ke,K3y:()=>F,K4T:()=>Lt,KA2:()=>Q,KLh:()=>E,LoZ:()=>ne,MD7:()=>B,MU2:()=>Pe,MV2:()=>vt,M_0:()=>ln,Mdu:()=>Ve,Mfh:()=>be,Mpz:()=>yt,MsS:()=>u,N7t:()=>de,NFf:()=>pe,Nn$:()=>h,No6:()=>I,OE$:()=>pn,OK_:()=>m,Oau:()=>j,PBs:()=>g,QS0:()=>x,QSt:()=>o,Qcf:()=>w,Qgj:()=>ct,Quo:()=>c,RG3:()=>Be,RIA:()=>$t,S94:()=>z,S9A:()=>gn,TAd:()=>ze,TFu:()=>nn,TYv:()=>Oe,Uhm:()=>ut,Uwd:()=>Ee,V6y:()=>It,VMO:()=>Tt,Voi:()=>gt,Wh_:()=>C,Wiy:()=>T,Wy1:()=>dt,Xgx:()=>it,Xj_:()=>p,Xsh:()=>Je,Y6l:()=>Ze,Y7r:()=>Qe,YHn:()=>G,YOJ:()=>bn,YPt:()=>y,Z87:()=>mt,ZHw:()=>P,ZmO:()=>K,Zp2:()=>tn,_so:()=>kt,a6i:()=>se,aL4:()=>Ae,afv:()=>q,aiP:()=>a,alX:()=>i,b_f:()=>U,blN:()=>Ce,c7X:()=>Et,cFM:()=>et,dXl:()=>fn,euV:()=>k,exn:()=>ve,f0e:()=>an,f8P:()=>ie,fHd:()=>S,fOh:()=>mn,fe0:()=>_e,gGc:()=>$,gec:()=>st,gjL:()=>J,gug:()=>l,hEP:()=>on,hKO:()=>ce,hzx:()=>ee,i25:()=>wt,iTw:()=>rt,irE:()=>jt,j35:()=>Me,jWx:()=>Fe,kDE:()=>Ut,kUP:()=>xt,l24:()=>xe,lIT:()=>M,lmr:()=>yn,mJW:()=>b,mSZ:()=>A,mWS:()=>Pt,myM:()=>ot,nM$:()=>Ft,nU_:()=>fe,o4s:()=>Nt,oc0:()=>$e,ovr:()=>Ot,p0b:()=>L,p1Q:()=>_,p4m:()=>re,pg$:()=>en,q1J:()=>Ie,qnV:()=>dn,qr0:()=>We,qxR:()=>Le,rG8:()=>Ge,rIE:()=>De,rIj:()=>tt,rIs:()=>Xt,rKl:()=>s,rTm:()=>Gt,rVO:()=>Kt,rcG:()=>ge,rli:()=>ye,s$o:()=>Xe,sbt:()=>Zt,sqL:()=>Vt,srZ:()=>V,tQh:()=>O,tfM:()=>Ct,ulv:()=>hn,vvn:()=>ft,wFE:()=>te,wG0:()=>rn,wKH:()=>f,wXs:()=>Dt,wnm:()=>at,x2W:()=>lt,x4y:()=>d,x9t:()=>Ht,xvU:()=>qt,y4j:()=>un,yNE:()=>Re,ykc:()=>he,zYS:()=>Se,z_z:()=>zt,zar:()=>qe,zov:()=>ae,zwY:()=>Mt});const o="notion-cursor-default",i="hidden",r="notion-fadein",a="notion-mobile",s="notion-fadein-fast",l="notion-front-page",c="analytics-scroll-point",d="notion-login",u="notion-light-theme",p="notion-dark-theme",m="notion-scroller",f="vertical",g="horizontal",h="notion-history-modal",v="notion-block-resizer",b="notion-overlay-container",y="notion-default-overlay-container",S="notion-page-template-modal",_="notion-peek-renderer",w="notion-text-action-menu",k="notion-selectable",I="notion-selectable-halo",C="notion-focusable-within",x="notion-page-content",T="notion-frame",M="notion-topbar",P="notion-topbar-mobile",A="notion-topbar-more-button",R="notion-topbar-action-buttons",D="notion-share-menu",B="notion-topbar-share-menu",E="notion-updates-menu",F="notion-topbar-updates-button",Z="notion-topbar-favorite-button",L="notion-topbar-comments-button",j="notion-search-menu",V="notion-embed-menu",U="notion-unfurling-menu",O="notion-media-menu",N="notion-invite",z="notion-record-icon",H="notion-calendar-header-days",W="notion-board-group",q="notion-block-permission-settings-workspace-access",G="notion-block-permission-settings-team-access",K="notion-block-permission-settings-team-access",$="notion-block-permission-settings-group-access",Q="notion-page-view-discussion",Y="notion-updates-button-mentions",J="notion-updates-button-all-updates",X="notion-updates-button-archive",ee="notion-discussion-input-edit-existing-comment",te="notion-discussion-input",ne="notion-discussion-reply-menu",oe="notion-comment-overflow-menu",ie="notion-shimmer",re="notion-link",ae="ai-block",se="notion-sharing-permission-role-select",le="notion-sharing-permission-expiration-timestamp",ce="notion-language-picker",de="notion-cookie-selector",ue="notion-activity-section-icon",pe="notion-activity-section-header",me="notion-activity-section-time",fe="notion-activity-section-children",ge="notion-sidebar",he="notion-sidebar-mobile",ve="notion-open-sidebar",be="notion-close-sidebar",ye="notion-sidebar-switcher",Se="notion-space-settings",_e="notion-outliner-bookmarks",we="notion-outliner-workspace",ke="notion-outliner-shared",Ie="notion-outliner-private",Ce="notion-outliner-offline",xe="notion-outliner-team",Te="notion-outliner-bookmarks-header",Me="notion-outliner-workspace-header",Pe="notion-outliner-shared-header",Ae="notion-outliner-private-header",Re="notion-outliner-offline-header",De="notion-outliner-team-header",Be="notion-outliner-joined-team-header",Ee="notion-outliner-unjoined-team-header",Fe="notion-outliner-search-team-header",Ze="notion-outliner-public-page-template-includes-header",Le="notion-outliner-team-context-menu-button",je="notion-outliner-team-heading-context-menu-button",Ve="notion-outliner-team-context-menu",Ue="notion-updates-menu",Oe="notion-sidebar-trash-menu",Ne="notion-password-modal",ze="notion-scim-table-revoke-button",He="notion-subscription-checkout-title",We="notion-subscription-checkout-description",qe="notion-update-sidebar",Ge="notion-update-sidebar-tab-comments-segmented-control",Ke="notion-update-sidebar-tab-comments-dropdown-control",$e="notion-update-sidebar-tab-comments-dropdown-button-open",Qe="notion-update-sidebar-tab-comments-dropdown-button-resolved",Ye="notion-update-sidebar-tab-comments-header",Je="notion-update-sidebar-tab-comments-comments-scroller",Xe="notion-update-sidebar-tab-comments-discussion-item",et="notion-update-sidebar-tab-updates-header",tt="notion-team-settings-modal",nt="notion-add-members-modal",ot="notion-new-team",it="notion-use-case-onboarding-profile",rt="notion-use-case-onboarding-company-survey",at="notion-use-case-onboarding-persona-survey",st="notion-workspace-choose",lt="notion-workspace-plan-choose",ct="notion-workspace-create",dt="notion-workspace-invite",ut="notion-onboarding-error",pt="notion-onboarding-popup",mt="notion-onboarding-button",ft="notion-onboarding-plan-type-personal",gt="notion-onboarding-plan-type-team",ht="notion-onboarding-plan-type-school",vt="notion-onboarding-app-download",bt="notion-onboarding-persona-survey-persona",yt="notion-onboarding-persona-survey-role",St="notion-onboarding-persona-survey-companysize",_t="notion-onboarding-persona-survey-usecases",wt="notion-onboarding-timed-trial-upsell",kt="notion-table-view",It="notion-table-view-add-column",Ct="notion-table-view-add-row",xt="notion-table-view-header-row",Tt="notion-table-view-header-cell",Mt="notion-table-view-row",Pt="notion-table-view-cell",At="notion-table-view-empty-placeholder",Rt="notion-table-view-drag-and-fill-handle",Dt="notion-table-view-frozen-column-repositioner",Bt="notion-board-view",Et="notion-calendar-view",Ft="notion-list-view",Zt="notion-gallery-view",Lt="notion-collection-item",jt="notion-calendar-view-day",Vt="notion-collection-view-item-add",Ut="notion-timeline-view",Ot="notion-timeline-item",Nt="notion-timeline-item-row",zt="notion-timeline-item-properties",Ht="notion-collection-view-body",Wt="notion-view-settings-sidebar",qt="notion-collection-edit-view",Gt="notion-collection-view-tab-button",Kt="notion-collection-add-view",$t="notion-collection-automation-edit-view",Qt="notion-template-picker-item",Yt="notion-template-picker-item-action-menu",Jt="draggable-ghost-section",Xt="developer-integrations-container",en="developer-integrations-list",tn="developer-integration-create",nn="developer-integration-view",on="developer-integration-lab",rn="developer-integration-not-found",an="notion-table-row-selector",sn="notion-table-column-selector",ln="notion-table-row",cn="notion-table-cell",dn="notion-table-cell-text",un="notion-table-selection-overlay",pn="notion-table-tbody-selectable",mn="notion-table-content",fn="notion-temporary-comment",gn="notion-margin-discussion-item",hn="search-query-result-item",vn="search-result-mobile-body-scroller",bn="notion-completions-feedback-popup",yn="notion-help-button"},47853:(e,t,n)=>{n.d(t,{D:()=>r});var o=n(13991),i=n(25666);function r(e){return i.D(e,o.SP)}},57254:(e,t,n)=>{n.d(t,{A:()=>s,S:()=>l});n(21703);var o=n(94568),i=n(97880),r=n(80444),a=n(98165);function s(){const{mainEditorCurrentBlockStore:e}=r.default.state;if(!e)throw new Error("No current block store");const t=(0,a.qA)(e);return Boolean(t.find((e=>e.id===o.TM||e.id===o.y3)))}function l(e){return"assistantChat"===e.type?1===e.operations.length&&"createBlock"===e.operations[0].command&&"text"===e.operations[0].blockNode.tagName&&0===e.operations[0].blockNode.text.length:"assistantChatText"===e.type?0===e.text.length:void(0,i.t1)(e)}},82343:(e,t,n)=>{n.d(t,{pZ:()=>S,Gb:()=>I,PN:()=>_,Rr:()=>M,pt:()=>w,uV:()=>x,$5:()=>T,td:()=>C});var o=n(14577),i=n(80700),r=n(81730),a=n(94412),s=n(10450),l=(n(57658),n(78106)),c=n(72126),d=n(149);var u=n(1274),p=n(42875),m=n(59753),f=n(26825),g=n(98963),h=n(97880),v=n(77080),b=n(35661),y=n(35057);const S=30;function _(){return v.default.checkGate("button_property")}function w(e){const{context:t}=e;let n,o,u;if(t.persisted){const{automationStore:i}=t,a=e.automationValue??i.getValue();if(!a)return{error:new r.MO("Missing automation record")};n=m.kk.fromValue(g.cv,a),o=i.getActionStores().map((e=>e.getModel())).filter(h.$K)}else n=new a.X({triggerType:"button",actions:t.actions,parentPointer:t.parentPointer,spaceId:t.parentPointer.spaceId}),o=t.actions.map((e=>new a.e(e,t.parentPointer.spaceId)));if("button_property"===t.type){const e=t.collectionContextStore.collectionStore();if(!e)return{error:new r.MO("Missing collectionContextStore")};u=(0,s.zW)({collectionPointer:{...e.pointer,spaceId:e.getSpaceId()},intl:t.intl})}else if("button_block"===t.type){const e=t.pageStore.getAssociatedCollectionStore();u=(0,s.rb)({intl:t.intl,collectionPointer:e?{...e.pointer,spaceId:e.getSpaceId()}:void 0})}else"structured_automation"===t.type?u={value:{valueTypes:[]}}:"event"===t.type?u=(0,s.E$)({collectionPointer:t.parentPointer,intl:t.intl}):(0,h.t1)(t);return d.x.isFail(u)?u:function(e){const{context:t}=e,{actionModels:n}=t,o={valueTypes:t.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}};for(const r of n){const e=(0,i.z)(r.getType()).typecheck(t,r),n=c.d9(o.valueTypes);if(o.actionInputValueTypes[r.id]=n,d.x.isFail(e))return e;for(const t of e.value.valueTypes??[])o.valueTypes.some((e=>(0,l.Fl)(t,e)))||o.valueTypes.push(t);e.value.validationFailures&&(o.actionValidationFailures[r.id]=e.value.validationFailures)}return{value:o}}({context:{automationModel:n,actionModels:o,handleDataRequest:(0,l.yf)(t.parentRecordStore.getRecordModel,t.parentRecordStore.loadRecordModel),valueTypes:u.value.valueTypes??[],intl:t.intl,getRecordModel:t.parentRecordStore.getRecordModel,userTimeZone:(0,p.r)()}})}const k=new WeakMap;function I(e){const t=k.get(e.automationStore);if(t)return t;{const t=new o.Z((()=>function(e){if(("button_block"===e.type||"button_property"===e.type)&&!e.currentUserId)return{executionPermissionStatus:"insufficient",typecheckResult:void 0};const t=e.automationStore.getModel();if(!t)return{executionPermissionStatus:"unknown",typecheckResult:void 0};const n=e.automationStore.getActionStores().map((e=>e.getModel()));if(!n.every((0,h.AO)((e=>(0,h.$K)(e)?{true:e}:{false:e}))))return{executionPermissionStatus:"insufficient",typecheckResult:void 0};const o=w({context:e});if(d.x.isFail(o))return{executionPermissionStatus:"unknown",typecheckResult:o};const r={automationModel:t,valueTypes:o.value.valueTypes};for(const a of n){const t=(0,i.z)(a.getType()).getDependencies(r,a);for(const n of t){const t=(0,b.Kv)(e.parentRecordStore,n.pointer).getRole();if(!t||(0,f.gr)(t,n.minimumRole))return{executionPermissionStatus:"insufficient",typecheckResult:o}}}return{executionPermissionStatus:"sufficient",typecheckResult:o}}(e)),{debugName:"buttonAutomationAnalysisCachedStore"});return k.set(e.automationStore,t),t}}function C(e){return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof b.zq&&e.isType("duplicate_blocks"))).ancestor)}function x(e,t){const n=e.getModel(),o=e.getActionStores(),i=o.filter((e=>e.isDefined())).map((e=>e.getModel())).filter(h.$K);if(n&&i.length===o.length)return{checkExperimentGate:e=>Promise.resolve(v.default.checkGate(e)),checkSubscribed:()=>Promise.resolve((0,y.sX)()),automation:n,automationActions:i,contextType:t,checkType:"canAddAction"}}function T(e){if(!e)return{editPermissionStatus:"unknown",reason:"missing_automation_context"};const{automationStore:t}=e,n=t.getValue(),o=t.getModel();if(!o||!n)return{editPermissionStatus:"unknown",reason:"missing_automation_model"};const r=t.getActionStores().map((e=>e.getModel()));if(!r.every((0,h.AO)((e=>(0,h.$K)(e)?{true:e}:{false:e}))))return{editPermissionStatus:"unknown",reason:"missing_automation_action_model"};const a=w({context:e});if(d.x.isFail(a))return{editPermissionStatus:"unknown",reason:"typecheck_error"};const s=r.length>0&&r.some((e=>!e.isType("slack_notification")));if(o.isType("event")&&s&&!(0,y.sX)())return{editPermissionStatus:"insufficient",reason:"free_workspace"};const l={automationModel:o,valueTypes:a.value.valueTypes},c=r.filter((e=>e.isType("slack_notification")));for(const d of c){const t=(0,i.z)(d.getType()).getDependencies(l,d);for(const n of t){const t=(0,b.Kv)(e.parentRecordStore,n.pointer).getRole();if(!t||(0,f.gr)(t,n.minimumRole))return{actionId:d.id,editPermissionStatus:"insufficient",reason:"missing_permissions"}}}const p=(0,u.fz)({automationValue:n,actionValues:t.getActionStores().map((e=>({config:e.getConfig(),type:e.getType()})))});for(const i of p){const e=t.getRecordRole(i.pointer);if(!e||(0,f.gr)(e,i.minimumRequiredRole))return{editPermissionStatus:"insufficient",reason:"missing_permissions"}}return{editPermissionStatus:"sufficient"}}function M(e){const{device:t}=e.environment;return!(t.isIOS&&t.isMobileNative)}},97004:(e,t,n)=>{n.d(t,{CN:()=>C,Gz:()=>I,H_:()=>h,Me:()=>w,Mj:()=>_,Nq:()=>y,Pi:()=>k,RL:()=>v,Zh:()=>b,m1:()=>T,qd:()=>g,rQ:()=>x,yU:()=>S});n(57658);var o=n(76205),i=n(99036),r=n(43690),a=n(53504),s=n(93824),l=n(42875),c=n(72126),d=n(97880),u=n(28020),p=n(93959),m=n(17335),f=n(33929);function g(e){const{schema:t,filters:n,getRecordModel:i}=e,r=[];for(const o of Object.keys(t)){const e=h({property:o,schema:t,getRecordModel:i});e&&r.push(e)}const a=r.filter((e=>!n.find((t=>(0,o.aN)(t.filter)&&t.filter.property===e.property))));return c.MR(a,(e=>{const n=t[e.property];return(null==n?void 0:n.name)||""}))}function h(e){const{property:t,schema:n,getRecordModel:i}=e,r=(0,m.zZ)({property:t,schema:n,getRecordModel:i});if((0,o.a_)(r)?!(0,o.mv)(r.subfilter):!(0,o.mv)(r))return{property:t,filter:r}}function v(e){var t;const{collectionContextStore:n,applySubitemFilter:r}=e,a=n.currentPropertyFiltersStore.state,s=n.currentCombinatorFilterStore.state,l=r&&n.currentSubitemFormatStore.state,d=n.normalizedSchemaStore.state,u=l&&d[l.property],p=u&&"relation"===u.type&&(0,i.F0)(u)===(null===(t=n.collectionStore())||void 0===t?void 0:t.id)&&u.property,m=p?{property:p,filter:{operator:"is_empty"}}:void 0,f=(0,o.OH)({propertyFilters:a,combinatorFilter:s,schema:d});return c.oA([m,...f])}function b(e,t){var n,i;const l=e.collectionViewStore();if(!l)return{combinatorFilter:void 0,filters:{moveOps:[],removed:[],updated:[],moved:[],added:[]},sorts:void 0};const d="persisted"===t?l.getQueryStore().getKeyStore("sort").getValue()||[]:(null===(n=e.normalizedQueryStore.state)||void 0===n?void 0:n.sort)||[],u=e.currentSortsStore.state,p="persisted"===t?l.getQueryStore().getKeyStore("filter").getValue():null===(i=e.normalizedQueryStore.state)||void 0===i?void 0:i.filter,m=e.currentCombinatorFilterStore.state,f="persisted"===t?l.getPropertyFiltersStore().getValue()||[]:function(e){const t=e.normalizedSchemaStore.state,n=e.normalizedFormatStore.state.property_filters||[];return c.oA(n.filter((n=>{const i=(0,r.dN)(n.filter,t),a=e.collectionViewBlockStore();if(t[n.filter.property]&&i&&(0,o.J5)(t,n.filter.property,i.filter,null==a?void 0:a.getRecordModel))return i&&{id:n.id,filter:i}})))}(e),g=e.currentPropertyFiltersStore.state,h=f.map((e=>e.id)),v=g.map((e=>e.id)),{beforeOps:b,removeOps:y}=(0,s.q)(h,v),S=Array.from(y).filter((e=>!v.includes(e))),_=Object.keys(b).map((e=>({id:e,beforeId:b[e]}))),w=_.filter((e=>{let{id:t}=e;return h.includes(t)})).map((e=>{let{id:t}=e;return t})),k=_.filter((e=>{let{id:t}=e;return!h.includes(t)})).map((e=>{let{id:t}=e;return t})),I=g.filter((e=>f.find((t=>{if(e.id!==t.id)return!1;const n=c.Xh(t),o=c.Xh(e);return!c.Xy((0,a.Z)(o,"ignore-class-instances"),(0,a.Z)(n,"ignore-class-instances"))})))).map((e=>e.id));return{combinatorFilter:c.Xy(p,m)?void 0:{value:m},filters:{moveOps:_,removed:S,updated:I,moved:w,added:k},sorts:c.Xy(d,u)?void 0:{value:u}}}function y(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter||void 0!==t.sorts)}function S(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter)}function _(e){const t=e.localStateDiffStore.state;return Boolean(void 0!==t.sorts)}function w(e){return{property:(0,i.uS)(e),filter:{operator:"string_contains",value:{type:"exact",value:void 0}}}}function k(e){const t=e.currentCombinatorFilterStore.state,n=e.currentPropertyFiltersStore.state.filter((e=>!(0,p.EE)(e.id))).map((e=>e.filter)),o=[...(null==t?void 0:t.filters)||[],...n];return{...t,filters:o,operator:"and"}}function I(e,t){const n=e.currentCombinatorFilterStore.state,o=e.currentPropertyFiltersStore.state.filter((e=>e.id!==t.id)),i=[...(null==n?void 0:n.filters)||[],t.filter];return{combinatorFilter:{operator:"and",...n,filters:i},propertyFilters:o}}function C(e,t,n,o){let i=n.filter((e=>"is_group"===e.type)).map((t=>e.find((e=>e.name===t.value)))).filter(d.$K),r=n.filter((e=>"is_option"===e.type)).map((e=>t.find((t=>t.value===e.value)))).filter(d.$K);for(const a of e){const e=a.optionIds??[];if(i.some((e=>e.id===a.id)))r=r.filter((t=>!e.includes(t.id)));else if(e.length>0){const t=r.filter((t=>!e.includes(t.id)));t.length+e.length===r.length&&(r=t,i=[...i,a])}}if("is_option"===o.type){const n=t.find((e=>e.value===o.value));if(!n)return;const a=r.filter((e=>e.id!==n.id));if(a.length<r.length)r=a;else{const o=e.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(n.id)})),a=i.find((e=>e.id===(null==o?void 0:o.id)));if(a){const e=t.filter((e=>{var t;return(null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id))&&e.id!==n.id}));i=i.filter((e=>e.id!==a.id)),r=[...r,...e]}else{r=[...r,n];const e=(null==o?void 0:o.optionIds)??[];if(o&&e.length>0){const t=r.filter((t=>!e.includes(t.id)));t.length+e.length===r.length&&(r=t,i=[...i,o])}}}}else if("is_group"===o.type){const t=e.find((e=>e.name===o.value));if(!t)return;const n=i.filter((e=>e.id!==t.id));if(n.length<i.length)i=n;else{const e=t.optionIds??[];i=[...i,t],r=r.filter((t=>!e.includes(t.id)))}}else(0,d.t1)(o.type);return[...i.map((e=>({type:"is_group",value:e.name}))),...r.map((e=>({type:"is_option",value:e.value})))]}function x(e){const{group:t,options:n,filterValues:o}=e,i=o.some((e=>"is_group"===e.type&&e.value===t.name)),r=n.filter((e=>{var n;return null===(n=t.optionIds)||void 0===n?void 0:n.includes(e.id)})),a=new Map;for(const d of r){const e=o.some((e=>"is_option"===e.type&&e.value===d.value))||i;a.set(d.id,e)}const s=Array.from(a.values()),l=s.some((e=>e)),c=s.every((e=>e))&&s.length>0;return{groupCheckState:!(!i&&!c)||!!l&&"partial",optionCheckedInfo:a}}function T(e){const{collectionContextStore:t,environment:n}=e,i=t.relativeVariableStore.state,r=t.currentPropertyFiltersStore.state,a=t.currentCombinatorFilterStore.state,s=r.filter((e=>!(0,o.Oo)(e.filter))).map((e=>e.filter));if(0===s.length&&!a)return;const c={schema:t.normalizedSchemaStore.state,userId:n.currentUser.id,userTimeZone:(0,l.r)(),userStartOfWeek:u.AK.state,intl:f.default.getIntl(),relativeVariableResult:i};return{filter:{filters:a?[...s,a]:s,operator:"and"},context:c}}},4708:(e,t,n)=>{n.d(t,{A3:()=>_,B9:()=>w,C$:()=>I,CY:()=>k,En:()=>P,F$:()=>b,GH:()=>Z,Lm:()=>h,Or:()=>m,Rv:()=>f,Ye:()=>p,_6:()=>d,fJ:()=>x,fW:()=>B,g4:()=>D,gp:()=>g,kG:()=>T,p1:()=>u,s$:()=>S,s2:()=>M,u3:()=>y,uD:()=>C,uX:()=>L,wd:()=>F,yq:()=>E,zq:()=>v});var o=n(13991),i=(n(95477),n(77080)),r=n(88893),a=n(35057),s=n(93827),l=n(38755),c=n(95697);function d(e){return!e.device.isMobile&&"on"===i.default.getEligibleGroup({experimentId:"contextual-invite-on-select-focus",defaultGroup:"control"})}function u(){return r.ye()&&"on"===i.default.getEligibleGroup({experimentId:"request_membership",defaultGroup:"control"})}function p(e){return r.ye()&&"on"===i.default.getEligibleGroup({experimentId:"guest_membership_request",defaultGroup:"control"})}function m(){return S()}function f(){return(0,a.Mk)()&&"on"===i.default.getEligibleGroup({experimentId:"import_slack_contacts",defaultGroup:"control"})}function g(e){let{currentSpaceStore:t}=e;return!!(0,l.Q9)(t)&&"on"===i.default.getEligibleGroup({experimentId:"share_modal_placeholder",defaultGroup:"control"})}function h(){return i.default.checkGate("share_modal_invalid_invite_tokens")}function v(e){return!e.device.isMobile}function b(){return(0,c.bq)()&&"on"===i.default.getEligibleGroup({experimentId:"teamspace_guests",defaultGroup:"control"})}function y(){return(0,c.bq)()&&"on"===i.default.getEligibleGroup({experimentId:"teams_invite_link",defaultGroup:"control"})}function S(){return(0,c.bq)()&&"on"===i.default.getEligibleGroup({experimentId:"team_invite_link_ms2",defaultGroup:"control"})}function _(){return i.default.checkGate("drawing_block")}function w(){return i.default.checkGate("team_add_app_template_tooltip")}function k(e){return"en-US"!==o.SP||e?"control":i.default.getEligibleGroup({experimentId:"onboarding_invite_skip_button",defaultGroup:"control"})}function I(){return"on"===i.default.getEligibleGroup({experimentId:"full_access_privacy_selector",defaultGroup:"control"})}function C(){return i.default.getEligibleGroup({experimentId:"share_modal_autofill_email",defaultGroup:"control"})}function x(){return"on"===i.default.getEligibleGroup({experimentId:"share_modal_pending_invite_status_ui",defaultGroup:"control"})}function T(e){if(!(0,l.Fn)(e))return"control";return(0,c.$)(e)?"control":i.default.getEligibleGroup({experimentId:"share_modal_guest_member_confirmation",defaultGroup:"control"})??"control"}function M(){return i.default.checkGate("in_app_template_gallery")}function P(){return!1}function A(e,t){const{device:n}=e,{spaceStore:o}=t,i=o.getSubscriptionTier();return"business"!==i&&"enterprise"!==i&&!n.isMobile}function R(e){return i.default.getEligibleGroup({experimentId:"persona_survey_joiner",defaultGroup:"control"})}function D(e,t){return!!A(e,t)&&"banner_with_survey"===R()}function B(e,t){return!!A(e,t)&&["banner_with_survey","banner_only"].includes(R())}function E(){return"on"===i.default.getEligibleGroup({experimentId:"random_house",defaultGroup:"control"})}function F(){return i.default.checkGate("guest_invite_requests")}function Z(){return Boolean((0,s.C)()&&"on"===i.default.getEligibleGroup({experimentId:"public_page_template_sidebar",defaultGroup:"control"}))}function L(e){return Boolean((null==e?void 0:e.template)&&Z())}},14976:(e,t,n)=>{n.d(t,{Dn:()=>te,Gj:()=>se,IY:()=>z,Ob:()=>pe,PY:()=>de,Qb:()=>Y,Rl:()=>fe,SD:()=>ne,So:()=>me,TQ:()=>he,Ut:()=>J,We:()=>ve,Xh:()=>H,bD:()=>N,cD:()=>le,fm:()=>ce,kV:()=>re,li:()=>oe,lw:()=>X,n$:()=>$,vO:()=>ie,x9:()=>Q,xX:()=>ue});var o=n(22377),i=n(15095),r=n(42875),a=n(72126),s=n(82883),l=n(21202),c=n(70203),d=n(44805),u=n(63143),p=n(97444),m=n(32741),f=n(48514),g=n(95477),h=n(24990),v=n(33929),b=n(68056),y=n(77080),S=n(30874),_=n(35661),w=n(24666),k=n(46150),I=n(62619),C=n(83631),x=n(45162),T=n(70219),M=n(65598),P=n(31352),A=n(89224);function R(e){return I.kK(e)&&e.classList.contains(d.Eu)}function D(e){return I.kK(e)&&e.classList.contains(d.tL)}function B(e){return function(e){const t=I.sh(e,(e=>(0,C.Xu)(e)||(0,k.eD)(e)));if(t&&R(t))return t}(e)||F(e)||function(e){const t=I.sh(e,(e=>D(e)||(0,k.eD)(e)));if(t&&D(t))return t}(e)}function E(e){return I.kK(e)&&e.classList.contains(o.P)}function F(e){const t=I.sh(e,(e=>(0,C.Xu)(e)||(0,k.eD)(e)));if(t&&(0,C.Xu)(t))return t}const Z=function(e){return I.kK(e)&&e.classList.contains(d.mb)},L=function(e){if(Z(e))return!0;try{return Z(e.parentNode)}catch(t){return!1}},j=function(e){try{const t=I.sh(e,(e=>Boolean(e.getAttribute&&e.getAttribute("contenteditable"))||(0,k.eD)(e)));return t&&t.isContentEditable}catch(t){return!1}};function V(e){return I.kK(e)&&e.classList.contains(d.$A)}function U(e,t){if(e===t.container){if(I.Gs(e)){const n=e.textContent||"";return(0,i.p4)(n.substring(0,t.offset)).length}{const n=Array.from(e.childNodes).slice(0,t.offset).map((e=>G(W(e)))).join("");return(0,i.p4)(n).length}}let n=0;for(const o of Array.from(e.childNodes)){if(o.contains(t.container))return n+U(o,t);n+=(0,i.p4)(G(W(o))).length}return n}function O(e,t){const n=(0,k.X1)(e);if(!n)return 0;return U(n,function(e,t){const n=B(e);if(n){const e=n.parentNode,o=Array.from(e.childNodes).indexOf(n);return{container:e,offset:0===t?o:o+1}}if(Z(e)||Z(e.parentNode))return{container:e,offset:(e.textContent||" ").length-1};return{container:e,offset:t}}(e,t))}function N(e,t){if(0===t)return!(e.childNodes.length>0)||R(e.childNodes[0])||E(e.childNodes[0])||(0,C.Xu)(e.childNodes[0])||D(e.childNodes[0])||V(e.childNodes[0])?{container:e,offset:0}:{container:e.childNodes[0],offset:0};const n=a.cx(e.childNodes,V),o=n>=0?n-1:e.childNodes.length-1;let r=t;for(let s=0;s<=o;s++){const t=e.childNodes[s],n=G(W(t)),l=(0,i.p4)(n).length;if(s===o?r-l<=0:r-l<0){if(R(t)||(0,C.Xu)(t)||E(t)||Z(t)||D(t)){const e=I.oG(t.parentNode,t);return{container:t.parentNode,offset:e}}if(t.nodeType===Node.TEXT_NODE){return{container:t,offset:a.tP((0,i.p4)(n),0,r).join("").length}}return N(t,r)}r-=l}return{container:e,offset:0}}function z(e){const{environment:t,textValue:n,parentStore:o,disableHover:i,disableStyleAnnotations:a,disableDateStyleAnnotations:s,disabled:l,emojiType:c,highlightDiscussionId:u,renderedPageBlockId:p,parentBlockId:m,theme:f,katex:b,disableLinks:_,formulaValueTypes:w,useExperimentalLinksToNonPageBlocks:k,stopLinkPropagation:I,linkTargetBlank:C}=e,{device:x,currentUser:M}=t,P=y.default.checkGate("enable_deleted_page_indicator");return d.IY({textValue:n,getRecordModel:o.getRecordModel,getRecordRole:o.getRecordRole,disableHover:i,disableStyleAnnotations:a,disableDateStyleAnnotations:s,disableLinks:_||!1,userTimeZone:(0,r.r)(),disabled:l,isAndroid:x.isAndroid,isSafariOrIOS:x.isSafari||x.isIOS,isWindows:x.isWindows,showEmojiInline:x.isWindows,emojiType:c,highlightDiscussionId:u,theme:f,intl:v.default.getIntl(),renderedPageBlockId:p,parentBlockId:m,katex:b,isClient:!0,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,currentUserId:M.id,overwriteBaseUrlFromSpaceId:(0,T.b)(t),externalIntegrations:S.Z.integrations.state,formulaValueTypes:w,enableDeletedPageIndicator:P,useExperimentalLinksToNonPageBlocks:k,stopLinkPropagation:I,linkTargetBlank:C,emojiData:h.Z.state})}const H=function(e,t){return(0,s.X)({textValue:e,getRecordModel:t.getRecordModel,userTimeZone:(0,r.r)(),intl:v.default.getIntl()})};function W(e){let t="";if(R(e))t+=c.qyI;else if((0,C.Xu)(e))t=c.fuX;else if(E(e))t+=e.alt;else if(function(e){return I.kK(e)&&"br"===e.tagName.toLowerCase()}(e))t+="\n";else if(I.Gs(e))t+=e.textContent;else if(D(e));else for(const n of Array.from(e.childNodes))t+=W(n);return t}const q=new RegExp(d.U3,"g");function G(e){return e.replace(q,"")}const K={[c.qyI]:{deleteEndToken:new RegExp(`${c.qyI}$`,"g"),deleteToken:new RegExp(`(${c.qyI})([^${d.U3}])`,"g"),existingToken:new RegExp(`${c.qyI}${d.U3}`,"g")},[c.fuX]:{deleteEndToken:new RegExp(`${c.fuX}$`,"g"),deleteToken:new RegExp(`(${c.fuX})([^${d.U3}])`,"g"),existingToken:new RegExp(`${c.fuX}${d.U3}`,"g")}};function $(e,t){if(!t)return"";let n=W(t);if(e.device.isAndroid)for(const[o,i]of Object.entries(K))n=n.replace(i.deleteEndToken,"").replace(i.deleteToken,"$2").replace(i.existingToken,o);return"\n"===n[n.length-1]&&(n=n.substring(0,n.length-1)),n}function Q(e,t,n){if(!e)return!1;let o=n,i=t;for(;i!==e&&!V(i);){const{parentNode:e}=i;if(!e)break;o=I.oG(e,i),i=e}if(V(i))return o>0;const r=a.cx(e.childNodes,V);return!(r<0)&&(i===e&&o>r)}function Y(e,t){const n=(0,k.X1)(e);if(!n)return;const o=O(e,t),i=B(e);return{index:o,forceEmit:Boolean(i),afterEndOfLine:Q(n,e,t)}}function J(e,t){if(t||(t=A.get()),t){const e=O(t.startContainer,t.startOffset),n=O(t.endContainer,t.endOffset),o=B(t.startContainer)||B(t.endContainer);return{selection:{startIndex:e,endIndex:n},forceEmitSelectionStore:Boolean(o)}}}function X(e,t,n){const o=N(e,t),i=N(e,n);return A.rangeFromContainerOffsets({start:o,end:i})}function ee(e,t,n,o){if(e===n&&t===o)return!0;if(L(e)!==L(n))return!1;if(F(e)!==F(n))return!1;const i=(0,k.X1)(e),r=(0,k.X1)(n);if(i!==r)return!1;if(O(e,t)!==O(n,o))return!1;return Q(i,e,t)===Q(r,n,o)}function te(e,t){return!e&&!t||!(!e||!t)&&(e.startOffset===t.startOffset&&e.endOffset===t.endOffset&&e.startContainer===t.startContainer&&e.endContainer===t.endContainer||j(e.startContainer)&&j(t.startContainer)&&ee(e.startContainer,e.startOffset,t.startContainer,t.startOffset)&&ee(e.endContainer,e.endOffset,t.endContainer,t.endOffset))}function ne(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,canEdit:a,disableEquationInteraction:s}=e,l=ae({event:n,textValue:o,editorNode:i});(t.device.isFirefox||"editing"!==w.default.state.mode||w.default.isEmptySelection()||l&&(0,C.Xu)(l.node))&&l&&(s&&(0,C.Xu)(l.node)||p.VO({environment:t,event:n,interactiveToken:l,store:r,canEdit:a}))}function oe(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,parentStore:a,canEdit:s}=e,l=ae({event:n,textValue:o,editorNode:i});l&&p.ON({environment:t,event:n,interactiveToken:l,store:r,parentStore:a,canEdit:s})}function ie(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,canEdit:a}=e,s=ae({event:n,textValue:o,editorNode:i});s&&p.Nh({environment:t,event:n,interactiveToken:s,store:r,canEdit:a})}function re(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,canEdit:a}=e;if(n.target===i)return void m.lY();const s=ae({event:n,textValue:o,editorNode:i});s&&p.Zl({environment:t,event:n,interactiveToken:s,store:r,canEdit:a})}function ae(e){const{event:t,textValue:n,editorNode:o}=e,i=I.sh(t.target,(e=>Boolean(e.getAttribute&&e.getAttribute("data-token-index"))));if(i&&null!=o&&o.contains(i)){const e=i.getAttribute("data-token-index");if(e){const t=parseInt(e,10);if(n){const e=n[t];if(e)return{textValue:n,tokenIndex:t,textToken:e,node:i}}}}}const se=e=>ce({store:e.store,temporaryAnnotation:c.GKr.TemporaryComment,multiSelection:f.Z.state.open&&"inline"===f.Z.state.type?f.Z.state.multiSelection:void 0}),le=e=>{const{store:t,find:n}=e;let o=t.getValue();if(!o)return;return c.Oqk({textValue:o,substring:n,ignoreCase:!0}).forEach(((e,t)=>{o=c.aSf({textValue:o,selection:e,annotation:[c.GKr.TemporaryFindHighlight]})})),o},ce=e=>{const{store:t,temporaryAnnotation:n,multiSelection:o}=e,i=t.getValue();if(o){const e=(0,x.L5)(o).find((e=>{let{store:n}=e;return n===t}));if(e){const{selection:t}=e;return c.aSf({textValue:i,selection:t,annotation:[n]})}}return i};function de(e){const{store:t,equationStore:n}=e;if(!n.isOpen())return;const o=(0,b.QY)(n.state.savedTextSelectionState.multiSelection);if(!o)return;const{store:i,selection:r}=o;if(t!==i)return;const a=i.getValue(),s=r.startIndex===r.endIndex?a:c._QS(a,r.startIndex,r.endIndex),l=C.qZ({equationState:n.state,isTemporary:!0});return l?c.P$X(s,[l],r.startIndex):void 0}function ue(e){const{store:t,selection:n}=e,o=t.getValue();if(n.startIndex+1!==n.endIndex)return o;const i=c.b1T(o,n.startIndex);if(!i||!c.eOb(i))return o;const r=n.startIndex===n.endIndex?o:c._QS(o,n.startIndex,n.endIndex),a=(0,u.uh)(i[1],c.rIb),s=[i[0],[...a,c.EPB()]];return c.P$X(r,[s],n.startIndex)}function pe(e){const{store:t,mentionMenuState:n}=e,o=t.getValue();if(n.textStore!==t)return o;const i=n.temporaryInputData.state;if(!i)return o;const r=(0,P.O2)(t,n.oldTextValue,i.prefix);if(r&&r.prefix){const{tokensBeforeRange:e,tokensInsideRange:t,tokensAfterRange:n}=c.xrQ(o,r.prefix.startIndex,r.filter.endIndex),a=c.QaF(t);return[...e,c.V3y(a,[c.mF$(i)]),...n]}return o}function me(e){const{store:t,selection:n}=e,o=t.getValue(),{tokensBeforeRange:i,tokensInsideRange:r,tokensAfterRange:a}=c.xrQ(o,n.startIndex,n.endIndex),s=c.QaF(r);return[...i,c.V3y(s,[[c.GKr.TemporarySelection]]),...a]}const fe=e=>{let{store:t,textValue:n}=e;if(!n)return n;if(t.table!==l.iU)return n;const o=_.G.createChildStore(t,{table:t.table,id:t.id});if(o.isInsideCollection()||o.isType("callout")||o.isType("code"))return n;let i=n;return(0,M.bB)((0,M.yJ)(o)).unresolved.forEach((e=>{const t=["m",e.id];i=c.aSf({textValue:i,annotation:t,selection:{startIndex:0,endIndex:1/0}})})),i};function ge(e){if(e.nodeType===Node.TEXT_NODE)return e;if(I.kK(e)&&"false"===e.getAttribute("contentEditable"))return e;let t;const n=I.kd(e);return n.forEach((e=>{null!==e.textContent&&e.textContent.indexOf("\n")>=0&&(t=e)})),t||(n.length>0?n[n.length-1]:e)}function he(e){const t=A.get();if(!t)return;const n=t.startContainer,o=(0,k.X1)(n),i=null==o?void 0:o.childNodes,r=!A.isExpanded(t);if(i&&(i.length>1||r)){const r=(0,k.g4)(n,o),g=a.cx(i,(e=>e===r));let h,v,b=!0,y=n,S=t.startOffset;if(0===S)for(let e=g-1;b&&e>=0;e--){const t=ge(i[e]);if(t.nodeType===Node.TEXT_NODE){var s;const e=null===(s=t.textContent)||void 0===s?void 0:s.lastIndexOf("\n");var l,c;if(void 0!==e&&e>=0)null!==(l=t.textContent)&&void 0!==l&&l.length&&e+1<(null===(c=t.textContent)||void 0===c?void 0:c.length)&&(y=t,S=e+1),b=!1;else y=t,S=0}else y=t,S=0}b=!0;for(let e=g;b&&e<i.length;e++){const t=ge(i[e]);if(t.nodeType===Node.TEXT_NODE){let e;var d,u,p,m;if(y===t)e=null===(d=t.textContent)||void 0===d?void 0:d.indexOf("\n",S);else e=null===(u=t.textContent)||void 0===u?void 0:u.indexOf("\n");if(void 0!==e&&e>=0)h=t,v=e+1===(null===(p=t.textContent)||void 0===p?void 0:p.length)?e:e+1,b=!1;else h=t,v=(null===(m=t.textContent)||void 0===m?void 0:m.length)||0}else{var f;h=t,v=(null===(f=t.textContent)||void 0===f?void 0:f.length)||0}}if(y&&h){const t=A.rangeFromContainerOffsets({start:{container:y,offset:S},end:{container:h,offset:v||0}});A.set(t,e)}}}function ve(e,t){const n=c.$0A(e.id,e.getSpaceId()),o=c.YCD(n);return{textValue:[o],tokenIndex:0,textToken:o,node:t}}},70764:(e,t,n)=>{n.d(t,{NP:()=>s,QS:()=>f,mO:()=>c,sw:()=>m,xt:()=>p});var o=n(20270),i=n(5366),r=(n(95477),n(77080)),a=n(30874);function s(e){const t=a.Z.state;return t.loaded?t.bots.filter((t=>t.integration_id===e)):[]}const l=(0,i.defineMessages)({invalidRequest:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidRequest",defaultMessage:"The authentication request is invalid. Please contact support if issue persists."},unauthorizedClient:{id:"unfurlingHelpers.unauthorizedClient.",defaultMessage:"The client is not authorized to request an authorization code using this method. Please contact support if issue persists."},accessDenied:{id:"unfurlingHelpers.authenticatedErrorDescription.accessDenied",defaultMessage:"The resource owner or authorization server denied the request. Check with your organization or resource owner to ensure OAuth installation is enabled."},unsupportedResponseType:{id:"unfurlingHelpers.authenticatedErrorDescription.unsupportedResponseType",defaultMessage:"The authorization server does not support obtaining an authorization code using this method. Please contact support if issue persists."},invalidScope:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidScope",defaultMessage:"The requested scope is invalid. Please contact support if issue persists."},serverError:{id:"unfurlingHelpers.authenticatedErrorDescription.serverError",defaultMessage:"The authorization server encountered an unexpected condition that prevented it from fulfilling the request. Please contact support if issue persists."},temporarilyUnavailable:{id:"unfurlingHelpers.authenticatedErrorDescription.temporarilyUnavailable",defaultMessage:"The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server. Please contact support if issue persists."},githubAppRequestAccessUnsupported:{id:"unfurlingHelpers.authenticatedErrorDescription.githubAppRequestAccessUnsupported",defaultMessage:"Request Access is not supported. You must be both a Github Admin and Notion Workspace Admin to connect the two apps."},unknownError:{id:"unfurlingHelpers.authenticatedErrorDescription.unknownError",defaultMessage:"The authorization server responded with an unknown error (`{value}`). Please contact support if issue persists."}});function c(e){return"invalid_request"===e?l.invalidRequest:"unauthorized_client"===e?l.unauthorizedClient:"access_denied"===e?l.accessDenied:"unsupported_response_type"===e?l.unsupportedResponseType:"invalid_scope"===e?l.invalidScope:"server_error"===e?l.serverError:"temporarily_unavailable"===e?l.temporarilyUnavailable:"github_app_request_access_unsupported"===e?l.githubAppRequestAccessUnsupported:l.unknownError}const d=(0,i.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseError.unknownError",defaultMessage:"Can't load preview"},accessDenied:{id:"unfurlingHelpers.unfurlResponseError.accessDenied",defaultMessage:"Access denied"},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseError.reAuthenticate",defaultMessage:"Re-authentication necessary"},notFound:{id:"unfurlingHelpers.unfurlResponseError.notFound",defaultMessage:"Content not found"},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseError.unprocessableEntity",defaultMessage:"Unrecognized URL"},rateLimited:{id:"unfurlingHelpers.unfurlResponseError.rateLimited",defaultMessage:"Too many requests"},serverError:{id:"unfurlingHelpers.unfurlResponseError.serverError",defaultMessage:"Can't load preview"},invalidRequest:{id:"unfurlingHelpers.unfurlResponseError.invalidRequest",defaultMessage:"Can't load preview"},authRefresh:{id:"unfurlingHelpers.unfurlResponseError.authRefresh",defaultMessage:"Fetching Preview"},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.githubNotAcceptable",defaultMessage:"Need owner role"},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.jiraNotAcceptable",defaultMessage:"Synced in another workspace"},notAcceptable:{id:"unfurlingHelpers.unfurlResponseError.notAcceptable",defaultMessage:"Not Acceptable"},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseError.databaseSyncLimit",defaultMessage:"Synced Database limit reached"}}),u=(0,i.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unknownError",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},accessDenied:{id:"unfurlingHelpers.unfurlResponseErrorDescription.accessDenied",defaultMessage:"You do not have appropriate permission to access this resource."},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseErrorDescription.reAuthenticate",defaultMessage:"You need to re-authenticate your account to access this resource."},notFound:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notFound",defaultMessage:"The resource information for this link could not be found. It may no longer exist or you may not have appropriate permission to access it."},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unprocessableEntity",defaultMessage:"This url is not currently embedable by this integration."},rateLimited:{id:"unfurlingHelpers.unfurlResponseErrorDescription.rateLimited",defaultMessage:'"{integrationName}" received too many requests for you or your organization. Please wait a few minutes and try again.'},serverError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.serverError",defaultMessage:'Oh no! Seems like there was a "{integrationName}" server error. Received error code "{statusCode}".'},invalidRequest:{id:"unfurlingHelpers.unfurlResponseErrorDescription.invalidRequest",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},authRefresh:{id:"unfurlingHelpers.unfurlResponseErrorDescription.authRefresh",defaultMessage:"Fetching Preview via Login Update, please wait."},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.githubNotAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.jiraNotAcceptable",defaultMessage:"You have synced this resource in another workspace."},notAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseErrorDescription.databaseSyncLimit",defaultMessage:"Your workspace has hit the Synced Database limit."}});function p(e,t){return void 0===e?{message:d.unknownError,description:u.unknownError}:401===e?{message:d.reAuthenticate,description:u.reAuthenticate}:439===e?{message:d.authRefresh,description:u.authRefresh}:403===e?{message:d.accessDenied,description:u.accessDenied}:404===e?{message:d.notFound,description:u.notFound}:422===e?{message:d.unprocessableEntity,description:u.unprocessableEntity}:429===e?{message:d.rateLimited,description:u.rateLimited}:406===e?"jira"===t?{message:d.jiraNotAcceptable,description:u.jiraNotAcceptable}:"github"===t?{message:d.githubNotAcceptable,description:u.githubNotAcceptable}:{message:d.notAcceptable,description:u.notAcceptable}:417===e?{message:d.databaseSyncLimit,description:u.databaseSyncLimit}:(0,o.Ms)(e)?{message:d.serverError,description:u.serverError}:{message:d.invalidRequest,description:u.invalidRequest}}function m(e){return!e.device.isMobileBrowser}function f(){return"on"===r.default.getGroup("beta-developers-external")}},15010:(e,t,n)=>{n.d(t,{JF:()=>a,QZ:()=>r,WD:()=>l,e2:()=>s});n(45433);var o=n(44317),i=n(80444);n(93959);function r(){const{currentUserSettingsStore:e,currentSpaceStore:t}=i.default.state,n=(null==e?void 0:e.getSettings())||{},o=null==t?void 0:t.getPlanType();return"professional"===n.domain_type&&"team"===o}function a(){const{currentUserSettingsStore:e}=i.default.state;return((null==e?void 0:e.getSettings())||{}).domain_type}function s(e){const t=e.getSettings(),n=null==t?void 0:t.signup_time;return n?(0,o.O5)(n):null}function l(e){const{currentUserSettingsStore:t}=i.default.state;if(t&&t.id===e.currentUser.id)return t}},56518:(e,t,n)=>{n.d(t,{Ef:()=>w,Gp:()=>h,IU:()=>m,Li:()=>f,X4:()=>b,ZI:()=>S,ax:()=>_,nZ:()=>v,tt:()=>g,xF:()=>p});var o=n(15145),i=n(1800),r=n(42875),a=n(25718),s=n(74446),l=n(21202),c=n(97880),d=n(95477),u=n(33929);const p="paste";function m(e){let t,n;const o=new Set,i=new Set;for(const r of e){const e=r.getParentBlockStore();if(e&&"column"===e.getType()){o.add(e.id),i.add(r.id);const a=e.getParentBlockStore();if(a&&"column_list"===a.getType()){n=a.getSpaceId();const e=a.id;if(void 0===t&&(t=e),t!==e)return}}}if(t&&o.size>1&&n)return{columnListId:t,columnIds:o,blockIds:i,spaceId:n}}function f(e,t){if(!e.clipboardData)return;const n=e.clipboardData.getData("text/html");e.clipboardData.setData("text/html",`${n}${h(t)}`)}function g(e){if(!e.clipboardData)return;return v(e.clipboardData.getData("text/html"))}function h(e){return`\x3c!-- notionvc: ${e} --\x3e`}function v(e){const t=e.match(/\<\!-- notionvc\: ([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}) --\>$/i);return t?t[1]:void 0}function b(e){const{blockValues:t,rootBlock:n,getRecordValue:o,isWindows:i,markdownSerializationOptions:r,markdownLinkifyIt:s}=e;let l=a.on(t,{..._({rootBlock:n,getRecordValue:o}),transformAnnotation:null==r?void 0:r.transformAnnotation,transformBlockMapping:null==r?void 0:r.transformBlockMapping});const c={markdown:void 0,html:void 0};if(l){l=l.replaceAll(y,"$1"),c.markdown=S(i,l);const e=s&&a.c8({...s,markdown:l});e&&(c.html=S(i,e))}return c}const y=/\[(https?:\/\/[^\])]+)\]\(\1\)/g;function S(e,t){return e?t.split("\r\n").reduce(((e,t)=>[...e,...t.split("\n")]),[]).join("\r\n"):t}function _(e){const{rootBlock:t,getRecordValue:n}=e;return{root:t,navigableBlockId:t.id,renderParentBlockId:void 0,blockId:t.id,userTimeZone:(0,r.r)(),intl:u.default.getIntl(),getRecordValue:n,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,i.Z)({pageId:t,pageValue:n({table:l.iU,id:t}),baseUrl:d.default.domainBaseUrl,pageVisitSource:o.tY.Export})},baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName}}function w(e){const{rootBlock:t,clipboardData:n,isWindows:o,fallbackGetRecordValue:i,markdownSerializationOptions:r,markdownLinkifyIt:a}=e,{tree:l,blockSelection:d}=n,u=s.mF.tryUntilFound(...d.blocks.map((e=>e.blockSubtree&&s.mF.fromRecordMap(e.blockSubtree))).filter(c.$K),i),p=l.value,m=d.blocks.map((e=>u({...p,id:e.blockId}))).filter(c.$K);return b({rootBlock:t,getRecordValue:u,blockValues:m,isWindows:o,markdownSerializationOptions:r,markdownLinkifyIt:a})}},75079:(e,t,n)=>{n.d(t,{Pn:()=>a,Pp:()=>p,Y5:()=>d,ZO:()=>l,vS:()=>s,yr:()=>u});var o=n(43690),i=n(58421),r=n(28209);function a(e){const t=null==e?void 0:e.collectionViewBlockStore(),n=null==e?void 0:e.collectionStore(),o=null==e?void 0:e.collectionViewStore(),a=null==e?void 0:e.filtersBarOpenStore.state,s=null==o?void 0:o.getType(),l=(null==e?void 0:e.settingsStore)&&(0,i.n)(null==e?void 0:e.settingsStore),c=null==t?void 0:t.id,d=r.Z.state.userHomePageId;return{view_type:s,settings_menu:null!=e&&e.settingsStore.state.open&&l?l.type:void 0,collection_id:null==n?void 0:n.id,collection_view_id:null==o?void 0:o.id,collection_view_block_id:c,filters_bar_open:a,is_in_my_tasks:d===c,is_in_wiki:null==t?void 0:t.isCollectionViewPageWithContent()}}function s(e,t){var n,o,i,r,a;if(!e)return{view_type:"missing_context_store",row_count_category:"missing_context_store",column_count_category:"missing_context_store",has_relation_column:"missing_context_store",has_rollup_column:"missing_context_store",has_formula_column:"missing_context_store",is_client_mode_enabled:"missing_context_store",tracking_source:void 0,collection_view_id:"missing_context_store",collection_id:"missing_context_store",collection_type:"missing_context_store"};const s=e.isClientModeEnabled.state,d=(null===(n=e.collectionViewBlockStore())||void 0===n?void 0:n.id)||"missing",u=(null===(o=e.collectionStore())||void 0===o?void 0:o.id)||"missing",p=null===(i=e.collectionViewStore())||void 0===i?void 0:i.getCollectionSource(),m=null===(r=e.collectionStore())||void 0===r?void 0:r.getSchema();if(!m)return{view_type:"missing_schema",row_count_category:"missing_schema",column_count_category:"missing_schema",has_relation_column:"missing_schema",has_rollup_column:"missing_schema",has_formula_column:"missing_schema",is_client_mode_enabled:s,tracking_source:t,collection_view_id:d,collection_id:u,collection_type:(null==p?void 0:p.type)||"missing"};const{has_relation_column:f,has_rollup_column:g,has_formula_column:h}=function(e){const t="missing_schema";if(void 0===e)return{has_relation_column:t,has_rollup_column:t,has_formula_column:t};let n=!1,o=!1,i=!1;for(const r of Object.values(e))if("relation"===(null==r?void 0:r.type)&&(n=!0),"rollup"===(null==r?void 0:r.type)&&(o=!0),"formula"===(null==r?void 0:r.type)&&(i=!0),n&&o&&i)break;return{has_relation_column:n,has_rollup_column:o,has_formula_column:i}}(m);return{view_type:e.getViewType()||"unknown",row_count_category:l(null===(a=e.remoteResult.state)||void 0===a?void 0:a.sizeHint),column_count_category:c(m),has_relation_column:f,has_rollup_column:g,has_formula_column:h,is_client_mode_enabled:s,tracking_source:t,collection_view_id:d,collection_id:u,collection_type:(null==p?void 0:p.type)||"missing"}}function l(e){return void 0===e?"unknown":e<=100?"0-100":e<=200?"100-200":e<=300?"200-300":e<=400?"300-400":e<=500?"400-500":e<=600?"500-600":e<=700?"600-700":e<=800?"700-800":e<=900?"800-900":e<=1e3?"900-1000":"1001_or_more"}function c(e){const t=Object.keys(e).length;return t<=10?"0-10":t<=20?"10-20":t<=50?"20-50":"51_or_more"}function d(e){const{from:t,collectionContextStore:n,sizeHintAtStart:o}=e,i=s(n),{row_count_category:r,...a}=i;return{...a,from:t,property_type:"property_type"in e?e.property_type:void 0,did_trigger_fetch:n?n.isLoading.state:"missing_context_store",row_count_category:l(o)}}function u(e){const{collectionContextStore:t,is_native_drop:n,is_empty:o}=e;return{...s(t),is_native_drop:n,is_empty:o}}function p(e){const{collectionContextStore:t,visibleItemsCount:n}=e,i=s(t),r=t.remoteResult.state?o.aW({result:t.remoteResult.state}).length:0,a=0===r?void 0:n/r;return{...i,percentage_of_remote_result_visible:void 0===a?"empty_remote_result":0===a?"0":a<=.25?"0-25":a<=.5?"25-50":a<=.75?"50-75":a<1?"75-100":1===a?"100":"greater_than_100"}}},17335:(e,t,n)=>{n.d(t,{$7:()=>S,D0:()=>k,Fc:()=>_,HL:()=>x,IF:()=>A,KV:()=>K,Qz:()=>$,SW:()=>Y,Sb:()=>w,Sj:()=>y,WC:()=>v,_T:()=>R,cq:()=>E,ip:()=>T,li:()=>W,qh:()=>z,rn:()=>m,x:()=>C,xe:()=>J,zZ:()=>g});var o=n(2032),i=n(76205),r=n(34299),a=n(78106),s=n(72126),l=n(97880),c=n(4308),d=n(5366),u=n(33929);const p={text:{operator:"string_contains",value:{type:"exact",value:void 0}},relation:{operator:"relation_contains",value:{type:"exact",value:void 0}},url:{operator:"string_contains",value:{type:"exact",value:void 0}},checkbox:{operator:"checkbox_is",value:{type:"exact",value:void 0}},created_by:{operator:"person_contains",value:{type:"exact",value:void 0}},last_edited_by:{operator:"person_contains",value:{type:"exact",value:void 0}},select:{operator:"enum_is",value:{type:"exact",value:void 0}},multi_select:{operator:"enum_contains",value:{type:"exact",value:void 0}},status:{operator:"status_is",value:{type:"is_group",value:void 0}},person:{operator:"person_contains",value:{type:"exact",value:void 0}},number:{operator:"number_equals",value:{type:"exact",value:void 0}},auto_increment_id:{operator:"number_equals",value:{type:"exact",value:void 0}},date:{operator:"date_is_relative_to",value:{type:"relative",value:"surrounding",unit:"week"}},created_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_edited_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_visited_time:{operator:"date_is",value:{type:"exact",value:void 0}},email:{operator:"string_contains",value:{type:"exact",value:void 0}},phone_number:{operator:"string_contains",value:{type:"exact",value:void 0}},title:{operator:"string_contains",value:{type:"exact",value:void 0}},file:{operator:"is_empty"},location:{operator:"location_is",value:{type:"exact",value:void 0}},verification:{operator:"verification_is",value:{type:"exact",value:void 0}}};function m(e){return p[e]}function f(e){return"v2"===e.version?function(e){if(!e.formula2)return{operator:"is_empty"};const t=e.formula2.result_type;if("array"===t.type){const e=(0,a.B8)(t.of);return"array"===e.type||"function"===e.type?{operator:"is_empty"}:"block"===e.type||"unknown"===e.type?{operator:"any",subfilter:m("text")}:{operator:"any",subfilter:m(e.type)}}if("unknown"===t.type||"block"===t.type)return m("text");return m(t.type)}(e):function(e){return e.formula&&e.formula.result_type?m(e.formula.result_type):{operator:"is_empty"}}(e)}function g(e){const{property:t,schema:n}=e,a=n[t];if(!a||"button"===a.type)return{operator:"is_empty"};if("formula"===a.type)return f(a);if("rollup"===a.type){if(a.aggregation&&"show_unique"!==a.aggregation){return m((0,o.W6)((0,o.gu)(a.aggregation)))}{const t=(0,r.gT)(e);if(!t){return{operator:"any",subfilter:{operator:"is_empty"}}}if("rollup"===t.targetPropertySchema.type){return{operator:"any",subfilter:{operator:"is_empty"}}}if("formula"===t.targetPropertySchema.type){const e=f(t.targetPropertySchema);if((0,i.a_)(e))return e;return{operator:"any",subfilter:e}}if("button"===t.targetPropertySchema.type)return{operator:"is_empty"};return{operator:"any",subfilter:m(t.targetPropertySchema.type)}}}return m(a.type)}const h=(0,d.defineMessages)({date_is_within:{defaultMessage:"Is between",id:"collectionFilterMenuHelpers.operator.dateIsWithin"},date_is_relative_to:{defaultMessage:"Is relative to today",id:"collectionFilterMenuHelpers.operator.dateIsRelativeTo"},is_empty:{defaultMessage:"Is empty",id:"collectionFilterMenuHelpers.operator.isEmpty"},is_not_empty:{defaultMessage:"Is not empty",id:"collectionFilterMenuHelpers.operator.isNotEmpty"},string_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.stringIs"},string_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.stringIsNot"},string_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.stringContains"},string_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.stringDoesNotContain"},string_starts_with:{defaultMessage:"Starts with",id:"collectionFilterMenuHelpers.operator.stringStartsWith"},string_ends_with:{defaultMessage:"Ends with",id:"collectionFilterMenuHelpers.operator.stringEndsWith"},checkbox_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.checkboxIs"},checkbox_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.checkboxIsNot"},enum_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.enumIs"},enum_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.enumIsNot"},enum_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.enumContains"},enum_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.enumDoesNotContain"},status_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.statusIs"},status_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.statusIsNot"},person_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.personContains"},person_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.personDoesNotContain"},relation_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.relationContains"},relation_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.relationDoesNotContain"},location_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.locationIs"},location_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.locationIsNot"},number_equals:{defaultMessage:"=",id:"collectionFilterMenuHelpers.operator.numberEquals"},number_does_not_equal:{defaultMessage:"≠",id:"collectionFilterMenuHelpers.operator.numberDoesNotEqual"},number_greater_than:{defaultMessage:">",id:"collectionFilterMenuHelpers.operator.numberGreaterThan"},number_less_than:{defaultMessage:"<",id:"collectionFilterMenuHelpers.operator.numberLessThan"},number_greater_than_or_equal_to:{defaultMessage:"≥",id:"collectionFilterMenuHelpers.operator.numberGreaterThanOrEqualTo"},number_less_than_or_equal_to:{defaultMessage:"≤",id:"collectionFilterMenuHelpers.operator.numberLessThanOrEqualTo"},date_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.dateIs"},date_is_before:{defaultMessage:"Is before",id:"collectionFilterMenuHelpers.operator.dateIsBefore"},date_is_after:{defaultMessage:"Is after",id:"collectionFilterMenuHelpers.operator.dateIsAfter"},date_is_on_or_before:{defaultMessage:"Is on or before",id:"collectionFilterMenuHelpers.operator.dateIsOnOrBefore"},date_is_on_or_after:{defaultMessage:"Is on or after",id:"collectionFilterMenuHelpers.operator.dateIsOnOrAfter"},any:{defaultMessage:"Any",id:"collectionFilterMenuHelpers.operator.any"},none:{defaultMessage:"None",id:"collectionFilterMenuHelpers.operator.none"},every:{defaultMessage:"Every",id:"collectionFilterMenuHelpers.operator.every"},string_has_no_alphabet_prefix:{defaultMessage:"(Not used)",id:"collectionFilterMenuHelpers.operator.stringHasNoAlphabetPrefix"},verification_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.verificationStateIs"},verification_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.verificationStateIsNot"}});function v(e){return u.default.formatMessage(h[e])}const b=(0,d.defineMessages)({today:{defaultMessage:"Today",id:"collectionFilterMenuHelpers.relativeDates.today"},tomorrow:{defaultMessage:"Tomorrow",id:"collectionFilterMenuHelpers.relativeDates.tomorrow"},yesterday:{defaultMessage:"Yesterday",id:"collectionFilterMenuHelpers.relativeDates.yesterday"},one_week_ago:{defaultMessage:"One week ago",id:"collectionFilterMenuHelpers.relativeDates.oneWeekAgo"},one_week_from_now:{defaultMessage:"One week from now",id:"collectionFilterMenuHelpers.relativeDates.oneWeekFromNow"},one_month_ago:{defaultMessage:"One month ago",id:"collectionFilterMenuHelpers.relativeDates.oneMonthAgo"},one_month_from_now:{defaultMessage:"One month from now",id:"collectionFilterMenuHelpers.relativeDates.oneMonthFromNow"}}),y=(0,d.defineMessages)({past:{defaultMessage:"Past",id:"collectionFilterMenuHelpers.relativeDates.past"},future:{defaultMessage:"Next",id:"collectionFilterMenuHelpers.relativeDates.next"}}),S=(0,d.defineMessages)({direction:{defaultMessage:"Direction",id:"collectionFilterMenuHelpers.relativeDates.direction"},unit:{defaultMessage:"Unit",id:"collectionFilterMenuHelpers.relativeDates.unit"}}),_=(0,d.defineMessages)({this:{defaultMessage:"This",id:"collectionFilterMenuHelpers.relativedates.this"}}),w=(0,d.defineMessages)({day:{defaultMessage:"day",id:"collectionFilterMenuHelpers.relativeDates.day"},week:{defaultMessage:"week",id:"collectionFilterMenuHelpers.relativeDates.week"},month:{defaultMessage:"month",id:"collectionFilterMenuHelpers.relativeDates.month"},year:{defaultMessage:"year",id:"collectionFilterMenuHelpers.relativeDates.year"}}),k=(0,d.defineMessages)({day:{defaultMessage:"days",id:"collectionFilterMenuHelpers.relativeDates.days"},week:{defaultMessage:"weeks",id:"collectionFilterMenuHelpers.relativeDates.weeks"},month:{defaultMessage:"months",id:"collectionFilterMenuHelpers.relativeDates.months"},year:{defaultMessage:"years",id:"collectionFilterMenuHelpers.relativeDates.years"}}),I=(0,d.defineMessages)({exactDate:{defaultMessage:"Custom date",id:"collectionFilterMenuHelpers.relativeDates.exactDate"},exactDateRange:{defaultMessage:"Exact dates",id:"collectionFilterMenuHelpers.relativeDates.exactDateRange"}});function C(e){return"exact"===e.type?u.default.formatMessage(I.exactDate):u.default.formatMessage(b[e.value])}const x=(0,d.defineMessages)({custom:{defaultMessage:"Relative range",id:"collectionFilterMenuHelpers.relativeDates.range"},surrounding:{defaultMessage:"Surrounding range",id:"collectionFilterMenuHelpers.relativeDates.customRange"},this_week:{defaultMessage:"This week",id:"collectionFilterMenuHelpers.relativeDates.thisWeek"},the_past_week:{defaultMessage:"The past week",id:"collectionFilterMenuHelpers.relativeDates.thePastWeek"},the_past_month:{defaultMessage:"The past month",id:"collectionFilterMenuHelpers.relativeDates.thePastMonth"},the_past_year:{defaultMessage:"The past year",id:"collectionFilterMenuHelpers.relativeDates.thePastYear"},the_next_week:{defaultMessage:"The next week",id:"collectionFilterMenuHelpers.relativeDates.theNextWeek"},the_next_month:{defaultMessage:"The next month",id:"collectionFilterMenuHelpers.relativeDates.theNextMonth"},the_next_year:{defaultMessage:"The next year",id:"collectionFilterMenuHelpers.relativeDates.theNextYear"}});function T(e){return"custom"===e.value?function(e){const t=u.default.formatMessage(y[e.direction]),n=1===e.count?u.default.formatMessage(w[e.unit]):u.default.formatMessage(k[e.unit]);return 1===e.count?`${t} ${n}`:`${t} ${e.count} ${n}`}(e):"surrounding"===e.value?function(e){const t=u.default.formatMessage(w[e.unit]);return`${u.default.formatMessage(_.this)} ${t}`}(e):"exact"===e.type?u.default.formatMessage(I.exactDateRange):"relative"===e.type?u.default.formatMessage(x[e.value]):void(0,l.t1)(e)}const M=(0,d.defineMessages)({start_date:{defaultMessage:"Start date",id:"collectionFilterMenuHelpers.dateFilterModes.start_date"},end_date:{defaultMessage:"End date",id:"collectionFilterMenuHelpers.dateFilterModes.end_date"}}),P=(0,d.defineMessages)({start_date:{defaultMessage:"For date ranges, filters on the start date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.start_date"},end_date:{defaultMessage:"For date ranges, filters on the end date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.end_date"}});function A(e){return u.default.formatMessage(M[e])}function R(e){return u.default.formatMessage(P[e])}const D=(0,d.defineMessages)({and:{defaultMessage:"And",id:"collectionFilterMenuHelpers.combinatorOperators.and"},or:{defaultMessage:"Or",id:"collectionFilterMenuHelpers.combinatorOperators.or"}}),B=(0,d.defineMessages)({checked:{defaultMessage:"Checked",id:"collectionFilterMenuHelpers.checkbox.checked"},unchecked:{defaultMessage:"Unchecked",id:"collectionFilterMenuHelpers.checkbox.unchecked"}});function E(e){return e.value?u.default.formatMessage(c.A3(e.value)):""}const F=e=>{let{filter:t,schema:n}=e;return N({filter:t.subfilter,schema:n})},Z=e=>{let{filter:t}=e;return C(t.value)},L=e=>{let{filter:t}=e;return T(t.value)},j=e=>{let{filter:t}=e;return`"${t.value.value||""}"`},V=e=>{let{filter:t}=e;return void 0===t.value.value?void 0:t.value.value.toString()},U=e=>{let{filter:t}=e;return function(e){const t=e.value?B.checked:B.unchecked;return u.default.formatMessage(t)}(t.value)},O={is_empty:()=>{},is_not_empty:()=>{},string_is:j,string_is_not:j,string_contains:j,string_does_not_contain:j,string_starts_with:j,string_ends_with:j,checkbox_is:U,checkbox_is_not:U,enum_is:j,enum_is_not:j,enum_contains:j,enum_does_not_contain:j,status_is:j,status_is_not:j,relation_contains:()=>{},relation_does_not_contain:()=>{},person_contains:()=>{},person_does_not_contain:()=>{},location_is:()=>{},location_is_not:()=>{},number_equals:V,number_does_not_equal:V,number_greater_than:V,number_less_than:V,number_greater_than_or_equal_to:V,number_less_than_or_equal_to:V,date_is:Z,date_is_before:Z,date_is_after:Z,date_is_on_or_before:Z,date_is_on_or_after:Z,date_is_within:L,date_is_relative_to:L,any:F,none:F,every:F,string_has_no_alphabet_prefix:()=>{},verification_is:j,verification_is_not:j};function N(e){const{filter:t}=e,n=v(t.operator),o=O[t.operator](e);return s.oA([n,o]).join(" ")}function z(e){const{filter:t,schema:n}=e;if((0,i.vA)(t)){const e=t.filters||[],o=s.oA(e.map((e=>{const t=z({filter:e,schema:n});if(t)return(0,i.vA)(e)?`(${t})`:t}))),r=u.default.formatMessage(D[t.operator]);return o.join(` ${r} `)}if((0,i.aN)(t)){const e=n[t.property];if(!e)return;const o=t.filter,i=e.name,r=N({filter:o,schema:n});return s.oA([i,r]).join(" ")}}const H={text:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:"string_has_no_alphabet_prefix"===e.operator?{operator:t}:{operator:t,value:e.value}},number:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},checkbox:function(e,t){return{operator:t,value:e.value}},select:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},multi_select:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},status:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"is_option",value:void 0}}:{operator:t,value:e.value}},relation:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},person:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},date:function(e,t,n){if((0,i._N)(t))return{operator:t};const o=(0,i.mv)(e)?void 0:e.use_end;return"date_is_within"===t?"date_is_within"!==e.operator?{operator:t,value:{type:"exact",value:void 0},use_end:o}:e:"date_is_relative_to"===t?"date_is_relative_to"!==e.operator?{operator:t,value:{type:"relative",value:"surrounding",unit:"week"},use_end:o}:e:(0,i.TQ)(e)?"combinator"===n?{operator:t,value:{type:"relative",value:"today"},use_end:o}:{operator:t,value:{type:"exact",value:void 0},use_end:o}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value,use_end:o}},file:function(e,t){return{operator:t}},location:function(e,t){return{operator:t,value:e.value}},verification:function(e,t){return{operator:t,value:e.value}}};function W(e,t,n,o){return(0,H[e])(t,n,o)}const q=(0,d.defineMessages)({and:{defaultMessage:"And",id:"database.filterOperators.and"},or:{defaultMessage:"Or",id:"database.filterOperators.or"}}),G=(0,d.defineMessages)({and:{defaultMessage:"All filters must match",id:"database.filterOperators.andCaption"},or:{defaultMessage:"At least one filter must match",id:"database.filterOperators.orCaption"}});function K(e,t){return"and"===e?t.formatMessage(q.and):t.formatMessage(q.or)}function $(e,t){return"and"===e?t.formatMessage(G.and):t.formatMessage(G.or)}const Q=(0,d.defineMessages)({any:{defaultMessage:"Any",id:"database.filterOperators.any"},every:{defaultMessage:"Every",id:"database.filterOperators.every"},none:{defaultMessage:"None",id:"database.filterOperators.none"}});function Y(e,t){return"any"===e?t.formatMessage(Q.any):"every"===e?t.formatMessage(Q.every):t.formatMessage(Q.none)}const J=(0,d.defineMessages)({number:{id:"collectionFilterMenuFilter.filterOperators.number.order",defaultMessage:"{operator}{operatorValue}"},text:{id:"collectionFilterMenuFilter.filterOperators.text.order",defaultMessage:"{operator}{operatorValue}"},checkbox:{id:"collectionFilterMenuFilter.filterOperators.checkbox.order",defaultMessage:"{operator}{operatorValue}"},select:{id:"collectionFilterMenuFilter.filterOperators.select.order",defaultMessage:"{operator}{operatorValue}"},multi_select:{id:"collectionFilterMenuFilter.filterOperators.multi_select.order",defaultMessage:"{operator}{operatorValue}"},status:{id:"collectionFilterMenuFilter.filterOperators.status.order",defaultMessage:"{operator}{operatorValue}"},relation:{id:"collectionFilterMenuFilter.filterOperators.relation.order",defaultMessage:"{operator}{operatorValue}"},location:{id:"collectionFilterMenuFilter.filterOperators.location.order",defaultMessage:"{operator}{operatorValue}"},person:{id:"collectionFilterMenuFilter.filterOperators.person.order",defaultMessage:"{operator}{operatorValue}"},date:{id:"collectionFilterMenuFilter.filterOperators.date.order",defaultMessage:"{operator}{operatorValue}"},file:{id:"collectionFilterMenuFilter.filterOperators.file.order",defaultMessage:"{operator}{operatorValue}"},verification:{id:"collectionFilterMenuFilter.filterOperators.verification.order",defaultMessage:"{operator}{operatorValue}"}})},81849:(e,t,n)=>{n.d(t,{_1:()=>C,II:()=>I,h6:()=>k,ej:()=>v,Cz:()=>_,kW:()=>g,XD:()=>f,ew:()=>h,nr:()=>b,ar:()=>y,qW:()=>S});n(57658);var o=n(35011),i=n(14714),r=n(99036),a=n(8848),s=n(45433),l=n(86678),c=n(72126),d=n(97058);var u=n(97880),p=n(26991),m=n(29376);const f=10,g=10,h=50;function v(e){const{groupBy:t,schema:n,format:o,filter:r,groupsFormatKey:a,limit:s}=e,l=n[t.property];if(!l||!(0,i.LG)(l))return;const c=o[a]||[],d=c.reduce(((e,t)=>(0,i.eF)(t)?e+1:e),0);return{type:"groups",groupBy:t,filter:r,groupSortPreference:c.map((e=>e.value)),limit:s+d}}function b(e,t,n){const o=e.filter((e=>!(0,i.ZH)(e,t))),r=o.filter((e=>!(0,i.eF)(e))),a=o.filter((e=>(0,i.eF)(e)));return[...r.slice(0,n-1),t,...r.slice(n-1),...a]}function y(e,t){const n=e.filter((e=>!(0,i.ZH)(e,t))),o=n.filter((e=>!(0,i.eF)(e))),r=n.filter((e=>(0,i.eF)(e)));return[...o,t,...r]}function S(e){return!e.device.isPhone&&(e.isFullScreen||e.isRootChild)}function _(e){const{schema:t,groupBy:n,schemaGroups:r,reducerResults:a,relativeVariableResult:l,getRecordModel:u,viewAppConfigUri:p}=e;if(!n)return[];const m=t[n.property];if(!m||!(0,i.LG)(m))return[];const f=[...e.formatGroups,...r&&!a?r.map((e=>({property:n.property,value:e}))):[]];let g;if("manual"===(0,i.mu)(n).type){if(g=f,a)for(const{value:e}of a){const t={property:n.property,value:e};g.push(t)}p===s.sV&&(g=function(e,t){const n=(0,d.ft)(t);return c.MR(e,[e=>{const t=n[(0,i.Hd)(e.value)];return void 0!==t?t:1/0},e=>(0,i.Hd)(e.value)])}(g,e.formatGroups.map((e=>e.value))))}else{const e=new Map;for(const t of f)e.set((0,i.mD)(t),t);g=a?a.map((t=>{let{value:o}=t;return e.get((0,i.Hd)(o))||{property:n.property,value:o}})):[];for(const t of f)g.push(t)}if(a){if(n.hideEmptyGroups){const e=new Set,t=new Set;for(const n of a){const o=(0,i.Hd)(n.value);0===n.total?t.add(o):e.add(o)}g=g.map((n=>{const o=(0,i.mD)(n);if(t.has(o))return{...n,emptyHidden:!0};if(e.has(o)){const e={...n};return delete e.emptyHidden,e}return n}))}else g=g.map((e=>{if(e.emptyHidden){const t={...e};return delete t.emptyHidden,t}return e}));g=p===s.sV&&n.property===s.Es.TaskToSprintRelation?g.map((e=>"relation"===e.value.type&&(0,i.t2)(e.value.value)||void 0===e.value||void 0===e.value.value?e:{...e,hiddenByDefault:!0})):g.map((e=>{if(e.hiddenByDefault){const t={...e};return delete t.hiddenByDefault,t}return e}))}const h=g.filter((e=>{if(e.property!==n.property)return!1;const t=e.value;if(t.type!==m.type)return!1;if(void 0===t.value)return!0;if("formula"===m.type){const t=(0,o.mm)(m);if(!m.formula&&!m.formula2||"unknown"===t)return!1;if("formula"!==e.value.type||"formula"!==n.type)return!1;const r=e.value.value;if(!r)return!0;if("block"===t&&"text"===r.type)return!0;if(r.type!==t)return!1;const a=n.groupBy;return"relation"===a.type?function(e,t,n){if(!e||!e.value)return!0;if("relation"!==t.type||"relation"!==e.type)return!1;if((0,i.t2)(e.value))return!1;const o=n(e.value);return null==o?void 0:o.alive}(r,{...a,property:n.property},u):w({groupValue:r,groupBy:{property:n.property,...a},getRecordModel:u,relativeVariableResult:l})}return w({groupValue:t,groupBy:n,getRecordModel:u,relativeVariableResult:l,propertySchema:m})}));return c.mN(h,(e=>(0,i.mD)(e)))}function w(e){const{groupValue:t,groupBy:n,getRecordModel:o,relativeVariableResult:r,propertySchema:a}=e;if(!t.value)return!0;const s=n.type;if("formula"===s)return!1;if("select"===s){if("select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("multi_select"===s){if("multi_select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("status"===s){if("status"!==(null==a?void 0:a.type))return!1;const e=a.options??[],o=a.groups??[];if("status"!==t.type)return!1;const{value:i}=t;return"by_group"===i.type?("status"!==s||"group"===n.groupBy)&&o.some((e=>e.name===i.group)):"by_option"===i.type&&(("status"!==s||"option"===n.groupBy)&&e.some((e=>e.value===i.option)))}return(0,i.A1)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,i.ib)(t)||!(0,i.Mc)(e)||!t.groupBy)return!1;const n=e.value.type;if("relative"===t.groupBy)return"today"===n||"yesterday"===n||"last_7_days"===n||"last_30_days"===n||"tomorrow"===n||"next_7_days"===n||"next_30_days"===n||"month"===n;if("day"===t.groupBy)return"day"===n;if("week"===t.groupBy)return"week"===n;if("month"===t.groupBy)return"month"===n;if("year"===t.groupBy)return"year"===n;(0,u.t1)(t.groupBy)}(t,n):(0,i.HB)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,i.aB)(t)||!(0,i.R7)(e)||!t.groupBy)return!1;const n=e.value.type;if("alphabet_prefix"===t.groupBy)return"alphabet_prefix"===n||"other"===n;if("exact"===t.groupBy)return"exact"===n;(0,u.t1)(t.groupBy)}(t,n):"number"===s?function(e,t){if(!e||!e.value)return!0;if("number"!==t.type||"number"!==e.type)return!1;const n=e.value;if("out_of_range"===n.type)return n.start===t.start&&n.end===t.end;if("range"===n.type){const e=(0,i.n6)(n.start,t.start,t.end,t.size);return e&&"range"===e.type&&e.start===n.start}(0,u.t1)(n)}(t,n):"relation"===s?"relation"===(null==a?void 0:a.type)&&function(e,t,n,o,r){var a;if(!t||!t.value)return!0;if("relation"!==n.type||"relation"!==t.type)return!1;if((0,i.t2)(t.value)){var s,c;const n=e.collection_pointer&&o(e.collection_pointer);if(!r||!n)return!1;const i=null==n||null===(s=n.getFormat())||void 0===s?void 0:s.app_config_uri,a=null===(c=r[n.id])||void 0===c?void 0:c[t.value.value.variable],l=null==n?void 0:n.getSchema();return(0,p.Sh)(l,i)&&a}const d=o(t.value);if(!d)return!1;const u=(0,l.ky)({block:d,getRecordModel:o});if(r&&u){if((0,i.qQ)({relativeVariableValues:r[null==u?void 0:u.id],pointer:d.pointer}).length>0)return!1}return Boolean(d.alive&&((null==u?void 0:u.id)===e.collection_id||(null==u?void 0:u.id)===(null===(a=e.collection_pointer)||void 0===a?void 0:a.id)))}(a,t,n,o,r):"location"===s?function(e,t,n){if(!e||!e.value)return!0;if("location"!==t.type||"location"!==e.type)return!1;const o=n(e.value);return Boolean(o)}(t,n,o):!(!(0,i.pd)(s)&&"checkbox"!==s)||void(0,u.t1)(s)}function k(e,t){var n;const o=t.collectionViewStore(),i=null==o||null===(n=o.getFormat().board_columns_by)||void 0===n?void 0:n.disableBoardColorColumns;return void 0===i||i}function I(e){const{environment:t,groupFormat:n,schema:o,format:l,collectionContextStore:c,theme:d}=e,u=k(0,c);if(l.collection_group_by||!u){if(n){const e=o[n.property];if(e&&!u){const t=n.value;if((0,r.cu)(e)){const n=(e.options||[]).find((e=>e.value===t.value));return(0,a.bw)(d,null==n?void 0:n.color)}if("status"===e.type&&"status"===t.type){var p,f;let n;if("by_group"===(null===(p=t.value)||void 0===p?void 0:p.type)){var g;const o=t.value.group;n=null===(g=e.groups)||void 0===g||null===(g=g.find((e=>e.name===o)))||void 0===g?void 0:g.color}else if("by_option"===(null===(f=t.value)||void 0===f?void 0:f.type)){var h;const o=t.value.option;n=null===(h=e.options)||void 0===h||null===(h=h.find((e=>e.value===o)))||void 0===h?void 0:h.color}return(0,a.bw)(d,n)}if("relation"===e.type&&"relation"===t.type&&(0,i.t2)(t.value)){const n=c.collectionStore();if(!n)return(0,a.bw)(d,"default");const o=(0,m.gO)(e,n),i=(0,m.uJ)(e,n),r=null==o?void 0:o.getPropertyMapping(),l=null==r?void 0:r[s.b0.StatusV2],u=i&&l&&i[l];if(u&&"status"===u.type){var v;const e=t.value.value.variable,n=null===(v=u.options)||void 0===v||null===(v=v.find((t=>t.id===e)))||void 0===v?void 0:v.color;if(n)return(0,a.bw)(d,n)}}}}return(0,a.bw)(d,"default")}}function C(e){return!("board"===e.viewType&&"board_columns_by"===e.groupByKey)}},52821:(e,t,n)=>{n.d(t,{Bh:()=>D,Cg:()=>Q,DL:()=>Z,JI:()=>U,K8:()=>O,Km:()=>V,Rb:()=>A,SO:()=>T,Sb:()=>W,TP:()=>H,Tr:()=>M,_W:()=>q,_Y:()=>j,aW:()=>F,k4:()=>K,oy:()=>L,r_:()=>G,sN:()=>E,to:()=>z});var o=n(41892),i=n(41432),r=n(99036),a=n(80951),s=n(35013),l=n(21321),c=n(69628),d=n(17948),u=n(42696),p=n(10405),m=n(72126),f=n(19889),g=n(3791),h=n(97880),v=n(5366),b=n(33929),y=n(80444),S=n(77080),_=n(83212),w=n(78291),k=n(19124),I=n(37034),C=n(95697);const x=(0,v.defineMessages)({title:{defaultMessage:"Title",id:"database.propertyTypeName.title"},text:{defaultMessage:"Text",id:"database.propertyTypeName.text"},number:{defaultMessage:"Number",id:"database.propertyTypeName.number"},url:{defaultMessage:"URL",id:"database.propertyTypeName.url"},select:{defaultMessage:"Select",id:"database.propertyTypeName.select"},multi_select:{defaultMessage:"Multi-select",id:"database.propertyTypeName.multi_select"},status:{defaultMessage:"Status",id:"database.propertyTypeName.status"},person:{defaultMessage:"Person",id:"database.propertyTypeName.person"},email:{defaultMessage:"Email",id:"database.propertyTypeName.email"},phone_number:{defaultMessage:"Phone",id:"database.propertyTypeName.phone_number"},date:{defaultMessage:"Date",id:"database.propertyTypeName.date"},file:{defaultMessage:"Files & media",id:"database.propertyTypeName.file"},checkbox:{defaultMessage:"Checkbox",id:"database.propertyTypeName.checkbox"},formula:{defaultMessage:"Formula",id:"database.propertyTypeName.formula"},relation:{defaultMessage:"Relation",id:"database.propertyTypeName.relation"},rollup:{defaultMessage:"Rollup",id:"database.propertyTypeName.rollup"},created_time:{defaultMessage:"Created time",id:"database.propertyTypeName.created_time"},created_by:{defaultMessage:"Created by",id:"database.propertyTypeName.created_by"},last_edited_time:{defaultMessage:"Last edited time",id:"database.propertyTypeName.last_edited_time"},last_edited_by:{defaultMessage:"Last edited by",id:"database.propertyTypeName.last_edited_by"},last_visited_time:{defaultMessage:"Last visited time",id:"database.propertyTypeName.last_visited_time"},button:{defaultMessage:"Button",id:"database.propertyTypeName.button"},auto_increment_id:{defaultMessage:"ID",id:"database.propertyTypeName.auto_increment_id"},location:{defaultMessage:"Location",id:"database.propertyTypeName.location"},verification:{defaultMessage:"Verification",id:"database.propertyTypeName.verification"},ai_summary:{defaultMessage:"AI summary",id:"database.propertyTypeName.text.summarizeWithAi"},ai_custom_prompt:{defaultMessage:"AI custom autofill",id:"database.propertyTypeName.text.customPromptWithAI"},ai_extract:{defaultMessage:"AI key info",id:"database.propertyTypeName.text.extractInfoWithAI"},ai_translate:{defaultMessage:"AI translation",id:"database.propertyTypeName.text.translateWithAI"}}),T={title:b.default.formatMessage(x.title),text:b.default.formatMessage(x.text),number:b.default.formatMessage(x.number),url:b.default.formatMessage(x.url),select:b.default.formatMessage(x.select),multi_select:b.default.formatMessage(x.multi_select),status:b.default.formatMessage(x.status),person:b.default.formatMessage(x.person),email:b.default.formatMessage(x.email),phone_number:b.default.formatMessage(x.phone_number),date:b.default.formatMessage(x.date),file:b.default.formatMessage(x.file),checkbox:b.default.formatMessage(x.checkbox),formula:b.default.formatMessage(x.formula),relation:b.default.formatMessage(x.relation),rollup:b.default.formatMessage(x.rollup),created_time:b.default.formatMessage(x.created_time),created_by:b.default.formatMessage(x.created_by),last_edited_time:b.default.formatMessage(x.last_edited_time),last_edited_by:b.default.formatMessage(x.last_edited_by),last_visited_time:b.default.formatMessage(x.last_visited_time),button:b.default.formatMessage(x.button),auto_increment_id:b.default.formatMessage(x.auto_increment_id),location:b.default.formatMessage(x.location),verification:b.default.formatMessage(x.verification),ai_summary:b.default.formatMessage(x.ai_summary),ai_custom_prompt:b.default.formatMessage(x.ai_custom_prompt),ai_extract:b.default.formatMessage(x.ai_extract),ai_translate:b.default.formatMessage(x.ai_translate)};(0,v.defineMessages)({text:{defaultMessage:"A single line of text.",id:"database.propertyTypeDescription.text"},number:{defaultMessage:"A number, with options to format as currency, percent, and more.",id:"database.propertyTypeDescription.number"},url:{defaultMessage:"A link to a page on the web.",id:"database.propertyTypeDescription.url"},select:{defaultMessage:"Select from a list of options.",id:"database.propertyTypeDescription.select"},multi_select:{defaultMessage:"Tag with values from a list of options.",id:"database.propertyTypeDescription.multi_select"},status:{defaultMessage:"Tag with a list of custom options with groups",id:"database.propertyTypeDescription.status"},person:{defaultMessage:"Reference a person on your team.",id:"database.propertyTypeDescription.person"},email:{defaultMessage:"Reference an email address.",id:"database.propertyTypeDescription.email"},phone_number:{defaultMessage:"Reference a phone number.",id:"database.propertyTypeDescription.phone_number"},date:{defaultMessage:"A date, with options to format and include time.",id:"database.propertyTypeDescription.date"},file:{defaultMessage:"Upload files and images.",id:"database.propertyTypeDescription.file"},checkbox:{defaultMessage:"Track status with a single checkbox.",id:"database.propertyTypeDescription.checkbox"},formula:{defaultMessage:"Compute a formula using other properties of a page.",id:"database.propertyTypeDescription.formula"},relation:{defaultMessage:"Allow pages in this database to reference pages in another.",id:"database.propertyTypeDescription.relation"},rollup:{defaultMessage:"Display and summarize data from a relation.",id:"database.propertyTypeDescription.rollup"},created_time:{defaultMessage:"Reference the date and time a page was created.",id:"database.propertyTypeDescription.created_time"},created_by:{defaultMessage:"Reference the person that created a page.",id:"database.propertyTypeDescription.created_by"},last_edited_time:{defaultMessage:"Reference the date and time a page was last edited.",id:"database.propertyTypeDescription.last_edited_time"},last_edited_by:{defaultMessage:"Reference the person that last edited a page.",id:"database.propertyTypeDescription.last_edited_by"},last_visited_time:{defaultMessage:"Reference the date and time a page was last visited by you.",id:"database.propertyTypeDescription.last_visited_time"},button:{defaultMessage:"A clickable button that can be configured to perform any action.",id:"database.propertyTypeDescription.button"},auto_increment_id:{defaultMessage:"An auto-increment ID.",id:"database.propertyTypeDescription.auto_increment_id"},location:{defaultMessage:"A location.",id:"database.propertyTypeDescription.location"},verification:{defaultMessage:"Verified status.",id:"database.propertyTypeDescription.verification"}});const M=["text","number","select","multi_select","status","date","person","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","verification"],P=["select","multi_select","status","person","date","created_time","created_by","last_edited_time","last_edited_by"],A=function(e){return P.includes(e.type)},R=(0,v.defineMessages)({tableDisplayName:{defaultMessage:"Table",id:"collectionHelpers.table.displayName"},boardDisplayName:{defaultMessage:"Board",id:"collectionHelpers.board.displayName"},calendarDisplayName:{defaultMessage:"Calendar",id:"collectionHelpers.calendar.displayName"},listDisplayName:{defaultMessage:"List",id:"collectionHelpers.list.displayName"},galleryDisplayName:{defaultMessage:"Gallery",id:"collectionHelpers.gallery.displayName"},timelineDisplayName:{defaultMessage:"Timeline",id:"collectionHelpers.timline.displayName"},pageDisplayName:{defaultMessage:"Page",id:"collectionHelpers.page.displayName"}}),D={table:b.default.formatMessage(R.tableDisplayName),board:b.default.formatMessage(R.boardDisplayName),calendar:b.default.formatMessage(R.calendarDisplayName),list:b.default.formatMessage(R.listDisplayName),gallery:b.default.formatMessage(R.galleryDisplayName),timeline:b.default.formatMessage(R.timelineDisplayName),page:b.default.formatMessage(R.pageDisplayName)},B=(0,v.defineMessages)({table:{defaultMessage:"Table with types to store and view any kind of structured data",id:"collectionHelpers.table.caption"},board:{defaultMessage:"Kanban board, great for project planning and bug tracking",id:"collectionHelpers.board.caption"},calendar:{defaultMessage:"Month view, for event planning and scheduling",id:"collectionHelpers.calendar.caption"},list:{defaultMessage:"A simplified page view, great for bookmarks and notes",id:"collectionHelpers.list.caption"},gallery:{defaultMessage:"Grid of cards, use for mood boards, index cards, and recipes",id:"collectionHelpers.gallery.caption"},timeline:{defaultMessage:"A timeline view, great for project scheduling and planning",id:"collectionHelpers.timeline.caption"},page:{defaultMessage:"A page view for organizing pages hierarchically, great for documents and wikis",id:"collectionHelpers.page.caption"}}),E={table:b.default.formatMessage(B.table),board:b.default.formatMessage(B.board),calendar:b.default.formatMessage(B.calendar),list:b.default.formatMessage(B.list),gallery:b.default.formatMessage(B.gallery),timeline:b.default.formatMessage(B.timeline),page:b.default.formatMessage(B.page)},F={table:u.t,board:s.i,calendar:l.N,list:d.O,gallery:c.n,timeline:p._,page:d.O},Z=(o.Z.images.tooltips.views.tablePng,o.Z.images.tooltips.views.boardPng,o.Z.images.tooltips.views.calendarPng,o.Z.images.tooltips.views.listPng,o.Z.images.tooltips.views.galleryPng,o.Z.images.tooltips.views.timelinePng,o.Z.images.tooltips.views.listPng,{table:void 0,board:"board_cover",calendar:void 0,list:void 0,gallery:"gallery_cover",timeline:void 0,page:void 0}),L={table:void 0,board:"board_cover_size",calendar:void 0,list:void 0,gallery:"gallery_cover_size",timeline:void 0,page:void 0},j={table:void 0,board:"board_cover_aspect",calendar:void 0,list:void 0,gallery:"gallery_cover_aspect",timeline:void 0,page:void 0},V={table:!0,board:!1,calendar:!1,list:!0,gallery:!0,timeline:!0,page:!1};function U(e){const t=e.getType(),n=e.getTitleStore();return t&&(0,i.dM)(t)&&n?n:e.getBlockTitleStore()}function O(e,t){let n=[];switch(t){case"gallery":e&&e.gallery_properties&&(n=e.gallery_properties);break;case"board":e&&e.board_properties&&(n=e.board_properties)}const o=n.find((e=>{let{property:t}=e;return"title"===t}));return!!o&&Boolean(o.visible)}const N=["text","number","select","multi_select","status","date","person","ai_summary","ai_extract","ai_custom_prompt","ai_translate","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","location","verification"];function z(e){if((0,r.XU)(e))switch(e){case"ai_custom_prompt":case"ai_extract":case"ai_summary":case"ai_translate":return"suggested";default:throw(0,h.t1)(e)}return"standard"}function H(e){let{isSyncedCollection:t,collectionContextStore:n,environment:o}=e;const i=S.default.checkGate("database_sync_ugc");return N.filter((e=>{if((0,r.XU)(e)){const t=n.collectionStore();if(!t)return!1;const i=_.Z.getMode(o,t);return t.isTypedCollection()?"suggested"!==z(e)&&(0,k.mX)(o,i,t):(0,k.mX)(o,i,t)}return!(!i&&t&&!(0,r.Of)(e))&&!!((0,C.QI)()&&"collectionTypedView"===n.contextType||"location"!==e)}))}function W(e){let{propertySchema:t,property:n,blockStores:o,collectionSchema:i}=e;return 0!==o.length&&((0,r.iE)(t)?o.every((e=>q(t,e,i))):!(0,r.ZY)(t.type)&&!(0,a.wl)(n))}function q(e,t,n){const o=e.verifier_property;if(!o)return!1;const i=t.getPropertyValue(o),r=(0,a.DW)({textValue:i,propertySchema:n[o],blockCreatorPointer:t.getCreatedByPointer()}),s=y.default.state.currentUserRootStore;return!!s&&r.some((e=>e.id===s.id&&e.table===f.KJ))}function G(e){const{collectionStore:t,environment:n,intl:o,queryForFilter:i}=e;if(""===i)return!0;return(0,I.vU)({environment:n,intl:o,store:t}).toUpperCase().includes(i.toUpperCase())}function K(){var e;const t=(null===(e=w.default.state.data)||void 0===e?void 0:e.addOns)??[];return(0,g.de)(t)}function $(e,t){for(const n of t)void 0===e[n]&&delete e[n]}function Q(e){const t=m.Xh(e.loader);if($(t,["sort","reducerDependencies","searchQuery","upwardTraversalRelation","vectorSearch","filter"]),t.reducers)for(const n of Object.values(t.reducers))switch(n.type){case"results":$(n,["filter","searchQuery","loadContentCover"]);break;case"groups":$(n,["filter"]);break;case"aggregation":$(n,["filter"]),void 0===n.aggregation.property&&$(n.aggregation,["property"])}return{collectionView:e.collectionView,source:e.source,loader:t}}},48543:(e,t,n)=>{n.d(t,{LQ:()=>u,Ls:()=>l,RI:()=>p,RO:()=>m});var o=n(17683),i=n(31490),r=n(32240),a=n(5366),s=n(33929);const l={table:"side_peek",board:"side_peek",calendar:"center_peek",list:"side_peek",gallery:"center_peek",timeline:"side_peek",page:"side_peek"},c=(0,a.defineMessages)({side_peek:{defaultMessage:"Side peek",id:"database.viewPropertiesMenu.peekMode.sidePeek"},center_peek:{defaultMessage:"Center peek",id:"database.viewPropertiesMenu.peekMode.centerPeek"},full_page:{defaultMessage:"Full page",id:"database.viewPropertiesMenu.peekMode.fullPage"}}),d=(0,a.defineMessages)({side_peek:{defaultMessage:"Open pages on the side. Keeps the view behind interactive.",id:"database.viewPropertiesMenu.peekMode.description.sidePeek"},center_peek:{defaultMessage:"Open pages in a focused, centered modal.",id:"database.viewPropertiesMenu.peekMode.description.centerPeek"},full_page:{defaultMessage:"Open pages in full page.",id:"database.viewPropertiesMenu.peekMode.description.fullPage"}}),u=e=>{switch(e){case"side_peek":return s.default.formatMessage(c.side_peek);case"center_peek":return s.default.formatMessage(c.center_peek);case"full_page":return s.default.formatMessage(c.full_page)}},p=e=>{switch(e){case"side_peek":return s.default.formatMessage(d.side_peek);case"center_peek":return s.default.formatMessage(d.center_peek);case"full_page":return s.default.formatMessage(d.full_page)}},m=e=>{switch(e){case"side_peek":return r.y;case"center_peek":case"mini_peek":return o.Q;case"full_page":return i.M}}},65742:(e,t,n)=>{n.d(t,{AZ:()=>W,B8:()=>L,BJ:()=>x,C1:()=>K,DS:()=>N,EW:()=>J,GK:()=>U,Ge:()=>k,Gz:()=>A,H5:()=>M,HZ:()=>Se,Ii:()=>ce,Ip:()=>H,Ne:()=>ue,PF:()=>O,Qw:()=>ge,S7:()=>b,ST:()=>B,TW:()=>F,Tp:()=>re,Wk:()=>y,XO:()=>Z,YE:()=>ve,YP:()=>le,Zn:()=>me,_Q:()=>ne,_e:()=>P,al:()=>j,bK:()=>V,bk:()=>E,cK:()=>z,d$:()=>G,e$:()=>R,f2:()=>ye,fc:()=>te,fj:()=>$,i2:()=>_,lf:()=>S,lx:()=>I,pQ:()=>ae,pe:()=>de,px:()=>w,qG:()=>X,rr:()=>ie,vX:()=>he,wI:()=>be,x2:()=>D,xI:()=>Q,xJ:()=>Y,xP:()=>oe,xd:()=>fe,y1:()=>pe,yk:()=>ee});var o=n(30120),i=n(13991),r=n(49085),a=n(30823),s=n(99036),l=n(80951),c=n(40506),d=n(7057),u=n(53877),p=n(6695),m=n(42875),f=n(15157),g=n(97880),h=n(77794),v=n(77181);const b=5,y=3,S=2,_=21;let w=function(e){return e[e.LeftResizer=0]="LeftResizer",e[e.RightResizer=1]="RightResizer",e[e.ItemDrag=2]="ItemDrag",e}({});const k=4e3,I=k/4,C=864e5,x={hours:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"fifteen_minutes",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:C/7e3,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"fifteen_minutes",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:9,getDateRangePlaceholderDuration:e=>e.plus({hour:1})},day:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"hour",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:69120,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"hour",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:2,getDateRangePlaceholderDuration:e=>e.plus({hour:3})},week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:48e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:"day",showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:1})},bi_week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:108e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:3})},month:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:216e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:5})},quarter:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:72e5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:35,getDateRangePlaceholderDuration:e=>e.plus({week:2})},year:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:C/5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:6,getDateRangePlaceholderDuration:e=>e.plus({week:4})}},T="month";function M(e){var t;return null===(t=P(e))||void 0===t?void 0:t.property}function P(e){const t=e.normalizedFormatStore.state.timeline_arrows_by;if(null==t||!t.property)return;const n=e.normalizedSchemaStore.state[t.property],o=e.collectionStore();return n&&"relation"===n.type&&n.property&&o&&(0,s.F0)(n)===o.id?{property:t.property,inverse:n.property}:void 0}function A(e){return{zoomLevel:r.default.createValue(T),currentRange:r.default.createValue({startTimestamp:0,endTimestamp:0}),dragState:r.default.createValue(void 0),drawState:r.default.createValue(void 0),hoveredItem:r.default.createValue(void 0),dateRangePlaceholder:r.default.createValue({active:!1}),scrollLeft:r.default.createValue(void 0),outerSizeObserver:new h.E,timelineSizeObserver:new h.E,horizontalScroller:void 0,savePreference:void 0,isFullScreen:e.isFullScreen,isRootChild:e.isRootChild,destroyed:!1}}function R(e,t){return t/x[e].msPerPixel}function D(e,t){return t*x[e].msPerPixel}function B(e){return"fifteen_minutes"===e||"hour"===e}function E(e){const{store:t,query:n,schema:o,userId:i,intl:r}=e,l=t.getModel();if(!l)return;const{timeline_by:c,timeline_by_end:d}=n;if(!c)return;const p=o[c];if(!p||!(0,s.Lt)(p))return;const f=(0,a.FT)({property:c,schema:o,block:l,getRecordModel:t.getRecordModel,propertyMapping:void 0,collectionRequestContext:{userId:i,userTimeZone:(0,m.r)(),depth:0,intl:r,visitedProperties:new Set,resultCache:{}}}).next().value;if("date"!==(null==f?void 0:f.type))return;const g=f.value;if(!d||c===d)return g;{const e=o[d];if(!e||!(0,s.Lt)(e))return;const n=(0,a.FT)({property:d,schema:o,block:l,getRecordModel:t.getRecordModel,propertyMapping:void 0,collectionRequestContext:{userId:i,userTimeZone:(0,m.r)(),depth:0,intl:r,visitedProperties:new Set,resultCache:{}}}).next().value;if(n&&"date"===n.type){const e=n.value,t=u.rH(g,e);if(t)return u.Qq(t)}}}function F(e){const{store:t,dateValue:n,query:o,schema:i}=e,{timeline_by:r,timeline_by_end:a}=o;if(!r)return;const d=i[r];if(d&&(0,s.Lt)(d)){if(!a||r===a)return{[r]:(0,l.d7)(n)};{const e=i[a];if(!e||!(0,s.Lt)(e))return;const o=(0,l.Gl)(t.getPropertyValue(r)),d=(0,l.Gl)(t.getPropertyValue(a));if("date"===n.type)return{[r]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(o)}),[a]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(d)})};if("daterange"===n.type)return{[r]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(o)}),[a]:(0,l.d7)({type:"date",start_date:n.end_date,reminder:c.V3(d)})};if("datetime"===n.type)return{[r]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(o)}),[a]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(d)})};if("datetimerange"===n.type)return{[r]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(o)}),[a]:(0,l.d7)({type:"datetime",start_date:n.end_date,start_time:n.end_time,time_zone:n.time_zone,reminder:c._3(d)})};(0,g.t1)(n)}}}function Z(e,t){const n=B(t),o=u.NK(n?e:c.Dy(e),(0,m.r)()),i=N(o.start,t),r=n&&"date"===e.type?o.start.plus({days:1}).startOf("day"):o.end||i;return{start:i,end:n?N(r,t):H(r,t)}}function L(e){return`timeline:${e}`}function j(e){const{horizontalScroller:t,outerSizeObserver:n}=e,o=e.zoomLevel.state,{startTimestamp:i}=e.currentRange.state;return i+D(o,(t?t.scrollLeft:0)+n.rect.state.width/2)}function V(e){const{environment:t,timestamp:n,timelineState:o,paddingLeft:i,format:r}=e;return n-D(o.zoomLevel.state,Q({environment:t,paddingLeft:i,format:r,isFullScreen:o.isFullScreen,isRootChild:o.isRootChild})/2)}function U(e){const{environment:t,timestamp:n,timelineState:o,paddingLeft:i,format:r}=e;return n-D(o.zoomLevel.state,Q({environment:t,paddingLeft:i,format:r,isFullScreen:o.isFullScreen,isRootChild:o.isRootChild})-o.outerSizeObserver.rect.state.width/2)}function O(e){const{timestamp:t,timelineState:n}=e;return t+D(n.zoomLevel.state,-n.outerSizeObserver.rect.state.width/2)}function N(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15);return e.set({minute:t}).startOf("minute")}return e.startOf(t)}function z(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)-15;return e.set({minute:t}).startOf("minute")}return e.startOf(t).minus({[t]:1}).startOf(t)}function H(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)+15;return e.set({minute:t}).startOf("minute")}return e.plus({[t]:1}).startOf(t)}function W(e){const{startValue:t,snapUnit:n,desiredStart:o,desiredEnd:i}=e;let r=t;const a=c.Ze(t)||(0,m.r)();if(o){const e=q(o,n,"start",a);if("datetime"===e.type)if("date"===r.type){const e={type:"daterange",start_date:r.start_date,end_date:r.start_date};r=u.bD(e,(0,m.r)())}else"daterange"===r.type&&(r=u.bD(r,(0,m.r)()));"date"===r.type?r={...r,type:"daterange",start_date:e.start_date,end_date:r.start_date}:"daterange"===r.type?r={...r,type:"daterange",start_date:e.start_date,end_date:r.end_date}:"datetime"===r.type?r={...r,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:r.start_time,end_date:r.start_date,end_time:r.start_time}:"datetimerange"===r.type&&(r={...r,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:r.start_time})}if(i){const e=q(i,n,"end",a);if("datetime"===e.type)if("date"===r.type){const e={type:"daterange",start_date:r.start_date,end_date:r.start_date};r=u.bD(e,(0,m.r)())}else"daterange"===r.type&&(r=u.bD(r,(0,m.r)()));"date"===r.type||"daterange"===r.type?r={...r,type:"daterange",end_date:e.start_date}:"datetime"!==r.type&&"datetimerange"!==r.type||(r={...r,type:"datetimerange",end_date:e.start_date,end_time:"datetime"===e.type?e.start_time:"datetimerange"===r.type?r.end_time:r.start_time})}return c.qW(r)}function q(e,t,n,o){const i=z(e,t),r=N(e,t),a=H(e,t),s=B(t);let l;return l="start"===n?e.valueOf()>=r.valueOf()+(r.valueOf()-i.valueOf())/2?a:r:e.valueOf()>=r.valueOf()+(r.valueOf()-i.valueOf())/2?s?a:r:s?r:i,function(e,t,n){return B(t)?u.CQ(e.valueOf(),n):u.hT(e.valueOf(),n)}(l,t,o)}function G(e){const{environment:t,isFullScreen:n,isRootChild:o}=e;return(t.device.isDesktop||t.device.isTablet)&&(n||o)}function K(e){const{environment:t,format:n,isFullScreen:o,isRootChild:i}=e;return G({environment:t,isFullScreen:o,isRootChild:i})&&Boolean(n.timeline_show_table)}function $(e){const{isFullScreen:t,isRootChild:n}=e;return!t&&n&&K(e)}function Q(e){const{environment:t,paddingLeft:n,format:o,isFullScreen:i,isRootChild:r}=e;if(!K({environment:t,format:o,isFullScreen:i,isRootChild:r}))return 0;return n+(o.timeline_table_properties||[]).reduce(((e,t)=>(t.width&&t.visible?t.width:0)+e),0)}function Y(){const e=o.ou.now().setLocale(i.SP);return e.toLocaleString(o.ou.TIME_SIMPLE)===e.toLocaleString(o.ou.TIME_24_SIMPLE)}function J(e,t,n){return"day"===n?(0,d.Yx)(t,"month_day_long",e):"month"===n?(0,d.Yx)(t,"month_long",e):void(0,g.t1)(n)}function X(e,t){return"day"===t?(0,d.Yx)(e,"long",i.SP):"month"===t?(0,d.Yx)(e,"month_year_long",i.SP):void(0,g.t1)(t)}function ee(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),i.SP),{primaryDisplayUnit:o}=x[t],r="fifteen_minutes"===o||"hour"===o?"month_day_time":"month_day";return(0,d.Yx)(n.start.valueOf(),r,i.SP)}function te(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),i.SP),{primaryDisplayUnit:o}=x[t],r=(n.end||n.start).valueOf(),a="fifteen_minutes"===o||"hour"===o?"month_day_time":"month_day";return(0,d.Yx)(r,a,i.SP)}function ne(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),i.SP),{primaryDisplayUnit:o}=x[t],r="fifteen_minutes"===o||"hour"===o?"medium_with_time":"medium",a=(0,d.Yx)(n.start.valueOf(),r,i.SP);return n.end?`${a} → ${(0,d.Yx)(n.end.valueOf(),r,i.SP)}`:a}function oe(e,t){return N(e,t)<e?H(e,t):e}function ie(e){return e.device.nativeScrollbarWidth>0||e.device.isFirefox||e.device.isPhone}function re(e){return!(e.device.isFirefox||e.device.isMobile)}function ae(e,t){const n=t.currentUser.id,o=e.getFormat().timeline_preference,i=L(e.id),r=f.Z.get({userId:n,key:i}),a={zoomLevel:T,centerTimestamp:Date.now()};return se(r)||se(o)||a}function se(e){if(e&&"number"==typeof e.centerTimestamp&&p.H.includes(e.zoomLevel))return e}function le(e,t){let n=e.timeline_table_properties||[];if(t){n.find((e=>{let{visible:t}=e;return Boolean(t)}))||(n=(0,p.Rt)(n,"title",!0))}return{timeline_show_table:t,timeline_table_properties:n}}function ce(e){const{environment:t,collectionContextStore:n,timelineState:o,isFullScreen:i,isRootChild:r}=e,a=o.zoomLevel.state,s=n.normalizedFormatStore.state,l=K({environment:t,format:s,isFullScreen:i,isRootChild:r}),c=l&&s.timeline_table_properties?s.timeline_table_properties.length:0,d=s.timeline_properties||[],u=d.filter((e=>"title"!==e.property));return{zoom_level:a,show_table:l,show_table_properties_count:c,show_timeline_title:d.length!==u.length,show_timeline_properties_count:u.length}}const de=33,ue=66,pe=22,me=33,fe=4,ge=96;function he(e){return e?de:ue}function ve(e,t,n){if(!t)return[];const o=M(e);if(!o)return[];const i=t.getPropertyValue(o),r=n[o];return i&&r&&"relation"===r.type?(0,l.j$)({relationValue:(0,l.rq)(i),propertySchema:r,getRecordModel:t.getRecordModel}):[]}function be(e,t,n){var o;if(!t)return[];const i=null===(o=(0,v.jA)(e))||void 0===o?void 0:o.property;if(!i)return[];const r=t.getPropertyValue(i),a=n[i];return r&&a&&"relation"===a.type?(0,l.j$)({relationValue:(0,l.rq)(r),propertySchema:a,getRecordModel:t.getRecordModel}):[]}function ye(e,t,n){var o;if(!t)return[];const i=null===(o=(0,v.OW)(e))||void 0===o?void 0:o.property;if(!i)return[];const r=t.getPropertyValue(i),a=n[i];return r&&a&&"relation"===a.type?(0,l.j$)({relationValue:(0,l.rq)(r),propertySchema:a,getRecordModel:t.getRecordModel}):[]}function Se(e){const{timelineState:t,placeholderDate:n,subitemPlaceholderDate:o}=e,i=o??e.dateValue;if(!i)return;const r=t.zoomLevel.state,{snapUnit:a}=x[r],{startTimestamp:s,endTimestamp:l}=t.currentRange.state,{start:c,end:d}=Z(i,a),u=d.valueOf()>s&&c.valueOf()<l,p=R(r,c.valueOf()-s)+2,m=o?Math.max(p+40,0):Math.max(p,0),f=R(r,d.valueOf()-s)-2,g=R(r,l-s),h=Math.min(f,g),v=h/R(r,l-s);return{visible:u,isPlaceholder:Boolean(n),isExistingSubitemPlaceholder:Boolean(o),left:m,right:h,maskPercent:v}}},78316:(e,t,n)=>{n.d(t,{Bm:()=>Ze,Bs:()=>de,Cc:()=>pe,Ch:()=>be,D:()=>ge,D2:()=>re,D8:()=>$,HI:()=>G,Ks:()=>le,L5:()=>ve,Mq:()=>O,NG:()=>ne,NU:()=>ee,PD:()=>q,PI:()=>H,Ql:()=>Be,SY:()=>xe,Sc:()=>ke,Se:()=>W,VM:()=>ie,Vv:()=>me,XO:()=>ye,YG:()=>_e,YL:()=>he,_5:()=>ce,az:()=>oe,b1:()=>Fe,bW:()=>Ee,bd:()=>te,bu:()=>N,eD:()=>fe,eL:()=>De,en:()=>se,fk:()=>Ae,fm:()=>Pe,kr:()=>we,mb:()=>Ce,p1:()=>ae,pB:()=>Ie,rD:()=>ue,v_:()=>Re,w0:()=>Se,wK:()=>X,xy:()=>Q,zm:()=>K});n(21703),n(30541),n(57658);var o=n(15145),i=n(41432),r=(n(14714),n(99036)),a=n(80951),s=n(43690),l=n(8848),c=n(93824),d=n(87444),u=n(95538),p=n(6695),m=n(72126),f=n(4615),g=n(71644),h=n(98963),v=n(21202),b=n(6287),y=n(13493),S=n(19889),_=n(70203),w=n(97880),k=n(5366),I=n(35541),C=n(95477),x=n(58202),T=n(24646),M=n(80444),P=n(88923),A=n(35661),R=n(27724),D=n(28020),B=n(4708),E=(n(52821),n(48543)),F=n(75081),Z=n(84210),L=n(33929),j=n(85957),V=n(17311),U=n(35328);(0,k.defineMessages)({status:{id:"database.viewHelpers.selectProperty.defaultName",defaultMessage:"Status"},date:{id:"database.viewHelpers.dateProperty.defaultName",defaultMessage:"Date"}});const O={showDelay:500,showHold:100},N=new Set(["gallery","list","calendar"]),z=(0,k.defineMessages)({addTypedItemTitle:{id:"collectionViewBlock.action.newItem.typedDatabaseTitle",defaultMessage:"New {singleItemName}"},addItemTitle:{id:"collectionViewBlock.action.newItem.nonTypedDatabaseTitle",defaultMessage:"New"}});function H(e){return"collectionTypedView"===e.contextType?L.default.formatMessage(z.addTypedItemTitle,{singleItemName:(0,F.sN)(e.databaseType)}):L.default.formatMessage(z.addItemTitle)}function W(e){const t=Object.keys(e);return t.find((t=>{const n=e[t];return Boolean(n&&"status"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"select"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"person"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"multi_select"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"relation"===n.type)}))}function q(e){const t=Object.keys(e);return t.find((t=>{const n=e[t];return Boolean(n&&"date"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"created_time"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"last_edited_time"===n.type)}))}function G(e){return Object.keys(e).find((t=>{const n=e[t];return Boolean(n&&"date"===n.type)}))}function K(e){const{collectionId:t,schema:n,property:o,targetCollectionStore:i}=e,s=n[o];if(!s)return;const l={newSchema:{...n,[o]:void 0},deletedSchema:{[o]:n[o]}};if("relation"===s.type&&r.F0(s)&&s.property&&!(0,a.Kp)(s))if(r.F0(s)===t&&s.property!==o){const e={...l.newSchema,[s.property]:void 0},t={...l.deletedSchema,[s.property]:n[s.property]};l.newSchema=e,l.deletedSchema=t}else if(r.F0(s)!==t&&null!=i&&i.canEditCollection()&&i.isDefined()){const e=r.oC({schema:i.getSchema(),format:i.getFormat(),space_id:i.getSpaceId()}),t={...e,[s.property]:void 0},n={[s.property]:e[s.property]};l.otherCollectionId=i.id,l.otherCollectionSchema=t,l.otherCollectionDeletedSchema=n}return l}function $(e){const{deletedSchema:t,property:n}=e;if(t[n])return{updateSchema:{[n]:t[n]},updateDeletedSchema:{[n]:null}}}async function Q(e){const{environment:t,schema:n,properties:o,property:i,parentStore:a,spaceId:s}=e,l=n[i];if(!l)return;if(r.dx(l))return;const c=(0,g.ZP)(),u={...l,name:(0,d.nM)(l.name)},p=o.findIndex((e=>e.property===i)),m=o[p],v={property:c,visible:!0,width:m&&m.width},b=[...o];let y;if(b.splice(p+1,0,v),"button"===u.type&&u.automation_id){const e=A.Mz.createChildStore(a,{table:h.cv,id:u.automation_id,spaceId:s});await e.load();const n=e.getActionStores();await Promise.all(n.map((e=>e.load())));const o=e.getValue(),i=n.map((e=>e.getValue()));if(!o||!i.every(w.$K))throw new Error("Automation or AutomationActions were not defined.");const r={...o,id:(0,f.ZP)()},l=i.map((e=>{const n={...e,id:(0,f.ZP)()};return(0,d.t1)({original:e,duplicate:n,newParentId:r.id,getRecordRole:a.inMemoryRecordCache.makeGetRecordRoleFn(t.currentUser.id)}),n})),c=t.currentUser.id,p=c?{id:c,table:S.KJ}:void 0;(0,d.tV)({duplicate:r,newParentId:r.parent_id,newActionIds:l.map((e=>e.id)),originOptions:{baseUrl:C.default.domainBaseUrl,publicDomainName:C.default.publicDomainName},actor:p}),u.automation_id=r.id,y={newAutomationValue:r,newAutomationActionValues:l}}return{newProperty:c,newPropertySchema:u,newProperties:b,automationUpdate:y}}function*Y(e){const{rootStore:t,depth:n=0}=e;if(t.getType()===i.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();e&&(yield*Y({rootStore:e,depth:n}))}else{const e=t.getContentStores();for(const t of e)yield{blockStore:t,depth:n},t.isNavigableBlock()||(0,U.BX)(t)||(yield*Y({rootStore:t,depth:t.getType()===i.Ti.columnList||t.getType()===i.Ti.column||t.getType()===i.Ti.transclusionContainer||t.getType()===i.Ti.transclusionReference?n:n+1}))}}function J(e,t){const n={image:void 0,blocks:[],isDefined:!0},o=Y({rootStore:e});let r=0,a=0;for(const{blockStore:l,depth:c}of o){if(r++,r>s.C7)return n;l.isDefined()||(n.isDefined=!1);const e=l.getType(),o=l.getModel();if(!e||!o)continue;const d=l.getProperties();if(o.isType(i.Ok)&&!n.image&&d){const t=(0,_.QaF)(d.source);if(t&&((0,u.SR)({url:t})||e===i.Ti.image))return n.image={pointer:{table:"block",id:l.id},url:t},n}const p=(0,i.nq)(e),m=o.isType(i.MV)&&(!l.isEmptyTitle()||p),f=t&&void 0!==(0,I.u)(l);(m||f)&&a<s.Uo&&(n.blocks.push({blockStore:l,depth:c}),p||a++)}return n}function X(e,t){const{image:n,blocks:o,isDefined:i}=J(e,t);return n?{image:n,blockIds:[],isDefined:i}:{image:void 0,blockIds:o.map((e=>e.blockStore.id)),isDefined:i}}function ee(e,t){const{image:n,blocks:o,isDefined:r}=J(e,t);if(n)return{image:n,blockIds:[],isDefined:r};return{image:void 0,blockIds:o.filter((e=>{const{blockStore:t,depth:n}=e;return 0===n&&t.getType()!==i.Ti.transclusionReference&&t.getType()!==i.Ti.transclusionContainer})).map((e=>e.blockStore.id)),isDefined:r}}function te(e){const t=e.isFullScreen.state,n=e.collectionViewStore();if(!n)throw new Error("Collection view store not defined.");const o=e.normalizedFormatStore.state,i=n.isDefined()&&"board"===n.getType(),r=o.collection_group_by;if(!t||r){const e=p.rx(o.inline_collection_first_load_limit,Boolean(r));if("load_limit"===e.type)return e.limit}return i?20:t?50:20}function ne(e){const{collectionViewStore:t,isFullScreen:n,currentResultCount:o}=e;return t.isDefined()&&"board"===t.getType()?20:n||o<=50?50:100}function oe(e,t){const n=e.collectionViewStore();if(!n)return!1;const o=n.getFormat();return!t||Boolean(o.collection_group_by)}function ie(e){const{collectionContextStore:t,isFullScreen:n,reducerResult:o}=e;return o&&o.blockIds.length>0&&!((i=o)&&!i.hasMore)&&oe(t,n);var i}function re(e){const{query:t,schema:n}=e,{timeline_by:o,timeline_by_end:i}=t;if(o){const e=n[o];if(e&&"date"!==e.type)return!1}if(i){const e=n[i];if(e&&"date"!==e.type)return!1}return!0}function ae(e){const t=e.getParentBlockStore();return Boolean(t&&t.isLocked())}function se(e){return(0,j.wq)(e)}function le(e){return P.default.isSidePeekOpen()&&!se(e)&&!e.isImmediateColumnChild()&&(e.isRootOrDirectChild()||"page"===e.getType())}function ce(e){const t=e.getRecordStoreUIRoot();return!!(t&&t instanceof A.G)&&t.isFullWidth()}function de(e){const{environment:t,isFullScreen:n,store:o,sizeObserver:i,viewType:r}=e,{device:a,WindowSizeStore:s}=t,l=o.isRootOrDirectChild();if(!n&&!l&&"gallery"===r)return{paddingLeft:1,paddingRight:1};if(l){if(se(o))return{paddingLeft:P.PeekModePadding.horizontal[P.default.state.mode],paddingRight:P.PeekModePadding.horizontal[P.default.state.mode]};if(a.isPhone)return{paddingLeft:s.getSafePaddingLeftPx((0,D.ui)(t)),paddingRight:s.getSafePaddingRightPx((0,D.ui)(t))};if(n)return{paddingLeft:96,paddingRight:96};if(ce(o)||function(e,t){const{WindowSizeStore:n}=e;return n.state.width-((0,T.Wk)(e)+(0,T.ll)(e,t)-(0,T.vJ)(e))<D.CC}(t,se(o))||le(o)&&!P.default.isSidePeekClosing.state)return{paddingLeft:(0,D.ui)(t),paddingRight:(0,D.ui)(t)};{const e=i.rect.state.width;if(0===e)return;const n=(e-(D.CC-2*(0,D.ui)(t)))/2;return{paddingLeft:n,paddingRight:n}}}return{paddingLeft:0,paddingRight:0}}function ue(e){switch(e){case"large":return V.Z.card.desktop.large.width;case"small":return V.Z.card.desktop.small.width;case"medium":default:return V.Z.card.desktop.medium.width}}function pe(e){let{collectionViewName:t,collectionViewType:n}=e;return t||L.default.formatMessage(Fe[n])}function me(e){var t;return((null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewsStore().getValue())||[]).map((t=>A.Xr.createChildStore(e,{table:y.n,id:t}))).find((e=>"table"===e.getType()))}function fe(e){const{collectionStore:t,collectionViewBlockStore:n,checkNavigableAncestorLocked:o}=e;if(!n)return!1;if(o&&n.isNavigableAncestorLocked())return!1;const i=null==t?void 0:t.canEditCollection(),r=null==t?void 0:t.getParentBlockStore(),a=null==r?void 0:r.isLocked();return Boolean(i&&!a)}function ge(e,t){const n=e.getType();if(!n)return!1;if(""===t)return!0;return-1!==pe({collectionViewName:e.getName(),collectionViewType:n}).toUpperCase().indexOf(t.toUpperCase())}function he(e){const{newOptions:t,collectionId:n,property:o,schema:i}=e,a=i[o];if(!a)return;if(!r.cu(a)&&"status"!==a.type)return;const s=a.options||[],l=[],d=m.xH(t),u=s.map((e=>e.value)),{beforeOps:p}=(0,c.q)(u,d);for(const[r,c]of Object.entries(p)){const e=s.find((e=>e.value===r));if(e)if(c){const t=s.find((e=>e.value===c));if(t){const i={pointer:{table:b.v,id:n},command:"keyedObjectListBefore",path:["schema",o,"options"],args:{value:e,before:{id:t.id}}};l.push(i)}}else{const t={pointer:{table:b.v,id:n},command:"keyedObjectListAfter",path:["schema",o,"options"],args:{value:e}};l.push(t)}}if("status"===a.type){const e=a.groups??[];for(const[i]of e.entries()){const e=t[i];if(!Array.isArray(e))return;const r=s.filter((t=>e.includes(t.value))).map((e=>e.id)),a={pointer:{table:b.v,id:n},command:"set",path:["schema",o,"groups",i,"optionIds"],args:r};l.push(a)}}return l.length>0?l:void 0}function ve(e){const{collectionId:t,property:n,propertySchema:o,schema:i,isAscending:r}=e;return he({newOptions:[...o.options||[]].map((e=>e.value)).sort(((e,t)=>e.localeCompare(t,void 0,{sensitivity:"base"})*(r?1:-1))),collectionId:t,property:n,schema:i})}function be(e){const{collectionId:t,property:n,propertySchema:o,newOption:i,isAscending:r}=e,a=o.options||[],s=m.cx(a,(e=>e.value.localeCompare(i.value,void 0,{sensitivity:"base"})*(r?1:-1)>=0));return-1!==s?{pointer:{table:b.v,id:t},command:"keyedObjectListBefore",path:["schema",n,"options"],args:{value:i,before:a[s]}}:{pointer:{table:b.v,id:t},command:"keyedObjectListAfter",path:["schema",n,"options"],args:{value:i}}}function ye(e){const{viewType:t,format:n}=e;return"board"===t?p.Lw(n.board_cover):"gallery"===t?p.Lw(n.gallery_cover):"timeline"===t&&p.vP(Boolean(n.timeline_show_table),n.timeline_table_properties||[])}function Se(e){const{viewType:t}=e;return"table"===t||("board"===t||("gallery"===t||void 0))}function _e(e){const t=null==e?void 0:e.getType();if(!e||!t)return!1;return"full_page"===(e.getFormat().collection_peek_mode||E.Ls[t])}function we(e){const t=null==e?void 0:e.getType();return(null==e?void 0:e.getFormat().collection_peek_mode)??(t?E.Ls[t]:"side_peek")}function ke(e){const{stores:t,phase:n}=R.default.state;return!(n===R.SelectionPhase.Selected&&t.indexOf(e)>=0)&&(P.default.state.open&&P.default.isSidePeekOpen()&&P.default.state.target.id===e.id)}function Ie(e,t){return e?{background:l.ZP.blueWithAlpha(.025),boxShadow:t.outlineUltraThinBlueInputBoxShadow,borderRadius:4}:{}}function Ce(e){const{store:t,mainEditorCurrentBlockStore:n,collectionContextStore:i,fullyQualified:r,overridePeekMode:a}=e,s=null==i?void 0:i.collectionViewStore();if(!a&&_e(s))return(0,Z.ZP)({store:t,fullyQualified:r,pageVisitSource:(null==i?void 0:i.getPageVisitSourceOverride())??o.tY.Expand});if(n){const e=null==i?void 0:i.getViewType(),l=(null==i?void 0:i.normalizedFormatStore.state.collection_peek_mode)??(e?E.Ls[e]:void 0),c=a??(0,P.getPeekModeFromCollectionPeekModeFormat)(l);return(0,Z.ZP)({store:n,collectionViewId:null!=i&&i.isFullScreen.state?null==s?void 0:s.id:void 0,fullyQualified:r,peekViewBlockId:t.id,peekMode:(0,P.getUrlParamFromPeekMode)(c),pageVisitSource:(null==i?void 0:i.getPageVisitSourceOverride())??o.tY.PeekOpen})}}function xe(e){var t;const n=null===(t=e.getCollectionViewStores().find((e=>"page"===e.getType())))||void 0===t?void 0:t.getFormat().page_pointer;if(n)return A.G.createChildStore(e,{table:v.iU,id:null==n?void 0:n.id,spaceId:e.getSpaceId()})}function Te(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null==e?void 0:e.findRecordStoreUIAncestor((n=>n instanceof A.G&&n.isCollectionView()&&(t||n.id!==e.id))).ancestor}function Me(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Te(e,t);if(n)return x.R.findCollectionViewBlockFromId(n.id)}function Pe(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Me(e,t);if(null!=n&&n.collectionContextStore)return n.collectionContextStore}function Ae(e){var t;let{environment:n,collectionContextStore:o}=e;const i=(0,B.zq)(n),{currentUserStore:r}=M.default.state;return!!r&&i&&(o.permissionScopes.state.canEditContent||"collectionTypedView"===o.contextType)&&"table"===(null===(t=o.collectionViewStore())||void 0===t?void 0:t.getType())}function Re(e,t){let n=t;return e.every((e=>{if(e.getType()===i.Ti.page||e.getType()===i.Ti.collectionViewPage){var t;const o=null===(t=Me(e,!1))||void 0===t?void 0:t.props.store.id;return!!o&&(void 0===n&&(n=o),o===n)}return!1}))}function De(e,t){return!e&&"table"===t}function Be(e){return void 0!==e&&e>=0}function Ee(e){return Be(e)?e+1:0}const Fe=(0,k.defineMessages)({board:{id:"database.collectionView.untitledName.board",defaultMessage:"Board"},gallery:{id:"database.collectionView.untitledName.gallery",defaultMessage:"Gallery"},timeline:{id:"database.collectionView.untitledName.timeline",defaultMessage:"Timeline"},calendar:{id:"database.collectionView.untitledName.calendar",defaultMessage:"Calendar"},list:{id:"database.collectionView.untitledName.list",defaultMessage:"List"},table:{id:"database.collectionView.untitledName.table",defaultMessage:"Table"},page:{id:"database.collectionView.untitledName.page",defaultMessage:"Page"}});function Ze(e){let{store:t,collectionContextStore:n}=e;return"collectionVirtualView"===n.contextType?n.collectionStore():t.getAssociatedCollectionStore()}},77181:(e,t,n)=>{n.d(t,{A7:()=>x,Af:()=>P,Av:()=>S,CJ:()=>w,F0:()=>v,Hw:()=>h,JR:()=>F,Ns:()=>T,OW:()=>y,SM:()=>M,T2:()=>j,bX:()=>_,fd:()=>E,g0:()=>Z,gY:()=>g,jA:()=>b,kC:()=>I,uU:()=>D,wP:()=>L,xb:()=>k,yU:()=>R,yr:()=>C,zV:()=>A});n(57658);var o=n(76205),i=n(99036),r=n(80951),a=n(60246),s=n(42875),l=n(72126),c=n(95371),d=n(95802),u=n(35661),p=n(28020),m=n(78316),f=n(33929);const g=4,h=24,v=10;function b(e){const t=e.normalizedFormatStore.state.collection_view_subitem,n=e.collectionStore();if(!n||!n.getSchema()||!t)return;const o=n.getSchema()[t.property];if(!o||"relation"!==o.type||i.F0(o)!==n.id)return;const r=o.property;if(!r)return;const a=n.getSchema()[r];return a&&"relation"===a.type?{...t,inverse:r}:void 0}function y(e){var t,n;const o=null===(t=e.collectionStore())||void 0===t?void 0:t.getFormat().collection_default_subitem,r=null===(n=e.collectionViewStore())||void 0===n||null===(n=n.getFormat().collection_view_subitem)||void 0===n?void 0:n.display_mode,a=e.collectionStore();if(!a||!a.getSchema()||!o)return;const s=a.getSchema()[o];if(!s||"relation"!==s.type||i.F0(s)!==a.id)return;const l=s.property;if(!l)return;const c=a.getSchema()[l];return c&&"relation"===c.type?{property:o,inverse:l,display_mode:r}:void 0}function S(e){return"table"===e||"timeline"===e||"list"===e}function _(e){var t;const n=(0,m.fm)(e),o=null==n||null===(t=n.collectionViewStore())||void 0===t?void 0:t.getType();return Boolean((null==n?void 0:n.currentSubitemFormatStore.state)&&o&&S(o))}function w(e){const{store:t,subitemFormat:n,propertySchema:o}=e,i=t.getPropertyValue(n.property),a=(0,r.rq)(i),s=t.getRecordModel;return r.j$({relationValue:a,propertySchema:o,getRecordModel:s})}function k(e){const{store:t,subitemFormat:n,propertySchema:o}=e,i=t.getPropertyValue(n.inverse),a=(0,r.rq)(i),s=t.getRecordModel;return r.j$({relationValue:a,propertySchema:o,getRecordModel:s})}function I(e){const{store:t,collectionStore:n,collectionContextStore:i,subitemFormat:r,subitemPathKey:a,propertyFilters:l,combinatorFilter:c,currentUserId:d}=e,m=n.getSchema()[r.property];if(!m||"relation"!==m.type)return[];const g=w({store:t,subitemFormat:r,propertySchema:m});if(0===g.length)return[];let h=g.filter((e=>!a.includes(e.id))).map((e=>u.G.createChildStore(t,e)));const v=i.relativeVariableStore.state,b={schema:i.normalizedSchemaStore.state,userId:d,userTimeZone:(0,s.r)(),userStartOfWeek:p.AK.state,intl:f.default.getIntl(),relativeVariableResult:v};if(l&&l.length>0||c){const e=(0,o.q)({filter:{filters:c?[...l.filter((e=>!(0,o.Oo)(e.filter))).map((e=>e.filter)),c]:l.filter((e=>!(0,o.Oo)(e.filter))).map((e=>e.filter)),operator:"and"},context:b});h=h.filter((t=>B({blockStore:t,compiledFilter:e,subitemFormat:r,propertySchema:m,visitedIds:new Set})))}return h}function C(e,t){var n,o;const r=e.currentSubitemFormatStore.state;if(!r)return new c.DG([]);const d=e.collectionStore();if(!d)return new c.DG([]);const u=e.currentSortsStore.state,p=d.getRecordModel,m=a.$m({userTimeZone:(0,s.r)(),intl:f.default.getIntl(),userSorts:u,userId:e.getCurrentUserId(),apiSorts:[]}),g=e.normalizedSchemaStore.state[r.property],h=g&&"relation"===g.type&&i.F0(g)===(null===(n=e.collectionStore())||void 0===n?void 0:n.id)&&g.property,v=null===(o=e.collectionViewStore())||void 0===o?void 0:o.getType(),b=!h||v&&S(v)?void 0:{property:h,filter:{operator:"is_empty"}},y=[...b&&h?[{id:h,filter:b}]:[],...e.currentPropertyFiltersStore.state],_=e.currentCombinatorFilterStore.state,w=e.subitemExpandedStore.state,k=l.xH(e.groupsStore.getAllGroupStates().map((e=>e.resultsStore.state)));return new c.DG(k.map((n=>{const o=M(n);return(0,c.MW)(o,(n=>{let{store:o,pathKey:i}=n;const s=w.get(i);if(!s)return{value:{store:o,pathKey:i},children:[]};const c=function(e){const{store:t,collectionStore:n,collectionContextStore:o,subitemFormat:i,querySorts:r,limit:s,subitemPathKey:c,propertyFilters:d,combinatorFilter:u,currentUserId:p,getRecordModel:m}=e,f=I({store:t,collectionStore:n,collectionContextStore:o,subitemFormat:i,subitemPathKey:c,propertyFilters:d,combinatorFilter:u,currentUserId:p});if(!f)return[];const g=new a.EO([...r,...a.Xm(f.map((e=>e.id))??[])]);f.forEach((e=>{g.updateBlock({block:e.getModel(),schema:n.getSchema(),propertyMapping:void 0,getRecordModel:m})}));const h=f.map((e=>e.id))??[],v=a.Qx(h,g),b={};return v.forEach(((e,t)=>{b[e]=t})),l.MR(f,(e=>b[e.id])).slice(0,s)}({store:o,collectionStore:d,collectionContextStore:e,subitemFormat:r,querySorts:m,limit:s.limit,subitemPathKey:i,propertyFilters:y,combinatorFilter:_,currentUserId:t,getRecordModel:p}).map((e=>({store:e,pathKey:A(i,e)})));return{value:{store:o,pathKey:i},children:c}}))})))}function x(e,t){const n=e?[e]:[],o=t.groupsStore.getGroupState(n);if(!o)return[];const i=o.resultsStore.state;if(!t.currentSubitemFormatStore.state)return i;const r=[],a=t.subitemTreeStore.state;for(const s of a.children)R({results:r,tree:s});return r}function T(e){return(0,c.CY)(e.children[e.children.length-1])}function M(e){return{store:e,pathKey:P([e.pointer])}}function P(e){return e.map((e=>e.id)).join(",")}function A(e,t){return e?`${e},${t.id}`:t.id}function R(e){const{results:t,tree:n}=e;t.push(n.value.store);for(const o of n.children)R({results:t,tree:o})}function D(e){var t,n;const{block:o,collectionContextStore:a}=e,s=null==a||null===(t=a.currentSubitemFormatStore.state)||void 0===t?void 0:t.inverse;if(!s)return!1;const l=a.normalizedSchemaStore.state[s];if(!l||!(0,i.p_)(l))return!1;const c=null===(n=a.collectionViewBlockStore())||void 0===n?void 0:n.getRecordModel;if(!c)return!1;return(0,r.Ds)({block:o,propertySchema:l,getRecordModel:c}).length>0}function B(e){const{blockStore:t,compiledFilter:n,subitemFormat:o,propertySchema:i,visitedIds:r}=e;r.add(t.id);const a=t.getModel();if(!a)return!1;if(n({block:a,getRecordModel:t.getRecordModel,propertyMapping:void 0}))return!0;const s=w({store:t,subitemFormat:o,propertySchema:i});return 0!==s.length&&s.map((e=>u.G.createChildStore(t,e))).filter((e=>!r.has(e.id))).some((e=>B({blockStore:e,compiledFilter:n,subitemFormat:o,propertySchema:i,visitedIds:r})))}async function E(e){const{blockStore:t,compiledFilter:n,subitemFormat:o,propertySchema:i,subitemExpandedStore:a,pathKey:s,forceStoresToLoad:l,visitedIds:c}=e;if(await t.load(),c.has(t.id))return;c.add(t.id);const d=l?await async function(e){const{store:t,subitemFormat:n,propertySchema:o}=e,i=t.getPropertyValue(n.property),a=(0,r.rq)(i);await Promise.all(a.map((e=>u.G.createChildStore(t,e).load())));const s=t.getRecordModel;return r.j$({relationValue:a,propertySchema:o,getRecordModel:s})}({store:t,subitemFormat:o,propertySchema:i}):w({store:t,subitemFormat:o,propertySchema:i});if(0===d.length)return;a.state.set(s,{isExpanded:!0,limit:20});const p={};for(const r of d){const e=u.G.createChildStore(t,r),d=e.getModel();if(!d)continue;n({block:d,getRecordModel:e.getRecordModel,propertyMapping:void 0,resultCache:p})||await E({blockStore:e,compiledFilter:n,subitemFormat:o,propertySchema:i,subitemExpandedStore:a,pathKey:A(s,e),forceStoresToLoad:l,visitedIds:c})}}function F(e){if(!e.collectionStore())return;const t=e.currentSubitemFormatStore.state,n=e.normalizedSchemaStore.state,o=(null==t?void 0:t.inverse)&&n[t.inverse],r=(null==t?void 0:t.property)&&n[t.property];if(!(r&&(0,i.p_)(r)&&o&&(0,i.p_)(o)))return;const a=o.property,s=r.property;return a&&s?{childRelationProperty:a,parentRelationProperty:s,childRelationSchema:o,parentRelationSchema:r,subitemFormat:t}:void 0}function Z(e){const t=(0,m.fm)(e);if(t)return F(t)}function L(e){if(!e.isType("page"))return!1;const t=(0,m.fm)(e);if(!t)return!1;return!!t.collectionStore()&&Boolean(t.currentSubitemFormatStore.state)}function j(e){let{blocks:t,parentRelationProperty:n,parentRelationSchema:o,collectionViewBlockStore:i}=e;const a=new Set;for(const r of t)a.add(r.id);return l.xH(t.map((e=>{const t=(e=>{const t=e.getPropertyValue(n);return r.j$({relationValue:r.rq(t),propertySchema:o,getRecordModel:e.getRecordModel})})(e),s=t.map((e=>e.id));if(0===t.length)return[u.G.createChildStore(i,e.pointer)];return d.C.findAllSelectablesFromIds(s.filter((e=>!a.has(e)))).map((e=>e.props.store)).map((t=>u.G.createChildStore(t,e.pointer)))})))}},43224:(e,t,n)=>{n.d(t,{F:()=>o,p:()=>i});const o={maxWidth:280,width:"max-content",overflowWrap:"break-word",textWrap:"wrap"},i=200},26991:(e,t,n)=>{n.d(t,{As:()=>u,Sh:()=>d,ki:()=>m,qf:()=>p});var o=n(76205),i=n(99036),r=n(23014),a=n(21202),s=n(6287),l=n(35661),c=n(29376);function d(e,t){return(0,r.oN)(e,t)}function u(e,t,n,o){const i=e.relativeVariableStore.state;if(i){const e=i[n.id],r=null==e?void 0:e[t];if(r){return l.G.createChildStore(o,{table:a.iU,id:r,spaceId:n.spaceId})}}}function p(e,t){if((0,o.e)(e.filter)){if(((0,o.vR)(e.filter)?(0,o.YO)(e.filter):[]).some((e=>"relative"===e.type)))return function(e,t){const n=t.getSchema()[e];return!(!n||!(0,i.p_)(n))&&(0,r.oN)((0,c.uJ)(n,t),(0,c.ke)(n,t))}(e.property,t)}return!0}function m(e,t,n){return!!e&&Object.values(e).some((e=>{if("groups"===e.type&&"relation"===e.groupBy.type){const o=e.groupBy.property,i=t[o];if(i.collection_pointer){const e=l.NW.createChildStore(n,{table:s.v,id:i.collection_pointer.id}),t=e.getFormat().app_config_uri;return t&&r.qB[t]&&e.isDefined()&&(0,r.oN)(e.getSchema(),t)}}return!1}))}},78175:(e,t,n)=>{n.d(t,{Po:()=>l,hF:()=>a,zE:()=>s});n(95477);var o=n(78316),i=n(77080),r=n(88923);function a(e){let t=e;for(;t&&(!t||!t.isNavigableBlock());){if("column"===t.getType())return!0;t=t.getParentBlockStore()}return!1}function s(e,t){const{device:n}=t;if(n.isPhone)return!1;if((0,o.en)(e)){return r.default.getSidePeekWidth(t.WindowSizeStore.state.width)>=r.sidePeekNoColumnWidth}return!0}function l(e,t){return!t.device.isMobile&&("on"===i.default.getGroup("columns-full-width")&&(e.isType("column_list")&&e.isChildOfRecordStoreUIRoot()&&s(e,t)&&!(null!==(n=e.getParentBlockStore())&&void 0!==n&&n.isFullWidth())&&!(0,o.en)(e)));var n}},78663:(e,t,n)=>{n.d(t,{$W:()=>m,FD:()=>g,Fu:()=>h,Xc:()=>f});var o=n(72126),i=n(97880),r=n(57819),a=n(30793),s=n(28685),l=n(35661),c=n(27724),d=n(24666),u=n(33929),p=n(73959);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.getIntl();if("helpMeEdit"===e.key||"helpMeDraft"===e.key||"helpMeWrite"===e.key){var n;const o=null===(n=e.steps)||void 0===n?void 0:n[0],i="text"===(null==o?void 0:o.type)&&o.prefilledValue;return i?t.formatMessage({id:"completionPopup.prefilledValue",defaultMessage:"Write about {prefilledValue} "},{prefilledValue:i}):""}if(!(0,a.TE)(e.key))return"";switch(e.key){case"brainstormIdeas":return t.formatMessage({id:"completionPopup.brainStorm.prefilledValue",defaultMessage:"Brainstorm ideas on "});case"blogPost":return t.formatMessage({id:"completionPopup.blogPost.prefilledValue",defaultMessage:"Write a blog post about "});case"outline":return t.formatMessage({id:"completionPopup.outline.prefilledValue",defaultMessage:"Write an outline about "});case"socialMediaPost":return t.formatMessage({id:"completionPopup.socialMediaPost.prefilledValue",defaultMessage:"Write a social media post about "});case"pressRelease":return t.formatMessage({id:"completionPopup.pressRelease.prefilledValue",defaultMessage:"Write a press release about "});case"creativeStory":return t.formatMessage({id:"completionPopup.creativeStory.prefilledValue",defaultMessage:"Write a creative story about "});case"essay":return t.formatMessage({id:"completionPopup.essay.prefilledValue",defaultMessage:"Write an essay about "});case"poem":return t.formatMessage({id:"completionPopup.poem.prefilledValue",defaultMessage:"Write a poem about "});case"todoList":return t.formatMessage({id:"completionPopup.todoList.prefilledValue",defaultMessage:"Write a todo list about "});case"meetingAgenda":return t.formatMessage({id:"completionPopup.meetingAgenda.prefilledValue",defaultMessage:"Write a meeting agenda about "});case"prosConsList":return t.formatMessage({id:"completionPopup.prosConsList.prefilledValue",defaultMessage:"Write a pros and cons list about "});case"jobDescription":return t.formatMessage({id:"completionPopup.jobDescription.prefilledValue",defaultMessage:"Write a job description about "});case"salesEmail":return t.formatMessage({id:"completionPopup.salesEmail.prefilledValue",defaultMessage:"Write a sales email about "});case"recruitingEmail":return t.formatMessage({id:"completionPopup.recruitingEmail.prefilledValue",defaultMessage:"Write a recruiting email about "});default:(0,i.t1)(e.key)}}function f(){const{stores:e}=c.default.state,t=e[0],n=o.Z$(e),i=t?t.getRecordStoreUIRoot():void 0;if(i&&i instanceof l.G&&n){return{type:"blockSelection",stores:e,currentPage:i,origin:n,scrollerStore:(0,r.Dj)(i)}}}function g(){const e=d.default.state;if("editing"!==e.mode)return;const t=e.multiSelection,n=t.start.store,o=n.getRecordStoreUIRoot(),i=s.E.findNodeFromStore(n),a=(0,p.sQ)(n),c=null==a?void 0:a.getRecordStoreUIParent(),u=(0,r.Dj)(o),m=a&&a instanceof l.G&&a!==o?a:void 0,f=m??i;if(!(o&&o instanceof l.G&&f))return;return{type:"cursor",textSelection:t,currentPage:o,currentBlock:m,origin:f,currentParent:c,scrollerStore:u,isPageTitle:o.id===n.id}}function h(){const{stores:e}=c.default.state,t=d.default.state,n="empty"!==t.mode?t.multiSelection:void 0,o="empty"!==t.mode?t.multiSelection.start.store:void 0,i=o?o.getRecordStoreUIRoot():void 0;if(n&&i&&i instanceof l.G){const t=(0,p.sQ)(n.end.store),o=null==t?void 0:t.getRecordStoreUIParent(),a=(0,r.Dj)(i);if(t&&o){return{type:"textSelection",stores:e,textSelection:n,currentPage:i,origin:t,endBlock:t,endBlockParent:o,scrollerStore:a}}}}},19124:(e,t,n)=>{n.d(t,{AC:()=>B,E8:()=>F,Fk:()=>Z,G9:()=>k,GD:()=>x,Gw:()=>E,It:()=>S,KZ:()=>A,RT:()=>M,Zt:()=>T,eL:()=>_,hu:()=>R,mX:()=>D,q:()=>P,qB:()=>w,z1:()=>I});var o=n(94568),i=n(38823),r=n(8848),a=n(52897),s=n(12970),l=n(91856),c=n(11751),d=n(72126),u=n(5366),p=(n(95477),n(80444)),m=n(21273),f=n(77080),g=n(88923),h=n(83212),v=n(85957),b=n(38755);const y=(0,u.defineMessages)({helpMeWrite:{defaultMessage:"Ask AI to write...",id:"id.completions.helpMeWrite"},helpMeWritePlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "5 reasons why we should hire a dedicated designer"',id:"id.completions.helpMeWritePlaceholder"},helpMeDraftPlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "article about the benefits of learning a new language"',id:"id.completions.helpMeDraftPlaceholder"},summarize:{defaultMessage:"Summarize",id:"id.completions.summarize"},findActionItems:{defaultMessage:"Find action items",id:"id.completions.findActionItems"},summarizeMeetingTranscript:{id:"id.completions.summarizeMeetingTranscript",defaultMessage:"Summarize meeting"}}),S={key:"helpMeWrite",category:"writeWithAI",name:y.helpMeWrite,svg:c.t,svgFill:r.FN.light.purple[400],requiresContent:!0,steps:[{key:"prompt",name:y.helpMeWritePlaceholder,placeholder:y.helpMeWritePlaceholder,type:"text"}]},_={key:"helpMeDraft",category:"draftWithAI",name:y.helpMeWrite,svg:c.t,svgFill:r.FN.light.purple[400],requiresNoContent:!0,steps:[{key:"prompt",name:y.helpMeDraftPlaceholder,placeholder:y.helpMeDraftPlaceholder,type:"text"}]};function w(e){const{customPrompt:t,isPageEmpty:n}=e;return{key:n?"helpMeDraft":"helpMeWrite",category:"writeWithAI",name:y.helpMeWrite,svg:a.d,svgFill:r.FN.light.purple[400],steps:[{key:"prompt",name:y.helpMeWritePlaceholder,placeholder:y.helpMeWritePlaceholder,type:"text",prefilledValue:t}]}}function k(){return[{key:"summarize",category:"extractFromContent",name:y.summarize,svg:l.Y,svgFill:r.FN.light.purple[400]},{key:"findActionItems",category:"extractFromContent",name:y.findActionItems,svg:s.O,svgFill:r.FN.light.purple[400]},S]}function I(){return d.KX(k(),"key")}function C(){const e=p.default.state.currentSpaceStore;return!!e&&e.isAiEnabledOnSpace()}function x(e){if(f.default.checkGate("disable_ai_big_red_button"))return!1;const t=p.default.state.currentSpaceStore;if((0,b.Cx)(t))return!1;const n=null==t?void 0:t.canRead();return!(e&&e.hasPublicPermission&&!n)&&(!(g.default.isMiniPeekOpen()&&!(0,v.yT)())&&C())}function T(e){return C()&&f.default.checkGate("ai_property_autofill_v2")}function M(e,t){return x(e)&&f.default.checkGate("ai_property_autofill_v2")&&t.canEdit()}function P(){return f.default.checkGate("autotag_ambient_trigger")}function A(){return f.default.checkGate("autofill_tags")}function R(){return f.default.checkGate("autofill_translate")}function D(e,t,n){return x(t)&&f.default.checkGate("ai_property_autofill_v2")&&n.canEditCollection()}function B(e){m.Z.setState(new i.m({getEligibleGroup:e=>f.default.getEligibleGroup({experimentId:e}),isAiEnabled:()=>{const t=p.default.state.mainEditorCurrentBlockStore;return x(t&&h.Z.getMode(e,t))}}))}function E(){var e;return(null===(e=p.default.state.currentSpaceStore)||void 0===e?void 0:e.id)===o.vj}function F(){var e;return(null===(e=p.default.state.currentSpaceStore)||void 0===e?void 0:e.id)===o.vj}function Z(e){return f.default.checkGate("search_modal_qna")||m.Z.shouldShowQnaInSearchOnly()||!0===e}},53323:(e,t,n)=>{n.d(t,{L:()=>s,n:()=>l});var o=n(63143),i=n(88632),r=n(99757);const a=1*o.hM;function s(){var e;if(i.Z.state.online){if(null!==(e=r.Z.state.connectionError)&&void 0!==e&&e.startTime){var t;if(Date.now()-(null===(t=r.Z.state.connectionError)||void 0===t?void 0:t.startTime)<a)return}return r.Z.state.connectionError}}function l(){return Boolean(s())}},46150:(e,t,n)=>{n.d(t,{C7:()=>m,D1:()=>v,G0:()=>u,GF:()=>r,GZ:()=>s,HM:()=>l,X1:()=>g,_F:()=>c,eD:()=>p,g4:()=>h,xp:()=>b});var o=n(62619);const i="data-content-editable-leaf",r={[i]:!0},a="data-content-editable-root",s={[a]:!0},l="data-content-editable-selecting",c="data-content-editable-composing",d="data-content-editable-void",u={[d]:!0};function p(e){return o.kK(e)&&e.hasAttribute(i)}function m(e){return Boolean(o.kK(e)&&e.querySelector("[data-content-editable-leaf]"))}function f(e){return o.kK(e)&&e.hasAttribute(a)}function g(e){return o.sh(e,p)}function h(e,t){return e.parentElement===t?e:o.sh(e,(e=>e.parentElement===t))||e}function v(e,t){if(!e||!t)return!1;const n=b(e),o=b(t);return Boolean(n&&n===o)}function b(e){const t=o.sh(e,(e=>f(e)||function(e){return o.kK(e)&&e.hasAttribute(d)}(e)));if(t&&f(t))return t}},40959:(e,t,n)=>{n.d(t,{Hc:()=>k,MU:()=>w,O5:()=>I});var o=n(1302),i=n(41892),r=n(41432),a=n(45953),s=n(21202),l=n(5366),c=n(98104),d=n(33929),u=n(95802),p=n(21273),m=n(19037),f=n(42),g=n(4708),h=n(78175),v=n(19124),b=n(68056),y=n(73959),S=n(89086);const _=(0,l.defineMessages)({textTitle:{id:"newBlock.text.title",defaultMessage:"Text"},textDescription:{id:"newBlock.text.description",defaultMessage:"Just start writing with plain text."},textKeywords:{id:"newBlock.text.fuzzySearchKeywords",defaultMessage:"Plain Text"},pageTitle:{id:"newBlock.page.title",defaultMessage:"Page"},pageDescription:{id:"newBlock.page.description",defaultMessage:"Embed a sub-page inside this page."},pageKeywords:{id:"newBlock.page.fuzzySearchKeywords",defaultMessage:"Page"},linkToPageTitle:{id:"newBlock.linkToPage.title",defaultMessage:"Link to page"},linkToPageDescription:{id:"newBlock.linkToPage.description",defaultMessage:"Link to an existing page."},linkToPageKeywords:{id:"newBlock.linkToPage.fuzzySearchKeywords",defaultMessage:"Link to page ltp"},linkedDatabaseDescription:{id:"newBlock.linkToCollection.description",defaultMessage:"Add an existing database to this page."},transclusionContainerTitle:{id:"newBlock.transclusionContainer.title",defaultMessage:"Synced block"},transclusionContainerDescription:{id:"newBlock.transclusionContainer.description",defaultMessage:"Sync content across pages."},transclusionContainerKeywords:{id:"newBlock.transclusionContainer.fuzzySearchKeywords",defaultMessage:"Create synced block reference transclusion portal block embed group"},toDoTitle:{id:"newBlock.toDo.title",defaultMessage:"To-do list"},toDoDescription:{id:"newBlock.toDo.description",defaultMessage:"Track tasks with a to-do list."},toDoKeywords:{id:"newBlock.toDo.fuzzySearchKeywords",defaultMessage:"Todo To-Do Checkbox List"},headerTitle:{id:"newBlock.header.title",defaultMessage:"Heading 1"},headerDescription:{id:"newBlock.header.description",defaultMessage:"Big section heading."},headerKeywords:{id:"newBlock.header.fuzzySearchKeywords",defaultMessage:"Heading 1 # h1"},subHeaderTitle:{id:"newBlock.subHeader.title",defaultMessage:"Heading 2"},subHeaderDescription:{id:"newBlock.subHeader.description",defaultMessage:"Medium section heading."},subHeaderKeywords:{id:"newBlock.subHeader.fuzzySearchKeywords",defaultMessage:"sub heading 2 ## h2 two"},subSubHeaderTitle:{id:"newBlock.subSubHeader.title",defaultMessage:"Heading 3"},subSubHeaderDescription:{id:"newBlock.subSubHeader.description",defaultMessage:"Small section heading."},subSubHeaderKeywords:{id:"newBlock.subSubHeader.fuzzySearchKeywords",defaultMessage:"subsub heading 3 ### h3 three"},imageTitle:{id:"newBlock.image.title",defaultMessage:"Image"},imageDescription:{id:"newBlock.image.description",defaultMessage:"Upload or embed with a link."},imageKeywords:{id:"newBlock.image.fuzzySearchKeywords",defaultMessage:"Image Picture Gif Giphy"},bookmarkTitle:{id:"newBlock.bookmark.title",defaultMessage:"Web bookmark"},bookmarkDescription:{id:"newBlock.bookmark.description",defaultMessage:"Save a link as a visual bookmark."},bookmarkKeywords:{id:"newBlock.bookmark.fuzzySearchKeywords",defaultMessage:"Web Link Bookmark"},dividerTitle:{id:"newBlock.divider.title",defaultMessage:"Divider"},dividerDescription:{id:"newBlock.divider.description",defaultMessage:"Visually divide blocks."},dividerKeywords:{id:"newBlock.divider.fuzzySearchKeywords",defaultMessage:"Horizontal Rule Divider --- —-"},codeTitle:{id:"newBlock.code.title",defaultMessage:"Code"},codeDescription:{id:"newBlock.code.description",defaultMessage:"Capture a code snippet."},codeKeywords:{id:"newBlock.code.fuzzySearchKeywords",defaultMessage:"Code ```"},quoteTitle:{id:"newBlock.quote.title",defaultMessage:"Quote"},quoteDescription:{id:"newBlock.quote.description",defaultMessage:"Capture a quote."},quoteKeywords:{id:"newBlock.quote.fuzzySearchKeywords",defaultMessage:"Quote"},bulletedListTitle:{id:"newBlock.bulletedList.title",defaultMessage:"Bulleted list"},bulletedListDescription:{id:"newBlock.bulletedList.description",defaultMessage:"Create a simple bulleted list."},bulletedListKeywords:{id:"newBlock.bulletedList.fuzzySearchKeywords",defaultMessage:"Bulleted Unordered List"},numberedListTitle:{id:"newBlock.numberedList.title",defaultMessage:"Numbered list"},numberedListDescription:{id:"newBlock.numberedList.description",defaultMessage:"Create a list with numbering."},numberedListKeywords:{id:"newBlock.numberedList.fuzzySearchKeywords",defaultMessage:"Numbered Ordered List"},toggleTitle:{id:"newBlock.toggle.title",defaultMessage:"Toggle list"},toggleDescription:{id:"newBlock.toggle.description",defaultMessage:"Toggles can hide and show content inside."},toggleKeywords:{id:"newBlock.toggle.fuzzySearchKeywords",defaultMessage:"Toggle list"},fileTitle:{id:"newBlock.file.title",defaultMessage:"File"},fileDescription:{id:"newBlock.file.description",defaultMessage:"Upload or embed with a link."},fileKeywords:{id:"newBlock.file.fuzzySearchKeywords",defaultMessage:"File upload attach"},videoTitle:{id:"newBlock.video.title",defaultMessage:"Video"},videoDescription:{id:"newBlock.video.description",defaultMessage:"Embed from YouTube, Vimeo..."},videoKeywords:{id:"newBlock.video.fuzzySearchKeywords",defaultMessage:"Video"},audioTitle:{id:"newBlock.audio.title",defaultMessage:"Audio"},audioDescription:{id:"newBlock.audio.description",defaultMessage:"Embed from SoundCloud, Spotify..."},audioKeywords:{id:"newBlock.audio.fuzzySearchKeywords",defaultMessage:"Audio Sound Music"},embedTitle:{id:"newBlock.embed.title",defaultMessage:"Embed"},embedDescription:{id:"newBlock.embed.description",defaultMessage:"For PDFs, Google Maps, and more."},embedKeywords:{id:"newBlock.embed.fuzzySearchKeywords",defaultMessage:"Embed iFrame"},driveTitle:{id:"newBlock.drive.title",defaultMessage:"Google Drive"},driveDescription:{id:"newBlock.drive.description",defaultMessage:"Embed a Google Doc, Google Sheet..."},driveKeywords:{id:"newBlock.drive.fuzzySearchKeywords",defaultMessage:"Google Drive"},figmaTitle:{id:"newBlock.figma.title",defaultMessage:"Figma"},figmaDescription:{id:"newBlock.figma.description",defaultMessage:"Embed a Figma file."},figmaKeywords:{id:"newBlock.figma.fuzzySearchKeywords",defaultMessage:"Figma"},loomTitle:{id:"newBlock.loom.title",defaultMessage:"Loom"},loomDescription:{id:"newBlock.loom.description",defaultMessage:"Embed a Loom recording."},loomKeywords:{id:"newBlock.loom.fuzzySearchKeywords",defaultMessage:"Loom"},typeformTitle:{id:"newBlock.typeform.title",defaultMessage:"Typeform"},typeformDescription:{id:"newBlock.typeform.description",defaultMessage:"Embed a Typeform."},typeformKeywords:{id:"newBlock.typeform.fuzzySearchKeywords",defaultMessage:"Typeform"},codepenTitle:{id:"newBlock.codepen.title",defaultMessage:"CodePen"},codepenDescription:{id:"newBlock.codepen.description",defaultMessage:"Embed a CodePen."},codepenKeywords:{id:"newBlock.codepen.fuzzySearchKeywords",defaultMessage:"CodePen"},tweetTitle:{id:"newBlock.tweet.title",defaultMessage:"Tweet"},tweetDescription:{id:"newBlock.tweet.description",defaultMessage:"Embed a Tweet."},tweetKeywords:{id:"newBlock.tweet.fuzzySearchKeywords",defaultMessage:"Tweet"},gistTitle:{id:"newBlock.gist.title",defaultMessage:"GitHub Gist"},gistDescription:{id:"newBlock.gist.description",defaultMessage:"Embed a Gist from GitHub."},gistKeywords:{id:"newBlock.gist.fuzzySearchKeywords",defaultMessage:"GitHub Gist"},mapsTitle:{id:"newBlock.maps.title",defaultMessage:"Google Maps"},mapsDescription:{id:"newBlock.maps.description",defaultMessage:"Embed a Google Map."},mapsKeywords:{id:"newBlock.maps.fuzzySearchKeywords",defaultMessage:"Google Maps"},framerTitle:{id:"newBlock.framer.title",defaultMessage:"Framer"},framerDescription:{id:"newBlock.framer.description",defaultMessage:"Embed a Framer prototype."},framerKeywords:{id:"newBlock.framer.fuzzySearchKeywords",defaultMessage:"Framer"},invisionTitle:{id:"newBlock.invision.title",defaultMessage:"Invision"},invisionDescription:{id:"newBlock.invision.description",defaultMessage:"Embed an Invision project."},invisionKeywords:{id:"newBlock.invision.fuzzySearchKeywords",defaultMessage:"Invision"},mixpanelTitle:{id:"newBlock.mixpanel.title",defaultMessage:"Mixpanel"},mixpanelDescription:{id:"newBlock.mixpanel.description",defaultMessage:"Embed a Mixpanel project."},mixpanelKeywords:{id:"newBlock.mixpanel.fuzzySearchKeywords",defaultMessage:"Mixpanel"},equationTitle:{id:"newBlock.equation.title",defaultMessage:"Block equation"},equationDescription:{id:"newBlock.equation.description",defaultMessage:"Display a standalone math equation."},equationKeywords:{id:"newBlock.equation.fuzzySearchKeywords",defaultMessage:"LaTeX Math Block Equation $$ Formula"},pdfTitle:{id:"newBlock.pdf.title",defaultMessage:"PDF"},pdfDescription:{id:"newBlock.pdf.description",defaultMessage:"Embed a PDF."},pdfKeywords:{id:"newBlock.pdf.fuzzySearchKeywords",defaultMessage:"PDF"},factoryTitle:{id:"newBlock.factory.title",defaultMessage:"Template button"},factoryDescription:{id:"newBlock.factory.description",defaultMessage:"Duplicate blocks with a click."},factoryKeywords:{id:"newBlock.factory.fuzzySearchKeywords",defaultMessage:"Template Duplicate Button"},buttonTitle:{id:"newBlock.button.title",defaultMessage:"Button"},buttonDescription:{id:"newBlock.button.description",defaultMessage:"Run custom automations with a click."},buttonKeywords:{id:"newBlock.button.fuzzySearchKeywords",defaultMessage:"Button automation template duplicate"},breadcrumbTitle:{id:"newBlock.breadcrumb.title",defaultMessage:"Breadcrumb"},breadcrumbDescription:{id:"newBlock.breadcrumb.description",defaultMessage:"Show the current page location."},breadcrumbKeywords:{id:"newBlock.breadcrumb.fuzzySearchKeywords",defaultMessage:"Breadcrumb"},calloutTitle:{id:"newBlock.callout.title",defaultMessage:"Callout"},calloutDescription:{id:"newBlock.callout.description",defaultMessage:"Make writing stand out."},calloutKeywords:{id:"newBlock.callout.fuzzySearchKeywords",defaultMessage:"Callout"},table_of_contentsTitle:{id:"newBlock.tableOfContents.title",defaultMessage:"Table of contents"},table_of_contentsDescription:{id:"newBlock.tableOfContents.description",defaultMessage:"Show an outline of your page."},table_of_contentsKeywords:{id:"newBlock.tableOfContents.fuzzySearchKeywords",defaultMessage:"TOC Table of Contents"},whimsicalTitle:{id:"newBlock.whimsical.title",defaultMessage:"Whimsical"},whimsicalDescription:{id:"newBlock.whimsical.description",defaultMessage:"Embed a Whimsical board."},whimsicalKeywords:{id:"newBlock.whimsical.fuzzySearchKeywords",defaultMessage:"Whimsical"},hexTitle:{id:"newBlock.hex.title",defaultMessage:"Hex"},hexDescription:{id:"newBlock.hex.description",defaultMessage:"Embed a Hex cell."},hexKeywords:{id:"newBlock.hex.fuzzySearchKeywords",defaultMessage:"Hex"},deepnoteTitle:{id:"newBlock.deepnote.title",defaultMessage:"Deepnote"},deepnoteDescription:{id:"newBlock.deepnote.description",defaultMessage:"Embed a Deepnote block."},deepnoteKeywords:{id:"newBlock.deepnote.fuzzySearchKeywords",defaultMessage:"Deepnote"},miroTitle:{id:"newBlock.miro.title",defaultMessage:"Miro"},miroDescription:{id:"newBlock.miro.description",defaultMessage:"Embed a Miro board."},miroKeywords:{id:"newBlock.miro.fuzzySearchKeywords",defaultMessage:"Miro"},abstractTitle:{id:"newBlock.abstract.title",defaultMessage:"Abstract"},abstractDescription:{id:"newBlock.abstract.description",defaultMessage:"Embed an Abstract project."},abstractKeywords:{id:"newBlock.abstract.fuzzySearchKeywords",defaultMessage:"Abstract"},sketchTitle:{id:"newBlock.sketch.title",defaultMessage:"Sketch"},sketchDescription:{id:"newBlock.sketch.description",defaultMessage:"Embed a Sketch document."},sketchKeywords:{id:"newBlock.sketch.fuzzySearchKeywords",defaultMessage:"Sketch"},excalidrawTitle:{id:"newBlock.excalidraw.title",defaultMessage:"Excalidraw"},excalidrawDescription:{id:"newBlock.excalidraw.description",defaultMessage:"Embed an Excalidraw whiteboard."},excalidrawKeywords:{id:"newBlock.excalidraw.fuzzySearchKeywords",defaultMessage:"Excalidraw"},replitTitle:{id:"newBlock.replit.title",defaultMessage:"Replit"},replitDescription:{id:"newBlock.replit.description",defaultMessage:"Embed a repl."},replitKeywords:{id:"newBlock.replit.fuzzySearchKeywords",defaultMessage:"Replit"},databaseTitle:{id:"newBlock.database.title",defaultMessage:"Database"},databaseDescription:{id:"newBlock.database.description",defaultMessage:"Create a new database."},inlineTimelineDatabaseTitle:{id:"newBlock.inlineTimelineDatabase.title",defaultMessage:"Timeline database - Inline"},inlineTimelineDatabaseDescription:{id:"newBlock.inlineTimelineDatabase.description",defaultMessage:"Add a Timeline database to this page."},inlineTimelineDatabaseKeywords:{id:"newBlock.inlineTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Inline"},fullPageTableDatabaseTitle:{id:"newBlock.fullPageTableDatabase.title",defaultMessage:"Table database - Full page"},fullPageTableDatabaseDescription:{id:"newBlock.fullPageTableDatabase.description",defaultMessage:"Add a Table database as a sub-page."},fullPageTableDatabaseKeywords:{id:"newBlock.fullPageTableDatabase.fuzzySearchKeywords",defaultMessage:"Table database - Full page"},fullPageBoardDatabaseTitle:{id:"newBlock.fullPageBoardDatabase.title",defaultMessage:"Board database - Full page"},fullPageBoardDatabaseDescription:{id:"newBlock.fullPageBoardDatabase.description",defaultMessage:"Add a Board database as a sub-page."},fullPageBoardDatabaseKeywords:{id:"newBlock.fullPageBoardDatabase.fuzzySearchKeywords",defaultMessage:"Board database - Full page"},fullPageGalleryDatabaseTitle:{id:"newBlock.fullPageGalleryDatabase.title",defaultMessage:"Gallery database - Full page"},fullPageGalleryDatabaseDescription:{id:"newBlock.fullPageGalleryDatabase.description",defaultMessage:"Add a Gallery database as a sub-page."},fullPageGalleryDatabaseKeywords:{id:"newBlock.fullPageGalleryDatabase.fuzzySearchKeywords",defaultMessage:"Gallery database - Full page"},fullPageListDatabaseTitle:{id:"newBlock.fullPageListDatabase.title",defaultMessage:"List database - Full page"},fullPageListDatabaseDescription:{id:"newBlock.fullPageListDatabase.description",defaultMessage:"Add a List database as a sub-page."},fullPageListDatabaseKeywords:{id:"newBlock.fullPageListDatabase.fuzzySearchKeywords",defaultMessage:"List database - Full page"},fullPageCalendarDatabaseTitle:{id:"newBlock.fullPageCalendarDatabase.title",defaultMessage:"Calendar database - Full page"},fullPageCalendarDatabaseDescription:{id:"newBlock.fullPageCalendarDatabase.description",defaultMessage:"Add a Calendar database as a sub-page."},fullPageCalendarDatabaseKeywords:{id:"newBlock.fullPageCalendarDatabase.fuzzySearchKeywords",defaultMessage:"Calendar database - Full page"},fullPageTimelineDatabaseTitle:{id:"newBlock.fullPageTimelineDatabase.title",defaultMessage:"Timeline database - Full page"},fullPageTimelineDatabaseDescription:{id:"newBlock.fullPageTimelineDatabase.description",defaultMessage:"Add a Timeline database as a sub-page."},fullPageTimelineDatabaseKeywords:{id:"newBlock.fullPageTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Full page"},simpleTableTitle:{id:"newBlock.simple_table.title",defaultMessage:"Table"},simpleTableDescription:{id:"newBlock.simple_table.description",defaultMessage:"Add simple tabular content to your page."},simpleTableKeywords:{id:"newBlock.simple_table.fuzzySearchKeywords",defaultMessage:"Table"},tabTitle:{id:"newBlock.tab.title",defaultMessage:"Tabs"},tabDescription:{id:"newBlock.tab.description",defaultMessage:"Organize content in tabs."},tabKeywords:{id:"newBlock.tab.keywords",defaultMessage:"tab tabs tabbed switch toggle"},toggleFormatHeaderTitle:{id:"newBlock.toggleFormatHeader.title",defaultMessage:"Toggle heading 1"},toggleFormatHeaderDescription:{id:"newBlock.toggleFormatHeader.description",defaultMessage:"Hide content inside a large heading."},toggleFormatHeaderKeywords:{id:"newBlock.toggleFormatHeader.fuzzySearchKeywords",defaultMessage:"toggle heading 1 # h1"},toggleFormatSubHeaderTitle:{id:"newBlock.toggleFormatSubHeader.title",defaultMessage:"Toggle heading 2"},toggleFormatSubHeaderDescription:{id:"newBlock.toggleFormatSubHeader.description",defaultMessage:"Hide content inside a medium heading."},toggleFormatSubHeaderKeywords:{id:"newBlock.toggleFormatSubHeader.fuzzySearchKeywords",defaultMessage:"toggle sub heading 2 ## h2 two"},toggleFormatSubSubHeaderTitle:{id:"newBlock.toggleFormatSubSubHeader.title",defaultMessage:"Toggle heading 3"},toggleFormatSubSubHeaderDescription:{id:"newBlock.toggleFormatSubSubHeader.description",defaultMessage:"Hide content inside a small heading."},toggleFormatSubSubHeaderKeywords:{id:"newBlock.toggleFormatSubSubHeader.fuzzySearchKeywords",defaultMessage:"toggle subsub heading 3 ### h3 three"},columnListTitle:{id:"newBlock.columnList.title",defaultMessage:"Columns"},columnListDescription:{id:"newBlock.columnList.description",defaultMessage:"Create columns of blocks."},columnListKeywords:{id:"newBlock.columnList.fuzzySearchKeywords",defaultMessage:"Create col column columns block vertical"},column2Title:{id:"newBlock.column2.title",defaultMessage:"2 columns"},column2Description:{id:"newBlock.column2.description",defaultMessage:"Create 2 columns of blocks."},column2Keywords:{id:"newBlock.column2.fuzzySearchKeywords",defaultMessage:"Create col c2 col2 columns block vertical 2col two"},column3Title:{id:"newBlock.column3.title",defaultMessage:"3 columns"},column3Description:{id:"newBlock.column3.description",defaultMessage:"Create 3 columns of blocks."},column3Keywords:{id:"newBlock.column3.fuzzySearchKeywords",defaultMessage:"c3 col3 column3 columns 3col three"},column4Title:{id:"newBlock.column4.title",defaultMessage:"4 columns"},column4Description:{id:"newBlock.column4.description",defaultMessage:"Create 4 columns of blocks."},column4Keywords:{id:"newBlock.column4.fuzzySearchKeywords",defaultMessage:"c4 col4 column4 columns 4col four"},column5Title:{id:"newBlock.column5.title",defaultMessage:"5 columns"},column5Description:{id:"newBlock.column5.description",defaultMessage:"Create 5 columns of blocks."},column5Keywords:{id:"newBlock.column5.fuzzySearchKeywords",defaultMessage:"c5 col5 column5 columns 5col five"},mermaidCodeTitle:{id:"newBlock.mermaidCode.title",defaultMessage:"Code - Mermaid"},mermaidCodeDescription:{id:"newBlock.mermaidCode.description",defaultMessage:"Create a diagram by writing code."},mermaidCodeKeywords:{id:"newBlock.mermaidCode.fuzzySearchKeywords",defaultMessage:"mermaid diagram graphviz flowchart code"},aiSummaryBlockTitle:{id:"newBlock.aiSummaryBlock.title",defaultMessage:"Summary"},aiSummaryBlockDescription:{id:"newBlock.aiSummaryBlock.description",defaultMessage:"Generate a summary for the current page."},aiSummaryKeywords:{id:"newBlock.aiSummaryBlock.fuzzySearchKeywords",defaultMessage:"summary ai"},aiActionItemsBlockTitle:{id:"newBlock.aiActionItemsBlock.title",defaultMessage:"Action items"},aiActionItemsDescription:{id:"newBlock.aiActionItemsBlock.description",defaultMessage:"Extract action items from current page."},aiActionItemsKeywords:{id:"newBlock.aiActionItemsBlock.fuzzySearchKeywords",defaultMessage:"find action items ai"},aiFreePromptBlockTitle:{id:"newBlock.aiFreePromptBlock.title",defaultMessage:"Custom AI Block"},aiFreePromptDescription:{id:"newBlock.aiFreePromptBlock.description",defaultMessage:"Generate content from any instruction."},aiFreePromptKeywords:{id:"newBlock.aiFreePromptBlock.fuzzySearchKeywords",defaultMessage:"ask help question prompt ai custom block content"},drawingTitle:{id:"newBlock.drawing.title",defaultMessage:"Drawing"},drawingDescription:{id:"newBlock.drawing.description",defaultMessage:"Draw and diagram on an infinite canvas."},drawingKeywords:{id:"newBlock.drawing.fuzzySearchKeywords",defaultMessage:"drawing diagram canvas illustration draw sketch tldraw doodle mindmap architecture paint pen"},aiSectionBlockTitle:{id:"newBlock.aiSection.title",defaultMessage:"AI Section"},aiSectionKeywords:{id:"newBlock.aiSection.fuzzySearchKeywords",defaultMessage:"ai section heading meeting note summary action items"}});function w(e){const{key:t,displayName:n,fuzzySearchKeywords:o,blockType:i,thumbnail:r,tooltipPhoto:l,description:c,createTemplate:u,shouldShow:p,badge:m,postCreateCallback:f,collectionViewType:g,isToggleable:h}=e,v=d.default.formatMessage(o),b=v!==o.defaultMessage?`${v} ${o.defaultMessage}`:v;return{key:t,displayName:d.default.formatMessage(n),analyticsName:n.defaultMessage,searchName:b,thumbnail:r,tooltipPhoto:l,description:c?d.default.formatMessage(c):void 0,templateRootBlockId:"root",blockType:i,createTemplate:u||(()=>a.Ao.create({[s.iU]:{root:{id:"root",type:i}}})),shouldShow:p,badge:m,postCreateCallback:f,collectionViewType:g,isToggleable:h}}const k={[r.Ti.text]:w({key:r.Ti.text,blockType:r.Ti.text,displayName:_.textTitle,fuzzySearchKeywords:_.textKeywords,thumbnail:i.Z.images.blocks.textPng,description:_.textDescription,tooltipPhoto:i.Z.images.tooltips.blocks.textPng}),[r.Ti.page]:w({key:r.Ti.page,blockType:r.Ti.page,displayName:_.pageTitle,fuzzySearchKeywords:_.pageKeywords,thumbnail:i.Z.images.blocks.pagePng,description:_.pageDescription,tooltipPhoto:i.Z.images.tooltips.blocks.pagePng}),[r.Ti.linkToPage]:w({key:r.Ti.linkToPage,blockType:r.Ti.linkToPage,displayName:_.linkToPageTitle,fuzzySearchKeywords:_.linkToPageKeywords,thumbnail:i.Z.images.blocks.linkPng,description:_.linkToPageDescription,tooltipPhoto:i.Z.images.tooltips.blocks.linkToPagePng}),[r.Ti.transclusionContainer]:w({key:r.Ti.transclusionContainer,blockType:r.Ti.transclusionContainer,displayName:_.transclusionContainerTitle,fuzzySearchKeywords:_.transclusionContainerKeywords,thumbnail:i.Z.images.blocks.transclusionPng,description:_.transclusionContainerDescription,tooltipPhoto:i.Z.images.tooltips.blocks.transclusionPng,shouldShow:e=>!(0,m.wT)(e),createTemplate:e=>f._Z()}),[r.Ti.toDo]:w({key:r.Ti.toDo,blockType:r.Ti.toDo,displayName:_.toDoTitle,fuzzySearchKeywords:_.toDoKeywords,thumbnail:i.Z.images.blocks.toDoPng,description:_.toDoDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toDoListPng}),[r.Ti.header]:w({key:r.Ti.header,blockType:r.Ti.header,displayName:_.headerTitle,fuzzySearchKeywords:_.headerKeywords,thumbnail:i.Z.images.blocks.headerPng,description:_.headerDescription,tooltipPhoto:i.Z.images.tooltips.blocks.headerPng}),[r.Ti.subHeader]:w({key:r.Ti.subHeader,blockType:r.Ti.subHeader,displayName:_.subHeaderTitle,fuzzySearchKeywords:_.subHeaderKeywords,thumbnail:i.Z.images.blocks.subheaderPng,description:_.subHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.subHeaderPng}),[r.Ti.subSubHeader]:w({key:r.Ti.subSubHeader,blockType:r.Ti.subSubHeader,displayName:_.subSubHeaderTitle,fuzzySearchKeywords:_.subSubHeaderKeywords,thumbnail:i.Z.images.blocks.subsubheaderPng,description:_.subSubHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.subsubheaderPng}),[r.Ti.image]:w({key:r.Ti.image,blockType:r.Ti.image,displayName:_.imageTitle,fuzzySearchKeywords:_.imageKeywords,description:_.imageDescription,tooltipPhoto:i.Z.images.tooltips.blocks.imagePng,thumbnail:i.Z.images.blocks.imagePng}),[r.Ti.bookmark]:w({key:r.Ti.bookmark,blockType:r.Ti.bookmark,displayName:_.bookmarkTitle,fuzzySearchKeywords:_.bookmarkKeywords,thumbnail:i.Z.images.blocks.webBookmarkPng,description:_.bookmarkDescription,tooltipPhoto:i.Z.images.tooltips.blocks.webBookmarkPng}),[r.Ti.divider]:w({key:r.Ti.divider,blockType:r.Ti.divider,displayName:_.dividerTitle,fuzzySearchKeywords:_.dividerKeywords,thumbnail:i.Z.images.blocks.dividerPng,description:_.dividerDescription,tooltipPhoto:i.Z.images.tooltips.blocks.dividerPng}),[r.Ti.code]:w({key:r.Ti.code,blockType:r.Ti.code,displayName:_.codeTitle,fuzzySearchKeywords:_.codeKeywords,thumbnail:i.Z.images.blocks.codePng,description:_.codeDescription,tooltipPhoto:i.Z.images.tooltips.blocks.codePng}),[r.Ti.quote]:w({key:r.Ti.quote,blockType:r.Ti.quote,displayName:_.quoteTitle,fuzzySearchKeywords:_.quoteKeywords,thumbnail:i.Z.images.blocks.quotePng,description:_.quoteDescription,tooltipPhoto:i.Z.images.tooltips.blocks.quotePng}),[r.Ti.bulletedList]:w({key:r.Ti.bulletedList,blockType:r.Ti.bulletedList,displayName:_.bulletedListTitle,fuzzySearchKeywords:_.bulletedListKeywords,thumbnail:i.Z.images.blocks.bulletedListPng,description:_.bulletedListDescription,tooltipPhoto:i.Z.images.tooltips.blocks.bulletedListPng}),[r.Ti.numberedList]:w({key:r.Ti.numberedList,blockType:r.Ti.numberedList,displayName:_.numberedListTitle,fuzzySearchKeywords:_.numberedListKeywords,thumbnail:i.Z.images.blocks.numberedListPng,description:_.numberedListDescription,tooltipPhoto:i.Z.images.tooltips.blocks.numberedListPng}),[r.Ti.toggle]:w({key:r.Ti.toggle,blockType:r.Ti.toggle,displayName:_.toggleTitle,fuzzySearchKeywords:_.toggleKeywords,thumbnail:i.Z.images.blocks.togglePng,description:_.toggleDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleListPng,isToggleable:!0}),[r.Ti.file]:w({key:r.Ti.file,blockType:r.Ti.file,displayName:_.fileTitle,fuzzySearchKeywords:_.fileKeywords,thumbnail:i.Z.images.blocks.filePng,tooltipPhoto:i.Z.images.tooltips.blocks.filePng,description:_.fileDescription}),[r.Ti.video]:w({key:r.Ti.video,blockType:r.Ti.video,displayName:_.videoTitle,fuzzySearchKeywords:_.videoKeywords,thumbnail:i.Z.images.blocks.videoPng,tooltipPhoto:i.Z.images.tooltips.blocks.videoPng,description:_.videoDescription}),[r.Ti.audio]:w({key:r.Ti.audio,blockType:r.Ti.audio,displayName:_.audioTitle,fuzzySearchKeywords:_.audioKeywords,thumbnail:i.Z.images.blocks.audioPng,description:_.audioDescription}),[r.Ti.embed]:w({key:r.Ti.embed,blockType:r.Ti.embed,displayName:_.embedTitle,fuzzySearchKeywords:_.embedKeywords,thumbnail:i.Z.images.blocks.embedPng,description:_.embedDescription}),[r.Ti.drive]:w({key:r.Ti.drive,blockType:r.Ti.drive,displayName:_.driveTitle,fuzzySearchKeywords:_.driveKeywords,thumbnail:i.Z.images.blocks.drivePng,description:_.driveDescription,shouldShow:e=>(0,m.P5)()}),[r.Ti.figma]:w({key:r.Ti.figma,blockType:r.Ti.figma,displayName:_.figmaTitle,fuzzySearchKeywords:_.figmaKeywords,thumbnail:i.Z.images.blocks.figmaPng,description:_.figmaDescription}),[r.Ti.loom]:w({key:r.Ti.loom,blockType:r.Ti.loom,displayName:_.loomTitle,fuzzySearchKeywords:_.loomKeywords,thumbnail:i.Z.images.blocks.loomPng,description:_.loomDescription}),[r.Ti.typeform]:w({key:r.Ti.typeform,blockType:r.Ti.typeform,displayName:_.typeformTitle,fuzzySearchKeywords:_.typeformKeywords,thumbnail:i.Z.images.blocks.typeformPng,description:_.typeformDescription}),[r.Ti.codepen]:w({key:r.Ti.codepen,blockType:r.Ti.codepen,displayName:_.codepenTitle,fuzzySearchKeywords:_.codepenKeywords,thumbnail:i.Z.images.blocks.codepenPng,description:_.codepenDescription}),[r.Ti.tweet]:w({key:r.Ti.tweet,blockType:r.Ti.tweet,displayName:_.tweetTitle,fuzzySearchKeywords:_.tweetKeywords,thumbnail:i.Z.images.blocks.twitterPng,description:_.tweetDescription}),[r.Ti.gist]:w({key:r.Ti.gist,blockType:r.Ti.gist,displayName:_.gistTitle,fuzzySearchKeywords:_.gistKeywords,thumbnail:i.Z.images.blocks.githubPng,description:_.gistDescription}),[r.Ti.maps]:w({key:r.Ti.maps,blockType:r.Ti.maps,displayName:_.mapsTitle,fuzzySearchKeywords:_.mapsKeywords,thumbnail:i.Z.images.blocks.mapsPng,description:_.mapsDescription}),[r.Ti.framer]:w({key:r.Ti.framer,blockType:r.Ti.framer,displayName:_.framerTitle,fuzzySearchKeywords:_.framerKeywords,thumbnail:i.Z.images.blocks.framerPng,description:_.framerDescription}),[r.Ti.invision]:w({key:r.Ti.invision,blockType:r.Ti.invision,displayName:_.invisionTitle,fuzzySearchKeywords:_.invisionKeywords,thumbnail:i.Z.images.blocks.invisionPng,description:_.invisionDescription}),[r.Ti.equation]:w({key:r.Ti.equation,blockType:r.Ti.equation,displayName:_.equationTitle,fuzzySearchKeywords:_.equationKeywords,thumbnail:i.Z.images.blocks.texPng,tooltipPhoto:i.Z.images.tooltips.blocks.mathPng,description:_.equationDescription}),[r.Ti.pdf]:w({key:r.Ti.pdf,blockType:r.Ti.pdf,displayName:_.pdfTitle,fuzzySearchKeywords:_.pdfKeywords,thumbnail:i.Z.images.blocks.pdfPng,description:_.pdfDescription}),[r.Ti.factory]:w({displayName:_.factoryTitle,fuzzySearchKeywords:_.factoryKeywords,thumbnail:i.Z.images.blocks.templateButtonPng,key:r.Ti.factory,blockType:r.Ti.factory,description:_.factoryDescription,tooltipPhoto:i.Z.images.tooltips.blocks.templateButtonPng,createTemplate:f.sw,shouldShow:()=>!1}),[r.Ti.button]:w({displayName:_.buttonTitle,fuzzySearchKeywords:_.buttonKeywords,thumbnail:i.Z.images.blocks.templateButtonPng,key:r.Ti.button,blockType:r.Ti.button,description:_.buttonDescription,tooltipPhoto:i.Z.images.tooltips.blocks.templateButtonPng,createTemplate:f.ax,badge:"new"}),[r.Ti.breadcrumb]:w({displayName:_.breadcrumbTitle,thumbnail:i.Z.images.blocks.breadcrumbPng,tooltipPhoto:i.Z.images.tooltips.blocks.breadcrumbPng,description:_.breadcrumbDescription,fuzzySearchKeywords:_.breadcrumbKeywords,key:r.Ti.breadcrumb,blockType:r.Ti.breadcrumb}),[r.Ti.callout]:w({key:r.Ti.callout,blockType:r.Ti.callout,displayName:_.calloutTitle,thumbnail:i.Z.images.blocks.calloutPng,description:_.calloutDescription,fuzzySearchKeywords:_.calloutKeywords,tooltipPhoto:i.Z.images.tooltips.blocks.calloutPng}),[r.Ti.tableOfContents]:w({displayName:_.table_of_contentsTitle,fuzzySearchKeywords:_.table_of_contentsKeywords,thumbnail:i.Z.images.blocks.tableOfContentsPng,tooltipPhoto:i.Z.images.tooltips.blocks.tableOfContentsPng,description:_.table_of_contentsDescription,key:r.Ti.tableOfContents,blockType:r.Ti.tableOfContents}),[r.Ti.whimsical]:w({key:r.Ti.whimsical,blockType:r.Ti.whimsical,displayName:_.whimsicalTitle,fuzzySearchKeywords:_.whimsicalKeywords,thumbnail:i.Z.images.blocks.whimsicalPng,description:_.whimsicalDescription}),[r.Ti.mixpanel]:w({key:r.Ti.mixpanel,blockType:r.Ti.mixpanel,displayName:_.mixpanelTitle,fuzzySearchKeywords:_.mixpanelKeywords,thumbnail:i.Z.images.blocks.mixpanelPng,description:_.mixpanelDescription}),[r.Ti.miro]:w({key:r.Ti.miro,blockType:r.Ti.miro,displayName:_.miroTitle,fuzzySearchKeywords:_.miroKeywords,thumbnail:i.Z.images.blocks.miroPng,description:_.miroDescription}),[r.Ti.abstract]:w({key:r.Ti.abstract,blockType:r.Ti.abstract,displayName:_.abstractTitle,thumbnail:i.Z.images.blocks.abstractPng,description:_.abstractDescription,fuzzySearchKeywords:_.abstractKeywords}),[r.Ti.sketch]:w({key:r.Ti.sketch,blockType:r.Ti.sketch,displayName:_.sketchTitle,thumbnail:i.Z.images.blocks.sketchPng,description:_.sketchDescription,fuzzySearchKeywords:_.sketchKeywords}),[r.Ti.excalidraw]:w({key:r.Ti.excalidraw,blockType:r.Ti.excalidraw,displayName:_.excalidrawTitle,thumbnail:i.Z.images.blocks.excalidrawPng,description:_.excalidrawDescription,fuzzySearchKeywords:_.excalidrawKeywords}),[r.Ti.replit]:w({key:r.Ti.replit,blockType:r.Ti.replit,displayName:_.replitTitle,thumbnail:i.Z.images.blocks.replitPng,description:_.replitDescription,fuzzySearchKeywords:_.replitKeywords}),[r.Ti.table]:w({key:r.Ti.table,blockType:r.Ti.table,displayName:_.simpleTableTitle,thumbnail:i.Z.images.blocks.simpleTablePng,description:_.simpleTableDescription,fuzzySearchKeywords:_.simpleTableKeywords,tooltipPhoto:i.Z.images.tooltips.blocks.simpleTablePng,createTemplate:()=>f.S7()}),[r.Ti.tab]:w({key:r.Ti.tab,blockType:r.Ti.tab,displayName:_.tabTitle,thumbnail:i.Z.images.blocks.tabsPng,tooltipPhoto:i.Z.images.tooltips.blocks.tabsPng,description:_.tabDescription,fuzzySearchKeywords:_.tabKeywords,createTemplate:()=>f.ZW(),shouldShow:e=>(0,m.$c)(e)}),[r.Ti.hex]:w({key:r.Ti.hex,blockType:r.Ti.hex,displayName:_.hexTitle,thumbnail:i.Z.images.blocks.hexPng,description:_.hexDescription,fuzzySearchKeywords:_.hexKeywords}),[r.Ti.deepnote]:w({key:r.Ti.deepnote,blockType:r.Ti.deepnote,displayName:_.deepnoteTitle,thumbnail:i.Z.images.blocks.deepnotePng,description:_.deepnoteDescription,fuzzySearchKeywords:_.deepnoteKeywords}),[r.MF.toggleFormatHeaderBlock]:w({key:r.MF.toggleFormatHeaderBlock,blockType:r.Ti.header,displayName:_.toggleFormatHeaderTitle,fuzzySearchKeywords:_.toggleFormatHeaderKeywords,thumbnail:i.Z.images.blocks.toggleHeading1Png,description:_.toggleFormatHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleH1Png,createTemplate:()=>f.UG(r.Ti.header),isToggleable:!0}),[r.MF.toggleFormatSubHeaderBlock]:w({key:r.MF.toggleFormatSubHeaderBlock,blockType:r.Ti.subHeader,displayName:_.toggleFormatSubHeaderTitle,fuzzySearchKeywords:_.toggleFormatSubHeaderKeywords,thumbnail:i.Z.images.blocks.toggleHeading2Png,description:_.toggleFormatSubHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleH2Png,createTemplate:()=>f.UG(r.Ti.subHeader),isToggleable:!0}),[r.MF.toggleFormatSubSubHeaderBlock]:w({key:r.MF.toggleFormatSubSubHeaderBlock,blockType:r.Ti.subSubHeader,displayName:_.toggleFormatSubSubHeaderTitle,fuzzySearchKeywords:_.toggleFormatSubSubHeaderKeywords,thumbnail:i.Z.images.blocks.toggleHeading3Png,description:_.toggleFormatSubSubHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleH3Png,createTemplate:()=>f.UG(r.Ti.subSubHeader),isToggleable:!0}),[r.Ti.columnList]:w({key:r.Ti.columnList,blockType:r.Ti.columnList,displayName:_.columnListTitle,fuzzySearchKeywords:_.columnListKeywords,thumbnail:i.Z.images.blocks.columnListPng,description:_.columnListDescription,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(2),shouldShow:e=>!e.environment.device.isPhone}),[r.MF.column2Block]:w({key:r.MF.column2Block,blockType:r.Ti.columnList,displayName:_.column2Title,fuzzySearchKeywords:_.column2Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:_.column2Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(2),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(h.hF)}),[r.MF.column3Block]:w({key:r.MF.column3Block,blockType:r.Ti.columnList,displayName:_.column3Title,fuzzySearchKeywords:_.column3Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:_.column3Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(3),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(h.hF)}),[r.MF.column4Block]:w({key:r.MF.column4Block,blockType:r.Ti.columnList,displayName:_.column4Title,fuzzySearchKeywords:_.column4Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:_.column4Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(4),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(h.hF)}),[r.MF.column5Block]:w({key:r.MF.column5Block,blockType:r.Ti.columnList,displayName:_.column5Title,fuzzySearchKeywords:_.column5Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:_.column5Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(5),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(h.hF)}),[r.MF.mermaidCodeBlock]:w({key:r.MF.mermaidCodeBlock,blockType:r.Ti.code,displayName:_.mermaidCodeTitle,fuzzySearchKeywords:_.mermaidCodeKeywords,thumbnail:i.Z.images.blocks.codePng,description:_.mermaidCodeDescription,tooltipPhoto:i.Z.images.tooltips.blocks.codePng,createTemplate:()=>f.iD("Mermaid","graph TD\n  Mermaid --\x3e Diagram"),postCreateCallback:e=>{o.default.afterNextFlush((()=>{o.default.afterNextFlush((()=>{const t=u.C.find((t=>t.props.store.id===e.id)),n=null==t?void 0:t.props.store,o=n&&(0,y.mh)(n);if(o){var i;const e=(0,b.TD)({store:o,selection:{startIndex:0,endIndex:(null===(i=(0,S.x0)(o))||void 0===i?void 0:i.endIndex)??0}});c.NA({multiSelection:e})}}))}))}}),[r.MF.aiSummaryBlock]:w({key:r.MF.aiSummaryBlock,blockType:r.Ti.aiBlock,displayName:_.aiSummaryBlockTitle,fuzzySearchKeywords:_.aiSummaryKeywords,thumbnail:i.Z.images.blocks.tableOfContentsPng,description:_.aiSummaryBlockDescription,badge:"ai",createTemplate:()=>f.Jy("summarize"),shouldShow:e=>!e.environment.device.isPhone&&C(e)}),[r.MF.aiActionItemsBlock]:w({key:r.MF.aiActionItemsBlock,blockType:r.Ti.aiBlock,displayName:_.aiActionItemsBlockTitle,fuzzySearchKeywords:_.aiActionItemsKeywords,thumbnail:i.Z.images.blocks.bulletedListPng,description:_.aiActionItemsDescription,badge:"ai",createTemplate:()=>f.Jy("findActionItems"),shouldShow:e=>!e.environment.device.isPhone&&C(e)}),[r.MF.aiFreePromptBlock]:w({key:r.MF.aiFreePromptBlock,blockType:r.Ti.aiBlock,displayName:_.aiFreePromptBlockTitle,fuzzySearchKeywords:_.aiFreePromptKeywords,thumbnail:i.Z.images.blocks.calloutPng,description:_.aiFreePromptDescription,badge:"ai",createTemplate:()=>f.Jy("helpMeWrite"),shouldShow:e=>!e.environment.device.isPhone&&C(e)}),[r.Ti.drawing]:w({key:r.Ti.drawing,blockType:r.Ti.drawing,displayName:_.drawingTitle,fuzzySearchKeywords:_.drawingKeywords,thumbnail:i.Z.images.externalIntegrations.acmeIconPng,description:_.drawingDescription,shouldShow:e=>(0,g.A3)(),createTemplate:()=>f.Fr()}),[r.MF.aiSectionBlock]:w({key:r.MF.aiSectionBlock,blockType:r.Ti.aiBlock,displayName:_.aiSectionBlockTitle,fuzzySearchKeywords:_.aiSectionBlockTitle,thumbnail:i.Z.images.blocks.calloutPng,badge:"ai",createTemplate:()=>f.d6(),shouldShow:e=>!e.environment.device.isPhone&&C(e)&&p.Z.shouldShowAISections()})},I=(k[r.Ti.callout],k[r.Ti.toggle],[r.MF.aiSummaryBlock,r.MF.aiActionItemsBlock,r.MF.aiFreePromptBlock,r.MF.aiSectionBlock]),C=e=>{let{publicEditMode:t}=e;return(0,v.GD)(t)}},11599:(e,t,n)=>{n.d(t,{$0:()=>d,A$:()=>l,ab:()=>s,dy:()=>c,kq:()=>p,p1:()=>u});var o=n(80951),i=n(80444),r=n(88923);function a(){const e=d(),{mainEditorCurrentBlockStore:t}=i.default.state,n=r.default.state.open&&r.default.state.target||t;return e||n}function s(e,t){const n=a(),o=null==n?void 0:n.getFormat(),i=e&&e[t],r=(null==o?void 0:o.collection_page_sections)||[];if(!i){if("backlinks"===t)return"section_collapsed";if("comments"===t)return"section_show";if("margin_comments"===t)return"inline";if(r&&r.filter((e=>e.section===t))){const e=r.find((e=>e.section===t));if(e)return e.visibility}return"inline"}return i}function l(e,t){const n=a();if(!n)return!1;return s(n.getFormat().page_section_visibility,e)===t}function c(e,t){const n=a();if(!n)return!0;return"section_show"===s(n.getFormat().page_section_visibility,t)}function d(){const{mainEditorCurrentBlockStore:e}=i.default.state,t=r.default.state.open&&r.default.state.target||e;return null==t?void 0:t.getAssociatedCollectionStore()}function u(){const e=d();if(!e)return!1;const t=e.getParentBlockStore();return Boolean(t&&(t.isLocked()||t.isNavigableAncestorLocked()))}function p(e){const{propertySchema:t}=e,{type:n}=t,i=(0,o.eb)(t);return!(["created_time","created_by","last_edited_time","last_edited_by"].includes(n)||i)}},75081:(e,t,n)=>{n.d(t,{A7:()=>_,Hu:()=>g,Mn:()=>h,OW:()=>m,Q_:()=>b,sN:()=>v,tV:()=>S,x1:()=>y});n(57658),n(67294);var o=n(45433),i=n(54855),r=n(86793),a=n(59960),s=n(97880),l=n(5366),c=n(35661),d=n(33929),u=n(98165),p=n(85893);const m={page:i.a,tasks:a.w,projects:r.D},f=(0,l.defineMessages)({page:{defaultMessage:"Page",id:"dbTypesHelpers.singlePage.displayName"},tasks:{defaultMessage:"Task",id:"dbTypesHelpers.singleTask.displayName"},projects:{defaultMessage:"Project",id:"dbTypesHelpers.singleProject.displayName"}}),g={page:f.page,tasks:f.tasks,projects:f.projects};function h(e){return d.default.formatMessage((0,o.J2)(e))}function v(e,t){return d.default.formatMessage((0,o.tq)(e,t))}function b(e,t){return d.default.formatMessage((0,o.Xj)(e,t))}function y(e){let{typedCollections:t,spaceStore:n,environment:o}=e;const i=[],r=[],a={},l={};for(const d of t){const e=(0,u.u3)(d);if(!e)continue;const t=S({environment:o,spaceStore:n,collectionStore:d});switch(t){case"team":a[e.id]=[...a[e.id]||[],d],e instanceof c.zX&&(l[e.id]=e);break;case"private":i.push(d);break;case"other":r.push(d);break;default:(0,s.t1)(t)}}return{privateDatabases:i,otherDatabases:r,teamDatabases:a,teamStores:l}}function S(e){let{environment:t,spaceStore:n,collectionStore:o}=e;const i=(0,u.u3)(o);return i&&i.canRead()?i instanceof c.zX?"team":i.isTopLevelPrivatePage({spaceStore:n,environment:t})?"private":"other":"other"}function _(e,t){return(0,p.jsx)(l.FormattedMessage,{...t,defaultMessage:"This property is required for {databaseType}.",id:"database.requiredPropertyExplanation",description:"Educate the users on why this property cannot be deleted.",values:{databaseType:h(e)}})}},21969:(e,t,n)=>{n.d(t,{H:()=>a,W:()=>r});var o=n(80310),i=n(64002);function r(e){const t=(0,i.Qc)(e);return t.query[o.JF]="true",(0,i.bf)({url:(0,i.WU)(t),query:t.query,hash:t.hash||void 0})}function a(e){const t=(0,i.Qc)((0,i.T1)(e));return t.query[o.f6]="true",(0,i.bf)({url:(0,i.WU)(t),query:t.query,hash:t.hash||void 0})}},71776:(e,t,n)=>{n.d(t,{$Z:()=>s,GU:()=>r,OS:()=>l,cr:()=>a});n(57658);var o=n(77420),i=n(9844);function r(e){const{ids:t,table:n,userStore:o}=e,i=[];for(const r of t){const e=o.getRecordModel({id:r,table:n});e&&i.push(e)}return a(i)}function a(e){return e.slice().sort(((e,t)=>t.created_at-e.created_at))}const s=["all","internal","public"],l={[o.cZ]:"internal",[i.K2]:"public"}},25898:(e,t,n)=>{function o(e,t,n,o){return Math.sqrt((e-n)*(e-n)+(t-o)*(t-o))}n.d(t,{Z:()=>o})},62619:(e,t,n)=>{n.d(t,{Gs:()=>a,IL:()=>p,OW:()=>u,UG:()=>r,kA:()=>m,kK:()=>s,kd:()=>c,oG:()=>d,r3:()=>f,sh:()=>l});n(57658);var o=n(15095),i=n(72126);function r(e){try{return Boolean(e&&void 0!==e.nodeType)}catch(t){return!1}}function a(e){return r(e)&&e.nodeType===Node.TEXT_NODE}function s(e){return r(e)&&e.nodeType===Node.ELEMENT_NODE}function l(e,t){for(;r(e)&&!t(e);)e=e.parentNode;return e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(r(e)){for(const n of o.p4(e.childNodes))a(n)?t.push(n):n.childNodes&&c(n,t);return t}return[]}const d=function(e,t){return r(e)&&r(t)?i.cx(e.childNodes,(e=>e===t)):-1},u=(()=>{if("undefined"==typeof window)return!0;if(window.InputEvent&&"function"==typeof window.InputEvent.prototype.getTargetRanges)return!0;const e=window.document.createElement("div");e.contentEditable="true";return"onbeforeinput"in e})(),p=e=>{!u&&e.preventDefault&&e.preventDefault()};function m(e){return"inputType"in e}function f(e,t){return e!==t&&e.contains(t)}},43045:(e,t,n)=>{n.d(t,{N:()=>l});var o=n(54087),i=n.n(o);let r;let a=!1;function s(){a||(a=!0,i()((()=>{a=!1,(r||(r=document.createElement("div"),r.style.position="fixed",r.style.top="-9999px",r.style.left="-9999px",r.style.zIndex="-9999",document.body.appendChild(r)),r).style.height=`${Math.random()}px`})))}function l(){const e=window.getSelection();e&&e.anchorNode&&s()}},63085:(e,t,n)=>{n.d(t,{bf:()=>b,sj:()=>v,W4:()=>u,id:()=>m,cJ:()=>f,YG:()=>h});n(21703);var o=n(80951),i=n(68626);n(57658);var r=n(29477),a=n(95477),s=n(77080),l=n(24608);const c=1e4;async function d(e){const{environment:t,sourceURL:n}=e;let o;o=`https://embed.notion.co/api/iframely?key=${a.default.iframely_prod.key}&url=${n}`;const s={environment:t,method:"GET",url:o,format:"json"},{result:c}=await r.vW(3,1e4,(()=>(0,l.ZP)(s)));if(c&&"success"===c.type)return function(e){const t=e;return Object.keys(e).forEach((n=>{if("meta"===n&&(e[n].title&&(t.title=e[n].title),e[n].description&&(t.description=e[n].description),e[n].site&&(t.provider_name=e[n].site)),"url"===n&&(t.url=e[n]),"links"===n){if(e[n].thumbnail&&e[n].thumbnail.length>0){t.images=[];const o={width:Number,height:Number,url:String};o.width=e[n].thumbnail[0].media&&e[n].thumbnail[0].media.width?e[n].thumbnail[0].media.width:480,o.height=e[n].thumbnail[0].media&&e[n].thumbnail[0].media.height?e[n].thumbnail[0].media.height:1080,o.url=e[n].thumbnail[0]&&e[n].thumbnail[0].href?e[n].thumbnail[0].href:"",t.images.push(o)}e[n].icon&&e[n].icon.length>0&&(t.favicon_url=e[n].icon[0].href)}})),t}(c.data);i.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==c?void 0:c.error,data:{miscDataToConvertToString:{provider:"iframely"}}})}async function u(e,t){const n=encodeURIComponent(t.trim());return"on"===s.default.getEligibleGroup({experimentId:"iframely_switch",defaultGroup:"control"})?await d({environment:e,sourceURL:n}):await async function(e,t){const n={environment:e,method:"GET",url:`https://api.embed.ly/1/extract?key=${a.default.embedly.key}&url=${t}`,format:"json"},{result:o}=await r.vW(3,c,(()=>(0,l.ZP)(n)));if(o&&"success"===o.type)return o.data;i.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==o?void 0:o.error,data:{miscDataToConvertToString:{provider:"embedly"}}})}(e,n)}const p=/(\/d\/|id=)([-\w]{25,})/;function m(e){const t=e.match(p);if(t&&!(t.length<3))return t[2]}function f(e){return o.zB(e.store.getProperties().source)||e.source}const g=new Set(["http:","https:","blob:","data:"]),h=function(e){const t=new URL(e,a.default.domainBaseUrl).protocol;return g.has(t)};function v(e){if(e&&e instanceof b)return{type:"invalid_protocol",protocol:e.protocol}}class b extends Error{constructor(e){const t=new URL(e,a.default.domainBaseUrl).protocol;super(`Invalid URL protocol: "${t}"`),this.name=void 0,this.protocol=void 0,this.protocol=t,this.name="InvalidUrlProtocolError"}}},83631:(e,t,n)=>{n.d(t,{D9:()=>b,JT:()=>k,Jf:()=>I,ND:()=>y,TJ:()=>_,Xu:()=>S,bc:()=>v,by:()=>w,nk:()=>C,qZ:()=>x});var o=n(41892),i=n(98923),r=n(15095),a=n(65454),s=n(72126),l=n(70203),c=n(44805),d=n(97880),u=n(63143),p=n(50906),m=n(62619),f=n(68056),g=n(89224),h=n(89086);function v(){return(0,a.ZP)(o.Z.katex.katexMinCss,{resourceType:a._g.Stylesheet})}function b(e){const{source:t,currentEquationToken:n,selectedText:o}=e;return"rich_text_menu"===t?n?{type:"edit",source:t}:{type:"create",source:t,selection:!0}:"input_keyboard_shortcut"===t?n?{type:"edit",source:t}:{type:"create",source:t,selection:Boolean(o)}:"slash_menu"===t?{type:"create",source:t,selection:!1}:"click_token"===t||"arrow_keys"===t?{type:"edit",source:t}:"text_filter"===t?{type:"create",source:t,selection:!0}:void(0,d.t1)(t)}function y(e){const{environment:t,equation:n,from:o}=e;p.iA$(t,{equation:n,equationNewlineCount:n.split("\n").length-1,equationBackslashCount:n.split("\\").length-1,equationLength:r.p4(n).length,from:o})}function S(e){return m.kK(e)&&e.classList.contains(c.et)}function _(e){const{selection:t,environment:n}=e,o=g.getRect(t);if(!o){return m.sh(t.startContainer,m.kK).getBoundingClientRect()}if(n.device.isChrome){const e=t.startContainer.childNodes[t.startOffset];return e&&S(e)?e.getBoundingClientRect():m.kK(t.startContainer)?new DOMRect(o.left,o.top,o.width,t.startContainer.getBoundingClientRect().height):new DOMRect(o.left,o.top,o.width,22)}return o}function w(e){const{environment:t,equation:n,displayMode:o}=e,r=t.KatexStore.getKatex();return r&&(0,i.CY)({katex:r,equation:n,options:{displayMode:"block"===o}}).error}function k(e){if("editing"!==e.mode)return;const t=(0,f.QY)(e.multiSelection);if(!t)return;const{store:n,selection:o}=t,{tokensBeforeRange:i,tokensInsideRange:r}=l.xrQ(n.getValue(),o.startIndex,o.endIndex);let a=s.Sm(i.map(l.J1x));for(const s of r){const e=l.J1x(s),t={startIndex:a,endIndex:a+e};if(l.YrK(s))return{token:s,position:t};a+=e}}function I(e){let t=e;for(let n=0;n<2;n+=1){const e=/^\$(.*)\$$/m.exec(t);if(!e||!e[1])break;t=e[1]}return t}function C(e){const t=(0,f.QY)(e.multiSelection);if(!t)return[];const{selection:n,store:o}=t,i=o.getValue();if(!i)return[];const r=h.wd(n)&&n.startIndex>0?[n.startIndex-1]:[n.startIndex];return h.oc(r,i)[0]||[]}function x(e){const{equationState:t,isTemporary:n}=e,o=t.editingToken?u.uh(l.hDy(t.editingToken),(e=>l.kuv(e)||l.QVC(e))):u.uh(t.annotations,(e=>l.kuv(e)||l.QVC(e)||l.ZAl(e))),i=s.oA([n&&l.W9d(),...o]);return l.qZ6(t.value,i)}},73744:(e,t,n)=>{n.d(t,{DJ:()=>a,ZV:()=>r,lj:()=>i});let o=!1;try{const e=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("test",(()=>{}),e)}catch(s){}const i=function(e,t,n,i){o?e.addEventListener(t,n,{passive:!0,capture:Boolean(i)}):e.addEventListener(t,n,Boolean(i))},r=function(e,t,n,o){e.removeEventListener(t,n,Boolean(o))};function a(e){if(void 0!==e)return"shiftKey"in e&&"altKey"in e&&e.shiftKey&&e.altKey?"window":"metaKey"in e&&e.metaKey||"ctrlKey"in e&&e.ctrlKey?"tab":void 0}},41232:(e,t,n)=>{n.d(t,{GQ:()=>f,Ue:()=>m,Xg:()=>b,_F:()=>h,_l:()=>g,o$:()=>y,pI:()=>v,y6:()=>p});var o=n(17215),i=n(78601),r=n(2864),a=n(97880),s=n(44876),l=n(80444),c=n(77080),d=n(30874),u=n(40671);function p(e){if(e.isCollectionView()){var t,n;if(null===(t=e.getCollectionViewCollectionStore())||void 0===t||!t.isSyncedCollection())return;return null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.getFormat()}return e.getFormat()}function m(e,t){const n=d.Z.state;if(!e||!n.loaded)return[];const o=(0,s.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"!==o.type?[]:n.bots.filter((e=>e.integration_id===o.integration.id))}function f(e,t){if(!e)return;const n=(0,s.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"===n.type?n:void 0}function g(e){const{store:t,isInDarkMode:n}=e,i=p(t);if(null!=i&&i.is_placeholder||null!=i&&i.error){const e=d.Z.integrations.state.find((e=>{let{id:t}=e;return i.integration_id===t}));if(e){const t=d.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t})),{icon:a,dark_icon:c,accent_color:u,accent_icon:p}=e.info,m=n&&c?c:a;if(!m||!u||!p)return;const f=i.original_url;let g;if(f){var r;const t=(0,s.ny)({url:f,integrations:[e],currentSpaceId:null===(r=l.default.state.currentSpaceStore)||void 0===r?void 0:r.id});"success"===t.type&&(g=t.pattern)}return{type:null!=i&&i.is_placeholder?"placeholder":"error",userHasBotForIntegration:t.length>0,renderConfig:{headerAttributes:[{formatter:o.V1.placeholder,attribute:{id:"title",name:"Title",type:"inline",values:[e.name],format:{type:"title"}}}]},action:f&&!g?"error":void 0,updating:!1,originalUrl:f,pattern:g,integration:{id:e.id,icon:m,name:e.name,accentColor:u,accentIcon:p},botIds:t}}}return h({...e,getRenderFn:e=>e.block})}function h(e){var t;const{store:n,isInDarkMode:o,canEdit:r,currentUserId:c,showAction:d,getRenderFn:g}=e,h=p(n);if(!h||h.is_placeholder)return;if(void 0===h.external_object_id&&void 0!==h.uri)return;const v=h.original_url||h.uri;if(!n.isDefined())return;const b=f(v,n.getSpaceId()??(null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id));if(!v||!b)return;const y=m(v,n.getSpaceId()),S=y.length>0,_=n.getExternalObjectSubInstanceStores(),w=_.map((e=>e.getFormat())).filter(a.$K);if(w.length!==_.length)return;const{integration:k,pattern:I}=b,{icon:C,dark_icon:x,accent_color:T,accent_icon:M}=k.info,P=o&&x?x:C;if(!P||!T||!M)return;const A=(0,i.U)(I.name),R=(0,s.Tf)({url:v,integration:k}),D=g(A)({integrationIcon:P,root:h,relations:w,parsedAttributes:R});if(!D)return;const B=u.Z.state.updatingUrls.has(v),E=Date.now(),F=Boolean(n.getCreatedById()!==c&&n.getCreatedTime()&&E-n.getCreatedTime()<6e4);let Z;return!B&&r&&c&&(d?Z=d:h.error?Z="error":(null==h||!h.stale)&&h.attributes||F||(Z=S?"update":"authenticate")),{type:"active",renderConfig:D,action:Z,updating:B,originalUrl:v,integration:{id:k.id,icon:P,name:k.name,accentColor:T,accentIcon:M},pattern:I,userHasBotForIntegration:S,botIds:y.map((e=>{let{id:t}=e;return t}))}}function v(e,t){if(!t)return e;const n=f(e,t);return"success"!==(null==n?void 0:n.type)?e:(0,r.l)({url:e,integration:n.integration,pattern:n.pattern})}function b(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing",defaultGroup:"control"})}function y(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing_api",defaultGroup:"control"})}},6398:(e,t,n)=>{n.d(t,{hx:()=>A,lf:()=>P,ox:()=>T,r4:()=>M});n(67294);var o=n(13991),i=n(86628),r=n(24405),a=n(6906),s=n(8848),l=n(84619),c=n(7057),d=n(53877),u=n(42875),p=n(5366),m=n(97880),f=n(82990),g=n(44876),h=n(62896),v=n(51077),b=n(56496),y=n(12981),S=n(81865),_=n(65085),w=n(85567),k=n(33929),I=n(85893);function C(e){window.__c={n:"ExternalObjectInstanceAttributeToken"};const{title:t,color:n,icon:o}=e,i=(0,r.Fg)(),c=n?(0,s.MJ)(`rgb(${n.r},${n.g},${n.b})`):void 0,d=(0,s.KR)(i,c);return(0,I.jsx)(w.Z,{format:l.l.Medium,value:o?(0,I.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(S.Z,{isAuthenticated:!1,url:o,width:32,render:(e,t)=>(0,I.jsx)(y.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})}),(0,I.jsx)(h.Z,{children:(0,a.Z)(t)})]}):(0,I.jsx)(h.Z,{children:(0,a.Z)(t)}),showRemoveButton:!1,color:d.textColor,backgroundColor:d.backgroundColor,isSingle:!0,style:{display:"flex",whiteSpace:"break-spaces",flex:"0 0 auto"}})}function x(e){var t,n,o;window.__c={n:"ExternalObjectInstanceRelation"};const{uri:r,store:a,...s}=e,l=(0,i.VK)((()=>{const e=a.getExternalObjectSubInstanceStores().find((e=>{const t=e.getKeyStore("format").getKeyStore("uri").getValue();return t&&t===r}));if(e)return e.getFormat()}),[a,r]);if(!l)return null;const c=null===(t=l.attributes)||void 0===t?void 0:t.find(g.Id),d=null===(n=l.attributes)||void 0===n?void 0:n.find(g.li),u=null===(o=l.attributes)||void 0===o?void 0:o.find(g.hW);return c?u?(0,I.jsx)(C,{title:c.values[0],color:u.values[0],icon:null==d?void 0:d.values[0]}):c?(0,I.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[d&&(0,I.jsx)(v.Z,{type:"image_url",imageURL:d.values[0],size:16,style:{marginRight:4},imageStyle:s.avatarStyle}),(0,I.jsx)(T,{attribute:c,store:a,...s})]},r):null:null}function T(e){window.__c={n:"ExternalObjectInstanceAttribute"};const{attribute:t,formatter:n,store:o,style:i,avatarStyle:a}=e,s=(0,r.Fg)();if((0,g.Id)(t)){var l;const e=t.values[0];if("enum"===(null===(l=t.format)||void 0===l?void 0:l.type)){const{color:n}=t.format;return(0,I.jsx)(C,{title:e,color:n})}{const t=e.replace(/[\r\n]/g,"").trim(),o=n?k.default.formatMessage(n,{value:t}):t;return(0,I.jsx)("div",{spellCheck:!1,style:{whiteSpace:"nowrap",color:s.mediumTextColor,...i},children:o})}}if((0,g.OM)(t))return(0,I.jsx)(x,{uri:t.values[0],store:o,style:i,avatarStyle:a});if((0,g.Gc)(t))return(0,I.jsx)(M,{attribute:t,formatter:e.formatter,style:e.style,dateStyle:"relative"});if((0,g.An)(t)){const e=t.values[0];return(0,I.jsx)("div",{style:{color:s.mediumTextColor,fontSize:12,...i},children:n?k.default.formatMessage(n,{value:e}):String(e)})}return null}function M(e){window.__c={n:"ExternalObjectInstanceDateAttribute"};const{attribute:t,formatter:n,style:i,dateStyle:a}=e,s=(0,p.useIntl)(),l=(0,r.Fg)(),f=t.values[0];let g;if("datetimerange"===f.type)g=(0,c.ZV)({allowRelativeDates:!1,displayInUserTimezone:!0,intl:s,value:f});else{const e=(0,d.uO)(f,(0,u.r)());a&&"relative"!==a?"exact_time"===a?g=(0,c.Yx)(e,"medium_with_time",o.SP):"exact_date"===a?g=(0,c.Yx)(e,"medium",o.SP):(0,m.t1)(a):g=(0,c.tv)(e,o.SP)}const h=n?k.default.formatMessage(n,{value:g}):g;return(0,I.jsx)("div",{style:{color:l.mediumTextColor,fontSize:12,whiteSpace:"nowrap",...i},children:h})}function P(e){window.__c={n:"ExternalObjectInstanceIconAttribute"};const t=(0,r.Fg)(),{attribute:n,isSmall:o}=e,i=o?22:34,a={...e.style,borderRadius:i,boxShadow:t.avatarBoxShadow};return(0,g.li)(n)?(0,I.jsx)(v.Z,{type:"image_url",imageURL:n.values[0],size:i,imageStyle:a}):(0,g.Id)(n)?(0,I.jsx)("div",{style:{...a,borderRadius:i,overflow:"hidden",boxShadow:t.avatarBoxShadow,height:30,width:30},children:(0,I.jsx)(b.Z,{size:i,title:n.values[0]})}):null}function A(e){window.__c={n:"ExternalObjectInstanceStringBodyAttribute"};const{attribute:t}=e,n=(0,r.yK)((e=>({text:{color:e.regularTextColor,fontSize:14},buttons:{fontWeight:f.Z.fontWeight.medium}})),[]);return(0,I.jsx)("div",{style:{marginRight:4,marginBottom:4},children:(0,I.jsx)(_.Z,{moreElement:(0,I.jsxs)(I.Fragment,{children:["…"," ",(0,I.jsx)("span",{style:{...n.text,...n.buttons},children:(0,I.jsx)(p.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.moreLabel",defaultMessage:"more"})})]}),lessElement:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("span",{style:{...n.text,...n.buttons},children:(0,I.jsx)(p.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.showLessLabel",defaultMessage:"show less"})})}),maxLines:3,children:(0,I.jsx)("div",{spellCheck:!1,style:n.text,children:t.values[0]})})})}},69988:(e,t,n)=>{n.d(t,{LX:()=>c,Vu:()=>d,XT:()=>p,ZP:()=>m,fe:()=>u,il:()=>l});n(57658);var o=n(72126),i=n(92338),r=n(63143);function a(e){const t=[];let n=!1,o=e;for(;""!==o;){const e=n?i.dK:i.Um,r=o.indexOf(e);if(-1===r)return t.push(s(o,!1)),t;const a=o.substring(0,r),l=o.slice(r+e.length);""!==a&&t.push(s(a,n)),o=l,n=!n}return t}function s(e,t){return t?[e,"highlight"]:[e]}function l(e){return 2===e.length&&"highlight"===e[1]}function c(e){return e[0]}function d(e){return e.reduce(((e,t)=>{if(0===e.length)return[t];const n=e[e.length-1];return l(n)===l(t)?[...e.slice(0,e.length-1),s(c(n)+c(t),l(t))]:[...e,t]}),[])}function u(e){if(!e)return[];let t=a(e);t.some((e=>l(e)&&1===c(e).length))&&(t=d(t));const n=t.filter(l).map(c);return o.jj(n)}function p(e){const{text:t,patterns:n,uniqueTokenHighlighterContext:i}=e,a=o.jj(n.filter((e=>e.length>0)));if(0===a.length)return[s(t,!1)];const l=o.MR(a,(e=>-e.length)).map(o.hr);return function(e,t,n){const o=(0,r.uO)(t,e);if(0===o.length)return[s(e,!1)];let i=0;const a=[];for(let r=0;r<o.length;r++){const t=o[r];if(!t)continue;let l;void 0===n||!n.has(t[0].toLowerCase())?(void 0!==n&&n.add(t[0].toLowerCase()),i!==t.index&&a.push(s(e.slice(i,t.index),!1)),a.push(s(t[0],!0)),l=t.index+t[0].length):l=i;o[r+1]||l===e.length||a.push(s(e.slice(l),!1)),i=l}return a}(t,new RegExp(l.join("|"),"ig"),i)}const m=a},44486:(e,t,n)=>{n.d(t,{W:()=>r});var o=n(41432),i=n(35661);function r(e){return e.findRecordStoreUIAncestor((e=>e instanceof i.G&&e.getType()===o.Ti.factory)).ancestor}},79897:(e,t,n)=>{n.d(t,{r:()=>s});var o=n(72126),i=n(80444),r=n(81236),a=n(38755);function s(e){const{currentUserRootStore:t}=i.default.state,n=null==t?void 0:t.getSpaceViewStores(),s=o.oA(null==n?void 0:n.map((e=>e.getSpaceId()))).map((t=>r.Z.getPublicSpaceData(e,t))),l=function(e){const t=e.map((e=>(0,a.cD)(e))),n=new Set(o.oA(t));return n.has("enterprise")?"enterprise":n.has("business")?"business":n.has("plus")?"plus":n.has("team_free")?"team_free":n.has("student")?"student":n.has("personal")?"personal":n.has("personal_free")?"personal_free":(n.has("free"),"free")}(s);return{userHighestPlanType:l,isSalesAssistedPlan:o.hX(s,{subscriptionTier:l}).some((e=>{if("none"!==(null==e?void 0:e.role)&&!0===(null==e?void 0:e.is_sales_assisted))return!0}))}}},19306:(e,t,n)=>{n.d(t,{W:()=>a});var o=n(5366),i=n(33929);const r=(0,o.defineMessages)({twoItems:{id:"formatSettings.twoItems",defaultMessage:"{item1} and {item2}"},threeOrMoreItems:{id:"formatSettings.threeOrMoreItems",defaultMessage:"{item1}, and {numberOfOther} others"}});function a(e){if(0===e.length)return"";const t=e[0];if(1===e.length)return t;const n=e[1];if(2===e.length)return i.default.formatMessage(r.twoItems,{item1:t,item2:n});const o=e.length-1;return i.default.formatMessage(r.threeOrMoreItems,{item1:t,numberOfOther:o})}},17809:(e,t,n)=>{n.d(t,{Cl:()=>p,NY:()=>f,V1:()=>m});var o=n(67294),i=n(480),r=n(86628),a=n(72126),s=n(4615),l=n(21202),c=(n(70203),n(84398)),d=n(77080),u=n(35661);function p(e){const{initialValue:t,onChange:n,source:d="title",parentCollection:p}=e,m=(0,i.O7)(),f=(0,c.$)("formulaPrototypeHelpers.useMockTextStore",{isMockTextStore:!0,overrideDefaultRecordCache:!0}),g=function(e){const{initialValue:t,inMemoryRecordCache:n,source:r,parentCollection:a}=e,c=(0,i.O7)(),d=(0,o.useMemo)((()=>t),[]);return(0,o.useMemo)((()=>{const e={id:(0,s.ZP)(),table:l.iU};n.setRecord({pointer:e,userId:c.currentUser.id},{value:{alive:!0,id:e.id,parent_id:(null==a?void 0:a.id)??s._6,parent_table:"block",properties:{[r]:d},space_id:(null==a?void 0:a.getSpaceId())??s._6,type:"page",version:0},role:"editor"});const t=new u.ST({environment:c,inMemoryRecordCache:n,path:["properties",r],pointer:e,userId:c.currentUser.id});return n.emitRecord(e,[]),t}),[c,n,d,a,r])}({initialValue:t,inMemoryRecordCache:f,source:d,parentCollection:p}),h=(0,o.useRef)(t),v=(0,o.useCallback)((e=>{const t=m.currentUser.id,n=g.getRecordStoreAtRootPath();if(n instanceof u.G){const o=n.getValue();o&&(f.setRecord({pointer:g.pointer,userId:t},{role:"editor",value:{...o,properties:{...null==o?void 0:o.properties,[d]:e}}}),f.emitRecord(g.pointer,[]))}}),[m.currentUser.id,g,f,d]);return(0,r.VK)((()=>{const e=g.getValue();a.Xy(h.current,e)||(h.current=e,null==n||n(e))}),[g,n]),{store:g,setValue:v}}function m(){return d.default.checkGate("formulas_prototype")}function f(){return d.default.checkGate("formula_buttons")}},35683:(e,t,n)=>{n.d(t,{uP:()=>c,_R:()=>m,vu:()=>l});n(57658);var o=n(30120),i=(n(21703),n(30541),n(7406));const r=class{constructor(e){let{maxSize:t,prefix:n,store:o,version:i}=e;this.prefix=void 0,this.maxSize=void 0,this.store=void 0,this.version=void 0,this.serializedKeys=void 0,this.namespace=void 0,this.lastVersion=void 0,this.createInternalKey=e=>`${this.namespace}${e}`,this.maxSize=t,this.prefix=n,this.store=o,this.version=i.toString(),this.namespace=`${n}:${i}::`,this.serializedKeys=`${n}:${i}:keys`,this.lastVersion=`${n}:version`}set(e,t){try{this.setInternal(e,t),this.promote(e)}catch(n){return{error:(0,i.tg)(n)}}return{value:void 0}}get(e){try{const t=this.getInternal(e);if(null!==t)return{value:t}}catch(t){return{error:(0,i.tg)(t)}}return{value:void 0}}remove(e){try{this.getKeys().indexOf(e)>-1&&(this.removeInternal(e),this.evict(e))}catch(t){return{error:(0,i.tg)(t)}}return{value:void 0}}clear(){try{const e=this.getKeys();for(const t of e)this.removeInternal(t);this.setKeys([])}catch(e){return{error:(0,i.tg)(e)}}return{value:void 0}}scan(e){try{const t=this.getKeys();for(const n of t){const t=this.getInternal(n);if(null===t)throw new Error(`Item not found: ${n}`);e(n,t)}}catch(t){return{error:(0,i.tg)(t)}}return{value:void 0}}entries(){const e=[],t=this.scan(((t,n)=>{e.push([t,n])}));return t.error?{error:t.error}:{value:e}}keys(){try{return{value:this.getKeys()}}catch(e){return{error:(0,i.tg)(e)}}}slowGC(){const e=[],t=e=>e!==this.serializedKeys&&(!!e.endsWith("keys")&&this.isOldKey(e));for(let n=0;n<this.store.length;n+=1){const o=this.store.key(n);null!==o&&((this.isOldKey(o)||t(o))&&e.push(o))}for(const n of e)this.store.removeItem(n)}updateVersionAndGC(){const e=this.store.getItem(this.lastVersion);if(null!==e){const t=parseInt(e,10),n=parseInt(this.version,10),o=!Number.isNaN(t),i=!Number.isNaN(n);o&&i&&t<n&&this.slowGC()}this.store.setItem(this.lastVersion,this.version)}isOldKey(e){if(!e.startsWith(`${this.prefix}:`))return!1;const t=e.substring(`${this.prefix}:`.length),n=parseInt(t,10);if(Number.isNaN(n))return!1;return n<parseInt(this.version,10)}getKeys(){const e=this.store.getItem(this.serializedKeys);if(null===e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}setKeys(e){const t=JSON.stringify(e);this.store.setItem(this.serializedKeys,t)}promote(e){const t=this.getKeys(),n=t.indexOf(e);if(n>-1)t.splice(n,1),t.unshift(e);else if(t.unshift(e),t.length>this.maxSize){const e=t.splice(this.maxSize);for(const t of e)this.removeInternal(t)}this.setKeys(t)}evict(e){const t=this.getKeys(),n=t.indexOf(e);n>-1&&t.splice(n,1),this.setKeys(t)}setInternal(e,t){this.store.setItem(this.createInternalKey(e),JSON.stringify(t))}getInternal(e){const t=this.store.getItem(this.createInternalKey(e));return null===t?null:JSON.parse(t)}removeInternal(e){this.store.removeItem(this.createInternalKey(e))}};var a=n(72126),s=n(97880);let l=function(e){return e.Default="Default",e.Link="Link",e.Favorite="Favorite",e.Search="Search",e}({});const c=3,d={BONUS:{DEFAULT:100,LINK:120,SEARCH:200,FAVORITE:140},BONUS_NORMALIZER:100,TIME_BUCKETS:[{days:4,weight:100},{days:14,weight:70},{days:31,weight:50},{days:90,weight:30}],DEFAULT_BUCKET_WEIGHT:10};function u(e){const{BONUS:t}=d;switch(e){case l.Default:return t.DEFAULT;case l.Link:return t.LINK;case l.Favorite:return t.FAVORITE;case l.Search:return t.SEARCH;default:(0,s.t1)(e)}}function p(e,t){const{TIME_BUCKETS:n,DEFAULT_BUCKET_WEIGHT:i}=d,r=o.ou.fromMillis(e).diff(o.ou.fromMillis(t),"days").get("days");return r<=n[0].days?n[0].weight:r<=n[1].days?n[1].weight:r<=n[2].days?n[2].weight:r<=n[3].days?n[3].weight:i}class m{constructor(e){var t=this;this.maxStoredVisits=void 0,this.visits=void 0,this.recordVisit=e=>{const{id:t,type:n,timestampForTestingOnly:o}=e,i=this.createVisit(n,o),r=this.visits.get(t);if(r.error)return;const s=r.value||this.createVisitCacheEntry();var l,c,d;s.totalVisits+=1,s.recentVisits=(l=s.recentVisits,c=i,d=this.maxStoredVisits,[...(0,a.pm)(l,d-1),c]),this.visits.set(t,s)},this.getVisits=e=>{const t=this.visits.get(e);if(!t.error)return t.value},this.getVisitedIds=()=>{const e=this.visits.keys();return e.error?[]:e.value},this.getFrecencyScore=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();const o=t.getVisits(e);if(!o)return m.UNVISITED_FRECENCY_SCORE;const{totalVisits:i,recentVisits:r}=o;if(0===i||0===r.length)return m.UNVISITED_FRECENCY_SCORE;const s=r.map((e=>{const{type:t,timestamp:o}=e,i=u(t);return p(n,o)*(i/d.BONUS_NORMALIZER)})),l=(0,a.Sm)(s)/s.length,c=Math.ceil(i*l);return c};const{maxBlocks:n,maxStoredVisits:o,store:i,version:s}=e;this.maxStoredVisits=o,this.visits=new r({prefix:e.prefix||"FrecencyStore",maxSize:n,store:i,version:s})}initialize(){this.visits.updateVersionAndGC()}sortFrecencyHighToLow(e){const{items:t,now:n,recordFrecency:o}=e;return(0,a.MR)(t,(e=>{const t="number"==typeof e.score?e.score:1,i=this.getFrecencyScore(e.id,n);o&&(e.frecencyScore=i);const r=e.personalizationBoost??1;return-1*t*Math.max(i,r)}))}createVisitCacheEntry(){return{totalVisits:0,recentVisits:[]}}createVisit(e,t){return{type:e,timestamp:"number"==typeof t?t:Date.now()}}clear(){const e=[];this.visits.scan((t=>e.push(t)));for(const t of e)this.visits.remove(t)}}m.UNVISITED_FRECENCY_SCORE=1},84210:(e,t,n)=>{n.d(t,{Hu:()=>u,ZP:()=>p});var o=n(1800),i=n(15157),r=n(63306),a=(n(64002),n(95477)),s=n(80444),l=n(886),c=n(88923),d=n(98165);function u(e){e={fullyQualified:!0,...e};const{store:t,collectionViewId:n,showMoveTo:u,saveParent:p,preferPublicLink:m,duplicate:f,getSpaceDomain:g,pageVisitSource:h,queryId:v}=e;let b;if(n)b=n;else if(t&&t.isCollectionView()){const e=i.Z.get({userId:t.environment.currentUser.id,key:l.Z.getLocalViewPreferenceKey(t.id)});if(e)b=e;else{const e=t.getCollectionViewsStore().getValue();e&&(b=e[0])}}const y=t.getParentSpaceStore(),{currentSpaceStore:S}=s.default.state,_=y||S,w=(0,d.fJ)(t),k=(0,r.$t)(w),I=m&&k?(null==_?void 0:_.getPublicContentDomain())||(null==g?void 0:g()):null==_?void 0:_.getEditDomain();let C=a.default.domainBaseUrl;const x=m&&k&&I;if(x){let e="https:";try{e=new URL(a.default.domainBaseUrl||"").protocol||e}catch{}C=`${e}//${I}.${a.default.publicDomainName}`}let T=t,M=e.scrollToBlockId;if(t.isReady()&&!t.isNavigableBlock()){const e=(0,d.Dg)(t);e&&(T=e,M=t.id)}const P=s.default.state.mainEditorCurrentBlockStore;let A,R,D;return P&&e.openInSidePeek?(A=P,R=T.id,D=(0,c.getUrlParamFromPeekMode)(c.PeekModeSide)):(A=T,R=e.peekViewBlockId,D=e.peekMode),(0,o.Z)({pageId:A.id,pageModel:A.getModel(),pageVisitSource:h,queryId:v,scrollToBlockId:M,peekViewBlockId:R,peekMode:D,collectionViewId:b,discussionId:e.discussionId,spaceDomain:x?void 0:I,baseUrl:e.fullyQualified||m?C:void 0,showMoveTo:u,saveParent:p,duplicate:f,templateGalleryItem:e.templateGalleryItem,projectManagementLaunch:e.projectManagementLaunch})}const p=u},87078:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(15723);const i=function(){const e=document.documentElement;return new o.iL(0,0,e.clientWidth,e.clientHeight)}},28415:(e,t,n)=>{n.d(t,{qH:()=>u,vE:()=>c});var o=n(65454),i=n(99405),r=n(50906),a=n(47839),s=n(95477),l=n(77080);async function c(e){const{environment:t,accessToken:n}=e;if(r.D6j(t,{from:e.from}),t.device.isElectron){const t=await a.openGoogleDrivePickerPopup({url:(0,i.zN)(s.default.domainBaseUrl,{token:n})});if(!t)return;"integration"in e?e.callback(!1,t.url):e.callback(t.id)}else await(0,o.ZP)("https://apis.google.com/js/api.js"),"integration"in e?window.gapi.load("picker",(()=>d({environment:t,accessToken:n,callback:e.callback,integration:e.integration}))):window.gapi.load("picker",(()=>d({environment:t,accessToken:n,callback:e.callback})))}function d(e){const{environment:t,accessToken:n}=e,o=`${window.location.protocol}//${window.location.host}`;(new window.google.picker.PickerBuilder).enableFeature(window.google.picker.Feature.SUPPORT_DRIVES).setOAuthToken(n).hideTitleBar().setOrigin(o).addView(new window.google.picker.DocsView).setCallback((n=>{if(n.action===window.google.picker.Action.PICKED&&n.docs&&n.docs.length>0){const o=n.docs[0];"integration"in e?e.callback(!1,o.url):e.callback(o.id),r.D6j(t,{from:"link_preview_placeholder"})}})).build().setVisible(!0)}function u(){return"on"===l.default.getEligibleGroup({experimentId:"google_external_integration_file_picker",defaultGroup:"control"})}},12534:(e,t,n)=>{n.d(t,{$0:()=>a,Af:()=>o,Wi:()=>s,ZP:()=>l});let o=function(e){return e[e.ButtonMouseDown=0]="ButtonMouseDown",e[e.EditorMouseDown=1]="EditorMouseDown",e[e.EditorMouseUp=2]="EditorMouseUp",e[e.EditorClick=3]="EditorClick",e[e.MenuListClick=4]="MenuListClick",e[e.EditorContextMenu=5]="EditorContextMenu",e[e.EditorMouseOver=6]="EditorMouseOver",e[e.EditorHoverMouseMove=7]="EditorHoverMouseMove",e[e.EditorDropMouseMove=8]="EditorDropMouseMove",e[e.EditorDoubleClick=9]="EditorDoubleClick",e[e.SidebarMouseMove=10]="SidebarMouseMove",e[e.ManageTeamsRowClick=11]="ManageTeamsRowClick",e[e.MobileTap=12]="MobileTap",e[e.CollectionSettingsClick=13]="CollectionSettingsClick",e[e.BaseTableRowClick=14]="BaseTableRowClick",e[e.NotificationClick=15]="NotificationClick",e[e.CollectionAutomationSettingsClick=16]="CollectionAutomationSettingsClick",e}({});const i={};function r(e){const t=i[e.context],n=e.event.nativeEvent||e.event;if(t!==n){var o;i[e.context]=n;"unhandled"===(null===(o=e.callback)||void 0===o?void 0:o.call(e))&&(i[e.context]=t)}}function a(e){r({event:e,context:o.EditorMouseDown,callback:()=>{}})}function s(e){r({event:e,context:o.EditorClick,callback:()=>{}})}const l=r},87290:(e,t,n)=>{n.d(t,{B:()=>l,x:()=>s});var o=n(55367),i=n(22294),r=n(86486),a=n(27724);let s=function(e){return e[e.Default=0]="Default",e[e.Hovered=1]="Hovered",e[e.Selected=2]="Selected",e[e.SelectedDescendant=3]="SelectedDescendant",e}({});function l(e,t){var n;const l=a.default.state.stores,c=r.default.state;if(1===l.length&&l.includes(e))return s.Selected;if(l.length>0&&l.every((t=>e.uiContains(t))))return s.SelectedDescendant;const d=o.ZP.state;return d&&d.isDragging&&d.currentParentStore&&e.uiContains(d.currentParentStore)||d&&d.isDragging&&d.currentDropZone&&d.currentDropZone.type===o.Dl.Selectable&&null!==(n=d.currentDropZone)&&void 0!==n&&n.store&&e.uiContains(d.currentDropZone.store)||c.isOpen&&c.currentStore===e||t&&!i.Z.state.isKeyboardMode?s.Hovered:s.Default}},45023:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(27537),i=n.n(o),r=n(72126);const a=function e(t,n,o){if(Array.isArray(o))return o.some((o=>e(t,n,o)));{const e=o.toLowerCase().split("+");if(t.device.isWindows||t.device.isLinux){if((r.q9(e,"command")||r.q9(e,"ctrl"))!==n.ctrlKey)return!1}else{if(r.q9(e,"command")!==n.metaKey)return!1;if(r.q9(e,"ctrl")!==n.ctrlKey)return!1}return r.q9(e,"shift")===n.shiftKey&&(r.q9(e,"alt")===n.altKey&&r.yW(e,(e=>{if("command"===e||"shift"===e||"ctrl"===e||"alt"===e)return!0;const t="code:";if(e.startsWith(t)&&n.code){const o=e.substr(t.length);return n.code.toLowerCase()===o}return i()(n.keyCode)===e})))}}},92783:(e,t,n)=>{n.d(t,{Z:()=>o});const o=e=>{const{spaceViewStore:t,pageId:n}=e;if(!t||!n)return!1;return-1!==t.getBookmarkedPageIds().indexOf(n)}},28314:(e,t,n)=>{n.d(t,{lF:()=>a,yA:()=>i});var o=n(49085);const i=function(){return r},r={shift:!1,option:!1,control:!1,command:!1},a=o.default.createValue(r),s=function(e){r.shift=Boolean(e.shiftKey),r.option=Boolean(e.altKey),r.control=Boolean(e.ctrlKey),r.command=Boolean(e.metaKey),a.emit()};window.addEventListener("keydown",s),window.addEventListener("keyup",s),window.addEventListener("focus",(function(e){r.shift=!1,r.option=!1,r.control=!1,r.command=!1,a.emit()}))},78429:(e,t,n)=>{n.d(t,{H:()=>r});var o=n(95477),i=n(77080);function r(){return o.default.isAdminMode||"on"===i.default.getEligibleGroup({experimentId:"highlight_legacy_transclusions",defaultGroup:"control"})}},48709:(e,t,n)=>{n.d(t,{FV:()=>c,Fs:()=>m,Ts:()=>f,ZG:()=>p,cX:()=>d,dY:()=>h,hy:()=>u,uP:()=>g});var o=n(99405),i=n(70203),r=n(64002),a=n(95477),s=n(23178);function l(e,t){const n=s.Z.state;n.open&&n.focusLinkInput!==e&&s.Z.setState({...n,focusLinkInput:e,url:t?"":n.url})}function c(){l(!0),p(!1)}function d(){l(!1)}function u(){l(!1,!0)}function p(e){const t=s.Z.state;t.open&&t.focusTitleInput!==e&&s.Z.setState({...t,focusTitleInput:e})}function m(e){const{editingToken:t}=e;if(!t)return;const n=i.hDy(t),o=i.rlz(n);return o?i.zW$(o):void 0}function f(e){if(!e)return;const t=i.hDy(e);return i.rlz(t)?i.WiV(e):void 0}function g(e){return e.url||""}function h(e){const t=i.rOz(e);if(t&&"url"===t.type){const e=(0,o.Wj)({url:t.href,baseUrl:a.default.domainBaseUrl,publicDomainName:a.default.publicDomainName,isMobile:!1,protocol:void 0,currentUrl:void 0});return"page"===e.name?{type:"notion",url:t.href,notionPage:e}:{type:"web",url:t.href}}const n=(0,r.yn)(e);if(n)return{type:"other",url:n}}},28125:(e,t,n)=>{n.d(t,{S:()=>s,k:()=>a});var o=n(13991),i=n(77080),r=n(12955);function a(e){const{mobileNative:t}=e;if(t){const n=Boolean(t.sqliteConnection),o=r.canSetCookie(e);return n&&o}return!0}function s(e){return"en-US"===o.SP&&(e.device.isElectron&&i.default.checkGate("desktop_app_signup_hide_passcode")||e.device.isMobileNative&&e.device.isIOS&&i.default.checkGate("ios_app_signup_hide_passcode"))}},87279:(e,t,n)=>{n.d(t,{Xp:()=>s,mw:()=>l,og:()=>i,qW:()=>c});var o=n(67381);let i=function(e){return e[e.Modal=0]="Modal",e[e.ActionSheet=1]="ActionSheet",e[e.Popup=2]="Popup",e}({});const r="menu",a=(0,o.Q)({modernContextDefaultValue:{menuType:void 0},displayName:r,legacyContextKey:r}),s=a.context,l=a.legacyPropTypes,c=a.Provider},85818:(e,t,n)=>{n.d(t,{$6:()=>a,Ds:()=>i,_K:()=>r,tM:()=>s});var o=n(72126);function i(e,t){let n=0;for(let o=0;o<t.length;o+=1){const i=t[o];if(e>n+i.items.length-1){n+=i.items.length;continue}const r=e-n,a=i.items[r];if(!a)return;return{item:a,index:{section:o,indexLocal:r}}}}function r(e,t){const n=t[e.section];if(!n)return;const o=n.items[e.indexLocal];return o||void 0}function a(e,t){return o.Sm(t.slice(0,e.section).map((e=>e.items.length)))+e.indexLocal}function s(e){return e.reduce(((e,t)=>e+t.items.length),0)}},98742:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(72126),i=n(77744);function r(e,t){const n={...e};return Object.keys(t).forEach((r=>{const a=t[r],s=e[r];s&&r.startsWith("on")&&o.mf(a)?n[r]=function(){s(...arguments),a(...arguments)}:s&&("ref"===r||r.endsWith("Ref"))&&a?n[r]=(0,i.lq)(s,a):s||(n[r]=a||s)})),n}},64496:(e,t,n)=>{n.d(t,{_3:()=>a,fP:()=>r,qE:()=>i});var o=n(5162);function i(){return window.__mobileExperimentCache}function r(e,t,n){if(n)return t&&n.userExperiments?n.userExperiments[t]:{experimentsBySpace:{},experimentsWithoutSpace:n.deviceExperiments,isLoaded:!0,userId:void 0,deviceId:e,test:!1}}function a(e){return(0,o.Y)("supportsMobileExperimentCache")}},52533:(e,t,n)=>{n.d(t,{S$:()=>a,Y2:()=>r,nd:()=>i});n(97880);var o=n(11342);n(95477);let i=function(e){return e[e.Bottom=0]="Bottom",e[e.Floating=1]="Floating",e}({});function r(e){const{environment:t}=e;return!t.device.isIOS&&!t.device.isAndroid}function a(e){const{environment:t}=e;if(!t.device.isIOS)return!1;if(!t.mobileNative||!t.mobileNative.api.openUpgradeModal)return!1;{if(!t.device.mobileAppVersion)return!1;const e=o.parseVersion(t.device.mobileAppVersion),n=o.parseVersion("0.4.165");if(!e||!n)return!1;return!o.isLessThanVersion(e,n)}}},39500:(e,t,n)=>{n.d(t,{N9:()=>r,Nf:()=>a,Vc:()=>i,X9:()=>s,uG:()=>l});var o=n(27186);const i={mouse:6,finger:0,stylus:6};function r(e){return 3===e.button||4===e.button}function a(e){return e&&"stylus"===e.touchType?"stylus":"finger"}const s=function(){return o.IL.moved};function l(e){return!!e.isTrusted&&s()}},75770:(e,t,n)=>{n.d(t,{lQ:()=>E,hD:()=>B,cJ:()=>Z,HE:()=>R,uw:()=>F,EC:()=>M,ah:()=>P,vz:()=>D,ru:()=>L,ed:()=>j,NV:()=>T});n(21703),n(67294);var o=n(53877),i=n(69246),r=n(21202),a=n(6287),s=n(15047),l=n(29369),c=n(97880),d=n(5366),u=n(47307),p=n(74523),m=n(80444),f=n(55367),g=n(35661),h=n(99757),v=n(33929),b=n(35026),y=n(98165),S=n(67669),_=n(18514),w=n(38755),k=n(85644),I=n(82990),C=n(85893);async function x(){return u.confirmUserAction({message:(0,C.jsx)("span",{children:(0,C.jsx)(d.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <boldtext>Only you will be able to access it.</boldtext>",id:"confirmDialog.movePageToPrivate.message",values:{boldtext:e=>(0,C.jsx)("span",{style:{fontWeight:I.Z.fontWeight.semibold},children:e})}})}),acceptLabel:(0,C.jsx)(d.FormattedMessage,{defaultMessage:"Move to private",id:"confirmDialog.movePageToPrivate.confirmButton.label"})})}const T=(0,d.defineMessages)({privateDestinationName:{id:"moveToHelpers.destinationName.private",defaultMessage:"Private"},numPagesDescriptorString:{id:"moveToHelpers.movePageDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}}"},numPagesWithSubitemsDescriptorString:{id:"moveToHelpers.movePagesWithSubitemsDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}} and {numSubitemsMoved, plural, one {# sub-item} other {# sub-items}}"},numBlocksDescriptorString:{id:"moveToHelpers.moveBlocksDescriptorString",defaultMessage:"{numBlocksMoved, plural, one {# block} other {# blocks}}"},bookmarksDestinationName:{id:"moveToHelpers.destinationName.favorites",defaultMessage:"Favorites"},movedMessagesWithDestinationToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessageWithDestination",defaultMessage:"Moved {pageDescriptor} to {destinationName}"},movedToDestinationShortToast:{id:"moveToHelpers.afterMoveCompleteOnMobileToastMessageWithDestination",defaultMessage:"Moved to {destinationName}"},movedMessagesToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessage",defaultMessage:"Moved {pageDescriptor}"}});function M(e){const{movedItems:t,numSubitems:n}=e;if(!(t.filter((e=>e.isNavigableBlock())).length===t.length))return v.default.formatMessage(T.numBlocksDescriptorString,{numBlocksMoved:t.length});if(1===t.length){const e=A(t[0]);if(e)return e}return n?v.default.formatMessage(T.numPagesWithSubitemsDescriptorString,{numPagesMoved:t.length-n,numSubitemsMoved:n}):v.default.formatMessage(T.numPagesDescriptorString,{numPagesMoved:t.length})}const P=e=>{const{environment:t,movedItems:n,moveToLocation:o,numSubitems:i}=e,r=M({movedItems:n,numSubitems:i}),a=function(e){const{environment:t,moveToLocation:n}=e,{currentSpaceStore:o}=m.default.getState();if(void 0===n||void 0===o)return;switch(n.type){case"moveToBlock":return A(n.blockStore);case"moveToCollection":return A(n.collectionStore);case"moveToCurrentWorkspace":return(0,w.rn)(t,o);case"moveToPrivatePages":return v.default.formatMessage(T.privateDestinationName);case"moveToTeam":return A(n.teamStore);case"moveToOtherWorkspace":return(0,w.rn)(t,n.spaceStore);case"moveToBookmarks":case"moveToShared":return;default:(0,c.t1)(n)}}({environment:t,moveToLocation:o});return a?t.device.isPhone?v.default.formatMessage(T.movedToDestinationShortToast,{destinationName:a}):v.default.formatMessage(T.movedMessagesWithDestinationToast,{pageDescriptor:r,destinationName:a}):v.default.formatMessage(T.movedMessagesToast,{pageDescriptor:r})};const A=e=>{var t;const n=v.default.getIntl();if(e)return null===(t=e.getModel())||void 0===t?void 0:t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:o.x7,intl:n})},R=(e,t)=>{const{currentSpaceStore:n}=m.default.getState(),o=("space"===e.type?e.id:e.spaceId)??(null==n?void 0:n.id);if(void 0===n||void 0===o)return;const i=(e=>{var t;const{currentUserRootStore:n,currentSpaceStore:o}=m.default.state;return(null==o?void 0:o.id)===e?o:null==n||null===(t=n.getSpaceViewStores())||void 0===t||null===(t=t.find((t=>{var n;return(null===(n=t.getSpaceStore())||void 0===n?void 0:n.id)===e})))||void 0===t?void 0:t.getSpaceStore()})(o);if(i){if(i.id!==n.id)return{type:"moveToOtherWorkspace",spaceStore:i,targetParentId:"space-private-pages"!==e.type?e.id:i.id};switch(e.type){case"page":{const t=m.default.state.mainEditorCurrentBlockStore;if(!t)return;return{type:"moveToBlock",blockStore:g.G.createChildStore(t,{table:r.iU,id:e.id})}}case"collection":return{type:"moveToCollection",collectionStore:g.NW.createChildStore(i,{table:a.v,id:e.id})};case"space":return{type:"moveToCurrentWorkspace"};case"space-private-pages":return{type:"moveToPrivatePages"};case"team":return{type:"moveToTeam",teamStore:g.zX.createChildStore(i,{table:l.e0,id:e.id})};default:(0,c.t1)(e)}}},D=e=>{const{droppedDirection:t,targetStore:n,outlinerSectionType:o}=e,{currentSpaceStore:r}=m.default.getState();if(!r||!o)return;let a=n;if("block"===(null==n?void 0:n.table)&&t!==f.vh.Onto){if("bookmarks"===o)return{type:"moveToBookmarks"};if("shared"===o)return{type:"moveToShared"};a=null==n?void 0:n.getParentStore()}if(void 0===a)return;if(r.id===a.id)return(e=>{switch(e){case"workspace":return{type:"moveToCurrentWorkspace"};case"bookmarks":return{type:"moveToBookmarks"};case"private":return{type:"moveToPrivatePages"};case"shared":return{type:"moveToShared"};case"team":case i.kg:case i.PT:case i.cz:case i.mu:case i.g$:return;default:(0,c.t1)(e)}})(o);switch(a.table){case"block":return{type:"moveToBlock",blockStore:a};case"team":return{type:"moveToTeam",teamStore:a}}};function B(e){let{environment:t,blocks:n}=e;if(h.n.state)return{canMoveBlocks:!1,reason:{key:"unknown"}};for(const o of n){if(o.getParentTable()===l.e0){const e=(0,y.VP)(o);if(!e||!(0,b.si)({teamStore:e,environment:t}))return{canMoveBlocks:!1,reason:{key:"lockedTopLevelTeamPage"}}}if(!o.canAdmin())return{canMoveBlocks:!1,reason:{key:"needsFullAccess"}};if(!S.KE({environment:t,block:o})){const e=o.getParentStore();return{canMoveBlocks:!1,reason:{key:"needsEditAccessOnParent",parentStore:e instanceof g.G?e:void 0}}}}return{canMoveBlocks:!0}}function E(e){let{environment:t,blocks:n}=e;return B({environment:t,blocks:n}).canMoveBlocks}function F(e){const{type:t}=e,{mainEditorCurrentBlockStore:n,currentSpaceStore:o}=m.default.state;if(!o)throw new Error("currentSpaceStore not found");const i=n||o;if("space"!==t&&e.spaceId&&e.spaceId!==o.id)return g.H2.createChildStore(i,{table:s.bx,id:e.spaceId});switch(t){case"space-private-pages":return g.H2.createChildStore(i,{table:s.bx,id:o.id});case"space":return g.H2.createChildStore(i,{table:s.bx,id:e.id});case"page":return g.G.createChildStore(i,{table:r.iU,id:e.id});case"collection":return g.NW.createChildStore(i,{table:a.v,id:e.id});case"team":return g.zX.createChildStore(o,{table:l.e0,id:e.id,spaceId:o.id});default:(0,c.t1)(t)}}async function Z(){return await u.confirmUserAction({message:(0,C.jsx)("b",{children:(0,C.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmTitle",defaultMessage:"Some content and settings may be broken on the duplicated page."})}),description:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:{marginBottom:8},children:(0,C.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription1",defaultMessage:"This may include: links, relations, permissions, page history, and more."})}),(0,C.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription2",defaultMessage:"This page will remain unchanged in the current workspace, and a duplicate version will be created in the workspace you have chosen."}),(0,C.jsx)(p.Z,{title:(0,C.jsx)("div",{children:(0,C.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmHelpLink",defaultMessage:"Learn more"})}),href:(0,_.UY)("guides.duplicateToSpace"),analyticsFrom:"move_to_confirm_duplicate_to_space",style:{marginTop:12}})]}),acceptLabel:(0,C.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmAcceptLabel",defaultMessage:"I understand, duplicate"})})}function L(e){let{targets:t,destination:n,direction:o,draggingOutlinerType:i}=e;if(o===f.vh.Onto&&t.some((e=>e.id===n.id)))return!0;const r=void 0!==(0,y._A)(n);return!(!t.some((e=>(0,k.AY)(e)))||!r)||!("bookmarks"===i||!function(e){let{targets:t,destination:n,direction:o}=e;if(!t.some((e=>e.isCollectionView())))return!1;if(n.isCollectionView()&&!(0,k.AY)(n)){if(o===f.vh.Onto)return!0;if(!n.getRecordStoreUIParent())return!0}const i=n.getAssociatedCollectionStore();if(o!==f.vh.Onto&&i&&!i.isPageTreeCollection())return!0;return!1}({targets:t,destination:n,direction:o}))}async function j(e){const t=function(e){const{from:t,environment:n}=e;if("moveTo"===t){const{moveToValue:t}=e.moveToArgs;return R(t,n)}if("dragAndDrop"===t){const{destination:t,direction:o,destinationOutlinerType:i}=e.dropArgs;return D({targetStore:t,droppedDirection:o,outlinerSectionType:i,environment:n})}}(e),n=await async function(e){const{blocks:t,environment:n,moveToLocation:o,from:i}=e;if(!o||"moveToOtherWorkspace"===o.type||"moveToBookmarks"===o.type)return{confirmed:!0,shouldClearPagePermissions:!1};const r="moveToPrivatePages"===o.type,a="moveTo"===i?e.moveToArgs.destination:e.dropArgs.destination,s=a&&V({stores:[a],environment:n});if(!r&&!s)return{confirmed:!0,shouldClearPagePermissions:!1};if(!V({stores:t,environment:n})){return await x()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}if(!r)return{confirmed:!0,shouldClearPagePermissions:!1};const l=n.currentUser.id;if(t.some((e=>{const t=e.getPermissionItems();return 0!==t.length&&(1!==t.length||"user_permission"!==t[0].type||t[0].user_id!==l)}))){return await x()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}return{confirmed:!0,shouldClearPagePermissions:!1}}({...e,moveToLocation:t});if(!n.confirmed)return{confirmed:!1};const{shouldClearPagePermissions:o}=n;return{confirmed:!0,shouldClearPagePermissions:o}}function V(e){const{stores:t,environment:n}=e,{currentSpaceStore:o}=m.default.state;if(!o)return!1;for(const i of t){const e=(0,y.u3)(i);if(!((null==e?void 0:e.table)===r.iU&&e.isTopLevelPrivatePage({spaceStore:o,environment:n})))return!1}return!0}},68056:(e,t,n)=>{n.d(t,{NV:()=>u,QY:()=>m,TD:()=>f,_v:()=>a,e6:()=>p,iG:()=>c,k_:()=>s,ko:()=>d,qS:()=>l,yt:()=>h});var o=n(97880),i=n(89086);function r(e,t){return e.store===t.store&&e.index===t.index}function a(e,t){return!e&&!t||!(!e||!t)&&(r(e.start,t.start)&&r(e.end,t.end))}function s(e){return{start:{...e.start},end:{...e.end}}}function l(e){return!e||e.start.store===e.end.store}function c(e){return l(e)&&e.start.index===e.end.index}function d(e){return 0===e.start.index&&c(e)}function u(e){return c(e)&&(0,i.J_)(e.start.store,{startIndex:e.start.index,endIndex:e.end.index})}function p(e,t){const n=[e.start.store,e.end.store];return n.includes(t.start.store)||n.includes(t.end.store)}function m(e){if(e)return l(e)?{store:e.start.store,selection:{startIndex:e.start.index,endIndex:e.end.index}}:void 0}function f(e){const{store:t,selection:n}=e;if(t&&n)return{start:{store:t,index:n.startIndex},end:{store:t,index:n.endIndex}}}const g=(0,o.AO)((e=>e&&"object"==typeof e&&"store"in e&&"index"in e?{true:e}:{false:e})),h=(0,o.AO)((e=>{if("object"==typeof e&&e&&"start"in e&&"end"in e){const{start:t,end:n}=e;if(g(t)&&g(n))return{true:e}}return{false:e}}))},45162:(e,t,n)=>{n.d(t,{$r:()=>B,Aw:()=>F,L5:()=>w,Nj:()=>P,W9:()=>T,Zb:()=>I,fx:()=>R,r:()=>_,ri:()=>Z,tp:()=>M,uZ:()=>E,xI:()=>y});n(21703);var o=n(55010),i=n(45060),r=n(41432),a=n(92595),s=n(68626),l=n(73597),c=n(70842),d=n(28685),u=n(26842),p=n(14976),m=n(46150),f=n(68056),g=n(69645),h=n(73959),v=n(89224),b=n(89086);function y(e,t){const n=(0,f.QY)(t);return n||s.rateLimitedLog({from:"multiTextSelectionHelpers",type:"TODO",level:"warning",data:{name:e,message:e}}),n}const S={startIndex:0,endIndex:1/0};function _(e,t){const{start:n,end:i}=e;if((0,f.qS)(e))return n.store===t?"contained-within":void 0;if(n.store===t)return"starts-at";if(i.store===t)return"ends-at";const r=d.E.findNodeFromStore(n.store),a=d.E.findNodeFromStore(i.store),s=d.E.findNodeFromStore(t);return r&&a&&s&&1===(0,o.Z)(s,r)&&-1===(0,o.Z)(s,a)?"covers":void 0}function w(e){const{start:t,end:n}=e,o=(0,f.QY)(e);if(o){const e=d.E.findEditableWithStore(o.store);if(e){return[{editable:e,...o}]}return[]}const i=k(t),r=k(n);if(!i||!r){const e=i||r;if(!e)return[];return[{editable:e.editable,store:e.position.store,selection:{startIndex:e.position.index,endIndex:e.position.index}}]}const a=(0,b.yR)(i.editable).filter((e=>{var t,n,o;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===(null===(n=i.editable.contentEditableContext)||void 0===n?void 0:n.id)&&(null===(o=e.getNode())||void 0===o?void 0:o.isConnected)})),s=a.findIndex((e=>e.props.store.id===i.editable.props.store.id)),l=a.findIndex((e=>e.props.store.id===r.editable.props.store.id));if(-1===s){throw Object.assign(new Error("Start editable not found in DOM order array"),i)}if(-1===l){throw Object.assign(new Error("End editable not found in DOM order array"),r)}if(!(s<=l))throw new Error(`Start (index ${s}) must be before end (index ${l}) in DOM`);const c=a.slice(s,l+1);return c.map(((e,t)=>{if(0===t){const{position:t}=i;return{editable:e,store:e.props.store,selection:{startIndex:t.index,endIndex:1/0}}}if(t===c.length-1){const{position:t}=r;return{editable:e,store:e.props.store,selection:{startIndex:0,endIndex:t.index}}}return{editable:e,store:e.props.store,selection:S}}))}function k(e){const t=d.E.findEditableWithStore(e.store);if(t)return{editable:t,position:e}}function I(e){var t;const{range:n,contentEditableLeafRegistry:o,allowInvisibleEndSelection:i,constraintToContentEditableRootNode:r}=e;if(!n)return;if(r&&r!==(0,m.xp)(n.commonAncestorContainer))return;let a,s=!1,l=o.getParentContentEditableLeaf(n.startContainer);l||(a??=o.getByDOMOrder(),l=(0,v.snapContainerOffsetToNode)({nodesInDomOrder:a,containerOffset:{container:n.startContainer,offset:n.startOffset},snapTowards:"end"}),s=!0,n.startContainer,n.startOffset);let c=o.getParentContentEditableLeaf(n.endContainer);if(!c||!i&&c&&0===n.endOffset&&n.endContainer===c.node&&c.node!==(null===(t=l)||void 0===t?void 0:t.node)){a??=o.getByDOMOrder();const e=a.findIndex((e=>{var t;let{node:n}=e;return n===(null===(t=l)||void 0===t?void 0:t.node)})),t=-1!==e?a.slice(e):a,r=c&&!i?t.filter((e=>{var t;let{node:n}=e;return n!==(null===(t=c)||void 0===t?void 0:t.node)})):t;c=(0,v.snapContainerOffsetToNode)({nodesInDomOrder:r,containerOffset:{container:n.endContainer,offset:n.endOffset},snapTowards:"start"}),s=!0,n.endContainer,n.endOffset}if(!l||!c){const e=l??c;if(!e)return;return{start:e,end:e,forceEmit:!0}}return{start:l,end:c,forceEmit:s}}function C(e){const t=e.getTitleStore();if(t){if(d.E.findNodeFromStore(t))return t}}function x(e){for(const t of e){const e=C(t);if(e)return{blockStore:t,titleStore:e}}}function T(e){const t=x(e);if(!t)return;const n=function(e){return x([...e].reverse())}(e);if(!n)return;const o=(0,g.dq)({includeNonSelectableListContainer:!1,root:t.blockStore.getHighestContentBlockUIAncestor()});if(!o)return;const i=(0,g.Ib)(n.blockStore,o);if(!i)return;let r;for(const a of(0,l.JK)(i)){const e=a.value.store.getTitleStore();if(e){const t=(0,b.x0)(e);t&&(r={store:e,index:t.endIndex})}}if(!r)return;return{start:{store:t.titleStore,index:0},end:r}}function M(e){var t;const{multiSelection:n,filterCommonAncestors:o,focus:i}=e;if((0,f.qS)(n)){var a;let e=(0,h.sQ)(n.start.store);if((null===(a=e)||void 0===a?void 0:a.getType())===r.Ti.tableRow){var s;const t=null===(s=e.getRecordStoreUIParent())||void 0===s?void 0:s.recordStoreUIParentStore;t&&t instanceof u.G&&(e=t)}if(!e)return;return{stores:[e]}}const c=P({multiSelection:n,includeNonSelectable:!1});if(!c)return;const d=o?(0,l.tL)(c.treeRange):(0,l.bu)(c.treeRange),p=Array.from(d),m=p[0],g=null==m||null===(t=m.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id,b=p.filter((e=>{var t;return(null===(t=e.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id)===g||e.value.store.getType()===r.Ti.table})).map((e=>e.value.store));return{stores:b,pivot:"end"===i||i===n.end||void 0===i&&!(0,v.selectionIsBackwards)()?b[b.length-1]:b[0]}}function P(e){const{multiSelection:t,includeNonSelectable:n}=e,o=(0,h.sQ)(t.start.store),i=(0,h.sQ)(t.end.store);if(!o||!i)return;const r=o.getHighestContentBlockUIAncestor(),a=(0,g.dq)({includeNonSelectableListContainer:n,root:r});if(!a)return;const s=(0,g.v5)(o,[a]),l=(0,g.v5)(i,[a]);if(!s||!l)return;const d=c.T.fromNearestCommonAncestor(s,l);return d?{tree:a,treeRange:d}:void 0}function A(e){const{leafNode:t,rangeContainer:n,defaultEndIndex:i}=e,r=(0,o.Z)(t,n);let a=0;if(-1===r)a=i;else{if(1!==r)throw new Error("Invalid relativeStartPosition. index should not be inside leaf");a=0}return{index:a,forceEmit:!0,afterEndOfLine:!1}}function R(e){var t,n,o,i;const{range:r,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s}=e;if(!r)return;let l,c,u=!1;if(a&&a.hasMembers()){const e=I({range:r,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s,constraintToContentEditableRootNode:void 0});e&&(l=e.start.node,c=e.end.node,u||=e.forceEmit)}else l=(0,m.X1)(r.startContainer),c=(0,m.X1)(r.endContainer);const f=l?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===l})):void 0,g=c?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===c})):void 0;if(!f||!g)return;const h=!r.collapsed,v=f.props.store;let y=g.props.store;const{startContainer:S,endContainer:_}=r,w=(null===(t=(n=g.props).getEndSelection)||void 0===t?void 0:t.call(n).endIndex)??0,k=(null===(o=l)||void 0===o?void 0:o.contains(r.startContainer))&&(0,p.Qb)(r.startContainer,r.startOffset)||A({leafNode:l,rangeContainer:S,defaultEndIndex:w});let C=(null===(i=c)||void 0===i?void 0:i.contains(r.endContainer))&&(0,p.Qb)(r.endContainer,r.endOffset)||A({leafNode:c,rangeContainer:_,defaultEndIndex:w});if(h&&C.afterEndOfLine){const e=(0,b.hn)(y);e&&(r.endContainer,r.endOffset,y=e,C={index:0,forceEmit:!0,afterEndOfLine:!1})}return{multiSelection:{start:{store:v,index:k.index},end:{store:y,index:C.index}},forceEmit:u||k.forceEmit||C.forceEmit}}function D(e,t){if(!e&&!t)return 0;if(!t)return-1;if(!e)return 1;if(e.store===t.store)return e.index-t.index;const n=d.E.findNodeFromStore(e.store),i=d.E.findNodeFromStore(t.store);return(0,o.Z)(n,i)}function B(e,t){const[n,o]=[e,t].sort(D);return{start:n,end:o}}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,v.selectionIsBackwards)();return t?{focus:e.start,anchor:e.end}:{focus:e.end,anchor:e.start}}function F(e){return e.device.isAndroid?"gesture":e.device.isAndroid||e.device.isIOS||e.device.isElectron||e.device.isSafari||e.device.isChrome?"always":void 0}function Z(e){return e.isChrome&&96===parseInt(e.browserVersion,10)}(0,a.exposeDebugValue)("multiTextSelectionToBlockSelection",M),(0,i.Rw)({canFormat:e=>(0,f.yt)(e),header(e){const{table:t,tr:n,td:o,object:r,CONTAINER_STYLE:a}=i.TI,s=d.E.findNodeFromStore(e.start.store),l=d.E.findNodeFromStore(e.end.store);return t(a,n({},o({},"start:"),o({},r(e.start.index)," in"),o({},r(e.start.store)),o({},r(s))),n({},o({},"end:"),o({},r(e.end.index)," in"),o({},r(e.end.store)),o({},r(l))))},hasBody:e=>!1,body:e=>null})},17652:(e,t,n)=>{n.d(t,{H:()=>r,r:()=>i});var o=n(77080);function i(){return"on"===o.default.getEligibleGroup({experimentId:"improved_product_notif_email_and_settings",defaultGroup:"control"})}function r(){return"on"===o.default.getEligibleGroup({experimentId:"inbox_2_0",defaultGroup:"control"})}},99445:(e,t,n)=>{n.d(t,{UF:()=>l,bW:()=>s,yk:()=>r,yt:()=>i});var o=n(15095);function i(e){let t=0,n=0,o="";for(;e>0;)t=(e-1)/26,n=(e-1)%26,e=Math.floor(t),o=String.fromCharCode(97+n)+o;return o}function r(e){let t=0,n=0;const o=e.split("").reverse();for(const i of o){t+=(i.charCodeAt(0)-96)*26**n,n+=1}return t}const a={"m̄":1e6,"d̄":5e5,"c̄":1e5,"l̄":5e4,"x̄":1e4,"v̄":5e3,m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};function s(e){let t="";for(const n in a){const o=Math.floor(e/a[n]);if(o>=0)for(let e=0;e<o;e++)t+=n;e%=a[n]}return t}function l(e){const t=o.p4(e);let n,i,r,s,l=0;for(let o=0;o<t.length;o++){if(n=t[o],i=n?a[n]:void 0,r=t[o+1],s=r?a[r]:void 0,!i)return-1;s&&i<s?l-=i:l+=i}return l}},45950:(e,t,n)=>{n.d(t,{Dx:()=>p,Ye:()=>u,ne:()=>m,yY:()=>d});n(21703),n(57658);var o=n(72126),i=n(59753),r=n(45953),a=n(33361),s=n(21202),l=n(18245),c=n(77080);async function d(e){const{environment:t,recordPointers:n,recurFn:o,recordIsRequired:s}=e,l=r.PF.create();return await a.uf({recordPointers:n,recordMap:l,recurFn:(e,t)=>o(e,t),loadRecordModel:async e=>{const n=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e,userId:t.currentUser.id});if(n)return n;const o=t.defaultRecordCache.persistedRecordCache;if(o){const n=await o.get(e,t.currentUser.id);if(n)return{model:i.kk.fromValue(e.table,n.value),role:n.role}}if(s(e))throw new Error(`Failed to load a required record: ${e.table}, ${e.id}, ${e.spaceId}.`)}}),l}async function u(e){const{environment:t}=e,n=e.environment.currentUser.id;if(e.inMemoryRecordCache)return e.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n});let o=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n});if(void 0!==o)return o;if(e.useInMemoryCacheOnly)return;if(e.prefetchPromise&&"pending"===e.prefetchPromise.state.status&&(await e.prefetchPromise.wrappedPromise,o=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n}),void 0!==o))return o;const{persistedRecordCache:r}=e.environment.defaultRecordCache;if(r){const t=await r.get(e.pointer,n);if(t)return{model:i.kk.fromValue(e.pointer.table,t.value),role:t.role}}}async function p(e){const{parent:t,inMemoryRecordCache:n,environment:o}=e,r=[],a=e.environment.currentUser.id,l=e.environment.defaultRecordCache.persistedRecordCache;if(l&&n===o.defaultRecordCache.inMemoryRecordCache){return(await l.getBlocksWithParent({parent:t,userId:a})).map((e=>({model:i.kk.fromValue(s.iU,e.value),role:e.role})))}return n.forEachRecord(a,(e=>{let{model:n,role:o}=e;n.table===s.iU&&n.parent_table===t.table&&n.parent_id===t.id&&r.push({model:n,role:o})})),r}async function m(e){const{environment:t,inMemoryRecordCache:n}=e,r=i.kk.fromCollection(e.collection);if(!r)return[];const a=r.pointer;if(!r.isPageTreeCollection()){const e=l.default.mark("collections.get_local_pages_in_collection"),o=p({environment:t,parent:a,inMemoryRecordCache:n});return l.default.measure(e,{environment:t}),o}const u=r.getRootPagePointer(),m=c.default.checkGate("wiki_perf_improvement_local_enabled"),f=l.default.mark("collections.get_local_pages_in_collection_wiki"),g=m?await async function(e){const{rootPagePointer:t,environment:n}=e,o=[],i=(e,n)=>e.table!==s.iU?[]:(e.pointer.id===t.id||"page"!==e.type&&"collection_view_page"!==e.type||o.push({model:e,role:n}),e.getContentIds().map((t=>({table:s.iU,id:t,spaceId:e.spaceId}))));return await d({environment:n,recordPointers:[t],recurFn:i,recordIsRequired:()=>!1}),o}({environment:t,rootPagePointer:u}):await async function(e){const{rootPagePointer:t,environment:n,inMemoryRecordCache:i}=e;let r=[t];const a=[];for(;r.length>0;){const e=r.map((e=>p({environment:n,parent:e,inMemoryRecordCache:i}))),t=(await Promise.all(e)).flat();for(const n of t){var s;const e=null==n||null===(s=n.model)||void 0===s?void 0:s.type;"page"!==e&&"collection_view_page"!==e||a.push(n)}r=o.oA(t.map((e=>{var t;return null===(t=e.model)||void 0===t?void 0:t.pointer})))}return a}({environment:t,rootPagePointer:u,inMemoryRecordCache:n});return l.default.measure(f,{environment:t,data:{status:m?"v2":"v1"}}),g}},35026:(e,t,n)=>{n.d(t,{EE:()=>T,N:()=>P,P4:()=>M,Pl:()=>C,Ps:()=>R,Q2:()=>w,Yz:()=>A,l6:()=>S,si:()=>x,vs:()=>_});n(57658),n(30541);var o=n(15145),i=n(41432),r=n(42875),a=n(15157),s=n(72126),l=n(69246),c=n(21202),d=n(70279),u=n(29369),p=n(64684),m=n(70203),f=n(97880),g=n(35661),h=n(13105),v=n(75770);const b=new Set([i.Ti.page,i.Ti.collectionView,i.Ti.collectionViewPage,i.Ti.alias]),y=new Set([i.Ti.factory]);function S(e){const{allSharedPages:t,state:n,intl:o,teamStore:i}=e,{query:a,filter:s}=n;return t.map((e=>{if(!e.isDefined())return;const t=e.getLastEditedTime()||e.getCreatedTime();if(!t)return;const n=e.getLastEditedByPointer()??e.getCreatedByPointer(),c=e.getParentId();if(i){if("owned"===s&&c!==i.id)return;if("shared"===s&&c===i.id)return}return(0,l.fY)({block:e.getModel(),query:a,getRecordModel:e.getRecordModel,userTimeZone:(0,r.r)(),intl:o})?{blockId:e.id,timestamp:t,authorPointer:n}:void 0})).filter(f.$K)}function _(e){const{sharedPageItems:t}=e;return s.MR(t,(e=>{let{timestamp:t}=e;return t})).reverse()}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b;const o=[],i=new Set,r=[e];for(;r.length>0;){const a=r.shift();if(i.has(a.id))continue;i.add(a.id);const s=I(a,e,t,n);o.push(...s.outlinerItems),r.unshift(...s.subtree)}return o}const k=new h.P({debugName:"getOutlinerItemsStoresInSubtreePageMentions",memoizeRecursion:!1,deepEquals:!1,compute(e){var t;const n=null===(t=e.getTitleStore())||void 0===t?void 0:t.getValue(),o=m.cCA(n);return e.getRecordStoreArray(e,o).filter((t=>t.getParentId()===e.id)).concat(e.getContentStores())}});function I(e,t,n,o){var r;const a=e.getType();if(a&&n.has(a)||(null===(r=e.getModel())||void 0===r||null===(r=r.getAliasTargetPointer())||void 0===r?void 0:r.table)===d.x_)return{outlinerItems:[],subtree:[]};if(a&&e!==t&&o.has(a))return{outlinerItems:[e],subtree:[]};const s=e.getType()===i.Ti.transclusionReference?e.getTransclusionReferenceTargetStore():e;if(!s)return{outlinerItems:[],subtree:[]};return{outlinerItems:[],subtree:k.getStateFor(s)}}function C(e){let{environment:t,draggingStores:n,parentStore:o,currentSpaceStore:i}=e;if(!t.currentUser.id)return!1;if(!n.every((e=>e.isNavigableBlock())))return!1;if(!(0,v.lQ)({environment:t,blocks:n}))return!1;if((null==o?void 0:o.table)===u.e0){return x({environment:t,teamStore:g.zX.createChildStore(i,{table:u.e0,id:o.id,spaceId:i.id})})}return!0}function x(e){let{environment:t,teamStore:n}=e;const o=t.currentUser.id;if(!n.isDefined())return!1;return!(n.getDisableTeamPageEdits()&&o&&!(0,p.pd)({membership:n.getMembers()},o))&&n.canAddOrRemoveTopLevelPages()}function T(e){let{typeWithTeam:t,sidebarState:n,currentSpaceViewStore:o,environment:i}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStores();case"bookmarks":return o.getBookmarkedPages();case"workspace":return o.getWorkspacePages();case"shared":return n.visibleSharedPagesStores;case"private":return o.getPrivatePages(i);default:(0,f.t1)(t)}}function M(e){let{typeWithTeam:t,currentSpaceStore:n,currentSpaceViewStore:o}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStore();case"bookmarks":return o.getBookmarkedPagesStore();case"workspace":return n.getPagesStore();case"shared":return o.getSharedPagesStore();case"private":return o.getPrivatePagesStore();default:(0,f.t1)(t)}}function P(e){switch(e){case"bookmarks":return o.tY.SidebarBookmark;case"workspace":return o.tY.SidebarWorkspace;case"shared":return o.tY.SidebarShared;case"private":return o.tY.SidebarPrivate;case"team":return o.tY.SidebarTeam;case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":return o.tY.SidebarTeamBrowser;case l.g$:return o.tY.SidebarPublicPageTemplateIncludes;default:(0,f.t1)(e)}}function A(e){return w(g.G.createChildStore(e,{table:c.iU,id:e.id}),y,b)}function R(e){const{store:t,toggleStore:n,toOpen:o,environment:i,isTopLevelItem:r}=e;n.setState({...n.state,open:o}),r&&a.Z.set({userId:i.currentUser.id,key:`Outliner-${t.id}`,value:o})}},78873:(e,t,n)=>{n.d(t,{E:()=>s,c:()=>l});var o=n(54642),i=n(97799),r=n(69503),a=n(92083);function s(e){const{environment:t,onSubmit:n,onCancel:o}=e;t.device.isMobile?i.Z.setState({open:!0}):a.Z.setState({open:!0,openedFrom:"login",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0}),r.Z.setState({open:!0,setNewPassword:!0,password:"",repeatPassword:"",isSet:!1,onSubmit:n,onCancel:o})}async function l(e){const{environment:t,userEmail:n}=e,i=await o.getLoginOptions(t,{email:n});if("failed"===i.type)return{error:i.error};const r=i.data;return{value:{isSamlEnforced:"required"===r.samlSignIn,didLogInWithSaml:"available"===r.samlSignIn&&r.hasAccount&&"saml"===r.lastLoginMethod,hasPassword:"required"!==r.samlSignIn&&r.hasAccount&&r.passwordSignIn}}}},98165:(e,t,n)=>{n.d(t,{D0:()=>G,Dg:()=>Z,Eb:()=>R,KU:()=>O,Om:()=>B,Pj:()=>j,RC:()=>$,VP:()=>V,_A:()=>N,e3:()=>W,fJ:()=>A,fl:()=>z,n3:()=>q,oZ:()=>K,qA:()=>P,s:()=>D,u3:()=>L,uJ:()=>E,wf:()=>F,yI:()=>H});n(57658);var o=n(41432),i=n(72126),r=n(63306),a=n(27006),s=n(73360),l=n(74446),c=n(45953),d=n(606),u=n(98963),p=n(18844),m=n(21202),f=n(6287),g=n(70279),h=n(33709),v=n(91644),b=n(15047),y=n(29369),S=n(97880),_=n(80444),w=n(35661),k=n(13105),I=n(65598);function C(e,t){const{table:n,id:o,spaceId:i}=t,r=i||e.pointer.spaceId;if(n===f.v)return w.NW.createChildStore(e,{table:f.v,id:o});if(n===b.bx)return w.H2.createChildStore(e,{table:b.bx,id:o});if(n===m.iU)return w.G.createChildStore(e,{table:m.iU,id:o});if(n===g.x_){if(r)return w.T5.createChildStore(e,{table:g.x_,id:o,spaceId:r})}else if(n===h.qF){if(r)return w.jQ.createChildStore(e,{table:h.qF,id:o,spaceId:r})}else if(n===y.e0){if(r)return w.zX.createChildStore(e,{table:y.e0,id:o,spaceId:r})}else if(n===p.Xj){if(r)return w.zq.createChildStore(e,{table:p.Xj,id:o,spaceId:r})}else if(n===u.cv&&r)return w.Mz.createChildStore(e,{table:u.cv,id:o,spaceId:r})}function x(e){const t=_.default.state.mainEditorCurrentBlockStore;return t?t.inMemoryRecordCache!==e.inMemoryRecordCache?e:t:e}function T(e){const t=x(e);return((n=e)instanceof w.G||n instanceof w.H2||n instanceof w.NW||n instanceof w.T5||n instanceof w.jQ||n instanceof w.zX||n instanceof w.zq||n instanceof w.Mz)&&e.getRecordStoreUIParent()===t?e:C(t,e.pointer);var n}const M=new k.P({debugName:"getPathStores",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){const n=e.getValue();if(!n||!(0,s.oK)(n))return[e];const o=d.dr.getParentPointerFromRecordWithParent(n),i=C(x(e),o);return i?[e].concat(t(i)):[e]}}),P=function(e){const t=T(e);return t?M.getStateFor(t):[]};function A(e){return i.oA(P(e).map((e=>{if("space"===e.table){if(!(0,I.Mm)(e))return;return function(e){const{pointer:t}=e,n=(0,w.Vh)(e,t,"permissions").getValue(),o=(0,w.Vh)(e,t,"permission_groups").getValue();return{table:t.table,value:{id:t.id,permissions:n,permission_groups:o}}}(e)}if("block"===e.table){const{pointer:t}=e,n=(0,w.Vh)(e,t,"permissions").getValue(),o=(0,w.Vh)(e,t,"alive").getValue(),i=(0,w.Vh)(e,t,"parent_id").getValue(),r=(0,w.Vh)(e,t,"type").getValue();if(void 0!==o&&void 0!==i&&void 0!==r)return{table:t.table,value:{id:t.id,permissions:n,alive:o,parent_id:i,type:r}}}else if(e.table===y.e0){const{pointer:t}=e,n=(0,w.Vh)(e,t,"permissions").getValue(),o=(0,w.Vh)(e,t,"membership").getValue(),i=(0,w.Vh)(e,t,"settings").getValue();if(!i)return;return{table:t.table,value:{id:t.id,permissions:n||[],membership:o||[],settings:i,is_default:e.isDefault()}}}})))}function R(e){const{store:t,teamPermissionItems:n}=e,o=c.Ao.create(),i=j(t)||_.default.state.currentSpaceStore;return i&&n.forEach((e=>{const t=w.zX.createChildStore(i,{table:y.e0,id:e.team_id,spaceId:i.id}),n=(0,w.Vh)(t,t.pointer,"membership").getValue();o.set({id:t.id,table:y.e0,spaceId:i.id},{membership:n,is_default:t.isDefault()})})),o}async function D(e){const t=[];return await r.ne(e.pointer,l.zF.fromMonomorphicFunctionUnsafe((async n=>{let o;if(n.table===f.v?o=w.NW.createChildStore(e,n):n.table===b.bx?o=w.H2.createChildStore(e,n):n.table===m.iU?o=w.G.createChildStore(e,n):n.table===g.x_?o=w.T5.createChildStore(e,n):n.table===h.qF&&(o=w.jQ.createChildStore(e,n)),o)return t.push(o),await o.load(),o.getValue()}))),t}const B=function(e){const t=w.t1.fromV1(e);if(t instanceof w.G||t instanceof w.NW){const e=t.getParentTable(),n=t.getParentId();if(e&&n){if(e===f.v)return w.NW.createChildStore(t,{table:f.v,id:n});if(e===b.bx)return w.H2.createChildStore(t,{table:b.bx,id:n});if(e===m.iU)return w.G.createChildStore(t,{table:m.iU,id:n});if(e===g.x_)return w.T5.createChildStore(t,{table:g.x_,id:n,spaceId:t.getSpaceId()});if(e===y.e0)return w.zX.createChildStore(t,{table:y.e0,id:n});if(e===p.Xj)return w.zq.createChildStore(t,{table:p.Xj,id:n,spaceId:t.getSpaceId()});if(e===v.AT)return w.Vf.createChildStore(t,{table:v.AT,id:n,spaceId:t.getSpaceId()});(0,S.t1)(e)}}},E=function(e){return P(e).filter((e=>{if(!e.canRead())return!1;if(e instanceof w.G){const t=e.getType();return t&&(0,o.S9)(t)}return e instanceof w.zX}))},F=function(e){const t=P(e).find((e=>{let t;return(e instanceof w.G||e instanceof w.NW)&&(t=e.getAlive()),!1===t}));return Boolean(t)},Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=E(e)[t];return n instanceof w.zX?Z(n,t+1):n},L=function(e){const t=E(e);return t[t.length-1]},j=function(e){return P(e).find((e=>e.table===b.bx))},V=function(e){const t=P(e);return U(t)},U=function(e){return e.find((e=>e.table===y.e0))},O=e=>e.find((e=>e.table===y.e0)),N=function(e){return P(e).find((e=>{var t;return e.table===m.iU&&(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))},z=function(e){for(const t of e)if((t instanceof w.G||t instanceof w.NW)&&(!t.isDefined()||!t.getAlive()))return!1;return!0},H=function(e){for(const t of e)if(t instanceof w.G||t instanceof w.NW){if(!t.isDefined())continue;if(!t.getAlive())return!0}return!1};function W(e){for(const t of e)if(t instanceof w.G){if(!t.isDefined())continue;const e=t.getMovedStore().getValue();if(void 0!==e)return{store:t,moved:e}}}function q(e){return"block"===e.table||"space"===e.table||"collection"===e.table||"comment"===e.table||"discussion"===e.table}const G=function(e){const t=P(e).find((e=>{if(e.table===y.e0)return Boolean(e.getArchivedBy())}));return Boolean(t)};function K(e){const t=P(e);for(const n of t)if(n.table===b.bx)return n.getSettings().space_request}function $(e){const{environment:t,store:n}=e,o=t.currentUser.id;if(!o)return!1;const i=P(n);if(!i.every((e=>Boolean(e.isReady()))))return;if(!!i.some((e=>Boolean(e instanceof w.G&&!e.isDefined()))))return!1;return!i.some((e=>{if(e instanceof w.G){const t=(e.getPermissionItemsStore().getValue()||[]).find((e=>(0,a.$D)(e)||(0,a.hV)(e)||(0,a.ix)(e)||(0,a.RI)(e)||(0,a.ZQ)(e)||(0,a.FB)(e)||(0,a.jg)(e)&&e.user_id!==o));return Boolean(t)}return e instanceof w.zX}))}},85957:(e,t,n)=>{n.d(t,{I_:()=>h,PQ:()=>p,Tx:()=>c,mH:()=>d,wq:()=>u,x$:()=>m,yT:()=>g});var o=n(15145),i=n(24646),r=n(4926),a=n(38072),s=n(88923),l=n(27724);function c(){return s.default.isMiniOrCenterPeekOpen()||l.default.isInPeekRenderer()}function d(){const e=s.default.state;return e.open&&(c()||e.isOpening)}function u(e){return Boolean(e.findRecordStoreUIAncestor((e=>e===s.default.peekTarget.state)).ancestor)}function p(e){const t=r.Z.state;return s.default.isSidePeekOpen()?(0,i.vJ)(e):s.default.isCenterPeekOpen()?Math.min(e.WindowSizeStore.state.width-2*s.PeekModeOuterPadding,s.CenterPeekModeOuterWidth+t):s.default.isMiniPeekOpen()?Math.max(Math.min(e.WindowSizeStore.state.width*s.MiniPeekWidthPercentage,s.MiniPeekModeMaxWidth+t),s.MiniPeekModeMinWidth+t):0}function m(e){return s.default.isMiniPeekOpen()&&!g()&&!f[e]}const f={text:!0,bulleted_list:!0,numbered_list:!0,to_do:!0,toggle:!0,header:!0,sub_header:!0,sub_sub_header:!0,quote:!0,callout:!0,divider:!0,page:!1,personal_home_page:!1,code:!1,equation:!1,bookmark:!1,external_object_instance:!1,file:!1,audio:!1,image:!1,video:!1,embed:!1,tweet:!1,drive:!1,gist:!1,maps:!1,framer:!1,invision:!1,figma:!1,loom:!1,typeform:!1,mixpanel:!1,codepen:!1,pdf:!1,collection_view:!1,collection_view_page:!1,column_list:!1,column:!1,breadcrumb:!1,factory:!1,copy_indicator:!1,link_to_collection:!1,link_to_page:!1,alias:!1,transclusion_container:!1,transclusion_reference:!1,table_of_contents:!1,whimsical:!1,miro:!1,abstract:!1,sketch:!1,excalidraw:!1,replit:!1,hex:!1,deepnote:!1,table:!1,table_row:!1,tab:!1,external_object_instance_page:!1,button:!1,ai_block:!1,drawing:!1};function g(){return h()&&"page"===a.Z.state.pageType}function h(){return s.default.state.open&&s.default.state.creationSource===o.tY.SidebarQuickAdd}},67669:(e,t,n)=>{n.d(t,{BZ:()=>Z,Dt:()=>O,IJ:()=>C,JI:()=>P,KE:()=>L,Kz:()=>B,Oc:()=>T,S4:()=>x,U7:()=>V,UK:()=>M,WE:()=>N,YF:()=>F,YO:()=>I,Z9:()=>D,dA:()=>R,mU:()=>U,r_:()=>E,su:()=>j,uY:()=>z,yi:()=>A,zT:()=>W});n(67635),n(57658);var o=n(66897),i=n(72126),r=n(63306),a=n(26825),s=n(27006),l=n(4615),c=n(21202),d=n(29369),u=n(19889),p=n(47425),m=n(64684),f=n(97880),g=n(80444),h=n(83212),v=n(35661),b=n(78291),y=n(88893),S=n(98165),_=n(65598),w=n(38755),k=n(95697);function I(e){const t=S.fJ(e),n=a.KJ(t);return a.YO(n)}function C(e,t){const{id:n}=e.currentUser;if((0,w.C)()&&(0,w.Fn)(e))return;let i;if(n){const e=t.getRecordValue({table:u.KJ,id:n});e&&(i=(0,o.dp)(e))}const r=S.qA(t).map((e=>e.getModel())).filter(f.$K);return a.IJ({actor:i,ancestors:r})}function x(e){return I(e).map((e=>{let{permissionItem:t}=e;return t})).some((t=>s.$D(t)&&s.YX(t.role)&&(void 0===t.allow_duplicate||!0===t.allow_duplicate)&&(!e.isTypedCollectionViewBlock()||e.isCollectionViewPageWithContent())))}function T(e){return I(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>s.$D(e)))}function M(e){return I(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>s.ix(e)))}async function P(e){const{currentUserRootStore:t}=g.default.state;if(!t)return!1;if(!(0,l.e)(e))return!1;const n=v.G.createChildStore(t,{table:c.iU,id:e});return await n.load(),T(n)}function A(e,t){let n;if(n=t instanceof v.H2?(0,w.jv)(t):I(t).map((e=>{let{permissionItem:t}=e;return t})),1===n.length){const[t]=n;return"user_permission"===t.type&&s.zz(t.role)&&t.user_id===e.currentUser.id}return!1}function R(e,t){const{data:n}=b.default.state;if(!n)return!1;if(Boolean(n&&y.YK(n)))return!1;const o=y.ND(n).map((e=>e.userId)),i=y.hn(n).map((e=>e.userId)),r=new Set([...o,...t].filter((e=>!i.includes(e)))),a=(0,p.tP)("free");return r.size>Math.max(a,o.length)}function D(){const{data:e}=b.default.state;if(!e)return!1;if(Boolean(e&&y.YK(e)))return!0;const t=y.ND(e).map((e=>e.userId)),n=(0,p.tP)("free");return t.length<n}function B(e){const{environment:t,store:n,permissionItems:o}=e;if(n instanceof v.H2)return!1;const{data:i}=b.default.state;if(!i)return!1;return R(0,o.filter(s.jg).filter((e=>"none"!==e.role)).map((e=>e.user_id)))}function E(e){return{editor:"Full access",read_and_write:"Can edit",comment_only:"Can comment",reader:"Can read",none:"No access"}[e]}function F(e){return!!e&&(e.hasPublicPermission&&"edit"!==e.permission)}function Z(e){return!!e&&(e.hasPublicPermission&&"view"===e.permission)}function L(e){let{environment:t,block:n}=e;const o=n.getParentStore();if(!o)return!1;return!F(S.n3(o)&&h.Z.getMode(t,o))&&o.canEdit()}function j(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const n=e.find((e=>"user_permission"===e.type&&e.user_id===t));return n&&n.role||"none"}function V(){const{currentSpaceStore:e}=g.default.state;return"enterprise"===(null==e?void 0:e.getSubscriptionTier())}function U(e,t){const n=new Set;var o;(0,_.Y)(e)?null===(o=e.getPermissionItems())||void 0===o||o.forEach((e=>{s.jg(e)&&n.add(e.user_id)})):e.getPermissionItems().forEach((e=>{s.jg(e)&&n.add(e.user_id)}));return t.filter((e=>"existingUser"!==e.type||!n.has(e.value.id)))}function O(e){let{userId:t,store:n}=e;return N({userId:t,store:n})[0]}function N(e){let{userId:t,store:n}=e;const o=r.DW(n.pointer,n.getRecordModel),l=S.Pj(n)||g.default.state.currentSpaceStore,c=l&&l.isDefined()&&!o.findLast(a.zX)?[...o,l.getModel()]:o,d=I(n),p=S.VP(n),m=d.filter((e=>{let{permissionItem:t}=e;return(s.zU(t)||s.LW(t))&&t.team_id!==(null==p?void 0:p.id)})).map((e=>e.permissionItem)),f=S.Eb({store:n,teamPermissionItems:m}),h=a.J3({explicitTeamsRecordMap:f}),v=a.qY({actorPointer:{table:u.KJ,id:t},ancestors:c,permissionsContext:h}).map((e=>e.permissionItem));if(0===v.length)return[{type:"user_permission",role:"none",user_id:t}];const b=i.oA(v.map((e=>e.role))),y=a.nl(...b);return v.filter((e=>e.role===y)).sort(H)}function z(e){let{userId:t,store:n}=e;const o=r.DW(n.pointer,n.getRecordModel),i=S.Pj(n)||g.default.state.currentSpaceStore,l=i&&i.isDefined()&&!o.findLast(a.zX)?[...o,i.getModel()]:o,p=I(n),f=S.VP(n),h=p.filter((e=>{let{permissionItem:t}=e;return(s.zU(t)||s.LW(t))&&t.team_id!==(null==f?void 0:f.id)})).map((e=>e.permissionItem)),v=S.Eb({store:n,teamPermissionItems:h}),_=a.J3({explicitTeamsRecordMap:v}),w=a.qY({actorPointer:{table:u.KJ,id:t},ancestors:l,permissionsContext:_}),C=[...w];w.find((e=>"user_permission"===e.permissionItem.type))||C.push({permissionItem:{type:"user_permission",role:"none",user_id:t},from:{table:c.iU,blockId:n.id}});const{data:x}=b.default.state,T=new Set(x?y.ND(x).map((e=>e.userId)):[]);if(null!=T&&T.has(t))return C.sort(((e,t)=>H(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>s.xm[t.permissionItem.role??"none"]-s.xm[e.permissionItem.role??"none"]));!w.find((e=>"explicit_team_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==f?void 0:f.id)))&&f&&(0,k.AL)({teamStore:f,spaceStore:i,userId:t})&&C.push({permissionItem:{type:"explicit_team_permission",role:"none",team_id:f.id},from:{table:d.e0,teamId:f.id}});!w.find((e=>"explicit_team_owner_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==f?void 0:f.id)))&&f&&(0,m.pd)({membership:f.getMembers()},t)&&C.push({permissionItem:{type:"explicit_team_owner_permission",role:"none",team_id:f.id},from:{table:d.e0,teamId:f.id}});return w.find((e=>"space_permission"===e.permissionItem.type))||C.push({permissionItem:{type:"space_permission",role:"none"},from:{table:c.iU,blockId:n.id}}),C.sort(((e,t)=>H(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>s.xm[t.permissionItem.role??"none"]-s.xm[e.permissionItem.role??"none"]))}function H(e,t){const n=s.jg(e),o=s.jg(t);if(n||o)return n&&o?0:n?-1:1;const i=s.hV(e),r=s.hV(t);if(i||r)return i&&r?0:i?-1:1;const a=s.Lq(e),l=s.Lq(t);return a||l?a&&l?0:a?-1:1:0}function W(e){const{botStore:t,addPermission:n}=e,o=n?a.uH(t.getCapabilities()):"none",i=t.getParentId(),r=t.getParentTable();let s={type:"bot_permission",bot_id:t.id,role:o};return i&&r&&(s={type:"bot_permission",bot_id:t.id,role:o,parent_id:i,parent_table:r}),s}},45101:(e,t,n)=>{n.d(t,{Aw:()=>C,Bu:()=>P,DF:()=>A,Ji:()=>j,NN:()=>M,Nd:()=>x,OA:()=>F,ZK:()=>L,Zp:()=>R,a_:()=>E,cm:()=>T,fR:()=>O,gQ:()=>V,t0:()=>U,xT:()=>B,z5:()=>D});n(57658),n(67294);var o=n(15070),i=n(8848),r=n(5366),a=n(27006),s=n(4615),l=n(21202),c=n(15047),d=n(97880),u=n(82990),p=n(7928),m=n(50906),f=n(47307),g=n(80444),h=n(29677),v=n(78291),b=n(88893),y=n(35057),S=n(28020),_=n(33929),w=n(65598),k=n(16639),I=n(85893);async function C(e){let{environment:t,permissionsInviteStoreState:n,from:o}=e;const i=(0,I.jsx)(r.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Discard changes?"}),a=(0,I.jsx)(r.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationButton.label",defaultMessage:"Yes"}),s=(0,I.jsx)(r.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.cancelButton.label",defaultMessage:"Cancel"});if(n.inviteTargets.length>0){const e=await f.confirmUserAction({message:i,acceptLabel:a,cancelLabel:s});return m.q_n(t,{...E(t,n),from:o,discard_changes:e}),!e}return!1}const x=e=>{const{target:t,permissionsInviteStore:n}=e;return n.state.inviteTargets.find((e=>"newUser"===t.type?"newUser"===e.type&&t.value.email===e.value.email:e.type===t.type&&e.value.id===t.value.id))},T=e=>{const{targetStore:t,permissionsInviteStore:n,userTarget:o}=e;return!!x({permissionsInviteStore:n,target:o})||"existingUser"===o.type&&R({target:o,store:t})},M=e=>{const{targetStore:t,permissionsInviteStore:n,currentInviteActors:i}=e;if(!i)return{inviteUsers:[],inviteGroups:[],inviteBots:[]};const r=i.inviteUsers.filter((e=>!T({targetStore:t,permissionsInviteStore:n,userTarget:e})));return{inviteBots:i.inviteBots.filter((e=>!(!e.value.alive||x({permissionsInviteStore:n,target:e})||!(0,o.oA)(e.value)&&!(0,o.c9)(e.value))&&!R({target:e,store:t}))),inviteGroups:i.inviteGroups.filter((e=>!x({permissionsInviteStore:n,target:e})&&!R({target:e,store:t}))),inviteUsers:r,importedContacts:i.importedContacts}},P=(e,t)=>{if(!e||!t||0===e.length||0===t.length)return t;const n=new Set(e.map((e=>e.value.email.toLowerCase())));return t.filter((e=>!n.has(e.value.email.toLowerCase())))},A=e=>{const{intl:t,target:n}=e;switch(n.type){case"newUser":return n.value.email;case"existingUser":return(0,p.Nz)(t,n.value);case"bot":return(0,o.Mh)(n.value);case"group":return(0,k.kF)({intl:t,group:n.value});default:(0,d.t1)(n)}},R=e=>{const{target:t,store:n}=e;return!!n.isDefined()&&((0,w.Y)(n)?n.getMembers().filter((e=>{switch(t.type){case"existingUser":return"user"===e.entity_type&&t.value.id===e.user_id;case"group":return"group"===e.entity_type&&t.value.id===e.group_id}})).length>0:n.getPermissionItems().some((e=>{switch(t.type){case"existingUser":return(0,a.jg)(e)&&e.user_id===t.value.id;case"bot":return(0,a.FB)(e)&&e.bot_id===t.value.id;case"group":return(0,a.hV)(e)&&e.group_id===t.value.id;case"newUser":return!1;default:return(0,d.t1)(t)}})))};function D(e){const{environment:t,permissionsInviteStore:n,store:o,renderInShareModal:i}=e;n.setState({modalOpen:!i,tokenQuery:"",inviteTargets:[],inviteRole:B(e),isInviteTargetsEmpty:!0,table:(0,w.Mm)(o)?c.bx:l.iU,flowId:(0,s.ZP)(),inputFocus:"invitee",emailMessage:""}),(0,w.Mm)(o)?m.$zQ(t):m.Mqg(t,{...E(t,e.permissionsInviteStore.state)})}function B(e){const{store:t,isSubscribed:n}=e;return(0,w.Mm)(t)?n?"read_and_write":"editor":(0,y.Mk)()?"editor":"read_and_write"}function E(e,t){var n;const{isInviteTargetsEmpty:o,inviteRole:i,flowId:r}=t,a=(0,S.np)(),s=null==a?void 0:a.getRole(),l=null===(n=g.default.state.currentSpaceStore)||void 0===n?void 0:n.getRole(),{inviteTargets:c,emailMessage:d}=t,u=(0,y.zt)(),p={invite_flow_id:r,user_count:0,is_bot:!1,invite_message_length:(null==d?void 0:d.length)??0,...s&&{page_current_user_role:s},...l&&{space_role:l},...u&&{subscription_tier:u}};if(o)return p;if(0===c.length)return p;if(function(e){return e.length>0&&"bot"===e[0].type}(c))return{...p,is_bot:!0};const m=c.filter(h.cl).length,f=c.filter(h.fZ).length+m;return{...p,role:i,user_count:f,new_user_count:m}}function F(e){return"newUser"===e.type||"existingUser"===e.type&&("none"===e.spaceRole||"not_in_space"===e.spaceRole)}const Z=(0,r.defineMessages)({workspaceOwnerTooltip:{id:"inviteUserModal.userRole.workspaceOwnerBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a workspace owner in this workspace"},workspaceOwnerBadge:{id:"inviteUserModal.userRole.workspaceOwnerBadge.label",defaultMessage:"Workspace Owner"},adminTooltip:{id:"inviteUserModal.userRole.adminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is an admin in this workspace"},adminBadge:{id:"inviteUserModal.userRole.adminBadge.label",defaultMessage:"Admin"},membershipAdminTooltip:{id:"inviteUserModal.userRole.membershipAdminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a membership admin in this workspace"},membershipAdminBadge:{id:"inviteUserModal.userRole.membershipAdminBadge.label",defaultMessage:"Membership admin"},memberTooltip:{id:"inviteUserModal.userRole.memberBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a member in this workspace"},memberBadge:{id:"inviteUserModal.userRole.memberBadge.label",defaultMessage:"Member"},guestTooltip:{id:"inviteUserModal.userRole.guest.tooltip",defaultMessage:"{ userNameAndEmail} is a guest in this workspace"},guestBadge:{id:"inviteUserModal.userRole.guestBadge.label",defaultMessage:"Guest"}});function L(e){const{environment:t,customStyle:n}=e,{device:o}=t;return{display:"inline-flex",height:18,textTransform:"uppercase",fontSize:10,marginBottom:2,fontWeight:u.Z.fontWeight.medium,letterSpacing:1,color:i.ZP.uiLightGray,border:`1px solid ${i.ZP.uiLightGray}`,minWidth:70,alignItems:"center",justifyContent:"center",paddingTop:o.isAndroid?2:1,paddingBottom:1,paddingLeft:3,paddingRight:3,borderRadius:3,...n}}function j(e){const{role:t,intl:n,nameOrEmail:o}=e,i=o||n.formatMessage({id:"userTypeTooltip.generalPerson",defaultMessage:"This person"});switch(t){case"editor":return{tooltip:n.formatMessage(Z.workspaceOwnerTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.workspaceOwnerBadge)};case"membership_admin":return{tooltip:n.formatMessage(Z.membershipAdminTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.membershipAdminBadge)};case"read_and_write":return{tooltip:n.formatMessage(Z.memberTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.memberBadge)};case"none":return{tooltip:n.formatMessage(Z.guestTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.guestBadge)};default:(0,d.t1)(t)}}function V(e){return F(e)?"rgba(246, 192, 80, 0.26)":void 0}function U(e){var t;const{inviteTargets:n,recordStore:o,canEditSpaceMembership:i}=e;if(0===n.length)return null;if(!o)return null;const{inviteTargetGuests:a,inviteTargetMembers:s}=function(e){const t=[],n=[];return e.forEach((e=>{F(e)?t.push(e):n.push(e)})),{inviteTargetGuests:t,inviteTargetMembers:n}}(n),l=i?[...s,...a]:s,c=i?[]:a,d=_.default.getIntl(),u=(0,w.OY)(o)?null===(t=o.getBlockTitleStore())||void 0===t?void 0:t.getValue():o.getName();return i||0===c.length?(0,I.jsx)(r.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.usersAddedMessage",defaultMessage:"{numberOfTargets, plural, one {Added {targetName} to {recordName}} other {Added {numberOfTargets} people to {recordName}}}",values:{numberOfTargets:l.length,targetName:A({intl:d,target:l[0]}),recordName:u}}):0===l.length?(0,I.jsx)(r.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.inviteRequestedMessage",defaultMessage:"{numberOfTargets, plural, one {Requested {targetName} for approval} other {Requested {numberOfTargets} invites for approval}}",values:{numberOfTargets:c.length,targetName:A({intl:d,target:c[0]})}}):(0,I.jsx)(r.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.userAddedAndRequestedText",defaultMessage:"{numberOfAddedTargets, plural, one {Added {addedTargetName}} other {Added {numberOfAddedTargets} people}} & {numberOfRequestedTargets, plural, one {requested {requestedTargetName} for approval} other {requested {numberOfRequestedTargets} people for approval}}",values:{numberOfAddedTargets:l.length,addedTargetName:A({intl:d,target:l[0]}),numberOfRequestedTargets:c.length,requestedTargetName:A({intl:d,target:c[0]})}})}function O(e){if("existingUser"!==e.type)return;const{data:t}=v.default.state,n=(t?b.CM(t):[]).find((t=>t.userId===e.value.id));return n?n.role:"not_in_space"}},13273:(e,t,n)=>{n.d(t,{Xt:()=>r,al:()=>l,jM:()=>s,yT:()=>a});var o=n(43250),i=n(62619);function r(e){const{menuElement:t,clickedElement:n}=e;return t!==n&&!t.contains(n)&&(!n.classList.contains("notion-link")&&!(n.closest(`.${o.mJW}`)&&!n.closest(`.${o.p1Q}`)&&!n.closest(`.${o.Nn$}`)&&!n.closest(`.${o.fHd}`)))}function a(e){if((0,i.sh)(e,(e=>e.classList&&(e.classList.contains(o.p1Q)||e.classList.contains(o.Nn$)||e.classList.contains(o.fHd)))))return!1;const t=(0,i.sh)(e,(e=>e.classList&&e.classList.contains(o.mJW)));return Boolean(t)}function s(e){const t=(0,i.sh)(e,(e=>e.classList&&e.classList.contains(o.Dkf)));return Boolean(t)}function l(e){const t=(0,i.sh)(e,(e=>e.classList&&e.classList.contains(o.RIA)));return Boolean(t)}},17504:(e,t,n)=>{n.d(t,{V:()=>r,Z:()=>a});var o=n(74948),i=n(12534);const r=e=>{(0,i.ZP)({event:e,context:i.Af.SidebarMouseMove,callback:()=>{o.close()}})},a=function(e){return e({onMouseMove:r})}},55227:(e,t,n)=>{n.d(t,{g7:()=>a,kF:()=>l});n(57658);var o=n(72126),i=n(70203),r=n(62619);function a(e){let t="";const n=document.createElement("div");n.innerHTML=e;const i=r.kd(n);for(const r of i){const e=o.YU(r.data);if(null!==r.parentElement&&r.parentElement!==n){t+=`<span class="${s({parent:r.parentElement,root:n}).join(" ")}">${e}</span>`}else t+=e}return t}function s(e){const{parent:t,root:n}=e,o=new Set;let i=t;for(;i&&i!==n;)i.classList.forEach((e=>{o.add(e)})),i=i.parentElement??void 0;return Array.from(o)}function l(e,t){const n={text:c(e),syntax:c(t)},o=u(d(n.text,n.syntax)),r={text:0,syntax:0},a={text:0,syntax:0},s=[],l=e.map(i.WiV).join("");for(const[i,c]of o){const e=i+c,o=t[r.syntax],d={value:l.substring(i,e),textTokenIndex:r.text,classNames:(p=o,p&&p[1])};s.push(d);const u=n.text[r.text],m=n.syntax[r.syntax];e>=a.text+u&&(r.text+=1,a.text+=u),e>=a.syntax+m&&(r.syntax+=1,a.syntax+=m)}var p;return s}const c=e=>e.map((e=>e[0].length)),d=(e,t)=>{const n=e.slice(),o=t.slice(),i=[];let r=0,a=0;for(;r<n.length&&a<o.length;){const e=n[r],t=o[a];e===t?(i.push(e),r+=1,a+=1):e<t?(i.push(e),r+=1,o[a]-=e):(i.push(t),n[r]-=t,a+=1)}return i},u=e=>{let t=0;return e.reduce(((e,n)=>(e.push([t,n]),t+=n,e)),[])}},70219:(e,t,n)=>{n.d(t,{b:()=>r});var o=n(95477),i=n(81236);function r(e){return t=>{const{RouterStore:n}=e;if("page"!==n.state.route.name||!n.state.route.requestedOnPublicDomain)return;const r=i.Z.getPublicSpaceData(e,t),a=(null==r?void 0:r.domain)||n.state.route;return`${window.location.protocol}//${a}.${o.default.publicDomainName}`}}},58239:(e,t,n)=>{n.d(t,{ZT:()=>d,k1:()=>c,lX:()=>a,rq:()=>s});var o=n(15157),i=n(21202),r=n(15047);async function a(e){let{currentUserId:t,spaceStore:n}=e;const i=o.Z.get({userId:t,key:l(n.id)});return p(n,n.loadRecordModel,i)}function s(e){let{currentUserId:t,spaceId:n,value:i}=e;o.Z.set({userId:t,key:l(n),value:i})}const l=function(e){return`quickAddParent3:${e}`};function c(e){let{currentUserId:t,spaceStore:n,databaseType:i}=e;if(!n)return;const r=o.Z.get({userId:t,key:u(n.id,i)});return i?r:p(n,n.loadRecordModel,r)}function d(e){let{currentUserId:t,spaceId:n,parent:i,databaseType:r}=e;o.Z.set({userId:t,key:u(n,r),value:i})}const u=function(e,t){return`quickAddTypedParent:${e}:${t||"default"}`};async function p(e,t,n){let o;if(n)if("page"===n.type){await t({table:i.iU,id:n.id})&&(o=n)}else if("space"===n.type){await t({table:r.bx,id:n.id})&&(o=n)}return o||{type:"space-private-pages",spaceId:e.id}}},15447:(e,t,n)=>{n.d(t,{Od:()=>f,Wk:()=>v,X4:()=>u,_5:()=>h,_k:()=>g,h_:()=>m,rw:()=>p});n(57658);var o=n(14577),i=n(72126),r=n(54642),a=n(18245),s=n(80444),l=n(77080),c=n(69327),d=n(29026);const u=new o.Z((()=>{const{currentSpaceStore:e}=s.default.state;if(!e)return[];return c.Z.getWithoutSubscribing(e.id).slice(0,1e3).filter((e=>!e.store.pathIsDead()))}),{debugName:"recentAlivePagesStore"});function p(e,t){if("object"==typeof t&&t){const{spaceId:e,blockId:n,visitedAt:o}=t.userPageVisit||{};if(!e||!n||!o)return;!function(e){let{spaceId:t,pageId:n,visitedAt:o}=e;const i=c.Z.getWithoutSubscribing(t),r=function(e){let{newRecentPage:t,currentRecentPages:n}=e;const o=n.filter((e=>e.pageId!==t.pageId)),i=o;let r=0;for(;r<o.length;r++)if(t.visitedAt>=o[r].visitedAt){i.splice(r,0,t);break}r===o.length&&i.push(t);return i}({newRecentPage:{pageId:n,visitedAt:o},currentRecentPages:i});c.Z.set(t,r),u.recompute()}({spaceId:e,pageId:n,visitedAt:o})}}async function m(e){let{environment:t,userId:n,spaceId:o}=e;const s=l.default.getGroup("search-more-recent-pages-in-local"),d="lazy-";let p;s.startsWith(d)&&(p=i.o5(s.slice(d.length))||void 0);const m=s.startsWith(d),f=a.default.mark("load_global_recent_pages_initial_load"),g=a.default.mark("load_global_recent_pages");async function h(e,i){const l=await r.getRecentPageVisits(t,{userId:n,spaceId:o,limit:e},n);"success"===l.type&&(a.default.measure(i,{environment:t,data:{experiment_group:s}}),c.Z.set(o,l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))))),u.recompute()}m?(h(p,g),await h(void 0,f)):await h(p,g)}async function f(e,t){var n,o;let{environment:i,userId:a,spaceId:s}=t;if(c.Z.getWithoutSubscribing(s).length>1e3)return!1;const l=await r.getRecentPageVisits(i,{userId:a,spaceId:s,beforeTimestamp:e,limit:d.Xv},a);if("success"!==l.type||l.data.pages.length<=0)return!1;const p=l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))),m=null===(n=c.Z.get(s))||void 0===n?void 0:n.length;c.Z.mergeRecentPages(p,s);const f=null===(o=c.Z.get(s))||void 0===o?void 0:o.length;return u.recompute(),m!==f}const g=["Today","Yesterday","Past Week","Past 30 Days","Older"];function h(e){const t=Date.now(),n=864e5,o=t-e,i=new Date(e).getDay(),r=new Date(t).getDay(),a=new Date(t);a.setDate(a.getDate()-1);const s=a.getDay();return i===r&&o<=n?"Today":i===s&&o<=1728e5?"Yesterday":o<=6048e5?"Past Week":o<=2592e6?"Past 30 Days":"Older"}function v(e){return null==e?void 0:e.map((e=>({visitedAt:e.visitedAt,pageId:e.pageId}))).sort(((e,t)=>t.visitedAt-e.visitedAt)).slice(0,50)}},44133:(e,t,n)=>{n.r(t),n.d(t,{getDebugSourcesForIdsInOperations:()=>c,setBlockIdDebugSource:()=>s,setupRecordCacheDebugging:()=>a});var o=n(39593);let i=!1;const r=new(n.n(o)())({max:1e4});function a(e){e.isMobile||(i=!0)}function s(e,t){i&&(r.has(e)||r.set(e,t))}const l=/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/g;function c(e,t){const n={blocks:{},isIdSourceCacheFull:r.itemCount===r.max},o=JSON.stringify(t),i=new Set(Array.from(o.matchAll(l)).map((e=>e[0])));for(const s of i){var a;let t=!1;const o={},i=r.get(s);i&&(t=!0,o.debugSource=i);const l=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:{table:"block",id:s},userId:e.currentUser.id});null!=l&&null!==(a=l.value)&&void 0!==a&&a.type&&(t=!0,o.blockType=l.value.type),t&&(n.blocks[s]=o)}return n}},65598:(e,t,n)=>{n.d(t,{D4:()=>j,GP:()=>H,HK:()=>V,M1:()=>Q,MF:()=>T,MI:()=>C,Mm:()=>G,No:()=>W,OY:()=>S,Oh:()=>$,PF:()=>F,SJ:()=>k,Xp:()=>E,Y:()=>y,ak:()=>L,al:()=>A,bB:()=>B,bQ:()=>N,dv:()=>P,dz:()=>Y,ig:()=>O,le:()=>U,mY:()=>D,p9:()=>Z,sl:()=>q,vV:()=>R,x8:()=>w,yJ:()=>_,zP:()=>z});var o=n(92595),i=n(68626),r=n(72126),a=n(606),s=n(70921),l=n(21202),c=n(70279),d=n(33709),u=n(15047),p=n(29369),m=n(97880),f=n(34047),g=n(35661),h=n(13105),v=n(98165);const b=128;function y(e){return e.table===p.e0}function S(e){return e.table===l.iU}function _(e){return A(e,{recursivelyLoadAllDiscussions:!1}).filter(f.De)}function w(e){return(0,g.Vh)(e,e.pointer,"discussions")}function k(e){let t=0;return e.findRecordStoreUIAncestor((n=>(n!==e&&e.id&&n.id===e.id&&n.table===e.table&&r.Xy(e.path,n.path)&&t++,!1))),t>1}const I=new h.P({debugName:"recursiveChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{switch(e.getType()){case"page":return;case"transclusion_reference":return e.getTransclusionReferenceTargetStore();default:return e}})).filter(m.$K).flatMap((e=>[e,...t(e)]))}});function C(e){return I.getStateFor(e)}const x=new h.P({debugName:"recursiveWihTransclusionChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{switch(e.getType()){case"page":return;default:return e}})).filter(m.$K).flatMap((e=>[e,...t(e)]))}});function T(e){return x.getStateFor(e)}const M=new h.P({debugName:"loadedDiscussionStores",memoizeRecursion:!1,deepEquals:!1,compute:function(e){const t=w(e),n=((null==t?void 0:t.getValue())||[]).map((t=>g.t1.createChildStore(e,a.dr.fromPointerLike({table:d.qF,id:t,spaceId:e.pointer.spaceId}))));return n.reverse(),n}});function P(e){return e.table===c.x_}function A(e,t){const n=t.excludeSelf?[]:[e],o=null!=t&&t.recursivelyLoadAllDiscussions?[...n,...I.getStateFor(e)]:n,i=new Set;return o.flatMap(M.getStateFor).filter((e=>!!(null!=t&&t.includeLoadingDiscussions||e.isDefined())&&(!i.has(e.id)&&(i.add(e.id),!0))))}function R(e,t){return B(A(e,t)).unresolved}function D(e,t){return B(A(e,t)).resolved}function B(e){const t=e.filter((e=>e.isDefined())),[n,o]=r.uK(t,(e=>e.getResolved()));return{resolved:n,unresolved:o}}function E(e,t){return(Array.isArray(e)?e:R(e,t)).reduce(((e,n)=>{const o=n.getValue();return o?t.onlyIncludeBlockLevelDiscussions&&!(0,f.De)(n)?e:e+(o.comments||[]).length:e}),0)}function F(e){if("text"!==e.getType())return!1;const t=e.getBlockTitleStore().getValue();return(!t||!t.length)&&(!e.hasContent()&&0===function(e,t){return R(e,t).length}(e,{recursivelyLoadAllDiscussions:!1}))}function Z(e){return(0,g.Vh)(e,e.pointer,"properties")}function L(e){return(0,g.Vh)(e,e.pointer,"comments")}function j(e){if(!e)return[];const t=L(e);return(t.getValue()||[]).map((e=>g.T5.createChildStore(t,{table:c.x_,id:e,spaceId:t.pointer.spaceId})))}function V(e){if(e.isDefined())return g.t1.createChildStore(e,e.getParentPointer())}function U(e){const t=O(e);return(t.getValue()||[]).map((n=>g.G.createChildStore(t,a.dr.fromPointerLike({table:l.iU,id:n,spaceId:e.pointer.spaceId}))))}function O(e){return(0,g.Vh)(e,e.pointer,"content")}function N(e){return(0,g.Vh)(e,e.pointer,"last_edited_time")}function z(e){return(0,g.Vh)(e,e.pointer,"text")}function H(e){if(e.isDefined())return g.t1.createChildStore(e,e.getParentPointer())}function W(e,t,n){return g.t1.createChildStore(e,{table:s.TY,id:t,spaceId:n})}function q(e){if(e.isDefined())return W(e,e.getActivityId(),e.getSpaceId())}function G(e){return e.table===u.bx}(0,o.exposeDebugValue)("getDiscussionStores",A);const K=r.P2((e=>{i.log(e)}),500),$=function(e){let t=e,n=0;for(;t;){if(!t.isReady())return!1;if(n>=b)return K({level:"error",from:"recordStoreHelpers",type:"areAncestorsLoaded",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:b,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;n+=1,t=(0,v.Om)(t)}return!0};async function Q(e){let t=e,n=0;for(;t;){if(t.isReady()||await t.load(),n>=b)return K({level:"error",from:"recordStoreHelpers",type:"loadAncestors",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:b,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;n+=1,t=(0,v.Om)(t)}}function Y(e){return e.table===l.iU&&r.Xy(e.path,["content"])}},37034:(e,t,n)=>{n.d(t,{NO:()=>u,V:()=>p,vU:()=>m});var o=n(17215),i=n(42875),r=n(82883),a=n(13493),s=n(35661),l=n(52821),c=n(78316),d=n(38755);function u(e,t){if(e.isDefined())return e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:t})}function p(e,t,n){if(e instanceof s.zX)return e.getName();if(e instanceof s.H2)return(0,d.rn)(n,e);if(e instanceof s.Xr){const t=e.getName();if(t)return t;const n=e.getType();return n?l.Bh[n]:void 0}if("none"===e.getRole())return o.x(t);if(!e.isDefined())return;const a=e instanceof s.G?e.getTitleValue():e.getName();return(0,r.X)({textValue:a,getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:t})}function m(e){const{environment:t,intl:n,untitledFallback:i,store:r}=e,s=i?n.formatMessage(i):function(e,t){if(e.table===a.n){const n=e.getType();if(n&&"page"!==n&&c.b1[n])return t.formatMessage(c.b1[n])}return o.Q2(t)}(r,n);return p(r,n,t)||u(r,n)||s}},42937:(e,t,n)=>{n.d(t,{Bq:()=>w,Gt:()=>h,K9:()=>S,OH:()=>b,Tq:()=>f,W3:()=>m,cn:()=>k,dH:()=>u,g3:()=>y,l7:()=>p,nB:()=>g,qi:()=>v,uM:()=>_,vi:()=>I});var o=n(42773),i=n(59341),r=n(41898),a=n(97880),s=n(5366),l=n(75081);const c=(0,s.defineMessages)({dependenciesPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.dependencies.propertySelectPopup.default.caption",defaultMessage:"This property will be used for dependencies in new views, and will set date shifting behavior across all views."},deleteDependenciesAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteDependenciesAcceptModal.title",defaultMessage:"Turn off dependencies?"},dependenciesMenuTitle:{id:"database.viewSettings.dependenciesTab.title",defaultMessage:"Dependencies"},dateShiftingSectionCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.caption",defaultMessage:"Automatic date shifting"},datePropertyPickerTitle:{id:"database.viewSettings.relationFeatures.datePropertyPicker.title",defaultMessage:"Shift using"},startDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.startDate",defaultMessage:"Start date"},endDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.endDate",defaultMessage:"End date"},advancedSettings:{id:"database.viewSettings.dependenciesAdvancedSettingsTab.title",defaultMessage:"Advanced settings"},newDateProperty:{id:"collectionSettings.dependenciesFeature.newDateProperty.name",defaultMessage:"Date"},doNotShiftButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.doNotShift.label",defaultMessage:"Do not automatically shift"},consumeGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.consumeGap.label",defaultMessage:"Shift only when dates overlap"},avoidWeekendsSwitcherTitle:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.title",defaultMessage:"Avoid weekends"},hideDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.hideDependenciesInView",defaultMessage:"Hide dependencies in view"},showDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.showDependenciesInView",defaultMessage:"Show dependencies in view"},turnOnDependenciesButton:{id:"collectionSettings.dependenciesView.turnOnDependenciesButton.label",defaultMessage:"Turn on dependencies"},turnOffDependenciesButton:{id:"database.viewSettings.relationsPropertyTab.removeDependenciesButton.title",defaultMessage:"Turn off dependencies"},dateShiftSuccess:{id:"collectionDateActions.dateShiftSuccess",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}"},dateShiftSomeNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftSomeNotUpdatedDueToPermissions",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}. Others could not be shifted because you do not have permission"},dateShiftAllNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftAllNotUpdatedDueToPermissions",defaultMessage:"The dates of dependent {items} could not be shifted because you do not have permission"},shiftingNotApplicableNoShiftingMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableNoShiftingMessage",defaultMessage:"The dates of dependent {items} in this view will not automatically shift. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicableConsumeGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableConsumeGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift when {item} dates overlap. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicablePreserveGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicablePreserveGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift maintaining the time between {items}. To change the date shifting behavior, update the default relation property in Advanced settings."},preserveGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.preserveGap.label",defaultMessage:"Shift & maintain time between {items}"},avoidWeekendsSwitcherCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.description",defaultMessage:"Prevent shifted {items} from starting or ending on weekends"},dependenciesMenuDescription:{id:"database.viewSettings.relationsPropertyTab.dependencies.description",defaultMessage:"Use dependencies to show {items} that are blocking — or blocked by — other {items}."},dependenciesPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.dependencies.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the {items} that are blocked. We use “Blocking” as our default."}}),d=(0,s.defineMessages)({hideSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.hideSubitemsInView",defaultMessage:"Hide sub-{items} in view"},showSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.showSubitemsInView",defaultMessage:"Show sub-{items} in view"},turnOnSubItemsButton:{id:"collectionSettings.subitemsView.turnOnSubitemsButton.label",defaultMessage:"Turn on sub-{items}"},turnOffSubItemsButton:{id:"database.viewSettings.relationsPropertyTab.removeSubItemsButton.title",defaultMessage:"Turn off sub-{items}"},subItemsMenuTitle:{id:"database.viewSettings.subItemsTab.title",defaultMessage:"Sub-{items}"},subItemsMenuDescription:{id:"database.viewSettings.relationsPropertyTab.subitems.description",defaultMessage:"Use sub-{items} to break large {items} into smaller, more manageable chunks."},deleteSubItemsAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteSubItemsAcceptModal.title",defaultMessage:"Turn off sub-{items}?"},subItemsPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.subitems.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the sub-{items}. We use “Sub-{item}” as our default."},subItemsPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.subitems.propertySelectPopup.default.caption",defaultMessage:"This property will be used for sub-{items} in new views."},toggleNestingOnTitleMenuItemTooltip:{id:"database.viewSettings.relationFeatures.subitems.toggleNestingOnTitleMenuItemTooltip.default.caption",defaultMessage:"Whether nesting and the toggle button should always be on the title column or the left-most column. Only relevant for table views"}}),u=(0,s.defineMessages)({relationFeatureOnMessage:{id:"database.viewSettings.mainTab.feature.on",defaultMessage:"On"},relationFeatureOffMessage:{id:"database.viewSettings.mainTab.feature.off",defaultMessage:"Off"},relationFeatureHiddenMessage:{id:"database.viewSettings.mainTab.relationFeatureHidden",defaultMessage:"Hidden"},turnOffAndDelete:{id:"collectionSettings.relationFeatures.turnOffFeatureAllViewsButton.label",defaultMessage:"Turn off and delete"},turnOffFeature:{id:"collectionSettings.relationFeatures.turnOffFeatureWithoutDeleteButton.label",defaultMessage:"Turn off feature"},turnOffFeatureDeletedProperties:{id:"collectionSettings.relationFeatures.turnOffFeature.deletedProperties.description",defaultMessage:"This will also delete the properties <span>{propertyName}</span> and <span>{inversePropertyName}</span>."},...c,...d});function p(e){return"consume_gap"===e?r.d:"preserve_gap"===e?o.$:i.H}function m(e){let t;return t="consume_gap"===e.dateShiftingMode?u.consumeGapButton:"preserve_gap"===e.dateShiftingMode?u.preserveGapButton:u.doNotShiftButton,{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function f(e){let t;return"timeline_arrows_by"===e.feature?t=u.turnOnDependenciesButton:"subitem"===e.feature?t=u.turnOnSubItemsButton:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function g(e){let t;return"timeline_arrows_by"===e.feature?t=u.turnOffDependenciesButton:"subitem"===e.feature?t=u.turnOffSubItemsButton:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function h(e){let t;return"timeline_arrows_by"===e.feature?t=u.dependenciesMenuTitle:"subitem"===e.feature?t=u.subItemsMenuTitle:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function v(e){let t;return"timeline_arrows_by"===e.feature?t=u.dependenciesMenuDescription:"subitem"===e.feature?t=u.subItemsMenuDescription:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function b(e){let t;return"timeline_arrows_by"===e.feature?t=u.deleteDependenciesAcceptModalTitle:"subitem"===e.feature?t=u.deleteSubItemsAcceptModalTitle:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function y(e){let t;return"timeline_arrows_by"===e.feature?t=u.dependenciesPropertyPickerCaption:"subitem"===e.feature?t=u.subItemsPropertyPickerCaption:(0,a.t1)(e.feature),{...t,values:{item:(0,l.sN)(e.databaseType,!0),items:(0,l.Q_)(e.databaseType,!0)}}}function S(e){let t;return"timeline_arrows_by"===e.feature?t=u.dependenciesPropertySelectDefaultOptionCaption:"subitem"===e.feature?t=u.subItemsPropertySelectDefaultOptionCaption:(0,a.t1)(e.feature),{...t,values:{item:(0,l.sN)(e.databaseType,!0),items:(0,l.Q_)(e.databaseType,!0)}}}function _(e){let t;return(0,a.$K)(e.currentDateShiftConfig)?"preserve_gap"===e.currentDateShiftConfig.mode?t=u.shiftingNotApplicablePreserveGapMessage:"consume_gap"===e.currentDateShiftConfig.mode?t=u.shiftingNotApplicableConsumeGapMessage:(0,a.t1)(e.currentDateShiftConfig.mode):t=u.shiftingNotApplicableNoShiftingMessage,{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function w(e){return{...u.avoidWeekendsSwitcherCaption,values:{items:(0,l.Q_)(e,!0)}}}function k(e){const{feature:t,isOn:n,databaseType:o}=e;let i;return"timeline_arrows_by"===t?i=n?u.hideDependenciesInView:u.showDependenciesInView:"subitem"===t?i=n?u.hideSubitemsInView:u.showSubitemsInView:(0,a.t1)(t),{...i,values:{items:(0,l.Q_)(o,!0)}}}function I(e){const t={numDependenciesUpdated:e.result.numDependenciesUpdated,item:(0,l.sN)(e.databaseType,!0),items:(0,l.Q_)(e.databaseType,!0)};return e.result.numCouldNotUpdateDueToPermissions>0?e.result.numDependenciesUpdated>0?{message:{...u.dateShiftSomeNotUpdatedDueToPermissions,values:t},canUndo:!0}:{message:{...u.dateShiftAllNotUpdatedDueToPermissions,values:{}},canUndo:!1}:e.result.numDependenciesUpdated>0?{message:{...u.dateShiftSuccess,values:t},canUndo:!0}:void 0}},29376:(e,t,n)=>{n.d(t,{BI:()=>y,KV:()=>g,Mu:()=>f,NA:()=>M,ND:()=>P,OP:()=>h,Pi:()=>v,U1:()=>x,ZI:()=>C,aI:()=>k,gO:()=>D,gZ:()=>_,ke:()=>A,m8:()=>I,ny:()=>S,pR:()=>b,rj:()=>w,uJ:()=>R});n(57658);var o=n(99036),i=n(95200),r=n(77657),a=n(6695),s=n(42875),l=n(22808),c=n(59753),d=n(97880),u=n(35661),p=(n(65742),n(78316)),m=n(75081);const f=32;function g(e,t){return e.normalizedSchemaStore.state[t]}function h(e,t,n){const i=g(e,t);if(!i||"relation"!==i.type||!i.property)return!1;const r=e.collectionStore(),a=n.getSchema();return o.$u({propertySchema:i,sourceCollectionId:null==r?void 0:r.id,property:t,targetCollectionSchema:a})}function v(e){const t=(0,d.qP)(e).find((e=>{let[t,n]=e;if(n&&(0,o.NK)(n))return n.connectedRelation.integration_id===r.U9}));if(t&&t[1]&&(0,o.NK)(t[1]))return t[1]}function b(e){return Boolean(v(e))}function y(e,t){if(!e)return!1;const n=e[t];return Boolean(n&&(0,o.NK)(n)&&n.connectedRelation.integration_id===r.U9)}function S(e,t){if("relation"!==(null==t?void 0:t.type))return;const n=null==t?void 0:t.collection_pointer,o=e.collectionViewBlockStore();return n&&o?u.NW.createChildStore(o,n):void 0}function _(e){return p.eD({collectionStore:e,collectionViewBlockStore:e.getParentBlockStore(),checkNavigableAncestorLocked:!1})}function w(e){const{inverseName:t,collectionStore:n,propertySchema:o,intl:i,targetCollectionStore:r,from:a}=e;return t||(n.isDefined()&&o?k(i,{sourceCollection:n.getModel(),isSelfRelation:n.id===r.id,targetCollectionStore:r,createUnique:!0,from:a}):"")}function k(e,t){var n;const{sourceCollection:o,isSelfRelation:r,targetCollectionStore:a,createUnique:d,from:u}=t,p=c.kk.fromCollection(o),f=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),g=null===(n=p.getRenderIcon({}))||void 0===n?void 0:n.icon,h=p.getRenderTitle({getRecordModel:a.getRecordModel,userTimeZone:(0,s.r)(),intl:e})||f,v=p.getDatabaseType();let b;if(r)if("subitem"===u){const t=(0,m.sN)(v,!0);b=e.formatMessage({defaultMessage:"Parent {item}",id:"relationHelpers.autoSelfRelationInverseToggle.typedName"},{item:t})}else b="timeline_arrows_by"===u?e.formatMessage({defaultMessage:"Blocked by",id:"relationHelpers.autoSelfRelationInverseArrow.name"},{sourceCollectionName:h}):e.formatMessage({defaultMessage:"Related back to {sourceCollectionName}",id:"relationHelpers.autoSelfRelationInverse.name"},{sourceCollectionName:h});else b=g&&(0,l.Z)(g)?e.formatMessage({defaultMessage:"{sourceCollectionIcon} {sourceCollectionName}",id:"relationHelpers.autoInverseRelationWithIcon.name"},{sourceCollectionIcon:g,sourceCollectionName:h}):e.formatMessage({defaultMessage:"{sourceCollectionName}",id:"relationHelpers.autoInverseRelationSimple.name"},{sourceCollectionName:h});const y=a.getSchema();return y&&d?(0,i.Z)(b,(e=>!Object.values(y).find((t=>Boolean(t&&t.name===e))))):b}function I(e,t){var n,o;const{targetCollectionStore:r,isSelfRelation:a,sourceSchema:c,createUnique:d,from:u}=t,p=null===(n=r.getModel())||void 0===n||null===(n=n.getRenderIcon({}))||void 0===n?void 0:n.icon,f=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),g=(null===(o=r.getModel())||void 0===o?void 0:o.getRenderTitle({getRecordModel:r.getRecordModel,userTimeZone:(0,s.r)(),intl:e}))||f,h=r.getDatabaseType();let v;if(a)if("subitem"===u){const t=(0,m.sN)(h,!0);v=e.formatMessage({defaultMessage:"Sub-{item}",id:"relationHelpers.autoSelfRelationNest.typedName"},{item:t})}else v="timeline_arrows_by"===u?e.formatMessage({defaultMessage:"Blocking",id:"relationHelpers.autoSelfRelationTimelineArrow.name"},{targetCollectionName:g}):e.formatMessage({defaultMessage:"Related {targetCollectionName}",id:"relationHelpers.autoSelfRelation.name"},{targetCollectionName:g});else v=p&&(0,l.Z)(p)?e.formatMessage({defaultMessage:"{targetCollectionIcon} {targetCollectionName}",id:"relationHelpers.autoRelationWithIcon.name"},{targetCollectionIcon:p,targetCollectionName:g}):e.formatMessage({defaultMessage:"{targetCollectionName}",id:"relationHelpers.autoRelation.name"},{targetCollectionName:g});const b=Object.values(c);return d?(0,i.Z)(v,(e=>!b.find((t=>Boolean(t&&t.name===e))))):v}function C(e){const t=a.iB(e.getFormat(),e.getSchema(),void 0,a.j5.Relation);return t?t.collection_relation_options??{}:{}}function x(e){var t;const{collectionStore:n,property:o}=e;return(null===(t=C(n)[o])||void 0===t?void 0:t.related_properties)??[]}function T(e,t){return Object.entries(t).map((n=>{let[i,r]=n;if(!r||!(0,o.p_)(r))return;const a=(0,o.j0)(r),s=e.collectionStore();if(!a||a.id!==(null==s?void 0:s.pointer.id)||!s||!h(e,i,s))return;const l=r.property;if(!l)return;const c=t[l];if(!c||"relation"!==c.type)return;const d=(0,o.j0)(c);return d&&d.id===(null==s?void 0:s.pointer.id)?{propertyID:i,inversePropertyID:l}:void 0})).filter(d.$K)}function M(e,t){return T(e,t).map((e=>e.propertyID))}function P(e,t){const n=T(e,t),o=new Set,i=[];for(const{propertyID:r,inversePropertyID:a}of n)o.has(r)||o.has(a)||(i.push([r,a]),o.add(r),o.add(a));return i}function A(e,t){const n=(0,o.j0)(e);if(!n)return;const i=u.NW.createChildStore(t,n);return i?null==i?void 0:i.getFormat().app_config_uri:void 0}function R(e,t){const n=(0,o.j0)(e);if(!n)return;const i=u.NW.createChildStore(t,n);return i?null==i?void 0:i.getSchema():void 0}function D(e,t){const n=(0,o.j0)(e);if(!n)return;const i=u.NW.createChildStore(t,n);return i||void 0}},77546:(e,t,n)=>{n.d(t,{Ez:()=>p,Gf:()=>g,Oc:()=>c,SD:()=>r,VW:()=>a,Wr:()=>d,eA:()=>f,hI:()=>l,xH:()=>s});n(57658);var o=n(69454);const i={auto:!0,scroll:!0};function r(e){return e&&e instanceof HTMLElement?e:e&&e.parentElement?e.parentElement:void 0}function a(e){const t=r(e);if(t)return m(t,"vertical")}function s(e){const t=r(e);if(t)return m(t,"horizontal")}function l(e){let t=e;const n=[];do{const e=window.getComputedStyle(t);e&&(e.overflow&&i[e.overflow]||e.overflowY&&i[e.overflowY]||e.overflowX&&i[e.overflowX])&&n.push(t),t=t.parentElement}while(t);return n}function c(e){const{el:t,windowHeight:n}=e,i=e.minEdgeDist??8,r=a(t);if(!r||!r.getBoundingClientRect)return;const s=t.getBoundingClientRect(),l=r.getBoundingClientRect(),c=n-o.Z.estimatedNativeWebBottomOverlap(),d=Math.min(l.bottom,c);s.top<l.top?r.scrollTop=r.scrollTop-(l.top-s.top)-i:s.bottom>d&&(r.scrollTop=r.scrollTop+(s.bottom-d)+i)}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{edgeDist:0,animate:!1};const n=a(e),{animate:o,edgeDist:i}=t;if(!n||!n.getBoundingClientRect)return;const r=e.getBoundingClientRect(),s=n.getBoundingClientRect();if(o){const e=500,t=n.scrollTop-(s.top-r.top)-i,o=n.scrollTop,a=t-o,l=16;let c=0;const d=()=>{var t,i,r;c+=l,n.scrollTop=(t=c,i=o,r=a,(t/=e/2)<1?r/2*t*t+i:-r/2*(--t*(t-2)-1)+i),c<e&&requestAnimationFrame(d)};d()}else n.scrollTop=n.scrollTop-(s.top-r.top)-i}function u(e){return e&&e.overflowY&&i[e.overflowY]}function p(e){if(!e)return;let t=e;if(t)do{const e=t.parentElement&&window.getComputedStyle(t.parentElement);if(e&&u(e))return t;t=t.parentElement||void 0}while(t);return document.body}function m(e,t){if(!e)return;let n=e;if(n)do{const e=window.getComputedStyle(n);if(n.classList&&n.classList.contains("notion-scroller")&&n.classList.contains(t)||u(e))return n;n=n.parentElement||void 0}while(n);return document.body}function f(e){return e.device.isDesktop&&!e.device.isSafari}function g(e){return e.device.isDesktop}},45010:(e,t,n)=>{n.d(t,{Z:()=>o});const o={}},48141:(e,t,n)=>{n.d(t,{gC:()=>Ce,zD:()=>Ie,oO:()=>De,p6:()=>Se,_Q:()=>ke,De:()=>ve,pG:()=>Be,dy:()=>ze,Y_:()=>Ne,hb:()=>Pe,MQ:()=>je,bC:()=>Le,b9:()=>Ae,IV:()=>Fe,MS:()=>xe,FN:()=>be,VA:()=>ye,VD:()=>he,g8:()=>Ze,Nu:()=>Ee,iA:()=>Oe,YB:()=>Re,AX:()=>Ve});n(57658);var o=n(41432),i=n(80951),r=n(59753),a=n(21202),s=n(6287),l=n(70203),c=n(97880);const d={indexTimeMs:!0,title:!0,children_contents:!0,children_ids:!0,children_permissions:!0,children_fractional_index:!0,children_types:!0,alive:!0,created_by_id:!0,created_by_table:!0,created_time:!0,format:!0,id:!0,is_template:!0,last_edited_by_id:!0,last_edited_time:!0,parent_table:!0,permissions:!0,space_id:!0,team_id:!0,team_name:!0,team_is_archived:!0,auto_increment_id:!0,type:!0,version:!0,ancestors:!0,audience:!0,db_schema_source_partition:!0,depth:!0,is_path_alive:!0,is_top_level_page:!0,parent_id:!0,path_text:!0,search_permissions:!0,inherited_permissions:!0,parent_page_id:!0,collection_id:!0,parent_collection_id:!0,page_views:!0,unique_page_views:!0,collection_properties:!0,children_last_edited_times:!0},{audience:u,...p}=((0,c.QS)(d),d);(0,c.QS)(p);function m(e){const{getRecordValue:t,blockValue:n}=e;let c="";const d=r.kk.fromBlock(n),u=r.om.fromGetRecordValueFn(t);if(d.isCollectionView()){const e=function(e){const{getRecordModel:t,blockModel:n}=e,o=function(e){const{getRecordModel:t,model:n}=e,o=n.getRenderFormatPointer(t);if(!o)return;const r=t(o);if(!r)return;if(r.table===a.iU)return(0,i.wS)(r,"title")||[];if(r.table===s.v)return r.getNormalizedName()}({model:n,getRecordModel:t});if(o&&o.length>0)return l.Qh7(o)}({getRecordModel:u,blockModel:d});e&&(c=e)}else if(d.isType("file")){c=`${l.Qh7(d.getProperty("title"))} ${l.Qh7(d.getProperty("caption"))}`}else if(d.isType("bookmark")){c=`${l.Qh7(d.getProperty("title"))} ${l.Qh7(d.getProperty("description"))} ${l.Qh7(d.getProperty("caption"))}`}else if(d.isType(o.Ok)){const e=d.getProperty("caption");c=l.Qh7(e)}else if(d.isType(o.Ti.tableRow)){const e=function(e){const{blockModel:t,getRecordModel:n}=e,o=n({table:a.iU,id:t.getParentId(),spaceId:t.getSpaceId()});return null==o?void 0:o.getFormatValue("table_block_column_order")}({blockModel:d,getRecordModel:u});if(e){c=e.map((e=>l.Qh7(d.getProperty(e)))).join(" ")}}else{const e=(0,i.wS)(n,"title");c=l.Qh7(e)}return c.trim()||void 0}var f=n(40506),g=n(7057),h=n(53877),v=n(58573),b=n(42875),y=n(72126),S=n(63306),_=n(4615),w=n(73360),k=n(74446),I=n(45953),C=n(33361),x=n(92338),T=n(5366),M=n(54642),P=n(80444),A=n(61738),R=n(42198);const D=e=>{let{result:t}=e;return{name:"IS_EXACT_MATCH",value:t.relevanceResult.matchMetadata.isExactIdMatch?1:0}},B=e=>{let{result:t}=e;return{name:"IS_PREFIX_MATCH",value:t.relevanceResult.matchMetadata.isPrefixMatch?1:0}},E=e=>{let{result:t}=e;return{name:"IS_WORD_PREFIX_MATCH",value:t.relevanceResult.matchMetadata.isWordPrefixMatch?1:0}},F=e=>{let{result:t}=e;return{name:"IS_SUBSTRING_MATCH",value:t.relevanceResult.matchMetadata.isSubstringMatch?1:0}},Z=e=>{let{result:t}=e;return{name:"IS_WORD_PREFIX_MATCH",value:t.relevanceResult.matchMetadata.isFuzzyMatch?1:0}},L=e=>{let{result:t}=e;return{name:"IS_FRECENT_PAGE",value:t.relevanceResult.localSource.has("frecencyStore")?1:0}},j=e=>{let{result:t}=e;return{name:"IS_BOOKMARKED_PAGE",value:t.relevanceResult.localSource.has("bookmarkedPage")?1:0}},V=e=>{let{result:t}=e;return{name:"IS_TEAM_PAGE",value:t.relevanceResult.localSource.has("teamPage")?1:0}},U=e=>{var t;let{result:n,featureExtractor:o}=e;const i=null===(t=o.frecencyStore)||void 0===t?void 0:t.getFrecencyScore(n.blockModel.id);return{name:"FRECENCY_SCORE",value:i||0}},O=e=>{let{result:t,featureExtractor:n}=e;const[o,i]=n.getFrecencyScoreBounds();return{name:"FRECENCY_SCORE_SCALED",value:n.minMaxScale(U({result:t,featureExtractor:n}).value,o,i)}},N=e=>{let{result:t}=e;return{name:"LEXICAL_MATCH_SCORE",value:t.relevanceResult.score}},z={name:"CLIENT_FEATURESET_V1",features:[D,B,E,F,e=>{let{result:t}=e;return{name:"IS_IN_ORDER_TOKEN_MATCH",value:t.relevanceResult.matchMetadata.isInOrderTokenMatch?1:0}},Z,e=>{let{result:t}=e;return{name:"IS_RECENT_VISIT_BY_ME",value:t.relevanceResult.localSource.has("recentVisit")?1:0}},L,j,e=>{let{result:t}=e;return{name:"IS_FROM_DEFAULT_RECORD_CACHE",value:t.relevanceResult.localSource.has("defaultRecordCache")?1:0}},V,O,e=>{let{result:t,featureExtractor:n}=e;const[o,i]=n.getLexicalMatchScoreBounds();return{name:"LEXICAL_MATCH_SCORE_SCALED",value:n.minMaxScale(N({result:t,featureExtractor:n}).value,o,i)}}]},H={name:"CLIENT_FEATURESET_V2_RAW",features:[D,B,E,F,Z,L,j,V,O,e=>{let{result:t}=e;return{name:"IS_RECENT_VISIT_BY_ME",value:t.relevanceResult.localSource.has("recentVisit")?1:0}},e=>{let{result:t}=e;return{name:"TIME_SINCE_LAST_VIEWED_BY_ME",value:t.timeSinceLastViewedMs??-1}},e=>{let{result:t,featureExtractor:n}=e;return{name:"IS_SIMILAR_USER_1D_RECENT_PAGE",value:R.default.isSimilarUsersRecentPages({userId:n.userId,spaceId:n.spaceId,pageId:t.blockModel.id})?1:0}},e=>{let{result:t,featureExtractor:n}=e;return{name:"NUM_SIMILAR_USERS_VIEWED_PAGE",value:R.default.getNumSimilarUsersVisitedPage({userId:n.userId,spaceId:n.spaceId,pageId:t.blockModel.id})||0}},e=>{let{result:t,featureExtractor:n}=e;return{name:"PAGE_MOST_SIMILAR_VIEWER_SIMILARITY",value:R.default.getHighestViewerSimilarityScoreForPage({userId:n.userId,spaceId:n.spaceId,pageId:t.blockModel.id})||0}},e=>{let{result:t,featureExtractor:n}=e;const o=R.default.getSimilarUsersMostRecentVisitTimeForPage({userId:n.userId,spaceId:n.spaceId,pageId:t.blockModel.id});return{name:"TIME_SINCE_SIM_USER_VISIT",value:o?n.currentTimeMs-o:-1}},e=>{let{result:t,featureExtractor:n}=e;return{name:"IS_TOP_PAGES_7D_PAGE_VIEWS",value:R.default.isTopPages7dPageView({userId:n.userId,spaceId:n.spaceId,pageId:t.blockModel.id})?1:0}},e=>{let{result:t,featureExtractor:n}=e;return{name:"PAGE_AUTHORITY_V1",value:R.default.getPageAuthorityV1ForPage({userId:n.userId,spaceId:n.spaceId,pageId:t.blockModel.id})||0}},e=>{let{result:t,featureExtractor:n}=e;return{name:"TIME_SINCE_LAST_EDIT",value:n.currentTimeMs-t.blockModel.last_edited_time}},e=>{let{result:t,featureExtractor:n}=e;return{name:"IS_LAST_EDITED_BY_ME",value:n.userId&&t.blockModel.last_edited_by_id===n.userId?1:0}},e=>{let{result:t}=e;return{name:"IS_LAST_EDITED_BY_ME_WITHIN_12H",value:t.relevanceResult.localSource.has("defaultRecordCache")?1:0}},N,U]};function W(e){let t=0,n=0;for(const o of e)o<t&&(t=o),o>n&&(n=o);return[t,n]}class q{constructor(e,t,n){var o;this.featuresets=void 0,this.frecencyStore=void 0,this.results=void 0,this.resultsFeatureMetadata={},this.userId=void 0,this.spaceId=void 0,this.currentTimeMs=void 0,this.frecencyStore=A.Z.lazyFrecencyStore.get(t.currentUser.id),this.featuresets=e,this.results=n,this.userId=t.currentUser.id,this.spaceId=null===(o=P.default.state.currentSpaceStore)||void 0===o?void 0:o.id,this.currentTimeMs=Date.now()}minMaxScale(e,t,n){return t===n?0:(e-t)/(n-t)}getFrecencyScoreBounds(){if(!this.resultsFeatureMetadata.minFrecencyScore||!this.resultsFeatureMetadata.maxFrecencyScore){const e=this.results.map((e=>U({result:e,featureExtractor:this}).value||0)),[t,n]=W(e);this.resultsFeatureMetadata.minFrecencyScore=t,this.resultsFeatureMetadata.maxFrecencyScore=n}return[this.resultsFeatureMetadata.minFrecencyScore,this.resultsFeatureMetadata.maxFrecencyScore]}getLexicalMatchScoreBounds(){if(!this.resultsFeatureMetadata.minLexicalMatchScore||!this.resultsFeatureMetadata.maxLexicalMatchScore){const e=this.results.map((e=>N({result:e,featureExtractor:this}).value||0)),[t,n]=W(e);this.resultsFeatureMetadata.minLexicalMatchScore=t,this.resultsFeatureMetadata.maxLexicalMatchScore=n}return[this.resultsFeatureMetadata.minLexicalMatchScore,this.resultsFeatureMetadata.maxLexicalMatchScore]}extractFeatureGroup(e){const t=[];for(const n of this.featuresets){const o={groupName:n.name,features:[]};for(const t of n.features)o.features.push(t({result:e,featureExtractor:this}));t.push(o)}return t}}var G=n(77080),K=n(29026);n(21703);class ${constructor(e){let{name:t,weights:n,intercept:o,featureset:i}=e;if(this.weights=void 0,this.intercept=void 0,this.featureset=void 0,this.name=void 0,this.score=e=>{const t=function(e){const{result:t,groupName:n}=e;return t.featureGroups.find((e=>e.groupName===n))}({result:e,groupName:this.featureset.name});if(!t)throw new Error(`[Model: ${this.name}] Feature group ${this.featureset.name} not found`);const{groupName:n,features:o}=t;if(n!==this.featureset.name)throw new Error(`[Model: ${this.name}] Feature group name does not match model`);if(o.length!==this.weights.length)throw new Error(`[Model: ${this.name}] Feature weights do not match feature count`);let i=this.intercept;return o.forEach(((e,t)=>{const n=this.weights[t];i+=n*e.value})),i},n.length!==i.features.length)throw new Error(`[Model: ${t}] Feature weights do not match feature count`);this.weights=n,this.intercept=o,this.featureset=i,this.name=t}}const Q=new $({name:"ridge_regression_v1",weights:[.07338547745990809,-.5187934622823605,.2580923407555247,.02348953943987908,.6274337942627901,.03317934430846847,0,-.3511876522594548,-.6273845571398535,-.045037288133869424,.20767101148186384,8.619648989831271,-1.2158798461014042],intercept:1.5427965680658178,featureset:z}),Y=new $({name:"logistic_regression_v1",weights:[0,.591755530784604,-1.2417186349959148,.31667280869910813,-1.0465382148354145,2.6692070654927273,-.25984857199808187,-.8346114640363157,.12435852022293091,-.006220960322605889,.1653145505065149,105.87044316084274,.3404653043307269],intercept:-.15561962,featureset:z}),J=new $({name:"svc_v1",weights:[0,.285388028,-.587419463,.160194857,-.50486014,.676207274,-.121528628,-.403215103,.0743405796,.00540581964,.0816730306,24.5922097,.931615053],intercept:-.07565408,featureset:z});function X(e){const{sort:t,currentUserId:n,unsorted:o}=e,i=G.default.getEligibleGroup({experimentId:"search-client-ltr-v0"});return i&&"control"!==i?function(e){const{unsorted:t}=e,n=function(e){switch(e){case"logreg":return Y;case"ridgereg":return Q;case"svc":return J;default:(0,c.t1)(e)}}(e.clientLtrGroup);return t.map((e=>({result:e,score:n.score(e)}))).sort(((e,t)=>t.score-e.score)).map((e=>e.result))}({unsorted:o,clientLtrGroup:i}):Re({sort:t,currentUserId:n,unsorted:o,batchSize:K.Xv})}var ee=n(69327),te=n(35661),ne=n(26842),oe=n(88893),ie=n(24215),re=n(28020),ae=n(43250),se=n(45950),le=n(98165),ce=n(67669),de=n(15447),ue=n(38755),pe=n(95697);function me(e){return Boolean(e&&e.length>0)}function fe(e){return Boolean(e.starting||e.ending)}function ge(e){return Boolean(e)}const he={requireEditPermissions:ge,isDeletedOnly:ge,excludeTemplates:ge,navigableBlockContentOnly:ge,ancestors:me,parentId:function(e){return void 0!==e},createdBy:me,editedBy:me,lastEditedTime:fe,createdTime:fe,isAdminModeDeletedPageSearch:ge,blockTypes:function(e){return Boolean(e&&e.length>0)},inTeams:function(e){return me(x.iY(e))},includePublicPagesWithoutExplicitAccess:ge,audience:function(e){return Boolean(e)},dev_excludedPages:me,dev_excludedTeams:me,databaseType:me};function ve(e){return e?{requireEditPermissions:he.requireEditPermissions(e.requireEditPermissions),isDeletedOnly:he.isDeletedOnly(e.isDeletedOnly),excludeTemplates:he.excludeTemplates(e.excludeTemplates),navigableBlockContentOnly:he.navigableBlockContentOnly(e.navigableBlockContentOnly),ancestors:he.ancestors(e.ancestors),parentId:he.parentId(e.parentId),createdBy:he.createdBy(e.createdBy),editedBy:he.editedBy(e.editedBy),createdTime:he.createdTime(e.createdTime),lastEditedTime:he.lastEditedTime(e.lastEditedTime),blockTypes:he.blockTypes(e.blockTypes),inTeams:he.inTeams(e.inTeams),dev_excludedPages:he.dev_excludedPages(e.dev_excludedPages),dev_excludedTeams:he.dev_excludedTeams(e.dev_excludedTeams)}:{requireEditPermissions:!1,isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,ancestors:!1,parentId:!1,createdBy:!1,editedBy:!1,createdTime:!1,lastEditedTime:!1,blockTypes:!1,inTeams:!1,dev_excludedPages:!1,dev_excludedTeams:!1}}function be(e){const t=ve(e);return Object.values(t).some((e=>Boolean(e)))}function ye(e){const t=ve(e),{navigableBlockContentOnly:n,...o}=t;return Object.values(o).some((e=>Boolean(e)))}function Se(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.sF;const o=h.OQ.notionDateToLuxon(e,{locale:t.locale});return(0,g.Cp)(o,n)}function _e(e,t){const n=h.OQ.notionDateTimeToLuxon(e,t.locale);return(0,g.ZW)(n,"medium_with_time")}const we=(0,T.defineMessages)({startAndEnd:{defaultMessage:"{startDate} - {endDate}",id:"searchHelpers.betweenStartAndEndDates"},afterStart:{defaultMessage:"After {startDate}",id:"searchHelpers.afterStartDate"},beforeEnd:{defaultMessage:"Before {endDate}",id:"searchHelpers.beforeEndDate"}});function ke(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.sF,o="",i="";return e.starting&&(o="date"===e.starting.type?Se(e.starting,t,n):_e(e.starting,t)),e.ending&&(i="date"===e.ending.type?Se(e.ending,t,n):_e(e.ending,t)),o&&i?t.formatMessage(we.startAndEnd,{startDate:o,endDate:i}):o?t.formatMessage(we.afterStart,{startDate:o}):t.formatMessage(we.beforeEnd,{endDate:i})}function Ie(e){return Boolean(e.target&&e.target instanceof HTMLElement&&e.target.classList.contains("rdp-day"))}function Ce(e){const{input:t,spaceId:n,publicAccessPermissionAncestorBlockId:o,searchSessionId:i,searchSessionFlowNumber:r,source:a,forcedClusterPattern:s,searchExperimentOverrides:l,recentPagesForBoosting:c,forcedBlockIds:d,excludedBlockIds:u}=e,{query:p,limit:m,debug:f}=t;return n?{type:x.n8.BlocksInSpace,query:p.text.trim(),spaceId:n,limit:m,filters:p.filters,sort:p.sort,source:a||"quick_find",debug:f,searchExperimentOverrides:l,searchSessionId:i,searchSessionFlowNumber:r,forcedClusterPattern:s,recentPagesForBoosting:(0,de.Wk)(c),forcedBlockIds:d,excludedBlockIds:u}:o?{type:x.n8.BlocksInAncestor,query:p.text.trim(),ancestorId:o,filters:p.filters,sort:p.sort,limit:m,source:a||"quick_find_public",debug:f,searchExperimentOverrides:l,searchSessionId:i,searchSessionFlowNumber:r,forcedClusterPattern:s,forcedBlockIds:d,excludedBlockIds:u}:void 0}function xe(e){const{environment:t}=e,n=Ce(e);return!!n&&M.search(t,n)}class Te{constructor(e){this.startingTimestamp=void 0,this.endingTimestamp=void 0,this.startingTimestamp=e.starting&&h.uO(e.starting,(0,b.r)()),this.endingTimestamp=e.ending&&h.uO(e.ending,(0,b.r)())}matches(e){return void 0!==e&&(!(void 0!==this.startingTimestamp&&e<this.startingTimestamp)&&!(void 0!==this.endingTimestamp&&e>this.endingTimestamp))}}class Me{constructor(e){this.filters=void 0,this.activeFilters=void 0,this.ancestorFilterIds=void 0,this.parentFilterId=void 0,this.createdTimeMatcher=void 0,this.lastEditedTimeMatcher=void 0,this.teamFilterIds=void 0,this.dev_notInTeamFilterIds=void 0,this.dev_notInPagesFilterIds=void 0,this.filters=e,this.activeFilters=ve(e),this.ancestorFilterIds=new Set(e.ancestors),this.parentFilterId=e.parentId,this.createdTimeMatcher=new Te(e.createdTime),this.lastEditedTimeMatcher=new Te(e.lastEditedTime),this.teamFilterIds=new Set(x.iY(e.inTeams)??[]),this.dev_notInTeamFilterIds=new Set(e.dev_excludedTeams),this.dev_notInPagesFilterIds=new Set(e.dev_excludedPages)}matches(e){let{blockModel:t,path:n}=e;if(!Boolean(this.activeFilters.isDeletedOnly)!==t.alive)return!1;if(this.activeFilters.excludeTemplates&&t.is_template)return!1;if(this.activeFilters.editedBy){const e=t.last_edited_by_id||t.last_edited_by;if(!e||!this.filters.editedBy.includes(e))return!1}if(this.activeFilters.createdBy){const e=t.created_by_id||t.created_by;if(!e||!this.filters.createdBy.includes(e))return!1}if(this.activeFilters.ancestors&&!n.some((e=>{let{value:t}=e;return this.ancestorFilterIds.has(t.id)})))return!1;if(this.activeFilters.parentId){if(n.length<2)return!1;const[e,{value:{id:t}}]=n;return this.parentFilterId===t}if(this.activeFilters.lastEditedTime&&!this.lastEditedTimeMatcher.matches(t.last_edited_time))return!1;if(this.activeFilters.createdTime&&!this.createdTimeMatcher.matches(t.created_time))return!1;if(this.activeFilters.inTeams){var o;const e=le.KU(n),t=null==e||null===(o=e.value)||void 0===o?void 0:o.id;if(!t||!this.teamFilterIds.has(t))return!1}return!0}}async function Pe(e){const{environment:t,currentSpaceStore:n,currentSpaceViewStore:i,excludeCurrentPage:s}=e,{id:l}=n,c=new Map,d=new Set;function u(e,t){var n;c.has(e)?null===(n=c.get(e))||void 0===n||n.add(t):c.set(e,new Set([t]))}const p=new Map,f=(new Date).getTime();if(i)for(const o of i.getBookmarkedPageIds())u(o,"bookmarkedPage");const g=ee.Z.get(l);g&&g.forEach(((e,t)=>{let{pageId:n,visitedAt:o}=e;u(n,"recentVisit"),d.add(n),p.set(n,{index:t,timeSinceLastViewed:f-o})}));const h=(0,ue.ns)(t,n);for(const o of h)u(o,"spacePage");const v=(0,pe.xo)();for(const o of v)u(o,"teamPage");const b=t.currentUser.id;if(i){for(const{id:n}of(0,ue.KA)(t,i))u(n,"sharedPage");const e=f-432e5;t.defaultRecordCache.inMemoryRecordCache.forEachRecord(b,(t=>{let{model:i}=t;if(i.table===a.iU&&l===n.id){const{id:t,last_edited_time:n,last_edited_by_id:r,type:a}=i;(0,o.S9)(a)&&r===b&&n&&n>e&&(u(t,"defaultRecordCache"),d.add(t))}}))}const _=A.Z.getVisitedIds(b);for(const o of _)u(o,"frecencyStore"),d.add(o);const x=b?G.default.getEligibleGroup({experimentId:"search-new-local-recall-v1"}):void 0,T="on"===G.default.getEligibleGroup({experimentId:"search-no-local-recent-records-invalidations"}),M=Boolean(x&&"control"!==x||T);if(x){const e=R.default.getUserSignals({spaceId:l,userId:b});var P;if("sim_user_visits"===x)null==e||null===(P=e.similarUserRecentPages)||void 0===P||P.pagesMetadata.forEach(((e,t)=>{u(t,"similarUser1dRecentPages"),d.add(t)}));else if("popular_pages"===x){var D;null==e||null===(D=e.topPages7dPageView)||void 0===D||D.forEach(((e,t)=>{u(t,"topPages7dPageView"),d.add(t)}))}}if(s){const e=(0,re.np)();e&&c.delete(e.id)}const B=I.PF.create();await(0,C.uf)({recordPointers:Array.from(c.keys()).map((e=>({table:a.iU,id:e}))),recordMap:B,loadRecordModel:e=>(0,se.Ye)({environment:t,pointer:e}),recurFn:e=>y.oA([(0,w.tz)(e)&&e.getParentPointer(),e.table===a.iU&&e.getCollectionPointer()])});const E=k.mF.fromRecordMapWithRole(B),F=new Array;for(const[o,y]of c.entries()){const e={table:a.iU,id:o};let t,i;if(M&&d.has(o))t=te.t1.createChildStore(n,e),i=t.getModel();else{const t=E(e);i=t?r.kk.fromValue(a.iU,t):void 0}if(!i)continue;const s=(0,S.Wq)(e,B);if(0===s.length)continue;if(i.getSpaceId()!==n.id)continue;const l=m({blockValue:i,getRecordValue:E});if(!l)continue;if(!y)continue;const c=le.KU(s);if(c&&Boolean(c.value.archived_by))continue;const u=l.substring(0,1e3).trim(),f=p.get(o);F.push({blockModel:i,text:u,path:s,source:y,indexInRecentPages:f?f.index:void 0,timeSinceLastViewedMs:f?f.timeSinceLastViewed:void 0,blockStore:t})}return{spaceId:n.id,blocks:F,recordMap:B}}function Ae(e){if(e&&!e.error)return e.value}function Re(e){let{sort:t,unsorted:n,batchSize:o,currentUserId:i}=e;const r=Date.now();if("relevance"!==t.field)return n;const a=y.yo(n,o).map((e=>A.Z.sortFrecencyHighToLow({items:e,now:r,currentUserId:i,recordFrecency:!0})));return y.xH(a)}function De(e){const{localResults:t,serverResults:n}=e;if(t||n){if(t&&n){const e=new Set(t.map((e=>e.id)));function o(e){return(null==e?void 0:e.sources)??[]}return t.map((e=>{const t=(i=e.id,null==n?void 0:n.find((e=>e.id===i)));var i;const r=(null==(a=t)?void 0:a.originalPosition)??e.originalPosition;var a;const s=[...new Set([...e.badges??[],...(null==t?void 0:t.badges)??[]])];return{...e,originalPosition:r,serverEventProperties:(null==t?void 0:t.serverEventProperties)??e.serverEventProperties,sources:[...e.sources,...o(t)],badges:s}})).concat(n.filter((t=>!e.has(t.id))))}return t??n}}function Be(e){var t,n,o;const{globalFocusedIndexStore:i,searchActionsStore:r,searchResultStore:a}=e,s=De({localResults:null===(t=a.state.localResults)||void 0===t?void 0:t.results,serverResults:null===(n=a.state.serverResults)||void 0===n?void 0:n.results}),l=i.state;if(void 0===l)return;const c=r.state.length,d=l<c&&r.state[l];if(d&&"assistant"===d.type)return{type:d.type};const u=l-c;if(!s||s.length<=0||u<0)return;const p=null===(o=s[u])||void 0===o?void 0:o.store;return p?{type:"page_result",value:p}:void 0}function Ee(e){const{existingResults:t,newPageResults:n}=e;if(void 0!==t||void 0!==n){if(t&&n){const e=[...t.results],o=new Set(t.results.map((e=>e.id)));return e.push(...n.results.filter((e=>!(e.sources.includes(x.vp.ElasticsearchRandom)&&e.originalPosition<t.results.length)&&!o.has(e.id)))),{...n,results:e,total:n.total}}return t??n}}function Fe(e){const{intentBasedGrouping:t,localResults:n,serverResults:o}=e,i=De({localResults:n,serverResults:o})??[],r=i.filter((e=>e.sources.includes(x.vp.ElasticsearchUniqueID))),a=i.filter((e=>!e.sources.includes(x.vp.ElasticsearchUniqueID)));return t?{type:"intent-based-grouping",sections:{uniqueIdSearchResults:r,jumpBackInSearchResults:a.filter((e=>e.sources.includes(x.vp.Local))),serverOnlySearchResults:a.filter((e=>!e.sources.includes(x.vp.Local)))},allSearchResults:i}:r.length>0?{type:"unique-id",sections:{uniqueIdSearchResults:r,nonUniqueIdSearchResults:a},allSearchResults:i}:{type:"all",sections:{allSearchResults:i},allSearchResults:i}}function Ze(e,t,n){const o=n??(e.device.isMobile?2:3);return t.slice(0,o)}function Le(e){const{mainEditorCurrentBlockStore:t}=P.default.state,n=t&&ce.IJ(e,t);return{hasPublicAccessPermission:Boolean(n),publicAccessPermissionAncestorBlockId:(null==n?void 0:n.from.table)===a.iU?null==n?void 0:n.from.blockId:void 0}}function je(e){let{environment:t,searchResultsSection:n,modalBodyMenu:o,searchFilterMenu:i}=e;if(!n)return 0;let r=0;if(t.device.isMobile){const e=null==o?void 0:o.getNode(),t=null==i?void 0:i.getNode();if(e instanceof Element&&t instanceof Element){const n=e.getElementsByClassName(ae.GZn)[0];n instanceof Element&&(r=n.clientHeight-t.clientHeight+n.scrollTop)}}else r=n.getBoundingClientRect().height+n.scrollTop;let a=0,s=0;const l=n.getElementsByClassName(ae.ulv);for(let c=0;c<l.length;c++){const e=l[c];if(!(r-s>e.clientHeight/2))return a;a+=1,s+=e.clientHeight}return a}function Ve(e){if(void 0===e)return[];return e.map((e=>({id:e.id,score:e.score,sources:e.sources,spaceId:e.spaceId})))}function Ue(e,t){let{source:n,indexInRecentPages:o,timeSinceLastViewedMs:i}=t;return{...e,personalizationBoost:function(e){return e.has("recentVisit")||e.has("frecencyStore")||e.has("bookmarkedPage")||e.has("defaultRecordCache")?1.25:e.has("teamPage")?1.1:1}(n),localSource:n,indexInRecentPages:o,timeSinceLastViewedMs:i}}function Oe(e){let{query:t,localCachedPages:n,userId:o,includeRecordMap:i,environment:r,applyRecallScoreThreshold:a,canUseLtr:s}=e;const l=n.blocks,{query:c,limit:d}=t,{filters:u,sort:p}=c,m=i??!0,f=new Me(u);let g=function(e,t,n){const o=t.text.trim(),i=(0,_.nv)(o);return y.oA(e.map((e=>{let t;if(t=i.includes(e.blockModel.id)?{rendered:"",score:v.$r,matchMetadata:{isExactIdMatch:!0}}:(0,v.C6)(o,e.text,{pre:x.Um,post:x.dK,ignoreFuzzyFallback:n}),t)return{...e,relevanceResult:Ue(t,e)}})))}(l.filter((e=>f.matches(e))),c,a);if(a&&(g=g.filter((e=>e.relevanceResult.score>=v.T6))),0===g.length)return;const h=function(e,t){const{field:n}=e,o="relevance"===n||"desc"===e.direction?-1:1;switch(n){case"lastEdited":case"scroll":return y.MR(t,(e=>{let{blockModel:t}=e;return o*(t.last_edited_time||0)}));case"created":return y.MR(t,(e=>{let{blockModel:t}=e;return o*(t.created_time||0)}));default:return y.MR(t,(e=>{let{relevanceResult:t}=e;return o*t.score}))}}(p,g);s&&(0,ie.j)(r,"search_local_recall_results",{num_visible_members:(0,oe.qX)(),results:h.map((e=>({id:e.blockModel.id,localSource:[...e.relevanceResult.localSource]})))});const b=h;let S;if("relevance"!==p.field)S=He({results:b});else if(t.query.text.length>1&&s){S=X({sort:p,unsorted:He({results:b,featureExtractor:new q([z,H],r,b)}),currentUserId:o})}else S=Re({sort:p,currentUserId:o,unsorted:He({results:b}),batchSize:K.Xv});return S=S.slice(0,d),{total:g.length,results:S,recordMap:m?n.recordMap.toJson({allowVersionDowngrade:!1}):{},trackEventProperties:{}}}function Ne(e){let{query:t,localCachedPages:n,parentStore:o,isOnline:i,environment:r,shouldLimitLocalResultsWhenOnline:s,applyScoreThresholdWhenOnline:l,maxLocalResultsOverride:c,canUseLtr:d}=e;const u=Oe({query:t,localCachedPages:n,userId:r.currentUser.id,environment:r,applyRecallScoreThreshold:i&&l,canUseLtr:d});if(!u)return;if(0===u.results.length)return{error:x.Ix.NoResults};let p=u.results.map(((e,t)=>({...e,originalPosition:t,store:ne.G.createChildStore(o,{table:a.iU,id:e.id}),serverEventProperties:void 0})));const m=p.length;return i&&s&&(p=Ze(r,p,c)),0===p.length?{error:x.Ix.NoResults}:{value:{total:m,results:p,debugInfo:void 0}}}function ze(e){var t;if(void 0!==(null==e?void 0:e.highlightBlockId)&&void 0===(null===(t=e.highlight)||void 0===t?void 0:t.title))return e.highlightBlockId}function He(e){const{results:t,featureExtractor:n}=e;return t.map((e=>({id:e.blockModel.id,score:e.relevanceResult.score,localSource:e.relevanceResult.localSource,indexInRecentPages:e.relevanceResult.indexInRecentPages,timeSinceLastViewedMs:e.relevanceResult.timeSinceLastViewedMs,personalizationBoost:e.relevanceResult.personalizationBoost,highlight:{text:e.relevanceResult.rendered},spaceId:e.blockModel.space_id,sources:[x.vp.Local],featureGroups:(null==n?void 0:n.extractFeatureGroup(e))||[]})))}},69645:(e,t,n)=>{n.d(t,{Bj:()=>h,D_:()=>y,Ib:()=>g,dq:()=>v,kC:()=>b,v5:()=>f});n(57658);var o=n(55010),i=n(45060),r=n(21202),a=n(95371),s=n(374),l=n(97880),c=n(94419),d=n(95802),u=n(27724),p=n(28020),m=n(62619);function f(e,t){return(0,a.DY)(t,(t=>t.value.store===e))}function g(e,t){const n=f(e,[t]);if(n&&n.length>0)return n[n.length-1]}function h(e){const t=e.container??u.default.getCurrentDefaultContainer();if(!t)return new a.DG([]);const n=[];d.C.forEach((o=>{const i=o.getNode(),r=o.props.store;if(!i)return;if(o.getContextSelectableContainer()!==t)return;(o.props.canSelect||e.includeNonSelectableListContainer&&o.props.isListContainer)&&n.push({node:i,store:r,component:o})}));var i;return(i=n,(0,a.Yc)({values:i,compareOrder:(e,t)=>(0,o.Z)(e.node,t.node),isAncestor:(e,t)=>m.r3(e.node,t.node)}))||new a.DG([])}function v(e){const t=e.root||(0,p.RM)();if(t){const n=h(e);return new a.mp({store:t,node:void 0,component:void 0},n.children)}}function b(e){const{rootStore:t,root:n,target:o}=e,i=(0,a.DY)(n.children,(e=>e===o));if(void 0===i)return;const r=[t];let s=t;for(const a of i){const e=a.value.store;if(!e)return;const t=s.getTransclusionReferenceTargetStore()??s;let n=t.getContentStores();const o=t.getAutomationStore();if(o){const e=o.getActionStores();n=n.concat(e.flatMap((e=>e.getBlockStores())))}const i=n.find((t=>t.id===e.id));if(!i)return;r.push(i),s=i}return r}function y(e){const{transaction:t,treeOperation:n,deleteFrom:o,observer:i}=e;switch(n.operation){case"delete":{var a;const e=null===(a=n.deleteFromParent.value.store)||void 0===a?void 0:a.getContentStore(),s=n.deletingChildren.map((e=>e.value.store)).filter(l.$K);for(const a of s){const s=a.getRecordStoreUIParent(),l=s&&s.table===r.iU&&1===s.path.length&&"content"===s.path[0]&&s,d="record-store-parent"===o&&l||e;if(d){const e={parent:d,childToRemove:a,transaction:t};c.Od(e),null==i||i.onRemove(n,e)}}return}case"insert":{var d,u;const e=null===(d=n.insertIntoParent.value.store)||void 0===d?void 0:d.getContentStore(),o=null===(u=n.adjacentSibling)||void 0===u?void 0:u.value.store,i=n.insertChildren.map((e=>e.value.store));("listAfter"===n.direction&&o||"listBefore"===n.direction&&!o)&&i.reverse();for(const r of i)if(e&&r)if("listAfter"===n.direction){const n={insert:r,parent:e,transaction:t,after:o};c.BE(n)}else{const n={insert:r,parent:e,transaction:t,before:o};c.Vt(n)}return}case"move":for(const e of(0,s.Z)(n))y({transaction:t,treeOperation:e,deleteFrom:o,observer:void 0});return void(null==i||i.onMove(n));default:(0,l.t1)(n)}}!function(){const{span:e,object:t,div:n,CONTAINER_STYLE:o}=i.TI;(0,i.Rw)({canFormat:e=>Boolean(e&&e instanceof a.mp),header:(i,r)=>e(o,e({},t(i,{useDefaultFormatter:!0})),n({},t(i.value.store)),i.children.length?n({},t(i.children)):void 0),hasBody:(e,t)=>!1,body:e=>null})}()},73959:(e,t,n)=>{n.d(t,{J2:()=>m,Mn:()=>u,iZ:()=>h,mh:()=>f,sQ:()=>p,sY:()=>v,x7:()=>g});var o=n(41432),i=n(41662),r=n(80444),a=n(55367),s=n(88923),l=n(35661),c=n(27724),d=n(98165);function u(e){return!e.isPhone}function p(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&e instanceof l.G)return e;let n=e;for(;;){if(n=n.getRecordStoreUIParent(),!n)return;if(n&&n instanceof l.G&&n!==e)return n}}function m(e){const t=p(e);if(t)return d.Dg(t)}function f(e){const t=e.getType(),n=e.getModel(),r=e.getProperties();if(t&&n)return t&&(0,o.XD)(t)&&"factory"!==t&&!(0,o.S9)(t)?e.getBlockTitleStore():n.isInlineCollectionView()?e.getTitleStore():n.isType(o.oe)&&r&&r.caption?e.getCaptionStore():t===o.Ti.table?i.g$.getCellTextStore({simpleTableStore:e,rowIndex:0,columnIndex:0}):void 0}function g(e){const t=p(e);if(t)return t&&(t===r.default.state.mainEditorCurrentBlockStore||s.default.state.open&&t===s.default.state.target)}function h(e){const{stores:t,phase:n}=c.default.state;return 1===t.length&&t[0]===e&&n===c.SelectionPhase.Editing}function v(e){const{stores:t,phase:n}=c.default.state,o=new Set(t.map((e=>e.id))),i=d.qA(e),r=o.has(e.id),s=i.some((e=>o.has(e.id))),l=r||s;return!(n!==c.SelectionPhase.Selected||!l||a.ZP.state.isDragging)}},89014:(e,t,n)=>{n.d(t,{u:()=>r,x:()=>i});const o=new Map;function i(e){return o.get(e)}function r(e,t){o.set(e,t)}},41984:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(6287);const i=function(e){return!(e.getParentTable()===o.v)||e.isTemplate()}},28187:(e,t,n)=>{n.d(t,{F6:()=>m,Jk:()=>d,SG:()=>p,kC:()=>f});n(57658);var o=n(77657),i=n(63787),r=n(90965),a=(n(95477),n(80444)),s=n(77080),l=n(35661),c=n(98165);const d=function(e){const t=c.qA(e),n=[];for(const o of t)"block"===o.table&&n.push({blockStore:o,slackIntegrationStore:(0,l.Kv)(e,{table:i.s,id:o.id})});for(const{blockStore:o,slackIntegrationStore:i}of n)if(i.isReady()){if(i.getKeyStore("enabled").getValue())return{blockStore:o,slackIntegrationStore:i}}return{blockStore:e,slackIntegrationStore:(0,l.Kv)(e,{table:i.s,id:e.id})}};function u(){var e;const t=null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.getBotSettingsStore().getValue();return(0,r.hU)({spaceBotSettings:t,integrationId:o.nO,env:"production"})}function p(){return s.default.checkGate("legacy_slack_notifications")}function m(){return!!u()&&"on"===s.default.getGroup("notion-to-slack")}function f(){return!!u()&&"on"===s.default.getGroup("notion-mentions-to-slack")}},38755:(e,t,n)=>{n.d(t,{C:()=>se,CV:()=>ne,Cx:()=>te,Fn:()=>ae,G$:()=>U,Ib:()=>ue,KA:()=>W,MC:()=>N,Q6:()=>fe,Q9:()=>ce,TC:()=>re,Wd:()=>G,XD:()=>Y,cD:()=>pe,cJ:()=>J,di:()=>oe,g4:()=>ee,iX:()=>q,j9:()=>le,jv:()=>$,k0:()=>z,kt:()=>me,lQ:()=>ie,ns:()=>Q,rg:()=>V,rn:()=>K,w3:()=>X,ww:()=>de});n(21703);var o=n(14577),i=n(15145),r=n(44317),a=n(72126),s=n(62193),l=n(21202),c=n(15047),d=n(77858),u=n(19889),p=n(66079),m=n(28182),f=n(9852),g=n(90965),h=n(97880),v=n(3297),b=n(94273),y=n(40277),S=n(12321),_=n(65452),w=n(95477),k=n(94841),I=n(88310),C=n(80444),x=n(92425),T=n(77080),M=n(81236),P=n(35661),A=n(13105),R=n(29226),D=n(88893),B=n(84210),E=n(33929),F=n(98165),Z=n(67669),L=n(65598),j=n(95697);async function V(e,t){return(await async function(e,t){const n=e.currentUser.id,o=t.getSpaceStore();if(await t.load(),o&&n){var i;t.hasRemoteSharedPages()||await _.l({environment:e,spaceId:o.id,userId:n});const r=x.Z.getSharedPagesState({spaceId:o.id,userId:n}),a=(r&&r.currentPageIds?r.currentPageIds:[]).map((e=>P.G.createChildStore(o,{table:l.iU,id:e,spaceId:o.id})));await Promise.all([o.load(),Promise.all(t.getBookmarkedPageStores().map((e=>e.load()))),Promise.all(Y(e,o).map((e=>e.load()))),Promise.all(t.getSharedPageStores().map((e=>e.load()))),Promise.all(a.map((e=>e.load())))]);return[...t.getBookmarkedPages(),...t.getWorkspacePages(),...W(e,t),...t.getPrivatePages(e),...(null===(i=t.getTeamsStores())||void 0===i||null===(i=i[0])||void 0===i?void 0:i.getTeamPageStores())||[],...a].filter((t=>!(0,Z.IJ)(e,t)))}}(e,t)??[])[0]}const U=7,O=new s.Uw;function N(e){return O.memo((()=>new o.Z((()=>z(e)),{debugName:"sharedPageContextStore"})),[e.environment,e.spaceViewStore,e.userSettingsStore])}function z(e){const{environment:t,spaceViewStore:n,userSettingsStore:o}=e,i=n.getSpaceId(),r=W(t,n),a=new Set(r.map((e=>{let{id:t}=e;return t})));if(!i)return{allSharedPagesStores:r,visibleSharedPagesStores:r};if(!o.hasUserPinnedToOutliner({type:"shared",spaceId:i}))return{allSharedPagesStores:r,visibleSharedPagesStores:r.slice(0,U)};return{allSharedPagesStores:r,visibleSharedPagesStores:n.getPinnedSharedPages().filter((e=>{let{id:t}=e;return a.has(t)}))}}const H=new s.Uw;function W(e,t){const n=e.currentUser.id,o=t.getSpaceStore();if(o&&n){const i=x.Z.getSharedPagesState({spaceId:o.id,userId:n}),r=i&&i.currentPageIds?i.currentPageIds:[],s=H.memo((()=>function(e,t){return new A.P({debugName:"isValidSharedRemotePage",memoizeRecursion:!1,deepEquals:!1,compute:function(n){if(!e.currentUser.id)return!1;const o=(0,F.u3)(n);let i=!1;return o&&((0,L.OY)(o)?i=!(0,j.bq)()&&e.currentUser.id&&t.isDefined()&&n.hasSpacePermission()?(0,g.kC)(t.getPermissionItems(),e.currentUser.id):o.id!==n.id&&o.canRead():(0,L.Y)(o)&&(i=(0,j.zz)({teamStore:o,spaceStore:t,userId:e.currentUser.id})&&o.canRead())),!(!((0,L.Oh)(n)&&n.canRead()&&n.isNavigableBlock()&&n.isSharedPage(t,e))||(0,F.wf)(n)||i)}})}(e,o)),[e,o]),c=a.oA(r.map((e=>{const t=P.G.createChildStore(o.getPagesStore(),{table:l.iU,id:e,spaceId:o.id});if(s.getStateFor(t))return t}))),d=new Set(c.map((e=>e.id)));let u;const p=t.getSharedPageStores(),m=0===p.length;if(m){u=Y(e,o).filter((e=>{d.has(e.id)}))}else u=p.filter((e=>!(0,F.wf)(e)&&d.has(e.id)));(0,I.As)({use_legacy_shared_pages_ordering:m&&u.length>0});const f=[...u,...c];return a.mN(f,(e=>e.id))}return[]}async function q(e){const{disableRedirectUrl:t,environment:n}=e;await S.w();const{id:o}=n.currentUser,{url:r,spaceId:s,route:l}=await b.Ie(n),c=s?X(s):void 0,d=function(e){const{environment:t,lastVisitedUrl:n,lastVisitedSpaceView:o}=e,r=ee(t,o);switch(r){case"last_visited_page":return n?{url:n,isPersonalHomeUrl:!1}:void 0;case"first_page":return;case"personal_home":if(!o)return;const e=k.Al(o);if(!e)return;return{url:(0,B.ZP)({store:e,preferPublicLink:!1,pageVisitSource:i.tY.AppRedirect}),isPersonalHomeUrl:!0};default:(0,h.t1)(r)}}({environment:n,lastVisitedUrl:r,lastVisitedSpaceView:c}),g=null==d?void 0:d.url,_=v.qd(o),w=y.th(o),I=f.getOauthAuthorizationParams();if(!o)throw new Error("User not logged in.");const C=new P.U6(n,{table:u.KJ,id:o}),x=new P.r9(n,{table:p.dx,id:o}),T=new P.vO(n,{table:m.Sr,id:o}),[M,A]=await Promise.all([C.awaitNonNullValue(),x.awaitNonNullValue(),T.awaitNonNullValue()]),R=!!M&&Boolean(M.onboarding_completed),D=!!M&&Boolean(M.mobile_onboarding_completed),E=function(e,t){const n=(0,p.ao)(e);return n&&n.length>0?P.V9.createChildStore(t,n[0]):void 0}(A,x);E&&await E.load();const F=E?E.getSpaceStore():void 0;if(l&&!t){const e=await y.Jv({environment:n,request:{type:"block-space",...l}}).next();if(e.value){const t=e.value,n="page"===l.name?l.blockId:void 0,o=["read_and_write","comment_only","reader"].includes(t.publicAccessRole);if(t&&!a.xb(t)&&(t.canJoinSpace||t.userHasExplicitAccess||!o))return{userStore:C,userSettingsStore:T,userRootStore:x,firstSpace:F,firstSpaceView:E,lastVisitedSpaceView:c,redirectUrl:g,forkPageBlockId:_,publicAccessPageId:w,oauthAuthorizationParams:I,redirectPageId:n,hasExplicitAccessToRedirectPage:t.userHasExplicitAccess,redirectSpaceName:t.spaceName,redirectSpaceId:t.spaceId,canJoinRedirectSpace:t.canJoinSpace,onboardingCompleted:R,mobileOnboardingCompleted:D,isPersonalHomeRedirect:(null==d?void 0:d.isPersonalHomeUrl)??!1}}}return{userStore:C,userSettingsStore:T,userRootStore:x,firstSpace:F,firstSpaceView:E,lastVisitedSpaceView:c,forkPageBlockId:_,publicAccessPageId:w,oauthAuthorizationParams:I,redirectUrl:void 0,redirectPageId:void 0,hasExplicitAccessToRedirectPage:void 0,redirectSpaceId:void 0,canJoinRedirectSpace:void 0,onboardingCompleted:R,mobileOnboardingCompleted:D,redirectSpaceName:void 0,isPersonalHomeRedirect:!1}}function G(e,t){return P.t1.fromV1(t).getIcon()}function K(e,t){const n=t.getName(),o=E.default.getIntl().formatMessage({defaultMessage:"Untitled workspace",id:"spaceHelpers.getSpaceName.untitledWorkspace.name"});if(n)return n||o;{const n=M.Z.getPublicSpaceData(e,t.id);if(n)return n.name||o}return o}function $(e){return function(e){return(0,P.Vh)(e,{table:c.bx,id:e.id},"permissions")}(e).getValue()||[]}function Q(e,t){const n=e.currentUser.id,o=t.getPagesStore().getValue();if(o&&n){const e=R.Z.getSpaceInaccessiblePages(t.id,n);return e?o.filter((t=>!e.has(t))):o}return[]}function Y(e,t){const n=t.getPagesStore();return Q(e,t).map((e=>P.G.createChildStore(n,{table:l.iU,id:e})))}function J(e,t,n){const o=M.Z.getPublicSpaceData(e,t),i=!Boolean(null==o?void 0:o.domainIsAutogenerated),r=a.oA([i&&(null==o?void 0:o.domain),"invite",n]).join("/");return`${w.default.domainBaseUrl}/${r}`}function X(e){const{currentUserRootStore:t}=C.default.state;return null==t?void 0:t.getSpaceViewStores().find((t=>t.getSpaceId()===e))}function ee(e,t){var n,o;if(null!==(n=e.mobileNative)&&void 0!==n&&n.supportsNativeHomeOnPhone())return"last_visited_page";const i=(null==t||null===(o=t.getSettings())||void 0===o?void 0:o.on_app_start)||d.DB[0];return(0,j.QI)()||"personal_home"!==i?i:"first_page"}function te(e){return!!e&&!e.canRead()}function ne(e){return!!e&&e.getZeroRetentionEnabled()}function oe(e,t){const n=(0,D.CM)(t)||[],o=e.currentUser.id;for(const i of n)if(i.userId===o&&"none"===i.role&&i.isTeamGuest)return!0;return!1}function ie(e){return!!e&&e.canAdmin()}function re(e){let{spaceStore:t,groupId:n}=e;return((null==t?void 0:t.getPermissionGroups())||[]).find((e=>e.id===n))}function ae(e){const t=C.default.state.currentSpaceStore,n=e.currentUser.id;return!(null==t||!t.isDefined()||!n)&&(0,g.wv)({permissions:t.getPermissionItems()},n)}function se(){const e=C.default.state.currentSpaceStore;return!(null==e||!e.isDefined())&&"enterprise"===e.getSubscriptionTier()}function le(e){const t=e.getSubscriptionTier();return"plus"===t||"business"===t||"enterprise"===t}function ce(e){const t=function(e){const t=null==e?void 0:e.getCreatedTime();return t?(0,r.O5)(t):null}(e);return null!==t&&t<=7}function de(e){return(0,h.lm)(e)&&"none"!==e.role?e.planType:void 0}function ue(e){return(0,h.lm)(e)&&"none"!==e.role?e.createdTime:void 0}function pe(e){return(0,h.lm)(e)&&"none"!==e.role?e.subscriptionTier:void 0}function me(e){return T.default.checkGate("guest_invite_requests")&&(null==e?void 0:e.getEnableGuestInviteRequest())}function fe(e){return Boolean(me(e))&&!Boolean(null==e?void 0:e.canAdmin())}},16639:(e,t,n)=>{n.d(t,{N5:()=>p,kF:()=>c,kQ:()=>d,rm:()=>u});var o=n(72126),i=n(27006),r=n(19889),a=n(5366),s=n(20454);const l=(0,a.defineMessages)({untitledGroupName:{defaultMessage:"Untitled",id:"spaceBasicSettings.spacePermissionsSettings.groupsTab.defaultNewGroupName"}});function c(e){const{intl:t,group:n}=e;return n.name||t.formatMessage(l.untitledGroupName)}function d(e){const{group:t,spaceStore:n}=e,o=t.user_ids||[];if(!n)return[];const i=n.getPermissionItems();return o.filter((e=>Boolean(i.find((t=>"user_permission"===t.type&&t.user_id===e)))))}function u(e){const{group:t,spaceStore:n,limit:i}=e,a=d({group:t,spaceStore:n}),l=a.length;if(!n)return{countRemainingUsers:0,totalNumberMembers:l,limitedUserStores:[]};const c=i?a.slice(0,i):a;return{limitedUserStores:o.oA(a.map((e=>s.U.createChildStore(n,{table:r.KJ,id:e})))),countRemainingUsers:a.length-c.length,totalNumberMembers:l}}function p(e){let{userStores:t,spaceStore:n,intl:r}=e;return o.MR(t,(e=>e.getSearchName(r))).sort(((e,t)=>{var o,r;if(!n)return 0;const a=n.getPermissionItems(),s=null===(o=a.find((t=>"user_permission"===t.type&&t.user_id===e.id)))||void 0===o?void 0:o.role,l=null===(r=a.find((e=>"user_permission"===e.type&&e.user_id===t.id)))||void 0===r?void 0:r.role;return s&&l?i.Av.indexOf(l)-i.Av.indexOf(s):0}))}},15517:(e,t,n)=>{n.d(t,{ZL:()=>u,lr:()=>l,mn:()=>d,sK:()=>s});var o=n(68626),i=n(15157),r=n(63143),a=n(61738);async function s(){if("storage"in navigator&&"estimate"in navigator.storage){const{quota:e,usage:t}=await navigator.storage.estimate();if("number"==typeof e&&"number"==typeof t)return{quota:e,usage:t}}if("webkitPersistentStorage"in navigator){const e=navigator.webkitPersistentStorage;if("queryUsageAndQuota"in e)return new Promise((t=>{e.queryUsageAndQuota(((e,n)=>{t("number"==typeof n&&"number"==typeof e?{usage:e,quota:n}:void 0)}),(()=>t(void 0)))}))}}async function l(){if(navigator.storage&&navigator.storage.persist)try{const e=await navigator.storage.persist();return o.clientLogglyEnvironmentData.isPersistent=e,e}catch(e){console.trace("Persistence is disabled",e)}}const c=15*r.js;function d(e){const{quota:t,usage:n}=e;return n/t<=.9&&t>=c}function u(e){e?(a.Z.clearForUser(e),i.Z.clearStorageForUser(e)):localStorage.clear()}},75024:(e,t,n)=>{n.d(t,{Dp:()=>l,W6:()=>a,jy:()=>u,mK:()=>r,pd:()=>c,wK:()=>d,yv:()=>s});var o=n(97880),i=n(82990);const r={listStyleType:"none",padding:0,margin:0},a={border:"none",background:"none",padding:0,fontSize:"1em"};i.Z.fontWeight.regular;function s(e,t){const n="UIRegular"===t?i.Z.fontSize.UIRegular:"UISmall"===t?i.Z.fontSize.UISmall:(0,o.t1)(t);return e.device.isMobile?n.mobile:n.desktop}function l(e,t){const n="UIRegular"===t?i.Z.lineHeight.UIRegular:"UISmall"===t?i.Z.lineHeight.UISmall:(0,o.t1)(t);return e.device.isMobile?n.mobile:n.desktop}function c(e){return{display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:e}}function d(e){let{topLeft:t,topRight:n,bottomLeft:o,bottomRight:i}=e;return[t,n,i,o].map((e=>e?`${e}px`:"0")).join(" ")}const u={position:"absolute",overflow:"hidden",clip:"rect(1px, 1px, 1px, 1px)",whiteSpace:"nowrap",height:1,width:1}},52315:(e,t,n)=>{n.d(t,{b:()=>o,r:()=>i});const o=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.isReady())return!1;if(n[e.id])return!0;if(n[e.id]=!0,r(e,t))return!0;const i=e.getContentStores();let a=!0;for(const r of i)o(r,!1,n)||(a=!1);return a};async function i(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(await e.load(),n[e.id])return;if(n[e.id]=!0,r(e,t))return;const o=e.getContentStores();await Promise.all(o.map((e=>i(e,!1,n))))}function r(e,t){return!(!e.isPageBlock()||t)||!!e.isCollectionView()}},32363:(e,t,n)=>{n.d(t,{ni:()=>u,wY:()=>c});n(67294);var o=n(5366),i=n(97880),r=n(44876),a=n(30874),s=n(33929),l=n(85893);function c(e,t){const n=function(e,t){if(!e)return;const n=(0,r.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==n.type)return;return n.integration.name}(e),s=function(e,t){if(!e)return;const n=(0,r.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==n.type)return;if(!n.pattern.collectionItemType)return;switch(n.pattern.collectionItemType){case"project":return(0,l.jsx)(o.FormattedMessage,{defaultMessage:"Project",id:"syncedCollectionIndicators.project.label"});case"pull_request":return(0,l.jsx)(o.FormattedMessage,{defaultMessage:"Pull Requests",id:"syncedCollectionIndicators.pullRequests.label"});case"issue":return(0,l.jsx)(o.FormattedMessage,{defaultMessage:"Issues",id:"syncedCollectionIndicators.issues.label"});case"calendar":return(0,l.jsx)(o.FormattedMessage,{defaultMessage:"Calendar",id:"syncedCollectionIndicators.calendar.label"});case"release":return(0,l.jsx)(o.FormattedMessage,{defaultMessage:"Releases",id:"syncedCollectionIndicators.releases.label"});default:(0,i.t1)(n.pattern.collectionItemType)}}(e,t);return s?n?(0,l.jsx)(o.FormattedMessage,{id:"syncedCollectionIndicators.originalUrlWithIntegration",defaultMessage:"{collectionType} in {integrationName}",values:{integrationName:n,collectionType:s}}):(0,l.jsx)("span",{children:n}):(0,l.jsx)(o.FormattedMessage,{defaultMessage:"Link to original url",id:"syncedCollectionIndicators.originalUrl"})}const d=(0,o.defineMessages)({github_pull:{defaultMessage:"Oauth Pull Request",id:"syncedCollectionIndicators.oauthGithubPullRequest.label"},github_issue:{defaultMessage:"Oauth Issue",id:"syncedCollectionIndicators.oauthGithubIssue.label"},Event:{defaultMessage:"Event",id:"syncedCollectionIndicators.event.label"},figma_file:{defaultMessage:"File",id:"syncedCollectionIndicators.figmaFile.label"},google_drive_file:{defaultMessage:"File",id:"syncedCollectionIndicators.googleDriveFile.label"},zendesk_ticket:{defaultMessage:"Ticket",id:"syncedCollectionIndicators.zendeskTicket.label"}});function u(e){const{pattern:t,integration:n}=e;return`${n.name} ${function(e){switch(e.name){case"Event":return s.default.formatMessage(d.Event);case"figma_file":return s.default.formatMessage(d.figma_file);case"github_pull":return s.default.formatMessage(d.github_pull);case"github_issue":return s.default.formatMessage(d.github_issue);case"google_drive_file":return s.default.formatMessage(d.google_drive_file);case"zendesk_ticket":return s.default.formatMessage(d.zendesk_ticket);default:return e.name}}(t)}`}},40150:(e,t,n)=>{n.d(t,{AV:()=>p,Xx:()=>h,_n:()=>g,bp:()=>d,bu:()=>f,f2:()=>v,iZ:()=>w,lO:()=>y,lZ:()=>b,mH:()=>u,oc:()=>_,tA:()=>m,vg:()=>S});var o=n(8848),i=n(51454),r=n(92650),a=n(24646),s=n(27724),l=n(78316),c=n(77181);function d(e,t){return e.col===t.col&&e.row===t.row}const u="text/_notion-table",p=function(e){return{minCol:Math.min(e.start.col,e.end.col),maxCol:Math.max(e.start.col,e.end.col),minRow:Math.min(e.start.row,e.end.row),maxRow:Math.max(e.start.row,e.end.row)}},m=14,f=32,g=-8,h=f+g,v=e=>{let{columnIndex:t,titleColumnIndex:n,indentLevel:o,shouldShowBulkActionsToolbar:i,isSubitemToggleOnTitleColumn:r}=e;const a=0===t&&i?h:0;return b({columnIndex:t,titleColumnIndex:n,indentLevel:o,isSubitemToggleOnTitleColumn:r})+a},b=e=>{let{columnIndex:t,titleColumnIndex:n,indentLevel:o,isSubitemToggleOnTitleColumn:i}=e;return y({columnIndex:t,titleColumnIndex:n,isSubitemToggleOnTitleColumn:i})&&o>0?c.Hw*o+c.gY:0},y=e=>{let{columnIndex:t,titleColumnIndex:n,isSubitemToggleOnTitleColumn:o}=e;return o?t===n:0===t},S=e=>{let{collectionViewBlockId:t}=e;const n=s.default.state.stores;return 0!==n.length&&!(0,l.v_)(n,t)};function _(e){const{environment:t,collectionContextStore:n,isMobile:r,stickyLeft:s,theme:l}=e;if(r)return{};const c=n.collectionViewBlockStore(),d=null==c?void 0:c.getParentBlockStore();let u;const p=n.isInPeekRenderer.state;if("dark"===l.mode&&p&&(u=l.peekModalBackground),d&&!n.isFullScreen.state&&(null==c||!c.isRootOrDirectChild())){var m;const e=null===(m=d.getModel())||void 0===m?void 0:m.getFormat().block_color;e&&(u=(0,o.fi)(e,l).background)}const f=n.frozoneStore.state.scrollerLeftOffset??0,g=(0,a.Wk)(t),h=Math.max(g-f,0),v=w(t,n)?h:0;return{background:u||l.contentBackground,position:"sticky",left:(s||0)+v,zIndex:i.I5}}function w(e,t){const n=t.collectionViewBlockStore();return!!n&&(n.isRootOrDirectChild()&&(0,r.fg)(e,n)&&!(0,l._5)(n)&&!n.isCollectionViewPageWithContent())}},78122:(e,t,n)=>{n.d(t,{A8:()=>u,Bj:()=>b,Bt:()=>_,Fy:()=>g,T0:()=>m,Xg:()=>S,ZH:()=>p,hC:()=>y,hL:()=>v,iT:()=>f,wG:()=>h});n(67294);var o=n(72126),i=n(5366),r=n(97880),a=n(86080),s=n(47307),l=n(64369),c=n(95697),d=n(85893);async function u(e){let{isCurrentUser:t,teamName:n,memberName:o}=e;return await s.confirmUserAction({message:t?(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Are you sure you want to leave {teamName}?",id:"teamActions.leaveTeam.confirmDialogMessage.removingYourself",values:{teamName:n}}):(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogMessage.removingSomeoneElse",defaultMessage:"Are you sure you want to remove {memberName} from {teamName}?",values:{memberName:o,teamName:n}}),description:t?(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingYourself",defaultMessage:"You'll no longer see this teamspace in your sidebar and you may lose permissions to the teamspace's pages."}):(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingSomeoneElse",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),acceptLabel:t?(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Leave Teamspace",id:"teamActions.leaveTeam.confirmDialogAcceptLabel.removingYourself"}):(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Remove",id:"teamActions.leaveTeam.confirmDialogAcceptLabel"}),cancelLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogCancelLabel.removingSomeoneElse",defaultMessage:"Cancel"})})}function p(){s.showMessage({message:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.onlyTeamMemberLeftDialogMessage",defaultMessage:"Invite another teamspace owner to leave this teamspace"})})}function m(e){s.showMessage({message:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.userMembershipFromGroupDialogMessage",defaultMessage:"You can't leave this teamspace because you're a member of {groupNames}.",values:{groupNames:o.oA(e.map((e=>`"${e.name}"`))).join(", ")}})})}function f(e){var t;let{group:n,onAccept:o}=e;s.showDialog({message:n.name?(0,d.jsx)(i.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title",defaultMessage:"Are you sure you want to remove {groupName}?",values:{groupName:n.name}}):(0,d.jsx)(i.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title.noGroupName",defaultMessage:"Are you sure you want to remove this group?"}),description:(0,d.jsx)(i.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.description",defaultMessage:"{numGroupMembers} {numGroupMembers, plural, one {member} other {members}} from this group will be removed from this teamspace.",values:{numGroupMembers:(null===(t=n.user_ids)||void 0===t?void 0:t.length)||0}}),showCancel:!0,keepFocus:!1,handleCancel:s.dismissDialog,items:[{label:(0,d.jsx)(i.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.confirmationButton",defaultMessage:"Remove group"}),color:"red",onAccept:o}]})}async function g(e,t){return await a.b({message:(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,d.jsx)(i.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogTitle",defaultMessage:"Are you sure you want to archive this teamspace?"}),(0,d.jsx)(l.Z,{isMultiline:!0,style:{marginTop:8},children:t?(0,d.jsx)(i.FormattedMessage,{id:"teamActions.archiveTeam.transitionToZeroTeams.confirmDialogDescription",defaultMessage:'This is your last default teamspace. Archiving will remove the "Teamspaces" section in your sidebar. Type the teamspace name to confirm.'}):(0,d.jsx)(i.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogDescription",defaultMessage:"Archiving this teamspace will remove access and hide it in the sidebar for all teamspace members. Type the teamspace name to confirm."})})]}),acceptLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogAcceptLabel",defaultMessage:"Archive teamspace"}),requiredInputValue:e})}async function h(e){return await s.confirmUserAction({message:(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogTitle",defaultMessage:'Would you like to move pages under {teamName} to the "Private" and "Shared" sections in your sidebar?',values:{teamName:e}})}),acceptLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogAcceptLabel",defaultMessage:"Move pages"}),cancelLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogCancelLabel",defaultMessage:"Proceed without moving pages"})})}async function v(e){let{teamName:t,currentIsDefault:n,accessLevel:o,isDefault:a,numberOfTeamGuests:l}=e;const c=(0,d.jsx)("div",{style:{marginTop:8},children:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.confirmTeamAccessDialog.disableDefaultTeamLabel",defaultMessage:"{teamName} will also no longer be a default teamspace and auto-add workspace members.",values:{teamName:t}})});let u,p;return"private"===o?(u=(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} private?",id:"teamActions.confirmTeamAccessChangeDialog.privateTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.privateTeam.description",defaultMessage:"Only members will be able to see the teamspace and its content."}),n&&c]})):a?l>0?(u=(0,d.jsx)(i.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeamWithGuests.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),p=(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.defaultTeamWithGuests.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace. Additionally, {numberOfTeamGuests} teamspace guests will be removed.",values:{numberOfTeamGuests:l}})):(u=(0,d.jsx)(i.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeam.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),p=(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.defaultTeam.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace."})):"open"===o?(u=(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} open?",id:"teamActions.confirmTeamAccessChangeDialog.openTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[!n&&(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.openTeam.description",defaultMessage:"Everyone in the workspace will have access to the teamspace and its content."}),n&&c]})):"closed"===o?(u=(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} closed?",id:"teamActions.confirmTeamAccessChangeDialog.closedTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.closedTeam.description",defaultMessage:"The teamspace will still be discoverable, but joining will be invite-only."}),n&&c]})):(0,r.t1)(o),await s.confirmUserAction({message:u,description:p})}async function b(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disableGuests.confirmationTitle",defaultMessage:"Are you sure? All page guests in this teamspace will be removed."});break;case"disable_public_access":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disablePublicPages.confirmationTitle",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this teamspace."});break;case"disable_export":case"disable_team_page_edits":return!0;default:(0,r.t1)(e)}return await s.confirmUserAction({message:t})}async function y(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disableGuestsOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow guests on this teamspace? By default, guests are not allowed on teamspaces in this workspace."});break;case"disable_public_access":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disablePublicPagesOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be made public? By default, pages in this workspace cannot be made public."});break;case"disable_export":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disableExportOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be exported? By default, pages in this workspace cannot be exported."});break;case"disable_team_page_edits":return!0;default:(0,r.t1)(e)}return await s.confirmUserAction({message:t,acceptLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.workspaceSettingOverride.confirmationButtonLabel",defaultMessage:"Override workspace setting"})})}async function S(e){let{environment:t,spaceStore:n,teamName:o}=e;const r=t.currentUser.id;if(!r||!n)return!0;return!(await(0,c.F0)({environment:t,spaceStore:n,currentUserId:r})).some((e=>{var t;return(null===(t=e.getName())||void 0===t?void 0:t.trim())===o.trim()}))||await s.confirmUserAction({message:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.message",defaultMessage:"A teamspace with the same name already exists. Are you sure you want to name this teamspace “{teamName}”?",values:{teamName:o}}),cancelLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.cancelLabel",defaultMessage:"Cancel"})})}async function _(){return await s.confirmUserAction({message:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.setTeamPermissions.ClearCustomTeamPermissionsDialogMessage",defaultMessage:"Raising the permission level for all teamspace members will remove some custom permissions. Are you sure you want to proceed?"}),cancelLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.setTeamPermissions.cancelLabel",defaultMessage:"Cancel"})})}},21115:(e,t,n)=>{n.d(t,{$$:()=>u,CC:()=>g,JB:()=>h,K9:()=>m,Ke:()=>v,_t:()=>d,e6:()=>p,zs:()=>f});var o=n(5366),i=n(64964),r=n(1310),a=n(19306),s=n(33929);const l=(0,o.defineMessages)({leftTeam:{id:"teamPermissionsActions.leftTeam",defaultMessage:"Left {teamName}"},leftTeamNoName:{id:"teamPermissionsActions.leftTeamNoName",defaultMessage:"Left team"},leftYetStillInTeam:{id:"teamPermissionsActions.leftYetStillInTeam",defaultMessage:"You are still in {hasTeamName, select, true {{teamName}} other {the team}} because you are a member of the following groups: {groupsString}"},removedYetStillInTeam:{id:"teamPermissionsActions.removedYetStillInTeam",defaultMessage:"{hasMemberName, select, true {{memberName}} other {The removed user}} is still in {hasTeamName, select, true {{teamName}} other {the team}} because they are a member of the following groups: {groupsString}"},joinedTeam:{id:"teamPermissionsActions.joinedTeam",defaultMessage:"Joined {teamName}"},joinedTeamUsingAdminPrivileges:{id:"teamPermissionsActions.joinedTeamUsingAdminPrivileges",defaultMessage:"Joined {teamName} using admin privileges"},upgradedSelfToOwner:{id:"teamPermissionsActions.upgradedSelfToOwnerUsingAdminPrivileges",defaultMessage:"Became owner of {teamName} using admin privileges"},archivedTeam:{id:"teamPermissionsActions.archivedTeam",defaultMessage:"Archived {teamName}"},restoredTeam:{id:"teamPermissionsActions.restoredTeam",defaultMessage:"Restored {teamName}"},restoredTeamNoName:{id:"teamPermissionsActions.restoredTeamNoName",defaultMessage:"Restored team"},duplicatedTeam:{id:"teamPermissionsActions.duplicatedTeam",defaultMessage:"Duplicated {teamName}"},duplicatedTeamNoName:{id:"teamPermissionsActions.duplicatedTeamNoName",defaultMessage:"Duplicated teamspace"}}),c=(e,t,n)=>{const o=s.default.formatMessage(e,{...t});i.oV({label:o,durationMs:n})},d=e=>c(l.upgradedSelfToOwner,{teamName:e}),u=e=>{let{teamName:t,usingAdminPrivileges:n}=e;return c(n?l.joinedTeamUsingAdminPrivileges:l.joinedTeam,{teamName:t})},p=e=>e?c(l.leftTeam,{teamName:e}):c(l.leftTeamNoName),m=(e,t)=>{const n=(0,a.W)(t.flatMap((e=>e.name||[])));c(l.leftYetStillInTeam,{hasTeamName:void 0!==e,teamName:e,groupsString:n},r.JY)},f=(e,t,n)=>{const o=(0,a.W)(n.flatMap((e=>e.name||[])));c(l.removedYetStillInTeam,{hasMemberName:void 0!==e,hasTeamName:void 0!==t,memberName:e,teamName:t,groupsString:o},r.JY)},g=e=>c(l.archivedTeam,{teamName:e}),h=e=>e?c(l.restoredTeam,{teamName:e}):c(l.restoredTeamNoName),v=e=>e?c(l.duplicatedTeam,{teamName:e}):c(l.duplicatedTeamNoName)},95697:(e,t,n)=>{n.d(t,{q9:()=>de,$r:()=>se,ZN:()=>le,oI:()=>L,Xq:()=>Q,KP:()=>ae,W8:()=>ue,Pr:()=>Y,qX:()=>z,F0:()=>G,sj:()=>H,tu:()=>he,wP:()=>fe,Mf:()=>W,xo:()=>re,tO:()=>oe,xf:()=>ie,ku:()=>Z,AL:()=>te,QI:()=>F,BC:()=>O,U2:()=>pe,zz:()=>ne,bq:()=>U,Hu:()=>$,tV:()=>me,C2:()=>K,dY:()=>ge,$:()=>X,v1:()=>N,Gc:()=>V,OX:()=>ee});n(57658);var o=n(480),i=n(86628),r=n(14577),a=n(29477);const s=Symbol("unset");class l{constructor(e){this.timeoutMs=void 0,this.fetch=void 0,this.useLastValue=void 0,this.promise=void 0,this.lastFetched=void 0,this.lastValue=void 0,this.changeTrigger=a.UZ();const{timeoutMs:t,fetch:n,useLastValue:o}=e;this.timeoutMs=t,this.fetch=n,this.promise=void 0,this.useLastValue=o,this.lastValue=s}async getWithState(){if(this.isReady()&&this.lastValue!==s)return{value:this.lastValue,state:"cached"};if(this.promise)return{value:await this.promise,state:"cached"};this.promise=this.fetch().catch((e=>{if(this.useLastValue&&this.lastValue!==s)return this.lastValue;throw e}));try{const e=await this.promise;return this.lastFetched=Date.now(),e!==this.lastValue&&(this.changeTrigger.resolve(e),this.changeTrigger=a.UZ()),this.lastValue=e,{value:e,state:"fetched"}}finally{this.promise=void 0}}async get(){const{value:e}=await this.getWithState();return e}isReady(){const e=Date.now();return Boolean(this.lastFetched&&this.lastValue!==s&&this.lastFetched>e-this.timeoutMs)}waitUntilChange(){return this.changeTrigger.promise}}var c=n(68626),d=n(72126),u=n(5366),p=n(26825),m=n(27006),f=n(45953),g=n(29369),h=n(19889),v=n(64684),b=n(97880),y=n(54642),S=n(95477),_=n(38676),w=n(80444),k=n(77080),I=n(45483),C=n(35661),x=n(78291),T=n(30397),M=n(88893),P=n(60396),A=n(28020),R=n(4708),D=n(15010),B=n(67669),E=n(38755);function F(){return k.default.checkGate("sidebar_home_gate")}function Z(){return k.default.checkGate("sidebar_pages_hide_toggles")}function L(){return S.default.isAdminMode||!1}const j=d.HP((()=>new r.Z((()=>{const{currentSpaceStore:e}=w.default.state;return!!e&&e.isTeamsEnabled()}),{debugName:"teamsEnabledStore"})));function V(){return(0,i.VK)((()=>j().state),[])}function U(){return j().state}function O(){return k.default.checkGate("allow_experimental_home_features")}function N(){return(0,i.VK)((()=>O()),[])}async function z(e){let{environment:t,spaceStore:n,includeArchived:o=!1,currentUserId:i}=e;const r=await y.getTeams(t,{spaceId:n.id,includeArchived:o},i);return"failed"===r.type?(c.rateLimitedLog({from:"teamsHelpers",level:"error",type:"getTeamsFailed"}),[]):r.data.teamIds.map((e=>C.zX.createChildStore(n,{table:g.e0,id:e})))}async function H(e){let{spaceStore:t,currentUserId:n,includeArchived:o,minRoleOnTeamStores:i,environment:r}=e;if(!t||!n)return[];const a=await y.getAllTeamsInSpaceForAdmin(r,{spaceId:t.id,includeArchived:o},n);if("failed"===a.type)return[];const s=a.data.teamIds.map((e=>C.zX.createChildStore(t,{table:g.e0,id:e}))),l=[],c=[];for(const m of s){const e=m.getRole()??"none";(0,p.gr)(e,i)?c.push(m.id):l.push(m)}const d=f.Ak.create(a.data.recordMap);P.Z.initialize({environment:r,userId:n,spaceId:t.id,teamIds:a.data.teamIds,getRecordWithRole:e=>({role:i,value:d.getValue(e)})});const u=c.map((e=>P.Z.createTeamStoreFromCache({environment:r,teamId:e,spaceId:t.id,userId:n}))).filter(b.$K);return[...l,...u]}function W(e){return T.Z.state.teams.filter((t=>t.getMembers().some((t=>"user"===t.entity_type&&t.user_id===e))))}const q=new Map;async function G(e){let{environment:t,spaceStore:n,includeArchived:o=!1,currentUserId:i}=e;const r=`${n.id}:${o}`,a=q.get(r);if(a)return a.get();const s=new l({timeoutMs:3e4,fetch:async()=>z({environment:t,spaceStore:n,includeArchived:o,currentUserId:i}),useLastValue:!0});return q.set(r,s),s.get()}function K(e){return!!e&&"private"===(0,v.B5)(e)}function $(e){return e&&(0,v.jI)(e)}function Q(e){let{environment:t,spaceStore:n}=e;return!!n&&(!(0,E.Cx)(n)&&((0,E.Fn)(t)||!n.getDisableTeamCreation()))}function Y(e){const t=(0,B.YO)(e).map((e=>e.permissionItem)),n=t.find(m.ix),o=(null==n?void 0:n.role)??"none",i=(0,M.Io)().reduce(((e,t)=>(e.add(t.userId),e)),new Set),r=t.filter((e=>!(!(0,m.jg)(e)||!i.has(e.user_id))||!!(0,m.hV)(e))),a=function(e){if(0===e.length)return;return e.reduce(((e,t)=>(0,p.SL)(t,e)?t:e),e[0])}(r.map((e=>e.role)))??"read_and_write";return{accessLevel:"none"===o?"private":"closed",spacePermissionRole:o,teamPermissionRole:(0,p.nl)(a,o),members:r.map((e=>{const{type:t}=e;return"user_permission"===t?{entity_type:"user",type:"member",user_id:e.user_id}:"group_permission"===t?{entity_type:"group",type:"member",group_id:e.group_id}:void(0,b.t1)(t)}))}}function J(e){let{environment:t,currentSpaceStore:n,subscriptionData:o}=e;return!!n&&(!t.device.isMobile&&!n.isTeamsEnabled()&&!(0,M.wY)(o)&&(0,E.lQ)(n))}function X(e){const{currentSpaceStore:t}=w.default.state;return J({environment:e,currentSpaceStore:t,subscriptionData:x.default.state.data})}function ee(){const e=(0,o.O7)();return(0,i.VK)((()=>{const{currentSpaceStore:t}=w.default.state,n=x.default.state.data;return J({environment:e,currentSpaceStore:t,subscriptionData:n})}),[e])}function te(e){let{teamStore:t,spaceStore:n,userId:o}=e;return!!(t.isDefined()&&null!=n&&n.isDefined()&&o)&&(0,v.AL)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:n.getPermissionItems(),permission_groups:n.getPermissionGroups()},userId:o})}function ne(e){let{teamStore:t,spaceStore:n,userId:o}=e;return!(!t.isDefined()||!o)&&(0,v.zz)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:(null==n?void 0:n.getPermissionItems())||[],permission_groups:(null==n?void 0:n.getPermissionGroups())||[]},userId:o})}function oe(e){let{teamStore:t,spaceStore:n}=e;return n?(0,v.tO)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:n.getPermissionItems(),permission_groups:n.getPermissionGroups()}}):[]}function ie(e){let{teamStore:t,spaceStore:n}=e;return n?(0,v.xf)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:n.getPermissionItems(),permission_groups:n.getPermissionGroups()}}):[]}function re(){return T.Z.state.teams.flatMap((e=>e.getTeamPages()))}function ae(e,t){return e.isDefault()?-1:t.isDefault()?1:0}const se=["owner","member"],le=["owner","member","team_level_guest"],ce=(0,u.defineMessages)({ownerLabel:{id:"teamPermissionsMenu.ownerItem.label",defaultMessage:"Teamspace owner"},ownerCaption:{id:"teamPermissionsMenu.ownerItem.caption",defaultMessage:"Can edit teamspace settings and full access to teamspace pages."},memberLabel:{id:"teamPermissionsMenu.memberItem.label",defaultMessage:"Teamspace member"},memberCaption:{id:"teamPermissionsMenu.memberItem.caption",defaultMessage:"Cannot edit teamspace settings and can access teamspace pages."},guestLabel:{id:"teamPermissionsMenu.guestItem.label",defaultMessage:"Teamspace guest"},guestCaption:{id:"teamPermissionsMenu.guestItem.caption",defaultMessage:"Only has access to invited teamspaces."}}),de={owner:{label:ce.ownerLabel,caption:ce.ownerCaption},member:{label:ce.memberLabel,caption:ce.memberCaption},team_level_guest:{label:ce.guestLabel,caption:ce.guestCaption}};function ue(e){return`${S.default.domainBaseUrl}/team/${e}/join`}function pe(e){var t;return!(null===(t=e.getSettings())||void 0===t||!t.disable_invite_link)}function me(e){const t=[],n=[];for(const o of e)o.isDefined()&&(void 0===o.getArchivedBy()?n.push(o):t.push(o));return{archivedTeams:t,unarchivedTeams:n}}function fe(e){const t=(0,D.WD)(e);if(!t)return!1;const n=t.getKeyStore("settings").getKeyStore("seen_team_add_app_template_tooltip_at").getValue();return void 0!==n&&n>0}function ge(e){let{environment:t,teamId:n}=e;const o=Boolean(_.gV.state);return(0,R.B9)()&&w.default.state.inAppCalloutStore.canShow("team_add_app_template_tooltip")&&!fe(t)&&0===I.Z.state.openModals.size&&o&&function(e){var t;let{environment:n,teamId:o}=e;const i=((null===(t=(0,A.k_)(n).getState())||void 0===t?void 0:t.userJoinedTeamsStores)??[]).find((e=>{const t=e.getTeamPagesStores().filter((e=>{var t;return Boolean(null===(t=e.getCollectionStore())||void 0===t?void 0:t.getDatabaseType())}));return e.canAddOrRemoveTopLevelPages()&&t.length<2}));return!!i&&i.id===o}({environment:t,teamId:n})}function he(e){let{currentUserStore:t,currentSpaceStore:n,teamStore:o,members:i}=e;return d.oA(i.map((e=>{const{entity_type:i}=e;return"user"===i?function(e){let{currentUserStore:t,teamStore:n,member:o}=e;if(!t)return;const i=ve({teamStore:n,member:o}),r=C.U6.createChildStore(t,{table:h.KJ,id:o.user_id});return{type:"user",memberInfo:o,permissionItem:{type:"user_permission",user_id:o.user_id,role:i},userStore:r}}({currentUserStore:t,teamStore:o,member:e}):"group"===i?function(e){let{currentSpaceStore:t,teamStore:n,member:o}=e;const i=(0,E.TC)({spaceStore:t,groupId:o.group_id});if(!i)return;const r=ve({teamStore:n,member:o});return{type:"group",memberInfo:o,permissionItem:{type:"group_permission",group_id:i.id,role:r},permissionGroup:i}}({currentSpaceStore:n,teamStore:o,member:e}):void(0,b.t1)(i)})))}function ve(e){let{teamStore:t,member:n}=e;const o=t.getPermissionItems();if(!o)return"none";const i=function(e){let{permissions:t,member:n}=e;const o=null==t?void 0:t.find((e=>(0,m.hV)(e)&&"group"===n.entity_type&&e.group_id===n.group_id||(0,m.jg)(e)&&"user"===n.entity_type&&n.user_id===e.user_id));return null==o?void 0:o.role}({permissions:o,member:n});return i||(0,v.xC)({id:t.id,permissions:t.getPermissionItems()})}},60846:(e,t,n)=>{n.d(t,{D$:()=>l,JZ:()=>c,NL:()=>s,UZ:()=>d});n(21703);var o=n(52027),i=n.n(o),r=n(15095);const a=new(i()),{DIFF_DELETE:s,DIFF_INSERT:l,DIFF_EQUAL:c}=i(),d=function(e,t){const n=u(e,{count:0,encoding:{},decoding:{}}),o=n.encodedString,i=u(t,n.cypher),r=i.encodedString,s=i.cypher;return function(e,t){return e.map((e=>{let[n,o]=e;return[n,p(o,t)]}))}(a.diff_main(o,r),s).filter((e=>{let[t,n]=e;return""!==n}))};function u(e,t){const n=r.p4(e).map((e=>{const n=t.encoding[e];if(n)return n;{const n=String.fromCharCode(t.count);return t.count++,t.encoding[e]=n,t.decoding[n]=e,n}}));if(t.count>65535)throw new Error("This string has way too many different characters.");const o=n.join("");return{cypher:t,encodedString:o}}function p(e,t){return e.split("").map((e=>t.decoding[e])).join("")}},31352:(e,t,n)=>{n.d(t,{O2:()=>a,Ye:()=>c,ug:()=>s,zK:()=>l});var o=n(15095),i=n(72126),r=n(70203);function a(e,t,n){const a=e.getValue(),s=r.eeV(t),l=r.eeV(a);if(0===s.length&&0===l.length)return""===n?{filter:{startIndex:0,endIndex:0}}:void 0;const c=i.d9(s).reverse(),d=i.d9(l).reverse(),u=l.findIndex(((e,t)=>e!==s[t])),p=d.findIndex(((e,t)=>e!==c[t]));if(-1===u||-1===p)return;const m=o.p4(n),f={filter:{startIndex:u+(m.length>0?1:0),endIndex:u+l.length-s.length}};if(m.length>0){const e=f.filter.startIndex-m.length,t=f.filter.startIndex;l.slice(e,t).join("")===n&&(f.prefix={startIndex:e,endIndex:t})}return f}function s(e,t){if(!t)return;const n=e.getValue();return r.eeV(n).slice(t.filter.startIndex,t.filter.endIndex).join("")}function l(e,t,n){return s(e,a(e,t,n?"@":""))}function c(e,t,n,o,a){if(void 0===e)return!0;if(t&&0===n&&o>3)return!0;if(1===e.length){const t=i.Z$(e);if(t){if(/\s/g.test(t)){const e=a.getValue();if(e&&1===e.length){const t=r.QaF(e);return!(2===t.length&&t.startsWith("/"))}}}}else if(e.length>=2){return e.endsWith("  ")}return!1}},89224:(e,t,n)=>{n.r(t),n.d(t,{areRangesEqual:()=>D,clear:()=>_,containerOffsetIsBetweenNodes:()=>A,get:()=>h,getIncompleteDOMEndpoint:()=>y,getRect:()=>w,getSelectionRect:()=>k,isExpanded:()=>x,isMouseRightClicking:()=>U,isMouseSelecting:()=>V,rangeFromContainerOffsets:()=>T,rangeFromPoint:()=>I,rangeToContainerOffsets:()=>P,resetMouseRightClicking:()=>O,selectionIsBackwards:()=>Z,set:()=>v,setDOMEndpoint:()=>S,setOnNode:()=>C,snapContainerOffsetToNode:()=>R,startListeners:()=>F,toStaticRange:()=>M});n(21703);var o=n(55010),i=n(45060),r=n(1302),a=n(92595),s=n(7406),l=n(68626),c=n(72126),d=n(15723);new WeakMap;let u;const p=c.HP((()=>window.__isElectron?m:()=>window))();function m(){return!u||window.document.hasFocus()?(f("getWindow(): Returning main window because it has focus."),window):u?(f("getWindow(): Returning focused child window."),u):(f("getWindow(): Returning main window because nothing has focus"),window)}function f(){false}var g=n(73744);const h=function(){const e=p().getSelection();if(e&&e.rangeCount>0){return e.getRangeAt(0)}},v=function(e,t){b.reset();const n=window.getSelection();if(n){if(!(t.isFirefox&&parseFloat(t.browserVersion)<92))try{return function(e,t){const{focus:n,anchor:o}=P(t);e.collapse(o.container,o.offset),e.extend(n.container,n.offset)}(n,e)}catch(o){l.log({from:"textSelection",type:"textSelectionSet",level:"error",error:(0,s.tg)(o)})}return function(e,t){const n=document.createRange();n.setStart(t.startContainer,t.startOffset),n.setEnd(t.endContainer,t.endOffset),e.removeAllRanges(),e.addRange(n)}(n,e)}};const b=new class{constructor(e){this.state=void 0,this.debugName=e,(0,a.exposeDebugInstance)("endpointLatch",this)}complete(e){if(this.state&&this.state.endpoint!==e.endpoint&&this.state.onlyIfEqual===e.onlyIfEqual){const t="start"===this.state.endpoint?this.state:e,n="end"===this.state.endpoint?this.state:e;return this.state=void 0,{start:t,end:n}}if(this.state){let t=`${this.debugName}: cannot complete latch:`;const n=this.state.endpoint===e.endpoint,o=this.state.onlyIfEqual!==e.onlyIfEqual;n&&(t+=` same endpoint ${e.endpoint}`),o&&(t+=" different tokens"),l.log({level:"warning",from:"EndpointLatch",type:"cannotCompleteLatch",data:{name:this.debugName,message:t,miscDataToConvertToString:{sameEndpoint:n,differentTokens:o}}})}this.state=e}reset(){this.state&&(l.log({level:"warning",from:"EndpointLatch",type:"resetPartialLatch",data:{name:this.debugName,message:`reset latch with endpoint ${this.state.endpoint}`}}),this.state=void 0)}}("domSelection");function y(){return b.state}function S(e,t){const n=b.complete(e);if(!n)return;const{start:o,end:i}=n,r=T({start:o.position,end:i.position});v(r,t)}function _(e){b.reset();const t=window.getSelection();t&&(e.device.isMobile&&e.device.isAndroid?t.collapse(null,void 0):t.removeAllRanges())}const w=function(e){if(e){if(e.collapsed&&e.getClientRects){const t=c.Go(e.getClientRects()[0]);if(!c.xb(t))return t}else if(e.getBoundingClientRect){const t=c.Go(e.getBoundingClientRect());if(!c.xb(t))return t}if(e.startContainer.nodeType===Node.ELEMENT_NODE){if(0===e.startOffset){const t=e.startContainer.getBoundingClientRect();return new d.iL(t.left,t.top,0,t.height)}const t=e.startContainer.childNodes[e.startOffset-1];if(t&&t.nodeType===Node.ELEMENT_NODE){const e=t.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}const n=e.startContainer.childNodes[e.startOffset];if(n&&n.nodeType===Node.ELEMENT_NODE){const e=n.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}}}};function k(){const e=h();if(e)return w(e)}const I=function(e,t){if(document.caretRangeFromPoint){return document.caretRangeFromPoint(e,t)??void 0}if(document.caretPositionFromPoint){const n=document.caretPositionFromPoint(e,t),o=document.createRange();return o.setStart(n.offsetNode,n.offset),o.setEnd(n.offsetNode,n.offset),o}throw new Error("Browser does not support method caretRangeFromPoint or caretPositionFromPoint")};function C(e,t){const n=document.createRange();n.selectNode(e),v(n,t)}function x(e){return Boolean(e&&!e.collapsed)}function T(e){const{start:t,end:n}=e,o=document.createRange();if(t.container)try{o.setStart(t.container,t.offset)}catch(i){console.info(i)}if(n.container)try{o.setEnd(n.container,n.offset)}catch(i){console.info(i)}return o}function M(e){if(!e)return;const{startContainer:t,startOffset:n,endContainer:o,endOffset:i,collapsed:r}=e;return{startContainer:t,startOffset:n,endContainer:o,endOffset:i,collapsed:r}}function P(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z();const n={container:e.startContainer,offset:e.startOffset},o={container:e.endContainer,offset:e.endOffset},[i,r]=t?[n,o]:[o,n];return{start:n,end:o,focus:i,anchor:r}}function A(e,t,n){if(!t&&!n)return!1;if(!t&&n){const t=document.createRange();return t.selectNode(n),-1===t.comparePoint(e.container,e.offset)}if(t&&!n){const n=document.createRange();return n.selectNode(t),1===n.comparePoint(e.container,e.offset)}if(t&&n){const o=document.createRange();return o.setStartAfter(t),o.setEndBefore(n),0===o.comparePoint(e.container,e.offset)}return!1}function R(e){const{nodesInDomOrder:t,containerOffset:n,snapTowards:o}=e;for(let i=0;i<=t.length;i++){const e=t[i-1],r=t[i];if(A(n,null==e?void 0:e.node,null==r?void 0:r.node))return"start"===o?e:r}}function D(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset&&e.collapsed===t.collapsed}const B=new class{constructor(){this.currentHasNonEmptySelection=!1,this.currentIsBackwards=void 0,this.mouseDownSelection=void 0}selectionIsBackwards(){return Boolean(this.currentHasNonEmptySelection&&this.currentIsBackwards)}updateSelectionDirection(e,t){if(!e||!t||t.collapsed)return this.currentHasNonEmptySelection=!1,void(this.currentIsBackwards=void 0);if(this.currentHasNonEmptySelection=!0,void 0===this.currentIsBackwards){const n=1===t.startContainer.childNodes.length&&t.startContainer.childNodes[0].TEXT_NODE&&t.startContainer.childNodes[0]===e.startContainer;if(e.startContainer===t.startContainer||n)this.currentIsBackwards=t.startOffset<e.startOffset;else{const n=(0,o.Z)(t.startContainer,e.startContainer);this.currentIsBackwards=-1===n}}}startListeners(){window.addEventListener("mousedown",(()=>{r.default.afterNextFlush((()=>{this.mouseDownSelection=h()}))})),window.addEventListener("mouseup",(()=>{r.default.afterNextFlush((()=>{const e=h();this.updateSelectionDirection(this.mouseDownSelection,e)}))})),window.addEventListener("keydown",(()=>{const e=h();r.default.afterNextFlush((()=>{const t=h();this.updateSelectionDirection(e,t)}))}))}},E=new class{constructor(){this.mouseDown=!1,this.keysDown=0,this.wasBackwards=!1,this.device=void 0,this.debugDrawRects=()=>{const e=h();if(x(e)){const{focus:t,anchor:n}=P(e,this.wasBackwards),o=T({start:t,end:t}),r=w(o);r&&(0,i.yX)(r,"FOCUS","red");const a=T({start:n,end:n}),s=w(a);s&&(0,i.yX)(s,"ANCHOR","blue")}},this.handleSelectionChange=()=>{var e;(this.mouseDown||this.keysDown||null!==(e=this.device)&&void 0!==e&&e.isAndroid)&&(this.wasBackwards=function(){const e=window.getSelection();if(!e)return!1;const{focusNode:t,focusOffset:n,anchorNode:i,anchorOffset:r}=e;if(t===i)return n<r;return-1===(0,o.Z)(t,i)}())},this.handleKeyDown=()=>{this.keysDown++},this.handleKeyUp=()=>{this.keysDown--},this.handleMouseDown=()=>{this.mouseDown=!0},this.handleMouseUp=()=>{this.mouseDown=!1}}startListeners(e){return this.device=e,document.addEventListener("selectionchange",this.handleSelectionChange),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("mouseup",this.handleMouseUp),()=>{document.removeEventListener("selectionchange",this.handleSelectionChange),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("mouseup",this.handleMouseUp)}}};function F(e){B.startListeners(),E.startListeners(e)}function Z(){return B.currentIsBackwards||E.wasBackwards}(0,a.exposeDebugGetter)("selectionIsBackwards",Z);let L=!1,j=!1;function V(){return L}function U(){return j}function O(){return j=!1}(0,g.lj)(window,"mousedown",(e=>{0===e.button?L=!0:2===e.button&&(j=!0)}),!0),(0,g.lj)(window,"mouseup",(e=>{0===e.button?L=!1:2===e.button&&(j=!1)}),!0)},89086:(e,t,n)=>{n.d(t,{Gq:()=>Y,HE:()=>J,J5:()=>Q,J6:()=>x,J_:()=>Z,Ld:()=>k,Ov:()=>j,P2:()=>R,Q3:()=>W,Rb:()=>y,Rw:()=>B,ST:()=>A,ZZ:()=>$,a6:()=>I,bj:()=>P,dQ:()=>X,e7:()=>E,fM:()=>G,fu:()=>F,fx:()=>H,hn:()=>N,iB:()=>L,k2:()=>C,lV:()=>K,mK:()=>O,oc:()=>w,qh:()=>q,td:()=>b,wd:()=>S,x0:()=>D,yR:()=>V,yj:()=>M});n(57658);var o=n(55010),i=n(15095),r=n(72126),a=n(70203),s=n(95371),l=n(28685),c=n(95802),d=n(15723),u=n(50628),p=n(27724),m=n(24666),f=n(68056),g=n(45162),h=n(69645);const v="data-text-edit-side";function b(e){return{[v]:e}}function y(e){if(e instanceof HTMLElement){const t=e.closest("[data-text-edit-side]"),n=null==t?void 0:t.getAttribute(v);if("start"===n||"end"===n)return n}}function S(e){return e.startIndex===e.endIndex}function _(e){const{startIndex:t}=e;let n;return n=S(e)&&t>0?[t-1]:function(e){return r.w6(e.startIndex,e.endIndex)}(e),n}function w(e,t){const n=a.lzi(t),o=n.map((e=>i.p4(a.WiV(e))));return e.map((e=>{let t=0;const i=o.findIndex((n=>(t+=n.length,t>e))),r=n[i];return r?a.hDy(r):[]}))}function k(e){if("editing"===m.default.state.mode)return I(e,m.default.state.multiSelection,m.default.state.forceExtendAnnotations)}function I(e,t,n){return C([e],t,n)[e]}function C(e,t,n){const o={};if(0===e.length)return o;if((0,f.iG)(t)){for(const t of e){const e=n[t];if(null!=e&&e.extend){const n=e.annotation;o[t]=n}}return o}const i=new Set(e);let r=!0;const s=(0,g.L5)(t);for(const{store:l,selection:c}of s){const e=l.getValue(),t=a.Ulv(e,c),{tokensInsideRange:n}=a.xrQ(e,t.startIndex,t.endIndex);for(const s of n){const e=a.hDy(s);for(const t of i){const n=e.find((e=>a.J7s(e)===t));if(r&&n)o[t]=n;else if(n);else if(delete o[t],i.delete(t),0===i.size)return o}r=!1}}return o}function x(e){const t=m.default.state;if("editing"!==t.mode)return!1;const{multiSelection:n}=t;if((0,f.iG)(n))return!1;const o=(0,g.L5)(n);for(const{store:r,selection:s}of o){const t=r.getValue();if(!t)continue;const n=a.lzi(t);let o=0;for(const r of n){const t=i.p4(a.WiV(r));if(o>=s.startIndex&&o<s.endIndex||o<s.startIndex&&o+t.length>s.startIndex){if(a.hDy(r).some((t=>a.J7s(t)===e)))return!0}o+=t.length}}return!1}function T(e,t,n){const o=[],i=e[0]||[];for(const r of i){const e=a.J7s(r);if(!a.aLA[e])if(a.k87[e]||a.S_n[e]){A(t,n.startIndex,e)&&o.push(r)}else o.push(r)}return o}function M(e,t){const n=_(e),o=t.getValue()||[];return T(w(n,o),o,e)}function P(){const e=m.default.state;if("editing"!==e.mode)return[];const{multiSelection:t,forceExtendAnnotations:n}=e,o=(0,g.L5)(t);if(0===o.length)return[];const{store:i,selection:s}=o[0],l=i.getValue()||[];let c=T(w(_(s),l),l,s);return r.M6(n,((e,t)=>{e&&(e.extend?c.push(e.annotation):c=c.filter((e=>a.J7s(e)!==t)))})),c}function A(e,t,n){const o=a.b1T(e,t),i=a.hDy(o);return Boolean(i.find((e=>a.J7s(e)===n)))}function R(e){const t=D(e);if(t)return{startIndex:0,endIndex:t.endIndex}}function D(e){const t=l.E.findEditableWithStore(e);if(t)return t.props.getEndSelection?t.props.getEndSelection():void 0;{const t=a.eeV(e.getValue());return{startIndex:t.length,endIndex:t.length}}}function B(e){return 0===e.startIndex&&0===e.endIndex}function E(e,t){return e.store===t&&0===e.index}function F(e,t){return!e&&!t||e&&t&&(e.startIndex===t.startIndex||!e.startIndex&&!t.startIndex)&&(e.endIndex===t.endIndex||!e.endIndex&&!t.endIndex)}function Z(e,t){return F(t,D(e))}function L(e,t){var n;return e.store===t&&e.index===(null===(n=D(t))||void 0===n?void 0:n.endIndex)}function j(){const e=p.default.getCurrentDefaultContainer();return l.E.getMembersByDOMOrder({filter:t=>{const n=t.getContextClosestSelectable();if(!n)return!1;const o=n.getContextSelectableContainer();return o&&o===e}})}function V(e){const t=e.getNode(),n=t?p.default.getDefaultContainerFromTarget(t):p.default.getCurrentDefaultContainer();return l.E.getMembersByDOMOrder({filter:e=>{const t=e.getContextClosestSelectable();if(!t)return!1;const o=t.getContextSelectableContainer();return o&&o===n}})}function U(e){return j().filter((e=>!e.props.disabled)).map((e=>e.props.store))}function O(e){const t=U(),n=t.indexOf(e);return-1===n?null:t[n-1]}function N(e){const t=U(),n=t.indexOf(e);return-1===n?null:t[n+1]}function z(e){const t=[];for(const n of e){const e=r.cx(t,(e=>{const t=e[0];return d.Kr(n.rect,t.rect)}));e>=0?t[e].push(n):t.push([n])}return t}function H(e,t,n){const{selectableRectMap:i}=u.Z.state,a=n?p.default.getDefaultContainerFromTarget(n):void 0,s=p.default.getCurrentDefaultContainer(),l=a||s,d=c.C.getMembersByDOMOrder({filter:e=>e.props.canSelect&&e.props.canEditText&&e.getContextSelectableContainer()===l}),m=[];for(const o of d){const e=i.get(o);e&&m.push({selectable:o,rect:e})}const f=m.filter((e=>{let{rect:n}=e;return n.top<=t}));f.reverse();const g=z(f),h=r.UI(g,(e=>e.sort(((e,t)=>-1*(0,o.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),v=r.F(h,(t=>{let{rect:n}=t;return Math.min(Math.abs(n.left-e),Math.abs(n.right-e))}));if(v)return v;const b=z(m.filter((e=>e.rect.bottom>=t&&f.indexOf(e)<0))),y=r.UI(b,(e=>e.sort(((e,t)=>(0,o.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),S=r.F(y,(t=>{let{rect:n}=t;return Math.min(Math.abs(n.left-e),Math.abs(n.right-e))}));return S||void 0}function W(e,t){const{selectableRectMap:n}=u.Z.state,o=c.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===t});for(let i=o.length-1;i>=0;i--){const t=n.get(o[i]);if(t&&t.bottom>e)return!1}return!0}function q(e,t){const n=(0,h.dq)({includeNonSelectableListContainer:!0});if(!n)return!1;const o=r.Z$((0,s.DY)([n],(e=>e.value.component===t)));if(!o)return!1;const{selectableRectMap:i}=u.Z.state;return!(0,s.Yz)(o,(n=>{const o=n.component&&i.get(n.component);return!!(o&&e<=o.bottom&&n.component!==t)}))}function G(e,t,n){const o=e.getValue(),s=[],l=n?a.Jcv(o):a.QaF(o),{startIndex:c,endIndex:d}=t,u=i.p4(l),p=r.tP(u,0,c),m=r.qr(p,(e=>"\n"===e));m>=0?s.push(m):s.push(0);for(let i=c;i<d;i++){"\n"===u[i]&&s.push(i)}return s}function K(e){const{multiSelection:t}=e;return(0,g.L5)(t).map((e=>{let{store:t,selection:n}=e;const o=a.lzi(t.getValue()),i=a.Ulv(o,n),{tokensInsideRange:r}=a.xrQ(o,i.startIndex,i.endIndex);return a.QaF(r)})).join("\n\n")}function $(e){const t=m.default.state;return"empty"!==t.mode&&Boolean((0,g.r)(t.multiSelection,e))}function Q(e){const t=m.default.state;return"editing"===t.mode&&(t.multiSelection.start.store===e&&(t.multiSelection.end.store===e?"contains-selection":"contains-selection-start"))}function Y(e){const t=m.default.state;if("editing"!==t.mode)return!1;const{start:n,end:o}=t.multiSelection;return n.store===e||o.store===e}function J(e){const t=m.default.state;if("empty"===t.mode)return;const n=(0,f.QY)(t.multiSelection);if(n)return n.store===e?{type:"contain",selection:a.Ulv(e.getValue(),n.selection)}:void 0;const{start:o,end:i}=t.multiSelection;if(o.store===e){const t=a.eeV(e.getValue()).length;return{type:"start",index:Math.min(o.index,t)}}if(i.store===e){const t=a.eeV(e.getValue()).length;return{type:"end",index:Math.min(i.index,t)}}}function X(e){if(!(0,f.iG)(e))return!1;const{store:t,index:n}=e.start;return 0===n||"\n"===a.eeV(t.getValue())[n-1]}},17311:(e,t,n)=>{n.d(t,{Z:()=>o});const o={unit:8,borderRadius:3,card:{desktop:{small:{width:180,height:100},medium:{width:260,height:148},large:{width:320,height:180}},mobile:{width:"100%"}},vertical:{micro:2,tiny:4,small:8,medium:12,large:24},horizontal:{micro:2,tiny:4,small:8,medium:12,large:24}}},16402:(e,t,n)=>{n.d(t,{IS:()=>c,gs:()=>p,hH:()=>d,uy:()=>u});var o=n(44317),i=n(63143),r=n(5366),a=n(33929);const s=(0,r.defineMessages)({year:{id:"timeUtils.durationDescriptor.year",defaultMessage:"{numYears, plural, one {{numYears} year ago} other {{numYears} years ago}}"},day:{id:"timeUtils.durationDescriptor.day",defaultMessage:"{numDays, plural, one {{numDays} day ago} other {{numDays} days ago}}"},hour:{id:"timeUtils.durationDescriptor.hour",defaultMessage:"{numHours, plural, one {{numHours} hour ago} other {{numHours} hours ago}}"},minute:{id:"timeUtils.durationDescriptor.minute",defaultMessage:"{numMinutes, plural, one {{numMinutes} minute ago} other {{numMinutes} minutes ago}}"},second:{id:"timeUtils.durationDescriptor.second",defaultMessage:"Just now"}}),l=(0,r.defineMessages)({year:{id:"timeUtils.durationDescriptor.compactYear",defaultMessage:"{numYears}y ago"},day:{id:"timeUtils.durationDescriptor.compactDay",defaultMessage:"{numDays}d ago"},hour:{id:"timeUtils.durationDescriptor.compactHour",defaultMessage:"{numHours}h ago"},minute:{id:"timeUtils.durationDescriptor.compactMinute",defaultMessage:"{numMinutes}m ago"},second:{id:"timeUtils.durationDescriptor.compactSecond",defaultMessage:"Just now"}});function c(e){let{useCompactFormat:t,useLowercase:n,roundDownYears:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t?l:s,c=new Date(e),d=a.default.getIntl().locale,u=new Date,p=+u-e;if(p>=i._I&&o){const e=Math.floor(p/i._I);return a.default.formatMessage(r.year,{numYears:e})}if(c.getFullYear()!==u.getFullYear())return c.toLocaleDateString(d,{year:"numeric",month:"short",day:"numeric"});const m=Math.floor(p/i.A0);if(m>=3)return c.toLocaleDateString(d,{month:"short",day:"numeric"});if(m>=1)return a.default.formatMessage(r.day,{numDays:m});const f=Math.floor(p/i.U6);if(f>=1)return a.default.formatMessage(r.hour,{numHours:f});const g=Math.floor(p/i.hM);return g>=1?a.default.formatMessage(r.minute,{numMinutes:g}):n?a.default.formatMessage(r.second).toLocaleLowerCase():a.default.formatMessage(r.second)}function d(e,t){const n=t-e,r=Math.floor(n/i._I),s=Math.floor(n/i.A0),l=Math.floor(n/i.U6),c=Math.floor(n/i.hM),d=Math.floor(n/i.C0);return r>=1?a.default.formatMessage(o.eG.year,{numYears:r}):s>=1?a.default.formatMessage(o.eG.day,{numDays:s}):l>=1?a.default.formatMessage(o.eG.hour,{numHours:l}):c>=1?a.default.formatMessage(o.eG.minute,{numMinutes:c}):a.default.formatMessage(o.eG.second,{numSeconds:d})}function u(e,t){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"long",year:"numeric",day:"2-digit",hour:"numeric",minute:"2-digit",second:t?void 0:"2-digit"})}function p(e){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"short",year:"numeric",day:"numeric"})}},35328:(e,t,n)=>{n.d(t,{BX:()=>m,JO:()=>d,_A:()=>c,fn:()=>f,ih:()=>l,m1:()=>p,tZ:()=>u,th:()=>g});var o=n(41432),i=n(72126),r=n(29373),a=n(27724),s=n(45131);function l(e){return Boolean(o.ZY[e])}function c(e,t){return Boolean("toggle"===e||o.wZ[e]&&(null==t?void 0:t.toggleable))}function d(e){return Boolean(o.wZ[e])}function u(e){return o.ZY[e]}function p(e){return o.wZ[e]}function m(e){return"toggle"===e.getType()||f(e)}function f(e){const t=e.getType(),n=e.getFormat();return Boolean(void 0!==t&&(0,o.eJ)(t,n))}function g(e){const t=e.props.store;let n;n=i.q9(a.default.state.stores,t)?a.default.state.stores:[t];const o=!(s.Z.isOpen(t.id)&&!e.props.hideContent);for(const i of n)r.rd({blockId:i.id,state:o,currentUserId:e.environment.currentUser.id})}},99341:(e,t,n)=>{n.d(t,{JG:()=>s,LP:()=>r,Vm:()=>a,_V:()=>c,jQ:()=>l});n(57658);var o=n(72126),i=n(33317);function r(e){return{type:"recordOperation",operation:e}}function a(e,t){let{allowSquashing:n}=t;if(0===e.length)return{squashedTasks:[]};const r={squashedTasks:[],userId:e[0].userId};function a(e){var t,a;const s=o.Z$(r.squashedTasks),l=s?s.task:void 0,c=Boolean((null===(t=e.debug)||void 0===t?void 0:t.userFlow)||(null==l||null===(a=l.debug)||void 0===a?void 0:a.userFlow));s&&l&&n&&!c&&function(e,t){function n(e){const t=e.operations.map((e=>e.pointer));return o.sv(t,o.Xy)}const i=n(e),r=n(t);return 1===i.length&&1===r.length&&o.Xy(i,r)}(l,e)?(l.operations=(0,i.Iw)([...l.operations,...e.operations]),s.subTasks.push(e)):r.squashedTasks.push({task:{...e},subTasks:[e]})}for(const i of e){if(r.userId!==i.userId)return r;if(JSON.stringify(o.VS(r.squashedTasks,(e=>e.task.operations))).length>=c)return 0===r.squashedTasks.length&&a(i),r;a(i)}return r}function s(e){const{transaction:t,timestamp:n,callback:o}=e;return{id:t.id,userId:t.userId,spaceId:t.spaceId,debug:{userAction:t.getUserActionForAnalyticsPurposesOnly(),userFlow:t.getUserFlowForAnalyticsPurposesOnly()},timestamp:n,operations:t.operations,callback:o,useSudoMode:t.useSudoMode}}function l(e){const t=s({transaction:e,timestamp:Date.now(),callback:void 0});return JSON.stringify(t).length>c}const c=1e5},64856:(e,t,n)=>{n.d(t,{AK:()=>a,IJ:()=>c,W$:()=>r,Xv:()=>s,ox:()=>l,wF:()=>d});var o=n(72126),i=n(9163);function r(e,t){return a(d(e,t))}function a(e){return void 0!==e&&(e===i.FW||e===i.lR)}function s(e,t){if(a(t))return;const n=i.eU[e],o=n.steps.findIndex((e=>e.id===t));return-1===o?n.steps[0].id:o===n.steps.length-1?i.FW:n.steps[o+1].id}function l(e,t){const n=d(e,t);if(n&&!a(n))return s(t,n)}function c(e,t){const n=d(e,t);if(n)return function(e,t){const n=i.eU[e];var r;if(a(t))return null===(r=(0,o.Z$)(n.steps))||void 0===r?void 0:r.id;const s=n.steps.findIndex((e=>e.id===t));return-1!==s&&0!==s?n.steps[s-1].id:void 0}(t,n)}function d(e,t){var n;if(!e)return;const o=((null===(n=e.getSettings())||void 0===n?void 0:n.tutorials)||{})[t];return void 0===o?i.eU[t].steps[0].id:o}},66638:(e,t,n)=>{n.d(t,{u:()=>a});var o=n(18245),i=n(88923),r=n(94134);function a(e){const{environment:t,type:n,blockStore:a,store:s,isInCollectionView:l}=e,c=o.default.mark(n),d=null==a?void 0:a.getType();o.default.measureAfterNextFlush(c,{environment:t,getData:()=>{const e=null==a?void 0:a.getType(),t=a&&"properties"===s.path[0]&&"title"===s.path[1],n=a&&"properties"===s.path[0]&&"caption"===s.path[1];return{table:s.table,block_property:t?"title":n?"caption":void 0,block_type:e,block_type_initial:e!==d?d:void 0,peek_mode:i.default.state.mode,is_in_collection_view:l,profiling_tool:r.getProfilingToolForSession()}}})}},36867:(e,t,n)=>{n.d(t,{_:()=>a,g:()=>s});var o=n(7057),i=n(15157);const r="userSessionCount";function a(e){const t=c(e);if(!t)return void l({userId:e,count:1});const{count:n,updatedAt:i}=t;(0,o.$6)(i,!0)!==(0,o.$6)(Date.now(),!0)&&l({userId:e,count:n+1})}function s(e){if(!e)return 0;const t=c(e);return(null==t?void 0:t.count)||0}function l(e){let{userId:t,count:n}=e;const o={count:n,updatedAt:Date.now()};i.Z.set({userId:t,key:r,value:o})}function c(e){return i.Z.get({userId:e,key:r})}},85644:(e,t,n)=>{n.d(t,{AY:()=>a,iL:()=>r,zg:()=>i});var o=n(77080);function i(e){return r()&&e.isType("page")&&!e.isLocked()&&!e.isCollectionView()&&!e.isInsideCollection()&&!e.isAssociatedCollectionAPageTree()&&e.canEdit()}function r(){return o.default.checkGate("wiki_database")}function a(e){var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())??!1}},63474:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(67294),i=n(480),r=n(24215);function a(){const e=(0,i.O7)();return(0,o.useMemo)((()=>(0,r.mc)(e)),[e])}},84398:(e,t,n)=>{n.d(t,{$:()=>a});var o=n(67294),i=n(26263),r=n(480);function a(e,t){const{cacheFallback:n,isMockTextStore:a,isTemporaryData:s,overrideDefaultRecordCache:l}=t??{},c=(0,r.O7)(),{inMemoryRecordCache:d}=c.defaultRecordCache,u=(0,o.useMemo)((()=>{const t=new i.Z({isTemporaryData:Boolean(s),name:e});return t.isMockTextStore=Boolean(a),n&&t.addCacheFallback(n),l&&d.addCacheOverride(t),t}),[n,d,a,s,e,l]);return(0,o.useEffect)((()=>function(){n&&u.removeCacheFallback(n),l&&d.removeCacheOverride(u)}),[n,d,u,l]),u}},2991:(e,t,n)=>{n.d(t,{Kd:()=>l,MH:()=>s});var o=n(67294),i=n(72126),r=n(24990),a=n(77907);const s=i.IH((async function(){const e=await a.deps.emojiData.loader();r.Z.setState(e)}));function l(){return window.__c={n:"LoadAndCacheEmojiData"},(0,o.useEffect)((()=>{s()}),[]),null}},35630:(e,t,n)=>{n.d(t,{AS:()=>s,iP:()=>l});var o=n(67294),i=n(480),r=n(86628);const a=(0,o.createContext)(void 0);function s(e){const t=(0,r.VK)((()=>e.state.height),[e]),n=(0,o.useContext)(a)||window;return n!==window?n.innerHeight:t}function l(){const{WindowSizeStore:e}=(0,i.O7)();return(0,r.VK)((()=>{const{width:t,height:n}=e.state;return{width:t,height:n}}),[e])}},5659:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(92595),i=n(55652),r=n(4408),a=n(45950);const s=(0,o.exposeDebugValue)("offlineDebugger",new class{constructor(){var e=this;this.enableLogging=!1,this.operationLatency={},this.log=function(t){if(e.enableLogging){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];console.groupCollapsed(t,...o),console.trace(),console.groupEnd()}},this.generateLocalRecordMap=a.yY,this.getLocalRecord=a.Ye,this.getLocalBlocksWithParent=a.Dx}async measure(e,t,n){var o=this;const r=`OFFLINE: ${e}:`;return this.operationLatency[e]||(this.operationLatency[e]=new i.s((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.log(r,...t)}))),this.operationLatency[e].measureErrors(t,"hit","miss",n)}trace(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("OFFLINE:",...t)}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("OFFLINE:",...t)}traceMiss(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];this.trace(`missed: record ${e}:${t}`,...o)}clearMemory(){r.LK(window.__console.environment)}})},76856:(e,t,n)=>{function o(e,t,n,o,i){const r="y"===i?"scrollTop":"scrollLeft",a=e[r],s=t-a,l=+new Date;let c=!0,d=null;const u=()=>{if(!c)return;window.requestAnimationFrame(u);const i=+new Date,p=Math.floor(function(e,t,n,o){return(e/=o/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}(i-l,a,s,n));d?d===e[r]?(e[r]=p,d=e[r]):c=!1:(e[r]=p,d=e[r]),i>l+n&&(e[r]=t,c=!1,o&&o())};window.requestAnimationFrame(u)}n.d(t,{Z:()=>o})},75233:(e,t,n)=>{n.d(t,{Z:()=>i});n(21703);var o=n(26263);const i=new class{constructor(){this.pendingEvictions=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.pendingEvictions=new Map}getPendingEvictionCount(){return this.pendingEvictions.size}updateEnvironment(e){this.environmentProvider=()=>e}addToPendingEvictions(e,t){const n=(0,o.R)(e),i={...e,timestamp:t};this.pendingEvictions.set(n,i)}removeFromPendingEvictions(e){this.pendingEvictions.delete((0,o.R)(e))}forEachPendingEviction(e){for(const{pointer:t,userId:n,timestamp:o}of this.pendingEvictions.values())e({userId:n,pointer:t,timestamp:o,environment:this.environmentProvider()})}}},79420:(e,t,n)=>{n.d(t,{Z:()=>r});n(21703);var o=n(26263),i=n(21202);const r=new class{constructor(){this.subscribedRecords=void 0,this.pendingUnsubscribeRecords=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}getPendingUnsubscribeCount(){return this.pendingUnsubscribeRecords.size}updateEnvironment(e){this.environmentProvider=()=>e}getSubscriptionForRecord(e){return this.subscribedRecords.get((0,o.R)(e))}isSubscribedToRecord(e){const t=this.subscribedRecords.get((0,o.R)(e));return Boolean(t)}addToSubscribedRecords(e){const t=(0,o.R)(e),n={...e};this.subscribedRecords.set(t,n)}removeFromSubscribedRecords(e){const t=(0,o.R)(e);this.subscribedRecords.delete(t)}addToPendingUnsubscribeRecords(e,t){const n=(0,o.R)(e),i={...e,timestamp:t};this.pendingUnsubscribeRecords.set(n,i)}removeFromPendingUnsubscribeRecords(e){this.pendingUnsubscribeRecords.delete((0,o.R)(e))}forEachPendingUnsubscribeRecord(e){for(const{pointer:t,userId:n,timestamp:o}of this.pendingUnsubscribeRecords.values())e({userId:n,pointer:t,timestamp:o,environment:this.environmentProvider()})}reset(){this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}safelyGetEnvironment(){try{return this.environmentProvider()}catch(e){return}}getSubscribedBlockDebuggingData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.safelyGetEnvironment();if(!t)return;const n={loadedBlockTypes:{},loaded:0,notLoaded:0};for(const[o,r]of this.subscribedRecords.entries())if((e||!this.pendingUnsubscribeRecords.has(o))&&r.pointer.table===i.iU){const e=t.defaultRecordCache.inMemoryRecordCache.getRecord(r);if(e&&e.value){const t=e.value.type;t in n.loadedBlockTypes||(n.loadedBlockTypes[t]=0),n.loadedBlockTypes[t]+=1,n.loaded+=1}else n.notLoaded+=1}return n}}},32223:(e,t,n)=>{n.r(t),n.d(t,{isConnected:()=>r.Mb,isConnecting:()=>r.J9,onMobileNativeReceiveRawMessageStoreMessage:()=>r.tD,onMobileNativeUpdateMessageStoreState:()=>r.Ce,resetRecordSubscriptions:()=>a,updateEnvironment:()=>s});var o=n(75233),i=n(79420),r=n(88536);function a(){i.Z.reset()}function s(e){i.Z.updateEnvironment(e),o.Z.updateEnvironment(e)}},88536:(e,t,n)=>{n.d(t,{vj:()=>De,mb:()=>L,cO:()=>Pe,C$:()=>j,EM:()=>he,ZN:()=>ve,Tm:()=>ge,Mb:()=>ce,J9:()=>de,id:()=>ue,Ap:()=>Re,tD:()=>xe,Ce:()=>Ce,eg:()=>Be,Tg:()=>we,Ji:()=>Me,Ld:()=>Fe,hd:()=>Ee,r1:()=>Le,L4:()=>Te,g4:()=>pe});n(21703);var o=n(40682),i=n(68626),r=(n(57658),n(7406)),a=n(29477),s=n(21051);const l=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.maxDelayMs=void 0,this.timeSource=void 0,this.queue=[],this.workerTasks=new Map,this.nextWorkerId=0,this.currentWorkers=0,this.requestsRunning=0,this.awaitingTimeout=!1,this.dequeue=async()=>{if(this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;const e=this.nextWorkerId;this.nextWorkerId++,this.currentWorkers++;const t=this.queue.splice(0,this.batchSize),n=t.map((e=>e[0]));let o,i;this.workerTasks.set(e,t),this.requestsRunning+=t.length;try{o=await this.performRequests(n)}catch(a){i=(0,r.tg)(a)}try{if(i)for(let e=0;e<t.length;e++){t[e][1].reject(i)}else if(o)for(let e=0;e<t.length;e++){const n=t[e],i=o[e];n[1].resolve(i)}}catch(a){}this.currentWorkers--,this.workerTasks.delete(e),this.requestsRunning-=t.length,this.dequeueAfterFilledBatchOrTimeout()};const{performRequests:t,batchSize:n,maxWorkers:o,maxDelayMs:i}=e;this.performRequests=t,this.batchSize=n,this.maxWorkers=o,this.maxDelayMs=i,this.timeSource=s.O}getStats(){return{queue:this.queue.length,running:this.requestsRunning,workers:this.currentWorkers}}updateTimeSource(e){this.timeSource=e}updateBatchSize(e){this.batchSize=e}updateMaxDelayMs(e){this.maxDelayMs=e}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterFilledBatchOrTimeout()}enqueue(e){const t=a.UZ();return this.queue.push([e,t]),this.dequeueAfterFilledBatchOrTimeout(),(0,o.m)({promise:t.promise,canCancel:()=>this.queue.some((e=>e[1]===t)),cancel:e=>{const n=this.queue.findIndex((e=>e[1]===t));n>=0&&(this.queue.splice(n,1),t.reject(e))}})}dequeueAfterFilledBatchOrTimeout(){this.queue.length>=this.batchSize?this.dequeue():this.awaitingTimeout||(this.awaitingTimeout=!0,this.timeSource.setTimeout((()=>{this.awaitingTimeout=!1,this.dequeue()}),this.maxDelayMs))}cancel(){const e=this.workerTasks,t=this.queue;this.workerTasks=new Map,this.queue=[];for(const n of e.values())for(const e of n)e[1].reject(new Error("CanceledTask."));for(const n of t)n[1].reject(new Error("CanceledTask."))}};var c=n(72126),d=n(91155),u=n(77897),p=n(75189),m=n(44615),f=n(4615),g=n(12139),h=n(63143),v=n(36054),b=n(95477),y=n(18245),S=n(5162),_=n(88632);const w=window.location.host.endsWith(b.default.publicDomainName);var k=n(1302),I=n(24215),C=n(77080);function x(e,t){k.default.afterNextFlush((()=>{C.default.checkGate("message_store_client_send_request_metric_enabled")&&I.j(e,"message_store.client.send_request",t)}))}const T=async()=>n.e(7168).then(n.bind(n,14854)),M=!1,P=90*h.C0,A=.5*h.C0,R=30*h.C0,D=10*h.C0,B={versions:!0,collection:!0,activity:!0,notification:!0,teams_in_space:!0,user_page_visit:!0,backlinks:!0,user_content:!0,page_visit:!0,user_shared_pages_in_space:!0,presence:!0,user_joined_teams_in_space:!0,teams_migration_completed_in_space:!0,diagnosticPing:!0,_other:!0};function E(e){const t=e.indexOf("/");if(-1===t)return"_other";const n=e.substring(0,t);return n in B?n:"_other"}function F(e,t){var n;const o=E(t),i=null===(n=(0,m.pz)(t))||void 0===n?void 0:n.table,r=e[o];if(r){if(i){const e=r[i];if(!e)return void Qe(`Warning: "${o}.${i}" has no existing counters!`);r[i]=e-1}r._total-=1,e._total-=1}else Qe(`Warning: "${o}" has no existing counters!`)}function Z(e){return{_id:e,charactersSent:0,requestsSent:0,requestsTimedOut:0,responsesReceivedWithoutHandlers:0,successfulResponsesReceived:0,unsuccessfulResponsesReceived:0,invalidMessagesReceived:0,notificationsReceived:0,messagesReceived:0}}function L(){return{...ie}}function j(e){const t=ie;if(e._id===t._id)return{charactersSent:t.charactersSent-e.charactersSent,requestsSent:t.requestsSent-e.requestsSent,requestsTimedOut:t.requestsTimedOut-e.requestsTimedOut,responsesReceivedWithoutHandlers:t.responsesReceivedWithoutHandlers-e.responsesReceivedWithoutHandlers,successfulResponsesReceived:t.successfulResponsesReceived-e.successfulResponsesReceived,unsuccessfulResponsesReceived:t.unsuccessfulResponsesReceived-e.unsuccessfulResponsesReceived,invalidMessagesReceived:t.invalidMessagesReceived-e.invalidMessagesReceived,notificationsReceived:t.notificationsReceived-e.notificationsReceived,messagesReceived:t.messagesReceived-e.messagesReceived}}const V=new Map,U=new Map;class O extends Map{isCancelable(e){return Boolean(this.getCancelable(e))}getCancelable(e){const t=this.get(e);if(null!=t&&t.canCancel())return t}}const N=new O,z=new O,H=new Map,W=new Map,q=Date.now();let G={_total:0};const K="messageStoreInternals",$=new i.BatchedLogger({from:K,type:"BulkDebug",level:"info",maxLength:250,logToConsole:M});let Q,Y,J,X,ee=0,te=0,ne=0,oe=0,ie=Z(0),re=0,ae=s.O,se=!1,le="uninitialized";function ce(){return"open"===le}function de(){return"uninitialized"===le||"opening"===le}const ue=!0;function pe(e,t){let n=W.get(e);n||(n={},W.set(e,n)),Object.assign(n,t)}function me(e){$.log({level:"info",from:K,type:e})}function fe(){Y=function(e){var t;const n=null==e||null===(t=e.socket)||void 0===t||null===(t=t.transport)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.transport;if("websocket"===n||"polling"===n)return n}(this),me(`ping:${Y}`),Q=Date.now(),Qe(`Incoming primus ping received from server via ${Y}.`)}function ge(){return G}function he(){return{...je.getStats(),batchSubscribeQueue:Ue.getStats(),batchUnsubscribeQueue:Oe.getStats()}}function ve(e){const{lastOfflineTimestamp:t}=_.Z.getState(),n=he(),{batchSubscribeQueue:o,batchUnsubscribeQueue:i}=n;return{currentConnectionCounters:ie,timeSinceLastIncomingPing:Q&&e-Q,lastIncomingPingTransportType:Y,timeSinceLastResponseReceived:J&&e-J,timeSinceLastReadyStateChange:X&&e-X,timeSinceLastOffline:t&&e-t,largestMessageSize:re||void 0,messageStoreRequestsQueued:n.queue,messageStoreRequestsRunning:n.running,batchSubscribeQueue:o,batchUnsubscribeQueue:i,messageStoreConnectionState:le,uptime:e-q,subscriptionCounters:G,primusEndEventsReceived:te,primusErrorEventsReceived:ne,connectionResetsDueToFailedRequests:oe}}function be(e){switch($.log({level:"info",from:K,type:"readyStateChange",data:{message:e}}),X=Date.now(),e){case"end":le="closed";break;case"open":le="open";break;case"opening":le="opening"}}const ye=c.HP((e=>async function(e){if(w)return;if(Ke(e))return void i.log({level:"warning",from:K,type:"CreatePrimusClientCalledForNativeMessageStoreClient"});ee+=1;const{createClient:t}=await T(),n=t({minReconnectDelayMs:4*h.C0,maxReconnectDelayMs:8*h.C0});return n.on("data",qe),n.on("open",(()=>{me("open"),Se(e)})),n.on("reconnected",(e=>{Ie(),$.log({level:"info",from:K,type:"reconnected",data:{message:`Reconnected in ${null==e?void 0:e.duration} ms`}})})),n.on("reconnect",(()=>{me("reconnect")})),n.on("reconnect scheduled",(e=>{$.log({level:"info",from:K,type:"reconnect scheduled",data:{message:`Reconnecting in ${null==e?void 0:e.scheduled} ms, attempt ${null==e?void 0:e.attempt} of ${null==e?void 0:e.retries}`}})})),n.on("reconnect timeout",(()=>{me("reconnect timeout")})),n.on("reconnect failed",(()=>{me("reconnect failed")})),n.on("timeout",(()=>{me("timeout")})),n.on("destroy",(()=>{me("destroy")})),n.on("close",(()=>{me("close")})),n.on("online",(()=>{me("online")})),n.on("offline",(()=>{me("offline")})),n.on("error",(e=>{let t;t="TransportError"===e.type?{level:"info",from:K,type:"primusTransportError",error:(0,d.Ui)(e)}:{level:"error",from:K,type:"unknownPrimusError",error:(0,d.Ui)(e)};(0,u.lB)(1)&&i.rateLimitedLog(t),$.log(t),ne+=1})),n.on("incoming::ping",fe),n.on("readyStateChange",be),n.on("end",(()=>{me("end"),n.off("readyStateChange",be),te+=1,async function(e,t){var n,o;i.log({level:"info",from:K,type:"messageStoreEnd",error:{message:`SocketId: ${null==e||null===(n=e.socket)||void 0===n?void 0:n.id} Query:${null==e||null===(o=e.transport)||void 0===o?void 0:o.query}`}}),ke(),ae.setTimeout((()=>{void 0!==e&&e.destroy()}),0);const r=await ye(t);if(e!==r)return;ye.cache.clear(),ae.setTimeout((()=>{ye(t)}),2*h.C0)}(n,e)})),window.__primusClient=n,n}(e)),(function(){return"primus"}));function Se(e){ie=Z(ie._id+1),V.forEach(((t,n)=>{const o=U.get(n);Ae(n,o?o.version:-1,e).catch((e=>{i.log({level:"warning",from:K,type:"ReconnectSubscriptionError",error:(0,d.Ui)(e)})}))}))}let _e;function we(e){if(_e)throw new Error("Having more than one onRestartMessageStoreConnectionHandler is not currently supported");_e=e}function ke(){var e;se=!1,Ue.cancel(),Oe.cancel(),function(){for(const e of H.values())window.clearTimeout(e.timeout);H.clear()}(),N.clear(),z.clear(),Ne.cancel(),je.cancel(),W.clear(),G={_total:0},null===(e=_e)||void 0===e||e()}function Ie(){ke()}function Ce(e,t){if(!Ke(t))return;Qe("onMobileNativeUpdateMessageStoreState",e);const n=!("open"===le)&&"open"===e;n&&Ie(),be(e),n&&Se(t)}function xe(e,t){if(!Ke(t))return;const n=JSON.parse(e);Qe("onMobileNativeReceiveRawMessageStoreMessage",n),ce()||Ce("open",t),qe(n)}async function Te(e){var t;const{key:n,field:o,updates:i,ttl:r,environment:a}=e;await(null===(t=We({method:"updateField",request:{key:n,field:o,updates:i,ttl:r},environment:a}))||void 0===t?void 0:t.response)}async function Me(e){var t;const{key:n,field:o,value:i,ttl:r,environment:a}=e;await(null===(t=We({method:"setField",request:{key:n,field:o,value:i,ttl:r},environment:a}))||void 0===t?void 0:t.response)}async function Pe(e){if(w)return{type:"messageStoreDisabled"};const t=(0,f.ZP)(),{environment:n}=e,o=(0,m.JK)(t),i="diagnosticPing",r=a.UZ(),s=e.logToConsole??M,l={};function c(e,t){l[e]=t,s&&console.log(`diagnosticPing ${e}=${t}`)}const d=await a.aM(async function(){var e;const a=performance.now();await Fe(o,((e,t)=>{t&&r.resolve(performance.now())}),i,n);const s=performance.now(),d=s-a;c("registerSubscriptionResponseMs",d);const u=await(null===(e=We({method:"diagnosticPing",request:{id:t},environment:n,onRequestSent:()=>{c("diagnosticPingEnqueuedMs",performance.now()-s)}}))||void 0===e?void 0:e.response);if(!u)return{type:"canceled",key:o,...l};const p=function(e){const t=l[e];if(void 0===t)throw new Error(`Assertion failure, expected timing for "${e}" to be defined`);return t}("diagnosticPingEnqueuedMs"),m=u.setValueTime;c("diagnosticPingServerSideSetValueMs",m);const f=performance.now()-s;c("diagnosticPingResponseMs",f);const g=await r.promise-s;c("diagnosticPingNotificationMs",g);const h=performance.now();await Le(o,i,n);const v=performance.now();return{type:"success",key:o,registerSubscriptionResponseMs:d,diagnosticPingEnqueuedMs:p,diagnosticPingServerSideSetValueMs:m,diagnosticPingResponseMs:f,diagnosticPingNotificationMs:g,unregisterSubscriptionResponseMs:v-h,totalMs:v-a}}().catch((e=>(g.rn(e,{from:K,type:"diagnosticPingError",data:{key:o}}),{type:"error",key:o,...l}))),R);return d.timeout?{type:"timeout",key:o,...l}:d.result}async function Ae(e,t,n){ue&&pe(e,{latestRegisterSubscriptionRequestTimestamp:Date.now()}),function(e,t){var n;const o=E(t),i=null===(n=(0,m.pz)(t))||void 0===n?void 0:n.table;let r=e[o];if(r||(r={_total:0},e[o]=r),i){const e=r[i]||0;r[i]=e+1}r._total+=1,e._total+=1}(G,e);const o=z.getCancelable(e);if(o)o.cancel(new Error("Cancelled by sendRegisterSubscription()"));else{const o={key:e,version:t},i=Ue.enqueueCancelable({request:o,environment:n});if(i){N.set(e,i.asyncQueuePromise);try{await i.response}finally{N.delete(e)}}}ue&&pe(e,{latestRegisterSubscriptionResponseTimestamp:Date.now()})}function Re(e){return N.isCancelable(e)}function De(e,t){const n=N.getCancelable(e);if(!n)throw new Error(`Assertion failure, subscription request for key ${e} does not exist or is not cancelable`);Ze(e,t)&&(F(G,e),n.cancel(new Error("Cancelled by cancelRegisterSubscription()")),ue&&W.delete(e))}async function Be(e,t,n){var o;await(null===(o=We({method:"registerOnDisconnect",request:{disconnectId:e,operations:t},environment:n}))||void 0===o?void 0:o.response)}async function Ee(e,t){var n;await(null===(n=We({method:"unregisterOnDisconnect",request:{disconnectId:e},environment:t}))||void 0===n?void 0:n.response)}async function Fe(e,t,n,o){if(w)return;let i=V.get(e);if(!i||0===i.length)return i=[{listener:t,listenerId:n}],V.set(e,i),void(ce()?await Ae(e,-1,o):"uninitialized"!==le||Ke(o)||await ye(o));if(i.find((e=>e.listenerId===n)))i=[...i.filter((e=>e.listenerId!==n)),{listener:t,listenerId:n}],V.set(e,i);else{i=[...i,{listener:t,listenerId:n}],V.set(e,i);const o=U.get(e);o&&t(e,o.value,o.passThroughData)}}function Ze(e,t){if(w)return!1;const n=V.get(e);if(!n)return!1;const o=n.filter((e=>e.listenerId!==t));return o.length!==n.length&&(0===o.length?(V.delete(e),U.delete(e),!0):(V.set(e,o),!1))}async function Le(e,t,n){Ze(e,t)&&ce()&&await async function(e,t){ue&&pe(e,{latestUnregisterSubscriptionRequestTimestamp:Date.now()}),F(G,e);const n=N.getCancelable(e);if(n)n.cancel(new Error("Cancelled by sendUnregisterSubscription()"));else{const n={key:e},o=Oe.enqueueCancelable({request:n,environment:t});if(o){z.set(e,o.asyncQueuePromise);try{await o.response}finally{z.delete(e)}}}ue&&W.delete(e)}(e,n)}const je=new o.z(20);class Ve{constructor(e,t){this.queue=void 0,this.wrappedPerformRequests=async e=>{const t=e[0].environment;Qe(`Sending a batch of ${e.length} ${this.methodName} requests.`);const n=this.performRequests(t,e.map((e=>e.request)));if(!n)throw new Error("MessageStore is disabled.");const o=await n;if(!o)throw new Error("Request cancelled.");return o},this.methodName=e,this.performRequests=t,this.queue=new l({performRequests:this.wrappedPerformRequests,batchSize:250,maxDelayMs:A,maxWorkers:1})}updateTimeSource(e){this.queue.updateTimeSource(e)}getStats(){return this.queue.getStats()}cancel(){this.queue.cancel()}enqueueCancelable(e){if(w)return;const t=this.queue.enqueue(e),n=t.catch((e=>{Qe(`enqueueCancelable() for ${this.methodName} cancelled (${e.message})`)}));return{asyncQueuePromise:t,response:n}}}const Ue=new Ve("registerSubscription",((e,t)=>Ne.enqueue((async()=>{var n;const o=We({method:"registerBatchSubscriptions",request:{subscriptions:t},environment:e});return null===(n=await(null==o?void 0:o.response))||void 0===n?void 0:n.responses})))),Oe=new Ve("unregisterSubscription",((e,t)=>Ne.enqueue((async()=>{var n;const o=We({method:"unregisterBatchSubscriptions",request:{keys:t.map((e=>e.key))},environment:e});return null===(n=await(null==o?void 0:o.response))||void 0===n?void 0:n.keys.map((e=>({key:e})))})))),Ne=new o.z(1);let ze;function He(){if(!ze)return;const{totalRequests:e,requestCounts:t,startTime:n}=ze;Qe("checkRequestThroughputForBurstWarning requestCounts =",t),e>3e3&&i.log({level:"warning",from:K,type:"BurstThroughputExceeded",data:{time:Date.now()-n,totalRequests:e,requestCounts:t}}),ze=void 0}function We(e){if(w)return;const{method:t,request:n,environment:o}=e,i=y.default.mark("message_store.client.send_request.in_queue_time");x(o,{status:"enqueued",endpoint:t}),ue&&function(e){ze||(ze={startTime:Date.now(),totalRequests:0,requestCounts:{}},ae.setTimeout(He,D)),ze.totalRequests+=1,ze.requestCounts[e]=(ze.requestCounts[e]||0)+1}(t);const r=je.enqueue((()=>{var r;const s=(0,f.ZP)();!function(e,t){k.default.afterNextFlush((()=>{C.default.checkGate("message_store_client_send_request_metric_enabled")&&(I.j(e,"message_store.client.send_request.queue_running_size",{value:t.running}),I.j(e,"message_store.client.send_request.queue_backup_size",{value:t.queue}))}))}(o,je.getStats());const l=y.default.mark("message_store.client.send_request.round_trip_time");y.default.measure(i,{environment:o,data:{endpoint:t}});const c=a.UZ(),d=Date.now(),u=ue?window.setTimeout((()=>{"open"===le&&(ie.requestsTimedOut+=1,$.log({level:"info",from:K,type:"requestTimeout",data:{requestId:s,time:Date.now()-d}}))}),P):void 0;H.set(s,{resolve:c.resolve,reject:c.reject,timeout:u,sendTime:d}),$.log({level:"info",from:K,type:"requestSent",data:{requestId:s,method:t}});const p={type:`${b.default.messageStore.api}/${t}`,requestId:s,...n};return ie.requestsSent+=1,async function(e){const{message:t,environment:n}=e,o=Ge(n),i=JSON.stringify(t);ie.charactersSent+=i.length,re<i.length&&(re=i.length);if(o)o(i);else{const e=await ye(n);null==e||e.write(t)}}({message:p,environment:o}),null===(r=e.onRequestSent)||void 0===r||r.call(e),c.promise.then((e=>{y.default.measure(l,{environment:o,data:{endpoint:t}}),x(o,{status:"success",endpoint:t})})).catch((e=>{const n=je.getStats();x(o,{status:"failure",endpoint:t,queue_running_size:n.running,queue_backup_size:n.queue})})),c.promise}));return{response:r.catch((e=>{e instanceof $e&&!Ke(o)&&!se?(se=!0,oe+=1,me("connectionResetDueToFailedRequest"),ye(o).then((e=>{null==e||e.end()})),Qe(`sendRequest() for ${t} returned server error (${e.message}), resetting connection`,n)):Qe(`sendRequest() cancelled or errored for ${t} (${e.message})`,n)})),asyncQueuePromise:r}}function qe(e){ie.messagesReceived+=1;const t=(0,v.Gu)(p.yx,e);if(t)return ie.invalidMessagesReceived+=1,void i.rateLimitedLog({level:"warning",from:K,type:"ValidationError",data:{miscDataToConvertToString:e},error:(0,d.Ui)(t)});const n=e;if("response"===n.type){var o;const{requestId:e,status:t,result:i}=n,r=H.get(e);if(H.delete(e),$.log({level:"info",from:K,type:"responseReceived",data:{requestId:e,response:t,time:r&&Date.now()-r.sendTime,internalProcessingTimeMs:null===(o=n.result)||void 0===o?void 0:o.internalProcessingTimeMs}}),!r)return void(ie.responsesReceivedWithoutHandlers+=1);J=Date.now(),window.clearTimeout(r.timeout),"ok"===t?(ie.successfulResponsesReceived+=1,r.resolve(i)):(ie.unsuccessfulResponsesReceived+=1,r.reject(new $e(i)))}else{ie.notificationsReceived+=1;const{key:e,value:t,version:o,passThroughData:a}=n,s=V.get(e);if(!s)return;U.set(e,{version:o,value:t,passThroughData:a});for(const{listener:n}of s)try{n(e,t,a)}catch(r){i.log({level:"warning",from:K,type:"ListenerError",error:(0,d.Ui)(r)})}}}function Ge(e){var t;if((0,S.Y)("supportsNativeMessageStore"))return e&&(null===(t=e.mobileNative)||void 0===t?void 0:t.api.sendRawMessageStoreMessage)}function Ke(e){return Boolean(Ge(e))}class $e extends Error{constructor(e){super(e),this.name="FailedMessageStoreRequestError"}}function Qe(){}},2688:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(41641),i=n(88536);const r=new class{constructor(){this.subscriptionCount=0}addListener(e,t,n,r){if((0,o.Z)(e))return this.subscriptionCount+=1,n||(n=`subscription:${this.subscriptionCount}`),i.Ld(e,t,n,r),{key:e,subscriptionId:n}}removeListener(e,t){let{key:n,subscriptionId:r}=e;(0,o.Z)(n)&&i.r1(n,r,t)}async updateField(e,t,n,o,r){await i.L4({key:e,field:t,updates:n,ttl:o,environment:r})}async setField(e,t,n,o,r){await i.Ji({key:e,field:t,value:n,ttl:o,environment:r})}async onDisconnect(e,t,n,o){const r=`${n}/${e}`;await i.eg(r,t,o)}async clearOnDisconnect(e,t,n){const o=`${t}/${e}`;await i.hd(o,n)}}},84709:(e,t,n)=>{n.r(t),n.d(t,{subscribe:()=>w,unsubscribe:()=>T,unsubscribeAfterDelay:()=>A,unsubscribeForAllUsers:()=>C});n(21703);var o=n(1302),i=n(92595),r=n(68626),a=n(44615),s=n(63143),l=n(41641),c=n(4408),d=(n(95477),n(89087)),u=(n(57658),n(77897),n(29477),n(4615),n(50906),n(54642),n(79420)),p=n(88536);const m=60*s.C0,f=15*s.C0;s.C0;class g{constructor(e){this.map=new Map,this.timeoutMs=e}set(e){const{key:t,onTimeout:n,onClear:o,value:i}=e;this.clear(t);const r=window.setTimeout((()=>{this.map.delete(t),null==n||n()}),this.timeoutMs);this.map.set(t,{timeout:r,value:i,onClear:o})}get(e){var t;return null===(t=this.map.get(e))||void 0===t?void 0:t.value}clear(e){const t=this.map.get(e);var n;void 0!==t&&(window.clearTimeout(t.timeout),this.map.delete(e),null===(n=t.onClear)||void 0===n||n.call(t))}has(e){return this.map.has(e)}}const h=new g(m),v=new g(f);var b=n(75233),y=n(2688);const S="recordSubscriptionActions";function _(e,t,n){const o=a.pz(t);if(!o)return void r.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{version:n}}});if(null!==n&&"number"!=typeof n)return void r.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{pointer:o,version:n}}});const i=[void 0,...e.currentUser.loggedInUserIds];p.id&&((0,p.g4)(t,{latestUpdateTimestamp:Date.now()}),function(e){const t=h.get(e);t&&(t.latestUpdate=Date.now()),v.clear(e)}(t));for(const r of i){if(u.Z.getSubscriptionForRecord({userId:r,pointer:o})){const t=e.defaultRecordCache.inMemoryRecordCache.getVersion({pointer:o,userId:r}),i=d.transactionQueue.isPendingTransactionForRecord(o);(null===n||n>t)&&!i&&c.bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:o,userId:r})}}}function w(e){const{pointer:t,userId:n,environment:i}=e,r={pointer:t,userId:n};k(t)||(u.Z.removeFromPendingUnsubscribeRecords(r),b.Z.removeFromPendingEvictions(r),u.Z.isSubscribedToRecord(r)||(u.Z.addToSubscribedRecords(r),o.default.afterNextFlush((()=>{const o=i.defaultRecordCache.inMemoryRecordCache.getRecord(r);o?I({record:o,...e}):c.bG({environment:i,inMemoryRecordCache:i.defaultRecordCache.inMemoryRecordCache,userId:n,pointer:t}).then((t=>{I({record:t,...e})}))}))))}function k(e){return!e.id||!e.table||("emptyDroppableKey"===e.id||"placeholder"===e.id)}function I(e){const{environment:t,pointer:n,userId:o,record:i}=e,s={pointer:n,userId:o};if(!u.Z.isSubscribedToRecord(s))return;const c=a.ZS(n);(0,l.Z)(c)&&(n.id&&n.table?y.Z.addListener(c,((e,n)=>_(t,e,n)),S,t):r.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:subscribe",type:"KeyValidationError",data:{pointer:n,miscDataToConvertToString:{record:i,key:s,versionsKey:c}}}))}function C(e){for(const t of e.environment.currentUser.loggedInUserIds)T({...e,userId:t})}function x(e){const{pointer:t}=e;if(k(t))return!1;if(!u.Z.isSubscribedToRecord(e))return!1;u.Z.removeFromSubscribedRecords(e);const n=a.ZS(t);return!!(0,l.Z)(n)&&(!(!t.id||!t.table)||(r.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:unsubscribe",type:"KeyValidationError",data:{pointer:t,miscDataToConvertToString:{versionsKey:n}}}),!1))}function T(e){const{environment:t}=e;x(e)&&y.Z.removeListener({key:a.ZS(e.pointer),subscriptionId:S},t)}const M=2*s.hM,P=M;function A(e){const{pointer:t,environment:n,userId:o}=e;if(k(t))return;if(n.defaultRecordCache.inMemoryRecordCache.hasListener(t))return;const i=a.ZS(t);if((0,p.Ap)(i)){const e={pointer:t,userId:o};return b.Z.addToPendingEvictions(e,Date.now()+P),void(x(e)&&(0,p.vj)(i,S))}u.Z.addToPendingUnsubscribeRecords(e,Date.now()+M)}function R(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];u.Z.forEachPendingUnsubscribeRecord((n=>{let{pointer:o,userId:i,timestamp:r,environment:a}=n;if(r<e){u.Z.removeFromPendingUnsubscribeRecords({pointer:o,userId:i});const e={pointer:o,userId:i};t&&console.log("Unsubscribing and evicting",JSON.stringify(o)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e),T({pointer:o,userId:i,environment:a})}})),b.Z.forEachPendingEviction((n=>{let{pointer:o,userId:i,timestamp:r,environment:a}=n;if(r<e){b.Z.removeFromPendingEvictions({pointer:o,userId:i});const e={pointer:o,userId:i};t&&console.log("Evicting",JSON.stringify(o)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e)}}))}setInterval((()=>{R(Date.now())}),1e4),(0,i.exposeDebugValue)("forceUnsubscribeAndEvictPendingRecords",(()=>{R(1/0,!0)})),setTimeout((()=>{(0,p.Tg)((()=>{u.Z.forEachPendingUnsubscribeRecord((e=>{let{pointer:t,userId:n,timestamp:o,environment:i}=e;u.Z.removeFromPendingUnsubscribeRecords({pointer:t,userId:n});const r={pointer:t,userId:n};b.Z.addToPendingEvictions(r,o),T({pointer:t,userId:n,environment:i})}))}))}),0)},91948:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(86628),i=n(85248),r=n(17294),a=n(85893);function s(e){let{targetRecordId:t,style:n}=e;window.__c={n:"MoveOrDuplicateProgress"};const s=(0,o.VK)((()=>r.Z.state[t]),[t]);if(!s)return null;const{taskStatus:l,completeBlocks:c,totalBlocks:d}=s,u=(()=>{switch(l){case"not_started":case"failure":return;case"success":return 100;case"in_progress":if("number"!=typeof c||"number"!=typeof d)return;if(0===d)return;const e=c/d;return 1===e?99:Math.round(100*e)}})();return"number"!=typeof u?null:(0,a.jsx)(i.k,{percentage:u,style:n})}},98110:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),i=n(480),r=n(86628),a=n(15145),s=n(5366),l=n(75018),c=n(6854),d=n(73744),u=n(35683),p=n(85893);function m(e){window.__c={n:"MoveToSnackbarButtons"};const t=(0,i.O7)(),n=(0,r.VK)((()=>!t.device.isPhone),[t]);return(0,p.jsxs)(p.Fragment,{children:[n&&(0,p.jsx)(f,{...e}),(0,p.jsx)(c.ow,{onUndo:void 0})]})}function f(e){let{moveToLocation:t,movedItems:n}=e;window.__c={n:"MoveToVisitButton"};const r=(0,i.O7)(),m=(0,o.useCallback)((e=>{var o;if(t)switch(t.type){case"moveToBlock":l.navigateToBlock({environment:r,openInNew:d.DJ(e),store:t.blockStore,scrollToBlockId:null===(o=n[0])||void 0===o?void 0:o.id,visitType:u.vu.Link,pageVisitSource:a.tY.Move})}}),[r,t,n]);return t&&"moveToBlock"===t.type?(0,p.jsx)(c.Pn,{onClick:m,children:(0,p.jsx)(s.FormattedMessage,{defaultMessage:"Visit",id:"moveToHelpers.afterMoveToast.viewButton"})}):null}},55081:(e,t,n)=>{n.d(t,{EV:()=>O,Ex:()=>L,I1:()=>V,Mf:()=>j,Qt:()=>z,VW:()=>N,lp:()=>U,xN:()=>Z,yH:()=>F,zJ:()=>B});n(67294);var o=n(79946),i=n(7406),r=n(68626),a=n(59730),s=n(15157),l=n(89101),c=n(15047),d=n(77858),u=n(19889),p=n(5366),m=n(50906),f=n(47307),g=n(94273),h=n(92625),v=n(97977),b=n(9953),y=n(75018),S=n(70782),_=n(64369),w=n(33954),k=n(24608),I=n(33929),C=n(38755),x=n(77907),T=n(74948),M=n(80444),P=n(35661),A=n(10929),R=n(75538),D=n(85893);async function B(e,t){if(!e.currentUser.id)return!1;const n=E(e);return!!A.BB(n)||(t||(t=new P.U6(e,{table:u.KJ,id:e.currentUser.id}),await t.awaitNonNullValue()),!t.getOnboardingCompleted())}function E(e){return{...s.Z.get({userId:e.currentUser.id,key:R.onboardingPreferenceKey}),currentUserId:e.currentUser.id}}async function F(e,t){const{state:n}=R.default;if(n.isLoading||n.isOnboarding||!e.currentUser.id)return;const o=E(e);if(!o.isOnboarding)return;if(A.NT(o)&&t&&(null==t?void 0:t.id)!==o.spaceViewId)return;const{flow:i}=o,r="desktop_join_or_create_space"===i||"mobile_join_or_create_space"===i,a=await A.dD({environment:e,disableRedirects:r});a&&(o.onboardingData=a),R.default.setState(o);const{spaceId:s}=o;if(s&&M.default.setState({...M.default.state,currentSpaceStore:new P.H2(e,{table:c.bx,id:s})}),o.isOnboarding&&"spaceViewId"in o&&o.spaceViewId){const t=new P.V9(e,{table:d.zU,id:o.spaceViewId});M.default.setState({...M.default.state,currentSpaceViewStore:t})}H(e,o)}async function Z(e){await V(e,{type:"create-or-join"})}const L=function(e){const{userStore:t,transaction:n}=e;b.sW({store:t,data:{onboarding_completed:!0},transaction:n})},j=function(e){const{userStore:t,transaction:n}=e;b.sW({store:t,data:{mobile_onboarding_completed:!0},transaction:n})};async function V(e,t){try{y.navigate({environment:e,url:l._j.onboarding});const n=await A.dD({environment:e,disableRedirects:Boolean(t.disableRedirectUrl)||"create-or-join"===t.type}),i=A.Pn(n),r=await x.deps.onboardingStateActions.loader(),a=await r.getInitialState(e,t,n,i);if(a&&a.isOnboarding){"invalid"===i.type&&(a.stage="error"),R.default.setState(a);const t=A.jn(a);m.NGq(e,t),m.y6P(e,t),H(e,a),a.isNewUser&&(o.I$(),o.j(e.device,{facebook:{eventName:"CompleteRegistration"},google:{eventName:"registration"}}))}}catch(n){const t=(0,i.tg)(n);!function(e,t,n){R.default.setState({...R.default.state,isLoading:!1}),m.GkL(e,{...A.jn(R.default.state),errorMessage:t.message}),r.log({level:"error",from:"onboardingActions",type:"handleError",error:{message:`Found onboarding error: ${t.message}`}});const o=n?async()=>await v.actuallyLogoutAndDeleteAllLocalData({environment:e}):void 0;f.showMessage({message:t.message,onAccept:o})}(e,t,"WorkspaceCreationError"===t.name&&(0,a.Zw)(t)&&t.data.newUser)}}async function U(e,t){if(t.isOnboarding)try{const n=await x.deps.onboardingStateActions.loader(),o=await n.updateAndGetNextState(t,e);m.y6P(e,A.jn(o)),R.default.setState(o),o.isOnboarding&&H(e,o)}catch(n){O(e,(0,i.tg)(n))}}async function O(e,t){if(R.default.setState({...R.default.state,isLoading:!1}),r.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Found onboarding error: ${t.message}`,stack:String(t.stack)}}),h.x(),t instanceof k.Gg&&(0,a.Rp)(t.data.responseBody)&&"UnauthorizedError"===t.data.responseBody.name)return void m.hov(e,{...A.jn(R.default.state),errorMessage:t.message,debugMessage:"UnauthorizedError"});let n;if(t instanceof k.Gg){var o;const e=null==t||null===(o=t.data)||void 0===o||null===(o=o.responseBody)||void 0===o?void 0:o.clientData;e&&(n=(0,w.XN)(I.default.getIntl(),e))}m.hov(e,{...A.jn(R.default.state),errorMessage:t.message,debugMessage:n||"undefined"});await f.confirmUserAction({message:(0,D.jsxs)("div",{children:[(0,D.jsx)(_.Z,{style:{fontSize:17,fontWeight:500,lineHeight:"24px",paddingBottom:8},children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Oops, something went wrong.",id:"onboardingActions.onboardingErrorDialog.message"})}),(0,D.jsx)("div",{children:n??t.message})]}),acceptLabel:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Start over",id:"onboardingActions.onboardingErrorDialog.startOverButton.label"}),cancelLabel:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Close",id:"onboardingActions.onboardingErrorDialog.closeButton.label"})})&&function(e,t){const n=R.default.state;A.n0(n)?V(e,{type:"new-user",disableRedirectUrl:!0}):A.y7(n)?V(e,{type:"create-or-join",disableRedirectUrl:!0}):e.device.isMobile?V(e,{type:"mobile-onboarding",disableRedirectUrl:!0}):r.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Could not redirect onboarding: ${t.message}`,stack:String(t.stack)}})}(e,t)}async function N(e){const{state:t}=R.default;if(A.n0(t)){if(!(await f.confirmUserAction({message:(0,D.jsxs)("div",{style:{display:"block"},children:[(0,D.jsx)("div",{style:{fontWeight:600},children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Cancel new account setup?",id:"onboardingActions.closeOnboardingDialog.newUser.title"})}),(0,D.jsx)("div",{children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"You'll be taken back to the Notion home page.",id:"onboardingActions.closeOnboardingDialog.newUser.subtitle"})})]}),acceptLabel:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Return to home page",id:"onboardingActions.closeOnboardingDialog.newUser.confirmCloseButton.label"}),cancelLabel:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.newUser.continueButton.label"})})))return;m.BLZ(e,A.jn(t)),await v.actuallyLogoutAndDeleteAllLocalData({environment:e})}else{if(!(await f.confirmUserAction({message:(0,D.jsxs)("div",{style:{display:"block"},children:[(0,D.jsxs)("div",{style:{fontWeight:600},children:[" ",(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Cancel new workspace setup?",id:"onboardingActions.closeOnboardingDialog.existingUser.title"})]}),(0,D.jsx)("div",{style:{wordBreak:"keep-all"},children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"You'll be taken back to your previous workspace.",id:"onboardingActions.closeOnboardingDialog.existingUser.subtitle"})})]}),acceptLabel:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Back to previous workspace",id:"onboardingActions.closeOnboardingDialog.existingUser.confirmCloseButton.label"}),cancelLabel:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.existingUser.continueButton.label"})})))return;m.BLZ(e,A.jn(t));const{mainEditorCurrentBlockStore:o}=M.default.state,i=null==o?void 0:o.getSpaceId(),r=i&&(0,C.w3)(i);if(r){const e=r.getSpaceStore();M.default.setState({...M.default.state,currentSpaceStore:e,currentSpaceViewStore:r})}const{url:a,userId:s}=g.Vr(e);let l=e;if(s&&s!==e.currentUser.id&&(l=await S.x({environment:e,newCurrentUserId:s})),a){var n;T.close();const e=()=>{const e={isOnboarding:!1,isLoading:!1,currentUserId:s};R.default.setState(e)};y.navigate({environment:l,url:a}),null!==(n=l.mobileNative)&&void 0!==n&&n.supportsNativeHomeOnPhone()?y.navigateToHomeTab(l,e):e()}}}function z(e){const{state:t}=R.default;m.J7i(e,A.jn(t)),R.default.setState({isOnboarding:!1,isLoading:!1,currentUserId:e.currentUser.id})}function H(e,t){if(!t.isOnboarding)return;if(t.isOnboarding){const n=[...t.historicalStages||[],{stageName:t.stage,stageNumber:t.stageNumber,timestamp:Date.now()}];R.default.setState({...t,historicalStages:n.length>20?[{stageName:"truncated",stageNumber:-1,timestamp:Date.now()}]:n}),m.o7O(e,"onboarding_stage",{...A.jn(t),historical_stages:n})}}},87480:(e,t,n)=>{n.d(t,{DP:()=>r,bz:()=>i,eN:()=>a});var o=n(15157);const i="onboarding";function r(e){let{currentUserId:t,data:n}=e;o.Z.set({userId:t,key:i,value:JSON.stringify(n)})}function a(e){try{const t=o.Z.get({userId:e,key:i});return o.Z.remove({userId:e,key:i}),JSON.parse(t)}catch(t){return}}},10929:(e,t,n)=>{n.d(t,{$U:()=>Y,At:()=>$,BB:()=>Z,Bu:()=>j,Fz:()=>de,NT:()=>L,Pn:()=>q,SN:()=>Q,Vb:()=>ce,WX:()=>J,Wf:()=>K,YH:()=>ie,_J:()=>G,bM:()=>le,bN:()=>X,bm:()=>se,dD:()=>U,eW:()=>F,ey:()=>z,fz:()=>B,iF:()=>O,jF:()=>N,jn:()=>W,lr:()=>V,n0:()=>D,og:()=>ne,pd:()=>re,rT:()=>te,tq:()=>oe,tr:()=>A,uO:()=>ae,vA:()=>ee,y7:()=>R});var o=n(8848),i=n(80994),r=n(33728),a=n(68626),s=n(72126),l=n(15047),c=n(60949),d=n(97880),u=n(82990),p=n(5366),m=n(50906),f=n(54642),g=n(97977),h=n(76464),v=n(9953),b=n(29974),y=n(97627),S=n(39699),_=n(37181),w=n(24215),k=n(4708),I=n(33929),C=n(38755),x=n(80444),T=n(77080),M=n(35661),P=n(75538);function A(e,t){return`/tutorial/${e}${"dark"===t.state.mode?"-dark":""}.png`}function R(e){return e.isOnboarding&&("desktop_join_or_create_space"===e.flow||"mobile_join_or_create_space"===e.flow)}function D(e){return e.isOnboarding&&("desktop_cold_start"===e.flow||"mobile_cold_start"===e.flow||"desktop_joinable_spaces"===e.flow||"mobile_joinable_spaces"===e.flow||"desktop_redirect"===e.flow||"mobile_redirect"===e.flow)}function B(e){const{state:t}=e;return D(t)}const E=(0,p.defineMessages)({personalWorkspaceName:{defaultMessage:"{userName}'s Notion",id:"onboardingHelpers.personalWorkspaceName"}});function F(e,t){return t.formatMessage(E.personalWorkspaceName,{userName:e.trim()})}function Z(e){return e.isOnboarding&&Boolean(P.InAppOnboardingStages.find((t=>t===e.stage)))}function L(e){return e.isOnboarding&&(Boolean(P.InAppOnboardingStages.find((t=>t===e.stage)))||"invite"===e.stage)}function j(e){return e.isOnboarding&&"template_optout"===e.stage}function V(e){const t=e.userStore.getEmail();if(t&&e.isUserDomainJoinable)return(0,r.Gd)(t)}async function U(e){P.default.setState({...P.default.state,isLoading:!0});const{disableRedirects:t,environment:n}=e;a.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"initializeOnboardingDataLoad"}});const[o,r,s,l,c,u,p]=await Promise.all([f.getJoinableSpaces(n,{}),(0,C.iX)({environment:n,disableRedirectUrl:t}),f.isUserDomainJoinable(n,{}),f.isEmailEducation(n,{}),f.validateUserCanCreateWorkspace(n,{}),f.getVerifiedEmailDomain(n,{}),f.getGeoIpLocation(n,{})]);a.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"completedOnboardingDataLoad",miscDataToConvertToString:{joinableSpacesResponseType:o.type,joinableSpacesResponseStatus:o.status,userRedirectDataId:r.userRootStore.id,isUserDomainJoinableResponseType:s.type,isUserDomainJoinableResponseStatus:s.status,validateUserCanCreateWorkspaceStatus:c.status}}}),P.default.setState({...P.default.state,isLoading:!1});const m={isUserDomainJoinable:"success"===s.type&&s.data.isJoinable,isEducationPlanEligible:"success"===l.type&&l.data.isEligible,canUserCreateSpace:"success"!==c.type||c.data.canUserCreateSpace,isUserUsingVerifiedDomain:"success"===u.type&&(0,d.$K)(u.data.id),...r,countryCode:"success"===p.type&&(0,i.GC)(p.data.countryCodeFromIp)?p.data.countryCodeFromIp:void 0};return"success"===o.type?{joinableSpaceData:o.data,...m}:{joinableSpaceData:{results:[]},...m}}async function O(e){const t=await f.getGeoIpLocation(e,{});return"success"===t.type&&(0,i.GC)(t.data.countryCodeFromIp)?t.data.countryCodeFromIp:void 0}function N(e){if(R(e)){const{userRootStore:t}=e.onboardingData;if("timed_trial_upsell"===e.stage)return!1;const n=t.getSpaceViewPointers();if(n)return n.length>0}return!1}function z(e){const{onboardingData:t,isNewUserFlow:n}=e,{userRootStore:o}=t,{results:i}=t.joinableSpaceData,r=o.getSpaceViewStores().map((e=>e.getSpaceId()));return n?i:i.filter((e=>r.indexOf(e.id)<0))}function H(e){return e.isOnboarding&&"profile"!==e.stage&&"error"!==e.stage}function W(e){var t,n,o,i,r;const{currentUserSettingsStore:a,currentSpaceStore:s}=x.default.state;return{flow_name:e.isOnboarding?e.flow:"not_defined",flow_id:e.isOnboarding?e.flowId:void 0,stage:e.isOnboarding?e.stage:"not_defined",initial_workspace_type:H(e)?e.spaceJoinOrCreate:void 0,is_new_onboarding:te(e),is_create_or_join:R(e),stage_number:e.isOnboarding?e.stageNumber:void 0,num_of_joinable_spaces:e.isOnboarding&&"workspace_choose"===e.stage?(null===(t=e.joinableSpaces)||void 0===t?void 0:t.length)||0:void 0,historical_stages:e.isOnboarding?e.historicalStages:void 0,selectedPresets:e.isOnboarding&&"workspace_setup"===e.stage?e.selectedPresets:void 0,user_persona:null==a||null===(n=a.getSettings())||void 0===n?void 0:n.persona,user_team_role:null==a||null===(o=a.getSettings())||void 0===o?void 0:o.team_role,user_use_cases:null==a||null===(i=a.getSettings())||void 0===i?void 0:i.use_cases,user_company_size:null==a||null===(r=a.getSettings())||void 0===r?void 0:r.company_size,plan_type:null==s?void 0:s.getPlanType(),plan_selection:"planSelection"in e?e.planSelection:void 0}}function q(e){const{redirectSpaceId:t,redirectPageId:n,forkPageBlockId:o,hasExplicitAccessToRedirectPage:i,canJoinRedirectSpace:r,publicAccessPageId:a,oauthAuthorizationParams:s}=e;return s?{type:"oauth_authorization_redirect",...s}:o?{type:"fork_page",pageId:o}:!a||i||r?!t||i||r?t&&n&&i&&!r?{type:"guest_redirect",pageId:n,spaceId:t}:t&&n&&r?{type:"redirect_page",pageId:n,spaceId:t}:t&&r?{type:"redirect_space",spaceId:t}:{type:"getting_started_page"}:{type:"invalid"}:{type:"public_access_page_redirect",pageId:a}}async function G(e,t){const{onboardingData:n,name:o,profilePhoto:i,password:r,emailOptIn:a}=e,s=n.userStore;w.Zf(t,{email_optin_product_tips_and_news:a,email_optin_resources_and_events:a,email_optin_notion_for_startups:a}),S.createAndCommit({userAction:"onboardingHelpers.setProfileData",environment:t,perform:e=>{const t={...i&&{profile_photo:i}};t.name=o,v.sW({store:s,data:t,transaction:e})}});const l=await g.shouldCreatePassword(t)&&!ee();r&&l&&await f.setPassword(t,{newPassword:r,sendEmail:!1})}function K(e,t){const{userPersona:n,onboardingData:o,userTeamRole:i}=t;S.createAndCommit({userAction:"onboardingHelpers.setUserPersona",environment:e,perform:e=>{const t={persona:n,team_role:i};_.d2({userSettingsStore:o.userSettingsStore,data:t,transaction:e})}})}function $(e){if(!T.default.checkGate("survey_data_writes"))return;const{environment:t,state:n,spaceStore:o,spaceViewStore:i}=e,r=(new Date).getTime();if(i){var a,s;const e=c.Dh({maybeFunction:n.userPersona,guessedFunctionVersion:"on"===(null===(a=n.onboardingExperiments)||void 0===a?void 0:a.onboarding_creator_no_joinable_spaces_v2)?4.1:4,maybeRole:n.userRole,guessedRoleVersion:"on"===(null===(s=n.onboardingExperiments)||void 0===s?void 0:s.onboarding_creator_no_joinable_spaces_v2)?3:2,collectedFrom:"onboarding",collectedAt:r});void 0!==e&&y.Q1(t,e,i)}if(o){var l;const e=c.K0({maybeIntent:n.planSelection,guessedIntentVersion:"on"===(null===(l=n.onboardingExperiments)||void 0===l?void 0:l.onboarding_creator_no_joinable_spaces_v2)?2:1,maybeCompanySize:n.companySize,guessedCompanySizeVersion:2,maybeUseCases:n.useCases,guessedUseCasesVersion:3,collectedFrom:"onboarding",collectedAt:r});void 0!==e&&b.wg(t,e,o)}}async function Q(e,t){const{spaceId:n,onboardingData:o}=e;if(!n)return;const i=M.H2.createChildStore(o.userRootStore,{table:l.bx,id:n});await async function(e,t,n){t.isChecked&&t.joinableUserEmailDomain&&await b.$F({environment:e,emailDomains:[t.joinableUserEmailDomain],spaceStore:n})}(t,e,i);const{emails:r}=e,a=s.jj(r).map((e=>({type:"newUser",value:{email:e},source:"email"})));r.length>0&&(await h.n_({environment:t,store:i,inviteTargets:a,inviteRole:"editor",isOnboarding:!0,invite:{inviteOrigin:"onboarding_invite"}}),m.qJp(t,{...W(e),emails:e.emails,auto_join_space:e.isChecked,is_bulk_invite:e.isBulkInvite}))}function Y(e){const{userStore:t}=e,n=I.default.getIntl(),o=t.getFullName(n),i=t.getProfilePhoto()||null;if(o)return{name:o,profilePhoto:i,password:null,prefilled:!0,userPersona:"unfilled",userTeamRole:"unfilled"}}const J="inviteCode";function X(e){return(e.isBulkInvite?e.emailTokens:e.emailInputs.filter((e=>""!==e.sanitizedEmail))).length>0}function ee(){var e;const{currentUserSettingsStore:t}=x.default.state;return t&&t.isReady()&&"email-password"===(null===(e=t.getSettings())||void 0===e?void 0:e.mobile_ads_signup_variant)}function te(e){return e.isOnboarding&&e.isNewUser}function ne(e){return e.device.isMobileBrowser}function oe(e,t){const{redirectData:n,onboardingData:o}=t;if("redirect_page"===n.type||"redirect_space"===n.type){const{spaceId:t}=n,i=M.H2.createChildStore(o.userRootStore,{table:l.bx,id:t});return(0,k.g4)(e,{spaceStore:i})}}const ie={fontSize:12,color:o.ZP.mediumTextColor,fontWeight:u.Z.fontWeight.medium,lineHeight:"135%",marginTop:20,marginBottom:4},re={marginTop:14,marginBottom:14},ae={marginTop:8,marginBottom:8};function se(e){return{color:e.mediumTextColor}}const le={width:60},ce={marginTop:14,marginBottom:8,fontSize:16,fontWeight:600},de={boxShadow:`0 0 0 1px ${o.ZP.red}`}},75538:(e,t,n)=>{n.r(t),n.d(t,{InAppOnboardingStages:()=>a,default:()=>c,onboardingPreferenceKey:()=>s});var o=n(14577),i=n(49085),r=n(15157);const a=["template_optout","workspace_setup"],s="lastOnboardingStateKeyV1";class l extends i.default{setState(e){super.setState(e),function(e){if(e.isOnboarding)if("profile"===e.stage){const{onboardingData:t,isLoading:n,password:o,passwordErrorData:i,currentUserId:a,...l}=e;r.Z.set({userId:a,key:s,value:l})}else{const{onboardingData:t,isLoading:n,currentUserId:o,...i}=e;delete i.password,r.Z.set({userId:o,key:s,value:i})}else{const{currentUserId:t,...n}=e;r.Z.set({userId:t,key:s,value:n})}}(e)}constructor(){super(),this.isOnboarding=new o.Z((()=>this.state.isOnboarding),{debugName:"isOnboarding"});const e={isOnboarding:!1,isLoading:!1,currentUserId:void 0};super.setState(e)}}const c=new l},18245:(e,t,n)=>{n.r(t),n.d(t,{NotionPerformanceClass_TEST_ONLY:()=>S,default:()=>y});n(57658);var o=n(1302),i=n(5809),r=n(68626),a=(n(72126),n(77897)),s=n(12139),l=n(97880),c=n(24215),d=n(53410),u=n(94134),p=n(77080),m=n(85844),f=n(50112),g=n(50906);const h=Object.entries(f.N);const v=new Set(["navigation_page_render","navigation_database_render","typing_lag"]);class b{constructor(){this.startTimesByMetricName={},this.lastVisibilityChange=0,m.Z.addListener((()=>{this.lastVisibilityChange=performance.now()}))}mark(e){const t=performance.mark(e).startTime,n="sentry"===u.getProfilingToolForSession()&&v.has(e)?s.Yr({name:e}):void 0;return this.startTimesByMetricName[e]={startTime:t,sentryTransaction:n},{metricName:e,startTime:t,sentryTransaction:n}}markAllOf(e){if(0===e.length)return;const t=performance.now();for(const n of e)this.startTimesByMetricName[n]={startTime:t,sentryTransaction:"sentry"===u.getProfilingToolForSession()&&v.has(n)?s.Yr({name:n}):void 0}}markEitherOf(e){if(0===e.length)return;const t=performance.now();for(const n of e)this.startTimesByMetricName[n]={startTime:t,sentryTransaction:"sentry"===u.getProfilingToolForSession()&&v.has(n)?s.Yr({name:n}):void 0,allMetricNamesMarked:e}}measure(e,t){this._measure(e,t)}measureAfterNextFlush(e,t){o.default.afterNextFlush((()=>{const n="getData"in t?t.getData():void 0;"getData"in t&&void 0===n||this._measure(e,{...t,data:n})}))}measureFromAppStart(e,t){const n="object"==typeof e?e.metricName:e,o=i.$();"number"==typeof o&&this.measure({metricName:n,startTime:o,..."object"==typeof e?{endTime:e.endTime}:{}},t)}measureFromAppStartAfterNextFlush(e,t){const n="object"==typeof e?e.metricName:e;o.default.afterNextFlush((()=>{const o="getData"in t?t.getData():void 0;if("getData"in t&&void 0===o)return;const r=i.$();"number"==typeof r&&this._measure({metricName:n,startTime:r,..."object"==typeof e?{endTime:e.endTime}:{}},{...t,data:o})}))}_measure(e,t){if("object"==typeof e){const{startTime:n,endTime:o,metricName:i,sentryTransaction:r}=e;this.startTimesByMetricName[i]=void 0;const a=this.getDuration({metricName:i,startTime:n,endTime:o});r&&r.finish(o),this.trackDuration({metricName:i,startTime:n,duration:a,options:t})}else if("string"==typeof e){const n=e,o=this.startTimesByMetricName[n];if(!o)return;const{startTime:i,allMetricNamesMarked:r,sentryTransaction:a}=o;if(r)for(const e of r)this.startTimesByMetricName[e]=void 0;else this.startTimesByMetricName[n]=void 0;const s=this.getDuration({metricName:n,startTime:i});a&&a.finish(),this.trackDuration({metricName:n,startTime:i,duration:s,options:t})}else(0,l.t1)(e)}getDuration(e){const{metricName:t,startTime:n,endTime:o}=e;try{return performance.measure(t,{start:n,..."number"==typeof o?{end:o}:{}}).duration}catch(i){return"number"==typeof o?o-n:performance.now()-n}}async trackDuration(e){const{metricName:t,duration:n,startTime:o,options:i}=e,{environment:s,data:l,preboot:u}=i;if(!document.hidden&&!("number"==typeof this.lastVisibilityChange&&o<this.lastVisibilityChange)&&await this.getSamplingDecision(t,i)){if(s.device.isElectron&&d.C&&d.C.windowIsVisible){if(!(await d.C.windowIsVisible()))return}"navigation_database_render"===t&&n>=6e4&&r.log({level:"info",from:"collections",type:"navigationPageRenderSlow",error:{message:`Got a slow navigation page render that took: ${n/1e3}s`},data:{miscDataToConvertToString:l}}),c.j(s,t,{time:n,...l},{preboot:u}),function(e,t,n){if(!("memory"in(window.performance||{})))return;const o=Math.random();h.forEach((i=>{let[r,s]=i;if(!(r in window.performance.memory))return;const l=p.default.getConfigKey("event_trail_events",s),c=l&&"sampleRatesByMetric"in l&&"object"==typeof l.sampleRatesByMetric&&l.sampleRatesByMetric[t]||0;(0,a.aw)(c,(()=>o))&&g.Z41(e,{type:s,bytes:window.performance.memory[r],data:{collected_during:t,...n}})}))}(s,t,l)}}async getSamplingDecision(e,t){const{shouldSendIfStatsigNotInitialized:n}=t;await o.default.afterNextFlush();const i=p.default.getConfigKey("event_trail_events",e);if("object"==typeof i&&"number"==typeof i.sampleRate)return(0,a.aw)(i.sampleRate);const r=p.default.getConfigKey("event_trail_events","defaultSampleRate");return"number"==typeof r?(0,a.aw)(r):!!n}}const y=new b;class S extends b{}},30806:(e,t,n)=>{n.d(t,{$X:()=>i,Ay:()=>l,BX:()=>s,cY:()=>a,lj:()=>r,sm:()=>c});var o=n(24215);function i(e){let{environment:t,from:n}=e;(0,o.j)(t,"open_home",{from:n})}function r(e){let{environment:t}=e;(0,o.j)(t,"open_home_more_menu",{})}function a(e){const{environment:t,show:n,feature:i,from:r}=e;(0,o.j)(t,"toggle_home_feature",{show:n,feature:i,from:r})}function s(e){let{environment:t,oldValue:n,newValue:i,from:r}=e;(0,o.j)(t,"change_start_page",{old_value:n,new_value:i,from:r})}function l(e){let{environment:t,index:n,teamId:i}=e;(0,o.j)(t,"change_home_trending_source",{source_type:i?"team":"space",selected_index:n,selected_team_id:i})}function c(e){let{environment:t,blocks:n}=e;(0,o.j)(t,"home_notes_block_click",{blocks:n})}},46837:(e,t,n)=>{n.d(t,{Z:()=>p});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(56996),l=n(5366),c=n(82990),d=n(85893);function u(e){let{style:t}=e;window.__c={n:"PersonalHomeBreadcrumb"};const n=(0,i.O7)(),{isMobile:o}=n.device,u=(0,r.VK)((()=>{var e;return(null===(e=n.mobileNative)||void 0===e?void 0:e.supportsNativeHomeOnPhone())??!1}),[n.mobileNative]),p=(0,a.yK)((()=>({container:{display:"flex",alignItems:"center",lineHeight:1.2,paddingRight:4,fontSize:o?c.Z.fontSize.UIRegular.mobile:c.Z.fontSize.UIRegular.desktop,maxWidth:u?"100%":void 0,...t},homeIcon:{width:20,height:20,marginRight:4}})),[o,t,u]),m=(0,d.jsxs)(d.Fragment,{children:[(0,s.z)(p.homeIcon),(0,d.jsx)(l.FormattedMessage,{id:"personalHomeBreadcrumb.homeBreadcrumb",defaultMessage:"Home"})]});return u?(0,d.jsx)("div",{style:p.container,className:"notranslate",children:m}):(0,d.jsx)("div",{style:p.container,className:"notranslate shadow-cursor-breadcrumb",children:m})}const p=o.memo(u)},14654:(e,t,n)=>{n.d(t,{ib:()=>l,t3:()=>c});var o=n(15145),i=n(60310),r=n(97880),a=n(80444),s=n(94841);function l(e){let{blockOrCollectionId:t}=e;const n=c({blockOrCollectionId:t});switch(n){case"home":return o.tY.PersonalHomePage;case"home_tile_recents":return o.tY.PersonalHomeTileRecents;case"home_tile_trending":return o.tY.PersonalHomeTileTrending;case"home_tile_tips":return o.tY.PersonalHomeTileTips;case"home_tile_tasks":return o.tY.PersonalHomeTileTasks;case"home_tasks":return o.tY.PersonalHomePageTasks;case"home_tile_similar_users":return o.tY.PersonalHomeTileSimilarUsers;case"home_unknown":return o.tY.PersonalHomeUnknown;case"home_tile_notes":return o.tY.PersonalHomeNotes;case void 0:return;default:(0,r.t1)(n)}}function c(e){var t,n;let{blockOrCollectionId:o}=e;const l=null===(t=a.default.state.currentUserStore)||void 0===t?void 0:t.id,c=null===(n=a.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!l||!c)return;const d=(0,i.QB)({userId:l,spaceId:c}),u=(0,r.Yd)(d).find((e=>o===d[e]));if(u)switch(u){case"main":return"home";case"myTasksAssignedToMeCollectionView":case"myTasks":return(0,s.q0)()?"home_tile_tasks":"home_tasks";case"trendingCollectionView":return"home_tile_trending";case"similarUsersCollectionView":return"home_tile_similar_users";case"notes":return"home_tile_notes";case"trending":case"trendingCollection":case"myTasks":case"similarUsers":case"similarUsersCollection":return"home_unknown";default:(0,r.t1)(u)}}},94841:(e,t,n)=>{n.d(t,{Al:()=>p,Ek:()=>g,M6:()=>f,T5:()=>m,Vj:()=>h,hr:()=>u,q0:()=>d});var o=n(77840),i=n(60310),r=n(21202),a=n(13493),s=n(80444),l=n(88923),c=n(35661);function d(){const e=s.default.state.mainEditorCurrentBlockStore;return!!e&&u(e)}function u(e){const t=e.getModel();return Boolean(t&&i.hr(t))}function p(e){const t=e.getPersonalHomePageId(),n=e.getSpaceStore();if(t&&n)return c.G.createChildStore(n,{table:r.iU,id:t,spaceId:n.id})}function m(e){let{environment:t,type:n}=e;const o=t.currentUser.id,{currentSpaceStore:a}=s.default.state,l=null==a?void 0:a.id;if(!l||!o)return;const d=i.Lb({userId:o,spaceId:l,type:n});return c.G.createChildStore(a,{table:r.iU,id:d,spaceId:l})}function f(e){let{environment:t}=e;const n=t.currentUser.id,{currentSpaceStore:o}=s.default.state,a=null==o?void 0:o.id;if(n&&a)return c.G.createChildStore(o,{table:r.iU,id:i.Lb({userId:n,spaceId:a,type:"notes"}),spaceId:a})}function g(e){const t=e.getPersonalHomePageTrendingListViewId(),n=e.getSpaceStore();if(t&&n)return c.Xr.createChildStore(n,{table:a.n,id:t,spaceId:n.id})}function h(){return{list_properties:[{width:200,visible:!0,property:o.Es.DueDate},{width:200,visible:!0,property:o.Es.Status},{width:200,visible:!0,property:o.Es.Location},{visible:!1,property:o.Es.Assign,width:200},{visible:!1,property:o.Es.Reporter,width:200},{visible:!1,property:o.Es.CreatedTime,width:200},{visible:!1,property:o.Es.LastEditedTime,width:200},{visible:!1,property:o.Es.LastEditedBy,width:200}],collection_group_by:void 0,collection_peek_mode:l.PeekModeCenter,inline_collection_first_load_limit:{type:"load_limit",limit:20}}}},58299:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(76796);class i extends o.B{findBlockPropertyValue(e,t){return this.find((n=>n.getProps().store===e&&n.getProps().property===t))}findBlockPropertyValueByBlockId(e,t){return this.find((n=>n.getProps().store.id===e&&n.getProps().property===t))}getRect(e,t){const n=this.findBlockPropertyValue(e,t);if(n){const e=n.getNode();if(e&&e instanceof Element)return e.getBoundingClientRect()}}}const r=new i},58202:(e,t,n)=>{n.d(t,{R:()=>s});var o=n(35431),i=n(92595),r=n(53223);class a extends o.Z{findBlockFromStore(e){return this.find((t=>t.props.store===e))}findAllBlocksFromStore(e){return this.filter((t=>t.props.store===e))}findBlockFromStoreWithMethod(e,t){return this.find((n=>n.props.store===e&&"function"==typeof n[t]))}findBlockFromId(e){return this.find((t=>t.props.store&&t.props.store.id===e))}findNodeFromStore(e){const t=this.findBlockFromStore(e);if(t)return t.getNode()}getRect(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findCollectionViewBlockFromStore(e){return this.find((t=>t.props.store===e&&(0,r.w)(t)))}findCollectionViewBlockFromId(e){return this.find((t=>{var n;return Boolean((null===(n=t.props.store)||void 0===n?void 0:n.id)===e&&(0,r.w)(t))}))}}const s=new a;(0,i.exposeDebugValue)("GlobalBlockRegistry",s)},89574:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},46351:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},47372:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},27406:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(35431),i=n(92595);class r extends o.Z{constructor(){super(...arguments),this.isDropTargetForKey=(e,t)=>e.props.dropTargetKey===t}findDropTargetFromKey(e){return this.find((t=>this.isDropTargetForKey(t,e)))}findDropTargetsFromKey(e){return this.filter((t=>this.isDropTargetForKey(t,e)))}}const a=new r;(0,i.exposeDebugValue)("GlobalDropTargetRegistry",a);const s=a},28685:(e,t,n)=>{n.d(t,{E:()=>r});var o=n(35431);class i extends o.Z{findEditableWithinSelectable(e){return this.find((t=>t.getContextClosestSelectable()===e))}findEditableWithStore(e){return this.find((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findEditableWithStore(e);if(t)return t.getNode()}findStoreFromNode(e){const t=this.find((t=>t.getNode()===e));if(t)return t.props.store}}const r=new i},3994:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{shouldPreventMobileAutoScroll(e){const t=this.find((t=>t.props.capture&&!(t.props.allowMobileAutoScroll&&e.device.isMobile)));return Boolean(t)}}const r=new i},75987:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{isInlineAutocompleteOpen(){const e=this.find((e=>e.props.isOpen));return Boolean(e)}}const r=new i},81844:(e,t,n)=>{n.d(t,{Z:()=>r});n(57658);var o=n(35431);class i extends o.Z{findOutlinerItemFromStore(e){if(e)return this.find((t=>t.store===e))}findOutlinerItemsFromId(e){const t=[];return this.forEach((n=>{n.store.id===e&&t.push(n)})),t}}const r=new i},49427:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(35431),i=n(82136);class r extends o.Z{isBlockInFrame(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===i.S.Frame&&e.props.store===t)))}}const a=new r},64815:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},16339:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},95802:(e,t,n)=>{n.d(t,{C:()=>c});var o=n(35431),i=n(92595),r=n(72126),a=n(28685),s=n(27724);class l extends o.Z{getMembersByDOMOrder(e){let{filter:t}=e;return super.getMembersByDOMOrder({filter:e=>!e.props.isHoverMenu&&t(e)})}findSelectableFromStore(e){return this.find((t=>t.props.store===e))}findScrollToSelectableFromStore(e){return this.find((t=>t.props.store===e&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===s.default.getCurrentDefaultContainer()))}findScrollToSelectablesFromIds(e){return this.filter((t=>e.includes(t.props.store.id)&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===s.default.getCurrentDefaultContainer()))}findSelectablesFromStore(e){return this.filter((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findSelectableFromStore(e);if(t)return t.getNode()}getRectFromStore(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findEditableStoreWithin(e){const t=this.findSelectableFromStore(e);if(t){const e=a.E.findEditableWithinSelectable(t);if(e)return e.props.store}}findSelectablesFromIds(e){const t=s.default.getCurrentDefaultContainer(),n=this.getMembersByDOMOrder({filter:()=>!0});return r.oA(e.map((e=>n.find((n=>{const o=n.props.store,i=n.getContextSelectableContainer();return Boolean(o&&o.id===e&&i===t)})))))}findAllSelectablesFromIds(e){const t=s.default.getCurrentDefaultContainer(),n=this.getMembersByDOMOrder({filter:()=>!0});return r.xH(e.map((e=>n.filter((n=>{const o=n.props.store,i=n.getContextSelectableContainer();return Boolean(o&&o.id===e&&i===t)})))))}findNodeFromBlockId(e){var t;const n=this.findSelectablesFromIds([e]);return null==n||null===(t=n[0])||void 0===t?void 0:t.getNode()}findSelectableFromChildNode(e){const t=this.getMembersByDOMOrder({filter:t=>{var n;return null===(n=t.getNode())||void 0===n?void 0:n.contains(e)}});return t[t.length-1]}}const c=new l;(0,i.exposeDebugValue)("GlobalSelectableRegistry",c)},28578:(e,t,n)=>{n.d(t,{Sw:()=>l,T5:()=>s,XF:()=>r,ZP:()=>d,wV:()=>a});var o=n(49085),i=n(4615);let r=function(e){return e.Share="share",e.Publish="publish",e}({}),a=function(e){return e.MainShareMenu="mainShareMenu",e.Invite="invite",e.Publish="publish",e}({}),s=function(e){return e.Notion="notion",e.Slack="slack",e}({}),l=function(e){return e.Search="search",e.Message="message",e}({});class c extends o.default{getInitialState(){return{sessionId:(0,i.ZP)(),display:a.MainShareMenu,tab:r.Share}}}const d=new c},74948:(e,t,n)=>{n.r(t),n.d(t,{OnlyOneSidebarVisibleWidthThreshold:()=>$,SidePeekCloseLeftSidebarFrameWidthThreshold:()=>Q,bookmarkPage:()=>se,cancelSidebarInitialRenderLog:()=>ke,close:()=>J,handleSidebarButtonClick:()=>ee,initialize:()=>ye,leaveBlocks:()=>ae,newPageMessages:()=>me,open:()=>Y,pinSharedPage:()=>ce,quickAddPage:()=>pe,setExpand:()=>X,setPeekWidth:()=>re,setUpdateExpand:()=>te,setUpdateSidebarCommentsMode:()=>_e,setUpdateSidebarTab:()=>Se,setUpdateWidth:()=>ie,setWidth:()=>oe,toggleBothSidebars:()=>we,toggleLeftSidebarByWindowSize:()=>ne,unbookmarkPage:()=>le,unpinSharedPage:()=>de});var o=n(1302),i=n(15145),r=n(23867),a=n(54153),s=n(5366),l=n(50906),c=n(54642),d=n(54564),u=n(98834),p=n(94419),m=n(11302),f=n(17659),g=n(89858),h=n(18957),v=n(9953),b=n(75018),y=n(39699),S=n(1742),_=n(37181),w=n(75770),k=n(58239),I=n(45010),C=n(38755),x=n(18245),T=n(5162),M=n(80444),P=n(8949),A=n(66949),R=n(77080),D=n(3418),B=n(475),E=n(42330),F=n(45325),Z=n(79689),L=n(88923),j=n(24864),V=n(35661),U=n(69784),O=n(82187),N=n(62820),z=n(34583),H=n(24646),W=n(38676),q=n(97852),G=n(36896),K=n(36391);const $=1024,Q=430;function Y(){W.TC.state||U.Z.state.isActive||A.Z.isOpen()||F.ZP.isOpen()||F.ZP.isTransitioningOpenState()||W.TC.setState(!0)}function J(){!W.TC.state||B.Z.state.open||N.Z.state.open||G.Z.state.open||q.Z.state.open||P.Z.state.isActive||O.Z.state.clonedBlockStore||W.cY.state.isResizing||!(0,Z.c)()||D.Z.state.namedOpenPopups.has("team_more_actions")||D.Z.state.namedOpenPopups.has("teams_heading_actions")||(W.Ic.setState(0),W.TC.setState(!1))}function X(e){if((0,T.Y)("supportsNativeHome"))return;const t=x.default.mark("sidebar.toggle_expanded_lag");W.gV.setState(e.isExpanded),ve(),L.default.setSidebarExpandedStoreState(e.isExpanded),e.isExpanded&&e.environment.WindowSizeStore.state.width<$&&(0,H.Sx)(e.environment)&&te({environment:e.environment,isExpanded:!1,from:"close_for_space"}),e.isExpanded&&(0,H.$3)(e.environment)<Q&&h.xv(e.environment,"sidebar_expand"),e.isExpanded?l.LMg(e.environment):l.QdK(e.environment),x.default.measureAfterNextFlush(t,{environment:e.environment,getData:()=>({is_expanded:e.isExpanded,from:e.from})})}function ee(e,t,n,o){const r=L.default.state.open,{currentTab:a}=K.ZP.state,s=a!==n||a===n&&!(0,H.Sx)(e);K.ZP.setState({...K.ZP.state,currentTab:n}),r?(b.navigateToBlock({environment:e,store:t,pageVisitSource:i.tY.Expand}),te({environment:e,isExpanded:!0,from:o})):te({environment:e,isExpanded:s,from:o})}function te(e){var t;const{isExpanded:n,environment:o,from:i}=e;if(n||d.LZ(),n){o.WindowSizeStore.state.width<$&&(0,H.in)(o)&&X({environment:o,isExpanded:!1,from:`set_update_expand_${e.from}`}),F.ZP.isOpen()&&f.qQ({open:!1,environment:o});const t=K.ZP.state.currentTab,n={origin:L.default.state.open?"peek_view":"page",from:i};t===K.gY.Comments?l.v$O(o,n):t===K.gY.Updates&&l.phe(o,n)}K.ZP.setState({...K.ZP.state,expanded:n,mouseEntered:!!n||K.ZP.state.mouseEntered,openedOnBlockId:L.default.state.open&&L.default.state.target.id||(null===(t=M.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id),canRender:!0}),be()}function ne(e){L.default.state.savedSidebarExpandedStoreState&&!W.gV.state&&function(e){if(W.gV.state||!L.default.state.savedSidebarExpandedStoreState)return;L.default.isSidePeekOpen()&&(0,H.$3)(e)-(0,H.qG)(e)>=Q&&W.gV.setState(!0)}(e),W.gV.state&&function(e){const t=W.gV.state&&0===(0,H.Wk)(e)?e.WindowSizeStore.state.width-W.GZ.state-(0,H.ll)(e,!1):(0,H.$3)(e);L.default.isSidePeekOpen()&&L.default.state.savedSidebarExpandedStoreState&&W.gV.state&&t<Q&&(W.gV.setState(!1),L.default.setSidebarExpandedStoreState(!0))}(e)}function oe(e){W.GZ.setState(e.width),(0,H.$3)(e.environment)<Q&&h.xv(e.environment,"sidebar_expand"),ve()}function ie(e){K.ZP.setState({...K.ZP.state,width:e.width}),be()}function re(e){L.default.state.open&&L.default.isSidePeekOpen()&&(L.default.setSidePeekWidth(e.width,e.environment.WindowSizeStore.state.width),function(){const{preferredSidePeekWidth:e}=L.default.state,t={width:e};a.Z.set(he,t)}(),ne(e.environment))}async function ae(e){const{blocks:t,transaction:n,environment:o}=e,{currentSpaceViewStore:i}=M.default.state;if(i)for(const r of t)p.Od({parent:i.getSharedPagesStore(),childToRemove:r,transaction:n});b.navigateAwayIfCurrentPage({environment:o,blocks:t}),await Promise.all(t.map((e=>c.leaveBlock(o,{block:{id:e.id,spaceId:(0,r.C)(e.pointer.spaceId)}}))))}const se=function(e){const{store:t,spaceViewStore:n,transaction:o}=e,i=n.getBookmarkedPagesStore(),r=V.G.createChildStore(i,t.pointer);R.default.checkGate("append_favorites")?p.R3({parent:i,append:r,transaction:o}):p.Ce({parent:i,prepend:r,transaction:o})},le=function(e){const{store:t,spaceViewStore:n,transaction:o}=e,i=n.getBookmarkedPagesStore(),r=V.G.createChildStore(i,t.pointer);p.Od({parent:i,childToRemove:r,transaction:o})},ce=function(e){const{store:t,spaceViewStore:n,transaction:o}=e;ue(e);const i=n.getSharedPagesStore(),r=V.G.createChildStore(i,t.pointer);p.Ce({parent:i,prepend:r,transaction:o})},de=function(e){const{store:t,spaceViewStore:n,transaction:o}=e;ue(e);const i=n.getSharedPagesStore(),r=V.G.createChildStore(i,t.pointer);p.Od({parent:i,childToRemove:r,transaction:o})};function ue(e){const{environment:t,spaceViewStore:n,userSettingsStore:o,transaction:i}=e,r=n.getSpaceId();if(!r||o.hasUserPinnedToOutliner({spaceId:r,type:"shared"}))return;const{visibleSharedPagesStores:a}=(0,C.k0)({environment:t,spaceViewStore:n,userSettingsStore:o}),s=a.map((e=>{let{id:t}=e;return t}));v.sW({store:n,data:{shared_pages:s},transaction:i}),_.Nb({userSettingsStore:o,spaceId:r,type:"shared",transaction:i})}async function pe(e){const{from:t,environment:n,redirect:r}=e,{currentSpaceStore:a,currentSpaceViewStore:s}=M.default.state,c=new S.sA(n,"quickAddPage");if(!(z.M_(n)&&a&&a.canEdit()&&s))return void c.fail("invalid_state");E.ZP.setState({...E.ZP.state,lastPageId:M.default.state.mainEditorCurrentBlockStore?M.default.state.mainEditorCurrentBlockStore.id:void 0});const d=await async function(e){const{newPageTracker:t,quickAddParentOverride:n,environment:o}=e,{currentSpaceStore:i}=M.default.state;if(!i)return void t.fail("invalid_state");const r=n||await(0,k.lX)({spaceStore:i,currentUserId:o.currentUser.id}),a=w.uw(r);if("space-private-pages"===r.type||a.canAdmin()){return(await y.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.directMoveToAdd",waitForServerCommit:!1,perform:async e=>{const n=v.j4({environment:o,type:"page",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:i.id,tracker:t,useCrdt:!1}),a=await m.Ws({environment:o,targets:[n],value:r,transaction:e});if(a&&"collection"===a.table){const t=a.getDefaultTemplatePageStore();t&&u.ob({title:"template",environment:o,store:n,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"sidebar_actions"})}return{createdPage:n}}})).performResult.createdPage}if(!a.canAdmin()&&a.canEdit()){const{performResult:{createdPage:e}}=await y.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.moveToAdd",waitForServerCommit:!1,perform:async e=>{const n=v.j4({environment:o,type:"page",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:i.id,useCrdt:!1});return t.track(n.pointer,e),await m.Ws({environment:o,targets:[n],value:{type:"space-private-pages",spaceId:i.id},transaction:e}),{createdPage:n}}});return await y.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.moveToMove",waitForServerCommit:!1,perform:async t=>{const n=await m.kj({environment:o,targets:[e],value:r,transaction:t});if(n&&"collection"===n.table){const i=n.getDefaultTemplatePageStore();i&&u.ob({title:"template",environment:o,store:e,templateStore:i,isKeyboard:!1,isCreateIn:!1,transaction:t,from:"sidebar_actions"})}}}),e}t.fail("invalid_state")}({...e,newPageTracker:c});return d?(n.device.isMobile?(b.navigateToBlock({environment:n,store:d,showMoveTo:!0,saveParent:!0,redirect:r,pageVisitSource:i.tY.SidebarQuickAdd}),J()):b.peekBlock({environment:n,store:d,showMoveTo:!0,saveParent:!0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:i.tY.SidebarQuickAdd}),g.Eo({environment:n,spaceViewStore:s,type:"private",newIsHidden:!1,outlinerToggleButtonStore:j.Z,shouldPersistToggleState:!0}),l.W2j(n,{from:t,type:"page",new_page_id:d.id}),o.default.afterNextFlush((()=>{I.Z.SidebarScroller&&I.Z.SidebarScroller.scrollToBottom()})),d):void 0}const me=(0,s.defineMessages)({label:{id:"sidebar.newPage.button",defaultMessage:"New page"},tooltip:{id:"sidebar.newPage.tooltip",defaultMessage:"Create a new page"}}),fe="sidebar",ge="updateSidebar",he="sidePeek";function ve(){const e={expanded:W.gV.state,width:W.GZ.state};a.Z.set(fe,e)}function be(){const{expanded:e,width:t,openedOnBlockId:n,commentsMode:o,currentTab:i,currentSubTab:r}=K.ZP.state,s={expanded:e,width:t,openedOnBlockId:n,commentsMode:o,currentTab:i,currentSubTab:r};a.Z.set(ge,s)}function ye(){const e=a.Z.get(fe),t=a.Z.get(ge),n=a.Z.get(he);if((0,T.Y)("supportsNativeHome")?(W.gV.setState(!1),W.GZ.setState(0)):e&&(void 0!==e.expanded&&W.gV.setState(e.expanded),void 0!==e.width&&e.width>=W.nP&&W.GZ.setState(e.width)),t){const e=t.width&&t.width>=K.AO?t.width:K.AO;K.ZP.setState({...K.ZP.state,...t,width:e}),window.innerWidth<$&&W.gV.setState(!1)}n&&L.default.setSidePeekWidth(n.width,window.innerWidth)}function Se(e){K.ZP.setState({...K.ZP.state,currentTab:e})}function _e(e){K.ZP.setState({...K.ZP.state,commentsMode:e}),be()}function we(e){(0,H.Sx)(e)||W.gV.state?(X({environment:e,isExpanded:!1,from:"toggle_both_sidebars"}),te({environment:e,isExpanded:!1,from:"keyboard_default"})):(te({environment:e,isExpanded:!0,from:"keyboard_default"}),X({environment:e,isExpanded:!0,from:"toggle_both_sidebars"}))}function ke(){W.Yr.setState(!1)}},24646:(e,t,n)=>{n.d(t,{$3:()=>S,Bb:()=>M,GD:()=>R,J5:()=>b,Jr:()=>g,Nc:()=>m,Sx:()=>y,U8:()=>P,Wk:()=>w,YR:()=>C,_c:()=>f,em:()=>T,in:()=>h,js:()=>x,ll:()=>k,qG:()=>_,vG:()=>D,vJ:()=>I,vK:()=>v,wE:()=>A});var o=n(5366),i=n(28020),r=n(4708),a=n(38755),s=n(80444),l=n(45325),c=n(88923),d=n(38676),u=n(36391),p=n(21853);const m=800;function f(e){return!1}function g(e){return!!e.device.isDesktop||!!e.device.isTablet&&e.WindowSizeStore.isLandscape()}function h(e){return((0,r.GH)()||e.currentUser.isLoggedIn())&&d.gV.state}function v(e){return y(e)&&u.ZP.state.currentTab===u.gY.Comments}function b(e){return y(e)&&u.ZP.state.currentTab===u.gY.Updates}function y(e){var t;return(null===(t=s.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id)===u.ZP.state.openedOnBlockId&&(e.currentUser.isLoggedIn()&&!e.device.isMobile&&u.ZP.state.expanded||p.Z.state.open)}function S(e){return e.WindowSizeStore.state.width-w(e)-k(e,!1)}function _(e){const{isDesktop:t,isMobile:n,isTablet:o}=e.device,{WindowSizeStore:i}=e,r=i.isLandscape(),a=n&&!o&&r;return t?d.GZ.state:o||a?Math.min(320,.87*e.WindowSizeStore.state.width):.87*e.WindowSizeStore.state.width}function w(e){const{shouldShowSidebar:t}=(0,i.h1)(e),n=h(e);return t&&n&&g(e)?_(e)+l.ZP.getPanelWidthReturnZeroForClosingState():t&&!n&&l.ZP.isOpen()?l.ZP.getPanelWidthReturnZeroForClosingState():0}function k(e,t){return t&&c.default.state.open?0:function(e){0;if(e.device.isMobile)return 0;if(I(e)>0)return 0;return y(e)?u.ZP.state.width:0}(e)+I(e)}function I(e){return c.default.isSidePeekOpen()?c.default.getSidePeekWidth(e.WindowSizeStore.state.width):0}function C(e){return e.device.isAndroid&&!e.device.isTablet||e.device.isTablet&&e.WindowSizeStore.isPortrait()}const x=(0,o.defineMessages)({createOrJoinWorkspace:{defaultMessage:"Create or join workspace",id:"sidebarSwitcher.createOrJoinWorkspaceButton.prompt"},personalPlan:{defaultMessage:"Personal Plan",id:"sidebarSwitcher.personalPlan.label"},proPlan:{defaultMessage:"Personal Pro Plan",id:"sidebarSwitcher.proPlan.label"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"educationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"sidebarSwitcher.educationPlusPlan.label"},freePlan:{defaultMessage:"Free Plan",id:"sidebarSwitcher.freePlan.label"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"sidebarSwitcher.enterprisePlan.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"sidebarSwitcher.legacyPlan.label"},workspaceSubtitleWithMembers:{id:"sidebarSwitcher.workspaceSubtitleWithMembers.label",defaultMessage:"{planType} · {numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}}"},workspaceSubtitleWithoutMembers:{id:"sidebarSwitcher.workspaceSubtitleWithoutMembers.label",defaultMessage:"{planType}"}});function T(e){switch(e){case"team_free":case"personal_free":case"free":return x.freePlan;case"personal":return x.plusPlan;case"student":return x.educationPlusPlan;case"plus":return x.plusPlan;case"business":return x.businessPlan;case"enterprise":return x.enterprisePlan;default:return x.legacyPlan}}function M(e){return e.canRead()&&"copy_indicator"!==e.getType()}function P(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o}=e;return t&&n&&!o}function A(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:i}=e;return!i&&P({isElectronMac:t,isExpanded:n,isFullScreenDesktop:o})}function R(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:i}=e;return n&&!i&&!A({isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:i})}function D(e){var t;let{environment:n}=e;const o=null===(t=(0,i.k_)(n).state)||void 0===t?void 0:t.showTeamSection,r=s.default.state.currentSpaceStore,l=n.device.isMobile;return!(!o||!r||l)&&!(0,a.Cx)(r)}},88310:(e,t,n)=>{n.d(t,{$L:()=>s,As:()=>c,hV:()=>d,ls:()=>u});var o=n(5809),i=n(72126),r=n(83055);const a={};function s(e){void 0===a[e]&&(a[e]=performance.now())}const l={};function c(e){Object.assign(l,e)}function d(){return l}function u(){const{app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:n,render_start_to_render_end:s}=(0,r.I)().sub_metrics,l=(0,o.$)(),c={app_start_to_await_get_spaces_start:p(l,a.await_get_spaces_start),app_start_to_await_get_spaces_end:p(l,a.await_get_spaces_end),app_start_to_browser_repaint_start:p(l,a.browser_repaint_start),app_start_to_browser_repaint_end:p(l,a.browser_repaint_end)},d=i.GM({app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:n,render_start_to_render_end:s,...c},i.o8),u=[e,t,n,s];return u.some(i.o8)||(d.app_start_to_render_end=i.Sm(u)),d}function p(e,t){return void 0===e||void 0===t?void 0:t-e}},68418:(e,t,n)=>{n.d(t,{F:()=>r,Z:()=>s});var o=n(49085),i=n(4615);let r=function(e){return e[e.Team=0]="Team",e[e.Members=1]="Members",e}({});class a extends o.default{getInitialState(){return{open:!1,screen:r.Team,description:"",accessLevel:"open",isDefault:!1,name:"",icon:void 0,flowId:(0,i.ZP)(),pageNumber:1,onClose:void 0}}}const s=new a},97799:(e,t,n)=>{n.d(t,{Y:()=>i,Z:()=>r});var o=n(61766);let i=function(e){return e.Updates="updates",e.Home="home",e}({});const r=new o.Z},55521:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{touching:!1,swiping:!1}}}const r=new i},19034:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(80444);class r extends o.default{getInitialState(){return{results:[]}}getUnreadCountForCurrentSpace(){const{currentSpaceStore:e}=i.default.state,{results:t}=this.state;if(e){const n=t.find((t=>t.spaceId===e.id));if(n)return n.unread}return{mentions:0,following:0,highPriority:0}}getUnreadMentionsCountForOtherSpaces(){const{currentSpaceStore:e}=i.default.state,t=e&&e.id,{results:n}=this.state;let o=0;for(const i of n)i.spaceId!==t&&(o+=i.unread.mentions);return o}getTotalUnreadMentionsCount(){const{results:e}=this.state;let t=0;for(const n of e)t+=n.unread.mentions;return t}}const a=new r},38676:(e,t,n)=>{n.d(t,{GZ:()=>r,H3:()=>m,Ic:()=>l,TC:()=>a,Yr:()=>g,cY:()=>p,ck:()=>c,gV:()=>d,kx:()=>s,nP:()=>f,xH:()=>u});var o=n(49085),i=n(77794);const r=o.default.createValue(240),a=o.default.createValue(!1),s=o.default.createValue(!1),l=o.default.createValue(0),c=o.default.createValue(0),d=o.default.createValue(!0),u=o.default.createValue(!1),p=o.default.createValue({isResizing:!1,isResizerHovered:!1}),m=new i.E,f=220,g=o.default.createValue(!0)},97852:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},78861:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(49085),i=n(72126),r=n(19889),a=n(66079),s=n(63143),l=n(81236),c=n(35661);class d extends o.default{getInitialState(){return{createType:void 0}}getUserIds(e){return e.currentUser.loggedInUserIds}getAllSpaceViewStores(e){return this.getUserIds(e).reduce(((t,n)=>[...t,...this.getSpaceViewStores(e,n)]),[])}hasAtLeastOneTeamPlan(e){return this.getAllSpaceViewStores(e).map((e=>{const t=e.getSpaceStore();if(t)return t.getPlanType()})).some((e=>"team"===e))}getSpaceViewStores(e,t){const n=new c.r9(e,{table:a.dx,id:t},{userId:t}).getSpaceViewStores();return i.mN(n,(e=>e.isDefined()&&e.getSpaceId())).filter((t=>Boolean(t.isDefined())&&Boolean(t.getAlive())&&!this.isSpaceDeleted(e,t)))}isSpaceDeleted(e,t){const n=t.getSpaceId()||"",o=l.Z.getPublicSpaceData(e,n);return(0,s.z4)(o)}getUserEmailAddress(e,t){return new c.U6(e,{table:r.KJ,id:t},{userId:t}).getEmail()}}const u=new d},55838:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>i});var o=n(49085);let i=function(e){return e[e.General=0]="General",e[e.Members=1]="Members",e[e.Security=2]="Security",e}({});class r extends o.default{getInitialState(){return{open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}}getTeamStore(){return this.state.open?this.state.viewingUnjoinedPrivateTeamAsEnterpriseAdmin?this.state.unjoinedPrivateTeamStore:this.state.teamStore:void 0}}const a=new r},36896:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},44604:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{constructor(){super(...arguments),this.loadMoreOffset=200,this.startLimit=20,this.limitIncrement=20}getInitialState(){return{filter:"",currentTab:"all_pages",loading:!0,limit:this.startLimit,excludePages:new Set}}}const r=new i},36391:(e,t,n)=>{n.d(t,{AO:()=>l,F7:()=>r,ZP:()=>u,gY:()=>a,uF:()=>s});var o=n(49085),i=n(92595);let r=function(e){return e[e.Resolved=0]="Resolved",e[e.Unresolved=1]="Unresolved",e}({}),a=function(e){return e[e.Comments=0]="Comments",e[e.Updates=1]="Updates",e}({}),s=function(e){return e[e.Updates=0]="Updates",e[e.Analytics=1]="Analytics",e}({});const l=385;class c extends o.default{getInitialState(){return{width:l,expanded:!1,isResizerHovered:!1,isResizing:!1,mouseEntered:!1,currentTab:a.Comments,currentSubTab:s.Updates,commentsMode:r.Unresolved,isAnimating:!1,canRender:!0}}}const d=new c;(0,i.exposeDebugValue)("UpdateSidebarStore",d);const u=d},21853:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},98794:(e,t,n)=>{n.r(t),n.d(t,{annotateSimpleTableSelection:()=>ee,appendRow:()=>me,cancelReorder:()=>Ce,clearHover:()=>ie,clearSelectedCell:()=>Ee,clearSelection:()=>G,clearSelectionContents:()=>Fe,completeReorder:()=>xe,continueReorder:()=>Ie,contractColumns:()=>Me,contractRows:()=>Re,deleteColumns:()=>Te,deleteRows:()=>Ae,duplicateColumns:()=>fe,duplicateRows:()=>ge,expandCellSelection:()=>H,extendColumns:()=>ae,extendRows:()=>ue,fitToPage:()=>Ne,handleDelete:()=>Y,handleDuplicate:()=>X,handleKeypress:()=>J,handleLeftRightKey:()=>K,handleUpDownKey:()=>Q,hoverCell:()=>te,hoverResizer:()=>oe,hoverRowColumn:()=>ne,insertColumnLeft:()=>re,insertColumnRight:()=>se,insertRow:()=>pe,insertRowAbove:()=>ce,insertRowBelow:()=>de,messages:()=>V,resizeColumn:()=>Se,selectCell:()=>N,selectCellAndSetCursor:()=>W,selectColumn:()=>O,selectMultiCell:()=>z,selectRow:()=>U,setColor:()=>Oe,setResizing:()=>be,showResizeBar:()=>ve,startReorder:()=>ke,toggleHeaderColumn:()=>Ue,toggleHeaderRow:()=>Ve,turnIntoCollection:()=>Le,turnIntoSimpleTable:()=>je,updateCellSelectionFromTextSelection:()=>q,updateColumnSelectionOnResize:()=>we,updateRowSelectionOnResize:()=>_e});n(57658),n(21703);var o=n(1302),i=n(41432),r=n(90559),a=n(99036),s=n(80951),l=n(4615),c=n(71644),d=n(21202),u=n(6287),p=n(13493),m=n(23867),f=n(70203),g=n(63143),h=n(5366),v=n(54532),b=n(96802),y=n(94419),S=n(19785),_=n(9953),w=n(24677),k=n(97444),I=n(98104),C=n(39699),x=n(95477),T=n(14976),M=n(33929),P=n(65598),A=n(22294),R=n(35661),D=n(27724),B=n(24666),E=n(27534),F=n(84139),Z=n(64359),L=n(5676),j=n(63208);const V=(0,h.defineMessages)({turnIntoCollectionTitle:{defaultMessage:"Title",id:"simpleTableActions.collectionTitle"},turnIntoCollectionColumnTitle:{defaultMessage:"Column {columnIndex}",id:"simpleTableActions.collectionColumnTitle"}});function U(e){const{environment:t,index:n,simpleTableStore:o}=e,i=E.getNumberOfRows(o);if(0===i)return G(),void I.ZH(t);const r=(0,g.uZ)(n,0,i-1);j.Z.setState({isActive:!0,simpleTableStore:o,selection:{start:{col:0,row:r},end:{col:E.getNumberOfColumns(o)-1,row:r},type:"row"}}),w.Z5({environment:t,stores:[o],phase:D.SelectionPhase.Editing}),I.ZH(t)}function O(e){const{environment:t,index:n,simpleTableStore:o}=e,i=E.getNumberOfColumns(o);if(0===i)return G(),void I.ZH(t);const r=(0,g.uZ)(n,0,i-1);j.Z.setState({isActive:!0,simpleTableStore:o,selection:{start:{col:r,row:0},end:{col:r,row:E.getNumberOfRows(o)-1},type:"column"}}),w.Z5({environment:t,stores:[o],phase:D.SelectionPhase.Editing}),I.ZH(t)}function N(e){const{environment:t,rowIndex:n,columnIndex:o,simpleTableStore:i}=e;j.Z.setState({isActive:!0,simpleTableStore:i,selection:{start:{col:o,row:n},end:{col:o,row:n},type:"cell"}}),w.Z5({environment:t,stores:[i],phase:D.SelectionPhase.Editing})}function z(e){const{environment:t,start:n,end:o,simpleTableStore:i}=e;j.Z.setState({isActive:!0,simpleTableStore:i,selection:{start:n,end:o,type:"cell"}}),w.Z5({environment:t,stores:[i],phase:D.SelectionPhase.Editing}),I.ZH(t)}function H(e){const{environment:t,rowIndex:n,columnIndex:o,simpleTableStore:i}=e;z({environment:t,start:j.Z.state.isActive?j.Z.state.selection.start:{col:o,row:n},end:{col:o,row:n},simpleTableStore:i})}function W(e){N(e);const t=E.getCellTextStore(e);t&&I.NX({store:t})}function q(){if("editing"!==B.default.state.mode)return;const e=E.getSimpleTableCellFromTextSelection();if(!e)return void G();const{columnIndex:t,rowIndex:n,simpleTableStore:o}=e.props,i=j.Z.state;if(i.isActive){const{start:e,end:r}=i.selection;!(e.col===r.col&&e.row===r.row)||e.col===t&&e.row===n&&i.simpleTableStore===o||N({environment:o.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}else N({environment:o.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}function G(){j.Z.setState({isActive:!1})}function K(e){const{environment:t,direction:n,bypassExistingTextSelection:o,expandSelection:i}=e;if(!o&&E.getSimpleTableCellFromTextSelection())return;const r=j.Z.state;if(r.isActive){const{selection:e,simpleTableStore:a}=r;if(i){const{rowIndex:o,columnIndex:i}=$({selection:e,simpleTableStore:a,direction:n,wrapRow:!1});return void H({environment:t,rowIndex:o,columnIndex:i,simpleTableStore:a})}if(E.isColumnSelected({selection:e,columnIndex:e.start.col,simpleTableStore:a})){const{columnIndex:o}=$({selection:e,simpleTableStore:a,direction:n,wrapRow:!1});O({environment:t,index:o,simpleTableStore:a})}else{const i="editing"===B.default.state.mode;o&&I.ZH(t);const{rowIndex:r,columnIndex:s}=$({selection:e,simpleTableStore:a,direction:n,wrapRow:!0});if(i)return void W({environment:t,rowIndex:r,columnIndex:s,simpleTableStore:a});N({environment:t,rowIndex:r,columnIndex:s,simpleTableStore:a})}}A.Z.setKeyboardMode(!0)}function $(e){const{selection:t,simpleTableStore:n,direction:o,wrapRow:i}=e,r=E.getNumberOfColumns(n)-1,a=E.getNumberOfRows(n)-1,{col:s,row:l}=t.end;return"right"===o?s===r&&l===a?{columnIndex:r,rowIndex:a}:s===r?i?{columnIndex:0,rowIndex:l+1}:{columnIndex:s,rowIndex:l}:{columnIndex:s+1,rowIndex:l}:0===s&&0===l?{columnIndex:0,rowIndex:0}:0===s?i?{columnIndex:r,rowIndex:l-1}:{columnIndex:s,rowIndex:l}:{columnIndex:s-1,rowIndex:l}}function Q(e){const{environment:t,direction:n,bypassExistingTextSelection:o,expandSelection:i}=e;if(!o&&E.getSimpleTableCellFromTextSelection())return;const r=j.Z.state;if(r.isActive){const{selection:e,simpleTableStore:a}=r,{rowIndex:s,columnIndex:l}=function(e){const{selection:t,simpleTableStore:n,direction:o}=e,i=E.getNumberOfRows(n)-1,{col:r,row:a}=t.end,s="down"===o?Math.min(i,a+1):Math.max(0,a-1);return{columnIndex:r,rowIndex:s}}({selection:e,simpleTableStore:a,direction:n});if(i)return void H({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a});E.isRowSelected({selection:e,rowIndex:e.start.row,simpleTableStore:a})?U({environment:t,index:s,simpleTableStore:a}):(o&&I.ZH(t),N({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a}))}A.Z.setKeyboardMode(!0)}function Y(e){if(E.getSimpleTableCellFromTextSelection())return;const t=j.Z.state;if(!t.isActive)return;const{environment:n,transaction:o}=e,{selection:i,simpleTableStore:r}=t;if(E.isColumnSelected({selection:i,columnIndex:i.start.col,simpleTableStore:r}))Fe(e),Pe({index:i.start.col,simpleTableStore:r,transaction:o}),O({environment:n,index:i.start.col,simpleTableStore:r});else if(E.isRowSelected({selection:i,rowIndex:i.start.row,simpleTableStore:r})){De({rowID:r.getRenderableContentIds()[i.start.row],simpleTableStore:r,transaction:o}),U({environment:n,index:i.start.row,simpleTableStore:r})}else E.isSingleCellSelected(i)?Ee({environment:n,transaction:o}):Fe({environment:n,transaction:o})}function J(e){if(E.getSimpleTableCellFromTextSelection())return;const t=j.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=o.getContentStores()[n.end.row],r=E.getColumnOrder(o);if(!r)return;const{environment:a,transaction:s,key:l}=e,c=i.getPropertyStore(r[n.end.col]);if(l&&1===l.length){const e=c.getValue(),t=f.TPx(l);k.sO({environment:a,store:c,value:e?e.concat(t):t,transaction:s}),I.NX({store:c})}}function X(e){if(E.getSimpleTableCellFromTextSelection())return;const t=j.Z.state;if(!t.isActive)return;const{environment:n,transaction:o}=e,{selection:i,simpleTableStore:r}=t;E.isColumnSelected({selection:i,columnIndex:i.start.col,simpleTableStore:r})?fe({transaction:o}):E.isRowSelected({selection:i,rowIndex:i.start.row,simpleTableStore:r})&&ge({environment:n,transaction:o})}function ee(e){const{simpleTableStore:t,annotation:n}=e,o=j.Z.state;if(!o.isActive||o.simpleTableStore!==t)return;const{selection:i}=o,r=[],a=Math.min(i.start.row,i.end.row),s=Math.max(i.start.row,i.end.row),l=Math.min(i.start.col,i.end.col),c=Math.max(i.start.col,i.end.col);for(let p=a;p<=s;p++)for(let e=l;e<=c;e++){const n=E.getCellTextStore({simpleTableStore:t,rowIndex:p,columnIndex:e}),o=null==n?void 0:n.getValue();n&&o&&r.push({textStore:n,textValue:o})}const d=f.J7s(n),u=r.every((e=>{let{textValue:t}=e;return t.every((e=>f.hDy(e).some((e=>f.J7s(e)===d))))}));for(const{textStore:p}of r)k.QT({...e,textStore:p,action:u?"removeAnnotationType":"annotate"})}function te(e){if(ye())return;const{x:t,y:n,simpleTableStore:o}=e;Z.Z.setState({isActive:!0,simpleTableStore:o,hover:{x:t,y:n,showResizer:!1,resizing:!1,type:"cell"}})}function ne(e){if(ye())return;const{type:t,simpleTableStore:n,index:o}=e;Z.Z.setState({isActive:!0,simpleTableStore:n,hover:{type:t,index:o}})}function oe(e){const{simpleTableStore:t,resizer:n}=e;Z.Z.setState({isActive:!0,simpleTableStore:t,hover:{type:"resizer",resizer:n}})}function ie(){ye()||Z.Z.setState({isActive:!1})}function re(e){const t=j.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;le({index:n.start.col,simpleTableStore:o,transaction:r}),W({environment:i,rowIndex:0,columnIndex:n.start.col,simpleTableStore:o})}function ae(e){const{count:t,simpleTableStore:n,transaction:o}=e;if(t<1)return;const i=E.getNumberOfColumns(n);for(let r=0;r<t;r++)le({index:i+r,simpleTableStore:n,transaction:o})}function se(e){const t=j.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;le({index:n.end.col+1,simpleTableStore:o,transaction:r}),W({environment:i,rowIndex:0,columnIndex:n.end.col+1,simpleTableStore:o})}function le(e){const{index:t,simpleTableStore:n,transaction:o,columnID:i,format:r}=e,a=E.getColumnOrder(n)||[],s=E.getColumnFormat(n),l=i||(0,c.ZP)(),d=[...a.slice(0,t),l,...a.slice(t)],u=r?{...s,[l]:r}:s;b.FH({stores:[n],update:{table_block_column_order:d,table_block_column_format:u},transaction:o})}function ce(e){const t=j.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;pe({environment:i,index:n.start.row,simpleTableStore:o,transaction:r}),W({environment:i,rowIndex:n.start.row,columnIndex:0,simpleTableStore:o})}function de(e){const t=j.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;pe({environment:i,index:n.end.row+1,simpleTableStore:o,transaction:r}),W({environment:i,rowIndex:n.end.row+1,columnIndex:0,simpleTableStore:o})}function ue(e){const{environment:t,count:n,simpleTableStore:o,transaction:i}=e;if(n<1)return;const r=E.getNumberOfRows(o);for(let a=0;a<n;a++)pe({environment:t,index:r+a,simpleTableStore:o,transaction:i})}function pe(e){const{environment:t,index:n,simpleTableStore:o,transaction:i}=e,r=o.getContentStore();if(!(0,P.dz)(r))throw new Error("Block has an invalid parent.");const a=_.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:i,spaceId:o.pointer.spaceId,useCrdt:o.useCrdt()}),s=R.G.createChildStore(r,a.pointer);if(n<=0)S.SH({parentStore:r,childStore:s,transaction:i});else{const e=o.getContentStores();S.jG({parentStore:r,childStore:s,transaction:i,after:e[n-1].id})}return s}function me(e){const{environment:t,simpleTableStore:n,transaction:o}=e,i=n.getContentStore();if(!(0,P.dz)(i))throw new Error("Block has an invalid parent.");const r=_.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:o,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()}),a=R.G.createChildStore(i,r.pointer);return S.jG({parentStore:i,childStore:a,transaction:o}),a}function fe(e){const t=j.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=E.getColumnOrder(o),r=E.getColumnFormat(o);if(!i)return;const a=i.slice(n.start.col,n.end.col+1);if(!a)return;const s=[],{transaction:l}=e;for(let d=n.start.col;d<=n.end.col;d++){const e=a[d-n.start.col],t=(0,c.ZP)();s.push(t),le({index:n.end.col+1,simpleTableStore:o,transaction:l,columnID:t,format:r?r[e]:void 0})}for(const c of o.getContentStores())he({rowStore:c,columnIDs:a,newColumnIDs:s,transaction:l})}function ge(e){const t=j.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=o.getRenderableContentIds(),{environment:r,transaction:a}=e;for(let s=n.start.row;s<=n.end.row;s++){const e=R.G.createChildStore(o,{table:d.iU,id:i[s]}),[t]=v.Qi({environment:r,stores:[e],addCopyName:!1,transaction:a,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,m.C)(e.pointer.spaceId),baseUrl:x.default.domainBaseUrl,publicDomainName:x.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:o.useCrdt()}),n=t[0];y.BE({parent:o.getContentStore(),insert:n,after:e,transaction:a})}}function he(e){const{rowStore:t,columnIDs:n,newColumnIDs:o,transaction:i}=e,r=t.getPropertiesStore(),a={...r.getValue(),...(0,g.m8)(o.map(((e,o)=>[e,t.getPropertyValue(n[o])])))};_.sO({store:r,value:a,transaction:i})}function ve(e){const t=Z.Z.state;if(!t.isActive)return;const{hover:n}=t;"cell"===n.type&&Z.Z.setState({...t,hover:{...n,showResizer:e}})}function be(e){const t=Z.Z.state;if(!t.isActive)return;const{hover:n}=t;"cell"===n.type&&Z.Z.setState({...t,hover:{...n,resizing:e}})}function ye(){const e=Z.Z.state;return e.isActive&&"resizing"in e.hover&&e.hover.resizing}function Se(e){const{tableBlockColumnFormat:t,simpleTableStore:n,transaction:o}=e;b.FH({stores:[n],update:{table_block_column_format:t},transaction:o})}function _e(e){const t=j.Z.state;if(!t.isActive||"row"!==t.selection.type)return;const{selection:n}=t;j.Z.setState({...t,selection:{...n,end:{col:e,row:n.end.row}}})}function we(e){const t=j.Z.state;if(!t.isActive||"column"!==t.selection.type)return;const{selection:n}=t;j.Z.setState({...t,selection:{...n,end:{col:n.end.col,row:e}}})}function ke(e){const{environment:t,simpleTableStore:n,id:o,index:i,type:r,rowStore:a,theme:s,selectorStartPx:l,mouseOffsetPx:c}=e;let d=[];"column"===r?(O({environment:t,index:i,simpleTableStore:n}),d=F.Z.findCellsInColumnFromStore(n,o)):(U({environment:t,index:i,simpleTableStore:n}),d=F.Z.findCellsInRowFromStore(a));const u=E.cloneCellsForDragOverlay({cells:d,type:r,theme:s});L.Z.setState({isActive:!0,simpleTableStore:n,source:{id:o,type:r,index:i,draggedCells:u,selectorStartPx:l,mouseOffsetPx:c},destIndex:i,selectorDragPx:l,moved:!1})}function Ie(e){const{destIndex:t,selectorDragPx:n}=e,o=L.Z.state;o.isActive&&L.Z.setState({...o,destIndex:t,selectorDragPx:n,moved:!0})}function Ce(){L.Z.reset()}function xe(e){const{event:t,environment:n,format:i,simpleTableStore:r,transaction:a,type:s,onNoChange:l}=e,c=L.Z.state;if(!c.isActive)return;const{source:d,destIndex:u}=c;d.type===s&&c.simpleTableStore===r&&("column"===s?function(e){const{environment:t,columnOrder:n,source:i,destIndex:r,simpleTableStore:a,transaction:s}=e;if(!n)return;G();const l=[...n.slice(0,i.index),...n.slice(i.index+1)],c=[...l.slice(0,r),i.id,...l.slice(r)];b.FH({stores:[a],update:{table_block_column_order:c},transaction:s}),o.default.afterNextFlush((()=>{O({environment:t,index:r,simpleTableStore:a})}))}({environment:n,columnOrder:i.table_block_column_order,source:d,destIndex:u,simpleTableStore:r,transaction:a}):function(e){const{environment:t,source:n,destIndex:i,simpleTableStore:r,transaction:a}=e,s=r.getRenderableContentIds(),l=i>n.index?i:i-1;let c=i>0?s[l]:void 0;c===n.id&&(c=s[l+1]);G();const d=r.getContentStores().find((e=>e.id===n.id)),u=r.getContentStores().find((e=>e.id===c));if(d){const e=r;u?S.jG({parentStore:e,after:u.id,childStore:d,transaction:a}):S.SH({parentStore:e,childStore:d,transaction:a}),o.default.afterNextFlush((()=>{U({environment:t,index:i,simpleTableStore:r})}))}}({environment:n,source:d,destIndex:u,simpleTableStore:r,transaction:a}),d.index===u&&(null==l||l(t)))}function Te(e){const t=j.Z.state;if(!t.isActive)return;Fe(e);const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;for(let a=n.start.col;a<=n.end.col;a++)Pe({index:a,simpleTableStore:o,transaction:r});O({environment:i,index:n.start.col,simpleTableStore:o})}function Me(e){const{simpleTableStore:t,columnOrder:n,transaction:o}=e;b.FH({stores:[t],update:{table_block_column_order:n},transaction:o})}function Pe(e){const{index:t,simpleTableStore:n,transaction:o}=e,i=E.getColumnOrder(n);if(!i||1===i.length)return;const r=[...i.slice(0,t),...i.slice(t+1)];b.FH({stores:[n],update:{table_block_column_order:r},transaction:o})}function Ae(e){const t=j.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=o.getRenderableContentIds(),{environment:r,transaction:a}=e;for(let s=n.start.row;s<=n.end.row;s++)De({rowID:i[s],simpleTableStore:o,transaction:a});U({environment:r,index:n.start.row,simpleTableStore:o})}function Re(e){const{simpleTableStore:t,numRowsToDelete:n,transaction:o}=e,i=t.getRenderableContentIds();for(let r=i.length-n;r<i.length;r++)De({rowID:i[r],simpleTableStore:t,transaction:o})}function De(e){const{rowID:t,simpleTableStore:n,transaction:o}=e,i=n.getContentStore();if(!(0,P.dz)(i))throw new Error("Block has an invalid parent.");if(E.getNumberOfRows(n)<=1)return;const r={table:d.iU,id:t};Be({rowStore:R.G.createChildStore(i,r),simpleTableStore:n,transaction:o})}function Be(e){const{rowStore:t,simpleTableStore:n,transaction:o}=e,i=n.getContentStore();S.hr({parentStore:i,childStore:t,transaction:o})}function Ee(e){const t=j.Z.state;if(!t.isActive)return;const{selection:n}=t;if(!E.isSingleCellSelected(n))return;const{environment:o,transaction:i}=e;Fe({environment:o,transaction:i})}function Fe(e){const t=j.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=E.getColumnOrder(o);if(!i)return;const r=o.getContentStores(),{environment:a,transaction:s}=e,l=Math.min(n.start.row,n.end.row),c=Math.max(n.start.row,n.end.row),d=Math.min(n.start.col,n.end.col),u=Math.max(n.start.col,n.end.col);for(let p=l;p<=c;p++)Ze({rowStore:r[p],startIndex:d,endIndex:u,columnOrder:i,transaction:s});I.ZH(a)}function Ze(e){const{rowStore:t,startIndex:n,endIndex:o,columnOrder:i,transaction:r}=e,a=i.slice(n,o+1);if(!a)return;const s=t.getPropertiesStore(),l=(0,g.m8)(Object.entries(s.getValue()||{}).filter((e=>{let[t,n]=e;return!a.includes(t)})));_.sO({store:s,value:l,transaction:r})}function Le(e){const{simpleTableStore:t,transaction:n}=e,o=E.getColumnOrder(t)||[],r=E.getColumnFormat(t)||{},{headerRow:s}=E.getHeadersEnabled(t),c=t.getContentStores();if(!o.length)return;const m=o[0],f=t.getSpaceId(),h=(0,l.ZP)(),v=(0,l.ZP)(),b=s?c[0]:void 0,y=(0,g.m8)(o.map(((e,t)=>function(e){const{columnID:t,columnIndex:n,titleColumnID:o,headerRowStore:i}=e;let r=t,a="text",s=V.turnIntoCollectionColumnTitle;t===o&&(r="title",a="title",s=V.turnIntoCollectionTitle);const l=M.default.getIntl();return[r,{name:i?T.Xh(i.getPropertyValue(t),i):l.formatMessage(s,{columnIndex:n}),type:a}]}({columnID:e,columnIndex:t,titleColumnID:m,headerRowStore:b})))),S={id:h,version:0,parent_table:d.iU,parent_id:t.id,space_id:f,name:void 0,schema:y,alive:!0},w={table:u.v,id:h,spaceId:f};C.applyOperation({store:(0,R.Kv)(t,w),operation:{pointer:w,command:"set",path:[],args:S},transaction:n}),_.sW({store:t,data:{type:i.Ti.collectionView,collection_id:h,format:{collection_pointer:{table:u.v,id:h,spaceId:f}},view_ids:[v],content:[]},transaction:n}),c.map(((e,o)=>{if(s&&0===o)return void Be({rowStore:e,simpleTableStore:t,transaction:n});const r=e.getProperties();_.sW({store:e,data:{type:i.Ti.page,parent_id:h,parent_table:u.v,properties:{...r,title:r[m],[m]:void 0}},transaction:n})}));const k={id:v,version:0,type:"table",name:void 0,parent_id:t.id,parent_table:"block",space_id:f,format:{table_properties:o.map((e=>({visible:!0,property:e===m?"title":e,width:r&&e in r?r[e].width:void 0})))},page_sort:c.map((e=>e.id)).slice(0,a.gq),alive:!0},I={table:p.n,id:v,spaceId:f};C.applyOperation({store:(0,R.Kv)(t,I),operation:{pointer:I,command:"set",path:[],args:k},transaction:n})}function je(e){var t;const{environment:n,collectionViewBlockStore:o,pageStores:a,transaction:l}=e,u=o.getCollectionViewSourceCollectionStore();if(!u)return;if(a.length>E.simpleTableTransformPageLimit||a.some((e=>e.hasContent())))return;const[p]=o.getCollectionViewStores(),m=u.getSchema(),f=(p.getFormat().table_properties||[]).filter((e=>e.visible&&e.property in m));if(!f)return;const h=o.getContentStore(),v=(0,c.ZP)();_.sW({store:o,data:{type:i.Ti.table,format:{table_block_column_order:f.map((e=>"title"===e.property?v:e.property)),table_block_column_format:(0,g.m8)(f.map((e=>["title"===e.property?v:e.property,{width:e.width}]))),table_block_column_header:!0}},transaction:l});const b=_.j4({environment:n,type:"table_row",properties:(0,g.m8)(f.map((e=>{const t=e.property,n=t in m?m[t]:void 0;return["title"===t?v:t,n?[[n.name]]:[]]}))),inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache,transaction:l,spaceId:o.pointer.spaceId,useCrdt:o.useCrdt()}),y=R.G.createChildStore(h,b.pointer);S.SH({parentStore:h,childStore:y,transaction:l});const w=(0,r.$z)(m),k=w.length>0?null===(t=u.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey():void 0;a.map(((e,t)=>{const n=R.G.createChildStore(h,e.pointer),a=e.getProperties(),c=w.reduce((function(e,t){const n=(0,r.wf)(k,s.ah(a[t]));return e[t]=[[n]],e}),{});_.sW({store:n,data:{type:i.Ti.tableRow,parent_id:o.id,parent_table:d.iU,properties:{...a,...c,title:void 0,[v]:a.title}},transaction:l}),S.jG({parentStore:h,childStore:n,transaction:l})})),_.sW({store:u,data:{alive:!1},transaction:l}),_.sW({store:p,data:{alive:!1},transaction:l})}function Ve(e){const{simpleTableStore:t,transaction:n}=e,o=t.getFormat(),i=!Boolean(o.table_block_column_header);b.FH({stores:[t],update:{table_block_column_header:i},transaction:n})}function Ue(e){const{simpleTableStore:t,transaction:n}=e,o=t.getFormat(),i=!Boolean(o.table_block_row_header);b.FH({stores:[t],update:{table_block_row_header:i},transaction:n})}function Oe(e,t,n){const o=j.Z.state;if(!o.isActive)return;const{selection:i,simpleTableStore:r}=o;if("row"===i.type){const e=r.getContentStores()[i.start.row];b.FH({stores:[e],update:{block_color:"default"===t?void 0:t},transaction:n})}if("column"===i.type){const e=E.getColumnOrder(r),o=E.getColumnFormat(r)||{};if(!e)return;const a=e[i.start.col];a in o?o[a].color=t:o[a]={color:t},b.FH({stores:[r],update:{table_block_column_format:o},transaction:n})}D.default.state.phase!==D.SelectionPhase.Selected||e.device.isMobile||w.ZH(e)}function Ne(e){const{simpleTableStore:t,parentWidth:n,transaction:o}=e,i=E.getColumnOrder(t);if(!i)return;const r=E.getColumnFormat(t),a=(n-18)/i.length,s=(0,g.m8)(i.map((e=>[e,{width:a,color:r&&r[e]?r[e].color:void 0}])));b.FH({stores:[t],update:{table_block_column_format:s},transaction:o})}},27534:(e,t,n)=>{n.r(t),n.d(t,{blockSelectionInSimpleTable:()=>x,cloneCellsForDragOverlay:()=>D,columnsHaveData:()=>L,getCellTextStore:()=>R,getColumnFormat:()=>I,getColumnOrder:()=>_,getHeadersEnabled:()=>C,getNextEditableStoreForSimpleTable:()=>N,getNumberOfColumns:()=>w,getNumberOfRows:()=>k,getNumberOfUnresolvedComments:()=>F,getPagesInCollectionForSimpleTableTransform:()=>U,getPreviousEditableStoreForSimpleTable:()=>O,getSimpleTableCellFromTextSelection:()=>A,getTableResizeState:()=>B,isColumnSelected:()=>T,isPropertyTypeConvertableToSimpleTable:()=>j,isRowSelected:()=>M,isSingleCellSelected:()=>P,renderCellValueForActivity:()=>E,rowsHaveData:()=>Z,simpleTableTransformPageLimit:()=>V});var o=n(8848),i=n(42875),r=n(29477),a=n(21202),s=n(23867),l=n(97880),c=n(54642),d=n(42239),u=n(60682),p=n(43250),m=n(14976),f=n(65598),g=n(89086),h=n(24646),v=n(35661),b=n(24666),y=n(84139),S=n(29574);function _(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_order}function w(e){var t;return(null===(t=_(e))||void 0===t?void 0:t.length)||0}function k(e){return e.getContentLength()}function I(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_format}function C(e){var t,n;return{headerColumn:null==e||null===(t=e.getFormat())||void 0===t?void 0:t.table_block_row_header,headerRow:null==e||null===(n=e.getFormat())||void 0===n?void 0:n.table_block_column_header}}function x(e){const t=["table","table_row"];return e.map((e=>e.getType())).some((e=>e&&t.includes(e)))}function T(e){const{selection:t,columnIndex:n,simpleTableStore:o}=e,i=t.start.col<=n&&n<=t.end.col;return"column"===t.type&&i&&0===t.start.row&&t.end.row===k(o)-1}function M(e){const{selection:t,rowIndex:n,simpleTableStore:o}=e,i=t.start.row<=n&&n<=t.end.row;return"row"===t.type&&i&&0===t.start.col&&t.end.col===w(o)-1}function P(e){return e.start.col===e.end.col&&e.start.row===e.end.row}function A(){const e="editing"===b.default.state.mode&&b.default.state.multiSelection;if(e)return y.Z.findCellFromTextStore(e.start.store)}function R(e){const{simpleTableStore:t,rowIndex:n,columnIndex:o}=e,i=t.getContentStores()[n];if(!i)return;const r=_(t);if(!r)return;const a=r[o];return a?i.getPropertyStore(a):void 0}function D(e){const{cells:t,type:n,theme:i}=e;return t.map((e=>function(e){const{cell:t,type:n,theme:i}=e;if(!t.getNode())return;const r=d.eN(t.getNode()),a=r.cloned.querySelector(`.${p.Apy}`),s=r.cloned.querySelector(`.${p.f0e}`);"column"===n?(a&&(a.style.left="calc(50% - 15px)",a.style.fill=o.ZP.white,a.style.background=i.simpleTableSelectionBorder),s&&(s.style.visibility="hidden")):(s&&(s.style.top="calc(50% - 15px)",s.style.left="-7px",s.style.fill=o.ZP.white,s.style.background=i.simpleTableSelectionBorder),a&&(a.style.visibility="hidden"));return{cloned:r.cloned,rect:DOMRect.fromRect(r.rect)}}({cell:e,type:n,theme:i}))).filter(l.$K)}function B(e,t){const n=S.Z.state;if(n.isActive&&n.simpleTableStore===e&&(!t||n.resize===t))return n}function E(e){const{environment:t,cellValue:n,spaceId:o,parentStore:i,theme:r}=e;return m.IY({environment:t,textValue:n?{value:n,spaceId:o}:void 0,parentStore:i,disableStyleAnnotations:!0,disableDateStyleAnnotations:!0,disableHover:!0,disabled:!0,theme:r,emojiType:(0,u.e_)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})}function F(e){const{simpleTableStore:t,environment:n,includeInline:o}=e;return f.Xp(t,{recursivelyLoadAllDiscussions:o,onlyIncludeBlockLevelDiscussions:(0,h.Sx)(n)})}function Z(e){const{simpleTableStore:t,lastN:n}=e,o=t.getContentStores(),i=_(t);if(!o||!i)return!1;for(let r=o.length-1;r>Math.max(o.length-1-n,0);r--){const e=o[r].getProperties();if(e&&i.some((t=>t in e&&e[t])))return!0}return!1}function L(e){const{simpleTableStore:t,lastN:n}=e,o=t.getContentStores(),i=_(t);if(!o||!i)return!1;const r=i.slice(-n);return o.some((e=>{const t=e.getProperties();return t&&r.some((e=>e in t&&t[e]))}))}const j={title:!0,text:!0,url:!0,email:!0,person:!0,number:!0,date:!0,phone_number:!0,select:!0,multi_select:!0,status:!0,auto_increment_id:!0,file:!1,checkbox:!1,relation:!1,rollup:!1,formula:!1,created_by:!1,created_time:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,button:!1,location:!1,verification:!1},V=200;async function U(e){const{environment:t,collectionViewBlockStore:n}=e,o=n.getCollectionViewSourceCollectionStore();if(!o)return[];const[l]=n.getCollectionViewStores(),d={source:{type:"collection",id:o.id,spaceId:(0,s.C)(o.pointer.spaceId)},collectionView:{id:l.id,spaceId:(0,s.C)(l.pointer.spaceId)},loader:{type:"reducer",reducers:{results:{type:"results",limit:V+1,loadContentCover:!1}},searchQuery:void 0,userId:t.currentUser.id,userTimeZone:(0,i.r)()}},u=c.queryCollection(t,d,void 0,{src:"simple_tbl_transform"}),p=await(0,r.OI)(1e4,[u]);if(!p.timeout){const{result:e}=p;if("success"===e.type){const t=e.data.result.reducerResults.results;return(t&&"results"===t.type?t.blockIds:[]).map((e=>v.G.createChildStore(o,{id:e,table:a.iU})))}}return[]}function O(e){let t;if(0===e.props.rowIndex){const n=R({simpleTableStore:e.props.simpleTableStore,rowIndex:0,columnIndex:0});n&&(t=(0,g.mK)(n))}else t=R({simpleTableStore:e.props.simpleTableStore,rowIndex:e.props.rowIndex-1,columnIndex:e.props.columnIndex});return t}function N(e){let t;const n=k(e.props.simpleTableStore);if(e.props.rowIndex===n-1){const o=w(e.props.simpleTableStore),i=R({simpleTableStore:e.props.simpleTableStore,rowIndex:n-1,columnIndex:o-1});i&&(t=(0,g.hn)(i))}else t=R({simpleTableStore:e.props.simpleTableStore,rowIndex:e.props.rowIndex+1,columnIndex:e.props.columnIndex});return t}},41662:(e,t,n)=>{n.d(t,{Wv:()=>at,fZ:()=>Ne,HM:()=>i,g$:()=>o});var o=n(27534),i=n(98794),r=n(45697),a=n.n(r),s=n(67294),l=n(83355),c=n(1302),d=n(12137),u=n(52989),p=n(61045),m=n(85854),f=n(68709),g=n(53336),h=n(79954),v=n(43250),b=n(78316),y=n(12534),S=n(38755),_=n(24646),w=n(34859),k=n(77794);var I=n(49085);class C extends I.default{getInitialState(){return{}}setTemporaryFormat(e){this.update((t=>({...t,temporaryFormat:e})))}updateColumnOrder(e){this.update((t=>({...t,temporaryFormat:{...t.temporaryFormat,table_block_column_order:e}})))}}const x=C;var T=n(64359),M=n(5676),P=n(63208),A=n(13991),R=n(480),D=n(86628),B=n(24405),E=n(8848),F=n(55631),Z=n(42853),L=n(77734),j=n(73599),V=n(82990),U=n(51454),O=n(5366),N=n(39699),z=n(13966),H=n(23063),W=n(64921),q=n(52275),G=n(31945),K=n(78140),$=n(32163),Q=n(72495),Y=n(24006),J=n(26388),X=n(28020),ee=n(87279),te=n(95802),ne=n(22294),oe=n(27724),ie=n(29574),re=n(85893);function ae(e){var t;window.__c={n:"ActionBarContent"};const{simpleTableStore:n,rootSizeObserver:o,offset:r,hoverSizeObserver:a,experimentalLayout:s}=e,l=(0,R.O7)(),c=(0,B.Fg)(),d=(0,D.VK)((()=>te.C.findScrollToSelectableFromStore(n)),[n]),u=null==d||null===(t=d.getNode())||void 0===t?void 0:t.getBoundingClientRect(),p=(0,D.VK)((()=>o.rect.state.width),[o]),m=(0,D.VK)((()=>a.rect.state.width),[a]),f=(0,D.VK)((()=>{const e=Math.min((null==u?void 0:u.width)||0,p,m)+r;if(s){const t=X.qQ(l);return Math.min(t-3*r,e)}return e}),[l,u,p,m,r,s]);return u?(0,re.jsx)("div",{style:{width:0,position:"absolute",left:f,zIndex:U.t8},onMouseDown:y.$0,children:(0,re.jsx)("div",{style:{position:"relative"},children:(0,re.jsxs)("div",{style:le(c),children:[(0,re.jsx)(J.Z,{placement:J.Z.Placement.Top,render:e=>(0,re.jsx)(W.Z,{...e,style:ce(c),onClick:()=>{N.createAndCommit({userAction:"SimpleTableActionBar.ActionBarContent",environment:l,perform:e=>{i.fitToPage({simpleTableStore:n,parentWidth:a.rect.state.width,transaction:e})}})},children:(0,F.n)({width:20,fill:c.regularIconColor})}),renderTooltip:()=>(0,re.jsx)(O.FormattedMessage,{defaultMessage:"Fit table to page width",id:"simpleTable.actionBar.fitToPage"})}),(0,re.jsx)(G.ZP,{popupType:G.Z4.Popup,originGap:4,renderOrigin:e=>(0,re.jsxs)(W.Z,{style:ce(c),...e,children:[(0,re.jsx)(O.FormattedMessage,{id:"simpleTable.actionBar.options",defaultMessage:"Options"}),(0,Z.i)({width:10,fill:c.mediumIconColor,marginLeft:4})]}),render:()=>(0,re.jsx)(se,{simpleTableStore:n})}),(0,re.jsx)(z.Z,{store:n,fadeIn:!1,style:{display:"flex",justifyContent:"center",alignSelf:"center",width:30,height:void 0,padding:"9px 8px"},iconStyle:{fill:c.regularTextColor}})]})})}):null}function se(e){window.__c={n:"OptionsMenu"};const{simpleTableStore:t}=e,n=(0,R.O7)(),r=(0,B.Fg)(),a=[{key:"header column",action:()=>{N.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:n,perform:e=>{i.toggleHeaderColumn({simpleTableStore:t,transaction:e})}})},render:e=>(0,re.jsx)(q.Z,{...e,icon:(0,L.s)({width:16,fill:r.regularIconColor}),title:(0,re.jsx)(O.FormattedMessage,{id:"SimpleTableActionBar.action.rowHeader.title",defaultMessage:"Header column"}),right:(0,re.jsx)(Y.Z,{on:o.getHeadersEnabled(t).headerColumn||!1,onClick:e.onClick})})},{key:"header row",action:()=>{N.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:n,perform:e=>{i.toggleHeaderRow({simpleTableStore:t,transaction:e})}})},render:e=>(0,re.jsx)(q.Z,{...e,icon:(0,j.f)({width:16,fill:r.regularIconColor}),title:(0,re.jsx)(O.FormattedMessage,{id:"action.columnHeader.title",defaultMessage:"Header row"}),right:(0,re.jsx)(Y.Z,{on:o.getHeadersEnabled(t).headerRow||!1,onClick:e.onClick})})}];return(0,re.jsx)(K.Z,{menuType:ee.og.Popup,width:240,maxHeight:n.device.isMobile?70:void 0,children:(0,re.jsx)($.Z,{type:$.i.Vertical,sections:[{key:"appearance section",render:e=>(0,re.jsx)(Q.Z,{...e}),items:a}],initialFocus:void 0})})}function le(e){return{position:"absolute",top:-40,right:0,borderRadius:3,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:V.Z.getCompositeFontFamily(A.SP).sans,background:e.popoverBackground,boxShadow:e.mediumBoxShadow}}function ce(e){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${E.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`}}const de=function(e){window.__c={n:"SimpleTableActionBar"};const{disabled:t,canEdit:n,simpleTableStore:o}=e,i=(0,D.VK)((()=>{const e=P.Z.state,t=T.Z.state,n=ie.Z.state,i=ne.Z.state,r=oe.default.state,a=e.isActive&&e.simpleTableStore===o,s=1===r.stores.length&&r.stores[0]===o,l=t.isActive&&t.simpleTableStore===o&&"cell"===t.hover.type&&t.hover.resizing,c=n.isActive&&n.simpleTableStore===o;return(a||s)&&!l&&!c&&!i.isKeyboardMode}),[o]);return t||!n?null:(0,re.jsx)(H.Z,{isVisible:i,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:h.Z.opacitySpringConfig},render:()=>(0,re.jsx)(ae,{...e})})};var ue=n(78429),pe=n(14871),me=n(80402),fe=n(97444),ge=n(98104),he=n(65187),ve=n(68056),be=n(77907),ye=n(24666),Se=n(84139),_e=n(6695),we=n(72126),ke=n(6685),Ie=n(89224);class Ce extends l.Z{constructor(){super(...arguments),this.simpleTableFormat=void 0,this.handleDragStart=e=>{const{simpleTableStore:t,columnID:n,getWidth:r}=this.props;e.preventDefault();const a=o.getColumnFormat(t);this.simpleTableFormat=a&&n in a?a[n]:{},this.simpleTableFormat.width=r(),i.setResizing(!0)},this.handleDragMove=e=>{const t=this.getNewFormat(e);t&&this.props.onTemporaryResize(t)},this.handleDragEnd=e=>{const t=this.getNewFormat(e);t&&this.props.onAccept(t),i.setResizing(!1)},this.handleDragCancel=()=>{this.props.onCancel(),this.simpleTableFormat=void 0,i.setResizing(!1)},this.handleDoubleClick=()=>{const e=Se.Z.findCellsInColumnFromStore(this.props.simpleTableStore,this.props.columnId),t=we.oA(e.map((e=>{var t;const n=null===(t=e.node)||void 0===t?void 0:t.querySelector(`.${v.Iiy}`);if(n)return this.calculateMaxTextWidth(n)})));N.createAndCommit({userAction:"SimpleTableColumnResizer.handleDoubleClick",environment:this.environment,perform:e=>{i.resizeColumn({tableBlockColumnFormat:{...this.getCurrentFormat().table_block_column_format,[this.props.columnId]:{width:Math.max(...t)}},simpleTableStore:this.props.simpleTableStore,transaction:e})}})},this.showResizeBar=this.createComputedStore((()=>{const{columnIndex:e,simpleTableStore:t}=this.props,n=T.Z.state;return!!n.isActive&&(n.simpleTableStore===t&&("cell"===n.hover.type&&(!this.isTableResizing.state&&(n.hover.x===e&&(n.hover.showResizer||n.hover.resizing)))))}),!0),this.isTableResizing=this.createComputedStore((()=>Boolean(o.getTableResizeState(this.props.simpleTableStore))),!0)}renderComponent(){return(0,re.jsx)("div",{style:this.getStyle(),onMouseMove:()=>i.showResizeBar(!0),onMouseLeave:()=>i.showResizeBar(!1),children:(0,re.jsx)(ke.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,re.jsx)("div",{style:this.getInnerStyle(),onDoubleClick:this.handleDoubleClick,...e})})})}getCurrentFormat(){const{format:e,formatStore:t}=this.props,{temporaryFormat:n}=t.state;return n||e}calculateMaxTextWidth(e){const t=window.getComputedStyle(e),n=e.cloneNode(!0),o=n;o.id="notion-table-cell-shadow",Array.from(t).forEach((e=>o.style.setProperty(e,t.getPropertyValue(e),t.getPropertyPriority(e)))),o.style.opacity="0",o.style.width="100%",o.style.pointerEvents="none",document.body.appendChild(n);const i=o.querySelector(`.${v.qnV}`);if(!i)return void o.remove();i.style.width="",i.style.display="inline-block";const r=window.document.createRange();r.selectNode(i);const a=Ie.getRect(r);return o.remove(),null!=a&&a.width?a.width+je:void 0}getNewFormat(e){if(this.simpleTableFormat&&this.simpleTableFormat.width){const t=Math.max(this.simpleTableFormat.width+e.diffX,_e.lw);return{...this.simpleTableFormat,width:t}}}getStyle(){return{position:"absolute",right:0,width:0,top:0,flexGrow:0,height:"100%",zIndex:1}}getInnerStyle(){return{position:"absolute",width:3,marginLeft:-1,marginTop:-1,height:"calc(100% + 2px)",transition:"background 150ms ease 50ms",cursor:this.isTableResizing.state?void 0:"col-resize",background:this.showResizeBar.state?this.theme.simpleTableSelectionBorder:E.ZP.blueWithAlpha(0)}}}Ce.displayName="SimpleTableColumnResizer";const xe=Ce;class Te extends l.Z{constructor(){super(...arguments),this.reorderState=this.createComputedStore((()=>{const e=M.Z.state;if(e.isActive&&e.simpleTableStore===this.props.simpleTableStore&&e.moved&&e.source.index!==e.destIndex)return{destIndex:e.destIndex,sourceIndex:e.source.index,type:e.source.type}}),!0)}renderComponent(){const{rowIndex:e,columnIndex:t}=this.props,n=this.reorderState.state;if(!n)return;const{destIndex:o,sourceIndex:i,type:r}=n;return"row"===r&&o===e?(0,re.jsx)("div",{style:this.getRowStyle(i,o)}):"column"===r&&o===t?(0,re.jsx)("div",{style:this.getColumnStyle(i,o)}):void 0}getSharedStyle(){return{position:"absolute",flexGrow:0,zIndex:2,background:this.theme.simpleTableSelectionBorder}}getRowStyle(e,t){return{...this.getSharedStyle(),top:e>t?0:void 0,bottom:e<t?0:void 0,left:-1,width:"calc(100% + 2px)",height:3}}getColumnStyle(e,t){return{...this.getSharedStyle(),top:-1,left:e>t?0:void 0,right:e<t?0:void 0,width:3,height:"calc(100% + 2px)"}}}Te.displayName="SimpleTableReorderDropZone";const Me=Te;var Pe=n(12217),Ae=n(97880),Re=n(6404),De=n(8949),Be=n(35431);class Ee extends Be.Z{findSelectorsOfTypeFromStore(e,t){return this.filter((n=>n.props.simpleTableStore===t&&n.props.type===e))}}const Fe=new Ee;class Ze extends l.Z{constructor(){super(...arguments),this.dragPosition=void 0,this.node=void 0,this.handleDragStart=e=>{var t;const{type:n}=this.props;e.preventDefault();const o=null===(t=this.node)||void 0===t?void 0:t.parentNode;if(!(o&&o instanceof Element))return;const r=o.getBoundingClientRect();this.dragPosition="column"===n?r.x:r.y;const a="column"===n?e.startX-r.x:e.startY-r.y;i.startReorder({...this.props,environment:this.environment,theme:this.theme,selectorStartPx:this.dragPosition,mouseOffsetPx:a})},this.handleDragMove=e=>{const{type:t}=this.props;if(!this.dragPosition)return;const n=M.Z.state;if(!n.isActive)return;const o="column"===t?e.diffX:e.diffY;if(0!==o){const e=this.dragPosition+o,t=this.getDestIndex({delta:o,selectorDragPx:e+n.source.mouseOffsetPx});i.continueReorder({destIndex:t,selectorDragPx:e})}},this.handleDragEnd=e=>{const{isMobile:t}=this.environment.device,{simpleTableStore:n,type:o,format:r}=this.props;N.createAndCommit({userAction:"SimpleTableRowColumnSelector.handleDragEnd",environment:this.environment,perform:a=>{i.completeReorder({event:e,environment:this.environment,simpleTableStore:n,transaction:a,format:r,type:o,onNoChange:t?void 0:this.handleDragNoChange})}}),this.clearDragState()},this.handleDragCancel=()=>{this.clearDragState()},this.clearDragState=()=>{this.dragPosition=void 0,i.cancelReorder()},this.handleDragNoChange=e=>{Re.Qn({environment:this.environment,stores:[this.props.simpleTableStore],left:e.startX,top:e.startY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"})},this.onSelectorClick=e=>{const{type:t,index:n,simpleTableStore:o}=this.props,{isMobile:r}=this.environment.device;De.Z.state.isActive||Re.Qn({environment:this.environment,stores:[this.props.simpleTableStore],left:e.clientX,top:e.clientY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"}),r&&("column"===t?i.selectColumn({environment:this.environment,index:n,simpleTableStore:o}):i.selectRow({environment:this.environment,index:n,simpleTableStore:o}))},this.handleMouseEnter=()=>{const{simpleTableStore:e,type:t,index:n}=this.props;i.hoverRowColumn({type:t,simpleTableStore:e,index:n})},this.handleMouseLeave=()=>{i.clearHover()},this.shouldShow=this.createComputedStore((()=>{const{isMobile:e}=this.environment.device;if(e)return this.shouldShowMobile();const{isKeyboardMode:t}=ne.Z.state;if(t)return!1;const{simpleTableStore:n,type:i,index:r}=this.props;if(M.Z.state.isActive)return!1;const a=T.Z.state;if(!a.isActive)return!1;if(a.simpleTableStore!==n)return!1;if(o.getTableResizeState(n))return!1;const s=oe.default.state;if(s.stores[0]===n&&s.phase===oe.SelectionPhase.Selected)return!1;const l=a.hover;return"cell"!==l.type?l.type===i&&l.index===r:"column"===i?l.x===r:"row"===i&&l.y===r}),!0),this.isDragging=this.createComputedStore((()=>M.Z.state.isActive),!0)}get registries(){return[Fe]}didMountOrUpdate(){this.node=this.getNode()}renderComponent(){const{isSelected:e}=this.props,t=e||this.shouldShow.state;return(0,re.jsx)(ke.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:t?this.handleDragStart:void 0,onDraggableDragMove:t?this.handleDragMove:void 0,onDraggableDragEnd:t?this.handleDragEnd:void 0,onDraggableDragCancel:t?this.handleDragCancel:void 0,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>this.renderButton(e)})}renderButton(e){const{type:t,isSelected:n}=this.props;return(0,re.jsx)(W.Z,{className:"column"===t?v.Apy:v.f0e,style:this.getStyle(),hoveredStyle:n?this.getSelectedStyle():{background:this.theme.whiteButtonHoveredBackground},pressedStyle:this.getSelectedStyle(!0),onClick:this.onSelectorClick,onTouchStart:this.handleMouseEnter,onTouchEnd:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,...e,disallowTabbing:!0,children:(0,Pe.D)({fill:n?E.ZP.white:void 0,width:14,height:14,transform:"column"===t?"rotate(90deg)":void 0})})}shouldShowMobile(){const e=P.Z.state;if(!e.isActive)return!1;const{simpleTableStore:t,type:n,index:i}=this.props;if(e.simpleTableStore!==t)return!1;const{selection:r}=e;if(o.isSingleCellSelected(r)){if("column"===n)return r.start.col===i;if("row"===n)return r.start.row===i}return!1}getDestIndex(e){const{delta:t,selectorDragPx:n}=e,{simpleTableStore:o,type:i}=this.props,r=Fe.findSelectorsOfTypeFromStore(i,o);if(t>0){const e=r.map((e=>{var t;const n=null===(t=e.node)||void 0===t?void 0:t.parentNode;if(!(n&&n instanceof Element))return;const o=n.getBoundingClientRect();return"column"===i?null==o?void 0:o.x:null==o?void 0:o.y})).filter(Ae.$K);e.sort(((e,t)=>e-t));for(let t=e.length-1;t>=0;t--)if(n>e[t])return t;return 0}const a=r.map((e=>{var t;const n=null===(t=e.node)||void 0===t?void 0:t.parentNode;if(!(n&&n instanceof Element))return;const o=n.getBoundingClientRect();return"column"===i?o.x+o.width:o.y+o.height})).filter(Ae.$K);return a.sort(((e,t)=>e-t)),a.filter(Ae.$K).findIndex((e=>n<e))}getStyle(){const{type:e,isSelected:t}=this.props,n=t||this.shouldShow.state,o={opacity:n?1:0,pointerEvents:n?void 0:"none",transition:"opacity 150ms ease",fill:this.theme.lightIconColor,position:"absolute",display:"flex",alignItems:"center",cursor:this.isDragging.state?"grab":"pointer",justifyContent:"center",borderRadius:4,background:this.theme.whiteButtonBackground,boxShadow:t?void 0:this.theme.lightBoxShadow,zIndex:4};return"column"===e?{...o,...this.getSelectedStyle(),top:-8,left:"calc(50% - 13px)",height:16,width:26,padding:"2px 4px"}:{...o,...this.getSelectedStyle(),top:"calc(50% - 13px)",left:-8,width:16,height:26,padding:"4px 2px"}}getSelectedStyle(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{isSelected:t}=this.props;return t||e?{background:this.theme.simpleTableSelectionBorder}:void 0}}Ze.displayName="SimpleTableRowColumnSelector";const Le=Ze,je=1;class Ve extends l.Z{constructor(){super(...arguments),this.node=void 0,this.editor=null,this.handleCellClick=e=>{const{columnIndex:t,simpleTableStore:n,rowIndex:o,disabled:r,canEdit:a}=this.props;r||(0,y.ZP)({event:e,context:y.Af.EditorClick,callback:()=>{a&&e.shiftKey?i.expandCellSelection({environment:this.environment,rowIndex:o,columnIndex:t,simpleTableStore:n}):a?i.selectCellAndSetCursor({environment:this.environment,rowIndex:o,columnIndex:t,simpleTableStore:n}):i.selectCell({environment:this.environment,rowIndex:o,columnIndex:t,simpleTableStore:n})}})},this.handleContextMenuClick=e=>{const{columnIndex:t,simpleTableStore:n,rowIndex:o,disabled:r}=this.props;r||(0,y.ZP)({event:e,context:y.Af.EditorContextMenu,callback:()=>{i.selectCell({environment:this.environment,rowIndex:o,columnIndex:t,simpleTableStore:n})}})},this.handleTextClick=e=>{const{rowIndex:t,columnIndex:n,simpleTableStore:o,disabled:r,canEdit:a}=this.props;r||a&&e.shiftKey&&i.expandCellSelection({environment:this.environment,rowIndex:t,columnIndex:n,simpleTableStore:o})},this.handleMouseEnter=()=>{const{rowIndex:e,columnIndex:t,simpleTableStore:n,disabled:o}=this.props;o||i.hoverCell({x:t,y:e,simpleTableStore:n})},this.handleMouseLeave=()=>{this.props.disabled||i.clearHover()},this.handleTemporaryColumnResize=e=>{const{formatStore:t}=this.props;t.setTemporaryFormat(this.getNewFormat(e))},this.handleColumnResizeAccept=e=>{const{simpleTableStore:t,formatStore:n}=this.props,o=this.getCurrentFormat().table_block_column_format;N.createAndCommit({userAction:"SimpleTableCell.handleColumnResizeAccept",environment:this.environment,perform:e=>{i.resizeColumn({tableBlockColumnFormat:o||{},simpleTableStore:t,transaction:e})}}),n.setTemporaryFormat(void 0)},this.handleTemporaryColumnResizeCancel=()=>{const{formatStore:e}=this.props;e.setTemporaryFormat(void 0)},this.handleEnter=e=>{if(e.preventDefault(),this.editor&&this.editor.isComposing())return;"editing"===ye.default.state.mode&&i.handleUpDownKey({environment:this.environment,direction:"down",bypassExistingTextSelection:!0})},this.handleTab=e=>{e.preventDefault(),i.handleLeftRightKey({environment:this.environment,direction:"right",bypassExistingTextSelection:!0})},this.handleUntab=e=>{e.preventDefault(),i.handleLeftRightKey({environment:this.environment,direction:"left",bypassExistingTextSelection:!0})},this.handleEsc=e=>{this.props.disabled||(e.preventDefault(),ge.ZH(this.environment))},this.handleCut=e=>{const{disabled:t,canEdit:n}=this.props;if(t||!n)return;this.handleCopy(e);const o="editing"===ye.default.state.mode&&ye.default.state.multiSelection,r=this.environment;o&&!(0,ve.iG)(o)?N.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:r,perform:e=>{fe.pz({environment:r,multiSelection:o,transaction:e})}}):N.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:r,perform:e=>{i.clearSelectedCell({environment:r,transaction:e})}})},this.handleCopy=e=>{const{markdownLinkifyIt:t,exportJsxRenderer:n}=this.props,i=P.Z.state;if(!i.isActive)return;const{selection:r,simpleTableStore:a}=i,s=o.getColumnOrder(a);if(!s)return;pe.JG({environment:this.environment,event:e,markdownLinkifyIt:t});const l="editing"===ye.default.state.mode&&ye.default.state.multiSelection;l&&!(0,ve.iG)(l)||me.qn({environment:this.environment,simpleTableStore:a,selection:r,currentRows:a.getContentStores(),columnOrder:s,event:e,exportJsxRenderer:n})},this.isInDragSource=this.createComputedStore((()=>{const{store:e,columnID:t,simpleTableStore:n}=this.props;if(!e)return!1;const o=M.Z.state;if(!o.isActive||o.simpleTableStore!==n||!o.moved)return!1;const{type:i,id:r}=o.source;return"column"===i?r===t:r===e.id}),!0)}get registries(){return[Se.Z]}didMountOrUpdate(){this.node=this.getNode()}renderComponent(){const{columnID:e,columnIndex:t,simpleTableStore:n,rowIndex:o,textStore:i,store:r,format:a,disabled:s,canEdit:l,legacyTransclusionParent:c}=this.props,{device:d}=this.environment,u=!s&&l,p=(0,re.jsxs)(re.Fragment,{children:[this.isInDragSource.state&&(0,re.jsx)("div",{style:{width:"100%",height:"100%",...this.getColorStyle()}}),(0,re.jsxs)("div",{className:v.Iiy,style:{visibility:this.isInDragSource.state?"hidden":void 0},children:[r&&0===o&&u&&(0,re.jsx)(Le,{index:t,type:"column",simpleTableStore:n,isSelected:this.isColumnSelected(),id:e,format:a,rowStore:r}),r&&0===t&&u&&(0,re.jsx)(Le,{index:o,type:"row",simpleTableStore:n,isSelected:this.isRowSelected(),id:r.id,format:a,rowStore:r}),i?(0,re.jsx)(he.Z,{ref:e=>{this.editor=e},disabled:s,store:i,disableSlashCommands:!0,onClick:this.handleTextClick,onEnter:this.handleEnter,onTab:this.handleTab,onUntab:this.handleUntab,onEsc:this.handleEsc,onCut:this.handleCut,onCopy:this.handleCopy,style:this.getTextStyle(),pasteBehavior:"inline",className:v.qnV,disableDrag:!0,legacyTransclusionParent:c}):(0,re.jsx)("div",{style:this.getTextStyle(),children:" "}),!d.isMobile&&u&&(0,re.jsx)(xe,{format:this.props.format,formatStore:this.props.formatStore,columnId:this.getColumnID(),columnIndex:t,columnID:e,simpleTableStore:n,getWidth:()=>{var e;return(null===(e=this.node)||void 0===e?void 0:e.getBoundingClientRect().width)||0},onTemporaryResize:this.handleTemporaryColumnResize,onAccept:this.handleColumnResizeAccept,onCancel:this.handleTemporaryColumnResizeCancel}),!d.isMobile&&u&&(0,re.jsx)(Me,{simpleTableStore:n,rowIndex:o,columnIndex:t})]})]}),m={style:this.getStyle(),onClick:this.handleCellClick,onContextMenu:this.handleContextMenuClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},{headerColumn:f,headerRow:g}=this.getHeadersEnabled();return g&&0===o?(0,re.jsx)("th",{scope:"col",...m,children:p}):f&&0===t?(0,re.jsx)("th",{scope:"row",...m,children:p}):(0,re.jsx)("td",{...m,children:p})}getColumnID(){return this.props.columnID}isColumnSelected(){const{columnIndex:e,simpleTableStore:t,selection:n}=this.props;return!!n&&o.isColumnSelected({selection:n,columnIndex:e,simpleTableStore:t})}isRowSelected(){const{rowIndex:e,simpleTableStore:t,selection:n}=this.props;return!!n&&o.isRowSelected({selection:n,rowIndex:e,simpleTableStore:t})}getCurrentFormat(){const{format:e}=this.props,{temporaryFormat:t}=this.props.formatStore.state;return t||e}getNewFormat(e){const{columnID:t}=this.props,n={[t]:e},o=this.getCurrentFormat();return{...o,table_block_column_format:{...o.table_block_column_format,...n}}}getHeadersEnabled(){const{simpleTableStore:e}=this.props;return o.getHeadersEnabled(e)}getColorStyle(){var e;const{simpleTableStore:t,rowIndex:n,columnIndex:i,columnID:r}=this.props,{headerColumn:a,headerRow:s}=this.getHeadersEnabled();let l=(null===(e=this.props.store)||void 0===e?void 0:e.getFormat().block_color)||"default";const c=o.getColumnFormat(t);if(c&&r in c){var d;const e=null===(d=c[r])||void 0===d?void 0:d.color;e&&(l=e)}return 0===n&&s||0===i&&a?"default"!==l?{...(0,E.fi)(l,this.theme),fontWeight:V.Z.fontWeight.medium}:{background:this.theme.tableHeaderRowColumnBackground,fontWeight:V.Z.fontWeight.medium}:(0,E.fi)(l,this.theme)}getStyle(){return{...this.getColorStyle(),border:`${je}px solid ${this.theme.tableDividerColor}`,position:"relative",verticalAlign:"top",textAlign:"start",...this.getWidths(),minHeight:32}}getWidths(){var e;const{columnID:t}=this.props,n=this.getCurrentFormat().table_block_column_format;return n&&null!==(e=n[t])&&void 0!==e&&e.width?{minWidth:n[t].width,maxWidth:n[t].width}:{minWidth:120,maxWidth:240}}getTextStyle(){return{padding:"7px 9px",backgroundColor:"transparent",fontSize:14,lineHeight:"20px"}}}function Ue(e){window.__c={n:"SimpleTableCellWithDeps"};const{value:t}=(0,be.useDependency)(be.deps.exportJsxRenderer),{value:n}=(0,be.useDependency)(be.deps.markdownLinkifyIt),{value:o}=(0,be.useDependency)(be.deps.tinyMceMicrosoftWordPasteFilter);return(0,re.jsx)(Ve,{...e,exportJsxRenderer:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}Ve.displayName="SimpleTableCell";class Oe extends m.Z{constructor(){super(...arguments),this.isLegacyTransclusionStore=this.createComputedStore((()=>Boolean(this.props.rowStore)&&this.props.rowStore.getParentId()!==this.props.store.id)),this.styleStore=this.createComputedStore((()=>(0,ue.H)()&&this.isLegacyTransclusionStore.state?{border:"3px dashed deeppink"}:{}))}renderPersisted(){const{columnOrder:e,store:t,rowIndex:n,rowStore:o,selection:i,formatStore:r,disabled:a}=this.props;return e?(0,re.jsx)("tr",{className:v.M_0,style:this.styleStore.state,children:e.map(((e,s)=>(0,re.jsx)(Ue,{disabled:a,canEdit:this.canEdit(),columnID:e,columnIndex:s,rowIndex:n,store:o,simpleTableStore:t,selection:i,formatStore:r,format:t.getFormat(),textStore:null==o?void 0:o.getPropertyStore(e),legacyTransclusionParent:this.isLegacyTransclusionStore.state?this.props.store:void 0},e)))}):null}}const Ne=Oe;var ze=n(8958),He=n(40150),We=n(55367),qe=n(24677),Ge=n(3386),Ke=n(52689);function $e(e){window.__c={n:"SimpleTableKeyboardArea"};const{store:t,children:n,selection:r,disabled:a,canEdit:l}=e,c=(0,R.O7)(),d=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),i.handleLeftRightKey({environment:c,direction:"left",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),u=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),i.handleLeftRightKey({environment:c,direction:"right",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),p=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),i.handleUpDownKey({environment:c,direction:"up",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),m=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),i.handleUpDownKey({environment:c,direction:"down",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),f=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault();const t=P.Z.state;if(t.isActive){const{selection:e,simpleTableStore:n}=t;o.isSingleCellSelected(e)&&i.selectCellAndSetCursor({environment:c,rowIndex:e.start.row,columnIndex:e.start.col,simpleTableStore:n})}}),[c]),g=(0,s.useCallback)((e=>{var t;null===(t=e.preventDefault)||void 0===t||t.call(e);const n=P.Z.state;if(!n.isActive)return;const{selection:r,simpleTableStore:a}=n;o.isSingleCellSelected(r)&&r.end.row===o.getNumberOfRows(a)-1&&N.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleShiftEnter",environment:c,perform:e=>{const t=r.end.row+1;i.insertRow({environment:c,transaction:e,index:t,simpleTableStore:a}),i.selectCellAndSetCursor({environment:c,rowIndex:t,columnIndex:r.start.col,simpleTableStore:a})}})}),[c]),h=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault();const n=P.Z.state;if(!n.isActive)return;const{selection:r,simpleTableStore:a}=n;o.getSimpleTableCellFromTextSelection()?ge.ZH(c):o.isSingleCellSelected(r)?i.selectRow({environment:c,index:r.start.row,simpleTableStore:a}):(i.clearSelection(),qe.Z5({environment:c,stores:[t]}))}),[c,t]),v=(0,s.useCallback)((e=>{N.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDelete",environment:c,perform:e=>{i.handleDelete({environment:c,transaction:e})}})}),[c]),b=(0,s.useCallback)((e=>{!e.key||e.metaKey||e.ctrlKey||(ne.Z.setKeyboardMode(!0),N.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleKeypress",environment:c,perform:t=>{i.handleKeypress({environment:c,transaction:t,key:e.key})}}))}),[c]),{value:y}=(0,be.useDependency)(be.deps.exportJsxRenderer),S=(0,s.useCallback)((e=>{const t=P.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:i}=t,r=o.getColumnOrder(i);r&&me.qn({environment:c,simpleTableStore:i,selection:n,currentRows:i.getContentStores(),columnOrder:r,event:e,exportJsxRenderer:y})}),[c,y]),_=(0,s.useCallback)((e=>{!a&&l&&(S(e),N.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleCut",environment:c,perform:e=>{i.clearSelectionContents({environment:c,transaction:e})}}))}),[c,a,l,S]),{value:w}=(0,be.useDependency)(be.deps.markdownLinkifyIt),{value:k}=(0,be.useDependency)(be.deps.tinyMceMicrosoftWordPasteFilter),I=(0,s.useCallback)((e=>{if(a||!l)return;const t=P.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:i}=t,r=o.getColumnOrder(i);r&&N.createAndCommit({userAction:"SimpleTableSelectionOverlay.handlePaste",environment:c,perform:t=>{me.j0({environment:c,simpleTableStore:i,selection:n,currentRows:i.getContentStores(),columnOrder:r,event:e,transaction:t,markdownLinkifyIt:w,tinyMceMicrosoftWordPasteFilter:k})}})}),[c,a,l,w,k]),C=(0,s.useCallback)((e=>{e.preventDefault(),N.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDuplicate",environment:c,perform:e=>{i.handleDuplicate({environment:c,transaction:e})}})}),[c]),x=(0,s.useCallback)(((e,n)=>{!a&&l&&(n.preventDefault(),N.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleAnnotation",environment:c,perform:n=>{i.annotateSimpleTableSelection({environment:c,simpleTableStore:t,annotation:e,transaction:n})}}))}),[c,a,l,t]),T=(0,s.useCallback)((e=>x(["h",Ke.Z.state.color],e)),[x]),M=(0,s.useCallback)((e=>x(["b"],e)),[x]),A=(0,s.useCallback)((e=>x(["i"],e)),[x]),D=(0,s.useCallback)((e=>x(["s"],e)),[x]),B=(0,s.useCallback)((e=>x(["_"],e)),[x]),E=(0,s.useCallback)((e=>x(["c"],e)),[x]);return(0,re.jsx)(Ge.Z,{capture:Boolean(r)&&!a&&l,onLeft:d,onRight:u,onUntab:d,onTab:u,onUp:p,onDown:m,onEnter:f,onShiftEnter:g,onEsc:h,onDelete:v,onBackspace:v,onKeypress:b,onCut:_,onCopy:S,onPaste:I,onDuplicate:C,onToggleHighlight:T,onToggleBold:M,onToggleItalics:A,onToggleStrike:D,onToggleUnderline:B,onToggleCode:E,children:n})}var Qe=n(6740),Ye=n(47453),Je=n(71644);const Xe=(0,O.defineMessages)({tooltipContent:{id:"simpleTable.resizer.dimensions",defaultMessage:"{num_columns} × {num_rows}"}});class et extends l.Z{constructor(){super(...arguments),this.tooltipOrigin=s.createRef(),this.storeTypes={focusStore:I.default.createClass(!1)},this.renderTooltip=()=>{const{store:e,intl:t,type:n}=this.props;if(!this.isResizing.state){const e=this.theme.regularInvertedTextColor,t=t=>(0,re.jsx)("b",{style:{color:e},children:t});return(0,re.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",color:this.theme.mediumInvertedTextColor},children:[(0,re.jsxs)("div",{children:["row"===n&&(0,re.jsx)(O.FormattedMessage,{id:"simpleTable.resizer.tooltipRow",defaultMessage:"<b>Click</b> to add a new row",values:{b:t}}),"column"===n&&(0,re.jsx)(O.FormattedMessage,{id:"simpleTable.resizer.tooltipColumn",defaultMessage:"<b>Click</b> to add a new column",values:{b:t}}),"corner"===n&&(0,re.jsx)(O.FormattedMessage,{id:"simpleTable.resizer.tooltipCorner",defaultMessage:"<b>Click</b> to add a new row and column",values:{b:t}})]}),(0,re.jsxs)("div",{children:["row"===n&&(0,re.jsx)(O.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleRow",defaultMessage:"<b>Drag</b> to quickly add or remove rows",values:{b:t}}),"column"===n&&(0,re.jsx)(O.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleColumn",defaultMessage:"<b>Drag</b> to quickly add or remove columns",values:{b:t}}),"corner"===n&&(0,re.jsx)(O.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleCorner",defaultMessage:"<b>Drag</b> to quickly add or remove rows and columns",values:{b:t}})]})]})}const i=this.columnOrder.state||[],r=o.getNumberOfRows(e),a=this.numTempRows.state,s=t.formatMessage(Xe.tooltipContent,{num_columns:i.length,num_rows:r+a});return(0,re.jsx)("div",{children:s})},this.handleResizeClick=()=>{const{store:e,type:t}=this.props;N.createAndCommit({userAction:"SimpleTableResizer.handleResizeClick",environment:this.environment,perform:n=>{"row"!==t&&i.extendColumns({count:1,simpleTableStore:e,transaction:n}),"column"!==t&&i.extendRows({environment:this.environment,count:1,simpleTableStore:e,transaction:n})}})},this.handleDragStart=e=>{var t;e.preventDefault();const{formatStore:n,store:o,type:i}=this.props,r=null===(t=this.tooltipOrigin.current)||void 0===t?void 0:t.getBoundingClientRect();ie.Z.setState({isActive:!0,simpleTableStore:o,resize:i,rowsDelta:0,columnsDelta:0,tooltipOriginRect:r}),n.setTemporaryFormat(o.getFormat())},this.handleDragMove=e=>{var t;const{store:n,type:r,formatStore:a}=this.props,s=o.getTableResizeState(n,r);if(!s)return;const l=null===(t=this.tooltipOrigin.current)||void 0===t?void 0:t.getBoundingClientRect();if("row"!==r){const t=e.diffX>0?Math.ceil((e.diffX-30)/120):Math.floor((e.diffX+30)/120);if(t<0&&o.columnsHaveData({simpleTableStore:n,lastN:Math.abs(t)}))return;ie.Z.setState({...s,columnsDelta:t,tooltipOriginRect:l});const r=this.getNewColumnOrder(t);a.updateColumnOrder(r),i.updateRowSelectionOnResize(r.length-1)}if("column"!==r){const t=e.diffY>0?Math.ceil((e.diffY-8)/32):Math.max(-(o.getNumberOfRows(n)-1),Math.floor((e.diffY+8)/32));if(t<0&&o.rowsHaveData({simpleTableStore:n,lastN:Math.abs(t)}))return;ie.Z.setState({...s,rowsDelta:t,tooltipOriginRect:l}),i.updateColumnSelectionOnResize(o.getNumberOfRows(n)+t-1)}},this.handleDragEnd=e=>{const{store:t,type:n}=this.props,r=this.columnOrder.state,a=this.numTempRows.state,s=o.getNumberOfColumns(t);N.createAndCommit({userAction:"SimpleTableResizer.handleDragEnd",environment:this.environment,perform:e=>{"row"!==n&&r&&(r.length>s?i.extendColumns({count:r.length-s,simpleTableStore:t,transaction:e}):r.length<s&&i.contractColumns({simpleTableStore:t,columnOrder:r,transaction:e})),"column"!==n&&(a>0?i.extendRows({environment:this.environment,count:a,simpleTableStore:t,transaction:e}):a<0&&i.contractRows({numRowsToDelete:Math.abs(a),simpleTableStore:t,transaction:e}))}}),this.clearResizeState()},this.handleDragCancel=()=>{this.clearResizeState()},this.handleMouseEnter=()=>{const{store:e,type:t}=this.props;i.hoverResizer({simpleTableStore:e,resizer:t})},this.handleMouseLeave=()=>{i.clearHover()},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,Qe.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=()=>{this.stores.focusStore.setState(!1)},this.isResizing=this.createComputedStore((()=>{const{store:e,type:t}=this.props;return Boolean(o.getTableResizeState(e,t))}),!0),this.tooltipOriginRect=this.createComputedStore((()=>{const{store:e,type:t}=this.props,n=o.getTableResizeState(e,t);return null==n?void 0:n.tooltipOriginRect}),!0),this.columnOrder=this.createComputedStore((()=>{const{store:e,formatStore:t}=this.props,n=e.getFormat(),{temporaryFormat:o}=t.state;return(o||n).table_block_column_order})),this.numTempRows=this.createComputedStore((()=>{const e=o.getTableResizeState(this.props.store);return e?e.rowsDelta:0})),this.isVisible=this.createComputedStore((()=>{const{type:e,store:t}=this.props,n=T.Z.state,i=o.getTableResizeState(t,e),r=this.stores.focusStore.state;return!ne.Z.state.isKeyboardMode&&(this.isHoverVisible(n)||Boolean(i))||r}),!0)}renderComponent(){return(0,re.jsx)("div",{style:this.getOuterStyle(),onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,ref:this.tooltipOrigin,children:(0,re.jsx)(ke.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,re.jsx)("div",{style:this.getInnerStyle(),...e,children:(0,re.jsx)(J.Z,{renderTooltip:this.renderTooltip,placement:J.Z.Placement.Bottom,delayThreshold:0,originRect:this.tooltipOriginRect.state,forceVisibleState:!0===this.isResizing.state||void 0,render:e=>(0,re.jsx)(W.Z,{onClick:this.handleResizeClick,style:this.getButtonStyle(!0),hoveredStyle:this.getButtonStyle(!0),...e,children:(0,re.jsx)("div",{style:this.getStyle(),children:(0,Ye.R)({width:12,height:12,fill:this.isResizing.state?E.ZP.white:this.theme.mediumIconColor,padding:"auto"})})})})})})})}clearResizeState(){this.props.formatStore.reset(),ie.Z.reset()}getNewColumnOrder(e){const{store:t}=this.props,n=this.columnOrder.state||[],i=o.getColumnOrder(t)||[];if(e>0){const t=e-(n.length-i.length);if(t>0){const e=[...Array(t).keys()].map((e=>(0,Je.ZP)()));return[...n,...e]}return n.slice(0,n.length+t)}return i.slice(0,Math.max(1,i.length-Math.abs(e)))}isHoverVisible(e){const{type:t,store:n}=this.props;if(!e.isActive||e.simpleTableStore!==n)return!1;const{hover:i}=e;if("cell"===i.type){const e=i.y===o.getNumberOfRows(n)-1,r=i.x===o.getNumberOfColumns(n)-1;return"row"===t?e:("column"===t||e)&&r}return"resizer"===i.type&&i.resizer===t}getOuterStyle(){const{type:e}=this.props,t={position:"absolute",display:"flex"};return"row"===e?{...t,flexDirection:"row",bottom:-18,left:0,right:0}:"column"===e?{...t,right:-18,top:0,bottom:0}:{...t,bottom:-18,right:-18}}getInnerStyle(){const{type:e}=this.props,t=this.isVisible.state;return{display:"flex",flexDirection:"row"===e?"row":void 0,width:"100%",height:"100%",opacity:t?1:0,pointerEvents:t?void 0:"none",transition:"opacity 150ms ease 50ms"}}getButtonStyle(e){const{type:t}=this.props,n=e?16:20,o="100%";return"column"===t?{flex:1,width:n,height:o,cursor:"col-resize",borderRadius:3,overflow:"hidden"}:"row"===t?{flex:1,width:o,height:n,cursor:"row-resize",borderRadius:3,overflow:"hidden"}:{flex:1,width:n,height:n,cursor:"nwse-resize",borderRadius:"50%",overflow:"hidden"}}getStyle(){return{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:this.isResizing.state?this.theme.simpleTableSelectionBorder:this.theme.lightDividerColor}}}et.displayName="SimpleTableResizer";const tt=(0,O.injectIntl)(et);function nt(e){window.__c={n:"SimpleTableSelectionDragHandle"};const{position:t,onDraggableDragStart:n,onDraggableDragMove:o,onDraggableDragEnd:i,onDraggableDragCancel:r}=e,a=(0,R.Fy)().isMobile?26:9,s=(0,B.yK)((e=>({tapArea:{position:"absolute",top:"top-left"===t?-a/2:void 0,left:"top-left"===t?-a/2:void 0,bottom:"bottom-right"===t?-a/2:void 0,right:"bottom-right"===t?-a/2:void 0,width:a,height:a,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",pointerEvents:"auto",cursor:"nwse-resize",zIndex:10},dragHandle:{width:9,height:9,border:`2px solid ${E.ZP.blueWithAlpha(.57)}`,background:e.contentBackground,borderRadius:"50%"}})),[t,a]);return(0,re.jsx)(ke.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:n,onDraggableDragMove:o,onDraggableDragEnd:i,onDraggableDragCancel:r,render:e=>(0,re.jsx)("div",{...e,style:s.tapArea,children:(0,re.jsx)("div",{style:s.dragHandle})})})}class ot extends l.Z{constructor(){super(...arguments),this.tableElement=null,this.observer=void 0,this.handleObserverChange=()=>{var e,t;null===(e=this.selectionStartRectStore)||void 0===e||e.enqueueRecompute(),null===(t=this.selectionEndRectStore)||void 0===t||t.enqueueRecompute()},this.dragSelectAnchor=void 0,this.handleDragStart=e=>{this.props.canEdit&&(e.shiftKey&&this.props.selection?this.dragSelectAnchor=this.props.selection.start:this.dragSelectAnchor=this.getClosestTableCellPosition(e.startX,e.startY))},this.handleDragMove=e=>{if(!this.props.canEdit||!this.dragSelectAnchor)return;const t=this.dragSelectAnchor,n=this.getClosestTableCellPosition(e.currentX,e.currentY);(0,He.bp)(t,n)?i.selectCell({environment:this.environment,rowIndex:t.row,columnIndex:t.col,simpleTableStore:this.props.store}):i.selectMultiCell({environment:this.environment,start:t,end:n,simpleTableStore:this.props.store})},this.dragHandleSelectAnchor=void 0,this.handleTopLeftDragHandleDragStart=()=>this.handleDragHandleDragStart("top-left"),this.handleBottomRightDragHandleDragStart=()=>this.handleDragHandleDragStart("bottom-right"),this.handleDragHandleDragMove=e=>{if(!this.dragHandleSelectAnchor)return;const t=this.getClosestTableCellPosition(e.currentX,e.currentY);i.selectMultiCell({environment:this.environment,start:this.dragHandleSelectAnchor,end:t,simpleTableStore:this.props.store})},this.selectionStartRectStore=this.createComputedStore((()=>{const{selection:e}=this.props;if(e)return this.getCellRect(e.start)}),!0),this.selectionEndRectStore=this.createComputedStore((()=>{const{selection:e}=this.props;if(e)return this.getCellRect(e.end)}),!0),this.canShowTableResizers=this.createComputedStore((()=>{const{disabled:e,canEdit:t}=this.props,{device:n}=this.environment;return!(e||!t||n.isMobile)&&!(We.ZP.state.isDragging||this.isColumnResizing()||this.isReordering())}),!0),this.isColumnResizing=()=>{const{store:e}=this.props,t=T.Z.state;return!!t.isActive&&(t.simpleTableStore===e&&("cell"===t.hover.type&&t.hover.resizing))},this.isReordering=()=>{const{store:e}=this.props,t=M.Z.state;return t.isActive&&t.simpleTableStore===e},this.dragState=this.createComputedStore((()=>{const e=M.Z.state;if(!e.isActive)return;if(e.simpleTableStore!==this.props.store)return;if(!this.tableElement)return;const{source:t,selectorDragPx:n,moved:o}=e;if(t.selectorStartPx===n&&!o)return;if(!t.draggedCells[0])return;const i=t.draggedCells[0].rect,r=this.tableElement.getBoundingClientRect(),a="column"===t.type?0:(0,d.Z)(n-r.top,-8,r.height-32);return{left:"column"===t.type?(0,d.Z)(n-r.left,-i.width/3,r.width-2/3*i.width):0,top:a,draggedCells:t.draggedCells,type:t.type}}),!0)}renderComponent(){const{children:e,store:t,selection:n,formatStore:o,disabled:i,canEdit:r}=this.props,a=this.canShowTableResizers.state;return(0,re.jsx)($e,{store:t,selection:n,disabled:i,canEdit:r,children:(0,re.jsx)(ke.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,render:i=>(0,re.jsxs)("div",{style:{position:n||a?"relative":void 0},...i,children:[e,this.shouldRenderOverlay()&&(0,re.jsxs)("div",{style:{position:"absolute",top:0,left:0,pointerEvents:"none"},children:[this.renderDragOverlay(),this.renderSelectionOverlay()]}),a&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(tt,{store:t,type:"column",formatStore:o},"column"),(0,re.jsx)(tt,{store:t,type:"row",formatStore:o},"row"),(0,re.jsx)(tt,{store:t,type:"corner",formatStore:o},"corner")]})]})})})}shouldRenderOverlay(){const e=this.selectionStartRectStore.state,t=this.selectionEndRectStore.state,n=this.dragState.state;return!this.props.disabled&&(e&&t||n)}renderSelectionOverlay(){const e=this.selectionStartRectStore.state,t=this.selectionEndRectStore.state;if(!e||!t)return;const n=Math.min(e.left,t.left),o=Math.min(e.top,t.top),i=Math.max(e.right,t.right),r=Math.max(e.top+e.height,t.top+t.height),a=this.dragState.state,s={position:"absolute",left:a&&"column"===a.type?a.left:n+1.5,top:a&&"row"===a.type?a.top:o+1.5,width:i-n-3,height:r-o-3};return(0,re.jsxs)("div",{className:v.y4j,children:[(0,re.jsx)("div",{style:{...s,zIndex:a?4:2,backgroundColor:a?this.theme.contentBackground:void 0,opacity:a?.9:void 0,boxShadow:a?this.theme.mediumBoxShadow:void 0,borderRadius:2}}),(0,re.jsx)("div",{style:{...s,border:`solid ${this.theme.simpleTableSelectionBorder}`,borderWidth:2,borderRadius:2,zIndex:a?5:3},children:this.props.canEdit&&(0,re.jsxs)(re.Fragment,{children:[!this.environment.device.isMobile&&(0,re.jsx)(nt,{position:"top-left",onDraggableDragStart:this.handleTopLeftDragHandleDragStart,onDraggableDragMove:this.handleDragHandleDragMove}),(0,re.jsx)(nt,{position:"bottom-right",onDraggableDragStart:this.handleBottomRightDragHandleDragStart,onDraggableDragMove:this.handleDragHandleDragMove})]})})]})}renderDragOverlay(){const e=this.dragState.state;if(!e)return;if(!this.tableElement)return;const t=this.tableElement.getBoundingClientRect(),{draggedCells:n,type:o,left:i,top:r}=e;for(const a of n)a.rect="column"===o?new DOMRect(0,a.rect.top-t.top,a.rect.width,a.rect.height):new DOMRect(a.rect.left-t.left,0,a.rect.width,a.rect.height);return(0,re.jsx)("div",{style:{position:"absolute",left:i,top:r,zIndex:5},children:(0,re.jsx)(ze.Z,{store:this.props.store,ghostElement:n,opacity:.9},"simple_table_drag")})}didMount(){this.tableElement=this.getNode(),this.tableElement?this.observer||(this.observer=new MutationObserver(this.handleObserverChange),this.observer.observe(this.tableElement,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):this.observer&&(this.observer.disconnect(),this.observer=void 0)}handleDragHandleDragStart(e){if(!this.props.selection)return;const{start:t,end:n}=this.props.selection;this.dragHandleSelectAnchor={col:"top-left"===e?Math.max(t.col,n.col):Math.min(t.col,n.col),row:"top-left"===e?Math.max(t.row,n.row):Math.min(t.row,n.row)}}getClosestTableCellPosition(e,t){return{col:this.getClosestColumnIndex(e),row:this.getClosestRowIndex(t)}}getClosestColumnIndex(e){const t=Se.Z.findCellsInRowFromStore(void 0,this.props.store,0).sort(((e,t)=>e.props.columnIndex-t.props.columnIndex));for(let n=0;n<t.length;n++){if(e<=t[n].getNode().getBoundingClientRect().right)return n}return t.length-1}getClosestRowIndex(e){const t=Se.Z.findCellsInColumnFromStore(this.props.store,0).sort(((e,t)=>e.props.rowIndex-t.props.rowIndex));for(let n=0;n<t.length;n++){if(e<=t[n].getNode().getBoundingClientRect().bottom)return n}return t.length-1}getCellRect(e){if(!this.tableElement)return;const{store:t,columnOrder:n}=this.props,o=t.getContentStores()[e.row],i=Se.Z.findCellsInRowFromStore(o,t,e.row);if(!n)return;const r=this.getSelectedCellRect(i,n[e.col]);if(!r)return;const a=this.tableElement.getBoundingClientRect(),s=r.top-a.top,l=r.left-a.left,c=r.width,d=this.getMaxHeightOfCellsInRow(i);return new DOMRect(l-2,s-2,c+4,d+4)}getSelectedCellRect(e,t){var n;return null===(n=e.find((e=>e.getColumnID()===t)))||void 0===n||null===(n=n.node)||void 0===n?void 0:n.getBoundingClientRect()}getMaxHeightOfCellsInRow(e){return Math.max(...e.map((e=>{var t;return(null===(t=e.node)||void 0===t||null===(t=t.getBoundingClientRect())||void 0===t?void 0:t.height)||0})))}}ot.displayName="SimpleTableSelectionOverlay";const it=ot;class rt extends m.Z{constructor(){super(...arguments),this.storeTypes={formatStore:x},this.rootSizeObserver=new k.E,this.hoverSizeObserver=new k.E,this.nodeRef=s.createRef(),this.handleMount=e=>{e&&this.rootSizeObserver.observe(e)},this.handleHoverMount=e=>{const t=null==e?void 0:e.getNode();t&&this.hoverSizeObserver.observe(t)},this.handleRootMouseDown=e=>{const{device:t}=this.environment;t.isMobile||(0,y.ZP)({event:e,context:y.Af.EditorMouseDown,callback:()=>{e.preventDefault(),u.AI({environment:this.environment,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!0})}})},this.getSelectableStyle=this.createComputedStore((()=>{const{device:e}=this.environment,t={width:"100%",position:"relative",alignSelf:"center"};return(e.isMobile||this.isInColumnList()||!this.isRootOrDirectChild())&&(t.maxWidth=this.numberOfComments.state?"calc(100% - 40px)":"100%"),t})),this.columnOrder=this.createComputedStore((()=>{const{store:e}=this.props,t=e.getFormat(),{temporaryFormat:n}=this.stores.formatStore.state;return(n||t).table_block_column_order})),this.simpleTableSelection=this.createComputedStore((()=>{const e=P.Z.state,{store:t}=this.props;if(e.isActive&&e.simpleTableStore===t){var n;const i=(null===(n=this.columnOrder.state)||void 0===n?void 0:n.length)||o.getNumberOfColumns(t),r=o.getNumberOfRows(t)+this.numTempRows.state,{selection:a}=e;return{start:{col:(0,d.Z)(a.start.col,0,i-1),row:(0,d.Z)(a.start.row,0,r-1)},end:{col:(0,d.Z)(a.end.col,0,i-1),row:(0,d.Z)(a.end.row,0,r-1)},type:a.type}}}),!0),this.numTempRows=this.createComputedStore((()=>{const e=o.getTableResizeState(this.props.store);return e?e.rowsDelta:0})),this.resizeCursor=this.createComputedStore((()=>{const{store:e}=this.props,t=T.Z.state;if(t.isActive&&t.simpleTableStore===e){const{hover:e}=t;if("cell"===e.type&&e.resizing)return"col-resize"}const n=o.getTableResizeState(e);if(n){if("column"===n.resize)return"col-resize";if("row"===n.resize)return"row-resize";if("corner"===n.resize)return"nwse-resize"}const i=M.Z.state;if(i.isActive&&i.simpleTableStore===e)return"grab"})),this.numberOfBlockComments=this.createComputedStore((()=>o.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!1})),!0),this.numberOfComments=this.createComputedStore((()=>o.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!0})),!0)}willUnmount(){this.rootSizeObserver.destroy(),this.hoverSizeObserver.destroy()}renderPersisted(){var e,t;const{store:n,disabled:o,disableHoverMenu:i,experimentalLayout:r}=this.props,a=this.numberOfComments.state,s=this.numberOfBlockComments.state,l=a>0&&0===s,c=this.renderDiscussion({recursivelyLoadAllDiscussions:!this.marginCommentsVisible.state,hideIfSidebarOrMarginCommentsVisible:l}),d=Boolean(c)&&a>0||this.isInColumnList(),u=r?this.renderContent(d):(0,re.jsx)(g.Z,{type:w.Z.X,preventType:p.Q7(this.environment),style:this.getScrollerStyle(),showLeftRightOverlay:!0,leftOverlayStyle:{left:d?-8:-8-((null===(e=this.getLeftRightPadding())||void 0===e?void 0:e.paddingLeft)||0),top:8,bottom:18},rightOverlayStyle:{top:8,bottom:18},children:this.renderContent(d)}),m=(0,S.Fn)(this.environment),v=!o&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn();return(0,re.jsxs)(f.p,{allowSelectionWithin:!0,style:this.getStyle(),ref:this.handleMount,onMouseDown:this.handleRootMouseDown,children:[d?(0,re.jsx)(h.Z,{store:n,shouldShowHoverMenu:!i&&(this.canEdit()||m),shouldShowCommentMenu:v,style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:u}):u,c,(0,re.jsx)(de,{disabled:o,canEdit:this.canEdit(),simpleTableStore:n,rootSizeObserver:this.rootSizeObserver,offset:d?0:this.getOffset()||0,hoverSizeObserver:this.hoverSizeObserver,experimentalLayout:Boolean(r)})]})}renderContent(e){var t;const{store:n,disabled:i,disableHoverMenu:r}=this.props,a=n.getContentStores(),s=this.columnOrder.state;if(!s)return;const l=this.numTempRows.state,c=l<0?a.length+l:a.length,d=this.simpleTableSelection.state,{device:u}=this.environment,p=!u.isPhone,m=!i&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn(),f=(0,re.jsx)("div",{style:{display:"flex"},children:(0,re.jsx)("div",{style:{paddingTop:8,paddingLeft:8,paddingBottom:18,paddingRight:18},children:(0,re.jsx)(h.Z,{store:n,shouldShowHalo:!0,canSelect:!0,canDropLeft:p,canDropRight:p,canDropAbove:!1,canDropBelow:!1,aboveDropZoneMargin:4,belowDropZoneMargin:4,analyticsName:"page_content",shouldShowDropZone:!0,style:{position:"relative"},className:v.OE$,shouldShowCommentMenu:m,nodeRef:this.nodeRef??void 0,children:(0,re.jsx)(it,{store:n,selection:d,columnOrder:s,formatStore:this.stores.formatStore,disabled:i,canEdit:this.canEdit(),children:(0,re.jsx)("table",{children:(0,re.jsxs)("tbody",{ref:this.nodeRef,children:[a.slice(0,c).map(((e,t)=>(0,re.jsx)(Ne,{rowIndex:t,rowStore:e,store:n,disabled:i,columnOrder:s,selection:d,formatStore:this.stores.formatStore},e.id))),l>0&&[...Array(l).keys()].map(((e,t)=>(0,re.jsx)(Ne,{rowIndex:o.getNumberOfRows(n)+t,store:n,rowStore:void 0,disabled:i,columnOrder:s,selection:d,formatStore:this.stores.formatStore},t)))]})})})})})}),g=(0,S.Fn)(this.environment);return(0,re.jsx)("div",{className:v.fOh,style:{cursor:this.resizeCursor.state,...e?{paddingRight:20}:this.getLeftRightPadding()},children:e?f:(0,re.jsx)(h.Z,{store:n,shouldShowCommentMenu:m,shouldShowHoverMenu:!r&&(this.canEdit()||g),style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:f})})}handleCreated(){c.default.afterNextFlush((()=>{i.selectCellAndSetCursor({environment:this.environment,rowIndex:0,columnIndex:0,simpleTableStore:this.props.store})}))}getStyle(){const{experimentalLayout:e,store:t}=this.props;return{...this.getBlockColorStyle(),...this.props.style,position:e?"inherit":"relative",display:"flex",...(0,b.Ks)(t)&&{width:(0,_.$3)(this.environment),position:"sticky",left:0}}}getScrollerStyle(){return{flexGrow:1,marginLeft:-8}}isInColumnList(){return this.context.isInColumnList}getLeftRightPadding(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{store:t,experimentalLayout:n}=this.props;if(!n||e)return(0,b.Bs)({environment:this.environment,store:t,isFullScreen:!1,sizeObserver:this.rootSizeObserver})}getOffset(){var e;return null===(e=this.getLeftRightPadding(!0))||void 0===e?void 0:e.paddingLeft}}rt.contextTypes={...l.w,isInColumnList:a().any};const at=rt},84139:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{findCellsInRowFromStore(e,t,n){return this.filter((o=>{const{store:i,simpleTableStore:r,rowIndex:a}=o.props;return e?i===e:r===t&&a===n}))}findCellsInColumnFromStore(e,t){return this.filter((n=>n.props.simpleTableStore===e&&("number"==typeof t&&n.props.columnIndex===t||"string"==typeof t&&n.props.columnID===t)))}findCellFromTextStore(e){return this.find((t=>t.props.textStore===e))}findCellFromElement(e,t){return this.find((n=>n.props.simpleTableStore===t&&n.getNode()===e))}}const r=new i},64359:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},5676:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},29574:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},63208:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},6451:(e,t,n)=>{n.d(t,{Y3:()=>E,y6:()=>I,G$:()=>F,lR:()=>D,GF:()=>B,Q6:()=>R});n(21703),n(57658);var o=n(72126),i=n(73360),r=n(606),a=n(21202),s=n(80873),l=n(97664),c=n(20985),d=n(97880);const u={table:a.iU,recordColumnTypes:{id:s.Z.UUID,space_id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,type:s.Z.String,properties:s.Z.JSON,content:s.Z.StringArray,discussions:s.Z.StringArray,view_ids:s.Z.StringArray,collection_id:s.Z.UUID,permissions:s.Z.JSON,created_time:s.Z.Number,last_edited_time:s.Z.Number,copied_from:s.Z.UUID,file_ids:s.Z.StringArray,ignore_block_count:s.Z.Boolean,is_template:s.Z.Boolean,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,moved:s.Z.JSON,format:s.Z.JSON,created_by:s.Z.UUID,last_edited_by:s.Z.UUID,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,content_classification:s.Z.String},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_last_access_timestamp:s.Z.Number,meta_role:s.Z.String}};const p={table:n(6287).v,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,name:s.Z.JSON,description:s.Z.JSON,icon:s.Z.String,cover:s.Z.String,schema:s.Z.JSON,format:s.Z.JSON,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,file_ids:s.Z.StringArray,template_pages:s.Z.StringArray,copied_from:s.Z.UUID,migrated:s.Z.Boolean,space_id:s.Z.UUID,deleted_schema:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const m={table:n(13493).n,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,type:s.Z.String,name:s.Z.String,page_sort:s.Z.UUIDArray,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,format:s.Z.JSON,query2:s.Z.JSON,space_id:s.Z.UUID},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const f={table:n(65311).uX,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,user_id:s.Z.UUID,activity_id:s.Z.UUID,received:s.Z.Boolean,read:s.Z.Boolean,visited:s.Z.Boolean,emailed:s.Z.Boolean,invalid:s.Z.Boolean,space_id:s.Z.UUID,navigable_block_id:s.Z.UUID,collection_id:s.Z.UUID,type:s.Z.String,end_time:s.Z.String,channel:s.Z.String,archived_at:s.Z.Number},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const g={table:n(19889).KJ,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,email:s.Z.String,given_name:s.Z.String,family_name:s.Z.String,profile_photo:s.Z.String,onboarding_completed:s.Z.Boolean,mobile_onboarding_completed:s.Z.Boolean,clipper_onboarding_completed:s.Z.Boolean,reverify:s.Z.Boolean,name:s.Z.String,is_banned:s.Z.Boolean,suspended_time:s.Z.Number},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const h={table:n(15047).bx,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,name:s.Z.String,permissions:s.Z.JSON,permission_groups:s.Z.JSON,email_domains:s.Z.StringArray,pages:s.Z.StringArray,icon:s.Z.String,disable_public_access:s.Z.Boolean,disable_public_access_requests:s.Z.Boolean,disable_guests:s.Z.Boolean,disable_move_to_space:s.Z.Boolean,disable_export:s.Z.Boolean,disable_space_page_edits:s.Z.Boolean,beta_enabled:s.Z.Boolean,created_time:s.Z.Number,last_edited_time:s.Z.Number,deleted_by:s.Z.UUID,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,admin_disable_public_access:s.Z.Boolean,space_pages:s.Z.UUIDArray,plan_type:s.Z.String,invite_link_enabled:s.Z.Boolean,initial_use_cases:s.Z.String,public_home_page:s.Z.String,bot_settings:s.Z.JSON,settings:s.Z.JSON,subscription_tier:s.Z.String,disable_team_creation:s.Z.Boolean,overdue_subscription:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const v={table:n(77858).zU,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_id:s.Z.UUID,bookmarked_pages:s.Z.StringArray,shared_pages:s.Z.StringArray,visited_templates:s.Z.StringArray,sidebar_hidden_templates:s.Z.StringArray,notify_mobile:s.Z.Boolean,notify_desktop:s.Z.Boolean,notify_email:s.Z.Boolean,notify_email_always:s.Z.Boolean,created_getting_started:s.Z.Boolean,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,created_onboarding_templates:s.Z.Boolean,private_pages:s.Z.UUIDArray,joined:s.Z.Boolean,joined_teams:s.Z.UUIDArray,settings:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const b={table:n(29369).e0,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_id:s.Z.UUID,name:s.Z.String,description:s.Z.String,icon:s.Z.String,created_time:s.Z.Number,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_time:s.Z.Number,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,archived_by:s.Z.UUID,archived_at:s.Z.Number,team_pages:s.Z.UUIDArray,pinned_pages:s.Z.UUIDArray,parent_id:s.Z.UUID,parent_table:s.Z.String,settings:s.Z.JSON,is_default:s.Z.Boolean,membership:s.Z.JSON,permissions:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const y={table:n(66079).dx,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_views:s.Z.StringArray,space_view_pointers:s.Z.JSON,left_spaces:s.Z.StringArray,deleted_email:s.Z.String},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const S={table:n(28182).Sr,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,settings:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}},_=[u,h,v,y,g,m,p,b,S,f],w=new Set(_.map((e=>e.table))),k=Object.keys({record_table:!0,record_id:!0,record_value:!0,space_id:!0,timestamp:!0,parent_table:!0,parent_id:!0,importance:!0,user_id:!0});async function I(e,t){await(0,l.G$)({connection:e,statements:[{sql:"\n\t\t\t\tUPDATE records SET user_id = ? WHERE user_id is null\n\t\t\t\t",args:[t]}],queryName:"backfillRecordsWithUserId"})}function C(e){const t=o.vM(e.records,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((t=>{let[i,r]=t;const a=_.find((e=>e.table===i));if(!a)return;const s=Object.keys(a.recordColumnTypes),c=Object.keys(a.metaColumnTypes),d=s.concat(c);o.yo(r,Math.floor(l.mz/d.length)).forEach((t=>{const r=`(${d.join(",")})`,a=Array(t.length).fill(`(${"?, ".repeat(d.length-1)}?)`).join(",");let l;l=e.maybeStaleRecords&&d.includes("version")?`INSERT INTO ${i} ${r} VALUES ${a}`.concat("ON CONFLICT (id, meta_user_id) DO UPDATE SET").concat("\n").concat(d.map((e=>`${e} = excluded.${e}`)).join(",")).concat("\n").concat(`WHERE excluded.version > ${i}.version`):`INSERT OR REPLACE INTO ${i} ${r} VALUES ${a}`;const u=o.xH(t.map((e=>{let{value:t,timestamp:n,userId:o}=e;if(!t)return[];const i=t.value;if(!i)return[];const r=s.map((e=>function(e){if(null==e)return null;if("string"==typeof e||"number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;return JSON.stringify(e)}(i[e]))),a=c.map((e=>{switch(e){case"meta_user_id":return o;case"meta_role":return t.role;case"meta_last_access_timestamp":return n;default:throw new Error(`Unknown meta column ${e}`)}}));return r.concat(a)})));n.push({sql:l,args:u})}))})),n}function x(e){const[t,n]=o.uK(e.records,(e=>Z(e))),r=C({records:t,maybeStaleRecords:e.maybeStaleRecords}),a=function(e){const{records:t,maybeStaleRecords:n}=e;return o.yo(t,Math.floor(l.mz/k.length)).map((e=>{let t=`\n\t\t\tINSERT INTO records\n\t\t\t(\n\t\t\t\trecord_table,\n\t\t\t\trecord_id,\n\t\t\t\trecord_value,\n\t\t\t\ttimestamp,\n\t\t\t\tparent_table,\n\t\t\t\tparent_id,\n\t\t\t\timportance,\n\t\t\t\tuser_id,\n\t\t\t\tspace_id\n\t\t\t)\n\t\t\tVALUES ${Array(e.length).fill("(?, ?, ?, ?, ?, ?, ?, ?, ?)").join(",")}`;return t=n?t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.record_value\n\t\t\t\t\t\tELSE records.record_value\n\t\t\t\t\t\tEND,\n\t\t\t\t\ttimestamp =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.timestamp\n\t\t\t\t\t\tELSE records.timestamp\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_table =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_table\n\t\t\t\t\t\tELSE records.parent_table\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_id\n\t\t\t\t\t\tELSE records.parent_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\timportance =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.importance\n\t\t\t\t\t\tELSE records.importance\n\t\t\t\t\t\tEND,\n\t\t\t\t\tuser_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.user_id\n\t\t\t\t\t\tELSE excluded.user_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"):t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value = excluded.record_value,\n\t\t\t\t\ttimestamp = excluded.timestamp,\n\t\t\t\t\tparent_table = excluded.parent_table,\n\t\t\t\t\tparent_id = excluded.parent_id,\n\t\t\t\t\timportance = excluded.importance,\n\t\t\t\t\tuser_id = excluded.user_id,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"),{sql:t,args:o.xH(e.map((e=>{let{pointer:t,value:n,timestamp:o,importance:r,userId:a}=e,s=null,c=null;return n&&n.value&&(0,i.oK)(n.value)&&(s=n.value.parent_id,c=n.value.parent_table),[t.table,t.id,(0,l.gI)(n),o,c,s,"number"==typeof r?r:null,a,t.spaceId||null]})))}}))}({records:n,maybeStaleRecords:e.maybeStaleRecords});return[...T(t),...M(n.filter((e=>w.has(e.pointer.table)))),...r,...a]}function T(e){return o.yo(e,Math.floor(l.mz/(2*e.length))).map((e=>{const t=c.i6` OR `.joins(e.map((e=>c.i6`(records.record_id = ${e.pointer.id} AND records.user_id = ${e.userId})`)));return c.i6`DELETE FROM records WHERE ${t}`.asWrite()}))}function M(e){const t=o.vM(e,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((e=>{let[t,i]=e;o.yo(i,Math.floor(l.mz/(2*i.length))).forEach((e=>{const o=c.i6` OR `.joins(e.map((e=>c.i6`(id = ${e.pointer.id} AND meta_user_id = ${e.userId})`)));n.push(c.i6`DELETE FROM ${(0,c.k5)(t)} WHERE ${o}`.asWrite())}))})),n}async function P(e,t){if(0===t.length)return[];const n=o.vM(t,(e=>e.pointer.table)),i=[];Object.entries(n).forEach((t=>{let[n,a]=t;const s=_.find((e=>e.table===n));if(!s)return;const c=Array(a.length).fill("(id = ? AND meta_user_id = ?)").join(" OR "),d=o.VS(a,(e=>{let{pointer:{table:t,id:n},userId:o}=e;return[n,o]}));i.push(new Promise((async t=>{const[o]=await(0,l.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM ${n}\n\t\t\t\tWHERE ${c}`,args:d,getData:!0}],queryName:"getRecordsFromSeparateTables"});t(o.data.map((e=>function(e,t,n){return{pointer:r.dr.fromPointerLike({table:e,id:t.id,spaceId:t.space_id||void 0}),value:{role:t.meta_role,value:A(t,n)},timestamp:t.meta_last_access_timestamp,importance:0,userId:t.meta_user_id}}(n,e,s))))})))}));const a=await Promise.all(i);return o.xH(a)}function A(e,t){const n={};return Object.keys(t.recordColumnTypes).forEach((o=>{const i=t.recordColumnTypes[o];if(null!==e[o])switch(i){case s.Z.UUID:case s.Z.String:case s.Z.Number:n[o]=e[o];break;case s.Z.StringArray:case s.Z.JSON:n[o]=JSON.parse(e[o]);break;case s.Z.XML:n[o]=e[o];break;case s.Z.UUIDArray:n[o]=JSON.parse(e[o]);break;case s.Z.Boolean:n[o]=1===e[o];break;case s.Z.CIDR:n[o]=e[o];break;default:(0,d.t1)(i)}})),n}async function R(e,t){const[n,i]=o.uK(t,(e=>w.has(e.pointer.table))),a=await P(e,n),s=new Set(a.map((e=>r.P2.toKey({pointer:e.pointer,userId:e.userId})))),c=n.filter((e=>!s.has(r.P2.toKey(e)))),d=(await async function(e,t){if(0===t.length)return[];const n=Array(t.length).fill("(record_table = ? AND record_id = ? AND user_id = ?)").join(" OR "),i=o.VS(t,(e=>{let{pointer:{table:t,id:n},userId:o}=e;return[t,n,o]})),[a]=await(0,l.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM records\n\t\t\t\tWHERE ${n}`,args:i,getData:!0}],queryName:"getRecordsFromRecordsTable"});return a.data.map((e=>({pointer:r.dr.fromPointerLike({table:e.record_table,id:e.record_id,spaceId:e.space_id||void 0}),value:JSON.parse(e.record_value),timestamp:e.timestamp,importance:"number"==typeof e.importance?e.importance:void 0,userId:e.user_id})))}(e,i.concat(c))).filter((e=>!Z(e)));return a.concat(d)}async function D(e,t){const n=c.i6`
  SELECT * FROM block
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asRead(),o=c.i6`
  UPDATE block
  SET meta_last_access_timestamp = ${t.timestamp}
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asWrite(),[i]=await(0,l.G$)({connection:e,statements:[n,o],queryName:"getBlocksWithParent"});return i.data.map((e=>({pointer:r.dr.fromPointerLike({table:a.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:A(e,u)},userId:t.userId})))}async function B(e,t){const n=c.i6`
    WITH RECURSIVE page_blocks AS (
      SELECT * FROM block
      WHERE id = ${t.page.id}
      AND meta_user_id = ${t.userId}

      UNION

      SELECT block.*
      FROM
        block INDEXED BY block_parent_id,
        page_blocks
      WHERE
      (
        page_blocks.id = ${t.page.id}
        OR page_blocks.type NOT IN ('page', 'toggle')
      )
      AND block.parent_table = 'block'
      AND block.parent_id = page_blocks.id
      AND block.meta_user_id = ${t.userId}
    )
    SELECT * FROM page_blocks
    `,o=await n.all(e,"getPageBlocksByParent");return 0===o.length?[]:o.map((e=>({pointer:r.dr.fromPointerLike({table:a.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:A(e,u)},userId:t.userId})))}async function E(e,t,n){const o=n.filter((e=>"set"===e.type&&!e.maybeStaleRecord)),i=n.filter((e=>"set"===e.type&&e.maybeStaleRecord)),r=n.filter((e=>{let{type:t}=e;return"access"===t})),s=n.filter((e=>{let{type:t}=e;return"delete"===t})),d=[];if(r.forEach((e=>{const t=e.record.pointer.table;Z(e.record)?t===a.iU&&d.push(c.i6`
	        UPDATE block
	        SET meta_last_access_timestamp = ${e.record.timestamp}
	        WHERE id = ${e.record.pointer.id}
	        AND meta_user_id = ${e.record.userId}
	        `.asWrite()):d.push({sql:"UPDATE records\n          SET timestamp = ?\n          WHERE record_table = ?\n          AND record_id = ?\n          AND user_id = ?",args:[e.record.timestamp,t,e.record.pointer.id,e.record.userId]})})),o.length>0||i.length>0){if(o.length>0){const e=o.map((e=>e.record));d.push(...x({records:e,maybeStaleRecords:!1}))}if(i.length>0){const e=i.map((e=>e.record));d.push(...x({records:e,maybeStaleRecords:!0}))}d.push(c.i6`
			DELETE FROM records
			WHERE rowid IN (
				SELECT rowid FROM records
				ORDER BY importance DESC, timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite()),d.push(c.i6`
			DELETE FROM block
			WHERE rowid in (
				SELECT rowid FROM block
				ORDER BY meta_last_access_timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite())}if(s.length>0){const e=s.map((e=>e.record));d.push(...function(e){const t=M(e.filter((e=>w.has(e.pointer.table)))),n=T(e);return t.concat(n)}(e))}0!==d.length&&await(0,l.G$)({connection:e,statements:d,queryName:"applyRecordCacheOperations"})}async function F(e){await async function(e){const t=[];w.forEach((e=>{t.push(c.i6`DELETE FROM ${(0,c.k5)(e)}`.asWrite())})),await(0,l.G$)({connection:e,statements:t,queryName:"deleteAllCachedRecordsFromSeparateTables"})}(e),await async function(e){await(0,l.sf)({connection:e,sql:"DELETE FROM records",queryName:"deleteAllCachedRecordsFromRecordsTable"})}(e)}function Z(e){return w.has(e.pointer.table)&&void 0!==e.value&&void 0!==e.value.value}},4023:(e,t,n)=>{n.d(t,{u:()=>o,v:()=>i});let o=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Center=4]="Center",e}({}),i=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({})},70726:(e,t,n)=>{n.d(t,{Z:()=>i});var o=function(e){return e[e.Preview=0]="Preview",e[e.Mention=1]="Mention",e[e.Link=2]="Link",e}(o||{});const i=o},34859:(e,t,n)=>{n.d(t,{Z:()=>i});var o=function(e){return e[e.All=0]="All",e[e.X=1]="X",e[e.Y=2]="Y",e[e.None=3]="None",e}(o||{});const i=o},83960:(e,t,n)=>{n.d(t,{T:()=>o,l:()=>i});const o={localLanguagePreferenceKey:"CodeBlockDefaultLanguage",localCodeWrapPreferenceKey:"CodeBlockDefaultCodeWrap",defaultLanguage:"JavaScript",defaultCodePreviewFormat:"code"},i={localSizePreferenceKey:"QuoteBlockDefaultSize"}},96198:(e,t,n)=>{n.d(t,{O:()=>o});const o=44},15723:(e,t,n)=>{n.d(t,{Ep:()=>a,Kr:()=>d,MU:()=>m,aP:()=>l,bM:()=>r,dQ:()=>u,iL:()=>i,jn:()=>p,kK:()=>c,uh:()=>s});var o=n(72126);class i{static from(e){return new i(e.left,e.top,e.width,e.height)}constructor(e,t,n,o){this.x=e,this.y=t,this.width=n,this.height=o,this.top=this.height<0?this.y+this.height:this.y,this.bottom=this.height<0?this.y:this.y+this.height,this.left=this.width<0?this.x+this.width:this.x,this.right=this.width<0?this.x:this.x+this.width}toJSON(){return{...this}}}const r=new i(0,0,0,0);function a(e){return Boolean(e&&(o.hj(e.top)||o.hj(e.left)))}function s(e,t,n){return e.left<=t&&t<=e.right&&e.top<=n&&n<=e.bottom}function l(e,t){return e.left<=t.left&&e.right>=t.right&&e.top<=t.top&&e.bottom>=t.bottom}function c(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)}function d(e,t){return!(e.right<=t.left||t.right<=e.left)}function u(e,t){return!(e.bottom<=t.top||t.bottom<=e.top)}function p(e,t){return new i(e.left-t,e.top-t,e.width+2*t,e.height+2*t)}function m(e){const t=e.top+e.height/2,n=e.left+e.width/2;return new i(n,t,0,0)}},12252:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{constructor(){super(...arguments),this.pause=()=>{this.setState({active:!1,onActive:[]})},this.resume=()=>{this.state.onActive.map((e=>e())),this.setState({active:!0,onActive:[]})}}getInitialState(){return{active:!0,onActive:[]}}whenActive(e){this.state.active?e():this.setState({...this.state,onActive:i.jj([...this.state.onActive,e])})}}const a=new r},51214:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(606);class r extends o.default{getInitialState(){return{isGenerating:!1}}isGeneratingFor(e){const t=this.state;return!!t.isGenerating&&i.dr.isEqual(t.aiSectionBlockPointer,e)}setIsGeneratingFor(e){this.setState({isGenerating:!0,aiSectionBlockPointer:e})}}const a=new r},58455:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var o=n(49085),i=n(4615),r=n(95477);class a extends o.default{constructor(){super(...arguments),this.verboseAnalytics=r.default.isAdminMode||false}getInitialState(){return{isLoaded:!1,isLoggingEnabled:!1,isAmplitudeEnabled:!1,isSegmentEnabled:!1,isZendeskEnabled:!1,isIntercomEnabled:!1,intercomAppId:void 0,intercomUserHash:void 0,noIntercomUserId:!1,isSprigEnabled:!1,zendeskToken:void 0}}shouldRefresh(e){return!this.state.isLoaded||Boolean(e)!==Boolean(this.state.user_id)||Boolean(e&&this.state.user_id&&(0,i.cj)(this.state.user_id)!==(0,i.cj)(e))}}const s=new a},51:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.publicPageData)))}}const r=new i},80444:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var o=n(49085),i=n(72126),r=n(59753),a=n(74446);n(7406);const s={wiki_promo:0,ai_qna_alpha:0,enterprise_launch_promo:0,tasks_migration_modal:0,better_template_initialization:1,pm_intro_tooltip:2,pm_intro_sidebar_notif:2,customer_io:2,share_button_tooltip:2,add_icon_tooltip:2,persona_collection:2,add_on_discount_popup:2,team_add_app_template_tooltip:2,ai_onboarding_tooltip:2,share_menu_tutorial:2};class l extends o.default{getInitialState(){return{activeCallouts:new Set}}updateCalloutStatus(e){let{calloutId:t,visible:n}=e;const{activeCallouts:o}=this.state;if(n){const e=new Set(o).add(t);for(const n of o){s[t]<s[n]&&e.delete(n)}this.setState({activeCallouts:e})}else{const e=new Set(o);e.delete(t);this.setState({activeCallouts:e})}}canShow(e){const{activeCallouts:t}=this.state;if(t.has(e))return!0;for(const n of t){if(s[n]<=s[e])return!1}return!0}}const c=l;var d=n(30539),u=n(89523);class p extends o.default{getInitialState(){return{initialized:!1,renderPhase:"booting",pageVisitStore:new d.Z,presenceStore:new u.Z,inAppCalloutStore:new c}}getCurrentBlockModelFn(){const{mainEditorCurrentBlockStore:e}=this.state,t=a.mF.tryUntilFound(...i.oA([e&&e.getRecordValue]));return r.om.fromGetRecordValueFn(t)}waitUntilRendered(){return this.waitUntil((()=>"rendered"===this.state.renderPhase))}}p.sidebarIsExpandedPreferenceKey="sidebarIsExpanded";const m=new p},92425:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}getSharedPagesState(e){const{userId:t,spaceId:n}=e;let o=this.state[t];o||(o={},this.state[t]=o);return o[n]}setSharedPagesState(e){const{userId:t,spaceId:n,state:o}=e;let i=this.state[t];i||(i={},this.state[t]=i),i[n]=o,this.emit()}}const r=new i},5737:(e,t,n)=>{n.d(t,{NM:()=>s,Sr:()=>r});var o=n(49085),i=n(92595);function r(){return!!s.state&&Date.now()-s.state.lastSessionInitializedUnixEpochTime>=6e5}class a extends o.default{getInitialState(){}clear(){var e;null!==(e=this.state)&&void 0!==e&&e.temporaryCache&&this.state.temporaryCache.clearCache(),this.setState(void 0)}hasLockAction(){const e=this.state;return Boolean((null==e?void 0:e.committing)||(null==e?void 0:e.evaluating)||(null==e?void 0:e.sampling))}setLastSessionInitializedUnixEpochTime(){this.state&&this.setState({...this.state,lastSessionInitializedUnixEpochTime:Date.now()})}}const s=new a;(0,i.exposeDebugValue)("AssistantConfigurationStore",s)},21273:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(38823),r=n(45433);class a extends o.default{getInitialState(){return new i.m({getEligibleGroup:()=>"control",isAiEnabled:()=>!1})}isAssistantEnabled(){return this.state.isAssistantEnabled()}isQnAOnlyEnabled(){return this.state.isQnAOnlyEnabled()}isCanaryQnAExperience(){return this.isMode("canary")}shouldShowQnaInSearchOnly(){return this.isMode("alpha")||this.isMode("beta")}shouldShowSearchMenuItemAskAI(){return this.modeIsAtMost("beta")}shouldShowAssistantInCorner(){return this.modeIsAtMost("canary")||this.isMode("beta")}showAiQnaOnboardingModalForAlphaLaunch(){return this.modeIsAtMost("alpha")}showSearchAiFeatures(){return this.modeIsAtMost("development")||this.isMode("alpha")}allowWikiSkillCreation(e){return e===r.FF&&this.modeIsAtMost("development")}allowTaskSkillCreation(e){return e===r.TZ&&this.modeIsAtMost("ai_team")}allowCustomSkillCreation(){return this.modeIsAtMost("ai_team")}canViewMoreSkills(e){const t=this.allowWikiSkillCreation(e),n=this.allowTaskSkillCreation(e),o=this.allowCustomSkillCreation();return t||n||o}shouldShowAISections(){return this.modeIsAtMost("ai_team")}shouldAttributeChangesToAI(){return this.modeIsAtMost("ai_team")}getMode(){return this.state.getMode()}isMode(e){return this.state.isMode(e)}modeIsAtMost(e){return this.state.modeIsAtMost(e)}}const s=new a},82375:(e,t,n)=>{n.d(t,{Hl:()=>c,Of:()=>r,Pl:()=>d,XN:()=>l,zZ:()=>a});n(21703);var o=n(49085),i=n(92595);const r=(0,n(97880).AO)((e=>"string"==typeof e.inferenceId?{true:e}:{false:e}));function a(e){const{store:t,step:n}=e;if(!t.state)throw new Error("No state");const o=t.state.sampledSteps.map((e=>e.id===n.id?n:e));t.setState({...t.state,sampledSteps:o})}class s extends o.default{getInitialState(){}clear(){this.setState(void 0)}}const l=new s;(0,i.exposeDebugValue)("AssistantRuntimeStore",l);const c=o.default.createValue(void 0),d=o.default.createValue(void 0);(0,i.exposeDebugValue)("getTranscript",(()=>{var e;const t=(null===(e=l.state)||void 0===e?void 0:e.evaluator.getTranscript())??[];return JSON.stringify(t)})),(0,i.exposeDebugValue)("labelingSlackModeStore",d)},58454:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{open:!1}}}const a=new r;(0,i.exposeDebugValue)("AutomationModalStore",a);const s=a},8297:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{banners:[]}}}const r=i},24229:(e,t,n)=>{n.d(t,{Z:()=>d,u:()=>s});var o=n(49085),i=n(92595),r=n(49427),a=n(15723);let s=function(e){return e[e.Open=0]="Open",e[e.Resolved=1]="Resolved",e[e.NewThread=2]="NewThread",e}({});class l extends o.default{getInitialState(){return{open:!1,rect:a.bM,recursivelyLoadAllDiscussions:!1}}getFramePageFirstSelectedDiscussionId(){var e;return this.state.open&&r.Z.isBlockInFrame(this.state.blockStore)?null===(e=this.state.discussionIds)||void 0===e?void 0:e[0]:void 0}}const c=new l;(0,i.exposeDebugValue)("BlockDiscussionMenuStore",c);const d=c},8949:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1}}}const r=new i},61207:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},58484:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isOpen:!1}}}const r=i},68859:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{dragging:!1}}}const r=i},61766:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=i},17746:(e,t,n)=>{n.d(t,{Z:()=>s,t:()=>r});var o=n(49085),i=n(15157);let r=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class a extends o.default{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}static getLocalViewPreferenceKey(e){return`CalendarView:${e}`}static getLocalPreferences(e){let{collectionViewId:t,currentUserId:n}=e;return i.Z.get({userId:n,key:a.getLocalViewPreferenceKey(t)})}static getLocalDateRangeStart(e){let{collectionViewId:t,currentUserId:n}=e;const o=this.getLocalPreferences({collectionViewId:t,currentUserId:n});return o&&o.dateRangeStart?o.dateRangeStart:Date.now()}static setLocalDateRangeStart(e){let{collectionViewId:t,dateRangeStart:n,currentUserId:o}=e;const r=this.getLocalPreferences({collectionViewId:t,currentUserId:o})||{},s=a.getLocalViewPreferenceKey(t),l={...r,dateRangeStart:n};i.Z.set({userId:o,key:s,value:l})}}const s=a},4926:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(0)},87143:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{active:!1,stringValue:""}}}const r=new i},886:(e,t,n)=>{n.d(t,{Z:()=>L});n(57658);var o=n(14577),i=n(49085),r=n(41432),a=n(76205),s=n(30823),l=n(14714),c=n(99036),d=n(43690),u=n(10070),p=n(8848),m=n(45433),f=n(33147),g=n(6695),h=n(72126),v=n(23014),b=n(21202),y=n(6287),S=n(97880),_=n(45264),w=n(28020),k=n(97004),I=n(81849),C=n(65742),x=n(78316),T=n(77181),M=n(33929),P=n(98165),A=n(94841),R=n(35661);class D extends i.default{constructor(e){super(),this.collectionContextStore=e}getInitialState(){return new Map}getGroupState(e){const t=Array.isArray(e)?e:void 0!==e?[e]:[],n=(0,l.KW)(t),r=this.state.get(n);if(r)return r;const a=function(e,t){const n=i.default.createValue(void 0),r=e.collectionViewBlockStore();if(!r)return;let a;t.length>0?(a=r.clone(),a.setRecordStoreUIParent(r)):a=r;const s=x.bd(e),l=new o.Z((()=>{const e=n.state;return(e&&"results"===e.type?e.blockIds:[]).map((e=>R.G.createChildStore(a,{id:e,table:b.iU})))}),{debugName:"resultsStore"});return{groupsPointer:t,groupUiParentStore:a,reducerResultStore:n,resultsStore:l,currentLimit:i.default.createValue(s),toggleStateStore:i.default.createValue(!1)}}(this.collectionContextStore,t);return a?(this.state.set(n,a),this.emit(),a):void 0}getAllGroupStates(){return[...this.state.values()]}anyGroupHasResults(){for(const e of this.state.values())if(e.reducerResultStore.state)return!0;return!1}anyGroupHasNonEmptyResults(){for(const t of this.state.values()){var e;if(null!==(e=t.reducerResultStore.state)&&void 0!==e&&null!==(e=e.blockIds)&&void 0!==e&&e.length)return!0}return!1}anySpecifiedGroupHasResults(e){for(const t of e){const e=this.getGroupState(t);if(null!=e&&e.reducerResultStore.state)return!0}return!1}resetAllLimits(){const e=x.bd(this.collectionContextStore);for(const t of this.state.values())t.currentLimit.setState(e)}setLimitIfGreater(e,t){const n=this.getGroupState(e),o=null==n?void 0:n.currentLimit;o&&t>o.state&&o.setState(t)}incrementLimit(e){const{isFullScreen:t,currentResultCount:n,groupsPointer:o,incrementLimitsInRelatedGroups:i}=e,r=this.collectionContextStore.collectionViewStore();if(!r)return;const a=this.getGroupState(o);if(!a)return;const s=i?[...this.state.values()].filter((e=>1===o.length?1===e.groupsPointer.length:2===o.length&&(0,l.ZH)(o[0],e.groupsPointer[0]))):[a];for(const l of s){const e=l.currentLimit,o=e.state+x.NG({collectionViewStore:r,isFullScreen:t,currentResultCount:n});e.setState(o)}}}class B extends i.default{getInitialState(){return{hasLocalUpdates:!1,blockIds:new Set}}addLocalChange(e){const t=this.state.blockIds.size;for(const n of e)this.state.blockIds.add(n);t!==this.state.blockIds.size&&(this.state.hasLocalUpdates=!0,this.emit())}resetWithRemote(){const e=this.getInitialState();for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];e.blockIds=new Set(...n),this.setState(e)}}var E=n(77080),F=n(83212);class Z{static getLocalViewPreferenceKey(e){return`${Z.PREFERENCE_KEY_PREFIX}${e}`}constructor(e){this.context=i.default.createValue(void 0),this.reducers=i.default.createValue({}),this.reducerDependencies=new Map,this.resultSet=new B,this.remoteResult=i.default.createValue(void 0),this.remoteCollectionIds=i.default.createValue([]),this.lastRemoteRequest=i.default.createValue(void 0),this.searchOpen=i.default.createValue(!1),this.searchQuery=i.default.createValue(""),this.isLoading=i.default.createValue(!1),this.isLoaded=i.default.createValue(!1),this.loadingDetails=i.default.createValue({type:"load_general"}),this.wasCreatedThisSession=i.default.createValue(!1),this.isFullScreen=i.default.createValue(!1),this.isRootChild=i.default.createValue(!1),this.isInPeekRenderer=i.default.createValue(!1),this.relativeVariables=i.default.createValue({}),this.groupsStore=new D(this),this.groupsLimit=i.default.createValue(I.XD),this.boardColumnsLimit=i.default.createValue(I.XD),this.settingsStore=i.default.createValue({open:!1,stack:[]}),this.filtersBarOpen=i.default.createValue(void 0),this.temporaryState=i.default.createValue({}),this.filterBarItemSettingsStoreMap=new Map,this.frozoneStore=i.default.createValue({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1}),this.filterBarSortSettingsStore=i.default.createValue({open:!1,stack:[]}),this.filterBarCombinatorFilterSettingsState=i.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap=new Map,this.filterOptionsCombinatorFilterSettingsState=i.default.createValue({open:!1,stack:[]}),this.dateRangeStart=i.default.createValue(Date.now()),this.dateRangeEnd=i.default.createValue(Date.now()),this.calendarByMenuOpen=i.default.createValue(!1),this.timelineByMenuOpen=i.default.createValue(!1),this.subitemExpandedStore=i.default.createValue(new Map),this.numberChildrenReceived=i.default.createValue(0),this.numberChildrenUnfurled=i.default.createValue(0),this.renderEmitter=new f.Z,this.remoteRequestStoreCallback=void 0,this.localResultStoreCallback=void 0,this.updateCounter=0,this.isClientModeEnabled=i.default.createValue(!1),this.isViewSpecificClientModeEnabled=i.default.createValue(!1),this.asyncAggregationStatus=i.default.createValue({calculating:!1,aggregation:void 0,changingType:!1}),this.collectionStoresStore=new o.Z((()=>{const e=this.collectionViewBlockStore();if(!e)return[];const t=this.collectionStore();return t?[t]:this.remoteCollectionIds.state.map((t=>R.NW.createChildStore(e,{table:y.v,id:t})))}),{debugName:"collectionStoresStore"}),this.localResultStore=new o.Z((()=>_.pi(this.environment,this)),{useDeepEqual:!0,debugName:"localResultStore"}),this.remoteRequestStore=new o.Z((()=>_.oh(this.environment,this)),{debugName:"remoteRequestStore"}),this.normalizedFormatStore=new o.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore();if(!e||!t)return{};const n=t.getType(),o=this.normalizedQueryStore.state;if(!n||!o)return{};const i=this.normalizedSchemaStore.state,r=g.iB(t.getFormat(),i,t.getQueryStore().getValue(),g.Dg(n));return(0,w.$A)(e.id)?{...r,...(0,A.Vj)()}:r}),{useDeepEqual:!0,debugName:"normalizedFormatStore"}),this.normalizedSchemaStore=new o.Z((()=>{const e=this.context.state;switch(null==e?void 0:e.type){case"collectionTypedView":const t=e.databaseType===m.iS?(0,m.uV)(M.default.getIntl()):{};if(!this.collectionViewBlockStore())return t;const n=this.collectionStoresStore.state;if(0===n.length)return t;const o=(0,u.jf)({schemas:[...n.map((e=>{const t=e.getPropertyMapping(),n=e.getSchema();return u.aQ.toViewSchema(n,t)})),t],onlyPropertyIds:Object.keys(t)});return o.error?t:o.value;case"collectionVirtualView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:const i=this.collectionStore();return i?i.getSchema():c.Kc(M.default.getIntl());default:(0,S.t1)(e)}}),{useDeepEqual:!0,debugName:"normalizedSchemaStore"}),this.normalizedDeletedSchemaStore=new o.Z((()=>{const e=this.collectionStore();return e?e.getDeletedSchema():c.Kc(M.default.getIntl())}),{useDeepEqual:!0,debugName:"normalizedDeletedSchemaStore"}),this.normalizedQueryStore=new o.Z((()=>{const e=this.collectionViewStore();if(e){const t=e.getType();if(t){const n=this.normalizedSchemaStore.state;return(0,d.Qo)({type:t,query2:e.getQueryStore().getValue()},n)}}}),{useDeepEqual:!0,debugName:"normalizedQueryStore"}),this.subitemTreeStore=new o.Z((()=>(0,T.yr)(this,this.environment.currentUser.id)),{debugName:"subitemTreeStore"}),this.shouldShowSpinner=new o.Z((()=>{var e,t;if(!this.isLoading.state)return!1;const n=null===(e=this.lastRemoteRequest.state)||void 0===e?void 0:e.loader,o=null===(t=this.remoteRequestStore.state)||void 0===t?void 0:t.loader;if(!h.Xy(null==n?void 0:n.filter,null==o?void 0:o.filter))return!0;if(!h.Xy(null==n?void 0:n.sort,null==o?void 0:o.sort))return!0;if(!h.Xy(null==n?void 0:n.searchQuery,null==o?void 0:o.searchQuery))return!0;const i=(null==n?void 0:n.reducers)||{},r=(null==o?void 0:o.reducers)||{};for(const a in r){const e=r[a],t=i[a];if(!h.Xy(e,t))return!0}return!1}),{debugName:"shouldShowSpinner"}),this.shouldShowSource=new o.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore(),n=this.collectionStore();if(!e||!t||!n)return!1;return!(e.getCollectionViewSourceCollectionStore()&&this.isFullScreen.state||t.getFormat().hide_linked_collection_name)}),{debugName:"shouldShowSource"}),this.permissionScopes=new o.Z((()=>{const e=this.collectionStore(),t=this.collectionViewStore(),n=this.collectionViewBlockStore(),o=this.isFullScreen.state,i=x.eD({collectionStore:e,collectionViewBlockStore:n,checkNavigableAncestorLocked:!o}),r=Boolean(null==n?void 0:n.isLocked()),a=Boolean(null==e?void 0:e.isSyncedCollection());if(!t||!n)return{canConfigureCollection:i,canConfigureBlock:Boolean((null==n?void 0:n.canEditCollection())&&!n.isLocked()),canEditContent:Boolean((null==n?void 0:n.canEditCollection())||(null==n?void 0:n.canEditContentOnly())),isLocked:r,isSyncedCollection:a};const s=!o&&n.isNavigableAncestorLocked(),l=Boolean(n.inMemoryRecordCache.snapshotData),c=F.Z.getMode(this.environment,n);if(s||l||"comment"===(null==c?void 0:c.permission)||"view"===(null==c?void 0:c.permission))return{canConfigureCollection:i,canConfigureBlock:!1,canEditContent:!1,isLocked:r,isSyncedCollection:a};const d=n.canEditCollection();return{canConfigureCollection:i,canConfigureBlock:Boolean(d&&!r),canEditContent:Boolean(e&&e.canEdit()),isLocked:r,isSyncedCollection:a}}),{debugName:"permissionScopes"}),this.filtersBarOpenStore=new o.Z((()=>{if(this.environment.device.isPhone)return!0;const e=this.filtersBarOpen.state;if(void 0!==e)return e;return this.currentPropertyFiltersStore.state.some((e=>{const t=e.filter;return(0,a.Oo)(t)}))||(0,k.Nq)(this)}),{debugName:"filtersBarOpenStore"}),this.localStateDiffStore=new o.Z((()=>(0,k.Zh)(this,"normalized")),{useDeepEqual:!0,debugName:"localStateDiffStore"}),this.currentCombinatorFilterStore=new o.Z((()=>{var e;const t=this.temporaryState.state.combinatorFilter;return t?t.value:null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.filter}),{useDeepEqual:!0,debugName:"currentCombinatorFilterStore"}),this.currentSubitemFormatStore=new o.Z((()=>{var e,t;const n=E.default.checkGate("collection_level_subitems_setting");if(n&&"hidden"===(null===(e=this.collectionViewStore())||void 0===e||null===(e=e.getFormat().collection_view_subitem)||void 0===e?void 0:e.display_mode))return;const o=n?(0,T.OW)(this):(0,T.jA)(this),i=null===(t=this.collectionViewStore())||void 0===t?void 0:t.getType(),r=(0,k.RL)({collectionContextStore:this,applySubitemFilter:!1}),s=(0,a.kk)(r);return s&&(0,a.SH)(s,(e=>!!(0,a.aN)(e)&&(e.property===(null==o?void 0:o.property)||e.property===(null==o?void 0:o.inverse))))&&i&&!(0,T.Av)(i)?void 0:o}),{useDeepEqual:!0,debugName:"currentSubitemFormatStore"}),this.currentArrowsByFormatStore=new o.Z((()=>(0,C.H5)(this)),{useDeepEqual:!0,debugName:"currentArrowsByFormatStore"}),this.currentPropertyFiltersStore=new o.Z((()=>{const e=this.normalizedSchemaStore.state,t=this.temporaryState.state.propertyFilters;return(t?t.value||[]:this.normalizedFormatStore.state.property_filters||[]).map((t=>{const n=(0,d.dN)(t.filter,e),o=this.collectionViewBlockStore();if(e[t.filter.property]&&n&&(0,a.J5)(e,t.filter.property,n.filter,null==o?void 0:o.getRecordModel))return n&&{id:t.id,filter:n}})).filter(S.$K)}),{useDeepEqual:!0,debugName:"currentPropertyFiltersStore"}),this.currentSortsStore=new o.Z((()=>{var e;const t=this.temporaryState.state.sorts;return t?t.value||[]:(null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.sort)||[]}),{useDeepEqual:!0,debugName:"currentSortsStore"}),this.blockIsPrivateStore=new o.Z((()=>{const e=this.collectionViewBlockStore();if(e)return(0,P.RC)({environment:this.environment,store:e})}),{debugName:"blockIsPrivateStore"}),this.inheritedBlockColorStore=new o.Z((()=>{const e=this.collectionViewBlockStore(),{ThemeModeStore:t}=this.environment;if(!e)return;const n=e.findRecordStoreUIAncestor((e=>Boolean(e instanceof R.G&&e.getRecordStoreUIParent()&&e.getFormat().block_color&&!e.isCollectionView()))).ancestor;if(n&&n instanceof R.G){const e=n.getType(),o=n.getFormat().block_color;if(o){const n=(0,p.gh)({theme:t.state});return e===r.Ti.callout?(0,p.x7)(o,n):(0,p.fi)(o,n)}}}),{useDeepEqual:!0,debugName:"inheritedBlockColorStore"}),this.defaultPageTemplateStore=new o.Z((()=>{var e,t;const n=this.collectionStore(),o=this.collectionViewStore(),i=h.oA([null==o||null===(e=o.getFormat())||void 0===e?void 0:e.collection_view_default_template,null==n||null===(t=n.getFormat())||void 0===t?void 0:t.collection_default_template]),r=null==n?void 0:n.getTemplatePageStores();for(const a of i){if("empty"===a)return;const e=null==r?void 0:r.find((e=>e.id===a.template_page_id));if(null!=e&&e.getAlive())return e}}),{debugName:"defaultPageTemplateStore"}),this.relativeVariableStore=new o.Z((()=>{const e=this.context.state;if(!e)return;const t=e.collectionViewBlockStore;if(!t)return;const n={},o=this.relativeVariables.state;return Object.entries(o).map((e=>{let[o,i]=e;const r=R.NW.createChildStore(t,{id:o,table:y.v}),l=r.getSchema(),c=null==r?void 0:r.getFormat().app_config_uri;c&&(0,v.oN)(l,c)&&(n[o]={},Object.entries(i).map((e=>{var t;let[i,d]=e;const u=R.G.createChildStore(r,{id:d,table:b.iU});if((null===(t=u.getAssociatedCollectionStore())||void 0===t?void 0:t.id)!==o)return;const p=v.qB[c][i].reducer,m=p.getProperty(),f=l[m],g=u.getPropertyValue(m),h=p.getPropertyFilter(l,i);(0,a.CA)({filter:h,filterType:"status",relativeVariableValues:void 0})((0,s.yK)({propertySchema:f,propertyValue:g}))&&(n[o][i]=d)})))})),n}),{useDeepEqual:!0,debugName:"relativeVariableStore"}),this.aliveAutomationCount=new o.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let n=0;for(const o of t)(o.isTriggerType("notification_event")||o.isTriggerType("event"))&&o.getAlive()&&(n+=1);return n}),{debugName:"aliceAutomationCount"}),this.aliveSlackAutomationCount=new o.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let n=0;for(const o of t)o.isTriggerType("notification_event")&&o.getAlive()&&(n+=1);return n}),{debugName:"aliveSlackAutomationCount"}),this.getCompleteSprintButtonContext=new o.Z((()=>{var e,t;const n=this.collectionViewBlockStore();if(!n)return;if((null===(e=this.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("app_config_uri").getValue())!==m.g3)return;const o=this.collectionStore(),i=null==o?void 0:o.getSchemaStore().getKeyStore(m.Es.TaskToSprintRelation).getValue();if(!i)return;if("relation"!==i.type)return;const r=i.collection_pointer;if(!o||!r)return;const a=this.getAutomationCollectionValue(o),s=R.NW.createChildStore(n,r),l=this.getAutomationCollectionValue(s);if(!o.canEdit()||!s.canEdit())return;const c=null==l||null===(t=l.format)||void 0===t?void 0:t.app_config_uri,d=s.getSchema();return c&&v.qB[c]&&(0,v.oN)(d,c)&&a&&l?{blockStore:n,taskCollectionStore:o,taskCollectionValue:a,sprintCollectionStore:s,sprintCollectionValue:l,sprintCollectionSchema:d}:void 0}),{useDeepEqual:!0,debugName:"getCompleteSprintButtonContext"}),this.getSprintSettingsContext=new o.Z((()=>{const e=this.collectionViewBlockStore();if(!e)return;if(this.databaseType!==m.p$&&this.databaseType!==m.iS)return;const t=this.collectionStore();let n;this.databaseType===m.p$?n=m.b0.SprintToTaskRelation:this.databaseType===m.iS?n=m.Es.TaskToSprintRelation:(0,S.t1)(this.databaseType);const o=null==t?void 0:t.getSchemaStore().getKeyStore(n).getValue();if(!o||"relation"!==o.type)return;const i=o.collection_pointer;if(!t||!i)return;const r=R.NW.createChildStore(e,i);let a,s;return this.databaseType===m.p$?(s=t,a=r):this.databaseType===m.iS?(a=t,s=r):(0,S.t1)(this.databaseType),{taskCollectionStore:a,sprintCollectionStore:s}}),{useDeepEqual:!0,debugName:"getSprintSettingsContext"}),this.initialDatabaseItemsVisibleTracker=void 0,this.onItemMount=()=>{var e;null===(e=this.initialDatabaseItemsVisibleTracker)||void 0===e||e.handleItemMount()},this.environment=e}setContext(e){this.context.setState(e)}get contextType(){var e;return null===(e=this.context.state)||void 0===e?void 0:e.type}get databaseType(){const e=this.context.state;if(e){if("collectionTypedView"===e.type)return e.databaseType;if("collectionView"===e.type){const t=e.collectionStore;return null==t?void 0:t.getDatabaseType()}}}collectionViewStore(){const e=this.context.state,t=null==e?void 0:e.type;if(t)switch(t){case"collectionTypedView":case"collectionView":case"collectionVirtualView":return e.collectionViewStore;case"collectionPage":case"collectionViewBlock":return;default:(0,S.t1)(t)}}collectionStore(){const e=this.context.state;if(e&&"collectionTypedView"!==e.type)return"collectionVirtualView"===e.type||"collectionView"===(null==e?void 0:e.type)||"collectionPage"===(null==e?void 0:e.type)?e.collectionStore:void("collectionViewBlock"!==(null==e?void 0:e.type)&&(0,S.t1)(e))}hasSingleCollection(){switch(this.contextType){case"collectionTypedView":case"collectionVirtualView":return!1;case"collectionPage":case"collectionViewBlock":case"collectionView":case void 0:return!0;default:(0,S.t1)(this.contextType)}}collectionViewBlockStore(){const e=this.context.state;return null==e?void 0:e.collectionViewBlockStore}formatStore(){const e=this.context.state;if(e)return"collectionPage"===e.type?e.collectionStore:"collectionView"===e.type||"collectionTypedView"===e.type||"collectionVirtualView"===e.type?e.collectionViewStore:void("collectionViewBlock"!==e.type&&(0,S.t1)(e))}getPropertyFormatKey(){const e=this.context.state;if("collectionPage"===(null==e?void 0:e.type))return"collection_page_properties";if("collectionView"===(null==e?void 0:e.type)){const t=e.collectionViewStore.getType();if(!t)return;return g.oz(t)}}getPropertyFormat(e){var t;const n=null===(t=this.formatStore())||void 0===t?void 0:t.getFormat(),o=null==this?void 0:this.getPropertyFormatKey();if(!n||!o)return;return(n[o]??[]).find((t=>t.property===e))}createUpdateCounter(){return this.updateCounter++,this.updateCounter}shouldUpdate(e){return this.updateCounter===e}getCurrentUserId(){return this.environment.currentUser.id}getViewType(){const e=this.collectionViewStore();if(null!=e&&e.isDefined())return e.getType();const t=this.context.state;return"collectionPage"===(null==t?void 0:t.type)?"page":void 0}currentViewHasSort(){const e=this.normalizedQueryStore.state;return Boolean(e&&e.sort&&e.sort.length>0)}resetLoadingState(){this.isLoading.setState(!1),this.loadingDetails.reset()}getCollectionViewBlockSourceState(){const e=this.collectionViewBlockStore();if(!e)return"uninitialized";if(e.getCollectionViewSourceCollectionStore())return"source";return e.getCollectionViewStores().some((e=>Boolean(e.getCollectionStore())))?"linked":"uninitialized"}getFilterBarItemSettingsStore(e){let t=this.filterBarItemSettingsStoreMap.get(e.id);return t||(t=i.default.createValue({open:!1,stack:[]}),this.filterBarItemSettingsStoreMap.set(e.id,t)),t}getFilterOptionsItemSettingsStore(e){let t=this.filterOptionsItemSettingsStoreMap.get(e.id);return t||(t=i.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap.set(e.id,t)),t}viewIsFlushToTopbar(){if(!this.collectionStore())return!1;if(this.shouldShowSource.state)return!1;if(this.filtersBarOpenStore.state)return!1;return void 0===this.getCompleteSprintButtonContext.state}shouldAllowNewItemCreation(e){const t=this.permissionScopes.state,n="collectionTypedView"===this.contextType;return!t.isSyncedCollection&&(t.canEditContent||n&&(null==e?void 0:e.overrideAllowForTypedViews))}getAutomationCollectionValue(e){if(e.isDefined())return{id:e.id,space_id:e.getSpaceId(),schema:e.getSchema(),format:e.getFormat()}}getPageVisitSourceOverride(){var e;switch(null===(e=this.context.state)||void 0===e?void 0:e.type){case"collectionTypedView":case"collectionVirtualView":return this.context.state.pageVisitSourceOverride;case"collectionPage":case"collectionView":case"collectionViewBlock":case void 0:return;default:(0,S.t1)(this.context.state)}}resultsInViewOrder(e){var t,n;const o=this.collectionViewBlockStore(),i=this.collectionStore();if(!o||!i)return[];const r=this.normalizedFormatStore.state,a="board"===this.getViewType()?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},s=this.normalizedSchemaStore.state,c=r[a.groupByKey],d=(0,S.$K)(c)?(0,l.Qq)({schema:s,groupBy:c}):[],u=Object.values((null===(t=this.localResultStore.state)||void 0===t?void 0:t.reducerResults)??{}).find((e=>"groups"===e.type)),p=(0,I.Cz)({getRecordModel:o.getRecordModel,schema:s,groupBy:c,formatGroups:r[a.groupsFormatKey]??[],schemaGroups:d,reducerResults:(null==u?void 0:u.results)??[],relativeVariableResult:this.relativeVariableStore.state,viewAppConfigUri:null===(n=this.collectionViewStore())||void 0===n?void 0:n.getFormat().app_config_uri});let m;if(0===p.length){const e=this.localResultStore.state;if(e){const t=Object.values(e.reducerResults).find((e=>"results"===e.type));m=((null==t?void 0:t.blockIds)??[]).map((e=>R.G.createChildStore(i,{table:"block",id:e})))}else m=[]}else{m=[];for(const e of p){const t=this.groupsStore.getGroupState(e),n=null==t?void 0:t.resultsStore.state;m.push(...n??[])}}m=h.mN(m,(e=>e.id));const f=e||5;let g;if(this.currentSubitemFormatStore.state){g=[];const e=this.subitemTreeStore.state;for(const t of m){if(g.length>=f)break;const n=e.children.find((e=>e.value.store.id===t.id));if(n){const e=[];(0,T.yU)({results:e,tree:n}),g.push(...e)}}}else g=m;return g.slice(0,f)}}Z.PREFERENCE_KEY_PREFIX="CollectionView:",Z.incrementScrollOffset=600;const L=Z},58421:(e,t,n)=>{n.d(t,{n:()=>i});var o=n(72126);function i(e){const t=e.state;return o.Z$(t.stack)}},6776:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{editMode:void 0,store:void 0}}cloneState(){return i.d9(this.state)}}const a=new r},19511:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},16772:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});n(21703);var o=n(49085),i=n(12139);class r extends o.default{constructor(){super(...arguments),this.lastUpdater=0}getInitialState(){return{type:"closed"}}setState(e){if("completionPopup"===this.state.type&&"results"===this.state.stage&&("completionPopup"!==e.type||"results"!==e.stage)){const{inMemoryRecordCache:e,context:t}=this.state;if(e.cacheUsingThisInstanceAsAnOverride){const n=`CompletionsStore transitioning away from completionPopup results while inMemoryRecord cache is still overriding ${e.cacheUsingThisInstanceAsAnOverride===t.currentPage.inMemoryRecordCache?"page's in-memory cache":"an unknown cache"}!`;i.rn(new Error(n),{from:"CompletionsStore",type:"dangerousStateTransition"})}}super.setState(e)}createUpdater(){const e=++this.lastUpdater;return t=>{if(e===this.lastUpdater)return t()}}invalidateLastUpdater(){this.lastUpdater+=1}resetStore(e){const{environment:t}=e;this.invalidateLastUpdater();const n=this.state;"completionPopup"===n.type&&("initialPromptForAIBlock"!==n.stage&&"initialPrompt"!==n.stage&&t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(n.inMemoryRecordCache),this.setState({type:"closed"}))}getExistingSessionId(){return"closed"!==this.state.type?this.state.sessionId:void 0}isEditingEmptyBlock(){var e;const t=this.state;return Boolean("completionPopup"===t.type&&"initialPrompt"===t.stage&&"cursor"===t.context.type&&(null===(e=t.context.currentBlock)||void 0===e?void 0:e.isEmptyEditableBlock()))}}const a=new r},72371:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(14577),i=n(49085),r=n(92595);class a extends i.default{constructor(){super(...arguments),this.integrations=new o.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ComplianceIntegrationStore.integrations"}),this.webhookSubscriptions=new o.Z((()=>{const e=this.state;return e.loaded?e.webhookSubscriptions:[]}),{debugName:"ComplianceIntegrationStore.webhookSubscriptions"})}getInitialState(){return{loaded:!1,loading:!1}}}const s=new a;(0,r.exposeDebugValue)("ComplianceIntegrationStore",s);const l=s},81700:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},80641:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{bypassedPageIds:new Set}}bypassedPage(e){return this.state.bypassedPageIds.has(e)}bypassPage(e){this.state.bypassedPageIds.add(e),this.emit()}}const r=new i},61893:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(86658),r=n(12955);class a extends o.default{getInitialState(){return{permission:i.UE}}getId(){return this.getState().id}getPermission(){return this.getState().permission}setPermission(e){this.setState({...this.state,permission:e})}async setCookieConsent(e,t){this.setState(t),await(0,r.setCookieConsentCookie)(e,t)}clearCookieConsent(){this.reset(),(0,r.removeCookieConsentCookie)()}}const s=new a},45293:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},56681:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pageId:void 0,lastInteractionTimes:{}}}}const r=new i},28748:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},82246:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61364).Z)},55367:(e,t,n)=>{n.d(t,{Dl:()=>r,ZP:()=>s,vh:()=>i});var o=n(49085);let i=function(e){return e[e.Above=0]="Above",e[e.Below=1]="Below",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Onto=4]="Onto",e}({}),r=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}({});class a extends o.default{getInitialState(){return{isDragging:!1}}}const s=new a},45452:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isDragging:!1,willDrag:!1}}}const r=i},10084:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{initiator:"none",dragging:!1,waiting:!1}}hasDragged(){return this.state.dragging&&!i.Xy(this.state.startingPoint,this.state.currentPoint)}}const a=r},80796:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{initiator:"none",isDragging:!1,disableVerticalEdgeScroll:!1,disableHorizontalEdgeScroll:!1}}}const r=new i},12211:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{dropTargetRectMap:new Map}}}const a=new r;(0,i.exposeDebugValue)("GlobalDropTargetRectStore",a);const s=a},24042:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isTabsFeatureEnabled:!1}}}const r=new i},64233:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},66949:(e,t,n)=>{n.d(t,{P:()=>r,Z:()=>l});var o=n(49085),i=n(92595);let r=function(e){return e.Forward="Forward",e.Backward="Backward",e}({});class a extends o.default{getInitialState(){return{open:!1}}isOpen(){if(this.state.open){this.state;return!0}return!1}}const s=new a;i.exposeDebugValue("EquationAnnotationStore",s);const l=s},77080:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b,localExperimentsV2Key:()=>h});var o=n(14577),i=n(49085);var r=n(12174),a=n(68626),s=n(15157),l=n(72126),c=n(97715),d=n(34886),u=n(97880),p=n(95477),m=n(64496),f=n(80444),g=n(7339);const h="experimentsSettingsV2";class v extends i.default{getInitialState(){return{isLoaded:!1}}updateState(e,t){!e.test&&this.state.isLoaded&&this.state.test||(this.setState(e),(0,m._3)(t)||s.Z.set({userId:e.userId,key:h,value:e}))}setState(e){super.setState(e)}getExperimentsForCurrentSpace(){if(!this.state.isLoaded)return[];if(this.state.test)return this.state.experiments;const e=f.default.state.currentSpaceStore;return e&&this.state.experimentsBySpace[e.id]||this.state.experimentsWithoutSpace}getGroup(e){if(r.TS.has(e))return c.Le;let t;if(this.state.isLoaded){const n=this.getExperimentsForCurrentSpace().find((t=>t.experimentId===e));if(!n)return c.Le;t=n.group}return t||c.Le}getExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t.group})),e}getExperiments(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t})),Object.values(e)}getUsedNonControlExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{"control"!==t.group&&(0,r.DP)(t.experimentId)&&(e[t.experimentId]=t.group)})),e}getAcceptLanguageHeader(){if(this.state.isLoaded)return this.state.acceptLanguageHeader}}const b=new class extends v{constructor(){super(),this.statsigExposureCacheForAnalytics={},this.computedStoreMap=new Map,this.isStatsigEnabled()&&g.C.addListener((()=>{this.recomputeAllGroupStores()}))}isStatsigEnabled(){var e;return Boolean(null===(e=p.default.statsig)||void 0===e?void 0:e.apiKey)}isStatsigEnabledAndInitialized(){return this.isStatsigEnabled()&&g.C.isInitialized()}isLoaded(){return this.state.isLoaded}getGroup(e,t){if(!(0,r.YY)(e)){return this.createComputedGroupStore(`group-${e}`,(()=>super.getGroup(e))).state.group||c.Le}return this.getEligibleGroup({experimentId:e,defaultGroup:c.Le,disableExposureLogging:null==t?void 0:t.disableExposureLogging})}getEligibleGroup(e){const{experimentId:t,defaultGroup:n,parameter:o=g.Z,disableExposureLogging:i=!1}=e,r=o===g.Z;this.state.isLoaded;const a=`eligible-group-${t}-${o}`;return this.createComputedGroupStore(a,(()=>{if(!this.isStatsigEnabledAndInitialized())return;const e=this.validateGroupIsString(g.C.getGroup(t,i));return void 0!==e&&(this.statsigExposureCacheForAnalytics[`statsig-${t}`]=e),r?e:g.C.getGroup(t,i,o,n)})).state.group??n}manuallyLogExperimentExposure(e){g.C.manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.getFeatureGateOverrideForBrowserTest(e);if((0,u.$K)(n))return n;const o=this.getFeatureGateOverrideForUnitTest(e);if((0,u.$K)(o))return o;return this.createComputedGateStore(e,(()=>{if(!this.isStatsigEnabledAndInitialized())return!1;const n=g.C.checkGate(e,t);return this.statsigExposureCacheForAnalytics[`statsig-${e}`]=n,n})).state.gate}getConfigKey(e,t,n){const o=r.LI[e][t];return this.createComputedDynamicConfigKeyStore(e,t,(()=>{var i;return this.isStatsigEnabledAndInitialized()&&(null===(i=g.C.getConfig(e,n))||void 0===i?void 0:i.get(String(t),o))||o})).state.value}logEvent(e,t,n){return this.isStatsigEnabledAndInitialized()?g.C.logEvent(e,t,(0,d.R)(n)):(a.log({level:"error",from:"ExperimentStore.ts",type:"statsigIsNotInitialized",data:{miscDataToConvertToString:{eventName:e,value:t,metadata:(0,d.R)(n),isStatsigEnabled:this.isStatsigEnabled(),isInitialized:g.C.isInitialized()}}}),!1)}getExperimentsMap(){return{...super.getExperimentsMap(),...this.statsigExposureCacheForAnalytics}}getStatsigExperimentsMap(){return this.statsigExposureCacheForAnalytics}updateState(e,t){(void 0===e.userId||this.state.isLoaded&&this.state.userId!==e.userId)&&(this.statsigExposureCacheForAnalytics={}),super.updateState(e,t)}reset(){super.reset(),this.statsigExposureCacheForAnalytics={},this.recomputeAllGroupStores()}async waitUntilStatsigReady(){this.isStatsigEnabled()&&await g.C.waitUntil((()=>g.C.state.ready))}createComputedGroupStore(e,t){return this.createComputedStore(e,(()=>({group:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedGateStore(e,t){return this.createComputedStore(`gate-${e}`,(()=>({gate:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedDynamicConfigKeyStore(e,t,n){return this.createComputedStore(`config-${e}-${String(t)}`,(()=>({value:n(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedStore(e,t){const n=(new Date).getMinutes();let i=this.computedStoreMap.get(e);return i?i.state.lastUpdatedMinute!==n&&i.setShouldRecompute():(i=new o.Z(t,{debugName:`ExperimentStore.${e}`}),i.addListener(l.yR),this.computedStoreMap.set(e,i)),i}recomputeAllGroupStores(){this.computedStoreMap.forEach((e=>{e.enqueueRecompute()}))}getFeatureGateOverrideForBrowserTest(e){}getFeatureGateOverrideForUnitTest(e){}validateGroupIsString(e){return"string"==typeof e?e:void 0}}},30874:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(14577),i=n(49085),r=n(92595),a=n(45953),s=n(77420),l=n(9844);class c extends i.default{constructor(){super(...arguments),this.integrations=new o.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ExternalIntegrationStore.integrations"}),this.bots=new o.Z((()=>{const e=this.state;return e.loaded?e.bots:[]}),{debugName:"ExternalIntegrationStore.bots"}),this.externalAuthentications=new o.Z((()=>{const e=this.state;return e.loaded?e.externalAuthentications:[]}),{debugName:"ExternalIntegrationStore.externalAuthentications"}),this.completeSlackAuthentications=new o.Z((()=>{const e=this.state;return e.loaded?e.completeSlackAuthentications:[]}),{debugName:"ExternalIntegrationStore.completeSlackAuthentications"})}getInitialState(){return{loaded:!1,loading:!1}}getIntegrationsAsRecordMap(){const e=a.Ak.create();return this.integrations.state.forEach((t=>e.setValue({table:l.K2,id:t.id},t))),e}getBotsAsRecordMap(){const e=a.Ak.create();return this.bots.state.forEach((t=>e.setValue({table:s.cZ,id:t.id},t))),e}}const d=new c;(0,r.exposeDebugValue)("ExternalIntegrationStore",d);const u=d},79167:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(49085),i=n(41432),r=n(77657),a=n(72126),s=n(45953),l=n(21202),c=n(77420),d=n(6287),u=n(97880),p=n(63143),m=n(30874);class f extends o.default{getInitialState(){return{externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}}}addFromRecordMapWithRoleJson(e){this.addFromRecordMapWithRole(s.PF.create(e))}addFromRecordMapWithRole(e){const t=e.getByTable(d.v).filter((e=>{var t;let{value:n}=e;return null==n||null===(t=n.value)||void 0===t||null===(t=t.format)||void 0===t?void 0:t.external_object_id})).map((e=>{let{value:t}=e;return(null==t?void 0:t.value)&&{id:t.value.id,table:d.v,spaceId:t.value.space_id}})).filter(u.$K),n=m.Z.getBotsAsRecordMap(),o=e.getByTable(l.iU).filter((e=>{let{value:t}=e;if(!(t&&t.value&&t.value.format&&t.value.format.external_object_id))return!1;if(t.value.type!==i.Ti.externalObjectInstancePage&&t.value.type!==i.Ti.externalObjectInstance)return!1;const o=t.value.format.bot_id;if(!o)return!1;if(!0===m.Z.state.loaded){const e=n.getValue({table:c.cZ,id:o});if(e&&e.integration_id&&e.integration_id===r.U9)return!1}return!0})).map((e=>{let{value:t}=e;return null==t?void 0:t.value})).filter(u.$K),s=a.oA(o.map((e=>{if(e.type===i.Ti.externalObjectInstancePage&&e.parent_table===d.v)return{id:e.parent_id,table:e.parent_table,spaceId:e.space_id}}))),f=(0,p.m8)(o.map((e=>{const t={id:e.id,table:l.iU,spaceId:e.space_id};return[e.id,t]}))),g=(0,p.m8)([...t,...s].map((e=>[e.id,e])));this.setState({externalObjectInstanceBlockPointersMap:{...this.state.externalObjectInstanceBlockPointersMap,...f},externalCollectionInstancePointersMap:{...this.state.externalCollectionInstancePointersMap,...g}})}reset(){this.setState({externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}})}isEmpty(){return 0===Object.keys(this.state.externalCollectionInstancePointersMap).length&&0===Object.keys(this.state.externalObjectInstanceBlockPointersMap).length}}const g=new f},83279:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isLoading:!1,progressPercent:0}}}const r=i},69316:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1,findQuery:""}}}const r=new i},89256:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},73329:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(8297).Z)},17903:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(92595);const i=new(n(45589).Z);(0,o.exposeDebugValue)("FrameScrollerStore",i);const r=i},61738:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(41432);const i={skipIndexSearch:!1,skipRecordPageVisit:!1,skipCreateAppEvents:!1},r={page:i,collection_view:i,collection_view_page:i,external_object_instance_page:i,personal_home_page:{skipIndexSearch:!0,skipRecordPageVisit:!0,skipCreateAppEvents:!0}};var a=n(92595),s=n(35683),l=n(80444);const c=new class{constructor(){this.frecencyStore=void 0,this.spaceId=void 0,this.userId=void 0}get(e){const{currentSpaceStore:t}=l.default.state,n=t&&t.id;return void 0===n||void 0===e?(this.userId=void 0,this.spaceId=void 0,void(this.frecencyStore=void 0)):(this.spaceId===n&&this.userId===e||(this.spaceId=n,this.userId=e,this.frecencyStore=new s._R({store:localStorage,prefix:`BlockFrecency:${e}:${n}`,maxBlocks:100,maxStoredVisits:10,version:s.uP}),this.frecencyStore.initialize()),this.frecencyStore)}};const d={lazyFrecencyStore:c,recordVisit:e=>{const{id:t,type:n,timestampForTestingOnly:i,currentUserId:a,blockType:s}=e;if(function(e){return!(!e||!(0,o.S9)(e))&&r[e].skipRecordPageVisit}(s))return;const l=c.get(a);return l?l.recordVisit({id:t,type:n,timestampForTestingOnly:i}):void 0},sortFrecencyHighToLow:function(e){const{currentUserId:t,items:n,now:o,recordFrecency:i}=e,r=c.get(t);return r?r.sortFrecencyHighToLow({items:n,now:o,recordFrecency:i}):n},getVisitedIds:e=>{const t=c.get(e);return t?t.getVisitedIds():[]},clearForUser:function(e){for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&n.startsWith(`BlockFrecency:${e}`)&&localStorage.removeItem(n)}}};(0,a.exposeDebugValue)("FrecencyStore",d);const u=d},38302:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{isOpen:!1,backgroundAnimationComplete:!0,fullscreenNodeAnimationComplete:!0,startScrollTop:0,skipAnimations:!1,isSaving:!1,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}}}}const a=new r;(0,i.exposeDebugValue)("GlobalFullScreenStore",a);const s=a},81258:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},73796:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},27411:(e,t,n)=>{n.r(t),n.d(t,{GlobalFileUploadStore:()=>i,default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}getKeyState(e){return this.state[e]}setKeyState(e,t){const n=this.state;let o;if(t){var i;const a=t.file.type.indexOf("image")>=0;var r;if(t.file!==(null===(i=n[e])||void 0===i?void 0:i.file)&&a)o=null===(r=n[e])||void 0===r?void 0:r.dataURL,t.dataURL=URL.createObjectURL(t.file);n[e]={...t,dataURL:t.dataURL}}else{var a;o=null===(a=n[e])||void 0===a?void 0:a.dataURL,delete n[e]}if(o){const e=o;setTimeout((()=>{URL.revokeObjectURL(e)}),1e3)}this.emit()}isUploading(){const e=this.state,t=Object.keys(e);for(const n of t){if(e[n])return!0}return!1}getBlockKey(e){return e}}const r=new i},96049:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(14577),i=n(55367),r=n(80796),a=n(69784),s=n(59238);const l=new o.Z((()=>r.Z.state.isDragging||i.ZP.state.isDragging||s.Z.state.isDragging||a.Z.state.isActive),{debugName:"GlobalIsDraggingStore"})},45483:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{openModals:new Set}}}const a=new r,s=a;(0,i.exposeDebugValue)("GlobalModalStore",a)},3418:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{openPopups:new Set,namedOpenPopups:new Set}}hasOpenPopups(){const{openPopups:e,namedOpenPopups:t}=this.getState();return e.size>0||t.size>0}hasOpenMobileSlideUps(){const{openPopups:e,namedOpenPopups:t}=this.getState();if(t.size>0)return!0;for(const n of e){if(n.props.hidesMobileNativeBottomBar)return!0;if(n.isSlideUp(n.props)&&!n.props.preventSlideUpTransition)return!0}return!1}hasOpenMouseCapturePopup(){const{openPopups:e}=this.state;return e.size>0&&Array.from(e.values()).some((e=>!e.props.disableMouseCapture))}closeAll(){for(const n of this.state.openPopups){var e,t;null===(e=(t=n.props).onDismiss)||void 0===e||e.call(t,null)}}addNamedPopup(e){this.state.namedOpenPopups.add(e),this.emit()}removeNamedPopup(e){this.state.namedOpenPopups.delete(e),this.emit()}}const r=new i},69327:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(18466),i=n(49085),r=n(72126),a=n(44615),s=n(21202),l=n(63143),c=n(15447),d=n(2688),u=n(80444),p=n(35661);class m extends i.default{constructor(){super(...arguments),this.userPageVisitListenerReference=void 0,this.recentPageRefreshTimer=void 0,this.isInitialized=!1,this.reinitializeState=async(e,t,n)=>{this.cleanup(e),await(0,c.h_)({environment:e,userId:t,spaceId:n}),this.isInitialized=!0;const o=5*l.hM;this.recentPageRefreshTimer=window.setTimeout((()=>{(0,c.h_)({environment:e,userId:t,spaceId:n})}),o),this.userPageVisitListenerReference=d.Z.addListener((0,a.Ns)(t),r.P2(((e,n)=>(0,c.rw)(t,n)),100),void 0,e)}}getInitialState(){return{recentPages:new Map}}cleanup(e){this.userPageVisitListenerReference&&(d.Z.removeListener(this.userPageVisitListenerReference,e),this.userPageVisitListenerReference=void 0),this.recentPageRefreshTimer&&(clearTimeout(this.recentPageRefreshTimer),this.recentPageRefreshTimer=void 0)}getRecentPagesWithStores(e,t){const n=u.default.state.currentSpaceStore;return n?t.map((t=>({...t,store:p.G.createChildStore(n.getPagesStore(),{table:s.iU,id:t.pageId,spaceId:e})}))):[]}set(e,t){const n=this.getRecentPagesWithStores(e,t);this.update((t=>(t.recentPages.set(e,n),t))),this.emit()}get(e){return this.state.recentPages.get(e)}getWithoutSubscribing(e){return o.Z.withListenerIgnored((()=>this.get(e)))||[]}mergeRecentPages(e,t){const n=this.getRecentPagesWithStores(t,e),o=(this.state.recentPages.get(t)??[]).concat(n),i=r.mN(o,"pageId");this.set(t,i)}}const f=new m},7844:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},475:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},52689:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(54153);const r="currentHighlightColor";class a extends o.default{getInitialState(){return{color:Boolean(localStorage)&&i.Z.get(r)||"yellow_background"}}setHighlightColor(e){i.Z.set(r,e),this.setState({color:e})}}const s=new a},42653:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isPinned:!1}}}const r=new i},20144:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},65686:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(34859);class r extends o.default{getInitialState(){return{capturingAreas:new Set}}getPreventScrollType(){let e=!1,t=!1,n=!1;return this.state.capturingAreas.forEach((o=>{o.props.preventType===i.Z.All?e=!0:o.props.preventType===i.Z.X?t=!0:o.props.preventType===i.Z.Y&&(n=!0)})),e||t&&n?i.Z.All:t?i.Z.X:n?i.Z.Y:i.Z.None}}const a=new r},41577:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{loaded:!1,error:!1}}}const r=i},94416:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},64113:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{focused:!1}}}const r=i},33846:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{inputValue:"",focus:!1}}}const r=i},48863:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},22294:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isEnabled:!0,isKeyboardMode:!1}}setEnabled(e){this.setState({...this.state,isEnabled:e})}setKeyboardMode(e){this.state.isEnabled&&this.setState({isEnabled:!0,isKeyboardMode:e})}}const r=new i},23178:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},23883:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{limitParents:new WeakMap}}setLimitParents(e,t){this.state.limitParents.set(e,t),this.emit()}removeLimitParents(e){this.state.limitParents.delete(e),this.emit()}}const r=new i},22781:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{spinnerVisible:!1,showSpinnerTime:0,containerVisible:!1}}}const r=i},31104:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},37598:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}getEditedBlocksForCollection(e){const t=this.state[e];if(t)return t;{const t=new Set;return this.state[e]=t,t}}setEditedBlock(e,t){this.getEditedBlocksForCollection(e).add(t),this.emit()}}const r=new i},84166:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{}const r=new i},91390:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1}}}const r=new i},19111:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72087);class r extends o.default{getInitialState(){return{open:!1,userRequestStore:new i.Z,botRequestStore:new i.Z,pageRequestStore:new i.Z,mentionTypes:{page:!1,createPage:!1,user:!1,bot:!1,date:!1,reminder:!1,templateVariable:!1,group:!1}}}}const a=new r},29798:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0,isInitialized:!1}}}setState(e){super.setState({...e,focus:{...e.focus,isInitialized:!0}})}update(e){this.setState(e({...this.state}))}unsetFocus(){this.setState({...this.state,focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0}})}}const r=i},38072:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pageType:"page",databaseIds:{tasks:void 0,projects:void 0}}}setCollectionIdForType(e,t){this.state.databaseIds[e]=t}getCollectionIdForType(e){return this.state.databaseIds[e]}}const r=new i},69454:(e,t,n)=>{n.d(t,{Z:()=>c,i:()=>s});var o=n(49085),i=n(72126),r=n(5162),a=n(3418);let s=function(e){return e[e.willHide=0]="willHide",e[e.hidden=1]="hidden",e[e.willShow=2]="willShow",e[e.shown=3]="shown",e}({});class l extends o.default{constructor(){var e;super(...arguments),e=this,this.updateKeyboardPhaseDebounced=i.Ds(((e,t)=>{this.setState({...this.state,phase:e,estimatedKeyboardWebViewOverlap:t})}),300),this.updateKeyboardPhase=(e,t,n)=>{e.device.isAndroid&&e.device.isMobileNative?this.updateKeyboardPhaseDebounced(t,n):this.setState({...this.state,phase:t,estimatedKeyboardWebViewOverlap:n})},this.updateShouldResizeWebview=function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v2";const{mobileNative:i}=t;switch(o){case"v1":const t=null==i?void 0:i.api.setShouldResizeWebView;t&&t(n);break;case"v2":const o=null==i?void 0:i.api.setShouldResizeWebViewV2;(0,r.Y)("supportsWebViewResizingOnSelection")&&o&&(e.setState({...e.state,shouldResizeWebView:n}),o(n).then((t=>{t.length>0&&e.setState({...e.state,shouldResizeWebView:t[0]})})))}},this.estimatedNativeWebBottomOverlap=e=>{if((0,r.Y)("supportsNativeBottomBarOverlappingWebView")){const t=a.Z.hasOpenMobileSlideUps()?0:((null==e?void 0:e.WindowSizeStore.state.paddingBottom)??0)+48;return Math.max(this.estimatedKeyboardWebViewOverlap(),t)}return this.estimatedKeyboardWebViewOverlap()},this.estimatedKeyboardWebViewOverlap=()=>(0,r.Y)("supportsFixedSizeWebView")?(0,r.Y)("supportsWebViewResizingOnSelection")&&this.state.shouldResizeWebView?0:this.state.estimatedKeyboardWebViewOverlap:this.state.phase!==s.willShow||(0,r.Y)("supportsWebViewResizingOnKeyboardWillShow")?0:this.state.estimatedKeyboardWebViewOverlap}getInitialState(){return{phase:s.hidden,estimatedKeyboardWebViewOverlap:0,shouldResizeWebView:!1}}async onShow(e){await this.waitUntil((()=>this.state.phase===s.shown)),e()}async onHide(e){await this.waitUntil((()=>this.state.phase===s.hidden)),e()}}const c=new l},31792:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{mouseEntered:!1,mousePressed:!1}}enter(){this.setState({...this.state,mouseEntered:!0})}exit(){this.setState({...this.state,mouseEntered:!1})}}const r=i},17294:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},42330:(e,t,n)=>{n.d(t,{ZP:()=>s,o1:()=>i,rJ:()=>a});var o=n(49085);const i=["page","space","team","space-private-pages"];class r extends o.default{getInitialState(){return{isOpen:!1,lastPageId:void 0}}getVariant(){if(this.state.isOpen)return this.state.variant}getTargetsDatabaseType(){if(this.state.isOpen)return a(this.state.targets)}}function a(e){var t;if(0===e.length)return;const n=null===(t=e[0].getAssociatedCollectionStore())||void 0===t?void 0:t.getDatabaseType();if(n){for(const t of e){var o;if(n!==(null===(o=t.getAssociatedCollectionStore())||void 0===o?void 0:o.getDatabaseType()))return}return n}}const s=new r},89087:(e,t,n)=>{n.r(t),n.d(t,{TEST_ONLY__setTransactionQueue:()=>be,setupTransactionQueue:()=>ve,transactionQueue:()=>he});n(57658),n(21703);var o=n(92595),i=n(7406),r=n(68626),a=n(72126),s=n(91155),l=n(4615),c=n(482),d=n(97880),u=n(63143),p=n(99757),m=n(21830);const f="Transaction",g="bySessionId",h="byTimestamp",v="byId",b="byUserId",y="Session",S="bySessionId",_="byUpdatedAt",w="byOwnerSessionId";const k=45*u.C0;class I{constructor(e,t){this.db=void 0,this.debugLogger=void 0,this.runOptimizedScans=!0,this.activeTasks=new Map,this.ownedSessionIds=new Set,this.db=new m.pz(t,"TransactionStore",2,{upgrade(e,t,n,o){if(t<1&&function(e){const t=e.createObjectStore(y,{keyPath:d.MN("index"),autoIncrement:!0});t.createIndex(_,d.MN("updatedAt"),{unique:!1}),t.createIndex(w,d.MN("ownerSessionId"),{unique:!1}),t.createIndex(S,d.MN("sessionId"),{unique:!0});const n=e.createObjectStore(f,{keyPath:d.MN("index"),autoIncrement:!0});n.createIndex(h,d.MN("timestamp"),{unique:!1}),n.createIndex(g,[d.MN("sessionId"),d.MN("timestamp")],{unique:!1}),n.createIndex(v,d.MN("id"),{unique:!0})}(e),t<2){o.objectStore(f).createIndex(b,d.MN("userId"))}}}),this.debugLogger=e,this.runOptimizedScans=!t.device.isEdgeHTML}async DEV_ONLY_deadlockDb(e){throw new Error("This function is only available in development builds.")}async heartbeat(e,t){const n=t?[y,f]:[y],o=await this.db.startTransaction({storeNames:n,mode:"readwrite",name:"IndexedDBTransactionStore.heartbeat",timeoutMs:void 0},(async(n,o)=>{const i=new Set,a=n.objectStore(y);let l=await a.index(w).openCursor(e);o("Obtained session cursor.");let c=0;for(;l;){c+=1;const t=l.value;t.sessionId!==e&&i.add(t.sessionId);const n={...t,updatedAt:Date.now()};l.update(n),l=await l.continue()}if(o(`Finished processing ${c} sessions.`),t){const e=n.objectStore(f).index(v),t=Date.now()-k;o(`Processing ${this.activeTasks.size} active tasks.`),this.activeTasks.forEach((async n=>{if(n.timestamp>=t)return;if(!(await e.get(n.id))){if(n.callback)try{n.callback(void 0)}catch(o){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollectCleanupError",error:(0,s.Ui)(o)})}this.debugLogger.flush(),r.log({level:"warning",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollect",data:{miscDataToConvertToString:{task:n,expireTime:t}}}),this.activeTasks.delete(n.id)}}))}return{value:i}}));return o.error?o:(this.ownedSessionIds=o.value,{value:void 0})}async claimSessions(e,t){const n=await this.db.startTransaction({storeNames:[y],mode:"readwrite",name:"IndexedDBTransactionStore.claimSessions",timeoutMs:void 0},(async(n,o)=>{const i=[],r=n.objectStore(y);let a=await r.index(_).openCursor(IDBKeyRange.upperBound(t));for(o("Obtained session cursor.");a;){const t=a.value,n={...t,ownerSessionId:e,updatedAt:Date.now()};i.push(t.sessionId),o(`Taking ownership of session ${t.sessionId}.`);const r=Date.now()-t.updatedAt;this.debugLogger.log({from:"IndexedDBTransactionStore",level:"debug",type:"claimSession",data:{message:`claimed ${t.sessionId} updated ${r}ms ago`,sessionId:t.sessionId,sinceLastUpdate:r}}),a.update(n),a=await a.continue()}return{value:i}}));if(n.error)return n;for(const o of n.value)this.ownedSessionIds.add(o);return{value:void 0}}getTasks(e,t){return this.db.startTransaction({storeNames:[y,f],mode:"readonly",name:"IndexedDBTransactionStore.getTasks",timeoutMs:void 0},(async(n,o)=>{let i;const r=[],a=n.objectStore(y);let s=await a.index(w).openCursor(e);for(o("Obtained session cursor.");s;){const e=s.value;r.push(e),s=await s.continue()}if(o(`Found ${r.length} owned sessions.`),0===r.length)return{value:void 0};r.sort(((e,t)=>e.index-t.index));const l=r[0].sessionId,d=[];let u=await this.createTransactionCursor(n,l);for(;u;){const e=u.value;(0,c.d)(e.operations);const t=this.activeTasks.get(e.id);e.sessionId===l&&d.push({...e,callback:t&&t.callback}),u=await u.continue()}return o(`Found ${d.length} tasks.`),i={sessionId:l,tasks:d},t?i.tasks.sort(((e,t)=>e.index&&t.index?e.index-t.index:e.timestamp-t.timestamp)):i.tasks.sort(((e,t)=>e.timestamp-t.timestamp)),{value:i}}))}saveTask(e,t,n){const o={id:t.id,userId:t.userId,spaceId:t.spaceId,sessionId:e,timestamp:t.timestamp,debug:t.debug,operations:t.operations,useSudoMode:t.useSudoMode};return p.Z.setOrIncTotal(this.activeTasks.size+1),this.activeTasks.set(o.id,t),this.db.startTransaction({storeNames:[y,f],mode:"readwrite",name:"IndexedDBTransactionStore.saveTask",timeoutMs:n},(async(t,n)=>{const r=t.objectStore(y),a=await r.index(S).get(e);if(n("Obtained session cursor."),!a){const t={sessionId:e,updatedAt:Date.now(),ownerSessionId:e};n(`Adding session ${t.sessionId}.`);try{await r.add(t)}catch(s){throw(0,m.XH)((0,i.tg)(s),`session ${t.sessionId}`)}}try{await t.objectStore(f).add(o)}catch(s){throw(0,m.XH)((0,i.tg)(s),`task ${o.id}`)}return this.debugLogger.log({from:"IndexedDBTransactionStore",type:"saveTask",level:"debug",data:{message:`create task ${o.id} in ${a?"existing":"NEW"} session ${e}`,sessionId:e,taskId:o.id,isNewSession:!Boolean(a)}}),{value:void 0}}))}async deleteSession(e){const{currentSessionId:t,sessionId:n}=e,o=await this.db.startTransaction({storeNames:[y,f],mode:"readwrite",name:"IndexedDBTransactionStore.deleteSession",timeoutMs:void 0},(async(e,o)=>{let i=await this.createTransactionCursor(e,n);for(o("Obtained transaction cursor.");i;){if(i.value.sessionId===n)return{value:`Attempt to delete non-empty session: has task ${i.value.id}`,abort:!0};i=await i.continue()}const r=e.objectStore(y),a=await r.index(S).get(n);if(!a)return{value:"Session is missing",abort:!0};const s=a;return s.ownerSessionId!==t?{value:`Attempt to delete another tab's session: owned by ${s.ownerSessionId}`,abort:!0}:(r.delete(s.index),{value:void 0})}));return o.error?o:o.value?{error:{type:"LogicalError",message:o.value,userDetails:"Could not perform an operation due to a logical error."}}:{value:void 0}}hasTasks(){return this.activeTasks.size>0||this.ownedSessionIds.size>0}getTotalNumberOfTasks(e){return this.db.startTransaction({storeNames:[f],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasks",timeoutMs:e},(async e=>{const t=e.objectStore(f);return{value:await t.count()}}))}getTotalNumberOfTasksForUser(e,t){return this.db.startTransaction({storeNames:[f],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasksForUser",timeoutMs:t},(async t=>{const n=t.objectStore(f).index(b);return{value:await n.count(e)}}))}async anySessionHasTasks(e){const t=await this.getTotalNumberOfTasks(e);return t.error?t:{value:t.value>0}}async hasTasksForUser(e,t){const n=await this.getTotalNumberOfTasksForUser(e,t);return n.error?n:{value:n.value>0}}hasTask(e){for(const[,t]of this.activeTasks)if(e(t))return!0;return!1}async deleteTasks(e){const t=await this.db.startTransaction({storeNames:[f,y],mode:"readwrite",name:"IndexedDBTransactionStore.deleteTasks",timeoutMs:void 0},(async(t,n)=>{const o=[],i=[],a=new Set,s=t.objectStore(f),l=s.index(v),c=t.objectStore(y);await(0,m.qv)(e.map((0,m.zp)((async e=>{o.push(e.id);const t=await l.openCursor(e.id);if(n(`Obtained transaction cursor for task ${e.id}.`),t){a.add(t.value.sessionId),await t.delete(),n(`Deleted task ${e.id}.`);const o=String(e.id);this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${e.id}`,taskId:o}})}else this.debugLogger.flush(),r.log({from:"IndexedDBTransactionStore",type:"deleteTasksTaskNotExist",level:"warning",data:{message:`could not delete task not stored in indexeddb ${e.id}`,taskId:e.id}})}))));const d=s.index(g);return a.forEach((async e=>{let n=0;if(this.runOptimizedScans)n=await d.count(this.getTransactionRange(e));else{let o=await this.createTransactionCursor(t,e);for(;o;){if(o.value.sessionId===e){n++;break}o=await o.continue()}}if(0===n){const t=await c.index(S).openCursor(e);t&&(i.push(t.value.sessionId),t.delete(),this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteSession",level:"debug",data:{message:`delete empty session ${e}`,sessionId:e}}))}})),{value:{deletedTaskIds:o,deletedSessionIds:i}}}));if(t.error)return t;const{deletedTaskIds:n,deletedSessionIds:o}=t.value;for(const i of n)this.activeTasks.delete(i);for(const i of o)this.ownedSessionIds.delete(i);return p.Z.updateRemaining(this.activeTasks.size),{value:void 0}}async checkObjectStores(){const e="IndexedDBTransactionStore.checkObjectStores",t=this.db.startTransaction({storeNames:["Session"],mode:"readonly",name:`${e}: read from Session object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),n=this.db.startTransaction({storeNames:["Transaction"],mode:"readonly",name:`${e}: read from Transaction object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),[o,i]=await Promise.all([t,n]);return{session:o,transaction:i}}async reset(){await this.db.reset(),this.activeTasks.clear(),this.ownedSessionIds.clear(),p.Z.updateRemaining(0)}async clearTasksForUser(e){const t=await this.db.startTransaction({storeNames:[f],mode:"readwrite",name:"IndexedDBTransactionStore.clearTasksForUser",timeoutMs:void 0},(async(t,n)=>{const o=[],i=t.objectStore(f);let r=await i.index(b).openCursor(IDBKeyRange.only(e));for(n("Obtained transaction cursor.");r;)o.push(r.value.id),await r.delete(),r=await r.continue();return{value:{deletedTaskIds:o}}}));if(t.error)return t;const{deletedTaskIds:n}=t.value;for(const o of n)this.activeTasks.delete(o);p.Z.updateRemaining(this.activeTasks.size)}getTransactionRange(e){return IDBKeyRange.bound([e,0],[e,Number.MAX_VALUE],!0,!0)}createTransactionCursor(e,t){const n=e.objectStore("Transaction");return this.runOptimizedScans?n.index(g).openCursor(this.getTransactionRange(t),"next"):n.openCursor()}}var C=n(15517),x=n(54064),T=n(29477),M=n(606),P=n(12139);function A(e,t){t.startsWith("offline -")?t="offline":t.startsWith("mobileNativeError -")&&(t="mobileNativeError");const n=e[t]||0;e[t]=n+1,e._total+=1}const R=1*u.C0,D=.5*u.C0,B=10*u.C0,E=5*u.C0;var F=n(88632);function Z(){p.Z.setState({...p.Z.state,connectionError:void 0})}function L(e){const{connectionError:t}=p.Z.state,n=Date.now(),o=void 0===e.backoffEstimate?void 0:e.backoffEstimate+n;p.Z.setState({...p.Z.state,connectionError:{startTime:(null==t?void 0:t.startTime)??n,numAttempts:t?t.numAttempts+1:1,approximateBackoffDelayEndTime:o,retryReason:e.retryReason??(null==t?void 0:t.retryReason)}})}const j={onReset:Z,onBackoff(e,t){L({backoffEstimate:e,retryReason:t})}};var V=n(97664),U=n(20985);async function O(e,t){await U.i6`
		INSERT OR REPLACE INTO transactions (
		    id,
		    user_id,
		    space_id,
		    operations,
		    timestamp,
			debug
		)
		VALUES (
		    ${t.id},
		    ${t.userId||null},
		    ${t.spaceId||null},
		    ${JSON.stringify(t.operations)},
		    ${t.timestamp},
			${t.debug?JSON.stringify(t.debug):null}
		)
	`.run(e)}function N(e){try{const t=JSON.parse(e);if(!Array.isArray(t))throw new Error(`JSON value is not an array: ${t}`);return t}catch(t){return r.log({from:"sqliteTransactionStorage",level:"error",type:"safeParseArray",error:(0,s.Ui)(t)}),[]}}async function z(e){return(await(0,V.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions"}))[0].count}async function H(e,t){return(await(0,V.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions WHERE user_id = ?",args:[t]}))[0].count}async function W(e){await U.i6`DELETE FROM transactions`.run(e)}async function q(e,t){const[n]=await(0,V.G$)({connection:e,statements:[{sql:"SELECT * FROM transactions WHERE user_id = ?",args:[t],getData:!0},{sql:"DELETE FROM transactions WHERE user_id = ?",args:[t]}],queryName:"deleteTransactionsForUser"});return n.data.map((e=>e.id))}const G="NativeBackedTransactionQueue";class K{constructor(e,t,n){this.lastTaskTimestamp=0,this.tasks=new Map,this.sessionId="00000000-0000-0000-0000-000000000000",this.events=new x.Z,this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new r.BatchedLogger({from:G,type:"BulkDebug",level:"info",maxLength:250}),this.connection=e,this.dependencies=t,r.log({from:G,level:"debug",type:"NativeBackedTransactionQueueCreated"}),n.subscribeToUpdateTransactionState((e=>this.updateTransactionState(e)))}async enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;var n;(this.tasks.set(e.id,{...e,sessionId:this.sessionId}),this.hasTooManyOperations(e))&&r.log({from:G,type:"enqueueTask",level:"warning",data:{message:`enqueing task with operation count > ${K.operationCountWarningThreshold}`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(n=e.debug)||void 0===n?void 0:n.userAction,miscDataToConvertToString:{operationsCount:e.operations.length}}});const o=JSON.stringify(e.operations).length;var i;this.stringifiedOperationSizeIsTooLarge(o)&&r.log({from:G,type:"enqueueTask",level:"warning",data:{message:`enqueing task with stringified operation count > ${K.stringifiedOperationSizeByteThreshold} bytes`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(i=e.debug)||void 0===i?void 0:i.userAction,miscDataToConvertToString:{operationsCount:e.operations.length,stringifiedOperationsSize:o}}});await O(this.connection,e),this.debugLogger.log({from:G,type:"enqueueTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}})}startLoop(){this.dependencies.timeSource.setTimeout((()=>this.healthcheckLoop()),1)}unpause(){}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return await H(this.connection,e)>0}async getTotalNumberOfTasks(){return await z(this.connection)}async anySessionHasTasks(){return await this.getTotalNumberOfTasks()>0}async reset(){await W(this.connection),this.tasks.clear()}async clearForUser(e){const t=await q(this.connection,e);for(const n of t)this.tasks.delete(n)}updateDependencies(e){this.dependencies=e}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,M.qo)(t.pointer,e)))))}hasTooManyOperations(e){return e.operations.length>=K.operationCountWarningThreshold}stringifiedOperationSizeIsTooLarge(e){return e>=K.stringifiedOperationSizeByteThreshold}async drain(){return this.tasks.size>0?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();e>K.transactionSizeHealthcheckThreshold&&(this.debugLogger.flush(),r.log({level:"info",from:"NativeBackedSqliteTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck({queue_type:"NativeBackedSqliteTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:F.Z.state.online,retry_reasons:this.retryReasonCounters}))}catch(e){this.debugLogger.flush(),r.log({level:"error",from:"NativeBackedSqliteTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),P.IE(e)}await T.Vs(K.healthcheckInterval,this.dependencies.timeSource)}}updateTransactionState(e){(e.syncing||this.hasTasks())&&F.Z.setState({...F.Z.state,syncing:!0});let t=[],n=[];if(e.saveTransactionResult)if(e.saveTransactionResult.error){const{retryReason:o}=e.saveTransactionResult.error;o?A(this.retryReasonCounters,o):this.retryReasonCounters={_total:0},t=e.saveTransactionResult.error.savedTasks.map((e=>this.tasks.get(e.id))).filter(d.$K),n=e.saveTransactionResult.error.failedTasks.map((e=>this.tasks.get(e.id))).filter(d.$K),L({backoffEstimate:void 0,retryReason:o})}else this.retryReasonCounters={_total:0},t=e.saveTransactionResult.value.map((e=>this.tasks.get(e.id))).filter(d.$K),n=[],Z();t.forEach((e=>{if(e.callback)try{e.callback(void 0)}catch(t){this.debugLogger.flush(),r.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateSavedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id)})),n.forEach((e=>{if(e.callback)try{e.callback(new Error(`Failed to save transaction with id: ${e.id}`))}catch(t){this.debugLogger.flush(),r.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateFailedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id),this.dependencies.rollbackTask(e)})),e.syncing||this.hasTasks()||(F.Z.setState({...F.Z.state,syncing:!1}),this.events.emit("drain"))}}K.healthcheckInterval=5*u.hM,K.transactionSizeHealthcheckThreshold=1e3,K.operationCountWarningThreshold=500,K.stringifiedOperationSizeByteThreshold=1e5;var $=n(2414),Q=n(88893),Y=n(77080),J=n(78291);function X(){const{data:e}=J.default.state;return!(!e||(0,Q.CM)(e).length>1)&&Y.default.checkGate("optimize_single_workspace")}const ee="SqliteTransactionQueue";class te{constructor(e,t){this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.tasks=new Map,this.events=new x.Z,this.waiter=void 0,this.transactionBackoffController=new $.h(j),this.sessionId="00000000-0000-0000-0000-000000000000",this.debugLogger=new r.BatchedLogger({from:ee,type:"BulkDebug",level:"info",maxLength:250}),this.connection=e,this.dependencies=t,r.log({from:ee,level:"debug",type:"SqliteTransactionQueueCreated"})}startLoop(){this.dependencies.timeSource.setTimeout((()=>this.txLoop()),1),this.dependencies.timeSource.setTimeout((()=>this.healthcheckLoop()),1)}async enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;this.tasks.set(e.id,{...e,sessionId:this.sessionId}),await O(this.connection,e),this.debugLogger.log({from:ee,type:"saveTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}}),this.getWaitable(!1).trigger()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return await H(this.connection,e)>0}async getTotalNumberOfTasks(){return await z(this.connection)}async anySessionHasTasks(){return await this.getTotalNumberOfTasks()>0}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,M.qo)(t.pointer,e)))))}async reset(){await W(this.connection),this.tasks.clear()}async clearForUser(e){const t=await q(this.connection,e);for(const n of t)this.tasks.delete(n)}updateDependencies(e){this.dependencies=e}async txLoop(){for(;;)try{await this.txLoopIteration()}catch(e){this.debugLogger.flush(),r.log({level:"error",from:ee,type:"txLoopIteration",error:(0,s.Ui)(e)}),P.IE(e),await T.Vs(15e3)}}async txLoopIteration(){const e=this.hasTasks();e||(this.doneSyncing(),this.events.emit("drain"));const[t,n]=X()?[E,B]:[D,R];await this.wait(t,e?t:n);const o=await async function(e){return(await(0,V.gU)({connection:e,sql:"SELECT * FROM transactions"})).map((e=>({id:e.id,userId:e.user_id||void 0,spaceId:e.space_id||void 0,debug:void 0,operations:N(e.operations),timestamp:e.timestamp})))}(this.connection);for(const r of o)(0,c.d)(r.operations);const i=Array.from(o).sort(((e,t)=>e.timestamp-t.timestamp)).map((e=>{const t=this.tasks.get(e.id);if(t){return{...t,...e,callback:t.callback}}return e}));0!==i.length&&(this.startSyncing(),await this.useSaveTransactionsApi(i))}async useSaveTransactionsApi(e){const t=await this.dependencies.handleSaveTransactions(e);if(t.error){const{savedTasks:e,failedTasks:n,message:o,retryDelay:i}=t.error;e.length>0&&(this.debugLogger.log({level:"debug",from:ee,type:"handlePartialSaveTransactionsSuccess",data:{message:`will delete ${e.length} saved tasks`,taskIds:e.map((e=>e.id))}}),await this.cleanupTasks(e,void 0)),n.length>0?(this.debugLogger.flush(),r.log({level:"warning",from:ee,type:"handleSaveTransactionsError",data:{message:o,taskIds:n.map((e=>e.id))},error:(0,s.Ui)(t.error)}),await this.cleanupTasks(n,t.error)):this.debugLogger.log({level:"debug",from:ee,type:"handleSaveTransactionsRetryableError",data:{message:o},error:(0,s.Ui)(t.error)}),i>0?await this.transactionBackoffController.backOffOnFailure(i-D,t.error.retryReason):this.transactionBackoffController.reset()}else{const e=t.value;this.debugLogger.log({level:"debug",from:ee,type:"handleSaveTransactionsSuccess",data:{message:`will delete ${e.length} saved tasks`,taskIds:e.map((e=>e.id))}}),await this.cleanupTasks(e,void 0),this.transactionBackoffController.reset()}}async cleanupTasks(e,t){for(const o of e)if(o.callback)try{o.callback(t)}catch(n){this.debugLogger.flush(),r.log({level:"error",from:"SQLiteTransactionQueue",type:"cleanupTask",data:{taskId:o.id},error:(0,s.Ui)(n)})}for(const o of e)this.debugLogger.log({from:ee,type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${o.id}`,taskId:o.id}}),this.tasks.delete(o.id);await async function(e,t){const n=a.yo(t,V.mz).map((e=>{const t=U.i6`,`.joins(e.map((e=>U.i6`${e}`)));return U.i6`DELETE FROM transactions WHERE id in (${t})`.asWrite()}));await(0,V.G$)({connection:e,statements:n,queryName:"removeTransactions"})}(this.connection,e.map((e=>e.id)))}getWaitable(e){return this.waiter&&!e||(this.waiter=new T.a6(this.dependencies.timeSource)),this.waiter}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}startSyncing(){F.Z.setState({...F.Z.state,syncing:!0})}doneSyncing(){F.Z.setState({...F.Z.state,syncing:!1})}async healthcheckLoop(){for(;;){const e=await this.getTotalNumberOfTasks();e>te.transactionSizeHealthcheckThreshold&&(this.debugLogger.flush(),r.log({level:"info",from:"SqliteTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}})),await T.Vs(te.healthcheckInterval,this.dependencies.timeSource)}}}te.healthcheckInterval=15*u.hM,te.transactionSizeHealthcheckThreshold=1e3;var ne,oe=n(5162),ie=n(82798);n(95477);class re{constructor(e,t,n,o){this.shouldStopLooping=!1,this.attemptedToClaimSessions=!1,this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.events=new x.Z,this.waiter=void 0,this.transactionBackoffController=new $.h(j),this.retryReasonCounters={_total:0},this.errorCounts={},this.startTime=Date.now(),this.disableStorageManagerEstimate=!1,this.dependencies=e,this.transactionStore=t,this.sessionId=n,this.debugLogger=o,r.clientLogglyEnvironmentData.idbSessionId=this.sessionId,this.disableStorageManagerEstimate=Y.default.checkGate("disable_storage_manager_estimate",!0),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"createdIndexedDBTransactionQueue",data:{sessionId:this.sessionId}})}startLoop(){setTimeout((()=>{this.heartbeatLoop()}),1),setTimeout((()=>{this.txLoop()}),1),setTimeout((()=>{this.healthcheckLoop()}),1)}stopLoop(){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"stopLoop",data:{message:"Stopping loop."}}),this.shouldStopLooping=!0}hasAttemptedToClaimSessions(){return this.attemptedToClaimSessions}logEmptyTaskForDebugging(e){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"logEmptyTaskForDebugging",data:{message:`Task created by ${e} was empty.`}})}async enqueueTask(e){const t=await this.transactionStore.saveTask(this.sessionId,e,this.getIndexedDBTimeoutMs());if(this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp),t.error)throw this.incrementErrors(t.error,"enqueueTask"),this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"enqueueTask",error:(0,s.Ui)(t.error)}),t.error;this.clearErrors("enqueueTask"),this.getWaitable(!1).trigger()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return!!this.transactionStore&&this.transactionStore.hasTasks()}async hasTasksForUser(e){const t=await this.transactionStore.hasTasksForUser(e,this.getIndexedDBTimeoutMs());return t.error?(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.hasTasksForUser",error:(0,s.Ui)(t.error)}),!1):t.value}async anySessionHasTasks(){const e=await this.transactionStore.anySessionHasTasks(this.getIndexedDBTimeoutMs());return e.error?(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.anySessionHasTasks",error:(0,s.Ui)(e.error)}),!1):e.value}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return this.hasTask((t=>t.operations.some((t=>(0,M.qo)(t.pointer,e)))))}async reset(){await this.transactionStore.reset()}async clearForUser(e){await this.transactionStore.clearTasksForUser(e)}async checkObjectStores(){return await this.transactionStore.checkObjectStores()}async getTotalNumberOfTasks(){const e=await this.transactionStore.getTotalNumberOfTasks(this.getIndexedDBTimeoutMs());return e.error?(r.log({level:"error",from:"IndexedDBTransactionQueue",type:"getTotalNumberOfTasks",error:(0,s.Ui)(e.error)}),0):e.value}startSyncing(){F.Z.setState({...F.Z.state,syncing:!0})}updateDependencies(e){this.dependencies=e}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}async txLoop(){for(;!this.shouldStopLooping;)try{await this.txLoopIteration(),this.clearErrors("txLoop")}catch(e){this.incrementErrors(e,"txLoop"),A(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"txLoopIteration",error:(0,s.Ui)(e)}),P.IE(e),await T.Vs(15e3)}}async txLoopIteration(){const e=await this.getTasks();if(!e)return this.events.emit("drain"),void(await this.wait(...this.getMinMaxLoopDelay(!1)));const{tasks:t,sessionId:n}=e;if(0===t.length){const e=await this.transactionStore.deleteSession({currentSessionId:this.sessionId,sessionId:n});return void(e.error&&(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteSession",data:{sessionId:n},error:(0,s.Ui)(e.error)})))}this.startSyncing(),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSubmitTransactionAttempt",data:{message:`for session ${n}: attempt submitTransaction with ${t.length} tasks`,sessionId:n,taskIds:ae(t)}}),await this.useSaveTransactionsApi(t,n);const o=this.hasTasks();o||(this.doneSyncing(),this.events.emit("drain")),await this.wait(...this.getMinMaxLoopDelay(o))}getMinMaxLoopDelay(e){const[t,n]=X()?[E,B]:[D,R];return Boolean(e)?[t,t]:[t,n]}async useSaveTransactionsApi(e,t){const n=await this.dependencies.handleSaveTransactions(e);if(n.error){const{savedTasks:e,failedTasks:o,message:i,retryDelay:a,retryReason:l}=n.error;l?A(this.retryReasonCounters,l):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handlePartialSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:ae(e),sessionId:t}}),await this.cleanupTasks(e,void 0)),o.length>0?(this.debugLogger.flush(),r.log({level:"warning",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsError",data:{message:`for session ${t}: ${i}`,taskIds:ae(o),sessionId:t},error:(0,s.Ui)(n.error)}),await this.cleanupTasks(o,n.error)):this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsRetryableError",data:{message:`for session ${t}: ${i}`,sessionId:t}}),a>0?await this.transactionBackoffController.backOffOnFailure(a-D,n.error.retryReason):this.transactionBackoffController.reset()}else{const e=n.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:ae(e),sessionId:t}}),await this.cleanupTasks(e,void 0),this.transactionBackoffController.reset()}}incrementErrors(e,t){void 0===this.errorCounts[t]?this.errorCounts[t]=1:this.errorCounts[t]+=1;const n=a.Fp(Object.values(this.errorCounts))||0;this.errorCounts[t]===re.maxErrors+1&&(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:`maxErrors.${t}`,error:(0,s.Ui)(e)})),n>re.maxErrors&&p.Z.setState({...p.Z.state,transactionQueueError:e})}clearErrors(e){this.errorCounts[e]&&delete this.errorCounts[e];(a.Fp(Object.values(this.errorCounts))||0)<=re.maxErrors&&p.Z.setState({...p.Z.state,transactionQueueError:void 0})}async heartbeatLoop(){for(;!this.shouldStopLooping;)try{await this.heartbeat(),await T.Vs(re.heartbeatInterval)}catch(e){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"heartbeatLoopIteration",error:(0,s.Ui)(e)}),await T.Vs(re.heartbeatInterval)}}async heartbeat(){{const e=await this.transactionStore.heartbeat(this.sessionId,!0);if(e.error)return this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.heartbeat",error:(0,s.Ui)(e.error)}),void this.incrementErrors(e.error,"heartbeat");this.clearErrors("heartbeat")}{const e=Date.now()-re.claimSessionDelay,t=await this.transactionStore.claimSessions(this.sessionId,e);if(t.error)return this.debugLogger.flush(),void r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.claimSessions",error:(0,s.Ui)(t.error)});this.attemptedToClaimSessions=!0}this.checkStorageQuota()}async checkStorageQuota(){if(this.disableStorageManagerEstimate)return;const e=await(0,C.sK)();e&&(r.clientLogglyEnvironmentData.storageQuotaEstimate=e.quota,r.clientLogglyEnvironmentData.storageUsageEstimate=e.usage,p.Z.setState({...p.Z.state,storageUsageEstimate:e}))}doneSyncing(){F.Z.setState({...F.Z.state,syncing:!1})}hasTask(e){return this.transactionStore.hasTask(e)}async getTasks(){const e="on"===this.dependencies.getExperimentGroup("sort_indexeddb_tasks_by_index"),t=await this.transactionStore.getTasks(this.sessionId,e);if(t.error)throw t.error;return t.value}async cleanupTasks(e,t){for(const i of e)if(i.callback)try{i.callback(t)}catch(o){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"cleanupTask",data:{taskId:i.id},error:(0,s.Ui)(o)})}const n=await this.transactionStore.deleteTasks(e);n.error&&(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteTasks",error:(0,s.Ui)(n.error)}))}getWaitable(e){return this.waiter&&!e||(this.waiter=new T.a6),this.waiter}async healthcheckLoop(){for(;!this.shouldStopLooping;){try{var e;const t=await this.transactionStore.getTotalNumberOfTasks(re.defaultIndexedDBTimeoutMs),n={queue_type:"IndexedDBTransactionQueue",uptime:Date.now()-this.startTime,queue_size:t.error?void 0:t.value,error_type:null===(e=t.error)||void 0===e?void 0:e.type,is_considered_online:F.Z.state.online,retry_reasons:this.retryReasonCounters};(n.queue_size&&n.queue_size>re.transactionSizeHealthcheckThreshold||n.error_type)&&(this.debugLogger.flush(),r.log({level:"info",from:"IndexedDBTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:n}}),this.dependencies.handleHealthcheck(n))}catch(t){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(t)}),P.IE(t)}await T.Vs(re.healthcheckInterval)}}getIndexedDBTimeoutMs(){if("on"===this.dependencies.getExperimentGroup("indexeddb-transaction-timeout-v2"))return re.defaultIndexedDBTimeoutMs}}function ae(e){return e.map((e=>{var t;return null!==(t=e.debug)&&void 0!==t&&t.userAction?`${e.id} (${e.debug.userAction})`:e.id}))}ne=re,re.heartbeatInterval=2.5*u.C0,re.claimSessionDelay=5*ne.heartbeatInterval,re.healthcheckInterval=15*u.hM,re.transactionSizeHealthcheckThreshold=1e3,re.maxErrors=5,re.defaultIndexedDBTimeoutMs=180*u.C0;const se=re;class le{constructor(e,t){this.activeQueue=void 0,this.inMemoryTransactionQueue=void 0,this.indexedDBDrainListener=void 0,this.debugLogger=void 0,this.activeQueue=e,this.inMemoryTransactionQueue=t,this.indexedDBDrainListener=()=>this.handleIndexedDBQueueDrain(),this.debugLogger=new r.BatchedLogger({from:"IndexedDBToInMemoryTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),setTimeout((()=>{this.activeQueue instanceof se&&(this.debugLogger.log({level:"error",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"IndexedDBTransactionQueue has not drained after 5 minutes."}}),this.debugLogger.flush())}),5*u.hM)}startLoop(){if(this.activeQueue instanceof se){this.activeQueue.events.addListener("drain",this.indexedDBDrainListener)}this.activeQueue.startLoop()}handleIndexedDBQueueDrain(){const e=(0,ie.R9)(this.activeQueue,se);e.hasAttemptedToClaimSessions()&&(e.stopLoop(),e.events.removeListener("drain",this.indexedDBDrainListener),this.inMemoryTransactionQueue.startLoop(),this.activeQueue=this.inMemoryTransactionQueue,this.debugLogger.log({level:"info",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"Switching over from IndexedDBTransactionQueue to InMemoryTransactionQueue."}}))}logEmptyTaskForDebugging(e){var t,n;null===(t=(n=this.activeQueue).logEmptyTaskForDebugging)||void 0===t||t.call(n,e)}enqueueTask(e){return this.activeQueue.enqueueTask(e)}unpause(){this.activeQueue.unpause()}pause(){this.activeQueue.pause()}getLastTaskTimestamp(){return this.activeQueue.getLastTaskTimestamp()}hasTasks(){return this.activeQueue.hasTasks()}anySessionHasTasks(){return this.activeQueue.anySessionHasTasks()}getTotalNumberOfTasks(){return this.activeQueue.getTotalNumberOfTasks()}hasTasksForUser(e){return this.activeQueue.hasTasksForUser(e)}drain(){return this.activeQueue.drain()}awaitRecordTransaction(e){return this.activeQueue.awaitRecordTransaction(e)}isPendingTransactionForRecord(e){return this.activeQueue.isPendingTransactionForRecord(e)}reset(){return this.activeQueue.reset()}clearForUser(e){return this.activeQueue.clearForUser(e)}updateDependencies(e){this.activeQueue.updateDependencies(e),this.inMemoryTransactionQueue!==this.activeQueue&&this.inMemoryTransactionQueue.updateDependencies(e)}}const ce="InMemoryTransactionQueue";class de{constructor(e){this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.tasks=new Map,this.events=new x.Z,this.waiter=void 0,this.transactionBackoffController=new $.h(j),this.sessionId="00000000-0000-0000-0000-000000000000",this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new r.BatchedLogger({from:ce,type:"BulkDebug",level:"info",maxLength:250}),this.dependencies=e}startLoop(){setTimeout((()=>this.txLoop()),1),setTimeout((()=>this.healthcheckLoop()),1)}enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;return this.tasks.set(e.id,{...e,sessionId:this.sessionId}),p.Z.setOrIncTotal(this.tasks.size),this.debugLogger.log({from:ce,type:"saveTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}}),this.getWaitable(!1).trigger(),Promise.resolve()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return Promise.resolve(Array.from(this.tasks.values()).some((t=>t.userId===e)))}updateDependencies(e){this.dependencies=e}async getTotalNumberOfTasks(){return Promise.resolve(this.tasks.size)}async anySessionHasTasks(){return Promise.resolve(this.hasTasks())}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,M.qo)(t.pointer,e)))))}async reset(){return this.tasks=new Map,p.Z.updateRemaining(0),Promise.resolve()}async clearForUser(e){const t=Array.from(this.tasks.values()).filter((t=>t.userId===e));for(const n of t)this.tasks.delete(n.id);return p.Z.updateRemaining(this.tasks.size),Promise.resolve()}async txLoop(){for(;;)try{await this.txLoopIteration()}catch(e){A(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),r.log({level:"error",from:ce,type:"txLoopIteration",error:(0,s.Ui)(e)}),P.IE(e),await T.Vs(15e3)}}async txLoopIteration(){const e=this.hasTasks();e||(this.doneSyncing(),this.events.emit("drain"));const[t,n]=X()?[E,B]:[D,R];await this.wait(t,e?t:n);const o=Array.from(this.tasks.values()),i=Array.from(o).sort(((e,t)=>e.timestamp-t.timestamp));if(0===i.length)return;const a=[];for(let r=0;r<i.length;r++)i[r]!==o[r]&&a.push(r);a.length>0&&r.log({from:ce,level:"warning",type:"TasksNotOrdered",data:{miscDataToConvertToString:{unsortedTaskIds:o.map((e=>e.id)),mismatch:a},taskIds:i.map((e=>e.id))}}),this.startSyncing(),await this.useSaveTransactionsApi(i)}async useSaveTransactionsApi(e){const t=await this.dependencies.handleSaveTransactions(e);if(t.error){const{savedTasks:e,failedTasks:o,message:i,retryDelay:a,retryReason:l}=t.error;var n;if(l?A(this.retryReasonCounters,l):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:ce,type:"handlePartialSaveTransactionsSuccess",data:{message:`will delete ${e.length} saved tasks`,taskIds:e.map((e=>e.id))}}),await this.cleanupTasks(e,void 0)),o.length>0?(this.debugLogger.flush(),r.log({level:"warning",from:ce,type:"handleSaveTransactionsError",data:{message:i,taskIds:o.map((e=>e.id))},error:(0,s.Ui)(t.error)}),await this.cleanupTasks(o,t.error)):this.debugLogger.log({level:"debug",from:ce,type:"handleSaveTransactionsRetryableError",data:{message:i}}),a>0)await this.transactionBackoffController.backOffOnFailure(a-D,null===(n=t.error)||void 0===n?void 0:n.retryReason);else this.transactionBackoffController.reset()}else{const e=t.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:ce,type:"handleSaveTransactionsSuccess",data:{message:`will clean up ${e.length} submitted tasks`,taskIds:e.map((e=>e.id))}}),this.transactionBackoffController.reset(),await this.cleanupTasks(e,void 0)}}async cleanupTasks(e,t){for(const o of e)if(o.callback)try{o.callback(t)}catch(n){this.debugLogger.flush(),r.log({level:"error",from:"InMemoryTransactionQueue",type:"cleanupTask",data:{taskId:o.id},error:(0,s.Ui)(n)})}for(const o of e)this.debugLogger.log({from:ce,type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${o.id}`,taskId:o.id}}),this.tasks.delete(o.id);return p.Z.updateRemaining(this.tasks.size),Promise.resolve()}getWaitable(e){return this.waiter&&!e||(this.waiter=new T.a6),this.waiter}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}startSyncing(){F.Z.setState({...F.Z.state,syncing:!0})}doneSyncing(){F.Z.setState({...F.Z.state,syncing:!1})}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();if(e>de.transactionSizeHealthcheckThreshold){const t={queue_type:"InMemoryTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:F.Z.state.online,retry_reasons:this.retryReasonCounters};this.debugLogger.flush(),r.log({level:"info",from:"InMemoryTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck(t)}}catch(e){this.debugLogger.flush(),r.log({level:"error",from:"InMemoryTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),P.IE(e)}await T.Vs(de.healthcheckInterval)}}}de.healthcheckInterval=15*u.hM,de.transactionSizeHealthcheckThreshold=1e3;const ue=de;var pe=n(68026);const me="FeatureFlagTransactionQueue";async function fe(e){if(!window.indexedDB)return{available:!1,message:"The IndexedDB API is missing or disabled on this platform."};if(e.device.isFirefox){const e="FirefoxFeatureCheck";if(!(await new Promise((t=>{const n=window.indexedDB.open(e);n.onerror=()=>t(!1),n.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}}))))return{available:!1,message:"IndexedDB is disabled in Firefox Private Browsing."}}if(e.device.isChrome&&parseInt(e.device.browserVersion,10)>=99){const e="Chrome99FeatureCheck";let n=!1;try{if(n=await new Promise((t=>{const n=window.indexedDB.open(e);n.onerror=()=>t(!1),n.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}})),!n)return{available:!1,message:"IndexedDB is unstable in Chrome 99."}}catch(t){return{available:!1,message:(0,i.tg)(t).message}}}return{available:!0}}function ge(e,t){const n="react-native"===e.device.platform?"00000000-0000-0000-0000-000000000000":(0,l.ZP)(),o=new r.BatchedLogger({from:"IndexedDBTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),i=new I(o,e);return new se(t,i,n,o)}(0,o.exposeDebugValue)("getIndexedDBAvailability",fe);let he=new class{constructor(e,t){this.getActiveQueueName=void 0,this.queues=void 0,this.createQueues=void 0,this.getActiveQueueName=e,this.createQueues=t}getQueues(){const e=this.queues?this.queues:this.createQueues();return this.queues=e,e}applyToAllQueues(e){return Object.values(this.getQueues()).map(e)}applyToActiveQueue(e){return e(this.getQueues()[this.getActiveQueueName()])}startLoop(){this.applyToAllQueues((e=>e.startLoop()))}enqueueTask(e){return this.applyToActiveQueue((t=>t.enqueueTask(e)))}unpause(){this.applyToAllQueues((e=>e.unpause()))}pause(){this.applyToAllQueues((e=>e.pause()))}getLastTaskTimestamp(){return this.applyToActiveQueue((e=>e.getLastTaskTimestamp()))}hasTasks(){return this.applyToAllQueues((e=>e.hasTasks())).some(Boolean)}async hasTasksForUser(e){return(await Promise.all(this.applyToAllQueues((t=>t.hasTasksForUser(e))))).some((e=>e))}updateDependencies(e){this.applyToAllQueues((t=>t.updateDependencies(e)))}async anySessionHasTasks(){for(const e of this.applyToAllQueues((e=>e.anySessionHasTasks())))if(await e)return!0;return!1}async getTotalNumberOfTasks(){return a.Sm(await Promise.all(this.applyToAllQueues((e=>e.getTotalNumberOfTasks()))))}async drain(){await Promise.all(this.applyToAllQueues((e=>e.drain())))}awaitRecordTransaction(e){return this.applyToActiveQueue((t=>t.awaitRecordTransaction(e)))}isPendingTransactionForRecord(e){return this.applyToAllQueues((t=>t.isPendingTransactionForRecord(e))).some(Boolean)}async reset(){await Promise.all(this.applyToAllQueues((e=>e.reset())))}async clearForUser(e){await Promise.all(this.applyToAllQueues((t=>t.clearForUser(e))))}}((()=>"error"),(()=>{throw new Error("Need to await setupTransactionQueue")}));const ve=async e=>(he=await async function(e){const t=new pe.TransactionQueueDependenciesImpl(e);async function n(){const n=await fe(e);if(!n.available)return r.log({from:me,level:"warning",type:"preferIndexedDBUnavailable",data:{miscDataToConvertToString:{message:n.message,userAgent:navigator.userAgent}}}),o();r.log({from:me,type:"preferIndexedDB",level:"info"});const i=await(0,C.sK)();if(i&&!(0,C.mn)(i)){const n=ge(e,t);let o=!1;try{o=await n.anySessionHasTasks(),r.log({from:me,type:"indexedDBStorageVeryFull",level:"warning",data:{storage:{hasTasks:o,...i}}})}catch(l){r.log({from:me,level:"error",type:"indexedDBStorageReadError",data:{storage:i},error:(0,s.Ui)(l)})}return o?n:new ue(t)}if(e.device.isFirefox){const n=ge(e,t);try{const e=await n.checkObjectStores(),o=a.oA([e.transaction,e.session].map((e=>e.error)));if(o.length>0){const n=[];return e.transaction.error&&n.push("Transaction"),e.session.error&&n.push("Session"),r.log({from:me,level:"error",type:"FirefoxHealthCheckFailed",error:{miscErrorString:(0,s.LK)(o)},data:{message:`Can't read ${n}. Using InMemoryTransactionQueue instead.`}}),new ue(t)}return n}catch(l){return r.log({from:me,level:"error",type:"indexedDBHealthCheckError",error:(0,s.Ui)(l)}),new ue(t)}}return ge(e,t)}function o(){return r.log({from:me,type:"preferInMemory",level:"info"}),new ue(t)}const{device:i,mobileNative:l}=e;if(i.isBrowser&&i.isDesktop){if(i.isChrome||i.isFirefox)return n();if(i.isSafari){if(parseInt(i.browserVersion,10)<17)return n();const e=o(),t=await n();return t instanceof se&&!Y.default.checkGate("force_use_in_memory_transaction_queue_for_safari")&&await t.anySessionHasTasks()?(r.log({from:me,type:"Safari17.usingIndexedDBToInMemoryTransactionQueue.",level:"info"}),new le(t,e)):(r.log({from:me,type:"Safari17.usingInMemoryTransactionQueue+",level:"info"}),e)}return o()}return i.isBrowser&&i.isMobile?o():i.isElectron?n():i.isMobileNative&&l&&l.sqliteConnection?(0,oe.Y)("supportsNativeTransactionQueue")?new K(l.sqliteConnection,t,l):new te(l.sqliteConnection,t):o()}(e),he),be=e=>{he=e}},45325:(e,t,n)=>{n.d(t,{ZP:()=>s,ez:()=>r});var o=n(49085),i=n(97880);const r=["mentions","archive","allPages"];class a extends o.default{getInitialState(){return{openState:"closed",currentTab:r[0],filter:"readAndUnread",width:390,isResizerHovered:!1,isResizing:!1}}isOpen(){const{openState:e}=this.state;switch(e){case"open":case"opening":return!0;case"closed":case"closing":return!1;default:(0,i.t1)(e)}}isTransitioningOpenState(){const{openState:e}=this.state;switch(e){case"opening":case"closing":return!0;case"open":case"closed":return!1;default:(0,i.t1)(e)}}getPanelWidth(){return"closed"===this.state.openState?0:this.state.width}getPanelWidthReturnZeroForClosingState(){return this.isOpen()?this.state.width:0}}const s=new a},45946:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(53809),i=n(30548);const r=new o.D({key:"openInDesktopApp",namespace:i.$p,important:!0,trackingType:"necessary"})},64970:(e,t,n)=>{n.d(t,{m:()=>o});const o=n(49085).default.createValue(!1)},70704:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isHidden:!1}}}const r=i},79689:(e,t,n)=>{n.d(t,{L:()=>r,c:()=>a});var o=n(49085);const i=new Map;function r(e){const t="shared"===e.type?e.type:`${e.type}${e.teamId}${e.teamOutlinerType}`,n=i.get(t);if(n)return n;{const e=o.default.createValue(!1);return i.set(t,e),e}}function a(){const e=Array.from(i.entries());return 0===e.length||e.every((e=>!e[1].state))}},61364:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{constructor(){super(...arguments),this.containerDomNode=o.default.createValue(null)}getInitialState(){return{overlays:new Set}}}const r=i},19671:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(58484).Z)},93220:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{ready:!1,initialRequestCompleted:!1,loading:!1,endOfResultsReached:!1,error:void 0,currentCursor:void 0,currentChunkNumber:void 0}}}const r=i},85526:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{forceShowProperties:!1}}}const r=new i},94896:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pages:new Set}}setStatus(e,t){t?this.state.pages.add(e):this.state.pages.delete(e),this.emit()}}const r=new i},82136:(e,t,n)=>{n.d(t,{S:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e[e.Frame=0]="Frame",e[e.PeekView=1]="PeekView",e[e.MiniPeekView=2]="MiniPeekView",e[e.InAppTemplatePreview=3]="InAppTemplatePreview",e[e.CollectionPageView=4]="CollectionPageView",e}({});class r extends o.default{getInitialState(){return{forceDiscussionOpen:!1}}}const a=r},85844:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isVisible:!0}}}const r=new i},72014:(e,t,n)=>{n.d(t,{$g:()=>a,jx:()=>s});var o=n(49085),i=n(4615);class r extends o.default{getInitialState(){}initializeNewPageVisitId(){this.setState((0,i.ZP)())}getCurrentPageVisitId(){return this.getState()}}const a=new r,s=new r},30539:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pageId:void 0,lastViewTime:void 0,lastExitTime:void 0,omittedUserIds:[]}}}const r=i},69503:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1,hasPassword:!1}}isSetNewPasswordModal(){const e=this.state;return!0===e.setNewPassword&&!1===e.isSet}isPasswordSetModal(){const e=this.state;return!0===e.setNewPassword&&!0===e.isSet}isRemovePasswordModal(){const e=this.state;return!0===e.removePassword&&!1===e.isSuccess}isRemovePasswordSuccessModal(){const e=this.state;return!0===e.removePassword&&!0===e.isSuccess}isVerifyIdentityWithMfaModal(){return!0===this.state.verifyIdentity}isPasswordModalClosed(){return!this.state.open}}const r=new i},91551:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(8297).Z)},13023:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(58484).Z)},88923:(e,t,n)=>{n.r(t),n.d(t,{CenterPeekModeOuterWidth:()=>d,MiniPeekModeMaxWidth:()=>m,MiniPeekModeMinWidth:()=>p,MiniPeekWidthPercentage:()=>u,PeekModeCenter:()=>r,PeekModeMini:()=>s,PeekModeOuterPadding:()=>c,PeekModePadding:()=>l,PeekModeSide:()=>a,default:()=>_,getPeekModeFromCollectionPeekModeFormat:()=>g,getPeekModeFromUrlParam:()=>f,getUrlParamFromPeekMode:()=>h,sidePeekInitialMaxWidth:()=>v,sidePeekMinWidth:()=>y,sidePeekNoColumnWidth:()=>b});var o=n(14577),i=n(49085);const r="center_peek",a="side_peek",s="mini_peek",l={horizontal:{center_peek:126,side_peek:48,mini_peek:48}},c=72,d=708+2*l.horizontal[r],u=70,p=600,m=840;function f(e){switch(e){case"s":return a;case"c":return r;case"m":return s}}function g(e){switch(e){case"side_peek":return a;case"center_peek":return r}}function h(e){switch(e){case a:return"s";case r:return"c";case s:return"m"}}const v=980,b=640,y=430;class S extends i.default{constructor(){super(...arguments),this.isSidePeekOpening=new o.Z((()=>this.state.open&&this.isSidePeekOpen()&&this.state.isOpening),{debugName:"isSidePeekOpening"}),this.isSidePeekClosing=new o.Z((()=>this.state.open&&this.state.isClosing),{debugName:"isSidePeekClosing"}),this.peekTarget=new o.Z((()=>this.state.open?this.state.target:void 0),{debugName:"peekTarget"})}getInitialState(){return{open:!1,mode:r,preferredSidePeekWidth:0,savedSidebarExpandedStoreState:!1}}getCollectionModeFormat(){switch(this.state.mode){case a:return"side_peek";case r:return"center_peek"}}getPeekMode(){return this.state.open?this.state.mode:a}getPeekModeWidth(e){return this.isMiniOrCenterPeekOpen()?d:this.getSidePeekWidth(e)}getSidePeekWidth(e){const t=Math.min(e/2,v),n=this.state.preferredSidePeekWidth||t;return Math.min(Math.max(n,y),e)}setSidePeekWidth(e,t){const n=Math.min(Math.max(e,y),t);this.setState({...this.state,preferredSidePeekWidth:n})}isMiniPeekOpen(){return this.state.open&&this.state.mode===s}isCenterPeekOpen(){return this.state.open&&this.state.mode===r}isMiniOrCenterPeekOpen(){return this.state.open&&(this.state.mode===r||this.state.mode===s)}isSidePeekOpen(){return this.state.open&&this.state.mode===a&&!this.state.isClosing}setSidebarExpandedStoreState(e){this.setState({...this.state,savedSidebarExpandedStoreState:e})}}const _=new S},98452:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},99332:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},24612:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},42057:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(92595),i=n(45589);const r=(0,o.exposeDebugValue)("PeekViewScrollerStore",new i.Z)},29677:(e,t,n)=>{n.d(t,{Db:()=>a,cl:()=>i,fZ:()=>o,ow:()=>r});n(49085),n(21202);function o(e){return"existingUser"===e.type}function i(e){return"newUser"===e.type}function r(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function a(e){return e.inviteTargets.every((e=>"existingUser"===e.type||"newUser"===e.type||"group"===e.type))}},31194:(e,t,n)=>{n.d(t,{FJ:()=>m,Iw:()=>u,ZP:()=>g,lU:()=>p});var o=n(49085),i=n(4023),r=n(15723);const{Top:a,Bottom:s,Left:l,Right:c,Center:d}=i.u,u=i.u,p=i.v,m=e=>{switch(e){case a:return s;case s:return a;case l:return c;case c:return l;case d:return d}};class f extends o.default{getInitialState(){return{open:!1,placementFlipped:!1,offsetX:0,offsetY:0,originRect:r.bM}}}const g=f},89523:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1,userId:void 0}}isReady(){return Boolean(this.state.remotePresenceData)}}i.presentMaxActivityAge=6e4;const r=i},24864:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(70704).Z)},83212:(e,t,n)=>{n.d(t,{Z:()=>l,m:()=>a});var o=n(49085),i=n(27006),r=n(67669);const a={disabled:{hasPublicPermission:!1},view:{hasPublicPermission:!0,permission:"view"},comment:{hasPublicPermission:!0,permission:"comment"},edit:{hasPublicPermission:!0,permission:"edit"}};Object.freeze(a),Object.freeze(a.disabled),Object.freeze(a.view),Object.freeze(a.comment),Object.freeze(a.edit);class s extends o.default{getInitialState(){return{editing:!1,commenting:!1}}getMode(e,t){const n=this.getModeType(e,t)||"disabled";return a[n]}getModeType(e,t){if(!t.isDefaultRecordCache()||!(0,r.IJ)(e,t))return;const n=t.getRole(),o=!n||(0,i.J5)(n),a=!n||(0,i.RF)(n),s=e.currentUser.isLoggedIn();return o&&s&&this.state.editing?"edit":a&&s?"comment":"view"}}const l=new s},81236:(e,t,n)=>{n.d(t,{Z:()=>l});n(84633);var o=n(49085),i=n(92595),r=n(15157);class a extends o.default{constructor(){var e;super(...arguments),e=this,this.fetchSpaceIds=new Set,this.fetchedSpaceIds=new Set,this.fetch=async function(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=await Promise.resolve().then(n.bind(n,54642)),a=t.currentUser.id,s=Array.from(e.fetchSpaceIds.values());try{if(s.length>0){if(!o){for(const t of s){const n=r.Z.get({userId:a,key:e.getLocalKey(t)});n&&(e.setPublicSpaceData(t,n),e.fetchSpaceIds.delete(t),e.fetchedSpaceIds.add(t))}e.setState({...e.state,fetching:!1})}const n=await i.getPublicSpaceData(t,{type:"space-ids",spaceIds:s});"success"===n.type&&n.data.results.forEach(((t,n)=>{if(t){const o=s[n];e.setPublicSpaceData(o,t),r.Z.set({userId:a,key:e.getLocalKey(o),value:t}),e.fetchSpaceIds.delete(o),e.fetchedSpaceIds.add(o)}}))}}finally{e.setState({...e.state,fetching:!1})}}}getInitialState(){return{publicSpaceDataMap:{},fetching:!1}}getPublicSpaceData(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n&&(this.fetchSpaceIds.delete(t),this.fetchedSpaceIds.delete(t)),this.fetchSpaceIds.has(t)||this.fetchedSpaceIds.has(t)||(this.fetchSpaceIds.add(t),this.setState({...this.state,fetching:!0}),setImmediate((()=>this.fetch(e,n)))),this.state.publicSpaceDataMap[t]}async awaitPublicSpaceData(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.getPublicSpaceData(e,t,n),await this.waitUntil((()=>Boolean(this.state.publicSpaceDataMap[t])&&!this.state.fetching)),this.state.publicSpaceDataMap[t]}setPublicSpaceData(e,t){this.state.publicSpaceDataMap[e]=t||null,this.emit()}TEST_ONLY__setPublicSpaceData(e,t){this.fetchedSpaceIds.add(e),this.state.publicSpaceDataMap[e]=t||null,this.emit()}getLocalKey(e){return`${a.localKeyPrefix}:${e}`}}a.localKeyPrefix="PublicSpaceData";const s=new a;i.exposeDebugValue("PublicSpaceDataStore",s);const l=s},69784:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1}}}const r=new i},13105:(e,t,n)=>{n.d(t,{P:()=>r});var o=n(14577),i=n(92595);class r{constructor(e){this.memo=new WeakMap,this.debugName=void 0,this.hits=0,this.misses=0,this.getStateFor=e=>this.computeMemo(e),this.computeMemo=e=>{let t=this.memo.get(e);return t?this.hits++:(this.misses++,t=new o.Z((()=>this.options.compute(e,this.options.memoizeRecursion?this.computeMemo:this.computeNonMemo)),{debugName:this.debugName}),this.memo.set(e,t)),t.getState()},this.computeNonMemo=e=>this.options.compute(e,this.computeNonMemo),this.options=e,this.debugName=`RecursiveComputedStore.${e.debugName}`,(0,i.exposeDebugInstance)(this.debugName,this)}}},64951:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}isActive(){return Boolean(this.state.blockStore)}}const r=new i},82187:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}isActive(){return Boolean(this.state.clonedBlockStore)}}const r=new i},72087:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{ready:!1,loading:!1}}}const r=i},91681:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isResizing:!1}}}const r=new i},76967:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a,groupIntervalMs:()=>i});var o=n(49085);const i=700;class r extends o.default{getInitialState(){return{type:"legacy",undoStack:[],redoStack:[]}}}const a=new r},49557:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{isActive:!1,isAnimatingClosed:!1,top:0,left:0}}}const a=(0,i.exposeDebugValue)("RichTextMenuStore",new r)},4935:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},45589:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isScrolling:!1,scrollTop:0,scrollHeight:0,scrollLeft:0,scrollWidth:0,clientWidth:0}}}const r=i},32470:(e,t,n)=>{n.d(t,{BJ:()=>m,ZP:()=>h,gq:()=>g,lO:()=>f,v_:()=>p});var o=n(49085),i=n(15157),r=n(72126),a=n(53772),s=n(95477);const l="SearchDebugStorePersistenceKey";class c extends o.default{setState(e){super.setState(e),function(e){let{newState:t,key:n}=e;i.Z.set({userId:"global",key:n,value:t})}({newState:e,key:this.getPersistenceKey()})}setStateWithoutPersisting(e){super.setState(e)}reloadFromDisk(){const e=i.Z.get({userId:"global",key:this.getPersistenceKey()});super.setState({...this.getInitialState(),...e})}}class d extends c{constructor(e){super(),this.column=void 0,this.getPersistenceKey=()=>`SearchDebugStorePersistenceKey:${this.column}`,this.updateForcedClusterPattern=e=>{this.setState({...this.state,forcedClusterPattern:e})},this.updateForcedBlockIds=e=>{this.setState({...this.state,forcedBlockIds:e})},this.column=e}getInitialState(){return{forcedClusterPattern:void 0,forcedBlockIds:void 0,searchExperimentOverrides:{},visible:!0}}hasDebugOverrides(){return!r.xb(this.state.forcedClusterPattern)||!r.xb(this.state.searchExperimentOverrides)||!r.xb(this.state.forcedBlockIds)}}const u=new class extends c{constructor(){super(...arguments),this.getPersistenceKey=()=>l}getInitialState(){return{showDebugInfo:!1,debug:void 0}}getDebugLevel(){return this.state.debug??(this.state.showDebugInfo?"explain":void 0)}},p=new d("left"),m=new d("right");function f(){u.reloadFromDisk(),p.reloadFromDisk(),m.reloadFromDisk()}function g(e){let{device:t}=e;return(0,a.x)(s.default)&&!t.isMobile&&(p.hasDebugOverrides()||m.hasDebugOverrides()||p.state.forcedClusterPattern||m.state.forcedClusterPattern)&&m.state.visible}const h=u},55320:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1,openAsPage:!1,openedTimeMs:void 0,sessionId:void 0,intentBasedSearch:{enablesGrouping:!1,enablesSidePeekPanel:!1},isPublicPageSearch:!1}}isSidePeekPanelEnabled(){if(this.state.intentBasedSearch.enablesSidePeekPanel){const{state:e}=this;return!0}return!1}}const r=new i},87956:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){}}const r=new i},29026:(e,t,n)=>{n.d(t,{Xv:()=>l,ZP:()=>u});var o=n(49085),i=n(15157),r=n(94804),a=n(92338),s=n(80444);const l=20;let c=function(e){return e.Default="Default",e.Results="Results",e}({});class d extends o.default{constructor(){super(...arguments),this.resetQuery=e=>{let{resetFilters:t}=e;this.setState({...this.state,query:{...this.state.query,text:"",...t&&{filters:(0,a.u4)()}},limit:l,source:"quick_find_input_change"})},this.resetFilters=()=>{this.update((e=>({...e,query:{...e.query,filters:(0,a.u4)()}})))},this.updateFilters=e=>{const t=this.state.query.filters,n=(0,a.jl)(t,e);this.setState({...this.state,query:{...this.state.query,filters:n},limit:l,source:"quick_find_filters"})},this.expandFilterBar=()=>{this.updateFilterBarVisibilityState(!0)},this.collapseFilterBar=()=>{this.updateFilterBarVisibilityState(!1)},this.updateFilterBarVisibilityState=e=>{var t;const n=null===(t=s.default.state.currentUserStore)||void 0===t?void 0:t.id;n&&(i.Z.set({userId:n,key:r.rE,value:e}),this.update((t=>({...t,showFilterBar:e}))))},this.updateQueryText=e=>{this.setState({...this.state,query:{...this.state.query,text:e},limit:l,source:"quick_find_input_change"})}}getInitialState(){return{mode:"search",isSidePeekPanelOpen:!1,isDebugSidebarOpen:!1,showFilterBar:!0,query:{text:"",filters:(0,a.u4)(),sort:{field:"relevance"}},limit:l,source:"quick_find",hasScrolled:!1,filterState:{filterOrder:["workspaceSwitcher","titleToggle","personFilter","teamsFilter","pageFilter","dateFilter","dev_notInPageFilter","dev_notInTeamFilter"]}}}updateFilterState(e){this.setState({...this.state,filterState:e})}hasQuery(){return Boolean(this.state.query.text)}isSidePeekPanelOpen(){if(this.state.isSidePeekPanelOpen){const{state:e}=this;return!0}return!1}isDebugSidebarOpen(){if(this.state.isDebugSidebarOpen){const{state:e}=this;return!0}return!1}}d.Mode=c;const u=new d},86486:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isOpen:!1}}}const r=new i},50628:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{selectableRectMap:new Map,selectableContainerRectMap:new Map,selectableElementRectMap:new Map,lastUpdate:0}}hasBeenUpdatedSince(e){return this.state.lastUpdate>e}}const a=new r;(0,i.exposeDebugValue)("SelectableRectStore",a);const s=a},27724:(e,t,n)=>{n.r(t),n.d(t,{SelectionPhase:()=>c,default:()=>u});var o=n(49085),i=n(97880),r=n(16339),a=n(95802),s=n(88923),l=n(35661);let c=function(e){return e[e.Selected=0]="Selected",e[e.Editing=1]="Editing",e}({});class d extends o.default{getInitialState(){return{stores:[],phase:c.Selected}}cloneState(){return{stores:[...this.state.stores],phase:this.state.phase}}getEditing(){if(this.state.phase===c.Editing)return this.state.stores[0]}isSelected(){return this.state.stores.length>0&&this.state.phase===c.Selected}getNodes(){return this.state.stores.map((e=>a.C.findNodeFromStore(e)||void 0)).filter(i.$K)}getCurrentRootStore(){var e,t;const n=null===(e=this.getCurrentDefaultContainer())||void 0===e?void 0:e.props.store;return n&&n instanceof l.G?n:null===(t=this.getDefaultContainer())||void 0===t||null===(t=t.props)||void 0===t?void 0:t.store}getCurrentRecordCache(){const e=this.getCurrentRootStore();if(e)return e.inMemoryRecordCache}getDefaultContainerFromTarget(e){return r.Z.find((t=>{const n=t.getNode();return Boolean(n&&n.contains(e))}))}getCurrentDefaultContainer(){const e=this.state.anchorContainer;return e||this.getDefaultContainer()}getDefaultContainer(){const e=this.state.defaultContainerStack;if(e&&e.length>0)return e[e.length-1]}isInPeekRenderer(){if(this.state.anchorContainer)return Boolean(this.state.anchorContainer.isPeekRenderer());{var e;const t=Boolean(null===(e=this.state.anchor)||void 0===e?void 0:e.isPageBlock()),n=s.default.state.open&&this.state.anchor===s.default.state.target;return t&&n}}}const u=new d},77794:(e,t,n)=>{n.d(t,{E:()=>a});var o=n(49085),i=n(72126),r=n(15723);class a{constructor(e){this.rect=o.default.createValue(r.bM),this.el=void 0,this.resizeObserver=void 0,this.options=void 0,this.recomputeThrottled=void 0,this.recompute=()=>{var e;const t=(null===(e=this.el)||void 0===e?void 0:e.getBoundingClientRect())??r.bM;return this.rect.setState(t),t},this.options=e||{},this.options.throttleMs&&(this.recomputeThrottled=i.P2(this.recompute,this.options.throttleMs))}observe(e){this.el=e,"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.getRecomputeFn()),this.resizeObserver.observe(this.el)),this.recompute()}destroy(){this.resizeObserver&&this.resizeObserver.disconnect()}getRecomputeFn(){return this.recomputeThrottled||this.recompute}}},10743:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},1310:(e,t,n)=>{n.d(t,{JY:()=>r,Ty:()=>i,ZP:()=>s});var o=n(49085);const i=5e3,r=1e4;class a extends o.default{getInitialState(){return{currentItem:void 0,shouldReset:!0}}}const s=new a},64404:(e,t,n)=>{n.d(t,{Q:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e.Members="members",e.Groups="groups",e.Guests="guests",e.Reprovisioning="reprovisioning",e.Requests="requests",e}({});class r extends o.default{getInitialState(){return{currentTab:i.Members,limitMembers:!0,limitGuests:!0,limitTeamGuests:!0,membersFilter:"",guestsFilter:"",teamGuestsFilter:"",groupsFilter:"",groupNameInputValue:"",upsellModalOpen:!1,sorts:{members:{group:"members",by:"role",asc:!1},guests:void 0,team_guests:void 0}}}}const a=r},92083:(e,t,n)=>{n.d(t,{R:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e[e.OpenInDesktopApp=0]="OpenInDesktopApp",e[e.TwoStepVerification=1]="TwoStepVerification",e}({});class r extends o.default{getInitialState(){return{open:!1,currentTab:"settings",defaultSubtab:void 0,highlightedSetting:void 0,openedFrom:void 0}}}const a=new r},27242:(e,t,n)=>{n.d(t,{U:()=>r,Z:()=>s});var o=n(49085),i=n(4615);let r=function(e){return e.CurrentSpace="current-space",e.TargetSpace="domain-claim-upgrade-team-plan-workspace",e}({});class a extends o.default{getInitialState(){return{open:!1,type:r.CurrentSpace}}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}closeWithFailure(){this.setState({open:!1,succeeded:!1})}open(e){const{subscriptionTier:t,addOnFeature:n,billingInterval:o,coupon:a,isTrial:s}=e;this.setState({open:!0,temporaryPaymentMethod:"credit_card",temporaryBillingInterval:o,temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,subscriptionTier:t,vatApplicable:!1,calculatingTax:!1,payButtonState:"enabled",type:r.CurrentSpace,addOnFeature:n,onlyShowAddOn:void 0!==n,sessionId:(0,i.ZP)(),coupon:a,isTrial:s})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const s=new a},9209:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},78291:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});n(21703),n(30120);var o=n(49085),i=n(47425);n(95477);class r extends o.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.data)))}getSubscriptionTier(){var e;return(0,i.O9)(null===(e=this.state.data)||void 0===e?void 0:e.subscriptionTier)}setTestClockSeconds(e){throw new Error("Cannot set test clock time in production")}}const a=new r},99757:(e,t,n)=>{n.d(t,{Z:()=>l,n:()=>s});var o=n(14577),i=n(49085);class r extends i.default{constructor(){super(...arguments),this.updateRemaining=e=>{this.state.remainingPending!==e&&(0===e?this.setState({...this.state,totalPending:0,remainingPending:0}):this.setState({...this.state,remainingPending:e}))}}getInitialState(){return{totalPending:0,remainingPending:0,transactionQueueError:void 0,storageUsageEstimate:void 0,connectionError:void 0}}percentComplete(e){if(this.state.totalPending>0){const t=1-this.state.remainingPending/this.state.totalPending;return e.formatNumber(t,{style:"percent",maximumFractionDigits:0})}return e.formatNumber(1,{style:"percent"})}setOrIncTotal(e){this.state.totalPending>e?this.setState({...this.state,totalPending:this.state.totalPending+1}):this.setState({...this.state,totalPending:e})}}const a=new r,s=new o.Z((()=>Boolean(a.state.transactionQueueError)),{debugName:"transactionQueueUnhealthyStore"}),l=a},29370:(e,t,n)=>{n.d(t,{N:()=>r,Z:()=>s});var o=n(49085),i=n(72126);function r(e,t){return e.collectionViewBlockStore===t.collectionViewBlockStore&&i.Xy(e.groupFormat,t.groupFormat)}class a extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const s=new a},42185:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(void 0)},30397:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{teams:[],lastEmitData:{value:"no value saved yet",spaceId:void 0,userId:void 0}}}shouldRefetchTeamsInSpace(e){let{currentUserId:t,currentSpaceId:n,emitValue:o}=e;const{spaceId:i,userId:r,value:a}=this.state.lastEmitData;return n!==i||(t!==r||o!==a)}}const r=new i},24666:(e,t,n)=>{n.r(t),n.d(t,{TextSelectionStore:()=>l,default:()=>c});var o=n(14577),i=n(49085),r=n(72126),a=n(62965),s=n(68056);class l extends i.default{constructor(){super(...arguments),this.isEditingStore=new o.Z((()=>"editing"===this.state.mode),{debugName:"isEditingStore"}),this.isExpandedStore=new o.Z((()=>"empty"!==this.state.mode&&!(0,s.iG)(this.state.multiSelection)),{debugName:"isExpandedStore"})}getInitialState(){return{mode:"empty"}}setState(e){if("empty"===e.mode||"empty"===this.instanceState.mode)return super.setState(e);if(!(0,a.Z)(this.instanceState,e)){const{savedSelectionXPosition:t,...n}=this.instanceState,{savedSelectionXPosition:o,...i}=e;this.instanceState=e,(0,a.Z)(n,i)||this.emit()}}cloneState(){return"editing"===this.state.mode?{mode:"editing",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition,forceExtendAnnotations:r.Xh(this.state.forceExtendAnnotations)}:"readOnly"===this.state.mode?{mode:"readOnly",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition}:{mode:"empty"}}isEmptySelection(){if("empty"===this.state.mode)return!0;const{multiSelection:e}=this.state;return(0,s.iG)(e)}isEditingComment(){return"editing"===this.state.mode&&("comment"===this.state.multiSelection.start.store.table||"comment"===this.state.multiSelection.end.store.table)}isEditingCaption(){return"editing"===this.state.mode&&(r.Xy(this.state.multiSelection.start.store.path,["properties","caption"])||r.Xy(this.state.multiSelection.end.store.path,["properties","caption"]))}hasSelection(){return"empty"!==this.state.mode}isEditingEmptyBlock(){return!("empty"===this.state.mode||!this.isEmptySelection())&&!this.state.multiSelection.start.store.isDefined()}}const c=new l},45131:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}setOpen(e,t){this.setState({...this.state,[e]:t})}toggle(e){this.setState({...this.state,[e]:!this.isOpen(e)})}isOpen(e){return!!this.state[e]}}const r=new i},48588:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){}}const a=new r;(0,i.exposeDebugValue)("TokenHoverStore",a);const s=a},58948:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{focused:!1,hovered:!1}}}const r=i},16194:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(!1)},52258:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},66708:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},77503:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},59238:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isDragging:!1}}}const r=new i},68026:(e,t,n)=>{n.r(t),n.d(t,{TransactionQueueDependenciesImpl:()=>F});var o=n(68626),i=n(91155),r=n(21051),a=n(50906),s=(n(21703),n(57658),n(92595)),l=n(59730),c=n(72126),d=n(4615),u=n(97880),p=n(5366),m=n(54642),f=n(47307),g=n(77080),h=n(56518),v=n(33954),b=n(24608),y=n(33929),S=n(44133),_=n(482),w=n(4408);async function k(e,t){const n=c.mN(t.operations.flatMap((e=>[e.pointer,...(0,_.S)(e)?e.additionalUpdatedPointers??[]:[]])),(e=>e.id));await Promise.all(n.map((n=>w.HB({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:n,userId:t.userId}))))}var I=n(99341);let C=0;const x=(0,p.defineMessages)({requestTooLarge:{id:"transactionHelpers.requestTooLargeError.message",defaultMessage:"Sorry, that request was too large."},requestTooLargeTryImportInstead:{id:"transactionHelpers.requestTooLargeError.message.tryImportInstead",defaultMessage:"Sorry, that request was too large. Try import instead?"}});let T=!1;(0,s.exposeDebugValue)("toggleTransactionQueue",(()=>{T=!T,console.info(T?"Transactions paused":"Transactions resumed")}));class M extends Error{constructor(e){super(e.message),this.retryDelay=void 0,this.retryReason=void 0,this.savedTasks=void 0,this.failedTasks=void 0,this.clientData=void 0,this.name="HandleSaveTransactionsError",this.retryDelay=e.retryDelay,this.retryReason=e.retryReason,this.savedTasks=e.savedTasks,this.failedTasks=e.failedTasks,this.clientData=e.clientData}}function P(e){if(1===e.subTasks.length)return e.task.debug;const t=new Map;for(const o of e.subTasks){var n;const e=null===(n=o.debug)||void 0===n?void 0:n.userAction;if(e){const n=t.get(e)??0;t.set(e,n+1)}}return{...e.task.debug,squashedUserActions:Object.fromEntries(t)}}async function A(e){if(T)return{value:[]};const{environment:t,tasks:n}=e,r=function(e,t){const n=new Set(t.map((e=>e.timestamp))),o=t.length-n.size;return o>0&&a.LAz(e,{collision_count:o}),o}(t,n),{userId:s,squashedTasks:p}=I.Vm(n,{allowSquashing:!0}),_=p.map((e=>({id:e.task.id,spaceId:e.task.spaceId,debug:P(e),operations:e.task.operations,inSudoMode:e.task.useSudoMode}))),w=(0,d.ZP)(),k=g.default.checkGate("client_http_gzip")?"gzip":void 0,A=await m.saveTransactions(t,{requestId:w,transactions:_},s,void 0,void 0,void 0,k);if("success"===A.type)return C=0,{value:p.flatMap((e=>e.subTasks))};const F="Notion is unavailable, please try again later."===A.error.message;if(!F&&!A.error.data.offline||Math.random()<.01){const e=[...new Set(_.map((e=>e.spaceId??"NO_SPACE_ID")))];o.log({level:"error",from:"transactionActions",type:"ClientTransactionError",error:{miscErrorString:(0,i.LK)(A)},data:{requestId:w,miscDataToConvertToString:{transactions:_},userId:t.currentUser.id,spaceIds:e}})}if(413===A.status){let e,n,i=0;p.forEach((t=>{var o,r;null!==(o=t.task.debug)&&void 0!==o&&o.userAction&&(e=t.task.debug.userAction),null!==(r=t.task.debug)&&void 0!==r&&r.userFlow&&(n=t.task.debug.userFlow),i+=t.subTasks.length})),o.log({level:"error",from:"transactionActions",type:"ClientTransaction413Error",data:{totalTaskCount:i,userId:t.currentUser.id,requestId:w,userAction:e,userFlow:n}});const r=JSON.stringify(_);a.F4S(t,{totalTaskCount:i,payloadLength:r.length,userAction:e});const s=Math.ceil(r.length/I._V);for(let a=0;a<s;a++)o.log({level:"error",from:"transactionActions",type:"ClientTransaction413ErrorRecovery",data:{userId:t.currentUser.id,totalTaskCount:i,requestId:w,miscDataToConvertToString:{chunkTotal:s,chunkIndex:a,operationChunk:r.slice(a*I._V,(a+1)*I._V)}}});f.showErrorMessage(y.default.formatMessage(e===h.xF?x.requestTooLargeTryImportInstead:x.requestTooLarge))}const Z=e=>{const n=C;if(e.failedTasks.length>0&&(C+=1),!F&&!A.error.data.offline){var s,l;const c=e.failedTasks.length>0?e.failedTasks[0]:void 0;c&&"space_not_found_in_record_path"===(null===(s=e.clientData)||void 0===s?void 0:s.type)&&o.log({level:"error",from:"transactionActions",type:"ClientTransactionSpaceNotFoundError",error:(0,i.Ui)(e),data:{userId:t.currentUser.id,requestId:w,miscDataToConvertToString:(0,S.getDebugSourcesForIdsInOperations)(t,c.operations)}}),a.mcx(t,{status:A.status,message:(0,b.pO)(A),previous_consecutive_rollbacks:n,saved_tasks:e.savedTasks.length,failed_tasks:e.failedTasks.length,first_failed_task_user_action:null==c||null===(l=c.debug)||void 0===l?void 0:l.userAction,will_retry:e.retryDelay>0,retry_reason:e.retryReason,timestamp_collision_count:r})}return{error:e}};if((0,l.Rp)(A.body)){if((0,l.oE)(A.body.clientData)){const{errors:e}=A.body.clientData,n=e[0],o=p.findIndex((e=>e.task.id===n.id));if(o<0)return D(t,w,n),Z(new M({message:n.name,clientData:n.clientData,retryDelay:0,retryReason:void 0,savedTasks:[],failedTasks:[]}));const i=p.slice(0,o),r=i.flatMap((e=>e.subTasks)),a=[],s=[],l=[];let c=o,d=0,m=0;for(const u of e){const e=p[c];u.id===e.task.id?(u.retryable?(s.push({error:u,squashedTask:e}),m+=1):(d+=1,await R(t,e.task,w),e.subTasks.forEach((e=>a.push(e))),l.push({error:u,squashedTask:e})),c++):D(t,w,u)}const f=[`${i.length} successful`,d>0?`${d} failed unretryable (data loss)`:void 0,m>0?`${m} retryable`:void 0].filter(u.$K).join(", "),g=[`API error for ${p.length} transactions: ${f}.`,B(l,"unretryable"),B(s,"retryable")].filter(u.$K).join(" ");let h,v=0;return s.length>0&&(v=2e3,h=s[0].error.name),Z(new M({savedTasks:r,failedTasks:a,message:g,retryDelay:v,retryReason:h,clientData:n.clientData}))}if(c.q9(E,A.status))return await Promise.all(p.map((e=>R(t,e.task,w)))),Z(new M({savedTasks:[],failedTasks:p.flatMap((e=>e.subTasks)),message:(0,v.wf)(y.default.getIntl(),A),retryDelay:0,retryReason:void 0}))}let L=`http${A.status}`;return A.error.data.offline?L="offline":F&&(L="notionUnavailable"),Z(new M({savedTasks:[],failedTasks:[],message:(0,v.wf)(y.default.getIntl(),A),retryDelay:5e3,retryReason:L}))}async function R(e,t,n){try{await k(e,t)}catch(r){o.log({level:"error",from:"transactionActions",type:"ClientTransactionCleanupError",error:(0,i.Ui)(r),data:{userId:e.currentUser.id,requestId:n}})}}function D(e,t,n){o.log({level:"error",from:"transactionActions",type:"ClientTransactionNotFoundError",error:(0,i.Ui)(n),data:{userId:e.currentUser.id,requestId:t}})}function B(e,t){if(e.length>0){var n;const{error:o,squashedTask:{task:i}}=e[0];return`First ${t} error: ${o.name} for transaction ${i.id} created by ${null===(n=i.debug)||void 0===n?void 0:n.userAction}.`}}const E=[400,413];class F{constructor(e){this.timeSource=r.O,this.environment=e}getExperimentGroup(e){return g.default.getGroup(e)}handleSaveTransactions(e){return A({environment:this.environment,tasks:e})}handleHealthcheck(e){a.h23(this.environment,e)}async rollbackTask(e){try{await k(this.environment,e)}catch(t){o.log({level:"error",from:"TransactionQueueDependencies",type:"ClientTransactionCleanupError",error:(0,i.Ui)(t),data:{userId:this.environment.currentUser.id}})}}}},1634:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},80064:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},40671:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{updatingUrls:new Set}}add(e){this.state.updatingUrls.add(e),this.emit()}delete(e){this.state.updatingUrls.delete(e),this.emit()}}const r=new i},85703:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.data)))}}const r=new i},62820:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},4761:(e,t,n)=>{n.d(t,{ZP:()=>l,g0:()=>a,n_:()=>c});var o=n(49085),i=n(4615),r=n(97880);function a(e){return"mentions"===e||"allPages"!==e&&"archive"!==e&&void(0,r.t1)(e)}class s extends o.default{getInitialState(){return{currentTab:"mentions",isCurrentTabEmpty:!0,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,loadingId:void 0,sessionId:void 0,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}}startSession(){let{forceRestart:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(void 0===this.state.sessionId||e)&&this.setState({...this.state,sessionId:(0,i.ZP)()})}endSession(){this.setState({...this.state,sessionId:void 0})}startLoading(){const e=Math.random().toString();return this.setState({...this.state,loadingId:e}),e}endLoading(e){e===this.state.loadingId&&this.setState({...this.state,loadingId:void 0})}isFilteredToUnreadOnly(){if("mentions"===this.state.currentTab)return this.state.showOnlyUnreadNotifications}}const l=new s,c=o.default.createValue(!0)},29226:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(29477);class r extends o.default{getInitialState(){return{readyPromise:(0,i.UZ)(),localSpaceInaccessiblePages:void 0,remoteSpaceInaccessiblePages:void 0}}getSpaceInaccessiblePages(e,t){const n=this.state;return n.remoteSpaceInaccessiblePages&&n.remoteSpaceInaccessiblePages[t]?n.remoteSpaceInaccessiblePages[t][e]:n.localSpaceInaccessiblePages&&n.localSpaceInaccessiblePages[t]?n.localSpaceInaccessiblePages[t][e]:void 0}}const a=new r},17963:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pageMap:{}}}setStatus(e,t){const{pageMap:n}=this.state;t?n[e]=!0:delete n[e],this.emit()}}const r=new i},28209:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{userHomePageId:void 0,personalHomePageId:void 0}}}const r=new i},33759:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(85974).Z)},89403:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},85974:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{loginType:"email",email:"",password:"",hasAccount:!1,showPassword:!1,signUpLinkSent:!1,hiddenPasscode:!1}}isGoogle(){return"google"===this.state.loginType}isEmail(){return"email"===this.state.loginType}isReverifying(){return"reverify"===this.state.loginType}isTemporaryPasscode(){return"temporary"===this.state.loginType}isExclusiveLoginLinkTemporaryPasscode(){return"temporary"===this.state.loginType&&Boolean(this.state.hiddenPasscode)}isPassword(){return"password"===this.state.loginType}isForgotPassword(){return"forgot"===this.state.loginType}isPasswordResetSent(){return"reset"===this.state.loginType}isSaml(){return"saml"===this.state.loginType}isMfa(){return"mfa"===this.state.loginType}}const r=i},7339:(e,t,n)=>{n.d(t,{C:()=>_,Z:()=>b});n(21703);var o=n(30120),i=n(41351),r=n.n(i),a=n(49085),s=n(7406),l=n(68626),c=n(91155),d=n(90965),u=n(34886),p=n(97880),m=n(24215),f=n(12955),g=n(97448),h=n(35057),v=n(80444);const b="group";class y extends a.default{constructor(){super(...arguments),this.environment=void 0}getInitialState(){return{currentUserId:void 0,currentSpaceId:void 0,ready:!1}}isInitialized(){return g.StatsigInitializer.isComplete}async initialize(e){const t=Date.now();this.environment=e;const{userId:n,spaceId:o}=S(e);if(this.isInitialized()&&void 0!==n)await this.updateUserAndSpace(e);else try{this.setStateBeforeInitOrUpdate(n,o),await this.confirmInitializeDidSucceed(),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"initialize"}),this.setStateAfterInitOrUpdate(n,o),this.trackMetric("statsig_client_init_success")}catch(i){this.logError("initialize",i,{nextUserId:n}),this.trackMetric("statsig_client_init_error")}finally{this.trackMetric("statsig_client_init_duration",{time:Date.now()-t})}}async updateUserAndSpace(e){const{userId:t,spaceId:n}=S(e);this.state.currentUserId===t&&this.state.currentSpaceId===n||(this.setStateBeforeInitOrUpdate(t,n),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"updateUserAndSpace"}),this.setStateAfterInitOrUpdate(t,n))}async confirmInitializeDidSucceed(){if(!g.StatsigInitializer.initializePromise)throw new Error("`statsig.initialize` was not called on app bootstrap");if(await g.StatsigInitializer.initializePromise,g.StatsigInitializer.error)throw g.StatsigInitializer.error}async updateStatsigUserWithAllKnownFields(e){let{environment:t,stage:n}=e;const o=Date.now();try{const e=await this.createStatsigUser(t);await r().updateUser(e),this.trackMetric("statsig_client_update_user_success")}catch(i){this.logError("updateUser",i,{nextUserId:t.currentUser.id,err:(0,s.tg)(i).message,stage:n}),this.trackMetric("statsig_client_update_user_error")}finally{this.trackMetric("statsig_client_update_user_duration",{time:Date.now()-o})}}setStateBeforeInitOrUpdate(e,t){super.setState({currentUserId:e,currentSpaceId:t,ready:!1})}setStateAfterInitOrUpdate(e,t){const{currentSpaceId:n,currentUserId:o}=super.getState();n===t&&o===e&&super.setState({currentUserId:e,currentSpaceId:t,ready:!0})}getGroup(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,o=arguments.length>3?arguments[3]:void 0;const i=Date.now();if(!this.isInitialized())return;let a;try{return a=t?r().getExperimentWithExposureLoggingDisabled(e):r().getExperiment(e),this.trackMetric("statsig_client_get_group_success",{experiment_id:e}),a.get(n,o)}catch(s){this.trackMetric("statsig_client_get_group_error",{experiment_id:e}),this.logError("getGroup",s,{experimentId:e,expConfig:JSON.stringify(a)})}finally{this.trackMetric("statsig_client_get_group_duration",{time:Date.now()-i})}}manuallyLogExperimentExposure(e){r().manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Date.now();if(!this.isInitialized())return!1;let o;try{return o=t?r().checkGateWithExposureLoggingDisabled(e):r().checkGate(e),this.trackMetric("statsig_client_check_gate_success",{gate_name:e}),o}catch(i){const t=i instanceof Error?i.message:void 0;return this.logError("checkGate",i,{gateName:e,...t&&{errorMessage:t}}),this.trackMetric("statsig_client_check_gate_error",{gate_name:e}),!1}finally{this.trackMetric("statsig_client_check_gate_duration",{time:Date.now()-n})}}getConfig(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Date.now();if(!this.isInitialized())return;let o;try{return o=t?r().getConfig(e):r().getConfigWithExposureLoggingDisabled(e),this.trackMetric("statsig_client_get_config_success",{config_name:e}),o}catch(i){const t=i instanceof Error?i.message:void 0;return this.logError("getConfig",i,{dynamicConfigName:e,...t&&{errorMessage:t}}),void this.trackMetric("statsig_client_get_config_error",{config_name:e})}finally{this.trackMetric("statsig_client_get_config_duration",{time:Date.now()-n})}}logEvent(e,t,n){const o=Date.now();if(!this.isInitialized())return!1;try{return r().logEvent(e,t,n),this.trackMetric("statsig_client_log_event_success",{event_name:e}),!0}catch(i){const o=i instanceof Error?i.message:void 0;return this.logError("logEvent",i,{eventName:e,value:String(t),...n,...o&&{errorMessage:o}}),this.trackMetric("statsig_client_log_event_error",{event_name:e}),!1}finally{this.trackMetric("statsig_client_log_event_duration",{time:Date.now()-o})}}getLocalOverride(e){if(!this.isInitialized())return;const t=r().getAllOverrides().configs[e];return null==t?void 0:t[b]}updateLocalOverrideConfig(e,t){this.isInitialized()&&(r().overrideConfig(e,{[b]:t}),super.emit())}updateLocalOverrideGate(e,t){this.isInitialized()&&(r().overrideGate(e,"true"===t),super.emit())}removeAllLocalOverrides(){if(!this.isInitialized())return;const e=r().getAllOverrides();(0,p.Yd)(e.configs).forEach((e=>r().removeConfigOverride(e))),(0,p.Yd)(e.gates).forEach((e=>r().removeGateOverride(e))),super.emit()}async createStatsigUser(e){var t,n,i,r,a,s,l;const{device:c}=e,{currentUserSettingsStore:p,currentSpaceStore:m}=v.default.getState(),{userId:b,userEmail:y,spaceId:_}=S(e),w=await f.getExperimentDeviceId(e);return(0,g.createStatsigUser)({userId:b,device:c,spaceId:_,userEmail:y,deviceId:w,locale:null==p||null===(t=p.getSettings())||void 0===t?void 0:t.preferred_locale,spaceMemberCount:(0,u.F)((0,d.t5)(null==m?void 0:m.getPermissionItems())),spaceCreatedTime:null==m?void 0:m.getCreatedTime(),spaceCreatedDate:null!=m&&m.getCreatedTime()?o.ou.fromMillis(null==m?void 0:m.getCreatedTime()).toFormat("yyyy-MM-dd"):void 0,subscriptionTier:(0,h.zt)(),planType:null==m?void 0:m.getPlanType(),signupTime:null==p||null===(n=p.getSettings())||void 0===n?void 0:n.signup_time,domainType:null==p||null===(i=p.getSettings())||void 0===i?void 0:i.domain_type,persona:null==p||null===(r=p.getSettings())||void 0===r?void 0:r.persona,teamRole:null==p||null===(a=p.getSettings())||void 0===a?void 0:a.team_role,useCases:null==p||null===(s=p.getSettings())||void 0===s?void 0:s.use_cases,companySize:null==p||null===(l=p.getSettings())||void 0===l?void 0:l.company_size})}logError(e,t,n){l.log({level:"error",from:"statsig",type:e,error:(0,c.Ui)(t),data:{miscDataToConvertToString:{...n,...this.state}}})}trackMetric(e,t){this.environment&&e.endsWith("_error")&&m.j(this.environment,e,t)}}function S(e){const{currentUser:t}=e,{currentSpaceStore:n,currentUserStore:o}=v.default.getState(),i=t.id,r=null==o?void 0:o.getEmail();return{userId:i,spaceId:null==n?void 0:n.id,userEmail:r}}const _=new y},22616:(e,t,n)=>{n.d(t,{Z:()=>s,y:()=>l});n(21703);var o=n(64793),i=n(12139),r=n(54642),a=n(33493);async function s(e){const{environment:t,spaceId:n}=e;if("init"!==a.Z.state.status)return;a.Z.didStartLoading();const s=await r.listPrices(t,{spaceId:n,clientVersion:t.device.version});if("success"!==s.type)return void a.Z.resetExceptSelectedCurrencyCode();const l=s.data.prices;l&&0!==l.length||i.IE(new Error("Received empty price list")),a.Z.setPrices(l.map((e=>new o.t(e))))}function l(e){a.Z.availableCurrencyCodes.includes(e)&&a.Z.update((t=>({...t,selectedCurrencyCode:e})))}},34583:(e,t,n)=>{n.d(t,{$B:()=>$,EO:()=>z,I0:()=>ne,M_:()=>te,Mg:()=>U,OR:()=>Q,TV:()=>O,Xb:()=>oe,bi:()=>Y,px:()=>J,r7:()=>K,y3:()=>N,zb:()=>X});n(21703);var o=n(30120),i=(n(67294),n(41892),n(68626)),r=(n(65454),n(15157)),a=n(26929),s=n(2438),l=n(5366),c=n(50906),d=n(54642),u=n(35253),p=n(47307),m=n(92625),f=n(97977),g=n(91754),h=(n(95477),n(15010)),v=n(33929),b=n(78873),y=n(95697),S=n(80444),_=n(73329),w=n(89087),k=n(81236),I=n(35661),C=n(92083),x=n(27242),T=n(9209),M=n(78291),P=n(85703),A=n(28517),R=n(42198),D=n(70060),B=n(88893),E=n(35057),F=n(62142),Z=n(33493),L=n(85893);let j;const V=(0,l.defineMessages)({updatingSubscription:{id:"subscriptionSettings.updatingSubscriptionMessage",defaultMessage:"Updating your subscription…"},updatingPaymentMethod:{id:"subscriptionSettings.updatingPaymentMethodMessage",defaultMessage:"Updating your payment method…"},verifyingEligibility:{id:"subscriptionSettings.verifyingEligibilityMessage",defaultMessage:"Verifying eligibility…"},personalFree:{id:"subscriptionSettings.personalFreeMessage",defaultMessage:"You are now subscribed to Notion’s Personal Pro Plan for free."},educationPlusFree:{id:"subscriptionSettings.educationPlusFreeMessage",defaultMessage:"You are now subscribed to Notion's Education plan for free"}});async function U(e){const{environment:t,spaceStore:n,plan:o,billingEmail:i,paymentData:r,vatId:a,coupon:l,customerName:f,businessName:g,addressLine1:v,addressZip:b,addressCity:y,addressState:S,addressCountry:w,promoCodeId:k,from:I,addOns:C,useTestClock:x,sessionId:T,inAppOffer:P,isTrial:A}=e,{data:R}=M.default.state,D=H(t,R),E=null==R?void 0:R.addOns;if(!R)throw new Error("Subscription data not loaded.");u.Js({bannerStore:_.Z}),m.j({message:V.updatingSubscription});const F=await d.updateSubscription(t,{spaceId:n.id,plan:o,billingEmail:i,stripeToken:ie(r),paymentMethodId:re(r),vatId:a,coupon:l,customerName:f,businessName:g,addressLine1:v,addressZip:b,addressCity:y,addressState:S,addressCountry:w,promoCodeId:k,addOns:C,useTestClock:x,modalSessionId:T,inAppOffer:P,isTrial:A,clientVersion:t.device.version});let Z,L,j;const U=o?(0,s.qH)(o):void 0;if("failed"===F.type)p.showError(F);else{const e=B.XX(R);if(e){const n=Boolean(o&&o!==e.plan);L=e.plan?(0,s.qH)(e.plan):void 0,j=e.currencyCode;const r={...n?{plan_changed:n,plan_current:o,plan_old:e.plan,currency_code:j}:{plan_changed:n},billing_email_changed:Boolean(i&&i!==e.billingEmail),billing_address_changed:!1};Z=W(R,e),c.wlq(t,r)}else o&&c.k6o(t,{plan:o,credit_amount:0});await G({environment:t,spaceStore:n,newDefaultTeamId:F.data.newDefaultTeamId});const{data:r}=M.default.state;if(!r)throw new Error("Subscription data not loaded.");c._jH(t,{from:I,action:"update",spaceId:n.id,oldSubscriptionTier:D,newSubscriptionTier:H(t,r),oldCurrency:j,newCurrency:"currencyCode"in r?r.currencyCode:void 0,oldPriceId:Z,newPriceId:o,oldAddOns:null==E?void 0:E.map((e=>e.feature)),newAddOns:r.addOns.map((e=>e.feature)),oldBillingInterval:L,newBillingInterval:U??L,addressCountry:w,creditAmount:0,isProfessionalTeamUser:(0,h.QZ)(),planType:n.getPlanType(),isTrial:A})}if(m.x(),"failed"===F.type)throw new Error("An error occurred while updating subscription");return F.data}async function O(e){const{environment:t,spaceStore:n,paymentMethodId:o}=e;m.j({message:V.updatingPaymentMethod});const i=await d.updatePaymentMethod(t,{spaceId:n.id,paymentMethodId:o});if(m.x(),"failed"!==i.type)return await Y(t),i.data;p.showError(i)}async function N(e){const{environment:t,spaceStore:n,address:o}=e;u.Js({bannerStore:_.Z}),m.j({message:V.updatingSubscription});const i=await d.updateSubscription(t,{spaceId:n.id,customerName:o.name,businessName:o.businessName,addressLine1:o.addressLine1,addressLine2:o.addressLine2,addressZip:o.zipCode,addressCity:o.city,addressState:o.state,addressCountry:o.country});if("failed"===i.type)throw m.x(),p.showError(i),i.error;c.wlq(t,{billing_email_changed:!1,plan_changed:!1,billing_address_changed:!0}),await Y(t),await J(t),m.x()}async function z(e){const{environment:t,spaceStore:n,planType:o,from:i}=e,{data:r}=M.default.state;if(!r)throw new Error("Subscription data not loaded.");const a=H(t,r),l=r.addOns,u=B.XX(r),m=null==u?void 0:u.plan,f=m?(0,s.qH)(m):void 0,g=await d.cancelSubscription(t,{spaceId:n.id,planType:o,cancelImmediately:e.cancelImmediately});"failed"===g.type&&p.showError(g);const v=B.XX(r);let b;"subscribed_admin"===r.type&&v&&(b=!0,c.rxu(t,{plan:v.plan})),await G({environment:t,spaceStore:n,newDefaultTeamId:"success"===g.type?g.data.newDefaultTeamId:void 0});const{data:y}=M.default.state;if(!y)throw new Error("Subscription data not loaded.");return c._jH(t,{from:i,action:"cancel",spaceId:n.id,oldSubscriptionTier:a,newSubscriptionTier:H(t,y),oldPriceId:W(r,v),oldCurrency:q(r),newCurrency:q(y),oldAddOns:l.map((e=>e.feature)),oldBillingInterval:f,newBillingInterval:void 0,isCancelSubscription:b,isProfessionalTeamUser:(0,h.QZ)()}),!0}function H(e,t){const n=(0,E.zt)();if(!t)return n;return(0,B.DH)(t)?"free":n}function W(e,t){if(!e)return;return(0,B.DH)(e)||null==t?void 0:t.plan}function q(e){if(e)return"currencyCode"in e?e.currencyCode:void 0}async function G(e){let{environment:t,newDefaultTeamId:n,spaceStore:o}=e;if(await Y(t),await J(t),Z.Z.reset(),(0,y.bq)()&&t.currentUser.id&&void 0!==n){await A.m({userId:t.currentUser.id,spaceId:o.id,environment:t});const e=I.zX.createChildStore(o,{table:"team",id:n,spaceId:o.id});await e.load()}}async function K(e){const{environment:t,spaceStore:n,code:o}=e;m.j({message:V.verifyingEligibility});const{data:i}=M.default.state;if(!i)throw new Error("Subscription data not loaded.");const r=await d.updateSubscriptionToEducationPlan(t,{spaceId:n.id,code:o});"failed"===r.type?p.showError(r):r.data.isEligible?ee(i,t):T.Z.setState({open:!0,handlePromoCode:async e=>{m.j({message:V.updatingSubscription});const o=await d.updateSubscriptionToEducationPlan(t,{spaceId:n.id,code:e});"failed"===o.type?p.showError(o):o.data.isEligible?ee(i,t):p.showErrorMessage((0,L.jsx)(l.FormattedMessage,{id:"subscriptionSettings.invalidPromoCodeError.message",defaultMessage:"This promo code is not valid."})),m.x()}}),m.x()}function $(){j&&j.close()}async function Q(e){const{environment:t,spaceId:n,isNewlyCreatedSpace:o}=e,i=M.default.state.spaceId;if(!t.currentUser.isLoggedIn()||i&&i===n)await M.default.waitUntilLoaded();else if(M.default.setState({...M.default.state,spaceId:n}),P.Z.setState({...P.Z.state,spaceId:n}),o){const e={type:"unsubscribed_admin",users:[],bots:[],joinedMemberIds:[],blockUsage:0,hasPaidNonzero:!1,accountBalance:0,timelineViewUsage:0,inviteLinkCode:"",userSimilarity:{},spaceUsers:[],members:[],customerData:void 0,revenueCatEnabled:!1,addOns:[],currencyCode:void 0};M.default.setState({...M.default.state,data:e}),Y(t)}else Y(t),J(t)}async function Y(e){const{spaceId:t}=M.default.state,n=e.currentUser.id;if(!t)throw new Error("No spaceId.");{const o=`SubscriptionData:${t}:v2`,a=r.Z.get({userId:n,key:o});a&&M.default.setState({spaceId:t,data:a}),await async function(e){let{environment:t,spaceId:n,currentUserId:o,localKey:a}=e;o&&R.default.initializeAndLoadAllUserSignals({environment:t,userId:o,spaceId:n});await w.transactionQueue.drain();const[s,l]=await Promise.all([d.getSubscriptionData(t,{spaceId:n}),d.getVisibleUsers(t,{spaceId:n})]);if("success"===s.type&&"success"===l.type){const e={...s.data,...l.data};r.Z.set({userId:o,key:a,value:e}),M.default.state.spaceId===n&&(M.default.setState({spaceId:n,data:e}),B.YK(e)&&c.jw0(t))}else i.log({level:"error",from:"subscriptionActions",type:"fetchSubscriptionDataFailed",data:{miscDataToConvertToString:{getSubscriptionDataResponseType:s.type,getSubscriptionDataResponseStatus:s.status,getVisibleUserResponseType:l.type,getVisibleUserResponseStatus:l.status}}});await k.Z.awaitPublicSpaceData(t,n,!0)}({environment:e,spaceId:t,currentUserId:n,localKey:o})}}async function J(e){const{spaceId:t}=M.default.state,n=e.currentUser.id;if(!t)throw new Error("No spaceId.");{const o=`UpcomingInvoiceData:${t}:v2`,a=r.Z.get({userId:n,key:o});a&&P.Z.setState({spaceId:t,data:a}),await w.transactionQueue.drain();const s=await d.getInvoiceData(e,{spaceId:t,type:"upcoming"});if("success"===s.type){const{data:e}=s;r.Z.set({userId:n,key:o,value:e.invoiceData}),P.Z.state.spaceId===t&&P.Z.setState({spaceId:t,data:e.invoiceData})}else i.log({level:"error",from:"subscriptionActions",type:"fetchUpcomingInvoiceCall",data:{miscDataToConvertToString:{upcomingInvoiceResponse:s}}})}}async function X(e,t){const n=S.default.state.currentSpaceStore;if(!n)return;const o=await d.getBillingHistory(e,{spaceId:n.id,limit:t.state.billingEventsLimit});"success"===o.type&&t.update((e=>({...e,billingEvents:o.data.events})))}async function ee(e,t){await Y(t),J(t),Z.Z.reset();const n=()=>{p.showMessage({message:v.default.formatMessage(V.educationPlusFree)}),C.Z.setState({...C.Z.state,currentTab:"billing",defaultSubtab:void 0});const n=B.XX(e);c.jhO(t,{plan:"student_free",old_plan:n?n.plan:void 0})};await f.shouldCreatePassword(t)?b.E({environment:t,onSubmit:n,onCancel:n}):n()}function te(e){const{data:t}=M.default.state;if(e.device.isMobileNative)return!0;if(t){if((0,D.du)())return!0;if(B.Ln(e,t))return c.ljn(e),function(e){if((0,D.du)())return;u.Bw({id:"SubscriptionEditingBlocker",bannerStore:_.Z,styleKey:g.v.Red,contentKey:"over_free_block_limit"})}(),!1;B.XZ(e,t)&&c.z2b(e)}if((0,D.e0)()){var n,i;const e=null===(n=S.default.state.currentSpaceStore)||void 0===n?void 0:n.getOverdueSubscription(),t=B.aS(M.default.state.data),r=null==t||null===(i=t.testClock)||void 0===i?void 0:i.frozen_time,s=r?o.ou.fromSeconds(r):o.ou.now(),{paymentStatus:l}=(0,a.cS)({now:s,overdueSubscription:e});if("unpaid"===l)return!1}return u.qL({bannerStore:_.Z,id:"SubscriptionEditingBlocker"}),!0}function ne(e,t){const{subscriptionTier:n,from:o,addOnFeature:i,coupon:r,isTrial:a}=t;c.Lc3(e,{subscriptionTier:n,from:o,addOnFeature:i,currency_code:Z.Z.state.selectedCurrencyCode,isTrial:a});const s=i||a||!D.F4()?"month":"year";x.Z.open({subscriptionTier:n,billingInterval:s,addOnFeature:i,coupon:r,isTrial:a})}function oe(e){F.Z.open(e)}function ie(e){return"stripeToken"===(null==e?void 0:e.type)?e.value:void 0}function re(e){return"paymentMethodId"===(null==e?void 0:e.type)?e.value:void 0}},70060:(e,t,n)=>{n.d(t,{$r:()=>P,F4:()=>S,IC:()=>I,KC:()=>u,Mk:()=>v,R$:()=>A,U0:()=>M,YE:()=>b,Z$:()=>x,bI:()=>T,bQ:()=>D,du:()=>m,e0:()=>C,fQ:()=>g,fX:()=>R,fw:()=>f,oP:()=>h,px:()=>y,rR:()=>w,vi:()=>k});var o=n(44317),i=n(3791),r=n(47425),a=n(80444),s=n(77080),l=n(78291),c=n(88893),d=n(35057);function u(){return s.default.getEligibleGroup({experimentId:"block_limit_increase"})}function p(){const{currentSpaceStore:e}=a.default.state,t=null==e?void 0:e.getSettings().first_invited_member_time;return t?(0,o.O5)(t):null}function m(){const e=p();return null!==e&&(!(null!==e&&e>7)&&"on"===s.default.getEligibleGroup({experimentId:"block_limit_delay",defaultGroup:"control"}))}function f(){var e;const t=null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.getSettings();return null!=t&&t.seen_block_limit_reduction_v2&&"on"===s.default.getEligibleGroup({experimentId:"block_limit_reduction"})?"decrease":null!=t&&t.seen_block_limit_increase&&"on"===s.default.getEligibleGroup({experimentId:"block_limit_increase"})?"increase":"normal"}function g(){const e=p();return null!==e&&7-e>0?7-e:-1}function h(){return Boolean("on"===s.default.getGroup("churn_nudge"))}function v(){return Boolean("on"===s.default.getGroup("contraction_confirmation"))}function b(){return Boolean("on"===s.default.getGroup("contraction_confirmation_survey"))}function y(e,t){var n;if(e.device.isMobile)return!1;const{data:o}=l.default.state;if(!o)return!1;if(("subscribed_admin"===o.type||"unsubscribed_admin"===o.type)&&null!==(n=o.customerData)&&void 0!==n&&n.stripe&&Boolean(o.customerData.stripe.promo))return!1;const i=t??(0,d.zt)();return!!((0,r.mq)(i)&&(0,c.su)(o)<100&&Boolean("on"===s.default.getGroup("largesse")))}function S(){return Boolean("on"===s.default.getGroup("subscription_default_annual"))}function _(){return s.default.getGroup("subscription_elements")??"control"}function w(){return["payment","payment_and_address"].includes(_())}function k(){return["control","payment_and_address"].includes(_())}function I(){const e=s.default.getGroup("subscription_payment_status");return Boolean("on"===e||"message_only"===e)}function C(){return Boolean("on"===s.default.getGroup("subscription_payment_status"))}function x(){return Boolean("unassigned"===s.default.getEligibleGroup({experimentId:"tt_me_pregunto",defaultGroup:"unassigned"}))}function T(){return Boolean("on"===s.default.getEligibleGroup({experimentId:"tt_me_pregunto",defaultGroup:"unassigned"}))}function M(e){var t;if(!(0,d.QM)())return!1;if((0,i.E3)(e.addOns))return!1;const n=null===(t=a.default.state.currentSpaceStore)||void 0===t?void 0:t.getSettings();return null!=n&&n.exposed_to_timed_trials_in_onboarding?T():Boolean("on"===s.default.getGroup("tt_pp"))}function P(){return Boolean("on"===s.default.getGroup("pricing_plans_v3"))}function A(){return Boolean("on"===s.default.getGroup("upsell_colors"))}function R(){return Boolean(s.default.checkGate("advanced_security_in_enterprise"))}function D(){return Boolean("on"===s.default.getGroup("mobile_web_subscriptions"))}},88893:(e,t,n)=>{n.d(t,{A7:()=>le,Bu:()=>F,CM:()=>pe,DH:()=>B,E$:()=>ue,Et:()=>H,Fu:()=>ve,GD:()=>K,GJ:()=>P,Gh:()=>N,He:()=>_e,Io:()=>de,Ln:()=>ge,Lz:()=>q,M9:()=>$,MM:()=>z,Md:()=>G,ND:()=>oe,NM:()=>ee,NW:()=>J,Ns:()=>ce,Q6:()=>me,Tj:()=>x,XX:()=>T,XZ:()=>O,YK:()=>E,_9:()=>fe,aS:()=>M,cA:()=>te,f3:()=>Se,gG:()=>R,hn:()=>re,lk:()=>ie,m_:()=>he,o9:()=>be,qF:()=>Z,qX:()=>se,qb:()=>U,su:()=>ae,t1:()=>we,uN:()=>X,uo:()=>V,wY:()=>D,wl:()=>A,xR:()=>W,y$:()=>ye,ye:()=>j,zl:()=>ne,zt:()=>Q});n(57658),n(67294);var o=n(77458),i=n(59905),r=n(67677),a=n(31843),s=n(28067),l=n(95485),c=n(72126),d=n(5366),u=n(27006),p=n(31919),m=n(2438),f=n(47425),g=n(97880),h=n(95477),v=n(52533),b=n(80444),y=n(81236),S=n(27242),_=n(78291),w=n(70060),k=n(33941),I=n(35057),C=n(85893);const x=.9;d.FormattedMessage,d.FormattedMessage,d.FormattedMessage;function T(e){if(e&&"subscribed_admin"===e.type&&function(e){return void 0!==e.billing}(e.customerData.stripe))return e.customerData.stripe}function M(e){var t;if(e&&("subscribed_admin"===e.type||"unsubscribed_admin"===e.type))return null===(t=e.customerData)||void 0===t?void 0:t.stripe}function P(e){return!!e&&("subscribed_admin"===e.type||"unsubscribed_admin"===e.type)}function A(e){return e&&function(e){const t=T(e);if(t)return t.productId}(e)===h.default.pricing.student.productId}function R(e){return e.startsWith("enterprise")}function D(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&"revenueCat"===e.customerData.activeSubscriptionPlatform&&e.customerData.revenueCat&&!0===e.customerData.revenueCat.isSubscribed)}function B(e){const t=T(e);return t&&"number"==typeof t.canceledAt&&"number"==typeof t.willCancelAt}function E(e){return Boolean(e&&"unsubscribed_admin"!==e.type&&"unsubscribed_member"!==e.type&&"unsubscribed_guest"!==e.type)}function F(e){return!E(e)}function Z(e){return!ke(e,["personal","student","personal_free"])}function L(e){return(0,I.QM)()}function j(){return(0,I.mq)()}function V(e){return ke(e,["personal_free","personal","free"])}function U(e,t){return t===(0,I.zt)()}function O(e,t){return ne(e,t)>=.75}async function N(e){const{environment:t,userRootStore:n}=e;if(!n)return;const o=n.getAdminSpaceIds().map((async e=>{const n=await y.Z.awaitPublicSpaceData(t,e);return n&&n.productId})),i=await Promise.all(o);return c.oA(i)}function z(e){var t;const n="subscribed_admin"===(null==e?void 0:e.type)||"unsubscribed_admin"===(null==e?void 0:e.type)?null===(t=e.customerData)||void 0===t?void 0:t.stripe:void 0;return Boolean(null==n?void 0:n.paymentMethodType)}function H(e){const t=T(e);return"unsubscribed_admin"===e.type||"unsubscribed_member"===e.type?e.accountBalance:t?t.accountBalance:0}function W(e){const{environment:t,userRootStore:n}=e;if(!n)return;const o=n.getAdminSpaceIds().map((e=>{const n=y.Z.getPublicSpaceData(t,e);return n&&n.productId}));return c.oA(o)}function q(e,t){const n=ae(t)>1;return F(t)&&L()&&n?t.blockUsage:0}function G(e,t){const{currentUserStore:n}=b.default.state,o=T(t),i=null!=n&&n.isDefined()?n.getEmail():void 0;return e.temporaryBillingEmail||("subscribed_admin"===t.type&&o?o.billingEmail:void 0)||i}function K(e){return e||"year"}function $(e){return!!(0,I.QM)()&&((0,v.S$)({environment:e})?"personal":"plus")}function Q(e){return[{type:"credit_card",title:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,C.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.paymentMethod.creditCard.title",defaultMessage:"Credit or debit card"}),(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)("div",{style:{marginLeft:5},children:(0,l.w)({width:23})}),(0,C.jsx)("div",{style:{marginLeft:5},children:(0,s.N)({width:23})}),(0,C.jsx)("div",{style:{marginLeft:5},children:(0,o.b)({width:23})}),(0,C.jsx)("div",{style:{marginLeft:5},children:(0,r.d)({width:23})})]})]})},{type:"invoice",title:(0,C.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.paymentMethod.invoice.title",defaultMessage:"ACH or wire transfer"}),caption:(0,C.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.paymentMethod.invoice.caption",defaultMessage:"Receive an invoice via email"})},{type:"native_payment_platform",title:(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.paymentMethod.appleOrGooglePay.title",defaultMessage:"Apple or Google Pay"}),(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)("div",{style:{marginLeft:5},children:(0,i.T)({width:23})}),(0,C.jsx)("div",{style:{marginLeft:5},children:(0,a.o)({width:23})})]})]})}].filter((t=>e.includes(t.type)))}function Y(e){const{memberCount:t,subscriptionTier:n,addOnFeature:o,isAddOnFeature:i,billingInterval:r,coupon:a}=e,s=function(e){const{subscriptionTier:t,addOnFeature:n,isAddOnFeature:o}=e;if(!h.default.pricing)return;if(o&&void 0!==n)return h.default.pricing[n].productId;const i=h.default.pricing[t];if("productId"in i)return i.productId}({subscriptionTier:n,addOnFeature:o,isAddOnFeature:i});let l,c,d;return s===h.default.pricing.ai.productId?(l=h.default.pricing.ai.yearlyPricePerMember,c=h.default.pricing.ai.monthlyPricePerMember,"ai_fifty_percent"===a&&(l-=4800,c-=500),d="year"===r?l*t:c*t):s===h.default.pricing.personal.productId?(l=h.default.pricing.personal.yearlyPrice,c=h.default.pricing.personal.monthlyPrice,d="year"===r?l:c):s===h.default.pricing.plus.productId?(l=h.default.pricing.plus.yearlyPricePerMember,c=h.default.pricing.plus.monthlyPricePerMember,d="year"===r?l*t:c*t):s===h.default.pricing.business.productId?(l=h.default.pricing.business.yearlyPricePerMember,c=h.default.pricing.business.monthlyPricePerMember,d="year"===r?l*t:c*t):(l=h.default.pricing.enterprise.yearlyPricePerMember,c=h.default.pricing.enterprise.monthlyPricePerMember,d="year"===r?l*t:c*t),{yearlyUnitPrice:l,monthlyUnitPrice:c,planAmount:d}}function J(e){const t=_.default.state.data;return e===h.default.pricing.personal.productId||D(t)?"personal":e===h.default.pricing.student.productId?"personal_education":e===h.default.pricing.plus.productId?"plus":e===h.default.pricing.business.productId?"business":e===h.default.pricing.enterprise.productId?"enterprise":e===h.default.pricing.ai.productId?"ai":"legacy"}function X(e){const{subscriptionTier:t,currencyCode:n,promo:o,data:i,onlyShowAddOn:r,calculatingTax:a,taxAmount:s,addOnFeature:l,billingInterval:c,coupon:u}=e,f=ae(i),g=Math.min(0,H(i));let h=0,v=0,b=0;const y=void 0!==l;if(!r){const e=Y({subscriptionTier:t,memberCount:f,isAddOnFeature:!1,billingInterval:c});h+=e.yearlyUnitPrice,v+=e.monthlyUnitPrice,b+=e.planAmount}if(y){const e=Y({subscriptionTier:t,memberCount:f,isAddOnFeature:!0,addOnFeature:l,billingInterval:c,coupon:u});h+=e.yearlyUnitPrice,v+=e.monthlyUnitPrice,b+=e.planAmount}const S=(0,m.uN)(b,o),_=p.n.fromValue({amount:b-S.amount+g+(s&&!a?s:0),currencyCode:n}).zeroIfNegative(),w=[{type:"standard",name:(0,C.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.subTotal",defaultMessage:"Subtotal"}),price:p.n.fromValue({amount:b,currencyCode:n})}];return w.push({type:a?"calculating":"standard",name:(0,C.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.taxIfApplicable.title",defaultMessage:"Tax if applicable"}),price:p.n.fromValue({amount:b,currencyCode:n})}),0!==S.amount&&w.push({type:"promotion",name:(0,C.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo",defaultMessage:"Coupon"}),price:p.n.fromValue({amount:S.amount,currencyCode:n}),subtitle:S.monthsRemaining?(0,C.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo.subtitle",defaultMessage:"Valid for {durationInMonths} months",values:{durationInMonths:S.monthsRemaining}}):void 0}),g<0&&w.push({type:"promotion",name:(0,C.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.balance",defaultMessage:"Balance"}),price:p.n.fromValue({amount:-g,currencyCode:n})}),{yearlyUnitPrice:h,monthlyUnitPrice:v,planAmount:b,payAmount:_,accountBalance:g,lineItems:w,promoInfo:S}}function ee(e){return"bots"in e?e.bots:[]}function te(e,t){if((0,w.du)()&&ge(e,t)){const e=(0,w.fQ)(),t=(()=>{switch(e){case 0:return(0,C.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitToday",defaultMessage:"to upgrade today"});default:return(0,C.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitNumDays",defaultMessage:"{remainingDays, plural, one {1 day to upgrade} other {{remainingDays} days to upgrade}}",values:{remainingDays:e}})}})();return(0,C.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimit",defaultMessage:"You've hit Notion's trial block limit, and you have {remainingDaysMessage} before we limit new content creation.",values:{remainingDaysMessage:t}})}return(0,C.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.reachedFreeBlockLimit",defaultMessage:"This workspace has used {usedBlocks} of its {freeBlockLimit} block storage limit ({utilizationPercentage}).",values:{usedBlocks:q(0,t),freeBlockLimit:(0,f.v5)((0,w.fw)()),utilizationPercentage:(0,C.jsx)(d.FormattedNumber,{value:ne(e,t),style:"percent",maximumSignificantDigits:2,maximumFractionDigits:0})}})}function ne(e,t){return q(0,t)/(0,f.v5)((0,w.fw)())}function oe(e){return pe(e).filter((e=>!(0,u.Jy)(e.role)))}function ie(e){return oe(e).length}function re(e){return pe(e).filter((e=>(0,u.Jy)(e.role)))}function ae(e){return re(e).length}function se(){const{data:e}=_.default.state;return e?ae(e):1}function le(){const{data:e}=_.default.state;return e?oe(e):[]}function ce(){const e=se();return e<=99?"SMB":e<=1999?"Mid-Market":"Enterprise"}function de(){const{data:e}=_.default.state;return e?re(e):[]}function ue(e){const{state:t,availablePaymentMethods:n}=e;return(null==t?void 0:t.open)&&(null==t?void 0:t.type)===S.U.TargetSpace?n.filter((e=>"credit_card"===e)):n}function pe(e){return"visibleUsers"in e?e.visibleUsers:e.users}function me(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&e.customerData.stripe.isSubscribed&&("enterprise_free"===e.customerData.stripe.plan||"business_sales_assisted"===e.customerData.stripe.plan))}function fe(e){return"unsubscribed_member"===e.type||"unsubscribed_admin"===e.type||"subscribed_member"===e.type||"subscribed_admin"===e.type||"subscribed_membership_admin"===e.type}function ge(e,t){return q(0,t)>=(0,f.v5)((0,w.fw)())}function he(e){return f.wP(e)?"setup_enterprise_trial":f.NG(e)?"setup_business_trial":void 0}function ve(e){return!1}function be(e){return f.QM(e)}function ye(e){return!L()}function Se(e){return!L()}function _e(){return f.hf((0,I.zt)())}function we(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(k.a.free);case"personal":return t.formatMessage(k.a.personal);case"student":return t.formatMessage(k.a.educationPlan);case"plus":return t.formatMessage(k.a.plusPlan);case"business":return t.formatMessage(k.a.business);case"enterprise":return t.formatMessage(k.a.enterprise);default:(0,g.t1)(e)}}function ke(e,t){const n=(0,I.zt)();return!!n&&t.includes(n)}},33941:(e,t,n)=>{n.d(t,{a:()=>o});const o=(0,n(5366).defineMessages)({ai:{defaultMessage:"AI",id:"ai.title"},personalFreePlan:{defaultMessage:"Personal Plan",id:"personalFreePlan.title"},personalFree:{defaultMessage:"Personal",id:"personalFree.title"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},free:{defaultMessage:"Free",id:"free.title"},personalPlan:{defaultMessage:"Personal Pro Plan",id:"personalPlan.label"},personal:{defaultMessage:"Personal Pro",id:"personal.label"},singlePlayerPlusPlan:{defaultMessage:"Plus Plan with a 1-member limit",id:"singlePlayerPlusPlan.title"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"personalEducationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},team:{defaultMessage:"Team",id:"team.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},plus:{defaultMessage:"Plus",id:"plus.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},business:{id:"business.title",defaultMessage:"Business"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},enterprise:{defaultMessage:"Enterprise",id:"enterprise.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}})},35057:(e,t,n)=>{n.d(t,{Aw:()=>p,Mk:()=>d,QM:()=>c,Rs:()=>s,iJ:()=>m,mq:()=>u,p4:()=>f,sX:()=>a,wP:()=>l,zt:()=>r});var o=n(47425),i=n(78291);function r(){return i.default.getSubscriptionTier()}function a(){return o.sX(r())}function s(){return o.Rs(r())}function l(){return o.wP(r())}function c(){return o.QM(r())}function d(){return o.Mk(r())}function u(){return o.mq(r())}function p(){return o.Aw(r())}function m(){return o.iJ(r())}function f(e){return o.eZ(r(),e)}},62142:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(4615),r=n(27242);class a extends o.default{getInitialState(){return{open:!1,succeeded:!1}}close(){this.setState({open:!1,succeeded:!1})}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}open(e){this.setState({open:!0,temporaryPaymentMethod:"credit_card",temporaryBillingInterval:"month",temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,vatApplicable:!1,calculatingTax:!1,payButtonState:"disabled",subscriptionTier:"enterprise",targetPlan:void 0,targetSpace:e,totalUpgradeCost:void 0,onlyShowAddOn:!1,sessionId:(0,i.ZP)(),type:r.U.TargetSpace})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const s=new a},33493:(e,t,n)=>{n.d(t,{Z:()=>d});n(21703);var o=n(49085),i=n(92595),r=n(64793),a=n(12139),s=n(80444),l=n(22616);class c extends o.default{constructor(){var e;let t,n;super(),e=this;const o=()=>{if("ready"!==this.state.status)return;const e=this.state.prices.map((e=>{const t=Math.floor(100*Math.random()),n=Math.floor(e.unitAmount.amount/100);return new r.t({external_id:e.externalId,product:e.product,billing_interval:e.billingInterval,currency:e.currencyCode,state:e.state,regions:e.regions,unit_amount:100*n+t})}));this.setPrices(e)};(0,i.exposeDebugValue)("randomizePrices",(function(){let i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("ready"!==e.state.status)return;const r=Boolean(n);i!==r&&(n&&(clearInterval(n),n=void 0),i?(t=e.state.prices,n=setInterval(o,1e3),o()):t&&e.setPrices(t))}))}getInitialState(){return{status:"init",prices:[],availableCurrencyCodes:["USD"],selectedCurrencyCode:void 0}}resetExceptSelectedCurrencyCode(){this.update((e=>({...this.getInitialState(),selectedCurrencyCode:e.selectedCurrencyCode})))}waitUntilReady(){return this.waitUntil((()=>"ready"===this.state.status))}setPrices(e){this.update((t=>{const n=Array.from(new Set(e.map((e=>e.currencyCode))));n.sort();const o=t.selectedCurrencyCode&&n.includes(t.selectedCurrencyCode)?t.selectedCurrencyCode:n.find((e=>"USD"!==e))??"USD";return{...t,status:"ready",prices:e,availableCurrencyCodes:n,selectedCurrencyCode:o}}))}didStartLoading(){this.update((e=>({...e,status:"loading"})))}getPrice(e,t){const{status:n,selectedCurrencyCode:o}=this.state;if("init"===n){var i;const t=null===(i=s.default.state.currentSpaceStore)||void 0===i?void 0:i.id;t&&l.Z({environment:e,spaceId:t})}if("ready"!==n)return{isLoaded:!1,result:void 0};const r=this.state.prices,c=r.filter((e=>e.currencyCode===o)),d=c.find(t);return d||a.IE(new Error("No matching price found in PriceStore.getPrice"),{extra:{allPriceCount:r.length,selectedCurrencyCode:o,selectedCurrencyPriceCount:c.length}}),{isLoaded:!0,result:d}}get selectedCurrencyCode(){return this.state.selectedCurrencyCode??"USD"}get availableCurrencyCodes(){return this.state.availableCurrencyCodes}get prices(){return this.state.prices}}const d=new c},99334:(e,t,n)=>{let o;function i(e){o=e}function r(){return o}n.d(t,{$:()=>i,K:()=>r})},9867:(e,t,n)=>{n.d(t,{wT:()=>ie,aQ:()=>he,ED:()=>ke,mX:()=>Q,w6:()=>de,Ui:()=>ye,Xy:()=>Ie,Uj:()=>ce,Cj:()=>le,um:()=>ae,s:()=>me,Dv:()=>pe,lo:()=>oe,tn:()=>we,hI:()=>_e,mN:()=>ge,WO:()=>fe,X0:()=>ee,YH:()=>ve,JX:()=>Se,Ju:()=>te,$J:()=>$,jg:()=>ne,xI:()=>K,lH:()=>q,fs:()=>H,$x:()=>W,d:()=>be,W8:()=>J,Ce:()=>Y,RF:()=>ue});n(21703),n(57658);var o=n(15145),i=n(5220),r=n(68626),a=n(91155),s=n(27006),l=n(15047),c=n(29369),d=n(19889),u=n(90965),p=n(64684),m=n(97880),f=n(63143),g=n(50906),h=n(54642),v=n(47307),b=n(76464),y=n(9953),S=n(75018),_=n(29974),w=n(150),k=n(39699),I=n(65452),C=n(28020),x=n(33929),T=n(45010),M=n(78122),P=n(21115),A=n(27406),R=n(68418),D=n(38676),B=n(55838),E=n(80444),F=n(3418),Z=n(35661),L=n(42185),j=n(30397),V=n(34583),U=n(35057),O=n(30297),N=n(60396),z=n(36225);function H(e){const{store:t,update:n,transaction:o}=e;y.sW({store:t,data:(0,f.Q2)(n),transaction:o})}function W(e){let{environment:t,store:n,update:o,transaction:i}=e;const r=function(e){let{store:t,update:n}=e;const o=t.getSettingsStore().getValue();if(!o)return{};const i={};for(const r in n)i[r]=o[r];return i}({store:n,update:o});y.sW({store:n.getSettingsStore(),data:(0,f.Q2)(o),transaction:i}),g.ORE(t,{store:n,old_settings:r,updated_settings:o})}async function q(e){let{environment:t,spaceValue:n,addedStores:o,removedStores:i,createNewTeamFlowId:r,from:a}=e;const s=t.currentUser.id;if(!s||o.some((e=>!e.isDefined())))return!1;if(!(0,u.wv)(n,s))throw new Error("Only admins can update default teams");const{performResult:{results:l},serverCommitResult:c}=k.createAndCommit({environment:t,userAction:"teamActions.updateDefaultTeams",perform:e=>{const n=[];for(const i of o){const o=G({environment:t,transaction:e,teamStore:i,isDefault:!0,from:a,createNewTeamFlowId:r});n.push(o)}for(const o of i){const i=G({environment:t,transaction:e,teamStore:o,isDefault:!1,from:a,createNewTeamFlowId:r});n.push(i)}return{results:n}}});return await c,await V.bi(t),l.every((e=>e))}function G(e){let{environment:t,transaction:n,teamStore:o,isDefault:i,from:r,createNewTeamFlowId:a}=e;return o.isDefault()===i||(y.sW({store:o,data:{is_default:i},transaction:n}),n.postSubmitCallbacks.push((e=>{e||g.cXp(t,{store:o,is_default_team:i,create_new_team_flow_id:a,from:r})}))),!0}function K(e){var t;const{environment:n,teamStore:o,newRole:i,transaction:r,permissionsToClear:a}=e,l=a.map((e=>({...e,role:"none"}))),c=(null===(t=o.getTeamPermission())||void 0===t?void 0:t.role)??"none",d={type:"explicit_team_permission",team_id:o.id,role:i};l.push(d),b.ep({environment:n,store:o,permissionItems:l,transaction:r}),o.isDefault()&&b.ep({environment:n,store:o,permissionItems:[{type:"space_permission",role:i}],transaction:r}),(0,s.J5)(c)||!(0,s.J5)(i)||o.getDisableTeamPageEdits()||W({environment:n,store:o,update:{disable_team_page_edits:!0},transaction:r})}function $(e){const{environment:t,teamStore:n,newRole:o,transaction:i,permissionsToClear:r}=e,a=r.map((e=>({...e,role:"none"}))),s={type:"explicit_team_guest_permission",team_id:n.id,role:o};a.push(s),b.ep({environment:t,store:n,permissionItems:a,transaction:i})}function Q(e){let{userId:t,teamStore:n,transaction:o,environment:i,permissionRole:r}=e;const a=n.getMembershipDefinedOnTeam(),s=a.find((e=>"user"===e.entity_type&&e.user_id===t));if(!s)throw new Error("Specified user is not on the team");if("member"===s.type)return!1;if(!n.isDefined())return!1;const l=n.getPermissionItems(),c=n.id;if(r&&(0,p.bk)({teamValue:{id:c,permissions:l},permissionRole:r}))throw new Error("Cannot set member's permission to be lower than default team permission.");if(!(0,p.XO)({membership:a}).includes(t))throw new Error("Specified user is not an owner of the team");let d=!1;if(a.length>0){const e=a.filter((e=>!("user"===e.entity_type&&e.user_id===t)));d=a.length!==e.length;const r=[{entity_type:"user",type:"member",user_id:t},...e];k.applyOperation({store:n,operation:{pointer:n.pointer,path:["membership"],command:"set",args:r},transaction:o}),g.PdU(i,{store:n,permission_user_id:t,team_role:"member"})}let u=r||"none";const m=(0,p.xC)({id:c,permissions:l});m&&r===m&&(u="none");const f={type:"user_permission",role:u,user_id:t};return b.ep({environment:i,store:n,permissionItems:[f],transaction:o,skipAnalytics:d})}function Y(e){let{environment:t,userId:n,teamStore:o,spaceStore:i,transaction:r,newTeamRole:a}=e;if(!o.isDefined())return!1;const s=o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===n));return!!s&&(s.type!==a&&(k.applyOperation({store:o,operation:{pointer:o.pointer,path:["membership"],command:"setTeamMembershipItem",args:{entity_type:"user",type:a,user_id:n}},transaction:r}),b.ep({environment:t,store:i,permissionItems:[{type:"user_permission",role:"read_and_write",user_id:n}],transaction:r}),ee({environment:t,memberInfo:s,teamStore:o,transaction:r}),!0))}function J(e){let{environment:t,userId:n,teamStore:o,transaction:i}=e;const r=o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===n));if(!r)throw new Error("Specified user is not on the team");if("owner"===r.type)return!1;if(!o.isDefined())return!1;const a=o.getMembershipDefinedOnTeam().filter((e=>!("user"===e.entity_type&&e.user_id===n))),s=[{entity_type:"user",type:"owner",user_id:n},...a];return k.applyOperation({store:o,operation:{pointer:o.pointer,path:["membership"],command:"set",args:s},transaction:i}),g.PdU(t,{store:o,permission_user_id:n,team_role:"owner"}),ee({environment:t,memberInfo:r,teamStore:o,transaction:i}),!0}function X(e){let{memberInfo:t,newRole:n}=e;return"user"===t.entity_type?{type:"user_permission",user_id:t.user_id,role:n}:{type:"group_permission",group_id:t.group_id,role:n}}function ee(e){let{environment:t,memberInfo:n,teamStore:o,transaction:i}=e;return!!o.getPermissionItems()&&(b.ep({environment:t,store:o,permissionItems:[X({memberInfo:n,newRole:"none"})],transaction:i}),!0)}async function te(e){let{store:t,environment:n,accessLevel:o,teamName:i,from:r,isDefault:a}=e;const{currentSpaceStore:s}=E.default.getState();if(!s)throw new Error("currentSpaceStore does not exist");const l=t.isDefault()??!1,c=t.getTeamAccessLevel(),d=(0,p.Hf)({membership:t.getRawMembership()}).length;if(o===c&&a===l)return!1;if(!(await M.hL({teamName:i,accessLevel:o,currentIsDefault:l,isDefault:a,numberOfTeamGuests:d})))return!1;const u=t.getPermissionItems(),m=t.getSettingsStore().getValue();if(!m||!u)return!1;const f=(0,p.AW)({teamValue:{id:t.id,permissions:u,settings:m},accessLevel:o,isDefault:a}),{performResult:{result:h}}=k.createAndCommit({userAction:"teamActions.setTeamAccessLevel",environment:n,perform:e=>{G({environment:n,transaction:e,teamStore:t,isDefault:"invite_only"!==f.settings.space_member_join_access&&a,from:r,createNewTeamFlowId:void 0});const o=b.ep({environment:n,store:t,permissionItems:f.permissions,transaction:e});return y.sW({store:t.getSettingsStore(),data:f.settings,transaction:e}),{result:o}}});return h&&g.BWF(n,{store:t,old_access_level:c,new_access_level:o,from:r}),h}function ne(e){let{memberInfo:t,teamStore:n,transaction:o,environment:i,permissionRole:r}=e;if("owner"===t.type)return Q({userId:t.user_id,teamStore:n,transaction:o,environment:i,permissionRole:r});if(!n.isDefined())return!1;const a=n.id,s=n.getPermissionItems(),l=n.getMembers();if(r&&(0,p.bk)({teamValue:{id:a,permissions:s},permissionRole:r}))throw new Error("Cannot set member's permission to be lower than default team permission.");const c=(0,p.hY)({membership:l});if("user"===t.entity_type&&!c.find((e=>"user"===e.entity_type&&e.user_id===t.user_id))||"group"===t.entity_type&&!c.find((e=>"group"===e.entity_type&&e.group_id===t.group_id)))throw new Error("Specified memberInfo not found on team");let d=r||"none";const u=(0,p.xC)({id:a,permissions:s});return u&&r===u&&(d="none"),b.ep({environment:i,store:n,permissionItems:[X({memberInfo:t,newRole:d})],transaction:o})}function oe(e,t){R.Z.setState({...R.Z.state,open:!0,from:e}),R.Z.state.onClose=null==t?void 0:t.onClose}async function ie(e){let{environment:t,currentSpaceStore:n,teamStore:o,from:i,action:r}=e;const a=t.currentUser.id;if(!a||!n||!(0,O.o)({userId:a,spaceStore:n,entrypoint:i}))return!1;if(!(await async function(e){return!z.Z.state.open&&await new Promise((t=>{z.Z.setState({open:!0,type:e,onAccept:()=>t(!0),onCancel:()=>t(!1)})}))}(r)))return!1;const s=await h.setAdminPrivilegedTeamMembership(t,{spaceId:n.id,teamId:o.id,teamRole:re(r)});if("failed"===s.type)return Ie(s),!1;switch(r){case"joinTeamAsOwner":case"joinClosedOrPrivateTeamAsMember":se({environment:t,teamStore:o,from:i,newRole:"joinTeamAsOwner"===r?"owner":"member",usingAdminPrivileges:!0,andNavigateToTeamHome:!1});break;case"upgradeToOwner":g.PdU(t,{permission_user_id:a,team_role:"owner",store:o});const e=o.getName();e&&(0,P._t)(e);break;default:(0,m.t1)(r)}return!0}function re(e){switch(e){case"joinTeamAsOwner":case"upgradeToOwner":return"owner";case"joinClosedOrPrivateTeamAsMember":return"member";default:(0,m.t1)(e)}}async function ae(e){let{environment:t,currentSpaceStore:n,teamStore:o,from:i,andNavigateToTeamHome:r}=e;const a=t.currentUser.id;if(!a)return!1;const s=await h.updateTeamMembers(t,{spaceId:n.id,teamId:o.id,newMembersOrGuestsToAdd:[{type:"member",entity_type:"user",user_id:a}]});return"failed"===s.type?(Ie(s),!1):(se({environment:t,teamStore:o,from:i,newRole:"member",usingAdminPrivileges:!1,andNavigateToTeamHome:r}),!0)}function se(e){let{environment:t,teamStore:n,from:o,newRole:i,usingAdminPrivileges:r,andNavigateToTeamHome:a}=e;const s=t.currentUser.id,l=E.default.state.currentSpaceStore,c=E.default.state.currentSpaceViewStore;if(!s||!l||!c)return!1;!function(e){var t;let{environment:n,currentSpaceViewStore:o,teamId:i}=e;const r=null===(t=(0,C.k_)(n).state)||void 0===t?void 0:t.userJoinedTeamsStores;if(!r||!o)return!1;const a=[...r.map((e=>{let{id:t}=e;return t})).filter((e=>e!==i)),i];w.Ct({environment:n,currentSpaceViewStore:o,orderedTeamIds:a,userAction:"TeamBrowserOutliner",isExplicitUserAction:!1})}({environment:t,currentSpaceViewStore:c,teamId:n.id}),g.UD9(t,{store:n,joined_role:i,from:o}),I.l({environment:t,userId:s,spaceId:l.id});const d=n.getName();a?(_e({environment:t,teamStore:n,shouldScroll:!1}),d&&new Promise((e=>setTimeout(e,500))).then((()=>{(0,P.$$)({teamName:d,usingAdminPrivileges:r})}))):d&&(0,P.$$)({teamName:d,usingAdminPrivileges:r})}async function le(e){let{environment:t,teamId:n,spaceId:o,teamMemberInfos:i,isSettingDefaultTeam:r,inviterId:a}=e;const s=t.currentUser.id;if(!o||!s)return!1;return"failed"!==(await h.updateTeamMembers(t,{spaceId:o,teamId:n,newMembersOrGuestsToAdd:i,isSettingDefaultTeam:r,addNewMembersToSpace:!1},a)).type}async function ce(e){let{environment:t,teamStore:n,teamMemberInfos:o,isSettingDefaultTeam:i,createNewTeamFlowId:r}=e;const a=n.getSpaceId();if(!a)return!1;const s=t.currentUser.id;if(!a||!s)return!1;if("failed"===(await h.updateTeamMembers(t,{spaceId:a,teamId:n.id,newMembersOrGuestsToAdd:o,isSettingDefaultTeam:i,addNewMembersToSpace:(0,U.Mk)()},s)).type)return!1;if(!i){const e=o.flatMap((e=>"user"!==e.entity_type?[]:e.user_id)),i=e.length,a=o.filter((e=>"group"===e.entity_type)).length;i>0&&g.ixp(t,{store:n,num_members_invited:i,create_new_team_flow_id:r,members_invited:e}),a>0&&g.$1W(t,{store:n,num_groups_invited:a,create_new_team_flow_id:r})}return!0}function de(e){switch(e){case"team_browser":case"duplicate_team":case"create_team_from_page":case"permission_item":case"teams_dropdown_for_team_guest":case"teams_dropdown_for_team_member":case"teams_dropdown_for_group":case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":case"team_breadcrumb_popup":case"team_menu_header":case"sidebar_team_modal":case"team_invite_link":return!1;case"manage_teams_table":return!0;default:(0,m.t1)(e)}}function ue(e){let{environment:t,teamId:n,tab:o,from:i,buttonPopupStore:r}=e;const a=E.default.state.currentSpaceStore;if(!a)return;const s=Z.zX.createChildStore(a,{table:c.e0,id:n});if(s.canRead())B.Z.update((e=>({...e,open:!0,tab:o,teamStore:s,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!1})));else{const e=pe({environment:t,spaceStore:a,teamId:n,from:i});if(!e)return;B.Z.update((t=>({...t,open:!0,tab:o,unjoinedPrivateTeamStore:e,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!0})))}r&&(F.Z.removeNamedPopup("team_more_actions"),r.setState({...r.state,open:!1}))}function pe(e){var t;let{environment:n,spaceStore:o,teamId:r,from:a}=e;if(!de(a))return;const s=o.getModel(),l=null===(t=E.default.state.currentUserStore)||void 0===t?void 0:t.id;if(!(0,i.H)({spaceModel:s,userId:l}))return;const c=N.Z.createTeamStoreFromCache({environment:n,teamId:r,spaceId:o.id,userId:l}),d=null==c?void 0:c.getModel();return null!=c&&c.canRead()&&d&&(0,p.Ei)({userId:l,teamModel:d,spaceModel:s})?c:void 0}async function me(e){let{environment:t,teamStore:n,currentSpaceStore:o,from:i}=e;const r=t.currentUser.id;return!!r&&await fe({environment:t,teamStore:n,currentSpaceStore:o,userId:r,from:i})}async function fe(e){let{environment:t,teamStore:n,currentSpaceStore:o,userId:i,from:r}=e;const a=n.getSpaceId();if(!(n.isDefined()&&null!=o&&o.isDefined()&&t.currentUser.id&&a))return!1;const s=n.getMembers(),l=(0,p.XO)({membership:s}),c=l.some((e=>e===i));if(c&&1===l.length)return M.ZH(),!1;const u=(0,p.x4)({members:s,groups:o.getPermissionGroups()}).filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(i)}));if(!n.getMembers().find((e=>"user"===e.entity_type&&e.user_id===i)))return M.T0(u),!1;const m=Z.t1.createChildStore(n,{table:d.KJ,id:i}),f=i===t.currentUser.id,v=n.getName()??"",b=m.getDisplayName(x.default.getIntl());if(!(await M.A8({isCurrentUser:f,teamName:v,memberName:b})))return!1;const y=[{entity_type:"user",type:c?"owner":"member",user_id:i}],S=await h.updateTeamMembers(t,{spaceId:a,teamId:n.id,existingMembersOrGuestsToRemove:y});return"failed"===S.type?(Ie(S),!1):(g.$aC(t,{store:n,is_leaving_team:f,num_members_removed:y.length,from:r}),u.length>0?f?(0,P.K9)(v,u):(0,P.zs)(b,v,u):f&&(0,P.e6)(v),I.l({environment:t,userId:i,spaceId:a}),!0)}function ge(e){let{environment:t,teamStore:n,group:o}=e;const i=n.getSpaceId();if(!i)return;const r=n.getMembers().find((e=>"group"===e.entity_type&&e.group_id===o.id));r&&M.iT({group:o,onAccept:async()=>{const e=[r],o=await h.updateTeamMembers(t,{spaceId:i,teamId:n.id,existingMembersOrGuestsToRemove:e});"failed"!==o.type?g.miu(t,{store:n,num_groups_removed:e.length}):Ie(o)}})}async function he(e){const{currentSpaceStore:t}=E.default.getState();if(!t)throw new Error("currentSpaceStore does not exist");const{environment:n,teamStore:o,from:i}=e,r=n.currentUser.id,a=o.getName()||"",c=t.getSettingsStore();if(!r)return;const d=j.Z.state.teams.map((e=>({membership:e.getMembers(),id:e.id,archived_by:e.getArchivedBy(),is_default:e.isDefault()}))),u=(0,p.wN)({spaceValue:{permissions:t.getPermissionItems(),permission_groups:t.getPermissionGroups()},teamsInSpace:d,currentUserId:r});if(await M.Fy(a,u)){if(u){const e=await M.wG(a);k.createAndCommit({userAction:"teamsHelpers.archiveLastTeam",environment:n,perform:n=>{if(H({store:o,update:{archived_by:r,archived_at:Date.now()},transaction:n}),y.sW({store:c,data:{is_teams_enabled:!1},transaction:n}),_.oy({planType:"personal",spaceStore:t,transaction:n}),e){const e=o.getTeamPagesStores()??[];for(const o of e){const e=o.getRole();if(!e)continue;const i={type:"user_permission",user_id:r,role:e},a=[...o.getPermissionItems().filter((e=>!s.fG(e)&&!s.Le(e)&&!s.ix(e))),i];y.sW({store:o,data:{parent_id:t.id,parent_table:l.bx,permissions:a},transaction:n})}y.sW({store:o,data:{team_pages:[]},transaction:n})}}}),g.mFL(n,{store:o,from:i})}else k.createAndCommit({userAction:"teamsHelpers.archiveTeam",environment:n,perform:e=>{H({store:o,update:{archived_by:r,archived_at:Date.now()},transaction:e})}});g.Gpy(n,{store:o,from:i}),B.Z.setState({open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}),(0,P.CC)(a)}}function ve(e){let{environment:t,teamStore:n,teamName:o,from:i}=e;k.createAndCommit({userAction:"teamsHelpers.restoreArchivedTeam",environment:t,perform:e=>{H({store:n,update:{archived_by:void 0,archived_at:void 0},transaction:e})}}),g.IWJ(t,{store:n,from:i}),(0,P.JB)(o)}async function be(e){let{settingName:t,newTeamSettingValue:n,spaceSettingValue:o,environment:i,store:r}=e;let a=!0;return"disable"===o&&"allow"===n?a=await M.hC(t):"disable"===n&&(a=await M.Bj(t)),!!a&&(k.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:i,perform:e=>{W({environment:i,store:r,update:{[t]:"disable"===n},transaction:e})}}),!0)}function ye(e){return`TeamToggle_${e.id}`}function Se(e){let{teamStore:t,environment:n}=e;if(n.device.isMobile)return;const o=ye(t),i=A.Z.findDropTargetFromKey(o);if(i){const e=i.getNode();if(!(e instanceof HTMLElement))return;if(T.Z.SidebarScroller){var r;const n=(null===(r=T.Z.SidebarScroller.scrollerEl())||void 0===r?void 0:r.offsetTop)||0;T.Z.SidebarScroller.scrollTo(e.offsetTop-n,0,{animate:!0}),L.Z.setState(t.id),setTimeout((()=>{L.Z.state===t.id&&L.Z.setState(void 0)}),1500)}}}function _e(e){const{environment:t,teamStore:n,shouldScroll:i}=e;i&&Se({teamStore:n,environment:t});const r=n.getTeamPagesStores();!r||r.length<1||(S.navigateToBlock({environment:t,store:r[0],pageVisitSource:o.tY.JoinTeam}),g.SJp(t,{store:n}))}function we(e,t){let{from:n}=t;g.piC(e,{from:n}),D.kx.setState(!D.kx.state)}function ke(e){let{environment:t,from:n,teamStore:o}=e;const{state:i}=R.Z;var r,a;(g.Prc(t,{screen:i.screen,team_id:i.teamId,team_has_icon:Boolean(i.icon),team_has_name:Boolean(i.name),team_has_description:Boolean(i.description),team_access_level:i.accessLevel,flow_id:i.flowId,from:n,store:o}),i.teamId)&&(null===(r=(a=R.Z.state).onClose)||void 0===r||r.call(a,i.teamId));R.Z.reset()}function Ie(e){v.showError(e),r.log({level:"error",from:"teamActions",type:"TeamApiError",error:(0,a.Ui)(e.error),data:{miscDataToConvertToString:{body:e.body,status:e.status}}})}},73292:(e,t,n)=>{n.d(t,{RW:()=>s,k7:()=>a,oO:()=>l});var o=n(15157),i=n(50906),r=n(70704);function a(e){const{environment:t,spaceViewStore:n,teamStore:r,outlinerToggleButtonStore:a,newIsHidden:l,shouldPersistToggleState:c,isExplicitUserAction:d}=e;a.setState({...a.state,isHidden:l}),d&&i.MRb(t,{store:r,is_toggled:!l,outliner_type:e.teamOutlinerType}),c&&o.Z.set({userId:n.environment.currentUser.id,key:s(n,r.id),value:l})}function s(e,t){return`Team_Outliner_Item_${e.id}:${t}`}function l(e){let{oldState:t,teamIds:n,spaceId:i,userId:a}=e;return n.reduce(((e,n)=>{if(n in e)return e;if(n in t)return e[n]=t[n],e;const l=s({id:i},n),c=o.Z.get({userId:a,key:l});return e[n]=new r.Z,e[n].setState({isHidden:c??!1}),e}),{})}},28517:(e,t,n)=>{n.d(t,{I:()=>s,m:()=>l});n(21703);var o=n(72126),i=n(54642),r=n(95697),a=n(69911);async function s(e){let{environment:t,spaceId:n,userId:o}=e;if(!t.currentUser.loggedInUserIds.includes(o))throw new Error("Must be logged in user.");(0,r.bq)()&&(a.Z.getUserJoinedTeamsState({userId:o,spaceId:n})||await l({environment:t,spaceId:n,userId:o}))}async function l(e){var t;let{environment:n,spaceId:r,userId:s,emitValue:l}=e;if(!n.currentUser.loggedInUserIds.includes(s))throw new Error("Must be logged in user.");a.Z.setHasFetched({userId:s,spaceId:r});const c=await i.getTeams(n,{spaceId:r,onlyJoined:!0},s);if("failed"===c.type)return;const d=c.data.teamIds,u=(null===(t=a.Z.getUserJoinedTeamsState({userId:s,spaceId:r}))||void 0===t?void 0:t.joinedTeamsIds)||[];d.length===u.length&&0===o.e5(d,u).length&&0===o.e5(u,d).length||a.Z.setUserJoinedTeamsState({userId:s,spaceId:r,state:{joinedTeamsIds:d,lastEmitValue:l}})}},74016:(e,t,n)=>{n.d(t,{p:()=>m});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(79362),s=n(22808),l=n(31278),c=n(38755),d=n(80444),u=n(35661),p=n(85893);function m(e){window.__c={n:"TeamSpaceIcon"};const{store:t,size:n=16,style:m,disabled:f=!1,onChange:g=(()=>{})}=e,h=(0,o.O7)(),{name:v,icon:b}=(0,i.VK)((()=>{const n=d.default.state.currentSpaceStore;return t?t instanceof u.zX?{name:t.getName(),icon:e.icon??t.getIcon()}:{name:(0,c.rn)(h,t),icon:e.icon??(0,c.Wd)(h,t)}:{name:n&&`team-icon-${n.id}`,icon:e.icon}}),[t,h,e.icon]),y=(0,r.yK)((e=>({backgroundContainer:{background:b&&(0,a.V2)(b.icon)?(0,a.Pk)(b.icon,e.mode):e.regularDividerColor,width:n,height:n}})),[b,n]),S=b&&b.icon&&((0,a.V2)(b.icon)||(0,s.Z)(b.icon)),_=e.iconLoggingData||t&&{recordTable:t.table,source:"team_settings"};return(0,p.jsx)(l.Z,{title:v,icon:b,size:S?.9*n:n,emojiSize:S?.78*n:n,isEmptyPage:!1,style:S?{...m,...y.backgroundContainer}:m,isLarge:!0,largeIcon:!0,iconLoggingData:_,...f?{disabled:!0}:{disabled:!1,onChange:g,bucket:"public"}})}},30297:(e,t,n)=>{n.d(t,{o:()=>l,r:()=>c});var o=n(480),i=n(86628),r=n(5220),a=n(80444),s=n(9867);function l(e){let{entrypoint:t,userId:n,spaceStore:o}=e;return(0,r.H)({spaceModel:null==o?void 0:o.getModel(),userId:n})&&s.w6(t)}function c(e){const t=(0,o.O7)().currentUser.id;return(0,i.VK)((()=>{const{currentSpaceStore:n}=a.default.state;return l({entrypoint:e,spaceStore:n,userId:t})}),[t,e])}},60396:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(26263),i=n(49085),r=n(29369),a=n(97880),s=n(20431);class l extends i.default{getInitialState(){return{initialized:!1}}createTeamStoreFromCache(e){let{environment:t,teamId:n,spaceId:o,userId:i}=e;if(this.state.initialized&&o&&i&&this.state.spaceId===o&&this.state.userId===i)return new s.z(t,{table:r.e0,id:n},{inMemoryRecordCache:this.state.inMemoryCache})}initialize(e){let{environment:t,userId:n,spaceId:i,teamIds:s,getRecordWithRole:l}=e;const c=new o.Z({name:"GlobalEnterpriseAdminTeamsStore"});for(const o of s){const e={table:r.e0,id:o};c.setRecord({pointer:e,userId:n},l(e))}return this.setState({initialized:!0,spaceId:i,userId:n,inMemoryCache:c}),s.map((e=>this.createTeamStoreFromCache({environment:t,teamId:e,spaceId:i,userId:n}))).filter(a.$K)}}const c=new l},36225:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},75769:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{hasShownTooltip:!1}}hasShownTootlip(e){return this.state.hasShownTooltip&&this.state.teamId===e}}const r=new i},69911:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{joinedTeamsStates:{},hasFetched:new Set}}getKey(e){let{userId:t,spaceId:n}=e;return`${t}:${n}`}getUserJoinedTeamsState(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});return this.state.joinedTeamsStates[o]}setUserJoinedTeamsState(e){let{userId:t,spaceId:n,state:o}=e;const i=this.getKey({userId:t,spaceId:n});this.state.joinedTeamsStates[i]=o,this.emit()}getHasFetched(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});return this.state.hasFetched.has(o)}setHasFetched(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});this.state.hasFetched.add(o)}}const r=new i},29949:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{status:"closed"}}open(e){const{analyticsFrom:t,cloneTo:n,selectedTemplate:o,selectedTeam:i}=e;this.setState({...this.state,status:"opening",analyticsFrom:t,cloneTo:n,selectedTemplate:o,selectedTeam:i})}}const r=new i},60027:(e,t,n)=>{n.d(t,{T:()=>g,n:()=>h});n(67294);var o=n(68626),i=n(5366),r=n(50906),a=n(54642),s=n(47307),l=n(80444),c=n(78291),d=n(22616),u=n(34583),p=n(33493),m=n(22500),f=n(85893);async function g(e){const{environment:t,stripe:n,elements:a}=e;if(!c.default.state.data)return void o.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Unable to get subscription data."}});if(!a||!n)return void o.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}});const{error:g}=await a.submit();if(g)return void r.iL9(t,{error:"could not submit form",error_type:"payment_method"});const h=await n.createPaymentMethod({elements:a});if(h.error)return void r.iL9(t,{error:h.error.message,error_type:"payment_method"});if(!h.paymentMethod)return void r.iL9(t,{error:"could not create token",error_type:"payment_method"});const v={type:"paymentMethodId",value:h.paymentMethod.id};return await async function(e){var t;const{environment:n,paymentData:o,stripe:a,subscriptionTier:c}=e,m=l.default.state.currentSpaceStore;m&&await d.Z({environment:n,spaceId:m.id});const{status:g,prices:h,selectedCurrencyCode:v}=p.Z.state;if(!m||"ready"!==g)return;const b="month",y=null===(t=h.find((e=>e.product===c&&e.billingInterval===b&&e.currencyCode===v)))||void 0===t?void 0:t.externalId;try{const e=await u.Mg({environment:n,spaceStore:m,plan:y,paymentData:o,from:"onboarding",isTrial:!0}),t=e.paymentIntentClientSecret,r=e.paymentIntentStatus;if(t&&"requires_action"===r){const{error:e}=await a.handleNextAction({clientSecret:t});e&&(await u.EO({environment:n,spaceStore:m,planType:m.getPlanType()??"personal",from:"subscription_upgrade_onboarding_failed_payment"}),s.showErrorMessage((0,f.jsx)(i.FormattedMessage,{id:"subscription.upgrade.payment_failed",defaultMessage:"Your payment could not be processed. Please provide an alternate payment method or you will lose access to Notion."})))}return"success"}catch{return void r.BgI(n)}}({environment:t,paymentData:v,stripe:n,subscriptionTier:(0,m.Hy)()})}async function h(e){const t=await a.getExternalOrgData(e,{});if("failed"===t.type)return!1;const n=t.data;return"company_employee_count"in n&&parseInt(n.company_employee_count)>99}},22500:(e,t,n)=>{n.d(t,{Hy:()=>c,XG:()=>l,zQ:()=>s});var o=n(47425),i=n(53809),r=n(30548);const a=new i.D({key:"trialUpsell",namespace:r.$p,important:!1,trackingType:"preference"});function s(e){a.setState(e)}function l(){a.setState(void 0)}function c(){const e=a.getState();return e&&(0,o.mq)(e)&&(0,o.NG)(e)?"business":"plus"}},42198:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var o=n(49085),i=n(72126),r=n(63143),a=n(77080),s=(n(57658),n(97880)),l=n(54642),c=n(98730);async function d(e){const{spaceId:t,userId:n,environment:o}=e,i=await l.getUserSignals(o,{spaceId:t,signals:[{name:"similarUserRecentPages",includeRecords:!0},{name:"topPages7dPageView",includeRecords:!0}]});if("success"===i.type){const e={};i.data.signals.forEach((t=>{if("error"===t.status)return;const n=t.name;"similarUserRecentPages"===n?e[n]=function(e){const t=new Map,n=new Map;return e.forEach((e=>{let{userId:t,similarity:o}=e;n.set(t,o)})),e.forEach((e=>{const{userId:o,similarity:i}=e;e.recentPages.forEach((r=>{let{visitedAt:a,pageId:s}=r;const l=t.get(s);if(l){l.userIds.push(o),l.mostRecentlyVisitedAt<a&&(l.mostRecentlyVisitedUser=e.userId,l.mostRecentlyVisitedAt=a);const t=n.get(l.mostSimilarUser);t&&t<i&&(l.mostSimilarUser=o)}else t.set(s,{userIds:[o],mostRecentlyVisitedUser:o,mostRecentlyVisitedAt:a,mostSimilarUser:o})}))})),{pagesMetadata:t,userSimilarityScores:n}}(t.data):"topPages7dPageView"===n?e[n]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.pageAuthorityV1)})),t}(t.data):"editedPages1d"===n||"similarUsersEditedPages1d"===n?e[n]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.editedAt)})),t}(t.data):(0,s.t1)(n)})),m.update((o=>({...o,userSignals:o.userSignals.set(m.getKey(t,n),e)}))),c.S(o)}}const u=5*r.hM;class p extends o.default{constructor(){super(...arguments),this.refreshTimer=void 0,this.getKeyMemoized=(0,i.HP)(this.getKey)}getInitialState(){return{userSignals:new Map}}getKey(e,t){return`${e}:${t}`}getUserSignals(e){let{spaceId:t,userId:n}=e;if(!t||!n)return;const o=this.getKeyMemoized(t,n),i=this.state.userSignals.get(o);return i||void 0}initializeAndLoadAllUserSignals(e){this.refreshTimer&&window.clearTimeout(this.refreshTimer);a.default.getEligibleGroup({experimentId:"search-new-local-recall-v1"})&&(d(e),this.refreshTimer=window.setTimeout((()=>{d(e)}),u))}isSimilarUsersRecentPages(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t?void 0:t.has(i)}getNumSimilarUsersVisitedPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(i))||void 0===t||null===(t=t.userIds)||void 0===t?void 0:t.length}getSimilarUsersMostRecentVisitTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(i))||void 0===t?void 0:t.mostRecentlyVisitedAt}getHighestViewerSimilarityScoreForPage(e){var t,n;const{userId:o,spaceId:i,pageId:r}=e,a=this.getUserSignals({userId:o,spaceId:i}),s=null==a||null===(t=a.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(r))||void 0===t?void 0:t.mostSimilarUser;if(s)return null==a||null===(n=a.similarUserRecentPages)||void 0===n||null===(n=n.userSimilarityScores)||void 0===n?void 0:n.get(s)}isTopPages7dPageView(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.has(i)}getPageAuthorityV1ForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.get(i)}isRecentlyEdited(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.has(i)}getUserLastEditedTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.get(i)}isSimilarUsersRecentlyEdited(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.has(i)}getSimilarUserLastEditedTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.get(i)}}const m=new p},28084:(e,t,n)=>{n.d(t,{Z:()=>r});n(21703),n(57658);var o=n(7406),i=n(29477);const r=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.requestDelayMs=void 0,this.requestTimeoutMs=void 0,this.queue=[],this.currentWorkers=0,this.currentSetTimeouts=0,this.dequeue=async()=>{if(this.currentSetTimeouts=0,this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;this.currentWorkers++;const e=this.queue.splice(0,this.batchSize),t=e.map((e=>e.request));let n,r;try{if(this.requestTimeoutMs){const e=await i.OI(this.requestTimeoutMs,[this.performRequests(t)]);if(e.timeout)throw new Error("Timed out.");n=e.result}else n=await this.performRequests(t)}catch(a){r=(0,o.tg)(a)}try{if(r)for(let t=0;t<e.length;t++){e[t].deferred.reject(r)}else if(n)for(let t=0;t<e.length;t++){const o=e[t],i=n[t];o.deferred.resolve(i)}}catch(s){}this.currentWorkers--,this.queue.length>=this.batchSize?this.dequeue():this.dequeueAfterTimeout()};const{performRequests:t,batchSize:n,maxWorkers:r,requestDelayMs:a,requestTimeoutMs:s}=e;this.performRequests=t,this.batchSize=n,this.maxWorkers=r,this.requestDelayMs=a||0,this.requestTimeoutMs=s}getQueueSize(){return this.queue.length}updateBatchSize(e){this.batchSize=e}updateRequestDelayMs(e){this.requestDelayMs=e}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterTimeout()}enqueue(e){const t=i.UZ();return this.queue.push({request:e,deferred:t}),this.dequeueAfterTimeout(),t.promise}dequeueAfterTimeout(){this.currentSetTimeouts<this.maxWorkers&&(this.currentSetTimeouts++,setTimeout(this.dequeue,this.requestDelayMs))}}},54064:(e,t,n)=>{n.d(t,{Z:()=>o});const o=class{constructor(){this.listeners={}}addListener(e,t){let n=this.listeners[e];n||(n=new Set,this.listeners[e]=n),n.add(t)}addOnceListener(e,t){var n=this;const o=function(){n.removeListener(e,o),t(...arguments)};this.addListener(e,o)}removeListener(e,t){const n=this.listeners[e];n&&(n.delete(t),0===n.size&&delete this.listeners[e])}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const i=this.listeners[e];i&&i.forEach((e=>e(...n)))}listenerCount(e){const t=this.listeners[e];return t?t.size:0}}},55652:(e,t,n)=>{n.d(t,{s:()=>i});n(57658);var o=n(97880);class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};this.buckets={},this.count=0,this.total=0,this.unique=0,this.startedAt=new Map,this.logger=e}async measureErrors(e,t,n,o){const i=`${e} ${++this.unique}`;this.start(i);try{const e=await o();return this.end(i,t),e}catch(r){throw this.end(i,n,r),r}}get average(){return Math.floor(this.total/this.count)}get summary(){const e=[];e.push(`avg ${this.average}ms for ${this.count} calls`);for(const[t,n]of(0,o.qP)(this.buckets)){if(!n)continue;const o=Math.floor(n.total/n.count),i=(n.count/this.count*100).toFixed(2);e.push(`[${t}: ${i}% avg ${o}ms]`)}return e.join(" ")}start(e){this.startedAt.set(e,"object"==typeof performance?performance.now():Date.now())}end(e,t){const n=this.startedAt.get(e);if(!n)return;this.startedAt.delete(e);const o=("object"==typeof performance?performance.now():Date.now())-n;this.count++,this.total=this.total+o;let i=this.buckets[t];i||(i={count:0,total:0},this.buckets[t]=i),i.count++,i.total=i.total+o;for(var r=arguments.length,a=new Array(r>2?r-2:0),s=2;s<r;s++)a[s-2]=arguments[s];this.logger(`end ${e} ${t}: ${o}ms`,...a)}}},15157:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(30548);const i=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"necessary")}get(e){let{userId:t,key:n}=e;return this.localStorageStore.get(this.makeUserKey(t,n))}set(e){let{userId:t,key:n,value:o}=e;return this.localStorageStore.set(this.makeUserKey(t,n),o)}remove(e){let{userId:t,key:n}=e;return this.localStorageStore.remove(this.makeUserKey(t,n))}clearStorageForUser(e){this.localStorageStore.scan((t=>{t.startsWith(e)&&this.remove({userId:e,key:t})}))}scan(e){this.localStorageStore.scan(e)}makeUserKey(e,t){return`${e||"guest"}:${t}`}}(o.TA,!1)},75189:(e,t,n)=>{n.d(t,{uP:()=>P,yx:()=>M});var o=n(74487);const i=o.union([o.number(),o.string(),o.boolean(),o.isNull(),o.array(o.string())]),r=o.undefinable(i),a=o.union([i,o.record(o.string(),i)]),s=o.union([r,o.record(o.string(),r)]),l=o.union([s,o.record(o.string(),s)]),c=l,d=o.without(o.without(o.nonEmpty(o.string()),"{"),"}");o.object({required:{key:d,value:a,ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,value:s,version:o.number()},optional:{}}),o.object({required:{key:d,value:o.number(),ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,value:o.number(),version:o.number()},optional:{}}),o.object({required:{key:d,amount:o.number(),ttl:o.undefinable(o.number())},optional:{passThroughData:c}}),o.object({required:{key:d,value:o.number(),version:o.number()},optional:{}}),o.object({required:{key:d,field:o.string(),value:s,ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,field:o.string(),value:l,version:o.number()},optional:{}}),o.object({required:{id:o.string()},optional:{}}),o.object({required:{setValueTime:o.number()},optional:{}}),o.object({required:{key:d,field:o.string(),updates:o.record(o.string(),r),ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,field:o.string(),value:l,version:o.number()},optional:{}});const u=o.object({required:{blockId:o.string(),userId:o.string(),spaceId:o.string(),operation:o.literal("logPageExit"),pageVisitId:o.undefinable(o.string()),ts:o.number()},optional:{}}),p=(o.object({required:{},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{key:d,value:s,version:o.number()},optional:{}}),o.object({required:{operation:o.literal("setValue"),key:d,value:o.string(),ttl:o.undefinable(o.number())},optional:{}})),m=o.object({required:{operation:o.literal("setValue"),key:d,value:s,version:o.number()},optional:{}}),f=o.object({required:{operation:o.literal("increment"),key:d,amount:o.number(),ttl:o.undefinable(o.number())},optional:{passThroughData:c}}),g=o.object({required:{operation:o.literal("increment"),key:d,value:o.number(),version:o.number()},optional:{}}),h=o.object({required:{operation:o.literal("setIfGreater"),key:d,value:o.number(),ttl:o.undefinable(o.number())},optional:{}}),v=o.object({required:{operation:o.literal("setIfGreater"),key:d,value:o.number(),version:o.number()},optional:{}}),b=o.object({required:{operation:o.literal("setField"),key:d,field:o.string(),value:s,ttl:o.undefinable(o.number())},optional:{}}),y=o.object({required:{operation:o.literal("setField"),key:d,field:o.string(),value:l,version:o.number()},optional:{}}),S=o.object({required:{operation:o.literal("updateField"),key:d,field:o.string(),updates:o.record(o.string(),r),ttl:o.undefinable(o.number())},optional:{}}),_=o.object({required:{operation:o.literal("updateField"),key:d,field:o.string(),value:l,version:o.number()},optional:{}}),w=o.object({required:{operation:o.literal("logPageExit"),spaceId:o.string(),userId:o.string(),blockId:o.string(),pageVisitId:o.undefinable(o.string())},optional:{}}),k=o.object({required:{operation:o.literal("logPageExit")},optional:{}}),I={setValue:p,increment:f,setIfGreater:h,setField:b,updateField:S,logPageExit:w},C=o.union(Object.values(I)),x={setValue:m,increment:g,setIfGreater:v,setField:y,updateField:_,logPageExit:k},T=o.union(Object.values(x)),M=(o.object({required:{operations:o.array(C)},optional:{}}),o.object({required:{responses:o.array(T)},optional:{}}),o.object({required:{subscriptions:o.array(o.object({required:{key:d,version:o.number()},optional:{}}))},optional:{}}),o.object({required:{responses:o.array(o.object({required:{key:d,wasNotified:o.boolean()},optional:{}})),internalProcessingTimeMs:o.number()},optional:{}}),o.object({required:{key:d,version:o.number()},optional:{}}),o.object({required:{key:d,wasNotified:o.boolean()},optional:{}}),o.object({required:{keys:o.array(d)},optional:{}}),o.object({required:{keys:o.array(d),internalProcessingTimeMs:o.number()},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{disconnectId:o.string(),operations:o.array(C)},optional:{}}),o.object({required:{disconnectId:o.string(),hadDisconnect:o.boolean()},optional:{}}),o.object({required:{disconnectId:o.string()},optional:{}}),o.object({required:{disconnectId:o.string(),wasRemoved:o.boolean()},optional:{}}),o.union([o.object({required:{type:o.literal("notification"),key:d,value:l,version:o.number()},optional:{passThroughData:c}}),o.object({required:{type:o.literal("response"),status:o.literals("ok","error"),requestId:o.string(),result:o.any()},optional:{}})])),P=o.object({required:{userId:o.string(),present:o.boolean()},optional:{activityTimestamp:o.number(),blockId:o.union([o.isNull(),o.string()])}});o.object({required:{max_records:o.number()},optional:{}}),o.object({required:{values:o.array(u)},optional:{}}),o.object({required:{last_length:o.number(),new_length:o.number(),added:o.boolean()},optional:{}})},27731:(e,t,n)=>{n.d(t,{Z:()=>i});class o{constructor(){this.stiffness=50,this.damping=10,this.precision=.001,this.currentValue=0,this.endValue=0,this.velocity=0}isAtRest(){return Math.abs(this.endValue-this.currentValue)<=this.precision}setEndValue(e){this.endValue=e;const t=this.isAtRest();return t&&this.setAtRest(),t}jumpToEnd(){this.currentValue=this.endValue}step(e){let t=e;do{let e;t>o.timestep?(t-=o.timestep,e=o.timestep):(e=t,t=0);const[n,i]=this.rk4(this.currentValue,this.velocity,e);this.velocity=i,this.currentValue=n}while(t>0);const n=this.isAtRest();return n&&this.setAtRest(),n}setAtRest(){this.currentValue=this.endValue,this.velocity=0}rk4(e,t,n){var o=e,i=t,r=this.computeAccel(o,i,0),a=e+.5*i*n,s=t+.5*r*n,l=this.computeAccel(a,s,n/2),c=e+.5*s*n,d=t+.5*l*n,u=this.computeAccel(c,d,n/2),p=e+d*n,m=t+u*n;return[e+n/6*(i+2*s+2*d+m),t+n/6*(r+2*l+2*u+this.computeAccel(p,m,n))]}computeAccel(e,t,n){return this.stiffness*o.stiffnessMultiplier*(this.endValue-e)-this.damping*o.dampingMultiplier*t}}o.stiffnessMultiplier=1e-5,o.dampingMultiplier=.005,o.timestep=1e3/60;const i=o},95371:(e,t,n)=>{n.d(t,{CY:()=>m,DG:()=>i,DY:()=>c,MW:()=>s,Sr:()=>d,Xf:()=>u,YL:()=>p,Yc:()=>l,Yz:()=>a,lj:()=>f,mp:()=>r,qF:()=>v,si:()=>g,ub:()=>h});n(57658);var o=n(97880);class i{constructor(e){this.children=e}map(e){const t=this.children.map((t=>t.map(e)));return new i(t)}toString(){return`DetachedTreeRoots([${this.children}])`}}class r{constructor(e,t){this.value=e,this.children=t}map(e){return s(this,(t=>({value:e(t.value),children:t.children})))}toString(){return`Tree(${this.value}, [${this.children}])`}}function a(e,t){return t(e.value)||e.children.some((e=>a(e,t)))}function s(e,t){const n=t(e);if(!n)return;const{value:i,children:a}=n,l=a?a.map((e=>s(e,t))).filter(o.$K):[];return new r(i,l)}function l(e){const{values:t,isAncestor:n,compareOrder:o}=e;if(0===t.length)return;const a=(e,t)=>{for(const o of e)if(n(o.value,t))return void a(o.children,t);e.push(new r(t,[]))},s=t.slice().sort(o),l=[];for(const i of s)a(l,i);return new i(l)}function c(e,t){for(const n of e){if(t(n))return[n];{const e=c(n.children,t);if(e)return[n,...e]}}}function d(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,i=o.children.findIndex((e=>e===n));if(i>0)return{prev:o.children[i-1]};if(o!==e)return{parent:o}}return{}}function u(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,i=o.children.findIndex((e=>e===n));return i<o.children.length-1?{next:o.children[i+1]}:u(e,t.slice(0,t.length-1))}return{}}function p(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,i=o.children.findIndex((e=>e===n));if(i>0){return{prev:m(o.children[i-1])}}if(o!==e)return{parent:o}}return{}}function m(e){for(;e.children.length>0;)e=e.children[e.children.length-1];return e}function f(e,t){if(t&&t.length>0){const n=t[t.length-1];if(n.children.length>0){return{next:n.children[0]}}const{next:o}=u(e,t);return{next:o}}return{}}function g(e){if(e&&e.length>0){const t=e[e.length-1];if(t.children.length>0)return t.children[0]}}function h(e){if(e&&e.length>1)return e[e.length-2]}function v(e,t){if(0===e.length||0===t.length)return-1;for(let n=Math.min(e.length,t.length)-1;n>-1;n--){if(e[n]===t[n])return n}return-1}},39721:(e,t,n)=>{n.d(t,{F:()=>a,o:()=>s});n(21703),n(57658);var o=n(95371),i=n(73597),r=n(97880);const a={applyMutable:function(e,t){const n=(0,o.DY)(e.children,(e=>e===t.target));if(void 0===n)return!1;if(0===n.length)throw new Error("findPathInTree: empty path");const i=1===n.length?e.children:n[n.length-2].children,a=i.indexOf(t.target);if(-1===a)throw new Error("findPathInTree: cannot find node");switch(t.operation){case"indentSelf":return function(e,t){if(0===t)return!1;const n=e[t],o=e[t-1];return e.splice(t,1),o.children.push(n,...n.children),n.children=[],!0}(i,a);case"indentSelfAndSubtree":return function(e,t){if(0===t)return!1;const n=e[t],o=e[t-1];return e.splice(t,1),o.children.push(n),!0}(i,a);case"unindentSelf":{if(1===n.length)return!1;const t=2===n.length?e.children:n[n.length-3].children,o=n[n.length-2],i=t.indexOf(o);if(-1===i)throw new Error("findPathInTree: cannot find node");return function(e,t,n){const o=e[t],i=o.children[n];return o.children.splice(n,1),e.splice(t+1,0,i),!0}(t,i,a)}case"unindentSelfAndUpdateSiblings":{if(1===n.length)return!1;const t=2===n.length?e.children:n[n.length-3].children,o=n[n.length-2],i=t.indexOf(o);if(-1===i)throw new Error("findPathInTree: cannot find node");return function(e,t,n){const o=e[t],i=o.children[n],r=o.children.splice(n+1,o.children.length-n-1);return i.children.push(...r),o.children.splice(n,1),e.splice(t+1,0,i),!0}(t,i,a)}default:(0,r.t1)(t.operation)}}};const s={getIndentOperationsFromTreeRange:(e,t)=>"indent"===t?function(e){const t=[];for(const n of(0,i.bu)(e))t.push({operation:"indentSelf",target:n});return t}(e):"indentSelfAndSubtree"===t?function(e){const t=[];for(const n of(0,i.bu)(e))t.push({operation:"indentSelfAndSubtree",target:n});return t}(e):"unindent"===t?function(e){const t=[];for(const n of(0,i.bu)(e))t.push({operation:"unindentSelfAndUpdateSiblings",target:n});return t.reverse()}(e):"unindentSelf"===t?function(e){const t=[];for(const n of(0,i.bu)(e))t.push({operation:"unindentSelf",target:n});return t.reverse()}(e):void(0,r.t1)(t)}},73597:(e,t,n)=>{n.d(t,{JK:()=>i,bu:()=>a,tL:()=>r});n(21703);var o=n(97880);function*i(e){yield e;for(const t of e.children)yield*i(t)}function*r(e){for(let t=e.startPath.length-1;t>=0;t--){const n=e.getStartBoundary(t);if(!n)throw new Error("Start boundary must be defined");t===e.startPath.length-1?yield n.parent:yield*n.childrenInsideRange}}function*a(e){for(const{position:t,tree:n}of function*(e){for(let t=e.startPath.length-1;t>=0;t--){const n=e.getStartBoundary(t);if(n&&(t===e.startPath.length-1&&(yield{position:"start",tree:n.parent}),t>0))for(const e of n.childrenInsideRange)yield{position:"within",tree:e}}for(let t=0;t<e.endPath.length;t++){const n=e.getEndBoundary(t);if(n)for(const t of n.childrenInsideRange)e.isInEndPath(t)?yield{position:"endPath",tree:t}:yield{position:"within",tree:t}}}(e))switch(t){case"start":case"endPath":yield n;break;case"within":yield*i(n);break;default:(0,o.t1)(t)}}},374:(e,t,n)=>{n.d(t,{Z:()=>i,f:()=>r});var o=n(97880);function i(e){return[{operation:"delete",deleteFromParent:e.moveFromParent,deletingChildren:e.movingChildren,debug:e.debug},{operation:"insert",insertIntoParent:e.moveToParent,insertChildren:e.movingChildren,adjacentSibling:e.moveToAdjacentSibling,direction:e.moveToDirection,debug:e.debug}]}const r={applyMutable:function(e){switch(e.operation){case"delete":return a(e);case"insert":return s(e);case"move":const[t,n]=i(e),r=a(t),l=s(n);return r||l;default:(0,o.t1)(e)}}};function a(e){const{deleteFromParent:t,deletingChildren:n}=e;if(0===n.length)return!1;const o=new Set(n),i=t.children.filter((e=>!o.has(e)));return i.length!==t.children.length&&(t.children=i,!0)}function s(e){const{direction:t,insertChildren:n,insertIntoParent:i,adjacentSibling:r}=e;if(0===n.length)return!1;const a=r?i.children.indexOf(r):-1,s=(()=>{switch(t){case"listBefore":return Math.max(0,a);case"listAfter":return-1===a?i.children.length:a+1;default:(0,o.t1)(t)}})();return i.children.splice(s,0,...n),!0}},70842:(e,t,n)=>{n.d(t,{T:()=>i});n(21703),n(57658);var o=n(95371);class i{constructor(e,t,n){if(this.maxDepth=void 0,this.start=void 0,this.end=void 0,this.startPathSet=void 0,this.endPathSet=void 0,this.isInStartPath=e=>this.startPathSet.has(e),this.isInEndPath=e=>this.endPathSet.has(e),this.commonAncestor=e,this.startPath=t,this.endPath=n,0===this.startPath.length||0===this.endPath.length)throw new Error(`Cannot create TreeRange with empty path: ${this.startPath} ${this.endPath}`);this.start=this.startPath[this.startPath.length-1],this.end=this.endPath[this.endPath.length-1],this.startPathSet=new Set(t),this.endPathSet=new Set(n),this.maxDepth=Math.max(this.startPath.length,this.endPath.length)}static fromNearestCommonAncestor(e,t){const n=(0,o.qF)(e,t);if(!(n<0))return new this(e[n],e.slice(n),t.slice(n))}getStartBoundary(e){if(e>=this.startPath.length||e<0)return;const t=this.startPath[e];if(0===e&&this.startPath.length<=1&&this.endPath.length<=1)return{parentType:"commonAncestor",parent:t,childrenBeforeRange:[],childrenInsideRange:[],childrenAfterRange:t.children.slice()};const n=t.children.findIndex(this.isInStartPath)+1,o=t.children.findIndex(this.isInEndPath),i=t.children.slice(0,n),r=t.children.slice(n,-1===o?void 0:o+1),a=-1===o?[]:t.children.slice(o+1);return 0===e?{parentType:"commonAncestor",parent:t,childrenBeforeRange:i,childrenInsideRange:r,childrenAfterRange:a}:{parentType:"startPath",parent:t,childrenBeforeRange:i,childrenInsideRange:r}}getEndBoundary(e){if(e>=this.endPath.length||e<0)return;if(0===e)return this.getStartBoundary(0);const t=this.endPath[e],n=t.children.findIndex(this.isInStartPath)+1,o=t.children.findIndex(this.isInEndPath)+1,i=t.children.slice(n,o),r=t.children.slice(o);return{parentType:"endPath",parent:t,childrenInsideRange:i,childrenAfterRange:r}}getAnalagousNodesAtOffset(e){const t=this.startPath.length-1-e,n=this.endPath.length-1-e;return{start:this.getStartBoundary(t),end:this.getEndBoundary(n)}}*iterateAnalogousNodes(){for(let e=0;e<this.maxDepth;e++)yield this.getAnalagousNodesAtOffset(e)}getDeletionAtOffset(e){const{start:t,end:n}=this.getAnalagousNodesAtOffset(e),o=[];t&&t.childrenInsideRange.length>0&&o.push({operation:"delete",deleteFromParent:t.parent,deletingChildren:t.childrenInsideRange});const i=(null==t?void 0:t.parent)||this.commonAncestor;if(i&&n&&n.parent!==this.commonAncestor&&n.parent!==i&&n.childrenAfterRange.length>0){const e=i.children.find(this.isInStartPath);o.push({operation:"move",moveFromParent:n.parent,movingChildren:n.childrenAfterRange,moveToParent:i,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"})}return o}*iterateDeletion(){for(let e=0;e<this.maxDepth;e++)yield*this.getDeletionAtOffset(e)}getInsertionAtOffset(e,t,n){const o=Math.max(0,e.length-1-t),i=e[o],r=e[o+1],{start:a,end:s}=this.getAnalagousNodesAtOffset(t),l=[];if(a&&a.childrenInsideRange.length>0){const e=n.get(i)||r;l.push({operation:"move",moveFromParent:a.parent,movingChildren:a.childrenInsideRange,moveToParent:i,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"});const t=a.childrenInsideRange[a.childrenInsideRange.length-1];n.set(i,t)}const c=this.startPath.length-1-t,d=Math.min(c,this.endPath.length-1),u=this.getEndBoundary(d);if(u&&u.parent!==this.commonAncestor&&i!==e[0]){const e=i.children.indexOf(r)+1,t=i.children.slice(e);if(t.length){const e=0===u.childrenInsideRange.length&&u.childrenAfterRange.length>0,n=e?u.childrenAfterRange[0]:u.childrenInsideRange[u.childrenInsideRange.length-1];l.push({operation:"move",moveFromParent:i,movingChildren:t,moveToParent:u.parent,moveToAdjacentSibling:n,moveToDirection:e?"listBefore":"listAfter"})}}return s&&s.parent!==this.commonAncestor&&s.childrenAfterRange.length>0&&l.push({operation:"delete",deleteFromParent:s.parent,deletingChildren:s.childrenAfterRange}),l}*iterateInsertionAt(e){const t=new Map,n=[];for(let o=0;o<this.maxDepth;o++)n.push(...this.getInsertionAtOffset(e,o,t));yield*n}}},66504:(e,t,n)=>{n.d(t,{I:()=>a,o:()=>s});var o=n(45953),i=n(97880);let r;const a="guest";r=Symbol.iterator;class s{constructor(e){this.data=void 0,this.data=e??{}}getUserRecordMap(e){const t=e??a;let n=this.data[t];return n||(n=o.PF.create(),this.data[t]=n),n}getValue(e){return this.getUserRecordMap(e.userId).getValue(e.pointer)}getRole(e){return this.getUserRecordMap(e.userId).getRole(e.pointer)}setValueAndRole(e,t,n){return this.getUserRecordMap(e.userId).setValueAndRole(e.pointer,t,n),this}setModelAndRole(e,t,n){return this.getUserRecordMap(e.userId).setModelAndRole(e.pointer,t,n),this}delete(e){this.getUserRecordMap(e.userId).delete(e.pointer)}*[r](){for(const[e,t]of(0,i.qP)(this.data))for(const{pointer:n,model:o,role:i}of t)void 0!==o&&(yield{pointer:n,model:o,role:i,userId:e===a?void 0:e})}}},40902:(e,t,n)=>{n.d(t,{B9:()=>A,BX:()=>C,Dn:()=>x,Fb:()=>L,KN:()=>V,OC:()=>w,OS:()=>T,Yr:()=>M,Z3:()=>B,fc:()=>E,gg:()=>D,hY:()=>Z,j4:()=>R,lv:()=>F,md:()=>j,n_:()=>U,tR:()=>_});n(57658);var o=n(41432),i=n(99036),r=(n(80951),n(72126)),a=n(59753),s=n(27006),l=n(4615),c=n(70921),d=n(21202),u=n(6287),p=(n(13493),n(33709)),m=n(65311),f=n(15047),g=n(29369),h=n(19889),v=n(99108),b=n(70203),y=n(97880),S=n(63143);S.hM;function _(e,t){const n=a.kk.fromValue(c.TY,t),{edits:o,index:i}=e,s=[...n&&n.getEdits()||[],...o],m=v.VR(s),h=m[0],b=h&&h.timestamp.toString()||n&&n.start_time||o[0].timestamp,y=r.Z$(m),S=y&&y.timestamp.toString()||n&&n.end_time||b,_=k(o[0]),w=function(e){const{space_id:t,navigable_block_id:n,collection_id:o,collection_row_id:i,top_level_block_id:r,discussion_id:a,team_id:s}=e;return n?{parent_table:d.iU,parent_id:n}:r?{parent_table:d.iU,parent_id:r}:i?{parent_table:d.iU,parent_id:i}:a?{parent_table:p.qF,parent_id:a}:o?{parent_table:u.v,parent_id:o}:s?{parent_table:g.e0,parent_id:s}:{parent_table:f.bx,parent_id:t}}(o[0]);return{type:c.L8[o[0].type],index:i,start_time:b.toString(),end_time:S.toString(),edits:m.slice(0,1e3),invalid:I(m),shard_id:(0,l.bm)(_.space_id),context_id:c.rH(_),..._,...w}}function w(e){if("collection-changed"===e.type&&e.collection_data){if(!e.collection_data.before&&!e.collection_data.after)return!1;if(!e.collection_data.before||!e.collection_data.after)return!0;return x(e.collection_data.before.description,e.collection_data.after.description)}if("collection-created"===e.type&&e.collection_data){const t=e.collection_data.description;return Boolean(t)}return!1}function k(e){return S.ei(e,c.uJ)}function I(e){if(0===v.hI(e).length)return!0;{const t=e[0];if("mention-deleted"===t.type)return!0;if("mention-created"===t.type){if(t.authors&&t.authors.some((e=>e.table===h.KJ&&e.id===t.mentioned_user_id)))return!0}else if(e.every((e=>"comment-deleted"===e.type)))return!0}return!1}function C(e,t){return function(e){const t=a.kk.fromValue(c.TY,e),n=t&&t.getEdits()||[];return S.cf(r.xH(n.map((e=>e.authors||[]))))}(a.kk.fromValue(c.TY,e)).some((e=>e.table===h.KJ&&e.id===t))}function x(e,t){const n=b.OAI(e||[]),o=b.OAI(t||[]);return!r.Xy(n,o)}function T(e){const{before:t,after:n,schema:o}=e,r=[];return(o?Object.keys(o):i.qF).forEach((e=>{x(t&&t.properties&&t.properties[e],n&&n.properties&&n.properties[e])&&r.push(e)})),r}function M(e){const{before:t,after:n}=e,o=[];return new Set((0,y.Yd)(t.properties||{}).concat((0,y.Yd)(n.properties||{}))).forEach((e=>{x(t&&t.properties&&t.properties[e],n&&n.properties&&n.properties[e])&&o.push(e)})),o}const P=["page_icon","is_placeholder"];function A(e){const{before:t,after:n}=e,o=[];return P.forEach((e=>{(t.format&&t.format[e])!==(n.format&&n.format[e])&&o.push(e)})),o}function R(e){const{before:t,after:n,property:o}=e;return x(t&&t.properties&&t.properties[o],n&&n.properties&&n.properties[o])}function D(e){return T(e).length>0}function B(e){return e.after.type===o.Ti.tableRow&&M(e).length>0}function E(e){return A(e).length>0}function F(e){const{before:t,after:n}=e,o=a.kk.fromBlock(t),i=a.kk.fromBlock(n),r=o.type,s=i.type,l=o.isNavigableBlock()&&i.isNavigableBlock();return r&&s&&r!==s&&!l}function Z(e){const{activity:t,getRecordModel:n,baseUrl:o,pageVisitSource:i}=e;if(t.isType("top-level-block-created")||t.isType("top-level-block-deleted")){const e=n(t.getTopLevelBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("commented")){const e=n(t.getDiscussionPointer());if(e){const t=n(e.getParentPointer());if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,discussionId:e.id,pageVisitSource:i})}}else if(t.isType("collection-row-created")||t.isType("collection-row-deleted")){const e=n(t.getCollectionRowPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("permissions-edited")){const e=t.getNavigableBlockPointer();if(e){const t=n(e);if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else{const e=n(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:o})}}else if(t.isType("block-edited")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("user-mentioned")){const e=n(t.getMentionedBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("reminder")){const e=n(t.getReminderBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("user-invited")){const e=t.getNavigableBlockPointer();if(e){const t=n(e);if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else{const e=n(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:o})}}return o||"/"}function L(e){switch(e){case"top-level-block-created":return"activity_top_level_block_created";case"top-level-block-deleted":return"activity_top_level_block_deleted";case"collection-row-created":return"activity_collection_row_created";case"collection-row-deleted":return"activity_collection_row_deleted";case"block-edited":return"activity_block_edited";case"block-property-edited":return"activity_block_property_edited";case"permissions-edited":return"activity_permissions_edited";case"user-mentioned":return"activity_mention";case"commented":return"activity_comment";case"user-invited":return"activity_invited";case"collection-edited":return"collection_edited";case"collection-view-edited":return"collection_view_edited";case"collection-property-edited":return"collection_property_edited";case"reminder":return"activity_reminder";case"permission-group-edited":return"activity_permission_group_edited";case"page-locked":return"activity_page_locked";case"page-unlocked":return"activity_page_unlocked";case"email-edited":return"activity_email_edited";case"access-requested":return"activity_access_requested";case"access-request-resolved":return"activity_access_request_resolved";case"page-deleted":return"activity_page_deleted";case"page-restored":return"activity_page_restored";case"page-permanently-deleted":return"activity_page_permanently_deleted";case"team-membership-edited":return"activity_team_membership_edited";case"private-content-transferred":return"activity_private_content_transferred";case"permission-group-mentioned":return"activity_permission_group_mentioned";case"verification-expired":return"activity_verification_expired";case"export-completed":return"activity_export_completed"}}function j(e){const t=[],n=[],o=[];return e.forEach((e=>{!function(e){if("permission-created"===e.type){const t=e.permission_data;if("user_permission"===t.type&&s.YX(t.role)&&e.authors&&1===e.authors.length&&e.authors[0].table===h.KJ&&e.authors[0].id===t.user_id)return!0}return!1}(e)?"permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?n.push(e):o.push(e):t.push(e)})),{autojoinEdits:t,inheritanceEdits:n,otherEdits:o}}function V(e){return"commented"===e||"following"===m.hE[e]}function U(e){return"mentions"===m.hE[e]}},79946:(e,t,n)=>{n.d(t,{iI:()=>S,HR:()=>w,SY:()=>y,Q3:()=>_,rQ:()=>f,xx:()=>b,j:()=>g,VT:()=>x,dG:()=>k,k3:()=>D,PL:()=>P,L1:()=>T,Dq:()=>R,I$:()=>C,T1:()=>I,tO:()=>M,kd:()=>A});n(57658);var o=n(29450),i=n(68626),r=n(91155),a=n(54153),s=n(46637),l=n(97880),c=n(64002);let d,u,p=[],m="/";function f(e,t){u=!["staging","production"].includes(t.env),(0,o.hasPermissionForTrackingTypeBrowser)("targeting")&&(e.isNative||e.doNotTrackEnabled||(m=function(e){if(e.isLocalhost)return"http://localhost:3000";return"https://aif.notion.so"}(t),function(e){if(!m)return;const t=document.createElement("iframe");t.setAttribute("sandbox","allow-scripts allow-same-origin"),t.setAttribute("style","position: absolute; opacity: 0; width: 1px; height: 1px; top: 0; left: 0; border: none; display: block; z-index: -1;"),t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),t.setAttribute("referrerpolicy","no-referrer"),t.setAttribute("src",e.aif.url),document.body.appendChild(t),t.addEventListener("load",(()=>{d=t;for(const e of p)v(t,e);p=[]}))}(t)))}function g(e,t){if((0,o.hasPermissionForTrackingTypeBrowser)("targeting"))if(e.isNative||e.doNotTrackEnabled)h(t)&&i.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupDoNotTrackEnabled"});else try{d?v(d,t):p.push(t)}catch(n){i.log({level:"error",from:"adAnalyticsHelpers",type:"analyticsTrack",error:(0,r.Ui)(n)})}}function h(e){var t,n;return"CompleteRegistration"===(null===(t=e.facebook)||void 0===t?void 0:t.eventName)||"registration"===(null===(n=e.google)||void 0===n?void 0:n.eventName)}function v(e,t){h(t)&&i.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupIFramePostCall"}),e.contentWindow&&e.contentWindow.postMessage(t,m)}function b(e){if("facebook"===e.type){const t=`fb.1.${Date.now()}.${e.id}`;s.Z.set("adClick",{type:"facebook",id:t})}else"google"===e.type?s.Z.set("adClick",{type:"google",id:e.id}):(0,l.t1)(e)}function y(){return s.Z.get("adClick")}function S(){s.Z.remove("adClick")}function _(){return s.Z.get("fbp")}function w(){a.Z.remove("fbp")}function k(e){const{eventType:t,source:n,eventData:o}=e;if(u)console.debug(`track GTM event:%c ${t}`,"font-weight: bold;",o);else if("front"===n){(window.dataLayer=window.dataLayer||[]).push({event:t,data:o})}else{const e={google:{eventName:"custom",data:{event:t,data:o}}};d&&d.contentWindow?d.contentWindow.postMessage(e,m):p.push(e)}}function I(){k({eventType:"sign_up_flow_start",source:"client"})}function C(){k({eventType:"sign_up_flow_complete",source:"client"})}function x(e){let{planType:t,subscriptionTier:n,domainType:o}=e;t&&"team"===t?k({eventType:"create_space",source:"client",eventData:{planType:t}}):n&&k({eventType:"create_space",source:"client",eventData:{subscriptionTier:n,domainType:o}})}function T(e){let{planType:t,subscriptionTier:n}=e;k({eventType:"professional_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:n}})}function M(e){let{planType:t,subscriptionTier:n}=e;k({eventType:"team_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:n}})}function P(){k({eventType:"onboarding_complete",source:"client"})}function A(e,t){k({eventType:"workspace_first_invite_sent",source:"client",eventData:{subscriptionTier:e,domainType:t}})}function R(){k({eventType:"professional_workspace_first_invite_sent",source:"client"})}function D(e,t){var n;const o=(0,c.DP)(null===(n=document.location)||void 0===n?void 0:n.href),i=null==o?void 0:o.get("cid"),r=null==o?void 0:o.get("metadata_cid");var a;r&&g(e,{metadataio:{eventName:"sign_up",data:{email:t,cid:i,mcid:r,url:null===(a=document.location)||void 0===a?void 0:a.href}}})}},93214:(e,t,n)=>{n.d(t,{LC:()=>i,np:()=>r});let o;function i(){return o}function r(e){if(o)return;const t=new URL(e).searchParams.get("tid");t&&(o=t)}},82813:(e,t,n)=>{n.d(t,{e:()=>i});var o=n(97880);function i(e,t){const{notificationId:n,activityId:i,sessionId:r,from:a,alreadyRead:s}=t,l=function(e){const{alreadyRead:t,from:n}=e;switch(n){case"mark_as_unread":return t?"unread":"no_change";case"read_on_page":case"email":case"mark_as_read":case"add_reaction":case"title":case"body":case"frame":case"archive":case"unarchive":case"open_reply_menu":case"mark_all_as_read":return t?"no_change":"read";default:return(0,o.t1)(n)}}({alreadyRead:s,from:a});if("no_change"===l)return;const c={notificationId:n,activityId:i,sessionId:r,from:a,target:l};e.trackEvent({eventName:"mark_notification_as_read",properties:c})}},5809:(e,t,n)=>{n.d(t,{$:()=>i});n(21703);var o=n(12139);function i(){if(!0===window.__mobileAppBackgroundLaunch)return;const e=window.__webStartTime;if("number"==typeof e)return e;{const e=new Error("App Start Time not found. It should be in index.html.");o.IE(e)}}},94568:(e,t,n)=>{n.d(t,{If:()=>c,OU:()=>d,Ox:()=>a,TM:()=>l,vj:()=>r,y3:()=>s});var o=n(21202),i=n(70203);const r="5ee0e0b5-7f0a-4788-a438-f37644514636",a="[zf`",s="0ab77975-f984-4c43-95cc-bcdc2c41b326",l="70f46cce-b6c2-4f4c-848a-c04c9b50a0bc";function c(e){for(const n of e.currentPageAncestors){if(n.table===o.iU&&"0ab77975-f984-4c43-95cc-bcdc2c41b326"===n.value.parent_id)return n.value.id;if(n.table===o.iU){var t;const e=(0,i.QaF)(null===(t=n.value)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.gXoN).trim();if(e)return e}}}function d(e){const t=e.match(/test\+(.*)@makenotion.com/);if(t)return decodeURIComponent(t[1])}},38823:(e,t,n)=>{n.d(t,{m:()=>i});var o=n(12174);class i{constructor(e){this.getEligibleGroup=void 0,this.isAiEnabled=void 0,this.getEligibleGroup=e.getEligibleGroup,this.isAiEnabled=e.isAiEnabled}isAssistantEnabled(){return this.modeIsAtMost("development")}isQnAOnlyEnabled(){return this.isMode("canary")||this.isMode("alpha")||this.isMode("beta")}getMode(){return this.isAiEnabled()?this.getEligibleGroup("assistant_variant")??"control":"control"}isMode(e){return this.getMode()===e}modeIsAtMost(e){const t=["control",...o.KM],n=this.getMode();return t.indexOf(e)<=t.indexOf(n)}}},63362:(e,t,n)=>{function o(e,t){e.trackEvent({eventName:"automation_triggered",properties:t})}function i(e,t){e.trackEvent({eventName:"add_automation_step",properties:t})}function r(e,t){e.trackEvent({eventName:"delete_automation_step",properties:t})}function a(e,t){e.trackEvent({eventName:"click_configure_button",properties:t})}function s(e,t){e.trackEvent({eventName:"click_configure_button_done",properties:t})}function l(e,t){e.trackEvent({eventName:"click_automation_modal_option",properties:t})}function c(e,t){e.trackEvent({eventName:"automation_execution_success",properties:t})}function d(e,t){e.trackEvent({eventName:"automation_execution_fail",properties:t})}function u(e,t){e.trackEvent({eventName:"automation_create",properties:t})}function p(e,t){e.trackEvent({eventName:"automation_update",properties:t})}function m(e,t){e.trackEvent({eventName:"automation_delete",properties:t})}function f(e,t){e.trackEvent({eventName:"automation_enable",properties:t})}function g(e,t){e.trackEvent({eventName:"automation_disable",properties:t})}function h(e,t){e.trackEvent({eventName:"automation_trigger_create",properties:t})}function v(e,t){e.trackEvent({eventName:"automation_trigger_delete",properties:t})}function b(e,t){e.trackEvent({eventName:"automation_action_create",properties:t})}function y(e,t){e.trackEvent({eventName:"automation_action_delete",properties:t})}function S(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function _(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function w(e,t){e.trackEvent({eventName:"automation_learn_click",properties:t})}n.d(t,{A2:()=>b,By:()=>d,Cz:()=>c,Ey:()=>v,OK:()=>y,Rt:()=>f,T0:()=>u,W5:()=>l,ai:()=>g,co:()=>r,d:()=>_,eI:()=>i,lN:()=>s,nC:()=>S,nK:()=>h,qu:()=>w,r4:()=>p,rg:()=>o,uO:()=>m,yK:()=>a})},3865:(e,t,n)=>{n.d(t,{AQ:()=>I,SF:()=>S,TX:()=>B,Vd:()=>b,XO:()=>h,Ym:()=>M,_X:()=>P,bD:()=>R,cO:()=>_,g9:()=>w,gq:()=>g,n6:()=>x,nl:()=>v,rX:()=>T,vp:()=>C});n(57658);var o=n(5366),i=n(81730),r=n(23290),a=n(99036),s=n(6695),l=n(78106),c=n(76218),d=n(72126),u=n(482),p=n(149),m=n(97880);const f=(0,o.defineMessages)({slackAutomationDefaultName:{id:"automationStore.slackAutomation.defaultName",defaultMessage:"{hasCreatorName, select, true {{creatorName}'s notifications} other {Notifications}}"},automationDefaultName:{id:"automatonStore.automation.defaultName",defaultMessage:"{hasCreatorName, select, true {{creatorName}'s automation} other {Automation}}"}});function g(e,t){return e.formatMessage(f.slackAutomationDefaultName,{hasCreatorName:Boolean(t),creatorName:t})}function h(e,t){return e.formatMessage(f.automationDefaultName,{hasCreatorName:Boolean(t),creatorName:t})}function v(e){return"notification_event"===e.trigger.type}function b(e){return"event"===e.trigger.type}(0,m.AO)((e=>(0,m.$K)(e)&&(0,m.$K)(e.target)&&(0,m.$K)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target}}:{false:e}));const y={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function S(e){return Boolean(y[e.type]&&!(0,a.NK)(e)&&(!(0,a.qQ)(e)||void 0===(0,a.q3)(e)))}function _(e){const{collectionFormat:t,collectionSchema:n,filter:o,sort:i,sourcePropertyIds:r}=e,a=(r??(0,m.Yd)(n)).filter(((e,t,i)=>{const r=n[e];return!(!r||!S(r))&&(!o||o([e,r],t,n))}));if(0===a.length)return[];if(!t||!1===i)return a;const l=(0,s.iB)(t,n,void 0,s.j5.Page).collection_page_properties||[];return d.MR(a,(e=>l.findIndex((t=>t.property===e))))}async function w(e){const{config:t,collectionPointer:n,collectionSchema:o,actionId:a,context:s,getCurrentPropertyValue:d}=e,u={};for(const f of t.properties||[]){var m;const e=null===(m=t.values)||void 0===m?void 0:m[f],g=null==o?void 0:o[f];if(!g||!S(g))continue;const h=(0,c.H0)(n,f,g);if(!h)return{error:new i.Ox({actionId:a,property:f,collectionPointer:n})};const v=await(0,c.OH)({value:(null==e?void 0:e.value)||{type:"simple",value:void 0},context:{...s,returnType:h},executeFormula:s.executeContextualFormula});if(p.x.isFail(v))return{error:new i.x6({actionId:a,cause:v.error})};const b=(0,l.bw)({result:v.value,action:(0,r.o9)(e),currentPropertyValue:null==d?void 0:d(f),propertySchema:g});u[f]=b}return{value:u}}function k(e,t){"replace"===e.type?t(e.value):"keep"===e.type||(0,m.t1)(e)}function I(e){const{pointer:t,target:n,visitor:o}=e,i=[];return k(o.visitVariableOutsideOfFormula(n.id),(e=>{(0,m.$K)(e)?i.push(u.op.update({pointer:t,path:["config","target"],args:{id:e}})):i.push(u.op.update({pointer:t,path:["config"],args:{target:null}}))})),i}function C(e){const{pointer:t,config:{properties:n,values:o},visitor:i}=e;if(!n||!o)return[];const r=[];for(const a of n){const e=o[a];null!=e&&e.value&&k(i.visitFormula(e.value),(n=>{r.push(u.op.update({pointer:t,path:["config","values"],args:{[a]:n?{...e,value:n}:null}}))}))}return r}function x(e){const{fieldName:t,pointer:n,config:o,visitor:i}=e,r=[],a=o[t];return a&&k(i.visitFormula(a),(e=>{r.push(u.op.update({pointer:n,path:["config"],args:{[t]:e??null}}))})),r}function T(e,t){const n=(0,l.vx)(e,t);if(n){const e=n.type;if("array"===e.type&&"block"===e.of.type&&e.of.collection)return[{type:"record_permission",pointer:e.of.collection,minimumRole:"reader"}]}return[]}const M={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1};function P(e){const{collectionFormat:t,collectionSchema:n,filter:o,sort:i}=e,r=(0,m.Yd)(n).filter(((e,t,i)=>{var r;const s=n[e];return!(!s||!M[s.type])&&((!(0,a.qQ)(s)||null===(r=(0,a.q3)(s))||void 0===r||!r.auto_update_on_edit)&&(!o||o([e,s],t,n)))}));if(0===r.length)return[];if(!t||!1===i)return r;const l=(0,s.iB)(t,n,void 0,s.j5.Page).collection_page_properties||[];return d.MR(r,(e=>l.findIndex((t=>t.property===e))))}const A={checkbox:!0,multi_select:!0,select:!0,status:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,email:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,number:!1,person:!1,phone_number:!1,relation:!1,rollup:!1,text:!1,title:!1,url:!1,verification:!1};function R(e){return A[e.type]}const D={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function B(e){return D[e.type]}},48777:(e,t,n)=>{n.d(t,{L:()=>S,Y:()=>b});n(57658),n(21703);var o=n(3865),i=n(41432),r=n(84116),a=n(78106),s=n(79317),l=n(47453),c=n(5366),d=n(482),u=n(4615),p=n(149),m=n(18844),f=n(21202),g=n(6287),h=n(81730);const v=(0,c.defineMessages)({createPage:{id:"automations.actions.createPage",defaultMessage:"Add page to…"},createPageDefaultVariableName:{id:"automations.actions.createPageDefaultVariableName",defaultMessage:"New page added"},createPageVariableNameWithDatabase:{id:"automations.actions.createPageVariableNameWithDatabase",defaultMessage:"New page added in {databaseName}"},createPageVariableNameWithDatabaseAndStepNumber:{id:"automations.actions.createPageVariableNameWithDatabaseAndStepNumber",defaultMessage:"New page added in {databaseName} from step {stepNumber}"},createPageDescription:{id:"automations.actions.createPageDescription",defaultMessage:"Adds a new page to a database."}}),b={relation:!0,person:!0,multi_select:!0,title:!1,text:!1,url:!1,email:!1,phone_number:!1,checkbox:!1,created_by:!1,last_edited_by:!1,file:!1,select:!1,status:!1,number:!1,date:!1,created_time:!1,last_edited_time:!1,last_visited_time:!1,formula:!1,rollup:!1,button:!1,auto_increment_id:!1,location:!1,verification:!1},y=new Set(["button","event","recurrence"]),S={type:"create_page",display:{icon:l.R,name:v.createPage,description:v.createPageDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();return"notification_event"===t&&(t="event"),"event"===t?await e.checkSubscribed():y.has(t)},getDependencies:(e,t)=>{const n=t.getConfig();if(null!=n&&n.collection){const e=[{type:"record_permission",pointer:null==n?void 0:n.collection,minimumRole:"content_only_editor"}];return null!=n&&n.template_page_id&&e.push({type:"record_permission",pointer:{table:f.iU,id:null==n?void 0:n.template_page_id},minimumRole:"reader"}),e}return[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};const o=e.getRecordModel(n.collection);if(!o)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};if(!n.collection.spaceId)return{error:new h.MO("Collection missing space ID")};if(n.template_page_id){const t=e.getRecordModel({id:n.template_page_id,table:f.iU});if(!t)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}};if(t.getParentId()!==n.collection.id)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}}}let i=!1,s=!1;for(const r of e.automationModel.getActionIds()){if(r===t.id)continue;const o=e.getRecordModel({id:r,spaceId:e.automationModel.getSpaceId(),table:m.Xj});var l;if("create_page"===(null==o?void 0:o.type))i=!0,(null===(l=o.getConfig())||void 0===l||null===(l=l.collection)||void 0===l?void 0:l.id)===n.collection.id&&(s=!0)}const c=(0,a.Kd)({source:"action",action_id:t.id,action_output_type:"page"}),d=e.automationModel.getActionIds().indexOf(t.id)??-1,u=o.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:e.userTimeZone,intl:e.intl}),p=s?e.intl.formatMessage(v.createPageVariableNameWithDatabaseAndStepNumber,{databaseName:u,stepNumber:d+1}):i?e.intl.formatMessage(v.createPageVariableNameWithDatabase,{databaseName:u}):e.intl.formatMessage(v.createPageDefaultVariableName);return{value:{valueTypes:[{kind:r.yp.ContextValue,id:c,name:p,type:{type:"block",collection:n.collection}}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{values:[]}};if(!n.collection.spaceId)return{error:new h.mK({pointer:n.collection,actionId:t.id})};const l=await e.loadRecordModel(n.collection);if(!l)return{value:{values:[]}};const c=l.getSpaceShardedPointer(),m=l.getNormalizedSchema();let v,b,y;if(m){const i=await(0,o.g9)({config:n,collectionPointer:c,collectionSchema:m,actionId:t.id,context:e});if(p.x.isFail(i))return i;v=i.value}else v={};if(n.template_page_id)b=n.template_page_id;else{const t=(await e.handleDataRequest({recordPointers:[n.collection]})).getRecordModel(n.collection),o=null==t?void 0:t.getFormatValue("collection_default_template");o&&"empty"!==o&&(b=o.template_page_id)}const S=[];if(b){const t=await e.executeEffectMap.initializeTemplateInDatabase({templateId:b,collection:n.collection,propertyUpdates:v});if(p.x.isFail(t))return t;y=t.value.pageId}else{y=(0,u.ZP)();const t={created_time:Date.now(),last_edited_time:Date.now(),id:y,type:i.Ti.page,version:0,parent_id:n.collection.id,parent_table:g.v,alive:!0,space_id:n.collection.spaceId,properties:v,...e.author?{created_by_table:e.author.table}:{},...e.author?{created_by_id:e.author.id}:{}};S.push(d.op.set({pointer:{table:f.iU,id:t.id,spaceId:t.space_id},path:[],args:t})),e.author&&S.push(d.op.update({pointer:{table:f.iU,id:y,spaceId:c.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}const _=l.isPageTreeCollection(),w=l.getRootPagePointer();if(_&&w){const e=(0,s.A6)(w.table,f.iU);if(!e)throw new Error(`Could not find child path for parent table ${w.table} and child table ${f.iU}`);S.push({pointer:w,path:e,command:"insertChildrenAfter",args:{ids:[y]}})}if(S.length>0){const n=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"create_page",collection:c,pageId:y},operations:S});if(n.error)return n}const k=(0,a.Kd)({source:"action",action_id:t.id,action_output_type:"page"});return{value:{values:[{kind:r.yp.ContextValue,id:k,value:{type:"block",value:{table:f.iU,id:y,spaceId:c.spaceId}}}]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:n}=e,i=t.getConfig();return i?(0,o.vp)({pointer:t.pointer,config:i,visitor:n}):[]}}},80700:(e,t,n)=>{n.d(t,{z:()=>z,P:()=>H});var o=n(23290),i=n(48777),r=n(88437),a=n(72126),s=n(59753),l=n(5366),c=n(21202),d=n(97880);const u=(0,l.defineMessages)({duplicateBlocks:{id:"automations.actions.duplicateBlocks",defaultMessage:"Insert blocks"},duplicateBlocksDescription:{id:"automations.actions.duplicateBlocksDescription",defaultMessage:"Insert text or blocks on this page."}}),p={type:"duplicate_blocks",display:{icon:r.a,name:u.duplicateBlocks,description:u.duplicateBlocksDescription,hasSideEffects:!0},isAvailableForContext:async e=>Promise.resolve("button_block"===e.contextType),getDependencies:(e,t)=>[{type:"record_permission",pointer:e.automationModel.getParentPointer(),minimumRole:"content_only_editor"}],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n;const o=a.Ps(t.getBlocks()??[]),i=(null===(n=t.getConfig())||void 0===n?void 0:n.insertion_point)??s.IN.DEFAULT_INSERTION_POINT;return(0,d.$K)(o)&&await e.executeEffectMap.duplicateBlockChildren({blockPointer:{table:c.iU,id:o,spaceId:e.automationModel.getSpaceId()},insertionPoint:i}),{value:{values:[]}}},acceptFormulaVisitor:e=>[]};n(57658);var m=n(3865),f=n(78106),g=n(76218),h=n(84169),v=n(149),b=n(98963),y=n(70203),S=n(81730);const _=(0,l.defineMessages)({modalConfirmation:{id:"automations.actions.modalConfirmation",defaultMessage:"Show confirmation"},modalConfirmationDescription:{id:"automations.actions.modalConfirmationDescription",defaultMessage:"Shows a confirmation window before proceeding."}}),w={type:"modal_confirmation",display:{icon:h.m,name:_.modalConfirmation,description:_.modalConfirmationDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getDependencies:(e,t)=>[],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n,o,i;const r=t.getConfig();let a=[];if(null!=r&&r.text){const n=await(0,g.OH)({value:r.text,context:{...e,returnType:{type:"text"}},executeFormula:e.executeContextualFormula});if(v.x.isFail(n))return{error:new S.x6({actionId:t.id,cause:n.error})};a=(0,f.j4)(n.value)}(0,y.VrM)(a)>b.tb&&(a=(0,y.Zdj)(a,b.tb),a.push((0,y.V3y)("…")));return"cancel"===await e.executeEffectMap.displayModal({format:{icon:null===(n=e.automationModel.getProperties())||void 0===n?void 0:n.icon,text:a,continueButtonText:(null==r||null===(o=r.continue_button)||void 0===o?void 0:o.text)??"",cancelButtonText:(null==r||null===(i=r.cancel_button)||void 0===i?void 0:i.text)??""}})?{error:new S.nQ}:{value:{values:[]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:n}=e,o=t.getConfig();return o?(0,m.n6)({fieldName:"text",config:o,pointer:t.pointer,visitor:n}):[]}};var k=n(9999);const I=(0,l.defineMessages)({openPage:{id:"automations.actions.openPage",defaultMessage:"Open page"},openPageDescription:{id:"automations.actions.openPageDescription",defaultMessage:"Opens a specified page."}}),C={type:"open_page",display:{icon:k.J,name:I.openPage,description:I.openPageDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getDependencies:(e,t)=>{var n,o;const i=t.getConfig();return"page"===(null==i||null===(n=i.target)||void 0===n?void 0:n.type)?[{type:"record_permission",pointer:null==i?void 0:i.target.page,minimumRole:"reader"}]:"variable"===(null==i||null===(o=i.target)||void 0===o?void 0:o.type)?(0,m.rX)(e.valueTypes,i.target.id):[]},typecheck:(e,t)=>{const n=t.getConfig();return null!=n&&n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"open_page",key:"target"}]}}},execute:(e,t)=>{const n=t.getConfig();if(null==n||!n.target)return{error:new S.mK({pointer:null==n?void 0:n.target,actionId:t.id})};let o;if("page"===n.target.type)o=n.target.page;else if("variable"===n.target.type){const i=(0,f.dh)(e.values,n.target.id);if(!i)return{error:new S.Hb({actionId:t.id,source:"action",variable:i})};if("block"===i.value.type)o=i.value.value;else{if("array"!==i.value.type)return{error:new S.Hb({actionId:t.id,source:"action",variable:i.value})};{const e=i.value.values[0];if(!e||"block"!==e.type)return{error:new S.Hb({actionId:t.id,source:"action",variable:i.value})};o=e.value}}}else(0,d.t1)(n.target);return e.executeEffectMap.navigateToPage({actionId:t.id,page:o,openIn:t.getOpenPageIn()}),{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:n,visitor:o}=e,i=n.getConfig();if(!i)return[];const r=[];return"variable"===(null==i||null===(t=i.target)||void 0===t?void 0:t.type)&&r.push(...(0,m.AQ)({pointer:n.pointer,target:i.target,visitor:o})),r}};var x=n(84116),T=n(49019),M=n(6287);const P=(0,l.defineMessages)({queryCollection:{id:"automations.actions.queryCollection",defaultMessage:"Get pages"},queryCollectionDescription:{id:"automations.actions.queryCollectionDescription",defaultMessage:"Get a list of pages from a database with optional filters and sorts, to be used in a subsequent automation step."},queryCollectionPages:{id:"automations.actions.queryCollectionPages",defaultMessage:"Pages from step {stepNumber}"}}),A={type:"query_collection",display:{icon:T.e,name:P.queryCollection,description:P.queryCollectionDescription,hasSideEffects:!1},isAvailableForContext:async()=>Promise.resolve(!1),getDependencies:(e,t)=>{const n=t.getConfig();return null!=n&&n.collection?[{type:"record_permission",pointer:null==n?void 0:n.collection,minimumRole:"reader"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{valueTypes:[]}};const o=(0,f.Kd)({source:"action",action_id:t.id,action_output_type:"pages"}),i=e.automationModel.getActionIds().indexOf(t.id)??-1;return{value:{valueTypes:[{kind:x.yp.ContextValue,id:o,name:e.intl.formatMessage(P.queryCollectionPages,{stepNumber:i+1}),type:{type:"array",of:{type:"block",collection:n.collection}}}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{values:[]}};if(null==n||!n.collection.spaceId)return{error:new S.mK({pointer:null==n?void 0:n.collection,actionId:t.id})};const o={table:M.v,id:null==n?void 0:n.collection.id,spaceId:null==n?void 0:n.collection.spaceId},i=await e.executeEffectMap.queryCollection({actionId:t.id,collection:o,filter:null==n?void 0:n.filter,sort:null==n?void 0:n.sort,limit:null==n?void 0:n.limit});if(i.error)return i;const r=(0,f.Kd)({source:"action",action_id:t.id,action_output_type:"pages"});return{value:{values:[{kind:x.yp.ContextValue,id:r,value:{type:"array",values:i.value.blockIds.map((e=>({type:"block",value:{table:c.iU,id:e,spaceId:o.spaceId}})))}}]}}},acceptFormulaVisitor:e=>[]};var R=n(24600),D=n(77420);const B=(0,l.defineMessages)({slackNotification:{defaultMessage:"Send Slack notification to…",id:"automations.actions.slackNotification"},slackNotificationDescription:{defaultMessage:"Sends a Slack notification to a user or channel.",id:"automations.actions.slackNotificationDescription"}}),E={type:"slack_notification",display:{icon:R.P,name:B.slackNotification,description:B.slackNotificationDescription,hasSideEffects:!1},isAvailableForContext:async e=>{const t=e.automationActions.filter((e=>e.isType("slack_notification"))),n="canAddAction"===e.checkType?t.length<1:t.length<=1;return Promise.resolve("event"===e.contextType&&n)},getDependencies:(e,t)=>{const n=t.getConfig();return null!=n&&n.external_bot_id?[{minimumRole:"editor",pointer:{id:n.external_bot_id,table:D.cZ},type:"record_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.external_bot_id)return{value:{validationFailures:[{type:"missing_required_config",actionType:"slack_notification",key:"external_bot_id"}]}};return e.getRecordModel({id:n.external_bot_id,table:D.cZ})?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_value",actionType:"slack_notification",key:"external_bot_id"}]}}},execute:(e,t)=>({value:{values:[]}}),acceptFormulaVisitor:e=>[]};var F=n(86678),Z=n(25651),L=n(482);const j=(0,l.defineMessages)({updatePages:{id:"automations.actions.updatePages",defaultMessage:"Edit pages in…"},updatePagesDescription:{id:"automations.actions.updatePagesDescription",defaultMessage:"Edits the properties of specified pages in a database."}}),V=new Set(["button","event"]);async function U(e){const{pointer:t,context:n,actionId:o}=e,i=await n.loadRecordModel(t);if(!i)return{error:new S.Do({pointer:t,actionId:o})};const r=await(0,F.Rd)({block:i,loadRecordModel:n.loadRecordModel});return r?{value:r.getSpaceShardedPointer()}:{error:new S.Do({pointer:t,actionId:o})}}const O={type:"update_pages",display:{icon:Z.R,name:j.updatePages,description:j.updatePagesDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();if("notification_event"===t&&(t="event"),"event"===t){if(!(await e.checkSubscribed()))return!1;const t=e.automationActions.filter((e=>{var t;return e.isType("update_pages")&&"collection"===(null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.type)}));return"canAddAction"===e.checkType?t.length<5:t.length<=5}return V.has(t)},getDependencies:(e,t)=>{var n,o;const i=t.getConfig();return"collection"===(null==i||null===(n=i.target)||void 0===n?void 0:n.type)?[{type:"record_permission",pointer:null==i?void 0:i.target.collection,minimumRole:"content_only_editor"}]:"variable"===(null==i||null===(o=i.target)||void 0===o?void 0:o.type)?(0,m.rX)(e.valueTypes,i.target.id):[]},typecheck:(e,t)=>{const n=t.getConfig();return null!=n&&n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"update_pages",key:"target"}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.target)return{error:new S.mK({pointer:null==n?void 0:n.target,actionId:t.id})};let o,i,r,l=e.loadRecordModel;if("collection"===(null==n?void 0:n.target.type)){const a=await l(n.target.collection);if(!a)return{error:new S.Do({pointer:n.target.collection,actionId:t.id})};const c=await e.executeEffectMap.queryCollection({actionId:t.id,collection:n.target.collection,filter:n.target.filter,limit:n.target.limit,sort:n.target.sort});if(v.x.isFail(c))return c;r=c.value.blockIds,o=a.getNormalizedSchema(),i=n.target.collection,c.value.recordMap&&(l=s.s8.tryUntilFound(l,s.s8.fromRecordMapWithRole(c.value.recordMap)))}else if("variable"===n.target.type){const s=(0,f.dh)(e.values,n.target.id);if(!s)return{error:new S.L({actionId:t.id,contextValueId:n.target.id})};if("block"===s.value.type){let n=await U({pointer:s.value.value,context:e,actionId:t.id});if(v.x.isFail(n)){const t=function(e){var t;const{actionModels:n,contextValue:o}=e,i=(0,f.MY)(o.id);if("action"!==i.source)return{error:new S.Hb({source:"global",variable:o.value})};const r=n.find((e=>e.id===i.action_id));if(!r||"create_page"!==r.getType())return{error:new S.Hb({actionId:i.action_id,source:"action",variable:o.value})};const a=null===(t=r.getConfig())||void 0===t?void 0:t.collection;return a?{value:a}:{error:new S.Hb({actionId:i.action_id,source:"action",variable:o.value})}}({actionModels:e.actionModels,contextValue:s});if(v.x.isFail(t))return n;n=t}r=[s.value.value.id],i=n.value;const a=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:i});if(v.x.isFail(a))return a;o=a.value.collectionSchema}else{if("array"!==s.value.type)return{error:new S.Hb({actionId:t.id,source:"action",variable:s.value})};{const n=s.value.values[0];if(!n||"block"!==n.type)return{error:new S.Hb({actionId:t.id,source:"action",variable:n})};const c=await l(n.value),d=c?await(0,F.Rd)({block:c,loadRecordModel:l}):void 0;if(!d)return{error:new S.Do({pointer:n.value,actionId:t.id})};const u=d.getSpaceShardedPointer();r=a.oA(s.value.values.map((e=>"block"===e.type?e.value.id:void 0)));const p=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:u});if(v.x.isFail(p))return p;o=p.value.collectionSchema,i=u}}}else if("page"===n.target.type){const a=n.target.page,s=await U({pointer:a,context:e,actionId:t.id});if(v.x.isFail(s))return s;r=[a.id],i=s.value;const l=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:i});if(v.x.isFail(l))return l;o=l.value.collectionSchema}else(0,d.t1)(n.target);const u=[];for(const a of r){const r=await l({table:c.iU,id:a,spaceId:i.spaceId});let s;if(o){const a=null==r?void 0:r.getProperties(),l=await(0,m.g9)({config:n,collectionPointer:i,collectionSchema:o,actionId:t.id,context:e,getCurrentPropertyValue:e=>null==a?void 0:a[e]});if(v.x.isFail(l))return l;s=l.value}else s={};u.push({pointer:{table:c.iU,id:a,spaceId:i.spaceId},command:"update",path:["properties"],args:s}),e.author&&u.push(L.op.update({pointer:{table:c.iU,id:a,spaceId:i.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}if(u.length>0){const a=(n.properties??[]).map((e=>{var t;const n=null===(t=o)||void 0===t?void 0:t[e];if(n)return{id:e,type:n.type}})).filter(d.$K),s=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"update_pages",pageIds:r,collection:i,editedProperties:a},operations:u});if(v.x.isFail(s))return s}return{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:n,visitor:o}=e,i=n.getConfig();if(!i)return[];const r=[];if("variable"===(null==i||null===(t=i.target)||void 0===t?void 0:t.type)){const e=(0,m.AQ)({pointer:n.pointer,target:i.target,visitor:o});r.push(...e)}return r.push(...(0,m.vp)({pointer:n.pointer,config:i,visitor:o})),r}},N={query_collection:A,create_page:i.L,update_pages:O,open_page:C,slack_notification:E,duplicate_blocks:p,modal_confirmation:w};function z(e){return N[e]}function H(e){return(0,o.FP)(e).map((e=>z(e)))}},81730:(e,t,n)=>{n.d(t,{Do:()=>a,Hb:()=>s,L:()=>p,MO:()=>o,Ox:()=>c,Pn:()=>l,iR:()=>d,mK:()=>r,nQ:()=>m,x6:()=>u});n(21703);class o extends Error{}class i extends Error{constructor(e,t){super(t),this.type=e}}class r extends i{constructor(e){super("invalid_record_pointer","Invalid record pointer"),this.data=e}}class a extends i{constructor(e){super("invalid_record","Invalid record"),this.data=e}}class s extends i{constructor(e){super("invalid_variable_type","Invalid variable type"),this.data=e}}class l extends i{constructor(e){super(e.type,e.message),this.data=e}}class c extends i{constructor(e){super("invalid_property_schema","Invalid property schema"),this.data=e}}class d extends i{constructor(e){super("unsupported_context","Unsupported context"),this.data=e}}class u extends i{constructor(e){super("formula_execution_failed","Formula execution failed"),this.data=e}}class p extends i{constructor(e){super("missing_context_value","Missing context value"),this.data=e}}class m extends i{constructor(){super("user_cancelled","User cancelled")}}Error},94412:(e,t,n)=>{n.d(t,{X:()=>r,e:()=>a});var o=n(59753),i=n(18844);class r{constructor(e){this.triggerType=void 0,this.actions=void 0,this.spaceId=void 0,this.parentPointer=void 0,this.triggerType=e.triggerType,this.actions=e.actions,this.spaceId=e.spaceId,this.parentPointer=e.parentPointer}get id(){return"structured-automation-id"}getSpaceId(){return this.spaceId}getActionIds(){return this.actions.map((e=>e.id))}getProperties(){}getTriggerType(){return this.triggerType}getParentPointer(){return this.parentPointer}}class a{constructor(e,t){this.underlying=e,this.spaceId=t}get id(){return this.underlying.id}get pointer(){return{id:this.underlying.id,table:i.Xj,spaceId:this.spaceId}}getType(){return this.underlying.type}getConfig(){return this.underlying.config}getBlocks(){return this.underlying.blocks??[]}getOpenPageIn(){var e;return(null===(e=this.underlying.config)||void 0===e?void 0:e.open_in)??o.th.DEFAULT_PEEK_MODE_FORMAT}}},10450:(e,t,n)=>{n.d(t,{E$:()=>y,J0:()=>d,dG:()=>h,io:()=>b,rb:()=>v,zW:()=>g});var o=n(5366),i=n(53877),r=n(84116),a=n(78106),s=n(72126),l=n(19889);const c=(0,o.defineMessages)({buttonPage:{id:"automations.triggers.button.page.label",defaultMessage:"This page"},currentUser:{id:"automations.triggers.currentUser.label",defaultMessage:"Person who clicked button"},now:{id:"automations.triggers.now.label",defaultMessage:"Now"},today:{id:"automations.triggers.today.label",defaultMessage:"Today"}});function d(){return(0,a.Kd)({source:"global",global:"button_page"})}function u(){return(0,a.Kd)({source:"global",global:"current_user"})}function p(){return(0,a.Kd)({source:"global",global:"now"})}function m(){return(0,a.Kd)({source:"global",global:"today"})}function f(e){const{blockPointer:t,currentUserId:n}=e,o=d(),a=u(),s=p(),c=m();return{value:{values:[{kind:r.yp.ContextValue,id:o,value:{type:"block",value:t}},{kind:r.yp.ContextValue,id:a,value:{type:"person",value:{table:l.KJ,id:n}}},{kind:r.yp.ContextValue,id:s,value:{type:"date",value:(0,i.CQ)(Date.now(),e.userTimeZone)}},{kind:r.yp.ContextValue,id:c,value:{type:"date",value:(0,i.hT)(Date.now(),e.userTimeZone)}}]}}}function g(e){const{collectionPointer:t}=e,n=d(),o=u(),i=p(),a=m();return{value:{valueTypes:[{kind:r.yp.ContextValue,id:n,name:e.intl.formatMessage(c.buttonPage),type:{type:"block",collection:t}},{kind:r.yp.ContextValue,id:o,name:e.intl.formatMessage(c.currentUser),type:{type:"person"}},{kind:r.yp.ContextValue,id:i,name:e.intl.formatMessage(c.now),type:{type:"date"}},{kind:r.yp.ContextValue,id:a,name:e.intl.formatMessage(c.today),type:{type:"date"}}]}}}function h(e){return f(e)}function v(e){const t=u(),n=p(),o=m(),i=d(),a={kind:r.yp.ContextValue,id:t,name:e.intl.formatMessage(c.currentUser),type:{type:"person"}},l={kind:r.yp.ContextValue,id:n,name:e.intl.formatMessage(c.now),type:{type:"date"}},f={kind:r.yp.ContextValue,id:o,name:e.intl.formatMessage(c.today),type:{type:"date"}},g=e.collectionPointer?{kind:r.yp.ContextValue,id:i,name:e.intl.formatMessage(c.buttonPage),type:{type:"block",collection:e.collectionPointer}}:void 0;return{value:{valueTypes:s.oA([a,l,f,g])}}}function b(e){const{currentUserId:t,pagePointer:n}=e,o=u(),a=p(),s=m(),c=d();return{value:{values:[{kind:r.yp.ContextValue,id:o,value:{type:"person",value:{table:l.KJ,id:t}}},{kind:r.yp.ContextValue,id:a,value:{type:"date",value:(0,i.CQ)(Date.now(),e.userTimeZone)}},{kind:r.yp.ContextValue,id:s,value:{type:"date",value:(0,i.hT)(Date.now(),e.userTimeZone)}},{kind:r.yp.ContextValue,id:c,value:{type:"block",value:n}}]}}}function y(e){const t=p(),n=m(),o=d(),i={kind:r.yp.ContextValue,id:o,name:e.intl.formatMessage(c.buttonPage),type:{type:"block",collection:e.collectionPointer}};return{value:{valueTypes:[{kind:r.yp.ContextValue,id:t,name:e.intl.formatMessage(c.now),type:{type:"date"}},{kind:r.yp.ContextValue,id:n,name:e.intl.formatMessage(c.today),type:{type:"date"}},i]}}}},23290:(e,t,n)=>{n.d(t,{E2:()=>a,FP:()=>i,Gl:()=>d,lK:()=>r,o9:()=>s,ss:()=>c,xZ:()=>l});const o={duplicate_blocks:{display:!0},create_page:{display:!0},modal_confirmation:{display:!0},open_page:{display:!0},query_collection:{display:!0},slack_notification:{display:!0},update_pages:{display:!0}};function i(e){return Object.entries(o).filter((t=>{let[n,o]=t;return o[e]})).map((e=>{let[t]=e;return t}))}function r(e,t){return o[e][t]}const a=["replace","append","remove"];function s(e){return(null==e?void 0:e.action)||"replace"}const l=100,c=50,d={recurrence:{min:1,max:1},notification_event:{min:1,max:1},button:{min:0,max:"default_bound"},event:{min:1,max:"default_bound"}}},36576:(e,t,n)=>{n.d(t,{sU:()=>I,xU:()=>y});n(57658);var o=n(41432),i=n(99036),r=n(14215),a=n(86678),s=n(72126),l=n(59753),c=n(63306),d=n(26825),u=n(606),p=n(21202),m=n(70279),f=n(33709),g=n(23867),h=n(62965),v=n(70203),b=n(97880);async function y(e){const{loadRecordValue:t,operationPointers:n,getInitialRecordModel:o,getFinalRecordModel:i}=e,a=[],c=[];return await Promise.all(n.map((async e=>{if((0,u.$O)(e,p.iU)){const n=o.getRecordValue(e),d=i.getRecordValue(e),u=null==d?void 0:d.space_id,m={...e,spaceId:(0,g.C)(u)},f=(0,r.E)(S(n),S(d));if(await Promise.all([...f.deleted.map((async n=>{await async function(e){const t=e.getInitialRecordModel.getRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;const n=e.getFinalRecordModel.getRecordValue({table:p.iU,id:e.blockId});if(n&&n.parent_id!==e.parentId)return!0;if(!n){const t=await e.loadRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:n,parentId:e.id,getInitialRecordModel:o,getFinalRecordModel:i})&&c.push({block_id:n,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})})),...f.created.map((async n=>{await async function(e){const t=e.getFinalRecordModel.getRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;if(!t){const t=await e.loadRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:n,parentId:e.id,getFinalRecordModel:i})&&a.push({block_id:n,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})}))]),n&&d&&n.parent_id!==d.parent_id){if(n.parent_table===p.iU){let o=i.getRecordValue({table:p.iU,id:n.parent_id,spaceId:n.space_id});o||(o=await t({table:p.iU,id:n.parent_id,spaceId:n.space_id})),o&&o.content&&o.content.includes(e.id)&&a.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,b.xL)(n.parent_id),parent_pointer:m}})}if(d.parent_table===p.iU){let n=i.getRecordValue({table:p.iU,id:d.parent_id,spaceId:d.space_id});n||(n=await t({table:p.iU,id:d.parent_id})),n&&n.content&&!n.content.includes(e.id)&&a.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,b.xL)(d.parent_id),parent_pointer:{id:d.parent_id,table:p.iU,spaceId:d.space_id}}})}}let h;if(n&&(h=l.kk.fromBlock(n).getCollectionPointer()),(!n||!h)&&d){const e=l.kk.fromBlock(d).getCollectionPointer();if(e){let n=i.getRecordValue(e);n||(n=await t(e)),n&&n.parent_id!==d.id&&a.push({block_id:(0,b.xL)(n.parent_id),mentioned_from:{type:"collection_reference",block_id:d.id,pointer:{id:d.id,spaceId:d.space_id,table:p.iU}}})}}const v=(0,r.N)(w(n),w(d),_);for(const{blockId:t,propertyId:o}of v.created)a.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:o,pointer:m}});for(const{blockId:t,propertyId:o}of v.deleted)c.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:o,pointer:m}});const y=C(n),k=C(d);y&&!s.Xy(y,k)&&c.push({block_id:y.id,mentioned_from:{type:"alias",pointer:m}}),k&&!s.Xy(y,k)&&a.push({block_id:k.id,mentioned_from:{type:"alias",pointer:m}});const I=x(n),T=x(d);I&&!s.Xy(I,T)&&c.push({block_id:I.id,mentioned_from:{type:"transclusion_reference",pointer:m}}),T&&!s.Xy(I,T)&&a.push({block_id:T.id,mentioned_from:{type:"transclusion_reference",pointer:m}})}else if((0,u.$O)(e,m.x_)){const t=o.getRecordValue(e),n=i.getRecordValue(e),s=null==n?void 0:n.space_id,l={...e,spaceId:(0,g.C)(s)},d=(0,r.E)(k(t),k(n));for(const o of d.created)a.push({block_id:o,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:l}});for(const o of d.deleted)c.push({block_id:o,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:l}})}}))),{createdBacklinks:a,deletedBacklinks:c}}function S(e){const t=l.kk.fromValue(p.iU,e);return t?t.getContentIds():[]}function _(e){return`${e.blockId}${e.propertyId}`}function w(e){const t=l.kk.fromValue(p.iU,e),n=[];if(!t)return n;const o=t.getProperties();if(!o)return n;for(const i in o){const e=v.jDe(t.getProperty(i));for(const t of e)n.push({propertyId:i,blockId:t})}return n}function k(e){const t=l.kk.fromValue(m.x_,e);return t&&t.alive?v.jDe(t.getText()):[]}function I(e){window.__c={n:"filterBacklinksToHide"};const{actor:t,blockId:n,backlinks:r,getRecordModel:u}=e,v=(0,c.DW)({table:p.iU,id:n},u),y=s.Z$(v),S=v[0];if(!y||"block"!==S.table)return[];const _=(0,d.IJ)({actor:t,ancestors:v});return r.filter((e=>{const n=function(e){var t,n,o,i;return"comment_mention"===e.mentioned_from.type?{table:m.x_,id:e.mentioned_from.comment_id,spaceId:(0,g.C)(null===(t=e.mentioned_from.pointer)||void 0===t?void 0:t.spaceId)}:"reference"===e.mentioned_from.type?{table:p.iU,id:e.mentioned_from.parent_block_id,spaceId:(0,g.C)(null===(n=e.mentioned_from.parent_pointer)||void 0===n?void 0:n.spaceId)}:"property_mention"===e.mentioned_from.type?{table:p.iU,id:e.mentioned_from.block_id,spaceId:(0,g.C)(null===(o=e.mentioned_from.pointer)||void 0===o?void 0:o.spaceId)}:"collection_reference"===e.mentioned_from.type?{table:p.iU,id:e.mentioned_from.block_id,spaceId:(0,g.C)(null===(i=e.mentioned_from.pointer)||void 0===i?void 0:i.spaceId)}:"alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type?e.mentioned_from.pointer:void(0,b.t1)(e.mentioned_from)}(e),r=(0,c.DW)(n,u);if(!(0,c.Zg)(r))return!1;const s=(0,d.IJ)({actor:t,ancestors:r});if(s){if(!_)return!1;if(!(0,h.Z)(s.from,_.from))return!1}if(r.some((e=>e.table===f.qF&&e.resolved)))return!1;if("property_mention"===e.mentioned_from.type){var v;const t=u({table:p.iU,id:e.mentioned_from.block_id,spaceId:(0,g.C)(null===(v=e.mentioned_from.pointer)||void 0===v?void 0:v.spaceId)});if(!t)return!1;const n=(0,a.ky)({block:t,getRecordModel:u});if(n){const t=l.kk.fromCollection(n);if("title"!==e.mentioned_from.property_id){const o=i.oC(n),r=e.mentioned_from.property_id,s=o[r];if(!s)return!1;if("relation"===s.type){const e=(0,a.ky)({block:S,getRecordModel:u}),n=i.F0(s);if(!e||e.id!==n)return!1;if(i.EY({...t.pointer,propertyId:r,propertySchema:s},e))return!1}else if("title"!==s.type&&"text"!==s.type)return!1}}else if("title"===e.mentioned_from.property_id){if(!(0,o.XD)(t.type))return!1}else{if("caption"!==e.mentioned_from.property_id)return!1;if(!l.kk.fromBlock(t).isType(o.oe))return!1}}const y=(0,c.zN)(r)[0],w=(0,c.uJ)({table:p.iU,id:e.block_id},u)[1];return!y||!w||y.id!==w.id}))}function C(e){const t=l.kk.fromValue(p.iU,e);if(t&&"alias"===t.type)return t.getAliasTargetPointer()}function x(e){const t=l.kk.fromValue(p.iU,e);if(t&&"transclusion_reference"===t.type)return t.getTransclusionReferenceTargetPointer()}},49271:(e,t,n)=>{n.d(t,{N7:()=>r,ZD:()=>a});var o=n(8848),i=n(82990);function r(e){return{color:o.ZP.defaultText,fill:"currentColor",lineHeight:1.5,fontFamily:i.Z.getCompositeFontFamily(e).sans}}const a={paddingTop:3,paddingBottom:3,paddingLeft:2,paddingRight:2}},14248:(e,t,n)=>{n.d(t,{Ko:()=>x,ND:()=>R,RA:()=>I,WL:()=>A,Xq:()=>L,hz:()=>j,r9:()=>O,wg:()=>V,zk:()=>C});n(57658);var o=n(76205),i=n(30823),r=n(14714),a=n(99036),s=n(80951),l=n(40506),c=n(53877),d=n(76725),u=n(72126),p=n(59753),m=n(33317),f=n(4615),g=n(74446),h=n(606),v=n(21202),b=n(19889),y=n(70203),S=n(97880);function _(e){const t=[],n=[];for(const[o,i]of Object.entries(e))i&&((0,a.S4)(o)||("person"===i.type?t.push(o):"date"===i.type&&n.push(o)));return{date:n,person:t}}const w=y.V3y(", ");function k(e,t){const n={command:"update",args:t,pointer:{table:v.iU,id:e.id},path:["properties"]};return p.kk.fromValue(e.table,(0,m.lK)(n,e.__IM_SORRY__getValue()))}function I(e){const{block:t,schema:n,propertyMapping:i,filter:r,userFilterContext:a,groupsPointer:s,relativeVariableResult:l,getRecordModel:c,intl:d}=e,{userId:m,userTimeZone:f,userStartOfWeek:h}=a;let b=t;const y=p.om.tryUntilFound(p.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===v.iU&&n===b.id)return b}),g.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===v.iU&&n===b.id)return b.__IM_SORRY__getValue()}))),c),S={};for(const o of s)Object.assign(S,D({block:b,getRecordModel:y,schema:n,propertyMapping:i,group:o,intl:d,userFilterContext:a,relativeVariableResult:l})),b=k(t,S);if(r){const e=F({block:b,schema:n,filter:r,propertyMapping:i,userFilterContext:a,relativeVariableResult:l,getRecordModel:c,intl:d}),o="failsFilter"===e.type||"coercedByFilter"===e.type?e.update??{}:{};Object.assign(S,o),b=k(t,S)}for(const o of s)Object.assign(S,D({block:b,getRecordModel:y,schema:n,propertyMapping:i,group:o,intl:d,userFilterContext:a,relativeVariableResult:l})),b=k(t,S);const _=k(b,S),w=u.yW(s.map((e=>{const t=C({group:e,schema:n,timeZone:f}),i=t?(0,o.q)({context:{schema:n,userId:m,userTimeZone:f,userStartOfWeek:h,relativeVariableResult:l,intl:d},filter:t}):void 0;return Boolean(i&&i({block:_,getRecordModel:c,propertyMapping:void 0}))}))),I=r?(0,o.q)({filter:r,context:{schema:n,userId:m,userTimeZone:f,userStartOfWeek:h,relativeVariableResult:l,intl:d}}):void 0,x=!I||I({block:_,getRecordModel:c,propertyMapping:void 0});return{coercionSucceeded:w&&x,update:S}}function C(e){const t=x(e);return t?(0,o.vA)(t)?t:{operator:"and",filters:[t]}:void 0}function x(e){const{schema:t,group:n,timeZone:o}=e,i=n.property,a=t[i];if(!a)return;const s=n.value;if((0,r.LG)(a)&&s.type===a.type){if(void 0===s.value)return{property:i,filter:{operator:"is_empty"}};if("select"===a.type)return"string"==typeof s.value?{property:i,filter:{operator:"enum_is",value:{type:"exact",value:s.value}}}:void 0;if("status"===a.type)return void 0!==s.value&&"status"===s.type?{property:i,filter:{operator:"status_is",value:"by_group"===s.value.type?{type:"is_group",value:s.value.group}:{type:"is_option",value:s.value.option}}}:void 0;if((0,r.pd)(a.type))return"object"==typeof s.value&&s.type===a.type?{property:i,filter:{operator:"person_contains",value:{type:"exact",value:s.value}}}:void 0;if("relation"===a.type)return"object"==typeof s.value&&"relation"===s.type?function(e,t){if((0,r.RA)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"exact",value:t.value.id}}};if((0,r.t2)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"builtin",variable:t.value.value.variable}}}}}(i,s):void 0;if("location"===a.type)return"object"==typeof s.value&&"location"===s.type?{property:i,filter:{operator:"location_is",value:{type:"exact",value:s.value.id}}}:void 0;if("multi_select"===a.type)return"string"==typeof s.value?{property:i,filter:{operator:"enum_contains",value:{type:"exact",value:s.value}}}:void 0;if((0,r.A1)(a.type)){if(s.type!==a.type)return;return T(s.value,n.property,o)}if((0,r.HB)(a.type)){if(s.type!==a.type)return;return M(s.value,n.property)}if("number"===a.type){if("number"!==s.type)return;return P(s.value,n.property)}if("checkbox"===a.type){if("checkbox"!==s.type)return;return{property:i,filter:{operator:"checkbox_is",value:{type:"exact",value:s.value}}}}if("formula"===a.type){if("formula"!==s.type)return;const e=s.value;if(void 0===e.value)return;if((0,r.R7)(e))return M(e.value,n.property);if("number"===e.type)return P(e.value,n.property);if("checkbox"===e.type)return{property:i,filter:{operator:"checkbox_is",value:{type:"exact",value:e.value}}};if((0,r.Mc)(e))return T(e.value,n.property,o);if((0,r.q6)(e))return function(e,t){return{property:e,filter:{operator:"person_contains",value:{type:"exact",value:t.value}}}}(n.property,e);if((0,r.tL)(e))return(0,r.RA)(e.value)?{property:i,filter:{operator:"relation_contains",value:{type:"exact",value:e.value.id}}}:void 0;(0,S.t1)(e)}(0,S.t1)(a.type)}}function T(e,t,n){const o=(0,r.Hk)(e,n);return{property:t,filter:{operator:"date_is_within",value:{type:"exact",value:c.OQ.toPersistedDateRange(o,n)}}}}function M(e,t){if("alphabet_prefix"===e.type){const n=e.value;return isNaN(parseInt(n))?{operator:"or",filters:[{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toUpperCase()}}},{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toLowerCase()}}}]}:{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value}}}}return"other"===e.type?{property:t,filter:{operator:"string_has_no_alphabet_prefix"}}:"exact"===e.type?{property:t,filter:{operator:"string_is",value:{type:"exact",value:e.value}}}:void(0,S.t1)(e)}function P(e,t){if("range"===e.type){const{start:n,end:o}=e;return{operator:"and",filters:[{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:n}}},{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:o}}}]}}if("out_of_range"===e.type){const{start:n,end:o}=e;return{operator:"or",filters:[{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:n}}},{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:o}}}]}}(0,S.t1)(e)}function A(e,t){const n=e.property,o=null==t?void 0:t[n];if(null!=o&&o.derived_property_record_metadata)return!1;if(o&&s.A0(o))return!1;const i=e.value;return!i.value||("select"===i.type||"multi_select"===i.type||"status"===i.type||"person"===i.type||"checkbox"===i.type||"relation"===i.type||"date"===i.type||"number"===i.type||((0,r.R7)(i)?"exact"===i.value.type:"formula"!==i.type&&"created_by"!==i.type&&"last_edited_by"!==i.type&&"created_time"!==i.type&&"last_edited_time"!==i.type&&"location"!==i.type&&"last_visited_time"!==i.type&&void(0,S.t1)(i.type)))}function R(e){const{schema:t,group:n,block:o}=e;if(!A(n,t))return{};const i=function(e){const{schema:t,group:n}=e,o=n.property,i=t[o];if(!i)return;const a=n.value;return(0,r.LG)(i)&&a.type===i.type&&void 0!==a.value?"person"===i.type?"object"==typeof a.value&&"person"===a.type?{property:o,filter:{operator:"person_does_not_contain",value:{type:"exact",value:a.value}}}:void 0:"relation"===i.type?"relation"===a.type&&(0,r.RA)(a.value)?{property:o,filter:{operator:"relation_does_not_contain",value:{type:"exact",value:a.value.id}}}:"relation"===a.type&&(0,r.t2)(a.value)?{property:o,filter:{operator:"relation_does_not_contain",value:{type:"relative",value:{type:"builtin",variable:a.value.value.variable}}}}:void 0:"location"===i.type?"object"==typeof a.value&&"location"===a.type?{property:o,filter:{operator:"location_is_not",value:{type:"exact",value:a.value.id}}}:void 0:"multi_select"===i.type?"string"==typeof a.value?{property:o,filter:{operator:"enum_does_not_contain",value:{type:"exact",value:a.value}}}:void 0:void("select"!==i.type&&"status"!==i.type&&"checkbox"!==i.type&&"date"!==i.type&&"text"!==i.type&&"title"!==i.type&&"url"!==i.type&&"email"!==i.type&&"phone_number"!==i.type&&"number"!==i.type&&"formula"!==i.type&&"created_by"!==i.type&&"last_edited_by"!==i.type&&"created_time"!==i.type&&"last_edited_time"!==i.type&&"last_visited_time"!==i.type&&(0,S.t1)(i)):void 0}({schema:t,group:n});if(!i)return{};const a=Z({...e,property:i.property,filter:i.filter,schema:t,block:o});return("failsFilter"===a.type||"coercedByFilter"===a.type)&&a.update||{}}function D(e){const{schema:t,group:n,block:i,userFilterContext:r}=e,{userTimeZone:a}=r;if(!A(n,t))return{};const s=x({schema:t,group:n,timeZone:a});if(!s||!(0,o.aN)(s))return{};const l=Z({...e,property:s.property,filter:s.filter,schema:t,block:i});return("failsFilter"===l.type||"coercedByFilter"===l.type)&&l.update||{}}function B(e){const{dateValue:t,timestamp:n,userTimeZone:o}=e;if("date"===t.type)return{...c.hT(n,o),reminder:t.reminder};if("datetime"===t.type)return{...c.CQ(n,o),reminder:t.reminder};if("daterange"===t.type){const e=c.DF(l.Nh(t),o).valueOf(),i=c.DF(l.v3(t),o).valueOf()-e;return{...c.fZ(n,n+i,o),reminder:t.reminder}}if("datetimerange"===t.type){const e=c.Sy(l.C1(t)).valueOf(),i=c.Sy(l.C1(t)).valueOf()-e;return{...c.iC(n,n+i,o),reminder:t.reminder}}(0,S.t1)(t)}const E={text:function(e){const{filter:t,value:n}=e;if("is_empty"===t.operator)return{type:"text",value:void 0};if("is_not_empty"===t.operator)return;if("string_has_no_alphabet_prefix"===t.operator)return;const o=(t.value.value||"").trim();return"string_is_not"===t.operator||"string_does_not_contain"===t.operator?{type:"text",value:void 0}:"string_is"===t.operator?{type:"text",value:o}:"string_contains"===t.operator||"string_ends_with"===t.operator?{type:"text",value:(n.value||"")+o}:"string_starts_with"===t.operator?{type:"text",value:o+(n.value||"")}:void(0,S.t1)(t.operator)},checkbox:function(e){const{filter:t}=e,n=t.value;return"checkbox_is"===t.operator?{type:"checkbox",value:Boolean(n.value)}:"checkbox_is_not"===t.operator?{type:"checkbox",value:!Boolean(n.value)}:void(0,S.t1)(t.operator)},select:function(e){var t;const{filter:n,propertySchema:i}=e;if("is_empty"===n.operator)return{type:"select",value:void 0};if("is_not_empty"===n.operator)return{type:"select",value:i.options&&i.options.length>0?i.options[0].value:void 0};const r=null===(t=(0,o.mg)(n)[0])||void 0===t?void 0:t.value;return void 0!==r?"enum_is"===n.operator?{type:"select",value:r}:"enum_is_not"===n.operator?{type:"select",value:void 0}:void(0,S.t1)(n.operator):void 0},multi_select:function(e){var t;const{filter:n,propertySchema:i,value:r}=e;if("is_empty"===n.operator)return{type:"multi_select",value:void 0};if("is_not_empty"===n.operator)return{type:"multi_select",value:i.options&&i.options.length>0?[i.options[0].value]:void 0};const a=null===(t=(0,o.qC)(n)[0])||void 0===t?void 0:t.value;if(void 0===a)return;const s=r.value||[];return"enum_contains"===n.operator?{type:"multi_select",value:[...s,a]}:"enum_does_not_contain"===n.operator?{type:"multi_select",value:s.filter((e=>e!==a))}:void(0,S.t1)(n.operator)},status:function(e){const{filter:t,propertySchema:n}=e,i=n.groups??[],r=n.options??[];if("is_empty"===t.operator)return{type:"status",option:void 0,group:void 0};if("is_not_empty"===t.operator)return{type:"status",option:n.options&&n.options.length>0?n.options[0].value:void 0,group:n.groups&&n.groups.length>0?n.groups[0].name:void 0};const a=(0,o.wB)(t);if(0===a.length)return;const s=i.map((e=>{const t=r.filter((t=>{var n;return null===(n=e.optionIds)||void 0===n?void 0:n.includes(t.id)}));return{group:e,groupOptions:t}}));if("status_is"===t.operator){const{type:e,value:t}=a[0];if("is_group"===e){var l;const e=i.findIndex((e=>e.name===t)),n=e>=0?s[e]:void 0;return{type:"status",group:null==n?void 0:n.group.name,option:null==n||null===(l=n.groupOptions[0])||void 0===l?void 0:l.value}}if("is_option"===e){const e=r.find((e=>e.value===t)),n=e&&i.find((t=>{var n;return null===(n=t.optionIds)||void 0===n?void 0:n.includes(e.id)}));return{type:"status",group:null==n?void 0:n.name,option:null==e?void 0:e.value}}(0,S.t1)(e)}if("status_is_not"===t.operator)return{type:"status",group:void 0,option:void 0};(0,S.t1)(t.operator)},relation:function(e){var t;const{filter:n,value:i,propertySchema:r,relativeVariableResult:a}=e;if("is_empty"===n.operator)return{type:"relation",value:void 0};if("is_not_empty"===n.operator)return;const s=(0,o.YO)(n),l=null===(t=s[0])||void 0===t?void 0:t.type;let c;var d;if("exact"===l)c=null===(d=s[0])||void 0===d?void 0:d.value;else if("relative"===l){var u,p;const e=null===(u=r.collection_pointer)||void 0===u?void 0:u.id;if(!e||!a)return;c=a[e][null===(p=s[0])||void 0===p?void 0:p.value.variable]}if(void 0===c)return;const m=i.value||[];return"relation_contains"===n.operator?{type:"relation",value:[...m,{id:c,table:v.iU,spaceId:0!==m.length?m[0].spaceId:void 0}]}:"relation_does_not_contain"===n.operator?{type:"relation",value:m.filter((e=>e.id!==c))}:void(0,S.t1)(n.operator)},person:function(e){const{filter:t,userFilterContext:n,value:i}=e,{userId:r}=n;if("is_empty"===t.operator)return{type:"person",value:void 0};if("is_not_empty"===t.operator)return r?{type:"person",value:[{table:b.KJ,id:r}]}:void 0;const a=(0,o.R8)(t)[0];if(!a)return;const s=(0,o.l$)({operatorValue:a,userId:r});if(void 0===s)return;const l=i.value||[];return"person_contains"===t.operator?{type:"person",value:[...l,s]}:"person_does_not_contain"===t.operator?{type:"person",value:l.filter((e=>!u.Xy(e,s)))}:void(0,S.t1)(t.operator)},number:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"number",value:void 0};if("is_not_empty"===t.operator)return{type:"number",value:0};const n=t.value.value;return void 0===n||u.i2(n)?void 0:"number_equals"===t.operator||"number_greater_than_or_equal_to"===t.operator||"number_less_than_or_equal_to"===t.operator?{type:"number",value:n}:"number_less_than"===t.operator?{type:"number",value:n-1}:"number_greater_than"===t.operator?{type:"number",value:n+1}:"number_does_not_equal"===t.operator?{type:"number",value:void 0}:void(0,S.t1)(t.operator)},date:function(e){const{filter:t,userFilterContext:n,value:i}=e,{userTimeZone:r,userStartOfWeek:a}=n;if("is_empty"===t.operator)return{type:"date",value:void 0};if("is_not_empty"===t.operator)return{type:"date",value:c.Lg(r)};const s=i.value;if((0,o.TQ)(t)){const e=(0,o.sw)({operatorValue:t.value,userTimeZone:r,userStartOfWeek:a});if(void 0===s){const t=c.Lg(r),n=c.NK(t,r).start.valueOf();return void 0!==e.start&&void 0!==e.end&&n>=e.start&&n<=e.end?{type:"date",value:t}:void 0!==e.start?{type:"date",value:c.hT(e.start,r)}:void 0!==e.end?{type:"date",value:c.hT(e.end,r)}:void 0}const n=c.NK(s,r).start.valueOf();return void 0!==e.end&&n>e.end?{type:"date",value:B({dateValue:s,timestamp:e.end,userTimeZone:r})}:void 0!==e.start&&n<e.start?{type:"date",value:B({dateValue:s,timestamp:e.start,userTimeZone:r})}:void 0}const l=t.value,d=(0,o.og)({operatorValue:l,userTimeZone:r});if(void 0!==d){if("date_is"===t.operator||"date_is_on_or_before"===t.operator||"date_is_on_or_after"===t.operator)return s?{type:"date",value:B({dateValue:s,timestamp:d,userTimeZone:r})}:{type:"date",value:c.hT(d,r)};if("date_is_before"===t.operator){const e=c.Xz({date:d,daysToAdd:-1});return s?{type:"date",value:B({dateValue:s,timestamp:e,userTimeZone:r})}:{type:"date",value:c.hT(e,r)}}if("date_is_after"===t.operator){const e=c.Xz({date:d,daysToAdd:1});return s?{type:"date",value:B({dateValue:s,timestamp:e,userTimeZone:r})}:{type:"date",value:c.hT(e,r)}}(0,S.t1)(t.operator)}},file:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"file",value:void 0};"is_not_empty"!==t.operator&&(0,S.t1)(t)},location:()=>{},verification:function(e){const{filter:t}=e;if("verification_is"===t.operator)return{type:"verification",value:void 0};"verification_is_not"!==t.operator&&(0,S.t1)(t.operator)}};function F(e){const{filter:t,block:n,schema:i,propertyMapping:r,userFilterContext:a,relativeVariableResult:s,getRecordModel:l,intl:c}=e,{userId:d,userTimeZone:u,userStartOfWeek:m}=a,f=t.filters||[];if(0===f.length)return{type:"passesFilter"};if((0,o.q)({context:{schema:i,userId:d,userTimeZone:u,userStartOfWeek:m,relativeVariableResult:s,intl:c},filter:t})({block:n,getRecordModel:l,propertyMapping:void 0}))return{type:"passesFilter"};if("or"===t.operator){const e=f.map((e=>(0,o.aN)(e)?Z({intl:c,block:n,schema:i,propertyMapping:r,property:e.property,filter:e.filter,userFilterContext:a,getRecordModel:l,relativeVariableResult:s}):(0,o.Mm)(e)?{type:"failsFilter"}:(0,o.vA)(e)?F({filter:e,intl:c,block:n,schema:i,propertyMapping:r,userFilterContext:a,relativeVariableResult:s,getRecordModel:l}):void(0,S.t1)(e)));if(e.some((e=>"passesFilter"===e.type)))return{type:"passesFilter"};const t=e.find((e=>"coercedByFilter"===e.type));return t||(e.find((e=>"failsFilter"===e.type))||{type:"failsFilter"})}const h=[...f];h.reverse();let b="passesFilter";const y={};let _=n;const w=p.om.tryUntilFound(p.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===v.iU&&n===_.id)return _}),g.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===v.iU&&n===_.id)return _.__IM_SORRY__getValue()}))),l);for(const p of h){if((0,o.Mm)(p))continue;const e=(0,o.aN)(p)?Z({intl:c,block:_,schema:i,propertyMapping:r,property:p.property,filter:p.filter,userFilterContext:a,getRecordModel:w,relativeVariableResult:s}):F({filter:p,intl:c,block:_,schema:i,propertyMapping:r,userFilterContext:a,relativeVariableResult:s,getRecordModel:w});"coercedByFilter"===e.type&&"passesFilter"===b&&(b="coercedByFilter"),"failsFilter"===e.type&&(b="failsFilter"),("coercedByFilter"===e.type||"failsFilter"===e.type&&e.update)&&(Object.assign(y,e.update),_=k(n,y))}return"passesFilter"===b?{type:b}:{type:b,update:y}}function Z(e){const{filter:t,block:n,property:r,schema:a,propertyMapping:l,userFilterContext:c,getRecordModel:d,relativeVariableResult:u,intl:p}=e,{userId:m,userTimeZone:f,userStartOfWeek:g}=c;if((0,o.Y1)({context:{schema:a,userId:m,userTimeZone:f,userStartOfWeek:g,relativeVariableResult:u,intl:p},filter:t,property:r,depth:0})({block:n,getRecordModel:d,propertyMapping:l}))return{type:"passesFilter"};if((0,o.a_)(t))return{type:"failsFilter"};const h=a[r];if(!h)return{type:"failsFilter"};if(!(0,i.BJ)(h))return{type:"failsFilter"};const v=(0,i.vc)(h.type),b=(0,i.ML)({filterValueType:v,block:n,propertyValue:s.wS(n,r,d),propertySchema:h,getRecordModel:d,collectionRequestContext:{userId:m,userTimeZone:f,intl:p,depth:0,visitedProperties:new Set,resultCache:{}}}),y=(0,E[v])({filter:t,value:b,propertySchema:h,userFilterContext:c,relativeVariableResult:u});if(void 0===y)return{type:"failsFilter"};const S=(0,i.qg)({propertyType:h.type,filterValue:y});return{type:"coercedByFilter",update:{[(null==l?void 0:l[r])??r]:S}}}function L(e){const{blockProperties:t,oldSchema:n,newSchema:o}=e,i=Object.keys(n),r=Object.keys(o),a={propertyUpdate:function(e){const{blockProperties:t,oldSchema:n,newSchema:o}=e,i={},r=null==t?void 0:t.title,a=y.lcG(r),[s]=y.nai(r),{person:[l],date:[c]}=_(o),{person:[u],date:[p]}=_(n);if(l&&(null==t||!t[l])&&!u&&a.length>0){const e=Array.from(new Set(a));i[l]=(0,d.Z)(e.map((e=>y.YCD(y.tEo(e)))),(()=>w))}return!c||null!=t&&t[c]||p||!s||(i[c]=[y.YCD(y.pZr(s))]),i}({blockProperties:t,oldSchema:n,newSchema:o}),newSchema:o},s=["relation","auto_increment_id","verification"];for(const l of i){const e=n[l],i=null==t?void 0:t[l];if(e&&!s.includes(e.type)&&i){const i=r.find((e=>l===e))||r.find((t=>{const n=o[t];return Boolean(e&&n&&e.name.trim().toLowerCase()===n.name.trim().toLowerCase()&&e.type===n.type)}));if(i&&a.propertyUpdate)i!==l&&(a.propertyUpdate[i]=t[l]||null,a.propertyUpdate[l]=null);else{const e=(0,f.ZP)(),o=n[l];a.newSchema={...a.newSchema,[e]:o},a.propertyUpdate&&(a.propertyUpdate[e]=t[l]||null,a.propertyUpdate[l]=null)}}}return a}function j(e){const{block:t,schema:n,property:o,oldValue:i,newValue:a}=e;if(void 0===i.value)return{};if(void 0===a.value)return{};const l=t.getProperties();if(!l)return{};const c=l[o];if(!c)return{};const d=n[o];if(!d)return{};if(!(0,r.LG)(d))return{};if("status"===d.type||"select"===d.type||"multi_select"===d.type||"checkbox"===d.type)return function(e){const{propertySchema:t,property:n,oldValue:o,newValue:i,propertyValue:a}=e;if(void 0===o.value)return{};if(void 0===i.value)return{};if(!(0,r.LG)(t))return{};if("select"===t.type){if("select"!==o.type||"select"!==i.type)return{};if(void 0===i.value)return{};const e=s.Ak(a);return 0===e.length&&void 0===o.value||e.some((e=>(e||"").trim().toLowerCase()===(o.value||"").trim().toLowerCase()))?{[n]:s.O2(i.value)}:{}}if("multi_select"===t.type){if("multi_select"!==o.type||"multi_select"!==i.type)return{};if(void 0===i.value)return{};const e=s.Ak(a);if(!e.some((e=>e.trim().toLowerCase()===(o.value||"").trim().toLowerCase())))return{};const t=i.value,r=e.map((e=>e.trim().toLowerCase()===(o.value||"").trim().toLowerCase()?t:e));return{[n]:s.zq(r)}}if("status"===t.type){const e=t.groups??[],r=t.options??[];if("checkbox"===o.type&&"status"===i.type){if(s.Ml(a)!==o.value)return{};let t;if("by_group"===i.value.type){const n=i.value.group,o=e.find((e=>e.name===n)),a=r.find((e=>{var t;return e.id===(null==o||null===(t=o.optionIds)||void 0===t?void 0:t[0])}));t=null==a?void 0:a.value}else t=i.value.option;if(t)return{[n]:s.Is(t)}}var l;return"status"===o.type&&"status"===i.type?"by_option"!==o.value.type||"by_option"!==i.value.type||(null===(l=s.Ak(a))||void 0===l?void 0:l[0])!==o.value.option?{}:{[n]:s.Is(i.value.option)}:{}}if("checkbox"===t.type)return"status"!==o.type||"checkbox"!==i.type||"by_option"!==o.value.type?{}:s.Ak(a).includes(o.value.option)?{[n]:s._I(i.value)}:{};(0,S.t1)(t)}({propertySchema:d,property:o,propertyValue:c,oldValue:i,newValue:a});if("person"===d.type){if("person"!==i.type||"person"!==a.type)return{};if(void 0===i.value)return{};if(void 0===a.value)return{};const e=a.value,n=i.value,r=p.kk.fromBlock(t),l=s.DW({textValue:c,propertySchema:d,blockCreatorPointer:r.getCreatedByPointer()});if(!l.some((e=>u.Xy(e,n))))return{};const m=l.map((t=>u.Xy(t,n)?e:t));return{[o]:s.C1(m)}}if("relation"===d.type){if("relation"!==i.type||"relation"!==a.type||void 0===i.value||void 0===a.value)return{};if((0,r.t2)(i.value)||(0,r.t2)(a.value))return{};const e=a.value,t=i.value,n=s.rq(c);if(!n.some((e=>(0,h.qo)(e,t))))return{};const l=n.map((n=>(0,h.qo)(n,t)?e:n));return{[o]:s.ow(l)}}if((0,r.HB)(d.type)){if(i.type!==d.type||a.type!==d.type||void 0===i.value||void 0===a.value||"exact"!==i.value.type||"exact"!==a.value.type)return{};return y.QaF(c)!==i.value.value?{}:{[o]:(0,y.TPx)(a.value.value)}}if("date"===d.type||"number"===d.type||"formula"===d.type||"created_by"===d.type||"last_edited_by"===d.type||"created_time"===d.type||"last_edited_time"===d.type||"location"===d.type||"last_visited_time"===d.type)return{};(0,S.t1)(d.type)}function V(e){const{block:t,schema:n,property:i,value:a,timeZone:s,intl:l,getRecordModel:d}=e,u=n[i];if(!u||!(0,r.LG)(u)||t.is_template)return!1;const p=x({schema:n,group:{property:i,value:a},timeZone:s});if(!p)return!1;return(0,o.q)({filter:{operator:"and",filters:[p]},context:{schema:n,intl:l,userId:void 0,userTimeZone:"UTC",userStartOfWeek:(0,c.aN)(),relativeVariableResult:void 0}})({block:t,getRecordModel:d,propertyMapping:void 0})}const U={Todo:"To-do","To-do":"To-do","To do":"To-do","Not started":"To-do",Backlog:"To-do",Incomplete:"To-do",Waiting:"To-do","On hold":"To-do",Later:"To-do",Blocked:"To-do","In progress":"In progress",Building:"In progress",Designing:"In progress",Research:"In progress",Scoping:"In progress",Planning:"In progress","Needs review":"In progress",Reviewed:"In progress",Review:"In progress",Pending:"In progress",Recurring:"In progress","Review needed":"In progress","Edits needed":"In progress",Editing:"In progress",Complete:"Complete",Completed:"Complete",Done:"Complete",Finished:"Complete",Archive:"Complete",Archived:"Complete",Deleted:"Complete",Published:"Complete",Reverted:"Complete"};function O(e,t){var n,o;const i=(0,a.I4)(e),r=i.groups??[],s=i.options??[],l=u.Cw(U,((e,t)=>t.toLowerCase())),c=new Set,d=new Set;for(const a of t){const e=s.findIndex((e=>e.value.toLowerCase()===a.value.toLowerCase()));if(e>-1){const t=s[e];if(!c.has(t.id)){d.add(a.id),c.add(t.id),s[e]={...a,id:t.id};continue}}const t=l[a.value.toLowerCase()],n=r.find((e=>e.name===t));var p;if(n)null===(p=n.optionIds)||void 0===p||p.push(a.id),d.add(a.id)}for(const[a,u]of r.entries()){var m;const e=null===(m=u.optionIds)||void 0===m?void 0:m.some((e=>d.has(e)));u.optionIds=(u.optionIds??[]).filter((t=>!(!d.has(t)&&!c.has(t))||!e))}null==r||null===(n=r[0].optionIds)||void 0===n||n.push(...t.filter((e=>!d.has(e.id))).map((e=>e.id)));const f=[...s,...t],g=[];for(const a of r)for(const e of a.optionIds??[]){const t=f.find((t=>t.id===e));t&&g.push(t)}const h=null===(o=g.find((e=>{var t;return(null===(t=i.groups)||void 0===t||null===(t=t[0].optionIds)||void 0===t?void 0:t[0])===e.id})))||void 0===o?void 0:o.value;return{type:"status",name:e,groups:r,options:g,defaultOption:h}}},34296:(e,t,n)=>{n.d(t,{S:()=>o});let o=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({})},63144:(e,t,n)=>{n.d(t,{P:()=>i});var o=n(72126);function i(e,t){return t.getAlive()!==e.getAlive()||!o.Xy(t.getText(),e.getText())||!o.Xy(t.getContent(),e.getContent())}},1274:(e,t,n)=>{n.d(t,{IC:()=>c,bM:()=>u,fz:()=>d,o0:()=>p});n(57658);var o=n(21202),i=n(77420),r=n(6287),a=n(13493),s=n(15047),l=n(97880);function c(e){const{targetTriggerType:t,targetParentPointer:n,targetSpaceId:o}=e;return"notification_event"===t||"event"===t?[{pointer:n,minimumRequiredRole:"editor"},{pointer:{id:o,table:s.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===t||"button"===t?[{pointer:n,minimumRequiredRole:"read_and_write"}]:void(0,l.t1)(t)}function d(e){const{automationValue:t,actionValues:n}=e,o=n.flatMap((e=>p(e))).filter(l.$K);return"notification_event"===t.trigger.type||"event"===t.trigger.type?(o.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"editor"},{pointer:{id:t.space_id,table:s.bx},minimumRequiredRole:"read_and_write"}),(0,l.$K)(t.trigger.event.source)&&(t.trigger.event.source.type===a.n||t.trigger.event.source.type===r.v?o.push({pointer:t.trigger.event.source.pointer,minimumRequiredRole:"reader"}):"filter"===t.trigger.event.source.type||(0,l.t1)(t.trigger.event.source))):"recurrence"===t.trigger.type||"button"===t.trigger.type?o.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"read_and_write"}):(0,l.t1)(t.trigger),o}function u(e){return"notification_event"===e.trigger.type||"event"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"editor"},{pointer:{id:e.space_id,table:s.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===e.trigger.type||"button"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"read_and_write"}]:void(0,l.t1)(e.trigger)}function p(e){if("create_page"===e.type){var t,n;const i=[];var r,a;if(null!==(t=e.config)&&void 0!==t&&t.collection)i.push({pointer:null===(r=e.config)||void 0===r?void 0:r.collection,minimumRequiredRole:"content_only_editor"});if(null!==(n=e.config)&&void 0!==n&&n.template_page_id)i.push({pointer:{id:null===(a=e.config)||void 0===a?void 0:a.template_page_id,table:o.iU,spaceId:e.space_id},minimumRequiredRole:"reader"});return i}var s,c;if("query_collection"===e.type){if(null!==(s=e.config)&&void 0!==s&&s.collection)return[{pointer:null===(c=e.config)||void 0===c?void 0:c.collection,minimumRequiredRole:"content_only_editor"}]}else if("update_pages"===e.type){var d;const t=null===(d=e.config)||void 0===d?void 0:d.target;if(!t)return[];if("collection"===t.type)return[{pointer:t.collection,minimumRequiredRole:"content_only_editor"}];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"content_only_editor"}];if("variable"===t.type)return[];(0,l.t1)(t)}else if("open_page"===e.type){var u;const t=null===(u=e.config)||void 0===u?void 0:u.target;if(!t)return[];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"reader"}];if("variable"===t.type)return[];(0,l.t1)(t)}else if("slack_notification"===e.type){var p;if(null!==(p=e.config)&&void 0!==p&&p.external_bot_id)return[{pointer:{id:e.config.external_bot_id,table:i.cZ},minimumRequiredRole:"editor"}]}else{if("duplicate_blocks"===e.type)return[];if("modal_confirmation"===e.type)return[];(0,l.t1)(e)}}},86658:(e,t,n)=>{n.d(t,{Fd:()=>c,G_:()=>l,UE:()=>d,cW:()=>u,fV:()=>r,ze:()=>a});n(67294);var o=n(5366),i=n(85893);const r="v8",a=(0,o.defineMessages)({cookieSettingsLabel:{id:"cookieConsent.settings.label",defaultMessage:"Cookie settings"},customizeCookiesHeader:{id:"cookieConsent.customizeCookies.header",defaultMessage:"Customize cookies"},trackingTypeNecessaryTitle:{id:"cookieConsent.trackingTypeNecessary.title",defaultMessage:"Strictly necessary"},trackingTypeNecessaryCaption:{id:"cookieConsent.trackingTypeNecessary.caption",defaultMessage:"Essential for the site to function. Always On."},trackingTypePreferenceTitle:{id:"cookieConsent.trackingTypePreference.title",defaultMessage:"Functional"},trackingTypePreferenceCaption:{id:"cookieConsent.trackingTypePreference.caption",defaultMessage:"Used to remember preference selections and provide enhanced features."},trackingTypePerformanceTitle:{id:"cookieConsent.trackingTypePerformance.title",defaultMessage:"Analytics"},trackingTypePerformanceCaption:{id:"cookieConsent.trackingTypePerformance.caption",defaultMessage:"Used to measure usage and improve your experience."},trackingTypeTargetingTitle:{id:"cookieConsent.trackingTypeTargeting.title",defaultMessage:"Marketing"},trackingTypeTargetingCaption:{id:"cookieConsent.trackingTypeTargeting.caption",defaultMessage:"Used for targeted advertising."},trackingTypeTargetingSubtitleiOS:{id:"cookieConsent.trackingTypeTargeting.subtitleiOS",defaultMessage:"Not collected nor used within the iOS app"},cookieDismissButtonLabel:{id:"cookieConsent.dismissButton.label",defaultMessage:"Done"},acceptAllButtonLabel:{id:"cookieConsent.acceptAllButton.label",defaultMessage:"Accept all"},rejectAllButtonLabel:{id:"cookieConsent.rejectAllButton.label",defaultMessage:"Reject all"},moreOptionsButtonLabel:{id:"cookieConsent.moreOptionsButton.label",defaultMessage:"More options"},reloadAfterSaveMessage:{id:"cookieConsent.reloadAfterSave.message",defaultMessage:"Notion will now reload to apply your cookie preferences. Click okay to continue."}}),s=(0,o.defineMessages)({banner:{id:"cookieConsent.bannerDisclaimer.message",defaultMessage:"Notion uses cookies to offer you a better experience. See<cookielink>Cookie Notice</cookielink>for details."},settings:{id:"cookieConsent.settingsDisclaimer.message",defaultMessage:"Customize cookies. See<cookielink>Cookie Notice</cookielink>for details."},snackbar:{id:"cookieConsent.snackbarDisclaimer.message",defaultMessage:"Notion uses cookies. See<cookielink>Cookie Notice</cookielink>for details."}});function l(e,t){switch(e){case"necessary":return{title:a.trackingTypeNecessaryTitle,caption:a.trackingTypeNecessaryCaption};case"preference":return{title:a.trackingTypePreferenceTitle,caption:a.trackingTypePreferenceCaption};case"performance":return{title:a.trackingTypePerformanceTitle,caption:a.trackingTypePerformanceCaption};case"targeting":const e=t?a.trackingTypeTargetingSubtitleiOS:void 0;return{title:a.trackingTypeTargetingTitle,subtitle:e,caption:a.trackingTypeTargetingCaption}}}function c(e,t){return(0,i.jsx)(o.FormattedMessage,{...s[t],values:{cookielink:t=>(0,i.jsxs)(i.Fragment,{children:[" ",e("https://www.notion.so/Cookie-Notice-bc186044eed5488a8387a9e94b14e58c",t)," "]})}})}const d={necessary:!0,performance:!0,preference:!0,targeting:!0},u={necessary:!0,performance:!1,preference:!1,targeting:!1}},57081:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(72126),i=n(70203),r=n(97880),a=n(82798),s=n(59579);class l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.ops=e,function(e){for(let t=1;t<e.length;t++)(0,a.T)((0,s.$)(e[t-1].id,e[t].id)<0)}(e)}add(e){const t=this.findInsertionIndex(e.id);this.ops.splice(t,0,e)}findInsertionIndex(e){const t=this.ops.findIndex((t=>(0,s.$)(t.id,e)>0));return t>=0?t:this.ops.length}getOps(){return this.ops}getResolvedAnnotations(){const e=new Map;for(const t of this.ops){const n=t.type;"addAnnotation"===n?e.set(i.XSJ(t.annotation),t.annotation):"removeAnnotation"===n?e.delete(i.XSJ(t.annotationKey)):(0,r.t1)(n)}return[...e.values()]}containsOpId(e){return this.ops.some((t=>o.Xy(t.id,e)))}clone(){return new l([...this.ops])}equals(e){return o.Xy(this.ops,e.ops)}static equals(e,t){return e===t||(void 0===e||void 0===t?e===t:e.equals(t))}}},43993:(e,t,n)=>{n.d(t,{JE:()=>p,Jy:()=>c,KH:()=>u,vM:()=>d});var o=n(72126),i=n(70203),r=n(97880),a=n(82798),s=n(57081);class l{constructor(e){this.prev=void 0,this.next=void 0,this.annotationOpSetBefore=void 0,this.annotationOpSetAfter=void 0,this.id=e}startsWithId(e){return this.containsId(e)}endsWithId(e){return this.containsId(e)}containsId(e){return o.Xy(this.id,e)}getAnnotationOpSetForAnchor(e){return"before"===e?this.annotationOpSetBefore:"after"===e?this.annotationOpSetAfter:void(0,r.t1)(e)}maybeCreateAnnotationOpSetForAnchor(e,t){var n;if("before"===e)this.annotationOpSetBefore??=(null==t||null===(n=t.opSet)||void 0===n?void 0:n.clone())??new s.Z;else if("after"===e){var o;this.annotationOpSetAfter??=(null==t||null===(o=t.opSet)||void 0===o?void 0:o.clone())??new s.Z}else(0,r.t1)(e)}copyAnnotationOpSetTo(e){this.annotationOpSetBefore&&(e.annotationOpSetBefore=this.annotationOpSetBefore.clone()),this.annotationOpSetAfter&&(e.annotationOpSetAfter=this.annotationOpSetAfter.clone())}equals(e){return typeof this==typeof e&&s.Z.equals(this.annotationOpSetBefore,e.annotationOpSetBefore)&&s.Z.equals(this.annotationOpSetAfter,e.annotationOpSetAfter)}toString(){return`[${this.className}]`}}class c extends l{constructor(e,t,n,o){super(e),this.className="TextItem",this.deleted=!1,this.id=e,this.originId=t,this.content=n,this.length=o,this.verifyValueAndLength()}verifyValueAndLength(){(0,a.T)(!this.content||this.content.length===this.length,"TextItem content length must match item length"),(0,a.T)(this.length>0,"TextItem must have nonzero length"),(0,a.T)(!this.content||!(0,i.XoU)(this.content),"TextItem must not contain disallowed characters")}getStartId(){return this.id}getEndId(){const e=this.id;return[e[0],e[1]+this.length-1]}startsWithId(e){return o.Xy(this.getStartId(),e)}endsWithId(e){return o.Xy(this.getEndId(),e)}containsId(e){return"start"!==e&&"end"!==e&&this.id[0]===e[0]&&this.id[1]<=e[1]&&e[1]<=this.id[1]+this.length-1}getDefinedContent(){return(0,a.TO)(this.content)}isDeleted(){return this.deleted}setDeleted(){this.deleted=!0,this.content=void 0}splitBeforeId(e){return this.split(e,"before")}splitAfterId(e){return this.split(e,"after")}split(e,t){var n;(0,a.T)(this.length>1),(0,a.T)(this.containsId(e));const o=e[1]-this.id[1]+("after"===t?1:0);(0,a.T)(0<o&&o<this.length);const i=[this.id[0],this.id[1]+o],r=[this.id[0],this.id[1]+o-1],s=this.deleted?c.createDeleted(i,r,this.length-o):c.create(i,r,this.getDefinedContent().slice(o));this.annotationOpSetAfter&&(s.annotationOpSetAfter=this.annotationOpSetAfter.clone());const l=this.next;return this.next=s,s.prev=this,l&&(s.next=l,l.prev=s),this.content=null===(n=this.content)||void 0===n?void 0:n.slice(0,o),this.length=o,this.verifyValueAndLength(),this.annotationOpSetAfter=void 0,this.next=s,s}maybeMergeWithNext(){const e=this.next;if(!(e instanceof c))return!1;const t=this.getEndId(),n=e.getStartId();return!(!o.Xy(t,e.originId)||t[0]!==n[0]||t[1]!==n[1]-1||this.deleted!==e.deleted||void 0!==this.annotationOpSetAfter||void 0!==e.annotationOpSetBefore)&&(this.content&&e.content&&(this.content+=e.content),this.length+=e.length,this.verifyValueAndLength(),e.annotationOpSetAfter&&(this.annotationOpSetAfter=e.annotationOpSetAfter.clone()),this.next=e.next,e.next&&(e.next.prev=this),e.prev=void 0,e.next=void 0,!0)}getLength(){return this.length}clone(){const e=this.deleted?c.createDeleted(this.id,this.originId,this.length):c.create(this.id,this.originId,this.getDefinedContent());return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof c&&o.Xy(this.id,e.id)&&o.Xy(this.originId,e.originId)&&this.deleted===e.deleted&&this.content===e.content&&this.length===e.length}static create(e,t,n){return new c(e,t,n,n.length)}static createDeleted(e,t,n){const o=new c(e,t,void 0,n);return o.setDeleted(),o}toString(){return this.deleted?`[${this.className} (deleted)]`:`[${this.className} ${this.content}]`}}class d extends l{constructor(){super("start"),this.className="StartItem"}clone(){const e=new d;return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof d}}class u extends l{constructor(){super("end"),this.className="EndItem",this.originId="start"}clone(){const e=new u;return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof u}}class p extends l{constructor(e,t){super(e),this.className="SplitItem",this.id=e,this.originId=t}clone(){const e=new p(this.id,this.originId);return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof p&&o.Xy(this.id,e.id)&&o.Xy(this.originId,e.originId)}}},19056:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(82798);class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.value=e}get(){return this.value}set(e){this.value=e}}class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.valueHolder=void 0,this.valueHolder="number"==typeof e?new i(e):e,(0,o.T)(this.valueHolder.get()>=0)}reserveTicks(e){(0,o.T)(e>0);const t=this.valueHolder.get(),n=t+1;return this.valueHolder.set(t+e),n}maybeUpdateClock(e){return e>this.valueHolder.get()&&(this.valueHolder.set(e),!0)}getValue(){return this.valueHolder.get()}}},69920:(e,t,n)=>{n.d(t,{Z:()=>y,G:()=>g});n(21703),n(52262),n(24506),n(57658);var o=n(67266),i=n.n(o),r=n(72126),a=n(4615),s=n(70203),l=n(97880),c=n(82798),d=n(59579),u=n(43993),p=n(52136),m=n(19056);function f(e){switch(e.type){case"insertText":return e.id[1]+e.content.length-1;case"splitText":case"addAnnotation":case"removeAnnotation":return e.id[1]}}const g=(0,l.AO)((e=>e instanceof u.vM||e instanceof u.JE?{true:e}:{false:e})),h=(0,l.AO)((e=>e instanceof u.KH||e instanceof u.JE?{true:e}:{false:e})),v=(0,l.AO)((e=>e instanceof u.Jy?{true:e}:{false:e})),b=(0,l.AO)((e=>"end"===e?{false:e}:{true:e}));class y{constructor(e,t,n){this.textInstanceId=void 0,this.opClock=void 0,this.startItem=void 0,this.endItem=void 0,this.visibleCount=void 0,this.textInstanceId=e,this.opClock=t,this.startItem=n,this.endItem=(0,c.Fb)(p.s(n),h),this.visibleCount=p.TS(n),(0,c.T)(this.startItem!==this.endItem)}getStartItem(){return this.startItem}getEndItem(){return this.endItem}getVisibleCount(){return this.visibleCount}applyOperation(e){switch(e.type){case"insertText":this.applyInsertTextOperation(e);break;case"deleteText":this.applyDeleteTextOperation(e);break;case"splitText":this.applySplitTextOperation(e);break;case"addAnnotation":case"removeAnnotation":this.applyAnnotationOperation(e);break;default:(0,l.t1)(e)}}applyInsertTextOperation(e){const t=u.Jy.create(e.id,e.originId,e.content);this.integrateItem(t),this.opClock.maybeUpdateClock(f(e)),this.validateContent()}applyDeleteTextOperation(e){for(const t of e.ids){const e=(0,c.TO)(this.getItemWithOnlyId(t));if(!(e instanceof u.Jy))throw new Error("Cannot delete item");e.isDeleted()||(e.setDeleted(),this.visibleCount-=e.getLength(),e.prev instanceof u.Jy&&e.prev.maybeMergeWithNext(),e.maybeMergeWithNext())}this.validateContent()}applySplitTextOperation(e){const t=new u.JE(e.id,e.originId);this.integrateItem(t),this.opClock.maybeUpdateClock(f(e))}integrateItem(e){(0,c.T)(!this.containsOpId(e.id),`Already contains ID: ${e.id}`);const t=(0,c.TO)(this.getItemEndingWithId(e.originId));let n=t;for(;n.next&&!((0,d.D)(e.id,n.next.id)>0);)n=n.next;const o=n.next;if(n.next=e,e.prev=n,o&&(e.next=o,o.prev=e),e instanceof u.Jy&&(this.visibleCount+=e.getLength()),e instanceof u.JE){this.validateNotEndingWithHighSurrogate(t,"Cannot split content between a surrogate pair");const n=this.getPreceedingAnnotationOpSet({id:e.id,anchor:"before"});n&&e.maybeCreateAnnotationOpSetForAnchor("before",{opSet:n})}n instanceof u.Jy&&n.maybeMergeWithNext()}validateContent(){(0,c.T)(!s.PM3(this.getText()),"Content must not contain unpaired surrogates")}validateNotEndingWithHighSurrogate(e,t){if(!(e instanceof u.Jy)||e.isDeleted())return;const n=e.getDefinedContent().at(-1);n&&(0,c.T)("high"!==s.kG3(n),t)}applyAnnotationOperation(e){(0,c.T)(!this.containsOpId(e.id),`Already contains ID: ${e.id}`);const t=(0,c.TO)("before"===e.start.anchor?this.getItemStartingWithId(e.start.id):this.getItemEndingWithId(e.start.id)),n=(0,c.TO)("before"===e.end.anchor?this.getItemStartingWithId(e.end.id,{includeEndItem:!0}):this.getItemEndingWithId(e.end.id,{includeEndItem:!0}));let o=this.getPreceedingAnnotationOpSet(e.start);t.maybeCreateAnnotationOpSetForAnchor(e.start.anchor,{opSet:o});const i=this.iterateItemAnnotationOpSets({direction:"forward",from:e.start,to:e.end,includeSplitCharacters:!0});for(const{item:r,anchor:a}of i){r instanceof u.JE&&r.maybeCreateAnnotationOpSetForAnchor(a,{opSet:o});const t=(0,c.TO)(r.getAnnotationOpSetForAnchor(a));o=t.clone(),t.add(e)}n.maybeCreateAnnotationOpSetForAnchor(e.end.anchor,{opSet:o}),this.opClock.maybeUpdateClock(f(e))}getPreceedingAnnotationOpSet(e){const t=this.iterateItemAnnotationOpSets({direction:"backward",from:e});for(const{annotationOpSet:n}of t)return(0,c.TO)(n)}*iterateItems(e){yield*p.Hi(this.startItem,e)}*iterateItemAnnotationOpSets(e){const{direction:t,from:n,includeSplitCharacters:o}=e,i=e.to??("forward"===t?{id:this.endItem.id,anchor:"after"}:{id:this.startItem.id,anchor:"before"});let r=(0,c.TO)(this.getItemContainingId(n.id));(0,c.T)("before"===n.anchor?r.startsWithId(n.id):r.endsWithId(n.id));let a=n.anchor;for(;r;){if(r.containsId(i.id)&&a===i.anchor)return void(0,c.T)("before"===i.anchor?r.startsWithId(i.id):r.endsWithId(i.id));const e=r.getAnnotationOpSetForAnchor(a);switch(e?yield{item:r,anchor:a,annotationOpSet:e}:o&&r instanceof u.JE&&("forward"===t&&"before"===a||"backward"===t&&"after"===a)&&(yield{item:r,anchor:a,annotationOpSet:void 0}),t){case"forward":r="before"===a?r:r.next,a="before"===a?"after":"before";break;case"backward":r="after"===a?r:r.prev,a="after"===a?"before":"after";break;default:(0,l.t1)(t)}}}getItemStartingWithId(e,t){return this.getItem(e,{...t,shouldStartWithId:!0})}getItemEndingWithId(e,t){return this.getItem(e,{...t,shouldEndWithId:!0})}getItemWithOnlyId(e){return this.getItem(e,{shouldStartWithId:!0,shouldEndWithId:!0})}getItemContainingId(e,t){return this.getItem(e,t)}containsItemWithId(e,t){return Boolean(this.getItemContainingId(e,t))}getItem(e,t){const n=this.iterateItems({includeDeleted:!0,includeEndItem:null==t?void 0:t.includeEndItem});for(const o of n){if(o instanceof u.Jy&&o.containsId(e)){if("start"===e||"end"===e)continue;let n=o;return null!=t&&t.shouldStartWithId&&!n.startsWithId(e)&&(n=n.splitBeforeId(e)),null!=t&&t.shouldEndWithId&&!n.endsWithId(e)&&n.splitAfterId(e),n}if(o.containsId(e))return o}}findIndexOfItemId(e,t){const n=null==t?void 0:t.includeEndItem;let o=0;for(const i of this.iterateItems({includeDeleted:!0,includeEndItem:n}))if(i instanceof u.Jy){if(Array.isArray(e)&&i.containsId(e)){if(i.isDeleted())return o;const t=i.id[1];return o+(e[1]-t)}i.isDeleted()||(o+=i.getLength())}else if(i.containsId(e))return o}getItemIdsInRange(e,t){(0,c.T)(e<=t),(0,c.T)(0<=e&&t<this.visibleCount);const n=[];let o=-1;for(const i of this.iterateItems({includeDeleted:!1})){if(!(i instanceof u.Jy))continue;const r=o+1,a=r+i.getLength()-1;if(a<e){o=a;continue}if(t<r)break;const s=Math.max(0,e-r),l=Math.min(a-r,t-r),[c,d]=i.id;for(let e=s;e<l+1;e++)n.push([c,d+e]);o=a}return(0,c.T)(n.length===t-e+1),n}getItemIdAtIndex(e){return this.getItemIdsInRange(e,e)[0]}getItemIdBeforeIndex(e){const t=this.getItemIdAtIndex(e),n=(0,c.Fb)((0,c.TO)(this.getItemContainingId(t)),v);if(!n.startsWithId(t))return[t[0],t[1]-1];const o=(0,c.TO)(n.prev);return o instanceof u.Jy?o.getEndId():o.id}getItemIdAfterIndex(e){const t=this.getItemIdAtIndex(e);return this.getItemIdAfterItem(t)}getItemIdAfterItem(e){if("start"===e){(0,c.R9)(this.getStartItem(),u.vM);return(0,c.TO)(this.getStartItem().next).id}const t=(0,c.Fb)((0,c.TO)(this.getItemContainingId(e)),v);if(!t.endsWithId(e))return[e[0],e[1]+1];const n=(0,c.TO)(t.next);return n instanceof u.Jy?n.getStartId():n.id}getOriginItemIdForInsertionIndex(e){let t;if((0,c.T)(0<=e&&e<=this.visibleCount),e===this.visibleCount)t=this.getEndItem();else{const n=this.getItemIdAtIndex(e),o=(0,c.Fb)((0,c.TO)(this.getItemContainingId(n)),v);if(!o.startsWithId(n))return[n[0],n[1]-1];t=o}for(;t.prev;){const e=t.prev;if(e instanceof u.Jy&&!e.isDeleted())return e.getEndId();if(e instanceof u.KH)throw new Error("Unexpected");if(e.getAnnotationOpSetForAnchor("after"))return e instanceof u.Jy?e.getEndId():(0,c.Fb)(e.id,b);t=t.prev}return(0,c.Fb)((0,c.Fb)(t,g).id,b)}isLastOriginItemId(e){return r.Xy(this.getOriginItemIdForInsertionIndex(this.visibleCount),e)}containsOpId(e){for(const o of this.iterateItems({includeDeleted:!0,includeEndItem:!0})){var t,n;if(o.containsId(e))return!0;if(null!==(t=o.getAnnotationOpSetForAnchor("before"))&&void 0!==t&&t.containsOpId(e))return!0;if(null!==(n=o.getAnnotationOpSetForAnchor("after"))&&void 0!==n&&n.containsOpId(e))return!0}return!1}getTextValue(){const e=[];let t;for(const i of this.iterateItems({includeDeleted:!0})){var n,o;t=(null===(n=i.getAnnotationOpSetForAnchor("before"))||void 0===n?void 0:n.getResolvedAnnotations())??t,i instanceof u.Jy&&i.getLength()&&!i.isDeleted()&&(t?(t.length?e.push([i.getDefinedContent(),t]):e.push([i.getDefinedContent()]),t=void 0):e.length?(0,c.TO)(e.at(-1))[0]+=i.getDefinedContent():e.push([i.getDefinedContent()])),t=(null===(o=i.getAnnotationOpSetForAnchor("after"))||void 0===o?void 0:o.getResolvedAnnotations())??t}return e}getText(){const e=[];for(const t of this.iterateItems())t instanceof u.Jy&&e.push(t.getDefinedContent());return e.join("")}getSliceStartKey(){return`${this.textInstanceId},${i()(this.startItem.id)}`}getSliceKey(){return`${this.textInstanceId},${i()(this.startItem.id)},${i()(this.endItem.id)}`}static combineSlices(e){(0,c.T)(e.length>0);const{textInstanceId:t,opClock:n}=(0,c.TO)(e[0]),o=n.getValue(),r=new Map;for(const d of e){(0,c.T)(d.textInstanceId===t),(0,c.T)(d.opClock.getValue()===o);const e=i()(d.getStartItem().id);(0,c.T)(!r.has(e)),r.set(e,d)}const a=(0,c.TO)(r.get(i()("start")));r.delete(i()("start"));const s=a.startItem;let l=a.endItem;for(;"end"!==l.id;){const e=i()(l.id),t=(0,c.TO)(r.get(e));r.delete(e);const n=(0,c.TO)(t.startItem.next);l.next=n,n.prev=l,l=t.endItem}return(0,c.T)(0===r.size),new y(t,n,s)}splitIntoSlices(){const e=p.Eg(this.startItem);this.endItem=(0,c.Fb)(p.s(this.startItem),h),this.visibleCount=p.TS(this.startItem),(0,c.T)(this.startItem!==this.endItem);const t=[this];for(let n=1;n<e.length;n++)t.push(new y(this.textInstanceId,this.opClock,(0,c.Fb)(e[n],g)));return t}equals(e){if(this===e)return!0;if(this.textInstanceId!==e.textInstanceId)return!1;const t=[...this.iterateItems({includeDeleted:!0,includeEndItem:!0})],n=[...e.iterateItems({includeDeleted:!0,includeEndItem:!0})];if(t.length!==n.length)return!1;for(let o=0;o<t.length;o++){const e=n[o];if(!t[o].equals(e))return!1}return!0}static createEmpty(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZP)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new m.Z;const n=new u.vM,o=new u.KH;return n.next=o,o.prev=n,new y(e,t,n)}}},46227:(e,t,n)=>{n.d(t,{Z:()=>d,w:()=>c});n(57658),n(21703),n(30541);var o=n(15095),i=n(4615),r=n(70203),a=n(97880),s=n(82798),l=n(69920);const c=(0,i.ZP)();class d{constructor(e,t){this.parent=void 0,this.children=[],this.sessionId=e,this.textSlice=t}insertText(e,t){return this.insertTextValue(e,[[t]]),this}insertTextValue(e,t){const n=this.getOperationsForInsertTextValue(e,t).operations;for(const o of n){const e=o.type;"insertText"===e?this.applyInsertTextOperation(o):"addAnnotation"===e?this.applyAnnotationOperation(o):(0,a.t1)(e)}return this}findIndexOfItemId(e,t,n){let o=0;for(const i of this.iterateTextSliceTrees()){const r=i.getTextSlice();if(r.textInstanceId===e){const e=r.findIndexOfItemId(t,n);if(void 0!==e)return o+e}o+=r.getVisibleCount()}}getOperationsForInsertTextValue(e,t){const n=r.QaF(t),{operation:i,invertedOperation:a}=this.getOperationForInsertText(e,n),s=new o.W3(r.eeV(t)),{textSliceTree:l}=this.getTextSliceTreeAndOriginItemIdForInsertionIndex(e),{textSlice:c}=l,d=r.Sfs({textValue:t,startIndex:0,endIndex:n.length}).map((e=>{let{startIndex:t,endIndex:n,annotation:o}=e;const a=s.getStringStartIndex(t),l=s.getStringEndIndex(n-1),d=[this.sessionId,i.id[1]+a],u=r.J7s(o);let p,m;return r.$z2(u)?(p="before",m=l+1<s.getStringLength()?[this.sessionId,i.id[1]+l+1]:c.getItemIdAfterItem(i.originId)):(p="after",m=[this.sessionId,i.id[1]+l]),{type:"addAnnotation",textInstanceId:i.textInstanceId,id:[this.sessionId,c.opClock.reserveTicks(1)],start:{id:d,anchor:"before"},end:{id:m,anchor:p},annotation:o}}));return{operations:[i,...d],invertedOperations:[a]}}getOperationForInsertText(e,t){const{textSliceTree:n,originId:o}=this.getTextSliceTreeAndOriginItemIdForInsertionIndex(e),{textSlice:i}=n,r={type:"insertText",textInstanceId:i.textInstanceId,id:[this.sessionId,i.opClock.reserveTicks(t.length)],originId:o,content:t};(0,s.T)(t.length>0);return{operation:r,invertedOperation:{type:"invertedInsertText",textInstanceId:i.textInstanceId,startId:r.id,endId:[r.id[0],r.id[1]+t.length-1]}}}applyInsertTextOperation(e){(0,s.TO)(this.findTextSliceContainingItemWithId(e.textInstanceId,e.originId)).applyInsertTextOperation(e)}deleteText(e,t){return this.getOperationsForDeleteText(e,t).forEach((e=>this.applyDeleteOperation(e))),this}getOperationsForDeleteText(e,t){const n=[];for(const{textSliceTree:o,textSliceStartIndex:i,textSliceEndIndex:r}of this.getTextSliceTreesInRange(e,t)){const{textSlice:a}=o,s=a.getItemIdsInRange(Math.max(0,e-i),Math.min(r-i,t-i));n.push({type:"deleteText",textInstanceId:a.textInstanceId,ids:s})}return n}applyDeleteOperation(e){(0,s.TO)(this.findTextSliceContainingItemWithId(e.textInstanceId,(0,s.TO)(e.ids[0]))).applyDeleteTextOperation(e)}addAnnotation(e,t,n){return this.getOperationsForAddAnnotation(e,t,n).forEach((e=>this.applyAnnotationOperation(e))),this}removeAnnotation(e,t,n){return this.getOperationsForRemoveAnnotation(e,t,n).forEach((e=>this.applyAnnotationOperation(e))),this}getOperationsForAddAnnotation(e,t,n){const o=r.J7s(n),i=r.$z2(o);return this.getTextSliceSpansForAnnotationOperation(e,t,i,!1).map((e=>{let{textSlice:t,start:o,end:i}=e;return{type:"addAnnotation",textInstanceId:t.textInstanceId,id:[this.sessionId,t.opClock.reserveTicks(1)],start:o,end:i,annotation:n}}))}getOperationsForRemoveAnnotation(e,t,n){const o=r.JA7(n),i=r.$z2(o);return this.getTextSliceSpansForAnnotationOperation(e,t,i,!0).map((e=>{let{textSlice:t,start:o,end:i}=e;return{type:"removeAnnotation",textInstanceId:t.textInstanceId,id:[this.sessionId,t.opClock.reserveTicks(1)],start:o,end:i,annotationKey:n}}))}getTextSliceSpansForAnnotationOperation(e,t,n,o){const i=[];for(const{textSliceTree:r,textSliceStartIndex:a,textSliceEndIndex:s}of this.getTextSliceTreesInRange(e,t)){const{textSlice:l}=r;let c,d;c=e<a?{id:l.getStartItem().id,anchor:"after"}:o&&!n?{id:l.getItemIdBeforeIndex(e-a),anchor:"after"}:{id:l.getItemIdAtIndex(e-a),anchor:"before"},d=s<t?{id:l.getEndItem().id,anchor:"before"}:o||n?{id:l.getItemIdAfterIndex(t-a),anchor:"before"}:{id:l.getItemIdAtIndex(t-a),anchor:"after"},i.push({textSlice:l,start:c,end:d})}return i}applyAnnotationOperation(e){(0,s.TO)(this.findTextSliceContainingItemWithId(e.textInstanceId,e.start.id)).applyAnnotationOperation(e)}splitAtIndex(e){const t=this.getOperationsForSplitAtIndex(e),n=t.type;switch(n){case"splitNodeEnd":{const{newTextSliceTree:e,textSliceTreesToMove:n}=t;e.detachFromParent();for(const t of n)t.detachFromParent(),e.appendChild(t);return e}case"splitWithinNode":{const{splitOp:e,textSliceTreesToMove:n}=t,o=this.applySplitOperation(e);o.detachFromParent();for(const t of n)t.detachFromParent(),o.appendChild(t);return o}default:(0,a.t1)(n)}}getOperationsForSplitAtIndex(e){const{textSliceTree:t,originId:n}=this.getTextSliceTreeAndOriginItemIdForInsertionIndex(e),{textSlice:o}=t;if(o.isLastOriginItemId(n)){const e=this.getNextTextSliceTree(t);if(e)return{type:"splitNodeEnd",newTextSliceTree:e,textSliceTreesToMove:this.getFollowingTopLevelTextSliceTrees(e)}}return{type:"splitWithinNode",splitOp:{type:"splitText",textInstanceId:o.textInstanceId,id:[this.sessionId,o.opClock.reserveTicks(1)],originId:n},textSliceTreeToSplit:t,textSliceTreesToMove:this.getFollowingTopLevelTextSliceTrees(t)}}applySplitOperation(e){const t=(0,s.TO)(this.findTextSliceTreeContainingItemWithId(e.textInstanceId,e.originId));t.textSlice.applySplitTextOperation(e);const n=t.textSlice.splitIntoSlices();(0,s.T)(2===n.length);const o=(0,s.T)(n[1]),i=new d(this.sessionId,o);for(;t.children.length;){const e=t.children[0];e.detachFromParent(),i.appendChild(e)}return t.appendChild(i),i}getTextValue(){const e=[];for(const t of this.iterateTextSliceTrees())e.push(...t.textSlice.getTextValue());return r.Zxt(e)}getText(){return r.QaF(this.getTextValue())}detachFromParent(){var e;null===(e=this.parent)||void 0===e||e.removeChild(this)}getTextSlice(){return this.textSlice}replaceTextSlice(e){(0,s.T)(e.textInstanceId===this.textSlice.textInstanceId&&e.opClock===this.textSlice.opClock),this.textSlice=e}removeChild(e){const t=this.children.indexOf(e);return(0,s.T)(-1!==t),this.children.splice(t,1),e.parent=void 0,this}appendChild(e){if((0,s.T)(void 0===e.parent),e.parent=this,this.children.push(e),e.hasCycle())throw e.detachFromParent(),new Error("Appending child resulted in a cycle");return this}hasCycle(){const e=new Set;let t=this;for(;t;){if(e.has(t))return!0;e.add(t),t=t.parent}return!1}getTextSliceTreeAndOriginItemIdForInsertionIndex(e){let t,n;if(0===e)t=this,n=0;else{const o=this.getTextSliceTreesInRange(e-1,e-1)[0];t=o.textSliceTree,n=e-o.textSliceStartIndex}return{textSliceTree:t,originId:t.textSlice.getOriginItemIdForInsertionIndex(n)}}findTextSliceContainingItemWithId(e,t,n){var o;return null===(o=this.findTextSliceTreeContainingItemWithId(e,t,n))||void 0===o?void 0:o.textSlice}findTextSliceTreeContainingItemWithId(e,t,n){for(const o of this.iterateTextSliceTrees(e))if(o.textSlice.containsItemWithId(t,n))return o}getTextSliceTreesInRange(e,t){const n=[];(0,s.T)(e<=t);let o=-1;for(const i of this.iterateTextSliceTrees()){const{textSlice:r}=i;if(0===r.getVisibleCount())continue;const a=o+1,s=a+r.getVisibleCount()-1;if(s<e)o=s;else{if(t<a)break;n.push({textSliceTree:i,textSliceStartIndex:a,textSliceEndIndex:s}),o=s}}return n}getNextTextSliceTree(e){let t;for(const n of this.iterateTextSliceTrees()){if(t===e)return n;t=n}}getFollowingTopLevelTextSliceTrees(e){const t=[this];for(;t.length;){const n=(0,s.TO)(t.shift());if(n===e)return[...t];t.unshift(...n.children)}return[]}getLastTextSliceTreeInPreOrderTraversal(){let e=this;for(const t of this.iterateTextSliceTrees())e=t;return e}*iterateTextSliceTrees(e){e&&this.textSlice.textInstanceId!==e||(yield this);for(const t of this.children)yield*t.iterateTextSliceTrees(e)}equals(e){if(this===e)return!0;const t=[...this.iterateTextSliceTrees()],n=[...e.iterateTextSliceTrees()];if(t.length!==n.length)return!1;for(let o=0;o<t.length;o++){const e=t[o],i=n[o];if(!e.textSlice.equals(i.textSlice))return!1;const r=e.children,a=i.children;if(r.length!==a.length)return!1;for(let t=0;t<r.length;t++){const e=r[t],n=a[t];if(e.textSlice.getSliceKey()!==n.textSlice.getSliceKey())return!1}}return!0}static createEmpty(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZP)();return new d(arguments.length>1&&void 0!==arguments[1]?arguments[1]:c,l.Z.createEmpty(e))}}},97531:(e,t,n)=>{n.d(t,{K:()=>r});var o=n(68955),i=n(46227);function r(e,t){const n=e,r=i.Z.createEmpty(n);return t&&r.insertTextValue(0,t),{use_crdt:!0,text_slice_tree:o.Z.serialize(r),text_clocks:o.Z.serializeClocks(r)}}},59579:(e,t,n)=>{n.d(t,{$:()=>r,D:()=>a});var o=n(82798);function i(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:e[0]<t[0]?-1:e[0]>t[0]?1:0}function r(e,t){const n=i(e,t);return(0,o.T)(0!==n,`Expected IDs to be distinct: ${e}`),n}function a(e,t){const n=function(e,t){return"start"===e?"start"===t?0:-1:"end"===e?"start"===t?1:"end"===t?0:-1:"start"===t||"end"===t?1:i(e,t)}(e,t);return(0,o.T)(0!==n,`Expected IDs to be distinct: ${e}`),n}},52136:(e,t,n)=>{n.d(t,{AB:()=>l,Eg:()=>s,Hi:()=>i,TS:()=>a,s:()=>r});n(57658);var o=n(43993);function*i(e,t){let n=e;for(;n;){let e=!0;(null==t||!t.includeDeleted)&&n instanceof o.Jy&&n.isDeleted()?e=!1:null!=t&&t.includeEndItem||n.next||(e=!1),e&&(yield n),n=n.next}}function r(e){let t=e;for(const n of i(e,{includeDeleted:!0,includeEndItem:!0}))t=n;return t}function a(e){let t=0;for(const n of i(e,{includeDeleted:!1}))n instanceof o.Jy&&(t+=n.getLength());return t}function s(e){const t=[e];let n=e.next;for(;n;)if(n instanceof o.JE&&n.next){const e=n.clone(),o=n.next;e.next=o,o.prev=e,e.prev=void 0,n.next=void 0,t.push(e),n=e.next}else n=n.next;return t}function l(e){for(let t=1;t<e.length;t++)e[t].prev=e[t-1],e[t-1].next=e[t]}},47247:(e,t,n)=>{n.d(t,{Z:()=>u});n(57658);var o=n(82798),i=n(52136),r=n(69920),a=n(97880),s=n(43993),l=n(57081);class c{static serialize(e){return[...e.getOps()]}static deserialize(e){return new l.Z(e)}}class d{static serialize(e){let t;e instanceof s.vM?t=d.serializeStartItem(e):e instanceof s.KH?t=d.serializeEndItem(e):e instanceof s.JE?t=d.serializeSplitItem(e):e instanceof s.Jy?t=d.serializeTextItem(e):(0,a.t1)(e);const n=e.getAnnotationOpSetForAnchor("before");n&&(t.annotationOpsBefore=c.serialize(n));const o=e.getAnnotationOpSetForAnchor("after");return o&&(t.annotationOpsAfter=c.serialize(o)),t}static serializeStartItem(e){return{type:"start"}}static serializeEndItem(e){return{type:"end"}}static serializeSplitItem(e){return{type:"split",id:e.id,originId:e.originId}}static serializeTextItem(e){return e.isDeleted()?{type:"text",id:e.id,originId:e.originId,deleted:!0,length:e.getLength()}:{type:"text",id:e.id,originId:e.originId,deleted:!1,content:e.getDefinedContent()}}static deserialize(e){let t;const n=e.type;switch(n){case"start":t=d.deserializeStartItem(e);break;case"end":t=d.deserializeEndItem(e);break;case"split":t=d.deserializeSplitItem(e);break;case"text":t=d.deserializeTextItem(e);break;default:(0,a.t1)(n)}return e.annotationOpsBefore&&t.maybeCreateAnnotationOpSetForAnchor("before",{opSet:c.deserialize(e.annotationOpsBefore)}),e.annotationOpsAfter&&t.maybeCreateAnnotationOpSetForAnchor("after",{opSet:c.deserialize(e.annotationOpsAfter)}),t}static deserializeStartItem(e){return new s.vM}static deserializeEndItem(e){return new s.KH}static deserializeSplitItem(e){return new s.JE(e.id,e.originId)}static deserializeTextItem(e){return e.deleted?s.Jy.createDeleted(e.id,e.originId,e.length):s.Jy.create(e.id,e.originId,e.content)}}class u{static serialize(e){const t=[];for(const n of e.iterateItems({includeDeleted:!0,includeEndItem:!0}))t.push(d.serialize(n));return{textInstanceId:e.textInstanceId,items:t}}static deserialize(e,t){const n=[];for(const o of e.items)n.push(d.deserialize(o));i.AB(n);const a=(0,o.Fb)(n[0],r.G);return new r.Z(e.textInstanceId,t,a)}}},68955:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(82798),i=n(19056),r=n(46227),a=n(47247);class s{static serialize(e){const t={};for(const n of e.iterateTextSliceTrees()){const e=n.getTextSlice(),o=n.children;t[e.getSliceKey()]={textSlice:a.Z.serialize(e),childKeys:o.map((e=>e.getTextSlice().getSliceKey()))}}return{root:e.getTextSlice().getSliceKey(),nodes:t}}static serializeClocks(e){const t={};for(const n of e.iterateTextSliceTrees()){const{textInstanceId:e,opClock:i}=n.getTextSlice();t[e]?(0,o.T)(t[e]===i.getValue()):t[e]=i.getValue()}return t}static deserialize(e,t,n){const o=t.root,i=t.nodes;return s.deserializeHelper(e,o,i,n)}static deserializeTreeAndClocks(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.w;const o=s.deserializeClocks(t);return{textSliceTree:s.deserialize(n,e,o),opClockMap:o}}static deserializeHelper(e,t,n,i){const{textSlice:l,childKeys:c=[]}=(0,o.TO)(n[t]),d=(0,o.TO)(i[l.textInstanceId]),u=a.Z.deserialize(l,d),p=new r.Z(e,u);for(const o of c){const t=s.deserializeHelper(e,o,n,i);p.appendChild(t)}return p}static deserializeClocks(e){const t={};for(const[n,o]of Object.entries(e))t[n]=new i.Z(o);return t}}},52936:(e,t,n)=>{n.d(t,{Bp:()=>m,yu:()=>g});n(57658),n(21703);var o=n(30120),i=n(80951),r=n(40506),a=n(53877),s=n(21768),l=n(482),c=n(27006),d=n(149),u=n(21202),p=n(97880);const m=["consume_gap","preserve_gap"];class f{constructor(){this.operations=[],this.numDependenciesUpdated=0,this.numCouldNotUpdateDueToPermissions=0}push(e){this.operations.push(...e.operations),this.numDependenciesUpdated+=e.numDependenciesUpdated,this.numCouldNotUpdateDueToPermissions+=e.numCouldNotUpdateDueToPermissions}pushUpdatedBlockDates(e,t){for(const[n,o]of e)this.operations.push(...t.toOperations(o,{id:n,table:u.iU}));this.numDependenciesUpdated+=e.size}}function g(e){const{block:t,options:n,blockingPropertyId:r,blockedByPropertyId:a,timeZone:s,locale:l,collectionSchema:c,getRecordRole:u,getRecordValue:m,dateProperty:g,endDateProperty:y}=e,S=function(e){return t=>{let{oldDateValue:n,newDateValue:i,dependencyDateValue:r}=t;const a=Boolean(e.avoid_weekends),s=e.mode;if(!s)return;const l=r.getStart(),c=i.getStart(),d=i.getEnd();let u;if("consume_gap"===s){if(d.valueOf()>=l.valueOf()){if(a)return k({dateShiftMode:s,newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:r});u=d.plus(r.nudgeForDate("start"))}}else if("preserve_gap"===s)if(n){const e=n.getStart(),t=n.getEnd();if(a)return k({dateShiftMode:s,oldDateData:o.Xp.fromDateTimes(e,t),newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:r});const i=d.diff(t);u=l.plus(i)}else d.valueOf()>=l.valueOf()&&(u=d.plus(r.nudgeForDate("start")));else(0,p.t1)(s);return u&&r.changeBoundary({type:"start",newValue:u})}}(n),_=function(e){return t=>{let{oldDateValue:n,newDateValue:i,dependencyDateValue:r}=t;const a=Boolean(e.avoid_weekends),s=e.mode;if(!s)return;const l=r.getEnd(),c=i.getStart(),d=i.getEnd();let u;if("consume_gap"===s){if(c.valueOf()<=l.valueOf()&&(u=c.minus(r.nudgeForDate("end")),a))return w({dateShiftMode:s,newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:r})}else if("preserve_gap"===s)if(n){const e=n.getStart(),t=n.getEnd();if(a)return w({dateShiftMode:s,oldDateData:o.Xp.fromDateTimes(e,t),newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:r});const i=e.diff(c);u=l.minus(i)}else c.valueOf()<=l.valueOf()&&(u=c.minus(r.nudgeForDate("end")));else(0,p.t1)(s);return u&&r.changeBoundary({type:"end",newValue:u})}}(n),I={timeZone:s,locale:l};let C,M;if((0,p.$K)(y)){const e=new T({convertArgs:I,startPropertyId:g.id,endPropertyId:y.id});C=e;const n=e.getFromBlock(t),o=(0,i.Gl)(g.newValue)??(null==n?void 0:n.startValue),r=(0,i.Gl)(y.newValue)??(null==n?void 0:n.endValue);if(!(0,p.$K)(o))return new f;M=new A({convertArgs:I,startValue:o,endValue:r})}else{C=new x({convertArgs:I,propertyId:g.id});const e=(0,i.Gl)(g.newValue);if(!(0,p.$K)(e))return new f;M=new P({convertArgs:I,value:e})}const R={startingBlock:t,startingNewDateValue:M,context:{collectionSchema:c,getRecordRole:u,getRecordValue:m,accessor:C}};if("consume_gap"===n.mode){const e=new f,t=b({...R,dependencyPropertyId:r,dateAdjuster:S,dateRangeIsFurtherThan:(e,t)=>e.getStart().valueOf()>t.getStart().valueOf()});if(d.x.isFail(t))return new f;e.push(t.value);const n=b({...R,dependencyPropertyId:a,dateAdjuster:_,dateRangeIsFurtherThan:(e,t)=>e.getEnd().valueOf()<t.getEnd().valueOf()});return d.x.isFail(n)?new f:(e.push(n.value),e)}if("preserve_gap"===n.mode)return function(e){const{startingBlock:t,startingNewDateValue:n,forwardConfig:o,backwardConfig:i,context:r}=e,{accessor:a}=r,s=new Set,l=[{block:t,newDateValue:n}],c=new Map,d=new f;for(;;){const e=l.shift();if(!e)break;const{block:n,newDateValue:u}=e;if(s.has(n.id))continue;s.add(n.id);const p=a.getFromBlock(n);for(const{dependencyPropertyId:a,dateAdjuster:s}of[o,i]){const e=v(r,n,a);for(const n of e)n.id!==t.id&&h({context:r,adjust:e=>s({oldDateValue:p,newDateValue:u,dependencyDateValue:e}),result:d,dependencyPointer:n,onDateUpdated:(e,t)=>{c.has(n.id)||c.set(n.id,t),l.push({block:e,newDateValue:t})}})}}return d.pushUpdatedBlockDates(c,a),d}({...R,forwardConfig:{dependencyPropertyId:r,dateAdjuster:S},backwardConfig:{dependencyPropertyId:a,dateAdjuster:_}});(0,p.t1)(n.mode)}function h(e){const{result:t,dependencyPointer:n,context:o,adjust:i,onDateUpdated:r}=e,{accessor:a,getRecordValue:s,getRecordRole:l}=o,d=l(n);if(d&&!(0,c.J5)(d))return void t.numCouldNotUpdateDueToPermissions++;const u=s(n);if(!u)return;const p=a.getFromBlock(u);if(!p)return;const m=i(p);m&&!m.equals(p)&&r(u,m)}function v(e,t,n){var o;const r=e.collectionSchema[n];return r&&"relation"===r.type?(0,i.j$)({propertySchema:r,getRecordModel:s.o.fromGetRecordValueFn(e.getRecordValue),relationValue:(0,i.rq)(null===(o=t.properties)||void 0===o?void 0:o[n])}):[]}function b(e){const{startingBlock:t,startingNewDateValue:n,context:o,dateAdjuster:i,dateRangeIsFurtherThan:r,dependencyPropertyId:a}=e,{accessor:s}=o,l=new Set,c=[{block:t,newDateValue:n,path:[]}],d=new Map,u=new f;for(;;){const e=c.shift();if(!e)break;const{block:t,newDateValue:n,path:p}=e;if(p.includes(t.id))return{error:"cycle_detected"};if(l.has(t.id))continue;l.add(t.id);const m=s.getFromBlock(t),f=[...p,t.id],g=v(o,t,a);for(const a of g)h({context:o,adjust:e=>i({oldDateValue:m,newDateValue:n,dependencyDateValue:e}),result:u,dependencyPointer:a,onDateUpdated:(e,t)=>{const n=d.get(a.id);n&&!r(t,n)||d.set(a.id,t),c.push({block:e,newDateValue:t,path:f})}})}return u.pushUpdatedBlockDates(d,s),{value:u}}function y(e){const{inputDate:t,dateShiftDirection:n}=e;return 6===t.weekday?t.plus({days:"right"===n?2:-1}):7===t.weekday?t.plus({days:"right"===n?1:-2}):t}function S(e,t){let n,o,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;if(e.valueOf()>t.valueOf())n=t,o=e;else{if(!(e.valueOf()<t.valueOf()))return 0;n=e,o=t}for(i&&(n=n.plus({days:1}),o=o.minus({days:1}));n.valueOf()<=o.valueOf();)_(n)||r++,n=n.plus({days:1});return r}function _(e){return 6===e.weekday||7===e.weekday}function w(e){const{newDateData:t,dependencyDateValue:n,dateShiftMode:o}=e,i=n.getStart(),r=n.getEnd(),a=S(i,r);let s=y({inputDate:t.start.minus({days:1}),dateShiftDirection:"left"});if("preserve_gap"===o){const n=S(e.oldDateData.start,r,!0);for(let e=S(t.start,s,!0);e<n;e++)s=s.minus({days:1}),_(s)&&(s=y({inputDate:s,dateShiftDirection:"left"}))}let l=s,c=1;for(;c<a;)l=l.minus({days:1}),_(l)||c++;return n.changeBoundaries({newStart:l,newEnd:s})}function k(e){const{dependencyDateValue:t,newDateData:n,dateShiftMode:o}=e,i=t.getStart(),r=S(i,t.getEnd());let a=y({inputDate:n.end.plus({days:1}),dateShiftDirection:"right"});if("preserve_gap"===o){const t=S(e.oldDateData.end,i,!0);for(let e=S(n.end,a,!0);e<t;e++)a=a.plus({days:1}),_(a)&&(a=y({inputDate:a,dateShiftDirection:"right"}))}let s=a,l=1;for(;l<r;)s=s.plus({days:1}),_(s)||l++;return t.changeBoundaries({newStart:a,newEnd:s})}function I(e,t){if(!(e instanceof t))throw new Error(`Expected ShiftableDate to be of type ${t}`)}class C{constructor(e){this.convertArgs=e}}class x extends C{constructor(e){super(e.convertArgs),this.propertyId=void 0,this.propertyId=e.propertyId}getFromBlock(e){var t;const n=(0,i.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.propertyId]);return n?new P({value:n,convertArgs:this.convertArgs}):void 0}toOperations(e,t){return I(e,P),[l.op.update({pointer:t,path:["properties"],args:{[this.propertyId]:(0,i.d7)(e.value)}})]}}class T extends C{constructor(e){super(e.convertArgs),this.startPropertyId=void 0,this.endPropertyId=void 0,this.startPropertyId=e.startPropertyId,this.endPropertyId=e.endPropertyId}getFromBlock(e){var t;const n=(0,i.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.startPropertyId]);if((0,p.$K)(n)){var o;const t=(0,i.Gl)(null===(o=e.properties)||void 0===o?void 0:o[this.endPropertyId]);return new A({startValue:n,endValue:t,convertArgs:this.convertArgs})}}toOperations(e,t){return I(e,A),[l.op.update({pointer:t,path:["properties"],args:{[this.startPropertyId]:(0,i.d7)(e.startValue),...e.endValue?{[this.endPropertyId]:(0,i.d7)(e.endValue)}:{}}})]}}class M{constructor(e){this.convertArgs=e}toLuxon(e){return a.OQ.notionDateOrDateTimeToLuxon(e,this.convertArgs)}}class P extends M{constructor(e){super(e.convertArgs),this.value=void 0,this.value=e.value}getStart(){return this.toLuxon(r.Ws(this.value))}getEnd(){return this.toLuxon(r.S$(this.value))}nudgeForDate(e){return"date"===this.value.type||"daterange"===this.value.type?{days:1}:"datetime"===this.value.type?{minutes:1}:"datetimerange"===this.value.type?{}:void(0,p.t1)(this.value)}equals(e){return I(e,P),r.AP(this.value,e.value)}changeBoundary(e){let t;if("daterange"===this.value.type||"datetimerange"===this.value.type){const n=a.NK(this.value,this.convertArgs.timeZone,this.convertArgs.locale),o=n.end.diff(n.start);t=("daterange"===this.value.type?a.OQ.toPersistedDateRange:a.OQ.toPersistedDateTimeRange)("start"===e.type?{start:e.newValue,end:e.newValue.plus(o)}:{start:e.newValue.minus(o),end:e.newValue},this.convertArgs.timeZone)}else if("date"===this.value.type||"datetime"===this.value.type){t=("date"===this.value.type?a.OQ.toPersistedDate:a.OQ.toPersistedDateTime)(e.newValue.valueOf(),this.convertArgs.timeZone)}else(0,p.t1)(this.value);return new P({value:t,convertArgs:this.convertArgs})}changeBoundaries(e){const{newStart:t,newEnd:n}=e;return new P({value:a.OQ.toPersistedDateWithType({start:t,end:n},this.value.type,this.convertArgs.timeZone),convertArgs:this.convertArgs})}}class A extends M{getMergedValue(){if(this._mergedValue===A.MergedValueNotCalculated){const e=a.rH(this.startValue,this.endValue);this._mergedValue=e?a.Qq(e):void 0}return this._mergedValue}constructor(e){super(e.convertArgs),this.startValue=void 0,this.endValue=void 0,this._mergedValue=void 0,this.startValue=e.startValue,this.endValue=e.endValue}getStart(){return this.toLuxon(r.Ws(this.getMergedValue()??this.startValue))}getEnd(){return this.toLuxon(r.S$(this.getMergedValue()??this.endValue??this.startValue))}equals(e){return I(e,A),r.AP(this.startValue,e.startValue)&&((0,p.$K)(this.endValue)?(0,p.$K)(e.endValue)&&r.AP(this.endValue,e.endValue):!(0,p.$K)(e.endValue))}nudgeForDate(e){const t="start"===e?this.startValue:this.endValue??this.startValue;return"date"===t.type?{days:1}:"datetime"===t.type||"datetimerange"===t.type||"daterange"===t.type?{}:void(0,p.t1)(t)}toPersistedDateDiscardingRange(e,t){return void 0===t||"date"===t||"daterange"===t?a.OQ.toPersistedDate(e.valueOf(),this.convertArgs.timeZone):"datetime"===t||"datetimerange"===t?a.OQ.toPersistedDateTime(e.valueOf(),this.convertArgs.timeZone):void(0,p.t1)(t)}changeBoundary(e){var t,n;const o=this.getEnd().diff(this.getStart());return new A({convertArgs:this.convertArgs,..."start"===e.type?{startValue:this.toPersistedDateDiscardingRange(e.newValue,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue.plus(o),null===(t=this.endValue)||void 0===t?void 0:t.type)}:{startValue:this.toPersistedDateDiscardingRange(e.newValue.minus(o),this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue,null===(n=this.endValue)||void 0===n?void 0:n.type)}})}changeBoundaries(e){var t;const{newStart:n,newEnd:o}=e;return new A({startValue:this.toPersistedDateDiscardingRange(n,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(o,null===(t=this.endValue)||void 0===t?void 0:t.type),convertArgs:this.convertArgs})}}A.MergedValueNotCalculated=Symbol("Merged value not calculated yet")},44317:(e,t,n)=>{n.d(t,{Ct:()=>a,O5:()=>s,eG:()=>r});var o=n(5366),i=n(63143);const r=(0,o.defineMessages)({year:{id:"timeUtils.durationDescriptor.intervalYear",defaultMessage:"{numYears, plural, one {1 year} other {{numYears} years}}"},day:{id:"timeUtils.durationDescriptor.intervalDay",defaultMessage:"{numDays, plural, one {1 day} other {{numDays} days}}"},hour:{id:"timeUtils.durationDescriptor.intervalHour",defaultMessage:"{numHours, plural, one {1 hour} other {{numHours} hours}}"},minute:{id:"timeUtils.durationDescriptor.intervalMinute",defaultMessage:"{numMinutes, plural, one {1 minute} other {{numMinutes} minutes}}"},second:{id:"timeUtils.durationDescriptor.intervalSecond",defaultMessage:"{numSeconds, plural, one {1 second} other {{numSeconds} seconds}}"}});function a(e,t){const n=Math.floor(e/i._I),o=Math.floor(e/i.A0),a=Math.floor(e/i.U6),s=Math.floor(e/i.hM),l=Math.floor(e/i.C0);return n>=1?t.formatMessage(r.year,{numYears:n}):o>=1?t.formatMessage(r.day,{numDays:o}):a>=1?t.formatMessage(r.hour,{numHours:a}):s>=1?t.formatMessage(r.minute,{numMinutes:s}):t.formatMessage(r.second,{numSeconds:l})}function s(e){return Math.floor((Date.now()-e)/864e5)}},17223:(e,t,n)=>{n.d(t,{Y:()=>o});const o="415fc269-e68f-4da0-b3e3-b1273b741a7f"},14215:(e,t,n)=>{n.d(t,{E:()=>o,N:()=>i});n(57658),n(21703);function o(e,t){const n=new Set(e),o=new Set,i=new Array,r=new Array;for(const a of t)o.add(a),n.has(a)||r.push(a);for(const a of e)o.has(a)||i.push(a);return{created:r,deleted:i}}function i(e,t,n){const o=new Map,i=new Map,r=new Array,a=new Array;for(const s of e)o.set(n(s),s);for(const s of t){const e=n(s);i.set(e,s),o.has(e)||a.push(e)}for(const s of e){const e=n(s);i.has(e)||r.push(e)}return{created:a.map((e=>{const t=i.get(e);if(!t)throw new Error("After map did not contain value.");return t})),deleted:r.map((e=>{const t=o.get(e);if(!t)throw new Error("Before map did not contain value.");return t}))}}},93824:(e,t,n)=>{n.d(t,{q:()=>i});n(57658);var o=n(35311);function i(e,t){const n=o.create({arrays:{detectMove:!1,includeValueOnMove:!0}}).diff(e,t);if(!n)return{beforeOps:{},removeOps:new Set};let i=[],r=[];for(const o in n)"_t"!==o&&("_"===o[0]?i.push(parseInt(o.slice(1),10)):1===n[o].length&&r.push({index:parseInt(o,10),value:n[o][0]}));const a={},s=new Set,l=[...e];i=i.sort(((e,t)=>e-t));for(let o=i.length-1;o>=0;o--){const e=i[o],t=l.splice(e,1)[0];s.add(t)}r=r.sort(((e,t)=>e.index-t.index));for(let o=0;o<r.length;o++){const e=r[o];a[e.value]=l[e.index],l.splice(e.index,0,e.value)}return{beforeOps:a,removeOps:s}}},87444:(e,t,n)=>{n.d(t,{t1:()=>te,tV:()=>ee,PZ:()=>Q,nM:()=>W,eb:()=>K});n(57658),n(21703);var o=n(3865),i=n(80700),r=n(41432),a=n(76205),s=n(14714),l=n(99036),c=n(1274),d=n(68955),u=n(46227),p=(n(45433),n(17223)),m=(n(42509),n(89789)),f=n(59753),g=(n(482),n(4615)),h=n(98963),v=n(18844),b=n(21202),y=n(70203);function S(e){var t;const{blockValue:n,factoryButtonDeprecationContext:o,source:i}=e,r=function(e){return f.kk.fromValue(b.iU,e).getCreatedByPointer()??{id:m.P_.id,table:m.P_.table}}(n),a=n.space_id,s=(0,g.ZP)(),l=(0,g.ZP)(),c=o.isRootBlockFactoryBlock&&o.isCurrentBlockRootBlock?o.rootTextContainerId:(0,g.ZP)(),d=function(e){const{automationActionId:t,textContainerBlockId:n,creatorPointer:o,originalBlockValue:i,spaceId:r,blockContent:a}=e;return{table:b.iU,value:{id:n,space_id:r,alive:!0,parent_table:v.Xj,parent_id:t,type:"text",version:0,content:a,created_time:i.created_time,created_by_table:o.table,created_by_id:o.id}}}({automationActionId:l,textContainerBlockId:c,creatorPointer:r,originalBlockValue:n,blockContent:"duplication"===i?null===(t=n.content)||void 0===t?void 0:t.map((t=>e.pointerMapper({id:t,table:b.iU}).id)):n.content,spaceId:a}),u=function(e){const{automationId:t,automationActionId:n,spaceId:o,textContainerBlockId:i}=e;return{table:v.Xj,value:{id:n,space_id:o,alive:!0,parent_table:h.cv,parent_id:t,type:"duplicate_blocks",blocks:[i],version:0,config:void 0}}}({automationActionId:l,automationId:s,creatorPointer:r,originalBlockValue:n,spaceId:a,textContainerBlockId:c});return{textContainerBlock:d,automation:function(e){var t;const{creatorPointer:n,automationActionId:o,originalBlockValue:i,spaceId:r,automationId:a}=e,s=(0,g.ZP)(),l=Date.now();return{table:h.cv,value:{id:a,space_id:r,alive:!0,trigger:{id:s,type:"button"},parent_id:i.id,parent_table:b.iU,action_ids:[o],status:"active",properties:{name:(0,y.QaF)(null===(t=i.properties)||void 0===t?void 0:t.title)},created_by_id:n.id,created_by_table:n.table,created_time:i.created_time??l,last_edited_time:i.last_edited_time??l,version:0,last_edited_by_id:i.last_edited_by_id??n.id,last_edited_by_table:i.last_edited_by_table??n.table}}}({automationActionId:l,automationId:s,creatorPointer:r,originalBlockValue:n,spaceId:a}),automationAction:u}}var _=n(6695),w=n(78106),k=n(76218),I=n(59730),C=n(64572),x=n(72126),T=n(33317),M=n(63306),P=n(26825),A=n(27006),R=n(71644),D=n(74446),B=n(45953),E=n(606),F=n(77420),Z=n(6287),L=n(13493),j=n(70279),V=n(33709),U=n(80396),O=n(23867),N=n(91644),z=n(97880),H=n(63143);function W(e){const t=K([y.V3y(e)]);return y.QaF(t)}function q(e){if(e.length<3||!e.startsWith("(")||!e.endsWith(")"))return;const t=e.substring(1,e.length-1),n=parseInt(t);return!Number.isNaN(n)&&n>0&&function(e){return Boolean(e.match(/^[1-9][0-9]*$/))}(t)?n:void 0}function G(e){const t=e=>`(${e})`,{title:n,digit:o}=function(e){const t=e.trimEnd(),n=t.split(" "),o=q(n[n.length-1]);let i=t;if(void 0!==o){const e=n.slice(0,n.length-1).join(" ");i=e.length>0?e:void 0}return{title:i,digit:o}}(e[0]),i=void 0===n?"":`${n.trimEnd()} `,r=t(void 0===o?1:o+1);return y.V3y(`${i}${r}`)}function K(e){const t=y.QaF(e);if(0===t.trim().length||void 0===e)return[y.V3y(t)];const n=e[e.length-1];if(y.QJH(n)){return[...e.slice(0,e.length-1),G(n)]}return[...e,G([""])]}function $(e){return(t=e.table)===b.iU||t===Z.v||t===L.n||t===V.qF||t===j.x_||t===U.yo||t===h.cv||t===v.Xj||t===N.AT;var t}function Q(e){const{sourceBlockId:t,targetBlockPointer:n,recordMap:o,options:i,baseUrl:r,publicDomainName:a,actor:s,getRecordRole:l}=e,c=e.recordPointerMap||B.Ao.create();for(const{pointer:f}of o){const e=f.id===t?n:c.get(f)||{spaceId:n.spaceId,table:f.table,id:(0,g.ZP)()};c.set(f,e)}const d=B.Ak.create(),u=e=>{let{requested:t}=e;return c.get(t)},p=o.getModel({id:t,table:b.iU}),m=p?function(e){const t="duplication",n=new Map;let o;return"factory"===e.type?(o={type:t,isRootBlockFactoryBlock:!0,isCurrentBlockRootBlock:!1,factoryBlockIdToNewTextContainerIdMap:n,rootTextContainerId:(0,g.ZP)()},o.factoryBlockIdToNewTextContainerIdMap.set(e.id,{id:o.rootTextContainerId,table:b.iU})):o={type:t,isRootBlockFactoryBlock:!1,factoryBlockIdToNewTextContainerIdMap:n},o}(p):void 0;for(const{pointer:f,model:g}of o){if(void 0===g)continue;if(!$(g))continue;if(!(null!=i&&i.duplicateDiscussions||f.table!==V.qF&&f.table!==j.x_&&f.table!==U.yo))continue;const e=Boolean((null==i?void 0:i.resolveTemplateVariables)&&oe({rootSourceBlockIds:[t],childSourcePointer:f,getSourceRecordValue:D.mF.fromRecordMap(o)}))?{...i,resolveTemplateVariables:!1}:i;null!=m&&m.isRootBlockFactoryBlock&&(m.isCurrentBlockRootBlock=g.id===t);const{duplicateRecord:c,additionalRecords:p}=J({table:g.table,record:g.__IM_SORRY__getValue(),mapper:u,options:e,rewiredUriMap:{},typedCollectionViewBlocks:[],originOptions:{baseUrl:r,publicDomainName:a},actor:s,getRecordRole:l,factoryButtonDeprecationContext:m});if(void 0!==c){if(g.table===b.iU&&c.id===n.id){const e=c;delete e.parent_id,delete e.parent_table,delete e.alive}Y({duplicateRecordMap:d,duplicateRecordResult:{duplicateRecord:c,additionalRecords:p,duplicateRecordTable:g.table}})}}return{duplicateRecordMap:d,originalToDuplicate:c}}function Y(e){const{duplicateRecordResult:t,duplicateRecordMap:n}=e,{additionalRecords:o,duplicateRecord:i,duplicateRecordTable:r}=t;n.setValue(E.dr.fromPointerLike({table:r,id:i.id}),i);for(const a of o)n.setValue(E.dr.fromPointerLike({id:a.value.id,table:a.table}),a.value)}function J(e){const{table:t,record:n,mapper:a,options:c,originOptions:m,actor:C,helperRecordMap:M,getRecordRole:W,rewiredUriMap:q,typedCollectionViewBlocks:G,factoryButtonDeprecationContext:K}=e,$=x.Xh(n),Q=a({requested:E.dr.fromPointerLike({table:t,id:n.id,spaceId:n.space_id}),requester:E.dr.fromPointerLike({table:t,id:n.id})});if(void 0===Q)throw new I.D3(`Failed to duplicate record ${n.id}`);$.id=Q.id,$.space_id=(0,O.C)(Q.spaceId);const Y=[];if(t===b.iU){const e=$,{additionalRecords:t}=function(e){var t,n,o,i,a,s;const{originalBlock:l,duplicateBlock:c,mapper:m,options:v,originOptions:w,rewiredUriMap:k,typedCollectionViewBlocks:I,actor:C,helperRecordMap:T,factoryButtonDeprecationContext:M}=e,R={table:b.iU,id:l.id,spaceId:l.space_id};null!==(t=l.format)&&void 0!==t&&t.app_config_uri&&null!==(n=c.format)&&void 0!==n&&n.app_config_uri&&((0,_.iA)(l.format.app_config_uri)?c.format.app_config_uri=void 0:((0,r.dM)(c.type)&&I.push(c.id),k[l.id]=c.id));const D=[];if(null!==(o=c.format)&&void 0!==o&&o.use_crdt&&(0,r.h5)(c.type)){if(c.format.text_slice_tree&&c.format.text_clocks){const{textSliceTree:e}=d.Z.deserializeTreeAndClocks(c.format.text_slice_tree,c.format.text_clocks);c.properties={...c.properties,title:e.getTextValue()}}const{use_crdt:e,text_slice_tree:t,text_clocks:n,...o}=c.format;c.format=o}if("factory"===c.type&&M){const{automation:e,automationAction:t,textContainerBlock:n}=S({blockValue:c,source:"duplication",pointerMapper:e=>m({requested:e,requester:R})??e,factoryButtonDeprecationContext:M});D.push(e,t,n),M.factoryBlockIdToNewTextContainerIdMap.set(l.id,{id:n.value.id,table:b.iU});const o=c;o.type="button",o.content=[],o.format={...o.format,automation_id:e.value.id}}(0,g.e)(l.id)&&(c.format||(c.format={}),c.format.copied_from_pointer={table:b.iU,id:l.id,spaceId:l.space_id},c.copied_from=l.id);const B=(l.parent_table===b.iU?null==M?void 0:M.factoryBlockIdToNewTextContainerIdMap.get(l.parent_id):void 0)??m({requested:{table:c.parent_table,id:c.parent_id,spaceId:c.space_id},requester:R});B&&(c.parent_id=B.id);const j=c;if(j.content){var U;if(j.content=j.content.map((e=>{var t;return(null===(t=m({requested:{table:b.iU,id:e},requester:R}))||void 0===t?void 0:t.id)||e})),c.space_id===p.Y&&null!==(U=c.properties)&&void 0!==U&&U.title){var N,W,q;const e=(0,y.lzi)(null===(N=c.properties)||void 0===N?void 0:N.title);e&&e.length>0&&e[0].length>0&&null!==(W=e[0][0])&&void 0!==W&&null!==(W=W.trim())&&void 0!==W&&W.startsWith("🎲")&&null!==(q=e[0][0])&&void 0!==q&&null!==(q=q.trim())&&void 0!==q&&q.endsWith("🎲")&&(j.content=x.TV(j.content))}}null!==(i=c.format)&&void 0!==i&&i.ai_instructions_page_pointer&&(c.format.ai_instructions_page_pointer=m({requested:c.format.ai_instructions_page_pointer,requester:R}));null!==(a=c.format)&&void 0!==a&&a.ai_skill_pointer&&(c.format.ai_skill_pointer=m({requested:c.format.ai_skill_pointer,requester:R}));const G=c;G.view_ids&&(G.view_ids=G.view_ids.map((e=>{var t;return(null===(t=m({requested:{table:L.n,id:e,spaceId:G.space_id},requester:R}))||void 0===t?void 0:t.id)||e})));const K=f.kk.fromBlock(G).getCollectionPointer();if(K){var $;if(null==T||null===($=T.getValue(K))||void 0===$||null===($=$.format)||void 0===$?void 0:$.bot_id)G.collection_id=K.id,G.format={...G.format,collection_pointer:K};else{const e=m({requested:K,requester:R})||K;if(e.table!==Z.v)throw new Error(`Collection pointer for duplicate collection is invalid: ${JSON.stringify(e)}`);G.collection_id=e.id,G.format={...G.format,collection_pointer:e}}}c.discussions&&(v.duplicateDiscussions?c.discussions=c.discussions.map((e=>{var t;return(null===(t=m({requested:E.dr.fromPointerLike({table:V.qF,id:e,spaceId:c.space_id}),requester:R}))||void 0===t?void 0:t.id)||e})):delete c.discussions);if(c.permissions){var Q;if(v.duplicatePermissions)c.permissions=function(e){const{block:t,targetSpaceSettings:n,targetTeamSettings:o}=e;return(t.permissions||[]).filter((e=>!(0,A.FB)(e)&&(!(0,A.hV)(e)&&((!(!o&&n.disablePublicAccess||o&&o.disable_public_access)||!(0,A.$D)(e))&&!((!o&&n.disableGuests||o&&o.disable_guests)&&(0,A.jg)(e)&&!(0,P.N0)({spacePermissions:n.permissions||[],userId:e.user_id,botId:void 0}))))))}({block:c,targetSpaceSettings:v.duplicatePermissions.targetSpaceSettings,targetTeamSettings:null===(Q=v.duplicatePermissions)||void 0===Q?void 0:Q.targetTeamSettings});else delete c.permissions}c.content_classification&&delete c.content_classification;c.moved&&delete c.moved;c.properties||(c.properties={});for(const r in c.properties){const e=v.duplicateDiscussions?c.properties[r]:y.OAI(c.properties[r]);c.properties[r]=e}c.ignore_block_count&&delete c.ignore_block_count;if(c.properties)for(const r of Object.keys(c.properties)){const e=c.properties[r];e&&(c.properties[r]=ne({...w,text:{value:e,spaceId:(0,O.C)(c.space_id)},mapper:m,requester:R,resolveTemplateVariables:v.resolveTemplateVariables||!1}))}if("transclusion_reference"===c.type&&v.deepCopyTransclusionContainers){const e=c;if(e.format&&e.format.transclusion_reference_pointer){const t=e.format.transclusion_reference_pointer,n=m({requested:t,requester:R});n&&(e.format.transclusion_reference_pointer=n)}}if("transclusion_container"===c.type&&!v.deepCopyTransclusionContainers){const e=c;e.type="transclusion_reference",e.content=void 0;const t=e.format||{};t.transclusion_reference_pointer=R,e.format=t}if("alias"===c.type&&c.format&&c.format.alias_pointer){const e=c.format.alias_pointer,t=m({requested:e,requester:R});t&&(c.format.alias_pointer=t)}c.type===r.Ti.externalObjectInstancePage&&(c.type=r.Ti.externalObjectInstance);if(c.type===r.Ti.externalObjectInstance){var Y,J,X;if(null!==(Y=c.format)&&void 0!==Y&&Y.related_external_object_uris_to_instance_ids&&(c.format.related_external_object_uris_to_instance_ids=(0,H.m8)((0,z.qP)(c.format.related_external_object_uris_to_instance_ids).map((e=>{var t;let[n,o]=e;return[n,(null===(t=m({requested:{table:b.iU,id:o,spaceId:G.space_id},requester:R}))||void 0===t?void 0:t.id)||o]})))),v.convertExternalObjectInstancesToPlaceholders&&(null===(J=c.format)||void 0===J||!J.is_placeholder)&&null!==(X=c.format)&&void 0!==X&&X.bot_id){const e=null==T?void 0:T.getValue({table:F.cZ,id:c.format.bot_id}),t=null==e?void 0:e.integration_id;if(t){const e={is_placeholder:!0,integration_id:t};c.format=e}}}c.file_ids&&function(e){var t;const n=JSON.stringify(e.properties);e.file_ids=null==e||null===(t=e.file_ids)||void 0===t?void 0:t.filter((t=>{var o,i,r,a,s,l;return!(null===(o=e.format)||void 0===o||!o.display_source||-1===(null===(i=e.format)||void 0===i||null===(i=i.display_source)||void 0===i?void 0:i.indexOf(t)))||(!(null===(r=e.format)||void 0===r||!r.page_cover||-1===(null===(a=e.format)||void 0===a||null===(a=a.page_cover)||void 0===a?void 0:a.indexOf(t)))||(!(null===(s=e.format)||void 0===s||!s.page_icon||-1===(null===(l=e.format)||void 0===l||null===(l=l.page_icon)||void 0===l?void 0:l.indexOf(t)))||-1!==n.indexOf(t)))}))}(c);if(null!==(s=c.format)&&void 0!==s&&s.automation_id){const e=m({requested:{table:h.cv,id:c.format.automation_id,spaceId:c.space_id},requester:R});e&&(c.format.automation_id=e.id)}"collection"===l.parent_table&&l.type===r.Ti.copyIndicator&&c.properties&&(0,z.Yd)(c.properties).length>0&&(c.type=r.Ti.page);if(v.blocksShouldUseCrdt&&(c.format={...c.format,use_crdt:!0},(0,r.h5)(c.type))){var ee;const e=u.Z.createEmpty(c.id);null!==(ee=c.properties.title)&&void 0!==ee&&ee.length&&e.insertTextValue(0,c.properties.title),c.format={...c.format,text_slice_tree:d.Z.serialize(e),text_clocks:d.Z.serializeClocks(e)}}if(!v.preserveSourceMetadataTimestamps){const e=Date.now();c.created_time=e,c.last_edited_time=e}C&&(c.last_edited_by_id=C.id,c.last_edited_by_table=C.table,c.created_by_id=C.id,c.created_by_table=C.table);return{duplicateRecord:c,additionalRecords:D}}({originalBlock:n,duplicateBlock:e,mapper:a,options:c??{},rewiredUriMap:q,typedCollectionViewBlocks:G,originOptions:m,actor:C,helperRecordMap:M,factoryButtonDeprecationContext:K});Y.push(...t)}else if(t===Z.v){!function(e,t,n,o,i){var r,a,s,c;const d={table:Z.v,id:e.id,spaceId:e.space_id};null!==(r=e.format)&&void 0!==r&&r.app_config_uri&&(i[e.id]=t.id);if((0,g.e)(e.id)){if(t.format||(t.format={}),t.format.copied_from_pointer={table:Z.v,id:e.id,spaceId:e.space_id},void 0!==t.format.collection_default_template&&"empty"!==t.format.collection_default_template){const e=n({requested:{table:b.iU,id:t.format.collection_default_template.template_page_id},requester:d});e&&(t.format.collection_default_template={template_page_id:e.id})}t.copied_from=e.id}const u=n({requested:{table:t.parent_table,id:t.parent_id},requester:d});u&&(t.parent_id=u.id);const p=l.oC(t);for(const f in p){const e=p[f];if(e&&"relation"===e.type&&l.j0(e)){const t=n({requested:l.j0(e),requester:d});t?(e.collection_id=t.id,e.collection_pointer={id:t.id,table:Z.v,spaceId:(0,O.C)(t.spaceId)}):e.property&&(e.property=(0,R.ZP)())}e&&"title"===e.type&&t.name&&(t.name=ne({...o,text:{value:t.name,spaceId:t.space_id},mapper:n,requester:d,resolveTemplateVariables:!1}))}t.description&&(t.description=ne({...o,text:{value:t.description,spaceId:t.space_id},mapper:n,requester:d,resolveTemplateVariables:!1}));for(const l in p){const e=p[l];if(!e||"formula"!==e.type||"v2"!==e.version||!e.formula2)continue;const t=(0,w.Wo)(e.formula2.code,n,d);e.formula2.code=t}t.template_pages&&(t.template_pages=t.template_pages.map((e=>{var t;return(null===(t=n({requested:{table:b.iU,id:e},requester:d}))||void 0===t?void 0:t.id)||e})));if(null!==(a=t.format)&&void 0!==a&&a.collection_mode&&"page_tree"===t.format.collection_mode.type){var m;const e=t.format.collection_mode.root_page_pointer,o=(null===(m=n({requested:E.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:d}))||void 0===m?void 0:m.id)||e.id;t.format.collection_mode={type:"page_tree",root_page_pointer:{id:o,table:"block",spaceId:t.space_id}}}null!==(s=t.format)&&void 0!==s&&s.related_external_object_uris_to_instance_ids&&(t.format.related_external_object_uris_to_instance_ids=(0,H.m8)((0,z.qP)(t.format.related_external_object_uris_to_instance_ids).map((e=>{var o;let[i,r]=e;return[i,(null===(o=n({requested:{table:Z.v,id:r,spaceId:t.space_id},requester:d}))||void 0===o?void 0:o.id)||r]}))));delete t.deleted_schema,null!==(c=t.format)&&void 0!==c&&c.automation_ids&&(t.format.automation_ids=t.format.automation_ids.map((e=>{var o;return null===(o=n({requested:{id:e,table:h.cv,spaceId:t.space_id},requester:d}))||void 0===o?void 0:o.id})).filter(z.$K))}(n,$,a,m,q)}else if(t===L.n){!function(e,t,n,o){var i,r,a,l,c,d;const u={table:L.n,id:e.id,spaceId:e.space_id};null!==(i=e.format)&&void 0!==i&&i.app_config_uri&&null!==(r=t.format)&&void 0!==r&&r.app_config_uri&&((0,_.iA)(e.format.app_config_uri)?t.format.app_config_uri=void 0:o[e.id]=t.id);const p=null===(a=t.format)||void 0===a?void 0:a.collection_pointer;if(p){const e=n({requested:p,requester:u})||p;t.format={...t.format,collection_pointer:e}}if(t.format){var m;const e=null===(m=t.format.collection_groups)||void 0===m?void 0:m.map((e=>{if("relation"===e.value.type&&(0,s.RA)(e.value.value)&&e.value.value){return{...e,value:{type:"relation",value:n({requested:e.value.value,requester:u})}}}return e}));if(t.format.collection_groups=e,void 0!==t.format.collection_view_default_template&&"empty"!==t.format.collection_view_default_template){const e=n({requested:{table:b.iU,id:t.format.collection_view_default_template.template_page_id},requester:u});e&&(t.format.collection_view_default_template={template_page_id:e.id})}}const f=n({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:u});f&&(t.parent_id=f.id);t.page_sort&&(t.page_sort=t.page_sort.map((e=>{var o;return(null===(o=n({requested:{table:b.iU,id:e,spaceId:t.space_id},requester:u}))||void 0===o?void 0:o.id)||e})));if("page"===t.type&&null!==(l=t.format)&&void 0!==l&&l.page_pointer){var g;const e=t.format.page_pointer,o=(null===(g=n({requested:E.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:u}))||void 0===g?void 0:g.id)||e.id;t.format.page_pointer={table:"block",id:o,spaceId:t.space_id}}if(null!==(c=t.format)&&void 0!==c&&c.property_filters){const e=t.format.property_filters;for(const t of e)t.filter&&X(t.filter,(e=>{var t;return null===(t=n({requested:e,requester:u}))||void 0===t?void 0:t.id}))}if(null!==(d=t.format)&&void 0!==d&&d.filters2){const e=t.format.filters2;for(const t of e)t.filter&&X(t.filter,(e=>{var t;return null===(t=n({requested:e,requester:u}))||void 0===t?void 0:t.id}))}const h=t.query2;h&&h.filter&&X(h.filter,(e=>{var t;return null===(t=n({requested:e,requester:u}))||void 0===t?void 0:t.id}))}(n,$,a,q)}else t===V.qF?function(e,t,n,o){const i={table:V.qF,id:e.id,spaceId:e.space_id},r=n({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:i});r&&(t.parent_id=r.id);t.comments&&(t.comments=t.comments.map((e=>{var o;return(null===(o=n({requested:{table:j.x_,id:e,spaceId:t.space_id},requester:i}))||void 0===o?void 0:o.id)||e})));t.context&&(t.context=ne({...o,text:{value:t.context,spaceId:t.space_id},mapper:n,requester:i,resolveTemplateVariables:!1}))}(n,$,a,m):t===j.x_?function(e,t,n,o){const i={table:j.x_,id:e.id,spaceId:e.space_id},r=n({requested:E.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:i});r&&(t.parent_id=r.id);t.text&&(t.text=ne({...o,text:{value:t.text,spaceId:t.space_id},mapper:n,requester:i,resolveTemplateVariables:!1}));if(t.content)for(const[s,l]of t.content.entries()){var a;const e=(null===(a=n({requested:E.dr.fromPointerLike({table:b.iU,id:l,spaceId:t.space_id}),requester:i}))||void 0===a?void 0:a.id)??l;t.content[s]=e}}(n,$,a,m):t===U.yo?function(e,t,n,o){const i={table:U.yo,id:e.id,spaceId:e.space_id},r=n({requested:E.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:i});r&&(t.parent_id=r.id)}(n,$,a):t===h.cv?function(e,t,n,i,r){const a={table:h.cv,id:e.id,spaceId:e.space_id},s=n({requested:E.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:a}),l=(null==s?void 0:s.id)||t.parent_id,c=(t.action_ids??[]).map((e=>{var o;return(null===(o=n({requested:E.dr.fromPointerLike({table:v.Xj,id:e,spaceId:t.space_id}),requester:a}))||void 0===o?void 0:o.id)??e}));ee({duplicate:t,newParentId:l,newActionIds:c,originOptions:i,actor:r}),(0,o.Vd)(t)&&function(e){const{duplicate:t,mapper:n,requester:o}=e,i=t.trigger.event.source;if(!(0,z.$K)(i))throw new Error("Duplicated automation is missing trigger source - undefined");if("collection"===i.type){const e=n({requested:i.pointer,requester:o});if(!e)throw new Error("Duplicated automation is missing trigger source - Collection");if(e.table!==Z.v)throw new Error(`Duplicated automation has mismatch trigger target. Wanted: Collection, got ${e.table}`);if(void 0!==e.spaceId&&e.spaceId!==t.space_id)throw new Error(`Duplicated automation has mismatch workspace id. Wanted: ${t.space_id}, got ${e.spaceId}`);i.pointer={...e,spaceId:t.space_id}}else if("collection_view"===i.type){const e=n({requested:i.pointer,requester:o});if(!e)throw new Error("Duplicated automation is missing trigger source - Collection View");if(e.table!==L.n)throw new Error(`Duplicated automation has mismatch trigger target. Wanted: Collection View, got ${e.table}`);if(void 0!==e.spaceId&&e.spaceId!==t.space_id)throw new Error(`Duplicated automation has mismatch workspace id. Wanted: ${t.space_id}, got ${e.spaceId}`);i.pointer={...e,spaceId:t.space_id}}else"filter"===i.type||(0,z.t1)(i)}({duplicate:t,mapper:n,requester:a})}(n,$,a,m,C):t===v.Xj?function(e){const{original:t,duplicate:n,mapper:o,getRecordRole:r,originOptions:a}=e,s=t.space_id!==n.space_id,l={table:v.Xj,id:t.id,spaceId:t.space_id},c=o({requested:E.dr.fromPointerLike({table:n.parent_table,id:n.parent_id,spaceId:n.space_id}),requester:l});let d=r;(function(e,t){if(!e.config)return;const n=(e,n)=>({spaceId:n.spaceId,...t({id:n.id,table:n.table,spaceId:n.spaceId}),table:e});if("create_page"===e.type)e.config.collection&&(e.config.collection=n(Z.v,e.config.collection)),e.config.template_page_id&&(e.config.template_page_id=n(b.iU,{id:e.config.template_page_id,table:b.iU,spaceId:e.space_id}).id);else if("query_collection"===e.type)e.config.collection&&(e.config.collection=n(Z.v,e.config.collection));else if("update_pages"===e.type){const o=e.config.target;o&&("collection"===o.type?(o.collection=n(Z.v,o.collection),o.filter&&X(o.filter,(e=>{var n;return null===(n=t(e))||void 0===n?void 0:n.id}))):"variable"===o.type||("page"===o.type?o.page=n(b.iU,o.page):(0,z.t1)(o)))}else if("open_page"===e.type){const t=e.config.target;t&&("page"===t.type?t.page=n(b.iU,t.page):"variable"===t.type||(0,z.t1)(t))}else"duplicate_blocks"===e.type||"modal_confirmation"===e.type||"slack_notification"===e.type||(0,z.t1)(e)})(n,(e=>{const t=o({requester:l,requested:e});return t?(d=D.DH.tryUntilFound(D.DH.constantForPointer(t,"editor"),d),t):s?(d=D.DH.tryUntilFound(D.DH.constantForPointer(e,"none"),d),e):e})),function(e){const{automationAction:t,requester:n,mapper:o,originOptions:r}=e,a=(0,i.z)(t.type);function s(e){const i=(0,w.MY)(e);if("action"===i.source){var r;const e=(null===(r=o({requester:n,requested:{id:i.action_id,table:v.Xj,spaceId:t.space_id}}))||void 0===r?void 0:r.id)??i.action_id;return(0,w.Kd)({...i,action_id:e})}if("global"===i.source)return e;(0,z.t1)(i)}const l=f.kk.fromValue(v.Xj,t),c=a.acceptFormulaVisitor({action:l,visitor:{visitFormula:e=>{const i=(0,k.Zw)(e,s);let a;return a=i.value?{...i,value:ne({...r,text:{value:i.value,spaceId:t.space_id},mapper:o,requester:n,resolveTemplateVariables:!1})}:i,{type:"replace",value:a}},visitVariableOutsideOfFormula:e=>({type:"replace",value:s(e)})}}),d=B.Ak.create();d.setValue(l.pointer,t),(0,T.FS)({recordMap:d,operations:c,updateOnly:!1});const u=d.getValue(l.pointer);if(!u)throw new Error("Updated automation action not found in record map");t.config=u.config}({automationAction:n,mapper:o,requester:l,originOptions:a});const u=(null==c?void 0:c.id)??n.parent_id;te({original:t,duplicate:n,newParentId:u,getRecordRole:d});const p=(n.blocks??[]).map((e=>{var t;return null===(t=o({requested:E.dr.fromPointerLike({table:b.iU,id:e,spaceId:n.space_id}),requester:l}))||void 0===t?void 0:t.id})).filter(z.$K);n.blocks=p.length>0?p:void 0}({original:n,duplicate:$,mapper:a,getRecordRole:W,originOptions:m}):t===N.AT?function(e){let{original:t,duplicate:n,mapper:o,originOptions:i}=e;const r={table:N.AT,id:t.id,spaceId:t.space_id},a=o({requested:E.dr.fromPointerLike({table:n.parent_table,id:n.parent_id,spaceId:n.space_id}),requester:r});a&&(n.parent_id=a.id)}({original:n,duplicate:$,mapper:a,originOptions:m}):(0,z.t1)(t);return{duplicateRecord:$,additionalRecords:Y}}function X(e,t){if(a.vA(e)){(e.filters||[]).forEach((e=>X(e,t)))}if(a.aN(e)){if(a.e(e.filter)){const n=e.filter;if("relation_contains"===n.operator||"relation_does_not_contain"===n.operator)if(Array.isArray(n.value)){const e=n.value.map((e=>{const n=e.type;if("exact"===n){const n=e.value;return{type:"exact",value:n&&t({table:b.iU,id:n})||n}}if("relative"===n)return e;(0,z.t1)(n)}));n.value=e}else{const e=n.value.type;if("exact"===e){const e=n.value.value;n.value.value=e&&t({table:b.iU,id:e})||e}else{if("relative"===e)return;(0,z.t1)(e)}}}if(a.a_(e.filter)){const n=e.filter.subfilter;if(a.e(n)){const e=n;if("relation_contains"===e.operator||"relation_does_not_contain"===e.operator)if(Array.isArray(e.value)){const n=e.value.map((e=>{const n=e.type;if("exact"===n){const n=e.value;return{type:"exact",value:n&&t({table:b.iU,id:n})||n}}if("relative"===n)return e;(0,z.t1)(n)}));e.value=n}else{const n=e.value.type;if("exact"===n){const n=e.value.value;e.value.value=n&&t({table:b.iU,id:n})||n}else{if("relative"===n)return;(0,z.t1)(n)}}}}}}function ee(e){const{duplicate:t,newParentId:n,newActionIds:o,actor:i}=e;t.parent_id=n,t.action_ids=o;const r=Date.now();t.created_time=r,t.last_edited_time=r,i&&(t.last_edited_by_id=i.id,t.last_edited_by_table=i.table,t.created_by_id=i.id,t.created_by_table=i.table)}function te(e){const{original:t,duplicate:n,newParentId:o,getRecordRole:i}=e;n.parent_id=o,t.space_id!==n.space_id&&"slack_notification"===n.type&&(n.config={});const r=(0,c.o0)(n);if(r){r.some((e=>{const t=i(e.pointer);return!t||!(0,P.yY)(t,e.minimumRequiredRole)}))&&(n.config={})}}function ne(e){const{text:t,mapper:n,requester:o,resolveTemplateVariables:i,baseUrl:r,publicDomainName:a}=e;if(void 0!==t)return t.value.map((e=>function(e){const{token:t,mapper:n,requester:o,resolveTemplateVariables:i,baseUrl:r,publicDomainName:a}=e;let s;const l=y.hDy(t.token).map((e=>{if(y.STW(e)){const t=y.yrl(e);if(t){const e=n({requested:t,requester:o});if(e)return y.$0A(e.id,e.spaceId)}}if(y.j0F(e)){const t=y.zW$(e),i=(0,C.A5)({url:t,baseUrl:r,publicDomainName:a});if(i){const e=n({requested:{table:b.iU,id:i,spaceId:(0,O.C)(void 0)},requester:o});if(e)return y.edl((0,C.nR)({pageId:e.id}))}}if(y.nSN(e)){const t=y.frW(e);if(t){const e=n({requested:{table:b.iU,id:t,spaceId:(0,O.C)(void 0)},requester:o});if(e)return y.x36(e.id)}}if(y.xw5(e)){const i=y.h19(e),r=n({requested:{table:V.qF,id:i,spaceId:t.spaceId},requester:o});if(r)return y.jw(r.id)}if(y.aq(e)&&i){const t=y.x5L(e,i);if(t&&y.IWo(t)&&i){const e=y.zEN(t);if(e===i.currentUserId){if(s)return;s=e}}return t}if(y.IWo(e)&&i){const t=y.zEN(e);if(t===i.currentUserId){if(s)return;s=t}}return e})).filter(z.$K);return y.V3y(y.WiV(t.token),l)}({token:{token:e,spaceId:t.spaceId},mapper:n,requester:o,resolveTemplateVariables:i,baseUrl:r,publicDomainName:a})))}function oe(e){const{rootSourceBlockIds:t,childSourcePointer:n,getSourceRecordValue:o}=e;for(const i of(0,M.BW)(n,o))if(ie({rootSourceBlockIds:t,recordWithTable:i}))return!0;return!1}function ie(e){const{recordWithTable:t,rootSourceBlockIds:n}=e;if(t.table!==b.iU)return t.table===v.Xj;if(n.includes(t.value.id))return!1;if(f.kk.fromBlock(t.value).isTemplateVariableContainerBlock())return!0}},5220:(e,t,n)=>{n.d(t,{H:()=>a});var o=n(59730),i=n(90965),r=n(47425);function a(e){let{spaceModel:t,userId:n}=e;if(!t||!n)return!1;return void 0===function(e){const{spaceModel:t,userId:n}=e;if(!(0,i.wv)({permissions:t.getPermissionItems()},n))return new o.XV("You do not have permissions to this feature in the requested space.",{type:"generic_insufficient_permissions"});if(!(0,r.wP)(t.getSubscriptionTier()))return new o.XV("The feature is not available on your current plan type.",{type:"generic_insufficient_plan_type"})}({spaceModel:t,userId:n})}},55632:(e,t,n)=>{n.d(t,{HX:()=>v,fK:()=>h,$A:()=>g,Jq:()=>b,j2:()=>p,Pv:()=>y,j:()=>S});var o=n(15145),i=n(29450);var r=n(68626),a=n(72126),s=n(91155),l=n(4615);var c=n(64002);const d=new o.nY((async e=>{const{config:t,deviceId:i,disableCookies:r}=e,a=await n.e(9543).then(n.t.bind(n,16791,23));return await new Promise((e=>{const n=t.amplitude&&t.amplitude.apiKey;if(!n)return e(void 0);const s=new URL(t.domainBaseUrl),d=`${s.host}${t.api.http}/teV1`;let u=!0;"http:"===s.protocol&&(u=!1);const p=i?(0,l.XR)(i):void 0;a.getInstance("eventTrailApi").init(n,"",{apiEndpoint:d,forceHttps:u,includeReferrer:!0,includeUtm:!0,includeFbclid:!0,includeGclid:!0,unsetParamsReferrerOnNewSession:!1,saveParamsReferrerOncePerSession:!1,storage:r?"none":"",saveEvents:!r,deviceId:p},(n=>{n&&n.setVersionName((t.env,"2023092001")),e(n),function(){const e=(0,c.gy)(window.location.href);if(!e)return;const t={utm_campaign:e.searchParams.get("utm_campaign")||o.cL,utm_content:e.searchParams.get("utm_content")||o.cL,utm_medium:e.searchParams.get("utm_medium")||o.cL,utm_source:e.searchParams.get("utm_source")||o.cL,utm_term:e.searchParams.get("utm_term")||o.cL};h({traits:(0,o.bt)({...t})})}()}))}))}));function u(e,t,n){return function(o,i,l){if(200===o&&"success"===i)return;const c=a.CE(t,"experiments"),d={data:{responseBody:i,eventName:e,eventData:c,groupData:n},statusCode:o,message:null==l?void 0:l.reason};r.log({level:"error",from:"eventTrailApiHelpers",type:"trackFailure",error:(0,s.Ui)(d)})}}async function p(e){const{config:t,isEnabled:n,deviceId:o}=e,a=!(0,i.hasPermissionForThirdPartyServiceBrowser)("amplitude");try{await d.load({config:t,isEnabled:n,deviceId:o,disableCookies:a})}catch(l){r.log({level:"error",from:"eventTrailApiHelpers",type:"initialize",error:(0,s.Ui)(l)})}}function m(e,t){const n=new e.Identify;if(t)for(const o of Object.keys(t)){const e=t[o];void 0!==e&&(Array.isArray(e)?n.append(o,e):n.set(o,e))}return n}function f(e,t,n){const o=t.userPropertiesOperations||{};n.logEvent(e,o,void 0,u(e,o))}async function g(e){const{userId:t,traits:n,spaceIds:o}=e,i=await d.getInstance();if(!i)return;i.setUserId((0,l.XR)(t));const r=m(i,n);o&&r.set("workspace",a.jj(o)),f("$identify_user",r,i)}async function h(e){const{traits:t}=e,n=await d.getInstance();if(!n)return;const o=new n.Identify;for(const i of t)"set"===i.operation?o.set(i.name,i.value):"setOnce"===i.operation&&o.setOnce(i.name,i.value);f("$identify_device",o,n)}async function v(){const e=await d.getInstance();null==e||e.setUserId(null)}async function b(e){const{spaceId:t,spaceData:n}=e;if(!t)return;const o=await d.getInstance();if(!o)return;const i=a.d9(n),r=Object.entries(i).filter((e=>{let[t,n]=e;return Array.isArray(n)}));r.forEach((e=>{let[t,n]=e;return delete i[t]}));var s=m(o,i);r.forEach((e=>{let[t,n]=e;return s=s.set(t,n)})),o.groupIdentify("workspace",t,s)}async function y(e){const t=await d.getInstance();t&&t.setDeviceId((0,l.XR)(e))}async function S(e){const{eventName:t,eventData:n,spaceId:o}=e,i=await d.getInstance();if(i)if(o){const e={workspace:o};i.logEventWithGroups(t,n,e,void 0,u(t,n,e))}else i.logEvent(t,n,void 0,u(t,n))}},12174:(e,t,n)=>{n.d(t,{DP:()=>g,KM:()=>p,LI:()=>_,TS:()=>h,XY:()=>b,YY:()=>k,_n:()=>I,b2:()=>y,dn:()=>S,g6:()=>i,l4:()=>v,nb:()=>C});var o=n(97880);const i={"search-vectors":["log-norm","min-max-norm","cohere-snippets"],"vector-search-vanilla-ltr":["on","force-disable"],"search-no-local-blending":["on"],"search-debug-only-no-recent-boosting":["on"],"search-clear-results-on-query-change":["on"],"search-shorten-inactive-timer":["0","10","30","60","90"],"search-use-qwak":["on","on:tensorops_dev_xgboost:50","on:tensorops_dev_xgboost:100","on:tensorops_dev_xgboost:200","on:tensorops_dev_playground:50","on:tensorops_dev_playground:100","on:tensorops_dev_playground:200","on:xgboost2ndcg_new:50","on:xgboost2ndcg_new_2:50"],"search-debug-only-force-random-sample":["on"],"search-debug-force-shuffle":["2","5","10"],"search-debug-force-log-signals":["on"],"search-more-recent-pages-in-local":["lazy-100","lazy-200","lazy-500","lazy-1000"],"search-intent-based-grouping-n-side-peek":["on"],"search-use-english-light-kstem":["on","locale"],"search-results-new-utilities":["on"],"search-includes-current-page-in-local-search":["on"],"search-client-ltr-v0":["ridgereg","logreg","svc"],"search-new-local-recall-v1":["popular_pages","sim_user_visits"],"search-block-text-queries":["v2"],"search-no-local-recent-records-invalidations":["on"],"search-query-expansion":["prefix-completion","word-splitting","spell-correction","all"]},r={teams_invite_link:["on"],team_invite_link_ms2:["on"],expandable_permission_items:["on"]},a={simplified_email_subject_line:["on"],improved_product_notif_email_and_settings:["on"],mobile_push_notification_v2:["on"],mobile_push_notification_v2_actions:["on"],inbox_2_0:["on"]},s={onboarding_creator_no_joinable_spaces:["on"],onboarding_creator_no_joinable_spaces_v2:["on"],new_page_suggested_templates:["variant_1","variant_2","variant_3","variant_4"],acquisition_global_holdout_aa_testing:["on"],acq_simplify_enterprise_joiner_onboarding_flow_v1:["on"],page_invite_message:["control","variant_1","variant_2"],magic_link_email:["directed_to_creators","directed_to_joiners"],invitation_email_final_reminder:["on"],onboarding_invite_skip_button:["on"],share_modal_placeholder:["on"],share_modal_pending_invite_status_ui:["on"],invitation_modal_guest_vs_member_tag:["on"],invite_email_quotes:["on"],share_modal_guest_member_confirmation:["v1","v2"],page_invitation_email_selfserve_exp:["v1","v2","v3","v4"],app_template_removal:["on"],persona_survey_joiner:["banner_only","banner_with_survey"],share_modal_autofill_email:["control","v1"],humanize_page_invite_joiner_email_copy:["on"],persona_template_truncation:["on"],acq_person_property_invite_v1:["on"],rename_general_teamspace:["on"],simplify_template_options:["v1","v2"],block_names_in_six_dot_menu:["on"],delay_invite_your_team_email:["on"]},l={in_app_contact_sales_cta_billing:["on"]},c={block_limit_increase:["on"],block_limit_reduction:["on"],churn_nudge:["on"],contraction_confirmation:["on"],contraction_confirmation_survey:["on"],largesse:["on"],mobile_web_subscriptions:["on"],pricing_page_optimizations:["on"],pricing_plans_v3:["on"],quick_workspace_creation:["on"],subscription_payment_status:["message_only","on"],subscription_default_annual:["on"],subscription_elements:["payment_and_address","payment"],tt_me_pregunto:["on"],tt_pp:["on"],upsell_colors:["on"]},d={csv_adaptiveschema:["on"],csv_column_limit:["on"]},u={log_in_from_template_duplication:["on"],template_duplication_topbar:["on","variant_2"],public_page_template_sidebar:["on"]},p=["beta","alpha","canary","development","ai_team"],m={assistant_variant:p,qna_answer_using:["anthropic-qa-alpha","anthropic-1","openai-2","openai-5"]},f={"indexeddb-transaction-timeout-v2":["on"],"product-page-length":["no-demo","short-scroll","shortest-scroll"],"remove-profile-photo-string":["on"],"heath-ceramics":["on"],csat:["on"],"template-checklist":["on"],mermaid:["on"],polyglot:["on"],rc:["on"],"ios-json-bridge-v2":["on"],"clear-record-cache-on-login":["on"],"await-update-user-id":["on"],aloha:["on"],"multi-select-new-page-view-block-layout":["on"],"embed-previews":["on"],"beta-developers-external":["on"],"db-sync":["on"],janus:["on"],"mobile-drag-delay":["1000","600","700","800","900","1100","1200","1300","1400","1500"],"android-context-menu":["on"],"mobile-bottom-bar-ios-v4":["on"],"lucy-in-the-sky-with-tab-blocks":["on"],"messagestore-ios-v3":["on"],"home-ios":["on"],"home-ipad":["on"],"home-android":["on"],"txnqueue-ios-v6":["on"],"onboarding-emails":["generic","meeting-notes-focused"],patchExternalCollection:["on"],"emoji-apple-spritesheets":["enabled"],"default-new-page-property-to-hide-when-empty":["on"],"android-background-bridge-message-parsing":["on"],"columns-full-width":["on"],"notion-to-slack":["on"],"notion-mentions-to-slack":["on"],slash_menu_spaces_preceding:["on"],geo_ip_lookup_database:["on"],database_sync_for_google_calendar:["on"],database_sync_for_gitlab:["on"],database_sync_for_asana:["on"],enforce_enterprise_tier_for_scim:["on"],collections_workspace_client_mode:["on_200","on_500","on_1000"],...i,...r,...a,...s,...l,...c,...u,...d,"newer-primus":["on"],sort_indexeddb_tasks_by_index:["on"],marketing_home_page_hero_signup:["test","focus","work"],marketing_home_hero_text:["V1","V2","V3"],above_the_fold_product:["V1","V2","V3","V4"],marketing_contact_3_new_fields:["test"],template_gallery_web:["on"],invite_members_from_share_menu:["on"],try_notion_cta:["V1","V2","V3","V4","V5"],statsig_space_id_debug:["on"],enforce_write_once_permissions_for_block_updates:["on"],"contextual-invite-on-select-focus":["on"],integration_discovery:["top_left_sidebar","bottom_right_button"],zendesk:["on"],relations_sections:["on"],collection_table_drag_and_fill:["on"],collection_client_refetch_throttle_time_ms:["2000","3000","5000"],collections_loading_state:["on"],highlight_legacy_transclusions:["on"],lightbox_v2:["on"],user_similarity_debugging:["on"],log_iframely_results:["on"],iframely_switch:["on"],prompt_work_account_sidebar:["on"],request_membership:["on"],parallel_confluence_importer:["on"],parallel_confluence_importer_via_api:["on"],special_case_confluence_file_size:["on"],confluence_dynamic_batch_size_temp:["on"],confluence_server_allow_requests:["on"],confluence_logs:["on"],confluence_api_v2:["on"],send_notification_for_transfer_content:["on"],use_inert_html_attribute:["on"],box_file_picker:["on"],guest_membership_request:["on"],link_preview_resizing:["on"],link_preview_resizing_api:["on"],google_external_integration_file_picker:["on"],enable_google_drive_external_integration:["on"],import_slack_contacts:["on"],my_home:["on"],show_instruction_on_auth_popup_blocked:["on"],block_property_router:["on","on_v2"],teamspace_guests:["on"],asana_max_task_limit:["on"],better_asana_importer:["on"],monday_importer:["on"],generic_importer:["on"],special_case_generic_file_size:["on"],asana_to_single_team_space:["on"],learn_notion_three_steps:["on"],state_manangement_in_asana_importer:["on"],android_3rd_party_login_with_external_browser:["on"],ios_3rd_party_login_with_external_browser:["on"],block_limit_delay:["on"],asana_import_by_batch:["on"],intro_share_tooltip_condition:["d3","b200"],ignore_non_renderable_blocks_in_export:["on"],prioritize_slash_menu_block_placeholder:["on"],joiner_subject_line_v2:["variant_1","variant_2","variant_3"],joiner_email_illustration:["joiner_email_illustration_on"],joiner_email_facepile:["on"],slash_menu_tooltip:["on"],redirect_after_passcode_sent:["with_gmail_cta","without_gmail_cta"],wiki_education_convert_modal:["bottom_right"],full_access_privacy_selector:["on"],avoid_empty_eoip_creation_unfurl_collection:["on"],local_currency_first_experiment:["on"],quick_capture_tasks_with_layer:["on"],mobile_voice_input:["web_system_api","native_system_api","third_party_whisper","third_party_deepgram"],page_tree_query:["cte","cte_and_dark_read_v1","v1_and_dark_read_cte"],random_house:["on"],...m,export_comments:["on"]};function g(e){return Boolean(f[e])}const h=new Set([]),v=["log_iframely_results","iframely_switch","database_sync_for_google_calendar","database_sync_for_gitlab","database_sync_for_asana","enforce_enterprise_tier_for_scim","slash_menu_spaces_preceding","geo_ip_lookup_database","sort_indexeddb_tasks_by_index","marketing_contact_3_new_fields","marketing_home_page_hero_signup","marketing_home_hero_text","above_the_fold_product","invite_members_from_share_menu","try_notion_cta","contextual-invite-on-select-focus","enforce_write_once_permissions_for_block_updates","integration_discovery",...(0,o.Yd)(r),"zendesk","highlight_legacy_transclusions","lightbox_v2","relations_sections","collection_table_drag_and_fill","prompt_work_account_sidebar","request_membership","special_case_confluence_file_size","special_case_generic_file_size","confluence_dynamic_batch_size_temp","confluence_server_allow_requests","confluence_logs","user_similarity_debugging","send_notification_for_transfer_content","use_inert_html_attribute","box_file_picker","google_external_integration_file_picker","guest_membership_request","link_preview_resizing","link_preview_resizing_api","enable_google_drive_external_integration","import_slack_contacts","show_instruction_on_auth_popup_blocked","parallel_confluence_importer","parallel_confluence_importer_via_api","confluence_api_v2",...(0,o.Yd)(i),...(0,o.Yd)(s),...(0,o.Yd)(l),"block_property_router",...(0,o.Yd)(c),...(0,o.Yd)(u),...(0,o.Yd)(d),"teamspace_guests","asana_max_task_limit","better_asana_importer","monday_importer","generic_importer","asana_to_single_team_space","state_manangement_in_asana_importer",...(0,o.Yd)(a),"learn_notion_three_steps","android_3rd_party_login_with_external_browser","ios_3rd_party_login_with_external_browser","collection_client_refetch_throttle_time_ms","block_limit_delay","asana_import_by_batch","intro_share_tooltip_condition","ignore_non_renderable_blocks_in_export","prioritize_slash_menu_block_placeholder","joiner_subject_line_v2","joiner_email_illustration","joiner_email_facepile","slash_menu_tooltip","redirect_after_passcode_sent","wiki_education_convert_modal","full_access_privacy_selector","avoid_empty_eoip_creation_unfurl_collection","local_currency_first_experiment","collections_workspace_client_mode","quick_capture_tasks_with_layer","collections_loading_state","mobile_voice_input","page_tree_query","random_house",...(0,o.Yd)(m),"export_comments"],b=[...v].sort(),y=["polyglot","enforce_write_once_permissions_for_space_updates","person_vote","allow_dead_space_views_when_joining_space","throw_on_changing_unmanaged_scim_user","log_all_headers_for_unknown_scim_idp","enable_get_private_page_info_endpoint","wiki_database","log_saml_response_on_error","wiki_query_killswitch","default_person_property","connected_relation","enable_search_team_filter","expiring_public_links","enable_property_view_icons","enable_emoji_icon_color_picker","collection_dependencies","relation_left_properties","button_property","text_selection_completions","new_page_completions","completions_chat","database_sync_ugc","triage_notification_can_read","admin_content_search_tab","model-2","model-3","model-4","model-5","japan_full_launch","event_trail_router_v2","ai_waitlist_in_app_popup","model-2-space","model-3-space","model-4-space","model-5-space","public_api_dev_mode","optimize_single_workspace","enabled_bev_default_audience_filter","sprig","ai_multi_level_undo","ai_favorites","enable_ai_add_on","autoretry_file_uploads","audit_log_enterprise_cache_check","enable_secure_file_url_for_user","jit_onboarding_improvements","prevent_saml_guest_login","saml_hide_onboarding_password","free_tier_sync_database","developer_integration_form_redesign","return_scim_errors_to_client","use_secure_file_url_for_audit_log","use_secure_file_url_for_space_export","use_secure_file_url_for_block_export","return_404_on_scim_get_for_user_not_in_workspace","client-performance-profiler","react_18_concurrent_rendering","customerio","dev_only_show_updates_filters","property_updates_notifications","product_notif_email_improvements","enable_notifications_processor","sidebar_pages_hide_toggles","prefetch_spaces","sidebar_home_gate","home_show_tips","sidebar_home_v2_gate","team_add_app_template_tooltip","new_share_menu_tooltip","optimize_fetch_user_content_emit","load_cached_page_chunk_no_space","send_reminder_log_debugging","allow_experimental_home_features","collections_relation_picker_require_edit_perms","typed_db_creation","proj_management_sprints_upgrade","proj_management_tooltip_tour","unique_id","formulas_dark_read","db_view_scrolling_refactor","sync_collection_relation_as_admin","typed_db_migration","collections_bulk_relation_sync_queue_enabled","property_descriptions","collection_subitem_nested_operations","collection_level_subitems_setting","duplicate_collection_schema","webhooks_beta","public_api_developer_survey","e_discovery","add_comments_on_blocks","install_dlp_integrations","public_api_use_secure_file_proxy","enable_midterm_subscription_changes","upgrade_modal_ai_option","advanced_security_in_enterprise","estudiantes","deny_multiplayer_personal_plan_upgrade","in_app_template_gallery","template_submission_form","layout_collection_view_page","layout_side_peek_page","layout_editor_on_the_grid","layout_main_frame_page","layout_toggles","csv_validation_errors_fix","card_details_unified","trello_pagination_enabled","trello_media_queue","enable_text_crdt_server","enable_text_crdt_client","block_attribution","space_consolidation_ga","desktop_app_login_with_email_redirect","ai_property_autofill_v2","desktop_app_signup_hide_passcode","ios_app_signup_hide_passcode","better_asana_import_task_dependency","user_data_consent_admin_bypass","goodbye_credits","link_preview_auth_with_server_integration","formulas_prototype","formula_buttons","ai_onboarding_logging","enable_deleted_page_indicator","onetrust_onboarding_checkbox","forethought","survey_data_writes","typed_db_improvements_property_restrictions","typed_db_improvements_announcement","enable_refetch_eoi_blocks_on_retry","adding_extra_logs_in_eoi_retry_fg","snapshot_optional_collection_rollback_enabled","prevent_login_with_temporary_password","saml_throw_on_temporary_password_use_case_mismatch","saml_enforced_disallow_send_temporary_password","audit_log_aes_event_read","audit_log_permanently_deleted_filter_enable","audit_log_event_name_column","guest_invite_requests","drawing_block","cross_domain_device_id_tracking_serverside","duplcate_template_tracking_serverside","disable_ai_big_red_button","ai_data_sharing","convert_cut_paste_to_move","text_align","enable_giphy_feature_gate","dependency_date_shifting_by_space","admin_content_search_only_search_titles","legacy_slack_notifications","overlay_trap_focus","mobile_better_filing_eligibility","server_dispatch_recents_background_fetch","client_handle_query_collection_locally","onetrust_onboarding_unsub_link","experimental_non_page_block_links","google_drive_connected_relation","figma_connected_relation","zendesk_connected_relation","cron_connected_relation","zendesk_ai_enabled","toggleable_transcript","use_assembly","transcript_feedback_button","space_for_ai_tooltip_enabled","log_page_exit_events_to_analytics","export_collections_v1","use_new_export_notification","message_store_client_send_request_metric_enabled","template_gallery_web","response_size_instrumentation","append_favorites","permanently_delete_tree","collection_properties_select_auto_sort_options","collection_typed_db_duplication","support_synced_database_automations","template-variable-properties","template_contentful_sync_job","mobile_bridge_performance_logging","ai_source_picker","client_http_gzip","is_visibility_enabled_for_db_sync","disable_poll_jobs_for_collection_entities","export_new_structure","embed_block_fallback","automation_update_pages_batching","topbar_connection_indicator_v2","delete_kvs","force_kvs_break","add_ai_summary_button_transcript","enable_guest_export","animated_use_css_transition","perform_get_latest_activity_queries_sequentially","autofill_translate","scim_post_user_version_conflict","collections_view_specific_client_mode_enabled","autofill_tags","autotag_ambient_trigger","ghost_block_explorations","typed_move_to_improved_search","first_party_links","search_index_collection_ranking_features","ios_enable_prefetching","hide_orphan_blocks","wiki_perf_improvement_local_enabled","show_keep_existing_guests_modal","export_content_analytics_stream","export_admin_content_search_stream","export_puppeteer_upgrade","affiliates_s2s_routing","meeting_notes_transcript_consumer_setup","meeting_notes_transcript_new_consumer","enable_external_integration_auth_strict_access","student_form","native-find-in-page","assistant-labeler-mode","assistant_writer","vector_db_search","vector-search-live-indexing","embeddings-enabled-for-spaceid","qna-slack-workspaces","vector-spans-instead-of-load-page","people_profile_popup","collection_split_aggregation_v2","search_modal_qna","send_student_form_error_messages","recurrence_queue_task_improvements","enterprise_launch_modal","quick_search","share_modal_invalid_invite_tokens","search_toggle_side_peek","update_space_permissions_if_no_records","improved_asana_importer_screens","disable_storage_manager_estimate","force_use_in_memory_transaction_queue_for_safari","recurring_sprints"],S=[...y].sort(),_={event_trail_events:{},event_trail_routing:{},collection_request_settings:{clientFormulaTimeoutMs:3e5},sentry:{errorsSampleRate:0,"tracesSampleRate-v0":0,"replaysSessionSampleRate-v0":0,"replaysOnErrorSampleRate-v0":0,profilesSessionSampleRate:0,profilesSampleRate:0},gtm_ai_favorites:{space_id:void 0,collection_id:void 0},palette:{"sessionSampleRate-v4":0,pageLoadSampleIntervalMs:10,interactionSampleIntervalMs:10,maxBufferSize:1e5},permanently_delete_tree_queue_task_override:{queue_task_kill_switch_on:!1,task_delay_override_seconds:void 0,elastic_search_request_batch_size:200,s3_request_batch_size:200,redis_read_batch_size:1e4,tree_iteration_batch_size:1e4,tree_iteration_max_buffer_size:5e4,s3_isolation_project_done:!1},education_free_submit_form_config:{},notion_people_block_id:{data:{}},template_ids_to_use_duplicate_block:{data:[]},csv_limits:{maxRows:1e5,maxColumns:500}},w=new Set(v);function k(e){return w.has(e)}function I(e){return f[e]}const C="_unassigned_"},64962:(e,t,n)=>{n.d(t,{O:()=>F});n(57658);var o=n(66897),i=n(15145),r=n(15070),a=n(90559),s=n(35011),l=n(80951),c=n(34299),d=n(56373),u=n(1800),p=n(40506),m=n(7057),f=n(53877),g=n(61075),h=n(64572),v=n(72126),b=n(25718),y=n(59753),S=n(63306),_=n(21202),w=n(77420),k=n(6287),I=n(19889),C=n(70203),x=n(7928),T=n(63143),M=n(4308);const P=m.ZV;function A(e){return(0,g.hJ)({...e,fromString:e=>e}).join("")}function R(e){const{textValue:t}=e;if(t){const n=[];for(const o of t)C.QJH(o)||n.push(A({...e,textValue:[o]}));return n.join(", ")}return""}const D={[C.GKr.Page]:e=>{let{annotation:t,exportArgs:n}=e;const{getExportedPathToPage:o}=n,i=C.TOT(t),r=(0,g.Ho)({intl:n.intl,blockId:i,getRecordValue:n.getRecordValue,userTimeZone:n.userTimeZone}),a=o({toPageId:i});if(r&&a)return`${r} (${a})`},[C.GKr.Comment]:e=>{let{annotation:t,exportArgs:n}=e;const{getRecordValue:o,baseUrl:r}=n,a=y.om.fromGetRecordValueFn(o),s=C.$WM(t);if(!s)return;const l=a(s);if(!l)return;const c=l.getParentId(),d=l.getParentPointer(),p=(0,S.el)((0,S.DW)(d,o));if(!p)return;const m=a(d);let f;if(m){const e=a(m.getParentPointer());f=e&&"table_row"===e.getType()?e.getParentId():m.getParentId()}return(0,u.Z)({pageId:p.id,scrollToBlockId:f,pageValue:p,baseUrl:r,discussionId:c,pageVisitSource:i.tY.Export})},[C.GKr.Link]:e=>{let{annotation:t,exportArgs:n}=e;const{getExportedPathToFile:o,getExportedPathToPage:i,navigableBlockId:r,baseUrl:a,publicDomainName:s}=n,l=C.zW$(t),c=(0,h.A5)({url:l,baseUrl:a,publicDomainName:s});return c?i({toPageId:c}):o({fromBlockId:r,toFileURI:l})},[C.GKr.User]:e=>{let{annotation:t,exportArgs:n}=e;const{intl:o}=n,i=C.zEN(t),r=n.getRecordValue({table:I.KJ,id:i});if(r)return`@${(0,x.Nz)(o,r)}`},[C.GKr.Bot]:e=>{let{annotation:t,exportArgs:n}=e;const o=C._Rq(t),i=n.getRecordValue({table:w.cZ,id:o});if(i)return`@${(0,r.Mh)(i)}`},[C.GKr.Group]:e=>{let{annotation:t,exportArgs:n}=e;const o=(0,g.kF)({annotation:t,exportArgs:n});if(o)return o},[C.GKr.ExternalObjectInstance]:e=>{var t;let{annotation:n,exportArgs:o}=e;const i=C.frW(n);return null===(t=o.getRecordValue({table:_.iU,id:i,spaceId:o.root.spaceId}))||void 0===t||null===(t=t.format)||void 0===t?void 0:t.original_url},[C.GKr.Date]:e=>{let{annotation:t,exportArgs:n}=e;const{date_format:o,time_format:i,...r}=C.zyO(t);return`@${(0,m.ZV)({value:r,date_format:o,time_format:i,userTimeZone:n.userTimeZone,allowRelativeDates:!1,intl:n.intl})}`},[C.GKr.Equation]:e=>{let{annotation:t,exportArgs:n}=e;const o=(0,b.dx)(t),i=(0,b.wB)(t,n.getExportedPathToPage,n);return`${o}${C.xey(t)}${i}`},[C.GKr.Bold]:g.Hf,[C.GKr.Italic]:g.Hf,[C.GKr.Strike]:g.Hf,[C.GKr.Code]:g.Hf,[C.GKr.Highlight]:g.Hf,[C.GKr.Discussion]:g.Hf,[C.GKr.Underline]:g.Hf,[C.GKr.Inserted]:g.Hf,[C.GKr.Deleted]:g.Hf,[C.GKr.TemporaryComment]:g.Hf,[C.GKr.TemporaryEquation]:g.Hf,[C.GKr.TemporaryPage]:g.Hf,[C.GKr.TemporaryInput]:g.Hf,[C.GKr.TemporarySelection]:g.Hf,[C.GKr.TemporaryFindHighlight]:g.Hf,[C.GKr.TemplateVariable]:g.Hf,[C.GKr.FormulaPageProperty]:g.Hf,[C.GKr.FormulaContextValue]:g.Hf,[C.GKr.FormulaError]:g.Hf,[C.GKr.Citation]:g.Hf},B=()=>{},E=()=>Promise.resolve(void 0),F={blockRenderers:{text:B,header:B,sub_header:B,sub_sub_header:B,quote:B,bulleted_list:B,toggle:B,to_do:B,numbered_list:B,code:B,page:B,image:B,video:B,embed:B,bookmark:B,file:B,tweet:B,maps:B,gist:B,framer:B,invision:B,mixpanel:B,drive:B,figma:B,loom:B,pdf:B,typeform:B,codepen:B,audio:B,divider:B,equation:B,collection_view:B,collection_view_page:B,column_list:B,column:B,factory:B,copy_indicator:B,breadcrumb:B,link_to_collection:B,link_to_page:B,table_of_contents:B,callout:B,whimsical:B,miro:B,abstract:B,sketch:B,excalidraw:B,replit:B,alias:B,transclusion_container:B,transclusion_reference:B,external_object_instance:B,table:B,table_row:B,tab:B,hex:B,deepnote:B,external_object_instance_page:B,button:B,ai_block:B,drawing:B,personal_home_page:B},asyncBlockRenderers:{text:E,header:E,sub_header:E,sub_sub_header:E,quote:E,bulleted_list:E,toggle:E,to_do:E,numbered_list:E,code:E,page:E,image:E,video:E,embed:E,bookmark:E,file:E,tweet:E,maps:E,gist:E,framer:E,invision:E,mixpanel:E,drive:E,figma:E,loom:E,pdf:E,typeform:E,codepen:E,audio:E,divider:E,equation:E,collection_view:E,collection_view_page:E,column_list:E,column:E,factory:E,copy_indicator:E,breadcrumb:E,link_to_collection:E,link_to_page:E,table_of_contents:E,callout:E,whimsical:E,miro:E,abstract:E,sketch:E,excalidraw:E,replit:E,alias:E,transclusion_container:E,transclusion_reference:E,external_object_instance:E,table:E,table_row:E,tab:E,hex:E,deepnote:E,external_object_instance_page:E,button:E,ai_block:E,drawing:E,personal_home_page:E},annotationRenderers:D,propertyRenderers:{title:e=>A(e),text:A,select:e=>{const{textValue:t,propertySchema:n}=e,o=n.options||[];return l.Sj(t,o)},multi_select:e=>{const{textValue:t,propertySchema:n}=e,o=n.options||[],i=l.uP(t,o);return i.sort(),i.join(", ")},status:e=>{const{textValue:t,propertySchema:n}=e;return l.ZG(t,n)},relation:e=>{const{textValue:t,propertySchema:n,exportArgs:o}=e;if("relation"!==n.type)return;const i=l.j$({relationValue:l.rq(t),getRecordModel:y.om.fromGetRecordValueFn(o.getRecordValue),propertySchema:n}),r=l.ow(i);return R({...e,textValue:r})},rollup:e=>{const t=e.exportArgs.getRecordValue,n=y.kk.fromValue(_.iU,e.block),o=y.om.fromGetRecordValueFn(t);return c.kJ({...e,block:n,getRecordModel:o,collectionRequestContext:{userId:void 0,userTimeZone:e.exportArgs.userTimeZone,depth:0,intl:e.exportArgs.intl,visitedProperties:new Set,resultCache:{}}})},url:e=>{let{textValue:t}=e;return l.zB(t)},email:e=>{let{textValue:t}=e;return l.zB(t)},phone_number:e=>{let{textValue:t}=e;return l.zB(t)},checkbox:e=>{let{textValue:t}=e;return l.Ml(t)?"Yes":"No"},person:e=>{let{textValue:t,exportArgs:n,propertySchema:o,block:i}=e;const{intl:r}=n,a=y.kk.fromBlock(i),s=l.DW({textValue:t,propertySchema:o,blockCreatorPointer:a.getCreatedByPointer()});return v.oA(s.map((e=>{const t=n.getRecordValue(e),o=t&&y.kk.fromValue(e.table,t);return null==o?void 0:o.getDisplayName(r)}))).join(", ")},number:e=>{let{textValue:t}=e;const n=l.VY(t);if(void 0!==n)return n.toString()},date:e=>{let{textValue:t,propertySchema:n,...o}=e;const i=o.exportArgs.userTimeZone,r=l.Gl(t),{date_format:a,time_format:s}=n;if(r)return(0,m.ZV)({allowRelativeDates:!1,value:r,date_format:a,time_format:s,userTimeZone:i,intl:o.exportArgs.intl})},file:R,formula:e=>{const{property:t,schema:n,block:o,exportArgs:i}=e,{userTimeZone:r,getRecordValue:a,intl:l}=i,c=(0,s.py)(n,t,y.kk.fromBlock(o),y.om.fromGetRecordValueFn(a),l,r,0);return"boolean"==typeof c?c?"Yes":"No":(0,T.hj)(c)?c.toString():(0,p.U3)(c)?P({value:c,userTimeZone:r,allowRelativeDates:!1,intl:i.intl}):c},created_time:e=>{const{block:t,exportArgs:n}=e,{userTimeZone:o}=n;if(t.created_time)return P({allowRelativeDates:!1,value:(0,f.CQ)(t.created_time,o),userTimeZone:o,intl:n.intl})},last_edited_time:e=>{const{block:t,exportArgs:n}=e,{userTimeZone:o}=n;if(t.last_edited_time)return P({allowRelativeDates:!1,value:(0,f.CQ)(t.last_edited_time,o),userTimeZone:o,intl:n.intl})},created_by:e=>{const{block:t,exportArgs:n}=e,{getRecordValue:i,intl:r}=n;if(t.created_by_table&&t.created_by_id){const e=(0,o.Hl)({getRecordValue:i,pointer:{table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}});if(e.asActor)return(0,o.$4)(r,e)}},last_edited_by:e=>{const{block:t,exportArgs:n}=e,{getRecordValue:i,intl:r}=n;if(t.last_edited_by_table&&t.last_edited_by_id){const e=(0,o.Hl)({getRecordValue:i,pointer:{table:t.last_edited_by_table,id:t.last_edited_by_id,spaceId:t.space_id}});if(e.asActor)return(0,o.$4)(r,e)}},button:e=>"",auto_increment_id:e=>{let{textValue:t,block:n,exportArgs:o}=e;const i=l.ah(t),{getRecordValue:r}=o;if(void 0!==i){const e=y.kk.fromBlock(n),t=e.getParentTable();if(t!==k.v)return;const o=r((0,d.We)({spaceId:e.getSpaceId(),parentTable:t,parentId:e.getParentId()}));return(0,a.wf)(null==o?void 0:o.record_key,i)}},last_visited_time:e=>"",location:e=>"",verification:e=>{let{textValue:t,exportArgs:n}=e;const o=l._w(t);if(!o)return"";const i=M.WN(o);return n.intl.formatMessage(M.A3(i.type))}}}},42509:(e,t,n)=>{n.d(t,{Ev:()=>l,Gq:()=>s,OY:()=>u,hD:()=>c});var o=n(21202),i=n(6287),r=n(97880);(0,r.AO)((e=>e&&e.parent_table===o.iU&&a(e)&&e.format&&e.format.original_url&&!e.format.is_placeholder?{true:e}:{false:e})),(0,r.AO)((e=>{var t,n;return e&&e.parent_table===o.iU&&a(e)&&e.format&&void 0===e.format.original_url&&null!==(t=e.format)&&void 0!==t&&t.external_object_id&&null!==(n=e.format)&&void 0!==n&&n.uri&&!e.format.is_placeholder?{true:e}:{false:e}}));const a=(0,r.AO)((e=>d(e)&&"external_object_instance"===e.type?{true:e}:{false:e})),s=((0,r.AO)((e=>d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,r.AO)((e=>e&&e.parent_table===i.v&&d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,r.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===o.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&e.format.external_object_id?{true:e}:{false:e}}))),l=(0,r.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===o.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&!e.format.external_object_id?{true:e}:{false:e}})),c=((0,r.AO)((e=>{var t;return!e||d(e)?{false:e}:e.parent_table===i.v&&null!==(t=e.format)&&void 0!==t&&t.external_object_id?{true:e}:{false:e}})),(0,r.AO)((e=>{var t,n;return!e||d(e)?{false:e}:null!=e&&null!==(t=e.format)&&void 0!==t&&t.original_url||null!=e&&null!==(n=e.format)&&void 0!==n&&n.external_object_id||u(e)||p(e)||m(e)?{true:e}:{false:e}}))),d=(0,r.AO)((e=>"type"in e&&e.type?{true:e}:{false:e})),u=((0,r.AO)((e=>void 0===e.format?{true:e}:{false:e})),(0,r.AO)((e=>{var t;return null!==(t=e.format)&&void 0!==t&&t.is_placeholder?{true:e}:{false:e}})),(0,r.AO)((e=>{var t,n;return!e||d(e)?{false:e}:null!==(t=e.format)&&void 0!==t&&t.is_placeholder&&null!==(n=e.format)&&void 0!==n&&n.integration_id?{true:e}:{false:e}}))),p=(0,r.AO)((e=>d(e)?{false:e}:e.parent_table===i.v&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&e.format.integration_id?{true:e}:{false:e})),m=(0,r.AO)((e=>d(e)?{false:e}:e.parent_table===i.v&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&void 0===e.format.integration_id?{true:e}:{false:e}))},76218:(e,t,n)=>{n.d(t,{A6:()=>d,Ck:()=>m,H0:()=>f,OH:()=>y,S3:()=>h,UB:()=>v,YD:()=>c,Zw:()=>b,iC:()=>u,qW:()=>g});n(57658);var o=n(76725),i=n(72126),r=n(6287),a=n(23867),s=n(70203),l=n(97880);function c(e){if(void 0!==e)return[p(e)]}function d(e){const t=e||[],n=[];for(const o of t){const e=(0,s.hDy)(o),t=(0,s.hH9)(e)||(0,s.V8Y)(e)||(0,s.sP4)(e)||(0,s.K9C)(e);t&&n.push(t);const i=(0,s.WiV)(o).split(",");for(const o of i){const e=o.trim(),t=e.indexOf('"'),i=e.lastIndexOf('"');if(t>=0&&i>=0){const o=e.slice(t+1,i);o.length>0&&n.push(o)}else"true"===e?n.push(!0):"false"===e&&n.push(!1)}}return n}function u(e){const t=i.mN(e,(e=>JSON.stringify(e)));if(0!==t.length)return(0,s.Zxt)([["["],...(0,o.Z)(t.map(p),(()=>[", "])),["]"]])}function p(e){return"string"==typeof e?[`"${e}"`]:"boolean"==typeof e?[`${e}`]:(0,s.YCD)(e)}function m(e,t){return e.filter((e=>JSON.stringify(e)!==JSON.stringify(t)))}function f(e,t,n){const o=g(e,t,n);if(o)return function(e){if("text"===e.type)return e;if("number"===e.type)return e;if("checkbox"===e.type)return e;if("date"===e.type)return e;if("block_array"===e.type)return{type:"array",of:{type:"block",collection:e.collection}};if("person_array"===e.type)return{type:"array",of:{type:"person"}};if("select"===e.type)return{type:"select",collection:e.collection,property:e.property};if("select_array"===e.type)return{type:"array",of:{type:"select",collection:e.collection,property:e.property}};(0,l.t1)(e)}(o)}function g(e,t,n){if("text"===n.type||"url"===n.type||"email"===n.type||"phone_number"===n.type||"title"===n.type)return{type:"text"};if("checkbox"===n.type)return{type:"checkbox"};if("multi_select"===n.type)return{type:"select_array",collection:e,property:t};if("select"===n.type||"status"===n.type)return{type:"select",collection:e,property:t};if("person"===n.type)return{type:"person_array"};if("number"===n.type||"auto_increment_id"===n.type)return{type:"number"};if("date"===n.type)return{type:"date"};if("relation"===n.type){if(n.collection_pointer)return{type:"block_array",collection:{table:r.v,id:n.collection_pointer.id,spaceId:(0,a.C)(n.collection_pointer.spaceId)}};if(n.collection_id)return{type:"block_array",collection:{table:r.v,id:n.collection_id,spaceId:e.spaceId}}}else{if("formula"===n.type||"rollup"===n.type||"last_edited_by"===n.type||"last_edited_time"===n.type||"button"===n.type||"created_time"===n.type||"created_by"===n.type||"file"===n.type||"location"===n.type||"verification"===n.type||"last_visited_time"===n.type)return;(0,l.t1)(n)}}function h(e){return"string"!=typeof e&&"boolean"!=typeof e}function v(e){return(e.value??[]).map((e=>{if(!(0,s.km_)(e))return;const t=(0,s.sP4)(e[1]);if(!t)return;return(0,s.vmO)(t).id})).filter(l.$K)}function b(e,t){return{...e,value:e.value?e.value.map((e=>{if(!(0,s.km_)(e))return e;const n=i.Xh(e);for(const o of n[1])(0,s.wjk)(o)&&(o[1].id=t(o[1].id));return n})):void 0}}async function y(e){const{value:t,context:n,executeFormula:o}=e,{returnType:i}=n,r=t.value;if("simple"===t.type){if("number"===i.type){const e=(0,s.QaF)(r),t=parseFloat(e);return isNaN(t)?{value:{type:"undefined"}}:{value:{type:"number",value:t}}}if("text"===i.type)return{value:{type:"text",value:r||[]}};if("checkbox"===i.type){return{value:{type:"checkbox",value:"true"===(0,s.QaF)(r)}}}return o(n,r)}return"formula"===t.type?o(n,r):(0,l.t1)(t.type)}},5773:(e,t,n)=>{n.d(t,{ZP:()=>c,jy:()=>d,xN:()=>l});n(57658);var o=n(80951),i=n(43593),r=n(70203),a=n(97880);const s=["source"];function l(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;const c=[],p=[];if(e.properties){const i=Object.keys(e.properties);for(const m of i){const i=e.properties[m],f=i?o.g(i):void 0;if(l){const e=u(f,t,n,r,a);if(e&&e.length>0&&s.includes(m)){const t={pointer:l,path:["properties",m],command:"set",args:e};p.push(t)}}const g=d(f,[t,n],r,a);c.push(...g)}}if(e.format){const{page_cover:o,page_icon:s}=e.format;if(o){const e=(0,i.mV)(o,[t,n],r,a);e&&c.push(e)}if(s){const e=(0,i.mV)(s,[t,n],r,a);e&&c.push(e)}}return{files:c,operations:p}}function c(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;const a=l(e,t,n,o,i,r);return a.files}function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return void 0===e?[]:e.map((e=>(0,i.mV)(e.url,t,n,o))).filter(a.$K)}function u(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4?arguments[4]:void 0;if(void 0===e)return;const l=e.map((e=>(0,i.Wv)(e.url,t,n,o,s))).filter(a.$K);return l&&l.length>0?[r.V3y(l[0].link)]:void 0}},89789:(e,t,n)=>{n.d(t,{GR:()=>s,P_:()=>a});var o=n(66897),i=n(77420),r=n(19889);const a=(0,o.dp)(r.s$),s=((0,o.dp)(r.el),(0,o.dp)(r.T0));(0,o.dp)(r.fs),(0,o.D$)(i._H)},79317:(e,t,n)=>{n.d(t,{T1:()=>V,A6:()=>L,Wr:()=>Z,rb:()=>j});var o={};n.r(o),n.d(o,{derivePrimitiveOperations:()=>u,getAdditionalRelatedPointers:()=>p,invert:()=>m});var i={};n.r(i),n.d(i,{derivePrimitiveOperations:()=>h,getAdditionalRelatedPointers:()=>v,getOperationToAddChildBackToOldParent:()=>y,invert:()=>b});var r={};n.r(r),n.d(r,{derivePrimitiveOperations:()=>S,getAdditionalRelatedPointers:()=>_,invert:()=>w});var a={};n.r(a),n.d(a,{derivePrimitiveOperations:()=>R,getAdditionalRelatedPointers:()=>D,invert:()=>B});var s=n(90559),l=n(80951),c=n(86678),d=n(6287);function u(e,t){const{collectionId:n,spaceId:o}=e.args,i=t(e.pointer);if(!i)return[];if(i.is_template)return[];const r=(0,c.ky)({block:i,getRecordValue:t});if((null==r?void 0:r.id)===n){const i=(0,s.Y7)({spaceId:o,parentTable:d.v,parentId:n}),r=t(i),a=t({table:d.v,id:n,spaceId:o});if(a&&r&&r.alive)return(0,s.FT)(a).flatMap((t=>[{pointer:e.pointer,command:"set",path:["properties",t],args:(0,l.e7)(r.next_value)},{pointer:i,command:"set",path:["next_value"],args:r.next_value+1}]))}return[]}function p(e){const{collectionId:t,spaceId:n}=e.args;return[(0,s.Y7)({spaceId:n,parentTable:d.v,parentId:t})]}function m(e,t){return[]}n(21703),n(57658);var f=n(72126),g=n(73360);const h=function(e,t){const n=[];n.push({...e,command:"insertChildrenBefore"===e.command?"listBeforeMulti":"listAfterMulti",args:{...e.args}});const o=Z(e.pointer.table,e.path);if(!o)throw new Error(`Unsupported operation table and operation path ${JSON.stringify(e)} `);return e.args.ids.forEach((i=>{const r={id:i,table:o,spaceId:e.pointer.spaceId};n.push({command:"update",pointer:r,path:[],args:{parent_table:e.pointer.table,parent_id:e.pointer.id,alive:!0}});const a=t(r);if(a&&a.parent_id&&a.parent_table&&a.parent_id!==e.pointer.id){const e=L(a.parent_table,o);e?n.push({command:"listRemove",pointer:{id:a.parent_id,table:a.parent_table,spaceId:a.space_id},path:e,args:{id:a.id}}):function(e){if(!e)throw new Error("Assertion failed in insertChildrenOperationHelper")}(a.parent_table===d.v)}})),n},v=function(e){const t=Z(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.map((n=>({id:n,table:t,spaceId:e.pointer.spaceId})))},b=function(e,t){const n=Z(e.pointer.table,e.path);if(!n)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.flatMap((o=>{const i={id:o,table:n,spaceId:e.pointer.spaceId},r=t(i);if(r&&r.parent_table&&r.parent_id){if(L(r.parent_table,n)){const n=t({id:r.parent_id,table:r.parent_table,spaceId:r.space_id});if(n){const e=y(g.mk.create(r.parent_table,n),r.parent_table,i);return e?[e]:[]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:o}}]}return[{command:"setParent",pointer:i,path:[],args:{parentId:r.parent_id,parentTable:r.parent_table}}]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:o}}]}))},y=function(e,t,n){const o=L(e.table,n.table);if(!o)return{command:"setParent",pointer:n,path:[],args:{parentId:e.value.id,parentTable:t}};const i=f.U2(e.value,o);if(!i)return;const r=i.indexOf(n.id);if(-1===r)return;const a={id:e.value.id,table:t,spaceId:n.spaceId};if(0===r){return{command:"insertChildrenBefore",pointer:a,path:o,args:{ids:[n.id]}}}return{command:"insertChildrenAfter",pointer:a,path:o,args:{ids:[n.id],after:i[r-1]}}},S=function(e){const t=[];t.push({...e,command:"listRemove"});const n=Z(e.pointer.table,e.path);if(!n)throw new Error(`invalid operation ${JSON.stringify(e)}`);return t.push({command:"set",path:["alive"],args:!1,pointer:{table:n,spaceId:e.pointer.spaceId,id:e.args.id}}),t},_=function(e){const t=Z(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return[{id:e.args.id,table:t,spaceId:e.pointer.spaceId}]},w=function(e,t){const n=t(e.pointer);if(!n)return[];const o=Z(e.pointer.table,e.path);if(!o)throw new Error(`Invalid operation ${JSON.stringify(e)}`);const i=y(g.mk.create(e.pointer.table,n),e.pointer.table,{id:e.args.id,table:o,spaceId:e.pointer.spaceId});return i?[i]:[]};var k=n(98963),I=n(18844),C=n(21202),x=n(70279),T=n(33709),M=n(91644),P=n(15047),A=n(29369);const R=function(e,t){const n=[{command:"update",pointer:e.pointer,path:[],args:{parent_table:e.args.parentTable,parent_id:e.args.parentId,alive:!0}}],o=t(e.pointer);if(o&&o.parent_id&&o.parent_table){const t=L(o.parent_table,e.pointer.table);t&&n.push({command:"listRemove",pointer:{id:o.parent_id,table:o.parent_table,spaceId:o.space_id},path:t,args:{id:e.pointer.id}})}return n},D=function(e){return[]},B=function(e,t){const n=t(e.pointer);if(!n||!n.parent_id||!n.parent_table)return[{command:"set",pointer:e.pointer,path:["alive"],args:!1}];if(n.parent_id===e.args.parentId&&n.parent_table===e.args.parentTable)return[];const o=n.parent_table;if(L(o,e.pointer.table)){const o=t({id:n.parent_id,table:n.parent_table,spaceId:n.space_id});if(o){const t=y(g.mk.create(n.parent_table,o),n.parent_table,e.pointer);if(t)return[t]}return[]}return[{command:"setParent",pointer:e.pointer,path:[],args:{parentId:n.parent_id,parentTable:n.parent_table}}]},E={insertChildrenAfter:i,insertChildrenBefore:i,setParent:a,removeChild:r,assignAutoIncrementId:o},F={[C.iU]:[{childTable:C.iU,childPath:["content"]},{childTable:T.qF,childPath:["discussions"]}],[P.bx]:[{childTable:C.iU,childPath:["pages"]}],[T.qF]:[{childTable:x.x_,childPath:["comments"]}],[x.x_]:[{childTable:C.iU,childPath:["content"]}],[A.e0]:[{childTable:C.iU,childPath:["team_pages"]}],[k.cv]:[{childTable:I.Xj,childPath:["action_ids"]}],[I.Xj]:[{childTable:C.iU,childPath:["blocks"]}],[M.AT]:[]},Z=function(e,t){var n;const o=F[e];if(o)return null===(n=o.find((e=>{let{childPath:n}=e;return f.Xy(n,t)})))||void 0===n?void 0:n.childTable},L=function(e,t){var n;const o=F[e];if(o)return null===(n=o.find((e=>t===e.childTable)))||void 0===n?void 0:n.childPath},j=(e,t)=>E[e.command].invert(e,t),V=(e,t)=>E[e.command].derivePrimitiveOperations(e,t)},19531:(e,t,n)=>{n.d(t,{$O:()=>Xe,KD:()=>re,xR:()=>et,RE:()=>tt});n(57658),n(30541);var o=n(30120),i=n(41432),r=n(99036),a=n(80951),s=n(5366),l=n(84795),c=n(68626),d=n(5773),u=n(59730),p=n(30845),m=n(72126),f=n(32056),g=n(482),h=n(21202),v=n(6287),b=n(13493),y=n(70203),S=n(63143);const _="PartialMatch",w="FullMatch",k="ColumnCategory",I=(0,s.defineMessages)({titleColumnName:{id:"database.titleColumn.name",defaultMessage:"Title"},genericColumnName:{id:"database.genericColumn.name",defaultMessage:"Column {columnNumber}"}});function C(e){const{table:t,intl:n,randomShortID:o,isPhoneNumber:i,useCsvAdaptiveSchema:s}=e,l=function(e,t,n,o){var i;let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;const l=(e=e.filter((e=>e.some((e=>Boolean((e.text||"").trim())))))).length>0?e[0].length:0,c=e.map(((e,t)=>({row:e,rowIndex:t}))).filter((e=>{let{row:t}=e;return t.length!==l}));if(c.length>0){const e=c[0];throw new u.p8("CsvImportError",{data:{},clientData:{type:"csv_import_inconsistent_columns",messageValues:{numTitleColumns:l,numBadRows:c.length,firstBadRowIndex:e.rowIndex+1,firstBadRow:JSON.stringify(e.row.map((e=>e.text))),firstBadRowLength:e.row.length}}})}const d=null===(i=e[0])||void 0===i?void 0:i.length;null==s||s.set(k,W(d));let p=[];1===e.length?p=e[0].map(((e,n)=>t.formatMessage(I.genericColumnName,{columnNumber:n+1}))):e.length>1&&(p=e[0].map((e=>e.text)),e.shift());const f=e,g=H(o),h=m.oA(m.Ri(f).map((e=>e.length&&e[0].columnType?e[0].columnType:q(t,e.map((e=>null==e?void 0:e.text)),n,g,r,s)))),v=p.map((()=>!1));for(let a=0;a<p.length;a++)if("text"===h[a].schema.type)for(let e=0;e<f.length;e++){const t=f[e][a].textValue;if(t)for(const n of t)if(y.AJd(n)){v[a]=!0,e=f.length;break}}let b=!0;const S={title:{type:"title",name:t.formatMessage(I.titleColumnName)}};p.forEach(((e,t)=>{const o=h[t];if(o)if("text"===o.schema.type&&b&&!v[t]){b=!1,o.id="title",o.schema={type:"title",name:e};const t=S.title;t&&(t.name=e)}else{const t=n();o.id=t,S[t]={name:e,...o.schema}}}));const _=f.map((e=>{const t={};return h.forEach(((n,o)=>{if(n){const{id:i,schema:r,coerce:s}=n,{type:l}=r;if(i){const n=e[o]||"";t[i]="url"===l?a.iD(n.text):"date"===l?a.d7(s(n.text)):"text"===l?n.textValue||y.TPx(s(n.text)):"file"===l?n.textValue||[]:y.TPx(s(n.text))}}})),t}));return{schema:S,types:h,pages:_}}(t,n,o,i,s,e.csvEvalContext);return function(e){const{actor:t,blockType:n,rootId:o,parentId:i,parentTable:a,spaceId:s,name:l,format:c,ignoreBlockCount:u,randomID:p,pages:f,schema:g,columnIds:S,secureFileS3Url:_,secureFileS3UrlV2:w}=e,k=p(),I=p(),C=Date.now(),x=[],T={id:k,version:0,parent_table:h.iU,parent_id:o,space_id:s,name:y.TPx(l),schema:g,alive:!0,format:{collection_page_properties:m.oA(S.map((e=>{if(e)return{visible:!0,property:e}})))}};x.push({pointer:{table:v.v,id:k,spaceId:s},command:"set",path:[],args:T});const M={id:o,version:0,type:n,collection_id:k,format:{collection_pointer:{table:v.v,id:k,spaceId:s}},view_ids:[I],alive:!0,created_by_table:t.table,created_by_id:t.id,created_time:C,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:C,parent_id:i,parent_table:a,space_id:s};x.push({pointer:{table:h.iU,id:o,spaceId:s},command:"update",path:[],args:M});const P=function(e){const{actor:t,collectionId:n,spaceId:o,pages:i,ignoreBlockCount:r,secureFileS3Url:a,secureFileS3UrlV2:s,randomID:l}=e,c=Date.now();return i.map((e=>{const i=l(),u={id:i,version:0,parent_id:n,parent_table:v.v,space_id:o,type:"page",created_by_table:t.table,created_by_id:t.id,created_time:c,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:c,properties:e,...r?{ignore_block_count:!0}:void 0,alive:!0};if(a&&s){const e=(0,d.ZP)(u,a,s);e.length>0&&(u.file_ids=e.map((e=>e.id)))}return{id:i,operation:{pointer:{table:h.iU,id:i,spaceId:o},command:"set",path:[],args:u}}}))}({actor:t,collectionId:k,secureFileS3Url:_,secureFileS3UrlV2:w,spaceId:s,pages:f,ignoreBlockCount:u,randomID:p});P.forEach((e=>{let{operation:t}=e;return x.push(t)}));const A={id:I,version:0,type:"table",name:"Show All",parent_id:o,parent_table:"block",space_id:s,format:{table_properties:m.oA(S.map((e=>{if(e)return{visible:!0,property:e}}))),...c},page_sort:P.map((e=>e.id)).slice(0,r.gq),alive:!0};return x.push({pointer:{table:b.n,id:I,spaceId:s},command:"set",path:[],args:A}),{operations:x}}({...l,columnIds:l.types.map((e=>e.id)),...e})}const x=["yes","Yes","true","True","checked"],T=["no","No","false","False","unchecked"];function M(e){return x.some((t=>e===t))||T.some((t=>e===t))}function P(e,t){return e.length===t.length}function A(e,t){if(t.every(M))return{schema:{type:"checkbox"},validate:M,coerce:e=>x.some((t=>e===t))?r.bx:r.HC}}const R=function(e,t){const n=t.map(f._g),o=n[0];if(o&&n.every((e=>Boolean(e&&e.format===o.format))))return{schema:{type:"number",number_format:o.format},validate(e){const t=f._g(e);return!S.z4(t)&&t.format===o.format},coerce(e){const t=f._g(e);return`${t?t.value:void 0}`}}},D=function(e,t){if(parseInt(t)&&t.length<=6)return!1;const n=l.parseFreeformDateString(t,e);return Boolean(n)};function B(e,t){const n=t.filter((t=>D(e,t)));if(n.length>=t.length/2)return{schema:{type:"date"},validate:t=>D(e,t),coerce:t=>l.parseFreeformDateString(t,e),isFullMatch:P(t,n)}}const E=function(e){return e.length<320&&e.includes("@")&&p.B(e,"email")},F=function(e,t){const n=t.filter(E);if(n.length>=t.length/2)return{schema:{type:"email"},validate:E,coerce:m.yR,isFullMatch:P(t,n)}},Z=function(e){return e.length<320&&p.B(e,"url")},L=function(e,t){const n=t.filter(Z);if(n.length>=t.length/2)return{schema:{type:"url"},validate:Z,coerce:m.yR,isFullMatch:P(t,n)}},j=function(e,t){return!String(t).match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)&&e(String(t))},V=function(e,t,n){const o=j.bind(null,e),i=n.filter(o);if(i.length>=n.length/2)return{schema:{type:"phone_number"},validate:o,coerce:m.yR,isFullMatch:P(n,i)}},U=function(e,t,n){const o=[];t.forEach((e=>e.split(",").forEach((e=>o.push(e.trim())))));const i=new Set(o);if(a=i.size,s=o.length,l=t.length,s>l&&O(a,s)){return{schema:{type:"multi_select",options:Array.from(i).map(((e,t)=>({id:n(),value:e,color:(0,r.TL)([])})))},validate:e=>i.has(e),coerce:m.yR}}var a,s,l},O=function(e,t){return e>0&&e**2<t},N=function(e,t,n){const o=new Set(t);if(O(o.size,t.length)){return{schema:{type:"select",options:Array.from(o).map(((e,t)=>({id:n(),value:e,color:(0,r.TL)([])})))},validate:e=>o.has(e),coerce:m.yR}}},z=function(e,t){return{schema:{type:"text"},validate:m._z,coerce:m.yR}};function H(e){return[{test:V.bind(null,e),sampledSchemaIsComplete:!0},{test:R,sampledSchemaIsComplete:!0},{test:F,sampledSchemaIsComplete:!0},{test:L,sampledSchemaIsComplete:!0},{test:B,sampledSchemaIsComplete:!0},{test:A,sampledSchemaIsComplete:!1},{test:U,sampledSchemaIsComplete:!1},{test:N,sampledSchemaIsComplete:!1},{test:z,sampledSchemaIsComplete:!0}]}const W=function(e){return e<50?"lessthan50":e<100?"lessthan100":e<500?"lessthan500":e<1e3?"lessthan1000":e<5e3?"lessthan5000":"greaterthan5000"},q=function(e,t,n,o,i,r){const a=t.filter((e=>Boolean(e)));if(0===a.length)return z();if(i)for(const s of o){const t=s.test(e,a,n);if(t){let e=t;if(!1===t.isFullMatch){c.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, setting data type as string",columnType:t.schema.type,matchType:"Partial"}}),e=z();const n=(null==r?void 0:r.get(_))||0;null==r||r.set(_,n+1)}else c.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Complete column type match detected",columnType:t.schema.type,matchType:"Full"}});const n=(null==r?void 0:r.get(w))||0;return null==r||r.set(w,n+1),e}}else{const t=a.filter((e=>!m.xb(e))).slice(0,100);for(const i of o){const o=i.test(e,t,n);if(o){const s=i.sampledSchemaIsComplete||t.length===a.length?o:i.test(e,a,n);if(s){if(!1===s.isFullMatch){c.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, Potential data loss due to parsing failures",columnType:s.schema.type,matchType:"Partial"}});const e=(null==r?void 0:r.get(_))||0;null==r||r.set(_,e+1)}else{const e=(null==r?void 0:r.get(w))||0;null==r||r.set(w,e+1)}return s}}}}return z()};var G=n(53877),K=n(95538),$=n(15095),Q=n(43593),Y=n(19233),J=n(4615),X=n(33709);const ee=n(60809),te={a:!0,strong:!0,em:!0,code:!0,del:!0,s:!0,span:!0,time:!0},ne={meta:!0,style:!0,script:!0,head:!0,title:!0},oe="sourceCode";function ie(e){if(!e)return;const t=parseInt(e);return isNaN(t)?void 0:t}const re={[y.GKr.Page]:"data-notion-page-id",spaceId:"data-notion-space-id",[y.GKr.Highlight]:"data-notion-highlight",[y.GKr.User]:"data-notion-user-id",[y.GKr.Discussion]:"data-notion-block-discussion-id",[y.GKr.Equation]:"data-notion-inline-equation",[i.Ti.code]:"data-notion-code-syntax",[i.Ti.callout]:"data-notion-callout",calloutIcon:"data-notion-callout-icon",calloutBackground:"data-notion-callout-background",[i.Ti.tableOfContents]:"data-notion-toc",[i.Ti.file]:"data-notion-file",fileAlias:"data-notion-file-alias",[i.Ti.columnList]:"data-notion-column-list",[i.Ti.column]:"data-notion-column-ratio",[i.Ti.video]:"data-notion-video",[i.Ti.audio]:"data-notion-audio",[i.Ti.pdf]:"data-notion-pdf",[i.Ti.equation]:"data-notion-equation",dateFormat:"data-notion-date-format"};function ae(e,t){return t&&t.nodeType===e.Node.ELEMENT_NODE}const se=function(e,t){return e.nodeType===t.Node.TEXT_NODE||e instanceof t.Element&&te[e.tagName.toLowerCase()]},le=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.push(e);for(const n of $.p4(e.childNodes))le(n,t);return t},ce=function(e){const t=[];if(!e.parentNode)return t;let n=e.parentNode;for(;n;)t.push(n),n=n.parentNode||void 0;return t};function de(e,t){return ce(e).filter((e=>e instanceof t.Element&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase()))).length}const ue=["•","◦","▪"],pe=["h1","h2","h3","h4","h5","h6"].map((e=>`${e}:not(:first-child)`)).join(", "),me=function(e){const{node:t,window:n,stripText:i,timeZone:r}=e;if(!i){for(const e of Array.from(t.querySelectorAll("p:not(:first-child)")))e.prepend("\n");for(const e of Array.from(t.querySelectorAll(pe)))e.prepend("\n");for(const e of Array.from(t.querySelectorAll("ul > li"))){const t=de(e,n)-1,o=ue[t%ue.length],i="    ".repeat(t);e.prepend(`\n${i}${o} `)}for(const e of Array.from(t.querySelectorAll("ol"))){const t=de(e,n),o="    ".repeat(t);for(let n=0;n<e.children.length;n+=1){e.children[n].prepend(`\n${o}${n+1}. `)}}for(const e of Array.from(t.querySelectorAll("pre")))e.parentNode&&e.parentNode.insertBefore(n.document.createTextNode("\n\n"),e)}const a=[],s=le(t).filter((e=>e.nodeType===n.Node.TEXT_NODE&&(!i||!/^( |\t)*(\n)+( |\t)*$/.test(e.data))));let l=!0;s.forEach(((e,c)=>{let d=e.data;i&&(d=d.replace(/\[ \] /g,""),d=d.replace(/\[x\] /g,""),d=d.replace(/^[\-\*\•]\s?/g,""),d=d.replace(/(\s)+/g,"$1")),t.hasAttribute("confluenceTabSpaces")||0!==c||(d=d.trimStart()),c===s.length-1&&l&&(d=d.trimEnd());const u=[],p=ce(e);let m;!i&&p.some((e=>e instanceof n.Element&&("h1"===e.tagName.toLowerCase()||"h2"===e.tagName.toLowerCase()||"h3"===e.tagName.toLowerCase()||"h4"===e.tagName.toLowerCase()||"h5"===e.tagName.toLowerCase()||"h6"===e.tagName.toLowerCase())))&&u.push([y.GKr.Bold]),p.some((e=>e instanceof n.Element&&"strong"===e.tagName.toLowerCase()))&&u.push([y.GKr.Bold]),p.some((e=>e instanceof n.Element&&"em"===e.tagName.toLowerCase()))&&u.push([y.GKr.Italic]),p.some((e=>e instanceof n.Element&&"u"===e.tagName.toLowerCase()))&&u.push([y.GKr.Underline]),p.some((e=>e instanceof n.Element&&("code"===e.tagName.toLowerCase()||"pre"===e.tagName.toLowerCase())))&&u.push([y.GKr.Code]),p.some((e=>e instanceof n.Element&&("del"===e.tagName.toLowerCase()||"strike"===e.tagName.toLowerCase()||"s"===e.tagName.toLowerCase())))&&u.push([y.GKr.Strike]);const f=p.find((e=>{var t;return e instanceof n.Element&&(e.hasAttribute(re[y.GKr.Highlight])||(null===(t=e.parentElement)||void 0===t?void 0:t.hasAttribute(re[y.GKr.Highlight])))}));if(f&&f instanceof n.Element){var g;const e=f.getAttribute(re[y.GKr.Highlight]),t=null===(g=f.parentElement)||void 0===g?void 0:g.getAttribute(re[y.GKr.Highlight]),n=it(e&&"undefined"!==e?e||"":t||"");n&&u.push([y.GKr.Highlight,n])}const h=p.find((e=>e instanceof n.Element&&"a"===e.tagName.toLowerCase()));if(h){const e=h.getAttribute(re[y.GKr.Page]),t=h.getAttribute("notionUserId")||h.getAttribute(re[y.GKr.User]),n=h.getAttribute(re.spaceId),o=h.getAttribute(re[y.GKr.Comment]);"string"==typeof e&&(0,J.e)(e)&&"string"==typeof n&&(0,J.e)(n)?m=y.$0A(e,n):h.href?u.push(y.edl(h.href)):"string"==typeof t&&(0,J.e)(t)?(m=y.tEo(t),h.getAttribute("notionUserId")&&c===s.length-2&&(l=!1)):o&&n&&(0,J.e)(o)&&(0,J.e)(n)&&(m=y.mfJ(o,n))}const v=p.find((e=>!!(e instanceof n.Element&&e.getAttribute(re[y.GKr.Discussion]))));if(v){const e=v.getAttribute(re[y.GKr.Discussion]);e&&u.push(y.jw(e))}const b=p.find((e=>e instanceof n.Element&&"sub"===e.tagName.toLowerCase()));let S;"true"===(null==b?void 0:b.getAttribute("confluenceProcessableEquation"))&&(S=`_{${b.textContent}}`);const _=p.find((e=>e instanceof n.Element&&"sup"===e.tagName.toLowerCase()));let w;"true"===(null==_?void 0:_.getAttribute("confluenceProcessableEquation"))&&(w=`^{${_.textContent}}`);const k=p.find((e=>e instanceof n.Element&&e.hasAttribute(re[y.GKr.Equation])));let I;null!=k&&k.textContent&&(I=k.textContent);const C=p.find((e=>e instanceof n.Element&&"time"===e.tagName.toLowerCase()));if(C){const e=C.getAttribute("datetime");if(e){const t={...function(e,t){const n=o.ou.fromISO(e),i=n.toMillis();return i===n.startOf("day").toMillis()?G.OQ.toPersistedDate(i,t):G.OQ.toPersistedDateTime(i,t)}(e,r)};"relative"===C.getAttribute(re.dateFormat)&&(t.date_format="relative"),m=y.pZr(t)}}m?a.push(y.YCD(m,u)):S?a.push(y.qZ6(S,u)):w?a.push(y.qZ6(w,u)):I?a.push(y.qZ6(I,u)):a.push(y.V3y(d,u))}));return y.Zdj(a,1e5)};const fe=function(e){const t=["img[src]","a[download]",`a[${re[i.Ti.file]}]`,`audio[${re[i.Ti.audio]}]`,`video[${re[i.Ti.video]}]`],n=e.querySelectorAll(t.join(","));return $.p4(n)};function ge(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:r,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g}=e;return je({actor:t,parentId:n,parentTable:o,spaceId:i,nodes:fe(r),allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g})}function he(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:r,type:a,allOperations:s,window:l,ignoreBlockCount:c,stripText:d,randomID:u}=e,p=u(),m={id:p,version:0,type:a,properties:{title:me({node:r,window:l,stripText:d})},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!c||void 0};return s.push({pointer:{table:h.iU,id:p,spaceId:i},command:"set",path:[],args:m}),Le({node:r,spaceId:i,blockId:p,allOperations:s}),p}function ve(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,tableData:s,allOperations:l,ignoreBlockCount:c,intl:d,secureFileS3Url:u,secureFileS3UrlV2:p,randomID:m,randomShortID:f,isPhoneNumber:v,tableType:b}=e,y=m();if("table"===b){const{operations:e}=function(e){const{actor:t,parentId:n,tableId:o,parentTable:r,spaceId:a,ignoreBlockCount:s,randomID:l,randomShortID:c,table:d}=e,u=Date.now(),p=[],m=d.length?d[0].map((e=>c())):[],f=d.map((e=>l()));p.push(g.op.update({pointer:{id:o,table:h.iU,spaceId:a},path:[],args:{id:o,type:i.Ti.table,content:f,format:{table_block_column_order:m},properties:{},parent_id:n,space_id:a,parent_table:r,created_by_table:t.table,created_by_id:t.id,created_time:u,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:u,alive:!0,ignore_block_count:!!s||void 0}}));const v=f.map(((e,n)=>{const r=S.m8(m.flatMap(((e,t)=>{var o;const i=null===(o=d[n])||void 0===o||null===(o=o[t])||void 0===o?void 0:o.textValue;return i?[[e,i]]:[]})));return g.op.set({pointer:{id:e,table:h.iU,spaceId:a},path:[],args:{id:e,version:0,type:i.Ti.tableRow,parent_id:o,parent_table:h.iU,alive:!0,space_id:a,properties:r,created_by_table:t.table,created_by_id:t.id,created_time:u,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:u}})}));return p.push(...v),{operations:p}}({actor:t,tableId:y,parentId:n,parentTable:o,spaceId:r,table:s,ignoreBlockCount:c,randomID:m,randomShortID:f});l.push(...e),Le({node:a,spaceId:r,blockId:y,allOperations:l})}else if("collection"===b){const{operations:e}=C({actor:t,blockType:"collection_view",rootId:y,parentId:n,parentTable:o,spaceId:r,name:"",format:{table_wrap:!0},table:s,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:c,intl:d,randomID:m,randomShortID:f,isPhoneNumber:v});l.push(...e)}return y}function be(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,allOperations:a,ignoreBlockCount:s,randomID:l}=e,c=l(),d={id:c,version:0,type:i.Ti.divider,parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!s||void 0};return a.push({pointer:{table:h.iU,id:c,spaceId:r},command:"set",path:[],args:d}),c}function ye(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,source:a,allOperations:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:u,randomID:p,fallbackWidth:m}=e;let f;"image"===a.type&&a.width?f=Math.min(a.width,700):m&&(f=Math.min(m,700));const g=p(),v={id:g,version:0,type:i.Ti.image,properties:{source:y.TPx(a.url)},format:{block_width:f},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!u||void 0},b=(0,d.ZP)(v,l,c);return v.file_ids=b.map((e=>e.id)),s.push({pointer:{table:h.iU,id:g,spaceId:r},command:"set",path:[],args:v}),g}function Se(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:r,sourceUrl:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=ie(r.getAttribute("height")),u=ie(r.getAttribute("width")),p=c();let m;try{m=new URL(a)}catch(g){m=a}const f={id:p,version:0,type:K.Dz({url:a,baseUrl:m instanceof URL?m.origin:m,publicDomainName:""}),properties:{source:y.TPx(a)},format:{block_width:u,block_height:d,block_full_width:!1,block_page_width:!(u||d),block_preserve_scale:!0},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:h.iU,id:p,spaceId:i},command:"set",path:[],args:f}),p}function _e(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,source:r,allOperations:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:u,randomID:p}=e,m=p(),f=K.Dz({url:r.url,baseUrl:r.url,publicDomainName:""}),g={id:m,version:0,type:"embed"===f?"file":f,properties:{title:y.TPx((0,Q.w2)(r.url)),source:a.iD(r.url)},format:{block_width:"image"===r.type&&r.width?Math.min(r.width,700):void 0},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!u||void 0},v=(0,d.ZP)(g,l,c);return g.file_ids=v.map((e=>e.id)),s.push({pointer:{table:h.iU,id:m,spaceId:i},command:"set",path:[],args:g}),m}function we(e){return"#text"===e.nodeName?e.textContent?e.textContent:"":Array.from(e.childNodes).map((e=>{const t=e.nodeName.toLowerCase();return"br"===t?"\n":"div"===t?`${we(e)}\n`:we(e)})).map((e=>e.split("\n").map((e=>e.trimRight())).join("\n"))).join("")}function ke(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}=e,b=f(),y=a.getAttribute(re.calloutBackground),S=y?it(y):void 0,_=a.getAttribute(re.calloutIcon),w=_&&_.match(ee())?_:void 0,{title:k,children:I}=function(e){const{node:t,window:n}=e,o=$.p4(t.childNodes),[i,...r]=o;if(!i)return{title:[]};return(e=>t=>!!(ae(e,t)&&t instanceof e.HTMLParagraphElement))(n)(i)?{title:me({node:i,window:n,stripText:!1}),children:r}:se(i,n)?{title:me({node:t,window:n,stripText:!1}),children:void 0}:{title:[],children:o}}({node:a,window:c}),C=Array.isArray(I)?je({actor:t,parentId:b,parentTable:h.iU,spaceId:r,nodes:I,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}):[],x={id:b,version:0,type:i.Ti.callout,content:C,properties:{title:k},format:{block_color:S,page_icon:w},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:h.iU,id:b,spaceId:r},command:"set",path:[],args:x}),Le({node:a,spaceId:r,blockId:b,allOperations:s}),b}function Ie(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,importFileMap:a,node:s,allOperations:l,secureFileS3Url:c,secureFileS3UrlV2:u,ignoreBlockCount:p,randomID:m}=e,f=s.getAttribute(re.fileAlias)||"",g=s.getAttribute(re[i.Ti.file])||"",v=a[g]?a[g].url:g,b=m(),S={alive:!0,created_by_id:t.id,created_by_table:t.table,created_time:Date.now(),id:b,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),parent_id:n,parent_table:o,space_id:r,properties:{source:y.TPx(v),title:y.TPx(f)},type:i.Ti.file,version:0,ignore_block_count:!!p||void 0},_=(0,d.ZP)(S,c,u);return S.file_ids=_.map((e=>e.id)),l.push({pointer:{table:h.iU,id:b,spaceId:r},command:"set",path:[],args:S}),b}const Ce=/language-(\w+)/;function xe(e){let t=null;return null==e||e.forEach(((e,n,o)=>{if(t)return;if(Y.Y.hasOwnProperty(e))return void(t=e);const i=e.match(Ce);i&&i.length>1&&Y.Y.hasOwnProperty(i[1])&&(t=i[1])})),t}function Te(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=c();let u=a.getAttribute(re[i.Ti.code]);if(!u){var p;u=xe(null===(p=a.querySelector("code"))||void 0===p||null===(p=p.parentElement)||void 0===p?void 0:p.classList)}if(!u){var m;u=xe(null===(m=a.querySelector("code"))||void 0===m?void 0:m.classList)}const f=u&&Y.Y[u]?Y.Y[u]:"Plain Text",g={id:d,version:0,type:i.Ti.code,properties:{title:y.TPx(we(a)),language:y.TPx(f)},format:{code_wrap:!0},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:h.iU,id:d,spaceId:r},command:"set",path:[],args:g}),Le({node:a,spaceId:r,blockId:d,allOperations:s}),d}function Me(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=c(),u={id:d,version:0,type:i.Ti.equation,properties:{title:y.TPx(we(a))},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:h.iU,id:d,spaceId:r},command:"set",path:[],args:u}),d}function Pe(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,allOperations:a,ignoreBlockCount:s,randomID:l}=e,c=l(),d={id:c,version:0,type:i.Ti.tableOfContents,format:{block_color:"gray"},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!s||void 0};return a.push({pointer:{table:h.iU,id:c,spaceId:r},command:"set",path:[],args:d}),c}function Ae(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}=e,b=f(),[S,..._]=$.p4(a.childNodes),w=je({actor:t,parentId:b,parentTable:h.iU,spaceId:r,nodes:_,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}),k={id:b,version:0,type:i.Ti.quote,properties:{title:y.TPx(null!=S&&S.textContent?S.textContent.trim():"")},content:w,parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:h.iU,id:b,spaceId:r},command:"set",path:[],args:k}),Le({node:a,spaceId:r,blockId:b,allOperations:s}),b}function Re(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}=e,b=f(),S=a.querySelector("summary"),_=$.p4(a.childNodes).filter((e=>e!==S)),w=S&&S.textContent&&me({node:S,window:c,stripText:!1}),k=je({actor:t,parentId:b,parentTable:h.iU,spaceId:r,nodes:_,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}),I={id:b,version:0,type:i.Ti.toggle,content:k,properties:{title:w||y.TPx("")},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:h.iU,id:b,spaceId:r},command:"set",path:[],args:I}),b}function De(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}=e,b=f(),y=$.p4(a.children).filter((e=>e.hasAttribute(re[i.Ti.column]))).slice(0,8).map((e=>function(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}=e,b=f(),y=a.getAttribute(re[i.Ti.column]);let S;if(null!==y){const e=parseFloat(y);!Number.isNaN(e)&&e>0&&e<=1&&(S=e)}const _=je({actor:t,parentId:b,parentTable:h.iU,spaceId:r,nodes:$.p4(a.children),allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}),w={id:b,version:0,type:i.Ti.column,format:{column_ratio:S},content:_,parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:h.iU,id:b,spaceId:r},command:"set",path:[],args:w}),b}({actor:t,parentId:b,parentTable:h.iU,spaceId:r,node:e,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:v}))),S={id:b,version:0,type:i.Ti.columnList,content:y,parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:h.iU,id:b,spaceId:r},command:"set",path:[],args:S}),b}const Be=/^\[x\].*/,Ee=/^\[ \].*/,Fe=/^[-\*\•].*/;function Ze(e){const{actor:t,parentId:n,parentTable:o,spaceId:a,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:f,randomID:g,randomShortID:v,isPhoneNumber:b}=e,S=g(),_=d.document.createElement("span"),w=[];$.p4(s.childNodes).forEach(((e,t)=>{0===t&&We(e,d)?w.push(e):0===t&&!(Ne(e,d)||ze(e,d)||He(e,d))||se(e,d)?(_.appendChild(e),e instanceof d.Element&&fe(e).forEach((e=>w.push(e)))):w.push(e)}));const k=je({actor:t,parentId:S,parentTable:"block",spaceId:a,nodes:w,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:f,randomID:g,randomShortID:v,isPhoneNumber:b}),I=Be.test(_.textContent||""),C=Ee.test(_.textContent||"");let x;x=I||C?i.Ti.toDo:s.parentNode instanceof d.Element&&"ol"===s.parentNode.tagName.toLowerCase()?i.Ti.numberedList:i.Ti.bulletedList;let T=!1;x===i.Ti.toDo&&I&&(T=!0);const M={id:S,version:0,type:x,content:k,properties:{title:me({node:_,window:d,stripText:!0}),checked:T?y.TPx(r.bx):void 0},parent_id:n,parent_table:o,space_id:a,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!m||void 0};return l.push({pointer:{table:h.iU,id:S,spaceId:a},command:"set",path:[],args:M}),Le({node:_,spaceId:a,blockId:S,allOperations:l}),S}function Le(e){const{node:t,spaceId:n,blockId:o,allOperations:i}=e,r=Array.from(t.querySelectorAll(`span[${re[y.GKr.Discussion]}]`));for(const a of r){const e=a.getAttribute(re[y.GKr.Discussion]);if(e){const t={id:e,parent_id:o,parent_table:h.iU,resolved:!1,context:[[a.innerHTML,[[y.GKr.Discussion,e]]]],space_id:n,version:0};i.push({pointer:{table:X.qF,id:e,spaceId:n},command:"set",path:[],args:t},{pointer:{table:h.iU,id:o,spaceId:n},command:"listAfter",path:["discussions"],args:{id:e}})}}}function je(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,nodes:r,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:f,randomShortID:g,isPhoneNumber:h}=e;return m.G0(...r.map((e=>Ve({actor:t,parentId:n,parentTable:o,spaceId:i,node:e,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:f,randomShortID:g,isPhoneNumber:h}))))}function Ve(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b}=e;if(s&&s instanceof d.Element){const e=s.tagName.toLowerCase();if("h1"===e)return[he({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.header,allOperations:l,window:d,ignoreBlockCount:f,stripText:!0,randomID:h}),...ge({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("h2"===e)return[he({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.subHeader,allOperations:l,window:d,ignoreBlockCount:f,stripText:!0,randomID:h}),...ge({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("hr"===e)return[be({actor:t,parentId:n,parentTable:o,spaceId:r,allOperations:l,ignoreBlockCount:f,randomID:h})];if("h"===e[0])return[he({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.subSubHeader,allOperations:l,window:d,ignoreBlockCount:f,stripText:!0,randomID:h}),...ge({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("pre"===e||"code"===e||"div"===e&&s.className===oe)return[Te({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,ignoreBlockCount:f,randomID:h}),...ge({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if(s.hasAttribute(re[i.Ti.callout]))return[ke({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("blockquote"===e)return[Ae({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("details"===e)return[Re({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("table"===e){const{tableData:e,tableFiles:y}=function(e){const{node:t,window:n,importFileMap:o,intl:r}=e,s=[],l=[],c=Array.from(t.querySelectorAll("tr")).filter((e=>e.closest("table")===t));for(const d of c){const e=[],t=[],c=Array.from(d.querySelectorAll("td, th")).filter((e=>e.closest("tr")===d));for(const r of c){const a=(r.textContent||"").trim(),s=Ue(r.getAttribute("rowspan"),1);e.push({text:a,textValue:me({node:r,window:n,stripText:!1}),rowSpan:s});const l=Ue(r.getAttribute("colspan"),1);for(let t=1;t<l;t++)e.push({text:"",rowSpan:s});const c=fe(r);if(c.length){const e=m.oA(c.flatMap((e=>{var t;const n=e.getAttribute("src")||e.getAttribute(re[i.Ti.file])||e.getAttribute(re[i.Ti.audio])||e.getAttribute(re[i.Ti.video]),r=e.getAttribute(re.fileAlias);return n?{name:r||n,url:(null===(t=o[n])||void 0===t?void 0:t.url)||n}:void 0})));t.push(...e)}}e.length&&l.push(e);const u=a.CC(t);s.push({text:r.formatMessage({id:"htmlHelpers.table.fileColumnName",defaultMessage:"Files"}),textValue:u})}for(let i=0;i<l.length;i++){const e=l[i];for(let t=0;t<e.length;t++){const n=e[t].rowSpan;if(n>1)for(let e=1;e<n&&!(i+e>=l.length);e++){l[i+e].splice(t,0,{text:"",rowSpan:1})}}}return{tableData:l,tableFiles:s}}({node:s,window:d,importFileMap:c,intl:g});if(y.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length})))for(let t=0;t<e.length;t++)e[t].push({text:y[t].text,textValue:y[t].textValue,columnType:{schema:{type:"file"},validate:m._z,coerce:m.yR}});let S="table";return y.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length}))&&(S="collection"),0===m.Ar(e).length?[]:[ve({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,tableData:e,allOperations:l,ignoreBlockCount:f,secureFileS3Url:u,secureFileS3UrlV2:p,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b,tableType:S})]}if("div"===e&&s.hasAttribute(re[i.Ti.columnList]))return[De({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("nav"===e&&s.hasAttribute(re[i.Ti.tableOfContents]))return[Pe({actor:t,parentId:n,parentTable:o,spaceId:r,allOperations:l,ignoreBlockCount:f,randomID:h}),...ge({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("ul"===e||"ol"===e)return m.G0(...m.UI(s.children,(e=>Ve({actor:t,parentId:n,parentTable:o,spaceId:r,node:e,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b}))));if("li"===e||Be.test(s.textContent||"")||Ee.test(s.textContent||"")||Fe.test(s.textContent||""))return[Ze({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("img"===e){const e=s.getAttribute("src");if(e)return[ye({actor:t,parentId:n,parentTable:o,spaceId:r,source:c[e]||{type:"unknown",url:e},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,randomID:h,fallbackWidth:s instanceof d.HTMLImageElement?s.width:void 0})]}if("a"===e&&s.getAttribute(re[i.Ti.file]))return[Ie({actor:t,parentId:n,parentTable:o,spaceId:r,importFileMap:c,node:s,allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,randomID:h})];if("a"===e&&0===$.p4(s.childNodes).length){const e=s.getAttribute("href");if(s.hasAttribute("download")&&e)return[_e({actor:t,parentId:n,parentTable:o,spaceId:r,source:c[e]||{type:"unknown",url:e},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,randomID:h})]}if("video"===e){const e=s.querySelector("source");if(e){const i=e.getAttribute("src");if(i&&K.xL({url:i}))return[_e({actor:t,parentId:n,parentTable:o,spaceId:r,source:{type:"unknown",url:i},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,randomID:h})]}}if("audio"===e){const e=s.querySelector("source");if(e){const i=e.getAttribute("src");if(i&&K._c({url:i}))return[_e({actor:t,parentId:n,parentTable:o,spaceId:r,source:{type:"unknown",url:i},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,randomID:h})]}}if("iframe"===e){const e=s.getAttribute("src");if(e)return[Se({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,sourceUrl:e,allOperations:l,ignoreBlockCount:f,randomID:h})]}return"p"===e&&s.getAttribute("confluenceNewLine")?[he({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.text,allOperations:l,window:d,ignoreBlockCount:f,stripText:!0,randomID:h})]:s.hasAttribute(re[i.Ti.equation])?[Me({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,ignoreBlockCount:f,randomID:h})]:[.../^\s*$/g.test(s.textContent||"")?[]:[he({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.text,allOperations:l,window:d,ignoreBlockCount:f,stripText:!1,randomID:h})],...ge({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:f,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})]}return[]}function Ue(e,t){const n=null!==e?parseInt(e,10):t;return isFinite(n)?n:t}const Oe=function(e){if(e&&-1!==e.indexOf("em"))return parseInt(e)},Ne=function(e,t){return e instanceof t.Element&&"img"===e.tagName.toLowerCase()},ze=function(e,t){return e instanceof t.Element&&"video"===e.tagName.toLowerCase()},He=function(e,t){return e instanceof t.Element&&"audio"===e.tagName.toLowerCase()},We=function(e,t){return e instanceof t.Element&&"a"===e.tagName.toLowerCase()&&e.hasAttribute(re[i.Ti.file])},qe=function(e,t,n){const o=n.document.createElement(t);for(;e.firstChild;)o.appendChild(e.firstChild);for(let i=e.attributes.length-1;i>=0;--i){const t=e.attributes[i];o.setAttribute(t.name,t.value)}return e.parentNode&&e.parentNode.replaceChild(o,e),o},Ge=function(e,t,n){const o=n.document.createElement(t);for(;e.firstChild;)o.appendChild(e.firstChild);e.appendChild(o)},Ke=function(e){const t=[];let n=e;for(;e.firstChild;){const o=e.firstChild;t.push(o),e.parentNode&&e.parentNode.insertBefore(o,n.nextSibling),n=o}const o=e.parentNode;return o&&(o.removeChild(e),o.normalize()),t};function $e(e,t){!function(e,t){const n=Array.from(e.querySelectorAll("p"));for(const o of n){let e=o.firstChild,n=0;for(;e&&n<1e4;){let i=!1;if(e instanceof t.Element&&null!==e.textContent&&!e.textContent.trim()){const t=Array.from(e.querySelectorAll("br"));if(t.length>0){for(const n of t)o.insertBefore(n,e);i=!0}}const r=e.nextSibling;i&&o.removeChild(e),e=r,n+=1}}}(e,t);const n=Array.from(e.querySelectorAll("p"));for(let o=0;o<1e4;o++){const e=n.shift();if(!e||!e.parentNode)return;const o=e.querySelector("br");if(!o)continue;if(o.parentElement!==e)continue;const i=t.document.createElement("p");e.parentNode.insertBefore(i,e.nextSibling);let r=o.nextSibling;for(;r;){const e=r.nextSibling;i.appendChild(r),r=e}e.removeChild(o),n.unshift(i)}}function Qe(e){const t=e.match(/^([0-9]+)px$/i);if(t)return parseInt(t[1])}const Ye=function(e){const{rootNode:t,window:n,isInlineContent:o,emojiData:i}=e;!function(e){const{rootNode:t,window:n,emojiData:{emojiByName:o}}=e,i=Array.from(t.querySelectorAll("img[data-stringify-emoji]"));for(const r of i){const e=r.getAttribute("data-stringify-emoji")||"",t=e.match(/^:(.+):$/);if(!t||!r.parentNode)continue;const i=o[t[1]]||e;r.parentNode.replaceChild(n.document.createTextNode(i),r)}}({rootNode:t,window:n,emojiData:i}),t.normalize(),$e(t,n);const r=$.p4(t.childNodes);for(;r.length>0;){let e=r.shift();if(e instanceof n.Element&&e.parentNode&&"google-sheets-html-origin"===e.tagName.toLowerCase()){const t=$.p4(e.childNodes);for(const n of t)e.parentNode.insertBefore(n,e);r.unshift(...t),e.remove()}else if(e&&e.parentNode&&3===e.nodeType&&/^( |\t)*(\n)+( |\t)*$/.test(e.data))e.parentNode.removeChild(e);else if(e&&e instanceof n.Element&&e.parentNode&&ne[e.tagName.toLowerCase()])e.parentNode.removeChild(e);else{if(e instanceof n.HTMLElement){const t=(a=e.style.fontSize||void 0)&&-1!==a.indexOf("px")||a&&-1!==a.indexOf("pt")?parseInt(a):void 0,o=Oe(e.style.fontSize||void 0);(t&&t>=24||o&&o>2)&&(e=qe(e,"h1",n))}if(e instanceof n.HTMLElement&&("line-through"===e.style.textDecoration&&Ge(e,"del",n),"italic"===e.style.fontStyle&&Ge(e,"em",n),("bold"===e.style.fontWeight||e.style.fontWeight&&parseInt(e.style.fontWeight)>=500)&&Ge(e,"strong",n)),e instanceof n.HTMLImageElement){const t=Qe(e.style.width);!e.width&&t&&(e.width=t)}if(e instanceof n.HTMLElement&&("b"===e.tagName.toLowerCase()?e=qe(e,"strong",n):"i"===e.tagName.toLowerCase()&&(e=qe(e,"em",n))),e instanceof n.HTMLElement&&"strong"===e.tagName.toLowerCase()&&"normal"===e.style.fontWeight&&(e=qe(e,"span",n)),e instanceof n.HTMLElement&&("section"===e.tagName.toLowerCase()||"article"===e.tagName.toLowerCase())&&(e=qe(e,"div",n)),e instanceof n.HTMLElement&&"div"===e.tagName.toLowerCase()&&"inline"===e.style.display&&(e=qe(e,"span",n)),e instanceof n.HTMLElement&&"input"===e.tagName.toLowerCase()&&"checkbox"===e.type){const t=e.checked,o=e.parentNode,i=n.document.createElement("span");i.textContent=`[${t?"x":" "}] `,o&&(o.insertBefore(i,e),o.removeChild(e)),r.push(i)}else{if(e instanceof n.HTMLElement&&"table"===e.tagName.toLowerCase()){const t=Array.from(e.querySelectorAll("tr")).map((e=>e.querySelectorAll("td, th")));if(t.every((e=>1===e.length))){const o=n.document.createDocumentFragment();for(const e of t){const t=e[0],i=t.childNodes.length;for(let e=0;e<i;e+=1){const n=t.childNodes[e];n&&(o.appendChild(n),r.push(n))}o.appendChild(n.document.createElement("hr"))}e.parentNode&&e.parentNode.replaceChild(o,e)}}if(e instanceof n.HTMLElement&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase())&&e.parentNode instanceof n.HTMLElement&&("ul"===e.parentNode.tagName.toLowerCase()||"ol"===e.parentNode.tagName.toLowerCase())&&e.previousSibling instanceof n.HTMLElement&&"li"===e.previousSibling.tagName.toLowerCase()&&e.previousSibling.appendChild(e),e instanceof n.Element&&(e.removeAttribute("style"),e.removeAttribute("dir")),e instanceof n.Element&&"span"===e.tagName.toLowerCase()){(e.hasAttribute(re[y.GKr.Highlight])||e.hasAttribute(re[y.GKr.Discussion])||e.hasAttribute(re[y.GKr.Equation])?Array.from(e.children):Ke(e)).forEach((e=>r.push(e)))}else if(e){$.p4(e.childNodes).forEach((e=>r.push(e)))}}}}var a;for($.p4(t.childNodes).forEach((e=>r.push(e)));r.length>0;){const e=r.shift();if(e)if(Je(e,n)&&m.yW(e.childNodes,(e=>e instanceof n.Element&&"h1"===e.tagName.toLowerCase()))){const t=n.document.createElement("h1");m.S6(e.childNodes,(e=>{m.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const o=e.parentNode;if(o){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const i=n.document.createElement(e.tagName.toLowerCase());i.appendChild(t),o.insertBefore(i,e)}else o.insertBefore(t,e);o.removeChild(e)}r.push(t)}else if(Je(e,n)&&m.yW(e.childNodes,(e=>e instanceof n.Element&&"h2"===e.tagName.toLowerCase()))){const t=n.document.createElement("h2");m.S6(e.childNodes,(e=>{m.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const o=e.parentNode;if(o){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const i=n.document.createElement(e.tagName.toLowerCase());i.appendChild(t),o.insertBefore(i,e)}else o.insertBefore(t,e);o.removeChild(e)}r.push(t)}else if(e instanceof n.HTMLElement&&("div"===e.tagName.toLowerCase()||"span"===e.tagName.toLowerCase())&&e.parentNode&&0===e.childNodes.length)e.parentNode.removeChild(e);else if(!Je(e,n)||"p"!==e.tagName.toLowerCase()&&"div"!==e.tagName.toLowerCase()&&"figure"!==e.tagName.toLowerCase()||!$.p4(e.childNodes).some((e=>e instanceof n.Element&&("p"===e.tagName.toLowerCase()||"div"===e.tagName.toLowerCase()||"img"===e.tagName.toLowerCase()||"ul"===e.tagName.toLowerCase()||"table"===e.tagName.toLowerCase()||"hr"===e.tagName.toLowerCase()||"video"===e.tagName.toLowerCase())))){if(e&&e.childNodes){$.p4(e.childNodes).forEach((e=>r.push(e)))}}else{Ke(e).forEach((e=>r.push(e)))}}t.normalize(),o||$.p4(t.childNodes).forEach((e=>{if(3===e.nodeType){const o=n.document.createElement("p");t.insertBefore(o,e),o.appendChild(e)}}))};function Je(e,t){return e instanceof t.Element&&(0!==e.childNodes.length&&!(e.hasAttribute(re[i.Ti.columnList])||e.hasAttribute(re[i.Ti.column])||e.hasAttribute(re[i.Ti.callout])))}function Xe(e){const{actor:t,parentId:n,spaceId:o,parentTable:i,rootNode:r,importFileMap:a,window:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:d,intl:u,randomID:p,randomShortID:m,isPhoneNumber:f,emojiData:g}=e;Ye({rootNode:r,window:s,isInlineContent:!1,emojiData:g});const h=[];return{allOperations:h,rootContentIds:je({actor:t,parentId:n,parentTable:i,spaceId:o,nodes:$.p4(r.children),allOperations:h,importFileMap:a,window:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:d,intl:u,randomID:p,randomShortID:m,isPhoneNumber:f})}}const et=function(e){const{node:t,window:n,stripText:o,emojiData:i}=e;return Ye({rootNode:t,window:n,isInlineContent:!0,emojiData:i}),me({node:t,window:n,stripText:o})};function tt(e){const{node:t,window:n,emojiData:o}=e;return Ye({rootNode:t,window:n,isInlineContent:!1,emojiData:o}),ot(t,n)}const nt=new Set(["span","div","p"]);function ot(e,t){const n=e.tagName.toLowerCase();if(!nt.has(n))return!0;if("div"===n&&(e.className===oe||e.hasAttribute(re[i.Ti.columnList])))return!0;for(const o of Array.from(e.childNodes))if(ae(t,o)&&ot(o,t))return!0;return!1}function it(e){if("default"===e||"gray"===e||"brown"===e||"orange"===e||"yellow"===e||"teal"===e||"blue"===e||"purple"===e||"pink"===e||"red"===e||"gray_background"===e||"brown_background"===e||"orange_background"===e||"yellow_background"===e||"teal_background"===e||"blue_background"===e||"purple_background"===e||"pink_background"===e||"red_background"===e)return e}},45208:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("abstract",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 16C0 3.199 3.199 0 16 0s16 3.199 16 16-3.199 16-16 16S0 28.801 0 16zm9.976 7.71a6.128 6.128 0 003.398 1.043 6.14 6.14 0 006.146-6.127 6.126 6.126 0 10-9.544 5.085zm11.521.79h3.004v-17H7.499v2.997h13.998V24.5zm-5-5.874a3.123 3.123 0 11-6.246 0 3.123 3.123 0 016.246 0z"})})},52897:(e,t,n)=>{n.d(t,{d:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("aiImproveWriting",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8.84082 0.982422C8.84082 0.524414 8.45801 0.134766 8 0.134766C7.54199 0.134766 7.15234 0.524414 7.15234 0.982422V3.06738C7.15234 3.52539 7.54199 3.9082 8 3.9082C8.45801 3.9082 8.84082 3.52539 8.84082 3.06738V0.982422ZM10.9463 3.9082C10.6318 4.22949 10.6318 4.77637 10.96 5.10449C11.2744 5.41895 11.8281 5.41895 12.1494 5.09082L13.5781 3.66211C13.8994 3.34766 13.8926 2.79395 13.5645 2.46582C13.25 2.14453 12.6963 2.1582 12.375 2.47949L10.9463 3.9082ZM3.84375 5.09082C4.16504 5.41895 4.71875 5.41895 5.0332 5.10449C5.36133 4.77637 5.36133 4.22949 5.04688 3.9082L3.625 2.47949C3.30371 2.1582 2.75 2.14453 2.43555 2.46582C2.10742 2.78711 2.10742 3.34082 2.42188 3.65527L3.84375 5.09082ZM13.3047 14.9277C13.7148 15.3447 14.4121 15.3379 14.8154 14.9277C15.2188 14.5107 15.2188 13.834 14.8154 13.417L8.32812 6.88184C7.91797 6.47168 7.2207 6.47168 6.81738 6.88184C6.40723 7.29883 6.41406 7.97559 6.81738 8.38574L13.3047 14.9277ZM0.931641 7.19629C0.473633 7.19629 0.0908203 7.5791 0.0908203 8.03711C0.0908203 8.49512 0.473633 8.87793 0.931641 8.87793H3.0166C3.47461 8.87793 3.86426 8.49512 3.86426 8.03711C3.86426 7.5791 3.47461 7.19629 3.0166 7.19629H0.931641ZM15.0615 8.87793C15.5195 8.87793 15.9092 8.49512 15.9092 8.03711C15.9092 7.5791 15.5195 7.19629 15.0615 7.19629H12.9834C12.5254 7.19629 12.1357 7.5791 12.1357 8.03711C12.1357 8.49512 12.5254 8.87793 12.9834 8.87793H15.0615ZM9.62695 10.1357L7.49414 7.99609C7.32324 7.83203 7.26172 7.62012 7.43262 7.45605C7.58301 7.30566 7.80176 7.36035 7.97266 7.53125L10.0918 9.65723L9.62695 10.1357ZM2.42188 12.3984C2.10059 12.7197 2.09375 13.2734 2.4082 13.5879C2.72949 13.916 3.2832 13.9229 3.60449 13.6084L5.0332 12.1797C5.35449 11.8584 5.36133 11.3115 5.04688 10.9902C4.72559 10.6689 4.17188 10.6621 3.85059 10.9766L2.42188 12.3984ZM8.84082 13.0137C8.84082 12.5557 8.45801 12.166 8 12.166C7.54199 12.166 7.15234 12.5557 7.15234 13.0137V15.0918C7.15234 15.5498 7.54199 15.9395 8 15.9395C8.45801 15.9395 8.84082 15.5498 8.84082 15.0918V13.0137Z"})})},9999:(e,t,n)=>{n.d(t,{J:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("alias",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.1475 10.5869V3.72363C13.1475 3.25195 12.833 2.93066 12.3477 2.93066H5.48438C5.02637 2.93066 4.70508 3.27246 4.70508 3.67578C4.70508 4.07227 5.05371 4.40039 5.46387 4.40039H7.89746L10.8438 4.30469L9.59961 5.39844L3.08496 11.9199C2.92773 12.0771 2.8457 12.2686 2.8457 12.46C2.8457 12.8564 3.20801 13.2256 3.61816 13.2256C3.80957 13.2256 3.99414 13.1504 4.15137 12.9932L10.6729 6.47168L11.7803 5.22754L11.6641 8.05762V10.6074C11.6641 11.0176 11.9922 11.373 12.4023 11.373C12.8057 11.373 13.1475 11.0312 13.1475 10.5869Z"})})},82477:(e,t,n)=>{n.d(t,{L:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("alignCenter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-8.736 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.656-1.905-1.922-1.905H5.704c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.843-.28-.843-.85V5.78c0-.568.298-.85.843-.85h4.452c.539 0 .843.282.843.85v4.44c0 .568-.304.85-.697.85H5.774z"})})},70622:(e,t,n)=>{n.d(t,{$:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("alignLeft",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zM3.372 12.218H8.11c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H3.372c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H3.442z"})})},53376:(e,t,n)=>{n.d(t,{g:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("alignRight",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-6.408 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H8.032c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H8.102z"})})},77458:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("amex",{viewBox:"0 0 34 24",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("rect",{width:"34",height:"24",rx:"3",fill:"#1F72CD"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.0954 8.5l-3.1811 7.2467h3.8082l.4721-1.1554h1.0792l.472 1.1554h4.1919v-.8818l.3735.8818h2.1683l.3735-.9005v.9005h8.7178l1.0601-1.1254.9926 1.1254 4.4776.0094-3.1911-3.6125L31.1011 8.5h-4.4082L25.661 9.6046 24.6997 8.5h-9.4838l-.8144 1.8704L13.568 8.5H9.7677v.8519L9.345 8.5H6.0954zm.7369 1.029h1.8563l2.11 4.9141v-4.914h2.0335l1.6298 3.5233 1.502-3.5234h2.0234v5.2001h-1.2312l-.0101-4.0747-1.7949 4.0747h-1.1013l-1.805-4.0747v4.0747H9.512l-.4802-1.1658H6.4378l-.4792 1.1647h-1.357l2.2308-5.199zm17.2875 0h-5.0062v5.197h4.9287l1.5886-1.7224 1.5311 1.7224h1.6006l-2.3264-2.5834 2.3264-2.6136h-1.5311l-1.5805 1.7026-1.5312-1.7026zm-16.3845.8799l-.8547 2.0767H8.589l-.8537-2.0767zM20.35 11.555v-.9502h3.1237l1.363 1.5181-1.4234 1.5264h-3.0633V12.613h2.7311v-1.058h-2.7311z",fill:"#fff"})]})})},59905:(e,t,n)=>{n.d(t,{T:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("applePay",{viewBox:"0 0 34 24",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("rect",{x:".5",y:".5",width:"33",height:"23",rx:"2.5",fill:"#fff",stroke:"#D9D9D9"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.4492 8.3432c-.2854.3519-.742.6294-1.1986.5898-.057-.4758.1665-.9814.428-1.2936.2855-.3619.7849-.6196 1.1892-.6394.0475.4956-.138.9813-.4186 1.3432zm.4138.684c-.4023-.0242-.7693.126-1.0658.2473-.1908.078-.3524.1442-.4753.1442-.138 0-.3062-.0697-.495-.1479-.2476-.1024-.5305-.2196-.8273-.214-.6801.01-1.3127.4114-1.66 1.0508-.7134 1.2787-.1854 3.172.5042 4.2129.3377.5154.742 1.0804 1.2748 1.0606.2343-.0092.4029-.0838.5774-.1609.2008-.0888.4095-.1811.7353-.1811.3145 0 .514.0899.7056.1761.1821.0821.357.1608.6167.156.5517-.0099.8989-.5155 1.2366-1.0309.3645-.5532.5246-1.0932.5489-1.1751l.0029-.0095c-.0006-.0006-.0051-.0027-.0131-.0065-.1218-.0581-1.0529-.5023-1.0619-1.6935-.0089-.9998.7386-1.5063.8563-1.586v-.0001c.0071-.0048.012-.0081.0141-.0098-.4756-.7335-1.2176-.8128-1.4744-.8327zm3.8194 6.2895V7.5898h2.7825c1.4364 0 2.44 1.031 2.44 2.5376 0 1.5067-1.0227 2.5476-2.4781 2.5476h-1.5934v2.6417h-1.151zm1.1509-6.7158h1.327c.9989 0 1.5696.555 1.5696 1.5315 0 .9764-.5707 1.5364-1.5743 1.5364h-1.3223v-3.068zm7.872 5.7889c-.3044.6047-.9751.9863-1.6981.9863-1.0701 0-1.8169-.6641-1.8169-1.6653 0-.9912.723-1.5612 2.0595-1.6455l1.4364-.0892v-.4262c0-.6295-.3947-.9715-1.0987-.9715-.5803 0-1.0036.3123-1.0892.7881h-1.0369c.0333-1.0012.937-1.7298 2.1594-1.7298 1.3175 0 2.1737.7187 2.1737 1.8339v3.8461H22.729v-.9269h-.0237zm-1.389.0694c-.6136 0-1.0036-.3073-1.0036-.7781 0-.4857.3758-.7682 1.094-.8128l1.2794-.0843v.4362c0 .7236-.5897 1.239-1.3698 1.239zm6.0121 1.1598c-.4614 1.3531-.9893 1.7991-2.1118 1.7991-.0856 0-.371-.0099-.4376-.0297v-.9268c.0713.0099.2473.0198.3377.0198.5089 0 .7943-.223.9703-.8029l.1046-.342-1.9501-5.6254h1.2034l1.3555 4.5648h.0238l1.3556-4.5648h1.1701l-2.0215 5.9079z",fill:"#000"})]})})},33907:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("arrowRight",{viewBox:"0 0 30 30",svg:(0,i.jsx)("polygon",{points:"1 14 25.188 14 16.594 5.406 18 4 29 15 18 26 16.594 24.594 25.188 16 1 16"})})},55631:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("arrowsOut",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M7.09101 20.6434C7.50813 20.2263 7.49239 19.6124 7.07527 19.1953L6.41418 18.5342L3.51009 15.9449L7.75998 16.0551L12.6237 16.0709C12.8992 16.0787 13.1353 15.9685 13.3242 15.7797C13.7728 15.3311 13.8121 14.7093 13.3714 14.2686C13.1589 14.0561 12.8992 13.938 12.6159 13.938L7.75998 13.9459L3.51009 14.0561L6.42205 11.4589L7.07527 10.8057C7.49239 10.3886 7.52387 9.77473 7.09888 9.34974C6.6739 8.92476 6.06002 8.9405 5.63503 9.36548L1.2671 13.7334C0.464339 14.5362 0.464339 15.4649 1.2671 16.2676L5.63503 20.6356C6.04428 21.0448 6.6739 21.0605 7.09101 20.6434ZM24.3739 20.6592L28.7418 16.2912C29.5446 15.4885 29.5524 14.5519 28.7497 13.7492L24.3818 9.38123C23.9725 8.97198 23.3429 8.95624 22.9179 9.38123C22.5087 9.79047 22.5165 10.4122 22.9336 10.8293L23.5947 11.4904L26.5067 14.0718L22.2489 13.9695L17.3931 13.9459C17.1176 13.938 16.8736 14.0561 16.6847 14.245C16.244 14.6857 16.1968 15.3153 16.6375 15.7561C16.85 15.9685 17.1176 16.0787 17.4009 16.0787L22.2489 16.0787L26.5067 15.9607L23.5947 18.5578L22.9336 19.2189C22.5165 19.636 22.485 20.2499 22.91 20.6749C23.335 21.0999 23.9568 21.0763 24.3739 20.6592Z"})})},12970:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("assistFindActionItems",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.15503 7.44971C4.80298 7.44971 6.16748 6.0918 6.16748 4.43726C6.16748 2.78271 4.80957 1.41821 3.15503 1.41821C1.4939 1.41821 0.135986 2.78271 0.135986 4.43726C0.135986 6.0918 1.4939 7.44971 3.15503 7.44971ZM2.79248 6.06543C2.63428 6.06543 2.50903 5.97974 2.40356 5.85449L1.66528 4.97778C1.58618 4.87891 1.55322 4.7998 1.55322 4.68774C1.55322 4.45044 1.7312 4.27246 1.95532 4.27246C2.10034 4.27246 2.18604 4.33179 2.28491 4.45044L2.78589 5.0437L3.95264 3.17822C4.05151 3.02002 4.17017 2.94751 4.32178 2.94751C4.55249 2.94751 4.74365 3.1189 4.74365 3.33643C4.74365 3.42871 4.71729 3.5144 4.64478 3.62646L3.18799 5.84131C3.0957 5.97974 2.95068 6.06543 2.79248 6.06543ZM8.47461 5.16235H15.1257C15.5278 5.16235 15.8574 4.84595 15.8574 4.43726C15.8574 4.03516 15.5278 3.71216 15.1257 3.71216H8.47461C8.07251 3.71216 7.74951 4.03516 7.74951 4.43726C7.74951 4.84595 8.07251 5.16235 8.47461 5.16235ZM3.15503 15.0566C4.80957 15.0566 6.16748 13.6921 6.16748 12.0376C6.16748 10.3831 4.80957 9.01855 3.15503 9.01855C1.4939 9.01855 0.135986 10.3831 0.135986 12.0376C0.135986 13.6921 1.4939 15.0566 3.15503 15.0566ZM3.15503 13.6592C2.27173 13.6592 1.53345 12.9209 1.53345 12.0376C1.53345 11.1543 2.27173 10.416 3.15503 10.416C4.03833 10.416 4.77661 11.1543 4.77661 12.0376C4.77661 12.9209 4.03833 13.6592 3.15503 13.6592ZM8.47461 12.7957H15.1257C15.5278 12.7957 15.8574 12.4727 15.8574 12.0706C15.8574 11.6685 15.5278 11.3455 15.1257 11.3455H8.47461C8.07251 11.3455 7.74951 11.6685 7.74951 12.0706C7.74951 12.4727 8.07251 12.7957 8.47461 12.7957Z"})})},12436:(e,t,n)=>{n.d(t,{l:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("audio",{viewBox:"0 0 26 23",svg:(0,i.jsx)("path",{d:"M0 6.06667V16.4667H5.2L12.1333 22.5333V0L5.2 6.06667H0ZM4.33333 14.7333H1.73333V7.8H4.33333V14.7333ZM6.06667 7.61193L10.4 3.8194V18.7139L6.06667 14.9214V7.61193ZM19.0667 11.2667C19.0667 8.84433 17.6445 6.76087 15.5931 5.78847L14.586 7.24447C16.1928 7.87627 17.3333 9.43453 17.3333 11.2684C17.3333 13.1023 16.1928 14.6588 14.586 15.2923L15.5931 16.7483C17.6445 15.7725 19.0667 13.689 19.0667 11.2667ZM19.5607 0.0563333L18.5718 1.48287C21.9709 3.42247 24.2658 7.07373 24.2658 11.2667C24.2658 15.4596 21.9709 19.1109 18.5727 21.0505L19.5615 22.477C23.4087 20.2193 26 16.0507 26 11.2667C26 6.48267 23.4087 2.314 19.5607 0.0563333ZM22.5333 11.2667C22.5333 7.6648 20.5339 4.53093 17.5855 2.9094L16.5915 4.34547C19.0918 5.64547 20.8 8.25413 20.8 11.2649C20.8 14.2757 19.0901 16.8844 16.5915 18.1844L17.5855 19.6205C20.5339 18.0015 22.5333 14.8685 22.5333 11.2667Z"})})},83096:(e,t,n)=>{n.d(t,{Q:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("book",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M27,23V1H7C4.791,1,3,2.791,3,5v20c0,2.209,1.791,4,4,4h20v-2h-1v-4H27z M21,3v6l-1-1.333L19,9V3H21z M20,11l3,4V3h2v18H9V3 h8v12L20,11z M5,5c0-1.103,0.896-2,2-2v18c-0.729,0-1.411,0.195-2,0.537V5z M24,27H7c-1.104,0-2-0.896-2-2s0.896-2,2-2h17V27z"})})},36591:(e,t,n)=>{n.d(t,{e:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("check",{viewBox:"0 0 14 14",svg:(0,i.jsx)("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})})},22225:(e,t,n)=>{n.d(t,{g:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("checkPartial",{viewBox:"0 0 14 14",svg:(0,i.jsx)("rect",{x:"1.75",y:"6.125",width:"10.5",height:"1.75"})})},72261:(e,t,n)=>{n.d(t,{v:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("checkboxCircle",{viewBox:"0 0 22 23",svg:(0,i.jsx)("circle",{cx:"11",cy:"11.5",r:"10",stroke:"#E2E1DE",strokeWidth:"2"})})},65628:(e,t,n)=>{n.d(t,{z:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("checkboxSquare",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M1.5,1.5 L1.5,14.5 L14.5,14.5 L14.5,1.5 L1.5,1.5 Z M0,0 L16,0 L16,16 L0,16 L0,0 Z"})})},42853:(e,t,n)=>{n.d(t,{i:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("chevronDown",{viewBox:"0 0 30 30",svg:(0,i.jsx)("polygon",{points:"15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "})})},17693:(e,t,n)=>{n.d(t,{A:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("chevronDownRoundedThick",{viewBox:"0 0 12 12",svg:(0,i.jsx)("path",{d:"M6.02734 8.80274C6.27148 8.80274 6.47168 8.71484 6.66211 8.51465L10.2803 4.82324C10.4268 4.67676 10.5 4.49609 10.5 4.28125C10.5 3.85156 10.1484 3.5 9.72363 3.5C9.50879 3.5 9.30859 3.58789 9.15234 3.74902L6.03223 6.9668L2.90722 3.74902C2.74609 3.58789 2.55078 3.5 2.33105 3.5C1.90137 3.5 1.55469 3.85156 1.55469 4.28125C1.55469 4.49609 1.62793 4.67676 1.77441 4.82324L5.39258 8.51465C5.58789 8.71973 5.78808 8.80274 6.02734 8.80274Z"})})},5257:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("chevronRight",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M12.375 8.06445C12.375 7.83203 12.2861 7.63379 12.1084 7.45605L6.77637 2.24023C6.62598 2.08984 6.44141 2.01465 6.22266 2.01465C5.77832 2.01465 5.42285 2.35645 5.42285 2.80078C5.42285 3.01953 5.51172 3.21777 5.66211 3.375L10.4746 8.06445L5.66211 12.7539C5.51855 12.9043 5.42285 13.1025 5.42285 13.3213C5.42285 13.7725 5.77832 14.1143 6.22266 14.1143C6.44141 14.1143 6.62598 14.0391 6.77637 13.8887L12.1084 8.67285C12.293 8.49512 12.375 8.29688 12.375 8.06445Z"})})},53465:(e,t,n)=>{n.d(t,{X:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("clearInput",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.993 15.528a7.273 7.273 0 01-2.923-.593A7.633 7.633 0 012.653 13.3a7.797 7.797 0 01-1.633-2.417 7.273 7.273 0 01-.593-2.922c0-1.035.198-2.01.593-2.922A7.758 7.758 0 015.063.99 7.273 7.273 0 017.985.395a7.29 7.29 0 012.93.593 7.733 7.733 0 012.417 1.64 7.647 7.647 0 011.64 2.41c.396.914.594 1.888.594 2.923 0 1.035-.198 2.01-.593 2.922a7.735 7.735 0 01-4.058 4.05 7.272 7.272 0 01-2.922.594zM5.59 11.06c.2 0 .371-.066.513-.198L8 8.951l1.904 1.911a.675.675 0 00.498.198.667.667 0 00.491-.198.67.67 0 00.205-.49.64.64 0 00-.205-.491L8.981 7.969l1.92-1.911a.686.686 0 00.204-.491.646.646 0 00-.205-.484.646.646 0 00-.483-.205.67.67 0 00-.49.205L8 6.995 6.081 5.083a.696.696 0 00-.49-.19.682.682 0 00-.491.198.651.651 0 00-.198.49c0 .181.068.342.205.484l1.912 1.904-1.912 1.92a.646.646 0 00-.205.483c0 .19.066.354.198.49.136.132.3.198.49.198z"})})},19525:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("closeThick",{viewBox:"0 0 8 8",svg:(0,i.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},3124:(e,t,n)=>{n.d(t,{_:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("codeOnly",{viewBox:"0 0 24 20",svg:(0,i.jsx)("path",{d:"M8.093 13.62c.458.123.875-.123 1.011-.58l3.364-11.533c.13-.43-.082-.855-.54-.978-.451-.123-.848.075-.998.581L7.58 12.595c-.137.465.041.895.513 1.025zM.115 7.064c0 .233.103.472.301.643l4.423 3.992c.362.328.848.322 1.148-.02.308-.342.267-.834-.082-1.149L2.077 7.064l3.828-3.472c.349-.315.39-.8.082-1.142-.3-.342-.786-.348-1.148-.02L.416 6.415a.879.879 0 00-.3.65zm19.763 0a.878.878 0 00-.3-.649L15.153 2.43c-.362-.328-.847-.322-1.148.02-.308.342-.267.827.082 1.142l3.828 3.472-3.828 3.466c-.349.315-.39.807-.082 1.149.3.341.786.348 1.148.02l4.423-3.992c.198-.17.3-.41.3-.643z"})})},5049:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("codePreviewOnly",{viewBox:"0 0 24 20",svg:(0,i.jsx)("path",{d:"M2.608 11.906h1.21v1.032c0 1.463.766 2.215 2.243 2.215h9.33c1.477 0 2.243-.758 2.243-2.215V6.444c0-1.463-.766-2.221-2.242-2.221H14.12V3.197c0-1.463-.772-2.221-2.242-2.221h-9.27C1.132.976.366 1.734.366 3.197v6.494c0 1.457.766 2.215 2.242 2.215zm.082-1.34c-.635 0-.984-.328-.984-.99v-6.27c0-.662.349-.99.984-.99h9.106c.629 0 .984.328.984.99v.917H6.06c-1.476 0-2.242.758-2.242 2.221v4.122H2.69zm3.453 3.254c-.636 0-.985-.335-.985-.998V6.561c0-.664.349-.998.985-.998h9.167c.628 0 .984.334.984.998v6.261c0 .663-.356.998-.984.998H6.143zm2.713-1.77c0 .307.335.437.595.287l3.972-2.324a.372.372 0 00-.007-.643L9.451 7.046c-.26-.15-.595-.027-.595.287v4.717z"})})},43661:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("codepen",{viewBox:"0 0 40 40",svg:(0,i.jsx)("path",{d:"M39.9834,13.7071 C39.8236,12.6665 38.6647,12.1063 37.8655,11.586 C36.4269,10.6255 35.0283,9.70502 33.5897,8.74452 C30.1931,6.46334 26.7564,4.18216 23.3598,1.90098 C22.5606,1.38071 21.7613,0.820424 20.9621,0.300155 C20.4027,-0.100052 19.6434,-0.100052 19.044,0.300155 C16.7663,1.82094 14.4485,3.38175 12.1708,4.90253 L2.10066,11.626 C1.22152,12.1863 0.0626603,12.7466 0.0226996,13.9472 C-0.0172612,15.2679 0.0226996,16.6286 0.0226996,17.9493 L0.0226996,24.3526 C0.0226996,25.5132 -0.217065,26.8739 0.861875,27.5943 C3.41936,29.3552 6.01681,31.036 8.61426,32.7569 C11.8111,34.878 15.008,37.0391 18.2048,39.1602 C19.084,39.7606 19.9631,40.4009 21.0421,39.6805 C21.9611,39.0802 22.8403,38.4799 23.7594,37.8796 C27.3159,35.5184 30.8724,33.1171 34.4289,30.7559 L38.385,28.1145 C38.6248,27.9544 38.9045,27.7944 39.1443,27.5943 C39.7037,27.1941 39.9435,26.6338 39.9435,25.9534 L39.9435,14.9477 C39.9834,14.5075 40.0234,14.1073 39.9834,13.7071 C39.9834,13.7871 39.9834,13.6671 39.9834,13.7071 Z M21.7214,4.94255 L35.1882,13.9472 L29.194,17.9893 L21.7214,12.9867 L21.7214,4.94255 Z M18.2848,4.94255 L18.2848,12.9467 L10.8521,17.9493 L4.81799,13.9472 L18.2848,4.94255 Z M3.45932,17.1489 L7.73512,20.0304 L3.45932,22.9118 L3.45932,17.1489 Z M18.2848,35.1182 L4.81799,26.1135 L10.8121,22.0714 L18.2448,27.074 L18.2448,35.1182 L18.2848,35.1182 Z M20.0031,24.1125 L13.929,20.0304 L20.0031,15.9482 L26.0771,20.0304 L20.0031,24.1125 Z M21.7214,35.1182 L21.7214,27.114 L29.1541,22.1114 L35.1482,26.1535 L21.7214,35.1182 Z M36.5468,22.9118 L32.271,20.0304 L36.5868,17.1489 L36.5468,22.9118 Z"})})},35013:(e,t,n)=>{n.d(t,{i:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionBoard",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.39697 14.4634H13.5964C15.0532 14.4634 15.8311 13.6921 15.8311 12.2485V4.24609C15.8311 2.80249 15.0532 2.03125 13.5964 2.03125H2.39697C0.940186 2.03125 0.162354 2.7959 0.162354 4.24609V12.2485C0.162354 13.6987 0.940186 14.4634 2.39697 14.4634ZM2.52222 12.9934C1.94214 12.9934 1.63232 12.7034 1.63232 12.0969V4.39771C1.63232 3.79126 1.94214 3.50122 2.52222 3.50122H4.92822V12.9934H2.52222ZM6.34546 12.9934V3.50122H9.64795V12.9934H6.34546ZM13.4712 3.50122C14.0447 3.50122 14.3611 3.79126 14.3611 4.39771V12.0969C14.3611 12.7034 14.0447 12.9934 13.4712 12.9934H11.0652V3.50122H13.4712Z"})})},21321:(e,t,n)=>{n.d(t,{N:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionCalendar",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.29688 14.4561H12.7031C14.1797 14.4561 14.9453 13.6904 14.9453 12.2344V3.91504C14.9453 2.45215 14.1797 1.69336 12.7031 1.69336H3.29688C1.82031 1.69336 1.05469 2.45215 1.05469 3.91504V12.2344C1.05469 13.6973 1.82031 14.4561 3.29688 14.4561ZM3.27637 13.1162C2.70898 13.1162 2.39453 12.8154 2.39453 12.2207V5.9043C2.39453 5.30273 2.70898 5.00879 3.27637 5.00879H12.71C13.2842 5.00879 13.6055 5.30273 13.6055 5.9043V12.2207C13.6055 12.8154 13.2842 13.1162 12.71 13.1162H3.27637ZM6.68066 7.38086H7.08398C7.33008 7.38086 7.41211 7.30566 7.41211 7.05957V6.66309C7.41211 6.41699 7.33008 6.3418 7.08398 6.3418H6.68066C6.44141 6.3418 6.35938 6.41699 6.35938 6.66309V7.05957C6.35938 7.30566 6.44141 7.38086 6.68066 7.38086ZM8.92285 7.38086H9.31934C9.56543 7.38086 9.64746 7.30566 9.64746 7.05957V6.66309C9.64746 6.41699 9.56543 6.3418 9.31934 6.3418H8.92285C8.67676 6.3418 8.59473 6.41699 8.59473 6.66309V7.05957C8.59473 7.30566 8.67676 7.38086 8.92285 7.38086ZM11.1582 7.38086H11.5547C11.8008 7.38086 11.8828 7.30566 11.8828 7.05957V6.66309C11.8828 6.41699 11.8008 6.3418 11.5547 6.3418H11.1582C10.9121 6.3418 10.8301 6.41699 10.8301 6.66309V7.05957C10.8301 7.30566 10.9121 7.38086 11.1582 7.38086ZM4.44531 9.58203H4.84863C5.09473 9.58203 5.17676 9.50684 5.17676 9.26074V8.86426C5.17676 8.61816 5.09473 8.54297 4.84863 8.54297H4.44531C4.20605 8.54297 4.12402 8.61816 4.12402 8.86426V9.26074C4.12402 9.50684 4.20605 9.58203 4.44531 9.58203ZM6.68066 9.58203H7.08398C7.33008 9.58203 7.41211 9.50684 7.41211 9.26074V8.86426C7.41211 8.61816 7.33008 8.54297 7.08398 8.54297H6.68066C6.44141 8.54297 6.35938 8.61816 6.35938 8.86426V9.26074C6.35938 9.50684 6.44141 9.58203 6.68066 9.58203ZM8.92285 9.58203H9.31934C9.56543 9.58203 9.64746 9.50684 9.64746 9.26074V8.86426C9.64746 8.61816 9.56543 8.54297 9.31934 8.54297H8.92285C8.67676 8.54297 8.59473 8.61816 8.59473 8.86426V9.26074C8.59473 9.50684 8.67676 9.58203 8.92285 9.58203ZM11.1582 9.58203H11.5547C11.8008 9.58203 11.8828 9.50684 11.8828 9.26074V8.86426C11.8828 8.61816 11.8008 8.54297 11.5547 8.54297H11.1582C10.9121 8.54297 10.8301 8.61816 10.8301 8.86426V9.26074C10.8301 9.50684 10.9121 9.58203 11.1582 9.58203ZM4.44531 11.7832H4.84863C5.09473 11.7832 5.17676 11.708 5.17676 11.4619V11.0654C5.17676 10.8193 5.09473 10.7441 4.84863 10.7441H4.44531C4.20605 10.7441 4.12402 10.8193 4.12402 11.0654V11.4619C4.12402 11.708 4.20605 11.7832 4.44531 11.7832ZM6.68066 11.7832H7.08398C7.33008 11.7832 7.41211 11.708 7.41211 11.4619V11.0654C7.41211 10.8193 7.33008 10.7441 7.08398 10.7441H6.68066C6.44141 10.7441 6.35938 10.8193 6.35938 11.0654V11.4619C6.35938 11.708 6.44141 11.7832 6.68066 11.7832ZM8.92285 11.7832H9.31934C9.56543 11.7832 9.64746 11.708 9.64746 11.4619V11.0654C9.64746 10.8193 9.56543 10.7441 9.31934 10.7441H8.92285C8.67676 10.7441 8.59473 10.8193 8.59473 11.0654V11.4619C8.59473 11.708 8.67676 11.7832 8.92285 11.7832Z"})})},69628:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionGallery",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.0542 7.75952H5.96973C7.00464 7.75952 7.50562 7.25854 7.50562 6.19727V3.58691C7.50562 2.53223 7.00464 2.03125 5.96973 2.03125H2.0542C1.01929 2.03125 0.518311 2.53223 0.518311 3.58691V6.19727C0.518311 7.25854 1.01929 7.75952 2.0542 7.75952ZM10.0303 7.75952H13.9392C14.9741 7.75952 15.4751 7.25854 15.4751 6.19727V3.58691C15.4751 2.53223 14.9741 2.03125 13.9392 2.03125H10.0303C8.98877 2.03125 8.48779 2.53223 8.48779 3.58691V6.19727C8.48779 7.25854 8.98877 7.75952 10.0303 7.75952ZM2.06079 6.55322C1.83008 6.55322 1.71802 6.44116 1.71802 6.20386V3.58032C1.71802 3.34961 1.83008 3.23755 2.06079 3.23755H5.96313C6.18726 3.23755 6.30591 3.34961 6.30591 3.58032V6.20386C6.30591 6.44116 6.18726 6.55322 5.96313 6.55322H2.06079ZM10.0369 6.55322C9.79956 6.55322 9.69409 6.44116 9.69409 6.20386V3.58032C9.69409 3.34961 9.79956 3.23755 10.0369 3.23755H13.9392C14.1633 3.23755 14.2754 3.34961 14.2754 3.58032V6.20386C14.2754 6.44116 14.1633 6.55322 13.9392 6.55322H10.0369ZM2.0542 14.4634H5.96973C7.00464 14.4634 7.50562 13.969 7.50562 12.9077V10.2974C7.50562 9.24268 7.00464 8.7417 5.96973 8.7417H2.0542C1.01929 8.7417 0.518311 9.24268 0.518311 10.2974V12.9077C0.518311 13.969 1.01929 14.4634 2.0542 14.4634ZM10.0303 14.4634H13.9392C14.9741 14.4634 15.4751 13.969 15.4751 12.9077V10.2974C15.4751 9.24268 14.9741 8.7417 13.9392 8.7417H10.0303C8.98877 8.7417 8.48779 9.24268 8.48779 10.2974V12.9077C8.48779 13.969 8.98877 14.4634 10.0303 14.4634ZM2.06079 13.2637C1.83008 13.2637 1.71802 13.1516 1.71802 12.9143V10.2974C1.71802 10.0601 1.83008 9.94141 2.06079 9.94141H5.96313C6.18726 9.94141 6.30591 10.0601 6.30591 10.2974V12.9143C6.30591 13.1516 6.18726 13.2637 5.96313 13.2637H2.06079ZM10.0369 13.2637C9.79956 13.2637 9.69409 13.1516 9.69409 12.9143V10.2974C9.69409 10.0601 9.79956 9.94141 10.0369 9.94141H13.9392C14.1633 9.94141 14.2754 10.0601 14.2754 10.2974V12.9143C14.2754 13.1516 14.1633 13.2637 13.9392 13.2637H10.0369Z"})})},17948:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionList",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.08716 5.15576C2.64087 5.15576 3.08911 4.70752 3.08911 4.15381C3.08911 3.6001 2.64087 3.15186 2.08716 3.15186C1.53345 3.15186 1.08521 3.6001 1.08521 4.15381C1.08521 4.70752 1.53345 5.15576 2.08716 5.15576ZM5.29736 4.85254H14.2161C14.605 4.85254 14.9148 4.54272 14.9148 4.15381C14.9148 3.76489 14.605 3.45508 14.2161 3.45508H5.29736C4.90845 3.45508 4.59863 3.7583 4.59863 4.15381C4.59863 4.54272 4.90186 4.85254 5.29736 4.85254ZM2.08716 9.24927C2.64087 9.24927 3.08911 8.80103 3.08911 8.24731C3.08911 7.6936 2.64087 7.24536 2.08716 7.24536C1.53345 7.24536 1.08521 7.6936 1.08521 8.24731C1.08521 8.80103 1.53345 9.24927 2.08716 9.24927ZM5.29736 8.94604H14.2161C14.605 8.94604 14.9148 8.64282 14.9148 8.24731C14.9148 7.8584 14.605 7.54858 14.2161 7.54858H5.29736C4.90845 7.54858 4.59863 7.8584 4.59863 8.24731C4.59863 8.63623 4.90186 8.94604 5.29736 8.94604ZM2.08716 13.3428C2.64087 13.3428 3.08911 12.8945 3.08911 12.3408C3.08911 11.7937 2.64087 11.3389 2.08716 11.3389C1.53345 11.3389 1.08521 11.7937 1.08521 12.3408C1.08521 12.8945 1.53345 13.3428 2.08716 13.3428ZM5.29736 13.0396H14.2161C14.605 13.0396 14.9148 12.7363 14.9148 12.3408C14.9148 11.9519 14.605 11.6487 14.2161 11.6487H5.29736C4.90845 11.6487 4.59863 11.9519 4.59863 12.3408C4.59863 12.7297 4.90186 13.0396 5.29736 13.0396Z"})})},49019:(e,t,n)=>{n.d(t,{e:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionSearch",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M0 6.35938C0 9.86719 2.85156 12.7188 6.35938 12.7188C7.66406 12.7188 8.85938 12.3203 9.85938 11.6406L13.4531 15.2344C13.6719 15.4609 13.9766 15.5625 14.2812 15.5625C14.9453 15.5625 15.4219 15.0625 15.4219 14.4141C15.4219 14.1016 15.3125 13.8125 15.1016 13.5938L11.5312 10.0156C12.2734 8.99219 12.7188 7.72656 12.7188 6.35938C12.7188 2.85156 9.86719 0 6.35938 0C2.85156 0 0 2.85156 0 6.35938ZM1.65625 6.35938C1.65625 3.76562 3.75781 1.65625 6.35938 1.65625C8.95312 1.65625 11.0625 3.76562 11.0625 6.35938C11.0625 8.95312 8.95312 11.0625 6.35938 11.0625C3.75781 11.0625 1.65625 8.95312 1.65625 6.35938Z"})})},10405:(e,t,n)=>{n.d(t,{_:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionTimeline",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5964 14.4634H2.39697C0.940186 14.4634 0.162354 13.6987 0.162354 12.2485V4.24609C0.162354 2.7959 0.940186 2.03125 2.39697 2.03125H13.5964C15.0532 2.03125 15.8311 2.80249 15.8311 4.24609V12.2485C15.8311 13.6921 15.0532 14.4634 13.5964 14.4634ZM1.63232 12.0969C1.63232 12.7034 1.94214 12.9934 2.52222 12.9934H13.4712C14.0447 12.9934 14.3611 12.7034 14.3611 12.0969V4.39771C14.3611 3.79126 14.0447 3.50122 13.4712 3.50122H2.52222C1.94214 3.50122 1.63232 3.79126 1.63232 4.39771V12.0969ZM8.92711 6.13826H2.71776C2.44986 6.13826 2.23645 5.91123 2.23645 5.64787C2.23645 5.37997 2.44986 5.15747 2.71776 5.15747H8.92711C9.19955 5.15747 9.40842 5.37542 9.40842 5.64787C9.40842 5.91577 9.19955 6.13826 8.92711 6.13826ZM11.3757 8.49036H4.75992C4.49201 8.49036 4.2786 8.26332 4.2786 7.99996C4.2786 7.73206 4.49201 7.50957 4.75992 7.50957H11.3757C11.6482 7.50957 11.857 7.72752 11.857 7.99996C11.857 8.26332 11.6482 8.49036 11.3757 8.49036ZM13.2822 10.8424H8.24608C7.97818 10.8424 7.76477 10.6109 7.76477 10.352C7.76477 10.0841 7.97818 9.85711 8.24608 9.85711H13.2822C13.5547 9.85711 13.7636 10.0796 13.7636 10.352C13.7636 10.6154 13.5547 10.8424 13.2822 10.8424Z"})})},70037:(e,t,n)=>{n.d(t,{h:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("commentAlert",{viewBox:"0 0 34 28",svg:(0,i.jsx)("path",{d:"M8.99023 25.3516C9.55957 25.3516 9.94629 25.1582 10.6338 24.5566L14.2324 21.3232C15.0059 22.1719 16.1768 22.6338 17.6699 22.6338H21.376L24.9639 25.7061C25.6191 26.2646 25.9736 26.5547 26.4893 26.5547C27.2305 26.5547 27.6494 26.0283 27.6494 25.2119V22.6338H28.1006C30.7969 22.6338 32.5908 21.001 32.5908 18.1973V11.8486C32.5908 9.03418 30.7969 7.40137 28.1006 7.40137H26.4141V6.58496C26.4141 3.67383 24.6846 1.97656 21.7627 1.97656H6.39062C3.58691 1.97656 1.73926 3.67383 1.73926 6.58496V16.4785C1.73926 19.4004 3.58691 21.0869 6.39062 21.0869H7.80859V24.0303C7.80859 24.8574 8.22754 25.3516 8.99023 25.3516ZM9.43066 20.3672C9.43066 19.7549 9.06543 19.4756 8.59277 19.4756H6.49805C4.59668 19.4756 3.46875 18.4336 3.46875 16.4355V6.64941C3.46875 4.65137 4.59668 3.59863 6.49805 3.59863H21.6553C23.5566 3.59863 24.6846 4.65137 24.6846 6.64941V7.40137H17.6699C14.8555 7.40137 13.1904 9.03418 13.1904 11.8486V18.1973C13.1904 18.7773 13.2549 19.3037 13.3945 19.7764L9.43066 23.4395V20.3672ZM26.0381 24.6104L22.5898 21.5166C22.1602 21.1406 21.9023 21.0117 21.3115 21.0117H17.7773C15.9834 21.0117 14.9092 20.0449 14.9092 18.1436L14.9199 11.9023C14.9199 10.0117 15.9834 9.02344 17.7773 9.02344H28.0039C29.7871 9.02344 30.8613 10.0117 30.8613 11.9023V18.1436C30.8613 20.0449 29.7871 21.0117 28.0039 21.0117H26.8652C26.4033 21.0117 26.0381 21.291 26.0381 21.8926V24.6104ZM22.9014 16.3389C23.3955 16.3389 23.6641 16.0596 23.6855 15.5225L23.8359 11.7734C23.8574 11.2148 23.4277 10.8174 22.8906 10.8174C22.3428 10.8174 21.9346 11.2041 21.9561 11.7627L22.0957 15.5225C22.1172 16.0488 22.3857 16.3389 22.9014 16.3389ZM22.8906 19.6045C23.4814 19.6045 23.9971 19.1318 23.9971 18.541C23.9971 17.9395 23.4922 17.4775 22.8906 17.4775C22.2891 17.4775 21.7842 17.9502 21.7842 18.541C21.7842 19.1318 22.2998 19.6045 22.8906 19.6045Z"})})},25654:(e,t,n)=>{n.d(t,{m:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("compass",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M18,4.361V3c0-1.657-1.343-3-3-3s-3,1.343-3,3v1.361C6.27,5.718,2,10.854,2,17c0,7.18,5.82,13,13,13s13-5.82,13-13 C28,10.854,23.73,5.718,18,4.361z M14,3c0-0.552,0.448-1,1-1s1,0.448,1,1v1.051C15.669,4.025,15.338,4,15,4s-0.669,0.025-1,0.051V3z M16,27.949V26h-2v1.949C8.724,27.474,4.526,23.276,4.051,18H6v-2H4.051C4.526,10.724,8.724,6.526,14,6.051V8h2V6.051 c5.276,0.476,9.474,4.673,9.949,9.949H24v2h1.949C25.474,23.276,21.276,27.474,16,27.949z M8,24l10-4l4-10l-10,4L8,24z M18.41,13.59 l-1.949,4.871L11.59,20.41l1.949-4.871L18.41,13.59z"})})},75553:(e,t,n)=>{n.d(t,{U:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("copy",{viewBox:"0 0 14 16",svg:(0,i.jsx)("path",{d:"M2.404 15.322h5.701c1.26 0 1.887-.662 1.887-1.927V12.38h1.154c1.254 0 1.91-.662 1.91-1.928V5.555c0-.774-.158-1.266-.626-1.74L9.512.837C9.066.387 8.545.21 7.865.21H5.463c-1.254 0-1.91.662-1.91 1.928v1.084H2.404c-1.254 0-1.91.668-1.91 1.933v8.239c0 1.265.656 1.927 1.91 1.927zm7.588-6.62c0-.792-.1-1.161-.592-1.665L6.225 3.814c-.452-.462-.844-.58-1.5-.591V2.215c0-.533.28-.832.843-.832h2.38v2.883c0 .726.386 1.113 1.107 1.113h2.83v4.998c0 .539-.276.832-.844.832H9.992V8.701zm-.79-4.29c-.206 0-.288-.088-.288-.287V1.594l2.771 2.818H9.201zM2.503 14.15c-.563 0-.844-.293-.844-.832V5.232c0-.539.281-.837.85-.837h1.91v3.187c0 .85.416 1.26 1.26 1.26h3.14v4.476c0 .54-.28.832-.843.832H2.504zM5.79 7.816c-.24 0-.346-.105-.346-.345V4.547l3.223 3.27H5.791z"})})},86215:(e,t,n)=>{n.d(t,{u:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("cornerResize",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{fillRule:"evenodd",strokeWidth:"1.5",d:"M 14 0C 12.8955 0 12 0.895447 12 2L 12 12L 2 12C 0.895508 12 0 12.8954 0 14C 0 15.1046 0.895508 16 2 16L 14 16C 15.1045 16 16 15.1046 16 14L 16 2C 16 0.895447 15.1045 0 14 0Z"})})},42773:(e,t,n)=>{n.d(t,{$:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("dateInterval",{viewBox:"0 0 20 20",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M4.345 10.359l1.832 1.36c.191.146.378.182.56.11.183-.074.274-.226.274-.459v-.847H8.96a.52.52 0 00.54-.533.513.513 0 00-.157-.376.521.521 0 00-.383-.158H7.01V8.63c0-.246-.093-.4-.28-.465-.186-.068-.371-.034-.553.103L4.345 9.64a.43.43 0 00-.185.362c0 .146.062.264.185.356zm11.31 0l-1.832 1.36c-.191.146-.378.182-.56.11-.183-.074-.274-.226-.274-.459v-.847H11.04a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.146.052-.272.157-.376a.521.521 0 01.383-.158h1.95V8.63c0-.246.093-.4.28-.465.186-.068.371-.034.553.103l1.832 1.374a.43.43 0 01.185.362.423.423 0 01-.185.356zM3.378 15.16c.183 0 .33-.051.445-.16a.553.553 0 00.17-.42V5.449a.592.592 0 00-.17-.438.601.601 0 00-.445-.17.592.592 0 00-.437.17.592.592 0 00-.171.438v9.132c0 .173.057.31.17.42s.26.16.438.16zm13.24 0c.183 0 .33-.051.445-.16a.552.552 0 00.17-.42V5.447a.592.592 0 00-.17-.437.6.6 0 00-.445-.17.592.592 0 00-.437.17.593.593 0 00-.171.437v9.132c0 .173.057.31.17.42.115.11.26.16.438.16z"})})})},90827:(e,t,n)=>{n.d(t,{N:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("deepnote",{viewBox:"0 0 92 92",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,i.jsx)("path",{fill:"#0265B4",fillRule:"evenodd",d:"M20 73h22.153l12.461-4.673-4.673-18.346-14.365 1.558L20 73z",clipRule:"evenodd"}),(0,i.jsx)("path",{fill:"#002868",fillRule:"evenodd",d:"M42.153 73s7.004-3.695 8.3-10.242c1.296-6.546-5.1-11.22-14.876-11.22 0-.172 8.582-12.114 8.582-12.114l20.84.605-4.622 24.407-8.628 6.74L42.153 73z",clipRule:"evenodd"}),(0,i.jsx)("path",{fill:"#3793EF",fillRule:"evenodd",d:"M20 44.615l17.307-25.614s.424.004 1.385 0c6.784-.03 34.268 1.315 34.268 25.467 0 27.57-30.807 28.53-30.807 28.53s12.865-2.463 12.865-14.687-11.619-13.696-19.095-13.696H20z",clipRule:"evenodd"})]})})},67677:(e,t,n)=>{n.d(t,{d:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("dinersclub",{viewBox:"0 0 34 24",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("rect",{x:".5",y:".5",width:"33",height:"23",rx:"2.5",fill:"#fff",stroke:"#D9D9D9"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.8384 19.3h2.5961c4.0524 0 7.2817-3.215 7.4084-7.1865v-.0631c-.0634-4.0345-3.356-7.3126-7.4084-7.2495h-2.9127c-3.8624.126-6.9018 3.4041-6.7751 7.3126 0 3.9084 3.1659 7.1234 7.0917 7.1865zm-5.8253-7.2496c0-3.278 2.7227-5.9887 6.0153-5.9887 3.2926 0 6.0153 2.7106 6.0153 5.9887s-2.7227 5.9888-6.0153 5.9888c-3.2926 0-6.0153-2.7107-6.0153-5.9888zm6.9651 4.0345v-8.006c2.2161.5674 3.6092 2.7738 3.0393 4.9801-.3799 1.513-1.5197 2.6477-3.0393 3.0259zm-4.8756-5.0431c-.5699 2.2064.7598 4.4758 2.976 5.0431v-8.006c-1.4563.3783-2.5961 1.513-2.976 2.9629z",fill:"#0079BE"})]})})},56666:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("dots",{viewBox:"0 0 13 3",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M3,1.5A1.5,1.5,0,1,1,1.5,0,1.5,1.5,0,0,1,3,1.5Z"}),(0,i.jsx)("path",{d:"M8,1.5A1.5,1.5,0,1,1,6.5,0,1.5,1.5,0,0,1,8,1.5Z"}),(0,i.jsx)("path",{d:"M13,1.5A1.5,1.5,0,1,1,11.5,0,1.5,1.5,0,0,1,13,1.5Z"})]})})},64330:(e,t,n)=>{n.d(t,{a:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("download",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8.215 15.126c3.862 0 7.061-3.192 7.061-7.062 0-3.862-3.199-7.061-7.068-7.061-3.862 0-7.055 3.2-7.055 7.061 0 3.87 3.2 7.062 7.062 7.062zm0-1.388a5.654 5.654 0 01-5.667-5.674 5.642 5.642 0 015.66-5.667 5.66 5.66 0 015.68 5.667 5.66 5.66 0 01-5.673 5.674zm0-9.174c-.342 0-.602.247-.602.588v3.234l.062 1.401-.622-.766-.766-.8a.557.557 0 00-.41-.177.54.54 0 00-.56.547c0 .164.054.3.163.41l2.256 2.283c.15.157.294.226.479.226.191 0 .335-.075.485-.226l2.256-2.283a.557.557 0 00.164-.41.539.539 0 00-.56-.547.523.523 0 00-.41.178l-.766.793-.622.779.054-1.408V5.152c0-.341-.253-.588-.601-.588z"})})},12217:(e,t,n)=>{n.d(t,{D:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("dragHandle",{viewBox:"0 0 10 10",svg:(0,i.jsx)("path",{d:"M3,2 C2.44771525,2 2,1.55228475 2,1 C2,0.44771525 2.44771525,0 3,0 C3.55228475,0 4,0.44771525 4,1 C4,1.55228475 3.55228475,2 3,2 Z M3,6 C2.44771525,6 2,5.55228475 2,5 C2,4.44771525 2.44771525,4 3,4 C3.55228475,4 4,4.44771525 4,5 C4,5.55228475 3.55228475,6 3,6 Z M3,10 C2.44771525,10 2,9.55228475 2,9 C2,8.44771525 2.44771525,8 3,8 C3.55228475,8 4,8.44771525 4,9 C4,9.55228475 3.55228475,10 3,10 Z M7,2 C6.44771525,2 6,1.55228475 6,1 C6,0.44771525 6.44771525,0 7,0 C7.55228475,0 8,0.44771525 8,1 C8,1.55228475 7.55228475,2 7,2 Z M7,6 C6.44771525,6 6,5.55228475 6,5 C6,4.44771525 6.44771525,4 7,4 C7.55228475,4 8,4.44771525 8,5 C8,5.55228475 7.55228475,6 7,6 Z M7,10 C6.44771525,10 6,9.55228475 6,9 C6,8.44771525 6.44771525,8 7,8 C7.55228475,8 8,8.44771525 8,9 C8,9.55228475 7.55228475,10 7,10 Z"})})},88437:(e,t,n)=>{n.d(t,{a:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("duplicate",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.83887 12.1523H4.00098V13.1846C4.00098 14.6406 4.75977 15.3994 6.24316 15.3994H13.1611C14.6377 15.3994 15.4033 14.6406 15.4033 13.1846V6.21191C15.4033 4.75586 14.6377 3.99707 13.1611 3.99707H11.999V2.96484C11.999 1.50879 11.2334 0.75 9.75684 0.75H2.83887C1.3623 0.75 0.59668 1.50195 0.59668 2.96484V9.93066C0.59668 11.3936 1.3623 12.1523 2.83887 12.1523ZM2.9209 10.8125C2.28516 10.8125 1.93652 10.4844 1.93652 9.82129V3.08105C1.93652 2.41797 2.28516 2.08301 2.9209 2.08301H9.68164C10.3105 2.08301 10.666 2.41797 10.666 3.08105V3.99707H6.24316C4.75977 3.99707 4.00098 4.75586 4.00098 6.21191V10.8125H2.9209ZM6.31836 14.0596C5.68262 14.0596 5.34082 13.7314 5.34082 13.0684V6.32812C5.34082 5.66504 5.68262 5.33691 6.31836 5.33691H13.0791C13.708 5.33691 14.0635 5.66504 14.0635 6.32812V13.0684C14.0635 13.7314 13.708 14.0596 13.0791 14.0596H6.31836Z"})})},75e3:(e,t,n)=>{n.d(t,{U:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("enter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M5.38965 14.1667C5.81812 14.1667 6.10156 13.8767 6.10156 13.468C6.10156 13.2571 6.01587 13.0989 5.89062 12.967L4.18994 11.3125L3.02979 10.3369L4.55908 10.4028H12.7922C14.4402 10.4028 15.1389 9.65796 15.1389 8.04297V4.13403C15.1389 2.48608 14.4402 1.78735 12.7922 1.78735H9.13379C8.70532 1.78735 8.4021 2.11035 8.4021 2.50586C8.4021 2.90137 8.69873 3.22437 9.13379 3.22437H12.7593C13.4316 3.22437 13.7151 3.50781 13.7151 4.17358V7.99683C13.7151 8.67578 13.425 8.95923 12.7593 8.95923H4.55908L3.02979 9.03174L4.18994 8.04956L5.89062 6.39502C6.01587 6.26978 6.10156 6.11157 6.10156 5.89404C6.10156 5.48535 5.81812 5.19531 5.38965 5.19531C5.21167 5.19531 5.01392 5.27441 4.8689 5.41943L1.08521 9.1438C0.933594 9.28882 0.854492 9.48657 0.854492 9.68433C0.854492 9.87549 0.933594 10.0732 1.08521 10.2183L4.8689 13.9492C5.01392 14.0876 5.21167 14.1667 5.38965 14.1667Z"})})},56185:(e,t,n)=>{n.d(t,{F:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("excalidraw",{viewBox:"0 0 32 32",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"m14.2933 1.41174c-.8308.66246-2.1108 1.78526-3.1214 2.75088l-.7972.75228.146.98807c.0786.53895.2246 1.59439.3144 2.33544.101.74105.2021 1.43719.2358 1.53825.0449.13473 0 .2021-.1235.2021-.2134 0-.2246-.05614.3593 1.79654.2133.7073.4154 1.3586.4379 1.4259.0224.0786.1122.1123.2133.0786.1011-.0449.1572-.1347.1235-.2133-.0337-.0898.0225-.1797.1123-.2133.1235-.045.1123-.1348-.0786-.4604-.3032-.5053-1.0779-4.81685-1.1228-6.20913-.0337-.98807-.0337-.9993.3817-1.5607.4043-.55018 1.3362-1.38105 2.7734-2.43649.4042-.30316.8084-.64.9207-.75228.1684-.20211.247-.14597 1.6617 1.35859.8197.86456 1.7292 1.75158 2.0211 1.97614l.5389.40422-.4154.87579c-.2246.47157-1.134 2.29052-2.0323 4.01966-1.8751 3.6379-1.4933 3.2898-3.6716 3.3235l-1.4147.0112-.4716.539c-.494.5726-.5614.7859-.3256 1.1452.0898.1235.1572.3257.1572.4492 0 .2021.0786.2358.5277.2582.2807.0112.539.0449.5726.0786.0337.0337.0786.7298.1123 1.5495l.0449 1.4821-.7522 1.6168c-1.2464 2.6948-1.74039 3.9299-1.74039 4.3341 0 .2133.04491.3929.08982.3929.11227 0 .11227-.0112 4.68207-9.5438 2.1221-4.4239 4.132-8.5895 4.4688-9.27441.3369-.68491.64-1.31369.6625-1.40351.0224-.10105-.7523-.87579-1.9874-1.96491-1.1116-.98807-2.0884-1.88632-2.1782-1.98737-.2583-.314389-.64-.213336-1.325.33684zm.3818 12.91226c-.5165.9993-.539 1.0106-1.9537 1.0779-1.2463.0674-1.2688.0562-1.2688-.1796 0-.1348-.0449-.3144-.101-.4042-.0674-.1011-.0225-.2807.1347-.5278l.247-.3817h1.1228c.6176-.0112 1.325-.0562 1.572-.1011s.4603-.0673.4828-.0561c.0224.0112-.0898.2695-.2358.5726zm-.9432 1.7965c-.0898.2358-.3256.7298-.5165 1.1004-.3143.6287-.348.6512-.4266.393-.0449-.1572-.0786-.6176-.0898-1.033-.0113-.8197-.0337-.8084.9094-.8646l.3032-.0112z"}),(0,i.jsx)("path",{d:"m14.6302 4.08401c-.2021.14597-.2583.29193-.2583.66246 0 .43789.0337.50526.3369.62877s.3817.11228.7298-.12351c.4604-.31439.4716-.39298.1348-.89824-.292-.4379-.5839-.51649-.9432-.26948zm.64.40421c.1796.31439.0674.55018-.2695.55018-.3031 0-.4379-.30316-.2695-.60632.1348-.24701.393-.22456.539.05614z"}),(0,i.jsx)("path",{d:"m21.6702 6.61034c0 .05614-.0674.11228-.146.11228-.0674 0-.2582.31439-.4042.69614-.4491 1.16772-4.9404 10.04914-4.9516 9.76844 0-.146-.0673-.247-.1796-.247-.1572 0-.1797.0898-.1123.5277.0674.5053.0224.6175-1.5719 3.7165-.8983 1.7628-1.8639 3.6042-2.1446 4.0982-.2919.5165-.5165 1.0779-.5389 1.3137-.0337.4042.0112.4604.988 1.3025.5614.494 1.28 1.1115 1.5944 1.3922 1.4147 1.2913 2.0772 1.8078 2.2569 1.7741.2694-.0449 4.435-4.4127 4.4463-4.6597 0-.1122-.2021-1.8189-.4492-3.7951-.4266-3.3684-.8308-7.3094-.7859-7.6912.0337-.2358-.1348-1.4259-.2583-1.9424-.101-.4043-.0561-.5727.7523-2.4141.4716-1.0891 1.0891-2.42524 1.3586-2.96419.2583-.53894.4828-1.01052.4828-1.04421 0-.03368-.0786-.05614-.1684-.05614s-.1684.04492-.1684.11228zm-2.5825 8.38736c.1235.786.3705 2.6723.5502 4.1881.3481 2.7845.7523 5.8723.8646 6.6582.0673.393.0224.4716-.7074 1.28-1.2688 1.426-2.6162 2.8295-3.0765 3.1888l-.4267.3368-2.1894-2.0435c-2.0211-1.8638-2.1895-2.0547-2.066-2.2793.0674-.1235.64-1.1677 1.2688-2.3129.6287-1.1453 1.4596-2.6723 1.8414-3.3909.3929-.7299.7522-1.3586.8196-1.3923.0786-.0449.1011 1.0891.0786 3.5032-.0449 3.6042-.0337 3.6154.3256 3.5368.0449 0 .0786-1.819.0786-4.0309v-4.0196l1.179-2.3579c.6512-1.3025 1.1901-2.3467 1.2126-2.3355.0225.0113.1347.6737.247 1.4709z"})]})})},37240:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("expand",{viewBox:"-1 -1 9 11",svg:(0,i.jsx)("path",{id:"path0_stroke",d:"M 3.5 0L 3.98809 -0.569442L 3.5 -0.987808L 3.01191 -0.569442L 3.5 0ZM 3.5 9L 3.01191 9.56944L 3.5 9.98781L 3.98809 9.56944L 3.5 9ZM 0.488094 3.56944L 3.98809 0.569442L 3.01191 -0.569442L -0.488094 2.43056L 0.488094 3.56944ZM 3.01191 0.569442L 6.51191 3.56944L 7.48809 2.43056L 3.98809 -0.569442L 3.01191 0.569442ZM -0.488094 6.56944L 3.01191 9.56944L 3.98809 8.43056L 0.488094 5.43056L -0.488094 6.56944ZM 3.98809 9.56944L 7.48809 6.56944L 6.51191 5.43056L 3.01191 8.43056L 3.98809 9.56944Z"})})},13797:(e,t,n)=>{n.d(t,{F:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("factoryBlockSettings",{viewBox:"0 0 24 24",svg:(0,i.jsx)("path",{d:"M12,8c-2.209,0-4,1.791-4,4s1.791,4,4,4s4-1.791,4-4S14.209,8,12,8z M12,14c-1.104,0-2-0.896-2-2s0.896-2,2-2s2,0.896,2,2 S13.104,14,12,14z M24,15V9h-3.523c-0.105-0.299-0.227-0.589-0.361-0.872l2.491-2.492l-4.243-4.243l-2.491,2.491 C15.59,3.75,15.299,3.629,15,3.523V0H9v3.523C8.701,3.629,8.411,3.75,8.128,3.885L5.636,1.394L1.394,5.636l2.491,2.492 C3.75,8.411,3.629,8.701,3.523,9H0v6h3.523c0.106,0.299,0.227,0.589,0.362,0.872l-2.492,2.491l4.243,4.243l2.492-2.491 C8.411,20.25,8.701,20.371,9,20.477V24h6v-3.523c0.299-0.105,0.59-0.227,0.872-0.361l2.491,2.491l4.243-4.243l-2.491-2.491 c0.135-0.283,0.256-0.573,0.361-0.872H24z M19.778,18.363l-1.415,1.415l-2.077-2.077c-0.896,0.502-2.271,1.049-3.286,1.363V22h-2 v-2.936c-1.016-0.314-2.391-0.861-3.286-1.363l-2.078,2.077l-1.415-1.415L6.3,16.285C5.781,15.359,5.234,13.953,4.936,13H2v-2h2.936 C5.234,10.047,5.781,8.641,6.3,7.714L4.222,5.636l1.415-1.415l2.078,2.077C8.609,5.797,9.984,5.25,11,4.936V2h2v2.936 c1.016,0.314,2.391,0.861,3.286,1.363l2.077-2.077l1.415,1.415L17.7,7.714c0.519,0.926,1.065,2.333,1.364,3.286H22v2h-2.936 c-0.299,0.953-0.846,2.359-1.364,3.285L19.778,18.363z"})})},71441:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("figma",{viewBox:"0 0 36 55",svg:(0,i.jsx)("path",{d:"M19.5,27.5 C19.5,23.08142 23.08142,19.5 27.5,19.5 C31.9186,19.5 35.5,23.08142 35.5,27.5 C35.5,31.9186 31.9186,35.5 27.5,35.5 C23.08142,35.5 19.5,31.9186 19.5,27.5 Z M0.5,46.5 C0.5,42.08142 4.08142,38.5 8.5,38.5 L16.5,38.5 L16.5,46.5 C16.5,50.9186 12.9186,54.5 8.5,54.5 C4.08142,54.5 0.5,50.9186 0.5,46.5 Z M19.5,16.5 L19.5,0.5 L27.5,0.5 C31.9186,0.5 35.5,4.08142 35.5,8.5 C35.5,12.9186 31.9186,16.5 27.5,16.5 L19.5,16.5 Z M8.5,16.5 C4.08142,16.5 0.5,12.9186 0.5,8.5 C0.5,4.08142 4.08142,0.5 8.5,0.5 L16.5,0.5 L16.5,16.5 L8.5,16.5 Z M8.5,35.5 C4.08142,35.5 0.5,31.9186 0.5,27.5 C0.5,23.08142 4.08142,19.5 8.5,19.5 L16.5,19.5 L16.5,35.5 L8.5,35.5 Z"})})},50066:(e,t,n)=>{n.d(t,{R:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("file",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.35645 15.4678H11.6367C13.0996 15.4678 13.8584 14.6953 13.8584 13.2256V7.02539C13.8584 6.0752 13.7354 5.6377 13.1406 5.03613L9.55176 1.38574C8.97754 0.804688 8.50586 0.667969 7.65137 0.667969H4.35645C2.89355 0.667969 2.13477 1.44043 2.13477 2.91016V13.2256C2.13477 14.7021 2.89355 15.4678 4.35645 15.4678ZM4.46582 14.1279C3.80273 14.1279 3.47461 13.7793 3.47461 13.1436V2.99219C3.47461 2.36328 3.80273 2.00781 4.46582 2.00781H7.37793V5.75391C7.37793 6.73145 7.86328 7.20312 8.83398 7.20312H12.5186V13.1436C12.5186 13.7793 12.1836 14.1279 11.5205 14.1279H4.46582ZM8.95703 6.02734C8.67676 6.02734 8.56055 5.9043 8.56055 5.62402V2.19238L12.334 6.02734H8.95703ZM8.59473 12.7266V10.6279L8.54004 9.56152L9.06641 10.1152L9.59277 10.6484C9.68848 10.7646 9.8457 10.833 9.98926 10.833C10.2969 10.833 10.5293 10.6143 10.5293 10.3066C10.5293 10.1357 10.4678 10.0127 10.3379 9.90332L8.45117 8.16699C8.29395 8.02344 8.16406 7.96191 7.99316 7.96191C7.8291 7.96191 7.69922 8.02344 7.54199 8.16699L5.65527 9.90332C5.52539 10.0127 5.46387 10.1357 5.46387 10.3066C5.46387 10.6143 5.68945 10.833 6.00391 10.833C6.14746 10.833 6.29785 10.7646 6.40039 10.6484L6.92676 10.1152L7.45312 9.56152L7.39844 10.6279V12.7266C7.39844 13.0547 7.67188 13.3008 7.99316 13.3008C8.32129 13.3008 8.59473 13.0547 8.59473 12.7266Z"})})},60997:(e,t,n)=>{n.d(t,{B:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("framer",{viewBox:"0 0 32 32",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"m9 6h14v7h-7zm0 7h7l7 7h-14zm0 7h7v7z"})})})},80750:(e,t,n)=>{n.d(t,{l:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("genericError",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{d:"M16.0242 29.0485c7.1251 0 13.0243-5.8992 13.0243-13.0243C29.0485 8.91198 23.1365 3 16.0115 3 8.89922 3 3 8.91198 3 16.0242c0 7.1251 5.91198 13.0243 13.0242 13.0243zm-.0127-11.1089c-.6768 0-1.0471-.3959-1.0726-1.0726l-.1788-6.3078c-.0255-.70232.5108-1.20031 1.2386-1.20031.7151 0 1.2769.51076 1.2514 1.21301l-.1916 6.2951c-.0255.6895-.3958 1.0726-1.047 1.0726zm0 4.6989c-.7406 0-1.4301-.5874-1.4301-1.379 0-.7917.6767-1.3791 1.4301-1.3791.7533 0 1.4301.5746 1.4301 1.3791 0 .8044-.6895 1.379-1.4301 1.379z"})})},84869:(e,t,n)=>{n.d(t,{c:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("googleDrive",{viewBox:"0 0 512 512",svg:(0,i.jsxs)("g",{children:[" ",(0,i.jsx)("path",{d:"M175.5,44.9c2.6,0,4.5,0,6.5,0c50.5,0,101,0.1,151.5-0.2c5.5,0,8.5,2,11,6.4c10.7,19,21.5,38,32.3,56.9   c13.2,23.2,26.5,46.4,39.8,69.5c14.8,25.9,29.8,51.6,44.6,77.5c11.9,20.7,23.6,41.6,35.4,62.4c1.5,2.6,5,5.2,3.5,7.8  c-0.8,1.4-5.6,0.6-8.5,0.6c-28.8-0.3-57.6-0.4-86.4-1.2c-19.7-0.6-39.3-0.3-58.9-0.8c-5.6-0.1-11.3-0.6-16.9-0.7   c-2.3,0-3.1-1.2-4-2.9c-9.7-17.9-19.4-35.7-29.2-53.6c-10.4-19.1-20.8-38.2-31.3-57.4c-11.5-21.2-23-42.4-34.5-63.5   c-11.6-21.3-23.3-42.6-34.9-64C188.7,69.7,182.3,57.6,175.5,44.9z"})," ",(0,i.jsx)("path",{d:"M97.1,474c1.6-6.5,5.5-10.8,8.3-15.6c14.5-25.3,29.3-50.3,43.9-75.5c8.6-14.9,17.1-29.8,25.5-44.8   c1.4-2.5,3.1-3.2,5.6-3.2c27.6,0.4,55.3,0.3,82.9,1.3c16.7,0.6,33.3,0.4,49.9,0.8c20.1,0.4,40.3,0.2,60.4,1.2  c13.8,0.6,27.6,0.4,41.4,0.7c29.3,0.5,58.6,0.8,87.9,1.2c1.4,0,3.2-0.7,4,1.1c0.5,1.3-0.4,2.4-1.2,3.6   c-10.4,16.3-20.8,32.7-31.2,49.1c-10.6,16.7-21.1,33.5-31.6,50.2c-5.3,8.4-10.6,16.7-15.6,25.2c-2.3,3.9-4.9,6.2-9.8,5.7   c-5.4-0.6-11-0.7-16.4-0.7c-99.3-0.1-198.6-0.2-297.9-0.3C101.3,474,99.4,474,97.1,474z"})," ",(0,i.jsx)("path",{d:"M9.8,326.3c1.1-5.3,4.5-9.5,7.1-14c14.3-25.7,28.9-51.2,43.3-76.8c9.7-17.1,19.5-34.3,29.2-51.4   c12.9-22.8,25.7-45.7,38.6-68.5c10.7-18.9,21.6-37.8,32.4-56.7c4.7-8.2,5.1-8.4,9.3-0.6c8.3,15.6,16.7,31.1,24.8,46.8  c6.1,11.9,12.6,23.7,18.9,35.5c7.2,13.6,14.5,27.2,21.7,40.7c2.2,4.2,4.3,8.6,6.8,12.7c1.3,2.1,0.9,3.4-0.3,5.4   c-16.2,27.3-32.2,54.7-48.4,81.9c-14,23.6-28.3,47-42.3,70.6c-16.4,27.5-32.6,55.1-49,82.6c-6.6,11.2-13.3,22.4-20,33.6   c-0.6,1.1-0.8,2.8-2.5,2.7c-1.6-0.1-2-1.7-2.6-2.8c-3.7-7.6-7.3-15.2-10.9-22.8c-6.9-14.7-13.9-29.3-20.9-44   c-9-18.8-18-37.5-27-56.3c-2.3-4.8-4.5-9.6-6.8-14.3C10.6,329.2,9.7,328,9.8,326.3z"})," "]})})},31843:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("googlePay",{viewBox:"0 0 34 24",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("rect",{x:".5",y:".5",width:"33",height:"23",rx:"2.5",fill:"#fff",stroke:"#D9D9D9"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.0578 15.528v-2.9347h1.5147c.6206 0 1.1445-.2079 1.5715-.6181l.1025-.104c.7801-.8492.7289-2.172-.1025-2.9577-.4156-.416-.985-.6413-1.5715-.6297h-2.4314v7.2442h.9167zm.0001-3.8244V9.1734h1.5377c.3303 0 .6435.127.877.3581.4955.4853.5069 1.2941.0285 1.7966a1.1899 1.1899 0 01-.9055.3755h-1.5377zm7.4649-.7451c-.3929-.364-.9281-.5488-1.6057-.5488-.8712 0-1.526.3235-1.9588.9647l.8086.5141c.2961-.439.7004-.6585 1.2128-.6585.3246 0 .6378.1213.8826.3408.2392.208.3758.5084.3758.8261v.2137c-.353-.1964-.7972-.3004-1.3438-.3004-.6377 0-1.1502.1502-1.5317.4564-.3815.3062-.5751.7106-.5751 1.2247a1.5418 1.5418 0 00.5409 1.2132c.3588.3235.8143.4852 1.3495.4852.6321 0 1.1332-.283 1.5147-.8492h.0398v.6875h.8769v-3.056c0-.6412-.1936-1.1496-.5865-1.5135zm-2.4881 3.6567c-.188-.1386-.3019-.3639-.3019-.6065 0-.2715.1253-.4968.3702-.6759.2506-.1791.5638-.2715.934-.2715.5125-.0058.9112.1097 1.1959.3408 0 .3928-.1537.7337-.4556 1.0225a1.4463 1.4463 0 01-1.0308.4333c-.2562.0057-.5068-.0809-.7118-.2427zm5.0448 3.0906l3.0634-7.1344h-.9965L26.7286 14.13h-.0171l-1.452-3.5586h-.9964l2.01 4.6388-1.1388 2.4956h.9452z",fill:"#3C4043"}),(0,i.jsx)("path",{d:"M12.8929 11.9579c0-.2831-.0228-.5661-.0683-.8434H8.9583v1.6002h2.215c-.0911.5141-.3872.9763-.82 1.2651v1.0398h1.3211c.7744-.7221 1.2185-1.7908 1.2185-3.0617z",fill:"#4285F4"}),(0,i.jsx)("path",{d:"M8.9585 16.0248c1.1046 0 2.0384-.3697 2.716-1.0052l-1.321-1.0398c-.3701.2542-.8427.3986-1.395.3986-1.0705 0-1.9759-.7336-2.3004-1.7157H5.297v1.0745c.6947 1.4038 2.1126 2.2876 3.6614 2.2876z",fill:"#34A853"}),(0,i.jsx)("path",{d:"M6.6582 12.6627c-.1708-.5141-.1708-1.0745 0-1.5944V9.9996H5.2971a4.177 4.177 0 000 3.7318l1.3611-1.0687z",fill:"#FBBC04"}),(0,i.jsx)("path",{d:"M8.9585 9.3525c.5865-.0115 1.1502.2138 1.5715.624l1.173-1.1901c-.7459-.7048-1.7253-1.0918-2.7445-1.0803-1.5488 0-2.9667.8897-3.6613 2.2934L6.658 11.074c.3245-.9878 1.2299-1.7215 2.3004-1.7215z",fill:"#EA4335"})]})})},59341:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("hand",{viewBox:"0 0 28 28",svg:(0,i.jsx)("path",{d:"M13.6572 23.1553C16.918 23.1553 19.1943 21.415 20.416 17.9873L21.9893 13.584C22.1035 13.2588 22.1562 12.9512 22.1562 12.6611C22.1562 11.6592 21.4092 10.9209 20.416 10.9209C19.7832 10.9209 19.2119 11.2812 18.9131 11.9668L18.4385 13.1182C18.4209 13.1533 18.4033 13.1709 18.3682 13.1709C18.3242 13.1709 18.3066 13.1445 18.3066 13.1006V6.35059C18.3066 5.23438 17.5771 4.51367 16.4961 4.51367C16.1621 4.51367 15.8545 4.61914 15.6172 4.82129C15.4414 3.93359 14.8174 3.38867 13.9121 3.38867C13.0332 3.38867 12.3916 3.94238 12.207 4.80371C11.9873 4.61035 11.7061 4.51367 11.4072 4.51367C10.3965 4.51367 9.70215 5.2168 9.70215 6.2627V7.08008C9.48242 6.86914 9.16602 6.75488 8.83203 6.75488C7.82129 6.75488 7.10938 7.51074 7.10938 8.58301V16.2822C7.10938 20.5361 9.72852 23.1553 13.6572 23.1553ZM13.6133 21.6523C10.4668 21.6523 8.54199 19.6484 8.54199 16.124V8.75C8.54199 8.41602 8.75293 8.1875 9.06934 8.1875C9.39453 8.1875 9.62305 8.41602 9.62305 8.75V13.2764C9.62305 13.6543 9.93066 13.918 10.2822 13.918C10.6426 13.918 10.9502 13.6543 10.9502 13.2764V6.48242C10.9502 6.14844 11.1611 5.91992 11.4863 5.91992C11.8027 5.91992 12.04 6.14844 12.04 6.48242V12.8105C12.04 13.1885 12.3389 13.4609 12.6904 13.4609C13.0508 13.4609 13.3584 13.1885 13.3584 12.8105V5.36621C13.3584 5.04102 13.5869 4.79492 13.9033 4.79492C14.2197 4.79492 14.4482 5.04102 14.4482 5.36621V12.7051C14.4482 13.0654 14.7383 13.3467 15.0986 13.3467C15.4678 13.3467 15.7666 13.0654 15.7666 12.7051V6.48242C15.7666 6.14844 15.9863 5.91992 16.3115 5.91992C16.6279 5.91992 16.8564 6.14844 16.8564 6.48242V15.2451C16.8564 15.7549 17.1816 16.0449 17.6035 16.0361C17.9551 16.0361 18.2715 15.8779 18.4824 15.4121L19.748 12.5732C19.8975 12.2305 20.1963 12.125 20.4688 12.2217C20.7676 12.3359 20.8643 12.626 20.7236 13.0039L19.0889 17.5127C17.999 20.501 16.1621 21.6523 13.6133 21.6523Z"})})},84169:(e,t,n)=>{n.d(t,{m:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("help",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM7.84277 9.4248C8.21875 9.4248 8.45801 9.21289 8.47852 8.93262C8.47852 8.90527 8.47852 8.87109 8.47852 8.85059C8.49902 8.49512 8.74512 8.25586 9.18945 7.96875C9.85938 7.52441 10.2969 7.13477 10.2969 6.3418C10.2969 5.2002 9.27148 4.55078 8.06152 4.55078C6.89258 4.55078 6.09277 5.08398 5.88086 5.72656C5.83984 5.84277 5.81934 5.95898 5.81934 6.08203C5.81934 6.41016 6.0791 6.61523 6.35254 6.61523C6.60547 6.61523 6.76953 6.5127 6.90625 6.32812L7.01562 6.19141C7.24121 5.81543 7.56934 5.61719 7.97949 5.61719C8.5332 5.61719 8.90918 5.94531 8.90918 6.41016C8.90918 6.84082 8.62207 7.05273 8.04102 7.45605C7.55566 7.79102 7.2002 8.14648 7.2002 8.76855V8.84375C7.2002 9.22656 7.43262 9.4248 7.84277 9.4248ZM7.83594 11.5234C8.27344 11.5234 8.63574 11.2021 8.63574 10.7715C8.63574 10.3408 8.27344 10.0264 7.83594 10.0264C7.3916 10.0264 7.03613 10.3477 7.03613 10.7715C7.03613 11.2021 7.39844 11.5234 7.83594 11.5234Z"})})},74155:(e,t,n)=>{n.d(t,{u:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("helpButtonGuide",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 2.77344C7.39844 2.0625 6.05859 1.42676 4.48633 1.42676C2.3877 1.42676 0.692383 2.51367 0.241211 3.5459V13.8066C0.241211 14.4766 0.678711 14.7363 1.16406 14.7363C1.52637 14.7363 1.73145 14.627 1.96387 14.4561C2.42871 14.0801 3.1875 13.6426 4.48633 13.6426C5.79199 13.6426 6.68066 14.0801 7.07715 14.415C7.2959 14.5791 7.54883 14.7363 8 14.7363C8.45117 14.7363 8.69727 14.5654 8.92285 14.415C9.34668 14.1006 10.208 13.6426 11.5137 13.6426C12.8125 13.6426 13.585 14.0869 14.0361 14.4561C14.2686 14.627 14.4736 14.7363 14.8359 14.7363C15.3213 14.7363 15.7588 14.4766 15.7588 13.8066V3.5459C15.3076 2.51367 13.6191 1.42676 11.5137 1.42676C9.94141 1.42676 8.6084 2.0625 8 2.77344ZM1.72461 4.01758C1.90918 3.56641 2.9209 2.80078 4.48633 2.80078C6.05176 2.80078 7.09766 3.57324 7.26172 4.01758V13.0342C6.55762 12.5283 5.55273 12.2549 4.48633 12.2549C3.41309 12.2549 2.41504 12.5283 1.72461 13.0547V4.01758ZM14.2754 4.01758V13.0547C13.585 12.5283 12.5869 12.2549 11.5137 12.2549C10.4473 12.2549 9.44238 12.5283 8.73828 13.0342V4.01758C8.90234 3.57324 9.94824 2.80078 11.5137 2.80078C13.0791 2.80078 14.0908 3.56641 14.2754 4.01758Z"})})},64258:(e,t,n)=>{n.d(t,{p:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("hex",{viewBox:"0 0 92 92",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.8 34v8.368h-2.4V34H15v24h8.4V46h2.4v12h8.4V34h-8.4Zm10.7995 24h19.2v-9.6h-8.4v6h-2.4V46h10.8V34h-19.2v24Zm8.4-15.6v-4.8h2.4v4.8h-2.4Zm24.0007 0V34h8.4v6l-3.6 4.2 3.6 4.2V58h-8.4V45.968h-2.4V58h-8.4v-9.6l3.6-4.2-3.6-4.2v-6h8.4v8.4h2.4Z",fill:"#473982"})]})})},37250:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(67294),i=n(45238),r=n(85893);const a=(0,i.I)("imageError",{viewBox:"0 0 32 32",svg:(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)("path",{d:"M6.39515 31.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33305.6662-.69079.6662z"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 17.5539V3h26v26H12.6862c.4113-.6095.7364-1.282.9578-2H28v-4H13.7749c-.1687-.7106-.4373-1.3825-.7902-2H28V5H6v12.1798c-.69548.0352-1.36626.164-2 .3741zM11.3329 19c-.6875-.5905-1.48192-1.0601-2.35027-1.3757L13 12l2 1 5-5 6 11H11.3329zM12 9c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm3.395 6.434l-1.76-.881L11.887 17h10.744l-3.107-5.695-4.129 4.129z"})]})})},44495:(e,t,n)=>{n.d(t,{D:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("info",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.97266 14.9453C11.7871 14.9453 14.9453 11.7803 14.9453 7.97266C14.9453 4.1582 11.7803 1 7.96582 1C4.1582 1 1 4.1582 1 7.97266C1 11.7803 4.16504 14.9453 7.97266 14.9453ZM7.97266 13.7832C4.74609 13.7832 2.16895 11.1992 2.16895 7.97266C2.16895 4.74609 4.73926 2.16211 7.96582 2.16211C11.1924 2.16211 13.7764 4.74609 13.7832 7.97266C13.79 11.1992 11.1992 13.7832 7.97266 13.7832ZM7.91113 5.53906C8.41016 5.53906 8.7998 5.14258 8.7998 4.64355C8.7998 4.14453 8.41016 3.74805 7.91113 3.74805C7.41895 3.74805 7.02246 4.14453 7.02246 4.64355C7.02246 5.14258 7.41895 5.53906 7.91113 5.53906ZM6.77637 11.7324H9.55859C9.83887 11.7324 10.0576 11.5273 10.0576 11.2471C10.0576 10.9805 9.83887 10.7686 9.55859 10.7686H8.71094V7.28906C8.71094 6.91992 8.52637 6.67383 8.17773 6.67383H6.89258C6.6123 6.67383 6.39355 6.88574 6.39355 7.15234C6.39355 7.43262 6.6123 7.6377 6.89258 7.6377H7.62402V10.7686H6.77637C6.49609 10.7686 6.27734 10.9805 6.27734 11.2471C6.27734 11.5273 6.49609 11.7324 6.77637 11.7324Z"})})},48964:(e,t,n)=>{n.d(t,{v:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("invision",{viewBox:"0 0 215 182",svg:(0,i.jsxs)("g",{stroke:"none",strokeWidth:"1",children:[" ",(0,i.jsxs)("g",{transform:"translate(0.000000, -222.000000)",children:[" ",(0,i.jsxs)("g",{children:[" ",(0,i.jsx)("path",{d:"M98.9196618,401.249534 L67.23738,401.249534 C69.0283748,394.069758 70.787323,387.019973 72.4415558,380.387695 C68.8636285,384.425558 65.4170469,389.032134 61.2582199,392.866884 C50.6503674,402.647395 38.1012175,405.941417 24.0797327,402.23079 C13.9819165,399.55829 7.92421985,391.917675 6.61663119,381.562133 C5.46837247,372.464529 7.41824578,363.782628 9.57890401,355.080416 C13.7219334,338.391847 17.8017725,321.687933 21.9028255,304.989434 C22.0454551,304.409889 22.1339216,303.817254 22.2995706,302.96283 L-0.0003,302.96283 C2.30975824,294.403698 4.53721769,286.151943 6.78995327,277.806756 L60.5229552,277.806756 C60.3491817,278.642223 60.2273147,279.357627 60.0512844,280.059943 C53.0231647,308.023022 45.9535198,335.97572 39.0057421,363.95911 C38.1427426,367.435481 37.6331576,371.059899 37.479244,374.638277 C37.2535643,379.877659 40.2013936,382.783512 45.4935844,382.824134 C53.5440336,382.885068 60.4588621,379.769784 66.3955944,374.554776 C72.743064,368.979131 77.1564578,362.201967 79.1663619,353.808936 C83.0828089,337.452117 87.2971531,321.167064 91.379249,304.850416 C91.5232327,304.276286 91.5715282,303.678686 91.6933952,302.909569 L69.2513464,302.909569 C69.6155936,301.479211 69.9089773,300.269116 70.2316994,299.067145 C71.9843286,292.540938 73.758623,286.020597 75.4882328,279.488522 C75.7789084,278.389461 76.0555918,277.645621 77.5008451,277.651037 C92.8448135,277.709714 108.18833,277.692562 123.531847,277.702492 C123.75166,277.702492 123.97102,277.781931 124.411096,277.867238 C122.458966,286.803255 120.511801,295.717606 118.565087,304.631958 C118.656261,304.671226 118.747887,304.710043 118.838611,304.749311 C120.277996,302.605804 121.639297,300.404524 123.17076,298.328721 C129.752485,289.408051 137.659853,281.997178 148.043831,277.728671 C168.022811,269.515732 188.005402,280.685076 192.142563,302.283534 C193.975534,311.851454 193.064691,321.305631 190.553778,330.628914 C187.175803,343.16994 183.622249,355.664024 180.318748,368.224458 C179.661569,370.722733 179.467484,373.448493 179.624106,376.035235 C179.988804,382.073072 185.463796,384.737899 190.442292,381.268749 C192.360119,379.932273 194.120421,378.060937 195.308399,376.052387 C197.438816,372.450086 199.08989,368.563429 200.922861,364.787355 C201.278532,364.054347 201.552056,363.281168 201.937066,362.346854 C206.06836,363.936993 210.106223,365.491476 214.381049,367.137584 C210.178891,380.337594 205.268551,393.058261 192.248181,399.864312 C181.021966,405.732889 169.389528,405.395272 158.535233,398.5987 C151.013326,393.889214 148.484358,386.186312 148.027131,377.697592 C147.620005,370.133709 149.656088,362.968376 151.693976,355.800786 C154.30148,346.629159 157.031754,337.485517 159.315182,328.232646 C160.272516,324.353211 160.657977,320.20973 160.534756,316.210233 C160.26394,307.425422 153.949871,301.479211 145.147908,301.094201 C135.701404,300.681207 128.636273,304.704626 123.601357,312.562796 C119.514296,318.940958 117.721496,326.162711 115.917863,333.384916 C110.367494,355.603993 104.804488,377.819911 99.2455434,400.036731 C99.157077,400.390597 99.0564238,400.741303 98.9196618,401.249534 Z M28.7006165,241.023028 C28.6658618,230.356047 37.1446512,221.982425 47.9637399,222.000028 C58.6717942,222.017631 67.1365914,230.335285 67.169992,240.873176 C67.2033927,251.467488 58.5991253,259.984192 47.8874602,259.958916 C37.2349231,259.934091 28.7349198,251.545573 28.7006165,241.023028 Z"})," "]})," "]})," "]})})},27714:(e,t,n)=>{n.d(t,{N:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("link",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.69922 10.8945L8.73828 9.84863C7.91797 9.77344 7.34375 9.51367 6.91992 9.08984C5.76465 7.93457 5.76465 6.29395 6.91309 5.14551L9.18262 2.87598C10.3379 1.7207 11.9717 1.7207 13.127 2.87598C14.2891 4.04492 14.2822 5.67188 13.1338 6.82031L11.958 7.99609C12.1768 8.49512 12.2451 9.10352 12.1289 9.62988L14.0908 7.6748C15.7725 6 15.7793 3.62109 14.084 1.92578C12.3887 0.223633 10.0098 0.237305 8.33496 1.91211L5.95605 4.29785C4.28125 5.97266 4.26758 8.35156 5.96289 10.0469C6.36621 10.4434 6.90625 10.7441 7.69922 10.8945ZM8.30078 5.13184L7.26855 6.17773C8.08203 6.25293 8.66309 6.51953 9.08008 6.93652C10.2422 8.09863 10.2422 9.73242 9.08691 10.8809L6.81738 13.1504C5.66211 14.3057 4.03516 14.3057 2.87305 13.1504C1.71094 11.9883 1.71777 10.3545 2.87305 9.20605L4.04199 8.03027C3.83008 7.53125 3.75488 6.92969 3.87109 6.39648L1.91602 8.35156C0.234375 10.0264 0.227539 12.4121 1.92285 14.1074C3.61816 15.8027 5.99707 15.7891 7.67188 14.1143L10.0439 11.7354C11.7256 10.0537 11.7324 7.6748 10.0371 5.98633C9.64062 5.58301 9.10059 5.28223 8.30078 5.13184Z"})})},90199:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("locked",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.79395 14.7227H11.1992C12.252 14.7227 12.7783 14.1963 12.7783 13.0479V8.20801C12.7783 7.19629 12.3682 6.66992 11.541 6.56055V4.96094C11.541 2.36328 9.81152 1.1123 7.99316 1.1123C6.18164 1.1123 4.45215 2.36328 4.45215 4.96094V6.56055C3.625 6.66992 3.21484 7.19629 3.21484 8.20801V13.0479C3.21484 14.1963 3.73438 14.7227 4.79395 14.7227ZM5.75098 4.83105C5.75098 3.22461 6.76953 2.35645 7.99316 2.35645C9.2168 2.35645 10.2422 3.22461 10.2422 4.83105V6.54004H5.75098V4.83105ZM4.99219 13.5059C4.69141 13.5059 4.54102 13.3623 4.54102 13V8.25586C4.54102 7.89355 4.69141 7.76367 4.99219 7.76367H11.0078C11.3086 7.76367 11.4521 7.89355 11.4521 8.25586V13C11.4521 13.3623 11.3086 13.5059 11.0078 13.5059H4.99219Z"})})},97485:(e,t,n)=>{n.d(t,{p:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("loom",{viewBox:"0 0 190 190",svg:(0,i.jsx)("path",{d:"M189.611 84.2622H134.166L182.184 56.539L171.639 38.2692L123.621 65.9923L151.338 17.9781L133.068 7.42678L105.351 55.4409V0H84.2598V55.4462L56.5322 7.42678L38.2681 17.9728L65.9904 65.987L17.9723 38.2692L7.42658 56.5337L55.4447 84.2569H0V105.349H55.4394L7.42658 133.072L17.9723 151.342L65.9851 123.624L38.2628 171.638L56.5322 182.184L84.2545 134.165V189.611H105.346V134.17L133.063 182.184L151.332 171.638L123.61 123.619L171.628 151.342L182.174 133.072L134.161 105.354H189.6V84.2622H189.611ZM94.8055 123.491C78.9021 123.491 66.0116 110.601 66.0116 94.6968C66.0116 78.7929 78.9021 65.9021 94.8055 65.9021C110.709 65.9021 123.599 78.7929 123.599 94.6968C123.599 110.601 110.709 123.491 94.8055 123.491Z"})})},81822:(e,t,n)=>{n.d(t,{h:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("maps",{viewBox:"0 0 160 164",svg:(0,i.jsxs)("g",{children:[" ",(0,i.jsx)("polyline",{points:"16 163.155 76.159 103 136.314 163.155 16 163.155"})," ",(0,i.jsx)("path",{d:"M91.1523093,12 C89.1061243,15.5558234 87.6020864,19.4206238 86.7688642,23.441 C84.8448642,33.084 86.5958642,43.241 91.3038642,51.836 C91.8382207,52.8588753 92.3925227,53.8704894 92.9644441,54.8718184 L0,147.839 L0,24.942 C0,17.799 5.796,12 12.942,12 L91.1523093,12 L91.1523093,12 Z M27.8186945,28.8787927 C20.9826945,31.9947927 15.9026945,38.8067927 15.1686945,46.3227927 C13.7376945,56.9777927 21.5856945,67.7337927 32.0706945,69.9057927 C40.5536945,71.9007927 50.5746945,68.4527927 54.8196945,60.5497927 C57.5256945,56.1347927 57.8816945,50.7917927 57.3626945,45.7587927 C50.5816945,45.0857927 43.5296945,45.6577927 36.6486945,45.4797927 C36.5946945,48.0237927 36.6096945,50.5677927 36.7256945,53.1037927 C40.8396945,53.0417927 44.9526945,53.0807927 49.0736945,53.0727927 C47.8296945,58.9497927 41.9446945,62.9007927 36.0456945,62.2127927 C27.0296945,62.0967927 20.6586945,51.4727927 24.4936945,43.3927927 C27.4236945,35.1807927 39.1766945,32.2347927 45.4326945,38.4437927 C47.4426945,36.5027927 49.4526945,34.5547927 51.4096945,32.5597927 C45.1536945,26.7907927 35.5196945,25.3527927 27.8186945,28.8787927 Z"})," ",(0,i.jsx)("path",{d:"M124.80036,20.6120969 C120.325021,21.6105482 116.569675,25.5689693 116.191987,30.2012296 C115.721991,34.5142624 118.24735,38.8911407 122.112695,40.7949674 C126.304191,43.0118678 131.806442,42.332644 135.307176,39.1288306 C138.574835,36.2380909 139.764822,31.2458343 138.057917,27.2058756 C136.037937,22.1505427 130.041845,19.2713414 124.80036,20.6120969 Z M129.322621,0 C138.754833,0.539994477 147.978584,5.14840888 153.696218,12.7298698 C157.440026,17.5182824 159.529236,23.4620677 160,29.4989291 L160,31.7396754 C159.779233,43.4418634 152.290848,53.047919 145.807068,62.1501336 C138.528681,72.435413 131.801058,83.6445291 129.937231,96.3213226 C129.438005,98.4697621 129.034302,102.445875 127.470333,102.445875 C124.80036,102.3677 123.210376,86.842958 120.185792,80.3707165 C116.755058,72.8300244 111.978183,66.0154787 107.125156,59.3463161 C104.17134,55.3471262 101.384446,51.2079378 99.0798538,46.7964445 C95.4583524,40.1849736 94.1114431,32.3719766 95.591428,24.9543602 C96.8052617,19.097497 99.8698458,13.6698602 104.112879,9.47298004 C109.830513,3.88303721 117.561972,0.499225663 125.538045,0 L129.322621,0 Z"})," ",(0,i.jsx)("path",{d:"M151.652474,72 L151.652474,148.672145 C135.535571,132.464045 127.553192,124.419378 127.705338,124.538145 C131.041338,123.277145 130.263338,119.369145 130.912338,116.576145 C133.335338,100.096145 142.081338,85.5241452 151.543338,72.1531452 C151.579693,72.102109 151.616072,72.0510607 151.652474,72 Z"})," ",(0,i.jsx)("path",{d:"M106.040648,74 L92,88.0399478 L125.952845,121.992793 C123.906994,113.374953 121.723258,103.970177 117.61803,95.9459594 C114.174293,88.3766869 110.811044,80.7912134 106.040648,74 Z"})," "]})})},28067:(e,t,n)=>{n.d(t,{N:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("mastercard",{viewBox:"0 0 34 24",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("rect",{x:".5",y:".5",width:"33",height:"23",rx:"2.5",fill:"#fff",stroke:"#D9D9D9"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.179 16.8294c-1.1841.9981-2.72 1.6006-4.3983 1.6006C9.0358 18.43 6 15.4303 6 11.73c0-3.7003 3.0358-6.7 6.7807-6.7 1.6783 0 3.2142.6025 4.3983 1.6005 1.184-.998 2.7199-1.6005 4.3983-1.6005 3.7448 0 6.7807 2.9997 6.7807 6.7 0 3.7003-3.0359 6.7-6.7807 6.7-1.6784 0-3.2143-.6025-4.3983-1.6006z",fill:"#ED0006"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.179 16.8294c1.4579-1.2289 2.3824-3.0575 2.3824-5.0994 0-2.042-.9245-3.8706-2.3824-5.0995 1.184-.998 2.7199-1.6005 4.3983-1.6005 3.7448 0 6.7806 2.9997 6.7806 6.7 0 3.7003-3.0358 6.7-6.7806 6.7-1.6784 0-3.2143-.6025-4.3983-1.6006z",fill:"#F9A000"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.179 16.8294c1.4579-1.2289 2.3824-3.0575 2.3824-5.0994 0-2.042-.9245-3.8706-2.3824-5.0995-1.4579 1.229-2.3824 3.0575-2.3824 5.0995 0 2.0419.9245 3.8705 2.3824 5.0994z",fill:"#FF5E00"})]})})},15289:(e,t,n)=>{n.d(t,{M:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("miro",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{d:"M13.75 20.895l1.761.359v-7.82l-1.76.344v7.117zm4.604-4.28v4.28l1.761.359V16.88c0-.993.56-1.441 1.432-1.607l1.015-.186v-1.835l-1.015.164c-1.935.44-3.193 1.073-3.193 3.197zm-7.446-.256c0-2.313-1.539-3.085-2.777-3.068-.984.014-1.785.423-2.265 1.047-.478-.685-1.325-1.068-2.016-1.068-.85 0-1.597.373-2.09.97v-.806L0 13.778v7.117l1.76.359v-4.895c0-.776.568-1.328 1.418-1.328.836 0 1.403.552 1.403 1.328v4.536l1.76.359v-4.895c0-.776.568-1.328 1.404-1.328.835 0 1.402.552 1.402 1.328v4.536l1.76.359v-4.895h.001zm17.176 5.059c2.356 0 3.916-1.636 3.916-4.081 0-2.446-1.56-4.067-3.916-4.067-2.446 0-4.082 1.62-4.082 4.067 0 2.445 1.636 4.08 4.082 4.08zm0-1.65c-1.366 0-2.281-.976-2.281-2.431 0-1.456.915-2.416 2.281-2.416 1.275 0 2.115.96 2.115 2.416 0 1.455-.84 2.43-2.115 2.43zm-13.416-7.552c.641 0 1.065-.445 1.065-1.11S15.31 10 14.668 10c-.665 0-1.11.44-1.11 1.106 0 .665.445 1.11 1.11 1.11"})})},78810:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("mixpanel",{viewBox:"0 0 101 106",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M31.008 41.412h13.385c-3.342-2.09-4.593-5.021-6.272-10.454l-5.022-18.613C30.803 3.982 28.918.005 19.714.005H.484v5.022H3.21c5.639 0 6.273 2.091 7.952 8.364l4.387 16.315c2.297 7.952 5.861 11.706 15.476 11.706h-.016zm30.968 0h13.37c9.614 0 12.956-3.77 15.27-11.706l4.387-16.315c1.679-6.273 2.502-8.364 7.952-8.364h2.724V.006H86.655c-9.41 0-11.294 3.77-13.385 12.34l-5.02 18.611c-1.68 5.639-2.93 8.363-6.273 10.454zM44.393 58.963h17.584l-.001-17.55H44.393v17.55zM.484 100.369h19.23c9.204 0 11.088-3.976 13.385-12.34l5.022-18.611c1.679-5.434 2.93-8.364 6.272-10.455H31.008c-9.615 0-13.179 3.77-15.475 11.706l-4.388 16.315c-1.68 6.273-2.297 8.364-7.952 8.364H.484v5.021zm86.14 0h19.023v-5.021h-2.724c-5.433 0-6.273-2.091-7.952-8.364L90.583 70.67c-2.296-7.952-5.639-11.706-15.27-11.706H61.976c3.343 2.091 4.546 4.816 6.225 10.455l5.022 18.612c2.09 8.57 3.975 12.339 13.385 12.339h.015z"})})})},58810:(e,t,n)=>{n.d(t,{Z:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("openAsPageThick",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.16895 7.19629C2.59277 7.19629 2.90723 6.88867 2.90723 6.45801V5.96582L2.75684 3.81934L4.35645 5.50098L6.3252 7.4834C6.46875 7.63379 6.65332 7.70215 6.85156 7.70215C7.30957 7.70215 7.6377 7.39453 7.6377 6.93652C7.6377 6.72461 7.55566 6.54004 7.41211 6.39648L5.43652 4.4209L3.74805 2.82129L5.91504 2.96484H6.44141C6.86523 2.96484 7.18652 2.65723 7.18652 2.22656C7.18652 1.7959 6.87207 1.48145 6.44141 1.48145L2.64746 1.48145C1.86816 1.48145 1.41699 1.93262 1.41699 2.71875L1.41699 6.45801C1.41699 6.88184 1.73828 7.19629 2.16895 7.19629ZM9.55176 14.6543H13.3389C14.125 14.6543 14.5762 14.2031 14.5762 13.417V9.67773C14.5762 9.25391 14.2549 8.93945 13.8242 8.93945C13.4004 8.93945 13.0859 9.24707 13.0859 9.67773V10.1699L13.2295 12.3164L11.6299 10.6348L9.66113 8.65234C9.52441 8.50195 9.33984 8.43359 9.1416 8.43359C8.68359 8.43359 8.35547 8.74121 8.35547 9.19922C8.35547 9.41113 8.43066 9.5957 8.57422 9.73926L10.5566 11.7148L12.2383 13.3145L10.0781 13.1709H9.55176C9.12793 13.1709 8.80664 13.4785 8.80664 13.9092C8.80664 14.3398 9.12109 14.6543 9.55176 14.6543Z"})})},41898:(e,t,n)=>{n.d(t,{d:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("overlap",{viewBox:"0 0 20 20",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M4.917 14.496h1.729v-1.1H4.93c-.342 0-.604-.091-.786-.274-.182-.182-.273-.45-.273-.806V5.52c0-.356.09-.625.273-.807.182-.182.444-.273.786-.273h6.83c.336 0 .596.09.779.273.186.182.28.451.28.807v1.497h1.1V5.459c0-.702-.18-1.23-.54-1.586-.355-.355-.888-.533-1.6-.533H4.918c-.716 0-1.254.178-1.614.533-.355.351-.533.88-.533 1.586v6.918c0 .707.178 1.237.533 1.593.36.35.898.526 1.614.526zm3.315 3.165h6.863c.711 0 1.244-.177 1.6-.533.36-.355.54-.884.54-1.586V8.624c0-.702-.18-1.23-.54-1.586-.356-.355-.889-.533-1.6-.533H8.232c-.716 0-1.253.178-1.613.533-.356.351-.534.88-.534 1.586v6.918c0 .707.178 1.235.534 1.586.36.356.897.533 1.613.533zm.014-1.1c-.342 0-.604-.091-.787-.274-.182-.182-.273-.45-.273-.806V8.686c0-.356.091-.625.273-.807.183-.182.445-.273.787-.273h6.829c.337 0 .597.09.779.273.187.182.28.451.28.807v6.795c0 .355-.093.624-.28.806-.182.183-.442.274-.78.274H8.247z"}),(0,i.jsx)("path",{d:"M13.976 12.448l-1.832 1.36c-.192.147-.379.183-.561.11-.182-.073-.273-.225-.273-.458v-.848H9.7a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.145.053-.27.157-.376s.233-.157.383-.157h1.61v-.827c0-.246.093-.401.28-.465.187-.068.371-.034.554.103l1.832 1.374a.43.43 0 01.184.362.423.423 0 01-.184.356z"})]})})},87292:(e,t,n)=>{n.d(t,{B:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("pdf",{viewBox:"0 0 42 42",svg:(0,i.jsx)("path",{d:"M6,3 L36,3 C37.6569,3 39,4.34326 39,6 L39,36 C39,37.6567 37.6569,39 36,39 L6,39 C4.34314,39 3,37.6567 3,36 L3,6 C3,4.34326 4.34314,3 6,3 Z M12.3916324,17.6692964 C12.6740492,17.8831067 12.8153869,18.2406755 12.8153869,18.7423682 C12.8153869,19.2441828 12.6740492,19.6106452 12.3916324,19.8417552 C12.1138709,20.0728653 11.7225736,20.188603 11.21787,20.188603 L9.22452987,20.188603 L9.22452987,17.3486418 L11.21787,17.3486418 C11.7225736,17.3486418 12.1138709,17.4553642 12.3916324,17.6692964 Z M14.0168221,21.143866 C14.6280786,20.6727524 14.9336421,19.8679485 14.9336421,18.7293325 C14.9336421,17.6868398 14.6280786,16.9167572 14.0168221,16.4194503 C13.4056949,15.9221434 12.5861173,15.6734899 11.5582184,15.6734899 L7.09921423,15.6734899 L7.09921423,25.3187101 L9.22452987,25.3187101 L9.22452987,21.8505974 L11.3983891,21.8505974 C12.5328408,21.8505974 13.4056949,21.6151015 14.0168221,21.143866 Z M19.3259732,23.6435582 L19.3259732,17.3486418 L21.2984941,17.3486418 C22.2709182,17.3486418 22.9191579,17.6125239 23.243213,18.14041 C23.5719234,18.6639102 23.7364079,19.4164494 23.7364079,20.3979056 C23.7364079,21.1091447 23.6275275,21.7218239 23.4098958,22.2366742 C23.0117451,23.1745156 22.3079014,23.6435582 21.2984941,23.6435582 L19.3259732,23.6435582 Z M23.243213,15.8829144 C22.8219155,15.7520698 22.294065,15.6821398 21.6596618,15.6734899 L17.2493564,15.6734899 L17.2493564,25.3187101 L21.6596618,25.3187101 C23.2062299,25.3187101 24.3498627,24.718823 25.0906895,23.5191705 C25.6371608,22.6293298 25.9102672,21.5431004 25.9102672,20.2604823 C25.9102672,19.7546473 25.845482,19.2221317 25.7157824,18.6639102 C25.586212,18.1055668 25.343106,17.5863307 24.9865936,17.1065672 C24.5420199,16.513137 23.9608931,16.1053745 23.243213,15.8829144 Z M35.4978258,15.6865256 L28.2398178,15.6865256 L28.2398178,25.3187101 L30.3650558,25.3187101 L30.3650558,21.2748324 L34.8587673,21.2748324 L34.8587673,19.5996805 L30.3650558,19.5996805 L30.3650558,17.3814139 L35.4978258,17.3814139 L35.4978258,15.6865256 Z"})})},17683:(e,t,n)=>{n.d(t,{Q:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("peekModeCenter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM4.33594 11.0654H11.6504C12.0742 11.0654 12.2588 10.8809 12.2588 10.4502V5.69238C12.2588 5.25488 12.0742 5.07715 11.6504 5.07715H4.33594C3.91211 5.07715 3.72754 5.25488 3.72754 5.69238V10.4502C3.72754 10.8809 3.91211 11.0654 4.33594 11.0654Z"})})},31490:(e,t,n)=>{n.d(t,{M:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("peekModeFull",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM2.77734 12.1113H13.2158C13.5645 12.1113 13.7559 11.9131 13.7559 11.5645V4.57812C13.7559 4.22949 13.5645 4.02441 13.2158 4.02441H2.77734C2.42871 4.02441 2.2373 4.22949 2.2373 4.57812V11.5645C2.2373 11.9131 2.42871 12.1113 2.77734 12.1113Z"})})},32240:(e,t,n)=>{n.d(t,{y:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("peekModeSide",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM8.51953 12.1113H13.2158C13.5986 12.1113 13.7559 11.9541 13.7559 11.5645V4.57812C13.7559 4.18848 13.5986 4.02441 13.2158 4.02441H8.51953C8.13672 4.02441 7.98633 4.18848 7.98633 4.57812V11.5645C7.98633 11.9541 8.13672 12.1113 8.51953 12.1113Z"})})},25651:(e,t,n)=>{n.d(t,{R:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("pencil",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},44597:(e,t,n)=>{n.d(t,{U:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("picture",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M1,4v22h28V4H1z M27,24H3V6h24V24z M18,10l-5,6l-2-2l-6,8h20L18,10z M11.216,17.045l1.918,1.918l4.576-5.491L21.518,20H9 L11.216,17.045z M7,12c1.104,0,2-0.896,2-2S8.104,8,7,8s-2,0.896-2,2S5.896,12,7,12z"})})},87111:(e,t,n)=>{n.d(t,{I:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("play",{viewBox:"0 0 14 16",svg:(0,i.jsx)("path",{d:"M1.34699 16C1.73805 16 2.07697 15.8756 2.52017 15.6089L12.8703 9.47556C13.6437 9.01333 14 8.62222 14 8C14 7.37778 13.6437 6.98667 12.8703 6.52444L2.52017 0.391111C2.07697 0.133333 1.73805 0 1.34699 0C0.582247 0 0 0.595556 0 1.57333V14.4356C0 15.4044 0.582247 16 1.34699 16Z"})})},59401:(e,t,n)=>{n.d(t,{K:()=>a});var o=n(67294),i=n(45238),r=n(85893);const a=(0,i.I)("playbackError",{viewBox:"0 0 32 32",svg:(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)("path",{d:"M6.39515 29.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33306.6662-.69079.6662z"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29.1373 16.1987c0 6.7017-5.542 12.2437-12.2436 12.2437-1.622 0-3.1761-.3246-4.6001-.9118.3323-.4107.6226-.8567.8644-1.3316 1.1612.4325 2.4197.6687 3.7357.6687 5.9082 0 10.6689-4.7608 10.6689-10.669-.0122-5.9082-4.7729-10.65671-10.6812-10.65671-5.5497 0-10.08288 4.20726-10.5961 9.62871-.55173.0075-1.08925.0738-1.60656.193.4362-6.32082 5.78156-11.40862 12.20266-11.40862 6.7139 0 12.2559 5.54199 12.2559 12.24362zm-15.4585 4.4372a7.628 7.628 0 00-.0797-.2566.65573.65573 0 01-.0013-.0424v-8.2764c0-.5004.5859-.7202 1.0498-.4516l6.7016 4.0161c.4395.2686.4517.8911 0 1.1597l-6.7016 3.9917c-.3763.2257-.796.1398-.9688-.1405z"})]})})},47453:(e,t,n)=>{n.d(t,{R:()=>r,s:()=>i});n(67294);var o=n(45238);const i=(0,n(85893).jsx)("path",{d:"M7.977 14.963c.407 0 .747-.324.747-.723V8.72h5.362c.399 0 .74-.34.74-.747a.746.746 0 00-.74-.738H8.724V1.706c0-.398-.34-.722-.747-.722a.732.732 0 00-.739.722v5.529h-5.37a.746.746 0 00-.74.738c0 .407.341.747.74.747h5.37v5.52c0 .399.332.723.739.723z"}),r=(0,o.I)("plus",{viewBox:"0 0 16 16",svg:i})},74600:(e,t,n)=>{n.d(t,{L:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("questionMark",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M9.645 12.826c.26 0 .457-.073.594-.219a.935.935 0 00.233-.574v-.212a2 2 0 01.15-.71c.091-.197.24-.386.444-.568.21-.187.5-.401.869-.643.601-.396 1.07-.831 1.408-1.305.342-.479.512-1.046.512-1.702 0-.693-.173-1.283-.52-1.77a3.258 3.258 0 00-1.394-1.129c-.588-.264-1.246-.396-1.975-.396-.547 0-1.057.08-1.531.239-.47.16-.885.39-1.245.69-.355.301-.63.661-.827 1.08a2.38 2.38 0 00-.17.486 2.205 2.205 0 00-.048.444c0 .237.068.43.205.581.14.146.337.219.588.219a.847.847 0 00.519-.157.905.905 0 00.314-.445c.114-.387.272-.7.472-.936.205-.237.447-.408.725-.513.282-.11.59-.164.923-.164.41 0 .777.073 1.1.219.324.141.581.346.773.615.196.269.294.583.294.943 0 .31-.06.581-.178.814a2.17 2.17 0 01-.513.642c-.223.196-.49.402-.8.616a6.68 6.68 0 00-.922.738 2.965 2.965 0 00-.63.84c-.15.306-.225.65-.225 1.033v.369c0 .26.073.472.219.636.15.16.362.24.636.24zm.013 3.808c.205 0 .392-.05.56-.15.174-.1.31-.235.41-.404a.998.998 0 00.158-.554c0-.2-.052-.385-.157-.553a1.071 1.071 0 00-.41-.397 1.08 1.08 0 00-.56-.15c-.21 0-.4.05-.568.15a1.085 1.085 0 00-.554.95c0 .205.05.39.15.554.1.169.235.303.404.403.168.1.358.15.567.15z"})})},36067:(e,t,n)=>{n.d(t,{J:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("replit",{viewBox:"0 0 793.8 871.5",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M396.9 356.1H227.2c-16.6 0-30-13.4-30-30v-99.8c0-16.6 13.4-30 30-30h139.7c16.6 0 30 13.4 30 30v129.8zm169.7 159.7H396.9V356.1h169.7c16.5 0 29.9 13.4 29.9 29.9v99.8c0 16.6-13.4 30-29.9 30zM366.9 675.6H227.2c-16.5 0-29.9-13.4-29.9-29.9v-99.8c0-16.5 13.4-29.9 29.9-29.9h169.7v129.8c0 16.3-13.4 29.8-30 29.8z"})})})},18442:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("settings",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.30957 15.4814H8.69043C9.25781 15.4814 9.70215 15.1328 9.83203 14.5928L10.1123 13.3828L10.29 13.3145L11.3428 13.9639C11.8213 14.2646 12.3818 14.1895 12.7783 13.7861L13.7354 12.8291C14.1455 12.4258 14.2139 11.8652 13.9131 11.3936L13.2637 10.3477L13.3252 10.1768L14.5352 9.89648C15.0684 9.75977 15.4238 9.31543 15.4238 8.75488V7.4082C15.4238 6.84766 15.0752 6.40332 14.5352 6.2666L13.3389 5.97949L13.2705 5.80176L13.9199 4.75586C14.2207 4.28418 14.1455 3.73047 13.7422 3.31348L12.7852 2.35645C12.3887 1.95996 11.8281 1.88477 11.3564 2.17871L10.3037 2.82129L10.1123 2.74609L9.83203 1.53613C9.70215 0.996094 9.25781 0.647461 8.69043 0.647461H7.30957C6.73535 0.647461 6.29785 0.996094 6.16797 1.53613L5.8877 2.74609L5.69629 2.82129L4.64355 2.17871C4.16504 1.88477 3.60449 1.95996 3.20801 2.35645L2.25098 3.31348C1.84766 3.73047 1.77246 4.28418 2.07324 4.75586L2.72949 5.80176L2.6543 5.97949L1.46484 6.2666C0.917969 6.40332 0.576172 6.84766 0.576172 7.4082V8.75488C0.576172 9.31543 0.924805 9.75977 1.46484 9.89648L2.66797 10.1768L2.73633 10.3477L2.08008 11.3936C1.7793 11.8652 1.85449 12.4258 2.25781 12.8291L3.21484 13.7861C3.61816 14.1895 4.17871 14.2646 4.65039 13.9639L5.70312 13.3145L5.8877 13.3828L6.16797 14.5928C6.29785 15.1328 6.73535 15.4814 7.30957 15.4814ZM7.47363 14.2441C7.35742 14.2441 7.30273 14.1895 7.28223 14.0869L6.87891 12.4053C6.44141 12.3027 6.03125 12.1318 5.69629 11.9199L4.21973 12.8291C4.1377 12.8838 4.05566 12.877 3.9668 12.7949L3.24219 12.0703C3.16699 11.9951 3.16016 11.9131 3.22168 11.8242L4.13086 10.3477C3.93945 10.0264 3.75488 9.61621 3.65234 9.18555L1.96387 8.78223C1.86133 8.76172 1.81348 8.70703 1.81348 8.59082V7.56543C1.81348 7.44238 1.86133 7.39453 1.96387 7.36719L3.65234 6.9707C3.75488 6.5127 3.95312 6.08887 4.11719 5.79492L3.21484 4.3252C3.15332 4.22949 3.15332 4.14746 3.23535 4.06543L3.95996 3.34766C4.04883 3.27246 4.11719 3.25879 4.21973 3.31348L5.68945 4.20898C5.99707 4.02441 6.44824 3.83301 6.87891 3.72363L7.28223 2.04199C7.30273 1.93945 7.35742 1.88477 7.47363 1.88477H8.52637C8.64258 1.88477 8.69727 1.93262 8.71094 2.04199L9.12109 3.7373C9.56543 3.83984 9.96875 4.02441 10.3037 4.21582L11.7734 3.32031C11.876 3.26562 11.9443 3.27246 12.0264 3.35449L12.7578 4.07227C12.8398 4.14746 12.8398 4.22949 12.7783 4.3252L11.876 5.79492C12.04 6.08887 12.2451 6.5127 12.3477 6.9707L14.0293 7.36719C14.1387 7.39453 14.1865 7.44238 14.1865 7.56543V8.59082C14.1865 8.70703 14.1318 8.76172 14.0293 8.78223L12.3408 9.18555C12.2383 9.61621 12.0537 10.0264 11.8691 10.3477L12.7715 11.8242C12.8262 11.9131 12.8262 11.9951 12.751 12.0635L12.0264 12.7949C11.9375 12.877 11.8555 12.8838 11.7734 12.8291L10.2969 11.9199C9.96191 12.1318 9.57227 12.3027 9.12109 12.4053L8.71094 14.0869C8.69727 14.1963 8.64258 14.2441 8.52637 14.2441H7.47363ZM8 10.6621C9.42188 10.6621 10.5908 9.49316 10.5908 8.06445C10.5908 6.64941 9.42188 5.48047 8 5.48047C6.57812 5.48047 5.40234 6.64941 5.40234 8.06445C5.40234 9.49316 6.57129 10.6621 8 10.6621ZM8 9.49316C7.2207 9.49316 6.57812 8.85059 6.57812 8.06445C6.57812 7.29199 7.2207 6.65625 8 6.65625C8.76562 6.65625 9.40137 7.29199 9.40137 8.06445C9.40137 8.84375 8.76562 9.49316 8 9.49316Z"})})},1436:(e,t,n)=>{n.d(t,{g:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("settingsConnectedApps",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M16.492 3.922C15.695 3.125 14.57 3 13.234 3H7.148c-1.312 0-2.437.125-3.234.922C3.117 4.719 3 5.836 3 7.14v6.03c0 1.337.117 2.446.914 3.243.797.797 1.922.922 3.25.922h6.07c1.336 0 2.461-.125 3.258-.922.797-.797.914-1.906.914-3.242V7.164c0-1.336-.117-2.453-.914-3.242zm-.344 3.023v6.438c0 .812-.101 1.64-.578 2.117-.468.469-1.312.578-2.117.578h-6.5c-.805 0-1.648-.11-2.125-.578-.469-.477-.57-1.305-.57-2.117V6.969c0-.82.101-1.664.57-2.133.477-.477 1.328-.578 2.149-.578h6.476c.805 0 1.649.11 2.117.578.477.476.578 1.305.578 2.11zm-3.492 5.149c.344 0 .57-.266.57-.625V7.78c0-.46-.25-.64-.648-.64h-3.71c-.368 0-.602.226-.602.57s.242.57.617.57h1.422l1.156-.125-1.219 1.133-2.875 2.883a.62.62 0 00-.187.422c0 .351.226.578.57.578.188 0 .336-.07.445-.18l2.875-2.875 1.125-1.203-.117 1.219v1.351c0 .368.227.61.578.61z"})})},56996:(e,t,n)=>{n.d(t,{z:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sidebarHome",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.54446 3.06854C9.8066 2.84385 10.1934 2.84385 10.4556 3.06854L15.7064 7.56922C16.0832 7.89219 16.3 8.36369 16.3 8.85996V14.6C16.3 15.5389 15.5389 16.3 14.6 16.3H11.75C11.3634 16.3 11.05 15.9866 11.05 15.6V11.7H8.95001V15.6C8.95001 15.9866 8.63661 16.3 8.25001 16.3H5.40001C4.46113 16.3 3.70001 15.5389 3.70001 14.6V8.85996C3.70001 8.36369 3.91687 7.89219 4.29367 7.56922L9.54446 3.06854ZM10 4.52198L5.20477 8.63218C5.13828 8.68918 5.10001 8.77238 5.10001 8.85996V14.6C5.10001 14.7657 5.23433 14.9 5.40001 14.9H7.55001V11.5C7.55001 10.8373 8.08727 10.3 8.75001 10.3H11.25C11.9128 10.3 12.45 10.8373 12.45 11.5V14.9H14.6C14.7657 14.9 14.9 14.7657 14.9 14.6V8.85996C14.9 8.77238 14.8617 8.68918 14.7952 8.63218L10 4.52198Z"})})},31317:(e,t,n)=>{n.d(t,{j:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sketch",{viewBox:"0 0 46 46",svg:(0,i.jsx)("g",{fillRule:"evenodd",children:(0,i.jsx)("path",{d:"M23.0831783 10.0045301l8.1450351.8960958c.2099814.0231017.4008968.1324906.5270123.3019626l6.0917147 8.1859511c.2137793.2872733.1982297.6847539-.0373384.9544486L23.4296391 36.806161c-.2072579.2372831-.5676296.2616233-.8049127.0543654l-.0543655-.0543654L8.19039805 20.3429882c-.23556813-.2696947-.25111774-.6671753-.03733843-.9544486l6.09171468-8.1859511c.1261155-.169472.3170309-.2788609.5270123-.3019626l8.1450351-.8960958a.76060447.76060447 0 01.1663566 0zm2.0141776 2.4229231c-.0693405-.0648437-.1764661-.0687976-.2504897-.0092454-.081512.0655766-.0939018.1841651-.0276733.2648747l3.8573181 4.7007387c.055083.0671271.085151.1509825.085151.2374739 0 .207984-.1702805.3765884-.3803321.3765884H17.6186701c-.0873512 0-.1720402-.0297721-.2398346-.0843129-.163024-.1311532-.1878035-.3683301-.0553465-.5297494l3.8573181-4.7007387c.0601442-.073295.0561509-.1793661-.0093373-.2480242-.0721132-.0756035-.1924706-.0790085-.2688257-.0076051l-5.750016 5.3771171c-.0774384.0724164-.1819972.1093609-.2882425.1018466-.2095178-.0148182-.3672335-.1950067-.352268-.4024622l.2753824-3.8174045c.0064096-.0888512-.0509385-.1699933-.1374402-.1944648-.1009848-.0285688-.206239.0293302-.2350918.129321L13.1553109 17.98681c-.0869135.3012032-.3194364.539875-.62031.6367138l-2.76499194.8899366c-.07834118.0252148-.13137885.0975058-.13137885.1790711 0 .1039921.08514024.1882942.19016605.1882942h2.66553224c.3250892 0 .6276464.1644528.8021788.4360184L20.3459621 31.28552c.0777639.1209976.2347663.165079.3651002.1025088.1417556-.0680534.2009545-.2370061.1322245-.3773663l-5.0526479-10.3185107c-.0376144-.0768161-.0571558-.1610746-.0571558-.2464434 0-.3119761.2554207-.5648827.5704981-.5648827h13.3920376c.0862174 0 .1713136.0193492.2488932.0565933.2835111.1361069.401909.4740123.2644491.7547328l-5.0526479 10.3185107c-.0631922.129051-.0186726.2845081.1035279.3615065.1329093.0837462.3092182.0449521.3937968-.086649l7.0494549-10.9686759c.1745324-.2715656.4770896-.4360184.8021788-.4360184h2.5849257c.0818532 0 .1545231-.0518618.1804073-.1287503.0332121-.0986555-.0206353-.2052903-.1202715-.2381755l-2.6912281-.888246c-.2977515-.0982735-.5273437-.3357047-.6135671-.6345159l-1.2609059-4.3697316c-.0247148-.0856502-.1066636-.1424338-.196398-.1360873-.1047589.0074091-.1836168.0975033-.176134.2012311l.2753824 3.8174045c.0075889.1051994-.0297228.2087291-.1028592.2854053-.1442263.1512071-.3849411.158017-.5376513.0152103z"})})})},24600:(e,t,n)=>{n.d(t,{P:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("slackLogo",{viewBox:"0 0 16 16",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M1.68078 11.7915C2.60586 11.7915 3.36156 11.0358 3.36156 10.1107V8.42993H1.68078C0.755701 8.42993 0 9.18563 0 10.1107C0 11.0358 0.755701 11.7915 1.68078 11.7915Z",fill:"#E01E5A"}),(0,i.jsx)("path",{d:"M5.88928 8.42993C4.9642 8.42993 4.2085 9.18563 4.2085 10.1107V14.3192C4.2085 15.2443 4.9642 16 5.88928 16C6.81436 16 7.57006 15.2443 7.57006 14.3192V10.1107C7.57006 9.18563 6.81436 8.42993 5.88928 8.42993Z",fill:"#E01E5A"}),(0,i.jsx)("path",{d:"M4.2085 1.68078C4.2085 2.60586 4.9642 3.36156 5.88928 3.36156H7.57006V1.68078C7.57006 0.755701 6.81436 0 5.88928 0C4.9642 0 4.2085 0.755701 4.2085 1.68078Z",fill:"#36C5F0"}),(0,i.jsx)("path",{d:"M7.57003 5.88928C7.57003 4.9642 6.81433 4.2085 5.88925 4.2085H1.68078C0.755701 4.2085 0 4.9642 0 5.88928C0 6.81436 0.755701 7.57006 1.68078 7.57006H5.88925C6.81433 7.57006 7.57003 6.81436 7.57003 5.88928Z",fill:"#36C5F0"}),(0,i.jsx)("path",{d:"M10.1107 7.57003C11.0358 7.57003 11.7915 6.81433 11.7915 5.88925V1.68078C11.7915 0.755701 11.0358 0 10.1107 0C9.18563 0 8.42993 0.755701 8.42993 1.68078V5.88925C8.42993 6.81433 9.18563 7.57003 10.1107 7.57003Z",fill:"#2EB67D"}),(0,i.jsx)("path",{d:"M14.3192 4.2085C13.3941 4.2085 12.6384 4.9642 12.6384 5.88928V7.57006H14.3192C15.2443 7.57006 16 6.81436 16 5.88928C16 4.9642 15.2443 4.2085 14.3192 4.2085Z",fill:"#2EB67D"}),(0,i.jsx)("path",{d:"M8.42993 10.1107C8.42993 11.0358 9.18563 11.7915 10.1107 11.7915H14.3192C15.2443 11.7915 16 11.0358 16 10.1107C16 9.18563 15.2443 8.42993 14.3192 8.42993H10.1107C9.18563 8.42993 8.42993 9.18563 8.42993 10.1107Z",fill:"#ECB22E"}),(0,i.jsx)("path",{d:"M11.7915 14.3192C11.7915 13.3941 11.0358 12.6384 10.1107 12.6384H8.42993V14.3192C8.42993 15.2443 9.18563 16 10.1107 16C11.0358 16 11.7915 15.2443 11.7915 14.3192Z",fill:"#ECB22E"})]})})},11751:(e,t,n)=>{n.d(t,{t:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sparkles",{viewBox:"0 0 14 17",svg:(0,i.jsx)("path",{d:"M6.417 4.074c.096 0 .157-.061.178-.157.191-1.114.184-1.128 1.36-1.36.096-.02.157-.076.157-.178 0-.096-.061-.157-.157-.171-1.176-.219-1.155-.24-1.36-1.36-.02-.096-.082-.164-.178-.164-.096 0-.157.068-.178.164-.205 1.107-.177 1.12-1.36 1.36-.096.014-.157.075-.157.17 0 .103.061.158.164.179 1.169.225 1.162.232 1.353 1.36.02.096.082.157.178.157zM3.095 8.921c.15 0 .266-.11.287-.253.232-1.798.28-1.812 2.167-2.16a.276.276 0 00.246-.28c0-.15-.11-.267-.253-.28-1.873-.26-1.928-.315-2.16-2.154-.02-.15-.13-.26-.287-.26-.15 0-.26.11-.28.267-.22 1.798-.294 1.798-2.168 2.146-.15.02-.252.13-.252.28 0 .158.102.26.28.28 1.846.288 1.92.35 2.14 2.147.02.158.13.267.28.267zm4.82 7.54c.211 0 .375-.15.41-.376.498-3.67 1.01-4.252 4.655-4.662a.416.416 0 00.39-.41c0-.22-.165-.383-.39-.417-3.61-.431-4.123-.957-4.656-4.662-.04-.22-.198-.37-.41-.37-.212 0-.376.15-.41.37-.5 3.677-1.012 4.258-4.655 4.662-.226.027-.39.198-.39.417 0 .212.164.383.39.41 3.602.492 4.101.964 4.655 4.662.04.226.198.376.41.376z"})})},95855:(e,t,n)=>{n.d(t,{z:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("speechBubble",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.32 15.424c.39 0 .677-.192 1.149-.609l2.344-2.064h4.116c2.057 0 3.213-1.19 3.213-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.22h.28v1.675c0 .608.322.998.875.998zm.342-1.531v-1.949c0-.403-.178-.56-.56-.56H3.26c-1.285 0-1.9-.65-1.9-1.894V4.26c0-1.243.615-1.893 1.9-1.893h8.627c1.278 0 1.893.65 1.893 1.894v5.23c0 1.243-.615 1.893-1.893 1.893h-4.15c-.417 0-.622.068-.909.369l-2.167 2.14z"})})},87784:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("splitView",{viewBox:"0 0 24 20",svg:(0,i.jsx)("path",{d:"M13.456 11.143V2.864c0-1.476-.766-2.242-2.222-2.242H2.915C1.452.622.693 1.388.693 2.864v8.278c0 1.477.76 2.243 2.222 2.243h8.32c1.462 0 2.221-.766 2.221-2.242zm-1.34-.083c0 .636-.335.985-.998.985H3.024c-.663 0-.99-.349-.99-.985V7.663h10.082v3.397zM2.033 2.946c0-.629.328-.984.991-.984h8.094c.663 0 .998.355.998.984v3.405H2.033V2.946z"})})},65153:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sub",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M5 3V20H23.187L19.594 16.406L21 15L27 21L21 27L19.594 25.594L23.187 22H3V3H5Z"})})},60291:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sync",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M27.93 13.81h-1.54c-.606-5.717-5.536-10.265-11.387-10.265-3.425 0-6.514 1.55-8.625 3.987-.427.483-.37 1.078.079 1.392.438.315.965.214 1.336-.202a9.57 9.57 0 017.21-3.268 9.503 9.503 0 019.456 8.356h-1.673c-.798 0-1 .539-.573 1.156l2.516 3.583c.359.516.898.528 1.269 0l2.504-3.572c.45-.628.236-1.167-.573-1.167zM2.064 16.202h1.55c.607 5.716 5.526 10.253 11.388 10.253 3.425 0 6.525-1.561 8.636-3.987.416-.483.36-1.09-.078-1.404-.438-.314-.977-.202-1.337.214-1.74 2.01-4.324 3.268-7.221 3.268a9.496 9.496 0 01-9.467-8.344H7.22c.798 0 1-.55.573-1.157l-2.516-3.583c-.359-.516-.898-.527-1.269 0l-2.515 3.572c-.438.617-.236 1.168.572 1.168z"})})},77734:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("tableHeaderColumn",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM14.6762 4.19293C14.6762 3.56913 14.325 3.25402 13.7037 3.25402H7V5.60772H14.6762V4.19293ZM7 6.81672V9.18328H14.6762V6.81672H7ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H7V12.7395H13.7037Z"})})},73599:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("tableHeaderRow",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM1.32377 6.81672V9.18328H7.34825V6.81672H1.32377ZM8.645 6.81672V9.18328H14.6762V6.81672H8.645ZM1.32377 11.8071C1.32377 12.4309 1.66821 12.7395 2.29633 12.7395H7.34825V10.3923H1.32377V11.8071ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H8.645V12.7395H13.7037Z"})})},63003:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("tex",{viewBox:"0 0 32 21",svg:(0,i.jsxs)("g",{children:[" ",(0,i.jsxs)("g",{id:"d7fc5246-3c04-467c-8f25-6c129c5642ac","data-name":"tex",children:[" ",(0,i.jsxs)("g",{id:"ec363c67-067d-4da0-8c27-f8d029e068bd","data-name":"E",children:[" ",(0,i.jsx)("path",{id:"e1948427-1829-4c96-a9f4-14a99a3d5b97","data-name":"path0 fill",d:"M497.33,497.82c-1.2,0-2.11-.06-3-0.06a0.5,0.5,0,0,0-.55.27c0,0.15.17,0.23,0.57,0.32a1.08,1.08,0,0,1,1.06,1.23c0,0.55,0,1,0,3.32s-0.08,4.43-.13,5.21c-0.08,1-.42,1.2-1.39,1.41a0.59,0.59,0,0,0-.53.32c0,0.21.23,0.25,0.59,0.25,0.7,0,1.08-.09,2.13-0.09,2.76,0,6,.13,6.21.13a0.7,0.7,0,0,0,.36-0.21,14.63,14.63,0,0,0,.68-2.07c0-.21,0-0.53-0.15-0.53a0.78,0.78,0,0,0-.48.55,2.41,2.41,0,0,1-1.54,1.41,9,9,0,0,1-1.8.15,10.57,10.57,0,0,1-1.69-.13,0.74,0.74,0,0,1-.38-0.44,7,7,0,0,1-.15-1.56c0-.78,0-2.49.06-2.93a0.26,0.26,0,0,1,.17-0.17c0.53,0,1.29,0,1.9,0,1.06,0.06,1.18.13,1.44,1a0.52,0.52,0,0,0,.32.4c0.15,0,.23-0.19.23-0.53s-0.06-.68-0.06-1.2,0-.84.06-1.35c0-.17,0-0.46-0.17-0.46a0.54,0.54,0,0,0-.36.42c-0.34.87-.38,0.93-2.09,0.93h-1.27a0.18,0.18,0,0,1-.17-0.17c0-.44,0-3.84.08-4.29a0.5,0.5,0,0,1,.27-0.55,21.09,21.09,0,0,1,2.7.1,1.4,1.4,0,0,1,1.25,1.31,0.54,0.54,0,0,0,.3.47,0.46,0.46,0,0,0,.3-0.51c0-.38,0-1.08,0-1.84a0.28,0.28,0,0,0-.17-0.23,14.12,14.12,0,0,1-1.75.08h-2.81Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,i.jsxs)("g",{id:"8dfbf0a9-85f0-49da-99d8-6229354b9534","data-name":"T",children:[" ",(0,i.jsx)("path",{id:"8602b8e9-f5d6-42d3-88c6-0649b350ce04","data-name":"path1 fill",d:"M490.48,490.82c-2.18,0-3.91-.06-4.39-0.11a1.32,1.32,0,0,1-.68-0.34,0.85,0.85,0,0,0-.3-0.3,0.39,0.39,0,0,0-.28.32,19.85,19.85,0,0,1-.38,2.55,0.4,0.4,0,0,0,.23.42c0.08,0,.19,0,0.38-0.42a5.64,5.64,0,0,1,.61-1,1.72,1.72,0,0,1,1.35-.44c0.32,0,1.94,0,2.3.09a0.26,0.26,0,0,1,.17.25v2.26c0,1.46-.09,5.3-0.13,6.44-0.06,1.41-.11,1.71-1.41,2a0.47,0.47,0,0,0-.38.34c0,0.11.19,0.23,0.57,0.23s1.33-.13,2.22-0.13,2.13,0.1,2.28.1,0.53,0,.53-0.25a0.65,0.65,0,0,0-.49-0.34c-1.22-.25-1.31-0.53-1.39-1.33s-0.1-2.6-.1-4.81c0-1.63,0-3.61,0-4.5a0.35,0.35,0,0,1,.15-0.25c0.29-.06,2.26-0.06,2.6,0,1.12,0.06,1.37.15,1.5,1.16,0.06,0.48.15,0.61,0.28,0.61a0.43,0.43,0,0,0,.32-0.38,11.69,11.69,0,0,1,.42-2.2c0.1-.27,0-0.44-0.09-0.44a0.72,0.72,0,0,0-.28.13,2.49,2.49,0,0,1-1.33.32C494,490.8,491.49,490.82,490.48,490.82Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,i.jsxs)("g",{id:"88168da7-a35d-4a6e-af2a-2bab78b9d062","data-name":"X",children:[" ",(0,i.jsx)("path",{id:"f33958e3-fb20-476c-b2a8-674ffe821a96","data-name":"path2 fill",d:"M504,491a0.52,0.52,0,0,0,.51.36,3,3,0,0,1,1.84,1.14,53.54,53.54,0,0,1,3,4.73,0.22,0.22,0,0,1-.06.27c-1.14,1.58-2.22,2.87-3,3.72a4.47,4.47,0,0,1-2.22,1.27c-0.51.1-.7,0.27-0.7,0.44s0.15,0.21.51,0.21,1.2-.1,2-0.1c0.61,0,1.48.06,2,.06,0.25,0,.46-0.08.46-0.27a0.53,0.53,0,0,0-.46-0.32c-0.74-.27-1-0.47-0.17-1.82,0.53-.78,1.44-2,2.05-2.72a0.15,0.15,0,0,1,.19,0c0.23,0.21,2.09,3.17,2.53,4a0.26,0.26,0,0,1-.08.34,3.18,3.18,0,0,1-.68.23c-0.32.11-.42,0.19-0.42,0.34s0.11,0.25.47,0.25,1-.08,1.58-0.08c1.12,0,2.17.11,2.79,0.11,0.42,0,.57-0.09.57-0.25a0.49,0.49,0,0,0-.44-0.36,3.37,3.37,0,0,1-2.34-1.73c-0.49-.67-2.7-4-2.83-4.31a0.45,0.45,0,0,1,0-.23c0.91-1.27,2.17-2.7,2.85-3.52a3.79,3.79,0,0,1,2.38-1.41,0.5,0.5,0,0,0,.44-0.34,0.44,0.44,0,0,0-.46-0.21c-0.44,0-1.56.06-2,.06s-1.12,0-1.69,0c-0.36,0-.53.1-0.53,0.25a0.49,0.49,0,0,0,.48.34c0.67,0.13,1,.34.72,0.89a32.86,32.86,0,0,1-2.53,3.44,0.14,0.14,0,0,1-.19,0,33.44,33.44,0,0,1-2.3-3.63c-0.21-.38,0-0.59.34-0.68s0.46-.21.46-0.36a0.43,0.43,0,0,0-.47-0.21c-0.55,0-.91,0-1.63,0s-2-.1-2.39-0.1S504,490.84,504,491Z",transform:"translate(-484.44 -490.06)"})," "]})," "]})," "]})})},98519:(e,t,n)=>{n.d(t,{k:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("thinCheck",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},91:(e,t,n)=>{n.d(t,{L:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("triangle",{viewBox:"0 0 100 100",svg:(0,i.jsx)("polygon",{points:"5.9,88.2 50,11.8 94.1,88.2 "})})},77926:(e,t,n)=>{n.d(t,{l:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("twitter",{viewBox:"0 0 300 300",svg:(0,i.jsx)("path",{d:"M103.62,251.13969 C197.96,251.13969 249.56,172.97969 249.56,105.19969 C249.56,102.97969 249.56,100.76969 249.41,98.5696903 C259.448314,91.3087989 268.113555,82.3184843 275,72.0196903 C265.638791,76.167708 255.708293,78.8879768 245.54,80.0896903 C256.24744,73.6795109 264.261235,63.5974102 268.09,51.7196903 C258.021575,57.6942435 247.006461,61.9048105 235.52,64.1696903 C219.620828,47.2636331 194.357194,43.1258162 173.895493,54.0764896 C153.433792,65.027163 142.86275,88.3429476 148.11,110.94969 C106.868957,108.882186 68.4447578,89.402923 42.4,57.3596903 C28.7862276,80.7961376 35.7398788,110.778285 58.28,125.82969 C50.117412,125.587766 42.1327937,123.385822 35,119.40969 C35,119.61969 35,119.83969 35,120.05969 C35.0066813,144.47562 52.2175149,165.505042 76.15,170.33969 C68.598696,172.399091 60.6758059,172.700133 52.99,171.21969 C59.7094793,192.113919 78.9657456,206.427529 100.91,206.83969 C82.7473504,221.11401 60.3105951,228.862968 37.21,228.83969 C33.1290357,228.831856 29.0520407,228.584765 25,228.09969 C48.4563595,243.152456 75.749134,251.13686 103.62,251.09969"})})},51929:(e,t,n)=>{n.d(t,{G:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("typeform",{viewBox:"0 0 30 31",svg:(0,i.jsx)("path",{d:"M15.027 30.53c-4.294-.036-8.467-2.247-11.47-5.222C.553 22.333-.09 19.78.009 15.654.107 11.53 1.2 7.81 4.047 4.68 6.895 1.55 10.121.11 14.25.006c4.129-.103 7.291 1.046 10.44 4.156 3.15 3.11 5.242 7.127 5.31 11.392.067 4.266-1.978 6.94-4.972 9.936-2.994 2.995-5.706 5.077-10 5.04zm-4.891-19.66h3.818v10.304h1.903V10.87h3.818V9.071h-9.54v1.798z"})})},55863:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("undo",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.542 10.6826C14.542 7.96875 12.71 6.10254 9.59961 6.10254H5.29297L3.70703 6.1709L4.91016 5.15234L6.67383 3.43652C6.80371 3.30664 6.89258 3.14258 6.89258 2.91699C6.89258 2.5 6.59863 2.19238 6.1543 2.19238C5.96973 2.19238 5.76465 2.28125 5.61426 2.4248L1.69043 6.29395C1.5332 6.4375 1.45117 6.64258 1.45117 6.84766C1.45117 7.05273 1.5332 7.25098 1.69043 7.40137L5.61426 11.2705C5.76465 11.4141 5.96973 11.5029 6.1543 11.5029C6.59863 11.5029 6.89258 11.1953 6.89258 10.7715C6.89258 10.5527 6.80371 10.3887 6.67383 10.252L4.91016 8.53613L3.70703 7.52441L5.29297 7.59277H9.64746C11.8486 7.59277 13.0586 8.84375 13.0586 10.6211C13.0586 12.4053 11.8486 13.7109 9.64746 13.7109H8.05469C7.60352 13.7109 7.2959 14.0459 7.2959 14.4629C7.2959 14.873 7.61035 15.208 8.05469 15.208H9.69531C12.751 15.208 14.542 13.4102 14.542 10.6826Z"})})},95097:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("video",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M2,2v26h26V2H2z M26,6h-2V4h2V6z M22,14H8V4h14V14z M6,10H4V8h2V10z M6,12v2H4v-2H6z M6,16v2H4v-2H6z M6,20v2H4v-2H6z M8,16 h14v10H8V16z M24,20h2v2h-2V20z M24,18v-2h2v2H24z M24,14v-2h2v2H24z M24,10V8h2v2H24z M6,4v2H4V4H6z M4,24h2v2H4V24z M24,26v-2h2v2 H24z"})})},95485:(e,t,n)=>{n.d(t,{w:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("visa",{viewBox:"0 0 33 23",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("rect",{width:"33",height:"23",rx:"2.5",fill:"#fff",stroke:"#D9D9D9"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 15.858H8.69L7.147 9.792c-.073-.279-.229-.525-.458-.642A6.573 6.573 0 004.8 8.508v-.233h3.318c.458 0 .801.35.859.758l.801 4.376 2.059-5.134h2.002l-3.089 7.583zm4.234 0H13.04l1.602-7.583h1.945l-1.602 7.583zm4.119-5.482c.057-.409.4-.642.801-.642a3.535 3.535 0 011.888.35l.344-1.633a4.801 4.801 0 00-1.774-.351c-1.888 0-3.262 1.05-3.262 2.508 0 1.11.973 1.692 1.66 2.042.743.35 1.03.584.972.934 0 .524-.572.758-1.143.758a4.789 4.789 0 01-2.003-.467l-.343 1.633c.687.292 1.43.409 2.117.409 2.117.058 3.432-.992 3.432-2.567 0-1.983-2.69-2.1-2.69-2.974zm9.497 5.482l-1.545-7.583h-1.659a.863.863 0 00-.801.583l-2.86 7h2.002l.4-1.108h2.46l.23 1.108H28.6zm-2.917-5.54l.571 2.857h-1.602l1.03-2.858z",fill:"#172B85"})]})})},54497:(e,t,n)=>{n.d(t,{t:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("warning",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{d:"M1.619 12.581h9.96c.983 0 1.618-.73 1.618-1.625 0-.266-.07-.54-.21-.793L7.998 1.25a1.593 1.593 0 00-2.8 0L.217 10.163c-.14.26-.216.527-.216.793 0 .895.635 1.625 1.619 1.625zm4.989-4.367c-.375 0-.59-.21-.603-.584l-.089-3.174c-.013-.394.267-.666.686-.666.406 0 .704.279.691.672l-.101 3.162c-.013.387-.222.59-.584.59zm0 2.196c-.432 0-.787-.31-.787-.73 0-.419.349-.73.787-.73.432 0 .78.311.78.73 0 .425-.355.73-.78.73z"})})},98616:(e,t,n)=>{n.d(t,{A:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("whimsical",{viewBox:"0 0 32 32",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{opacity:".8",fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#A7A6A2"}),(0,i.jsx)("mask",{id:"a",maskUnits:"userSpaceOnUse",x:"3",y:"7",width:"19",height:"19",children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#fff"})}),(0,i.jsx)("g",{filter:"url(#filter0_d)",mask:"url(#a)",children:(0,i.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#000",fillOpacity:".01"})}),(0,i.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#A7A6A2"}),(0,i.jsx)("defs",{children:(0,i.jsxs)("filter",{id:"filter0_d",x:"8.055",y:"4.964",width:"22.98",height:"23.071",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,i.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,i.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,i.jsx)("feOffset",{}),(0,i.jsx)("feGaussianBlur",{stdDeviation:"1.018"}),(0,i.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.6 0"}),(0,i.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow"}),(0,i.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})]})})]})})},74229:(e,t,n)=>{n.d(t,{H1:()=>o});n(57658);const o={is:e=>i(e),async*fromValues(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];yield*t},async collect(e){const t=[];for await(const n of e)t.push(n);return t},async*withIndex(e){let t=0;for await(const n of e)yield[t,n],t++},async*chunk(e,t){let n=[];for await(const o of e)n.push(o),n.length>=t&&(yield n,n=[]);n.length>0&&(yield n)},async*map(e,t){for await(const n of e)yield t(n)},async*concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const o of t)yield*o},async*filter(e,t){for await(const n of e){t(n)&&(yield n)}},withSideEffect:(e,t)=>Object.assign({},e,{async*[Symbol.asyncIterator](){for await(const n of e)await t(n),yield n}})};function i(e){return Symbol.asyncIterator in e}},25718:(e,t,n)=>{n.d(t,{Lk:()=>D,wB:()=>C,dx:()=>I,c8:()=>$,lM:()=>Q,on:()=>Y,CK:()=>q,WB:()=>R});n(57658);var o=n(67266),i=n.n(o),r=n(41432),a=n(80951),s=n(7057),l=n(14215),c=n(95538),d=n(64962),u=n(61075),p=n(64572),m=n(22808),f=n(72126),g=n(59753),h=n(21202);var v=n(19233),b=n(606),y=n(70279),S=n(19889),_=n(70203);n(29477);var w=n(97880),k=n(7928);function I(e){const t=_.J7s(e);return"a"===t?"[":"b"===t?"**":"i"===t?"*":"c"===t?"`":"s"===t?"~~":"e"===t?"$":""}function C(e,t,n){const o=_.J7s(e);if(_.j0F(e)){const o=_.zW$(e),i=(0,p.A5)({...n,url:o});return`](${(i?t({toPageId:i}):o)||""})`}return"b"===o?"**":"i"===o?"*":"c"===o?"`":"s"===o?"~~":"e"===o?"$":""}function x(e){const{annotation:t,exportArgs:n}=e,{getRecordValue:o,userTimeZone:i,getExportedPathToPage:r,intl:a,transformAnnotation:l}=n;if(l){const e=l(t,n);if("string"==typeof e)return e}if(_.IWo(t)){const e=_.zEN(t),n=o({table:S.KJ,id:e});return`@${(0,k.Nz)(a,n)}`}if(_.STW(t)){const e=_.TOT(t),i=o({table:h.iU,id:e});if(i){return`[${R({block:i,exportArgs:n})}](${r({toPageId:e})})`}}else{if(_.K$_(t)){var c;const e=_.r3j(t),i=o({table:y.x_,id:e,spaceId:n.root.spaceId});return null==i||null===(c=i.text)||void 0===c?void 0:c.toString()}if(_.fpG(t)){const{date_format:e,time_format:o,...r}=_.zyO(t);return(0,s.ZV)({value:r,date_format:e,time_format:o,userTimeZone:i,allowRelativeDates:!1,intl:n.intl})}if(_.kuv(t))return _.xey(t);if(_._bk(t)){const e=(0,u.kF)({annotation:t,exportArgs:n});if(e)return e}else{if(_.nSN(t)){var d;const e=_.frW(t);return null===(d=o({table:h.iU,id:e,spaceId:n.root.spaceId}))||void 0===d||null===(d=d.format)||void 0===d?void 0:d.original_url}if(_.OU5(t)){const{number:e}=_.Vv0(t);return`(${e})`}if(_.inx(t)||_.j0F(t)||_.aC4(t)||_.xw5(t)||_.pV3(t)||_.STW(t)||_.rIb(t)||_.LAI(t)||_.fTS(t)||_.aq(t)||_.QVC(t)||_.uge(t)||_.Lyt(t)||_.wjk(t)||_.OU5(t))return;(0,w.t1)(t)}}}const T=e=>{const t=/^\s+/.exec(e);return t?t[0]:""},M=e=>{const t=/\s+$/.exec(e);return t?t[0]:""},P=e=>{const t=M(e);return t.length>0?e.slice(0,-1*t.length):e},A=e=>{const t=T(e);return e.slice(t.length)};function R(e){const{block:t,exportArgs:n}=e;return q({textValue:_.lzi(g.kk.fromBlock(t).getProperties().title),exportArgs:n})}function D(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n,i=t&&t.content?t.content:[];return f.oA(f.UI(i,(t=>z({block:o({table:h.iU,id:t}),exportArgs:{...n,blockId:t},visitedBlock:e.visitedBlock}))))}function B(e){return e.split("\n")}function E(e){const{block:t,exportArgs:n}=e,o=_.lzi(g.kk.fromBlock(t).getProperties().caption);return o.length>0?[{text:q({textValue:o,exportArgs:n}),breakLines:!0,children:[]}]:[]}function F(e){const{block:t,exportArgs:n}=e;return q({textValue:_.lzi(g.kk.fromBlock(t).getProperties().caption),exportArgs:n})}function Z(e){return{text:"",breakLines:!0,children:D(e)}}function L(){}function j(e){const{block:t,exportArgs:n}=e;return{text:`# ${R({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:D(e)}}function V(e){const{block:t,exportArgs:n}=e;return{text:`- ${R({block:t,exportArgs:n}).trim()}`,breakLines:!1,childrenPrefix:H,children:D(e)}}function U(e){const{block:t,exportArgs:n}=e,{getExportedRenderAsset:o}=n,{source:i}=g.kk.fromBlock(t).getProperties(),r=_.QaF(i),a=o({fromBlockId:n.blockId,toFileURI:r});return{text:`[${F(e)||R({block:t,exportArgs:n})||a}](${a})`,breakLines:!0,children:E(e)}}function O(e){const{block:t,exportArgs:n}=e,{getRecordValue:o,getExportedPathToPage:i,userTimeZone:r,intl:a}=n;if("collection_view"===t.type||"collection_view_page"===t.type){return{text:`[${(0,u.Ho)({blockId:t.id,getRecordValue:o,userTimeZone:r,intl:a})}](${i({toPageId:t.id,exportFileExt:".csv"})})`,breakLines:!0,children:[]}}}const N={text:function(e){const{block:t,exportArgs:n}=e;return{text:R({block:t,exportArgs:n}),breakLines:!0,children:D(e)}},header:j,sub_header:function(e){const{block:t,exportArgs:n}=e;return{text:`## ${R({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:D(e)}},sub_sub_header:function(e){const{block:t,exportArgs:n}=e;return{text:`### ${R({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:D(e)}},quote:function(e){const{block:t,exportArgs:n}=e;return{text:`> ${R({block:t,exportArgs:n}).trim()}`,breakLines:!0,childrenPrefix:"> ",children:D(e)}},bulleted_list:V,toggle:V,to_do:function(e){const{block:t,exportArgs:n}=e;let o;return o=a.Ml(g.kk.fromBlock(t).getProperties().checked)?"- [x] ":"- [ ] ",{text:`${o} ${R({block:t,exportArgs:n}).trim()}`,breakLines:!1,childrenPrefix:H,children:D(e)}},numbered_list:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;return{text:`${function(e){const{block:t,getRecordValue:n}=e,o=t.parent_id,i=n({table:h.iU,id:o});let a;a=i?f.oA(f.UI(i.content,(e=>n({table:h.iU,id:e})))):[];const s=f.cx(a,(e=>e.id===t.id)),l=f.tP(a,0,s),c=f.qr(l,(e=>e.type!==r.Ti.numberedList));return l.length-(c+1)}({block:t,getRecordValue:o})+1}. ${R({block:t,exportArgs:n})}`,breakLines:!1,childrenPrefix:H,children:D(e)}},code:function(e){const{block:t,exportArgs:n}=e,o=R({block:t,exportArgs:n});return{text:`${`\`\`\`${t.properties&&t.properties.language?function(e){const t=_.QaF(e);if(!t)return"";const n=v.W[t];return void 0===n||n===v.W["Plain Text"]?"":n}(t.properties.language):""}\n${B(o).join("\n")}\n\`\`\``}`,breakLines:!0,children:[]}},page:function(e){const{block:t,exportArgs:n}=e;if(t.id===n.navigableBlockId&&!n.renderParentBlockId)return j(e);const{getExportedPathToPage:o}=n;return{text:`[${R({block:t,exportArgs:n})}](${o({toPageId:t.id})})`,breakLines:!0,children:[]}},image:function(e){const{block:t,exportArgs:n}=e,{getExportedRenderAsset:o}=n,{source:i}=g.kk.fromBlock(t).getProperties(),r=_.QaF(i),a=o({fromBlockId:n.blockId,toFileURI:r}),s=F(e)||R({block:t,exportArgs:n})||a;return{text:(0,c.SR)({url:r})?`![${s}](${a})`:`[${s}](${a})`,breakLines:!0,children:E(e)}},video:U,embed:U,bookmark:function(e){const{block:t,exportArgs:n}=e,{link:o}=g.kk.fromBlock(t).getProperties(),i=a.zB(o);return{text:`[${R({block:t,exportArgs:n})}](${i})`,breakLines:!0,children:E(e)}},file:U,external_object_instance:function(e){var t;const{block:n}=e,o=null===(t=n.format)||void 0===t?void 0:t.original_url;if(o)return{text:`[${o}](${o})`,breakLines:!0,children:[]}},tweet:U,maps:U,gist:U,framer:U,invision:U,mixpanel:U,drive:function(e){const{block:t}=e;if(t.format&&t.format.drive_properties){const{url:e,title:n}=t.format.drive_properties;return{text:`[${n}](${e})`,breakLines:!0,children:[]}}return U(e)},figma:U,loom:U,pdf:U,typeform:U,codepen:U,audio:U,divider:function(){return{text:"---",breakLines:!0,children:[]}},equation:function(e){const{block:t}=e;let n="";return t&&t.properties&&t.properties.title&&(n=_.QaF(t.properties.title)),{text:`$$\n${n}\n$$`,breakLines:!0,children:[]}},collection_view:O,collection_view_page:O,column_list:Z,column:Z,factory:L,personal_home_page:L,copy_indicator:L,breadcrumb:L,link_to_collection:L,link_to_page:L,callout:function(e){var t;const{block:n,exportArgs:o}=e,i=R({block:n,exportArgs:o}),r=null===(t=n.format)||void 0===t?void 0:t.page_icon;return{text:`${(0,m.Z)(r)?r:"string"==typeof r?function(e){let{source:t,width:n=40,exportArgs:o}=e;const{getExportedRenderAsset:i}=o,r=i({fromBlockId:o.blockId,toFileURI:t});return`<img src="${r}" alt="${r}" width="${n}px" />`}({source:r,exportArgs:o}):""} ${i}`.trim(),breakLines:!0,children:D(e),htmlTag:"aside"}},table_of_contents:L,whimsical:U,miro:U,abstract:U,sketch:U,excalidraw:U,replit:U,hex:U,deepnote:U,alias:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;if(t.format&&t.format.alias_pointer&&(0,b.$O)(t.format.alias_pointer,h.iU)){const i=o(t.format.alias_pointer);if(i)return z({block:i,exportArgs:{...n,renderParentBlockId:t.id,blockId:t.format.alias_pointer.id},visitedBlock:e.visitedBlock})}},transclusion_container:Z,transclusion_reference:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;if(t.format&&t.format.transclusion_reference_pointer){const i=o(t.format.transclusion_reference_pointer);if(i)return z({block:i,exportArgs:{...n,renderParentBlockId:t.id,blockId:t.format.transclusion_reference_pointer.id},visitedBlock:e.visitedBlock})}},table:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:i}=o,r=(null===(t=n.format)||void 0===t||null===(t=t.table_block_column_order)||void 0===t?void 0:t.length)||0,a=n.content,s={text:"",breakLines:!0,children:[]};if(0===r||!a)return s;const l=a.map((t=>{const r=i({table:h.iU,id:t});return r&&z({block:r,exportArgs:{...o,blockId:t,renderParentBlockId:n.id},visitedBlock:e.visitedBlock})||s})),c={text:`| ${[...Array(r).keys()].map((()=>"---")).join(" | ")} |`,breakLines:!1,children:[]};return{text:"",breakLines:!0,children:[l[0],c,...l.slice(1)]}},table_row:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:i,renderParentBlockId:r}=o;if(!r)return;const s=i({table:h.iU,id:r}),l=null==s||null===(t=s.format)||void 0===t?void 0:t.table_block_column_order;if(!l)return;return{text:`| ${l.map((t=>{const o=a.wS(n,t);return o?(0,u.hJ)({textValue:o,fromString:e=>e,exportArgs:e.exportArgs,renderers:d.O}).join(""):void 0})).join(" | ")} |`,breakLines:!1,children:[]}},tab:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:i}=o;return{text:`${f.oA(null===(t=n.content)||void 0===t?void 0:t.flatMap((e=>{const t=i({table:h.iU,id:e});if(t)return[R({block:t,exportArgs:o}),W(D({block:t,exportArgs:o})).trim()]}))).join("\n\n")}\n\t\t`,breakLines:!0,children:[]}},external_object_instance_page:L,button:L,ai_block:Z,drawing:L};function z(e){const{block:t,forceRenderAsText:n,exportArgs:{transformBlockMapping:o}}=e;if(t&&t.type){if(e.visitedBlock){if(e.visitedBlock.has(t.id))return;e.visitedBlock.add(t.id)}const i=n&&r.wL[t.type]?(null==o?void 0:o.text)??N.text:(null==o?void 0:o[t.type])??N[t.type];if(i)return i(e)}}const H="    ";function W(e){let t="";for(const n of e){n.breakLines&&(t+="\n"),n.htmlTag&&(t+=`<${n.htmlTag}>\n`),n.text&&(t+=`${n.text}\n`),n.breakLines&&(t+=n.childrenPrefix?`${n.childrenPrefix}\n`:"\n");let e=W(n.children);if(e&&n.childrenPrefix){const t=B(e);e=[...t.slice(0,-1).map((e=>n.childrenPrefix+e)),...t.slice(-1)].join("\n")}t+=`${e}`,n.htmlTag&&(t+=`</${n.htmlTag}>\n\n`),n.suffix&&(t+=`${n.suffix}\n\n`)}return t=t.replace(/[\n]{3,}/g,"\n\n"),t}function q(e){const{textValue:t,exportArgs:n}=e;let o="";const r=_.lzi(t);let a=[];for(const c of r){const e=_.hDy(c),t=(0,l.N)(a,e,(e=>i()(e))),r=_.WiV(c),s=e.map((e=>x({annotation:e,exportArgs:n}))).find((e=>Boolean(e)))||r,d=M(o);o=P(o),t.deleted.reverse();for(const i of t.deleted)o+=C(i,n.getExportedPathToPage,n);o+=d,o+=T(s);for(const n of t.created)o+=I(n);o+=A(s);a=[...f.DY(a,e,((e,t)=>f.Xy(e,t))),...t.created]}const s=M(o);o=P(o),a.reverse();for(const i of a)o+=C(i,n.getExportedPathToPage,n);return o+=s,o}function G(e,t){const n=(new e).match(t)||[];if(0===n.length)return t;let o="",i=0;for(const r of n){const e=0===r.index||"<"!==t[r.index-1],n=r.lastIndex===t.length||">"!==t[r.lastIndex],a=Boolean(t.slice(r.index).match(/^[a-z][a-z]+:/i)),s=e&&n&&a;o+=t.slice(i,r.index),s&&(o+="<"),o+=r.raw,s&&(o+=">"),i=r.lastIndex}return o+=t.slice(i),o}function K(e){return e.replace(/\\/g,"\\\\")}const $=e=>{const{MarkdownIt:t,LinkifyIt:n,markdown:o,plugin:i}=e,r=new t({linkify:!0});return i&&r.use(i),r.render(K(G(n,o)))},Q=e=>{const{MarkdownIt:t,LinkifyIt:n,markdown:o,plugin:i}=e,r=new t({linkify:!0});return i&&r.use(i),r.renderInline(K(G(n,o)))};function Y(e,t){const n=new Set;return W(f.oA(e.map((e=>z({block:e,exportArgs:{...t,blockId:e.id},visitedBlock:n}))))).trim()}},44615:(e,t,n)=>{n.d(t,{Cy:()=>v,JK:()=>x,JY:()=>g,Lp:()=>b,Mv:()=>_,NP:()=>k,Ns:()=>S,T0:()=>I,ZS:()=>p,bS:()=>h,e7:()=>T,jY:()=>f,je:()=>y,pD:()=>C,pb:()=>w,pz:()=>m});var o=n(606),i=n(21202),r=n(6287),a=n(13493),s=n(80396),l=n(15047),c=n(77858),d=n(29369);const u={[l.bx]:!0,[i.iU]:!0,[a.n]:!0,[r.v]:!0,[c.zU]:!0,[d.e0]:!0,[s.yo]:!0};function p(e){return(0,o.UI)(e.table)&&!(e.table in u)?`versions/${e.id}:${e.table}:${e.spaceId}`:`versions/${e.id}:${e.table}`}function m(e){const t=e.indexOf("/");if(-1===t)return;const n=e.substring(t+1).split(":");return 2===n.length?o.dr.fromPointerLike({table:n[1],id:n[0]}):3===n.length?o.dr.fromPointerLike({table:n[1],id:n[0],spaceId:n[2]}):void 0}function f(e){return`collection/${e}`}function g(e){return`typedDatabasesListChanged/${e.spaceId}-${e.databaseType}`}function h(e){return`activity/${e}`}function v(e){return`activity/${e}`}function b(e){return`notification/${e}`}function y(e){return`teams_in_space/${e}`}function S(e){return`user_page_visit/${e}`}function _(e){return`backlinks/${e}`}function w(e){return`page_visit/${e}`}function k(e){return`user_shared_pages_in_space/${e.spaceId}-${e.userId}`}function I(e){return`presence/${e}`}function C(e){return`user_joined_teams_in_space/${e.userId}:${e.spaceId}`}function x(e){return`diagnosticPing/${e}`}function T(e){return`presence/drawing/${e}`}},56589:(e,t,n)=>{function o(e,t){return t&&e.redirect_uris.includes(t)?t:t||1!==e.redirect_uris.length?void 0:e.redirect_uris[0]}n.d(t,{_:()=>o})},82036:(e,t,n)=>{n.d(t,{_:()=>o});const o={invalid_request:"invalid_request",unauthorized_client:"unauthorized_client",access_denied:"access_denied",unsupported_response_type:"unsupported_response_type",invalid_scope:"invalid_scope",server_error:"server_error",temporarily_unavailable:"temporarily_unavailable"}},33317:(e,t,n)=>{n.d(t,{FS:()=>A,bv:()=>C,lK:()=>I,Iw:()=>M});n(21703),n(57658);var o=n(40902),i=n(53504),r=n(79317),a=n(59730),s=(n(30541),n(72126));function l(e,t){let n=Array.isArray(t)?t:[];return n=n.filter((t=>t!==e.id)),n}function c(e,t){let n=Array.isArray(t)?t:[];return n=n.filter((t=>t&&t.id&&t.id!==e.remove.id)),n}var d=n(59753),u=n(482),p=n(26825),m=n(80951),f=n(606),g=n(21202);n(70203);function h(e,t){const n=(0,m.rq)(t).filter((t=>t.id!==e.id));return(0,m.ow)(n)}function v(e,t){const n=(0,m.rq)(t),o=n.findIndex((t=>t.id===e.args.id));return o<0?{pointer:e.pointer,path:e.path,command:"removeRelation",args:{id:e.args.id,spaceId:e.args.spaceId}}:o===n.length-1?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:n[o+1].id,spaceId:e.args.spaceId}}}var b=n(76462),y=n(64684);n(68955),n(82798),n(26109);n(46227),n(4615),n(69920);n(47247);var S=n(67175),_=n(63143);const w={set:e=>e,update:(e,t)=>(t||(t={}),{...t,...e}),listBefore:function(e,t){let n=Array.isArray(t)?t:[];n=l({id:e.id},n);const o=s.cx(n,(t=>t===e.before));return o>=0?n.splice(o,0,e.id):n.unshift(e.id),n},listAfter:function(e,t){let n=Array.isArray(t)?t:[];n=l({id:e.id},n);const o=s.cx(n,(t=>t===e.after));return o>=0?n.splice(o+1,0,e.id):n.push(e.id),n},listRemove:l,listReplace:function(e,t){let n=Array.isArray(t)?t:[];return n=n.map((t=>t===e.id?e.newId:t)),n},listAfterMulti:function(e,t){const n=new Set(e.ids),o=(Array.isArray(t)?t:[]).filter((e=>!n.has(e))),i=s.cx(o,(t=>t===e.after));return i>=0?o.splice(i+1,0,...e.ids):o.push(...e.ids),o},listBeforeMulti:function(e,t){const n=new Set(e.ids),o=(Array.isArray(t)?t:[]).filter((e=>!n.has(e))),i=s.cx(o,(t=>t===e.before));return i>=0?o.splice(i,0,...e.ids):o.unshift(...e.ids),o},keyedObjectListBefore:function(e,t){let n=Array.isArray(t)?t:[];n=c({remove:{id:e.value.id}},n);const o=e.before?e.before.id:void 0,i=s.cx(n,(e=>e&&e.id&&e.id===o));return i>=0?n.splice(i,0,e.value):n.unshift(e.value),n},keyedObjectListAfter:function(e,t){let n=Array.isArray(t)?t:[];n=c({remove:{id:e.value.id}},n);const o=e.after?e.after.id:void 0,i=s.cx(n,(e=>e&&e.id&&e.id===o));return i>=0?n.splice(i+1,0,e.value):n.push(e.value),n},keyedObjectListRemove:c,keyedObjectListUpdate:function(e,t){const n=Array.isArray(t)?[...t]:[],o=s.cx(n,(t=>t&&t.id&&t.id===e.value.id));return o>=0?n[o]=e.value:n.push(e.value),n},appendActivity:o.tR,setPermissionItem:p.r2,setSingletonPermissionItem:p.co,addRelation:function(e,t){const n=(0,m.rq)(t),o={id:e.id,spaceId:e.spaceId,table:g.iU},i=f.dr.uniq([...n,o]);return(0,m.ow)(i)},addRelationAfter:function(e,t){const n=h({id:e.id,spaceId:e.spaceId},t),o=(0,m.rq)(n),i={id:e.id,spaceId:e.spaceId,table:g.iU};let r;if(e.after){const t=o.findIndex((t=>t.id===e.after));r=f.dr.uniq([...o.slice(0,t+1),i,...o.slice(t+1)])}else r=f.dr.uniq([...o,i]);return(0,m.ow)(r)},addRelationBefore:function(e,t){const n=h({id:e.id,spaceId:e.spaceId},t),o=(0,m.rq)(n),i={id:e.id,spaceId:e.spaceId,table:g.iU};let r;if(e.before){const t=o.findIndex((t=>t.id===e.before));r=f.dr.uniq([...o.slice(0,t),i,...o.slice(t)])}else r=f.dr.uniq([i,...o]);return(0,m.ow)(r)},addRelations:function(e,t){const n=s.Kn(t)?t:{},o={...n};for(const i in e){const t=e[i],r=(0,m.rq)(n[i]),a=f.dr.uniq([...r,...t.map((e=>({id:e.id,spaceId:e.spaceId,table:g.iU})))]);o[i]=(0,m.ow)(a)}return o},removeRelation:h,copyFile:(e,t)=>{const n=t.file_ids||[];return n.includes(e.fileId)?{...t}:{...t,file_ids:[...n,e.fileId]}},removeTeamMembershipItem:y.Uk,setTeamMembershipItem:y.I6};function k(e){return void 0===e.size?1:e.size}const I=function(e,t){let n,o,r=t||{};if(n=e.path.length>0?s.U2(r,e.path):r,o=r.version?r.version+k(e):k(e),!w[e.command])throw new Error(`Unknown operation command ${e.command}.`);if(void 0!==e.expectedVersion&&r.version&&e.expectedVersion!==r.version)throw new a.vq("Mismatching expected and actual versions for the record",{clientData:{type:"operation_conflict",expectedVersion:e.expectedVersion,currentVersion:r.version,command:e.command,path:e.path,pointer:e.pointer}});n=(0,w[e.command])(e.args,n);r=e.path.length>0?function(e,t,n){if(0===t.length)throw new a.D3("Empty path to set");const o=s.d9(e);let i=o;for(let r=0;r<t.length;r++){const e=t[r];if(r===t.length-1)i[e]=n;else{let n=s.d9(i[e]);null==n&&(n="number"==typeof t[r+1]?[]:{}),i[e]=n,i=n}}return o}(r,e.path,n):n;const l=b.ZP[e.pointer.table],c=l.requiredColumns||{},d=l.defaultColumnValues||{};for(const i of Object.keys(c))!t||_.z4(t[i])||r&&!_.z4(r[i])||(d.hasOwnProperty(i)?r[i]=d[i]:r[i]=t[i]);if(r&&t){const e=t.file_ids||[];(r.file_ids||[]).length<e.length&&(r.file_ids=e)}return r=(0,i.Z)(r,"mangle-class-instances")||{},r.id=e.pointer.id,r.version=o,r},C=function(e,t){let n;switch(t=t||{},n=e.path.length>0?s.U2(t,e.path):t,e.command){case"set":return((e,t)=>({pointer:e.pointer,path:e.path,command:"set",args:_.z4(t)?null:t}))(e,n);case"update":return((e,t)=>{t||(t={});const n={};return Object.keys(e.args).forEach((e=>{n[e]=t[e],void 0===n[e]&&(n[e]=null)})),{pointer:e.pointer,path:e.path,command:"update",args:n}})(e,n);case"listBefore":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id));if(o>=0){if(o+1===n.length)return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id}};const t=n[o+1];return{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id,before:t}}}return{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,n);case"listAfter":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id));if(o>0){const t=n[o-1];return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:t}}}return 0===o?{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}:{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,n);case"listRemove":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id)),i=n[o-1];return i?{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:i}}:{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}}(e,n);case"keyedObjectListBefore":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.value.id));if(o>=0){if(o+1===n.length)return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:e.args};const t=n[o+1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value,before:{id:t.id}}}}return{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"keyedObjectListAfter":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.value.id));if(o>0){const t=n[o-1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:e.args.value,after:{id:t.id}}}}return 0===o?{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"keyedObjectListRemove":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.remove.id)),i=n[o],r=n[o-1];return i?r?{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:i,after:{id:r.id}}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:i}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:r.id}}}}(e,n);case"keyedObjectListUpdate":return function(e,t){t||(t={});const n=(Array.isArray(t)?t:[]).find((t=>t.id===e.args.value.id));return n?{pointer:e.pointer,path:e.path,command:"keyedObjectListUpdate",args:{value:n}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"addRelation":case"addRelationAfter":case"addRelationBefore":return v(e,n);case"removeRelation":return function(e,t){const n=(0,m.rq)(t),o=n.findIndex((t=>t.id===e.args.id));return o<0?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:0===o?{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:n.length>1?n[1].id:void 0,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,after:n[o-1].id,spaceId:e.args.spaceId}}}(e,n);default:return}};function x(e){let{operation:t,previousOperation:n}=e;return{...t,args:t.args,size:k(t)+k(n)}}function T(e){let{operation:t,previousOperation:n}=e;return{...t,args:{...n.args,...t.args},size:k(t)+k(n)}}function M(e){const[t,...n]=e,o=[t];for(const i of n){const e=o[o.length-1],t=s.Xy(i.pointer,e.pointer)&&s.Xy(i.path,e.path);"set"===i.command&&"set"===e.command&&t?o[o.length-1]=x({operation:i,previousOperation:e}):"update"===i.command&&"update"===e.command&&t?o[o.length-1]=T({operation:i,previousOperation:e}):o.push(i)}return o}function P(e){const{getRecordModel:t,setNewValue:n,primitiveOperation:o,updateOnly:i}=e,r=t.getRecordValue(o.pointer);if(!i||r){const e=I(o,r);n({pointer:o.pointer,newValue:e})}}function A(e){const{recordMap:t,operations:n,updateOnly:o}=e;n.forEach((e=>{if((0,S.Qf)(e))throw new Error("Text operations should be applied separately")})),function(e){const{getRecordModel:t,setNewValue:n,recordOperations:o,updateOnly:i}=e;for(const a of o)if((0,u.S)(a)){const e=(0,r.T1)(a,t.getRecordValue);for(const o of e)P({primitiveOperation:o,getRecordModel:t,setNewValue:n,updateOnly:i})}else P({primitiveOperation:a,getRecordModel:t,setNewValue:n,updateOnly:i})}({getRecordModel:d.om.fromRecordMap(t),setNewValue:e=>{const{pointer:n,newValue:o}=e;t.setValue(n,o)},recordOperations:n,updateOnly:o})}},69246:(e,t,n)=>{n.d(t,{PT:()=>a,cz:()=>r,fY:()=>l,g$:()=>s,kg:()=>o,mu:()=>i});const o="teamSidebar",i="teamBrowserSearch",r="teamBrowserUnjoinedTeams",a="teamBrowserJoinedTeams",s="publicPageTemplateIncludes";function l(e){const{block:t,query:n,getRecordModel:o,userTimeZone:i,intl:r}=e;if(!n)return!0;const a=null==t?void 0:t.getRenderTitle({getRecordModel:o,userTimeZone:i,intl:r});return!!a&&a.toLowerCase().indexOf(n.trim().toLowerCase())>=0}},26825:(e,t,n)=>{n.d(t,{D3:()=>pe,FD:()=>re,GU:()=>G,Gx:()=>ce,IF:()=>B,IJ:()=>S,J3:()=>le,KJ:()=>C,Kf:()=>I,L2:()=>Q,N0:()=>K,OC:()=>L,Rh:()=>oe,SL:()=>R,Ub:()=>X,WM:()=>ie,Wo:()=>$,Xr:()=>ee,YO:()=>V,ZO:()=>y,_G:()=>J,aG:()=>te,cJ:()=>me,co:()=>k,gr:()=>D,kD:()=>de,mq:()=>ae,nl:()=>x,oF:()=>T,qY:()=>z,r2:()=>w,uH:()=>ne,uq:()=>ue,ws:()=>_,xO:()=>E,yY:()=>A,zX:()=>U});n(57658),n(21703);var o=n(41432),i=n(15070),r=n(72126),a=n(59753),s=n(5366),l=n(63306),c=n(27006),d=n(45953),u=n(21202),p=n(77420),m=n(33709),f=n(15047),g=n(29369),h=n(19889),v=(n(47425),n(64684)),b=n(97880);function y(e){const{actor:t,ancestors:n,updatedPermissionItem:o}=e;return z({actorPointer:t&&t.pointer,ancestors:n,permissionsContext:se({recordMap:void 0})}).some((e=>{const t=I(e.permissionItem,o)?o.role:e.permissionItem.role;return!!t&&(0,c.zz)(t)}))}function S(e){const{actor:t,ancestors:n}=e,o=z({actorPointer:t&&t.pointer,ancestors:n,permissionsContext:se({recordMap:void 0})});if(1===o.length){const e=o[0];if((0,c.$D)(e.permissionItem)&&(0,c.YX)(e.permissionItem.role))return e}}function _(e,t){return e.some((e=>"user_permission"===e.type&&e.user_id===t))}function w(e,t){let n=t||[];if("public_permission"===e.type){const t=n.filter((e=>(0,c.$D)(e))).map((e=>e.added_timestamp||0));t.length>0?e.added_timestamp=Math.min(...t):e.added_timestamp=(new Date).getTime()}return n=n.filter((t=>!I(t,e))),n.push(e),n=n.filter((e=>!(0,c.C2)(e)||"none"!==(0,c.cY)(e))),n}function k(e,t){const{singletonPermissionItem:n,set:o}=e;let i=t||[];return i=i.filter((e=>!I(e,n))),o&&i.push(n),i}function I(e,t){return!(!e||!t)&&((0,c.jg)(e)&&(0,c.jg)(t)||(0,c.e_)(e)&&(0,c.e_)(t)?e.user_id===t.user_id:(0,c.FB)(e)&&(0,c.FB)(t)?e.bot_id===t.bot_id:(0,c.hV)(e)&&(0,c.hV)(t)?e.group_id===t.group_id:(0,c.LW)(e)&&(0,c.LW)(t)||(0,c.zU)(e)&&(0,c.zU)(t)?e.team_id===t.team_id:e.type===t.type)}function C(e){return(0,l.gc)(e).map((e=>{if(e.table===u.iU){const t=a.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,n=a.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:u.iU,blockId:n},permissions:t}}else if(e.table===g.e0){const t=a.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,n=a.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:g.e0,teamId:n},permissions:t}}})).filter(b.$K)}function x(){let e=0,t="none";for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];for(const a of o)if("string"==typeof a)e=Math.max(e,c.Av.indexOf(a));else for(const e of(0,b.Yd)(a))a[e]&&(t=P(t,e));const r=c.Av[e];return"editor"===r||"read_and_write"===r||"membership_admin"===r?r:"none"!==t&&Object.keys(t).length?("reader"!==r&&"comment_only"!==r&&"content_only_editor"!==r||(t=P(t,"read_content")),t):r}const T=(0,b.AO)((e=>"object"==typeof e?{true:e}:{false:e})),M=(0,b.AO)((e=>(0,i.pH)(e)||(0,i.Ye)(e)||"none"===e?{true:e}:{false:e}));function P(e,t){let n;return"none"===e?"read_content"===t?n={read_content:!0}:"update_content"===t?n={update_content:!0}:"insert_content"===t?n={insert_content:!0}:"read_property"===t||"update_property"===t||"insert_property"===t?n={read_property:!0}:"read_comment"===t?n={read_comment:!0}:"insert_comment"===t?n={insert_comment:!0}:(0,b.t1)(t):(n={...e},"read_content"===t?(n.read_content=!0,delete n.read_property):"update_content"===t?(n.update_content=!0,delete n.update_property):"insert_content"===t?(n.insert_content=!0,delete n.insert_property):"read_property"===t?n.read_content||(n.read_property=!0):"update_property"===t?n.update_content||(n.update_property=!0):"insert_property"===t?n.insert_content||(n.insert_property=!0):"read_comment"===t?n.read_comment=!0:"insert_comment"===t?n.insert_comment=!0:(0,b.t1)(t)),n}function A(e,t){if("string"==typeof e&&"string"==typeof t)return B(e,t);if("string"==typeof e){if("editor"===e||"membership_admin"===e)return!0;e=c.jD[e]}if("string"==typeof t){if("editor"===t||"membership_admin"===t)return!1;t=c.jD[t]}return function(e,t){if("none"===t)return!0;if("none"===e)return!1;let n=!0;for(const o of(0,b.Yd)(t))"read_property"===o?n&&=e.read_property||e.read_content:"update_property"===o?n&&=e.update_property||e.update_content:"insert_property"===o?n&&=e.insert_property||e.insert_content:"read_content"===o?n&&=e.read_content:"update_content"===o?n&&=e.update_content:"insert_content"===o?n&&=e.insert_content:"read_comment"===o?n&&=e.read_comment:"insert_comment"===o?n&&=e.insert_comment:"link_preview"===o||"synced_database"===o||(0,b.t1)(o);return Boolean(n)}(e,t)}function R(e,t){return c.Av.indexOf(e)<=c.Av.indexOf(t)}function D(e,t){return c.Av.indexOf(e)<c.Av.indexOf(t)}function B(e,t){return c.Av.indexOf(e)>=c.Av.indexOf(t)}function E(e,t){return c.Av.indexOf(e)>c.Av.indexOf(t)}function F(e,t){return void 0!==e&&e||void 0!==t&&t}function Z(e){const{inheritedPermissionToCompare:t,mostPermissivePermissionLoose:n}=e,o=n;if((0,c.KF)(o.permissionItem)&&!(0,c.KF)(t.permissionItem))return t;const i=o.permissionItem.role,r=x(i,t.permissionItem.role),a=r!==i?t:o;return{from:a.from,permissionItem:{...a.permissionItem,role:r}}}function L(e){return e?(0,c.jg)(e)||(0,c.e_)(e)?`${e.type}:${e.user_id}`:(0,c.FB)(e)?`${e.type}:${e.bot_id}`:(0,c.hV)(e)?`${e.type}:${e.group_id}`:(0,c.zU)(e)||(0,c.LW)(e)?`${e.type}:${e.team_id}`:e.type:""}function j(e){return 1===e.length?e[0]:e.reduce(((e,t)=>{if(!I(e.permissionItem,t.permissionItem))throw Error("Items should be grouped by target, but given items have different targets");return(0,c.jg)(t.permissionItem)||(0,c.e_)(t.permissionItem)||(0,c.ix)(t.permissionItem)||(0,c.bm)(t.permissionItem)||(0,c.RI)(t.permissionItem)||(0,c.ZQ)(t.permissionItem)||(0,c.hV)(t.permissionItem)||(0,c.FB)(t.permissionItem)?Z({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,c.$D)(t.permissionItem)?function(e){const{mostPermissivePermissionLoose:t,inheritedPermissionToCompare:n}=e,o=Z({mostPermissivePermissionLoose:t,inheritedPermissionToCompare:n});var i,r,a,s;return o.permissionItem={...o.permissionItem,allow_duplicate:(a=o.permissionItem.allow_duplicate,s=n.permissionItem.allow_duplicate,void 0===a||a||void 0===s||s),allow_search_engine_indexing:F(o.permissionItem.allow_search_engine_indexing,n.permissionItem.allow_search_engine_indexing),expiration_timestamp:(i=o.permissionItem.expiration_timestamp,r=n.permissionItem.expiration_timestamp,i&&r?Math.max(i,r):i||r)},o}({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,c.gG)(t.permissionItem)?{...e,from:t.from}:(0,c.Le)(t.permissionItem)?e:void(0,b.t1)(t.permissionItem)}),e[0])}function V(e){const t=r.xH(e.map((e=>{const{permissions:t,from:n}=e;return t.map((e=>({from:n,permissionItem:e})))})));t.reverse();const n=r.vM(t,(e=>L(e.permissionItem))),o=r.Q8(n,j),i=new Set,a=[];for(const r of t){const e=L(r.permissionItem);i.has(e)||(i.add(e),a.push(o[e]))}const s=a.find((e=>(0,c.gG)(e.permissionItem)));return s?[s]:a}function U(e){return e.table===f.bx}function O(e){return e.table===f.bx}function N(e){return e.table===g.e0}function z(e){const{actorPointer:t,ancestors:n,permissionsContext:o}=e;if((0,l.GR)(n))return[];let i=e.ignorePublicPermissions;i||(0,l.Zg)(n)||(i=!0);const r=n.find(O),[a,s,d]=r?[r.__IM_SORRY__getValue(),r.getPermissionItems(),r.getPermissionGroups()]:[null,[],[]],f=(null==t?void 0:t.table)===h.KJ&&t,g=(null==t?void 0:t.table)===p.cZ&&t,b=g&&g.id,y=n.find(N),S=y?y.__IM_SORRY__getValue():null;if(g&&g.spaceId&&a&&a.id!==g.spaceId)return[];g&&!i&&(i=!0);const _=f&&f.id,w=_?d.filter((e=>e.user_ids&&e.user_ids.includes(_))).reduce(((e,t)=>(e.add(t.id),e)),new Set):new Set,k=V(C(n).map((e=>{const{permissions:t,from:n}=e;return{from:n,permissions:t.filter((e=>{if((0,c.jg)(e)||(0,c.e_)(e))return e.user_id===_;if((0,c.FB)(e))return e.bot_id===b;if((0,c.hV)(e))return w.has(e.group_id);if((0,c.Ix)(e))return Boolean(_&&S&&a&&(0,v.AL)({userId:_,team:S,space:a,groupIdsThatIncludeUser:w}));if((0,c.KK)(e))return Boolean(S&&f&&(0,v.pd)(S,f.id));if((0,c.zU)(e)){const t=q({team:S,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(_&&t&&a&&(0,v.AL)({userId:_,team:t,space:a,groupIdsThatIncludeUser:w}))}if((0,c.LW)(e)){const t=q({team:S,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(t&&f&&(0,v.pd)(t,f.id))}if((0,c.bm)(e)){const t=q({team:S,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(_&&t&&a&&(0,v.s8)({userId:_,team:t}))}return!0}))}}))),I=K({spacePermissions:s,userId:_||void 0,botId:b||void 0}),x=(0,l.Zg)(n),T=n.some((e=>Boolean(e.table===m.qF&&e.resolved)));return k.filter((e=>{const{permissionItem:t}=e;if(!(0,c.C2)(t))return!1;if((!x||T)&&(0,c.rz)(t.role)&&!(0,c.FB)(t))return!1;if(((0,c.jg)(t)||(0,c.e_)(t))&&t.user_id===_)return!0;if((0,c.FB)(t)&&t.bot_id===b)return!0;if((0,c.Ix)(t))return Boolean(_&&S&&a&&(0,v.AL)({userId:_,team:S,space:a,groupIdsThatIncludeUser:w}));if((0,c.KK)(t))return Boolean(S&&f&&(0,v.pd)(S,f.id));if((0,c.zU)(t)){const e=q({team:S,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(_&&e&&a&&(0,v.AL)({userId:_,team:e,space:a,groupIdsThatIncludeUser:w}))}if((0,c.bm)(t)){const e=q({team:S,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(_&&e&&a&&(0,v.s8)({userId:_,team:e}))}if((0,c.LW)(t)){const e=q({team:S,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(e&&f&&(0,v.pd)(e,f.id))}return!(!(0,c.ix)(t)||!I)||(!(i||!(0,c.$D)(t)||(0,c.o7)(t))||!!((0,c.hV)(t)&&I&&w.has(t.group_id)))})).map((e=>{const{from:t,permissionItem:o}=e,[i,r]=n;if("content_only_editor"===o.role){if(t.table!==u.iU)return W(n,t,e,o);if(!H(t,i)&&!H(t,r))return W(n,t,e,o);if(r&&r.table===t.table&&"collection"!==i.table&&"collection_view"!==i.table&&r.hasWikiBlockUri())return W(n,t,e,o)}return e}))}function H(e,t){return!!t&&(t.table===e.table&&t.id===e.blockId)}function W(e,t,n,i){return function(e,t){if(t.table!==u.iU)return!1;const n=e.findIndex((e=>e.table===u.iU&&e.type===o.Ti.page&&e.is_template));if(n<0)return!1;const i=e[n+2];if(!i)return!1;if(i.table!==u.iU)return!1;return i.isType(o.pg)&&i.id===t.blockId}(e,t)?{...n,permissionItem:{...i,role:"comment_only"}}:{...n,permissionItem:{...i,role:"read_and_write"}}}function q(e){var t;let{team:n,permissionItem:o,spaceId:i,permissionsContext:r}=e;if(n&&n.id===o.team_id)return n;const a={table:g.e0,id:o.team_id,spaceId:i};let s=null===(t=r.explicitTeamsRecordMap)||void 0===t?void 0:t.get(a);return s||(s=r.originalRecordMap.getValue(a)),s}function G(e){const{spacePermissions:t,userId:n}=e;return t.some((e=>(0,c.jg)(e)&&e.user_id===n&&(0,c.J5)(e.role)))}function K(e){const{spacePermissions:t,userId:n,botId:o}=e;return t.some((e=>{const t=(0,c.jg)(e)&&e.user_id===n&&(0,c.J5)(e.role),i=(0,c.FB)(e)&&e.bot_id===o&&(0,c.J5)(e.role),r=(0,c.jg)(e)&&e.user_id===n&&(0,c.Bc)(e.role);return t||i||r}))}function $(e){return V(C(e)).map((e=>{let{permissionItem:t}=e;return t}))}function Q(e,t){const n=[],o=[],i=[],r=[],a={};for(const s of e){a[L(s)]=s}for(const s of t){const e=L(s);if(a[e]){const t=a[e];(0,c.C2)(t)&&(0,c.C2)(s)&&t.role!==s.role?i.push([t,s]):r.push(s),delete a[e]}else n.push(s)}for(const s of Object.values(a))o.push(s);return{created:n.sort(J),deleted:o.sort(J),changed:i.sort(J),unchanged:r.sort(J)}}function Y(e){return Array.isArray(e)?e[0].type:e.type}function J(e,t){return c.UF.indexOf(Y(e))-c.UF.indexOf(Y(t))}function X(e,t,n){const o=Q(t,n),i=o.unchanged.filter((e=>(0,c.C2)(e)));for(const[s,l]of o.changed){const t=x(s.role,l.role);e.isCollectionView()||"read_and_write"!==s.role||"content_only_editor"!==l.role?s.role!==l.role&&s.role!==t&&i.push(s):i.push(s)}const r=[];for(const s of i){const t={pointer:e.pointer,command:"setPermissionItem",path:["permissions"],args:{...s,role:"none"}};r.push(t)}const a={pointer:e.pointer,command:"setSingletonPermissionItem",path:["permissions"],args:{singletonPermissionItem:{type:"restricted_permission"},set:!1}};return r.push(a),r}function ee(e,t){const n=[],o=Q(e,t);for(const i of o.created)if((0,c.C2)(i)){const e={...i,role:"none"};n.push([e,i])}for(const[i,r]of o.changed){const e=x(i.role,r.role);("content_only_editor"===r.role&&"read_and_write"===i.role||i.role!==e)&&n.push([i,r])}return n}function te(e){const t=a.kk.isAnyModel(e)?e.getPermissionItems():e.permissions;return r.oA((t||[]).map((e=>{if((0,c.jg)(e)&&(0,c.Jy)(e.role))return{userId:e.user_id,role:e.role}})))}function ne(e){if(e){const{read_user_without_email:t,read_user_with_email:n,inherit_creator_permissions:o,link_preview:i,synced_database:r,webhooks:a,workspace_search:s,workspace_page_export:l,...c}=e;if(M(c))return c}return"none"}function oe(e){if(!e)return{};const{read_user_with_email:t,read_user_without_email:n}=e;return n&&t?{read_user_without_email:n,read_user_with_email:t}:n?{read_user_without_email:n}:{}}function ie(e){if(!e)return{};const{link_preview:t,synced_database:n}=e;return t&&n?{link_preview:t,synced_database:n}:t?{link_preview:t}:{}}function re(e){return Boolean(e&&e.inherit_creator_permissions)}const ae=(0,s.defineMessages)({adminLabel:{id:"userPermissionsMenu.adminItem.label",defaultMessage:"Admin"},adminCaption:{id:"userPermissionsMenu.adminItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},workspaceOwnerLabel:{id:"userPermissionsMenu.workspaceOwnerItem.label",defaultMessage:"Workspace owner"},workspaceOwnerCaption:{id:"userPermissionsMenu.workspaceOwnerItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},membershipAdminLabel:{id:"userPermissionsMenu.membershipAdminItem.label",defaultMessage:"Membership admin"},membershipAdminCaption:{id:"userPermissionsMenu.membershipAdminItem.caption",defaultMessage:"Can manage workspace and group membership."},fullAccessLabel:{id:"userPermissionsMenu.fullAccessItem.label",defaultMessage:"Full access"},fullAccessCaption:{id:"userPermissionsMenu.fullAccessItem.caption",defaultMessage:"Can edit and share with others."},memberLabel:{id:"userPermissionsMenu.memberItem.label",defaultMessage:"Member"},memberCaption:{id:"userPermissionsMenu.memberItem.caption",defaultMessage:"Cannot change workspace settings or invite new members to the workspace."},canEditLabel:{id:"userPermissionsMenu.canEditItem.label",defaultMessage:"Can edit"},canEditCaption:{id:"userPermissionsMenu.canEditItem.caption",defaultMessage:"Can edit, but not share with others."},canEditContentLabel:{id:"userPermissionsMenu.canEditContentItem.label",defaultMessage:"Can edit content"},canEditContentCaption:{id:"userPermissionsMenu.canEditContentItem.caption",defaultMessage:"Can edit content, but can't edit the database's views or structure."},canReadLabel:{id:"userPermissionsMenu.canReadItem.label",defaultMessage:"Can view"},canReadCaption:{id:"userPermissionsMenu.canReadItem.caption",defaultMessage:"Cannot edit or share with others."},canWriteLabel:{id:"userPermissionsMenu.canWriteItem.label",defaultMessage:"Can write."},canWriteCaption:{id:"userPermissionsMenu.canWriteItem.caption",defaultMessage:"Cannot read or share with others."},canCommentLabel:{id:"userPermissionsMenu.canCommentItem.label",defaultMessage:"Can comment"},canCommentCaption:{id:"userPermissionsMenu.canCommentItem.caption",defaultMessage:"Can view and comment, but not edit."},mixedAccessLabel:{id:"userPermissionsMenu.mixedAccessItem.label",defaultMessage:"Mixed access"},mixedAccessCaption:{id:"userPermissionsMenu.mixedAccessItem.caption",defaultMessage:"Has mixed access."},leaveWorkspaceLabel:{id:"userPermissionsMenu.leaveWorkspaceItem.label",defaultMessage:"Leave workspace"},removeFromWorkspaceLabel:{id:"userPermissionsMenu.removeFromWorkspaceItem.label",defaultMessage:"Remove from workspace"},removeWorkspaceLabel:{id:"userPermissionsMenu.removeWorkspaceItem.label",defaultMessage:"Remove"},disabledLabel:{id:"userPermissionsMenu.disabledItem.label",defaultMessage:"Disabled"},noAccessLabel:{id:"userPermissionsMenu.noAccessItem.label",defaultMessage:"No access"},guestLabel:{id:"userPermissionsMenu.guestItem.label",defaultMessage:"Guest"},pageGuestLabel:{id:"userPermissionsMenu.pageGuestItem.label",defaultMessage:"Page guest"},teamGuestLabel:{id:"userPermissionsMenu.teamGuestItem.label",defaultMessage:"Teamspace guest"},canAccessLabel:{id:"userPermissionsMenu.canAccessItem.label",defaultMessage:"Can access"},limitedAccessLabel:{id:"userPermissionsMenu.limitedAccessItem.label",defaultMessage:"Limited access"}});function se(e){const{recordMap:t}=e;return{originalRecordMap:t||d.Ak.create(),explicitTeamsRecordMap:void 0,type:"empty_permissions_context"}}function le(e){const{recordMap:t,explicitTeamsRecordMap:n}=e;return{originalRecordMap:t||d.Ak.create(),explicitTeamsRecordMap:n,type:"loaded_permissions_context"}}function ce(e,t){if(!e)throw new Error("Expected to have a role");if("none"===e)return{label:ae.noAccessLabel};if(t===f.bx)return{label:ae.memberLabel,caption:ae.memberCaption};if(e.read_content&&e.update_content&&e.insert_content)return{label:ae.canEditLabel,caption:ae.canEditCaption};if(e.insert_content||e.update_content||e.read_content||e.read_comment)return{label:ae.mixedAccessLabel,caption:ae.mixedAccessCaption};if(e.insert_comment)return{label:ae.canCommentLabel,caption:ae.canCommentCaption};if(e.insert_property||e.update_property||e.read_property)throw new Error("Unsupported permission role");(0,b.t1)(e)}function de(e,t){if(T(e)){const{label:n}=ce(e,t);return n}return"reader"===e?ae.canReadLabel:"editor"===e?ae.fullAccessLabel:"read_and_write"===e?ae.canEditLabel:"content_only_editor"===e?ae.canEditContentLabel:"comment_only"===e?ae.canCommentLabel:"none"===e?ae.noAccessLabel:"membership_admin"===e?ae.membershipAdminLabel:void(0,b.t1)(e)}async function ue(e){return function(e){if(e.shared_to_web)return"shared_to_web";if(e.shared_externally)return"shared_externally";if(e.shared_internally)return"shared_internally";return"private"}(await async function(e){const{permissionItems:t,spaceUserPermissions:n,hasTeamLevelGuests:o,teamHasTeamLevelGuestsCache:i}=e,r={shared_internally:!1,shared_externally:!1,shared_to_web:!1,private:!1},a=t.filter((e=>!(0,c.Le)(e)));if(1===a.length&&(0,c.jg)(a[0]))return r.private=!0,r;const s=new Set((n??[]).map((e=>{let{user_id:t}=e;return t})));for(const l of a)switch(l.type){case"user_permission":case"exclusive_user_permission":s.has(l.user_id)?r.shared_internally=!0:r.shared_externally=!0;continue;case"explicit_team_owner_permission":case"explicit_team_permission":case"explicit_team_guest_permission":const e=l.team_id;(void 0!==(null==i?void 0:i[e])?i[e]:await o(e))?r.shared_externally=!0:r.shared_internally=!0;continue;case"bot_permission":r.shared_externally=!0;continue;case"group_permission":case"space_permission":r.shared_internally=!0;continue;case"public_permission":r.shared_to_web=!0;break;case"deleted_permission":case"restricted_permission":case"team_owner_permission":case"team_permission":continue;default:(0,b.t1)(l)}return r}(e))}function pe(e){switch(e.type){case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"explicit_team_permission":return e.team_id;case"bot_permission":return e.bot_id;case"exclusive_user_permission":case"user_permission":return e.user_id;case"group_permission":return e.group_id;case"public_permission":case"team_permission":case"team_owner_permission":case"deleted_permission":case"restricted_permission":case"space_permission":return;default:(0,b.t1)(e)}}function me(e){const{permissions:t,userId:n}=e;for(const o of t)if((0,c.jg)(o)&&o.user_id===n)return o.invite_id}},19233:(e,t,n)=>{n.d(t,{W:()=>i,Y:()=>r});var o=n(20852);const i={ABAP:o.PrismLanguages.abap,Agda:o.PrismLanguages.agda,Arduino:o.PrismLanguages.arduino,Assembly:o.PrismLanguages.nasm,Bash:o.PrismLanguages.bash,BASIC:o.PrismLanguages.basic,BNF:o.PrismLanguages.bnf,C:o.PrismLanguages.c,"C#":o.PrismLanguages.csharp,"C++":o.PrismLanguages.cpp,Clojure:o.PrismLanguages.clojure,CoffeeScript:o.PrismLanguages.coffeescript,Coq:o.PrismLanguages.coq,CSS:o.PrismLanguages.css,Dart:o.PrismLanguages.dart,Dhall:o.PrismLanguages.dhall,Diff:o.PrismLanguages.diff,Docker:o.PrismLanguages.docker,EBNF:o.PrismLanguages.ebnf,Elixir:o.PrismLanguages.elixir,Elm:o.PrismLanguages.elm,Erlang:o.PrismLanguages.erlang,"F#":o.PrismLanguages.fsharp,Flow:o.PrismLanguages.flow,Fortran:o.PrismLanguages.fortran,Gherkin:o.PrismLanguages.gherkin,GLSL:o.PrismLanguages.glsl,Go:o.PrismLanguages.go,GraphQL:o.PrismLanguages.graphql,Groovy:o.PrismLanguages.groovy,Haskell:o.PrismLanguages.haskell,HTML:o.PrismLanguages.html,Idris:o.PrismLanguages.idris,Java:o.PrismLanguages.java,JavaScript:o.PrismLanguages.jsx,JSON:o.PrismLanguages.json,Julia:o.PrismLanguages.julia,Kotlin:o.PrismLanguages.kotlin,LaTeX:o.PrismLanguages.latex,Less:o.PrismLanguages.less,Lisp:o.PrismLanguages.lisp,LiveScript:o.PrismLanguages.livescript,"LLVM IR":o.PrismLanguages.llvm,Lua:o.PrismLanguages.lua,Makefile:o.PrismLanguages.makefile,Markdown:o.PrismLanguages.markdown,Markup:o.PrismLanguages.markup,MATLAB:o.PrismLanguages.matlab,Mathematica:o.PrismLanguages.mathematica,Mermaid:o.PrismLanguages.mermaid,Nix:o.PrismLanguages.nix,"Notion Formula":o.PrismLanguages.notion,"Objective-C":o.PrismLanguages.objectivec,OCaml:o.PrismLanguages.ocaml,Pascal:o.PrismLanguages.pascal,Perl:o.PrismLanguages.perl,PHP:o.PrismLanguages.php,"Plain Text":"null",PowerShell:o.PrismLanguages.powershell,Prolog:o.PrismLanguages.prolog,Protobuf:o.PrismLanguages.protobuf,PureScript:o.PrismLanguages.purescript,Python:o.PrismLanguages.python,R:o.PrismLanguages.r,Racket:o.PrismLanguages.racket,Reason:o.PrismLanguages.reason,Ruby:o.PrismLanguages.ruby,Rust:o.PrismLanguages.rust,Sass:o.PrismLanguages.sass,Scala:o.PrismLanguages.scala,Scheme:o.PrismLanguages.scheme,Scss:o.PrismLanguages.scss,Shell:o.PrismLanguages.bash,Solidity:o.PrismLanguages.solidity,SQL:o.PrismLanguages.sql,Swift:o.PrismLanguages.swift,TOML:o.PrismLanguages.toml,TypeScript:o.PrismLanguages.tsx,"VB.Net":o.PrismLanguages.vbnet,Verilog:o.PrismLanguages.verilog,VHDL:o.PrismLanguages.vhdl,"Visual Basic":o.PrismLanguages.visualBasic,WebAssembly:o.PrismLanguages.wasm,XML:o.PrismLanguages.xml,YAML:o.PrismLanguages.yaml,"Java/C/C++/C#":o.PrismLanguages.clike},r={[o.PrismLanguages.abap]:"ABAP",[o.PrismLanguages.agda]:"Agda",[o.PrismLanguages.arduino]:"Arduino",[o.PrismLanguages.bash]:"Shell",[o.PrismLanguages.basic]:"BASIC",[o.PrismLanguages.bnf]:"BNF",[o.PrismLanguages.c]:"C",[o.PrismLanguages.clojure]:"Clojure",[o.PrismLanguages.coffeescript]:"CoffeeScript",[o.PrismLanguages.coq]:"Coq",[o.PrismLanguages.cpp]:"C++",[o.PrismLanguages.csharp]:"C#",[o.PrismLanguages.css]:"CSS",[o.PrismLanguages.dart]:"Dart",[o.PrismLanguages.dhall]:"Dhall",[o.PrismLanguages.diff]:"Diff",[o.PrismLanguages.docker]:"Docker",[o.PrismLanguages.ebnf]:"EBNF",[o.PrismLanguages.elixir]:"Elixir",[o.PrismLanguages.elm]:"Elm",[o.PrismLanguages.erlang]:"Erlang",[o.PrismLanguages.flow]:"Flow",[o.PrismLanguages.fortran]:"Fortran",[o.PrismLanguages.fsharp]:"F#",[o.PrismLanguages.gherkin]:"Gherkin",[o.PrismLanguages.glsl]:"GLSL",[o.PrismLanguages.go]:"Go",[o.PrismLanguages.graphql]:"GraphQL",[o.PrismLanguages.groovy]:"Groovy",[o.PrismLanguages.haskell]:"Haskell",[o.PrismLanguages.html]:"HTML",[o.PrismLanguages.idris]:"Idris",[o.PrismLanguages.java]:"Java",[o.PrismLanguages.javascript]:"JavaScript",[o.PrismLanguages.json]:"JSON",[o.PrismLanguages.jsx]:"JavaScript",[o.PrismLanguages.julia]:"Julia",[o.PrismLanguages.kotlin]:"Kotlin",[o.PrismLanguages.latex]:"LaTeX",[o.PrismLanguages.less]:"Less",[o.PrismLanguages.lisp]:"Lisp",[o.PrismLanguages.livescript]:"LiveScript",[o.PrismLanguages.llvm]:"LLVM IR",[o.PrismLanguages.lua]:"Lua",[o.PrismLanguages.makefile]:"Makefile",[o.PrismLanguages.markdown]:"Markdown",[o.PrismLanguages.markup]:"Markup",[o.PrismLanguages.matlab]:"MATLAB",[o.PrismLanguages.mathematica]:"Mathematica",[o.PrismLanguages.mermaid]:"Mermaid",[o.PrismLanguages.nasm]:"Assembly",[o.PrismLanguages.notion]:"Notion Formula",[o.PrismLanguages.nix]:"Nix",[o.PrismLanguages.objectivec]:"Objective-C",[o.PrismLanguages.ocaml]:"OCaml",[o.PrismLanguages.pascal]:"Pascal",[o.PrismLanguages.perl]:"Perl",[o.PrismLanguages.php]:"PHP",[o.PrismLanguages.powershell]:"PowerShell",[o.PrismLanguages.prolog]:"Prolog",[o.PrismLanguages.protobuf]:"Protobuf",[o.PrismLanguages.purescript]:"PureScript",[o.PrismLanguages.python]:"Python",[o.PrismLanguages.r]:"R",[o.PrismLanguages.racket]:"Racket",[o.PrismLanguages.reason]:"Reason",[o.PrismLanguages.ruby]:"Ruby",[o.PrismLanguages.rust]:"Rust",[o.PrismLanguages.sass]:"Sass",[o.PrismLanguages.scala]:"Scala",[o.PrismLanguages.scheme]:"Scheme",[o.PrismLanguages.scss]:"Scss",[o.PrismLanguages.solidity]:"Solidity",[o.PrismLanguages.sql]:"SQL",[o.PrismLanguages.swift]:"Swift",[o.PrismLanguages.toml]:"TOML",[o.PrismLanguages.tsx]:"TypeScript",[o.PrismLanguages.typescript]:"TypeScript",[o.PrismLanguages.vbnet]:"VB.Net",[o.PrismLanguages.verilog]:"Verilog",[o.PrismLanguages.vhdl]:"VHDL",[o.PrismLanguages.visualBasic]:"Visual Basic",[o.PrismLanguages.wasm]:"WebAssembly",[o.PrismLanguages.xml]:"XML",[o.PrismLanguages.yaml]:"YAML",[o.PrismLanguages.clike]:"Java/C/C++/C#"}},90850:(e,t,n)=>{n.d(t,{$r:()=>a,Zj:()=>r,Zk:()=>s});var o=n(15157);const i="promoCode";function r(e){let{currentUserId:t,promoCode:n}=e;n?o.Z.set({userId:t,key:i,value:n}):o.Z.remove({userId:t,key:i})}function a(e){o.Z.remove({userId:e,key:i})}function s(e){return o.Z.get({userId:e,key:i})}},23014:(e,t,n)=>{n.d(t,{P8:()=>f,oN:()=>m,qB:()=>d,un:()=>p,zy:()=>u});n(57658),n(67294);var o=n(5366),i=n(76205),r=n(99036),a=n(96449),s=n(40652),l=n(85893);class c{constructor(e,t){this.variable=void 0,this.property=void 0,this.variable=e,this.property=t}getProperty(){return this.property}get(e){const t=this.getCombinatorFilter(e);if(t)return{type:"results",limit:1,filter:t}}getCombinatorFilter(e){const t=this.getPropertyFilter(e,this.variable);if(t)return{operator:"and",filters:[{property:this.property,filter:t}]}}getPropertyFilter(e,t){var n;const o=e[this.property];if(!o)return;return{operator:"status_is",value:{type:"is_option",value:null===(n=o.options)||void 0===n||null===(n=n.find((e=>e.id===t)))||void 0===n?void 0:n.value}}}}const d={[s.p$]:{current:{formattedMessage:(0,l.jsx)(o.FormattedMessage,{id:"database.filterValue.relationType.relativeSprintVariable.current",defaultMessage:"Current"}),reducer:new c(a.SF,a.b0.StatusV2)},next:{formattedMessage:(0,l.jsx)(o.FormattedMessage,{id:"database.filterValue.relationType.relativeSprintVariable.next",defaultMessage:"Next"}),reducer:new c(a.YE,a.b0.StatusV2)}}};function u(e,t){const{filter:n,property:o}=e;if(!(0,i.e)(n)||!(0,i.vR)(n))return!1;const a=t[o];if(!a||!(0,r.p_)(a))return!1;return(0,i.YO)(n).some((e=>"relative"===e.type))}function p(e,t,n){if(!e)return!1;const o=t[n];return!!o&&(e===s.p$&&n===a.b0.StatusV2&&(0,r.gB)(o))}function m(e,t){return!!e&&p(t,e,a.b0.StatusV2)}function f(e,t){const n=Object.entries(t).find((t=>{let[n,o]=t;return e===o}));return n?n[0]:void 0}},76462:(e,t,n)=>{n.d(t,{OC:()=>nt,ZP:()=>it});n(59730);var o=n(72126),i=n(97880),r=n(63143),a=n(74487),s=n(58129),l=n(70921),c=n(30842),d=n(39050),u=n(54368),p=n(51650),m=n(88179),f=n(80926),g=n(98963),h=n(18844),v=n(21202),b=n(7470),y=n(77420),S=n(60014),_=n(6287),w=n(13493),k=n(70279),I=n(75908),C=n(6359),x=n(7678),T=n(73409),M=n(60897),P=n(33709),A=n(44312),R=n(4986),D=n(52719),B=n(58912),E=n(19639),F=n(73387),Z=n(36077),L=n(97715),j=n(32161),V=n(82447),U=n(9713),O=n(57398),N=n(49953),z=n(14710),H=n(9508),W=n(62643),q=n(57883),G=n(66726),K=n(30754),$=n(6946),Q=n(9844),Y=n(25753),J=n(84683),X=n(38429),ee=n(89488),te=n(65311),ne=n(16427),oe=n(61220),ie=n(96683),re=n(70017),ae=n(89470),se=n(49126),le=n(4137),ce=n(80396),de=n(24836),ue=n(86135),pe=n(78929),me=n(84323),fe=n(83200),ge=n(67627),he=n(65963),ve=n(14130),be=n(34406),ye=n(42314),Se=n(16663),_e=n(19221),we=n(93646),ke=n(91644),Ie=n(63787),Ce=n(38952),xe=n(40837),Te=n(15047),Me=n(96740),Pe=n(63921),Ae=n(75990),Re=n(57829),De=n(63188),Be=n(56877),Ee=n(76413),Fe=n(47238),Ze=n(77858),Le=n(37202),je=n(29369),Ve=n(26195),Ue=n(60113),Oe=n(14718),Ne=n(14327),ze=n(53412),He=n(65836),We=n(5505),qe=n(66295),Ge=n(10354),Ke=n(19889),$e=n(19716),Qe=n(98897),Ye=n(46769),Je=n(66079),Xe=n(58161),et=n(28182),tt=n(35794);const nt={block:v.ZP,customer:M.ZP,notion_user:Ke.ZP,space:Te.ZP,space_view:Ze.ZP,token:We.Z,user_root:Je.ZP,temporary_password:He.ZP,password:se.Z,collection:_.Z,collection_view:w.Z,apple_token:m.Z,google_token:$.Z,follow:q.ZP,activity:l.ZP,notification:te.ZP,firebase_token:W.ZP,trello_token:qe.Z,asana_token:f.Z,confluence_token:I.Z,monday_token:ee.Z,external_entity:U.Z,external_token:H.Z,external_integration_app:O.Z,slack_integration:Ie.Z,slack_notification:Ce.Z,discussion:P.ZP,comment:k.ZP,snapshot:xe.Z,credit:x.ZP,used_credit:Ge.Z,user_settings:et.ZP,evernote_token:Z.Z,space_recover_pages:Ee.ZP,drive_token:R.ZP,block_token:b.Z,user_metadata:Ye.Z,bot:y.ZP,bot_token:S.Z,saml_config:pe.ZP,experiment:L.ZP,education_domain:D.Z,education_email:B.Z,space_invite_link:De.Z,public_email_domain:le.Z,user_data_consent_permissions:$e.Z,access_request:s.ZP,csat_feedback:T.ZP,template_checklist:Ue.Z,template_tag:ze.ZP,page_visit:ae.ZP,page_exit:re.ZP,subscription:Le.ZP,space_domain:Pe.ZP,admin_api_log:c.Z,admin_api_op_log:d.Z,integration:Q.ZP,integration_token:Y.Z,oauth_authorization_code:ne.Z,mfa_settings:X.ZP,[j.P]:j.Z,[V.r]:V.Z,[tt.b]:tt.Z,[z.Dw]:z.ZP,[Xe.t]:Xe.Z,team:je.ZP,[we.O]:we.Z,[C.H]:C.Z,[K.G]:K.Z,[G.l]:G.Z,[ce.yo]:ce.ZP,[N.r9]:N.ZP,[A.Jd]:A.ZP,[E.mz]:E.ZP,[Ae.F]:Ae.Z,[J.Tu]:J.ZP,[g.cv]:g.ZP,[me.b]:me.Z,[he.a]:he.Z,[Se.h]:Se.Z,[be.f1]:be.ZP,[ye.P]:ye.Z,[fe.w]:fe.Z,[ve.O]:ve.Z,[ge.m]:ge.Z,[_e.a]:_e.Z,[de.qV]:de.ZP,[ue.FM]:ue.ZP,[h.Xj]:h.ZP,[F.k]:F.Z,[Re.fF]:Re.ZP,[Fe.x]:Fe.ZP,[Qe.pm]:Qe.ZP,[Me.L]:Me.Z,[Be.L9]:Be.ZP,[Ve.nE]:Ve.ZP,[Ne.z]:Ne.Z,[Oe.u]:Oe.Z,[oe.V7]:oe.ZP,[ie.K]:ie.Z,[u.y]:u.Z,[ke.AT]:ke.ZP,[p.b]:p.Z};(0,i.Yd)(nt);a.literals(...(0,r.XP)(nt));const ot={};o.M6(nt,(e=>{e.columnTypes&&o.M6(e.columnTypes,((e,t)=>{t&&(ot[t]=!0)}))}));const it=nt},53772:(e,t,n)=>{function o(e){return"development"===e.env||"local"===e.env||e.isAdminMode}n.d(t,{x:()=>o})},94804:(e,t,n)=>{n.d(t,{A7:()=>r,Y6:()=>l,fe:()=>s,rE:()=>a,w8:()=>c});var o=n(15157),i=n(97880);function r(e){let{searchSessionId:t,searchSessionFlowNumber:n}=e;if((0,i.$K)(t)&&(0,i.$K)(n))return`1:${t}:${n}`}const a="SearchShowFilterBar";function s(e){return d({key:a,userId:e,defaultValue:!1})}const l="SearchSidePeekDefaultOpen";function c(e){return d({key:l,userId:e,defaultValue:!0})}function d(e){const{key:t,userId:n,defaultValue:i}=e,r=o.Z.get({userId:n,key:t});return void 0===r?i:"boolean"==typeof r&&r}},92338:(e,t,n)=>{n.d(t,{GA:()=>b,Ix:()=>S,Um:()=>_,dK:()=>w,iY:()=>c,jl:()=>p,n8:()=>d,u4:()=>u,vp:()=>y});var o=n(41432),i=n(40652),r=n(74487);const a=r.object({required:{type:r.literal("date"),start_date:r.string()},optional:{}}),s=r.union([r.object({required:{starting:a,ending:r.isUndefined()},optional:{}}),r.object({required:{starting:r.isUndefined(),ending:a},optional:{}}),r.object({required:{starting:a,ending:a},optional:{}}),r.object({required:{starting:r.isUndefined(),ending:r.isUndefined()},optional:{}})]),l=r.union([r.array(r.string()),r.object({required:{teamIds:r.array(r.string()),includeSpaceRecords:r.boolean()},optional:{}})]);function c(e){if(e)return Array.isArray(e)?e:e.teamIds?e.teamIds:void 0}r.object({required:{id:r.string(),type:r.union([r.literal("user"),r.literal("permission_group")])},optional:{}});let d=function(e){return e.CollectionsInSpace="CollectionsInSpace",e.BlocksInSpace="BlocksInSpace",e.BlocksInAncestor="BlocksInAncestor",e.BlocksInParent="BlocksInParent",e.BlocksInCollection="BlocksInCollection",e}({});r.object({required:{ancestors:r.array(r.string()),createdBy:r.array(r.string()),editedBy:r.array(r.string()),lastEditedTime:s,createdTime:s},optional:{requireEditPermissions:r.boolean(),isDeletedOnly:r.boolean(),excludeTemplates:r.boolean(),isAdminModeDeletedPageSearch:r.boolean(),blockTypes:r.minLength(r.array(r.literals(...Object.keys(o.Ti))),1),inTeams:l,navigableBlockContentOnly:r.boolean(),includePublicPagesWithoutExplicitAccess:r.boolean(),audience:r.array(r.literals("private","shared_internally","shared_externally","shared_to_web")),dev_excludedPages:r.array(r.string()),dev_excludedTeams:r.array(r.string()),parentId:r.string(),databaseType:r.array(r.literals(...i.fW))}});function u(e){return{isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,requireEditPermissions:!1,includePublicPagesWithoutExplicitAccess:!1,ancestors:[],parentId:void 0,createdBy:[],editedBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},inTeams:[],...e}}function p(e,t){return{...e,...t,createdTime:{...e.createdTime,...t.createdTime},lastEditedTime:{...e.lastEditedTime,...t.lastEditedTime}}}const m=["quick_find","quick_find_public","quick_find_input_change","quick_find_scroll","quick_find_filters","quick_find_ancestor_filter","quick_find_navigational_mode"],f=(m.filter((e=>"quick_find_ancestor_filter"!==e)),["cron_attachment_search_input_change","cron_attachment_parent_search_input_change"]),g=(r.union([...m.map(r.literal),...f.map(r.literal),r.literal("ancestor_filter_page_search"),r.literal("debugging"),r.literal("report_bad_search"),r.literal("trash"),r.literal("link_to_page_block"),r.literal("link_to_collection_block"),r.literal("mention_menu"),r.literal("move_to_menu"),r.literal("public_home_page_menu"),r.literal("relation_menu"),r.literal("relation_setup_menu"),r.literal("web_clipper"),r.literal("oauth"),r.literal("collection_group_value"),r.literal("collection_settings_source"),r.literal("collection_settings_select_relation_source"),r.literal("admin_search_permanently_deleted_pages"),r.literal("bot_iterate_blocks_in_space"),r.literal("api_unknown"),r.literal("simple_formula_value_page_search"),r.literal("automation_page_picker"),r.literal("automation_collection_picker"),r.literal("admin_content_search"),r.literal("ediscovery_search_api"),r.literal("admin_content_search_export"),r.literal("question_answer_context_search"),r.literal("export_content_analytics"),r.literal("send_to_notion_database_options"),r.literal("search_content_analytics"),r.literal("search_unique_id"),r.literal("update_sidebar_tab_assistant"),r.literal("legacy_searchPagesWithParent")]),["lastEdited","created","scroll","id",...Object.keys({pageViewsLast7Days:"pageViews.pageViewsLast7Days",pageViewsLast28Days:"pageViews.pageViewsLast28Days",pageViewsLast90Days:"pageViews.pageViewsLast90Days",pageViewsAllTime:"pageViews.pageViewsAllTime",uniquePageViewsLast7Days:"uniquePageViews.uniquePageViewsLast7Days",uniquePageViewsLast28Days:"uniquePageViews.uniquePageViewsLast28Days",uniquePageViewsLast90Days:"uniquePageViews.uniquePageViewsLast90Days",uniquePageViewsAllTime:"uniquePageViews.uniquePageViewsAllTime"})]),h=r.object({required:{field:r.literals("relevance")},optional:{}}),v=r.object({required:{field:r.literals(...g),direction:r.literals("asc","desc")},optional:{missing:r.union([r.literal("_first"),r.literal("_last"),r.number(),r.boolean(),r.string()]),searchAfter:r.undefinable(r.union([r.number(),r.string()]))}}),b=r.union([h,v]);let y=function(e){return e.Local="local",e.ElasticSearch="es",e.Postgres="pg",e.VectorDBBlock="vector_block",e.VectorDBCollection="vector_collection",e.ElasticsearchRandom="es_random",e.ElasticsearchUniqueID="es_uniqueId",e.ElasticsearchForcedRecentRecall="es_forced_recent_recall",e}({});const S={RequestFailed:{type:"RequestFailed",message:"Something went wrong."},NoResults:{type:"NoResultsFound",message:"No results found."},Offline:{type:"Offline",message:"Go online for more results."}},_="<gzkNfoUU>",w="</gzkNfoUU>"},25666:(e,t,n)=>{n.d(t,{D:()=>a,T:()=>r});var o=n(24211),i=n(72126);const r="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function a(e,t){if(i.HD(e))return e;{const n=e[t];return void 0!==n?n:e[o.al]}}},94044:(e,t,n)=>{n.d(t,{$e:()=>m,TQ:()=>p,UF:()=>s,VX:()=>c,jm:()=>d,my:()=>u,p_:()=>a,vr:()=>l});var o=n(5366),i=n(30845),r=n(59753);n(4615);const a=8,s=70,l=1e3,c=(0,o.defineMessages)({member:{id:"sharedContextualInviteHelpers.member.inviteMessage2",defaultMessage:"{userName} shared a page {pageName} with you."},guest:{id:"sharedContextualInviteHelpers.guest.inviteMessage2",defaultMessage:"{userName} shared {pageName}. Join {spaceName} to view this page."},default:{id:"sharedContextualInviteHelpers.default.inviteMessage",defaultMessage:"Your invitation message"},optional:{id:"sharedContextualInviteHelpers.default.inviteMessagePrefix",defaultMessage:"Optional message..."}});function d(e){const{includeOptional:t,isGuest:n,emailProps:o,intl:i}=e,r=n?c.guest:c.member;if(t){return`${i.formatMessage(c.optional)}\n"${i.formatMessage(r,o)}"`}return i.formatMessage(r,o)}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if(!e)return"";const n=i.s(e,"url");let o=e.slice();return n.forEach(((e,t)=>{o=o.replace(e.value,"[link]")})),o.length>t&&(o=`${o.substring(0,t)}...`),o}function p(e){if(!e)return!1;return i.s(e,"url").length>0}function m(e,t){var n;const o=null===(n=r.kk.fromValue("block",e).getPermissionItems())||void 0===n?void 0:n.find((e=>"user_permission"===e.type&&e.user_id===t.invited_user_id));if(o&&"invite_id"in o)return o.invite_id}},99108:(e,t,n)=>{n.d(t,{VR:()=>P,hI:()=>R});n(57658);var o=n(40902),i=n(41432),r=n(80951),a=n(53504),s=n(72126),l=n(26825),c=n(27006),d=n(97880);function u(e,t){return e.space_id===t.space_id&&e.collection_id===t.collection_id&&e.navigable_block_id===t.navigable_block_id}function p(e){return e.table+e.id}function m(e,t){return s.Xy(s.MR(e.authors||[],p),s.MR(t.authors||[],p))}function f(e,t){return s.MR(s.mN([...e.authors||[],...t.authors||[]],p),p)}function g(e,t){return e.block_id===t.block_id&&u(e,t)}function h(e,t){return e.block_id===t.block_id&&u(e,t)}function v(e,t){return u(e,t)&&e.comment_id===t.comment_id}function b(e,t){return u(e,t)}function y(e,t){return e.collection_property_id===t.collection_property_id&&u(e,t)}function S(e,t){return e.collection_view_id===t.collection_view_id&&u(e,t)}function _(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_user_id===t.mentioned_user_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&u(e,t)}function w(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_group_id===t.mentioned_group_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&u(e,t)}function k(e){const t=[];e:for(;e.list.length>0;){const n=e.list.shift();let o,i=0,r=!1;for(;i<e.list.length;){const t=e.list[i];if(r=e.cancel(n,t),r){e.list.splice(i,1);continue e}if(o=e.replace(n,t),o){e.list[i]=o;continue e}i++}t.push(n)}return t}function I(e,t){return 0===s.e5(e,t).length&&0===s.e5(t,e).length}function C(e,t){return u(e,t)&&e.permission_group_id===t.permission_group_id}function x(e){return"permission-created"===e.type||"permission-deleted"===e.type?(0,l.OC)(e.permission_data):"permission-changed"===e.type?(0,l.OC)(e.permission_data.before):void(0,d.t1)(e)}function T(e,t){return!!u(e,t)&&(!!m(e,t)&&("permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type||(null===(n=e.permission_data)||void 0===n||null===(n=n.actual_changes)||void 0===n?void 0:n.some((e=>(0,l.OC)(e)===x(t)))):"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type?t.permission_data.actual_changes.some((t=>(0,l.OC)(t)===x(e))):x(e)===x(t)));var n}function M(e,t){if("permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)&&!function(e,t){return c.cY(e)===c.cY(t)}(e.permission_data,t.permission_data))return{...t,type:"permission-changed",timestamp:t.timestamp,permission_data:{before:e.permission_data,after:t.permission_data}}}function P(e){const t=k({list:k({list:s.MR((0,a.Z)(e,"mangle-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>M(e,t)}),cancel:(e,t)=>function(e,t){return"block-created"===e.type&&"block-deleted"===t.type&&g(e,t)}(e,t)||function(e,t){return"block-deleted"===e.type&&"block-created"===t.type&&g(e,t)}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&g(e,t)){if(e.block_data.after.block_value.type===i.Ti.tableRow){const n=o.Yr({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),i=o.Yr({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return I(n,i)&&s.Xy(s.ei(e.block_data.before.block_value.properties||{},n),s.ei(t.block_data.after.block_value.properties||{},i))}const n=o.OS({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),r=o.B9({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),a=o.OS({before:t.block_data.before.block_value,after:t.block_data.after.block_value,schema:t.block_schema}),l=o.B9({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return!o.lv({before:t.block_data.before.block_value,after:t.block_data.after.block_value})&&I(n,a)&&s.Xy(s.ei(e.block_data.before.block_value.properties||{},n),s.ei(t.block_data.after.block_value.properties||{},a))&&I(r,l)&&s.Xy(s.ei(e.block_data.before.block_value.format||{},r),s.ei(t.block_data.after.block_value.format||{},l))}return!1}(e,t)||function(e,t){return!("block-property-changed"!==e.type||"block-property-changed"!==t.type||!h(e,t))&&I(Object.keys(e.property_updates),Object.keys(t.property_updates))&&s.Xy(Object.values(e.property_updates).map((e=>e.before)),Object.values(t.property_updates).map((e=>e.after)))}(e,t)||function(e,t){return"permission-created"===e.type&&"permission-deleted"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t)&&s.Xy(e.permission_data.before,t.permission_data.after)}(e,t)||function(e,t){return"mention-created"===e.type&&"mention-deleted"===t.type&&_(e,t)}(e,t)||function(e,t){return"mention-deleted"===e.type&&"mention-created"===t.type&&_(e,t)}(e,t)||function(e,t){return"permission-group-mention-created"===e.type&&"permission-group-mention-deleted"===t.type&&w(e,t)}(e,t)||function(e,t){return"permission-group-mention-deleted"===e.type&&"permission-group-mention-created"===t.type&&w(e,t)}(e,t)||function(e,t){return"comment-created"===e.type&&"comment-deleted"===t.type&&v(e,t)}(e,t)||function(e,t){return"comment-deleted"===e.type&&"comment-created"===t.type&&v(e,t)}(e,t)||function(e,t){return"comment-changed"===e.type&&"comment-changed"===t.type&&v(e,t)&&s.Xy(e.comment_data.before,t.comment_data.after)}(e,t)||function(e,t){return!!("collection-changed"===e.type&&"collection-changed"===t.type&&b(e,t)&&e.collection_data&&t.collection_data)&&s.Xy(e.collection_data.before,t.collection_data.after)}(e,t)||function(e,t){return"collection-property-created"===e.type&&"collection-property-deleted"===t.type&&y(e,t)}(e,t)||function(e,t){return"collection-property-deleted"===e.type&&"collection-property-created"===t.type&&y(e,t)}(e,t)||function(e,t){return"collection-property-changed"===e.type&&"collection-property-changed"===t.type&&y(e,t)&&s.Xy(e.collection_property_data.before,t.collection_property_data.after)}(e,t)||function(e,t){return"collection-view-created"===e.type&&"collection-view-deleted"===t.type&&S(e,t)}(e,t)||function(e,t){return"collection-view-deleted"===e.type&&"collection-view-created"===t.type&&S(e,t)}(e,t)||function(e,t){return"collection-view-changed"===e.type&&"collection-view-changed"===t.type&&S(e,t)&&s.Xy(e.collection_view_data.before,t.collection_view_data.after)}(e,t)||function(e,t){return"permission-group-created"===e.type&&"permission-group-deleted"===t.type&&C(e,t)}(e,t)||function(e,t){return"permission-group-deleted"===e.type&&"permission-group-created"===t.type&&C(e,t)}(e,t),replace:(e,t)=>function(e,t){if("block-created"===e.type&&"block-changed"===t.type&&g(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),block_schema:t.block_schema,block_data:t.block_data.after}}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&g(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),block_schema:t.block_schema,block_data:{before:e.block_data.before,after:t.block_data.after}}}(e,t)||function(e,t){if("block-property-changed"===e.type&&"block-property-changed"===t.type&&h(e,t)){const n=e.property_updates;return t.property_updates&&Object.entries(t.property_updates).forEach((o=>{let[i,r]=o;i in n?s.Xy(n[i].before,r.after)?(delete n[i],e.filtered_block_schema&&delete e.filtered_block_schema[i],t.filtered_block_schema&&delete t.filtered_block_schema[i]):n[i].after=r.after:n[i]=r})),{...e,timestamp:t.timestamp,authors:f(e,t),filtered_block_schema:{...e.filtered_block_schema,...t.filtered_block_schema},property_updates:n}}}(e,t)||function(e,t){if("comment-created"===e.type&&"comment-changed"===t.type&&v(e,t))return{...e,comment_data:t.comment_data.after}}(e,t)||function(e,t){if("comment-changed"===e.type&&"comment-changed"===t.type&&v(e,t))return{...e,comment_data:{before:e.comment_data.before,after:t.comment_data.after}}}(e,t)||function(e,t){if("permission-created"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,timestamp:t.timestamp,permission_data:t.permission_data.after}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,permission_data:{before:e.permission_data.before,after:t.permission_data.after},timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-created"===t.type&&"permission-restriction-created"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-deleted"===t.type&&"permission-restriction-deleted"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("collection-created"===e.type&&"collection-changed"===t.type&&b(e,t))return{...e,authors:f(e,t),collection_data:t.collection_data?t.collection_data.after:void 0}}(e,t)||function(e,t){if("collection-changed"===e.type&&"collection-changed"===t.type&&b(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_data:{before:e.collection_data?e.collection_data.before:void 0,after:t.collection_data?t.collection_data.after:void 0}}}(e,t)||function(e,t){if("collection-property-created"===e.type&&"collection-property-changed"===t.type&&y(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_property_data:t.collection_property_data.after}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-changed"===t.type&&y(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_property_data:{before:e.collection_property_data.before,after:t.collection_property_data.after}}}(e,t)||function(e,t){if("collection-view-created"===e.type&&"collection-view-changed"===t.type&&S(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_view_data:t.collection_view_data.after}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-changed"===t.type&&S(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_view_data:{before:e.collection_view_data.before,after:t.collection_view_data.after}}}(e,t)||function(e,t){if("permission-group-created"===e.type&&"permission-group-changed"===t.type&&C(e,t))return{...e,timestamp:t.timestamp,permission_group_data:t.permission_group_data.after,authors:f(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-changed"===t.type&&C(e,t))return{...e,permission_group_data:{before:e.permission_group_data.before,after:t.permission_group_data.after},timestamp:t.timestamp,authors:f(e,t)}}(e,t)}).filter((e=>!function(e){if("block-changed"===e.type){const t=o.gg({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),n=o.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),i=o.fc({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),r=o.Z3({before:e.block_data.before.block_value,after:e.block_data.after.block_value});return!(t||n||i||r)}return!1}(e)));return s.MR(t,(e=>e.timestamp))}function A(e){const t=k({list:s.MR((0,a.Z)(e,"ignore-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>function(e,t){if("block-changed"===e.type&&"block-deleted"===t.type&&g(e,t))return{...t,authors:f(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-deleted"===t.type&&C(e,t))return{...t,timestamp:t.timestamp,permission_group_data:e.permission_group_data.before,authors:f(e,t)}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-deleted"===t.type&&T(e,t))return{...t,timestamp:t.timestamp,permission_data:e.permission_data.before}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-deleted"===t.type&&y(e,t))return{...t,authors:f(e,t)}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-deleted"===t.type&&S(e,t))return{...t,authors:f(e,t)}}(e,t)});return s.MR(t,(e=>e.timestamp))}function R(e){return function(e){const t=[];return e.forEach((e=>{if("block-changed"===e.type)if(o.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value})){const n={...e,type:"block-created",block_data:e.block_data.after},o={...e,type:"block-deleted",block_data:e.block_data.before};t.push(o),t.push(n)}else t.push(e);else t.push(e)})),t}(A(e)).filter((e=>!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&i.wL[e.block_data.block_value.type]&&"page"!==e.block_data.block_value.type&&!(0,r.wS)(e.block_data.block_value,"title")}(e)&&!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&i.XX[e.block_data.block_value.type]}(e)))}},34886:(e,t,n)=>{n.d(t,{F:()=>a,R:()=>r});var o=n(72126),i=n(97880);function r(e){const t={};return e?((0,i.qP)(e).forEach((e=>{let[n,i]=e;n&&i&&(t[String(n)]=o.HD(i)?i:JSON.stringify(i))})),t):t}function a(e){return e>=1e3?"1000+":e>=500?"500-999":e>=100?"100-499":e>=50?"50-99":e>=10?"10-49":e>=2?"2-9":e>=1?"1":"0"}},46637:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(29450),i=n(30548);const r=["adClick","fbp"];const a=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new i.ZP(e,t,"targeting")}get(e){return this.localStorageStore.get(e)}set(e,t){return this.localStorageStore.set(e,t)}remove(e){return this.localStorageStore.remove(e)}removeAllIfNoPermission(){const{trackingType:e}=this.localStorageStore;(0,o.hasPermissionForTrackingTypeBrowser)(e)||r.forEach((e=>this.remove(e)))}}(i.$p,!1)},72128:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(29450),i=n(30548);const r=["sourceInitialPage"];const a=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new i.ZP(e,t,"performance")}get(e){let{userId:t,key:n}=e;return this.localStorageStore.get((0,i.dq)(t,n))}set(e){let{userId:t,key:n,value:o}=e;return this.localStorageStore.set((0,i.dq)(t,n),o)}remove(e){let{userId:t,key:n}=e;return this.localStorageStore.remove((0,i.dq)(t,n))}removeAllIfNoPermission(){const{namespace:e,trackingType:t}=this.localStorageStore;if((0,o.hasPermissionForTrackingTypeBrowser)(t))return;const n=`${i.eg}${e}:`;Object.keys(localStorage).filter((e=>e.startsWith(n))).filter((e=>{const[t,n,o,i]=e.split(":");return i&&r.includes(i)})).forEach((e=>localStorage.removeItem(e)))}}(i.TA,!1)},64793:(e,t,n)=>{n.d(t,{t:()=>a});var o=n(97880),i=n(31919),r=n(896);class a{constructor(e){this.lastVersion=void 0,this.externalId=void 0,this.product=void 0,this.billingInterval=void 0,this.unitAmount=void 0,this.state=void 0,this.regions=void 0,this.externalId=e.external_id,this.product=e.product,this.billingInterval=e.billing_interval,this.unitAmount=i.n.fromValue({amount:e.unit_amount,currencyCode:e.currency}),this.state=e.state,this.regions=e.regions}get currencyCode(){return this.unitAmount.currencyCode}isAddOn(){return"ai"===this.product}getMonthlyUnitCost(e){const t=this.getAdjustedUnitAmount(e);return"year"===this.billingInterval?t.withDividedAmount(12):t}getMonthlyCost(e){const{quantity:t,coupon:n}=e;return this.getMonthlyUnitCost(n).withMultipliedAmount(t)}getCostPerBillingInterval(e){const{quantity:t,coupon:n}=e;return this.getAdjustedUnitAmount(n).withMultipliedAmount(t)}getDiscountPerBillingInterval(e){var t;const{quantity:n,coupon:o,promo:i}=e,a=this.unitAmount.withMultipliedAmount(n);if(o&&this.doesCouponApply(o))return a.withMultipliedAmount((0,r.ZN)(o));let s=0;return null!=i&&i.percent_off&&null!==(t=i.applies_to)&&void 0!==t&&t.includes(this.externalId)&&(s=i.percent_off/100),a.withMultipliedAmount(s)}getAdjustedUnitAmount(e){let t=1;return e&&this.doesCouponApply(e)&&(t=1-(0,r.ZN)(e)),this.unitAmount.withMultipliedAmount(t)}doesCouponApply(e){switch(this.product){case"ai":return"ai_fifty_percent"===e;case"free":case"student":case"personal":return!1;case"plus":return["team_three_months","team_annual"].includes(e);case"business":case"enterprise":return["business_three_months","business_annual"].includes(e);default:(0,o.t1)(this.product)}}}},31919:(e,t,n)=>{n.d(t,{n:()=>i});n(21703);const o={BRL:{currencyCode:"BRL",minorUnitDigits:2},EUR:{currencyCode:"EUR",minorUnitDigits:2},USD:{currencyCode:"USD",minorUnitDigits:2}};class i{static fromValue(e){const{amount:t,currencyCode:n}=e,r=o[n];if(!r)throw new Error(`Unsupported currency code: ${n}`);return new i(r,t)}static sum(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=t.filter((e=>void 0!==e));if(0===o.length)return;const{currencyCode:r}=o[0];if(o.some((e=>e.currencyCode!==r)))throw new Error("Cannot add money with different currencies");const a=o.reduce(((e,t)=>e+t.amount),0);return i.fromValue({amount:a,currencyCode:r})}static zero(e){return i.fromValue({amount:0,currencyCode:e})}constructor(e,t){this.currencyValue=void 0,this.amount=void 0,this.currencyValue=e,this.amount=t}get currencyCode(){return this.currencyValue.currencyCode}toMoneyValue(){return{amount:this.amount,currencyCode:this.currencyValue.currencyCode}}withAmount(e){return new i(this.currencyValue,e)}withAddedAmount(e){return new i(this.currencyValue,this.amount+e)}plus(e){if(this.currencyCode!==e.currencyCode)throw new Error(`Cannot add money with currency code ${this.currencyCode} to money with currency code ${e.currencyCode}`);return new i(this.currencyValue,this.amount+e.amount)}minus(e){return this.plus(e.withMultipliedAmount(-1))}withMultipliedAmount(e){return new i(this.currencyValue,this.amount*e)}withDividedAmount(e){return new i(this.currencyValue,this.amount/e)}zeroIfNegative(){return new i(this.currencyValue,Math.max(0,this.amount))}zeroIfPositive(){return new i(this.currencyValue,Math.min(0,this.amount))}isPositive(){return this.amount>0}isNegative(){return this.amount<0}}},896:(e,t,n)=>{n.d(t,{$v:()=>r,ZN:()=>a,pp:()=>i});var o=n(97880);function i(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!0;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!1;default:(0,o.t1)(e)}}function r(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!1;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!0;default:(0,o.t1)(e)}}function a(e){switch(e){case"team_three_months":case"ai_fifty_percent":return.5;case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return.1;default:(0,o.t1)(e)}}},26929:(e,t,n)=>{n.d(t,{cS:()=>s});n(21703);var o=n(30120),i=n(97880);const r={payment_failed:30,confirmation_required:15};function a(e){const{now:t,subscriptionId:n,invoiceId:o,overdueReason:a,subscriptionStatus:s,invoiceDueDate:l}=e,c=function(e){const{subscriptionId:t,subscriptionStatus:n}=e;if(t&&n)switch(n){case"past_due":case"unpaid":return{paymentStatus:n,reason:`Subscription [${t}] status is '${n}'. This triggered the '${n}' payment status`};case"incomplete":return{paymentStatus:"past_due",reason:`Subscription [${t}] status is '${n}'. This triggered the 'past_due' payment status`};case"active":case"canceled":case"incomplete_expired":case"paused":case"trialing":return;default:(0,i.t1)(n)}}({subscriptionId:n,subscriptionStatus:s}),d=function(e){const{invoiceId:t,invoiceDueDate:n,overdueReason:o,now:i}=e;if(!t||!n||!o)return;if(i<n)return;const a=n.toFormat("LLLL dd, yyyy"),s=r[o];if(!s)throw new Error(`Unsupported overdue reason '${o}'`);const l=n.plus({days:s});if(i>=l)return{paymentStatus:"unpaid",reason:`Invoice [${t}] is overdue since ${a} due to '${o}'. This triggered the 'unpaid' payment status after a ${s} day warning period ending on ${l.toFormat("LLLL dd, yyyy")}`};return{paymentStatus:"past_due",reason:`Invoice [${t}] is overdue since ${a} due to '${o}'. This triggered the 'past_due' payment status on the due date.`}}({now:t,invoiceId:o,invoiceDueDate:l,overdueReason:a});return"unpaid"===(null==c?void 0:c.paymentStatus)?c:"unpaid"===(null==d?void 0:d.paymentStatus)?d:"past_due"===(null==c?void 0:c.paymentStatus)?c:"past_due"===(null==d?void 0:d.paymentStatus)?d:{paymentStatus:"paid"}}function s(e){const{now:t,overdueSubscription:n}=e;if(!n)return{paymentStatus:"paid",reason:"No overdue subscription was provided"};const{subscriptionId:i,invoiceId:r,subscriptionStatus:s,dueDate:l,overdueReason:c}=n;return a({now:t,subscriptionId:i,invoiceId:r,overdueReason:c,subscriptionStatus:s,invoiceDueDate:l?o.ou.fromMillis(l):void 0})}},2438:(e,t,n)=>{n.d(t,{CF:()=>r,du:()=>i,nR:()=>s,qH:()=>l,uN:()=>a});n(21703);var o=n(60897);function i(e){return"none"===e.role}function r(e){return"none"!==e.role}function a(e,t){return t?t.percent_off?{amount:e*t.percent_off/100,monthsRemaining:t.duration_in_months}:t.amount_off?{amount:t.amount_off}:{amount:0}:{amount:0}}function s(e){return"personal"!==e&&o.tt.find((t=>t===e))}function l(e){const t=o.KK.find((t=>t.includes(e))),n=null==t?void 0:t.findIndex((t=>t===e));if(0===n||e.includes("monthly")||e.includes("free")||e.includes("trial"))return"month";if(1===n||e.includes("yearly"))return"year";if(o.uw.has(e))return o.uw.get(e);throw new Error(`${e} not found in billing interval config nor contain known billing interval indicators.`)}},64684:(e,t,n)=>{n.d(t,{AL:()=>v,AW:()=>D,B5:()=>R,Ei:()=>B,Hf:()=>m,I6:()=>V,J2:()=>_,Rk:()=>h,Uk:()=>j,V3:()=>w,W9:()=>F,XO:()=>p,ah:()=>P,bk:()=>A,hY:()=>d,jI:()=>E,jc:()=>k,lF:()=>L,m4:()=>f,pd:()=>g,s8:()=>y,t0:()=>T,tO:()=>C,wN:()=>Z,x4:()=>u,xC:()=>S,xf:()=>I,zz:()=>b});n(57658),n(21703);var o=n(59730),i=n(72126),r=(n(59753),n(63306),n(26825)),a=n(27006),s=n(29369),l=n(90965),c=n(97880);function d(e){return void 0===e.membership?[]:e.membership}function u(e){let{members:t,groups:n}=e;if(!t||!n)return[];const o=i.KX(n,(e=>e.id)),r=t.map((e=>"group"===e.entity_type?o[e.group_id]:void 0));return i.oA(r)}function p(e){const t=d(e);return i.oA(t.map((e=>{if("owner"===e.type)return e.user_id})))}function m(e){const t=d(e);return i.oA(t.map((e=>{if("team_level_guest"===e.type)return e.user_id})))}function f(e){return Boolean(e.archived_by)}function g(e,t){return p(e).includes(t)}function h(e){var t;let{team:n,space:o,userId:i}=e;const r=null===(t=x({team:n,space:o}).find((e=>{let{userId:t}=e;return t===i})))||void 0===t?void 0:t.teamMemberInfos;if(!r||0===r.length)return"none";return function(){let e=0;for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];for(const i of n)e=Math.max(e,s.d2.indexOf(i));return s.d2[e]}(...r.map((e=>e.type)))}function v(e){let{team:t,space:n,userId:o,groupIdsThatIncludeUser:i}=e;window.__c={n:"isNonGuestTeamMember"};const r=(0,l.kC)(n.permissions,o);if(!r)return!1;if(t.is_default&&r)return!0;i||(i=(n.permission_groups??[]).filter((e=>e.user_ids&&e.user_ids.includes(o))).reduce(((e,t)=>(e.add(t.id),e)),new Set));const a=d(t);for(const s of a){if("member"!==s.type&&"owner"!==s.type)continue;const{entity_type:e}=s;switch(e){case"user":if(s.user_id===o)return!0;break;case"group":if(i.has(s.group_id))return!0;break;default:(0,c.t1)(e)}}return!1}function b(e){let{team:t,space:n,userId:o}=e;const i=h({team:t,space:n,userId:o});switch(i){case"owner":case"member":case"team_level_guest":return!0;case"none":return!1;default:(0,c.t1)(i)}}function y(e){let{team:t,userId:n}=e;return d(t).some((e=>"team_level_guest"===e.type&&e.user_id===n))}function S(e){if(!e.permissions)return"none";const t=e.permissions.find((t=>_(t,e.id)));return t?t.role:"none"}function _(e,t){return(0,a.zU)(e)?e.team_id===t:(0,a.Ix)(e)}function w(e,t){return!!(0,a.bm)(e)&&e.team_id===t}function k(e,t){return!(!(0,a.LW)(e)||e.team_id!==t)||(0,a.KK)(e)}function I(e){let{team:t,space:n}=e;const o=x({team:t,space:n}),i=[];for(const r of o){const{teamMemberInfos:e,userId:t}=r;e.some((e=>"owner"===e.type||"member"===e.type))&&i.push(t)}return i}function C(e){let{team:t,space:n}=e;return x({team:t,space:n}).map((e=>e.userId))}function x(e){let{team:t,space:n}=e;const o={},i={},r=new Set((0,l.Mi)(n));return(t.is_default?T({team:t,space:n}):d(t)).forEach((e=>{if("user"===e.entity_type){("team_level_guest"===e.type||r.has(e.user_id))&&(o[e.user_id]=[e])}else"group"===e.entity_type?i[e.group_id]=e:(0,c.t1)(e)})),n.permission_groups&&n.permission_groups.forEach((e=>{if(e.id in i&&e.user_ids){const t=i[e.id];e.user_ids.forEach((e=>{e in o||(o[e]=[]),r.has(e)&&o[e].push(t)}))}})),(0,c.qP)(o).map((e=>{let[t,n]=e;return{userId:t,teamMemberInfos:n}}))}function T(e){let{team:t,space:n}=e;const o=[],i=new Set;for(const a of d(t))o.push(a),"user"!==a.entity_type||"member"!==a.type&&"owner"!==a.type||i.add(a.user_id);const r=(0,l.UD)(n);for(const a of r)i.has(a.user_id)||o.push({type:"member",entity_type:"user",user_id:a.user_id});return o}function M(e){return"user"===e.entity_type?`${e.entity_type}|${e.user_id}`:"group"===e.entity_type?`${e.entity_type}|${e.group_id}`:void(0,c.t1)(e)}function P(e,t){return M(e)===M(t)}function A(e){let{teamValue:t,permissionRole:n}=e;const i=S(t);if(!i)throw new o.p8("Couldn't find team's default permission");return(0,r.nl)(n,i)===i&&n!==i}function R(e){return"self_join"===e.space_member_join_access?"open":"team_members"===e.visibility?"private":"closed"}function D(e){const{accessLevel:t,isDefault:n}=e,{id:o,permissions:i,settings:r}=e.teamValue,s={type:"explicit_team_owner_permission",role:"editor",team_id:o},l=(null==i?void 0:i.find(a.zU))||{type:"explicit_team_permission",role:"editor",team_id:o},d=null==i?void 0:i.find(a.ix),u={visibility:"space_members",space_member_join_access:"self_join",invite_access:"team_members"};if(n)return{settings:u,permissions:[s,l,{type:"space_permission",role:l.role},{type:"explicit_team_guest_permission",role:"none",team_id:o}]};if("open"===t){const e=(null==d?void 0:d.role)??"none";return{settings:u,permissions:[s,l,{type:"space_permission",role:(0,a.YX)(e)?e:l.role}]}}return"closed"===t?{settings:{visibility:"space_members",space_member_join_access:"invite_only",invite_access:r.invite_access},permissions:[s,l,{type:"space_permission",role:"none"}]}:"private"===t?{settings:{visibility:"team_members",space_member_join_access:"invite_only",invite_access:null==r?void 0:r.invite_access},permissions:[s,l,{type:"space_permission",role:"none"}]}:void(0,c.t1)(t)}function B(e){let{userId:t,teamModel:n,spaceModel:o}=e;if(void 0===t||void 0===n||void 0===o)return!1;if("private"!==R(n.getSettings()))return!1;return"none"===h({userId:t,team:{is_default:n.isDefault(),membership:n.getRawMembership()},space:{permissions:o.getPermissionItems()}})}function E(e){return p(e).length<1}function F(e,t,n){return!!E(e)&&(!!(0,l.wv)(n,t)&&("private"!==R(e.settings)||(n.subscription_tier,v({team:e,space:n,userId:t}))))}function Z(e){let{spaceValue:t,teamsInSpace:n,currentUserId:o}=e;const i=(0,r.aG)(t),a=n.filter((e=>!f({archived_by:e.archived_by}))).filter((e=>v({team:e,space:t,userId:o})));return Boolean(1===i.length&&i[0].userId===o&&1===a.length&&g({membership:a[0].membership},o))}function L(e){let{groupId:t,teamMember:n}=e;return"group"===n.entity_type&&n.group_id===t}function j(e,t){return t?t.filter((t=>!P(t,e))):[]}function V(e,t){return(t=(t=t??[]).filter((t=>!P(t,e)))).push(e),t}},62992:(e,t,n)=>{n.d(t,{J:()=>i});const o=new Set(["7754cf02-251f-4bc9-ab2f-9cc897765336","ba43b46e-4ad3-47f7-95f0-58a3ba01476f","86fd2f05-b95a-48d9-a2fd-9fd8aab2f74f","aa94ac95-f6b0-47f1-8211-37087c9dcba6","10e7ee2a-3beb-4b49-96f2-8b8f662aabd4","6ce5f94a-8f64-42bd-9df9-2718a97bf539","c3eec6d5-b872-4ed6-ba75-306ec8006d88","7777cfa6-76ad-4976-8ef6-8f49c217ab52","6f521ac5-cfca-4580-860b-65df285f9660","fbe283d2-7e33-41ce-ac39-4b29f194ee26","c1de9900-4b7d-431b-a470-84c5c26eefde","dfb87d56-70af-4ac6-917d-1291d8ec7354","73feb0ab-635a-4c7c-8925-0bf551c61700","f0391877-6552-4b6c-969f-4effd300e264","75aacb5d-c105-4c73-8aad-bba3df0181f8","6f040c35-60bf-432c-b30a-096d494c5960","b8cf3a52-269f-430e-8dcf-e4cc860e0884","ad3d8b0b-22d8-48d1-9146-812b7ad4faec","0bc5a2e1-f401-4179-ba2a-c99bcae55190","179b5241-bada-44e4-8928-1efd1656c38d","c9443c7b-c803-49fb-bce3-44d4e9021454","27fdba35-578f-482d-b496-a98821942c35","b72f783a-5dce-41e3-9735-2cae3fcef6e6","3d811429-6bdf-489a-8f10-832380aa873d","de1cdbdd-9c77-4f08-8211-007a2b3401c3","307087b5-e940-46bf-ae69-fe3eebe91031","566b2711-4a9c-4d1b-a9d7-a2439f358674","bb957a92-76ec-4283-aaab-7fa77deba3f1","bef399e1-8841-4a69-aa8b-1471664c582c","ee6c3e86-3fd1-4164-9351-b31ccbc695f8","35eee73a-0536-420a-a6a5-125e0aad2d54","ddc2981c-e7fd-4880-81b5-86e0c4bc2ea1","14d1a2a5-dc71-4275-9b0c-cfc5a1b13b00","fcc6e15e-257d-4260-bced-da7d6aeb7257","10a07eab-3d8f-42d2-86fe-e58aba32c6a4","a929b937-0b73-427a-afd5-1896715abc49","1f87c3fd-3c99-484d-af03-7a6296dd09af","9b8c7303-4148-4754-ae47-da98ad15ebd3","06917ea1-367b-44d4-9e74-8d0a507d0a1f","44b19dbc-c008-4dc3-a203-77d28f5c1859","c87c2638-8564-444c-88c6-8d6231da145e","f3627a1c-aa76-40d0-956d-4b305813f3b2","0bf1bac9-af83-47e9-8bd0-987732d57348","3b9a8796-0d8e-455e-af31-f5b4631ae438","4728ffef-226b-423b-a730-c71d38e71d85","835f8d33-9268-42e6-9e04-a9c9db7acfac","0f844dc5-4142-4061-9e84-e0dd1ef71d00","44ed096e-f287-46a7-9222-f8f1e519b0bb","866ce03b-d6a6-4ce3-a527-b95118b56bd7","82c3118e-5e8b-4917-a921-9e695a1853bb","72630fc1-3d80-4b39-b7de-269b1ce5d455","039fba32-3bea-4377-8b42-04ff8e5dd3f4","9f115bdc-8fa6-4272-896d-2678970d3ef8","98772d76-b111-49e4-a9db-f000e9d61b03","960c9f76-30d6-4861-bc01-ce82ba1a8591","b830a9d4-06bd-4639-ba9e-2832ee81a689","912d82c7-cd39-455d-8ff6-9742118186db","ca827af1-3833-4a3a-8e82-c02552d820f5","bb439161-a466-4571-b5da-63f84b193474","a80ed33e-3840-408e-a445-b1099ce2b9d0","f24f8158-ecde-49ef-a51a-95b6ccc0703e","bdcdf14b-1f7d-471b-b4d6-e3cd244d12a6","e15410a0-4766-499d-a513-f536544bd2f3","ef512485-d49b-448f-a038-c6c71cfddbca","5f6d17ed-543a-4395-a5a7-04b3d2a35a55","48374a18-b873-461c-9d08-0127c6553204","d3cc5d9f-1aee-4ebe-90ec-77968c058905","b3558f2a-8ee3-472b-ab47-3d05b83e47a4","caca4605-2888-4869-8dfd-ef8f1dedab70","61c5eaf1-c511-4e80-9ad9-a4aab4edd106","1a49c41e-4107-4161-ad19-7161197defa5","bf154056-b048-4a3e-bb40-f41ec111791b","0c805a36-50be-4442-9a35-ed2907d70239","72955d7d-a8c1-4e84-a5e1-db637f53781e","e5c98f03-928b-4d20-ba01-e36382468187","0fa21220-95d0-400f-9fa4-5a95a046e9e8","ff889770-d18d-4b18-9f01-905a57cd9b28","2273a46b-12b5-483b-8f67-f4842f282967","47f7d067-7741-4113-ab72-6d12b8cd5786","e609dd4f-39d7-4424-b273-6eead26c7fe9","4ba726cb-4898-4702-9e05-4e23d85fd015","d6ec9638-6bb3-4b9d-ae4f-47122405e3eb","282a4fdf-1457-4d32-88cd-51d599481d71","eb12d79d-5dff-4d0a-ba49-02c7fd72e7ac","04576141-9d17-4d7c-a499-79590630e9fa","e0513925-3754-4cdc-8213-398c81f89d1b","25154d3e-5937-43f2-a47e-11509f34ce5a","59fd9e00-4b34-4e8d-bf9e-26b86323fd81","07b1a6c5-3526-4272-a35a-127684cfbcfe","e9642cc5-1342-4e34-b0c4-585321151347","a2bbdea8-2e03-4df8-9b89-0569c0ffd127","6905c1f8-6e8b-4e92-b3e5-5bf3059ce472","7cb6e153-76d8-4f11-9c3c-2f0c3b816ddc","8c37f1d6-19ee-4de0-a851-65ddbef0d642","1b65b28b-db02-4a9a-b596-26bd59ec9ce0","1d32c0de-c904-4e01-b56f-759c643c20ca","14fc89bf-4a6a-44ab-b9f4-79c5f997a73a","c352dfd4-67b1-413c-88ea-f7bf2ec8a3e0","bdb36fd4-ac83-4c8d-b83b-2884fa63f0fd","f7bdcac5-3454-4ffe-904e-ad4fe91b4b53","ea04b311-11bd-4872-9ab7-c15faadc3e3c","b03f9c77-daaf-432a-8573-71a931204d98","89238317-2b73-4ca7-922d-7c6df95f6bdb","33f2c6ca-7a7e-44d0-ba49-8e8e2897c91f","70b3c08c-cd4a-40db-9c2c-0029a23ba970","8de1c223-226e-46f6-9f16-36847f42b99f","4175a9b5-ea6e-489b-a2b1-70db5518f9db","f582c072-525e-4412-8f5a-68e8f9aaba9b","1b53b923-a77d-4bca-adc6-764ff78769f7","16a18cca-cacb-48ed-b1a6-72560e0ad728","cb5551ab-a47f-41a0-8a9c-ad134d77c693","75fd09a5-821f-4faa-a8f4-9f862d3892d9","75a93415-c9a4-4270-86fd-42664893cc7c","754b3d46-509e-4a4b-82d0-ec340114d5b5","42a45521-808f-4f85-9922-dc8bc583e287","a5b24576-80f8-415c-9877-45ba9d6e6033","58444e8f-94eb-4708-9f3b-6582245e6a9e","e29a8fd7-faf4-4614-9341-c55cce539b3d","f41adbea-5c0a-4b74-b222-d898d8ece92c","aa2398a2-6261-4995-bcf5-2423e8560336","cf48a687-67bd-4117-ad07-c20c0682662c","edbfd965-92a1-4291-b11e-f52d21184507","e7b453b7-98b4-4166-a97a-e99fc7bd6a35","d7768c90-8491-42af-b960-3575f5b218a7","9368e169-ec01-4953-b7dc-817398ab6e53","3477b696-40b1-4548-8ff0-a93e0d41fc25","e0ccdb5a-bacd-4d8c-875c-4f29c8786048","8fb16dba-6f02-4d4f-b69c-210a900f9e57","9a47645f-8880-4d04-8b1e-d49f9f24a524","ded667af-370f-469a-ae2b-16737d423cfe","cd19749e-355c-493a-a1a9-64be68ba9399","aa94fec7-7dba-4aa3-a444-d321c2e6e11c","68e75880-ea6b-43f6-9a62-f813972d8f40","8c6f9188-eaff-426b-9d81-a14c4148a34b","b17d77ae-2af7-48e3-be6b-0c70b1dadd61","3e2349d2-0ca4-47ed-b4b9-817e5daafb19","5fd0af8d-72f1-4b7e-8246-4c46b651c531","e558a94c-6104-4bfd-b97b-ac7a2cecce35","cb137291-1ad2-4c35-b496-6f87a469c1b2","a7d3d253-0bfd-4c9d-a9c3-3459ec3ee8d8","3a966f53-355f-4a2e-a25a-4afce1ea4a0f","eea1c2a4-4992-459e-bf8c-735bf96abbe9","57c9d2f6-7086-4d8e-9d5d-1eca18ec8891","06334913-07b1-4622-9b2a-370cf56f0007","74dfb5af-738b-4a0e-916b-ce1970ec85cf","ba72173e-c456-46e9-92dc-73185c654d77","1887f846-11e7-4ab2-b816-c2e8c724718e","9ac64262-cad7-44f3-bfae-96dabec9e770","5b51de44-604b-4a96-b421-9f3e3cf470d2","b9626438-4451-441c-9608-35ab50e3b182","eb402bfa-b46f-4f51-878c-37aef629d3fa","89c371f3-766b-4dab-bde6-d23a97952cd5","ff21bacf-9b2b-4dc2-a715-02cf94e08015","87c07fd3-dcb2-4ba2-8855-927206bfba62","ea69e9ee-ee67-4f2d-83f6-7f862a8495ff","958b2624-6de2-44c8-bf07-ce363d450a28","67a391bb-2b1e-4fb6-b032-dc006e236e6e","e1218662-df9e-477c-bf3d-805e9b420911","697d17c4-4597-4949-9c24-c220aefc31f7","3d6561ad-7ea5-4c0e-9b9d-3280be3ffcc7","0f12132a-db77-4cdb-8b24-449d623a9010","05017ffd-160e-48c5-a6cf-67d04a45f53f","92cc7ea8-55a1-486c-a2ba-71c5093628aa","0821d4cd-353f-431c-bc63-5b51a7971bf0","4c801bb7-cb1b-45e3-a5eb-5aa31bbe1098","5c94c383-f6b2-4cf3-aff8-d629519c5fcd","b989c735-bc3a-4695-a7c2-9496aa28b8a6","a9019468-ed82-456b-854c-c08adf545757","4a898da1-68ac-4794-a30c-1fb7135776eb","aaddc9ad-2a6b-49cd-85a3-e80f4a04c5b8","6dd32bf2-72f8-4e62-bd77-870d9cc9cc99","949b3963-dbea-4abe-9590-97c7cd361209","897a2735-0e80-46da-b6f6-58fc3df53086","cdbbe77b-4b6c-49f0-a006-c1cb7c053d15","61a5c696-b407-4e63-85a8-b57f3f935cbb","42e9c365-194e-49b2-a7ac-d651f12c8cf7","fd81a9e6-b912-4f81-904c-a52526f6dbda","c46efa5f-a694-475c-8663-040a95fb807b","4adffda2-b85f-4660-b450-cfe09c9b0738","bd5cc0b9-d2e8-421b-9c88-de91dda82774","e9bc2136-0167-4fec-a72d-737571f7b027","0f93fc48-ec04-445d-94e5-ce4ed8b70c87","db3c3399-ddb8-4bae-9e89-1b0478931527","f3dfe652-b303-4177-ac57-10dff07f906f","56f414f6-20c9-40e8-8ff2-29784f768d1c","644c1c6a-8d94-4041-8dd4-5fb6a2aada91","7da30be9-2725-4226-9247-2a8fbf5d3d71","dd5540c5-fb12-49f9-b94f-5ffca3054ba5","b4f7298d-08b2-407a-9bee-50dbac0a7f00","7a950eae-90da-4885-8157-68009c201af0","8da6e187-ca72-4c85-8640-517601e1271f","046c0e5f-7098-42d1-b754-64fcc6276660","0b1a2c1b-3b18-4a55-8fa8-08fd5985aa4f","1abf52e0-b652-4629-8353-e2fc1ed8f046","bd871031-b4ad-417f-8082-5fd7bf3c805d","e8d82ad2-a010-4448-a29e-bd19ddf655e7","13d638ec-4f82-4318-bfa6-1f636643dc46","eeb6fd30-006e-4f99-b4c2-40931da53359","4c86679b-7ab7-407e-b863-2a8a46b82a8b","0a0b7aa2-bec5-46e7-949e-fd54ef7bffdc","d355b3d8-545a-4720-82f9-2a0243d72407","dc7a8827-25ac-4443-b8e1-c7de2304eb25","79ddf4d1-9031-4700-b30b-8db26a7b02af","68b8c5b5-7836-476b-8a02-af5b500aa180","e118777a-a087-4a6a-ba10-699cb73b06c4","b4d83009-a10d-4eb4-a04b-ff3dbc8e1304","1c3735df-eb4a-4a7a-ac45-a12b8c6ddbf7","412cb881-aecd-4cfd-8187-cbef4f6d70bb","3d875026-6da6-4cdf-ac18-084706a3eb24","f992976c-ecb4-41b5-ae2c-b25d48707701","90b462a0-5cbe-43d3-8de1-04926b96d492","a28036b8-5a0d-4867-9d8f-dfe034d6ac77","34e78ee8-d46b-4bd1-accb-8efffd17e7f2","1aacaa6e-3718-4b6b-9436-e5cf747a85f5","b147ba74-1764-41ec-93f2-47694e1b8ae3","f8243ce8-45a0-468f-a949-42595e728618","42496cf1-408c-45b5-9492-90985b5d933d","ee70e79d-2c8e-4307-81e3-5e8d1e6cdc4f","833ac885-ef61-4748-bd02-85e3e927a7da","da2975ce-c5eb-4f36-9ae5-541d74b0b370","edc45a1f-e2b4-4a8d-8868-c5d33027ff65","0907e06e-8884-4cdd-bc9a-766dc771049a","22f3e6fb-90b9-4cc6-bd8c-7d97998ffb9c","020a62e4-c5b4-4280-9872-3bf56fa34803","be58e424-c2ac-4835-a482-1083af3f75db","f3a92c2d-1fe4-48e6-b07e-52bf0a73735b","5b51f361-b0a8-4442-a095-4e781cdd2a38","476b5d8c-6d64-49fb-b664-d5c3b19e0dc6","bccc09eb-c3c0-43e1-a377-73ede6bfdc93","b31728b7-f4c4-4870-85dd-e4e543354fa9","4d2f560e-ef38-414b-b78c-c6b400f6d521","634abe84-7bfd-41c4-8ca8-8f2d8d548ec5","06c04e85-a23f-411c-8134-7d75ae627ebb","4c007793-6634-4891-b899-f709d3f8be13","90f9e4a2-b696-4f0c-ba98-d2856619b921","011db133-fd04-47f7-8fc1-255d2bb63e0b","652d83ae-50de-45da-8086-33749e5a8484","dc42afef-e4eb-4f39-9414-30cf73df3ec6","dd47099e-f772-48fd-97da-0396514afd22","9a0a5a76-bca8-44f9-87dc-65384c3a217c","99dcd6b6-61a3-4a17-945c-3e7be66ea38d","30b77330-aeed-45ff-84cc-fe68ff1f8f3a","f5157133-84a3-4904-97d4-07ee533ad17d","5ff9e66d-d71c-4449-825f-2f40aea916a7","05d2906c-0d7e-464a-86a7-e201ef984fdf","46500981-90b0-466c-ba96-7c8cc3abe6bb","66e403e8-7381-4576-a3a1-55b3e5562142","b8f6fce4-32fe-44d3-aa93-1f2b98735a46","9a87eddb-b5c5-4d26-9c05-2ebb3bc25c38","d7608a6b-48f4-4155-abcc-e3f816d76540","5b1ea383-85a8-49e0-92db-c5314fc2bf60","09c9fad5-8783-4bc5-823b-ee96006c988a","c6754733-1cae-447c-87f1-7dcc97ec3c91","e75096b4-c1b9-457c-a0b1-08bb16a9ccb7","184316f7-5174-4e40-ab49-9d0acc795626","1d1f0bf1-ed8d-4b28-b95d-2d45951f6bb7","e4bcde5b-a9af-4ca3-8048-84ed66114db6","fe748adb-5348-4b99-9550-eb578d1267fe","77af2dcb-2afc-4346-afed-eb4a056e6aea","4e041ef3-1f42-4185-a27c-89f919eab933","87546bbc-daa7-45f8-a9a4-1d3fb0dbccc8","c45fab4c-5aae-47ec-a2e8-3eff476212ca","83b9fbc2-90db-4d77-805e-3e5439c3cf94","81bb64e8-81e8-491d-8f87-d08a1a563293","7c02ebd1-16b2-45a2-93c0-276a9b2b802f","5ba31d6f-cb0d-404d-ba7e-470460959007","52308efd-956f-40f1-86c7-121262bfacc1","f76d2214-119e-4338-a84c-976c0f816f8d","d80b366f-38f8-4f43-b773-5fd57180ea04","7b2a23ff-8a2d-437d-927a-d3ebe2bfad75","0397fc82-ee33-457d-b0f5-ee1d6cdb96c8","c11cb495-f207-4780-b893-c049f88cb828","29927ba5-b792-45d2-a9eb-92009c88f23e","4c3cd83e-e143-4a16-9c5a-fafada32b0d1","65767cff-5517-4446-bc54-ab2783fd245e","2a5c0225-dc76-4cdf-9505-bef61cca3074","e687822e-f385-4a3a-b52f-e07dcf1eb946","85dbea68-b96e-4807-a076-fd2e76050c56","f3bccfd2-1ead-4101-8fb8-fd91e9264c47","93aaac98-cf8b-4647-bec1-75cadd34b277","5b6740a2-5ecb-4333-9971-ce9122536803","d138d7b0-547f-4a7a-aa7e-f5905d6f93d1","57ba4b5b-cda7-4fbf-a84b-d390fa8cb998","67e3ad55-b09b-45db-9e1c-d19f6cf42f75","c79374e2-375f-483d-b911-fcf31f5ab260","7cdb9ea8-6ba6-4e96-bd55-4a088f564c1a","2b8820f7-aa83-4844-aa7c-49f65e76ca13","5d695d09-8b83-4974-bbfa-e23db25c9777","965b2b54-ddd1-4aa4-ae8b-e9063f176508","cd7e1241-257f-4fb6-8a47-b58c44fa7fd8","144276a5-081a-491d-a7fe-1d2c302c3c77","48a232b8-2bc3-4e9c-8a19-3a6ea3b0a4f2","eb9db865-87c3-4c9f-8fc2-b616f33a191c","5a05fe82-51e7-4dec-be56-9ee88e1dfb09","1819b87e-93f4-437f-a576-a81829aea8a9","ad85e229-b68e-4609-b15d-7fb83cc57440","ac64ba9a-7be1-49a1-b3c7-ab03eeabb887","a04035db-bb1c-4a4f-a401-46b2852b69d5","31118d8a-d030-4990-ab6c-c1903e25f52d","b55a8da7-da4c-4f95-b24d-df30c2f45c71","d004e080-0446-4f6d-b7c1-e23a4112e42e","2229861a-a659-49b6-83f7-04532904bcaf","c627a829-9cce-40ba-9f5f-658730381474","cd180496-ae10-45de-b90d-ed645113e574","9f85c044-5eb6-43c3-8067-f3a7c605e90f","0428cf5d-33df-46de-bde7-15cdf830836e","2343e042-1a90-4156-bb85-1b4796cef497","f1559f2d-b7fa-438f-8203-314660014496","1137fddf-9bc0-4096-a8f7-60299e1045fa","933b8d80-00ac-441a-b7f1-ff89747a96ef","04530f0c-0761-4c13-8d09-9de1f762f1fb","47345698-eaa6-4dff-a289-a6166b7ed7de","73d74b26-c367-41d2-9631-8b0870281364","f871a524-8782-4e18-82bd-b37c9a02d20e","1cb94ea7-851b-47c4-9779-ca6e36ff729e","d825ee6e-087e-4529-b9c6-cc872035a99b","a0813507-dd48-4247-9e11-5591505be841","22e4f4a0-11e2-48e4-971f-45b042ab5ffe","f2cf7d5a-be29-4778-8716-2ba8052782b5","f7dcc389-593f-440f-9d0f-f2fcb13969b4","f1337a6d-af6e-4577-b393-b1b951b29caf","b0221a97-158b-40c8-9fdb-96de7f828d6f","ebeec459-313c-4cc1-b10e-1d1fd89379d2","67fd654f-5f30-4da9-a9ac-c3a00e62298d","ee5fc60a-9b57-470e-965b-016a9c78965d","1a69020b-4480-48c5-863e-0d362dadc4c5","07cedd59-44b0-4cf0-bb2f-71c15d4d959a","d9deb1c2-2e23-48c2-9df9-d45053a3d7c9","749d0431-47c8-491b-b325-2632a3450efa","3e688f6f-dd89-44a2-990b-1fbebfe4c545","49b38afa-be03-45c9-9709-e99f0fa29896","c0f9dd57-cb4c-4275-8c2c-923bf844fdcb","1224bf88-115f-4ccb-9990-9193ff2c38a5","0e60c769-183d-4657-9a98-b4348b446275","3a47f793-6767-4fab-bddd-acfd43149d5b","345b4e0a-1cd4-4bf6-9647-2830ff18d5ec","8f3857a7-54c3-4a78-8b47-5826f8886fee","dfe91161-0409-42bb-adf7-a97310d6a5e7","49a239b3-6587-4943-8518-ab1f6aa0c200","42f690d6-1db4-410d-85b7-5c89d567ecda","5632a03f-c43a-4560-86f8-9c85313f4164","5ecf0ee6-6e50-4b3e-a08e-62c57333a30c","073ca394-eaed-4b85-a191-6f44fc33ee41","538b78d9-928e-4ad4-b15a-34b37c96ab37","424d82df-9b44-41b5-b611-a1c29ee8ba3e","7a913969-1603-411f-9d1f-cea873782252","b67ce306-a79d-42b0-b2ea-030fc537611e","73aa919d-2805-4438-848b-8349c3f65fe0","c11dafa1-9f92-4f55-8fb7-4e1661bd8fa6","8d9c8281-961f-4c0f-94d3-c50222841c73","98846fb8-3d54-4f77-9d36-414234d86ef6","33b07269-76b3-44d8-9b67-8e101b1df37e","09556661-5d31-4e2b-a916-40772339c29d","a0a3bb82-6ff0-41b3-8b56-65bfad9bddfe","0de62cce-27ed-4c27-a27c-ad4ff7df3cb3","cfaa64e2-78ef-4426-a6a5-9c97b9416a9c","fac15e0e-1c6d-4f78-8b8b-0f64c67559e8","628a2e25-26d3-4ad2-af01-47435cb033aa","7d775bff-9e67-4e9c-bdf6-657139b0c7e3","c69ae828-ce06-417b-8d30-193e8f051c03","4d3d6a95-ba15-4d1a-ab3f-c62584729c22","40b390b6-94d7-4328-879a-4c44fc289ad4","fdebe0c2-395c-425b-ab3b-b460431c9f62","8885799b-3107-4637-8d53-e1a9c3699875","b6f9434d-abba-4b06-b4c5-802dd940be7c","f563cfb6-381f-49ba-85b1-7a59d873d828","5964fc7d-d005-414d-8ddd-f600e78816fc","26655761-99f0-4668-abd0-e86f18515d7d","a9fdbb7a-f803-49ba-b75d-cfa1a3742687","a17cce9b-db68-45da-8f95-44470ab22288","92fe12c4-d11f-4721-830f-acc1dc7ae238","fe508199-026a-4d25-8f86-4863e133ec55","a3d9e508-d6aa-43f0-81cd-bc04671db8e3","8131a139-1b1c-4eda-a538-5f3ffd99a260","eb1a4b9f-2727-4e6e-868e-5120a6f2a48a","f8a4db90-da62-41d3-a74f-fd50fc4f5458","b5c44d60-6655-4f28-a7a0-edd81828f572","6338cbe2-021e-406d-9bb8-88f1ddf0cbbe","51e3a828-8857-4d4c-907f-289e425fff1a","5ca2c593-796b-4ec9-a6af-0f9b56419b9b","41ecdb08-d684-418c-ae6a-6e459f7b7e39","b0df2874-6a4a-41f0-ab0a-74ffd9a58638","814f566f-c8da-4034-8ea5-dc73d1041280","7d3ffe57-f411-4116-97b1-5da284fb32f5","2731005d-3f2c-4d59-af95-857605008540","5c186c47-5c84-44c6-9019-fb1eda5ab042","4ae28606-869e-475e-aa55-6497ecb88ffc","1e9e7223-cf3f-4483-a682-c4da7477279f","e1473692-e4ad-40e2-a560-349cf8f67dbb","ed8ae3e6-b566-4e62-987c-f5d529774521","4e4db2c2-8ccb-4bfe-ae24-3562d9bbc9b1","7293bd3a-0389-4060-862d-33fc45dde040","c969b419-b18f-42cb-99cd-d361018bd4be","456f3b5a-9909-4d60-9810-7a8604038228","32b5f3ee-c089-4dbf-9f4d-afc4753d3ca6","35489a7a-2c8a-46f0-9ac7-b057f8310ddc","2278e74f-c3a5-46de-bc28-c6f4248b1f00","37dd0d04-d5bd-40a7-b057-3aa0ce27c438","f30afd5d-3d43-476e-96ba-30f31569e913","93c85785-8b2a-4305-b81d-f42431891bc0","b14624c2-72fa-44e9-a8ec-c9d82657e130","6dc57f42-9f7b-40e4-ab76-053508dd1cfb","17047d04-360c-41a4-b396-798269d987c5","15978e45-60a6-486a-bdfe-71c6359eae43","cd0038d3-3aff-4bce-aedf-d2caabc0ff24","38ccea82-6607-4013-a099-9e1d2dba1c29","bf90ab92-062f-4db9-bad7-bbf3d2de6203","c5a2d542-031b-465e-8227-e25357b6824c","e267772f-7f8f-4ff2-8420-8a74e70cbac6","f9131d21-248c-48ee-a7d2-0a955bc18143","e82516e0-a77e-481c-87f3-0c6111a60dee","78d7784c-3e69-4e7e-951e-b141fc903c01","5a86d993-6611-4359-b89c-090341d3cad6","60f6e613-1c1f-4e0c-ade6-c1d1df66c942","4f47a4f1-f305-4c53-a102-4c87a1140962","899c1257-4bd8-413e-8c22-15217d3bf246","dc37be6e-7432-43db-a5c4-85c3a61a41bf","b9a001df-14be-44a2-bd41-a91ecd393375","45efbfa5-1720-47fe-ae18-37f7997f2a9a","0da47389-92f1-435f-acb6-b6b88feb8cc3","18819350-9c15-44ef-9d3e-bea11c4f2a31","bad9dc3b-5768-4d3b-b929-cc30b44c6780","2c27388a-7069-4004-b793-7a46d671b9cc","8f94bda0-a5c9-4d38-9367-f76ba52212e5","c6717003-5b76-4978-bd64-e45a9815d9ad","2d189307-1cf8-4374-9357-32f7f719fdaa","4d6f6eed-8b98-4db2-82af-3c4459822a67","05932da9-e597-4c69-97bb-3178abe38ba7","76736415-9cd4-405e-92cc-36ef7fd42af7","35c2b473-7820-47de-b4e4-04001621ad86","c59c055e-e32d-4a75-9637-672fc770456a","927d26d8-a163-40cc-b8c0-95aae0d4c11e","9d09f6b8-402d-4023-8277-d73ef25bfadb","439e0c29-cea7-411a-8c43-f45fa2151183","d6ec245c-cddd-440e-b0b1-81330cb4a693","830701d2-8642-447e-9b42-41bc8cf0df9a","9a6bd000-39e6-4336-9bce-bfc1e0e4f59f","85770327-8f9d-464e-b0c1-5b8e9959e881","4867da7c-1548-4c15-afe2-105d99fca78c","34df3977-43be-4bcb-a7d8-89ef602f253d","7396298f-9fa6-48de-bc19-f7a13bd5ba35","44ee4609-b70a-4577-9728-a9d62330a30e","2c3e349c-e1ea-4089-b4af-20ba6836c694","250c35ee-2fa5-4eb9-b0eb-c7e46c240f3f","e4091305-7e34-41c2-b2e0-7eb6543f4710","02beaf98-46f4-4de2-a54b-9c6369d5409e","d6a2cc8c-7689-4cd5-802d-64373cf7ce8e","36e2df71-8508-4161-b4e2-cefb95aa211e","dafcf971-afd9-4346-a02a-198a71c4fd1f","813ff5ba-c59d-4597-98a9-a349a4b4008a","09c278d6-282b-4553-b1a3-0ecc88adb1ae","e578ce9a-42cf-4124-bc61-c6eb083de860","c25d1c6a-0ff7-4fce-9a3b-6f0d8669f75b","deb12fde-ed41-4923-970c-b8f29dbaea2e","8d3de27b-fb2f-40a8-9527-7c20df05cc8d","00ea135f-a479-45e1-a548-1f22f49ff99b","2bdd0d05-3d1f-4d51-a699-9e69435aab0c","8c371dbd-1a3c-402e-aa75-331025962d7b","83d0a451-567a-4e25-895a-62ead41abb09","310a39f7-be67-47aa-a92e-178da5267ee4","27e68f03-e28a-465e-a81f-336307432807","9f020f1c-ed8e-43fe-a4a0-1ba5c1b005e4","3348bfc5-29f4-4a7d-bbab-72c173fc43f2","24c2d68c-ea31-430c-a60c-718c61628680","bfc49a80-d536-48df-a7bb-b6e6b76a865f","6f5ce424-89c3-4459-ae53-a4945b232dae","c5906279-6c27-40e9-81e0-b440b781dddd","cadf74c9-8649-4b86-9eee-c1484a480745","460843c7-1b6a-4089-8f59-3413e3a5b6f4","6fae06c8-6ad4-47ba-82dc-8af74c6f6834","0e67e333-1728-4aa8-ac78-78a80bfaf00c","f04f5325-8bef-4a11-8dd1-7aee77bd888b","e3fa9fd5-10c3-4e52-88ae-9cb554776ba5","c9d27ef3-e2d0-4f15-9b26-76c6a0ef5c76","01f003ec-b90a-426b-b4f3-963bdb77a0db","4af52f7e-86d4-439f-9ff4-e11717f1c78f","8e76bce7-7c70-4854-aabc-ba8772740776","01fefbbd-9750-4fdd-a775-ccc4b2f43ea8","d77b6817-b98c-4827-a163-f4bfc77b5785","cf30353f-7429-4e89-b992-67b7dbe6ecca","a9056d36-db54-4e74-855c-6749a363dd21","6e424ac3-047a-4b53-b527-0d3689f94f3d","6eaa925a-29af-4359-9560-b8347e47f6fe","92b29e7d-c8ba-4cf2-a42c-f7e885704f63","32fbf9b8-4d95-4c94-9c0d-4ade7df6f586","f579b995-1c59-47d0-aca2-0d5c7b7802d9","4fad536a-fbdb-4acd-8e98-c71f64a8c88d","52d017d6-c4f9-4250-b478-b587d0ab6130","328ceba1-e265-457a-882a-41bbbb0e13e7","f281bde8-1b22-455f-ad21-843533f32437","bc5feb55-c4d3-4f3c-b07f-d160e1d4fb69","53368c52-10b3-4fa8-81d9-d6dca66bdd8b","d7d8b44d-0d19-421e-b3b4-4cb27442e225","75748896-5a01-4af3-8ff1-e63a8448acf6","7f1895e0-ba4e-48ac-85fc-8f8491b8d136","a504ed15-cddc-408f-8521-f302c6013c59","4aeb7590-be76-4ed6-bf30-339680701d77","4b9f4739-40d3-42c2-9868-605478b8dfb7","90bedd71-d96a-4b6a-a8eb-b783151461e6","4b9b3c6f-43c0-4652-9e0c-c308dc5bd091","89194e22-7505-4e71-9089-b2b21473ae2c","6efa3aeb-a5e6-4deb-9995-12bdee1bc77c","813736a0-b2f8-4998-b526-a0702f07f3f7","d99ec63a-e805-40a6-bb2f-c15a589241e0","269bb4b1-693f-4e47-844b-f181b6c92137","3bb69b37-9033-4507-8777-1a290c2074cb","5b31bc69-877b-41d5-a9c5-94460219ca5b","55258282-a6c6-4a33-afbf-70a927aa4c7a","1b74ea0a-9cd0-4f35-8070-cbed478058b1","91f94047-dcef-4d55-a243-9222d57dea3c","626a046b-e7ad-4795-af3a-9676745688b1","cd8e1b6b-7c3a-4e27-8473-c927becc83e8","2c76610c-703f-4246-9937-d21590f8dfff","ec844790-40e3-4651-8ac8-0263bf457b50","229e1236-0e31-4ca9-87a9-14566d3eb47e","805ed1ef-3805-4d0a-a165-9113872dd4d9","3f8bd200-0916-427d-9faa-fc20e4e17491","3dc84eb4-3ca6-44e8-80b8-85a74f989a5f","ab72f8f7-2e66-4adc-8056-5034b9417e87","ffd13238-71af-4015-8cb7-a633ead39d75","cc0f64ab-f56d-4dae-87e9-b77931ce4b7c","2007f60f-317f-4c63-9d0a-a9fec1968026","0af9b723-7a50-4db6-88d3-ca9eac2521d1","b1e3b467-7928-44ee-b131-d4689d2c9fbb","64de2a69-5822-47e2-affb-0138152703a2","003222f5-d07f-4347-a61b-bcabb3b852c1","66ed0ce7-e2b1-4c7a-bd7a-6e1901de2400","397ab7e2-065b-47c4-87d1-1b3119d20e7d","e96547f7-1f3d-42b8-a4ca-9bfbf2c0728e","36cd4db0-a61a-4b36-bbb0-0f87d0a7b7e0","00e361f1-9021-450e-bf35-fe48f1fb6844","ce6bbda4-1b44-44fa-983e-e5f37b89895b","4cd0eced-e273-46c2-84f5-a7efd7fbdd2f","82be252e-5184-44cd-a91b-a7d6ffdefac6","bea8efd0-61d7-495b-a255-5c1f40753cf7","12a6eaa5-30f7-419b-aee7-1be2dbc7278c","75db54d0-46ad-43b1-8ef0-7556ce0e9069","89ba9061-3275-4d76-966f-11691fdfd72f","0eb824c6-f768-47bc-9204-d94dbb912c6e","09f3541c-8edb-4603-9bc3-02bd22cd7836","b13cc3bd-a0a3-4b61-b482-63051d7804b5","b2b10be2-1b2f-4a48-a453-532657bd8e92","a00ebb82-58f2-4b40-89ee-a65be3befabf","6d1f21ba-36cf-4c90-9ecb-d5e377942f3a","50a76940-a26e-443a-b752-1412855e6ad7","30fa18a6-609e-4f5b-af3d-31906c46fe23","3afd60d5-3ce7-431a-b812-2c836b7596a3","dd2f1d05-d4ef-48a0-899c-10fe0346a447","ac411712-ee48-4589-828d-b4e5827efc17","0c5be7d7-cfcf-417b-824a-1a280254a58e","35c18cd6-99a8-47f3-91ee-40dbfec922fa","017372b2-9d34-4118-ad13-9b8e15c30ebd","035cfcde-4292-4905-82b2-6517e58a28b9","bd0b93b9-a0e9-4582-a164-98acdc7a5b45","ecdfe65a-28ee-46d2-a82b-99573e3dd63d","56dd4a06-5073-46d2-8aca-8e37d90e5610","1f8febec-2e84-4be2-a67d-7b5165845a4b","ee67a0e4-8343-4dd6-9636-9504cae6c573","eabf4d1f-9a77-441f-88fb-de9e9e0dc26e","56ba9c1f-2a28-4d05-910c-e89fb051327d","07ffa801-adfb-41f3-809b-87f69ae9e9cd","27fa9add-6ec7-433a-88c9-58279f5055c3","24c31e38-d546-423f-b3cb-a0533e711d02","6e87073b-2877-44d1-9df7-2dd266bb35e3","d6367cec-2e43-4558-882d-fb9a00545fef","172fd543-704b-489a-8d2e-7d1255f51bef","8f27f9ff-57f2-4c07-ad65-55c7f7f7501f","24f220ca-372b-4003-8e74-13291220c778","e16c2241-0f08-4946-908e-c5e6612b0a8c","2e568628-70b1-4f35-934e-81ea4263d0e8","3d8c8d33-f904-41f7-a3ff-b6272c633079","9aefc3b4-f172-4917-b1c7-495c26ec37f9","4453c56e-831c-4203-83fc-9736e276b7dc","6239e7bb-e6a6-4cb4-b4fa-236035bad7f7","95dafcd5-6243-4838-bea1-8e19b0596f6f","34d8ae09-8161-49ec-ae2d-c188c477bb90","cb2a5d30-074f-4c07-97b5-61147e0ea504","e950a58c-0d6f-42c3-8225-9e7adc5d4182","bfe1c963-57ad-4ed2-a9f9-65a3e65f61fd","4ba67e59-362e-4fee-9a67-da423ceefa54","6e41b1fc-a49b-491c-a312-13578c137ab4","037b290e-c8e2-4985-9859-83c40b32b47a","ed447931-f637-4b99-ad61-a2d9d6292ed9","46bcda2b-ec7a-47cc-bcd4-255bb39d310d","61430569-a0c3-4804-a0a3-088135cbbf3e","8e9658b3-1879-43ee-8dd0-aa453db5102d","d8d61f33-8960-4603-849b-b4d1f13a6d36","ece03bf4-b8b2-477a-abe6-125ed58de706","e7bd67f9-1c39-4ac0-b9fe-3441fa74bc14","1ac86639-060b-4e5d-8801-5dd0a40743ff","3ebbe91c-2198-4cd8-8558-ca0b7b47464f","c3762916-2f17-40e0-bd88-12b9442756fd","fe341c1f-ce4e-4845-a24a-802d106b1c80","b5bc1d11-c24d-4523-b371-22c3ee0c4253","0c017ea5-219e-4212-bfdf-89f2ea88187f","39365f4f-a881-461b-97e5-d9aa4ff49498","37f70389-a5e2-4fb8-840f-8cfe940662ef","5ab11760-87f6-4b8a-ae84-206e92aa9009","2486c8b2-de46-4f07-8df9-00ac5080303e","453e1a27-0815-46a0-a5ad-b55267008588","a91e6b04-d782-4974-b523-6c4519a54f50","2c2559b7-77fa-4a0b-877b-2b9769a0caab","ff21f4c6-5ca3-4bb6-b795-aeb1c5b2fe06","845cb0c6-34d2-46fe-9d44-adc3dc124c80","64917ef4-eb94-4a23-a8dc-cb07d7756103","6c5d4d64-558f-4925-8168-b1a96613b0ad","ffb3e282-814e-4b16-a707-5efb54961ba7","7ea58f0d-22f4-4c96-8188-42319c1509ae","1e371f92-dae2-43d6-b029-3d4d1ac8acd9","47a3e557-3e63-45f6-beeb-f7f767589a83","d6070391-2f76-412f-b5a5-bccbfcafc4e5","a96635d9-4dfb-4970-9671-b8f64a5c080c","2238e3ac-7da8-4c47-a13f-854c0576fbd4"]);function i(e){return o.has(e.id)}},94826:(e,t,n)=>{n.d(t,{Bb:()=>c,EY:()=>y,I$:()=>_,RW:()=>w,Uw:()=>S,ZB:()=>v,uw:()=>I,z6:()=>k});var o=n(15070),i=n(5366),r=n(4615),a=n(97880),s=n(64002),l=n(63143);const c={headers:{authorization:{prefix:"Bearer"},hmac:!1,extras:{}},body:{path:["event"]},urlValidator:function(e){return(0,s.yn)(e)}},d=(0,i.defineMessages)({nightfall:{id:"temporaryWebhookIntegrationConfig.taglines.nightfall",defaultMessage:"Simplify security and compliance with Nightfall AI"},panther:{id:"temporaryWebhookIntegrationConfig.taglines.panther",defaultMessage:"A SIEM built for speed, scale, and flexibility"},sumologic:{id:"temporaryWebhookIntegrationConfig.taglines.sumologic",defaultMessage:"Secure and protect against modern threats with cloud-native log analytics"},splunk:{id:"temporaryWebhookIntegrationConfig.taglines.splunk",defaultMessage:"The unified security and observability platform"},datadog:{id:"temporaryWebhookIntegrationConfig.taglines.datadog",defaultMessage:"Detect, investigate, and automate response to threats at any scale"},polymer:{id:"temporaryWebhookIntegrationConfig.taglines.polymer",defaultMessage:"Protect sensitive data across cloud apps and reduce the risk of exposure"},onna:{id:"temporaryAdminIntegrationConfig.taglines.onna",defaultMessage:"Connect. Find. Act."},hanzo:{id:"temporaryAdminIntegrationConfig.taglines.hanzo",defaultMessage:"Manage Risk Everywhere Work Is Done"},aware:{id:"temporaryAdminIntegrationConfig.taglines.aware",defaultMessage:"Secure Your Digital Workplace. Drive Growth. Scale AI."}}),u={id:"a2768733-a1f9-4174-84fa-40a9ff2053d7",name:"nightfall",icon:"/images/external_integrations/nightfall-logo.svg",website_url:"https://www.nightfall.ai/",signupUrl:"https://www.nightfall.ai/integrations/notion",privacy_policy_url:"https://www.nightfall.ai/privacy",terms_of_use_url:"https://www.nightfall.ai/terms",developer_name:"Nightfall",installation_info_url:void 0,type:"dlp",tagline:d.nightfall,webhookUrl:"https://notion.nightfall.ai/notion/v1/event",customization:{headers:{hmac:!0}},allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/nightfall",redirectUri:"https://app.nightfall.ai/dashboard"},p={id:"fb50a39e-955a-4b9c-9ffb-49587de2a79c",name:"panther",icon:"/images/external_integrations/panther-logo.png",website_url:"https://panther.com/",signupUrl:"https://panther.com/product/request-a-demo/",privacy_policy_url:"https://panther.com/privacy-policy/",terms_of_use_url:"https://panther.com/terms-of-service/",developer_name:"Panther",installation_info_url:void 0,type:"siem",customization:{headers:{hmac:!0},urlValidator:function(e){if(!e||!(0,s.yn)(e))return;const t=new URL(e);if("https:"!==t.protocol)return;if(!t.hostname.endsWith(".runpanther.net"))return;if(!t.pathname.startsWith("/http/"))return;const n=t.pathname.replace("/http/","");return(0,r.t)(n)?e:void 0}},tagline:d.panther,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0,integrationGalleryUrl:"https://www.notion.so/integrations/panther"},m={id:"3ecda536-3b09-4218-a756-bda416c512d7",name:"sumologic",icon:"/images/external_integrations/sumo-logic-logo.jpeg",website_url:"https://www.sumologic.com/",signupUrl:"https://www.sumologic.com/sign-up/",privacy_policy_url:"https://www.sumologic.com/privacy-statement/",terms_of_use_url:"https://www.sumologic.com/terms-conditions/",developer_name:"Sumo Logic",installation_info_url:void 0,type:"siem",tagline:d.sumologic,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/sumo-logic",customization:{urlValidator:function(e){if(!e||!(0,s.yn)(e))return;const t=new URL(e);return"https:"===t.protocol&&t.hostname.endsWith("sumologic.com")&&t.pathname.startsWith("/receiver/v1/http/")?e:void 0}}},f={id:"ff522b0f-e688-4986-9b7d-255627316f73",name:"splunk",icon:"/images/external_integrations/splunk-logo.jpeg",website_url:"https://www.splunk.com/",signupUrl:"https://www.splunk.com/en_us/talk-to-sales.html",privacy_policy_url:"https://www.splunk.com/en_us/legal/privacy/privacy-policy.html",terms_of_use_url:"https://www.splunk.com/en_us/legal/terms/terms-of-use.html",developer_name:"Splunk",installation_info_url:void 0,integrationGalleryUrl:"https://www.notion.so/integrations/splunk",customization:{headers:{authorization:{prefix:"Splunk"}},body:{path:["event"]},urlValidator:function(e){if(!e||!(0,s.yn)(e))return;const t=new URL(e);if(!["http:","https:"].includes(t.protocol))return;let n=t.hostname;return n.startsWith("http-inputs")&&n.endsWith(".splunkcloud.com")&&(n=n.replace("http-inputs","").replace(".splunkcloud.com",""),!(n.length<2||!n.startsWith("-")&&!n.startsWith("."))&&["/services/collector/raw","/services/collector/event"].includes(t.pathname))?e:void 0}},type:"siem",tagline:d.splunk,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0},g=["public_exportPage","public_workspaceSearch","public_getUser","public_listUsers","public_listTeamspaces","public_getPage","public_getDatabase","public_getSelf"],h={workspace_search:!0,workspace_page_export:!0,read_content:!0,read_user_without_email:!0,read_user_with_email:!0},v={datadog:{id:"97d68716-a483-4472-8fa9-da26215d721a",name:"datadog",icon:"/images/external_integrations/datadog-logo.png",website_url:"https://www.datadoghq.com/",signupUrl:"https://www.datadoghq.com/free-datadog-trial/",privacy_policy_url:"https://www.datadoghq.com/legal/privacy/",terms_of_use_url:"https://www.datadoghq.com/legal/terms/",developer_name:"Datadog",installation_info_url:void 0,type:"siem",integrationGalleryUrl:"https://www.notion.so/integrations/datadog",customization:{headers:{hmac:!0}},oauth:{sendScopes:!1,accountInfoPropertyNames:{accountId:"dd_oid",accountName:"dd_org_name"},usePKCE:!0,apiDomainsByRegion:{"https://app.datadoghq.com":"api.datadoghq.com","https://us3.datadoghq.com":"api.us3.datadoghq.com","https://us5.datadoghq.com":"api.us5.datadoghq.com","https://app.datadoghq.eu":"datadoghq.eu","https://app.ddog-gov.com":"ddog-gov.com","https://ap1.datadoghq.com":"ap1.datadoghq.com"},tokenPath:"/oauth2/v1/token",apiKeyPath:"/api/v2/api_keys/marketplace"},tagline:d.datadog,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1},nightfall:u,panther:p,polymer:{id:"9fb229bb-d287-45de-82f1-7331e99d9c6b",name:"polymer",icon:"/images/external_integrations/polymer-logo.jpeg",website_url:"https://www.polymerhq.io/",signupUrl:"https://www.polymerhq.io/request-demo/",privacy_policy_url:"https://www.polymerhq.io/privacy/",terms_of_use_url:"https://www.polymerhq.io/terms-of-service/",developer_name:"Polymer",installation_info_url:void 0,type:"dlp",tagline:d.polymer,webhookUrl:"https://umalik.dev3.polymerhq.io/notion/oauth/webhook",integrationGalleryUrl:"https://www.notion.so/integrations/polymer",allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_listUsers","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,redirectUri:"https://www.polymerhq.io/"},splunk:f,sumologic:m,onna:{id:"bb67e6bb-09f3-48fe-a7b2-428665ff20ac",name:"onna",icon:"/images/external_integrations/onna-icon.jpeg",website_url:"https://onna.com/",privacy_policy_url:"https://onna.com/privacy-policy",terms_of_use_url:"https://onna.com/master-subscription-agreement",developer_name:"Onna",type:"ediscovery",tagline:d.onna,integrationGalleryUrl:"https://www.notion.so/integrations/onna",allowedBotCapabilities:h,allowedEndpoints:g},aware:{id:"99b8b727-7eee-40f8-af16-de045fb78e15",name:"aware",icon:"/images/external_integrations/aware-icon.png",website_url:"https://www.awarehq.com/",privacy_policy_url:"https://www.awarehq.com/privacy",terms_of_use_url:"https://www.awarehq.com/terms-conditions",developer_name:"Aware",type:"ediscovery",tagline:d.aware,integrationGalleryUrl:"https://www.notion.so/integrations/aware",allowedBotCapabilities:h,allowedEndpoints:g},hanzo:{id:"2ebac254-9d38-4c94-b579-0eac7fe0f43c",name:"hanzo",icon:"/images/external_integrations/hanzo-icon.png",website_url:"https://www.hanzo.co/",privacy_policy_url:"https://www.hanzo.co/privacy",terms_of_use_url:"https://www.hanzo.co/privacy",developer_name:"Hanzo",type:"ediscovery",tagline:d.hanzo,integrationGalleryUrl:"https://www.notion.so/integrations/hanzo",allowedBotCapabilities:h,allowedEndpoints:g}},b=(0,l.m8)((0,a.qP)(v).map((e=>{let[t,n]=e;return[n.id,n]})));function y(e){var t;return null===(t=_(e))||void 0===t?void 0:t.name}function S(e){const t=_(e);return Boolean(t&&"ediscovery"===t.type)}function _(e){if(e)return b[e]}function w(e){const t=_(e);if(t&&("siem"===t.type||"dlp"===t.type))return t}function k(e){return Boolean(_(e))}function I(e){if(!e)return!1;const t=_(e);return!!t&&(0,o.ms)(t.allowedBotCapabilities)}},26109:(e,t,n)=>{n.d(t,{NL:()=>a,Og:()=>r});n(67266),n(19056),n(47247),n(68955);var o=n(72126),i=(n(4615),n(70203));n(97880),n(82798);function r(e){const{existingDiscussions:t,oldTextValue:n,newTextValue:r}=e,a=o.e5(i.llS(r),i.llS(n));return a.length>0?o.G0(t??[],a):t}function a(e){const{existingDiscussions:t,oldTextValue:n,newTextValue:r}=e,a=o.e5(i.llS(n),i.llS(r));return a.length>0?o.zu(t??[],...a):t}},67175:(e,t,n)=>{n.d(t,{Qf:()=>r,W5:()=>a});var o=n(97880);const i={insertText:!0,deleteText:!0,splitTextIntoBlock:!0,splitText:!0,moveTextSliceIntoBlock:!0,moveTextSlice:!0,addAnnotation:!0,removeAnnotation:!0};function r(e){return Boolean(i[e.command])}function a(e){const{pointer:t,crdtOperation:n}=e,i=n.type;switch(i){case"insertText":return{command:"insertText",pointer:t,path:[],args:n};case"deleteText":return{command:"deleteText",pointer:t,path:[],args:n};case"addAnnotation":return{command:"addAnnotation",pointer:t,path:[],args:n};case"removeAnnotation":return{command:"removeAnnotation",pointer:t,path:[],args:n};case"splitText":return{command:"splitText",pointer:t,path:[],args:n};default:(0,o.t1)(i)}}},7250:(e,t,n)=>{n.d(t,{$A:()=>d,Jq:()=>u,Nv:()=>g,OP:()=>b,j:()=>p,oG:()=>c});n(57658);var o=n(67294),i=n(29450),r=n(65454),a=n(4615);const s={download_desktop_app:!0,download_mobile_app:!0,sign_up:!0,onboarding_show:!0,onboarding_complete:!0,gdpr_consent:!0,create_subscription:!0,subscription_update_plan:!0,subscription_update_billing:!0,subscription_update_billing_email:!0,cancel_subscription:!0,click_upgrade_button:!0,create_space:!0,join_space:!0,leave_space:!0,delete_space:!0,open_support_chat:!0},l=[];function c(e){let{getLocale:t,analyticsSettings:n,deviceId:s,onVisibilityChange:c}=e;(0,o.useEffect)((()=>{!function(e){const{getLocale:t,analyticsSettings:n,deviceId:o,onVisibilityChange:s}=e;if(void 0===n||!n.isIntercomEnabled)return;if(!(0,i.hasPermissionForThirdPartyServiceBrowser)("intercom"))return;const c=t().split("-")[0];window.intercomSettings={app_id:n.intercomAppId,user_hash:n.intercomUserHash?n.intercomUserHash:void 0,language_override:c},!n.noIntercomUserId&&n.user_id?window.intercomSettings.user_id=(0,a.cj)(n.user_id):n.user_email&&(window.intercomSettings.email=n.user_email);o&&(window.intercomSettings.device_id=(0,a.cj)(o));const d=window.Intercom;if("function"==typeof d)d("reattach_activator"),d("update",window.intercomSettings);else{const e=function(){e.c(arguments)};e.q=l,e.c=function(t){e.q.push(t)},window.Intercom=e,(0,r.ZP)(`https://widget.intercom.io/widget/${n.intercomAppId}`)}s&&(f("onShow",(()=>{s(!0)})),f("onHide",(()=>{s(!1)})))}({getLocale:t,analyticsSettings:n,deviceId:s,onVisibilityChange:c})}),[t,n,s,c])}function d(e){if(v()){const{userId:n,userName:o,traits:i,settings:r}=e;if(!r)return;var t={};o&&(t.name=o);const a={email:r.user_email,user_hash:r.intercomUserHash,...i,...t};!r.noIntercomUserId&&n?a.user_id=n:delete a.user_id,Intercom("update",a)}}function u(e){if(v()){const{companiesData:t}=e;Intercom("update",{companies:t})}}function p(e){const{eventName:t,eventData:n}=e;v()&&s[t]&&Intercom("trackEvent",t,n)}let m=!1;function f(e,t){if(v())Intercom(e,t);else{l.push([e,t])}}function g(e){const{prepopulatedContent:t,waitForCssInsets:n}=e;f("showNewMessage",t),!m&&n&&(m=!0,h((()=>n())))}const h=function(e){f("onHide",e)},v=function(){return"undefined"!=typeof Intercom};function b(){if(v())return Intercom("getVisitorId")}},49902:(e,t,n)=>{n.d(t,{j:()=>s,kI:()=>a});n(57658);var o=n(67294),i=n(66673),r=n(65454);function a(e){let{isEnabled:t,isLoggedIn:n,userId:a,userEmail:l,spaceId:c,sprigConfig:d,userDaysSinceSignup:u,userDomainType:p,isSpaceAdmin:m}=e;(0,o.useEffect)((()=>{if(!t||!n||void 0===a||void 0===l||void 0===c||void 0===d||void 0===p)return;if(window.Sprig)return;const e=function(){e._queue.push(arguments)};e._queue=[],e.appId=d.environmentId,window.Sprig=e,window.UserLeap=e,window.Sprig("setUserId",a),window.Sprig("setEmail",l),window.Sprig("setAttribute","SPACE_ID",c),u>=3&&u<=14&&"professional"===p&&s(m?{name:"trigger-phase-1"}:{name:"trigger-phase-1-1"}),(0,r.ZP)("https://cdn.sprig.com/shim.js")}),[t,n,a,d,l,c,m,p,u]);const f=(0,i.D9)(n);(0,o.useEffect)((()=>{f&&!n&&window.Sprig&&window.Sprig("logoutUser")}),[f,n])}function s(e){const t=e.name;if(!window.Sprig)return void console.error("Sprig not loaded, not tracking: ",t);const n="args"in e?e.args:{};window.Sprig("track",t,n)}},9163:(e,t,n)=>{n.d(t,{FW:()=>i,eU:()=>o,lR:()=>r});const o={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]}},i="completed",r="dismissed"},41641:(e,t,n)=>{function o(e){return![".","#","$","[","]"].map((t=>-1!==e.indexOf(t))).reduce(((e,t)=>e||t),!1)}n.d(t,{Z:()=>o})},73123:(e,t,n)=>{n.d(t,{Fi:()=>p,Hz:()=>r,Rh:()=>s,Zj:()=>c,aT:()=>f,ez:()=>a,hx:()=>m,xX:()=>l,y3:()=>u,yM:()=>d});var o=n(5366),i=n(97880);const r=["last_7_days","last_28_days","last_90_days","all_time"],a={last_7_days:7,last_28_days:28,last_90_days:90},s=((0,i.AO)((e=>7===e||28===e||90===e?{true:e}:{false:e})),(0,o.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.last7days",defaultMessage:"Last 7 Days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.last28days",defaultMessage:"Last 28 Days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.last90days",defaultMessage:"Last 90 Days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.allTime",defaultMessage:"All Time"}})),l=(0,o.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last7days",defaultMessage:"last 7 days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last28days",defaultMessage:"last 28 days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last90days",defaultMessage:"last 90 days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.allTime",defaultMessage:"all time"}});function c(e,t,n){const o=e||0,i=t||0;return n?o-i:i-o}function d(e,t,n){const o=e||-1,i=t||-1;return n?o-i:i-o}const u=(0,o.defineMessages)({page:{id:"contentAnalyticsHeaderMessages.columnHeader.page",defaultMessage:"Page"},pageId:{id:"contentAnalyticsHeaderMessages.columnHeader.pageId",defaultMessage:"Page ID"},teams:{id:"contentAnalyticsHeaderMessages.columnHeader.teamspace",defaultMessage:"Teamspace"},audience:{id:"contentAnalyticsHeaderMessages.columnHeader.audience",defaultMessage:"Audience"},allViews:{id:"contentAnalyticsHeaderMessages.columnHeader.allViews",defaultMessage:"All views"},uniqueViews:{id:"contentAnalyticsHeaderMessages.columnHeader.uniqueViews",defaultMessage:"Unique views"},createdBy:{id:"contentAnalyticsHeaderMessages.columnHeader.createdBy",defaultMessage:"Created by"},createdAt:{id:"contentAnalyticsHeaderMessages.columnHeader.createdAt",defaultMessage:"Created at"},lastEditedBy:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedBy",defaultMessage:"Last edited by"},lastEditedAt:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedAt",defaultMessage:"Last edited at"}});const p={num_searches:"numSearches",num_unique_users:"numUniqueUsers",ctr:"ctr"},m={numSearches:"num_searches",numUniqueUsers:"num_unique_users",ctr:"ctr"};function f(e){return e<=1?"1":e<=50?"2-50":e<=100?"51-100":e<=500?"101-500":e<=1e3?"501-1000":e<=5e3?"1001-5000":"5001-plus"}},51454:(e,t,n)=>{n.d(t,{A_:()=>E,Bh:()=>j,D_:()=>l,E:()=>q,Eo:()=>A,Gt:()=>_,I5:()=>p,LI:()=>B,LN:()=>h,MC:()=>b,MU:()=>Z,Mo:()=>P,Nm:()=>C,Nn:()=>M,O7:()=>z,Qm:()=>a,RJ:()=>u,S1:()=>x,VT:()=>m,Wd:()=>W,Wi:()=>o,XB:()=>F,XP:()=>i,Y6:()=>R,YO:()=>L,_:()=>H,_Y:()=>k,ag:()=>K,db:()=>$,eU:()=>s,eu:()=>T,fQ:()=>w,hT:()=>U,ke:()=>Q,l6:()=>r,lB:()=>O,lI:()=>D,mJ:()=>N,nD:()=>c,ov:()=>y,p8:()=>G,py:()=>d,sL:()=>f,t8:()=>S,vt:()=>V,wx:()=>v,xP:()=>g,y:()=>I});const o=1,i=2,r=2,a=2,s=3,l=9,c=9,d=81,u=83,p=83,m=85,f=84,g=30,h=85,v=83,b=84,y=85,S=85,_=86,w=86,k=86,I=86,C=87,x=88,T=89,M=99,P=99,A=99,R=99,D=100,B=100,E=101,F=102,Z=102,L=109,j=110,V=111,U=111,O=113,N=999,z=1001,H=9999,W=9999999,q=1e6,G=1,K=2,$=3,Q=4},88642:(e,t,n)=>{n.d(t,{j:()=>l,g:()=>c});var o=n(29450),i=n(29477);let r,a;async function s(e,t,n){if(r)return r;e.planType=t,e.isSalesAssistedPlan=n;const a=(0,i.UZ)();r=a.promise,await async function(e){if(!(0,o.hasPermissionForThirdPartyServiceBrowser)("zendesk"))return;const t=document.createElement("script");if(t.type="text/javascript",t.async=!0,t.src="https://solve-widget.forethought.ai/embed.js",t.id="forethought-widget-embed-script",t.setAttribute("data-api-key","c895ee24-2c6c-4ed6-a100-3037e65cadda"),t.setAttribute("data-ft-full-name",e.fullName||"Forethought Deflected"),t.setAttribute("data-ft-email",e.email||"forethought@makenotion.com"),e.locale){var n;const o=null===(n=e.locale.split("-")[0])||void 0===n?void 0:n.toLowerCase();o&&t.setAttribute("data-ft-embed-script-language",o)}const i=e.planType||"undefined";"enterprise"===i&&e.isSalesAssistedPlan?(t.setAttribute("data-ft-plan-type","enterprise_free"),t.setAttribute("data-ft-workflow-tag","enterprise_free"),t.setAttribute("initial-intent-id","d5cb32d0-3637-4e8e-87fa-c4ea8d79d45f")):(t.setAttribute("data-ft-plan-type",i),t.setAttribute("data-ft-workflow-tag",i));const r=document.getElementsByTagName("script")[0];return null==r||r.parentNode.insertBefore(t,r),window.addEventListener("message",(e=>{var t,n;"forethoughtWidgetClosed"===(null==e||null===(t=e.data)||void 0===t?void 0:t.event)&&(null===(n=Forethought)||void 0===n||n("widget","hide"))})),new Promise((e=>{t.addEventListener("load",(()=>{var t;null===(t=Forethought)||void 0===t||t("widget","hide"),e()}))}))}(e),a.resolve()}async function l(e){if(a)return a;const t=(0,i.UZ)();a=t.promise,e.isForethoughtEnabled&&await s(e.forethoughtInitializeArgs,e.userHighestPlanType,e.isSalesAssistedPlan),await async function(e){const{locale:t}=e;if(!(0,o.hasPermissionForThirdPartyServiceBrowser)("zendesk"))return;const n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://static.zdassets.com/ekr/snippet.js?key=b9ad856d-6b98-4cf5-a2f6-d96e50557722",n.id="ze-snippet";const i=document.getElementsByTagName("script")[0];return null==i||i.parentNode.insertBefore(n,i),new Promise((e=>{n.addEventListener("load",(()=>{var n=window.zE;n&&(n("webWidget","setLocale",t),n("webWidget","hide"),e())}))}))}(e),t.resolve()}async function c(e){if(await l(e),"undefined"!=typeof Forethought)Forethought("widget","show"),Forethought("widget","open");else{var t=window.zE;if(!t)return;t("webWidget","show"),t("webWidget","open"),t("webWidget:on","close",(function(e){(t=window.zE)&&t("webWidget","hide")}))}}}}]);