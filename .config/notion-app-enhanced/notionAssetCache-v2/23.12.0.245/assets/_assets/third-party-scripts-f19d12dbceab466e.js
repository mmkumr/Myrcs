"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9765],{37252:(e,s,t)=>{t.r(s),t.d(s,{InjectThirdPartyScripts:()=>D,useThirdPartyScripts:()=>Z});var a=t(67294),i=t(13991),n=t(480),r=t(86628),o=t(72126),d=(t(57658),t(29450)),l=t(66673),c=t(65454),u=t(4615);const p="a2a8e2144b2bbbb4074a",g="901895b8-45c7-40c8-ba91-626cfc6739b3";function f(){var e,s,t;if(!window._cio)for(window._cio=[],e=function(e){return function(){window._cio.push([e].concat(Array.prototype.slice.call(arguments,0)))}},s=["load","identify","sidentify","track","page","on","off","reset"],t=0;t<s.length;t++)window._cio[s[t]]=e(s[t])}var m=t(7250),y=t(93724),S=t(49902),v=t(50906),I=t(75018),b=t(95477),w=t(15010),_=t(94134),k=t(58455),C=t(80444),E=t(61893),h=t(74055),R=t(77080),K=t(3418),P=t(69454),V=t(7339),T=t(77907);function Z(){const e=(0,n.O7)(),s=(0,n.Fy)(),{currentUser:t}=e,Z=(0,r.VK)((()=>{var e;return null===(e=C.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),D=(0,r.VK)((()=>V.C.state.ready),[]);!function(e){let{isEnabled:s,isLoggedIn:t,userId:i,onMessageOpened:n,onMessageDismissed:r,onMessageError:o,onMessageAction:m}=e;(0,a.useEffect)((()=>{s&&(0,d.hasPermissionForThirdPartyServiceBrowser)("customer_io")&&("cio-tracker"in window||(f(),(0,c.ZP)("https://assets.customer.io/assets/track.js",{id:"cio-tracker",attributes:{"data-site-id":p,"data-use-array-params":"true","data-in-app-org-id":g,"data-use-in-app":"true","data-auto-track-page":"false"}})))}),[s]);const y=(0,l.D9)(i);(0,a.useEffect)((()=>{y!==i&&(f(),t&&void 0!==i?(window._cio.identify({id:(0,u.cj)(i)}),n&&window._cio.on("in-app:message-opened",n),r&&window._cio.on("in-app:message-dismissed",r),m&&window._cio.on("in-app:message-action",m),window._cio.on("in-app:message-error",o)):window._cio.reset())}),[t,i,y,n,r,o,m])}({isEnabled:(0,r.VK)((()=>t.isLoggedIn()&&D&&R.default.checkGate("customerio")),[t,D]),isLoggedIn:t.isLoggedIn(),userId:t.id,onMessageOpened:s=>{h.Z.state.suppressReason?v.EKj(e,{message_id:s.detail.messageId,reason:h.Z.state.suppressReason}):(h.Z.setState({...h.Z.state,isVisible:!0}),v.IMV(e,{message_id:s.detail.messageId}))},onMessageDismissed:s=>{h.Z.setState({...h.Z.state,isVisible:!1}),v.x91(e,{message_id:s.detail.messageId})},onMessageError:s=>{v.ybK(e,{message_id:s.detail.messageId})},onMessageAction:s=>{if(s.detail.actionValue.startsWith("relative_url=")){const t=s.detail.actionValue.split("relative_url=")[1];I.navigate({environment:e,url:t})}s.detail.message.dismiss()}}),(0,S.kI)({...(0,r.VK)((()=>{const e=k.default.state.isSprigEnabled&&E.Z.state.permission.performance&&R.default.checkGate("sprig")&&s.isDesktop,{currentUserSettingsStore:t,currentSpaceStore:a,currentUserStore:i}=C.default.state,n=null==i?void 0:i.getEmail(),r=t?(0,w.e2)(t):null,o=Boolean(null==a?void 0:a.canAdmin());return{isEnabled:e,userEmail:n,userDaysSinceSignup:r??0,userDomainType:(0,w.JF)(),isSpaceAdmin:o}}),[s]),isLoggedIn:t.isLoggedIn(),userId:t.id,spaceId:Z,sprigConfig:b.default.sprig}),(0,m.oG)({getLocale:(0,a.useCallback)((()=>i.SP),[]),analyticsSettings:(0,r.VK)((()=>o.ei(k.default.state,["isIntercomEnabled","intercomAppId","intercomUserHash","noIntercomUserId","user_id","user_email"])),[]),onVisibilityChange:(0,a.useCallback)((s=>{P.Z.updateShouldResizeWebview(e,s,"v1"),s?K.Z.addNamedPopup("intercom"):K.Z.removeNamedPopup("intercom")}),[e])}),function(e){var s;const{userId:t,spaceId:i,...n}=e,r=(0,T.useDependency)(T.deps.sentry);(0,a.useEffect)((()=>{if(!r.value)return;const{Sentry:e,sentryInitializeFull:s}=r.value;s({Sentry:{...e,isFullSDK:!0},config:b.default,...n})}),[r.value,n]);const o=null===(s=r.value)||void 0===s?void 0:s.Sentry;(0,a.useEffect)((()=>{o&&o.setUser(t?{id:t}:null)}),[o,t]),(0,a.useEffect)((()=>{o&&o.setTag("space.id",i)}),[o,i])}({userId:t.id,spaceId:Z,getErrorsSampleRate:(0,a.useCallback)((()=>R.default.getConfigKey("sentry","errorsSampleRate")),[]),getTracesSampleRate:(0,a.useCallback)((()=>R.default.getConfigKey("sentry","tracesSampleRate-v0")),[]),getReplaysSessionSampleRate:(0,a.useCallback)((()=>R.default.getConfigKey("sentry","replaysSessionSampleRate-v0")),[]),getReplaysOnErrorSampleRate:(0,a.useCallback)((()=>R.default.getConfigKey("sentry","replaysOnErrorSampleRate-v0")),[]),getIsProfilingEnabled:(0,a.useCallback)((()=>"sentry"===(0,_.getProfilingToolForSession)()),[]),getProfilesSampleRate:(0,a.useCallback)((()=>R.default.getConfigKey("sentry","profilesSampleRate")),[])}),(0,y.useConfigurePalette)({userId:t.id,spaceId:Z,pageType:(0,r.VK)((()=>{var e;return null===(e=C.default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.getType()}),[]),device:s})}function D(){return window.__c={n:"InjectThirdPartyScripts"},Z(),null}},74055:(e,s,t)=>{t.d(s,{V:()=>i,Z:()=>r});var a=t(49085);let i=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class n extends a.default{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const r=new n}}]);