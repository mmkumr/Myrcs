"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8567],{69255:(e,t,i)=>{i.r(t),i.d(t,{default:()=>b});i(57658);var o=i(67294),n=i(480),r=i(86628),s=i(77657),l=i(62208),a=i(60291),d=i(77420),c=i(97880),u=i(5366),p=i(41363),m=i(39699),g=i(61202),f=i(87279),v=i(77907),y=i(30874),x=i(93405),h=i(78140),S=i(32163),j=i(72495),w=i(85893);const b=function(e){window.__c={n:"ExternalObjectInstanceBlockMenu"};const{titleForReloadMenuOption:t,store:i,parentBlockStore:b,onAccept:k,onDismiss:I,extraSecondaryItemKey:C,token:_}=e,P=(0,n.O7)(),{value:Z}=(0,v.useDependency)(v.deps.markdownLinkifyIt),{value:T}=(0,v.useDependency)(v.deps.tinyMceMicrosoftWordPasteFilter),M=(0,o.useCallback)((e=>{const t={blocks:[i],environment:P,publicEditMode:void 0,lazyDependencies:{markdownLinkifyIt:Z,tinyMceMicrosoftWordPasteFilter:T}};return{key:e.key,render:(i,o)=>e.render(i,t,{onAccept:k,onFocus:o.onFocus}),action:i=>{let{event:o}=i;return e.action(t,o)}}}),[k,P,i,Z,T]),O=[];(0,r.VK)((()=>{const e=i.getFormat().bot_id,t=y.Z.getBotsAsRecordMap();if(e&&!0===y.Z.state.loaded){const i=t.getValue({table:d.cZ,id:e});if(i&&i.integration_id&&i.integration_id===s.U9)return!1}return!0}),[i])&&O.push({key:0,render:e=>(0,w.jsx)(j.Z,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[{key:"reload external instance object",render:e=>(0,w.jsx)(x.Z,{...e,title:t,svg:a.b}),action:()=>{i&&(i.isExternalObjectInstanceBlockStore()||i.isExternalObjectInstancePageBlockStore())&&g.qK({environment:P,from:"page_more_menu",store:i,spaceId:i.getSpaceId()})}}]});const B=(0,r.VK)((()=>{switch(C){case"preview_to_mention":return[M(p.OH)];case"mention_to_preview":if(!i.isExternalObjectInstanceBlockStore())return[];return[{key:"turn preview into block",render:e=>(0,w.jsx)(x.Z,{...e,title:(0,w.jsx)(u.FormattedMessage,{id:"hoverPreviewOverlay.action.turnPreviewIntoPreview",defaultMessage:"Turn into preview"}),svg:l.z}),action:()=>{b&&_&&m.createAndCommit({userAction:"HoverPreviewOverlay.transformExternalObjectInstanceMentionIntoBlock",environment:P,perform:e=>{g.aV({block:i,parentStore:b,transaction:e,token:_}),e.postSubmitCallbacks.push((e=>{e||null==I||I()}))}})}}];default:(0,c.t1)(C)}}),[C,M,i,b,_,P,I]);return O.push({key:1,render:e=>(0,w.jsx)(j.Z,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[...B,M(p.IK)]}),(0,w.jsx)(h.Z,{menuType:f.og.Popup,children:(0,w.jsx)(S.Z,{type:S.i.Vertical,initialFocus:void 0,onAccept:k,sections:O,style:{paddingTop:3,paddingBottom:3}})})}},98567:(e,t,i)=>{i.d(t,{D5:()=>Ze,E5:()=>Be,s6:()=>be});var o=i(67294),n=i(1302),r=i(480),s=i(86628),l=i(24405),a=i(15145),d=i(1800),c=i(7057),u=i(78601),p=i(66673),m=i(69651),g=i(75553),f=i(56666),v=i(40462),y=i(11751),x=i(64572),h=i(76725),S=i(72126),j=i(4615),w=i(99405),b=i(21202),k=i(70279),I=i(70203),C=i(44805),_=i(97880),P=i(82990),Z=i(44876),T=i(5366),M=i(50906),O=i(14871),B=i(45990),K=i(97444),R=i(32741),U=i(95477),V=i(60682),E=i(24990),z=i(49616),W=i(4708),H=i(73744),D=i(41232),F=i(6398),A=i(88804),L=i(75024),q=i(4023),G=i(15723),N=i(80444),$=i(77080),Y=i(96049),J=i(42653),Q=i(72014),X=i(35661),ee=i(48588),te=i(10912),ie=i(18746),oe=i(64921),ne=i(31945),re=i(51077),se=i(73063),le=i(12981),ae=i(53437),de=i(31278),ce=i(76798),ue=i(94096),pe=i(27186),me=i(19987),ge=i(69255),fe=i(25735),ve=i(19889),ye=i(36517),xe=i(85893);function he(e){window.__c={n:"HoverUserPreviewOverlayRenderer"};const t=(0,s.VK)((()=>N.default.state.currentSpaceStore),[]),i=(0,s.VK)((()=>{var t;return null===(t=e.state)||void 0===t?void 0:t.annotation}),[e.state]),o=(0,p.Rm)(i,void 0,600,Object.is),n=(0,s.VK)((()=>{if(t&&o)return X.U6.createChildStore(t,{id:o[1],table:ve.KJ})}),[t,o]),r=(0,s.VK)((()=>!!n&&n.isDefined()),[n]);return n&&r&&t?(0,xe.jsx)(ye.Z,{targetUserStore:n}):null}var Se=i(29551),je=i(74169);const we=(0,T.defineMessages)({aiSummary:{defaultMessage:"Summary",id:"hoverPreviewOverlay.aiSummary.label"}});function be(e){window.__c={n:"HoverPreviewOverlay"};const t=(0,r.O7)(),i=(0,s.Kw)(Y.Z,{debugName:"HoverPreviewOverlay"}),{state:n,pinPopup:l,unpinPopup:a,hasBeenHovering:d,isPinned:c,dismissPopup:u}=function(){const[e,t]=(0,o.useState)(!1),[i]=(0,s.AF)(ee.Z),n=(0,p.Kt)(i,400,Object.is),[r,l]=(0,o.useState)(void 0),a=r||(e?void 0:n),d=(0,o.useCallback)((()=>l(a)),[a]),c=(0,o.useCallback)((()=>{l(void 0)}),[]),u=(0,o.useCallback)((()=>{c(),t(!0)}),[c]);return(0,o.useEffect)((()=>{t(!1)}),[n]),{state:a,pinPopup:d,unpinPopup:c,hasBeenHovering:i&&i===a,isPinned:Boolean(r),dismissPopup:u}}(),m=(0,s.VK)((()=>$.default.checkGate("first_party_links")),[]),g=(0,s.VK)((()=>(0,W.En)()),[]),f=function(e){const t=(0,r.O7)();return(0,s.VK)((()=>!!e&&(0,A.E)(t,e.store)),[e,t])}(n),v=(0,o.useMemo)((()=>Boolean(n&&function(e,t){return t&&(e.annotations.some(I.j0F)||e.annotations.some(I.nSN))}(n,f))),[n,f]),y=(0,o.useMemo)((()=>n&&n.token.node.getBoundingClientRect()),[n]),x=v&&y&&0===y.width&&0===y.height&&0===y.left&&0===y.top,h=v?!x:Boolean(!i&&d&&!x),[,j]=(0,s.AF)(J.Z);(0,o.useEffect)((()=>(j({isPinned:c}),()=>j({isPinned:!1}))),[c,j]);const w=!(null!=n&&n.annotations.some(I.nSN))&&m&&!(null!=n&&n.annotations.some(I.STW)),b=(g&&(null==n?void 0:n.annotations.some(I.IWo)))??!1,k=Boolean(null==n?void 0:n.annotations.some(I.OU5)),C=(0,s.VK)((()=>t.RouterStore.state),[t.RouterStore]);return(0,o.useEffect)((()=>{u()}),[C,u]),(0,o.useEffect)((()=>{const e=S.P2((()=>{R.lY(),u()}),200,{leading:!0});return H.lj(window,"scroll",e,!0),()=>H.ZV(window,"scroll",e,!0)}),[u]),(0,xe.jsx)(ae.ZP,{disableMouseCapture:!0,preventCaptureEsc:!0,preventPointerEvents:!v,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:ae.ZP.PopupType.Popup,open:h,originRect:y,originGap:8,alignmentToOrigin:b?ae.ZP.Alignment.End:ae.ZP.Alignment.Start,placementToOrigin:b||k?ae.ZP.Placement.Top:ae.ZP.Placement.Bottom,useLightBoxShadow:w,render:()=>n&&(0,xe.jsx)("div",{onMouseEnter:l,onMouseLeave:a,children:(0,xe.jsx)(ke,{state:n,isHoveredTokenEditable:f,onDismiss:a})})})}function ke(e){window.__c={n:"HoverPreviewOverlayRenderer"};const t=(0,s.VK)((()=>$.default.checkGate("first_party_links")),[]),i=(0,s.VK)((()=>(0,W.En)()),[]),o=(0,r.Fy)(),n=(0,s.VK)((()=>{const{currentSpaceStore:e}=N.default.state;return e?e.getPermissionGroups():[]}),[]),a=(0,l.yK)((e=>({noMembersInGroupStyle:{fontSize:P.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,padding:"4px 8px"}})),[]),d=e.state.annotations,c=d.find(I.j0F),u=d.find(I.fpG),p=d.find(I._bk),m=d.find(I.aq),g=I.frE(d),f=t?d.find(I.STW):void 0,v=i?d.find(I.IWo):void 0,y=d.find(I.OU5);if(c&&e.state.store.table!==k.x_)return(0,xe.jsx)(Ie,{...e,state:{...e.state,annotation:c}});if(u)return(0,xe.jsx)(Ce,{...e,state:{...e.state,annotation:u}});if(p){const e=I.kxk(p);if(e){const t=e.groupId,i=n.find((e=>e.id===t));if(i)return(0,xe.jsx)(fe.Y,{group:i,limit:10,color:"white_background",trackHover:!0,noMembersMessage:(0,xe.jsx)(Se.gq,{style:a.noMembersInGroupStyle,children:(0,xe.jsx)("div",{style:P.Z.textOverflowStyle,children:(0,xe.jsx)(T.FormattedMessage,{id:"groupPreview.noUsers",defaultMessage:"No users in this group"})})})})}}return m?(0,xe.jsx)(_e,{...e,state:{...e.state,annotation:m}}):g&&!o.isMobile?(0,xe.jsx)(Ze,{...e,state:{...e.state,annotation:g},onDismiss:e.onDismiss}):t&&f&&!o.isMobile?(0,xe.jsx)(Me,{...e,state:{...e.state,annotation:f},onDismiss:e.onDismiss}):v&&!o.isMobile?(0,xe.jsx)(he,{...e,state:{...e.state,annotation:v},onDismiss:e.onDismiss}):y&&!o.isMobile?(0,xe.jsx)(Oe,{...e,state:{...e.state,annotation:y},onDismiss:e.onDismiss}):null}function Ie(e){window.__c={n:"HoverLinkPreviewOverlayRenderer"};const{onDismiss:t}=e,{annotation:i,store:c,token:u}=e.state,p=(0,r.O7)(),m=(0,l.Fg)(),f=I.zW$(i),y=(0,x.A5)({url:f,baseUrl:U.default.domainBaseUrl,publicDomainName:U.default.publicDomainName}),h=(0,o.useCallback)((async()=>{t(),K.AE({token:u,store:c,readOnly:!1}),await n.default.afterNextFlush(),B.dz({type:"focusOnly",focus:!0})}),[t,c,u]),S=(0,o.useCallback)((async()=>{t(),await n.default.afterNextFlush();const e=O.tq.copiedLinkToClipboard;let i=f;const o=(0,w.Wj)({url:f,baseUrl:U.default.domainBaseUrl,publicDomainName:U.default.publicDomainName,isMobile:p.device.isMobile,protocol:U.default.protocol,currentUrl:window.location.href});if("page"===o.name){const e=X.G.createChildStore(c,{table:b.iU,id:o.blockId});i=(0,d.Z)({pageId:o.blockId,pageModel:e.getModel(),baseUrl:U.default.domainBaseUrl,discussionId:o.discussionId,scrollToBlockId:o.scrollToBlockId,peekViewBlockId:o.peekViewBlockId,peekMode:o.peekMode,pageVisitSource:a.tY.CopyLink})}O.RD({environment:p,stringValue:i,copiedMessage:e})}),[p,t,c,f]),j=(0,l.yK)((e=>({wrapper:{fontSize:P.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,fontWeight:P.Z.fontWeight.regular,fill:e.mediumIconColor},destination:{padding:"4px 0 4px 6px"},button:{display:"flex",alignItems:"center",padding:"2px 6px",whiteSpace:"nowrap",marginRight:2,borderRadius:3,color:e.regularTextColor},destinationText:{paddingRight:6,maxWidth:250,...P.Z.textOverflowStyle},icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor}})),[]),k=(0,s.VK)((()=>{if(!y)return;const e=X.G.createChildStore(c,{table:b.iU,id:y});return{pageIcon:(0,C.tp)({pageModel:e.getModel(),pageRole:e.getRole(),baseUrl:U.default.domainBaseUrl,getRecordModel:c.getRecordModel,emojiType:(0,V.e_)(p),isSafariOrIOS:p.device.isSafari||p.device.isIOS,isClient:!0,showEmojiInline:p.device.isWindows,currentUserId:p.currentUser.id,theme:m,emojiData:E.Z.state}),title:(0,xe.jsx)(ce.Z,{style:j.destinationText,store:e})}}),[p,c,y,j,m])||{pageIcon:(0,v.o)(j.icon),title:(0,xe.jsx)("div",{style:j.destinationText,children:f})};return(0,xe.jsxs)(Se.gq,{style:j.wrapper,alignItems:"center",children:[(0,xe.jsxs)(Se.gq,{style:j.destination,alignItems:"center",children:[k.pageIcon,k.title]}),(0,xe.jsx)(se.Z,{onClick:S,icon:g.U,isDarkIconColor:!0}),e.isHoveredTokenEditable&&(0,xe.jsx)(oe.Z,{style:j.button,onClick:h,children:(0,xe.jsx)(T.FormattedMessage,{defaultMessage:"Edit",id:"hoverPreviewOverlay.editButton.label"})})]})}function Ce(e){window.__c={n:"HoverDatePreviewOverlayRenderer"};const{annotation:t}=e.state,i=I.zyO(t),o=(0,l.yK)((e=>({container:{fontSize:P.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,padding:"4px 8px"},icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor}})),[]),n=(0,T.useIntl)(),r="relative"===i.date_format?"ll":"relative",s=(0,c.ZV)({value:i,date_format:r,time_format:"h:mm A",allowRelativeDates:!0,intl:n});return s===(0,c.ZV)({value:i,date_format:i.date_format,time_format:i.time_format,allowRelativeDates:!0,intl:n})?null:(0,xe.jsxs)(Se.gq,{style:o.container,alignItems:"center",children:[(0,m.C)(o.icon),(0,xe.jsx)("div",{style:P.Z.textOverflowStyle,children:s})]})}function _e(e){window.__c={n:"HoverTemplateVariablePreviewOverlayRenderer"};const{annotation:t}=e.state,i=I.fsE(t),o=(0,T.useIntl)(),n=I.Z08(i.type,o),r=(0,l.yK)((e=>({container:{fontSize:P.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,padding:"4px 8px"}})),[]);return(0,xe.jsx)(Se.gq,{style:r.container,alignItems:"center",children:(0,xe.jsx)("div",{style:P.Z.textOverflowStyle,children:n})})}function Pe(e){var t;window.__c={n:"ExternalObjectInstancePreviewContent"};const{renderConfig:i,store:o}=e,n=(0,l.yK)((e=>({title:{color:e.regularTextColor,fontWeight:P.Z.fontWeight.medium,whiteSpace:"initial"},header:{color:e.mediumTextColor,fontSize:P.Z.fontSize.UISmall.desktop},dictionaryKey:{color:e.mediumTextColor,fontWeight:P.Z.fontWeight.regular,fontSize:P.Z.fontSize.UISmall.desktop},dictionaryValue:{color:e.regularTextColor,fontSize:P.Z.fontSize.UIRegular.desktop,whiteSpace:"normal",wordBreak:"break-word"}})),[]);return(0,xe.jsxs)(xe.Fragment,{children:[i.title&&(0,xe.jsx)(Se.gq,{children:(0,xe.jsx)(F.ox,{...i.title,store:o,style:n.title})}),i.headerAttributes&&i.headerAttributes.length>0&&(0,xe.jsx)(Se.gq,{alignItems:"center",style:{...n.header,marginBottom:3},children:(0,h.Z)(i.headerAttributes.map(((e,t)=>(0,xe.jsx)(F.ox,{...e,store:o,style:{...n.header,...P.Z.textOverflowStyle}},`attribute-${t}`)))||[],(e=>(0,xe.jsxs)("span",{children:[" ","·"," "]},`dot-${e}`)))}),i.dictionaryAttributes&&i.dictionaryAttributes.length>0&&(0,xe.jsx)(Se.Ht,{children:i.dictionaryAttributes.map(((e,t)=>{var r;let{key:s,value:l}=e;return(0,xe.jsxs)(Se.gq,{style:{marginBottom:t!==((null===(r=i.dictionaryAttributes)||void 0===r?void 0:r.length)??0)-1?3:0},children:[(0,xe.jsx)("div",{style:{marginRight:10,width:"30%",display:"flex",alignItems:"center"},children:(0,xe.jsx)("span",{style:n.dictionaryKey,children:(0,xe.jsx)(T.FormattedMessage,{...s.formatter,values:{value:l.attribute.name}})})}),(0,xe.jsxs)("div",{style:{width:"70%",display:"flex",alignItems:"center"},children:[l.icon&&(0,Z.li)(l.icon)&&(0,xe.jsx)(re.Z,{type:"image_url",imageURL:l.icon.values[0],size:16,style:{marginRight:4}}),(0,xe.jsx)(F.ox,{...l,store:o,style:n.dictionaryValue,avatarStyle:{marginRight:4}})]})]},t)}))}),i.bodyAttribute&&(0,xe.jsx)(Se.gq,{style:((null===(t=i.dictionaryAttributes)||void 0===t?void 0:t.length)??0)>0?{marginTop:3}:{},children:(0,xe.jsx)(F.hx,{attribute:i.bodyAttribute})}),i.previewImageAttribute&&(0,xe.jsx)("div",{style:{marginTop:i.dictionaryAttributes?6:0,marginBottom:4,display:"flex",justifyContent:"center"},children:(0,xe.jsx)("div",{children:(0,xe.jsx)(le.Z,{src:i.previewImageAttribute.values[0],style:{width:"100%",maxHeight:200}})})})]})}function Ze(e){window.__c={n:"HoverExternalObjectInstanceOverlayRenderer"};const{state:{annotation:t,store:i,token:n},onDismiss:a}=e,d=I.frW(t),c=(0,r.O7)(),p=(0,l.Fg)(),m=(0,o.useRef)(null),g=(0,s.VK)((()=>{const t=X.G.createChildStore(i,{table:b.iU,id:d,spaceId:i.pointer.spaceId}),o=t.canEdit(),r=(0,D._F)({store:t,isInDarkMode:"dark"===p.mode,canEdit:o,currentUserId:c.currentUser.id,getRenderFn:e=>t=>{var i,o;return(null===(i=e.hover)||void 0===i?void 0:i.call(e,t))||(null===(o=u.j.hover)||void 0===o?void 0:o.call(u.j,t))},showAction:void 0});if(!r)return;const{renderConfig:s,integration:l}=r,g=Boolean(r.action),v=e.isHoveredTokenEditable,y=i.recordStoreUIParentStore&&i.recordStoreUIParentStore instanceof X.G?i.recordStoreUIParentStore:void 0;return(0,xe.jsxs)("div",{style:{display:"flex",flexDirection:"column"},ref:m,children:[(0,xe.jsxs)(Se.gq,{alignItems:"center",style:{fontSize:12},children:[(0,xe.jsx)(re.Z,{type:"image_url",imageURL:l.icon,size:16,style:{marginRight:"4px"}}),(0,xe.jsx)("div",{style:{flexGrow:1,fontWeight:P.Z.fontWeight.medium},children:l.name}),n&&!g&&v&&(0,xe.jsx)("div",{children:(0,xe.jsx)(ne.ZP,{popupType:ne.Z4.Popup,placementToOrigin:q.u.Right,alignmentToOrigin:q.v.Start,originGap:4,onClose:()=>{let e=!1;const t=m.current;t&&(e=(0,G.uh)(t.getBoundingClientRect(),pe.IL.x,pe.IL.y)),e||null==a||a()},renderOrigin:e=>(0,xe.jsx)(oe.Z,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:3},...e,children:(0,f.o)({width:14})}),render:e=>(0,xe.jsx)(ge.default,{titleForReloadMenuOption:(0,xe.jsx)(T.FormattedMessage,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:y,store:t,token:n,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})})]}),g&&v?(0,xe.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",margin:"6px 0"},children:(0,xe.jsx)(me.Z,{canEdit:o,store:t,isHoverPreview:!0,postActionCallback:a})}):(0,xe.jsx)(Pe,{renderConfig:s,store:t})]})}),[d,i,c,p,n,a,e.isHoveredTokenEditable,m]);return g?(0,xe.jsx)("div",{style:{padding:"8px 16px",minWidth:300,maxWidth:350},children:g}):null}function Te(e){window.__c={n:"HoverPagePreviewContent"};const t=(0,r.O7)(),i=(0,T.useIntl)(),{store:n}=e,a=(0,s.VK)((()=>z.TP(n)),[n]),d=(0,l.yK)((e=>({icon:{height:16,width:16,fill:e.icon.purple,marginRight:2},title:{fontSize:12,color:e.icon.purple},summary:{...(0,L.pd)(4),fontSize:12,color:e.text.primary,marginBottom:16},contentCover:{color:e.text.primary,fontSize:12,lineHeight:1.5,marginBottom:16},contentCoverEmpty:{height:0},imageCoverWrap:{marginBottom:16},contentCoverFade:{height:45,background:`linear-gradient(to bottom, transparent, ${e.fill.elevated} 100%)`},loadingShimmer:{marginBottom:16}})),[]),c=a&&I.Vkf(a)>=20,u=(0,o.useMemo)((()=>(0,j.ZP)()),[]);return(0,o.useEffect)((()=>{const e=Q.$g.getCurrentPageVisitId();return M.piO(t,{hover_session_id:u,mentioned_page_id:n.pointer.id,hover_content_type:c?"ai_summary":"content_preview",page_visit_id:e}),()=>{M.Yo0(t,{hover_session_id:u,hover_content_type:c?"ai_summary":"content_preview",mentioned_page_id:n.pointer.id,page_visit_id:e})}}),[t,u,c,n.pointer.id]),c?(0,xe.jsxs)("div",{children:[(0,xe.jsxs)(Se.gq,{alignItems:"center",children:[(0,y.t)(d.icon),(0,xe.jsx)("div",{style:d.title,children:i.formatMessage(we.aiSummary)})]}),(0,xe.jsx)("div",{style:d.summary,children:(0,xe.jsx)(ie.A,{textValue:a,parentStore:n})})]}):(0,xe.jsx)(te.Z,{variant:"default",store:n,coverFormat:{type:"page_content"},coverContentFadedOverlay:!0,coverContentFadedOverlayStyle:d.contentCoverFade,coverHeight:120,contentWrapStyle:d.contentCover,imageCoverWrapStyle:d.imageCoverWrap,emptyGalleryCoverStyle:d.contentCoverEmpty,loadingShimmerStyle:d.loadingShimmer,showLoadingShimmer:!0,showEmptyGalleryCover:!0,onLoadProxiedImage:()=>{}})}function Me(e){window.__c={n:"HoverPagePreviewOverlayRenderer"};const t=(0,s.VK)((()=>{const t=N.default.state.currentSpaceStore;if(!t)return;const i=X.G.createChildStore(t,{id:e.state.annotation[1],table:"block"});return i.isNavigableBlock()&&i.isDefined()?i:void 0}),[e.state.annotation]);return(0,xe.jsx)(Be,{store:t})}function Oe(e){window.__c={n:"HoverCitationPreviewOverlayRenderer"};const{state:{annotation:t,store:i}}=e,n=I.Vv0(t),r=(0,o.useMemo)((()=>{if((0,_.$K)(n.blockId))return X.G.createChildStore(i,{table:b.iU,id:n.blockId})}),[i,n]);return r?(0,xe.jsx)(Be,{store:r}):null}function Be(e){let{store:t,events:i}=e;window.__c={n:"HoverPagePreview"};const o=(0,l.yK)((e=>({wrapper:{width:320},coverContainer:{height:60,background:e.accentColors.gray[30]},content:{padding:"16px 16px 0"},breadcrumb:{color:e.text.secondary},pageTitle:{display:"inline",fontWeight:P.Z.fontWeight.semibold,color:e.text.primary},pageTitleIcon:{position:"relative",marginLeft:16,marginTop:-15},pageTitleContainer:{...(0,L.pd)(2),verticalAlign:"top",fontSize:16,lineHeight:1.25},description:{fontSize:P.Z.fontSize.UISmall.desktop,color:e.icon.primary,paddingBottom:2},empty:{height:16}})),[]),[n,r,a]=(0,s.VK)((()=>{if(!t)return[void 0,!1,null,null];const e=t.isEmptyPage(),i=e?(0,xe.jsx)("div",{className:"empty"}):(0,xe.jsx)(Te,{store:t});return[t.getIcon(),e,i]}),[t]);return t?(0,xe.jsxs)("div",{style:o.wrapper,...i,children:[(0,xe.jsx)("div",{style:o.coverContainer,children:(0,xe.jsx)(je.Z,{store:t,disabled:!0,paddingLeft:0,paddingRight:0,height:60,proxyWidth:320})}),(0,xe.jsx)(de.Z,{disabled:!0,icon:n,isEmptyPage:r,isLarge:!0,disableShrinking:!0,size:30,emojiSize:30,largeIcon:!0,style:o.pageTitleIcon}),(0,xe.jsxs)(Se.Ht,{gap:16,style:o.content,children:[(0,xe.jsxs)(Se.Ht,{gap:2,children:[(0,xe.jsx)(ue.Z,{store:t,style:o.breadcrumb}),(0,xe.jsx)("div",{style:o.pageTitleContainer,children:(0,xe.jsx)(ce.Z,{shouldWrap:!0,maxLines:2,store:t,style:o.pageTitle})})]}),a]})]}):null}},84844:(e,t,i)=>{i.d(t,{Z:()=>b,d:()=>w});var o=i(67294),n=i(480),r=i(86628),s=i(24405),l=i(99036),a=i(6695),d=i(51365),c=i(66890),u=i(33929),p=i(61766),m=i(886),g=i(13023),f=i(97039),v=i(78030),y=i(24118),x=i(53876),h=i(12867),S=i(85893);const j=[...y.Ae,"button","formula","rollup","title","file","verification"];function w(e){return(0,r.VK)((()=>{if(!e)return{collectionStore:void 0,schema:void 0,format:void 0};const t=e.getAssociatedCollectionStore();let i,o;return i=t?t.getSchema():l.Kc(u.default.getIntl()),t&&(o=a.iB(t.getFormat(),i,void 0,a.j5.Collection)),{collectionStore:t,schema:i,format:o}}),[e])}const b=function(e){window.__c={n:"MiniProperties"};const{store:t}=e,i=(0,n.O7)(),l=(0,o.useMemo)((()=>new m.Z(i)),[i]),{collectionStore:u,schema:y,format:b}=w(t),k=(0,r.qz)(void 0,p.Z),I=(0,s.yK)((e=>({pageProperties:{display:"flex",gap:"0 6px",overflow:"hidden",paddingRight:6},morePropertiesTooltip:{color:e.mediumInvertedTextColor},morePropertiesButton:{borderRadius:6,height:x.IT,width:x.IT},overflowButtonWrapperStyle:{paddingBottom:0},overflowButtonStyle:{height:30,width:30}})),[]);(0,o.useEffect)((()=>{if(u){const e=u.getParentBlockStore();e&&e.isCollectionView()&&l.setContext({type:"collectionPage",collectionViewBlockStore:e,collectionStore:u})}}),[l,u]);const C=(0,o.useCallback)((t=>{d.bA({environment:i,blockPropertyValueOverlayStore:g.Z,store:e.store,property:t,format:v.C.Mini,collectionContextStore:l})}),[l,i,e.store]),[_,P]=(0,r.VK)((()=>{var e;if(!u||!b||!y)return[void 0,void 0];const t=a.iB(b,y,void 0,a.j5.Collection),i=(null==t||null===(e=t.collection_page_properties)||void 0===e?void 0:e.filter((e=>{var t;const i=null===(t=y[e.property])||void 0===t?void 0:t.type;return void 0!==i&&!j.includes(i)})))??[];return[i.slice(0,5),i.slice(5).map((e=>({visibility:"show",hasValue:!0,...e})))]}),[u,b,y]);return u&&b&&null!=_&&_.length?(0,S.jsx)("div",{style:I.pageProperties,children:(0,S.jsxs)(c.L1,{value:l,children:[_.map((e=>(0,S.jsx)(f.Z,{store:t,property:e.property,locked:!1,disabled:!1,format:v.C.Mini,tableWrap:!1,blockPropertyValueOverlayStore:g.Z,onOpenProperty:C,showRelationTooltip:!0,showIfEmpty:!0,collectionStore:u},e.property))),P&&P.length>0&&(0,S.jsx)(h.gm,{hiddenProperties:P,canConfigureCollection:!1,store:e.store,collectionStore:u,collectionContextStore:l,blockPropertyValueOverlayStore:g.Z,disabled:!1,locked:!1,isInPeekRenderer:!0,format:b,buttonPopupStore:k,hideDragHandle:!0,overflowButtonWrapperStyle:I.overflowButtonWrapperStyle,overflowButtonStyle:I.overflowButtonStyle})]})}):null}},36517:(e,t,i)=>{i.d(t,{Z:()=>M});i(57658);var o=i(67294),n=i(480),r=i(86628),s=i(24405),l=i(6695),a=i(72126),d=i(4615),c=i(21202),u=i(19889),p=i(82990),m=i(5366),g=(i(95477),i(66890)),f=i(80444),v=i(886),y=i(88632),x=i(77080),h=i(19671),S=i(35661),j=i(78291),w=i(88893),b=i(97039),k=i(78030),I=i(45653),C=i(29551),_=i(84844),P=i(85893);const Z=["Title","Pronoun","Teams (via Teams DB)","Office","Manager","Languages (Fluency)","Tenure"],T={"Teams (via Teams DB)":"Teams","Languages (Fluency)":"Languages"};function M(e){let{targetUserStore:t}=e;window.__c={n:"PeopleProfilePopup"};const i=(0,s.yK)((e=>({wrapper:{minWidth:100,maxWidth:300},profile:{padding:"10px 12px 12px 10px"},content:{padding:"8px 10px 10px"},breadcrumb:{color:e.text.secondary},profileTitle:{paddingLeft:20,fontSize:18,lineHeight:1.25,fontWeight:p.Z.fontWeight.semibold,color:e.text.primary},profileSubtitle:{paddingLeft:20,paddingTop:2,fontSize:p.Z.fontSize.UISmall.desktop,color:e.icon.primary,paddingBottom:1},profileKeyRow:{minWidth:80},profileKeyText:{textTransform:"capitalize",fontWeight:500},description:{padding:"6px 8px 12px 20px",fontSize:p.Z.fontSize.UISmall.desktop,color:e.icon.primary,borderTop:`1px solid ${e.regularDividerColor}`}})),[]),a=(0,r.VK)((()=>f.default.state.currentSpaceStore),[]),u=(0,r.VK)((()=>f.default.state.currentUserStore),[]),m=(0,r.VK)((()=>!!t&&t.isDefined()),[t]),y=(0,r.VK)((()=>{if(!t)return;const e=t.getEmail();if(!e)return;const i=x.default.getConfigKey("notion_people_block_id","data")[e];if(!i)return;return S.G.createChildStore(t,{table:c.iU,id:(0,d.Mt)(i)})}),[t]),{collectionStore:j,schema:w,format:I}=(0,_.d)(y),T=function(e){let{collectionStore:t,format:i,schema:o,userPeopleCollectionPage:n}=e;return(0,r.VK)((()=>{var e;if(!(t&&i&&o&&n))return;const r=l.iB(i,o,void 0,l.j5.Collection),s=null==r||null===(e=r.collection_page_properties)||void 0===e?void 0:e.filter((e=>{var t;const i=null===(t=o[e.property])||void 0===t?void 0:t.name;return void 0!==i&&Z.includes(i)}));if(!s)return;const a={};return s.forEach((e=>{var i;a[(null===(i=o[e.property])||void 0===i?void 0:i.name)||""]=(0,P.jsx)(b.Z,{store:n,property:e.property,locked:!0,disabled:!0,format:k.C.Page,onTab:()=>{},onUntab:()=>{},tableWrap:!1,blockPropertyValueOverlayStore:h.Z,showRelationTooltip:!1,collectionStore:t})})),a}),[t,o,i,n])}({collectionStore:j,format:I,schema:w,userPeopleCollectionPage:y}),M=(0,n.O7)(),R=(0,o.useMemo)((()=>new v.Z(M)),[M]);(0,o.useEffect)((()=>{j&&R.setContext({type:"collectionPage",collectionStore:j})}),[R,j]);const U=(0,r.VK)((()=>!!(t&&u&&m)&&t.id===u.id),[t,u,m]);return t&&m&&a?y&&R&&T?(0,P.jsx)("div",{style:i.wrapper,children:(0,P.jsx)(g.L1,{value:R,children:(0,P.jsxs)(C.Ht,{children:[(0,P.jsx)(C.gq,{gap:3,alignItems:"center",style:i.profile,children:(0,P.jsx)(O,{userStore:t,styles:i})}),(0,P.jsxs)("div",{style:i.description,children:[(0,P.jsx)(B,{userProfile:T,styles:i}),U?(0,P.jsx)(C.gq,{gap:1,alignItems:"center",children:(0,P.jsx)(K,{spaceStore:a,limit:5,styles:i})}):void 0]})]})})}):(0,P.jsx)("div",{style:i.wrapper,children:(0,P.jsxs)(C.Ht,{children:[(0,P.jsx)(C.gq,{gap:3,alignItems:"center",style:i.profile,children:(0,P.jsx)(O,{userStore:t,styles:i})}),U?(0,P.jsx)("div",{style:i.description,children:(0,P.jsx)(C.gq,{gap:1,alignItems:"center",children:(0,P.jsx)(K,{spaceStore:a,limit:5,styles:i})})}):void 0]})}):null}function O(e){let{userStore:t,styles:i}=e;window.__c={n:"UserContactCard"};const o=(0,m.useIntl)(),{name:n,email:s}=(0,r.VK)((()=>({name:t.getFullName(o),email:t.getEmail()})),[t,o]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(I.Z,{userStore:t,size:70,borderStyle:"none"}),(0,P.jsxs)(C.Ht,{gap:1,children:[(0,P.jsx)("div",{style:i.profileTitle,children:n}),(0,P.jsx)("div",{style:i.profileSubtitle,children:s})]})]})}function B(e){let{userProfile:t,styles:i}=e;return t?(0,P.jsx)(P.Fragment,{children:Z.filter((e=>t[e])).map((e=>(0,P.jsxs)(C.gq,{gap:1,alignItems:"center",children:[(0,P.jsx)(C.Ht,{children:(0,P.jsx)(C.gq,{style:i.profileKeyRow,children:(0,P.jsx)("div",{style:i.profileKeyText,children:T[e]?T[e]:e})})}),(0,P.jsx)(C.Ht,{style:{transform:"scale(0.9)",transformOrigin:"center left"},children:t[e]})]},e)))}):null}function K(e){let{spaceStore:t,limit:i,styles:o}=e;window.__c={n:"UserSimilarity"};const{userSimilarityList:n}=(0,r.VK)((()=>{var e,o;const n=null===(e=j.default.state)||void 0===e?void 0:e.data,r=n?w.CM(n):[],s=(null==n?void 0:n.userSimilarity)||{},l=r.map((e=>{const t=s[e.userId];return{id:e.userId,similarity:t||0}})).sort(((e,t)=>t.similarity-e.similarity)).slice(0,i),d=[],c=a.yW(l.map((e=>{const i=S.U6.createChildStore(t,{table:u.KJ,id:e.id});return d.push({id:e.id,similarity:e.similarity,userStore:i}),i.isReady()})));return{isOnline:y.Z.state.online,subscriptionDataStoreData:n,userSimilarityData:(null===(o=j.default.state.data)||void 0===o?void 0:o.userSimilarity)||{},visibleUsersLoaded:c,visibleUsers:r,userSimilarityList:d}}),[t,i]);return t&&n&&0!==n.length?(0,P.jsxs)(C.gq,{gap:1,alignItems:"center",style:{paddingTop:4},children:[(0,P.jsx)(C.Ht,{children:(0,P.jsx)(C.gq,{style:o.profileKeyRow,children:(0,P.jsx)("div",{style:o.profileKeyText,children:"Coworkers"})})}),(0,P.jsx)(C.Ht,{children:(0,P.jsx)(C.gq,{gap:5,children:(0,P.jsx)("div",{children:(0,P.jsx)("div",{style:{display:"flex",position:"relative",float:"right"},children:n.map((e=>(0,P.jsx)("div",{style:{marginLeft:1.5},children:(0,P.jsx)(I.Z,{userStore:e.userStore,size:18})},e.id)))})})})})]}):null}},25735:(e,t,i)=>{i.d(t,{Y:()=>m});i(67294);var o=i(480),n=i(86628),r=i(24405),s=i(5366),l=i(82990),a=i(50906),d=i(16639),c=i(80444),u=i(29302),p=i(85893);function m(e){window.__c={n:"GroupMembersListTooltip"};const{group:t,limit:i,noMembersMessage:m,color:g,trackHover:f}=e,v=(0,r.yK)((e=>({container:{marginBottom:4,..."white_background"===g?{fontSize:l.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,padding:"4px 8px"}:{}},userContainer:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},user:{flexGrow:1},moreMessage:{marginLeft:2,marginTop:4,..."white_background"===g?{fontSize:l.Z.fontSize.UISmall.desktop,color:e.mediumTextColor}:{color:e.mediumInvertedTextColor}}})),[g]),y=(0,n.VK)((()=>c.default.state.currentSpaceStore),[]),x=(0,o.O7)();(0,n.VK)((()=>{f&&a.iHH(x,{group_id:t.id})}),[f,t.id,x]);const{countRemainingUsers:h,limitedUserStores:S}=(0,n.VK)((()=>(0,d.rm)({group:t,spaceStore:y,limit:i})),[t,y,i]);return 0===S.length?(0,p.jsx)(p.Fragment,{children:m}):(0,p.jsxs)("div",{style:v.container,children:[S.map((e=>(0,p.jsx)("div",{style:v.userContainer,children:(0,p.jsx)(u.Z,{style:v.user,userStore:e,avatarSize:18})},e.id))),h>0&&(0,p.jsx)("div",{style:v.moreMessage,children:(0,p.jsx)(s.FormattedMessage,{id:"blockPermissionsSettings.groupPermissionUsers.tooltip",defaultMessage:"{countRemainingUsers} more…",values:{countRemainingUsers:h}})})]})}},88804:(e,t,i)=>{i.d(t,{E:()=>a,N:()=>l});var o=i(83212),n=i(35661),r=i(98165),s=i(67669);function l(e,t){const i=t.getRecordStoreUIRoot(),l=i instanceof n.G&&i.isPageBlock()&&i.isLocked(),a=(0,r.n3)(i)&&o.Z.getMode(e,i),d=Boolean((0,s.YF)(a));return!t.canEdit()||l||d}function a(e,t){return!l(e,t)}}}]);