"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[253],{63029:(e,t,n)=>{n.d(t,{L6:()=>Ft,aU:()=>at,Yw:()=>De});var o=n(27537),a=n.n(o),i=n(48317),s=n(15145),r=n(41432),c=n(61061),l=n(27714),d=n(38491),u=n(55863),m=n(70203),p=n(5366),h=n(50906),g=n(19719),f=n(1302),v=n(27724),y=n(44886),b=n(61045),S=n(24677);var k=n(6404),M=n(14871),C=n(30188),w=n(42239),N=n(47839),P=n(36280),A=n(45990),I=n(91376),L=n(18957),R=n(82007),x=n(75018),T=n(87531),B=n(42858),_=n(29974),Z=n(97444),E=n(22974),j=n(29373),D=n(39699),F=n(68422),U=n(33932),V=n(56206),z=n(40824),O=n(19037),q=n(28020),K=n(92783),W=n(18514),H=n(95697),G=n(62967),J=n(94841),Y=n(30806);const Q=(0,G.cs)({key:"open home",displayName:void 0,analyticsName:"openHome",validators:[O.jl],shortcuts:["openHome"],closeParentMenu:!0,action:e=>{const t=e.environment,n=J.T5({environment:t,type:"main"});n&&((0,Y.$X)({environment:t,from:"keyboard_shortcut"}),x.navigateToBlock({environment:t,store:n,pageVisitSource:s.tY.Direct}))}});var $=n(57345),X=n(74948),ee=n(24646),te=n(38676),ne=n(36391),oe=n(80444),ae=n(5737),ie=n(21273),se=n(82375),re=n(85526),ce=n(88923),le=n(29026),de=n(62820),ue=n(9867),me=n(21797),pe=n(69815),he=n(89941),ge=n(8416),fe=n(82763),ve=n(35067),ye=n(29768),be=n(89666),Se=n(71247),ke=n(34658),Me=n(6471),Ce=n(62466),we=n(41670),Ne=n(11732);function Pe(e){return void 0!==e.shortcuts}const Ae=(0,p.defineMessages)({enterName:{id:"action.enter.name",defaultMessage:"Enter"},syncPageName:{id:"action.syncPage.name",defaultMessage:"Save for offline"},resyncPageName:{id:"action.resyncPage.name",defaultMessage:"Refresh offline data"},unsyncPageName:{id:"action.unsyncPage.name",defaultMessage:"Remove from offline"},edit:{id:"action.edit.name",defaultMessage:"Edit"},quickFindName:{id:"action.quickFind.name",defaultMessage:"Quick find"},copyLinktoViewName:{id:"action.copyLinktoView.name",defaultMessage:"Copy link to view"},zoomInName:{id:"action.zoomIn.name",defaultMessage:"Zoom in"},zoomOutName:{id:"action.zoomOut.name",defaultMessage:"Zoom out"},resetZoomName:{id:"action.resetZoom.name",defaultMessage:"Reset zoom"},blockSelectionCompletionName:{id:"action.blockSelectionCompletionName.name",defaultMessage:"Ask AI"},copyFormattedLinkNavigableTypeName:{id:"action.copyFormattedLinkNavigableType.name",defaultMessage:"Copy linked title"},copyLinkToCurrentPageSnackBarMessage:{id:"action.copyLinkToCurrentPage.snackBarMessage",defaultMessage:"Link to current page copied to clipboard"},pasteName:{id:"action.paste.name",defaultMessage:"Paste"},moveUpName:{id:"action.moveUp.name",defaultMessage:"Move up"},moveDownName:{id:"action.moveDown.name",defaultMessage:"Move down"},propertyVisibilityLabel:{id:"action.propertyVisibility.label",defaultMessage:"Toggle property visibility"},databaseLockLabel:{id:"action.databaseLock.label",defaultMessage:"Database lock"},wrapCellsName:{id:"action.wrapAllColumns.name",defaultMessage:"Wrap all columns"},createLinkName:{id:"action.createLink.name",defaultMessage:"Create link"},createEquationName:{id:"action.createEquation.name",defaultMessage:"Create equation"},filterName:{id:"action.filter.name",defaultMessage:"Filter"},sortName:{id:"action.sort.name",defaultMessage:"Sort"},legacyGroupByName:{id:"action.legacyGroupBy.name",defaultMessage:"Group by"},groupByName:{id:"action.groupBy.name",defaultMessage:"Group"},subGroupByName:{id:"action.subGroupBy.name",defaultMessage:"Sub-group"},propertiesName:{id:"action.properties.name",defaultMessage:"Properties"},templatesName:{id:"action.templates.name",defaultMessage:"Templates"},calendarByName:{id:"action.calendarBy.name",defaultMessage:"Calendar by"},timelineByName:{id:"action.timelineBy.name",defaultMessage:"Timeline by"},noDateName:{id:"action.noDate.name",defaultMessage:"No date"},boldName:{id:"action.bold.name",defaultMessage:"Bold"},italicName:{id:"action.italic.name",defaultMessage:"Italic"},strikeThroughName:{id:"action.strikeThrough.name",defaultMessage:"Strike-through"},underlineName:{id:"action.underline.name",defaultMessage:"Underline"},darkModeName:{id:"action.darkMode.name",defaultMessage:"Dark mode"},openAsPageName:{id:"action.openAsPage.name",defaultMessage:"Open as page"},openAllTogglesName:{id:"action.openAllToggles.name",defaultMessage:"Open all toggles"},toggleRecordingInputLatencyName:{id:"action.toggleRecordingInputLatency.name",defaultMessage:"Toggle recording input latency"},suggestedSlashMenuSection:{id:"slashMenu.suggestedSection.title",defaultMessage:"Suggested"},more:{defaultMessage:"See more",id:"slashMenu.more.title"},toggleSidePeekMessage:{defaultMessage:"Toggle side peek",id:"searchModal.Sidepeek.name"},toggleQnAMessage:{defaultMessage:"Toggle QnA",id:"action.toggleQnA.name"}});function Ie(e){return"key"in e}function Le(e){return"clipboardData"in e}const Re=[O.J5,O.ff(O.fI),O.FS];function xe(e){return(0,G.cs)({...e,validators:Re,closeParentMenu:!0,action:t=>{let{environment:n,blocks:o}=t;D.createAndCommit({userAction:"actionRegistry.createAnnotationAction",environment:n,perform:t=>{Z.Du({environment:n,blocks:o,annotation:e.annotation,transaction:t})}})}})}const Te=(0,G.cs)({key:"quick find",displayName:Ae.quickFindName,analyticsName:Ae.quickFindName.defaultMessage,validators:[O.lv],shortcuts:["quickFind"],closeParentMenu:!0,action:e=>{let{environment:t}=e;T.Kf({environment:t,analyticsFrom:"keyboard-shortcut"})}}),Be=(0,G.cs)({key:"toggle side peek",displayName:Ae.toggleSidePeekMessage,analyticsName:Ae.toggleSidePeekMessage.defaultMessage,validators:[O.AT,O.FO,O.QL("search_toggle_side_peek")],closeParentMenu:!0,shortcuts:["toggleSidebar"],action:e=>{let{environment:t}=e;const n=t.currentUser.id;T.bn(n)}}),_e=(0,G.cs)({key:"quick find (alternative)",displayName:Ae.quickFindName,analyticsName:Ae.quickFindName.defaultMessage,validators:[O.lv,O.ff(O.xD([O.D,O.KL]))],shortcuts:["openLinkMenu"],closeParentMenu:!0,action:e=>{let{environment:t}=e;T.Kf({environment:t,analyticsFrom:"keyboard-shortcut-command-k"})}}),Ze=(0,G.cs)({key:"toggle all updates",displayName:void 0,analyticsName:"toggleAllUpdates",validators:[O.jl],shortcuts:["toggleAllUpdates"],closeParentMenu:!0,action:e=>{const t=!de.Z.state.open;de.Z.setState({open:t}),t?g.GP({environment:e.environment,forceRestartSession:!0,from:"keyboard-shortcut"}):g.nI(e.environment)}}),Ee=(0,G.cs)({key:"toggle all teams",displayName:void 0,analyticsName:"toggleAllTeams",validators:[O.jl,H.bq],shortcuts:["toggleAllTeams"],closeParentMenu:!0,action:e=>{let{environment:t}=e;return ue.tn(t,{from:"sidebar_browse_team_item"})}}),je=(0,G.cs)({key:"open share menu",displayName:void 0,analyticsName:"openShareMenu",validators:[O.jl],shortcuts:["openShareMenu"],closeParentMenu:!0,action:e=>{let{environment:t}=e;return $.lG(t)}}),De=(0,G.cs)({key:"undo",displayName:G.RE.undoName,analyticsName:G.RE.undoName.defaultMessage,svg:u.s,validators:[O.jl,O.ff(O.tq),O.ff(O.P9(r.Ti.externalObjectInstancePage))],shortcuts:["undo"],closeParentMenu:!0,action:e=>{let{environment:t}=e;return R.Yw(t)}}),Fe=(0,G.cs)({key:"redo",displayName:G.RE.redoName,analyticsName:G.RE.redoName.defaultMessage,svg:d.N,validators:[],shortcuts:["redo"],closeParentMenu:!0,action:e=>{let{environment:t}=e;return R.KX(t)}}),Ue=(0,G.cs)({key:"up",analyticsName:"Up",displayName:void 0,validators:[],shortcuts:["up"],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;if(t&&Ie(t))return t.metaKey||t.ctrlKey?S.w5(n):void S.zJ({environment:n,shiftKey:Boolean(t&&t.shiftKey),altKey:Boolean(t&&t.altKey)})}}),Ve=(0,G.cs)({key:"left",analyticsName:"Left",displayName:void 0,validators:[],shortcuts:["left"],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;t&&Ie(t)&&S.e2(n)}}),ze=(0,G.cs)({key:"down",analyticsName:"Down",displayName:void 0,validators:[],shortcuts:["down"],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;if(t&&Ie(t))return t.metaKey||t.ctrlKey?S.hn(n):void S.DI({environment:n,shiftKey:Boolean(t&&t.shiftKey),altKey:Boolean(t&&t.altKey)})}}),Oe=(0,G.cs)({key:"right",analyticsName:"Right",displayName:void 0,validators:[],shortcuts:["right"],closeParentMenu:!0,action:e=>{let{environment:t}=e;S.FC(t)}}),qe=(0,G.cs)({key:"context menu",analyticsName:"Context menu",displayName:void 0,validators:[O.KH,O.ff(O.fI)],shortcuts:["commandSlash"],closeParentMenu:!0,action:e=>{let{environment:t}=e;const{stores:n}=v.default.state;k.$Z({environment:t,stores:n,actionSectionGroupKey:"default",analyticsFrom:"command_slash_menu"})}}),Ke=(0,G.cs)({key:"indent",analyticsName:"Indent",displayName:void 0,validators:[O.J5,O.ff(O.fI),O.Eo,O.ff(O.AK)],shortcuts:["tab"],closeParentMenu:!0,action:e=>{let{environment:t}=e;D.createAndCommit({userAction:"actionRegistry.indent",environment:t,perform:e=>{!function(e){const t=v.default.state.stores;if(t.length>0){const n=y.WY({environment:e.environment,blocks:t,transaction:e.transaction});n&&S.Z5({environment:e.environment,stores:n})}}({environment:t,transaction:e})}})}}),We=(0,G.cs)({key:"subitemIndent",analyticsName:"Toggle By Indent",displayName:void 0,validators:[O.J5,O.ff(O.fI),O.Eo,O.AK,O.y9,O.v_],shortcuts:["tab"],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;D.createAndCommit({userAction:"actionRegistry.subitemIndent",environment:n,perform:e=>{C.wA({environment:n,transaction:e,blocks:t,action:"indentSelfAndSubtree"})}})}}),He=(0,G.cs)({key:"unindent",analyticsName:"Unindent",displayName:void 0,validators:[O.J5,O.ff(O.fI),O.Eo,O.ff(O.AK)],shortcuts:["untab"],closeParentMenu:!0,action:e=>{let{environment:t}=e;D.createAndCommit({userAction:"actionRegistry.unindent",environment:t,perform:e=>{!function(e){const t=v.default.state.stores;if(t.length>0){const n=y.rB({environment:e.environment,blocks:t,transaction:e.transaction});n&&S.Z5({environment:e.environment,stores:n})}}({environment:t,transaction:e})}})}}),Ge=(0,G.cs)({key:"subitemUnindent",analyticsName:"Toggle By Unindent",displayName:void 0,validators:[O.J5,O.ff(O.fI),O.Eo,O.AK,O.y9,O.v_],shortcuts:["untab"],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;D.createAndCommit({userAction:"actionRegistry.subitemUnindent",environment:n,perform:e=>{C.wA({environment:n,transaction:e,blocks:t,action:"unindentSelf"})}})}}),Je=(0,G.cs)({key:"escape",analyticsName:"Escape",displayName:void 0,validators:[O.ff(O.lP)],shortcuts:["esc"],closeParentMenu:!0,action:e=>{let{environment:t}=e;w.cQ(t),S.ZH(t),L.jG(t)}}),Ye=(0,G.cs)({key:"escape",analyticsName:"Quick Search Escape",displayName:void 0,validators:[O.lP],shortcuts:["esc"],closeParentMenu:!0,action:()=>{le.ZP.state.query.text.length>0?le.ZP.updateQueryText(""):N.closeQuickSearch()}}),Qe=(0,G.cs)({key:"select all",analyticsName:"Select all",displayName:void 0,validators:[],shortcuts:["selectAll"],closeParentMenu:!0,action:e=>{let{environment:t}=e;S.td(t)}}),$e=(0,G.cs)({key:"cut",analyticsName:"Cut",displayName:void 0,validators:[O.J5,O.ff(O.fI),O.ry],shortcuts:["cut"],closeParentMenu:!0,action:(e,t)=>{let{environment:n,lazyDependencies:{markdownLinkifyIt:o}}=e;t&&Le(t)&&M.by({environment:n,event:t,markdownLinkifyIt:o})}}),Xe=(0,G.cs)({key:"copy",analyticsName:"Copy",displayName:void 0,validators:[],shortcuts:["copy"],closeParentMenu:!0,action:(e,t)=>{let{environment:n,lazyDependencies:{markdownLinkifyIt:o}}=e;t&&Le(t)&&M.JG({environment:n,event:t,markdownLinkifyIt:o})}}),et=(0,G.cs)({key:"zoom in",displayName:Ae.zoomInName,analyticsName:Ae.zoomInName.defaultMessage,validators:[O.d,O.ff(O.ar)],shortcuts:["zoomIn"],closeParentMenu:!0,action:()=>{N.zoomIn()}}),tt=(0,G.cs)({key:"zoom out",displayName:Ae.zoomOutName,analyticsName:Ae.zoomOutName.defaultMessage,validators:[O.d,O.ff(O.ar)],shortcuts:["zoomOut"],closeParentMenu:!0,action:()=>{N.zoomOut()}}),nt=(0,G.cs)({key:"zoom reset",displayName:Ae.resetZoomName,analyticsName:Ae.resetZoomName.defaultMessage,validators:[O.d,O.ff(O.ar)],shortcuts:["zoomReset"],closeParentMenu:!0,action:()=>{N.zoomReset()}});function ot(){const{mainEditorCurrentBlockStore:e}=oe.default.state;return ce.default.state.open&&ce.default.state.target||e}const at=(0,G.cs)({key:"copy link to current page",displayName:G.RE.copyLinkNavigableTypeName,analyticsName:G.RE.copyLinkNavigableTypeName.defaultMessage,svg:l.N,validators:[O.d],shortcuts:["copyLinkToCurrentPage"],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;const o=ot();o&&M.Hs({environment:n,blocks:[o],event:t})}}),it=(0,G.cs)({key:"copy linkified page title to current page",displayName:Ae.copyFormattedLinkNavigableTypeName,analyticsName:Ae.copyFormattedLinkNavigableTypeName.defaultMessage,svg:l.N,validators:[],shortcuts:["copyCurrentPageLinkifiedBlockTitle"],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;const o=ot();o&&M.VG({environment:n,blocks:[o],event:t})}}),st=(0,G.cs)({key:"paste",displayName:Ae.pasteName,analyticsName:Ae.pasteName.defaultMessage,validators:[O.J5,O.ff(O.fI),O.ry,O.jl],shortcuts:["paste"],closeParentMenu:!0,action:(e,t)=>{let{environment:n,lazyDependencies:{markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:a}}=e;t&&Le(t)&&D.createAndCommit({userAction:"actionRegistry.paste",environment:n,perform:e=>{M.v({environment:n,event:t,disableEmbedMenu:!0,transaction:e,onPasteFiles:M.AL,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:a})}})}}),rt=(0,G.cs)({key:"move up",displayName:Ae.moveUpName,analyticsName:Ae.moveUpName.defaultMessage,validators:[O.J5,O.Eo,O.ff(O.AK)],shortcuts:["moveUp"],closeParentMenu:!0,action:e=>{let{environment:t}=e;D.createAndCommit({userAction:"actionRegistry.moveUp",environment:t,perform:e=>{!async function(e){const t=y.A1({transaction:e.transaction,blocks:v.default.state.stores});t&&(S.Z5({environment:e.environment,stores:t}),await f.default.afterNextFlush(),b.Zv())}({environment:t,transaction:e})}})}}),ct=(0,G.cs)({key:"move down",displayName:Ae.moveDownName,analyticsName:Ae.moveDownName.defaultMessage,validators:[O.J5,O.Eo,O.ff(O.AK)],shortcuts:["moveDown"],closeParentMenu:!0,action:e=>{let{environment:t}=e;D.createAndCommit({userAction:"actionRegistry.moveDown",environment:t,perform:e=>{!async function(e){const t=y.vi({transaction:e.transaction,blocks:v.default.state.stores});t&&(S.Z5({environment:e.environment,stores:t}),await f.default.afterNextFlush(),b.Zv())}({environment:t,transaction:e})}})}}),lt=(0,G.cs)({key:"property visibility",displayName:Ae.propertyVisibilityLabel,analyticsName:Ae.propertyVisibilityLabel.defaultMessage,svg:c.B,shortcuts:["togglePropertyVisibility"],validators:[O.J5,O.ff(O.YG)],closeParentMenu:!0,action:e=>{re.Z.setState({...re.Z.state,forceShowProperties:!re.Z.state.forceShowProperties})}}),dt=(0,G.cs)({key:"enter",displayName:Ae.enterName,analyticsName:Ae.enterName.defaultMessage,validators:[O.J5,O.ff(O.fI)],shortcuts:["enter"],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;D.createAndCommit({userAction:"actionRegistry.enter",environment:t,perform:e=>{B.mp({blocks:n,transaction:e})}})}}),ut=(0,G.cs)({key:"activate",analyticsName:"Activate",displayName:void 0,validators:[O.J5,O.nW],shortcuts:["commandEnter"],closeParentMenu:!0,action:e=>B.QZ(e)}),mt=(0,G.cs)({key:"open tab",analyticsName:"open tab",displayName:void 0,validators:[O.fy],shortcuts:["commandEnter"],closeParentMenu:!0,action:e=>B.Ah(e)}),pt=(0,G.cs)({key:"toggle sidebar",analyticsName:"Toggle sidebar",displayName:void 0,validators:[O.ff(O.AT)],shortcuts:["toggleSidebar"],closeParentMenu:!0,action:e=>{let{environment:t}=e;return X.setExpand({environment:t,isExpanded:!te.gV.state,from:"action_registry"})}}),ht=(0,G.cs)({key:"toggle favorite",analyticsName:"Toggle favorite",displayName:void 0,validators:[O.jl],shortcuts:["toggleFavorite"],closeParentMenu:!0,action:e=>{let{environment:t}=e;const{currentSpaceViewStore:n}=oe.default.state,o=ot();if(!n||!o)return;const a=(0,K.Z)({spaceViewStore:n,pageId:o.id})?X.unbookmarkPage:X.bookmarkPage;D.createAndCommit({userAction:"actionRegistry.toggleFavorite",environment:t,perform:e=>a({spaceViewStore:n,store:o,transaction:e})})}}),gt=(0,G.cs)({key:"toggle update sidebar",analyticsName:"Toggle update sidebar",displayName:void 0,validators:[],shortcuts:["toggleUpdateSidebar"],closeParentMenu:!0,action:e=>{let{environment:t}=e;return X.setUpdateExpand({environment:t,isExpanded:!(0,ee.Sx)(t),from:"keyboard_default"})}}),ft=(0,G.cs)({key:"toggle both sidebars",analyticsName:"Toggle both sidebars",displayName:void 0,validators:[],shortcuts:["toggleBothSidebars"],closeParentMenu:!0,action:e=>{let{environment:t}=e;X.toggleBothSidebars(t)}}),vt=(0,G.cs)({key:"open comments tab in update sidebar",analyticsName:"Open comments tab in update sidebar",displayName:void 0,validators:[],shortcuts:["openCommentsTabInUpdateSidebar"],closeParentMenu:!0,action:e=>{let{environment:t}=e;X.setUpdateExpand({environment:t,isExpanded:!0,from:"keyboard_comments"}),X.setUpdateSidebarTab(ne.gY.Comments)}}),yt=(0,G.cs)({key:"open updates tab in update sidebar",analyticsName:"Open updates tab in update sidebar",displayName:void 0,validators:[],shortcuts:["openUpdatesTabInUpdateSidebar"],closeParentMenu:!0,action:e=>{let{environment:t}=e;X.setUpdateExpand({environment:t,isExpanded:!0,from:"keyboard_updates"}),X.setUpdateSidebarTab(ne.gY.Updates)}}),bt=(0,G.cs)({key:"open link annotation menu",displayName:Ae.createLinkName,analyticsName:Ae.createLinkName.defaultMessage,validators:[O.D,O.KL,O.U4,O.ry],shortcuts:["openLinkMenu"],closeParentMenu:!0,action:()=>A.dz({type:"focusOnly",focus:!0})}),St=(0,G.cs)({key:"open equation annotation menu",displayName:Ae.createEquationName,analyticsName:Ae.createEquationName.defaultMessage,validators:[O.D,O.ff(O.or([O.Kh,O.T2,O.QY,O.DU]))],shortcuts:["openEquationMenu"],closeParentMenu:!0,action:e=>P.qn({environment:e.environment,analyticsFrom:"input_keyboard_shortcut"})}),kt=(0,G.cs)({key:"exit app",analyticsName:"Exit app",displayName:void 0,validators:[O.ff(O.NW),O.Dt],shortcuts:["backbutton"],closeParentMenu:!0,action:e=>{let{environment:t}=e;if(t.mobileNative)if((0,W.__)(t)){const{TabbedRouterStore:e}=t;"home"!==e.state.activeTab?x.navigateToTab({environment:t,tab:"home",navigationAction:"pop",navigationSource:"mobile-back-navigation"}):t.mobileNative.exitApp()}else t.mobileNative.exitApp()}}),Mt=(0,G.cs)({key:"command left",analyticsName:"Go back",displayName:void 0,validators:[O.NW,O.ff(O.D)],shortcuts:["commandLeft"],closeParentMenu:!0,action:(e,t)=>x.back(e.environment)}),Ct=(0,G.cs)({key:"command right",analyticsName:"Go forward",displayName:void 0,validators:[O.vy,O.ff(O.D)],shortcuts:["commandRight"],closeParentMenu:!0,action:()=>x.forward()}),wt=(0,G.cs)({key:"go back",analyticsName:"Go back",displayName:void 0,validators:[O.NW],shortcuts:["goBack","backbutton"],closeParentMenu:!0,action:e=>{let{environment:t}=e;return x.back(t)}}),Nt=(0,G.cs)({key:"go forward",analyticsName:"Go forward",displayName:void 0,validators:[O.vy],shortcuts:["goForward"],closeParentMenu:!0,action:()=>x.forward()}),Pt=(0,G.cs)({key:"go up",analyticsName:"Go up",displayName:void 0,validators:[()=>x.canGoUp()],shortcuts:["goUp"],closeParentMenu:!0,action:e=>{let{environment:t}=e;return x.up(t)}}),At=(0,G.cs)({key:"switch spaces pre tabs",analyticsName:"Switch spaces pre tabs",displayName:void 0,validators:[O.d,O.ff(O.Vc)],shortcuts:["switchSpacesPreTabs"],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;if(!t||!Ie(t))return;t.preventDefault();const o=parseInt(a()(t.keyCode)),{currentUserRootStore:i,currentUserSettingsStore:s}=oe.default.state;i&&s&&(_.Yi({environment:n,index:o-1,userRootStore:i,userSettingsStore:s}),h.sos(n))}}),It=(0,G.cs)({key:"switch spaces post tabs",analyticsName:"Switch spaces post tabs",displayName:void 0,validators:[O.d,O.Vc],shortcuts:["switchSpacesPostTabs"],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;if(!t||!Ie(t))return;t.preventDefault();const o=parseInt(a()(t.keyCode)),{currentUserRootStore:i,currentUserSettingsStore:s}=oe.default.state;i&&s&&(_.Yi({environment:n,index:o-1,userRootStore:i,userSettingsStore:s}),h.sos(n))}}),Lt=(0,G.cs)({key:"open settings",analyticsName:"Open settings",displayName:void 0,validators:[O.d,O.ED],shortcuts:["settings"],closeParentMenu:!0,action:e=>{I.r$()}}),Rt=(0,G.cs)({key:"new page",analyticsName:"New page",displayName:void 0,validators:[O.RO,O.jl,O.or([O.d,O.Fx])],shortcuts:["newPage"],closeParentMenu:!0,action:e=>{let{environment:t}=e;X.quickAddPage({environment:t,from:"cmd_n"})}}),xt=(0,G.cs)({key:"turn into type",displayName:G.RE.turnIntoName,analyticsName:G.RE.turnIntoName.defaultMessage,validators:[O.J5,O.ff(O.fI),O.XQ,O.wF],shortcuts:["turnIntoType"],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:o}=e;if(!t||!Ie(t))return;t.preventDefault();const i=parseInt(a()(t.keyCode)),s=r.PH[i];D.createAndCommit({userAction:"actionRegistry.turnIntoTypeViaKeyboard",environment:o,perform:e=>{F.Cj({environment:o,blocks:n,blockType:s,transaction:e})}})}}),Tt=[xe({key:"toggle bold",displayName:Ae.boldName,analyticsName:Ae.boldName.defaultMessage,shortcuts:["toggleBold"],annotation:["b"]}),xe({key:"toggle italics",displayName:Ae.italicName,analyticsName:Ae.italicName.defaultMessage,shortcuts:["toggleItalics"],annotation:["i"]}),xe({key:"toggle strike",displayName:Ae.strikeThroughName,analyticsName:Ae.strikeThroughName.defaultMessage,shortcuts:["toggleStrike"],annotation:["s"]}),xe({key:"toggle underline",displayName:Ae.underlineName,analyticsName:Ae.underlineName.defaultMessage,shortcuts:["toggleUnderline"],annotation:[m.GKr.Underline]})],Bt=(0,G.cs)({key:"toggle dark mode",displayName:Ae.darkModeName,analyticsName:Ae.darkModeName.defaultMessage,validators:[],shortcuts:["toggleDarkMode"],closeParentMenu:!0,action:e=>{let{environment:t}=e;const n="light"===t.ThemeStore.state.mode?"dark":"light";t.device.isElectron&&h.CDl(t,{mode:n}),E.I6(n),E.h0(t,{mode:n,usingSystemTheme:!1})}}),_t=(0,G.cs)({key:"open peek view as page",displayName:Ae.openAsPageName,analyticsName:Ae.openAsPageName.defaultMessage,validators:[O.Tx],shortcuts:["commandEnter"],closeParentMenu:!0,action:e=>{let{environment:t}=e;ce.default.peekTarget.state&&x.navigateToBlock({environment:t,store:ce.default.peekTarget.state,pageVisitSource:s.tY.Expand})}}),Zt=(0,G.cs)({key:"toggle all toggles",displayName:Ae.openAllTogglesName,analyticsName:Ae.openAllTogglesName.defaultMessage,validators:[],shortcuts:["toggleAllToggles"],closeParentMenu:!0,action:e=>{let{environment:t}=e;const n=q.np();n&&j.X_(t,n)}});function Et(e){return e.actions.filter(Pe).map((t=>({...t,searchName:[e.title,t.displayName].filter(Boolean).join(" ")})))}const jt=(0,G.cs)({key:"toggle recording input latency",displayName:Ae.toggleRecordingInputLatencyName,analyticsName:Ae.toggleRecordingInputLatencyName.defaultMessage,validators:[],shortcuts:["toggleRecordingInputLatency"],closeParentMenu:!0,action:()=>{i.toggleRecordingInputLatency()}}),Dt=(0,G.cs)({key:"toggle qna in corner",displayName:Ae.toggleQnAMessage,analyticsName:"toggleQnAPane",validators:[O.lv,O.ff(O.D),...he.fF],shortcuts:["commandJ"],closeParentMenu:!0,action:e=>{let{environment:t}=e;var n;ie.Z.shouldShowAssistantInCorner()&&(V.d.state.open?(U.W(),z.N.setAssistantLastViewedTime(),"qna"===(null===(n=se.XN.state)||void 0===n||null===(n=n.selectedSkill)||void 0===n?void 0:n.skillType)&&h.Ti_(t,ae.NM.state)):T.em({environment:t,shouldResetAssistantStore:(0,ae.Sr)()}))}}),Ft=[Zt,Te,_e,ve.G,ye.Ay,...(0,ye.jW)()?ye.UO.actions:[],be.d,dt,ut,mt,ke.KB,we.B,we.L9,Me.$,Me.g,pe.U,pe.V,De,Fe,Ce.y,Ke,We,Ge,He,Qe,Je,Ye,rt,ct,$e,Xe,st,Ue,Ve,ze,Oe,Dt,qe,ge.OY,fe.H,ge.NY,bt,St,kt,wt,Nt,Mt,Ct,et,tt,nt,Pt,Se.A,Se.Q,At,It,at,it,xt,ke.Qk,ke.OW,pt,ft,gt,vt,yt,Lt,Rt,Bt,_t,lt,jt,ht,Ze,Ee,je,Be,Q,...Tt,...Et(Ne.g),...Et(me.te)]},62466:(e,t,n)=>{n.d(t,{y:()=>d});var o=n(5366),a=n(47839),i=n(32302),s=n(19037),r=n(88923),c=n(62967);const l=(0,o.defineMessages)({searchName:{id:"action.search.name",defaultMessage:"Search"}}),d=(0,c.cs)({key:"search",displayName:l.searchName,analyticsName:l.searchName.defaultMessage,validators:[s.jl,s.or([s.d,s.xD([s.QL("native-find-in-page"),s.lv,s.ff(s.YG),s.ff(s.f7)])])],shortcuts:["search"],closeParentMenu:!0,action:e=>{const t=[s.QL("native-find-in-page")(e),s.lv(e),s.ff(s.YG)(e),s.ff(s.f7)(e)].every((e=>Boolean(e))),n=s.d(e);if(t){var o;const e=null===(o=window.getSelection())||void 0===o?void 0:o.toString();i.Z(e)}else if(n){const e=r.default.isCenterPeekOpen();a.inPageSearch.start(e)}}})},15944:(e,t,n)=>{n.d(t,{o:()=>m,q:()=>p});var o=n(86628),a=n(68056),i=n(89086),s=n(28685),r=n(80444),c=n(24666),l=n(39699),d=n(37181);function u(){const e=c.default.state;if("editing"===e.mode){const t=(0,a.QY)(e.multiSelection);if(t&&(0,i.wd)(t.selection)){const e=t.store,n=s.E.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function m(){return(0,o.VK)(u,[])}function p(e){const{currentUserSettingsStore:t}=r.default.state;t&&l.createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{d.d2({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},userId:t.id})}},20073:(e,t,n)=>{n.d(t,{I:()=>i,O:()=>a});var o=n(23883);const a=e=>{const{cursors:t,rootStore:n}=e,a={};for(const o of t)for(const e of o.stack)for(const t of e)a[t.id]=t.index;o.Z.setLimitParents(n,a)},i=e=>{o.Z.removeLimitParents(e.rootStore)}},73966:(e,t,n)=>{n.d(t,{k2:()=>c,l6:()=>r,wk:()=>s});var o=n(42875),a=n(39699),i=n(37181);function s(e){const{environment:t,userSettingsStore:n}=e,a=n.getSettings(),i=null==a?void 0:a.time_zone,s=(0,o.r)();i!==s&&r({environment:t,userSettingsStore:n,timeZone:s})}function r(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;a.createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,perform:e=>{i.d2({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function c(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;a.createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,perform:e=>{i.d2({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},41464:(e,t,n)=>{n.d(t,{Z:()=>v});n(67294);var o=n(83355),a=n(63029),i=n(50906),s=n(68204),r=n(35328),c=n(77907),l=n(95802),d=n(8949),u=n(22294),m=n(86486),p=n(27724),h=n(38870),g=n(85893);class f extends o.Z{constructor(){super(...arguments),this.handleShortcut=(e,t)=>{if(!this.shouldBeActive())return;const{markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}=this.props,c=p.default.state.stores,d=p.default.state.pivot||c[0],u=d&&l.C.getRectFromStore(d),m=a.L6.find((t=>!!t.shortcuts.some((t=>t===e))&&s.vG(t,{environment:this.environment,blocks:c,originRect:u,publicEditMode:void 0})));if(m){"keydown"===t.type&&t.preventDefault&&t.preventDefault(),m.action({environment:this.environment,blocks:c,originRect:u,publicEditMode:void 0,lazyDependencies:{markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}},t);const e=c[0];let a,s;e&&(a=e.getType(),s=a?(0,r._A)(a,e.getFormat()):void 0),i.dhV(this.environment,{analyticsName:m.analyticsName,action_type:m.analyticsActionType,from:"keyboard_shortcut",block_id:null==e?void 0:e.id,block_type:a,is_toggleable:s}),this.enterKeyboardMode()}},this.prevX=void 0,this.prevY=void 0,this.handleWindowMouseMove=e=>{e.clientX===this.prevX&&e.clientY===this.prevY||(this.prevX=e.clientX,this.prevY=e.clientY,this.exitKeyboardMode())},this.shortcuts=this.getShortcutHandlers()}willMount(e){super.willMount(e),window.addEventListener("mousemove",this.handleWindowMouseMove)}willUnmount(){super.willUnmount(),window.removeEventListener("mousemove",this.handleWindowMouseMove)}renderComponent(){return(0,g.jsx)(h.Z,{priority:this.props.priority,enable:this.props.capture,shortcuts:this.shortcuts})}getShortcutHandlers(){const e={};for(const t of a.L6)for(const n of t.shortcuts)e[n]=e=>this.handleShortcut(n,e);return e}shouldBeActive(){return!this.intercomIsFocused()&&!d.Z.state.isActive}intercomIsFocused(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}enterKeyboardMode(){u.Z.setKeyboardMode(!0),m.default.reset()}exitKeyboardMode(){u.Z.setKeyboardMode(!1)}}function v(e){window.__c={n:"ActionRegistryShortcutListenerWithDeps"};const{value:t}=(0,c.useDependency)(c.deps.markdownLinkifyIt),{value:n}=(0,c.useDependency)(c.deps.tinyMceMicrosoftWordPasteFilter);return(0,g.jsx)(f,{...e,markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:n})}f.displayName="ActionRegistryShortcutListener"},3403:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(68785),a=n(33411),i=n(85893);function s(){return(0,i.jsx)(a.Z,{show:!0,showDelay:400,showHold:100,render:e=>(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e&&(0,i.jsx)(o.Z,{})})})}},26673:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});n(57658),n(67294);var o=n(83355),a=n(5366),i=n(3297),s=n(97977),r=n(28020),c=n(87279),l=n(38755),d=n(80444),u=n(89256),m=n(52275),p=n(78140),h=n(32163),g=n(40721),f=n(53437),v=n(31278),y=n(72495),b=n(85893);class S extends o.Z{constructor(){super(...arguments),this.renderPopup=()=>{const{device:e}=this.environment,t=u.Z.state;if(!t.open)return;const{currentUserRootStore:n}=d.default.state;if(!n)return;const o=[{key:"spaces",render:t=>(0,b.jsx)(y.Z,{title:e.isMobile?void 0:(0,b.jsx)(a.FormattedMessage,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),isTitleUppercase:!0,...t}),items:S.getSpaceViewMenuItems(this.environment,t.store)},{key:"logout",render:e=>(0,b.jsx)(y.Z,{...e,topBorder:!0}),items:[{key:"logout",action:()=>s.logout(this.environment),render:e=>{const{currentUserStore:t}=d.default.state;let n="";if(t){const e=t.getEmail();e&&(n=e)}return(0,b.jsx)(m.Z,{caption:(0,b.jsx)(a.FormattedMessage,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:n}}),...e})}}]}];let r;return r=e.isMobile?{menuType:c.og.Modal,title:(0,b.jsx)(a.FormattedMessage,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:(0,b.jsx)(g.CancelMenuText,{}),onClickRight:i.sC}:{menuType:c.og.Popup},(0,b.jsx)(p.Z,{...r,children:(0,b.jsx)(h.Z,{type:h.i.Vertical,sections:o,initialFocus:1})})}}renderComponent(){const{device:e}=this.environment;return(0,b.jsx)(f.ZP,{popupType:e.isMobile?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:u.Z.state.open,render:this.renderPopup,originGap:8,onDismiss:i.sC,originRect:u.Z.state.originRect,enableRounding:!0})}}S.displayName="ForkPagePopup",S.getSpaceViewMenuItems=(e,t)=>{const{device:n}=e,{currentUserRootStore:o}=d.default.state;if(!o)return[];const a=r.o(o),s=[];for(const r of a){const o=r.getSpaceStore();if(o){const a=(0,l.rn)(e,o),c=(0,l.Wd)(e,o);s.push({key:r.id,action:async()=>{await i.DK({environment:e,store:t,spaceStore:o,spaceViewStore:r,isPrivate:!0,context:"public_page_duplicate_multiple_workspace"})},render:e=>(0,b.jsx)(m.Z,{title:a,icon:(0,b.jsx)(v.Z,{icon:c,isEmptyPage:!1,title:a,size:n.isMobile?24:20,disabled:!0}),...e})})}}return s};const k=S},81059:(e,t,n)=>{n.d(t,{Z:()=>se});var o=n(67294),a=n(83355),i=n(82540),s=n(72126),r=n(80503),c=n(97880),l=n(51454),d=n(50906),u=n(47678),m=n(20073),p=n(61045),h=n(3898),g=n(72899),f=n(28020),v=n(43250),y=n(75079),b=n(78316),S=n(19124),k=n(51783),M=n(52533),C=n(67669),w=n(66430),N=n(45010),P=n(77907),A=n(18245);const I=(0,P.lazyComponent)(P.deps.personalHome,(e=>e.PersonalHomeContainer));var L=n(94841),R=n(24646),x=n(38676),T=n(34859),B=n(80444),_=n(88632),Z=n(24042),E=n(73329),j=n(17903),D=n(19111),F=n(56638),U=n(82136),V=n(88923),z=n(83212),O=n(87956),q=n(23063),K=n(68785),W=n(53336),H=n(26957),G=n(8848),J=n(5366),Y=n(42922),Q=n(85893);class $ extends a.Z{renderComponent(){let e;return _.Z.state.online?e=(0,Q.jsx)(J.FormattedMessage,{defaultMessage:"Oops, there was an error loading this page. Refresh to load it again.",id:"pageErrorIndicator.loadingError.message"}):(d.DCH(this.environment,{type:"page_error_indicator"}),e=this.environment.defaultRecordCache.persistedRecordCache?(0,Q.jsx)(J.FormattedMessage,{defaultMessage:"Please go online to load this page, then you'll be able to access it while offline.",id:"pageOfflineIndicator.hasLocalData.message"}):(0,Q.jsx)(J.FormattedMessage,{defaultMessage:"Oops, you seem to be offline. Please go online to view this page.",id:"pageOfflineIndicator.noLocalData.message"})),(0,Q.jsxs)("div",{style:this.getContainerStyle(),children:[(0,Q.jsx)("div",{style:this.getGreetingStyle(),children:e}),(0,Q.jsx)(Y.Z,{isLarge:!0,onClick:()=>window.location.reload(),children:(0,Q.jsx)(J.FormattedMessage,{defaultMessage:"Refresh",id:"pageErrorIndicator.reloadButton.label"})})]})}isLoggedIn(){return this.environment.currentUser.isLoggedIn()}getContainerStyle(){const{device:e}=this.environment;return{height:"100%",minHeight:this.isLoggedIn()?`calc(100vh - ${2*r.R6(this.environment.device.isElectronMac)}px)`:"100vh",paddingLeft:e.isMobile?16:32,paddingRight:e.isMobile?16:32,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}getGreetingStyle(){const{device:e}=this.environment;return{fontSize:e.isMobile?18:32,marginBottom:8,textAlign:"center",color:G.ZP.uiBlack,maxWidth:640,lineHeight:1.3}}}$.displayName="PageErrorIndicator";const X=$;var ee=n(85164),te=n(31192),ne=n(78901),oe=n(3553),ae=n(96234);class ie extends a.Z{constructor(){super(...arguments),this.pageContextStore=this.createComputedStore((()=>{const{presenceStore:e,pageVisitStore:t,currentSpaceStore:n,currentSpaceViewStore:o}=B.default.state;return{pageStore:this.props.store,spaceStore:n,spaceViewStore:o,presenceStore:e,pageVisitStore:t,publicEditModeStore:this.publicEditModeStore}})),this.publicEditModeStore=this.createComputedStore((()=>z.Z.getMode(this.environment,this.props.store))),this.renderAppInitializationOverlay=e=>{if(e)return(0,Q.jsx)("div",{style:{position:"absolute",height:"100vh",width:"100%"},children:(0,Q.jsx)(P.LazyAppInitializationOverlay,{collectionViewBlockStore:e})})},this.renderContent=e=>{const{store:t}=this.props,{pageVisitStore:n,presenceStore:a,currentLoadingContainerStore:i}=B.default.state;if(this.isPageInErrorState(e))return(0,Q.jsx)(X,{store:t});{const e=(0,R.$3)(this.environment),s=Math.max(f.CC,e),r=e+(0,R.vJ)(this.environment),c=(0,b.Ks)(t)&&!t.isFullWidth()?s:r,{WindowSizeStore:l,device:d}=this.environment,u=l.state.height,m=d.isMobile&&D.Z.state.open?u:0,h=te.Z.paddingBottom(this.environment,p._4()+m),g=V.default.isSidePeekOpen()||V.default.isSidePeekClosing.state;return(0,Q.jsxs)(o.Fragment,{children:[(0,Q.jsx)(te.Z,{context:U.S.Frame,style:g?{width:c,position:"absolute",left:0}:{},store:t,loadingContainerStore:i,paddingBottom:h,paddingLeft:(0,f.ui)(this.environment),paddingRight:(0,f.ui)(this.environment),pageCoverHeight:te.Z.defaultPageCoverHeight(this.environment),disabled:!1}),(0,Q.jsx)(ne.Z,{pageVisitStore:n,presenceStore:a,isPeekView:!1})]})}},this.renderFallbackMobileActionBar=e=>{const{isMobileNative:t}=this.environment.device;return(0,Q.jsx)(P.LazyMobileActionBar,{stores:e,position:t?M.nd.Bottom:M.nd.Floating,currentBlockStore:this.props.store})},this.handleScrollerMount=e=>{N.Z.PageScroller=e},this.storeHasReadableValue=this.createComputedStore((()=>{const{store:e}=this.props;return e.isDefined()&&e.canRead()})),this.isOffline=this.createComputedStore((()=>!_.Z.state.online)),this.maybeLogSearchScrollInteractionEvent=()=>{this.maybeLogSearchInteractionEvent("scroll")},this.onCopyListener=()=>{this.maybeLogSearchInteractionEvent("copy")},this.maybeLogSearchInteractionEvent=e=>{O.Z.state&&("scroll"===e?O.Z.state.hadScroll||(O.Z.setState({...O.Z.state,hadScroll:!0}),d.KkZ(this.environment,{interactionType:e})):"click"===e?O.Z.state.hadClick||(O.Z.setState({...O.Z.state,hadClick:!0}),d.KkZ(this.environment,{interactionType:e})):"copy"===e?O.Z.state.hadCopy||(O.Z.setState({...O.Z.state,hadCopy:!0}),d.KkZ(this.environment,{interactionType:e})):(0,c.t1)(e))}}willMount(){addEventListener("copy",this.onCopyListener)}willUnmount(){removeEventListener("copy",this.onCopyListener),m.I({rootStore:this.props.store})}renderComponent(){const{device:e,RouterStore:t}=this.environment,{isMobile:n}=e,{store:o,collectionViewStore:a,routerState:s}=this.props,{pageVisitStore:r,presenceStore:c,currentSpaceStore:l,currentSpaceViewStore:d}=B.default.state,u=this.isPageInErrorState(void 0),m=this.environment.currentUser.isLoggedIn(),{mainEditorCurrentBlockStore:p}=B.default.state,{shouldShowSidebar:h}=f.h1(this.environment),g="nativeTab"===t.state.route.name,y=(0,R.$3)(this.environment),b=y+(0,R.vJ)(this.environment),S=Boolean(this.props.store.getAppContainerBlockStore()),{isShowingTabBar:k}=Z.Z.state,M=x.cY.state,C=this.props.store.getAppContainerBlockStore();return(0,Q.jsx)(i.Mi,{value:this.pageContextStore.state,children:(0,Q.jsxs)("div",{className:""+(g?"hidden":""),style:{display:"flex",flexDirection:"column",width:e.isTablet?"unset":"100%",overflow:e.isTablet?"unset":"hidden"},children:[!n&&!S&&(0,Q.jsx)(ae.Z,{store:o,collectionViewStore:a,spaceStore:l,spaceViewStore:d,pageVisitStore:r,presenceStore:c,showSidebarButton:!k&&!(0,R.in)(this.environment),isElectron:e.isElectron,isInvalidPage:u,banners:E.Z.state.banners}),(0,Q.jsx)(q.Z,{isVisible:!0,animationStyle:{width:(0,L.q0)()?b:y},skipAnimation:k&&M.isResizing,render:()=>(0,Q.jsxs)("main",{style:{...this.getStyle(h)},className:v.Wiy,children:[n&&(0,Q.jsx)(P.LazyTopbarMobile,{store:o,collectionViewStore:a,spaceStore:l,spaceViewStore:d,pageVisitStore:r,presenceStore:c,isInvalidPage:u,shouldShowAddTo:Boolean(s.route.showMoveTo&&o.canEdit()&&m),saveParent:Boolean(s.route.saveParent),banners:E.Z.state.banners,isOffline:this.isOffline.state}),C?this.renderAppInitializationOverlay(C):this.renderPageContainer(),this.renderMobileActionBar(),this.shouldShowMobileBottomBar()&&m&&p&&(0,Q.jsx)(P.LazyMobileBottomBar,{store:p})]})})]})})}renderPageContainer(){const{RouterStore:e}=this.environment,{store:t,routerState:n}=this.props,{historyState:a}=n,{currentLoadingContainerStore:i,pageVisitStore:r}=B.default.state,c=a&&s.hj(a.scrollTop)?a.scrollTop:void 0,l=Boolean((0,C.IJ)(this.environment,t)),d=e=>{let{startTime:t,endTime:n}=e;const o=b.fm(this.props.store);A.default.measure({metricName:"collections.max_scroll_lag_in_session",startTime:t,endTime:n},{environment:this.environment,data:y.vS(o)})};return"personal_home_page"===this.props.store.getType()?(0,Q.jsx)(I,{}):(0,Q.jsx)(oe.Z,{store:t,isDefaultContainer:!0,droppable:!0,isRootContainer:!0,disableRectangularSelection:l,disable:Boolean(V.default.isMiniOrCenterPeekOpen()||F.Z.state.open),render:n=>{let{selectableEvents:a,selectableHoverMenuOverlay:s}=n;return(0,Q.jsx)(o.Suspense,{fallback:(0,Q.jsx)(H.Z,{isVisible:!0,store:this.props.store}),children:(0,Q.jsx)(ee.Z,{pageStore:t,pageVisitStore:r,scrollToBlockIds:h.uE(e),scrollToPosition:c,store:i,onReady:()=>{u.Y(this.environment)},onDone:()=>{this.props.store.isCollectionView()||"rendered"===B.default.state.renderPhase||B.default.setState({...B.default.state,renderPhase:"rendered"})},initialChunkSize:w.OZ,incrementChunkSize:30,render:e=>{let{error:t,ready:n,initialRequestCompleted:i,endOfResultsReached:r,isCollectionInPage:c}=e;const{isPhone:l}=this.environment.device;return(0,Q.jsxs)(o.Fragment,{children:[(0,Q.jsxs)(W.Z,{ref:this.handleScrollerMount,onScrollLagMeasure:c?d:void 0,onScroll:this.maybeLogSearchScrollInteractionEvent,preventType:V.default.isSidePeekOpen()?void 0:n?p.Q7(this.environment):T.Z.All,type:f.Zy({environment:this.environment,store:this.props.store}),style:this.getScrollerStyle(n),store:j.Z,...a,onClick:e=>{a.onClick(e),this.maybeLogSearchInteractionEvent("click")},children:[s,!l&&(0,S.GD)(this.publicEditModeStore.state)&&(0,Q.jsx)(g.GC,{scrollerStore:j.Z}),i&&this.renderContent(t),n&&!r&&!(i&&t)&&(0,Q.jsx)(K.Z,{style:this.getSpinnerStyle()})]}),l&&(0,S.GD)(this.publicEditModeStore.state)&&(0,Q.jsx)(g.GC,{scrollerStore:j.Z}),(0,Q.jsx)(H.Z,{isVisible:!n,store:this.props.store})]})}})})}},t.id)}renderMobileActionBar(){const e=this.environment.currentUser.isLoggedIn(),{isMobile:t}=this.environment.device;return e&&t?(0,k.LQ)({environment:this.environment})?(0,Q.jsx)(P.LazyMobileActionBarWrapper,{currentBlockStore:this.props.store,makeActionBarComponent:e=>{var t;return(0,Q.jsx)(P.LazyNativeMobileActionBar,{renderApi:null===(t=this.environment.mobileNative)||void 0===t?void 0:t.api.renderMobileActionBar,stores:e,currentBlockStore:this.props.store,fallbackRenderer:this.renderFallbackMobileActionBar})}}):(0,Q.jsx)(P.LazyMobileActionBarWrapper,{currentBlockStore:this.props.store,makeActionBarComponent:this.renderFallbackMobileActionBar}):null}isPageInErrorState(e){const{currentLoadingContainerStore:t}=B.default.state;return!(!e||!t||t.state.endOfResultsReached)||!this.storeHasReadableValue.getState()}getPageViewBlockBottomPadding(){return"number"==typeof te.Z.paddingBottom(this.environment)?`${te.Z.paddingBottom(this.environment)}px`:te.Z.paddingBottom(this.environment)}shouldShowMobileBottomBar(){const{isTablet:e,isMobileNative:t,isAndroid:n}=this.environment.device;return t&&(e||n)}getStyle(e){const{device:t}=this.environment,n={flexGrow:0,flexShrink:1,display:"flex",flexDirection:"column",background:(0,L.q0)()?this.theme.personalHomeBackground:this.theme.contentBackground,zIndex:l.Wi,height:t.isMobile?"100vh":`calc(100vh - ${r.R6(this.environment.device.isElectronMac)}px)`,maxHeight:"100%",...t.isTablet&&{position:"relative"},position:"relative"};if(!(0,R.Jr)(this.environment)){const e=x.TC.state;(0,R.YR)(this.environment)||(n.boxShadow=this.theme.mediumBoxShadow),n.pointerEvents=e?"none":"auto",n.transform="translateX(0)"}return!e&&t.isMobileNative&&(n.pointerEvents="auto",n.transform="translateX(0px)"),n}getScrollerStyle(e){const t={display:"flex",flexDirection:"column",zIndex:1,flexGrow:1,position:"relative",...e?{}:ie.hiddenStyle};return this.props.store.isCollectionView()?t:{...t,alignItems:"center"}}getSpinnerStyle(){return{zIndex:1,opacity:.5,width:ie.spinnerSize,height:ie.spinnerSize,marginTop:`calc(-${ie.spinnerSize} / 2 - ${this.getPageViewBlockBottomPadding()} / 2)`,marginBottom:24,marginLeft:"auto",marginRight:"auto"}}}ie.displayName="Frame",ie.spinnerSize="1.375em",ie.hiddenStyle={opacity:0,pointerEvents:"none",height:0};const se=ie},26957:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(480),a=n(86628),i=n(24405),s=n(80503),r=n(5366),c=(n(95477),n(34232)),l=n(88923),d=n(36596),u=n(68785),m=n(31192),p=n(85893);const h="1.375em";function g(e){let{store:t,peekMode:n}=e;window.__c={n:"FrameLoadingShimmer"};const s=(0,o.O7)(),r=(0,a.VK)((()=>t.hasCover()),[t]),c=(0,a.VK)((()=>t.hasIcon()),[t]),u=(0,a.VK)((()=>t.isCollectionView()),[t]),h=(0,a.VK)((()=>t.isFullWidth()),[t]),g=(0,a.VK)((()=>s.device.isMobile&&!s.device.isTablet),[s]),f=(0,a.VK)((()=>n===l.PeekModeCenter?"20vh":m.Z.defaultPageCoverHeight(s)),[s,n]),v=(0,i.yK)((()=>{const e=g?24:n===l.PeekModeSide?48:96,t=(()=>{switch(!0){case g:return 32;case c:return 96;case n===l.PeekModeCenter&&!c:return 54;case!c:return 102}})(),o=(()=>{switch(!0){case g&&r&&c:return 22;case g&&r&&!c:return 54;case g&&!r&&c:return 56;case g&&!r&&!c:return 4;case!g&&r&&c:return 50;case!g&&r&&!c:return 58;case!g&&!r&&c:return 92;case!g&&!r&&!c:return 20}})();return{collectionCoverPhoto:{width:"100%",height:"20vh"},collectionTitleContainer:{display:"flex",alignItems:"center",paddingLeft:e,paddingRight:e,width:"100%",paddingTop:(()=>{switch(!0){case g&&r:return 50;case g&&!r:return 78;case!g&&r:return 48;case!g&&!r:return 36}})()},collectionIcon:{flexGrow:0,flexShrink:0,width:36,height:36,borderRadius:6,marginRight:10,marginLeft:3},collectionTitle:{height:g?24:30,width:600,marginTop:g?6:3,borderRadius:15},pageCoverPhoto:{width:"100%",height:f},pageCoverPadding:{width:"100%",height:t},pageIconContainer:{maxWidth:"100%",boxSizing:"border-box",paddingLeft:e,paddingRight:e,width:h?"100%":900,height:36},pageIcon:{position:"relative",top:r?-42:0,width:78,height:78,marginLeft:2,borderRadius:16},pageTitleContainer:{display:"flex",boxSizing:"border-box",paddingLeft:e,paddingRight:e,width:h?"100%":900,maxWidth:"100%",paddingTop:o},pageTitle:{marginTop:g?3:0,height:g?24:30,width:600,borderRadius:15}}}),[h,r,c,f,g,n]);return u||n===l.PeekModeSide?(0,p.jsxs)(p.Fragment,{children:[r&&(0,p.jsx)(d.Z,{style:v.collectionCoverPhoto}),(0,p.jsxs)("div",{style:v.collectionTitleContainer,children:[c&&(0,p.jsx)(d.Z,{emphasized:!0,style:v.collectionIcon}),(0,p.jsx)(d.Z,{style:v.collectionTitle})]})]}):(0,p.jsxs)(p.Fragment,{children:[r?(0,p.jsx)(d.Z,{style:v.pageCoverPhoto}):(0,p.jsx)("div",{style:v.pageCoverPadding}),c&&(0,p.jsx)("div",{style:v.pageIconContainer,children:(0,p.jsx)(d.Z,{emphasized:!0,style:v.pageIcon})}),(0,p.jsx)("div",{style:v.pageTitleContainer,children:(0,p.jsx)(d.Z,{style:v.pageTitle})})]})}function f(e){let{isVisible:t,peekMode:n,store:d}=e;window.__c={n:"FrameLoadingState"};const f=(0,o.O7)(),v=(0,o.Fy)(),y=(0,r.useIntl)(),b=v.isMobile&&!v.isTablet,S=v.isMobileNative,k=s.R6(v.isElectronMac),M=(0,i.yK)((()=>({root:{position:"absolute",top:n===l.PeekModeCenter||n===l.PeekModeSide||b?`calc(${k}px + env(safe-area-inset-top))`:"env(safe-area-inset-top)",bottom:"env(safe-area-inset-bottom)",left:"env(safe-area-inset-left)",right:"env(safe-area-inset-right)",display:"flex",flexDirection:"column",alignItems:"center",pointerEvents:"none"}})),[n,b,k]),C=(0,a.VK)((()=>m.Z.paddingBottom(f)),[f]),w=!S||false;return(0,c.Z)(t,w?S?0:10:100,0)?(0,p.jsx)("div",{role:"progressbar","aria-valuetext":y.formatMessage({id:"frameLoadingState.loading",defaultMessage:"Loading..."}),style:{...M.root,...w?{}:{justifyContent:"center"}},children:w?(0,p.jsx)(g,{store:d,peekMode:n}):(0,p.jsx)(u.Z,{style:{zIndex:1,opacity:.5,width:h,height:h,...void 0===n&&{marginTop:`calc(-1.375em / 2 - ${C}px / 2)`,marginBottom:24,marginLeft:"auto",marginRight:"auto"}}})},"shimmer"):null}},85164:(e,t,n)=>{n.d(t,{Z:()=>se});n(21703);var o=n(73935),a=n(83355),i=n(1302),s=n(92595),r=n(7406),c=n(72126),l=n(62193),d=n(29477),u=n(45953),m=n(23867),p=n(32603),h=n(20073),g=n(25320),f=n(4408),v=n(3898),y=n(61202),b=n(11599),S=(n(57658),n(41432)),k=n(16691),M=n(64572),C=n(92516),w=n(73360),N=n(606),P=n(98963),A=n(18844),I=n(21202),L=n(6287),R=n(13493),x=n(70279),T=n(33709),B=n(19889),_=n(70203);var Z=n(54642),E=n(95477),j=n(45950),D=n(5659),F=n(32223),U=n(84709),V=n(83055),z=n(66430);async function O(e){const{environment:t,request:n,abortSignal:o,prefetchCacheKey:a}=e;return(0,V.B)(),F.isConnected()||F.isConnecting()?Z.loadCachedPageChunk(t,n,void 0,void 0,o,a):Z.loadPageChunk(t,function(e){if("none"===z.l4)return e;return{...e,page:{id:e.page.id,spaceId:(0,m.C)(void 0)}}}(n),void 0,void 0,o,a)}async function q(e){const{environment:t,request:n,prefetchPromise:o,abortSignal:a,useInMemoryCacheOnly:i}=e,s=u.PF.create(),r=await async function(e,t,n){let o;o=e.cursor?c.Xh(e.cursor.stack):[];const a=e.page.id,i=e.limit,s=u.Ak.create();0===o.length&&o.push([{table:I.iU,id:a,index:0}]);let r=0,l=0;const d=C.s.fromMonomorphicFunctionUnsafe((async e=>{const n=s.getModel(e);if(l+=1,n)return n;const o=await t(e);return s.setModel(e,o),o&&await p(o),o})),m=new Set,p=async function(t){const o=[];if((0,w.tz)(t)){const e=t.getParentPointer();o.push([e,"Block parent_id"])}if(t.table===I.iU){const n=t.getCollectionViewPointers();for(const e of n)o.push([e,"CollectionViewBlock view_id"]);const a=t.getCollectionPointer();a&&o.push([a,"CollectionViewBlock collection_id"]);const i=t.getDiscussionPointers();for(const e of i)o.push([e,"Discussion"]);const s=t.getProperties().title;if((0,S.XD)(t.getType())&&s){const n=_.lzi(s),a=c.G0(...n.map(_.hDy));for(const i of a){if(_.STW(i)&&o.push([{table:I.iU,id:_.TOT(i)},"page annotation"]),_.IWo(i)&&o.push([{table:B.KJ,id:_.zEN(i)},"user annotation"]),_.j0F(i)){const t=_.zW$(i),n=(0,M.A5)({url:t,baseUrl:e.baseUrl,publicDomainName:e.publicDomainName});n&&o.push([{table:I.iU,id:n},"link annotation"])}if(_.nSN(i)){const e=_.frW(i);e&&o.push([{table:I.iU,id:e,spaceId:t.space_id},"eoi annotation"])}}}if(t.getType()===S.Ti.alias){const e=t.getAliasTargetPointer();e&&o.push([e,"alias"])}else if(t.isExternalObjectInstanceType()){const e=t.getExternalObjectSubInstancePointers();for(const t of e)o.push([t,"eoi"])}else if(t.getType()===S.Ti.button){const e=t.getAutomationPointer();e&&o.push([e,"button_automation"])}}else if(t.table===T.qF)for(const e of t.getCommentPointers())o.push([e,"discussion table comment"]);else if(t.table===x.x_){for(const e of t.getContentPointers())o.push([e,"comment table attachment"]);for(const e of t.getReactionPointers())o.push([e,"comment table reaction"])}else if(t.table===R.n){const e=t.getFormatStore().getKeyStore("collection_pointer").getValue();e&&o.push([e,"CollectionView collection_id"])}else if(t.table===P.cv){const e=t.getActionPointers();for(const t of e)o.push([t,"Automation action_ids"])}else if(t.table===A.Xj)for(const e of t.getBlocks())o.push([{table:I.iU,id:e},"Automation action blocks"]);else if(t.table===L.v)for(const e of t.getAutomationPointers())o.push([e,"Collection automation_ids"]);await Promise.all(o.filter((e=>{let[t,n]=e;const o=(0,k.dn)(t);return!m.has(o)&&(m.add(o),!0)})).map((e=>{let[o,a]=e;return n&&n({table:t.table,id:t.id},o,a),o})).map(d))},h=async function(){const t=[],s=o[o.length-1];if(r>=i&&l>10*i||!s)return!1;const c=await Promise.all(s.map((async e=>{const{table:t,id:n}=e,o=N.dr.fromPointerLike({table:t,id:n});return await d(o)}))),u=[];for(let n=0;n<s.length;n++){const i=s[n],r=c[n];if(!r||r.table!==I.iU)continue;const l=null==r?void 0:r.getContentIds(),d=null==r?void 0:r.getFormat();if(!e.verticalColumns&&r&&l&&"column_list"===r.type&&0===i.index){for(let e=0;e<l.length;e++){const n=l[e];u.push([{table:I.iU,id:n},i,"column"]),t.push({table:I.iU,id:n,index:0})}i.index=l.length}else if(r&&"transclusion_reference"===r.type&&d&&d.transclusion_reference_pointer&&0===i.index)u.push([d.transclusion_reference_pointer,i,"transclusion reference"]),t.push({...d.transclusion_reference_pointer,index:0}),i.index=1;else if(r&&l&&(0,S.Um)(r.type,d)&&(r.id===a&&1===o.length||!(0,S.Pm)(r.type)&&!(0,S.BX)(r.type,d))&&l[i.index]){const e=l[i.index];u.push([{table:I.iU,id:e},i,"block content child"]),t.push({table:I.iU,id:e,index:0}),i.index++}}await Promise.all(u.map((e=>{let[t,o,a]=e;return n&&n(o,t,a),t})).map(d));const m=t.filter((e=>{for(let t=0;t<o.length;t++){const n=o[t];for(let t=0;t<n.length;t++){const o=n[t];if(o.table===e.table&&o.id===e.id)return!1}}return!0}));return m.length>0?(o.push(m),r++):o.pop(),!0};for(;await h(););return{recordMap:s,cursorValue:{stack:o}}}({...n,baseUrl:E.default.domainBaseUrl,publicDomainName:E.default.publicDomainName},C.s.fromMonomorphicFunctionUnsafe((async e=>{const n=await j.Ye({environment:t,pointer:e,prefetchPromise:o,useInMemoryCacheOnly:i});if(null!=a&&a.aborted)throw new Error("Abort signal received");if(n)return s.setModelAndRole(e,n.model,n.role),n.model;throw new Error(`Record not found: ${e.table},${e.id}`)})),D.A.enableLogging?(e,t,n)=>{console.log(`Spidering from ${e.table}:${e.id} to ${t.table}:${t.id} (${n})`)}:void 0);return{recordMap:s.toJson({allowVersionDowngrade:!1}),cursor:r.cursorValue}}var K=n(77546),W=n(11799),H=n(82798),G=n(33147),J=n(97880);class Y extends G.Z{constructor(e){super(),this.blocks=void 0,this.liveBlocks=void 0,this.rootBlock=void 0,this.detachedRootBlocks=void 0,this.blocks=new Map,this.liveBlocks=new Map,this.rootBlock=this.createBlock(e,"page"),this.detachedRootBlocks=new Map}hasBlock(e){return this.blocks.has(e)}getBlock(e){return(0,H.TO)(this.blocks.get(e))}createBlock(e,t){(0,H.T)(!this.hasBlock(e.id));const n=new Q(e,this,t);return this.blocks.set(n.getId(),n),n.hasLiveReference()&&this.addLiveBlock(n),n}removeBlock(e){(0,H.T)(this.hasBlock(e)),(0,H.T)(!this.liveBlocks.has(e),"Should not be possible to remove a live block."),this.blocks.delete(e)}addLiveBlock(e){(0,H.T)(!this.liveBlocks.has(e.getId())),this.liveBlocks.set(e.getId(),e),this.emit({type:"add_block",blockStore:e.blockStore})}removeLiveBlock(e){this.liveBlocks.delete(e.getId()),this.emit({type:"remove_block",blockId:e.getId()})}destroy(){for(const e of this.blocks.values())e.destroy();this.blocks.clear(),this.liveBlocks.clear(),this.detachedRootBlocks.clear()}}class Q{constructor(e,t,n){this.tracker=void 0,this.blockStore=void 0,this.liveReferences=void 0,this.detachedReferences=void 0,this.childBlocks=void 0,this.contentStoreListener=void 0,this.tracker=t,this.blockStore=e,this.liveReferences=new Set,this.detachedReferences=new Set,"page"===n||n.hasLiveReference()?this.liveReferences.add(n):this.detachedReferences.add(n),this.childBlocks=new Map,this.contentStoreListener=()=>this.handleContentStoreChange(),this.blockStore.getKeyStore("type").addListener(this.contentStoreListener),this.blockStore.getContentStore().addListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").addListener(this.contentStoreListener),this.handleContentStoreChange()}handleContentStoreChange(){const e=[...this.childBlocks.keys()],t=new Map,n=this.blockStore.getType();if(this.liveReferences.has("page")||n&&!(0,S.S9)(n)){const e=new Set(this.blockStore.getRenderableContentIds()),n=this.blockStore.getContentStores();for(const a of n)e.has(a.id)&&t.set(a.id,a);const o=function(e){const t=e.getType();if(!t)return[];switch(t){case"transclusion_reference":const n=e.getTransclusionReferenceTargetStore();return n?[n]:[];case"text":case"page":case"personal_home_page":case"bulleted_list":case"numbered_list":case"toggle":case"quote":case"factory":case"button":case"to_do":case"column_list":case"column":case"embed":case"framer":case"tweet":case"gist":case"drive":case"audio":case"maps":case"invision":case"mixpanel":case"image":case"video":case"file":case"bookmark":case"equation":case"code":case"header":case"sub_header":case"sub_sub_header":case"collection_view":case"collection_view_page":case"breadcrumb":case"copy_indicator":case"divider":case"link_to_page":case"link_to_collection":case"figma":case"loom":case"typeform":case"codepen":case"pdf":case"callout":case"table_of_contents":case"whimsical":case"miro":case"abstract":case"sketch":case"excalidraw":case"replit":case"alias":case"transclusion_container":case"external_object_instance":case"table":case"table_row":case"tab":case"external_object_instance_page":case"hex":case"deepnote":case"ai_block":case"drawing":return[];default:(0,J.t1)(t)}}(this.blockStore);for(const a of o)t.set(a.id,a)}const o=[...t.keys()],a=c.e5(o,e),i=c.e5(e,o);for(const s of a)if(this.tracker.hasBlock(s)){const e=this.tracker.getBlock(s);e.addReference(this),this.childBlocks.set(s,e)}else{const e=this.tracker.createBlock((0,H.TO)(t.get(s)),this);this.childBlocks.set(s,e)}for(const s of i){const e=(0,H.TO)(this.childBlocks.get(s));this.childBlocks.delete(s),e.removeReference(this)}}getId(){return this.blockStore.id}hasLiveReference(){return this.liveReferences.size>0}addReference(e){e.hasLiveReference()?this.addLiveReference(e):this.addDetachedReference(e)}addLiveReference(e){if((0,H.T)(!this.liveReferences.has(e)),this.liveReferences.add(e),1===this.liveReferences.size)for(const t of this.childBlocks.values())this.tracker.addLiveBlock(this),t.updateReference(this)}addDetachedReference(e){this.detachedReferences.add(e)}removeReference(e){e.hasLiveReference()?this.removeLiveReference(e):this.removeDetachedReference(e)}removeLiveReference(e){if(this.liveReferences.delete(e),this.detachedReferences.add("detached"),this.tracker.detachedRootBlocks.set(this.getId(),this),0===this.liveReferences.size){this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}removeDetachedReference(e){if(this.detachedReferences.delete(e),0===this.liveReferences.size&&0===this.detachedReferences.size){for(const[e,t]of this.childBlocks.entries())this.childBlocks.delete(e),t.removeReference(this);this.tracker.removeBlock(this.getId()),this.destroy()}}updateReference(e){const t=this.hasLiveReference();this.liveReferences.has(e)&&!e.hasLiveReference()?(this.liveReferences.delete(e),this.detachedReferences.add(e)):this.detachedReferences.has(e)&&e.hasLiveReference()&&(this.liveReferences.add(e),this.detachedReferences.delete(e));const n=this.hasLiveReference();if(t!==n){n?this.tracker.addLiveBlock(this):this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}destroy(){this.contentStoreListener&&(this.blockStore.getKeyStore("type").addListener(this.contentStoreListener),this.blockStore.getContentStore().removeListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").removeListener(this.contentStoreListener),this.contentStoreListener=void 0)}}const $=new class{constructor(){this.pageInfoMap=new W.Z}trackPage(e){if(this.pageInfoMap.has(e.pointer))return void(0,H.TO)(this.pageInfoMap.get(e.pointer)).count++;const t=new Y(e);this.pageInfoMap.set(e.pointer,{pageBlockTracker:t,count:1})}untrackPage(e){const t=(0,H.TO)(this.pageInfoMap.get(e));t.count--,0===t.count&&(t.pageBlockTracker.destroy(),this.pageInfoMap.delete(e))}};var X=n(95802),ee=n(88632),te=n(79167),ne=n(77144),oe=n(93220);let ae=!1;(0,s.exposeDebugValue)("toggleLogLocalPageLoadFailures",(()=>{ae=!ae,console.info(ae?"Local page load error logging enabled":"Local page load error logging disabled")}));class ie extends a.Z{constructor(){super(...arguments),this.lastTimeout=void 0,this.node=void 0,this.scrollableAncestor=void 0,this.isCollectionInPage=!1,this.trackPage=new l.EJ,this.storeTypes={store:oe.Z},this.handleConnectionStateChange=()=>{const{store:e}=this.stores,t=ee.Z.state.online;t&&!this.lastOnlineState&&e.state.error&&(e.reset(),this.requestNextChunk()),this.lastOnlineState=t},this.onReady=c.IH(this.props.onReady?this.props.onReady:()=>{}),this.onDone=c.IH(this.props.onDone?this.props.onDone:()=>{}),this.requestNextChunk=async()=>{const{loading:e,endOfResultsReached:t,initialRequestCompleted:n,currentCursor:o,currentChunkNumber:a,ready:s,error:c}=this.stores.store.state,{incrementChunkSize:l,initialChunkSize:u}=this.props;if(e||t||n&&c)return;this.stores.store.setState({...this.stores.store.state,loading:!0});const m=n?l:u;let p;n||ne.Z.state.initialRenderCompleted||this.environment.device.isAndroid||(p=new d._W(async function(e,t){const n=e.currentUser.id;if(!n||!e.defaultRecordCache.persistedRecordCache)return Promise.resolve(void 0);(await e.defaultRecordCache.persistedRecordCache.getPageBlocksByParent({page:t,userId:n})).forEach((t=>{e.defaultRecordCache.inMemoryRecordCache.setRecord({pointer:t.pointer,userId:t.userId},t.value),e.defaultRecordCache.inMemoryRecordCache.emitRecord(t.pointer,[]),U.unsubscribeAfterDelay({environment:e,pointer:t.pointer,userId:t.userId})}))}(this.environment,{id:this.props.pageStore.id,table:this.props.pageStore.table})));try{const e=await this.requestPageChunk(m,o,a||0,p);n&&await i.default.afterNextFlush();const t=this.isScrolledToPosition()&&this.scrollToBlocksAreRendered(),r=s||!e||t;!s&&r&&i.default.afterNextFlush((()=>{i.default.afterNextFlush((()=>{this.onReady()}))}));const c=!e;this.stores.store.setState({...this.stores.store.state,ready:r,initialRequestCompleted:!0,loading:!1,currentCursor:e?e.cursor:void 0,currentChunkNumber:e?e.chunkNumber:void 0,endOfResultsReached:c,error:void 0}),c&&this.onDone()}catch(h){this.stores.store.setState({...this.stores.store.state,ready:!0,initialRequestCompleted:!0,loading:!1,error:(0,r.tg)(h)})}},this.requestPageChunk=async(e,t,n,o)=>{const{device:a}=this.environment,{pageStore:i}=this.props,s=(0,m.C)(i.pointer.spaceId),r={page:{id:i.id,spaceId:s},limit:e,cursor:t||{stack:[]},chunkNumber:n,verticalColumns:a.isMobile},c=t?Promise.resolve(void 0):this.loadScrollToBlocks(),l=this.environment.prefetchCache.isEnabled&&!ne.Z.state.initialRenderCompleted?this.performLocalOrRemoteLoadPageChunkInParallel({request:r,initialPreloadPromise:o}):this.performLocalOrRemoteLoadPageChunkSerially({request:r,initialPreloadPromise:o});p.measureSubMetric({name:"render_end_to_await_page_chunk_start",startTime:e=>{var t;return null===(t=e.render_start_to_render_end)||void 0===t?void 0:t.endTime},endTime:performance.now()});const u=await l;if(!u)throw new Error("No successful load result found.");if(!ne.Z.state.initialRenderCompleted&&0===n){p.measureSubMetric({name:"await_page_chunk_start_to_await_page_chunk_end",startTime:e=>{var t;return null===(t=e.render_end_to_await_page_chunk_start)||void 0===t?void 0:t.endTime},endTime:performance.now()});const e=this.environment.prefetchCache;p.updateMetricData({page_chunk_source:u.source,page_chunk_prefetch:e.isEnabled?e.getPrefetchAnalytic("initialLoadPageChunk"):{type:"disabled"}})}this.environment.currentUser.isLoggedIn()&&(te.Z.addFromRecordMapWithRole(u.recordMap),te.Z.isEmpty()||y.dY({environment:this.environment}));const g=performance.now();await(0,d.aM)(c,5e3),ne.Z.state.initialRenderCompleted||0!==n||p.updateMetricData({scroll_to_blocks_wait_time:performance.now()-g}),h.O({rootStore:i,cursors:[u.cursor]});const f=u.cursor.stack.length>0?u.cursor:void 0;if(f)return{cursor:f,chunkNumber:n+1}}}shouldComponentUpdate(){return!0}didMount(){super.didMount(),this.lastOnlineState=ee.Z.state.online,this.node=o.findDOMNode(this),this.scrollableAncestor=(0,K.VW)(this.node),ee.Z.addListener(this.handleConnectionStateChange)}didMountOrUpdate(){super.didMountOrUpdate();const{pageStore:e}=this.props,{initialRequestCompleted:t,error:n}=this.stores.store.state;this.trackPage.effect((()=>{if(e.useCrdt()&&t&&!n)return $.trackPage(e),()=>$.untrackPage(e)}),[e.id,e.useCrdt(),t,n]),this.requestNextChunk()}willUnmount(){super.willUnmount(),this.lastTimeout&&window.clearTimeout(this.lastTimeout),ee.Z.removeListener(this.handleConnectionStateChange),this.trackPage.unmount()}renderComponent(){const{ready:e,error:t,initialRequestCompleted:n,endOfResultsReached:o}=this.stores.store.state;return this.props.render({error:t,ready:e,initialRequestCompleted:n,endOfResultsReached:o,isCollectionInPage:this.isCollectionInPage})}async performRemoteLoadPageChunk(e){const{request:t,abortSignal:n}=e,{pageStore:o,pageVisitStore:a}=this.props;if(0===t.chunkNumber){const e=O({environment:this.environment,request:t,abortSignal:n,prefetchCacheKey:"initialLoadPageChunk"});this.environment.LocalBacklinkStore.initializeBacklinks({block:{id:o.id,spaceId:(0,m.C)(o.pointer.spaceId)},currentUserId:this.environment.currentUser.id,environment:this.environment});const i=this.environment.LocalBacklinkStore.awaitLoaded(o.id);g.Ri(this.environment,{block:o,pageVisitStore:a,incremental:!1});const s=b.A$("backlinks","section_show"),r=e.then((()=>(0,d.aM)(i,1e3))),[c]=s?await Promise.all([e,r]):await Promise.all([e]);if("success"===c.type){const e=u.PF.create(c.data.recordMap);return this.isCollectionInPage=this.didLoadANonParentCollection(t.page,e,o.inMemoryRecordCache),{recordMap:e,cursor:c.data.cursor,source:"remote"}}}else{const e=await O({environment:this.environment,request:t,abortSignal:n,prefetchCacheKey:void 0});if("success"===e.type){const n=u.PF.create(e.data.recordMap);return this.isCollectionInPage=this.didLoadANonParentCollection(t.page,n,o.inMemoryRecordCache),{recordMap:n,cursor:e.data.cursor,source:"remote"}}}}async performLocalLoadPageChunk(e){const{request:t,initialPreloadPromise:n,abortSignal:o,useInMemoryCacheOnly:a}=e,{pageStore:i}=this.props;try{const e=await D.A.measure("localLoadPageChunk",`${t.page.id} ${t.cursor.stack.length}`,(()=>q({environment:this.environment,request:t,prefetchPromise:n,abortSignal:o,useInMemoryCacheOnly:a}))),s=u.PF.create(e.recordMap);return f.fL({environment:this.environment,inMemoryRecordCache:i.inMemoryRecordCache,recordMap:s,debugSource:"PageLoadaingContainer.performLocalLoadPageChunk"}),this.isCollectionInPage=this.didLoadANonParentCollection(t.page,s,i.inMemoryRecordCache),{cursor:e.cursor,recordMap:s,source:"local"}}catch(s){ae&&console.error(s)}}didLoadANonParentCollection(e,t,n){var o;if(this.isCollectionInPage)return!0;const a=null===(o=n.getRecord({pointer:{table:"block",id:e.id,spaceId:e.spaceId},userId:this.environment.currentUser.id}))||void 0===o?void 0:o.value;if(a)for(const c of t.getByTable("block")){var i,s,r;if(("collection_view"===(null===(i=c.value)||void 0===i||null===(i=i.value)||void 0===i?void 0:i.type)||"collection_view_page"===(null===(s=c.value)||void 0===s||null===(s=s.value)||void 0===s?void 0:s.type))&&a.parent_id!==(null===(r=c.value)||void 0===r||null===(r=r.value)||void 0===r?void 0:r.collection_id))return!0}return!1}async performLocalOrRemoteLoadPageChunkInParallel(e){const t=await this.performLocalLoadPageChunk({...e,useInMemoryCacheOnly:!0});if(t)return t;const n=new AbortController,o=this.performRemoteLoadPageChunk({...e,abortSignal:n.signal});if(!this.environment.defaultRecordCache.persistedRecordCache)return await o;const a=new AbortController,i=[{promise:this.performLocalLoadPageChunk({...e,abortSignal:a.signal}),abortController:a},{promise:o,abortController:n}],{winner:s}=await(0,d.S3)(i.map((e=>e.promise))),r=0===s?1:0,c=i[s],l=i[r],u=await c.promise;return u?(l.abortController.abort(),u):await l.promise}async performLocalOrRemoteLoadPageChunkSerially(e){const t=await this.performLocalLoadPageChunk(e);return t||await this.performRemoteLoadPageChunk(e)}async loadScrollToBlocks(){this.props.scrollToBlockIds&&await v.Nz(this.props.pageStore,this.props.scrollToBlockIds)}scrollToBlocksAreRendered(){const{scrollToBlockIds:e}=this.props;return!e||X.C.findSelectablesFromIds(e).length===e.length}isScrolledToPosition(){const{scrollToPosition:e}=this.props;return!this.scrollableAncestor||!c.hj(e)||e<=this.scrollableAncestor.scrollHeight-this.scrollableAncestor.clientHeight}}ie.displayName="PageLoadingContainer",ie.scrollThrottle=200;const se=ie},78901:(e,t,n)=>{n.d(t,{Z:()=>T});n(57658),n(67294);var o=n(83355),a=n(72126),i=n(19889),s=n(51454),r=n(48514),c=n(83420),l=n(33929),d=n(20095),u=n(17504),m=n(65598),p=n(439),h=n(95802),g=n(80444),f=n(24229),v=n(77080),y=n(17903),b=n(22294),S=n(42057),k=n(35661),M=n(86486),C=n(27724),w=n(24666),N=n(23063),P=n(9612),A=n(68930),I=n(45653),L=n(65200),R=n(85893);class x extends o.Z{constructor(){super(...arguments),this.interval=void 0,this.containerEl=void 0,this.handleContainerMount=e=>{e&&(this.containerEl=e)},this.findComponentByBlockId=(e,t,n)=>e.find((e=>{const o=e.props.store;return Boolean(o&&o.id===t&&n.uiContains(o)&&e.props.shouldShowHalo)})),this.presenceAvatarsStore=this.createComputedStore((()=>this.getPresenceAvatars(this.attributionAvatarsStore.state)),!0,"presenceAvatarsStore"),this.blockAttributionEnabledStore=this.createComputedStore((()=>v.default.checkGate("block_attribution")),!1,"blockAttributionEnabledStore"),this.attributionAvatarsStore=this.createComputedStore((()=>{var e;if(!this.blockAttributionEnabledStore.state)return[];const t=this.props.isPeekView?S.Z:y.Z,n=t.state.scrollTop-5e3,o=n+((null===(e=t.state.clientRect)||void 0===e?void 0:e.height)||0)+5e3,a=this.getAttributionAvatars();a.sort(((e,t)=>e.top-t.top));const i=[];return a.every((e=>e.top>=n&&e.top<=o&&(i.push(e),!0))),i}),!0,"attributionAvatarsStore"),this.updateAvatars=()=>{this.attributionAvatarsStore.recompute()},this.updateAvatarsDebounced=a.Ds(this.updateAvatars,100)}didMount(){super.didMount(),this.blockAttributionEnabledStore.state&&(window.addEventListener("resize",this.updateAvatarsDebounced),this.interval=setInterval(this.updateAvatarsDebounced,x.updateInterval))}willUnmount(){super.willUnmount(),window.removeEventListener("resize",this.updateAvatarsDebounced),clearInterval(this.interval)}renderComponent(){return(0,R.jsx)("div",{className:"notion-presence-container",style:x.containerStyle,ref:this.handleContainerMount,children:(0,R.jsx)(P.Z,{render:()=>a.oA([...this.presenceAvatarsStore.state.map((e=>this.renderPresenceAvatar(e))),...(this.attributionAvatarsStore.state||[]).map((e=>this.renderAttributionAvatar(e)))])})})}renderPresenceAvatar(e){const{device:t}=this.environment,{rootStore:n}=this.props.presenceStore.state;if(n&&"presence"===e.type){const{left:o,top:a,userId:s}=e,r=this.getAvatarWrapEnterExitStyle(o,a),c=k.U6.createChildStore(n,{table:i.KJ,id:s});if(!c.isDefined())return;return(0,R.jsx)(N.Z,{isVisible:!0,enterAnimationStyle:r,exitAnimationStyle:r,animationStyle:this.getAvatarWrapAnimationStyle(o,a),render:()=>(0,u.Z)((n=>(0,R.jsx)("div",{style:this.getAvatarWrapStyle(e.blockType),...n,children:(0,R.jsx)(I.Z,{userStore:c,style:this.getAvatarStyle(),size:t.isMobile?x.avatarMobileSize:x.avatarSize,avatarShouldShowShadow:!0})},s)))},s)}}renderAttributionAvatar(e){const{rootStore:t}=this.props.presenceStore.state;if(t&&"attribution"===e.type){const{left:n,top:o,actor:a,uniqueId:i,blockStore:s}=e,r=this.getAvatarWrapEnterExitStyle(n,o),d=(0,c.nc)({parentStore:t,pointer:a});if(!d.isDefined())return;const m=l.default.getIntl();return(0,R.jsx)(N.Z,{isVisible:!0,enterAnimationStyle:r,exitAnimationStyle:r,animationStyle:this.getAvatarWrapAnimationStyle(n,o),springConfig:{scale:{stiffness:200,damping:25,precision:.01},opacity:{stiffness:400,damping:25,precision:.01}},render:()=>(0,u.Z)((e=>(0,R.jsx)("div",{style:this.getAvatarWrapStyle(),...e,children:(0,R.jsx)(A.Z,{userId:d.id,name:d.getDisplayName(m),style:this.getAvatarStyle(),size:x.avatarSize,tooltipStore:s})},i)))},i)}}findComponentClosestToPresenceBlock(e,t,n){const o=new Map(t.map(((e,t)=>[e,t])));let a,i;for(const s of e){const e=s.props.store,t=o.get(e.id);if(void 0!==t&&((void 0===i||t<i)&&n.uiContains(e)&&s.props.shouldShowHalo&&(a=s,i=t),0===i))return a}return a}getPresenceAvatars(e){const{pageVisitStore:t,presenceStore:n}=this.props,o=new Set(e.map((e=>{let{blockStore:t}=e;return t.id}))),{rootStore:i}=n.state;if(!i)return[];if(!this.containerEl)return[];const s=this.environment.currentUser.id,r=(0,d.AQ)(t,n).filter((e=>e.userId!==s&&(0,d.MR)(this.environment,e)));if(r.length>0){const e={},t=h.C.getMembersByDOMOrder({filter:()=>!0}),n=this.containerEl.getBoundingClientRect(),s=M.default.state;return a.oA(r.map((a=>{const r=(0,d.EB)(a),c=null==a?void 0:a.blockPath;let l;if(c&&c.length>0?l=this.findComponentClosestToPresenceBlock(t,c,i):r&&(l=this.findComponentByBlockId(t,r,i)),!l)return;const u=l.props.store.id;e.hasOwnProperty(u)||(e[u]=0),e[u]++;const m=l.getNode();if(!(m&&m instanceof Element))return;const p=m.getBoundingClientRect(),h=s.isOpen&&s.currentStore.id===u?x.selectableHoverMenuTargetOffset:0,g=o.has(u)?1:0;if(p){let t=p.left-n.left-h;const o=l.getContextHorizontalScroller();if(o){const e=o.stores.store.state.clientRect,a=null==e?void 0:e.left,i=null==e?void 0:e.right;if(i&&p.left>i)return;a&&(t=Math.max(a-n.left-h,t))}return{type:"presence",userId:a.userId,left:t,top:p.top-n.top+(e[u]+g-1)*x.iconStackOffset,blockType:l.props.store.getType()}}})))}return[]}getAttributionAvatars(){var e;const t=v.default.checkGate("block_attribution"),{currentUserSettingsStore:n}=g.default.state,o=(null==n||null===(e=n.getSettings())||void 0===e?void 0:e.show_block_attribution)??!0;if(!t||!o)return[];const{presenceStore:i}=this.props,{rootStore:s}=i.state;if(!this.containerEl||!s||"editing"!==w.default.state.mode||r.Z.state.open||f.Z.state.open||b.Z.state.isKeyboardMode)return[];let c;for(const a of C.default.state.stores){const e=a.findRecordStoreUIAncestor((e=>e instanceof k.G&&e.isTransclusionType())).ancestor;e&&e instanceof k.G&&"transclusion_container"===e.getType()&&(c=e)}const l=h.C.getMembersByDOMOrder({filter:()=>!0}),d=this.containerEl.getBoundingClientRect(),u=m.MF(s).flatMap((e=>{const t=[];if(e.isInsideTransclusion()||e.isTransclusionType()){let n=e;if("transclusion_reference"===e.getType()){const t=e.getTransclusionReferenceTargetStore();t&&(n=t)}"transclusion_reference"!==e.getType()&&"transclusion_container"!==e.getType()||(n!==c?t.push(this.getAttributionAvatarsFromStore(e,l,d)):m.MF(n).map((e=>t.push(this.getAttributionAvatarsFromStore(e,l,d)))))}else t.push(this.getAttributionAvatarsFromStore(e,l,d));return t})).filter((e=>!a.o8(e)));u.sort(((e,t)=>e.top-t.top));const p=u.filter(((e,t,n)=>0===t||e.actor.id!==n[t-1].actor.id));return 1===p.length?[]:p}getAttributionAvatarsFromStore(e,t,n){const o=e.getLastEditedByPointer(),a=M.default.state;if(!o||o.table!==i.KJ)return;const s=this.findComponentByBlockId(t,e.id,e);if(!s)return;const r=e.getType();if("collection_view"===r||"collection_view_page"===r||"divider"===r||"table"===r||"table_row"===r||"tab"===r)return;if(e.isEmptyEditableBlock())return;const c=s.getNode();if(!(c&&c instanceof Element))return;const l=c.getBoundingClientRect();if(!l)return;const d=a.isOpen&&a.currentStore===e?x.selectableHoverMenuTargetOffset:0,u=(0,p.zt)((0,p.oJ)(e),e),m=(L.Z.height-x.attributionAvatarSize)/2,h=l.top-n.top+u-m,g=l.left-n.left;return d>0?{type:"attribution",actor:o,left:g-d,top:h,uniqueId:`${String(e.key)}+left`,blockStore:e}:{type:"attribution",actor:o,left:g,top:h,uniqueId:String(e.key),blockStore:e}}getAvatarWrapAnimationStyle(e,t){const{device:n}=this.environment;n.isMobile?(e-=21,t+=5):(e-=28,t+=3);return{translateX:e,translateY:t,scale:1,opacity:1}}getAvatarWrapEnterExitStyle(e,t){return{...this.getAvatarWrapAnimationStyle(e,t),scale:.7,opacity:0}}getAvatarWrapStyle(e){const{device:t}=this.environment;let n,o=0;if(t.isMobile){const t=e&&["breadcrumb","bulleted_list","numbered_list","toggle"].includes(e);n=x.avatarMobileSize,o=t?3:o}else n=x.avatarSize;return{position:"absolute",top:0,left:o,width:n,height:n}}getAvatarStyle(){const{device:e}=this.environment;let t;return t=e.isMobile?x.avatarMobileSize:x.avatarSize,{width:t,height:t}}}x.displayName="PresenceContainer",x.updateInterval=1e3,x.iconStackOffset=15,x.selectableHoverMenuTargetOffset=38,x.avatarSize=24,x.avatarMobileSize=20,x.attributionAvatarSize=18,x.containerStyle={position:"absolute",top:0,left:0,zIndex:s.eu};const T=x},32302:(e,t,n)=>{n.d(t,{Z:()=>a,x:()=>i});var o=n(69316);function a(e){const t=o.Z.state.findQuery;if(o.Z.state.open&&(e===t||!e))return i();var n;n=e,o.Z.setState({open:!0,findQuery:n??""})}function i(){o.Z.setState({open:!1,findQuery:o.Z.state.findQuery})}},83420:(e,t,n)=>{n.d(t,{TL:()=>u,nc:()=>d,ue:()=>l});var o=n(66897),a=n(54368),i=n(77420),s=n(19889),r=n(97880),c=n(35661);function l(e){const{parentStore:t,pointer:n}=e,a=(0,c.Kv)(t,n).getValue();if(a)return(0,o.LU)({table:n.table,value:a})}function d(e){const{parentStore:t,pointer:n}=e;return n.table===i.cZ?c.Qx.createChildStore(t,n):n.table===s.KJ?c.U6.createChildStore(t,n):n.table===a.y?c.fg.createChildStore(t,n):void(0,r.t1)(n)}function u(e){return e.table===i.cZ?(0,o.ON)(e.getValue()):e.table===s.KJ?(0,o.m3)(e.getValue()):e.table===a.y?(0,o.I4)(e.getValue()):void(0,r.t1)(e)}},64286:(e,t,n)=>{n.d(t,{u:()=>s});var o=n(80444),a=n(77080),i=n(15010);function s(e){const{currentUserSettingsStore:t}=o.default.state;if(!t)return!1;const n=(0,i.e2)(t);return!("number"==typeof n&&n>7)&&(!e.device.isMobile&&"on"===a.default.getEligibleGroup({experimentId:"slash_menu_tooltip",defaultGroup:"control"}))}},34232:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(67294);function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const[i,s]=(0,o.useState)(a),r=(0,o.useRef)(null),c=(0,o.useRef)(null);return(0,o.useLayoutEffect)((()=>{null!==c.current&&window.clearTimeout(c.current),null!==r.current&&window.clearTimeout(r.current),c.current=null,r.current=null,e?0===t?s(!0):r.current=window.setTimeout((()=>{r.current=null,s(!0)}),t):0===n?s(!1):c.current=window.setTimeout((()=>{c.current=null,s(!1)}),n)}),[e,t,n]),i}},758:(e,t,n)=>{n.d(t,{P:()=>d,x:()=>l});var o=n(27117),a=n.n(o),i=n(72126),s=n(54153),r=n(47839);const c="spellcheckEnabled";function l(e){return e instanceof d}class d{constructor(e){this.langCache=new(a())(100),this.enabled=void 0,this.currentInputElement=void 0,this.handleSelectionChange=()=>{if(this.enabled){const e=this.getInputElement();e&&e!==this.currentInputElement?(this.currentInputElement=e,this.handleDetectLanguageChange(e)):e&&this.handleDetectLanguageChangeThrottled(e)}},this.handleDetectLanguageChange=e=>{const t=e.textContent;if(t){let e=this.detectLanguages(t);void 0!==e&&(e=e.map((e=>navigator.language.startsWith(e)?navigator.language:e))),this.setLanguages(e)}},this.handleDetectLanguageChangeThrottled=i.P2(this.handleDetectLanguageChange,500),this.currentLanguages=void 0;const t=s.Z.get(c);this.setEnabled(void 0===t||t);const{isMac:n}=e.device;!n&&r.electronApi&&r.electronApi.loadSpellcheck&&(r.electronApi.loadSpellcheck(),document.addEventListener("selectionchange",this.handleSelectionChange))}setEnabled(e){this.enabled=e,s.Z.set(c,e),r.electronApi&&r.electronApi.setSpellCheckerLanguages&&(e?r.electronApi.setSpellCheckerLanguages(this.getLanguages()):r.electronApi.setSpellCheckerLanguages([]))}isEnabled(){return this.enabled}detectLanguages(e){let t;return this.langCache.cache[e]?(t=this.langCache.get(e),t):(r.electronApi&&r.electronApi.cld&&r.electronApi.cld.detect(e,((e,n)=>{n&&n.reliable&&n.languages&&(t=n.languages.map((e=>e.code)))})),this.langCache.set(e,t),t)}getCorrections(e){return e.dictionarySuggestions}setLanguages(e){i.Xy(this.currentLanguages,e)||(this.currentLanguages=e,r.electronApi&&r.electronApi.setSpellCheckerLanguages&&r.electronApi.setSpellCheckerLanguages(e||[]))}getInputElement(){const e=document.activeElement;if(e instanceof HTMLElement&&("input"===e.tagName||"true"===e.contentEditable))return e}getLanguages(){return navigator.languages.filter((e=>e.includes("-")))}}},33293:(e,t,n)=>{n.d(t,{q:()=>h});var o=n(67294),a=n(86628),i=n(24405),s=n(64275),r=n(5366),c=n(97880),l=n(64921),d=n(50506),u=n(33929),m=n(61254),p=n(85893);function h(e){window.__c={n:"BillingModal"};const{isOpen:t,children:n,onDismiss:r,onClosed:h,style:f,dismissUsing:v}=e,y=function(e){switch(e){case"onlyCloseButton":case"closeButtonOrEscape":return!0;case"onlyEscape":case"none":return!1;default:(0,c.t1)(e)}}(v),[b,S]=function(e,t,n){const i=(0,o.useMemo)((()=>new m.Z),[]),[s,r]=(0,o.useState)(t),c=(0,a.VK)((()=>i.state.open),[i]);return(0,o.useEffect)((()=>{e?r(t):c||(r(void 0),n&&n())}),[e,c,t,n]),[i,s]}(t,n,h),k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.yK)((t=>({cancelButton:{alignItems:"center",background:t.buttonHoveredBackground,borderRadius:"100%",display:"flex",height:20,justifyContent:"center",position:"absolute",right:12,top:12,width:20,zIndex:10},cancelButtonHovered:{background:t.buttonPressedBackground},cancelIcon:{fill:t.mediumTextColor,width:14},innerModal:{borderRadius:10,height:"auto",overflow:"auto",width:300,minHeight:40,padding:"12px 16px",position:"relative",...e}})),[e])}(f),M=(0,o.useCallback)((()=>(0,p.jsxs)(p.Fragment,{children:[y?(0,p.jsx)(l.Z,{hoveredStyle:k.cancelButtonHovered,onClick:()=>r(),style:k.cancelButton,ariaLabel:u.default.formatMessage(g.closeModalAriaLabel),children:(0,s.D)(k.cancelIcon)}):null,S]})),[S,r,y,k.cancelButton,k.cancelButtonHovered,k.cancelIcon]),C=(0,o.useCallback)((()=>{(function(e){switch(e){case"closeButtonOrEscape":case"onlyEscape":return!0;case"onlyCloseButton":case"none":return!1;default:(0,c.t1)(e)}})(v)&&r()}),[v,r]);return(0,p.jsx)(d.Z,{innerStyle:k.innerModal,onDismiss:C,open:t,preventHideChildrenWhileOpening:!0,render:M,store:b,trapFocus:!0})}const g=(0,r.defineMessages)({closeModalAriaLabel:{id:"subscriptions.BillingModal.closeButtonLabel",defaultMessage:"Close modal"}})},49204:(e,t,n)=>{n.d(t,{Id:()=>M,Ng:()=>C,Px:()=>S,ow:()=>k,t_:()=>b,um:()=>y});var o=n(15145),a=n(5366),i=n(19889),s=n(50906),r=n(54642),c=n(9953),l=n(64964),d=n(29974),u=n(39699),m=n(33929),p=n(38755),h=n(80444),g=n(9867),f=n(28517);const v=(0,a.defineMessages)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function y(e){let{environment:t,userId:n,teamStore:o,user:a}=e;const i=o.getSpaceId();if(!i)return;await g.Cj({environment:t,teamId:o.id,spaceId:i,teamMemberInfos:a,isSettingDefaultTeam:!1,inviterId:n})&&(s.UD9(t,{store:o,joined_role:"member",from:"team_invite_link"}),await b({environment:t,userId:n,teamStore:o}),l.oV({label:m.default.formatMessage(v.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function b(e){let{environment:t,userId:n,teamStore:a}=e;const i=h.default.state.currentUserRootStore,s=a.getSpaceId();if(!s||!i)return;const r=i.getSpaceViewStores().filter((e=>e.getSpaceId()===s))[0];await d.y3({environment:t,spaceViewStore:r,userSettingsStore:void 0,userRootStore:i,pageVisitSource:o.tY.JoinTeam}),await f.I({environment:t,spaceId:s,userId:n}),g.hI({environment:t,teamStore:a,shouldScroll:!0})}async function S(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await r.requestAccess(t,{type:"current-actor-to-team",teamId:n,message:o})).type?(s.LBE(t,{teamId:n}),await M({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{l.oV({label:m.default.formatMessage(v.requestTeamSuccessMessage)})}))):l.oV({label:m.default.formatMessage(v.requestTeamFailureMessage)})}async function k(e){let{environment:t,teamStore:n,accessRequestStore:o,status:a}=e;const r=o.getForActorId();if(!r)return;const l=o.getRecordModel({table:i.KJ,id:r});if(l){if("approved"===a){const e=[{type:"member",entity_type:"user",user_id:l.id}];if(!(await g.Uj({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}u.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{c.sW({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:i.KJ,resolved_by_id:t.currentUser.id,status:a}})}}),s.coX(t,{store:n,resolution:a})}}async function M(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:a,userSettingsStore:i}=await(0,p.iX)({environment:t,disableRedirectUrl:!1});n?await d.y3({environment:t,spaceViewStore:n,userRootStore:a,userSettingsStore:i,pageVisitSource:o.tY.BackForward}):await d.L5({environment:t,userRootStore:a,userSettingsStore:i,pageVisitSource:o.tY.BackForward})}async function C(e){let{environment:t,teamId:n}=e;const o=await r.getTeamAccessRequestMetadata(t,{teamId:n});if("success"===o.type)return o.data}},14889:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(67294),a=n(480),i=n(24405),s=n(5366),r=n(42922),c=n(74194),l=n(50506),d=n(64369),u=n(49204),m=n(74016),p=n(85893);const h=(0,s.defineMessages)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const g=function(e){window.__c={n:"TeamInviteLinkRequestModal"};const{teamStore:t,teamName:n,teamId:g,isModalOpen:f,onDismiss:v}=e,[y,b]=(0,o.useState)(""),S=(0,a.O7)(),k=(0,s.useIntl)(),M=async()=>{await u.Px({environment:S,teamId:g,message:y}),v()},C=(0,i.yK)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,p.jsx)(l.Z,{open:f,onDismiss:v,innerStyle:C.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{style:C.requestTitle,children:(0,p.jsx)(s.FormattedMessage,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:n,icon:(0,p.jsx)(m.p,{style:C.icon,store:t,disabled:!0,size:22})}})}),(0,p.jsx)(c.Z,{textarea:!0,style:C.input,value:y,onChange:e=>{b(e.target.value)},placeholder:k.formatMessage(h.message_placeholder)}),(0,p.jsxs)("div",{style:C.footer,children:[(0,p.jsx)(d.Z,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,p.jsx)(s.FormattedMessage,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,p.jsx)(r.Z,{isLarge:!0,style:C.requestInvitesButton,onClick:M,children:(0,p.jsx)(s.FormattedMessage,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},11799:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(67266),a=n.n(o),i=n(72126);let s;const r=new WeakMap;function c(e){let t=r.get(e);return void 0!==t||(t=a()(e),r.set(e,t)),t}s=Symbol.iterator;class l{constructor(){let{getKey:e=c,from:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.map=new Map,this.getKey=void 0,this.getKey=e,t)for(const[n,o]of t)this.set(n,o)}get size(){return this.map.size}set(e,t){return this.map.set(this.getKey(e),[e,t])}get(e){const t=this.map.get(this.getKey(e));if(t)return t[1]}has(e){return this.map.has(this.getKey(e))}delete(e){return this.map.delete(this.getKey(e))}*entries(){for(const e of this.map.values())yield e}[s](){return this.entries()}*keys(){for(const e of this.map.keys())yield JSON.parse(e)}*values(){for(const[e,t]of this.map.values())yield t}valuesArray(){return Array.from(this.values())}compactedValuesArray(){return i.oA(Array.from(this.values()))}}},16880:(e,t,n)=>{n.d(t,{R:()=>i});n(67294);var o=n(45238),a=n(85893);const i=(0,o.I)("chevronUpRounded",{viewBox:"0 0 15 9",svg:(0,a.jsx)("path",{d:"M1.258 6.5L7.203.422a.946.946 0 01.719-.32.99.99 0 01.726.32L14.586 6.5a.89.89 0 01.266.648c0 .524-.407.93-.922.93a.921.921 0 01-.672-.281L7.93 2.32 2.586 7.797a.926.926 0 01-.672.281.915.915 0 01-.922-.93c0-.25.094-.476.266-.648z"})})},64530:(e,t,n)=>{n.d(t,{y:()=>i});n(67294);var o=n(45238),a=n(85893);const i=(0,o.I)("settingsNotificationsAndPersonal",{viewBox:"0 0 20 20",svg:(0,a.jsx)("path",{d:"M12.5361 7.54883C13.2744 7.54883 13.9033 7.09082 14.1631 6.44141H16.4258C16.7607 6.44141 17.0479 6.14746 17.0479 5.79199C17.0479 5.43652 16.7676 5.14258 16.4258 5.14258H14.1699C13.9102 4.49316 13.2744 4.03516 12.5361 4.03516C11.7979 4.03516 11.1621 4.49316 10.9023 5.14258H3.59473C3.23242 5.14258 2.95215 5.43652 2.95215 5.79199C2.95215 6.14746 3.23926 6.44141 3.59473 6.44141H10.9023C11.1621 7.09082 11.7979 7.54883 12.5361 7.54883ZM12.5361 6.62598C12.0713 6.62598 11.6953 6.25684 11.6953 5.79199C11.6953 5.31348 12.0713 4.95117 12.5361 4.95117C13.0078 4.95117 13.3701 5.31348 13.3701 5.79199C13.3701 6.25684 13.0078 6.62598 12.5361 6.62598ZM3.56738 9.40137C3.23242 9.40137 2.95215 9.68848 2.95215 10.0508C2.95215 10.3994 3.23926 10.6934 3.56738 10.6934H5.91211C6.16504 11.3428 6.80078 11.8076 7.5459 11.8076C8.27734 11.8076 8.91309 11.3428 9.17285 10.6934H16.4053C16.7607 10.6934 17.0479 10.4062 17.0479 10.0508C17.0479 9.68848 16.7676 9.40137 16.4053 9.40137H9.17285C8.91309 8.75195 8.27734 8.29395 7.5459 8.29395C6.80762 8.29395 6.17188 8.75195 5.91211 9.40137H3.56738ZM7.5459 10.8848C7.07422 10.8848 6.70508 10.5156 6.70508 10.0508C6.70508 9.57227 7.07422 9.20996 7.5459 9.20996C8.01758 9.20996 8.37988 9.57227 8.37988 10.0508C8.37988 10.5156 8.01758 10.8848 7.5459 10.8848ZM12.5361 16.0596C13.2744 16.0596 13.9102 15.6016 14.1699 14.9521H16.4258C16.7607 14.9521 17.0479 14.6582 17.0479 14.3027C17.0479 13.9404 16.7676 13.6533 16.4258 13.6533H14.1631C13.9102 13.0039 13.2744 12.5459 12.5361 12.5459C11.7979 12.5459 11.1621 13.0039 10.9023 13.6533H3.59473C3.23242 13.6533 2.95215 13.9473 2.95215 14.3027C2.95215 14.6582 3.23926 14.9521 3.59473 14.9521H10.9023C11.1621 15.6016 11.7979 16.0596 12.5361 16.0596ZM12.5361 15.1436C12.0713 15.1436 11.6953 14.7676 11.6953 14.3027C11.6953 13.8311 12.0713 13.4619 12.5361 13.4619C13.0078 13.4619 13.3701 13.8311 13.3701 14.3027C13.3701 14.7676 13.0078 15.1436 12.5361 15.1436Z"})})},72458:(e,t,n)=>{n.d(t,{A:()=>s,Z:()=>i});var o=n(8848),a=n(15095);function i(e){const t=e.name,n=e.email;let o;if(t||n){if(t){const e=t.split(" ").filter((e=>e.length>0));o=e.length>1?String(a.p4(e[0])[0])+String(a.p4(e[e.length-1])[0]):String(a.p4(t)[0])+String(a.p4(t)[1])}else o=null==n?void 0:n.substring(0,2);return o=o?o.toUpperCase():void 0,o}}function s(e,t){return e&&(0,o.iY)(e,t)}},29091:(e,t,n)=>{function o(e){if(!e)return Math.random;let t=function(e){let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}(e);return()=>{t|=0,t=t+1831565813|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}function a(e){const t=Array.from({length:e},(()=>Math.random()));let n=0;return()=>{const e=t[n];return n=n===t.length-1?0:n+1,e}}n.d(t,{XJ:()=>a,yH:()=>o})}}]);