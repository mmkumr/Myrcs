"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[7432],{37834:(e,t,r)=>{r.d(t,{FF:()=>g,U4:()=>f,gs:()=>y,jN:()=>m,xx:()=>v,zb:()=>b});r(67294);var i=r(23867),o=r(82990),s=r(5366),n=r(77080),a=r(46096),d=r(50906),l=r(54642),c=r(47307),p=r(92625),h=r(85893);const u=(0,s.defineMessages)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoringâ€¦"}});function m(e){const{environment:t,from:r,...i}=e;d.ya1(t,r),a.Z.setState({...i,open:!0,size:50})}const g=()=>{const e=a.Z.state;e.open&&a.Z.setState({...e,size:e.size+20})},f=function(){a.Z.setState({open:!1})};function y(e){const{environment:t,snapshot:r,nextFutureSnapshot:i}=e;d.qDg(t,r);const o=a.Z.state;o.open&&a.Z.setState({...o,snapshot:r,nextFutureSnapshot:i,openSnapshotNearTimestamp:void 0})}function b(){const e=a.Z.state;e.open&&a.Z.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function v(e){if(!a.Z.state.open)return;if(!a.Z.state.snapshot)return;const t="restore_collection",r=a.Z.state.pageHasCollection,m=n.default.checkGate("snapshot_optional_collection_rollback_enabled")&&r?[{key:t,text:(0,h.jsx)(s.FormattedMessage,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,h.jsx)(s.FormattedMessage,{defaultMessage:"All database pages will be restored to the previous version, which may impact other users or database views.",id:"historyModal.confirmDialog.selectOption.collection.description"})}]:void 0,{accept:g,selectionResult:y}=await c.confirmUserActionV2({message:(0,h.jsx)("div",{style:{fontWeight:o.Z.fontWeight.semibold,fontSize:"medium"},children:(0,h.jsx)(s.FormattedMessage,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,h.jsx)(s.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:m});if(!g)return;d.R9m(e,a.Z.state.snapshot),p.j({message:u.restoringPreviousVersion});const b=await l.restoreSnapshot(e,{block:{id:a.Z.state.blockStore.id,spaceId:(0,i.C)(a.Z.state.blockStore.pointer.spaceId)},timestamp:a.Z.state.snapshot.timestamp,shouldRestoreCollection:(null==y?void 0:y.restore_collection)??!1}).next();b.value.error&&c.showErrorMessage(b.value.error.message),p.x(),f()}},63381:(e,t,r)=>{r.d(t,{Z:()=>ee});r(57658);var i=r(67294),o=r(83355),s=r(13991),n=r(49085),a=r(40902),d=r(66897),l=r(17215),c=r(41432),p=r(15070),h=r(99036),u=r(80951),m=r(8848),g=r(63144),f=r(25501),y=r(14215),b=r(6695),v=r(86678),k=r(42875),x=r(13530),C=r(72126),S=r(59753),_=r(26825),j=r(27006),B=r(21202),M=r(77420),w=r(70279),T=r(23867),E=r(15047),D=r(29369),P=r(19889),I=r(70203),V=r(97880),F=r(82990),R=r(7928),Z=r(5366),A=r(42130),U=r(33929),N=r(77907),H=r(41662),L=r(30874),G=r(35661),K=r(2456),z=r(44295),q=r(31278),O=r(85893);class W extends o.Z{constructor(){super(...arguments),this.renderEdit=()=>{const{edit:e,formatProperty:t}=this.props;if("page_icon"===t){const r=e.block_data.before.block_value.format&&e.block_data.before.block_value.format[t],i=e.block_data.after.block_value.format&&e.block_data.after.block_value.format[t];return this.renderPageIconUpdatedEdit(r,i)}"is_placeholder"!==t&&(0,V.t1)(t)},this.renderPageIconUpdatedEdit=(e,t)=>{const{edit:r}=this.props;if(e||t)return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",color:this.theme.lightTextColor,fontSize:12,lineHeight:1,marginBottom:8},children:[(0,z.I)({width:12,height:12,marginRight:6}),(0,O.jsx)(Z.FormattedMessage,{id:"editFormatDiff.pageIcon.label",defaultMessage:"Page Icon"})]}),(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,O.jsx)(q.Z,{disabled:!0,isEmptyPage:!1,size:20,icon:e?{pointer:{table:B.iU,id:r.block_data.before.block_value.id},icon:e}:void 0}),(0,O.jsx)("div",{style:{padding:"0px 8px"},children:(0,x.s)({width:14,height:14,fill:this.theme.mediumIconColor})}),(0,O.jsx)(q.Z,{disabled:!0,isEmptyPage:!1,size:20,icon:t?{pointer:{table:B.iU,id:r.block_data.after.block_value.id},icon:t}:void 0})]})]})}}renderComponent(){return this.renderEdit()||null}}W.displayName="EditFormatDiff";const $=W;var J=r(14200),Q=r(75561),X=r(93178);class Y extends o.Z{constructor(){super(...arguments),this.storeTypes={isEditHovered:n.default.createClass(!1)},this.renderProperty=(e,t,r)=>(0,O.jsx)(K.KX,{value:e,propertySchema:t,labeled:r,rootStore:this.props.rootStore}),this.renderBlockProperty=(e,t,r,i)=>(0,O.jsx)(K.Tl,{blockValue:e,prop:t,labeled:r,schema:i,intl:this.props.intl,rootStore:this.props.rootStore}),this.renderBlockEditProperty=(e,t,r)=>{const i=this.getBlockSchema(e)[t],o="block-changed"===e.type?e.block_data.after.block_value:e.block_data.block_value,s=(0,K.SX)(o,t);if(i)return this.renderProperty({value:s,spaceId:(0,T.C)(o.space_id)},i,r)},this.renderBlockEditPropertyDiff=(e,t,r)=>{const i=this.getBlockSchema(e),o=i[t];if(!o)return;const s=(0,K.SX)(e.block_data.before.block_value,t),n=u.wV({property:t,schema:i,block:S.kk.fromBlock(e.block_data.before.block_value),getRecordModel:this.getRecordModel,userId:this.environment.currentUser.id,userTimeZone:(0,k.r)(),intl:this.props.intl}),a=(0,K.SX)(e.block_data.after.block_value,t),d=o.type;return n&&"text"!==d&&"title"!==d?this.renderProperty({value:a,spaceId:(0,T.C)(e.block_data.after.block_value.space_id)},o,r):(0,O.jsx)(K.Hq,{labeled:r,name:o.name,type:o.type,icon:o.icon,children:(0,O.jsx)(X.Z,{propertySchema:o,beforeValue:{value:s,spaceId:(0,T.C)(e.block_data.before.block_value.space_id)},afterValue:{value:a,spaceId:(0,T.C)(e.block_data.after.block_value.space_id)},rootStore:this.props.rootStore})})},this.renderBlockPropertyEditDiff=e=>{const{labeled:t,propertySchema:r,beforeValue:i,afterValue:o,spaceId:s}=e,n=(0,T.C)(s);return(0,O.jsx)(K.Hq,{labeled:t,name:r.name,type:r.type,icon:r.icon,children:(0,O.jsx)(X.Z,{propertySchema:r,beforeValue:{value:i,spaceId:n},afterValue:{value:o,spaceId:n},rootStore:this.props.rootStore})})},this.getRecordValue=this.props.rootStore.getRecordValue,this.getRecordModel=this.props.rootStore.getRecordModel}renderComponent(){return this.renderEdit()||null}renderEdit(){if("comment-edit"===this.props.type){const{edit:e,discussionLocation:t,hideAuthorName:r,lineClamp:i}=this.props;switch(e.type){case"comment-created":return this.renderCommentCreatedEdit({edit:e,discussionLocation:t,hideAuthorName:r,lineClamp:i});case"comment-changed":return this.renderCommentChangedEdit(e);case"comment-deleted":return this.renderCommentDeletedEdit(e,t);default:(0,V.t1)(e)}}const{edit:e}=this.props;switch(e.type){case"block-created":return this.renderBlockCreatedEdit(e.block_data.block_value);case"block-deleted":return this.renderBlockDeletedEdit(e.block_data.block_value);case"block-changed":return this.renderBlockChangedEdit(e);case"block-property-changed":return this.renderBlockPropertyChangedEdit(e);case"collection-property-changed":return this.renderCollectionPropertyChangedEdit(e);case"collection-changed":return this.renderCollectionChangedEdit(e);case"collection-created":return this.renderCollectionCreatedEdit(e);case"mention-created":return this.renderMentionCreated(e);case"permission-created":return this.renderPermissionCreated(e);case"permission-changed":return this.renderPermissionChanged(e);case"permission-deleted":return this.renderPermissionDeleted(e);case"permission-restriction-created":case"permission-restriction-deleted":return this.renderPermissionInheritanceChanged(e);case"permission-group-created":return this.renderPermissionGroupCreated(e);case"permission-group-changed":return this.renderPermissionGroupChanged(e);case"permission-group-deleted":return this.renderPermissionGroupDeleted(e);case"reminder-created":return this.renderReminderCreated(e);case"permission-group-mention-created":return this.renderPermissionGroupMentionCreated(e);case"permission-group-mention-deleted":case"mention-deleted":return null;default:(0,V.t1)(e)}}renderBlockChanged(e){switch(e.block_data.after.block_value.type){case c.Ti.text:return this.renderTextBlockChanged(e);case c.Ti.header:return this.renderHeaderBlockChanged(e);case c.Ti.subHeader:return this.renderSubHeaderBlockChanged(e);case c.Ti.subSubHeader:return this.renderSubSubHeaderBlockChanged(e);case c.Ti.toggle:return this.renderToggleBlockChanged(e);case c.Ti.bulletedList:return this.renderBulletedListBlockChanged(e);case c.Ti.numberedList:return this.renderNumberedListBlockChanged(e);case c.Ti.quote:return this.renderQuoteBlockChanged(e);case c.Ti.factory:return this.renderFactoryBlockChanged(e);case c.Ti.equation:return this.renderEquationBlockChanged(e);case c.Ti.toDo:return this.renderTodoBlockChanged(e);case c.Ti.code:return this.renderCodeBlockChanged(e);case c.Ti.bookmark:return this.renderBookmarkBlockChanged(e);case c.Ti.page:return this.renderPageBlockChanged(e);case c.Ti.collectionView:case c.Ti.collectionViewPage:return this.renderCollectionBlockChanged(e);case c.Ti.image:return this.renderImageBlockChanged(e);case c.Ti.embed:return this.renderEmbedBlockChanged(e,"embed");case c.Ti.framer:return this.renderEmbedBlockChanged(e,"framer");case c.Ti.tweet:return this.renderEmbedBlockChanged(e,"tweet");case c.Ti.gist:return this.renderEmbedBlockChanged(e,"gist");case c.Ti.drive:return this.renderDriveBlockChanged(e);case c.Ti.maps:return this.renderEmbedBlockChanged(e,"maps");case c.Ti.invision:return this.renderEmbedBlockChanged(e,"invision");case c.Ti.video:return this.renderEmbedBlockChanged(e,"video");case c.Ti.audio:return this.renderEmbedBlockChanged(e,"audio");case c.Ti.file:return this.renderEmbedBlockChanged(e,"file");case c.Ti.callout:return this.renderCalloutBlockChanged(e);case c.Ti.whimsical:return this.renderEmbedBlockChanged(e,"whimsical");case c.Ti.miro:return this.renderEmbedBlockChanged(e,"miro");case c.Ti.abstract:return this.renderEmbedBlockChanged(e,"abstract");case c.Ti.mixpanel:return this.renderEmbedBlockChanged(e,"mixpanel");case c.Ti.sketch:return this.renderEmbedBlockChanged(e,"sketch");case c.Ti.replit:return this.renderEmbedBlockChanged(e,"replit");case c.Ti.excalidraw:return this.renderEmbedBlockChanged(e,"excalidraw");case c.Ti.tableRow:return this.renderSimpleTableRowBlockChanged(e);case c.Ti.hex:return this.renderEmbedBlockChanged(e,"hex");case c.Ti.hex:return this.renderEmbedBlockChanged(e,"deepnote");case c.Ti.externalObjectInstance:return this.renderExternalObjectInstanceBlockChanged(e)}}renderBlockCreatedEdit(e){const t=(0,O.jsx)(K.ZP,{blockValue:e,rootStore:this.props.rootStore,created:!0});if(t)switch(e.type){case c.Ti.quote:case c.Ti.video:case c.Ti.code:case c.Ti.equation:case c.Ti.file:case c.Ti.bookmark:case c.Ti.factory:return(0,O.jsx)("div",{style:A.v.wrapStyle,children:t});case c.Ti.table:return;case c.Ti.tableRow:return e.properties&&(0,V.Yd)(e.properties).length>0?(0,O.jsx)("div",{style:{...A.v.wrapStyle,...A.v.addedStyle},children:t}):void 0;default:return(0,O.jsx)("div",{style:{...A.v.wrapStyle,...A.v.addedStyle},children:t})}}renderBlockDeletedEdit(e){const t=(0,O.jsx)(K.ZP,{rootStore:this.props.rootStore,blockValue:e,deleted:!0});if(t)switch(e.type){case c.Ti.quote:case c.Ti.video:case c.Ti.code:case c.Ti.equation:case c.Ti.file:case c.Ti.bookmark:case c.Ti.factory:return(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{style:A.v.getLabelStyle(this.theme),children:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Deleted",id:"edit.blockDeletedEditStyles.factoryLabel"})}),(0,O.jsx)("div",{style:{...A.v.wrapStyle},children:t})]});case c.Ti.table:return;case c.Ti.tableRow:return e.properties&&(0,V.Yd)(e.properties).length>0?(0,O.jsx)("div",{style:{...A.v.wrapStyle,...A.v.deletedStyle},children:t}):void 0;default:return(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{style:A.v.getLabelStyle(this.theme),children:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Deleted",id:"edit.blockDeletedEditStyles.defaultLabel"})}),(0,O.jsx)("div",{style:{...A.v.wrapStyle,...A.v.deletedStyle},children:t})]})}}renderBlockChangedEdit(e){const t=this.renderBlockChanged(e);if(t)return(0,O.jsx)("div",{style:A.v.wrapStyle,children:t})}renderBlockPropertyChangedEdit(e){return(0,O.jsx)("div",{children:Object.entries(e.property_updates).map((t=>{let[r,i]=t;const o=e.filtered_block_schema[r];if(!o)return;const s=i.before?i.before.value:[],n=i.after?i.after.value:[],a=this.renderBlockPropertyEditDiff({labeled:!0,propertySchema:o,beforeValue:s,afterValue:n,spaceId:e.space_id});return a?(0,O.jsx)("div",{style:A.v.wrapStyle,children:a},r):void 0})).filter(V.$K)})}renderCheckbox(e){return(0,O.jsx)("div",{style:{marginRight:6,marginTop:3},children:this.renderBlockProperty(e,"checked",!1)})}renderEditTitle(e){return this.renderBlockEditProperty(e,"title",!1)}renderEditTitleDiff(e){return this.renderBlockEditPropertyDiff(e,"title",!1)}renderTextBlockChanged(e){return this.renderEditTitleDiff(e)}renderCalloutBlockChanged(e){return(0,O.jsx)(f.Z,{title:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Callout",id:"edit.calloutBlockChanged.label"}),theme:this.theme,children:this.renderEditTitleDiff(e)})}renderExternalObjectInstanceBlockChanged(e){const t=t=>{const r=e.block_data[t].block_value,i=S.kk.fromBlock(r);return i.isType("external_object_instance")?l.$F(U.default.getIntl(),i,S.om.fromRecordMap(L.Z.getIntegrationsAsRecordMap())):null};return(0,O.jsxs)(f.Z,{title:(0,O.jsx)(Z.FormattedMessage,{...l.V1.editLabel}),theme:this.theme,children:[(0,O.jsx)("div",{style:A.v.deletedStyle,children:t("before")}),(0,O.jsx)("div",{children:t("after")})]})}renderHeaderBlockChanged(e){return(0,O.jsx)("div",{style:A.v.headerStyle,children:this.renderEditTitleDiff(e)})}renderSubHeaderBlockChanged(e){return(0,O.jsx)("div",{style:A.v.subHeaderStyle,children:this.renderEditTitleDiff(e)})}renderSubSubHeaderBlockChanged(e){return(0,O.jsx)("div",{style:A.v.subSubHeaderStyle,children:this.renderEditTitleDiff(e)})}renderToggleBlockChanged(e){return(0,O.jsx)(K.ZD,{children:this.renderEditTitleDiff(e)})}renderBulletedListBlockChanged(e){return(0,O.jsx)("ul",{style:{margin:0,paddingLeft:28},children:(0,O.jsx)("li",{children:this.renderEditTitleDiff(e)})})}renderNumberedListBlockChanged(e){return(0,O.jsx)("ol",{style:{margin:0,paddingLeft:28},children:(0,O.jsx)("li",{children:this.renderEditTitleDiff(e)})})}renderQuoteBlockChanged(e){return(0,O.jsx)(f.Z,{title:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Quote",id:"edit.quoteBlockChanged.label"}),theme:this.theme,children:this.renderEditTitleDiff(e)})}renderFactoryBlockChanged(e){return(0,O.jsx)(f.Z,{title:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Template Button",id:"edit.templateButtonBlockChanged.label"}),theme:this.theme,children:this.renderEditTitleDiff(e)})}renderEquationBlockChanged(e){return(0,O.jsx)(f.Z,{title:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Equation",id:"edit.equationBlockChanged.label"}),theme:this.theme,children:this.renderEditTitleDiff(e)})}renderTodoBlockChanged(e){return a.j4({before:e.block_data.before.block_value,after:e.block_data.after.block_value,property:"checked"})?(0,O.jsxs)("div",{style:{display:"inline-flex"},children:[(0,O.jsx)("div",{style:{marginRight:6,marginTop:3,lineHeight:1},children:this.renderBlockEditPropertyDiff(e,"checked",!1)}),this.renderEditTitleDiff(e)]}):(0,O.jsxs)("div",{style:{display:"inline-flex"},children:[this.renderCheckbox(e.block_data.after.block_value),this.renderEditTitleDiff(e)]})}renderCodeBlockChanged(e){return a.j4({before:e.block_data.before.block_value,after:e.block_data.after.block_value,property:"language"})?(0,O.jsxs)(f.Z,{title:this.getCodeTitle(e.block_data.after.block_value),theme:this.theme,children:[(0,O.jsx)("span",{style:{fontFamily:F.Z.getCompositeFontFamily(s.SP).mono,fontSize:12,tabSize:2},children:this.renderEditTitle(e)}),this.renderBlockEditPropertyDiff(e,"language",!0)]}):(0,O.jsx)(f.Z,{title:this.getCodeTitle(e.block_data.after.block_value),theme:this.theme,children:(0,O.jsx)("span",{style:{fontFamily:F.Z.getCompositeFontFamily(s.SP).mono,fontSize:12,tabSize:2},children:this.renderEditTitle(e)})})}renderCaptionChanged(e){return this.propertyChanged(e,"caption")&&this.renderBlockEditPropertyDiff(e,"caption",!1)}renderEmbedBlockChanged(e,t){const{intl:r}=this.props,o=this.propertyChanged(e,"source")&&(0,O.jsxs)(f.Z,{title:l.xg(r,t),theme:this.theme,children:[this.renderSource(e.block_data.after.block_value),this.renderBlockEditPropertyDiff(e,"source",!1)]});return(0,O.jsxs)(i.Fragment,{children:[o,(0,O.jsx)("div",{style:{marginBottom:o?4:0},children:this.renderCaptionChanged(e)})]})}renderImageBlockChanged(e){const t=this.getSource(e.block_data.before.block_value),r=this.getSource(e.block_data.after.block_value),o=t!==r&&(0,O.jsxs)("div",{style:{marginTop:4,marginBottom:4},children:[(0,O.jsx)("div",{style:{...A.v.getLabelStyle(this.theme),marginBottom:4},children:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Updated",id:"edit.imageBlockChanged.updatedTitle"})}),r&&(0,O.jsx)(K.xP,{src:r,permissionRecord:{table:B.iU,id:e.block_id}})]});return(0,O.jsxs)(i.Fragment,{children:[o,(0,O.jsx)("div",{style:{marginBottom:o?4:0},children:this.renderCaptionChanged(e)})]})}renderComment(e){let{commentValue:t,discussionLocation:r,showEditedBadge:i,hideAuthorName:o,lineClamp:s}=e;if(!t.created_by_table||!t.created_by_id)return;if("comment-edit"!==this.props.type)return;const n=this.getRecordValue({table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}),a=n&&(0,d.LU)({table:t.created_by_table,value:n}),l=a?(0,d.$4)(this.props.intl,a):(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Unknown author",id:"edit.unknownAuthor.label"}),c=t.text&&(0,O.jsx)(J.Z,{propertySchema:{type:"text",name:""},value:{spaceId:t.space_id,value:this.props.highlightCurrentUser?this.highlightCurrentUserMentions(t.text,this.props.highlightCurrentUserStyle??"background_only"):t.text},rootStore:this.props.rootStore}),p=t.content&&t.content.length>0&&t.content.map((e=>{const r=this.getRecordValue({table:"block",id:e,spaceId:t.space_id});return r&&(0,O.jsx)(K.ZP,{blockValue:r,rootStore:this.props.rootStore})})).filter(V.$K),h=G.t1.createChildStore(this.props.rootStore,{table:w.x_,id:t.id,spaceId:(0,T.C)(this.props.rootStore.pointer.spaceId)}),u=h.getUserVisibleReactions().length>0,m=!u,g=this.stores.isEditHovered;return(0,O.jsxs)("div",{style:{...m&&{position:"relative"}},onMouseEnter:()=>g.setState(!0),onMouseLeave:()=>g.setState(!1),children:[!o&&(0,O.jsx)("div",{style:{...A.v.getLabelStyle(this.theme),marginBottom:2},children:l}),(0,O.jsx)("span",{style:{...F.Z.textOverflowStyle,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:s||6},children:c}),p,(0,O.jsx)("div",{style:{...m&&{position:"absolute",top:-3,right:3}},children:(g.state||u)&&(0,O.jsx)(N.LazyReactionBar,{parentStore:h,discussionLocation:r,onClick:this.props.onReactionClick})}),i&&(0,O.jsx)("span",{style:{color:this.theme.mediumTextColor,paddingLeft:4},children:(0,O.jsx)(Z.FormattedMessage,{id:"edit.editedBadge",defaultMessage:"(edited)"})})]})}renderCommentDiff(e){var t,r;const{before:o,after:s}=e;if(!s.created_by_table||!s.created_by_id)return;const n=this.getRecordValue({table:s.created_by_table,id:s.created_by_id,spaceId:s.space_id}),a=n&&(0,d.LU)({table:s.created_by_table,value:n}),l=a?(0,d.$4)(this.props.intl,a):(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Unknown author",id:"edit.unknownAuthorCommentDiff.label"}),c=o.text&&s.text&&(0,O.jsx)(X.Z,{propertySchema:{type:"text",name:""},beforeValue:{value:o.text||[],spaceId:o.space_id},afterValue:{value:s.text||[],spaceId:s.space_id},rootStore:this.props.rootStore}),p=null===(t=s.content)||void 0===t?void 0:t.filter((e=>{var t;return!(null!==(t=o.content)&&void 0!==t&&t.includes(e))})),h=null===(r=o.content)||void 0===r?void 0:r.filter((e=>{var t;return!(null!==(t=s.content)&&void 0!==t&&t.includes(e))})),u=(0,O.jsxs)(i.Fragment,{children:[null==h?void 0:h.map((e=>{const t=this.getRecordValue({table:B.iU,id:e,spaceId:s.space_id});return t&&this.renderBlockDeletedEdit(t)})),null==p?void 0:p.map((e=>{const t=this.getRecordValue({table:B.iU,id:e,spaceId:s.space_id});return t&&(0,O.jsx)(K.ZP,{blockValue:t,rootStore:this.props.rootStore})}))]});return(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{style:{...A.v.getLabelStyle(this.theme),marginBottom:2},children:l}),c,u]})}renderCollectionPropertyChangedDiff(e){if(!e||!e.before||!e.after)return;const{before:t,after:r}=e,i=u.IQ({before:t,after:r});if(!i)return;const{newOptions:o,modifiedOptions:s,removedOptions:n}=i;if([o,s,n].every((e=>0===e.length)))return;const a=e=>{let{option:t,strikethrough:r=!1}=e;const i=(0,m.KR)(this.theme,null==t?void 0:t.color);return(0,O.jsx)(Q.Z,{...i,strikethrough:r,children:t.value})};return(0,O.jsx)(K.Hq,{labeled:!0,name:r.name,icon:r.icon,type:r.type,children:(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"column",rowGap:4},children:[o.length>0&&(0,O.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",columnGap:4},children:[(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Added",id:"Edit.renderCollectionPropertyChangedDiff.addedProperty"}),o.map((e=>(0,O.jsx)("span",{children:a({option:e})},e.id)))]}),n.length>0&&(0,O.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",columnGap:4},children:[(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Removed",id:"Edit.renderCollectionPropertyChangedDiff.removedProperty"}),n.map((e=>(0,O.jsx)("span",{children:a({option:e,strikethrough:!0})},e.id)))]}),s.length>0&&(0,O.jsxs)("div",{style:{display:"flex",flex:1,flexDirection:"row"},children:[(0,O.jsx)("span",{children:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Edited",id:"Edit.renderCollectionPropertyChangedDiff.editedProperty"})}),(0,O.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:s.map((e=>(0,O.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[(0,O.jsx)("span",{style:{marginLeft:4},children:a({option:e.before,strikethrough:!0})}),(0,O.jsx)("span",{style:{padding:"0px 8px"},children:(0,x.s)({width:10,height:10,fill:this.theme.mediumIconColor})}),a({option:e.after})]},e.before.id)))})]})]})})}renderCollectionDescriptionChangedDiff(e,t){if(!t||!t.before&&!t.after)return;const r=t.before&&t.before.description||[],i=t.after&&t.after.description||[];return(0,O.jsx)(K.Hq,{labeled:!0,name:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Description",id:"edit.descriptionPropertyChanged.label"}),icon:void 0,type:"text",children:(0,O.jsx)(X.Z,{propertySchema:{type:"text",name:""},beforeValue:{value:r,spaceId:e},afterValue:{value:i,spaceId:e},rootStore:this.props.rootStore})})}renderCollectionDescriptionCreatedDiff(e){if(e)return(0,O.jsx)(K.Hq,{labeled:!0,name:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Description",id:"edit.descriptionPropertyCreated.label"}),type:"text",icon:void 0,children:(0,O.jsx)(X.Z,{propertySchema:{type:"text",name:""},beforeValue:{value:[],spaceId:e.spaceId},afterValue:e,rootStore:this.props.rootStore})})}renderBookmarkBlockChanged(e){const t=(this.propertyChanged(e,"title")||this.propertyChanged(e,"source"))&&(0,O.jsxs)(f.Z,{title:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Bookmark",id:"edit.bookmarkBlockPropertyChanged.label"}),theme:this.theme,children:[this.renderEditTitleDiff(e),this.renderBlockEditPropertyDiff(e,"link",!0)]});return(0,O.jsxs)(i.Fragment,{children:[t,this.propertyChanged(e,"caption")&&(0,O.jsx)("div",{style:{marginBottom:t?4:0},children:this.renderCaptionChanged(e)})]})}renderDriveBlockChanged(e){const t=(0,b.v0)(e.block_data.before.block_value),r=e.block_data.after.block_value,o=t!==(0,b.v0)(r);return(0,O.jsx)(i.Fragment,{children:o&&"drive"===r.type&&(0,O.jsx)(K.ZP,{blockValue:r,rootStore:this.props.rootStore})})}renderPageBlockChanged(e){const t=a.OS({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),r=a.B9({before:e.block_data.before.block_value,after:e.block_data.after.block_value});return(0,O.jsxs)("div",{children:[t.map(((t,r,i)=>(0,O.jsx)("div",{children:this.renderBlockEditPropertyDiff(e,t,!0)},t))),r.map(((r,i,o)=>{const s=0===t.length&&0===i,n=i===o.length-1;return(0,O.jsx)("div",{style:{marginTop:s?6:10,marginBottom:n?0:6},children:(0,O.jsx)($,{formatProperty:r,edit:e})},r)}))]})}renderCollectionBlockChanged(e){return null}renderSimpleTableRowBlockChanged(e){const t=e.block_data.before.block_value,r=e.block_data.after.block_value,i=a.Yr({before:t,after:r});return(0,O.jsx)("div",{style:{display:"flex",alignItems:"stretch",flexDirection:"column"},children:i.map(((e,i)=>{const o=t.properties&&e in t.properties?t.properties[e]:void 0,s=r.properties&&e in r.properties?r.properties[e]:void 0,n=H.g$.renderCellValueForActivity({environment:this.environment,cellValue:o,spaceId:t.space_id,parentStore:this.props.rootStore,theme:this.theme}),a=H.g$.renderCellValueForActivity({environment:this.environment,cellValue:s,spaceId:r.space_id,parentStore:this.props.rootStore,theme:this.theme});return(0,O.jsxs)("div",{style:{display:"flex",border:`1px solid ${this.theme.tableDividerColor}`,overflowWrap:"anywhere",width:"max-content",maxWidth:"100%",verticalAlign:"top",lineHeight:F.Z.lineHeight.UIRegular.desktop,padding:4,marginBottom:4},children:[(0,O.jsx)("span",{style:{...A.v.deletedStyle,marginBottom:void 0},children:n}),o&&s&&(0,x.s)({width:12,height:12,fill:this.theme.mediumIconColor,alignSelf:"center",margin:4}),(0,O.jsx)("span",{style:{...A.v.addedStyle},children:a})]},i)}))})}renderSource(e){const t=this.getSource(e);return(0,O.jsx)("span",{style:{wordBreak:"break-word"},children:t})}renderPermissionCreated(e){return(0,O.jsxs)("div",{style:{...A.v.permissionStyle,...A.v.addedStyle,marginTop:3,marginBottom:3},children:[(0,O.jsx)("div",{children:this.renderPermissionTarget(e)}),(0,O.jsx)("div",{children:this.renderPermissionRole(e.permission_data)})]})}renderPermissionDeleted(e){return(0,O.jsxs)("div",{style:{...A.v.permissionStyle,...A.v.deletedStyle},children:[(0,O.jsx)("div",{children:this.renderPermissionTarget(e)}),(0,O.jsx)("div",{children:this.renderPermissionRole(e.permission_data)})]})}renderPermissionChanged(e){return(0,O.jsxs)("div",{style:A.v.permissionStyle,children:[(0,O.jsx)("div",{children:this.renderPermissionTarget(e)}),(0,O.jsx)("div",{children:(0,O.jsxs)("div",{style:A.v.diffWrapStyle,children:[this.renderPermissionRole(e.permission_data.before),(0,O.jsx)("div",{style:{padding:"0px 8px"},children:(0,x.s)({width:14,height:14})}),this.renderPermissionRole(e.permission_data.after)]})})]})}renderPermissionInheritanceChanged(e){var t;return((null===(t=e.permission_data)||void 0===t?void 0:t.calculated_changes)||[]).map(((t,r)=>{let[o,s]=t;const n={timestamp:e.timestamp,space_id:e.space_id,type:"permission-changed",permission_data:{before:o,after:s}};return(0,O.jsx)(i.Fragment,{children:this.renderPermissionChanged(n)},`inheritance-change-${r}`)}))}renderPermissionGroupCreated(e){const t=e.permission_group_data.user_ids||[],r=C.oA(t.map((e=>this.getRecordValue({table:P.KJ,id:e}))));if(0!==r.length)return(0,O.jsx)("div",{children:r.map((e=>(0,O.jsx)("div",{style:{...A.v.groupStyle,...A.v.addedStyle,marginTop:3,marginBottom:3},children:(0,R.Nz)(this.props.intl,e)},e.id)))})}renderPermissionGroupDeleted(e){const t=e.permission_group_data.user_ids||[],r=C.oA(t.map((e=>this.getRecordValue({table:P.KJ,id:e}))));if(0!==r.length)return(0,O.jsx)("div",{children:r.map((e=>(0,O.jsx)("div",{style:{...A.v.groupStyle,...A.v.deletedStyle},children:(0,R.Nz)(this.props.intl,e)},e.id)))})}renderPermissionGroupChanged(e){const t=e.permission_group_data.before.user_ids||[],r=e.permission_group_data.after.user_ids||[],i=(0,y.E)(t,r),o=C.oA(i.created.map((e=>this.getRecordValue({table:P.KJ,id:e})))),s=C.oA(i.deleted.map((e=>this.getRecordValue({table:P.KJ,id:e}))));if(0!==o.length||0!==s.length)return(0,O.jsxs)("div",{children:[o.map((e=>(0,O.jsx)("div",{style:{...A.v.groupStyle,...A.v.addedStyle,marginTop:3,marginBottom:3},children:(0,R.Nz)(this.props.intl,e)},e.id))),s.map((e=>(0,O.jsx)("div",{style:{...A.v.groupStyle,...A.v.deletedStyle},children:(0,R.Nz)(this.props.intl,e)},e.id)))]})}renderPermissionRole(e){const t=e.role??"none",r=(0,_.kD)(t,void 0);return r?(0,O.jsx)("div",{style:A.v.getRoleStyle(),children:this.props.intl.formatMessage(r)}):void 0}renderPermissionTarget(e){const t="permission-changed"===e.type?e.permission_data.after:e.permission_data;if((0,j.jg)(t)){const e=this.getRecordValue({table:P.KJ,id:t.user_id}),r=(0,R.Nz)(this.props.intl,e);return(0,O.jsx)("div",{style:A.v.permissionTypeWrapStyle,children:(0,O.jsx)("div",{style:A.v.getUserHeaderStyle(this.theme),children:r})})}if((0,j.ix)(t)){const t=this.getRecordValue({table:E.bx,id:e.space_id}),r=t?t.name:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Unknown",id:"edit.unknownSpacePermissionTarget.label"});return(0,O.jsx)("div",{style:A.v.permissionTypeWrapStyle,children:(0,O.jsx)("div",{style:A.v.getUserHeaderStyle(this.theme),children:r})})}if((0,j.$D)(t))return(0,O.jsx)("div",{style:A.v.permissionTypeWrapStyle,children:(0,O.jsx)("div",{style:A.v.getUserHeaderStyle(this.theme),children:(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Published link",id:"edit.publishToWebPermissionTarget.label"})})});if((0,j.hV)(t)){const r=this.getRecordValue({table:E.bx,id:e.space_id}),i=(r&&r.permission_groups||[]).find((e=>e.id===t.group_id)),o=i&&i.name||(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Deleted group",id:"edit.deletedPermissionGroup.label"});return(0,O.jsx)("div",{style:A.v.permissionTypeWrapStyle,children:(0,O.jsx)("div",{style:A.v.getUserHeaderStyle(this.theme),children:o})})}if((0,j.FB)(t)){const r=this.getRecordValue({table:M.cZ,id:t.bot_id,spaceId:e.space_id}),i=(0,p.Mh)(r);return(0,O.jsx)("div",{style:A.v.permissionTypeWrapStyle,children:(0,O.jsx)("div",{style:A.v.getUserHeaderStyle(this.theme),children:i})})}if((0,j.zU)(t)){const r=this.getRecordValue({table:D.e0,id:t.team_id,spaceId:e.space_id});let i=(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Members of an unknown teamspace",id:"edit.teamMemberPermissionChanged.unknownTeam"});return null!=r&&r.name&&(i=(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Members of {teamName}",id:"edit.teamMemberPermissionChanged.knownTeam",values:{teamName:r.name}})),(0,O.jsx)("div",{style:A.v.permissionTypeWrapStyle,children:(0,O.jsx)("div",{style:A.v.getUserHeaderStyle(this.theme),children:i})})}if((0,j.LW)(t)){const r=this.getRecordValue({table:D.e0,id:t.team_id,spaceId:e.space_id});let i=(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Owners of an unknown teamspace",id:"edit.teamOwnerPermissionChanged.unknownTeam"});return null!=r&&r.name&&(i=(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Owners of {teamName}",id:"edit.teamOwnerPermissionChanged.knownTeam",values:{teamName:r.name}})),(0,O.jsx)("div",{style:A.v.permissionTypeWrapStyle,children:(0,O.jsx)("div",{style:A.v.getUserHeaderStyle(this.theme),children:i})})}}renderCommentCreatedEdit(e){const{edit:t,discussionLocation:r,hideAuthorName:i,lineClamp:o}=e,s=this.getRecordValue({table:w.x_,id:t.comment_id,spaceId:t.space_id}),n=Boolean(t.comment_data&&s&&(0,g.P)(S.kk.fromValue(w.x_,t.comment_data),S.kk.fromValue(w.x_,s)));if(s)return(0,O.jsx)("div",{style:A.v.wrapStyle,children:this.renderComment({commentValue:s,discussionLocation:r,showEditedBadge:n,hideAuthorName:i,lineClamp:o})})}renderCommentChangedEdit(e){return(0,O.jsx)("div",{style:A.v.wrapStyle,children:this.renderCommentDiff(e.comment_data)})}renderCommentDeletedEdit(e,t){const r=this.getRecordValue({table:w.x_,id:e.comment_id,spaceId:e.space_id}),i=e.comment_data||r;if(i)return(0,O.jsx)("div",{style:{...A.v.wrapStyle,...A.v.deletedStyle},children:this.renderComment({commentValue:i,discussionLocation:t,showEditedBadge:!1,hideAuthorName:!1})})}renderCollectionPropertyChangedEdit(e){const t=this.renderCollectionPropertyChangedDiff(e.collection_property_data);return t?(0,O.jsx)("div",{style:{...A.v.wrapStyle,paddingTop:6,paddingBottom:4},children:t}):null}renderCollectionChangedEdit(e){return(0,O.jsx)("div",{style:A.v.wrapStyle,children:this.renderCollectionDescriptionChangedDiff(e.space_id,e.collection_data)})}renderCollectionCreatedEdit(e){var t;const r=null===(t=e.collection_data)||void 0===t?void 0:t.description;return(0,O.jsx)("div",{style:A.v.wrapStyle,children:this.renderCollectionDescriptionCreatedDiff(r&&{value:r,spaceId:e.space_id})})}renderMentionCreated(e){return this.renderBlockOrProperty({blockId:e.mentioned_block_id,property:e.mentioned_property})}renderPermissionGroupMentionCreated(e){return this.renderBlockOrProperty({blockId:e.mentioned_block_id,property:e.mentioned_property})}renderReminderCreated(e){return this.renderBlockOrProperty({blockId:e.reminder_block_id,property:e.reminder_property})}renderBlockOrProperty(e){const t=this.getRecordValue({table:B.iU,id:e.blockId});if(t){const i=(0,v.ky)({block:t,getRecordValue:this.getRecordValue});if(i){const r=h.oC(i),o=this.renderBlockProperty(t,e.property,!0,r);if(o)return(0,O.jsx)("div",{style:{...A.v.wrapStyle},children:o})}else{var r;const e=null===(r=t.properties)||void 0===r?void 0:r.title,i={...t,properties:{...t.properties,title:this.props.highlightCurrentUser&&e?this.highlightCurrentUserMentions(e,this.props.highlightCurrentUserStyle??"background_only"):e}},o=(0,O.jsx)(K.ZP,{blockValue:i,rootStore:this.props.rootStore});if(o)return(0,O.jsx)("div",{style:A.v.wrapStyle,children:o})}}}highlightCurrentUserMentions(e,t){const r=[],i=this.environment.currentUser;return I.lzi(e).forEach((e=>{if(I.km_(e)){const o=[];for(const r of I.hn0(e)){const e=I.IWo(r)&&r[1]===i.id,s=I._bk(r)&&this.currentUserIsMemberOfGroup(r[1],r[2]);e||s?(o.push(r),o.push([I.GKr.Highlight,"yellow_background"]),"background_and_text"===t&&o.push([I.GKr.Highlight,"yellow"])):o.push(r)}r.push([e[0],o])}else r.push(e)})),r}currentUserIsMemberOfGroup(e,t){var r;const i=this.environment.currentUser.id;if(!i)return!1;const o=this.getRecordValue({table:E.bx,id:t});return new Set(null==o||null===(r=o.permission_groups)||void 0===r||null===(r=r.find((t=>t.id===e)))||void 0===r?void 0:r.user_ids).has(i)}getBlockSchema(e){return e.block_schema?h.a5(e):h.Kc(this.props.intl)}getCodeTitle(e){const t=e&&e.properties&&e.properties.language;if(!t)return(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Code",id:"edit.codeBlockChanged.label"});const r=u.Sj(t,h.fG);return(0,O.jsx)(Z.FormattedMessage,{defaultMessage:"Code - {codeLanguage}",values:{codeLanguage:r},id:"edit.codeBlockWithLanguageChanged.label"})}getSource(e){const t=e&&e.properties&&e.properties.source;return u.zB(t)}hasProperty(e,t){return Boolean(e&&e.properties&&e.properties[t])}propertyChanged(e,t){return!C.Xy(e.block_data.before.block_value&&e.block_data.before.block_value.properties&&e.block_data.before.block_value.properties[t],e.block_data.after.block_value&&e.block_data.after.block_value.properties&&e.block_data.after.block_value.properties[t])}}Y.displayName="Edit";const ee=(0,Z.injectIntl)(Y)},93178:(e,t,r)=>{r.d(t,{Z:()=>C});r(57658),r(67294);var i=r(86628),o=r(24405),s=r(80951),n=r(14215),a=(r(30541),r(21703),r(67266)),d=r.n(a),l=r(5242),c=r.n(l),p=r(15095),h=r(72126),u=r(70203),m=r(97880);let g=function(e){return e[e.removed=-1]="removed",e[e.added=1]="added",e[e.same=0]="same",e}({});function f(e){const{before:t,after:r}=e,i={count:0,encoding:{},decoding:{},annotationEncoding:{},annotationDecoding:{}},o=e=>{const t=i.encoding[e];if(t)return t;{const t=String.fromCharCode(i.count);return i.count++,i.encoding[e]=t,i.decoding[t]=e,t}},s=e=>{const t=d()(e),r=i.annotationEncoding[t];if(r)return r;{const r=String.fromCharCode(i.count);return i.count++,i.annotationEncoding[t]=r,i.annotationDecoding[r]=e,r}},n=e=>h.xH(u.lzi(e).map((e=>{const t=p.p4(e[0]).map(o);if(u.km_(e)){const r=u.hDy(e),i=u.I$B(r);i&&(t[0]=s({type:"mention",value:i}),r.forEach((e=>{u.ZAl(e)||u.kuv(e)||u.QVC(e)||(t.unshift(s({type:"start",value:e})),t.push(s({type:"end",value:e})))})))}else if(u.YrK(e)){const r=u.hDy(e),i=u.Ap(r);if(i){t[0]=s({type:"equation",value:i});for(const e of r)u.ZAl(e)||u.kuv(e)||u.QVC(e)||(t.unshift(s({type:"start",value:e})),t.push(s({type:"end",value:e})))}}else if(u.AJd(e)){u.hDy(e).forEach((e=>{t.unshift(s({type:"start",value:e})),t.push(s({type:"end",value:e}))}))}return t}))).join("");if(i.count>65535)throw new Error("This string has way too many different characters.");const a=function(e,t){const r=new(c())({timeout:2,editCost:6}),i=r.main(t,e);return r.cleanupSemantic(i),i}(n(r),n(t)),l=[];let f=[];return a.forEach((e=>{let[t,r]=e;r.split("").forEach((e=>{if(i.decoding[e]){const r=i.decoding[e];t===g.added?l.push([r,[...f,["+"]]]):t===g.removed?l.push([r,[...f,["-"]]]):t===g.same&&l.push([r,f])}else{const r=i.annotationDecoding[e];if(t===g.added)if("mention"===r.type)l.push([u.qyI,[...f,["+"],r.value]]);else if("start"===r.type)f=[...f,r.value];else if("end"===r.type)f=f.filter((e=>!h.Xy(e,r.value)));else if("equation"===r.type){const e=u.xey(r.value),t=u.qZ6(e,[...f,["+"]]);l.push(t)}else(0,m.t1)(r);else if(t===g.removed){if("mention"===r.type)l.push([u.qyI,[...f,["-"],r.value]]);else if("equation"===r.type){const e=u.xey(r.value),t=u.qZ6(e,[...f,["-"]]);l.push(t)}}else if(t===g.same)if("mention"===r.type)l.push([u.qyI,[...f,r.value]]);else if("start"===r.type)f=[...f,r.value];else if("end"===r.type)f=f.filter((e=>!h.Xy(e,r.value)));else if("equation"===r.type){const e=u.xey(r.value),t=u.qZ6(e,f);l.push(t)}else(0,m.t1)(r)}}))})),u.Zxt(l)}var y=r(32566),b=r(21202),v=r(35661),k=r(14200),x=r(85893);function C(e){const t=e.propertySchema.type;switch(t){case"title":case"text":return(0,x.jsx)(S,{...e});case"relation":return(0,x.jsx)(_,{propertySchema:e.propertySchema,beforeValue:e.beforeValue,afterValue:e.afterValue,rootStore:e.rootStore});case"checkbox":case"number":case"person":case"file":case"url":case"email":case"phone_number":case"created_time":case"created_by":case"last_edited_time":case"last_edited_by":case"last_visited_time":case"formula":case"rollup":case"select":case"multi_select":case"date":case"button":case"status":case"auto_increment_id":case"location":case"verification":return(0,x.jsx)(j,{...e});default:(0,m.t1)(t)}}function S(e){const t={value:f({before:e.beforeValue.value,after:e.afterValue.value}),spaceId:e.beforeValue.spaceId};return(0,x.jsx)(k.Z,{value:t,propertySchema:e.propertySchema,rootStore:e.rootStore})}function _(e){window.__c={n:"RelationPropertyDiff"};const{beforeValue:t,afterValue:r,propertySchema:o,rootStore:a}=e,d=(0,i.VK)((()=>{const e=(0,s.rq)(t.value),i=(0,s.rq)(r.value),d=(0,n.N)(e,i,(e=>`${e.id}${e.table}`)),l=new Set(s.j$({relationValue:d.created,getRecordModel:a.getRecordModel,propertySchema:o})),c=new Set(s.j$({relationValue:d.deleted,getRecordModel:a.getRecordModel,propertySchema:o})),p=[...l,...c];return p.flatMap(((e,t)=>{const r=v.G.createChildStore(a,{table:b.iU,id:e.id}).getPropertyValue("title")||[],i=[],o=u.lzi(r);for(const s of o)if(u.QJH(s)){const t=l.has(e)?"+":"-",r=[s[0],[[t]]];i.push(r)}else i.push(s);return t<p.length-1&&i.push(u.V3y("\n")),i}))}),[t,r,o,a]);return(0,x.jsx)(k.Z,{value:{value:d,spaceId:t.spaceId},propertySchema:{type:"title",name:"Title"},rootStore:a})}function j(e){window.__c={n:"ArrowPropertyDiff"};const t=(0,o.yK)((()=>({arrowDiffWrap:{display:"inline-flex",alignItems:"center"}})),[]);return(0,x.jsxs)("div",{style:t.arrowDiffWrap,children:[(0,x.jsx)(k.Z,{value:e.beforeValue,propertySchema:e.propertySchema,rootStore:e.rootStore}),(0,x.jsx)(B,{}),(0,x.jsx)(k.Z,{value:e.afterValue,propertySchema:e.propertySchema,rootStore:e.rootStore})]})}function B(){window.__c={n:"Arrow"};const e=(0,o.yK)((e=>({container:{padding:"0px 8px"},icon:{width:15,height:15,fill:e.mediumIconColor}})),[]);return(0,x.jsx)("div",{style:e.container,children:(0,y.k)(e.icon)})}},24764:(e,t,r)=>{r.d(t,{t0:()=>C,Zk:()=>k,CA:()=>v});r(67294);var i=r(45433),o=r(98519),s=r(97880),n=r(5366),a=r(62967),d=r(57883),l=r(50906),c=r(9953),p=r(39699);function h(e){const{environment:t,key:r,selectedKey:i,following:o,followSettings:s,navigableBlockId:n,userId:a,spaceId:h,from:u}=e;p.createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{c.Ue({environment:e.environment,table:d.t0,args:{following:o,followSettings:s,navigableBlockId:n,userId:a,spaceId:h},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),o?l.RJe(t,{from:"page_updates"}):l.ubm(t,{from:"page_updates"}),i!==r&&l.kLN(t,{from:u,navigableBlockId:n,oldSetting:i,newSetting:r})}var u=r(64964),m=r(93405),g=r(64369),f=r(80444),y=r(57538),b=r(85893);function v(e){const{followSettingsKey:t,environment:r,blockStore:o,from:s}=e,a=x({key:"none",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),environment:r,blockStore:o,from:s}),d=x({key:"comments",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),environment:r,blockStore:o,from:s}),l=x({key:"all",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),environment:r,blockStore:o,from:s}),c=o.getAssociatedCollectionStore();if(!c)return[d,a];const p=c.getDatabaseType();if(p===i.iS){return[l,x({key:"important",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),environment:r,blockStore:o,from:s}),a]}if(p===i.wW){return[l,x({key:"important",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),environment:r,blockStore:o,from:s}),a]}return[l,x({key:"comments",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),environment:r,blockStore:o,from:s}),a]}function k(e){const{followSettingsKey:t,environment:r,blockStore:i,from:o}=e;return[x({key:"important",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.label",defaultMessage:"All comments"}),caption:(0,b.jsx)(n.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.caption",defaultMessage:"Notified of all comments and @mentions"}),environment:r,blockStore:i,from:o}),x({key:"none",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.label",defaultMessage:"Replies and @mentions"}),caption:(0,b.jsx)(n.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.caption",defaultMessage:"Notified of comment replies and @mentions"}),environment:r,blockStore:i,from:o})]}function x(e){const{key:t,title:r,caption:i,selectedKey:s,environment:n,blockStore:d,from:l}=e,c=C({key:t,userSelectedKey:s}),p={icon:{width:14,height:14},rightWrapper:i?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,a.cN)({key:t,displayName:void 0,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=f.default.state;if(e){const{following:r,followSettings:i}=(0,y.Z)(t),o=e.id,a=d.id,c=d.getSpaceId();h({environment:n,following:r,followSettings:i,navigableBlockId:a,spaceId:c,userId:o,from:l,key:t,selectedKey:s}),"inbox"!==l&&"more_menu"!==l||u.d4({item:{label:S(t)},undoFunc:()=>{const{following:e,followSettings:r}=(0,y.Z)(s);h({environment:n,following:e,followSettings:r,navigableBlockId:a,spaceId:c,userId:o,from:l,key:t,selectedKey:s})}})}},render:e=>(0,b.jsx)(m.Z,{...e,title:(0,b.jsx)(g.Z,{children:r}),caption:i,shouldWrapCaption:!0,right:c?(0,o.k)(p.icon):(0,b.jsx)("div",{style:p.icon}),rightStyle:p.right})}),title:r,isSelectedOption:c}}function C(e){const{key:t,userSelectedKey:r}=e;return"important"===r||"comments"===r?"important"===t||"comments"===t:t===r}function S(e){switch(e){case"none":return(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,s.t1)(e)}}},46096:(e,t,r)=>{r.d(t,{Z:()=>s});var i=r(49085);class o extends i.default{getInitialState(){return{open:!1}}}const s=new o},52867:(e,t,r)=>{r.d(t,{H:()=>s});r(67294);var i=r(45238),o=r(85893);const s=(0,i.I)("archive",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M4.083 14.585h7.499c1.347 0 2.064-.697 2.064-2.037V5.739c.664-.11 1.019-.608 1.019-1.34V3.36c0-.834-.458-1.36-1.299-1.36H2.3C1.499 2 1 2.526 1 3.36V4.4c0 .73.355 1.23 1.019 1.34v6.808c0 1.347.717 2.037 2.064 2.037zM2.579 4.728c-.342 0-.478-.144-.478-.486v-.724c0-.342.136-.486.478-.486h10.514c.342 0 .472.144.472.486v.724c0 .342-.13.486-.472.486H2.579zm1.49 8.825c-.615 0-.95-.335-.95-.95V5.76h9.427v6.842c0 .616-.342.95-.95.95H4.069zM5.58 8.515h4.512c.287 0 .492-.199.492-.5v-.218c0-.3-.205-.492-.492-.492H5.58c-.287 0-.485.191-.485.492v.219c0 .3.198.499.485.499z"})})},90334:(e,t,r)=>{r.d(t,{O:()=>s});r(67294);var i=r(45238),o=r(85893);const s=(0,i.I)("ellipsis",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M2.887 9.014c.273 0 .52-.064.738-.192.219-.132.394-.307.526-.526.133-.219.199-.46.199-.725 0-.405-.142-.747-.424-1.025a1.41 1.41 0 00-1.04-.417c-.264 0-.505.066-.724.198a1.412 1.412 0 00-.718 1.244c0 .265.064.506.192.725.132.219.307.394.526.526.219.128.46.192.725.192zm5.113 0a1.412 1.412 0 001.244-.718c.132-.219.198-.46.198-.725 0-.405-.14-.747-.423-1.025A1.386 1.386 0 008 6.129c-.264 0-.506.066-.725.198a1.412 1.412 0 00-.718 1.244c0 .265.064.506.192.725.132.219.308.394.526.526.22.128.46.192.725.192zm5.106 0c.265 0 .506-.064.725-.192.219-.132.394-.307.526-.526.133-.219.199-.46.199-.725 0-.405-.142-.747-.424-1.025a1.394 1.394 0 00-1.026-.417 1.474 1.474 0 00-1.265.718c-.127.218-.19.46-.19.724 0 .265.063.506.19.725.133.219.308.394.527.526.223.128.47.192.738.192z"})})}}]);