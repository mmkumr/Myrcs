"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[3569],{70771:(e,t,n)=>{n.d(t,{Cc:()=>I,Fv:()=>k,K7:()=>S,Nt:()=>M,OZ:()=>j,y5:()=>C});n(21703);var i=n(41432),a=n(4615),s=n(71644),o=n(21202),r=n(6287),l=n(13493),c=n(91644),d=n(19889),u=n(70203),p=n(54642),h=n(94419),m=n(9953),g=n(80444),f=n(82375),y=n(89912),x=n(56844),v=n(33932);async function S(e){const{environment:t,spaceId:n}=e,i=await p.getSkillsInSpace(t,{spaceId:n});if("success"!==i.type)throw new Error("Failed to fetch skills in space.");const{skillIds:a}=i.data;y.L.setState({...y.L.state,serverSkillIds:new Set(a)})}function k(e){const{environment:t,transaction:n}=e,{inMemoryRecordCache:a}=t.defaultRecordCache,s=t.currentUser.id,{currentSpaceStore:r,mainEditorCurrentBlockStore:l}=g.default.state;if(!s)throw new Error("No current user.");if(!r)throw new Error("No current space.");if(!l)throw new Error("No current block.");const c=e.parent??{id:l.id,table:o.iU,spaceId:r.id},d=m.j4({environment:t,type:i.Ti.text,inMemoryRecordCache:a,transaction:n,spaceId:r.id,useCrdt:!1}),u=b({environment:t,transaction:n,skillValue:{type:"custom",parent_id:c.id,parent_table:c.table,space_id:c.spaceId,alive:!0}});return h.R3({transaction:n,parent:u.getKeyStore("blocks"),append:d}),u}function C(e){const{environment:t,transaction:n}=e,{inMemoryRecordCache:a}=t.defaultRecordCache,c=t.currentUser.id,{currentSpaceStore:d,mainEditorCurrentBlockStore:p}=g.default.state;if(!c)throw new Error("No current user.");if(!d)throw new Error("No current space.");if(!p)throw new Error("No current block.");const f=m.j4({environment:t,type:i.Ti.collectionViewPage,inMemoryRecordCache:a,transaction:n,spaceId:d.id,useCrdt:p.useCrdt()}),y=m.ae({environment:t,table:r.v,value:{name:(0,u.TPx)("FAQ"),schema:{title:{name:"Question",type:"title"},[(0,s.ZP)()]:{name:"Answer",type:"text"},[(0,s.ZP)()]:{name:"Sources",type:"text"},[(0,s.ZP)()]:{name:"Last edited time",type:"last_edited_time"},[(0,s.ZP)()]:{name:"Created by",type:"created_by"},[(0,s.ZP)()]:{name:"Created time",type:"created_time"},[(0,s.ZP)()]:{name:"Last edited by",type:"last_edited_by"}},parent_table:o.iU,parent_id:f.id,alive:!0,space_id:d.id},inMemoryRecordCache:a,transaction:n}),x=m.ae({environment:t,table:l.n,value:{name:"View all",type:"table",parent_table:o.iU,parent_id:f.id,alive:!0,space_id:d.id},inMemoryRecordCache:a,transaction:n});m.sW({store:f.getFormatStore(),data:{collection_pointer:y.pointer},transaction:n}),m.sW({store:f,data:{view_ids:[x.id]},transaction:n}),h.R3({parent:p.getContentStore(),append:f,transaction:n});return b({environment:t,transaction:n,skillValue:{type:"wiki_slack",settings:{search_context:d.pointer,qna_collection_view_block_id:f.id},parent_id:p.id,parent_table:o.iU,space_id:d.id,alive:!0}})}function w(e){const{environment:t}=e,n=t.currentUser.id,i=Date.now();if(!n)throw new Error("No current user.");return{created_time:i,created_by_id:n,created_by_table:d.KJ,last_edited_time:i,last_edited_by_id:n,last_edited_by_table:d.KJ}}function b(e){const{environment:t,skillValue:n,transaction:i}=e,{inMemoryRecordCache:a}=t.defaultRecordCache,s=m.ae({environment:t,table:c.AT,value:{...n,...w({environment:t})},inMemoryRecordCache:a,transaction:i});return y.L.addLocallyCreatedSkillId(s.id),s}async function j(e){const{environment:t,clientSkill:n}=e,i=f.Pl.state,s=Boolean(i);n.inAppSkillTrigger&&((0,v.O)({view:"chat"}),await(0,x.resetAndInitializeAssistantStores)({environment:t,isLabelerSlackMode:s,fakeSlackChannel:null==i?void 0:i.selectedFakeChannel,clientSkill:n}),n.inAppSkillTrigger.requiresInput||await(0,x.sampleNextAssistantSteps)({environment:t,inferenceId:(0,a.ZP)()}))}function I(e){const{store:t,update:n,transaction:i}=e;m.sW({store:t.getSettingsStore(),data:n,transaction:i})}function M(e){const{store:t,transaction:n}=e;m.sW({store:t,data:{alive:!1},transaction:n})}},54958:(e,t,n)=>{n.r(t),n.d(t,{AssistantChatStep:()=>a.H,AssistantLabelerBar:()=>F,AssistantMenuPopup:()=>oe,AssistantOriginElement:()=>te,SearchAssistantPane:()=>je,assistantActions:()=>i});var i=n(56844),a=n(94486),s=n(67294),o=n(480),r=n(86628),l=n(24405),c=n(94568),d=n(42875),u=n(59054),p=n(72126),h=n(21202),m=n(70203),g=n(82990),f=n(54642),y=n(98104),x=n(52275),v=n(88359),S=n(1743),k=n(74194),C=n(84076),w=n(68785),b=n(63296),j=n(53437),I=n(45959),M=n(95477),A=n(5737),Z=n(82375),T=n(35661),_=n(24666),B=n(85893);function F(){window.__c={n:"AssistantLabelerBar"};const e=(0,o.O7)(),t=(0,l.yK)((e=>({wrap:{padding:8,backgroundColor:e.contentBackground,width:400},samplingPicker:{display:"flex",alignItems:"center",marginBottom:8,gap:4},error:{fontSize:14,color:e.accentColors.red[600],maxHeight:150,overflow:"scroll"},observation:{fontSize:14,maxHeight:150,overflow:"scroll"},tooltip:{width:500,whiteSpace:"pre-wrap",fontFamily:g.Z.baseFontFamily.mono},input:{marginTop:5,marginBottom:5,fontFamily:g.Z.baseFontFamily.githubMono,fontSize:12},inputInner:{height:100}})),[]),n=(0,r.VK)((()=>Z.Hl.state),[]),a=(0,r.VK)((()=>Z.XN.state),[]),c=(0,r.VK)((()=>A.NM.state),[]),d=(0,r.VK)((()=>Boolean(a&&a.sampledSteps.length>0)),[a]),u=(0,r.VK)((()=>Boolean(c&&(c.sampling||c.evaluating))),[c]),p=(0,r.VK)((()=>null==a?void 0:a.previewingStepIndex),[a]),h=(0,r.VK)((()=>{const e=null==a?void 0:a.previewingStepIndex;var t;if("number"==typeof e)return null==a||null===(t=a.sampledSteps)||void 0===t?void 0:t[e]}),[a],{useDeepEqual:!0}),m=(0,r.VK)((()=>(null==a?void 0:a.previewingStepObservations)||[]),[a],{useDeepEqual:!0}),f=m.filter((e=>"error"===e.observationType)),x=m.filter((e=>"error"!==e.observationType)),v=(0,s.useCallback)((()=>{i.cancelPreviewStep()}),[]),C=(0,s.useCallback)((async t=>{if(!h||!a)return;const n={...h,value:t.target.value};(0,Z.zZ)({store:Z.XN,step:n}),await i.simulateOrCommitStep({environment:e,step:n,commit:!1,isStreaming:!1,preventSelection:!0})}),[e,h,a]),I=(0,s.useCallback)((async t=>{a&&await i.simulateOrCommitStep({environment:e,step:a.sampledSteps[t],commit:!1,isStreaming:!1})}),[e,a]),T=(0,s.useCallback)((async()=>{if(!a)return;const t=a.previewingStepObservations.length>0;await i.commitPreviewAssistantStep({environment:e}),t||await i.applyUncommittedOperations({environment:e})}),[e,a]),F=(0,s.useCallback)((async()=>{await i.retryNextAssistantSteps({environment:e})}),[e]),L=(0,r.VK)((()=>({top:20,left:0,right:0,bottom:0,width:e.WindowSizeStore.state.width,height:0})),[e],{useDeepEqual:!0}),[R,V]=(0,s.useState)(!1),K=(0,s.useCallback)((()=>{_.default.hasSelection()&&y.ZH(e),V(!0)}),[e,V]),W=(0,s.useCallback)((()=>{V(!1)}),[V]),E=M.default.isLocalhost||!1;return(0,B.jsx)(j.ZP,{popupType:j.kQ.Popup,open:!0,originRect:L,originGap:6,disableMouseCapture:!0,render:()=>(0,B.jsx)(S.Z,{capture:R,children:(0,B.jsxs)("div",{style:t.wrap,children:[(0,B.jsx)(P,{}),d&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("div",{style:t.samplingPicker,children:[(0,B.jsx)(b.Z,{hovered:void 0===p||void 0,onClick:v,children:"Original"}),(0,B.jsx)(b.Z,{hovered:0===p||void 0,onClick:()=>I(0),children:"A"}),(0,B.jsx)(b.Z,{hovered:1===p||void 0,onClick:()=>I(1),children:"B"}),(0,B.jsx)("div",{style:{flexGrow:1}}),u&&(0,B.jsx)(w.Z,{style:{marginRight:4}}),(0,B.jsx)(b.Z,{disabled:!E&&(void 0===p||u||!n),disabledFeedback:!0,onClick:F,children:"Retry"}),(0,B.jsx)(b.Z,{disabled:!E&&(void 0===p||u||!n),disabledFeedback:!0,onClick:T,isBlue:!0,children:"Accept"})]}),h&&(0,B.jsx)(k.Z,{style:t.input,inputStyle:t.inputInner,value:h.value,onChange:C,onFocus:K,onBlur:W,textarea:!0,spellCheck:!1}),f.length>0&&!u&&(0,B.jsx)("div",{style:t.error,children:f.map((e=>e.value)).join("\n")}),x.length>0&&!u&&(0,B.jsxs)("div",{style:t.observation,children:["Results: ",x.map((e=>e.value)).join("\n")]})]})]})})})}function P(e){var t;window.__c={n:"TaskPicker"};const n=(0,o.O7)(),i=(0,r.VK)((()=>Z.Hl.state),[]),[a]=(0,u.r5)((async()=>{const e="results",t={type:"reducer",filter:{operator:"and",filters:[{property:"ouFf",filter:{operator:"status_is",value:{type:"is_group",value:"In progress"}}}]},sort:[],userId:n.currentUser.id,userTimeZone:(0,d.r)(),searchQuery:void 0,reducers:{[e]:{type:"results",limit:100}}},i=await f.queryCollection(n,{source:{type:"collection",id:"f704a995-6417-457a-8038-ca9e1cb2c65f",spaceId:c.vj},collectionView:{id:"1dee420b-aa96-4e48-8eba-c2a0613e179e",spaceId:c.vj},loader:t},void 0,{src:"queryCollectionAction"});if("failed"===i.type)return;const a=i.data.result.reducerResults.results;if(!a||"results"!==a.type)return;const{blockIds:s}=a;let o=p.oA(s.map((e=>new T.G(n,{table:h.iU,id:e}).getValue()))).map((e=>{var t,n,i;return{id:e.id,name:(0,m.QaF)(null==e||null===(t=e.properties)||void 0===t?void 0:t.title),url:(0,m.QaF)(null==e||null===(n=e.properties)||void 0===n?void 0:n["}v_K"]),type:(0,m.QaF)(null==e||null===(i=e.properties)||void 0===i?void 0:i.pdfW)}}));return o=p.MR(o,(e=>e.name.toLowerCase())),o}),[n]),g=(0,s.useCallback)((e=>{var t;const n=null===(t=a.value)||void 0===t?void 0:t.find((t=>t.id===e));n&&Z.Hl.setState(n)}),[a]),y={menuTitle:"",items:(null===(t=a.value)||void 0===t?void 0:t.map((e=>e.id)))??[],getKey:e=>e,selectedItem:null==i?void 0:i.id,onSelect:g,renderItem:e=>{var t;const n=null===(t=a.value)||void 0===t?void 0:t.find((t=>t.id===e.value));return(0,B.jsx)(x.Z,{...e,title:null==n?void 0:n.name})},renderOrigin:e=>(0,B.jsx)(v.Z,{focused:!1,title:"",right:(null==i?void 0:i.name)||(0,B.jsx)("span",{style:{color:"red"},children:"Please select a task"}),...e}),width:300},S=(0,l.yK)((e=>({wrap:{marginBottom:8},inner:{display:"flex",alignItems:"center",marginBottom:4,gap:4},label:{fontSize:14,flexShrink:0},link:{fontSize:14,textDecoration:"underline"}})),[]);return(0,B.jsxs)("div",{style:S.wrap,children:[(0,B.jsxs)("div",{style:S.inner,children:[(0,B.jsx)("div",{style:S.label,children:"Current task:"}),(0,B.jsx)(I.Z,{...y})]}),i&&(0,B.jsx)(C.Z,{style:S.link,href:i.url,external:!0,children:"Instructions for task"})]})}var L=n(41892),R=n(5257),V=n(11751),K=n(97880),W=n(51454),E=n(5366),N=n(50906),O=n(55031),D=n(64921),z=n(91839),U=n(96234),H=n(28020),q=n(24646),Q=n(21273),G=n(4926),$=n(55320),X=n(33932),J=n(45317),Y=n(56206),ee=n(40824);function te(){window.__c={n:"AssistantOriginElement"};const e=(0,o.O7)(),t=(0,l.Fg)(),n=(0,r.VK)((()=>Q.Z.isQnAOnlyEnabled()),[]);!function(){const e=(0,r.VK)((()=>{var e;return Boolean(null===(e=Z.XN.state)||void 0===e?void 0:e.isCurrentlyCommittingHumanStep)}),[]);(0,s.useEffect)((()=>{const t=ee.N.state.lastStepLoadingCompletionUnixEpochMs>ee.N.state.aiWindowLastSeenUnixEpochMs;e||t||ee.N.state.lastStepLoadingCompletionUnixEpochMs===-1/0||ee.N.setState({...ee.N.state,currentState:"answerWaitingForUserClick",lastStepLoadingCompletionUnixEpochMs:Date.now()}),e&&ee.N.setState({...ee.N.state,currentState:"answerLoading"})}),[e])}();const a=(0,l.yK)((e=>({faceImg:{width:n?18:42,fill:n?e.aiPurpleColor:e.mediumIconColor,pointerEvents:"none"}})),[n]),c=(0,r.VK)((()=>(0,A.Sr)()),[]),d=(0,s.useCallback)((async()=>{ee.N.setState({...ee.N.state,currentState:"default"}),X.O({view:"chat"}),n&&(A.NM.state&&!c||await i.resetAndInitializeAssistantStores({environment:e,primeTextInput:void 0,clientSkill:J.lU}),N.IR(e,{configurationState:A.NM.state,hasQuery:!1,from:"button",searchSessionId:void 0})),A.NM.setLastSessionInitializedUnixEpochTime()}),[c,e,n]),u=(0,r.VK)((()=>(0,O.y)(e,{theme:t,rightEdgeDistance:16,isInPeekRenderer:!1,width:37})),[e,t]),p=(0,s.useMemo)((()=>(0,V.t)({...a.faceImg})),[a.faceImg]),h=(0,r.VK)((()=>{var e,t;const n=ee.N.state.currentState;return null!==(e=Y.d.state)&&void 0!==e&&e.open||null!==(t=$.default.state)&&void 0!==t&&t.open?"default":n}),[]);switch(h){case"answerLoading":return(0,B.jsx)(ne,{onClick:d,isAnswerReady:!1});case"answerWaitingForUserClick":return(0,B.jsx)(ne,{onClick:d,isAnswerReady:!0});case"default":return(0,B.jsx)(B.Fragment,{children:(0,B.jsx)(D.Z,{ariaLabel:"ai",className:"notion-ai-button",style:{...u},onClick:d,children:n?p:(0,B.jsx)("img",{style:a.faceImg,src:L.Z.images.aiFaceLookleftPng})})});default:throw(0,K.t1)(h)}}function ne(e){let{onClick:t,isAnswerReady:n}=e;window.__c={n:"QnaBackgroundProcessingElement"};const i=(0,l.yK)((e=>({sparklesIcon:{height:15,width:17,fill:e.icon.purple},aiProcessingButtonTopLevelStyle:{display:"flex",alignItems:"center",flexDirection:"row",marginLeft:12.5,marginRight:14,height:52},sparklesIconWrapperStyle:{borderRadius:"100%",background:e.whiteButtonBackground,height:30,width:30,display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`},messagesWrapperStyle:{display:"flex",flexDirection:"column",justifyContent:"center",marginLeft:8},notionAiTitleStyle:{fontSize:12,fontWeight:"500",color:e.lightTextColor},answerReadyStyle:{fontSize:13,fontWeight:"500",color:e.aiPurpleColor,display:"flex",alignItems:"center"},preparingYourAnswerStyle:{fontSize:13,fontWeight:"500",color:e.aiPurpleColor},chevronRightStyle:{height:19,width:15,opacity:.2,marginLeft:"auto"}})),[]),a=(0,l.Fg)(),s=(0,o.O7)(),c=(0,r.VK)((()=>function(e){const{rightEdgeDistance:t,theme:n,environment:i,isInPeekRenderer:a,width:s,height:o}=e,r=(0,q.ll)(i,a)-(0,q.vJ)(i);return{position:"absolute",bottom:16+G.Z.state,right:t+G.Z.state,width:s,height:o,borderRadius:100,fontSize:20,boxShadow:n.lightBoxShadow,zIndex:W.hT,background:n.aiPurpleTranslucentRadialGradientBackground,backgroundBlendMode:"overlay, normal",opacity:H.tu.state?0:1,transform:`translateX(-${r}px) translateZ(0)`,transition:`\n\t\t\topacity ${U.Z.transitionDuration}ms,\n\t\t\tcolor ${U.Z.transitionDuration}ms,\n\t\t\ttransform 200ms\n\t\t`}}({rightEdgeDistance:16,isInPeekRenderer:!1,width:278,height:52,environment:s,theme:a})),[s,a]);return(0,B.jsx)(D.Z,{ariaLabel:"ai processing",className:"notion-ai-button",onClick:t,style:c,children:(0,B.jsxs)("div",{style:i.aiProcessingButtonTopLevelStyle,children:[(0,B.jsx)("div",{style:i.sparklesIconWrapperStyle,children:(0,V.t)(i.sparklesIcon)}),(0,B.jsxs)("div",{style:i.messagesWrapperStyle,children:[(0,B.jsx)("div",{style:i.notionAiTitleStyle,children:(0,B.jsx)(E.FormattedMessage,{id:"AssistantOriginElement.notionAiTitle",defaultMessage:"Notion AI"})}),n?(0,B.jsx)("div",{style:i.answerReadyStyle,children:(0,B.jsx)(E.FormattedMessage,{id:"AssistantOriginElement.answerReady",defaultMessage:"Your answer is ready"})}):(0,B.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,B.jsx)("div",{style:i.preparingYourAnswerStyle,children:(0,B.jsx)(E.FormattedMessage,{id:"AssistantOriginElement.notionAiLoadingText",defaultMessage:"Preparing your answer"})}),(0,B.jsx)("div",{style:{marginLeft:6,fontWeight:"500"},children:(0,B.jsx)(z.Z,{})})]})]}),(0,R.o)(i.chevronRightStyle)]})})}var ie=n(31945),ae=n(4023),se=n(26794);function oe(){window.__c={n:"AssistantMenuPopup"};const e=(0,r.VK)((()=>Y.d.state.open),[]),[t,n]=(0,s.useState)(),i=(0,o.O7)(),a=(0,r.VK)((()=>{const e=(0,q.ll)(i,!1)-(0,q.vJ)(i);return{bottom:15+G.Z.state,right:15+G.Z.state,xPosition:e}}),[i]);(0,s.useEffect)((()=>{const e=()=>{n(new DOMRect(window.innerWidth-a.right-a.xPosition,window.innerHeight-a.bottom,0,0))};return e(),addEventListener("resize",e),()=>removeEventListener("resize",e)}),[a.right,a.xPosition,a.bottom]);const c=(0,l.yK)((e=>({wrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow}})),[]);return(0,B.jsx)(j.ZP,{popupType:i.device.isMobile?ie.Z4.SlideUp:ie.Z4.Popup,alignmentToOrigin:ae.v.End,alignBoxStyle:{transition:"left 200ms, top 200ms"},originRect:t,disableMouseCapture:!0,preventScaleTransition:!1,popupWrapStyle:c.wrap,open:e,render:()=>(0,B.jsx)(se.Q,{store:Z.XN,configurationStore:A.NM,onClose:()=>{X.W()}})})}var re=n(80721),le=n(13148),ce=n(23063),de=n(73063),ue=n(36488),pe=n(56940),he=n(78140),me=n(89728),ge=n(72495),fe=n(33991),ye=n(55888),xe=n(43250),ve=n(34700),Se=n(87279),ke=n(48141),Ce=n(85665),we=n(29026),be=n(18875);function je(e){window.__c={n:"SearchAssistantPane"};const t=(0,o.Fy)();return(0,Ce.Z)(),(0,B.jsx)(pe.Z,{capture:!0,ignoreBlockSelection:!0,focusOffscreenInput:!1,restoreSelection:!t.isMobile,render:()=>(0,B.jsx)(ue.Z,{capture:!0,allowMenuList:!0,render:t=>(0,B.jsx)(Ie,{...e,ignoreAreaEvents:t})})})}function Ie(e){window.__c={n:"SearchAssistantPaneInner"};const{ignoreAreaEvents:t,renderAsPage:n,quickSearchMode:a,onClose:c}=e,{modalBodyMenuRef:d}=(0,s.useContext)(fe.SearchStaticContext),u=(0,o.O7)(),p=(0,r.VK)((()=>A.NM.hasLockAction()),[]),h=(0,r.VK)((()=>A.NM.state),[]),m=(0,s.useCallback)((()=>{we.ZP.update((e=>({...e,mode:"search"})))}),[]),g=(0,r.VK)((()=>Boolean(we.ZP.state.query.text.trim())||(0,ke.VA)(we.ZP.state.query.filters)),[]),f=(0,r.VK)((()=>(0,ye.ip)({hasQuery:g,renderAsPage:n,environment:u})),[n,g,u]),y=(0,l.yK)((e=>({header:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto",paddingTop:8,paddingLeft:12,paddingRight:12},body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},scroller:{display:"flex",flexDirection:"column",maxHeight:f.maxHeight,minHeight:f.minHeight},clearButton:{color:p?e.lightTextColor:e.mediumIconColor,opacity:p?.5:1,...(0,ve.X)({noDrag:Boolean(a)})},headerButton:{color:e.mediumIconColor,...(0,ve.X)({noDrag:Boolean(a)})},closeButton:{borderRadius:"100%",marginLeft:6,...(0,ve.X)({noDrag:Boolean(a)})},backButton:{marginRight:6,...(0,ve.X)({noDrag:Boolean(a)})}})),[p,f,a]),x=(0,o.Fy)(),v=(0,s.useMemo)((()=>{if(x.isMobile){return{menuType:Se.og.Modal,width:n?"100vw":void 0,disableHeaderShadow:!0,bodyScrollerClassName:xe.GZn,...t}}const e={menuType:Se.og.Popup,maxHeight:f.maxHeight,minHeight:f.minHeight,...a?{width:"100vw"}:{},disableScroller:!0,scrollerStyle:y.scroller,...t};return n&&x.isDesktop&&(e.maxWidth="100%"),e}),[x,y,t,f,n,a]),S=(0,s.useCallback)((()=>{N.Le6(u,h),i.clearAssistantStores()}),[h,u]),k=(0,r.VK)((()=>!Z.XN.state||!A.NM.state||p),[p]);return(0,B.jsxs)(he.Z,{...v,className:xe.Oau,ref:d,children:[(0,B.jsx)(ge.Z,{children:(0,B.jsxs)("div",{style:y.header,children:[(0,B.jsx)(de.Z,{icon:re.W,onClick:m,ariaLabel:"back",style:y.backButton}),(0,B.jsx)(se.x,{}),(0,B.jsx)("div",{style:{flexGrow:1}}),(0,B.jsx)(ce.Z,{enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>(0,B.jsx)(me.Z,{style:y.clearButton,onClick:S,children:(0,B.jsx)(E.FormattedMessage,{id:"searchAssistantPane.header.clear.label",defaultMessage:"Clear"})}),isVisible:!k}),(0,B.jsx)(de.Z,{style:y.closeButton,hovered:!0,icon:le.U,onClick:c,ariaLabel:"close"})]})}),(0,B.jsx)(be.R,{store:Z.XN})]})}},2405:(e,t,n)=>{n.d(t,{Z:()=>o});n(67294);var i=n(24405),a=n(64921),s=n(85893);function o(e){window.__c={n:"AssistantActionButton"};const{style:t,icon:n,disabled:o,iconStyle:r,title:l,onClick:c,focused:d}=e,u=(0,i.yK)((e=>({AssistantActionButton:{display:"flex",alignItems:"center",border:`1px solid ${e.aiActionButtonBorderColor}`,padding:"6px 10px",color:e.regularTextColor,fontSize:14,borderRadius:24,width:"max-content"},icon:{width:14,height:14,fill:e.regularIconColor,marginRight:6}})),[]);return(0,s.jsxs)(a.Z,{disabled:o,style:{...u.AssistantActionButton,...t},onClick:c,focused:d,children:[null==n?void 0:n({...u.icon,...r}),l]})}},18875:(e,t,n)=>{n.d(t,{R:()=>ne});var i=n(67294),a=n(480),s=n(86628),o=n(24405),r=n(41892),l=n(7057),c=n(53877),d=n(42875),u=n(72126),p=n(5366),h=n(70203),m=n(97880),g=n(82990),f=n(47307),y=n(24677),x=n(97444),v=n(98104),S=n(39699),k=n(53336),C=n(57254),w=n(19124),b=n(17809),j=n(34859),I=n(80444),M=n(5737),A=n(21273),Z=n(82375),T=n(56844),_=n(33932),B=n(70771),F=n(45317),P=n(2405),L=n(94486),R=n(83176),V=n(54851),K=n(79198),W=n(98519),E=n(55863),N=n(4615),O=n(14871),D=n(56518),z=n(84969),U=n(85893);function H(e){window.__c={n:"AssistantFeedbackBar"};const{type:t}=e,n=(0,a.O7)(),r=(0,o.yK)((e=>({wrap:{display:"flex",marginTop:8,marginBottom:6,gap:6}})),[]),l=(0,s.VK)((()=>Z.XN.state),[]),[c,d]=(0,i.useState)((()=>(0,N.ZP)())),u=(0,i.useCallback)((async()=>{await T.saveFeedback({environment:n,inferenceId:c,type:"assistant_accept_edits"}),await T.commitPreviewAssistantStep({environment:n}),await T.applyUncommittedOperations({environment:n})}),[n,c]),h=(0,i.useCallback)((async()=>{await T.saveFeedback({environment:n,inferenceId:c,type:"assistant_fix_errors"}),await T.commitPreviewAssistantStep({environment:n})}),[n,c]),g=(0,i.useCallback)((async()=>{await T.saveFeedback({environment:n,inferenceId:c,type:"assistant_undo"}),await T.commitPreviewAssistantStep({environment:n}),T.resetUncommittedOperations({environment:n})}),[n,c]),f=(0,i.useCallback)((async()=>{await T.saveFeedback({environment:n,inferenceId:c,type:"assistant_retry"}),await T.retryNextAssistantSteps({environment:n})}),[n,c]),y=(0,i.useCallback)((()=>{const e=null==l?void 0:l.temporaryClientSteps.find((e=>"assistantChat"===e.type||"assistantChatText"===e.type));if(e)if("assistantChatText"===e.type)O.RD({environment:n,stringValue:e.text??"",copiedMessage:O.tq.copiedQnAMessageToClipboard});else{if("assistantChat"===e.type){const t=(0,z.G)({environment:n,clientStep:e}),i=(0,D.X4)({rootBlock:{...t[0].pointer,spaceId:t[0].getSpaceId()},blockValues:t.map((e=>e.getValue())).filter(m.$K),getRecordValue:t[0].getRecordValue,isWindows:n.device.isWindows,markdownLinkifyIt:void 0});return void O.RD({environment:n,stringValue:i.markdown??"",copiedMessage:O.tq.copiedQnAMessageToClipboard})}(0,m.t1)(e)}}),[n,null==l?void 0:l.temporaryClientSteps]);return(0,U.jsxs)("div",{style:r.wrap,children:["accept_action"===t&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(P.Z,{icon:W.k,onClick:u,title:(0,U.jsx)(p.FormattedMessage,{defaultMessage:"Accept all",id:"assistant.acceptAllButton"})}),(0,U.jsx)(P.Z,{icon:E.s,onClick:g,title:(0,U.jsx)(p.FormattedMessage,{defaultMessage:"Undo all",id:"assistant.undoAllButton"})})]}),"error"===t&&(0,U.jsx)(U.Fragment,{children:(0,U.jsx)(P.Z,{icon:R.z,onClick:h,title:(0,U.jsx)(p.FormattedMessage,{defaultMessage:"Fix errors",id:"assistant.fixErrorsButton"})})}),(0,U.jsx)(P.Z,{icon:K.n,onClick:f,title:(0,U.jsx)(p.FormattedMessage,{defaultMessage:"Try again",id:"assistant.retryButton"})}),(0,U.jsx)(P.Z,{icon:V.S,onClick:y,title:(0,U.jsx)(p.FormattedMessage,{defaultMessage:"Copy answer",id:"assistant.copyButton"})})]})}var q=n(83065),Q=n(80402),G=n(73063),$=n(65187),X=n(43250),J=n(29026);function Y(e){window.__c={n:"AssistantRichTextInput"};const{store:t,placeholder:n,disabled:r,onSubmit:l}=e,c=(0,a.O7)(),d=(0,s.VK)((()=>""===(0,h.Jcv)(t.getValue()).trim()),[t]),u=(0,o.yK)((e=>({wrap:{display:"flex",alignItems:"center",flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:16,padding:"6px 12px",marginLeft:16,marginRight:16,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{maxHeight:64},placeholder:{maxHeight:64,opacity:r?.5:1,cursor:"text"}})),[r]),m=(0,i.useCallback)((e=>{!d&&l&&(l(t.getValue()),S.createAndCommit({userAction:"AssistantRichTextInput.valueChanged",environment:c,perform:e=>{x.sO({environment:c,store:t,value:void 0,transaction:e})}}))}),[c,l,t,d]),g=(0,i.useCallback)((e=>{l&&!d&&(l(t.getValue()),S.createAndCommit({userAction:"AssistantRichTextInput.valueChanged",environment:c,perform:e=>{x.sO({environment:c,store:t,value:void 0,transaction:e})}}))}),[l,d,t,c]),y=(0,i.useCallback)((()=>{J.ZP.setState({...J.ZP.state,mode:"search"})}),[]);return(0,U.jsxs)("div",{style:u.wrap,className:X.Wh_,children:[(0,U.jsx)($.Z,{onEsc:()=>{d?y():f.confirmUserActionV2({message:(0,U.jsx)(p.FormattedMessage,{id:"assistant.search.confirmExit",defaultMessage:"Are you sure you want to exit"})}).then((e=>{e.accept&&y()}))},placeholder:n,disabled:r??!1,store:t,style:u.text,placeholderStyle:u.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!1,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:g,disableMobileActionBar:!0,disableDateReminderMentions:!0,disableStyleAnnotations:!0,disableMentions:!0,onFocus:()=>Q.MO()}),(0,U.jsx)(G.Z,{icon:q._,onClick:m,isBlue:!d,disabled:d,iconStyle:{height:20,width:20},style:{pointerEvents:"auto",height:16,width:16},ariaLabel:"submit-ai-message"})]})}var ee=n(5175);const te=(0,p.defineMessages)({qnaAssistantChatText:{id:"assistantChat.qnaWelcomeMessage.text",defaultMessage:"Hi! Iâ€™m Notion AI. I can search through your Notion workspace and answer questions based on any page you have access to."}});function ne(e){window.__c={n:"AssistantChat"};const{store:t,renderAsFullPage:n}=e,o=(0,a.O7)(),r=(0,i.useRef)(void 0),g=(0,p.useIntl)(),_=(0,s.VK)((()=>t.state),[t]),B=(0,s.VK)((()=>M.NM.state),[]),P=(0,s.VK)((()=>I.default.state.mainEditorCurrentBlockStore),[]),R=(0,s.VK)((()=>I.default.state.currentSpaceStore),[]),V=(0,s.VK)((()=>A.Z.isQnAOnlyEnabled()),[]),[K,W]=(0,i.useState)(!1),E=null==_?void 0:_.selectedSkill,N="qna"===(null==E?void 0:E.skillType),O=(0,s.VK)((()=>{var e;const n=null===(e=t.state)||void 0===e?void 0:e.previewingStepObservations.filter((e=>"observation"===e.type&&"error"===e.observationType));return null==n?void 0:n.map((e=>e.value)).join("\n")}),[t]),D=(0,s.VK)((()=>(0,w.Gw)()),[]),z=(0,s.VK)((()=>Z.Pl.state),[]),q=Boolean(z),{store:Q}=(0,b.Cl)({initialValue:void 0,onChange:u.yR}),G=(null==B?void 0:B.evaluating)||(null==B?void 0:B.sampling)||(null==B?void 0:B.committing),$=(0,i.useMemo)((()=>null!=B&&B.startTimestamp?(0,l.ZV)({value:(0,c.CQ)(B.startTimestamp,(0,d.r)()),date_format:"relative",time_format:"h:mm A",allowRelativeDates:!0,intl:g}):void 0),[null==B?void 0:B.startTimestamp,g]),X=(0,i.useCallback)((async e=>{!q||null!=z&&z.selectedFakeUser?(_||await T.resetAndInitializeAssistantStores({environment:o,isLabelerSlackMode:q,fakeSlackChannel:null==z?void 0:z.selectedFakeChannel,clientSkill:V?F.lU:E}),e&&(r.current&&(r.current.scrollToBottom(),W(!1)),T.commitHumanStep({environment:o,text:e,fakeUser:null==z?void 0:z.selectedFakeUser}),M.NM.setLastSessionInitializedUnixEpochTime())):f.deprecatedShowErrorMessage("Please select a user to send the message as")}),[q,null==z?void 0:z.selectedFakeUser,null==z?void 0:z.selectedFakeChannel,_,o,V,E]),J=(0,i.useCallback)((()=>{const e=r.current;e&&(e.atScrollEnd()?W(!1):W(!0))}),[]),ee=(0,i.useCallback)((e=>!N||("human"===e.type||"assistantChat"===e.type||"assistantChatText"===e.type||"assistantShowSearchResults"===e.type)),[N]);(0,i.useEffect)((()=>{G||(y.ZH({device:o.device}),v.N_({store:Q}))}),[G,o,Q]),(0,i.useEffect)((()=>{null!=_&&_.primeTextInput&&(S.createAndCommit({userAction:"assistant.primeTextFromSearch",environment:o,perform:e=>{x.sO({environment:o,store:Q,value:h.TPx(_.primeTextInput),transaction:e})}}),T.clearPrimedText())}),[o,Q,null==_?void 0:_.primeTextInput]),(0,i.useEffect)((()=>{r.current&&!K&&r.current.scrollToBottom()}),[null==_?void 0:_.clientSteps,null==_?void 0:_.temporaryClientSteps,K]);const te=ie(),ne=(0,s.VK)((()=>{const e=Z.XN.state,t=M.NM.state;if(!e||!t)return;if(!t.sampling&&!t.evaluating)return;const n=e.temporaryClientSteps.find((0,m.AO)((e=>"assistantChat"===e.type||"assistantTransaction"===e.type||"assistantChatText"===e.type?{true:e}:{false:e})));if(n&&("assistantTransaction"===n.type||!(0,C.S)(n)))return;const i=e.clientSteps[e.clientSteps.length-1];return i&&"assistantShowSearchResults"===i.type?{type:"searchResults",step:i}:{type:"default"}}),[]);return R&&(n||P)?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(k.Z,{ref:r,type:j.Z.Y,style:te.scroller,onScroll:J,children:[(0,U.jsx)("div",{style:{marginTop:"auto"}}),$&&(0,m.$K)(_)&&_.clientSteps.length>0?(0,U.jsx)("div",{style:te.dateContainer,children:(0,U.jsx)("div",{style:te.date,children:$})}):null,(0,U.jsx)(ae,{currentState:_,renderAsFullPage:n}),null!=_&&_.clientSteps?_.clientSteps.filter(ee).map(((e,t)=>(0,U.jsx)(L.H,{clientStep:e,parentStore:R,parentSpaceId:R.id,fakeSlackUser:"human"===e.type?e.fakeUser:void 0,configurationState:B},t))):null,null!=_&&_.temporaryClientSteps?_.temporaryClientSteps.filter(ee).map(((e,t)=>(0,U.jsx)(L.H,{clientStep:e,parentStore:R,parentSpaceId:R.id,configurationState:B},t))):null,B&&O&&!B.sampling&&!B.evaluating&&(N?(0,U.jsx)(L.H,{clientStep:{type:"assistantFriendlyError"},parentStore:R,parentSpaceId:R.id,configurationState:B}):(0,U.jsx)("div",{style:te.error,children:O})),!D&&_&&B&&(_.temporaryClientSteps.length>0||O)&&!B.sampling&&!B.evaluating&&(0,U.jsx)(H,{type:O?N?"retry_only":"error":Boolean(_.temporaryClientSteps.find((e=>"assistantTransaction"===e.type)))?"accept_action":"feedback"}),ne&&("default"===ne.type?(0,U.jsx)(L.H,{clientStep:{type:"assistantLoading"},parentStore:R,parentSpaceId:R.id,configurationState:B}):"searchResults"===ne.type?(0,U.jsx)(L.N,{clientStep:ne.step,parentStore:R,configurationState:B}):(0,m.t1)(ne))]}),(0,U.jsx)("div",{style:te.inputWrap,children:(0,U.jsx)(Y,{store:Q,placeholder:N?"Ask a questionâ€¦":"Ask for anythingâ€¦",onSubmit:X,disabled:G})})]}):null}function ie(){return(0,o.yK)((e=>({wrap:{display:"flex",flexDirection:"column",background:e.contentBackground,width:400,height:"max(40vh, 600px)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto",paddingTop:8,paddingLeft:12,paddingRight:12},labeledInput:{display:"flex",gap:8,alignItems:"center"},reset:{color:e.mediumIconColor},toggleSlackMode:{color:e.mediumIconColor},closeButton:{borderRadius:"100%",marginLeft:4},input:{width:void 0,marginLeft:8,marginRight:8},scroller:{flexGrow:1,display:"flex",flexDirection:"column",paddingTop:16,paddingBottom:8,paddingLeft:16,paddingRight:16},samplesLabel:{fontSize:12,marginTop:8,marginBottom:8},inputLabel:{fontSize:14,color:e.mediumTextColor},previewLabel:{fontSize:12},editLink:{fontSize:14,color:e.mediumTextColor,textDecoration:"underline",paddingLeft:8,paddingRight:8},error:{fontSize:14,color:e.errorText},addCustomInstructionsIcon:{fill:e.aiPurpleColor},suggestionsLabel:{fontSize:12,color:e.mediumTextColor,marginTop:18,marginBottom:12},emptyStateIntro:{marginLeft:18,marginRight:18},faceImgWrap:{width:64,height:64,borderRadius:"100%",background:"white",boxShadow:e.largeLightBoxShadow,overflow:"hidden"},faceImg:{width:64,pointerEvents:"none"},emptyStateText:{marginTop:28,fontSize:16,color:e.regularTextColor,fontFamily:g.Z.baseFontFamily.serif},inputWrap:{paddingTop:8,paddingBottom:12},skillsCaption:{fontSize:12,color:e.mediumTextColor,marginBottom:8},skillIcon:{fill:e.aiPurpleColor},skillsWrap:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:8},date:{fontSize:12,color:e.mediumTextColor},dateContainer:{display:"flex",justifyContent:"center"}})),[])}function ae(e){var t;window.__c={n:"AssistantWelcomeHeader"};const{currentState:n,renderAsFullPage:o}=e,l=(0,a.O7)(),c=(0,p.useIntl)(),d=(0,s.VK)((()=>M.NM.state),[]),u=(0,s.VK)((()=>I.default.state.mainEditorCurrentBlockStore),[]),h=(0,s.VK)((()=>(0,F.Qv)()),[]),m=(0,s.VK)((()=>{var e;const t=null==u||null===(e=u.getFormat())||void 0===e?void 0:e.app_config_uri;return A.Z.canViewMoreSkills(t)}),[u]),g=(0,s.VK)((()=>I.default.state.currentSpaceStore),[]),[f,y]=(0,s.VK)((()=>[A.Z.isAssistantEnabled(),A.Z.isQnAOnlyEnabled()]),[]),x="qna"===(null==n||null===(t=n.selectedSkill)||void 0===t?void 0:t.skillType)||y,v=(0,i.useCallback)((()=>{(0,_.O)({view:"skillSwitcher"})}),[]),S=(0,i.useCallback)((async e=>{await(0,B.OZ)({environment:l,clientSkill:e})}),[l]),k=ie();return g&&(o||u)?(0,U.jsxs)(U.Fragment,{children:[!n&&f&&(0,U.jsxs)("div",{style:k.emptyStateIntro,children:[(0,U.jsx)("div",{style:k.faceImgWrap,children:(0,U.jsx)("img",{style:k.faceImg,src:r.Z.images.aiFaceLookleftPng})}),(0,U.jsxs)("div",{style:k.emptyStateText,children:[(0,U.jsx)("p",{children:(0,U.jsx)(p.FormattedMessage,{id:"assistantChat.welcomeMessage.title",defaultMessage:"Hi! I'm Notion AI."})}),(0,U.jsx)("p",{children:(0,U.jsx)(p.FormattedMessage,{id:"assistantChat.welcomeMessage.helpText",defaultMessage:"I can answer questions about this workspace, help you analyze and edit pages, and search and manipulate databases."})})]}),h.length>0&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{style:k.skillsCaption,children:"Things to try"}),(0,U.jsxs)("div",{style:k.skillsWrap,children:[h.filter((e=>e.inAppSkillTrigger)).slice(0,6).map((e=>(0,U.jsx)(P.Z,{icon:F.AN[e.skillType],iconStyle:k.skillIcon,onClick:async()=>{await S(e)},title:(0,U.jsx)(ee.Z,{clientSkill:e})},e.key))),m&&(0,U.jsx)(P.Z,{onClick:v,title:"More"})]})]})]}),x&&(0,U.jsx)(L.H,{clientStep:{type:"assistantChatText",text:c.formatMessage(te.qnaAssistantChatText)},parentStore:g,parentSpaceId:g.id,configurationState:d})]}):null}},84969:(e,t,n)=>{n.d(t,{G:()=>W,m:()=>P});n(57658),n(21703);var i=n(67294),a=n(18466),s=n(26263),o=n(480),r=n(86628),l=n(24405),c=n(15145),d=n(88891),u=n(24993),p=n(72126),h=n(5366),m=n(21202),g=n(19889),f=n(70203),y=n(44805),x=n(97880),v=n(82990),S=n(14871),k=n(39699),C=n(15201),w=n(84076),b=n(31278),j=n(76798),I=n(55217),M=n(62619),A=n(84210),Z=n(35661),T=n(49065),_=n(48588),B=n(6507),F=n(85893);function P(e){window.__c={n:"AssistantChatMessageRenderer"};const{clientStep:t,parentStore:n,configurationState:r,fakeSlackUser:l,isLatestStep:c}=e,d=(0,o.O7)(),{temporaryListStore:u,pageCitations:h}=(0,i.useMemo)((()=>a.Z.withListenerIgnored((()=>function(e){const{environment:t,clientStep:n}=e,i=new s.Z({name:"AssistantChatMessageListRenderer"});return k.createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStore",environment:t,perform:e=>{const a=W({environment:t,clientStep:n,transaction:e}),s=p.MR(a.flatMap((e=>e.getTitleValue())).filter(f.km_).flatMap(f.hn0).filter(f.OU5).map((e=>{const{number:t,blockId:n}=f.Vv0(e);if(n)return{number:t,pointer:{id:n,table:m.iU}}})).filter(x.$K),(e=>e.number)),o=p.mN(s,(e=>e.pointer.id));return{temporaryListStore:S.Lh({environment:t,stores:a,inMemoryRecordCache:i,transaction:e}),pageCitations:o}}}).performResult}({environment:d,clientStep:t})))),[d,t]),g=(0,i.useRef)(null);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(B.J,{ref:g,clientStep:t,configurationState:r,fakeSlackUser:l,forceShowFeedback:c,children:(0,F.jsx)(C.O,{displayName:"AssistantChatStepContent",disabled:!0,children:(0,F.jsx)(I.Z,{store:u,disabled:!1,disableCommentMenu:!0,disableHoverMenu:!0,disableDrag:!0})})}),c&&(0,F.jsx)(L,{pageCitations:h,parentStore:n,chatWrapperRef:g})]})}function L(e){window.__c={n:"ConnectedCitedPagesList"};const{chatWrapperRef:t,pageCitations:n,parentStore:a}=e,s=n.map((e=>({...e,store:Z.G.createChildStore(a,e.pointer)}))),{resolvedHoveredPageId:o,setListHoveredPageId:l}=function(e){const{containerRef:t}=e,[n,a]=(0,i.useState)(),s=(0,r.VK)((()=>{var e;const n=_.Z.state;if(!n||!t.current||!M.r3(t.current,n.token.node))return;const i=n.annotations.find(f.OU5);return i?null===(e=f.Vv0(i))||void 0===e?void 0:e.blockId:void 0}),[t]),[o,l]=(0,i.useState)([]),c=(0,i.useCallback)((e=>{a(e);for(const t of o)t.style.removeProperty("background-color");const n=[];if(e&&t.current){const i=t.current.querySelectorAll(`[${y.JQ}='${e}']`);for(const e of Array.from(i))e instanceof HTMLElement&&e&&(e.style.backgroundColor="#2383e2",n.push(e))}l(n)}),[t,o]);return{resolvedHoveredPageId:n??s,setListHoveredPageId:c}}({containerRef:t});return 0===s.length?null:(0,F.jsx)(R,{citations:s,hoveredPageId:o,setHoveredPageId:l})}function R(e){window.__c={n:"CitedPagesList"};const{citations:t,hoveredPageId:n,setHoveredPageId:i}=e,a=(0,l.yK)((()=>({wrap:{marginLeft:12,marginBottom:6,display:"flex",flexDirection:"column",gap:2}})),[]);return(0,F.jsx)("div",{style:a.wrap,children:t.map((e=>(0,F.jsx)(V,{citation:e,hovered:n===e.store.id,setHovered:t=>{i(t?e.store.id:void 0)}},e.store.id)))})}function V(e){window.__c={n:"CitedPageRow"};const{citation:{number:t,store:n},hovered:i,setHovered:a}=e,s=(0,o.Fy)(),d=(0,l.yK)((()=>({wrap:{display:"flex"},link:{display:"flex",alignItems:"center",gap:4,padding:"0 2px"},icon:{marginRight:4},titleWrap:{display:"flex",alignItems:"center",fontSize:s.isMobile?v.Z.fontSize.UISmall.mobile:v.Z.fontSize.UISmall.desktop,padding:2}})),[s]),u=(0,r.VK)((()=>n.getIcon()),[n]),p=(0,r.VK)((()=>n.isEmptyPage()),[n]),h=(0,r.VK)((()=>(0,A.ZP)({store:n,fullyQualified:!1,pageVisitSource:c.tY.AIQna})),[n]);return(0,F.jsx)("div",{style:d.wrap,children:(0,F.jsxs)(w.Z,{href:h,style:d.link,hovered:i,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[(0,F.jsx)(K,{number:t,hovered:i}),(0,F.jsxs)("div",{style:d.titleWrap,children:[(0,F.jsx)(b.Z,{disabled:!0,icon:u,isEmptyPage:p,size:14,style:d.icon,useInvertedColors:!1}),(0,F.jsx)(j.Z,{store:n})]})]})})}function K(e){window.__c={n:"CitationNumber"};const{number:t,hovered:n}=e,i=(0,l.yK)((e=>({wrap:{verticalAlign:"text-bottom",cursor:"pointer",transition:"all 100ms ease-in",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:90,padding:"0 4px",fontSize:10,minWidth:14,height:14,fontWeight:v.Z.fontWeight.semibold,color:"dark"===e.mode?"#2f2f2f":"white",backgroundColor:n?"#2383e2":"dark"===e.mode?"#787774":"#acaba9"}})),[n]),a=(0,h.useIntl)();return(0,F.jsx)("div",{style:i.wrap,children:t.toLocaleString(a.locale)})}function W(e){const{environment:t,clientStep:n,transaction:i}=e,a=new s.Z({name:"AssistantChatMessageRenderer"}),o=t.currentUser.id;if(!o)throw new Error("No current user.");const r={table:g.KJ,id:o},l=e=>{const i=(0,u.Cr)();for(const s of n.operations){const n=(0,d.ND)({assistantOperation:s,actorPointer:r,getRecordValue:a.makeGetRecordValueFn(o),spaceId:e.spaceId,getCitationNumberForPage:i});for(const i of n){let n;n=i.pointer.table===m.iU?new Z.G(t,i.pointer,{inMemoryRecordCache:a}):new T.ST({environment:t,pointer:i.pointer,path:i.path,inMemoryRecordCache:a}),k.applyOperation({store:n,operation:i,transaction:e}),n instanceof Z.G&&a.setModelAndRole({pointer:i.pointer,userId:o},n.getModel(),"reader")}}return n.blockIds.map((e=>new Z.G(t,{table:m.iU,id:e},{inMemoryRecordCache:a})))};if(a.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),i)return l(i);return k.createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStore",environment:t,perform:l}).performResult}},94486:(e,t,n)=>{n.d(t,{H:()=>X,N:()=>J});n(67635);var i=n(67294),a=n(480),s=n(86628),o=n(24405),r=n(49019),l=n(35840),c=n(21202),d=n(23867),u=n(97880),p=n(82990),h=n(5366),m=n(91839),g=n(31278),f=n(76798),y=n(60682),x=n(57254),v=n(14976),S=n(82375),k=n(35661),C=n(84969),w=(n(21703),n(18466)),b=n(26263),j=n(14871),I=n(39699),M=n(15201),A=n(55217),Z=n(77907),T=n(85893);function _(e){window.__c={n:"AssistantChatMessageRendererMarkdown"};const{clientStep:t}=e,n=(0,a.O7)(),{value:s}=(0,Z.useDependency)(Z.deps.markdownLinkifyIt),o=(0,i.useMemo)((()=>s?w.Z.withListenerIgnored((()=>function(e){const{environment:t,clientStep:n,markdownLinkifyIt:i}=e,a=new b.Z({name:"AssistantChatMessageListRenderer"});return I.createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStore",environment:t,perform:e=>{const s=function(e){const{environment:t,clientStep:n,transaction:i,markdownLinkifyIt:a}=e,s=new b.Z({name:"AssistantChatMessageRenderer"}),o=t.currentUser.id;if(!o)throw new Error("No current user.");const r=e=>{const i=j.Mt({environment:t,text:n.text,transaction:e,inMemoryRecordCache:s,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:void 0});if(!i)return[];for(const t of i)s.setModelAndRole({pointer:t.pointer,userId:o},t.getModel(),"reader");return i};if(s.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),i)return r(i);return I.createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStore",environment:t,perform:r}).performResult}({environment:t,clientStep:n,transaction:e,markdownLinkifyIt:i});return j.Lh({environment:t,stores:s,inMemoryRecordCache:a,transaction:e})}}).performResult}({environment:n,clientStep:t,markdownLinkifyIt:s}))):void 0),[t,n,s]);return(0,T.jsx)(M.O,{displayName:"AssistantChatStepContent",disabled:!0,children:o?(0,T.jsx)(A.Z,{store:o,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,disableDrag:!0}):null})}var B=n(6507),F=n(15145),P=n(88891),L=n(72126),R=n(24677),V=n(2456),K=n(60981),W=n(61519),E=n(84076),N=n(93178),O=n(84210),D=n(95802),z=n(80444),U=n(5737);function H(e){window.__c={n:"AssistantTransactionRenderer"};const{clientStep:t}=e,n=(0,P.rn)(t.operations),a=(0,o.yK)((e=>({divider:{marginTop:6,marginBottom:6},subheader:{color:e.mediumTextColor}})),[]);return(0,T.jsx)(T.Fragment,{children:n.map(((e,t)=>(0,T.jsxs)(i.Fragment,{children:[(0,T.jsx)(q,{group:e},t),n[t+1]&&(0,T.jsx)(W.Z,{style:a.divider,size:1})]},t)))})}function q(e){window.__c={n:"AssistantTransactionGroupRenderer"};const{group:t}=e,n=(0,o.yK)((e=>({header:{marginBottom:6,color:e.mediumTextColor},pageTitle:{display:"inline",color:e.regularTextColor,fontWeight:p.Z.fontWeight.semibold,whiteSpace:void 0,overflow:void 0,textOverflow:void 0,textDecoration:"underline"},divider:{marginBottom:6},subheader:{color:e.mediumTextColor}})),[]),i=(0,s.VK)((()=>{const{mainEditorCurrentBlockStore:e}=z.default.state;if(!e)throw new Error("No main editor current block store");return e}),[]),a=(0,s.VK)((()=>i.getSpaceId()),[i]),r=k.G.createChildStore(i,{table:c.iU,id:t.pageId,spaceId:a}),l=(0,s.VK)((()=>{if("updatedPage"!==t.type)return[];const e=r.getParentCollectionStore(),n=null==e?void 0:e.getSchema();return L.oA(Array.from(t.updatedPropertyNames).map((e=>{const t=Object.entries(n||{}).find((t=>{let[,n]=t;return(null==n?void 0:n.name)===e}));if(t)return t[0]})))}),[r,t]),d=(0,s.VK)((()=>t.pageId===i.id?(0,O.ZP)({store:i,pageVisitSource:F.tY.AIChat,fullyQualified:!1}):(0,O.ZP)({store:i,pageVisitSource:F.tY.AIChat,fullyQualified:!1,peekViewBlockId:t.pageId})),[i,t.pageId]);if("updatedPage"===t.type){const{insertedBlockIds:e,updatedBlockIds:i,removedBlockIds:a,updatedTitle:s,updatedPropertyNames:o}=t,c=e.size+i.size+a.size+(s?1:0)+o.size;return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(E.Z,{style:n.header,href:d,children:(0,T.jsx)("span",{children:t.didCreatePage?(0,T.jsx)(h.FormattedMessage,{defaultMessage:"Created {page}",id:"assistant.transactionRenderer.createdPage.title",values:{page:(0,T.jsx)(f.Z,{store:r,style:n.pageTitle})}}):(0,T.jsx)(h.FormattedMessage,{defaultMessage:"{numEdits, plural, one {1 edit to {page}} other {{numEdits} edits to {page}}}",id:"assistant.transactionRenderer.editedPage.title",values:{numEdits:c,page:(0,T.jsx)(f.Z,{store:r,style:n.pageTitle})}})})}),s&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{style:n.subheader,children:"Updated title"}),(0,T.jsx)(G,{blockIds:[t.pageId]})]}),l.length>0&&(0,T.jsx)(T.Fragment,{children:l.map(((e,t)=>(0,T.jsx)(Q,{pageStore:r,property:e},t)))}),e.size>0&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{style:n.subheader,children:`Inserted ${e.size} block${e.size>1?"s":""}`}),(0,T.jsx)(G,{blockIds:Array.from(e)})]}),i.size>0&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{style:n.subheader,children:`Updated ${i.size} block${i.size>1?"s":""}`}),(0,T.jsx)(G,{blockIds:Array.from(i)})]}),a.size>0&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{style:n.subheader,children:`Removed ${a.size} block${a.size>1?"s":""}`}),(0,T.jsx)(G,{blockIds:Array.from(a)})]})]})}if("removedPage"===t.type)return(0,T.jsx)(E.Z,{style:n.header,href:d,children:(0,T.jsx)("span",{children:(0,T.jsx)(h.FormattedMessage,{defaultMessage:"Deleted {page}",id:"assistant.transactionRenderer.removedPage.title",values:{page:(0,T.jsx)("span",{style:{fontWeight:p.Z.fontWeight.bold},children:(0,T.jsx)(f.Z,{store:r,style:n.pageTitle})})}})})});(0,u.t1)(t)}function Q(e){window.__c={n:"BlockPropertyRenderer"};const{pageStore:t,property:n}=e,i=(0,s.VK)((()=>t.getParentCollectionStore()),[t]),a=(0,s.VK)((()=>{const e=null==i?void 0:i.getSchema(),t=Object.entries(e||{}).find((e=>{let[t]=e;return t===n}));return null==t?void 0:t[1]}),[i,n]),o=(0,s.VK)((()=>t.getPropertyValue(n)),[t,n]);return i&&a?(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(V.Hq,{labeled:!0,name:a.name,type:a.type,icon:a.icon,style:{marginBottom:6},children:(0,T.jsx)(N.Z,{propertySchema:a,beforeValue:{value:[],spaceId:i.getSpaceId()},afterValue:{value:o||[],spaceId:i.getSpaceId()},rootStore:t})})}):null}function G(e){window.__c={n:"BlockListRenderer"};const{blockIds:t}=e,n=(0,a.O7)(),s=(0,i.useMemo)((()=>w.Z.withListenerIgnored((()=>{const e=D.C.findSelectablesFromIds(t),i=t.map((t=>{if(!U.NM.state)throw new Error("No state");const i=e.find((e=>e.props.store.id===t));return(null==i?void 0:i.props.store)||new k.G(n,{table:c.iU,id:t},{inMemoryRecordCache:U.NM.state.temporaryCache})}));return R.rs(i),i}))),[n,t]);return(0,T.jsx)(M.O,{displayName:"AssistantBlockRenderer",disabled:!0,children:s.map(((e,t)=>(0,T.jsx)($,{store:e},t)))})}function $(e){window.__c={n:"BlockRenderer"};const{store:t}=e,n=(0,s.VK)((()=>(0,K.h)(t)),[t]);return n?(0,T.jsx)(n,{store:t,disabled:!0,isFirstItem:!1,isLastItem:!1}):null}function X(e){window.__c={n:"AssistantChatStep"};const{clientStep:t,parentStore:n,parentSpaceId:i,fakeSlackUser:c,configurationState:p}=e,g=(0,a.O7)(),f=(0,o.Fg)(),k=(0,s.VK)((()=>{var e,t;const n=[...(null===(e=S.XN.state)||void 0===e?void 0:e.clientSteps)??[],...(null===(t=S.XN.state)||void 0===t?void 0:t.temporaryClientSteps)??[]],i=n.findLast((e=>"human"===e.type));if(!i)return;const a=n.indexOf(i);return n.slice(a-1).find((e=>"assistantSearch"===e.type))}),[]),w=(0,s.VK)((()=>{var e,n;const i=[...(null===(e=S.XN.state)||void 0===e?void 0:e.clientSteps)??[],...(null===(n=S.XN.state)||void 0===n?void 0:n.temporaryClientSteps)??[]];return i.indexOf(t)===i.length-1}),[t]),b=(0,s.VK)((()=>"human"===t.type?{element:(0,T.jsx)("div",{style:{wordBreak:"break-word"},children:(0,v.IY)({environment:g,textValue:{value:t.text,spaceId:(0,d.C)(i)},parentStore:n,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:f,emojiType:(0,y.e_)(g),katex:g.KatexStore.getKatex(),formulaValueTypes:[]})})}:"assistantLoading"===t.type?{element:(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[k?(0,T.jsx)(h.FormattedMessage,{id:"AssistantChatStep.searching",defaultMessage:"Searching {icon} {keywords}",values:{icon:(0,l.R)({width:16,height:16,marginLeft:2,marginRight:2}),keywords:(0,T.jsx)("span",{style:{fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:` ${k.keywords}`})}}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(h.FormattedMessage,{id:"AssistantChatStep.thinking",defaultMessage:"Thinking"})," "]}),(0,T.jsx)("div",{style:{marginLeft:6},children:(0,T.jsx)(m.Z,{})})]})}:"assistantThink"===t.type?{element:(0,T.jsx)(T.Fragment,{children:`ðŸ’¡ ${t.thought}`})}:"assistantChatText"===t.type?(0,x.S)(t)?{element:null,doNotWrap:!0}:{element:(0,T.jsx)(_,{clientStep:t})}:"assistantChat"===t.type?(0,x.S)(t)?{element:null,doNotWrap:!0}:{element:(0,T.jsx)(C.m,{clientStep:t,parentStore:n,configurationState:p,fakeSlackUser:c,isLatestStep:w}),doNotWrap:!0}:"assistantTransaction"===t.type?{element:(0,T.jsx)(H,{clientStep:t})}:"assistantLoadPage"===t.type?{element:(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,T.jsx)(h.FormattedMessage,{id:"AssistantChatStep.loadPage",defaultMessage:"Reading pages"}),(0,T.jsx)("div",{style:{marginLeft:6},children:(0,T.jsx)(m.Z,{})})]})}:"assistantFriendlyError"===t.type?{element:(0,T.jsx)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:"I'm sorry! I wasn't able to complete this query. Please try asking me a different question."})}:"assistantSearch"===t.type?{element:(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,r.e)({width:14,marginRight:4}),(0,T.jsx)("b",{children:(0,T.jsx)(h.FormattedMessage,{id:"AssistantChatStep.search",defaultMessage:"Search {text}",values:{text:(0,T.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t.question})}})})]})}:"assistantSearchPeople"===t.type?{element:(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,T.jsx)(h.FormattedMessage,{id:"AssistantChatStep.searchPeople",defaultMessage:"Looking up people"}),(0,T.jsx)("div",{style:{marginLeft:6},children:(0,T.jsx)(m.Z,{})})]})}:"queryDatabase"===t.type?{element:(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,T.jsx)(h.FormattedMessage,{id:"AssistantChatStep.queryDatabase",defaultMessage:"Querying databases"}),(0,T.jsx)("div",{style:{marginLeft:6},children:(0,T.jsx)(m.Z,{})})]})}:"assistantShowSearchResults"===t.type?{element:null,doNotWrap:!0}:void(0,u.t1)(t)),[k,t,p,g,c,w,i,n,f]);return b.doNotWrap?b.element:(0,T.jsx)(B.J,{clientStep:t,configurationState:p,fakeSlackUser:c,forceShowFeedback:w,children:b.element})}function J(e){const{clientStep:t,parentStore:n,configurationState:i}=e;return(0,T.jsx)(B.J,{clientStep:t,configurationState:i,fakeSlackUser:void 0,forceShowFeedback:!1,children:(0,T.jsx)(Y,{clientStep:t,parentStore:n})})}function Y(e){window.__c={n:"AssistantSearchResultsThinkingMessageInner"};const{clientStep:t,parentStore:n}=e,{searchResults:a}=t,r=a.map((e=>k.G.createChildStore(n,{table:c.iU,id:e}))),[l,d]=(0,i.useState)(0),u=(0,o.yK)((e=>({messageWrapper:{display:"flex",marginTop:6,marginBottom:6},currentElementStyle:{marginRight:6,display:"flex",height:21}})),[]);(0,i.useEffect)((()=>{const e=setInterval((()=>{d((e=>e+1))}),800);return()=>clearInterval(e)}),[]);const y=(0,s.VK)((()=>r.map(((e,t)=>(0,T.jsx)("div",{style:u.currentElementStyle,children:(0,T.jsx)(h.FormattedMessage,{id:"AssistantChatStep.searchingText",defaultMessage:"Reading {link}",values:{link:(0,T.jsx)("div",{style:p.Z.textOverflowStyle,children:(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,T.jsx)(g.Z,{disabled:!0,isEmptyPage:e.isEmptyPage(),icon:e.getIcon(),size:20,emojiSize:20,disableShrinking:!0,largeIcon:!0,style:{margin:"0px 4px"}}),(0,T.jsx)(f.Z,{store:e})]})})}})},t)))),[r,u.currentElementStyle]),x=l>=r.length?(0,T.jsx)("div",{style:{...u.currentElementStyle,fontWeight:500},children:(0,T.jsx)(h.FormattedMessage,{id:"AssistantChatStep.summarize",defaultMessage:"Summarizing"})}):y[l];return(0,T.jsxs)("div",{style:{display:"flex"},children:[(0,T.jsx)("div",{style:{minWidth:50},children:x}),(0,T.jsx)("div",{style:{display:"flex",alignItems:"center",marginLeft:2},children:(0,T.jsx)(m.Z,{})})]})}},6507:(e,t,n)=>{n.d(t,{J:()=>q});var i=n(67294),a=n(480),s=n(6740),o=n(24405),r=n(72126),l=n(50906),c=n(26388),d=(n(95477),n(82375)),u=n(86628),p=n(77058),h=n(33676),m=n(97022),g=n(39986),f=n(10498),y=n(64964),x=n(23063),v=n(73063),S=n(49085);class k extends S.default{getInitialState(){return{}}}const C=new k;class w extends S.default{getInitialState(){return{open:!1,inferenceId:void 0}}}const b=new w;var j=n(54958),I=n(39040),M=n(70203),A=n(82990),Z=n(5366),T=n(54642),_=n(42922),B=n(60458),F=n(36488),P=n(74194),L=n(63296),R=n(64369),V=n(92660),K=n(60682),W=n(14976),E=n(80444),N=n(85893);const O=["Difficult to understand","Does not answer my question","Contains irrelevant details","Contains misleading or made-up information","Uses outdated information","I don't fully trust this answer"];function D(){window.__c={n:"ReportBadQnAForm"};const e=(0,o.yK)((e=>({reasonsArea:{width:"100%",background:e.popoverBackground,display:"block",marginBottom:16},title:{},checkboxArea:{display:"flex",alignItems:"center",gap:8},modalWrap:{width:"32rem",padding:24,fontSize:14},modalTitle:{fontSize:16,fontWeight:A.Z.fontWeight.medium},modalSubtitle:{fontSize:14},titleContainer:{marginBottom:16},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18},outlineButton:{marginRight:12},selectAll:{fontWeight:500,marginBottom:4},checkboxContainer:{display:"flex",flexDirection:"column",gap:4},linkTruncated:{maxWidth:"16rem",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}})),[]),[t,n]=(0,i.useState)([]),s=(0,i.useCallback)((e=>()=>{t.includes(e)?n((t=>t.filter((t=>t!==e)))):n((t=>[...t,e]))}),[t]),r=e=>t.includes(e),[l,c]=(0,i.useState)(),[p,h]=(0,i.useState)([]),m=(0,u.VK)((()=>E.default.state.currentSpaceStore),[]),g=(0,a.O7)(),f=(0,o.Fg)(),y=(0,i.useCallback)((()=>{const{inferenceId:e}=b.state,n=null==m?void 0:m.id;e&&n&&(T.saveAssistantFeedback(g,{type:"slackbot_followup_feedback",id:e,notes:l||"",reasons:t,correctAnswerPageIds:p}),b.reset())}),[null==m?void 0:m.id,g,l,t,p]),x=(0,i.useCallback)((e=>{p.includes(e)?h((t=>t.filter((t=>t!==e)))):h((t=>[...t,e]))}),[p]),v=(0,i.useCallback)((e=>p.includes(e)),[p]),S=(0,u.VK)((()=>{var e,t,n;const i=null===(e=d.XN.state)||void 0===e||null===(e=e.evaluator)||void 0===e||null===(e=e.codeEvaluator)||void 0===e?void 0:e.state,a=E.default.state.currentSpaceStore,s=null===(t=d.XN.state)||void 0===t||null===(t=t.evaluator)||void 0===t?void 0:t.getTranscript().filter((e=>"observation"===e.type&&"search"===e.observationType)),o=null==s||null===(n=s[s.length-1])||void 0===n?void 0:n.value;if(!o||!a)return[];const r=(0,I.P)(o)[0];if("element"===(l=r).type&&"search-results"===l.tagName&&(null===(c=l.children)||void 0===c?void 0:c.every((e=>"element"===e.type&&"page-result"===e.tagName)))){return r.children.map((e=>{var t;return((null==e||null===(t=e.attributes)||void 0===t?void 0:t.id)&&(null==i?void 0:i.getIdMapper().mapCounterToKey(e.attributes.id).key))??void 0})).filter((e=>!!e)).map((e=>({pageId:e,component:(0,W.IY)({environment:g,parentStore:a,textValue:{value:[(0,M.YCD)(["p",e])],spaceId:a.id},disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:f,emojiType:(0,K.e_)(g),katex:g.KatexStore.getKatex(),formulaValueTypes:[]})})))}var l,c;return[]}),[g,f]);return(0,N.jsx)(V.Z,{onDismiss:z,render:()=>(0,N.jsx)(F.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:t=>(0,N.jsxs)("div",{style:e.modalWrap,...t,children:[(0,N.jsx)("div",{style:e.titleContainer,children:(0,N.jsx)("div",{style:e.modalTitle,children:(0,N.jsx)(Z.FormattedMessage,{id:"BadQnAFeedbackForm.title",defaultMessage:"Report bad question & answer"})})}),(0,N.jsxs)("div",{style:e.reasonsArea,children:[(0,N.jsx)("div",{style:e.selectAll,children:"What should we know about this answer?"}),(0,N.jsx)("div",{style:e.checkboxContainer,children:O.map((t=>(0,N.jsxs)("div",{style:e.checkboxArea,children:[(0,N.jsx)(B.Z,{checked:r(t),onClick:s(t),size:14,checkSize:10}),(0,N.jsx)(R.Z,{style:e.title,children:t})]},t)))})]}),(0,N.jsxs)("div",{style:e.reasonsArea,children:[(0,N.jsx)("div",{style:e.selectAll,children:"Do any of these pages have the correct answer?"}),(0,N.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:S.map(((t,n)=>(0,N.jsxs)("div",{style:e.checkboxArea,children:[(0,N.jsx)(B.Z,{checked:v(t.pageId),onClick:()=>x(t.pageId),size:14,checkSize:10}),(0,N.jsx)("div",{style:e.linkTruncated,onClick:e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget.firstElementChild instanceof HTMLAnchorElement&&window.open(e.currentTarget.firstElementChild.href,"_blank")},children:t.component})]},t.pageId)))})]}),(0,N.jsx)(P.Z,{textarea:!0,placeholder:"Additional comments...",value:l,onChange:e=>c(e.target.value),focusInitial:!0,inputStyle:{padding:8}}),(0,N.jsxs)("div",{style:e.buttonArea,children:[(0,N.jsx)(L.Z,{isLarge:!0,onClick:z,style:e.outlineButton,children:(0,N.jsx)(Z.FormattedMessage,{id:"BadQnAFeedbackForm.cancelButton.label",defaultMessage:"Cancel"})}),(0,N.jsx)(_.Z,{isLarge:!0,onClick:y,children:(0,N.jsx)(Z.FormattedMessage,{id:"BadQnAFeedbackForm.reportButton.label",defaultMessage:"Submit"})})]})]})}),requireOnline:!0,modalStore:b})}function z(){b.update((()=>({open:!1,inferenceId:void 0})))}function U(e){let{configurationState:t,environment:n,isVisible:a,clientAssistantChatStep:s}=e;window.__c={n:"AssistantFeedbackButtons"};const{inferenceId:r}=s,l=(0,u.VK)((()=>C.state[r]??void 0),[r]),c=(0,o.yK)((e=>({thumbsUpFeedbackButton:{width:16,height:16,fill:"thumbs_up"===l?e.blueButtonBackground:e.grayButtonHoveredBackground},thumbsDownFeedbackButton:{width:16,height:16,fill:"thumbs_down"===l?e.blueButtonBackground:e.grayButtonHoveredBackground}})),[l]),d=(0,i.useMemo)((()=>Boolean(t&&t.isQnA)),[t]),v=(0,i.useCallback)((async()=>{await j.assistantActions.saveFeedback({environment:n,inferenceId:r,type:"assistant_thumbs_up"}),C.update((e=>({...e,[r]:"thumbs_up"}))),y.oV({label:(0,N.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,p.$)({width:16,height:16}),"Thanks for your feedback!"]})})}),[n,r]),S=(0,i.useCallback)((async()=>{await j.assistantActions.saveFeedback({environment:n,inferenceId:r,type:"assistant_thumbs_down"}),C.update((e=>({...e,[r]:"thumbs_down"}))),b.update((()=>({open:!0,inferenceId:r})))}),[n,r]);return(0,N.jsx)(x.Z,{isVisible:!0,animationStyle:{opacity:a||Boolean(l)?1:0},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:1},render:()=>(0,N.jsxs)("div",{style:{marginTop:"auto"},children:[(0,N.jsx)(H,{type:"up",iconHollow:g.P,iconFilled:f.w,onClick:v,style:c.thumbsUpFeedbackButton,feedbackReceived:l}),(0,N.jsx)(H,{type:"down",iconHollow:h.A,iconFilled:m.E,onClick:S,style:c.thumbsDownFeedbackButton,feedbackReceived:l}),d?(0,N.jsx)(D,{}):null]})})}function H(e){let{type:t,iconHollow:n,iconFilled:i,feedbackReceived:a,style:s,onClick:o}=e;const r=a===`thumbs_${t}`;return(0,N.jsx)(v.Z,{icon:r?i:n,onClick:r?()=>{}:o,disableBackground:r,iconStyle:{cursor:r?"initial":"pointer",...s},ariaLabel:`Thumbs ${t} feedback on assistant message`})}const q=(0,i.forwardRef)((function(e,t){window.__c={n:"AssistantChatStepWrapper"};const{children:n,clientStep:u,configurationState:p,fakeSlackUser:h,forceShowFeedback:m}=e,g=(0,a.O7)(),f=(0,o.yK)((e=>({wrap:{display:"flex",marginTop:6,marginBottom:6,gap:6},baseMessage:{maxWidth:512,borderRadius:16,padding:"8px 12px",fontSize:14,whiteSpace:"pre-wrap",overflowWrap:"break-word",position:"relative"},userLabel:{fontSize:12,color:e.mediumTextColor},humanMessage:{backgroundColor:"light"===e.mode?e.accentColors.gray[30]:e.accentColors.gray[300],color:e.darkTextColor,border:"unset"},assistantThinkMessage:{backgroundColor:e.accentColors.gray[50],color:e.mediumTextColor},assistantLoadingMessage:{backgroundColor:e.aiMessageBackgroundColor,color:e.aiMessageTextColor},assistantShowSearchResultsMessage:{backgroundColor:e.aiMessageBackgroundColor,color:e.aiMessageTextColor},assistantMessage:{border:`1px solid ${e.accentColors.gray[75]}`,backgroundColor:"light"===e.mode?e.contentBackground:e.accentColors.gray[300],color:e.regularTextColor,boxShadow:"0px 2px 4px 0px rgba(0, 0, 0, 0.04), 0px 0px 6px 0px rgba(0, 0, 0, 0.02)"}})),[]),[y,x]=(0,i.useState)(!1),v=(0,i.useMemo)((()=>(0,r.Ds)(x,100)),[x]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(c.Z,{placement:c.Z.Placement.Left,textWrap:!0,style:{maxWidth:240},disableTooltip:!("thought"in u&&u.thought,0),renderTooltip:()=>"thought"in u?`ðŸ’¡ ${u.thought}`:void 0,delayThreshold:500,render:e=>(0,N.jsxs)("div",{ref:t,style:f.wrap,...e,onClick:e=>{e.target instanceof HTMLSpanElement&&null!=p&&p.isQnA&&l.lO(g,p,e.target.baseURI.split("/").slice(-1)[0])},onFocus:t=>{var n;null===(n=e.onFocus)||void 0===n||n.call(e,t),(0,s.E)(t.target)&&v(!0)},onMouseEnter:t=>{var n;null===(n=e.onMouseEnter)||void 0===n||n.call(e,t),v(!0)},onBlur:t=>{var n;null===(n=e.onBlur)||void 0===n||n.call(e,t),v(!1)},onMouseLeave:t=>{var n;null===(n=e.onMouseLeave)||void 0===n||n.call(e,t),v(!1)},children:["human"===u.type&&(0,N.jsx)("div",{style:{flexGrow:1}}),(0,N.jsx)("div",{style:{...f.baseMessage,..."human"===u.type?f.humanMessage:"assistantThink"===u.type?f.assistantThinkMessage:"assistantLoading"===u.type?f.assistantLoadingMessage:"assistantShowSearchResults"===u.type?f.assistantShowSearchResultsMessage:f.assistantMessage},children:n}),"assistantChat"===u.type&&(0,d.Of)(u)&&(0,N.jsx)(U,{configurationState:p,environment:g,isVisible:y||m,clientAssistantChatStep:u})]})}),h&&"human"===u.type&&(0,N.jsxs)("div",{style:{display:"flex"},children:[(0,N.jsx)("div",{style:{flexGrow:1}}),(0,N.jsx)("div",{style:f.userLabel,children:h.name})]})]})}))},26794:(e,t,n)=>{n.d(t,{Q:()=>kt,x:()=>Ct});n(82801),n(21703);var i=n(67294),a=n(480),s=n(86628),o=n(24405),r=n(59054),l=n(37652),c=n(1464),d=n(89968),u=n(13148),p=n(56666),h=n(88437),m=n(11751),g=n(5366),f=n(82990),y=n(50906),x=n(31299),v=n(19471),S=n(23063),k=n(52275),C=n(31945),w=n(88359),b=n(73063),j=n(78140),I=n(32163),M=n(89728),A=n(72495),Z=n(45959),T=n(26388),_=n(19124),B=n(87279),F=n(77907),P=n(80444),L=n(5737),R=n(21273),V=n(82375),K=n(69454),W=n(56844),E=n(33932),N=n(70771),O=n(56206),D=n(40824),z=n(18875),U=n(54642),H=n(47307),q=n(39699),Q=n(53336),G=n(34859),$=n(45317),X=n(5175),J=n(2553),Y=n(15201),ee=n(68709),te=n(55217),ne=n(3553),ie=n(43250),ae=n(12534),se=n(85893);const oe=(0,g.defineMessages)({instructionSectionTitle:{id:"CustomSkillMenu.instructionSection.title",defaultMessage:"Instructions"}});function re(e){window.__c={n:"CustomSkillMenu"};const{clientSkill:t}=e,{skillStore:n}=t,r=(0,a.O7)(),l=(0,g.useIntl)(),c=(0,o.yK)((e=>({listWrap:{background:e.contentBackground,boxShadow:e.inputBoxShadow,padding:"3px 9px",margin:"0 8px",borderRadius:5,minHeight:64,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{},fontSize:14},emptyPlaceholder:{caretColor:e.mediumTextColor,color:e.lightTextColor,fontSize:14,padding:"5px 0",display:"inline-block"},sectionTitle:{color:e.lightTextColor,fontSize:12}})),[]),d=(0,s.VK)((()=>!n.canEdit()),[n]),u=(0,s.VK)((()=>{if(n.isType("custom"))return n.getInstructionParentStore()}),[n]),p=(0,s.VK)((()=>{if(u)return u.getContentStore()}),[u]),h=(0,i.useCallback)((e=>{(0,ae.ZP)({event:e,context:ae.Af.EditorClick,callback:()=>{if(!p)return;(p.getValue()||[]).length>0||q.createAndCommit({userAction:"CustomSkillMenu.handleListClick",environment:r,perform:e=>{J.Nj({environment:r,parentStore:p,transaction:e})}})}})}),[r,p]);return(0,se.jsx)(se.Fragment,{children:p&&u&&(0,se.jsx)(A.Z,{title:l.formatMessage(oe.instructionSectionTitle),children:(0,se.jsx)(ne.Z,{store:u,isDefaultContainer:!0,droppable:!1,render:()=>(0,se.jsx)(ee.p,{allowSelectionWithin:!0,children:(0,se.jsx)("div",{style:c.listWrap,onClick:h,className:ie.Wh_,children:(0,se.jsx)(Y.O,{displayName:"CustomSkillMenuContent",disabled:d,children:(0,se.jsx)(te.Z,{disabled:d,store:p,emptyPlaceholder:(0,se.jsx)("div",{style:c.emptyPlaceholder,children:(0,se.jsx)(g.FormattedMessage,{id:"automations.CustomSkillMenu.emptyPlaceholder",defaultMessage:"Click to edit instructionsâ€¦"})}),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1})})})})},u.id)})})}var le=n(24600),ce=n(53437),de=n(42876),ue=(n(57658),n(8848)),pe=n(80721),he=n(37612),me=n(97880),ge=n(95193),fe=n(18441),ye=n(30874),xe=n(41892),ve=n(77657),Se=n(149),ke=n(42631),Ce=n(42922);function we(e){const{renderMenu:t,onClose:n,onConnect:i}=e,a=[{key:"connect-to-slack-menu",items:[],render:e=>(0,se.jsx)(be,{...e,onClose:n,onConnect:i})}];return(0,se.jsx)(se.Fragment,{children:t(a)})}function be(e){window.__c={n:"ConnectSection"};const{onClose:t,onConnect:n}=e,i=Me();return(0,se.jsx)(A.Z,{children:(0,se.jsxs)("div",{style:i.container,children:[(0,se.jsx)(je,{}),(0,se.jsxs)("div",{style:i.connectToSlackBody,children:[(0,se.jsx)("div",{style:i.connectToSlackTitleText,children:(0,se.jsx)(g.FormattedMessage,{id:"slackConnectToSlackView.connectToSlackView.title",defaultMessage:"Connect to Slack"})}),(0,se.jsx)("div",{style:i.connectToSlackDescriptionText,children:(0,se.jsx)(g.FormattedMessage,{id:"slackConnectToSlackView.connectToSlackView.description",defaultMessage:"Enable your assistant to listen to Slack channels"})})]}),(0,se.jsx)(Ie,{onClose:t,onConnect:n})]})})}function je(){window.__c={n:"SlackIcon"};const e=Me();return(0,se.jsx)("div",{children:(0,se.jsx)("img",{src:xe.Z.images.externalIntegrations.slackIconPng,style:e.slackIcon})})}function Ie(e){window.__c={n:"AuthActionButtons"};const{onClose:t,onConnect:n}=e,i=(0,a.O7)(),o=(0,s.VK)((()=>{var e;return null===(e=P.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),r=(0,s.VK)((()=>ye.Z.integrations.state.find((e=>e.id===ve.nO))),[]),l=Me();return r&&o?(0,se.jsxs)("div",{style:l.buttonGroup,children:[(0,se.jsx)(Ce.Z,{style:l.connectToSlackButton,isLarge:!0,onClick:async()=>{const e=await ke.hM({environment:i,integration:r,spaceId:o,from:"collection_view_settings"});Se.x.isFail(e)?n({type:"workspace"}):e.value.externalAuthentication?n({type:"channel",externalAuthentication:e.value.externalAuthentication}):n({type:"workspace"})},children:(0,se.jsx)(g.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.connectButton.label",defaultMessage:"Connect"})}),(0,se.jsx)(M.Z,{style:l.cancelButton,isLarge:!0,onClick:()=>{t()},children:(0,se.jsx)(g.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.cancelButton.label",defaultMessage:"Cancel"})})]}):null}function Me(){return(0,o.yK)((e=>({container:{display:"flex",flexDirection:"column",margin:"10px 15px",justifyContent:"center",textAlign:"center"},connectToSlackBody:{margin:"0px 25px"},connectToSlackTitleText:{marginBottom:2,fontWeight:f.Z.fontWeight.semibold},connectToSlackDescriptionText:{fontSize:13,color:e.mediumTextColor},slackIcon:{width:23,height:"auto"},buttonGroup:{margin:"10px 10px 0px 10px"},connectToSlackButton:{width:"100%"},cancelButton:{color:e.mediumTextColor,width:"100%",justifyContent:"center",fontWeight:f.Z.fontWeight.medium,fontSize:13,marginTop:8}})),[])}var Ae=n(93364);const Ze=(0,g.defineMessages)({backButtonAriaLabel:{id:"SlackSelectWorkspaceAndChannelMenu.backButton.ariaLabel",defaultMessage:"Back to previous step"},selectSlackWorkspace:{id:"SlackSelectWorkspaceAndChannelMenu.selectSlackWorkspace",defaultMessage:"Select Slack workspace"},selectSlackChannel:{id:"SlackSelectWorkspaceAndChannelMenu.selectSlackChannel",defaultMessage:"Select Slack channel"},remove:{id:"SlackSelectWorkspaceAndChannelMenu.remove",defaultMessage:"Remove"}});function Te(e){window.__c={n:"SlackSelectWorkspaceAndChannelMenu"};const{onSelect:t,onClose:n,onRemove:a,channelFilter:o,workspaceFilter:r,onNewSlackAccountAdded:l}=e,c=(0,s.VK)((()=>(0,fe.P9)(ye.Z.completeSlackAuthentications.state,r)),[r]),[d,u]=i.useState(function(e){return 0===e.length?{type:"connect"}:1===e.length?{type:"channel",externalAuthentication:e[0]}:{type:"workspace"}}(c)),p=(0,ge.F)({maxHeight:"50vh",width:266});return"connect"===d.type?(0,se.jsx)(we,{onClose:n,onConnect:e=>u(e),renderMenu:e=>(0,se.jsx)(j.Z,{...p,children:(0,se.jsx)(I.Z,{type:I.i.Vertical,sections:e,initialFocus:0})})}):"workspace"===d.type?(0,se.jsx)(Ae.U,{onWorkspaceSelect:e=>{const t=(0,fe.jc)(e);(!r||t&&r(t))&&u({type:"channel",externalAuthentication:e})},workspaceFilter:r,onNewSlackAccountAdded:l,renderMenu:e=>(0,se.jsx)(j.Z,{...p,header:(0,se.jsx)(_e,{children:(0,se.jsx)(g.FormattedMessage,{...Ze.selectSlackWorkspace})}),children:(0,se.jsx)(I.Z,{type:I.i.Vertical,sections:e,initialFocus:0})})}):"channel"===d.type?(0,se.jsx)(de.ZP,{channelFilter:o,onClose:n,currentNotificationChannel:void 0,onNewSlackAccountAdded:()=>{u({type:"workspace"}),null==l||l()},currentExternalAuthentication:d.externalAuthentication,onNotificationChannelSelect:e=>t({notificationChannel:e,externalAuthentication:d.externalAuthentication}),renderMenu:e=>{const t=[...e];return a&&t.push({key:"remove",render:e=>(0,se.jsx)(A.Z,{topBorder:!0,...e}),items:[{key:"remove",render:e=>(0,se.jsx)(k.Z,{...e,icon:(0,he.y)({width:16,height:16,marginRight:2}),title:(0,se.jsx)(g.FormattedMessage,{...Ze.remove}),hoveredStyle:{color:ue.ZP.red,fill:ue.ZP.red}}),action:()=>{a(),n()}}]}),(0,se.jsx)(j.Z,{...p,header:(0,se.jsx)(_e,{onBack:()=>u({type:"workspace"}),children:(0,se.jsx)(g.FormattedMessage,{...Ze.selectSlackChannel})}),children:(0,se.jsx)(I.Z,{type:I.i.Vertical,sections:t,initialFocus:0})})}}):(0,me.t1)(d)}function _e(e){window.__c={n:"MenuHeader"};const{onBack:t,children:n}=e,i=(0,o.yK)((e=>({wrap:{display:"flex",alignItems:"center",margin:8,color:e.mediumTextColor,fontWeight:f.Z.fontWeight.medium,fontSize:f.Z.fontSize.UISmall.desktop,minHeight:22},iconButtonStyle:{marginRight:8,marginLeft:-2,height:22},iconButtonIconStyle:{width:16,height:16}})),[]),a=(0,g.useIntl)();return(0,se.jsxs)("div",{style:i.wrap,children:[t&&(0,se.jsx)(b.Z,{ariaLabel:a.formatMessage(Ze.backButtonAriaLabel),icon:pe.W,style:i.iconButtonStyle,iconStyle:i.iconButtonIconStyle,onClick:t}),n]})}n(95477);const Be=(0,g.defineMessages)({slackSectionTitle:{id:"editSkillMenu.optionalSlackSection.title",defaultMessage:"Slack (optional)"}});function Fe(e){window.__c={n:"SlackSkillMenu"};const{clientSkill:t}=e,n=(0,a.Fy)(),l=(0,a.O7)(),c=(0,g.useIntl)(),d=t.skillStore.pointer,[{value:u},p]=(0,r.r5)((async()=>{const e=null==d?void 0:d.id,t=null==d?void 0:d.spaceId;if(e&&t)return await U.getPageAssistantPreferences(l,{skillId:e,spaceId:t})}),[l,d]),h="success"===(null==u?void 0:u.type)?u.data:void 0,m=(0,s.VK)((()=>{var e;const t=null==h||null===(e=h.associatedChannels)||void 0===e?void 0:e[0];if("channel"===(null==t?void 0:t.type))return t.channel}),[h]),f=(0,i.useCallback)((e=>Boolean(null==h?void 0:h.aiEnabledSlackWorkspaceIds.includes(e))),[h]),y=(0,s.VK)((()=>t.skillStore.isType("custom")||t.skillStore.isType("wiki_slack")||t.skillStore.isType("tasks_slack")),[t.skillStore]),x=i.useCallback((async e=>{const{externalAuthentication:t,notificationChannel:n}=e,i=null==d?void 0:d.id,a=null==d?void 0:d.spaceId;i&&a&&(await U.setPageAssistantPreferences(l,{type:"skill",skillId:i,spaceId:a,operation:{type:"set_channel",botId:t.parent_id,channelId:n.id}}),await p())}),[l,d,p]),v=i.useCallback((async()=>{const e=null==d?void 0:d.id,t=null==d?void 0:d.spaceId;e&&t&&m&&t&&(await U.setPageAssistantPreferences(l,{type:"skill",skillId:e,spaceId:t,operation:{type:"clear_channel"}}),await p())}),[l,d,m,p]),S=(0,o.yK)((e=>({button:{width:"max-content",boxShadow:e.borderBoxShadow},selectChannelPlaceholder:{color:e.lightTextColor},container:{fontSize:14},icon:{width:12,height:12}})),[]);return y?(0,se.jsx)(A.Z,{title:c.formatMessage(Be.slackSectionTitle),children:(0,se.jsx)(C.ZP,{popupType:n.isMobile?ce.kQ.SlideUp:ce.kQ.Popup,render:e=>(0,se.jsx)(Te,{onClose:()=>e.close(),channelFilter:Pe,workspaceFilter:f,onSelect:async e=>{await x(e)},onRemove:async()=>{await v()}}),renderOrigin:e=>(0,se.jsx)(k.Z,{...e,focused:!1,buttonStyle:S.button,icon:!m&&(0,le.P)(S.icon),title:m?(0,se.jsx)(Le,{channel:m}):(0,se.jsx)(g.FormattedMessage,{id:"slackSkillRows.connectStart.label",defaultMessage:"Connect to a Slack channel"})})})}):null}const Pe=e=>"public"===e.type;function Le(e){window.__c={n:"ChannelValue"};const{channel:t}=e,n=(0,o.yK)((()=>({wrap:{display:"flex",alignItems:"center"},icon:{height:12,width:12}})),[]),i=(0,de.N_)({channel:t,styles:n.icon});return(0,se.jsxs)("div",{style:n.wrap,children:[i,"Â ",t.name]})}var Re=n(4615),Ve=n(64369);function Ke(e){window.__c={n:"TasksSlackSkillMenu"};const{clientSkill:t}=e,n=(0,a.O7)(),o=t.skillStore,r=(0,s.VK)((()=>{var e;return(null===(e=o.getSettings())||void 0===e||null===(e=e.tasks_team_options)||void 0===e?void 0:e.team_block_id)??""}),[o]),l=(0,s.VK)((()=>{var e;return(null===(e=o.getSettings())||void 0===e||null===(e=e.tasks_team_options)||void 0===e?void 0:e.tag_ids)??[]}),[o]),[c,d]=i.useState(r),[u,p]=i.useState(l.join(",")),h=i.useCallback((e=>{let t=e;e.includes("-")||(t=`${e.slice(0,8)}-${e.slice(8,12)}-${e.slice(12,16)}-${e.slice(16,20)}-${e.slice(20,32)}`),d(t),q.createAndCommit({userAction:"TasksSkillMenu.handleTeamBlockIdChange",environment:n,perform:e=>{(0,N.Cc)({store:o,update:{tasks_team_options:{team_block_id:t}},transaction:e})}})}),[o,n]),m=i.useCallback((e=>{const t=e.split(",").map((e=>e.trim())).map((e=>e.includes("-")?e:(0,Re.Mt)(e)));p(t.join(",")),q.createAndCommit({userAction:"TasksSkillMenu.handleTagIdsChange",environment:n,perform:e=>{(0,N.Cc)({store:o,update:{tasks_team_options:{tag_ids:t}},transaction:e})}})}),[o,n]);return(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)(A.Z,{children:[(0,se.jsx)(Ve.Z,{isSecondaryColor:!0,isSmall:!0,style:{marginLeft:"4px",marginBottom:"6px"},children:(0,se.jsx)(g.FormattedMessage,{id:"taskSlackSkillMenu.notes",defaultMessage:"Config here will change a lot - if anything breaks, ping @sophia"})}),(0,se.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6,margin:"0px 12px"},children:[(0,se.jsx)(v.b,{value:c,onChange:h,placeholder:"uuid for the team's page block"}),(0,se.jsx)(v.b,{value:u,onChange:m,placeholder:"uuids for tags to associate, comma separated"})]})]})})}var We=n(21202),Ee=n(15047),Ne=n(9953),Oe=n(40190),De=n(60458),ze=n(76798),Ue=n(35661);function He(e){window.__c={n:"AssistantSkillMenuProperty"};const{property:t,value:n}=e,i=(0,o.yK)((e=>({row:{display:"flex",alignItems:"center",marginLeft:8,marginRight:8,marginBottom:8,gap:8},property:{fontSize:14,flexGrow:1}})),[]);return(0,se.jsxs)("div",{style:i.row,children:[(0,se.jsx)("div",{style:i.property,children:t}),n]})}var qe=n(17215),Qe=n(53877),Ge=n(35840),$e=n(92338),Xe=n(35294),Je=n(68894),Ye=n(31278),et=n(48141),tt=n(88632);const nt=(0,g.defineMessages)({qnaSearchPlaceholderLabel:{id:"wikiQuestionAndAnswerDropdownButton.databaseSearch.inputPLaceholder",defaultMessage:"Search for databasesâ€¦"},qnaFeatureOffLabel:{id:"wikiQuestionAndAnswerDropdownButton.qnaFeatureMenu.disabledLabel",defaultMessage:"Off"}});function it(e){window.__c={n:"WikiQuestionAndAnswerDropdownButton"};const{skillStore:t,disabled:n}=e,l=(0,a.O7)(),c=(0,g.useIntl)(),d=(0,Xe.d)(),[u,p]=i.useState(""),h=(0,s.VK)((()=>{var e;const n=null===(e=t.getSettings())||void 0===e?void 0:e.qna_collection_view_block_id;if(n)return Ue.G.createChildStore(t,{table:We.iU,id:n,spaceId:t.getSpaceId()})}),[t]),m=(0,s.VK)((()=>null==h?void 0:h.getIcon()),[h]),[{value:f}]=(0,r.r5)((async()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=P.default.state;if(e)return await(0,et.hb)({environment:l,currentSpaceStore:e,currentSpaceViewStore:t})}),[l]),[{value:y}]=(0,r.r5)((async()=>{if(f)return await async function(e){const{environment:t,localCache:n,searchQuery:i}=e,a={query:{text:i,filters:(0,$e.u4)({requireEditPermissions:!0,isDeletedOnly:!1,excludeTemplates:!0,navigableBlockContentOnly:!0,blockTypes:["collection_view","collection_view_page"]}),sort:{field:"relevance"}},limit:5},s=await async function(e){const{environment:t,localCache:n,query:i}=e,{currentUserRootStore:a}=P.default.state;if(!a)return;return Promise.resolve((0,et.Y_)({query:i,localCachedPages:n,parentStore:a,isOnline:tt.Z.state.online,environment:t,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0,canUseLtr:!1}))}({environment:t,localCache:n,query:a});if(s&&Se.x.isSuccess(s)){const e=s.value.results;if(e.length>0)return e}return await async function(e){const{environment:t,query:{query:{text:n,filters:i,sort:a},limit:s}}=e,{currentSpaceStore:o}=P.default.state;if(!o)return;const r=await U.search(t,{type:$e.n8.BlocksInSpace,query:n,spaceId:o.id,limit:s,filters:i,sort:a,source:"quick_find_public",recentPagesForBoosting:void 0});if("success"===(null==r?void 0:r.type))return r.data.results.map((e=>({id:e.id,store:Ue.G.createChildStore(o,{id:e.id,table:We.iU,spaceId:e.spaceId})})))}({environment:t,query:a})??[]}({environment:l,localCache:f,searchQuery:u})}),[l,f,u]),x=(0,o.yK)((()=>({recordRow:{display:"flex",alignItems:"center"},recordIcon:{marginRight:6}})),[]);return(0,se.jsx)(C.ZP,{popupType:d,alignmentToOrigin:C.vR.End,placementToOrigin:C.pO.Bottom,originGap:0,disabled:n,renderOrigin:e=>(0,se.jsx)(Oe.S,{disabled:!1,variant:"gray",...e,children:h?(0,se.jsxs)("div",{style:x.recordRow,children:[(0,se.jsx)(Ye.Z,{style:x.recordIcon,disabled:!0,icon:m,isEmptyPage:!1,size:16}),(0,se.jsx)(ze.Z,{store:h})]}):c.formatMessage(nt.qnaFeatureOffLabel)}),render:e=>(0,se.jsx)(at,{skillStore:t,buttonPopupParent:e,searchQuery:u,setSearchQuery:p,searchResults:y})})}function at(e){window.__c={n:"QuestionAndAnswerDropdownMenu"};const{skillStore:t,searchQuery:n,setSearchQuery:r,buttonPopupParent:l,searchResults:c}=e,d=(0,a.O7)(),u=(0,o.yK)((e=>({menuItem:{paddingTop:8,paddingBottom:8},noResults:{color:e.mediumTextColor}})),[]),p=(0,g.useIntl)(),h=i.useCallback((e=>{q.createAndCommit({userAction:"QuestionAndAnswerDropdownMenu.onChange",environment:d,perform:n=>{Ne.sW({store:t.getSettingsStore(),data:{qna_collection_view_block_id:e},transaction:n})}})}),[d,t]),m={key:"input",action:()=>{},render:e=>(0,se.jsx)(Je.ZP,{...e,inputLeft:(0,se.jsx)(Je.f_,{icon:Ge.R}),showClearButton:!0,value:n,onChange:e=>{r(e.target.value)},placeholder:p.formatMessage(nt.qnaSearchPlaceholderLabel),focus:!0,style:u.menuItem})},f=(0,s.VK)((()=>c&&0!==c.length?c.map((e=>{let{id:t,store:n}=e;const i=n.getModel(),a=(null==i?void 0:i.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:Qe.x7,intl:p}))??(0,qe.Q2)(p),s=n.getIcon();return{key:t,action:()=>{h(t),l.close()},render:e=>(0,se.jsx)(k.Z,{...e,title:a,left:(0,se.jsx)(Ye.Z,{icon:s,disabled:!0,isEmptyPage:!1,size:16})})}})):[{key:"no-results",action:()=>{},render:e=>(0,se.jsx)(k.Z,{...e,style:{...u.menuItem,...u.noResults},title:(0,se.jsx)(g.FormattedMessage,{id:"wikiQuestionAndAnswerDropdownButton.noResult.label",defaultMessage:"No results"})})}]),[p,c,h,l,u]),y={key:"remove",action:()=>{h(void 0),l.close()},render:e=>(0,se.jsx)(k.Z,{...e,title:p.formatMessage(nt.qnaFeatureOffLabel),style:u.menuItem})},x={menuType:B.og.Popup,width:280,maxWidth:360};return(0,se.jsx)(j.Z,{...x,children:(0,se.jsx)(I.Z,{type:I.i.Vertical,initialFocus:0,sections:[{key:"search-input",render:e=>(0,se.jsx)(A.Z,{...e}),items:[m]},{key:"search-results",render:e=>(0,se.jsx)(A.Z,{...e,topBorder:!0}),items:f},{key:"disable-qna",render:e=>(0,se.jsx)(A.Z,{...e,topBorder:!0}),items:[y]}]})})}function st(e){const{clientSkill:t}=e,n=t.skillStore;return(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)(A.Z,{children:[(0,se.jsx)(He,{property:(0,se.jsx)(g.FormattedMessage,{id:"WikiSlackSkillMenu.searchIn",defaultMessage:"Search in"}),value:(0,se.jsx)(rt,{skillStore:n,disabled:!1})}),(0,se.jsx)(He,{property:(0,se.jsx)(g.FormattedMessage,{id:"WikiSlackSkillMenu.saveQuestionsAndAnswers",defaultMessage:"Save questions and answers"}),value:(0,se.jsx)(it,{skillStore:n,disabled:!1})}),(0,se.jsx)(He,{property:(0,se.jsx)(g.FormattedMessage,{id:"WikiSlackSkillMenu.confirmEdits",defaultMessage:"Confirm edits before saving"}),value:(0,se.jsx)(ot,{skillStore:n,disabled:!1})})]})})}function ot(e){window.__c={n:"WikiConfirmEditsButton"};const{skillStore:t,disabled:n}=e,o=(0,a.O7)(),r=(0,s.VK)((()=>{var e;return Boolean(null===(e=t.getSettings())||void 0===e?void 0:e.qna_ingestion_confirm_edits)}),[t]),l=(0,i.useCallback)((()=>{q.createAndCommit({userAction:"WikiConfirmEditsButton.onChange",environment:o,perform:e=>{Ne.sW({store:t.getSettingsStore(),data:{qna_ingestion_confirm_edits:!r},transaction:e})}})}),[o,r,t]);return(0,se.jsx)(De.Z,{checked:r,disabled:n,size:16,onClick:l})}function rt(e){window.__c={n:"SearchContextDropdownButton"};const{skillStore:t,disabled:n}=e,i=(0,a.Fy)(),o=(0,s.VK)((()=>{var e;return null===(e=t.getSettings())||void 0===e?void 0:e.search_context}),[t]);return o?(0,se.jsx)(C.ZP,{popupType:i.isMobile?C.Z4.SlideUp:C.Z4.Popup,alignmentToOrigin:C.vR.End,placementToOrigin:C.pO.Bottom,originGap:0,disabled:n,renderOrigin:e=>(0,se.jsx)(Oe.S,{disabled:n,variant:"gray",...e,children:(0,se.jsx)(ct,{value:o,skillStore:t})}),render:t=>(0,se.jsx)(lt,{value:o,parent:t,...e})}):null}function lt(e){window.__c={n:"SearchContextDropdownMenu"};const{value:t,skillStore:n,parent:r}=e,l=(0,a.O7)(),c=(0,o.yK)((()=>({menuItem:{paddingTop:8,paddingBottom:8}})),[]),d=(0,i.useCallback)((e=>{q.createAndCommit({userAction:"SearchContextDropdownMenu.onChange",environment:l,perform:t=>{Ne.sW({store:n.getSettingsStore(),data:{search_context:e},transaction:t})}})}),[l,n]),u={menuType:B.og.Popup,width:280,maxWidth:360},p=(0,s.VK)((()=>n.getParentPointer()),[n]),h=(0,s.VK)((()=>n.getSpacePointer()),[n]);if(!p||!h)return null;const m=[p,h].map(((e,i)=>({key:i,render:i=>(0,se.jsx)(k.Z,{...i,disabled:!1,title:(0,se.jsx)(ct,{value:e,skillStore:n}),style:c.menuItem,checkState:t.id===e.id,...i}),action:()=>{d(e),r.close()}})));return(0,se.jsx)(j.Z,{...u,children:(0,se.jsx)(I.Z,{type:I.i.Vertical,sections:[{key:0,render:e=>(0,se.jsx)(A.Z,{enableActionSheetTitle:!0,...e}),items:m}],initialFocus:0})})}function ct(e){const{value:t,skillStore:n}=e;return t.table===We.iU?(0,se.jsx)(ze.Z,{store:Ue.G.createChildStore(n,t)}):t.table===Ee.bx?(0,se.jsx)(g.FormattedMessage,{id:"WikiSlackSkillMenu.workspace",defaultMessage:"Workspace"}):void(0,me.t1)(t)}function dt(e){window.__c={n:"EditSkillMenu"};const{clientSkill:t,onClose:n,onDelete:r}=e,{skillStore:l}=t,c=(0,a.O7)(),d=(0,s.VK)((()=>l.getType()),[l]),u=(0,s.VK)((()=>l.isRenameable()),[l]),p=(0,s.VK)((()=>l.getName()),[l]),[h,m]=i.useState(p),f=i.useCallback((e=>{m(e),q.createAndCommit({userAction:"EditSkillMenu.handleNameChange",environment:c,perform:t=>{(0,N.Cc)({store:l,update:{name:e},transaction:t})}})}),[l,c]),y=(0,i.useCallback)((async()=>{if(!(await H.confirmUserAction({message:(0,se.jsx)(g.FormattedMessage,{defaultMessage:"Are you sure you want to delete this skill?",id:"EditSkillMenu.delete.cancelConfirmation"}),acceptLabel:(0,se.jsx)(g.FormattedMessage,{defaultMessage:"Delete",id:"EditSkillMenu.delete.cancelConfirmation.delete"})})))return;const e=l.getSpaceId();e&&await U.setPageAssistantPreferences(c,{type:"skill",spaceId:e,skillId:l.id,operation:{type:"clear_channel"}}),q.createAndCommit({userAction:"EditSkillMenu.handleDelete",environment:c,perform:e=>{(0,N.Nt)({store:l,transaction:e})}}),null==r||r(),n()}),[c,l,n,r]),x=(0,o.yK)((e=>({scroller:{maxHeight:"50vh"},skillIcon:{width:16,fill:e.aiPurpleColor,marginRight:4},fromRowWrap:{display:"flex",alignItems:"center",margin:"4px 8px",gap:4,fontSize:14},rowWrap:{display:"flex",alignItems:"center",margin:"0 8px",gap:8,fontSize:14},headerNameWrap:{flexGrow:1},sectionTitle:{color:e.lightTextColor,fontSize:12}})),[]);return(0,se.jsxs)(Q.Z,{type:G.Z.Y,style:x.scroller,children:[(0,se.jsx)(A.Z,{children:(0,se.jsxs)("div",{style:x.rowWrap,children:[$.AN[t.skillType](x.skillIcon),d&&u?(0,se.jsx)(v.b,{value:h,onChange:f,placeholder:"custom"===d?"Custom skill name":"Skill name"}):(0,se.jsx)("div",{style:x.headerNameWrap,children:(0,se.jsx)(X.Z,{clientSkill:t})}),(0,se.jsx)(M.Z,{onClick:n,isBlue:!0,children:"Done"})]})}),"custom"===d&&(0,se.jsx)(re,{clientSkill:t}),"wiki_slack"===d&&(0,se.jsx)(st,{clientSkill:t}),"tasks_slack"===d&&(0,se.jsx)(Ke,{clientSkill:t}),(0,se.jsx)(Fe,{clientSkill:t}),(0,se.jsx)(A.Z,{children:(0,se.jsx)("div",{style:x.rowWrap,children:(0,se.jsx)(M.Z,{onClick:y,isRed:!0,children:"Delete"})})})]})}function ut(e){window.__c={n:"AssistantSkillPopup"};const{clientSkill:t,renderOrigin:n,buttonPopupStore:i,onDelete:s}=e,r=(0,a.O7)(),l=(0,o.yK)((e=>({headerWrap:{display:"flex",alignItems:"center",margin:"0 4px"},editPopupWrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow,width:392}})),[]);return(0,se.jsx)(C.ZP,{popupType:r.device.isMobile?C.Z4.SlideUp:C.Z4.Popup,preventScaleTransition:!0,preventOpacityTransition:!0,popupWrapStyle:l.editPopupWrap,renderOrigin:n,render:e=>t&&(0,se.jsx)(dt,{clientSkill:t,onClose:e.close,onDelete:s}),buttonPopupStore:i})}var pt=n(18442),ht=n(72126),mt=n(98165),gt=n(61766),ft=n(2405);function yt(){window.__c={n:"AssistantSkillSwitcher"};const e=(0,a.O7)(),t=(0,o.yK)((e=>({wrap:{display:"flex",flexDirection:"column",overflow:"hidden"},skillIcon:{width:16,fill:e.aiPurpleColor,marginRight:4},headerWrap:{display:"flex",alignItems:"center",margin:"0 4px"},editPopupWrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow,width:392},skillMenuItemWrap:{display:"flex",alignItems:"center",margin:"8px 8px"},settingsButton:{marginLeft:8}})),[]),[n,r]=i.useState([]),l=i.useCallback((()=>{r((0,$.Qv)())}),[]);i.useEffect((()=>{l()}),[l]);const[c,d]=i.useState(void 0),u=(0,s.qz)(void 0,gt.Z),p=(0,s.VK)((()=>{if(c)return(0,$.WE)(c)}),[c]),h=(0,i.useCallback)((()=>{const{performResult:t}=q.createAndCommit({userAction:"AssistantSkillSwitcher.handleAddCustomSkillClick",environment:e,perform:t=>(0,N.Fv)({environment:e,transaction:t})});d(t),u.setState({...u.state,open:!0}),l()}),[e,u,l]),m=(0,i.useCallback)((()=>{const{performResult:t}=q.createAndCommit({userAction:"AssistantSkillSwitcher.handleWikiAddToSlackClick",environment:e,perform:t=>(0,N.y5)({environment:e,transaction:t})});d(t),u.setState({...u.state,open:!0})}),[e,u]),g=(0,s.VK)((()=>{var e;const{mainEditorCurrentBlockStore:t}=P.default.state;return null==t||null===(e=t.getFormat())||void 0===e?void 0:e.app_config_uri}),[]),f=(0,s.VK)((()=>{const{mainEditorCurrentBlockStore:e}=P.default.state;if(!e)return[];return(0,mt.uJ)(e).map((e=>e.id))}),[]),y=(0,s.VK)((()=>R.Z.allowWikiSkillCreation(g)),[g]),x=(0,s.VK)((()=>R.Z.allowCustomSkillCreation()),[]),v=(0,s.VK)((()=>{const e=n.filter((e=>"persisted"===e.type&&Boolean(e.inAppSkillTrigger)&&f.includes(e.skillStore.getParentId()))),t=n.filter((e=>"persisted"===e.type&&!e.inAppSkillTrigger&&Boolean(e.slackSkillTriggers)&&f.includes(e.skillStore.getParentId()))),i=n.filter((n=>Boolean(n.inAppSkillTrigger)&&!e.includes(n)&&!t.includes(n)));return{slackSkills:t,pageSkills:e,workspaceSkills:i}}),[f,n]),S=v.pageSkills.map((n=>xt({environment:e,clientSkill:n,styles:t,onDelete:l}))),k=v.workspaceSkills.map((n=>xt({environment:e,clientSkill:n,styles:t,onDelete:l}))),C=ht.oA([...v.slackSkills.map((n=>xt({environment:e,clientSkill:n,styles:t,onDelete:l}))),y&&{key:"wiki_slack",render:e=>(0,se.jsx)("div",{style:t.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref,children:(0,se.jsx)(ft.Z,{iconStyle:t.skillIcon,title:"Add to Slack",icon:$.AN.wiki_slack,focused:e.focused,onClick:e.onClick})},e.key),action:m}]);return(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)(A.Z,{style:t.wrap,children:[(0,se.jsxs)("div",{style:t.headerWrap,children:[(0,se.jsx)("div",{style:{flexGrow:1}}),(x||y)&&(0,se.jsx)(ut,{clientSkill:p,renderOrigin:()=>(0,se.jsx)(M.Z,{onClick:h,isBlue:!0,children:"New skill"}),buttonPopupStore:u,onDelete:l})]}),(0,se.jsx)(Q.Z,{type:G.Z.Y,children:(0,se.jsx)(I.Z,{type:I.i.Vertical,initialFocus:0,sections:ht.oA([S.length>0&&{key:"page",render:e=>(0,se.jsx)(A.Z,{topBorder:!1,disableMobileBorders:!0,title:"From this page",...e}),items:S},C.length>0&&{key:"slack",render:e=>(0,se.jsx)(A.Z,{topBorder:!1,disableMobileBorders:!0,title:"From Slack",...e}),items:C},k.length>0&&{key:"workspace",render:e=>(0,se.jsx)(A.Z,{topBorder:!1,disableMobileBorders:!0,title:"Other skills",...e}),items:k}])})})]})})}function xt(e){const{environment:t,clientSkill:n,styles:i,onDelete:a}=e;return{key:n.key,render:e=>"persisted"===n.type?(0,se.jsx)(ut,{clientSkill:n,onDelete:a,renderOrigin:t=>(0,se.jsxs)("div",{style:i.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref,children:[(0,se.jsx)(ft.Z,{iconStyle:i.skillIcon,title:(0,se.jsx)(X.Z,{clientSkill:n}),icon:$.AN[n.skillType],onClick:e.onClick,focused:e.focused}),"persisted"===n.type&&e.focused&&(0,se.jsx)(b.Z,{icon:pt.H,ariaLabel:"edit",style:i.settingsButton,...t})]},e.key)}):(0,se.jsx)("div",{style:i.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref,children:(0,se.jsx)(ft.Z,{iconStyle:i.skillIcon,title:(0,se.jsx)(X.Z,{clientSkill:n}),icon:$.AN[n.skillType],focused:e.focused,onClick:e.onClick})},e.key),action:async()=>{await(0,N.OZ)({environment:t,clientSkill:n})}}}var vt=n(42853);function St(e){window.__c={n:"AssistantSkillSwitcherButton"};const{store:t}=e,n=(0,s.VK)((()=>t.state),[t]),a=(0,o.yK)((e=>({skillIcon:{fill:e.aiPurpleColor},chevronDown:{fill:e.mediumIconColor,width:12,marginLeft:4}})),[]),r=(0,i.useCallback)((()=>{(0,E.O)({view:"skillSwitcher"})}),[]);if(null==n||!n.selectedSkill)return null;const{selectedSkill:l}=n;return(0,se.jsxs)(M.Z,{onClick:r,icon:$.AN[l.skillType],iconStyle:a.skillIcon,children:[(0,se.jsx)(X.Z,{clientSkill:l}),(0,vt.i)(a.chevronDown)]})}function kt(e){var t,n,m,U;window.__c={n:"AssistantMenu"};const{store:H,configurationStore:q,onClose:Q}=e,G=(0,a.O7)(),$=(0,s.VK)((()=>H.state),[H]),X=(0,s.VK)((()=>q.state),[q]),J=(0,s.VK)((()=>q.hasLockAction()),[q]),Y="qna"===(null==$||null===(t=$.selectedSkill)||void 0===t?void 0:t.skillType),ee=(0,i.useCallback)((()=>{var e;"qna"===(null==$||null===(e=$.selectedSkill)||void 0===e?void 0:e.skillType)&&y.Le6(G,X),W.clearAssistantStores()}),[X,null==$||null===(n=$.selectedSkill)||void 0===n?void 0:n.skillType,G]),te=(0,s.VK)((()=>!V.XN.state||!L.NM.state||J),[J]),ne=(0,i.useCallback)((()=>{var e;const t=(null===(e=V.XN.state)||void 0===e?void 0:e.evaluator.getTranscript())??{},n=JSON.stringify(t);navigator.clipboard.writeText(n)}),[]),ie=(0,i.useCallback)((()=>{var e;const t=null===(e=V.XN.state)||void 0===e?void 0:e.evaluator.getInferenceInputForEval({skipLastAssistantStep:!0}),n=JSON.stringify(t);navigator.clipboard.writeText(n)}),[]),ae=(0,i.useCallback)((()=>{var e;const t=null===(e=V.XN.state)||void 0===e?void 0:e.evaluator.getInferenceInputForEval({skipLastAssistantStep:!0}),n=JSON.stringify(t),i=btoa(encodeURIComponent(n));window.open(`/design/aiJsonRenderer#jsonl=${i}`,"_blank")}),[]),oe=(0,s.VK)((()=>{var e;return null===(e=P.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),re=(0,s.VK)((()=>(0,_.Gw)()),[]),le=(0,s.VK)((()=>e.renderAsFullPage?"chat":O.d.state.currentView),[e.renderAsFullPage]),ce=(0,s.VK)((()=>V.Pl.state),[]),de=Boolean(ce),ue=(0,s.VK)((()=>R.Z.isQnAOnlyEnabled()),[]),pe=(0,s.VK)((()=>R.Z.isAssistantEnabled()),[]),he=(0,s.VK)((()=>K.Z.estimatedNativeWebBottomOverlap(G)),[G]),me=(0,s.VK)((()=>R.Z.isMode("ai_team")),[]);(0,r.r5)((async()=>{oe&&await(0,N.K7)({environment:G,spaceId:oe})}),[G,oe]);const[ge,fe]=(0,i.useState)([]);(0,i.useEffect)((()=>{de&&x.Yu({environment:G,query:"",membersOnly:!1}).then((e=>fe(e))).catch((e=>{throw new Error(e)}))}),[G,de]);const ye=(0,i.useCallback)((()=>{(0,E.O)({view:"chat"})}),[]),xe=(0,i.useCallback)((()=>{var e;D.N.setAssistantLastViewedTime(),Q(),"qna"===(null==$||null===(e=$.selectedSkill)||void 0===e?void 0:e.skillType)&&y.Ti_(G,X)}),[X,null==$||null===(m=$.selectedSkill)||void 0===m?void 0:m.skillType,G,Q]),ve=(0,i.useCallback)((()=>{W.clearAssistantStores(),de?V.Pl.setState(void 0):V.Pl.setState({enabled:!0,selectedFakeUser:void 0,selectedFakeChannel:"#"})}),[de]),Se=function(e){const{hasLockAction:t,renderAsFullPage:n,mobileAppBottomOverlap:i,fullPagePaddingTop:a}=e;return(0,o.yK)((e=>({wrap:{display:"flex",flexDirection:"column",background:e.modalBackground,width:n?"100%":400,transition:"height 200ms ease",minHeight:128,height:n?`calc(100vh - ${i}px)`:void 0,maxHeight:n?void 0:"max(40vh, 600px)"},header:{display:"flex",alignItems:"center",pointerEvents:"auto",paddingTop:12,paddingLeft:16,paddingRight:16,paddingBottom:12,marginTop:a},labeledInput:{display:"flex",gap:8,alignItems:"center"},clearButton:{color:t?e.lightTextColor:e.mediumIconColor,opacity:t?.5:1},headerButton:{color:e.mediumIconColor},closeButton:{borderRadius:"100%",marginLeft:6},backwardButton:{borderRadius:"100%",marginRight:6},input:{width:void 0,marginLeft:8,marginRight:8},inputLabel:{fontSize:14,color:e.mediumTextColor},faceImgWrap:{width:64,height:64,borderRadius:"100%",background:"white",boxShadow:e.largeLightBoxShadow,overflow:"hidden"},faceImg:{width:64,pointerEvents:"none"},emptyStateText:{marginTop:28,fontSize:16,color:e.regularTextColor,fontFamily:f.Z.baseFontFamily.serif},inputWrap:{paddingTop:8,paddingBottom:8},skillsCaption:{fontSize:12,color:e.mediumTextColor,marginBottom:8},skillIcon:{fill:e.aiPurpleColor},skillsWrap:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:8},chatAndHelpButton:{display:"flex",alignItems:"center",gap:8},headerContentLeftOfClose:{display:"flex",marginRight:"8px",flexGrow:1,alignItems:"center"}})),[t,n,i,a])}({hasLockAction:J,renderAsFullPage:e.renderAsFullPage,mobileAppBottomOverlap:he,fullPagePaddingTop:e.fullPagePaddingTop});return(0,se.jsxs)("div",{style:Se.wrap,children:[(0,se.jsxs)("div",{style:Se.header,children:[(0,se.jsxs)("div",{style:Se.headerContentLeftOfClose,children:[e.renderAsFullPage&&(0,se.jsx)(b.Z,{iconStyle:{width:32,height:32},style:Se.backwardButton,icon:c.k,onClick:xe,disableBackground:!0,isDarkIconColor:!0,ariaLabel:"close"}),"chat"===le&&(0,se.jsxs)(se.Fragment,{children:[$&&pe&&(0,se.jsx)(St,{store:H}),"persisted"===(null==$||null===(U=$.selectedSkill)||void 0===U?void 0:U.type)&&(0,se.jsx)(ut,{clientSkill:$.selectedSkill,renderOrigin:e=>(0,se.jsx)(M.Z,{...e,style:Se.headerButton,children:"Edit"})}),ue&&(0,se.jsx)(Ct,{}),(0,se.jsx)("div",{style:{flexGrow:1}}),re&&(0,se.jsx)(M.Z,{style:Se.headerButton,onClick:ve,children:de?"Disable Slack mode":"Enable Slack mode"})]}),"skillSwitcher"===le&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(b.Z,{icon:l.V,onClick:ye,ariaLabel:"back"}),(0,se.jsx)("div",{style:{marginLeft:4,fontSize:14},children:"All skills"}),(0,se.jsx)("div",{style:{flexGrow:1}})]}),me&&(0,se.jsx)(C.ZP,{popupType:G.device.isMobile?C.Z4.SlideUp:C.Z4.Popup,renderOrigin:e=>(0,se.jsx)(T.Z,{render:t=>(0,se.jsx)(b.Z,{iconStyle:{width:18,height:18},icon:h.a,ariaLabel:"See debug data",...t,...e}),renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"assistant.copyTranscript",defaultMessage:"Debug data [dev]"})}),render:e=>(0,se.jsx)(j.Z,{menuType:B.og.Popup,children:(0,se.jsx)(I.Z,{type:I.i.Vertical,initialFocus:0,sections:[{key:"debug-data",render:e=>(0,se.jsx)(A.Z,{...e}),items:[{key:"copy-transcript",render:e=>(0,se.jsx)(k.Z,{...e,title:"Copy transcript"}),action:()=>{ne(),e.close()}},{key:"copy-eval",render:e=>(0,se.jsx)(k.Z,{...e,title:"Copy as AssistantInferenceInput"}),action:()=>{ie(),e.close()}},{key:"open-in-jsonl-viewer",render:e=>(0,se.jsx)(k.Z,{...e,title:"Open in JSONL viewer"}),action:()=>{ae(),e.close()}}]}]})})}),(0,se.jsxs)("div",{style:Se.chatAndHelpButton,children:[(0,se.jsx)(S.Z,{enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>(0,se.jsx)(T.Z,{render:e=>(0,se.jsx)(b.Z,{iconStyle:{width:24,height:24},icon:d.Y,ariaLabel:"clear",onClick:ee,...e}),renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"assistant.clear",defaultMessage:"clear"})}),isVisible:!te}),"chat"===le&&(!$||Y)&&!G.device.isMobileNative&&(0,se.jsx)(C.ZP,{popupType:G.device.isMobile?C.Z4.SlideUp:C.Z4.Popup,renderOrigin:e=>(0,se.jsx)(T.Z,{render:t=>(0,se.jsx)(b.Z,{iconStyle:{width:16,height:16},icon:p.o,ariaLabel:"help",...t,...e}),renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"assistant.help",defaultMessage:"Help"})}),render:()=>(0,se.jsx)(F.LazyHelpButtonContent,{shouldRenderAsStaticModal:!1})})]})]}),!e.renderAsFullPage&&(0,se.jsx)(b.Z,{style:Se.closeButton,hovered:!0,icon:u.U,onClick:xe,ariaLabel:"close"})]}),de&&(0,se.jsxs)("div",{style:{...Se.header,flexDirection:"column",gap:6},children:[(0,se.jsxs)("div",{style:Se.labeledInput,children:[(0,se.jsx)("div",{style:Se.inputLabel,children:"Channel"}),(0,se.jsx)(v.b,{value:(null==ce?void 0:ce.selectedFakeChannel)||"",onChange:e=>{if(!ce)throw new Error("slackModeState is undefined");V.Pl.setState({...ce,selectedFakeChannel:e})},disabled:Boolean($),placeholder:"Channel name",style:Se.input})]}),(0,se.jsxs)("div",{style:Se.labeledInput,children:[(0,se.jsx)("div",{style:Se.inputLabel,children:"User"}),(0,se.jsx)(Z.Z,{items:ge,selectedItem:null==ce?void 0:ce.selectedFakeUser,getKey:e=>e.name||e.id,renderItem:e=>(0,se.jsx)(k.Z,{...e,title:e.key}),onSelect:e=>{if(!ce)throw new Error("slackModeState is undefined");V.Pl.setState({...ce,selectedFakeUser:e})},renderOrigin:e=>(0,se.jsx)(w.Z,{focused:!1,title:null!=ce&&ce.selectedFakeUser?null==ce?void 0:ce.selectedFakeUser.name:"Select a user",...e})})]})]}),"chat"===le&&(0,se.jsx)(z.R,{store:H,renderAsFullPage:e.renderAsFullPage}),"skillSwitcher"===le&&(0,se.jsx)(yt,{})]})}function Ct(){window.__c={n:"QnaBadge"};const e=(0,o.yK)((e=>({headerSparkles:{width:16,height:16,marginRight:6,color:e.aiPurpleColor},headerLabel:{fontSize:14,color:e.regularTextColor,fontWeight:f.Z.fontWeight.medium,display:"flex",alignItems:"center"},alphaBadge:{marginLeft:8,fontSize:12,fontWeight:500,padding:"2px 4px",backgroundColor:"light"===e.mode?e.accentColors.purple[50]:e.accentColors.purple[200],color:"light"===e.mode?e.aiPurpleColor:e.accentColors.purple[900],borderRadius:4}})),[]);return(0,se.jsxs)(se.Fragment,{children:[(0,m.t)(e.headerSparkles),(0,se.jsx)("div",{style:e.headerLabel,children:(0,se.jsx)(g.FormattedMessage,{id:"assistantMenu.header.askNotionAI.label",defaultMessage:"Ask Notion AI"})}),(0,se.jsx)("div",{style:e.alphaBadge,children:(0,se.jsx)(g.FormattedMessage,{id:"assistantMenu.header.Alpha.label",defaultMessage:"Alpha"})})]})}},5175:(e,t,n)=>{n.d(t,{Z:()=>r});n(67294);var i=n(86628),a=n(5366),s=n(45317),o=n(85893);function r(e){window.__c={n:"AssistantSkillName"};const{clientSkill:t}=e,n=(0,a.useIntl)(),r=(0,i.VK)((()=>{if("persisted"===t.type){const e=t.skillStore.getName();if(e)return e}return n.formatMessage(s.jo[t.skillType])}),[t,n]);return(0,o.jsx)(o.Fragment,{children:r})}},40190:(e,t,n)=>{n.d(t,{S:()=>m,d:()=>g});var i=n(67294),a=n(480),s=n(24405),o=n(42853),r=n(54497),l=n(82990),c=n(24677),d=n(98104),u=n(89728),p=n(26388),h=n(85893);const m=i.forwardRef(((e,t)=>{window.__c={n:"AutomationDropdownButton"};const{variant:n,onClick:m,style:g,icon:f,children:y,disabled:x}=e,v=(0,a.O7)(),S=(0,s.yK)((e=>({button:{..."gray"===n&&{color:e.mediumTextColor},..."blue"===n&&{color:e.blueColor,fontWeight:500},..."error"===n&&{color:e.errorText},maxWidth:"calc(100% + 2px)",marginLeft:1,padding:"0 8px 0 5px",...g},warningIcon:{width:12,height:12,marginLeft:-6,marginLeft:6,fill:e.errorText,color:e.errorText},chevronIcon:{width:10,height:10,marginLeft:4,marginTop:2,fill:e.lightIconColor},spacer:{flexGrow:1}})),[n,g]),k=(0,i.useCallback)((e=>{d.ZH(v),c.ZH(v),null==m||m(e)}),[m,v]);return(0,h.jsx)(p.Z,{renderTooltip:()=>"error"===n?e.errorMessage:null,placement:p.Z.Placement.Bottom,disableTooltip:"error"!==n,delayThreshold:0,render:e=>(0,h.jsxs)(u.Z,{...e,style:S.button,icon:f,onClick:k,ref:t,shouldShrink:!0,disabled:x,disabledFeedback:x,children:[(0,h.jsx)("div",{style:{...l.Z.textOverflowStyle},children:y}),(0,h.jsx)("div",{style:S.spacer}),"error"===n&&(0,r.t)(S.warningIcon),(0,o.i)(S.chevronIcon)]})})}));function g(e){const{errorMessage:t,hasValue:n}=e;return(0,i.useMemo)((()=>t?{variant:"error",errorMessage:t}:n?{variant:"gray"}:{variant:"blue"}),[t,n])}},19471:(e,t,n)=>{n.d(t,{Y:()=>m,b:()=>h});var i=n(67294),a=n(480),s=n(86628),o=n(9953),r=n(98104),l=n(39699),c=n(21199),d=n(1743),u=n(74194),p=n(85893);function h(e){window.__c={n:"AutomationPlainTextInput"};const{value:t,onChange:n,wrapStyle:a,...s}=e,[o,l]=(0,i.useState)(!1);return(0,p.jsx)(d.Z,{capture:o,children:(0,p.jsx)(c.Z,{capture:!0,render:e=>(0,p.jsx)("div",{...e,style:a,children:(0,p.jsx)(u.Z,{value:t,onChange:e=>n(e.currentTarget.value),onBlur:()=>{l(!1)},onFocus:()=>{r.o9(),l(!0)},...s})})})})}function m(e){window.__c={n:"ConnectedAutomationPlainTextInput"};const{store:t,...n}=e,r=(0,a.O7)(),c=(0,s.VK)((()=>t.getValue()??""),[t]),d=(0,i.useCallback)((e=>{l.createAndCommit({userAction:"AutomationPlainTextInput.setValue",environment:r,perform:n=>{o.sO({store:t,transaction:n,value:e})}})}),[r,t]);return(0,p.jsx)(h,{value:c,onChange:d,...n})}},95193:(e,t,n)=>{n.d(t,{F:()=>r,U:()=>o});var i=n(480),a=n(86628),s=n(87279);function o(e){return e.device.isPhone||"actionSheet"===e.tabletBehavior&&e.device.isTablet?{menuType:s.og.ActionSheet}:{menuType:s.og.Popup,maxHeight:e.maxHeight,maxWidth:e.maxWidth,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,width:e.width,minWidth:e.minWidth}}function r(e){const t=(0,i.Fy)();return(0,a.VK)((()=>o({device:t,maxHeight:null==e?void 0:e.maxHeight,maxWidth:null==e?void 0:e.maxWidth,paddingTop:null==e?void 0:e.paddingTop,paddingBottom:null==e?void 0:e.paddingBottom,width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,tabletBehavior:null==e?void 0:e.tabletBehavior})),[t,null==e?void 0:e.maxHeight,null==e?void 0:e.maxWidth,null==e?void 0:e.paddingTop,null==e?void 0:e.paddingBottom,null==e?void 0:e.width,null==e?void 0:e.minWidth,null==e?void 0:e.tabletBehavior])}},35294:(e,t,n)=>{n.d(t,{d:()=>o});var i=n(480),a=n(86628),s=n(53437);function o(e){const t=(0,i.Fy)();return(0,a.VK)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?s.kQ.SlideUp:s.kQ.Popup),[t,null==e?void 0:e.tabletBehavior])}},93178:(e,t,n)=>{n.d(t,{Z:()=>C});n(57658),n(67294);var i=n(86628),a=n(24405),s=n(80951),o=n(14215),r=(n(30541),n(21703),n(67266)),l=n.n(r),c=n(5242),d=n.n(c),u=n(15095),p=n(72126),h=n(70203),m=n(97880);let g=function(e){return e[e.removed=-1]="removed",e[e.added=1]="added",e[e.same=0]="same",e}({});function f(e){const{before:t,after:n}=e,i={count:0,encoding:{},decoding:{},annotationEncoding:{},annotationDecoding:{}},a=e=>{const t=i.encoding[e];if(t)return t;{const t=String.fromCharCode(i.count);return i.count++,i.encoding[e]=t,i.decoding[t]=e,t}},s=e=>{const t=l()(e),n=i.annotationEncoding[t];if(n)return n;{const n=String.fromCharCode(i.count);return i.count++,i.annotationEncoding[t]=n,i.annotationDecoding[n]=e,n}},o=e=>p.xH(h.lzi(e).map((e=>{const t=u.p4(e[0]).map(a);if(h.km_(e)){const n=h.hDy(e),i=h.I$B(n);i&&(t[0]=s({type:"mention",value:i}),n.forEach((e=>{h.ZAl(e)||h.kuv(e)||h.QVC(e)||(t.unshift(s({type:"start",value:e})),t.push(s({type:"end",value:e})))})))}else if(h.YrK(e)){const n=h.hDy(e),i=h.Ap(n);if(i){t[0]=s({type:"equation",value:i});for(const e of n)h.ZAl(e)||h.kuv(e)||h.QVC(e)||(t.unshift(s({type:"start",value:e})),t.push(s({type:"end",value:e})))}}else if(h.AJd(e)){h.hDy(e).forEach((e=>{t.unshift(s({type:"start",value:e})),t.push(s({type:"end",value:e}))}))}return t}))).join("");if(i.count>65535)throw new Error("This string has way too many different characters.");const r=function(e,t){const n=new(d())({timeout:2,editCost:6}),i=n.main(t,e);return n.cleanupSemantic(i),i}(o(n),o(t)),c=[];let f=[];return r.forEach((e=>{let[t,n]=e;n.split("").forEach((e=>{if(i.decoding[e]){const n=i.decoding[e];t===g.added?c.push([n,[...f,["+"]]]):t===g.removed?c.push([n,[...f,["-"]]]):t===g.same&&c.push([n,f])}else{const n=i.annotationDecoding[e];if(t===g.added)if("mention"===n.type)c.push([h.qyI,[...f,["+"],n.value]]);else if("start"===n.type)f=[...f,n.value];else if("end"===n.type)f=f.filter((e=>!p.Xy(e,n.value)));else if("equation"===n.type){const e=h.xey(n.value),t=h.qZ6(e,[...f,["+"]]);c.push(t)}else(0,m.t1)(n);else if(t===g.removed){if("mention"===n.type)c.push([h.qyI,[...f,["-"],n.value]]);else if("equation"===n.type){const e=h.xey(n.value),t=h.qZ6(e,[...f,["-"]]);c.push(t)}}else if(t===g.same)if("mention"===n.type)c.push([h.qyI,[...f,n.value]]);else if("start"===n.type)f=[...f,n.value];else if("end"===n.type)f=f.filter((e=>!p.Xy(e,n.value)));else if("equation"===n.type){const e=h.xey(n.value),t=h.qZ6(e,f);c.push(t)}else(0,m.t1)(n)}}))})),h.Zxt(c)}var y=n(32566),x=n(21202),v=n(35661),S=n(14200),k=n(85893);function C(e){const t=e.propertySchema.type;switch(t){case"title":case"text":return(0,k.jsx)(w,{...e});case"relation":return(0,k.jsx)(b,{propertySchema:e.propertySchema,beforeValue:e.beforeValue,afterValue:e.afterValue,rootStore:e.rootStore});case"checkbox":case"number":case"person":case"file":case"url":case"email":case"phone_number":case"created_time":case"created_by":case"last_edited_time":case"last_edited_by":case"last_visited_time":case"formula":case"rollup":case"select":case"multi_select":case"date":case"button":case"status":case"auto_increment_id":case"location":case"verification":return(0,k.jsx)(j,{...e});default:(0,m.t1)(t)}}function w(e){const t={value:f({before:e.beforeValue.value,after:e.afterValue.value}),spaceId:e.beforeValue.spaceId};return(0,k.jsx)(S.Z,{value:t,propertySchema:e.propertySchema,rootStore:e.rootStore})}function b(e){window.__c={n:"RelationPropertyDiff"};const{beforeValue:t,afterValue:n,propertySchema:a,rootStore:r}=e,l=(0,i.VK)((()=>{const e=(0,s.rq)(t.value),i=(0,s.rq)(n.value),l=(0,o.N)(e,i,(e=>`${e.id}${e.table}`)),c=new Set(s.j$({relationValue:l.created,getRecordModel:r.getRecordModel,propertySchema:a})),d=new Set(s.j$({relationValue:l.deleted,getRecordModel:r.getRecordModel,propertySchema:a})),u=[...c,...d];return u.flatMap(((e,t)=>{const n=v.G.createChildStore(r,{table:x.iU,id:e.id}).getPropertyValue("title")||[],i=[],a=h.lzi(n);for(const s of a)if(h.QJH(s)){const t=c.has(e)?"+":"-",n=[s[0],[[t]]];i.push(n)}else i.push(s);return t<u.length-1&&i.push(h.V3y("\n")),i}))}),[t,n,a,r]);return(0,k.jsx)(S.Z,{value:{value:l,spaceId:t.spaceId},propertySchema:{type:"title",name:"Title"},rootStore:r})}function j(e){window.__c={n:"ArrowPropertyDiff"};const t=(0,a.yK)((()=>({arrowDiffWrap:{display:"inline-flex",alignItems:"center"}})),[]);return(0,k.jsxs)("div",{style:t.arrowDiffWrap,children:[(0,k.jsx)(S.Z,{value:e.beforeValue,propertySchema:e.propertySchema,rootStore:e.rootStore}),(0,k.jsx)(I,{}),(0,k.jsx)(S.Z,{value:e.afterValue,propertySchema:e.propertySchema,rootStore:e.rootStore})]})}function I(){window.__c={n:"Arrow"};const e=(0,a.yK)((e=>({container:{padding:"0px 8px"},icon:{width:15,height:15,fill:e.mediumIconColor}})),[]);return(0,k.jsx)("div",{style:e.container,children:(0,y.k)(e.icon)})}},42876:(e,t,n)=>{n.d(t,{ZP:()=>R,N_:()=>K});n(57658);var i=n(67294),a=n(480),s=n(86628),o=n(24405),r=n(41892),l=n(77657),c=n(82114),d=n(36591),u=n(90199),p=n(35840),h=n(55159),m=n(72126),g=n(149),f=n(97880),y=n(5366),x=n(54642),v=n(42631),S=n(33929),k=n(18441),C=n(80444),w=n(30874),b=n(49085),j=n(92595);class I extends b.default{getStateForBot(e){return this.state[e]??{channels:{},fetching:!1,lastRefreshed:0}}updateStateForBot(e,t){this.setState({...this.state,[e]:{...this.getStateForBot(e),...t}})}addChannelsForBot(e,t){const n=this.getStateForBot(e);this.setState({...this.state,[e]:{...n,channels:{...n.channels,...t}}})}}const M=new I;(0,j.exposeDebugValue)("ExternalNotificationChannelsStore",M);const A=M;var Z=n(52275),T=n(68894),_=n(68785),B=n(72495),F=n(33411),P=n(85893);const L=(0,y.defineMessages)({channelSearchPlaceholder:{id:"notificationRuleSettings.selectChannelView.searchInput.placeholder",defaultMessage:"Searchâ€¦"}});function R(e){window.__c={n:"SlackSelectChannelView"};const{currentNotificationChannel:t,onNotificationChannelSelect:n,onClose:c,onNewSlackAccountAdded:u,renderMenu:h,channelFilter:b}=e,j=(0,a.O7)(),{isMobile:I}=(0,a.Fy)(),M=(0,s.VK)((()=>w.Z.completeSlackAuthentications.state),[]),R=e.currentExternalAuthentication??m.Ps(M);i.useEffect((()=>{R&&async function(e){const{environment:t,botId:n,spaceId:i}=e,a=A.getStateForBot(n);if(a.fetching||Date.now()-a.lastRefreshed<15e3)return;let s;A.updateStateForBot(n,{fetching:!0,lastRefreshed:Date.now()});for(;;){const e=await x.getExternalNotificationChannels(t,{botId:n,spaceId:i,cursor:s});if("success"!==e.type){console.error(e.error);break}{const t={};for(const n of e.data.channels)t[n.id]=n;if(A.addChannelsForBot(n,t),s=e.data.cursor,!s)break}}A.updateStateForBot(n,{fetching:!1})}({environment:j,botId:R.id,spaceId:R.space_id})}),[j,R]);const[W,E]=i.useState(""),{loadedChannelsForAccount:N,isLoading:O}=(0,s.VK)((()=>{if(!R)return{loadedChannelsForAccount:[],isLoading:!1};const e=A.getStateForBot(R.id);return{loadedChannelsForAccount:Object.values(e.channels),isLoading:e.fetching}}),[R]),D=(0,s.VK)((()=>w.Z.integrations.state.find((e=>e.id===l.nO))),[]),z=(0,s.VK)((()=>{var e;return null===(e=C.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),U=i.useCallback((e=>{R&&n(e,R),c()}),[n,R,c]),H=(0,o.yK)((e=>({icon:{marginLeft:8,width:12,height:12,color:e.lightTextColor},container:{backgroundColor:e.popoverBackground,marginTop:12,marginBottom:6},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:e.regularIconColor}})),[]),q=i.useCallback((e=>{const{channel:n}=e;return{key:n.id,render:e=>(0,P.jsx)(Z.Z,{...e,icon:K({channel:n,styles:H.icon}),desktopIconStyle:{width:8},title:n.name,right:n.id===(null==t?void 0:t.id)&&(0,d.e)(H.icon)}),action:()=>{U(n)}}}),[U,H.icon,t]),{publicChannels:Q,privateChannels:G,personalChannels:$}=i.useMemo((()=>function(e,t){const n=[],i=[],a=[];for(const s of e)t&&!t(s)||("public"===s.type?n.push(s):"private"===s.type?i.push(s):"me"===s.type?a.push(s):(0,f.t1)(s.type));return{publicChannels:n,privateChannels:i,personalChannels:a}}(N,b)),[b,N]),X=i.useCallback((()=>Q.map((e=>({menuListItem:q({channel:e}),channelName:e.name})))),[Q,q]),J=i.useCallback((()=>G.map((e=>({menuListItem:q({channel:e}),channelName:e.name})))),[G,q]),Y=i.useCallback((()=>$.map((e=>({menuListItem:q({channel:e}),channelName:e.name})))),[$,q]),ee=i.useCallback((()=>X().map((e=>{let{menuListItem:t,channelName:n}=e;if(V({channelName:n,query:W}))return t})).filter(f.$K)),[X,W]),te=i.useCallback((()=>J().map((e=>{let{menuListItem:t,channelName:n}=e;if(V({channelName:n,query:W}))return t})).filter(f.$K)),[J,W]),ne=i.useCallback((()=>Y().map((e=>{let{menuListItem:t,channelName:n}=e;if(V({channelName:n,query:W}))return t})).filter(f.$K)),[Y,W]),ie=i.useCallback((()=>{if(!R)return[];const e=[],t=ee(),n=te(),i=ne();return i.length>0&&e.push({key:"personal-channels",render:e=>(0,P.jsx)(B.Z,{...e,title:(0,k.jg)(R).organizationName}),items:i}),t.length>0&&e.push({key:"public-channels",render:e=>(0,P.jsx)(B.Z,{...e,topBorder:i.length>0,title:0===i.length&&(0,k.jg)(R).organizationName}),items:t}),n.length>0&&e.push({key:"private-channels",render:e=>(0,P.jsx)(B.Z,{...e,topBorder:t.length>0,title:0===i.length&&t.length>0&&(0,k.jg)(R).organizationName}),items:n}),e}),[ee,te,ne,R]);if(!R||!D)return null;const ae=[{key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,P.jsx)("div",{children:(0,P.jsx)(T.ZP,{...e,inputLeft:(0,P.jsx)(T.f_,{icon:p.R}),inputRight:(0,P.jsx)(F.Z,{show:O,showDelay:500,showHold:300,render:e=>e&&(0,P.jsx)(_.Z,{style:{marginRight:2}})}),showClearButton:!0,placeholder:S.default.formatMessage(L.channelSearchPlaceholder),focusInitial:!I,value:W,onChange:e=>{E(e.target.value)}})})}],render:e=>(0,P.jsx)(B.Z,{...e})},...ie()];return t||ae.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!z)return;const e=await v.hM({environment:j,integration:D,spaceId:z,from:"collection_view_settings"});g.x.isFail(e)||u()},render:e=>(0,P.jsx)(Z.Z,{...e,icon:(0,P.jsx)("img",{src:r.Z.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,P.jsx)(y.FormattedMessage,{id:"notificationRuleSettings.selectChannelView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,P.jsx)(B.Z,{...e,topBorder:!0})}),(0,P.jsx)(P.Fragment,{children:h(ae)})}function V(e){const{channelName:t,query:n}=e;return 0===n.length||t.toLocaleLowerCase().indexOf(n.trim().toLocaleLowerCase())>=0}function K(e){const{channel:t,styles:n}=e;return"private"===t.type?(0,u.b)(n):"me"===t.type?(0,c.p)(n):(0,h.J)(n)}},93364:(e,t,n)=>{n.d(t,{U:()=>w});n(30541),n(57658);var i=n(67294),a=n(480),s=n(86628),o=n(24405),r=n(41892),l=n(77657),c=n(5257),d=n(35840),u=n(5366),p=n(149),h=n(42631),m=n(33929),g=n(18441),f=n(80444),y=n(30874),x=n(52275),v=n(68894),S=n(72495),k=n(85893);const C=(0,u.defineMessages)({workspaceSearchPlaceholder:{id:"notificationRuleSettings.selectWorkspaceView.searchInput.placeholder",defaultMessage:"Searchâ€¦"}});function w(e){window.__c={n:"SlackSelectWorkspaceView"};const{onWorkspaceSelect:t,renderMenu:n,workspaceFilter:w,onNewSlackAccountAdded:b}=e,j=(0,a.O7)(),{isMobile:I}=(0,a.Fy)(),M=(0,s.VK)((()=>{var e;return null===(e=f.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),A=(0,s.VK)((()=>(0,g.P9)(y.Z.completeSlackAuthentications.state,w)),[w]),Z=(0,s.VK)((()=>y.Z.integrations.state.find((e=>e.id===l.nO))),[]),[T,_]=i.useState(""),B=(0,o.yK)((e=>({chevronRight:{width:12,height:"auto",color:e.lightIconColor}})),[]);if(!Z)return null;const F=Object.entries((0,g.YJ)(A,T)).map(((e,n)=>{let[i,a]=e;return{key:i,items:a.map((e=>{let{workspaceName:n,externalAuthentication:i}=e;return{key:i.id,action:()=>{t(i)},render:e=>(0,k.jsx)(x.Z,{...e,title:n??(0,k.jsx)(u.FormattedMessage,{id:"notificationRuleSettings.selectWorkspace.untitledWorkspace",defaultMessage:"Slack workspace"}),right:(0,c.o)(B.chevronRight)})}})),render:e=>(0,k.jsx)(S.Z,{...e,title:i,topBorder:0!==n})}}));return F.unshift({key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,k.jsx)("div",{children:(0,k.jsx)(v.ZP,{...e,inputLeft:(0,k.jsx)(v.f_,{icon:d.R}),showClearButton:!0,placeholder:m.default.formatMessage(C.workspaceSearchPlaceholder),focus:!I||void 0,value:T,onChange:e=>{_(e.target.value)}})})}],render:e=>(0,k.jsx)(S.Z,{...e})}),F.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!M)return;const e=await h.hM({environment:j,integration:Z,spaceId:M,from:"collection_view_settings"});p.x.isFail(e)||e.value.externalAuthentication&&(t(e.value.externalAuthentication),null==b||b())},render:e=>(0,k.jsx)(x.Z,{...e,icon:(0,k.jsx)("img",{src:r.Z.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,k.jsx)(u.FormattedMessage,{id:"notificationRuleSettings.selectWorkspaceView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,k.jsx)(S.Z,{...e,topBorder:!0})}),(0,k.jsx)(k.Fragment,{children:n(F)})}},83176:(e,t,n)=>{n.d(t,{z:()=>s});n(67294);var i=n(45238),a=n(85893);const s=(0,i.I)("analyticsSearch",{viewBox:"0 0 51 52",svg:(0,a.jsx)("path",{d:"M.414 21.297c0 2.86.533 5.543 1.6 8.049a21.156 21.156 0 004.468 6.576 20.797 20.797 0 006.577 4.443c2.505 1.067 5.18 1.6 8.023 1.6 2.116 0 4.13-.305 6.043-.914a21.55 21.55 0 005.332-2.565l11.654 11.655a3.44 3.44 0 001.245.812c.473.186.964.28 1.472.28.728 0 1.371-.17 1.93-.508a3.48 3.48 0 001.32-1.346 3.887 3.887 0 00.482-1.93 3.8 3.8 0 00-.279-1.447 3.126 3.126 0 00-.787-1.193l-11.578-11.63a20.414 20.414 0 002.818-5.51c.694-2.013 1.041-4.138 1.041-6.372 0-2.844-.541-5.51-1.625-7.998a20.718 20.718 0 00-4.443-6.602 20.515 20.515 0 00-6.602-4.468c-2.488-1.067-5.162-1.6-8.023-1.6-2.844 0-5.518.533-8.023 1.6a20.592 20.592 0 00-6.577 4.468A21.072 21.072 0 002.014 13.3c-1.067 2.488-1.6 5.154-1.6 7.998zm5.408 0c0-2.1.39-4.071 1.168-5.916a15.517 15.517 0 013.301-4.875 15.168 15.168 0 014.875-3.276c1.845-.795 3.817-1.193 5.916-1.193 2.116 0 4.096.398 5.941 1.193a14.877 14.877 0 014.85 3.276 15.515 15.515 0 013.3 4.875c.796 1.845 1.194 3.817 1.194 5.916 0 2.116-.398 4.096-1.193 5.941a15.517 15.517 0 01-3.301 4.875 15.426 15.426 0 01-4.85 3.276c-1.845.795-3.825 1.193-5.941 1.193-2.099 0-4.07-.398-5.916-1.193a15.737 15.737 0 01-4.875-3.276 15.52 15.52 0 01-3.3-4.875c-.78-1.845-1.169-3.825-1.169-5.941zm15.31 10.36c.458 0 .746-.263.864-.788.237-1.32.474-2.437.711-3.351.254-.931.559-1.693.914-2.286a4.554 4.554 0 011.397-1.498c.575-.389 1.311-.694 2.209-.914.914-.237 2.056-.448 3.427-.634.542-.085.813-.381.813-.89 0-.507-.271-.812-.813-.913-1.354-.17-2.496-.373-3.427-.61-.915-.253-1.668-.567-2.26-.939a4.814 4.814 0 01-1.422-1.498c-.373-.61-.677-1.363-.914-2.26a42.337 42.337 0 01-.635-3.326c-.084-.542-.372-.813-.863-.813s-.796.263-.914.788a53.724 53.724 0 01-.737 3.377c-.22.914-.507 1.675-.863 2.285a4.64 4.64 0 01-1.396 1.472c-.576.373-1.32.677-2.235.914-.914.22-2.048.424-3.402.61-.559.101-.838.406-.838.914 0 .49.28.787.838.889 1.693.186 3.055.44 4.088.761 1.032.305 1.828.762 2.387 1.371.575.61 1.015 1.44 1.32 2.489.305 1.05.584 2.395.838 4.037a1 1 0 00.279.584c.17.152.38.228.635.228z"})})},37652:(e,t,n)=>{n.d(t,{V:()=>s});n(67294);var i=n(45238),a=n(85893);const s=(0,i.I)("arrowLeft",{viewBox:"0 0 30 30",svg:(0,a.jsx)("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},80721:(e,t,n)=>{n.d(t,{W:()=>s});n(67294);var i=n(45238),a=n(85893);const s=(0,i.I)("arrowLeftThick",{viewBox:"0 0 16 16",svg:(0,a.jsx)("path",{d:"M1.54004 8.05762C1.54004 8.2627 1.62891 8.46094 1.78613 8.61133L6.29102 13.1162C6.45508 13.2734 6.63965 13.3486 6.82422 13.3486C7.25488 13.3486 7.5625 13.041 7.5625 12.6309C7.5625 12.4189 7.48047 12.2344 7.34375 12.1045L5.8125 10.5527L3.78906 8.70703L5.38867 8.80273H13.7012C14.1455 8.80273 14.46 8.49512 14.46 8.05762C14.46 7.61328 14.1455 7.3125 13.7012 7.3125H5.38867L3.7959 7.4082L5.8125 5.5625L7.34375 4.01074C7.48047 3.87402 7.5625 3.68945 7.5625 3.47754C7.5625 3.06738 7.25488 2.7666 6.82422 2.7666C6.63965 2.7666 6.45508 2.83496 6.27734 3.00586L1.78613 7.50391C1.62891 7.64746 1.54004 7.85254 1.54004 8.05762Z"})})},82114:(e,t,n)=>{n.d(t,{Q:()=>a,p:()=>s});n(67294);var i=n(45238);const a=(0,n(85893).jsx)("path",{d:"M.911 8.034c0 4.505 3.049 7.24 7.246 7.24 1.135 0 2.215-.158 2.885-.376.472-.15.622-.397.622-.65a.44.44 0 00-.451-.444 1.3 1.3 0 00-.321.048c-.834.205-1.552.341-2.516.341-3.74 0-6.29-2.255-6.29-6.118 0-3.698 2.407-6.275 6.03-6.275 3.206 0 5.886 1.975 5.886 5.523 0 2.072-.697 3.466-1.825 3.466-.752 0-1.176-.437-1.176-1.183V4.972c0-.37-.205-.595-.554-.595-.341 0-.553.226-.553.595v.779h-.062c-.349-.84-1.203-1.374-2.222-1.374-1.77 0-3.014 1.51-3.014 3.678 0 2.187 1.237 3.712 3.042 3.712 1.06 0 1.88-.575 2.276-1.545h.062c.13.963.943 1.551 2.023 1.551 1.907 0 3.09-1.873 3.09-4.498 0-3.971-2.92-6.548-6.96-6.548C3.886.727.912 3.632.912 8.034zm6.911 2.652c-1.223 0-2.003-1.018-2.003-2.638 0-1.593.786-2.611 2.01-2.611 1.258 0 2.05.998 2.05 2.584 0 1.62-.813 2.665-2.057 2.665z"}),s=(0,i.I)("at",{viewBox:"0 0 16 16",svg:a})},12392:(e,t,n)=>{n.d(t,{S:()=>s});n(67294);var i=n(45238),a=n(85893);const s=(0,i.I)("historyBack",{viewBox:"0 0 14 14",svg:(0,a.jsx)("polygon",{points:"2.85893 7.74676 8.05608 12.9439 7 14 0.528042 7.52804 0 7 0.528042 6.47196 7 0 8.05608 1.05608 2.85893 6.25324 14 6.25324 14 7.74676"})})},79198:(e,t,n)=>{n.d(t,{n:()=>s});n(67294);var i=n(45238),a=n(85893);const s=(0,i.I)("refresh",{viewBox:"0 0 24 20",svg:(0,a.jsx)("path",{d:"M0.19663 9.99023C-0.184229 10.5273-0.00844799 11.0059 0.694677 11.0059L2.04233 11.0059C2.56968 15.9766 6.85679 19.9219 11.9447 19.9219C14.9232 19.9219 17.6185 18.5645 19.4544 16.4551C19.8158 16.0352 19.7669 15.5078 19.3861 15.2344C19.0052 14.9609 18.5365 15.0586 18.224 15.4199C16.7103 17.168 14.4642 18.2617 11.9447 18.2617C7.68686 18.2617 4.22007 15.1074 3.72202 11.0059L5.1771 11.0059C5.87046 11.0059 6.04624 10.5273 5.67515 10L3.48765 6.88477C3.17515 6.43555 2.7064 6.42578 2.38413 6.88477ZM4.44468 3.4668C4.07358 3.88672 4.12241 4.4043 4.51304 4.67773C4.8939 4.95117 5.35288 4.86328 5.67515 4.50195C7.19858 2.76367 9.44468 1.66016 11.9447 1.66016C16.1927 1.66016 19.6595 4.81445 20.1673 8.92578L18.7123 8.92578C18.0189 8.92578 17.8431 9.39453 18.2142 9.93164L20.4017 13.0469C20.7142 13.4961 21.183 13.5059 21.5052 13.0469L23.683 9.94141C24.0736 9.39453 23.888 8.92578 23.1849 8.92578L21.847 8.92578C21.3099 3.95508 17.0326 0 11.9447 0C8.96616 0 6.28061 1.34766 4.44468 3.4668Z"})})},83065:(e,t,n)=>{n.d(t,{_:()=>s});n(67294);var i=n(45238),a=n(85893);const s=(0,i.I)("sendArrow",{viewBox:"0 0 20 20",svg:(0,a.jsx)("path",{d:"M9.79883 18.5894C14.6216 18.5894 18.5894 14.6216 18.5894 9.79883C18.5894 4.96777 14.6216 1 9.79053 1C4.95947 1 1 4.96777 1 9.79883C1 14.6216 4.96777 18.5894 9.79883 18.5894ZM9.79883 14.3062C9.20947 14.3062 8.76953 13.9077 8.76953 13.3433V9.69922L8.86914 8.00586L8.25488 8.84424L7.3916 9.81543C7.23389 10.0063 6.98486 10.1143 6.72754 10.1143C6.21289 10.1143 5.84766 9.75732 5.84766 9.25928C5.84766 8.99365 5.92236 8.79443 6.12158 8.58691L8.96045 5.61523C9.19287 5.35791 9.4585 5.2417 9.79883 5.2417C10.1309 5.2417 10.4048 5.36621 10.6372 5.61523L13.4761 8.58691C13.667 8.79443 13.75 8.99365 13.75 9.25928C13.75 9.75732 13.3848 10.1143 12.8618 10.1143C12.6128 10.1143 12.3638 10.0063 12.2061 9.81543L11.3428 8.86914L10.7202 7.99756L10.8281 9.69922V13.3433C10.8281 13.9077 10.3799 14.3062 9.79883 14.3062Z"})})},33676:(e,t,n)=>{n.d(t,{A:()=>o});n(67294);var i=n(45238),a=n(39986),s=n(85893);const o=(0,i.I)("thumbDown",{viewBox:"0 0 18 19",svg:(0,s.jsx)("g",{transform:"rotate(180 9 9.5)",children:a.f})})},97022:(e,t,n)=>{n.d(t,{E:()=>o});n(67294);var i=n(45238),a=n(10498),s=n(85893);const o=(0,i.I)("thumbDownFilled",{viewBox:"0 0 16 18",svg:(0,s.jsx)("g",{transform:"rotate(180 8 9)",children:a.O})})},39986:(e,t,n)=>{n.d(t,{P:()=>s,f:()=>a});n(67294);var i=n(45238);const a=(0,n(85893).jsx)("path",{d:"M0.539062 12.3125C0.539062 15.0547 2.29688 17.3125 4.54688 17.3125H7.11719C8.17188 17.8516 9.42188 18.1641 10.8047 18.1641H11.8906C12.9062 18.1641 13.7734 18.1016 14.3359 17.9609C15.4766 17.6797 16.1953 16.8672 16.1953 15.8516C16.1953 15.6641 16.1719 15.5 16.1172 15.3281C16.6562 14.9141 16.9609 14.2969 16.9609 13.6328C16.9609 13.3203 16.8984 13.0078 16.7891 12.7578C17.1484 12.375 17.3594 11.8203 17.3594 11.25C17.3594 10.875 17.2656 10.4922 17.1094 10.2031C17.3281 9.86719 17.4531 9.42188 17.4531 8.9375C17.4531 7.69531 16.5078 6.73438 15.2734 6.73438H12.3672C12.1953 6.73438 12.0859 6.65625 12.0938 6.50781C12.1328 5.69531 13.4062 3.75781 13.4062 2.17188C13.4062 1.01562 12.5859 0.171875 11.4688 0.171875C10.6484 0.171875 10.0859 0.59375 9.55469 1.61719C8.58594 3.48438 7.40625 5.125 5.65625 7.28125H4.25C2.14844 7.28125 0.539062 9.52344 0.539062 12.3125ZM5.375 12.25C5.375 10.5938 5.75 9.53125 6.80469 8.11719C7.99219 6.53125 9.625 4.63281 10.8125 2.27344C11.0625 1.77344 11.2344 1.64844 11.4844 1.64844C11.7891 1.64844 11.9844 1.86719 11.9844 2.25C11.9844 3.42188 10.6641 5.35156 10.6641 6.61719C10.6641 7.55469 11.4219 8.15625 12.4375 8.15625H15.2422C15.7031 8.15625 16.0391 8.5 16.0391 8.95312C16.0391 9.28125 15.9297 9.5 15.6562 9.76562C15.4609 9.96875 15.4375 10.25 15.6094 10.4453C15.8359 10.7734 15.9375 10.9844 15.9375 11.25C15.9375 11.5781 15.7812 11.8516 15.4609 12.0938C15.2031 12.2812 15.1094 12.5859 15.2656 12.8828C15.4297 13.2109 15.5156 13.3672 15.5156 13.6172C15.5156 14 15.2734 14.2891 14.7812 14.5469C14.5312 14.6875 14.4609 14.9531 14.5703 15.1875C14.7344 15.5938 14.7578 15.6641 14.7578 15.8438C14.7578 16.1797 14.5078 16.4531 13.9766 16.5859C13.5156 16.7031 12.7812 16.75 11.8203 16.7422L10.8125 16.7344C7.57031 16.7031 5.375 14.8828 5.375 12.25ZM1.9375 12.3125C1.9375 10.3281 2.96094 8.73438 4.14062 8.6875C4.34375 8.6875 4.55469 8.6875 4.75781 8.6875C4.20312 9.76562 3.95312 10.8984 3.95312 12.25C3.95312 13.6875 4.46094 14.9531 5.375 15.9453C5.07812 15.9453 4.76562 15.9375 4.46875 15.9375C3.10156 15.8906 1.9375 14.2812 1.9375 12.3125Z"}),s=(0,i.I)("thumbUp",{viewBox:"0 0 18 19",svg:a})},10498:(e,t,n)=>{n.d(t,{O:()=>a,w:()=>s});n(67294);var i=n(45238);const a=(0,n(85893).jsx)("path",{d:"M4 12.1875C3.99219 15.1641 6.34375 17.4297 10.0859 17.4375H11.1719C12.1953 17.4375 12.9766 17.3594 13.4297 17.2422C14.1016 17.0781 14.7031 16.6562 14.7031 15.8828C14.7031 15.5859 14.625 15.3594 14.5312 15.1875C14.4766 15.1016 14.4922 15.0234 14.5703 14.9922C15.0859 14.7578 15.4766 14.2812 15.4766 13.6562C15.4766 13.2969 15.375 12.9766 15.2031 12.75C15.125 12.6406 15.1406 12.5469 15.2656 12.4766C15.625 12.25 15.875 11.7891 15.875 11.2656C15.875 10.8828 15.7578 10.4844 15.5547 10.2812C15.4453 10.1797 15.4609 10.1094 15.5781 10.0156C15.8281 9.78906 15.9844 9.41406 15.9844 8.96094C15.9844 8.15625 15.3516 7.5 14.5234 7.5H11.7031C11.0234 7.5 10.5781 7.15625 10.5781 6.60156C10.5781 5.54688 11.9141 3.57812 11.9141 2.14844C11.9141 1.375 11.4219 0.90625 10.75 0.90625C10.1641 0.90625 9.85938 1.28906 9.53125 1.9375C8.33594 4.24219 6.75781 6.11719 5.54688 7.72656C4.49219 9.11719 4.00781 10.3125 4 12.1875ZM0.015625 12.25C0.015625 14.6719 1.52344 16.6719 3.53125 16.6719H4.89062C3.47656 15.5938 2.85156 13.9922 2.86719 12.1719C2.875 10.2031 3.57812 8.77344 4.32031 7.79688H3.23438C1.41406 7.79688 0.015625 9.75 0.015625 12.25Z"}),s=(0,i.I)("thumbUpFilled",{viewBox:"0 0 16 18",svg:a})}}]);