"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[684],{16091:(e,t,s)=>{s.d(t,{RD:()=>k,gc:()=>T,gl:()=>I,u7:()=>w});var r=s(67294),i=s(36769),n=s(480),o=s(86628),a=s(41432),l=s(5366),d=s(39699),c=s(37181),u=s(81415),h=(s(95477),s(19124)),p=s(68056),g=s(89086),m=s(28685),f=s(80444),v=s(77080),y=s(83212),x=s(35661),S=s(24666),b=s(41752),C=s(89626),M=s(85893);const j=(0,l.defineMessages)({spaceForAiHeader:{id:"AiOnboardingTooltips.spaceForAi.header",defaultMessage:"Press ‘space’ for AI"},spaceForAiContent:{id:"AiOnboardingTooltips.spaceForAi.content",defaultMessage:"On a new line or page, press ‘space’ on your keyboard for AI to generate or edit the page. Try it now!"},askAiAnythingHeader:{id:"AiOnboardingTooltips.askAiAnything.header",defaultMessage:"Ask AI anything"},askAiAnythingContent:{id:"AiOnboardingTooltips.askAiAnything.content",defaultMessage:"Just tell AI what to do — the more details, the better. You can also start from an example in the menu."},refineAiResponseHeader:{id:"AiOnboardingTooltips.refineAiResponse.header",defaultMessage:"Tell AI what to do next"},refineAiResponseContent:{id:"AiOnboardingTooltips.refineAiResponse.content",defaultMessage:"How was it? Give AI further instructions to improve what it wrote, or hit ‘Done’ when finished."},showAssistantLocationHeader:{id:"AiOnboardingTooltips.showAssistantLocation.answersToYourQuestionHeader",defaultMessage:"Get instant answers to your questions"},showAssistantLocationContent:{id:"AiOnboardingTooltips.showAssistantLocation.askQuestionBody",defaultMessage:"Ask a question about anything in your workspace. Notion AI will search across your pages and generate an answer."}});function w(){window.__c={n:"SpaceForAiOnboardingTooltip"};const e=(0,n.O7)(),t=function(){const e=(0,n.O7)(),t=(0,o.VK)((()=>{const t=f.default.state.mainEditorCurrentBlockStore;return t&&y.Z.getMode(e,t)}),[e]);return(0,o.VK)((()=>{if(e.device.isMobile)return;if(!v.default.checkGate("space_for_ai_tooltip_enabled"))return;const{currentUserSettingsStore:s,inAppCalloutStore:r}=f.default.state;if(!r.canShow("ai_onboarding_tooltip"))return;const i=null==s?void 0:s.getSettings();if(!i)return;if(i.signup_time&&i.signup_time>16770636e5)return;if("space_for_ai"!==(0,C.sy)())return;if(!(0,h.GD)(t))return;const n=S.default.state;if("editing"===n.mode){const e=(0,p.QY)(n.multiSelection);if(e&&(0,g.wd)(e.selection)){const t=e.store,s=m.E.findEditableWithStore(t);if(s){const e="block"===t.pointer.table?x.G.createChildStore(t,t.pointer):void 0,r=e&&e.getType(),i=Boolean(r&&(0,a.hD)(r)),n=t.getValue();if(i&&!n)return s}}}}),[e,t])}();return t?(0,M.jsx)(u.U,{origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,M.jsx)(l.FormattedMessage,{...j.spaceForAiHeader}),content:(0,M.jsx)(l.FormattedMessage,{...j.spaceForAiContent}),onCloseClick:()=>(0,C.h1)(e)}):null}function k(e){window.__c={n:"AskAIAnythingOnboardingTooltip"};const{originRef:t,openState:s}=e,r=(0,n.O7)(),i=(0,o.VK)((()=>(0,C.sy)()),[]);if(r.device.isMobile)return null;return"ask_ai_anything"===i&&"initialPrompt"===s.stage?(0,M.jsx)(u.U,{origin:t,placementToOrigin:"top",header:(0,M.jsx)(l.FormattedMessage,{...j.askAiAnythingHeader}),content:(0,M.jsx)(l.FormattedMessage,{...j.askAiAnythingContent}),onCloseClick:()=>(0,C.h1)(r)}):null}function I(e){window.__c={n:"RefineAIResponseOnboardingTooltip"};const{originRef:t,openState:s,isInputEmpty:r}=e,i=(0,n.O7)(),a=(0,o.VK)((()=>(0,C.sy)()),[]);if(i.device.isMobile)return null;const d="refine_ai_response"===a&&"results"===s.stage&&!s.loading&&"cursor"===s.context.type&&r;return(0,M.jsx)(u.U,{origin:d?t:void 0,placementToOrigin:"right",pointerOffset:-4,pointerLength:25,header:(0,M.jsx)(l.FormattedMessage,{...j.refineAiResponseHeader}),content:(0,M.jsx)(l.FormattedMessage,{...j.refineAiResponseContent}),onCloseClick:()=>(0,C.h1)(i)})}function T(e){window.__c={n:"ShowAssistantLocationTooltip"};const{origin:t}=e,s=(0,n.O7)(),i=(0,r.useCallback)((()=>{const{currentUserSettingsStore:e}=f.default.state;e&&(0,b.C)(s,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e})}),[s]);return(0,M.jsx)(u.U,{style:{width:250},pointerLength:25,pointerPosition:"5%",origin:t,placementToOrigin:"bottom",header:(0,M.jsx)(l.FormattedMessage,{...j.showAssistantLocationHeader}),content:(0,M.jsx)(l.FormattedMessage,{...j.showAssistantLocationContent}),onCloseClick:i})}(0,i.exposeDebugEnvironmentValue)("resetAIOnboarding",(e=>()=>{const{currentUserSettingsStore:t}=f.default.state;t&&d.createAndCommit({userAction:"AiIntroModal.debugging.resetAIOnboarding",environment:e,perform:e=>{c.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:"space_for_ai"}})},userId:t.id})}))},81598:(e,t,s)=>{s.d(t,{Q:()=>o,Zl:()=>n,eC:()=>a,qS:()=>i,yX:()=>l});var r=s(77907);const i=(0,r.lazyComponent)(r.deps.assistant,(e=>e.AssistantChatStep)),n=(0,r.lazyComponent)(r.deps.assistant,(e=>e.AssistantLabelerBar)),o=(0,r.lazyComponent)(r.deps.assistant,(e=>e.AssistantOriginElement)),a=(0,r.lazyComponent)(r.deps.assistant,(e=>e.AssistantMenuPopup)),l=(0,r.lazyComponent)(r.deps.assistant,(e=>e.SearchAssistantPane))},33338:(e,t,s)=>{s.d(t,{Z:()=>l});s(67294);var r=s(480),i=s(24405),n=s(42853),o=s(64921),a=s(85893);function l(e){window.__c={n:"CollectionViewFilterPill"};const{icon:t,title:s,on:l,hasDiff:c,wrapStyle:u,innerStyle:h,hideChevron:p}=e,g=(0,i.Fg)(),m=(0,r.O7)();return(0,a.jsxs)("div",{style:{borderRadius:14,marginRight:6,display:"inline-flex",...c&&{position:"relative"},...u},children:[(0,a.jsxs)(o.Z,{disabled:e.disabled,style:d(Boolean(l),g,h,m.device.isMobile),hoveredStyle:l?{background:g.outlineBlueButtonHoveredBackground}:void 0,pressedStyle:l?{background:g.outlineBlueButtonPressedBackground}:void 0,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,onDoubleClick:e.onDoubleClick,children:[t,s,!p&&(0,n.i)({width:10,marginLeft:4,marginTop:1,fill:l?g.blueColor:g.lightIconColor})]}),c&&(0,a.jsx)("div",{style:{position:"absolute",top:-2,right:-2,background:"dark"===g.mode?g.accentColors.orange[500]:g.accentColors.orange[300],border:`1px solid ${g.contentBackground}`,width:9,height:9,borderRadius:9}})]})}function d(e,t,s,r){return{fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderRadius:32,height:r?28:24,lineHeight:r?"28px":"24px",padding:"0 8px",border:`1px solid ${t.outlineButtonBorder}`,color:t.mediumTextColor,...e&&{color:t.blueColor,border:`1px solid ${t.filterPillBorder}`,background:t.filterPillBackground},...s}}},97820:(e,t,s)=>{s.d(t,{Z:()=>p});s(67294);var r=s(83355),i=s(99036),n=s(39068),o=s(82990),a=s(19124),l=s(61766),d=s(33846),c=s(76836),u=s(85893);class h extends r.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:l.Z,nameInputStore:d.Z}}renderComponent(){const{device:e}=this.environment,{propertySchema:t,showIcon:s,hideName:r,showBadge:i,style:n}=this.props,a=e.isMobile?16:14;return(0,u.jsxs)("div",{style:{...h.baseStyle,fontSize:a,...n},children:[s&&(0,u.jsx)("div",{style:this.getIconStyle(),children:this.renderIcon()}),!r&&(0,u.jsx)("div",{style:{...o.Z.textOverflowStyle},children:t.name}),i&&this.renderBadge()]})}renderIcon(){const{device:e}=this.environment,{propertySchema:t}=this.props,{theme:s}=this,r=e.isMobile?18:16;return(0,u.jsx)(n.ZP,{type:t.type,icon:t.icon,size:this.props.iconSize||r,theme:s,style:this.props.iconStyle})}renderBadge(){const{propertySchema:e}=this.props;if((0,a.Zt)(this.environment)&&i.qQ(e)&&i.q3(e)&&("text"===e.type||(0,a.KZ)()))return(0,u.jsx)(c.Z,{})}getIconStyle(){const{hideName:e,iconStyle:t}=this.props;return{marginRight:e?void 0:6,...t}}}h.displayName="Property",h.baseStyle={display:"flex",alignItems:"center",lineHeight:"120%",minWidth:0};const p=h},97680:(e,t,s)=>{s.d(t,{Z:()=>m});s(67294);var r=s(83355),i=s(66897),n=s(97880),o=s(33929),a=s(87279),l=s(98742),d=s(52275),c=s(26388),u=s(70301),h=s(45653),p=s(85893);class g extends r.Z{renderComponent(){const{actor:e,userTitle:t,useEmailAsTooltip:s,tooltip:r,tooltipPlacement:a}=this.props,g=o.default.getIntl(),m=e.asActor&&e.isUser()?e.email:void 0,f=s&&m?m:r,v=this.environment.device.isMobile?24:20;let y;return(0,i.YU)(e)?y=(0,p.jsx)(u.Z,{botValue:null==e?void 0:e.asActor,size:v}):(0,i.$S)(e)?y=(0,p.jsx)(h.Z,{userValue:null==e?void 0:e.asActor,size:v}):(0,i.Iq)(e)?y=(0,p.jsx)(h.Z,{userValue:void 0,size:v}):(0,n.t1)(e),(0,p.jsx)(c.Z,{placement:a??c.Z.Placement.Bottom,alignment:c.Z.Alignment.Start,textWrap:!0,render:s=>(0,p.jsx)(d.Z,{...(0,l.Z)(s,this.props),icon:y,title:t??(0,i.$4)(g,e),className:"notranslate"}),disableTooltip:!f,renderTooltip:()=>f})}}g.displayName="UserMenuItem",g.contextTypes={...a.mw,...r.w};const m=g},22715:(e,t,s)=>{s.d(t,{Z:()=>o});s(67294);var r=s(480),i=s(24405),n=(s(58047),s(85893));function o(){window.__c={n:"WebComponentNotSupportedInMobileNativeWarning"};(0,r.O7)(),(0,i.yK)((e=>({container:{margin:"8px 16px",background:e.accentColors.yellow[100],borderRadius:8,height:"fit-content"}})),[]);return(0,n.jsx)(n.Fragment,{})}},93481:(e,t,s)=>{s.d(t,{Z:()=>M});s(67294);var r=s(83355),i=s(69651),n=s(97880),o=s(5366),a=s(48141),l=s(41558),d=s(33338),c=s(42922),u=s(52275),h=s(3386),p=s(89728),g=s(53437),m=s(72495),f=s(83264),v=s(255),y=s(75689),x=s(91642),S=s(8319),b=s(85893);class C extends r.Z{constructor(){super(...arguments),this.storeTypes={store:l.Z},this.renderActiveButtonOrigin=()=>{const{value:e,dateFormat:t,disabled:s,focused:r,intl:n}=this.props,o=this.styles,l=this.getThemeColors(),d={...o.menuItem,...l.activeMenuItem},c=a._Q(e,n,t),h=(0,b.jsx)(v.Z,{onClick:this.handleClear,disabled:s});return(0,b.jsx)(u.Z,{focused:r,disabled:s,icon:(0,i.C)(o.iconActiveDesktop),title:c,right:h,isTokenTitle:!0,alignIconTop:!0,onClick:this.handleOriginActivate,desktopTitleStyle:o.menuItemTitleDesktop,desktopIconStyle:o.iconActiveDesktopWrapper,style:d})},this.renderInactiveButtonOrigin=()=>{const{title:e,icon:t,disabled:s,focused:r,mode:i}=this.props,n=this.styles,o=this.getThemeColors(),a={...n.menuItem,...o.buttonMenuItem,...i===S.Z.Mode.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return(0,b.jsx)(u.Z,{focused:r,disabled:s,icon:t(n.icon),title:e,onClick:this.handleOriginActivate,style:a})},this.renderPillButtonOrigin=()=>{const{value:e,title:t}=this.props;return(0,b.jsx)(d.Z,{on:Boolean(e.starting||e.ending),icon:(0,i.C)({width:16,marginRight:6,fill:"currentColor"}),title:(0,b.jsx)("span",{children:t}),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e,showButtons:t}=this.props,{store:s}=this.stores;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Z,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:s,onDismiss:this.handleMenuClose}),t&&(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"},children:[(0,b.jsx)(p.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleMenuClose,children:(0,b.jsx)(o.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})}),(0,b.jsx)(c.Z,{onClick:()=>this.props.onChange(this.stores.store.state.temporaryDateRange),children:(0,b.jsx)(o.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"})})]})]})},this.renderFooter=()=>{const{store:e}=this.stores;return(0,b.jsxs)(m.Z,{topBorder:!0,style:{padding:6,justifyContent:"space-between",display:"flex"},children:[(0,b.jsx)(p.Z,{onClick:()=>{e.setState({...e.state,temporaryDateRange:{starting:void 0,ending:void 0}}),this.props.onChange({})},children:(0,b.jsx)(o.FormattedMessage,{id:"searchDateFilter.clearButton",defaultMessage:"Clear"})}),(0,b.jsx)(c.Z,{onClick:this.handleMenuClose,children:(0,b.jsx)(o.FormattedMessage,{id:"searchDateFilter.applyButton",defaultMessage:"Apply"})})]})},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t}=this.stores;e||t.setState({...t.state,isOpen:!0,focus:"starting"})},this.handleMenuClose=e=>{const{onChange:t,onMenuDismiss:s}=this.props,{store:r}=this.stores,{temporaryDateRange:i}=r.state;a.zD(e)||(this.props.showButtons||t(i),r.setState({...r.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),s&&s())},this.handleClear=()=>{const{onChange:e}=this.props;e({starting:void 0,ending:void 0})},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t}=this.stores;if(!e.error)return t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},sectionMenuItem:{display:"flex"},summary:{display:"inline-flex"}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t}=this.props,{store:s}=this.stores,r=this.styles,i=e===S.z.Section,o=i?t:void 0,a=(()=>e===S.Z.Mode.Section?this.renderActiveButtonOrigin():e===S.Z.Mode.Button?this.renderInactiveButtonOrigin():e===S.Z.Mode.Pill?this.renderPillButtonOrigin():void(0,n.t1)(e))();return(0,b.jsx)(x.Z,{title:o,marginAfter:i,children:(0,b.jsx)(h.Z,{capture:s.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey,children:(0,b.jsx)(g.ZP,{popupType:this.getPopupType(),open:s.state.isOpen,origin:a,render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:g.ZP.Placement.Bottom,alignmentToOrigin:g.ZP.Alignment.Start,keepFocus:!0,style:r.popup})})})}renderMobile(e){const{store:t}=this.stores,s=e===S.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return(0,b.jsx)(g.ZP,{popupType:g.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:s,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:s}=this.props,r=this.styles;return(0,b.jsx)(u.Z,{disabled:s,focused:!1,icon:e(r.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,dateFormat:s,disabled:r,intl:n}=this.props,o=this.styles,l=(0,b.jsxs)("div",{style:o.summary,children:[(0,i.C)(o.iconActiveMobile),a._Q(t,n,s)]});return(0,b.jsx)(y.Z,{disabled:r,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:l})}getCurrentValue(){const{value:e}=this.props,{store:t}=this.stores,{temporaryDateRange:s}=t.state;return{...e,...s}}getPopupType(){const{device:e}=this.environment;return e.isMobile?g.ZP.PopupType.SlideUp:g.ZP.PopupType.Popup}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},activeMenuItem:{color:this.theme.regularTextColor}}}}C.displayName="SearchDateFilter";const M=(0,o.injectIntl)(C)},33991:(e,t,s)=>{s.r(t),s.d(t,{INACTIVE_TIMEOUT_MS:()=>U,SearchStaticContext:()=>Q,SearchStoresContext:()=>$,default:()=>J});s(57658);var r=s(67294),i=s(83355),n=s(18466),o=s(49085),a=s(15145),l=s(1800),d=s(12174),c=s(72126),u=s(4615),h=s(94804),p=s(70203),g=s(97880),m=s(63143),f=s(50906),v=s(47839),y=s(75018),x=s(87531),S=s(81598),b=s(40824),C=(s(95477),s(34700)),M=s(73744),j=s(69988),w=s(98165),k=s(65598),I=s(48141),T=s(95697),P=s(74948),F=s(80444),R=s(77080),Z=s(32470),B=s(55320),A=s(92338),O=s(62965),L=s(29026);class D extends o.default{getInitialState(){return{insertedActionResultsCount:0,localResults:void 0,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,serverResultsAllLoaded:!1,errorState:E,selectedQueryResultQuery:void 0}}setState(e){const t={...this.instanceState};if(!(0,O.Z)(this.instanceState,t))return;const s=function(e){const{newState:t,priorState:s}=e,{localResults:r,serverError:i,serverResultsLoading:n,serverResults:o}=t,a=Boolean(r),l=n?void 0:i;if(!a&&n)return!s.errorState.isLoading&&s.errorState.showMajorError?s.errorState:{isLoading:n};if(a)return{hasLocalResults:a,serverError:l,isLoading:!1,showMajorError:!1};if(l)return{hasLocalResults:a,serverError:l,isLoading:!1,showMajorError:!0};if(0===(null==o?void 0:o.results.length))return{hasLocalResults:a,serverError:A.Ix.NoResults,isLoading:!1,showMajorError:!0};return{hasLocalResults:a,serverError:l,isLoading:!1,showMajorError:!1}}({newState:e,priorState:t});super.setState({...e,errorState:s})}getResultCount(){const{serverResults:e,localResults:t}=this.state,s=(null==e?void 0:e.total)??(null==t?void 0:t.total)??0,r=Boolean(e&&s>=100);return{count:s,isLowerBound:Boolean(e&&t&&s<L.Xv)||r}}}const E={showMajorError:!1,isLoading:!1,hasLocalResults:!1,serverError:void 0};const _=D;var q=s(30857),V=s(87956),N=s(88893),z=s(9019),H=s(55888),W=s(1924),K=s(85893);const U=120*m.C0,Q=r.createContext(null),$=r.createContext(null);class G extends i.Z{constructor(){super(...arguments),this.inactiveTimer=void 0,this.spaceId=void 0,this.isOpen=!1,this.shouldClearServerResultsOnQueryChange=!1,this.queryResultsSectionRef=r.createRef(),this.searchFilterMenuRef=r.createRef(),this.modalBodyMenuRef=r.createRef(),this.searchResultStore=new _,this.secondarySearchResultStore=new _,this.globalFocusedIndex=o.default.createValue(0),this.defaultBodyFocusedResult=o.default.createValue(void 0),this.searchActionItemsList=o.default.createValue([]),this.getStaticContext=c.HP((()=>({queryResultsSectionRef:this.queryResultsSectionRef,searchFilterMenuRef:this.searchFilterMenuRef,modalBodyMenuRef:this.modalBodyMenuRef,handleSelectResult:this.handleQueryResultSelect,handleRecentPageSelect:this.handleRecentPageSelect,handleQueryChange:this.handleQueryChange,searchResultStore:this.searchResultStore,secondarySearchResultStore:this.secondarySearchResultStore,globalFocusedIndex:this.globalFocusedIndex,defaultBodyFocusedResult:this.defaultBodyFocusedResult,searchActionItemsStore:this.searchActionItemsList,isQuickSearch:this.props.quickSearchMode}))),this.getStoresContext=c.HP((e=>({parentStore:e}))),this.renderContent=()=>{const e=this.currentMode.state;return(0,K.jsx)(Q.Provider,{value:this.getStaticContext(),children:(0,K.jsxs)($.Provider,{value:this.getStoresContext(this.props.parentStore),children:[this.props.quickSearchMode&&(0,K.jsx)("div",{style:{position:"absolute",height:W.$,width:"100%",...(0,C.X)({drag:!0})}}),"search"===e?(0,K.jsx)(H.$T,{renderAsPage:this.props.renderAsPage,quickSearchMode:this.props.quickSearchMode,onClose:this.handleComponentClose}):(0,K.jsx)(S.yX,{renderAsPage:this.props.renderAsPage,quickSearchMode:this.props.quickSearchMode,onClose:this.handleComponentClose})]})})},this.handleRecentPageSelect=e=>{this.handleSelectResult({...e,context:"recent_pages"})},this.handleQueryResultSelect=e=>{this.handleSelectResult({...e,context:"query_results"})},this.handleComponentOpenClose=()=>{const e=B.default.state.open||B.default.state.openAsPage;this.isOpen!==e&&(this.isOpen=e,(B.default.state.open||B.default.state.openAsPage)&&(clearTimeout(this.inactiveTimer),L.ZP.update((e=>({...e,hasScrolled:!1})))))},this.handleComponentClose=()=>{const{device:e}=this.environment,{selectedQueryResult:t,numKeystrokes:s,numServerRequests:r,numLocalRequests:i,hadMetaClick:n}=q.default.state,{serverEventProperties:o}=this.searchResultStore.state,{query:a,hasScrolled:l,mode:c}=L.ZP.state;if(s>0&&(r>0||i>0)&&!t&&!n&&(B.default.state.openAsPage||B.default.state.open)){const t=Date.now(),i=B.default.state.openedTimeMs,n=B.default.state.sessionId,a=q.default.state.firstKeyStrokeTimeMs;f.EH8(this.environment,{...o,timeToAbandonMs:t-i,timeFromFirstKeyStrokeToAbandonMs:a?t-a:void 0,numKeystrokes:s,numResultsAboveFold:this.getNumResultsAboveFold(),searchSessionId:n,searchSessionFlowNumber:r,hasScrolled:l,numLocalResults:this.getNumLocalResults(),numTotalLocalResults:this.getNumTotalLocalResults(),numVisibleMembers:(0,N.qX)(),isMobile:e.isMobile})}this.props.quickSearchMode?(B.default.reset(),t&&!n&&this.resetState(),v.closeQuickSearch()):x.IB(),"assistant"===c&&b.N.setAssistantLastViewedTime(),""===a.text.trim()&&"assistant"!==c&&L.ZP.reset();const u=R.default.getEligibleGroup({experimentId:"search-shorten-inactive-timer",defaultGroup:"control"});let h=U;"control"!==u&&d.g6["search-shorten-inactive-timer"].includes(u)&&(h=parseInt(u,10)*m.C0),this.inactiveTimer&&clearTimeout(this.inactiveTimer),h>0?this.inactiveTimer=window.setTimeout(this.resetState,h):this.resetState(),!this.props.renderAsPage&&e.isMobile&&P.close(),q.default.reset()},this.handleVisibilityChange=(e,t)=>{this.props.quickSearchMode&&(t?x.UT({environment:this.environment,analyticsFrom:"quick-search",isQuickSearch:!0,renderAsPage:!0}):this.handleComponentClose())},this.handleOpenFromQuickSearch=()=>{x.UT({environment:this.environment,analyticsFrom:"keyboard-shortcut-quick-search",isQuickSearch:!1,renderAsPage:!1})},this.handlePotentialWebSearchAbandon=e=>{this.props.renderAsPage&&this.handleComponentClose()},this.handleSelectResult=e=>{var t,s;let{action:r,sectionName:i,context:n,selectedResult:o,allSearchResults:d}=e;const{serverEventProperties:c,store:u}=o,{numKeystrokes:p,hadMetaClick:m}=q.default.state;if(!B.default.state.open&&!B.default.state.openAsPage)return;const{event:x}=r,S=M.DJ(x);"query_results"===n&&(q.default.update((e=>({...e,selectedQueryResult:!0}))),this.searchResultStore.update((e=>({...e,selectedQueryResultQuery:L.ZP.state.query}))));const b=Date.now(),{openedTimeMs:C,sessionId:j}=B.default.state,{firstKeyStrokeTimeMs:w}=q.default.state,{numServerRequests:k}=q.default.state,{query:T}=L.ZP.state,P=(0,N.qX)(),F=(null==d?void 0:d.filter((e=>{var t;return void 0!==(null===(t=e.matchedCollectionProperties)||void 0===t?void 0:t.collectionText)})).length)??0,R=(null==d?void 0:d.filter((e=>{var t;return void 0!==(null===(t=e.highlight)||void 0===t?void 0:t.collectionText)})).length)??0,Z=void 0!==(null===(t=o.matchedCollectionProperties)||void 0===t?void 0:t.collectionText),A=void 0!==(null===(s=o.highlight)||void 0===s?void 0:s.collectionText);f.nLf(this.environment,{...c,context:n,queryStringLength:T.text.trim().length,hasFilters:I.FN(T.filters),activeFilters:T.filters,selectedItemIndex:r.index,selectedItemLocalIndex:{sectionName:i,index:r.indexLocal.indexLocal},numKeystrokes:p,isMetaClick:Boolean(S),isSidebarOpen:L.ZP.isDebugSidebarOpen(),timeToSelectMs:b-C,timeFromFirstKeyStrokeToSelectMs:w?b-w:b-C,sources:null==o?void 0:o.sources,localSources:[...(null==o?void 0:o.localSource)??[]],indexInRecentPages:null==o?void 0:o.indexInRecentPages,timeSinceLastViewedMs:null==o?void 0:o.timeSinceLastViewedMs,hadMetaClick:m,numResultsAboveFold:this.getNumResultsAboveFold(),selectedSearchResultMetadata:this.getSearchResultMetadata(o),selectedSearchResultContent:void 0,allSearchResultMetadata:null==d?void 0:d.slice(0,G.MAX_RESULT_TO_TRACK).map((e=>this.getSearchResultMetadata(e))),totalSearchResultCount:null==d?void 0:d.length,searchSessionId:j,searchSessionFlowNumber:k,originalPosition:null==o?void 0:o.originalPosition,numLocalResults:this.getNumLocalResults(),numTotalLocalResults:this.getNumTotalLocalResults(),numVisibleMembers:P,isMobile:this.environment.device.isMobile,resultWithCollectionPropertyMatchCount:F,resultWithCollectionPropertyHighlightCount:R,isCollectionPropertyMatch:Z,isCollectionPropertyHighlight:A});const O=(null==c?void 0:c["server-queryId"])??(0,h.A7)({searchSessionId:j,searchSessionFlowNumber:k});let D;"recent_pages"===n?D=a.tY.SearchRecents:"query_results"===n?D=a.tY.SearchQuery:(0,g.t1)(n);if(this.environment.device.isElectron&&this.props.quickSearchMode){const e=(0,l.Z)({pageModel:o.store.getModel(),pageId:o.store.id,scrollToBlockId:(0,I.dy)(o),pageVisitSource:D});v.openQuickSearchResult(e)}else y.navigateToSearchResult({searchResult:o,environment:this.environment,pageVisitSource:D,queryId:O,openInNew:S,openInSidePeek:false});V.Z.setState({queryId:O,pageId:u.id,timeEntered:new Date}),S?q.default.update((e=>({...e,hadMetaClick:!0}))):this.handleComponentClose()},this.handleQueryChange=e=>{this.shouldClearServerResultsOnQueryChange&&(this.searchResultStore.update((e=>({...e,serverResults:void 0}))),this.secondarySearchResultStore.update((e=>({...e,serverResults:void 0})))),""!==e?(q.default.update((e=>({...e,numKeystrokes:e.numKeystrokes+1}))),L.ZP.updateQueryText(e)):L.ZP.resetQuery({resetFilters:!1})},this.getNumResultsAboveFold=()=>I.MQ({environment:this.environment,searchResultsSection:this.queryResultsSectionRef.current,modalBodyMenu:this.modalBodyMenuRef.current,searchFilterMenu:this.searchFilterMenuRef.current}),this.getNumLocalResults=()=>{var e;return(null===(e=this.searchResultStore.state.localResults)||void 0===e?void 0:e.results.length)??0},this.getNumTotalLocalResults=()=>{var e;return(null===(e=this.searchResultStore.state.localResults)||void 0===e?void 0:e.total)??0},this.getSearchResultMetadata=e=>{const{store:t,highlight:s,sources:r,localSource:i}=e;return n.Z.withListenerIgnored((()=>{var n,o,a,l,d;return{blockId:t.id,blockType:t.getType(),lowestNavigableAncestorId:null===(n=t.getNavigableBlockStore())||void 0===n?void 0:n.id,depth:w.qA(t).length,matchesText:Boolean(null==s?void 0:s.text),matchesPathText:Boolean((null==s?void 0:s.pathText)||(null==s?void 0:s.title)),matchesTitle:Boolean(null==s?void 0:s.title),isNavigable:t.isNavigableBlock(),lastEditedTime:t.getLastEditedTime(),isTeamArchived:null===(o=(0,w.VP)(t))||void 0===o?void 0:o.isArchived(),sources:r,localSource:[...i??[]],badges:(null===(a=e.badges)||void 0===a?void 0:a.map((e=>e.type)))??[],isCollectionPropertyMatch:void 0!==(null===(l=e.matchedCollectionProperties)||void 0===l?void 0:l.collectionText),isCollectionPropertyHighlight:void 0!==(null===(d=e.highlight)||void 0===d?void 0:d.collectionText),featureGroups:e.featureGroups}}))},this.getPathText=e=>{const t=[];return w.uJ(e).forEach((e=>{if(k.OY(e)){var s;const r=(0,p.QaF)(null===(s=e.getNavigableBlockStore())||void 0===s?void 0:s.getTitleValue());r&&t.push(r)}else if((0,T.bq)()&&k.Y(e)){const s=e.getName();s&&t.push(s)}})),t},this.handleSpaceChange=()=>{const e=F.default.state.currentSpaceStore&&F.default.state.currentSpaceStore.id;this.spaceId!==e&&(this.spaceId=e,this.resetState())},this.resetState=()=>{L.ZP.reset(),B.default.reset(),this.searchResultStore.reset(),this.secondarySearchResultStore.reset(),q.default.reset()},this.currentMode=this.createComputedStore((()=>L.ZP.state.mode))}willMount(e){var t;this.spaceId=null===(t=F.default.state.currentSpaceStore)||void 0===t?void 0:t.id,this.shouldClearServerResultsOnQueryChange="on"===R.default.getGroup("search-clear-results-on-query-change"),(0,Z.lO)(),F.default.state.currentUserStore&&e.quickSearchMode&&v.quickSearchReady()}willMountOrUpdate(e){if(e.renderAsPage&&!e.quickSearchMode&&!B.default.state.sessionId){const e=(0,u.ZP)();B.default.update((t=>({...t,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:e}))),f.wFN(this.environment,{from:"nativeTab-search-direct-link",searchSessionId:e})}}didMount(){F.default.addListener(this.handleSpaceChange),this.props.renderAsPage&&!this.props.quickSearchMode||B.default.addListener(this.handleComponentOpenClose),this.props.quickSearchMode?v.quickSearchVisibilityState.addListener(this.handleVisibilityChange):v.openSearchModalFromQuickSearch.addListener(this.handleOpenFromQuickSearch),y.potentialWebSearchAbandonEventEmitter.addListener(this.handlePotentialWebSearchAbandon)}willUnmount(){this.resetState(),this.props.renderAsPage&&!this.props.quickSearchMode||(B.default.removeListener(this.handleComponentOpenClose),v.openSearchModalFromQuickSearch.removeListener(this.handleOpenFromQuickSearch)),this.props.quickSearchMode&&v.quickSearchVisibilityState.removeListener(this.handleVisibilityChange),y.potentialWebSearchAbandonEventEmitter.removeListener(this.handlePotentialWebSearchAbandon),F.default.removeListener(this.handleSpaceChange),this.inactiveTimer&&(clearTimeout(this.inactiveTimer),this.inactiveTimer=void 0)}renderComponent(){if(this.props.renderAsPage)return this.renderContent();const{device:e,mobileNative:t}=this.environment,s=Boolean(B.default.state.open);return(0,K.jsx)(z.Z,{open:s,onDismiss:this.handleComponentClose,modalStyle:this.getModalStyle(),disableAnimation:!e.isMobile||(null==t?void 0:t.supportsNativeHomeOnPhone())||!1,renderContent:this.renderContent})}getPublicAccessPermissionForPage(){return I.bC(this.environment)}getSearchResultContent(e,t){return n.Z.withListenerIgnored((()=>{var s;return{title:(0,p.QaF)(null===(s=e.getNavigableBlockStore())||void 0===s?void 0:s.getTitleValue()),pathText:this.getPathText(e),highlight:{text:(0,j.fe)(null==t?void 0:t.text),pathText:(0,j.fe)(null==t?void 0:t.pathText)}}}))}getModalStyle(){const{renderAsPage:e}=this.props,t=Boolean(L.ZP.state.query.text.trim())||I.VA(L.ZP.state.query.filters),s=(0,H.ip)({hasQuery:t,renderAsPage:e,environment:this.environment});return{width:"100%",minHeight:s.minHeight,maxHeight:s.maxHeight,transform:"translate3d(0,0,0)",background:this.theme.popoverBackground,maxWidth:this.getMaxWidth(),borderRadius:12}}getMaxWidth(){const e=(0,Z.gq)({device:this.environment.device}),t=(0,H.X1)({device:this.environment.device,isPublicAccessPermissionForPage:this.getPublicAccessPermissionForPage().hasPublicAccessPermission});if(e)return"90vw";if(x.yt())return 700;let s=660;return t&&(s+=250),s}}G.displayName="Search",G.MAX_RESULT_TO_TRACK=50;const J=G},55888:(e,t,s)=>{s.d(t,{$T:()=>di,ip:()=>ui,X1:()=>mi});var r=s(67294),i=s(480),n=s(86628),o=s(24405),a=s(72126),l=s(29477),d=s(80503),c=s(98730),u=s(87531),h=s(43250),p=s(87279),g=s(48141),m=s(85665),f=s(5162),v=s(80444),y=s(21273),x=s(88632),S=s(69454),b=s(32470),C=s(55320),M=s(29026),j=s(36488),w=s(56940),k=s(78140),I=s(40721),T=s(83785),P=s(22715),F=s(33991),R=s(83355),Z=s(12174),B=s(67220),A=s(69651),O=s(64275),L=s(6637),D=s(60291),E=s(37612),_=s(83303),q=s(53772),V=s(97880),N=s(82990),z=s(5366),H=s(95477),W=s(95697),K=s(61766),U=s(77080),Q=s(23063),$=s(64921),G=s(52275),J=s(31945),X=s(60458),Y=s(89728),ee=s(72495),te=s(93481),se=s(84619),re=s(90028),ie=s(21202),ne=s(31299),oe=s(33929),ae=s(15447),le=s(35661),de=s(31278),ce=s(11470),ue=s(76798),he=s(255),pe=s(85567),ge=s(8319),me=s(85893);const fe=(0,z.defineMessages)({searchPages:{defaultMessage:"Search pages",id:"searchPageFilter.searchTokenFilter.tokenInput.placeholder"},selectAPage:{defaultMessage:"Select a page",id:"searchPageFilter.searchTokenFilter.resultSection.title"}});class ve extends R.Z{constructor(){super(...arguments),this.renderFilterListItem=(e,t)=>{let{disabled:s,onRemove:r,onClick:i}=t;const n=this.styles,o=this.createBlockStore(e),a=(0,me.jsx)(he.Z,{disabled:s,onClick:r});return(0,me.jsx)(ce.Z,{disabled:s,focused:!1,store:o,right:a,style:n.menuItem,desktopTitleStyle:n.menuItemTitle,onClick:i})},this.renderItemForSummary=e=>(0,me.jsx)(ue.Z,{store:this.createBlockStore(e),shouldWrap:!0,maxLength:50}),this.renderToken=(e,t)=>{const{blockIds:s}=this.props,r=this.tokenStyles,i=1===s.length,n=this.createBlockStore(e),o=(0,me.jsxs)("div",{style:r.token,children:[(0,me.jsx)(de.Z,{disabled:!0,icon:n.getIcon(),isEmptyPage:!1,size:20,style:r.icon}),(0,me.jsx)(ue.Z,{store:n})]});return(0,me.jsx)(pe.Z,{format:this.environment.device.isMobile?se.l.Large:se.l.Small,value:o,showRemoveButton:!0,onClickRemove:t.onRemove,isSingle:i,shouldShrink:!0,backgroundColor:"transparent",shouldWrap:!1},e)},this.renderResultMenuItem=(e,t)=>{const s=this.createBlockStore(e);return(0,r.createElement)(ce.Z,{...t,key:e,store:s})},this.performRequest=async e=>{let{query:t,current:s}=e;const{currentSpaceStore:r}=v.default.state;if(!r)return[];const i=t?(await ne.nJ({environment:this.environment,query:t,limit:20,spaceId:r.id,requireEditPermissions:!1,excludeTemplates:!1,source:"ancestor_filter_page_search",boostRecentlyViewedPages:!0})).results:ae.X4.state.map((e=>e.pageId)),n=new Set(s);return i.filter((e=>!n.has(e)))},this.createBlockStore=e=>{const{parentStore:t}=this.props;return le.G.createChildStore(t,{table:ie.iU,id:e})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{fill:"currentColor"}},this.tokenStyles={token:{display:"flex",alignItems:"center"},icon:{marginRight:4}}}renderComponent(){const{mode:e,title:t,blockIds:s,onChange:r,disabled:i,focused:n,onMenuDismiss:o}=this.props;return(0,me.jsx)(ge.Z,{mode:e,hasItemsSelected:(null==s?void 0:s.length)>0,title:t,icon:re.j,iconStyles:this.styles.recordIcon,items:s,onChange:r,focused:n,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Add another page",id:"searchPageFilter.searchTokenFilter.addAPage.button"}),labelText:{title:t,tokenInputPlaceholder:oe.default.formatMessage(fe.searchPages),componentDebugName:"SearchPageFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,disabled:i,onMenuDismiss:o})}}ve.displayName="SearchPageFilter";const ye=ve;var xe=s(83890),Se=s(88507),be=s(29369),Ce=s(92338),Me=s(30397),je=s(93044),we=s(30676);class ke extends R.Z{constructor(){super(...arguments),this.renderFilterListItem=(e,t)=>{let{disabled:s,onRemove:r,onClick:i}=t;const n=this.styles,o=this.createTeamStore(e),a=(0,me.jsx)(he.Z,{disabled:s,onClick:r});return(0,me.jsx)(we.F,{disabled:s,focused:!1,teamStore:o,right:a,style:n.menuItem,desktopTitleStyle:n.menuItemTitle,onClick:i},e)},this.renderItemForSummary=e=>this.createTeamStore(e).getName(),this.renderAvatarFactory=e=>{const t=e.getIcon();return e=>(0,me.jsx)(de.Z,{disabled:!0,icon:t,isEmptyPage:!1,size:e})},this.renderToken=(e,t)=>{const{teamIds:s}=this.props,r=(0,Ce.iY)(s),i=1===(null==r?void 0:r.length),n=this.createTeamStore(e);if(!n)return;const o=n.getName();return(0,me.jsx)(je.ZP,{format:this.environment.device.isMobile?je.lP.Large:je.lP.Small,showRemoveButton:!0,isSingle:i,onClickRemove:t.onRemove,renderAvatar:this.renderAvatarFactory(n),title:o,style:{background:"transparent"}},e)},this.renderResultMenuItem=(e,t)=>{const s=this.createTeamStore(e);return(0,r.createElement)(we.F,{...t,key:e,teamStore:s})},this.performRequest=async e=>{var t;let{query:s,current:r}=e;const i=new Set(r),n=v.default.state.currentSpaceViewStore,o=v.default.state.currentSpaceStore,a=null===(t=v.default.state.currentUserStore)||void 0===t?void 0:t.id;if(!n||!o||!a)return[];if(!s){const e=new Set(n.getTeamsStores().map((e=>e.id)));if(Me.Z.state.teams.map((e=>e.id)).forEach((t=>e.add(t))),e.size>0)return[...e]}const l=await(0,W.qX)({environment:this.environment,spaceStore:o,currentUserId:a});return(await ne.zf({query:s,spaceViewStore:n,teamStores:l})).filter((e=>!i.has(e.id))).slice(0,20).map((e=>e.id))},this.createTeamStore=e=>{const{parentStore:t}=this.props;return le.zX.createChildStore(t,{table:be.e0,id:e})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:6,fill:"currentColor"}}}renderComponent(){const{mode:e,title:t,teamIds:s,onChange:r,disabled:i,focused:n,onMenuDismiss:o,intl:a}=this.props,l=(0,Ce.iY)(s);return(0,me.jsx)(ge.Z,{mode:e,title:t,icon:Se.I,iconStyles:this.styles.recordIcon,items:l||[],onChange:r,disabled:i,focused:n,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Add a teamspace",id:"search.filterMenu.addATeamButton.label"}),labelText:{title:t,tokenInputPlaceholder:a.formatMessage({defaultMessage:"Search teamspaces",id:"search.filterMenu.searchTeams.placeholder"}),componentDebugName:"SearchTeamFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,onMenuDismiss:o,hasItemsSelected:Boolean(l&&(null==l?void 0:l.length)>0)})}}ke.displayName="SearchTeamFilter";const Ie=(0,z.injectIntl)(ke);var Te=s(33338),Pe=s(86825),Fe=s(75689),Re=s(91642);class Ze extends R.Z{constructor(){super(...arguments),this.handleToggle=()=>{const{value:e,onChange:t}=this.props;t(!e)},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},sectionMenuItem:{display:"flex"}}}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){return(0,me.jsx)(Re.Z,{marginAfter:!1,style:this.styles.sectionMenuItem,children:this.renderSwitcherMenuItem(e)})}renderMobile(e){const{title:t,value:s,disabled:r}=this.props;return e===ge.z.Button?this.renderSwitcherMenuItem(e):(0,me.jsx)(Fe.Z,{disabled:r,onClick:this.handleToggle,label:t,isToggle:!0,isToggleActive:s})}renderSwitcherMenuItem(e){const{title:t,icon:s,value:r,style:i,...n}=this.props,o=this.styles,a=this.getThemeColors(),l={...o.menuItem,...a.menuItem,...i};return e===ge.z.Pill?(0,me.jsx)(Te.Z,{on:r,hideChevron:!0,title:(0,me.jsx)("span",{children:t}),onClick:this.handleToggle,icon:s(o.pillIcon)}):(0,me.jsx)(Pe.Z,{title:t,icon:s(o.icon),on:r,onClick:this.handleToggle,style:l,...n})}getThemeColors(){return{menuItem:{color:this.theme.mediumTextColor}}}}Ze.displayName="SearchToggleFilter",Ze.Mode=ge.z;const Be=Ze;var Ae=s(8848),Oe=s(42853),Le=s(32163);function De(e){window.__c={n:"SearchExperimentFilterPopupButton"};const t=(0,i.Fy)();return(0,me.jsx)(J.ZP,{popupType:t.isMobile?J.Z4.SlideUp:J.Z4.Popup,renderOrigin:t=>(0,me.jsx)(_e,{events:t,...e}),render:t=>(0,me.jsx)(Ee,{parent:t,...e})})}function Ee(e){let{parent:t,experiment:s,searchExperimentOverrides:r,onChange:n}=e;window.__c={n:"SearchExperimentFilterMenu"};const a=(0,i.Fy)(),l=(0,o.yK)((()=>({menuOptionStyle:{color:Ae.ZP.mediumTextColor}})),[]);let d;d=a.isMobile?{menuType:p.og.Modal,title:s.experimentId,right:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:t.close}:{menuType:p.og.Popup,width:250};const c=s.groups.map((e=>({key:e,action:r=>{n({experimentId:s.experimentId,group:e}),t.close()},render:(t,s)=>(0,me.jsx)(G.Z,{...t,title:e,style:l.menuOptionStyle})})));return(0,me.jsx)(k.Z,{...d,children:(0,me.jsx)(Le.Z,{type:Le.i.Vertical,initialFocus:void 0,sections:[{key:s.experimentId,render:e=>(0,me.jsx)(ee.Z,{...e}),items:c}]})})}function _e(e){let{experiment:t,events:s,searchExperimentOverrides:i}=e;window.__c={n:"SearchExperimentFilterMenuButton"};const n=(0,o.yK)((e=>({experimentGroupButtonChevronStyle:{width:10,fill:e.lightIconColor},experimentGroupButtonStyle:{overflowX:"hidden",justifyContent:"left",overflow:"hidden",marginLeft:6,color:e.mediumTextColor},rowContainer:{display:"flex",overflow:"hidden",flexDirection:"row"},groupCell:{overflow:"hidden",marginRight:4}})),[]);return(0,r.createElement)(Y.Z,{...s,isSmall:!0,key:t.experimentId,style:n.experimentGroupButtonStyle},(0,me.jsxs)("div",{style:n.rowContainer,children:[(0,me.jsx)("div",{style:n.groupCell,children:i[t.experimentId]||t.group}),(0,me.jsx)("div",{children:(0,Oe.i)(n.experimentGroupButtonChevronStyle)})]}))}const qe=e=>({fontSize:14,lineHeight:1.2,color:e.mediumTextColor,marginRight:4,display:"flex",alignItems:"center",whiteSpace:"nowrap"}),Ve=function(e){window.__c={n:"SearchExperimentFilter"};const{experiment:t}=e,{leftOverrides:s,rightOverrides:i,experimentDiffers:a,experimentAgreesButNondefault:l}=(0,n.VK)((()=>{const e=b.v_.state.searchExperimentOverrides,s=b.BJ.state.searchExperimentOverrides,r=(e[t.experimentId]??t.group)!==(s[t.experimentId]??t.group);return{leftOverrides:e,rightOverrides:s,experimentDiffers:r,experimentAgreesButNondefault:!r&&void 0!==s[t.experimentId]&&e[t.experimentId]!==t.group}}),[t]),d=(0,o.yK)((e=>({rowContainer:{backgroundColor:a?e.equationErrorPlaceholderBackground:l?e.accentColors.yellow[100]:void 0},titleCell:{...qe(e),maxWidth:180,textOverflow:"ellipsis",overflow:"hidden"}})),[l,a]),c=(0,r.useCallback)((e=>{const{experimentId:t,group:s,store:r}=e;r.setState({...r.state,searchExperimentOverrides:{...r.state.searchExperimentOverrides,[t]:s}})}),[]);return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)("div",{style:{...d.titleCell,...d.rowContainer},children:t.experimentId.replace("search-","")}),(0,me.jsx)("div",{style:d.rowContainer,children:(0,me.jsx)(De,{experiment:t,searchExperimentOverrides:s,onChange:e=>{c({...e,store:b.v_})}})}),(0,me.jsx)("div",{style:d.rowContainer,children:(0,me.jsx)(De,{experiment:t,searchExperimentOverrides:i,onChange:e=>{c({...e,store:b.BJ})}})})]})};var Ne=s(53877),ze=s(42875),He=s(22686);let We=function(e){return e[e.Button=0]="Button",e[e.MenuItem=1]="MenuItem",e}({});class Ke extends R.Z{constructor(){super(...arguments),this.handleFilterClick=e=>{const{onMenuDismiss:t}=this.props;this.applyFilter(e),this.openSidebar(),t&&t()},this.applyFilter=e=>{M.ZP.updateFilters(e)},this.openSidebar=()=>{M.ZP.isDebugSidebarOpen()||M.ZP.setState({...M.ZP.state,isDebugSidebarOpen:!0})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},buttonFilter:{padding:"4px 8px",display:"flex",alignItems:"center",overflow:"hidden"},buttonText:{...N.Z.textOverflowStyle},icon:{display:"inline-block",height:14,width:14,fill:"currentColor"},buttonIcon:{marginRight:6}}}renderComponent(){const{mode:e}=this.props;return e===We.Button?this.renderAsButton():e===We.MenuItem?this.renderAsMenuItem():void(0,V.t1)(e)}renderAsButton(){const{icon:e,title:t,filter:s}=this.props,r=this.styles,i=this.getThemeColors();return(0,me.jsxs)($.Z,{style:{...r.buttonFilter,...i.buttonFilter},onClick:()=>this.handleFilterClick(s),children:[e&&e({...r.icon,...r.buttonIcon}),(0,me.jsx)("span",{style:r.buttonText,children:t})]})}renderAsMenuItem(){const{icon:e,title:t,filter:s,focused:r}=this.props,i=this.styles,n=this.getThemeColors(),o={...i.menuItem,...n.menuItem};return(0,me.jsx)(G.Z,{icon:e&&e(i.icon),focused:r,title:t,onClick:()=>this.handleFilterClick(s),style:o})}getThemeColors(){const{device:e}=this.environment;return{menuItem:{color:e.isDesktop?this.theme.mediumTextColor:void 0,...this.props.isLastInSection&&{boxShadow:void 0}},buttonFilter:{color:this.theme.mediumTextColor}}}}Ke.displayName="SearchFilterPreset",Ke.Mode=We;class Ue extends R.Z{renderComponent(){const e=Ue.getCurrentPageFilter();if(e)return(0,me.jsx)(Ke,{icon:re.j,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.quickFilters.inCurrentPage",defaultMessage:"In current page"}),filter:e,...this.props})}static isActive(e){const t=Ue.getCurrentPageFilter();if(!t)return!1;if(!t.ancestors)return!1;const s=t.ancestors[0];return-1!==e.ancestors.indexOf(s)}}Ue.displayName="InCurrentPagePreset",Ue.getCurrentPageFilter=()=>{const{mainEditorCurrentBlockStore:e}=v.default.state;if(e&&e.id)return{ancestors:[e.id]}};class Qe extends R.Z{renderComponent(){const e=Qe.getCurrentUserFilter(this.environment);if(e)return(0,me.jsx)(Ke,{icon:He.f,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.quickFilters.createdByMe",defaultMessage:"Created by me"}),filter:e,...this.props})}static isActive(e,t){const s=Qe.getCurrentUserFilter(e);if(!s)return!1;if(!s.createdBy)return!1;const r=s.createdBy[0];return-1!==t.createdBy.indexOf(r)}}Qe.displayName="CreatedByMePreset",Qe.getCurrentUserFilter=e=>{const{id:t}=e.currentUser;if(t)return{createdBy:[t]}};class $e extends R.Z{renderComponent(){const e=$e.getPastWeekFilter();if(e)return(0,me.jsx)(Ke,{icon:A.C,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.quickFilters.editedLastWeek",defaultMessage:"Edited last week"}),filter:e,...this.props})}static isActive(e){const{lastEditedTime:t}=$e.getPastWeekFilter();return a.Xy(t,e.lastEditedTime)}}$e.displayName="EditedLastWeekPreset",$e.getPastWeekFilter=()=>({lastEditedTime:{starting:Ne.Oo((0,ze.r)()),ending:Ne.Lg((0,ze.r)())}});var Ge=s(1743),Je=s(74194);function Xe(e){window.__c={n:"SearchStringOverrideControls"};const{leftValue:t,rightValue:s,setLeftValue:i,setRightValue:n,placeholder:a,label:l}=e,{titleCell:d,rightTitleCell:c,leftTitleCell:u}=(0,o.yK)((e=>{const r=qe(e);return{titleCell:r,rightTitleCell:{...r,color:s?r.color:e.lightTextColor,width:"95%"},leftTitleCell:{...r,color:t?r.color:e.lightTextColor,width:"95%"}}}),[t,s]),[h,p]=(0,r.useState)(s),[g,m]=(0,r.useState)(t);(0,r.useEffect)((()=>{void 0===s&&p(void 0),void 0===t&&m(void 0)}),[s,t]);const f=(0,r.useCallback)((()=>{n(h)}),[n,h]),v=(0,r.useCallback)((()=>{i(g)}),[i,g]),y=(0,r.useCallback)((e=>{p(e.target.value)}),[]),x=(0,r.useCallback)((e=>{m(e.target.value)}),[]);return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)("div",{style:d,children:l}),(0,me.jsxs)(Ge.Z,{capture:!0,allowMenuList:!1,children:[(0,me.jsx)(Je.Z,{style:u,onBlur:v,value:g,onChange:x,placeholder:a}),(0,me.jsx)(Je.Z,{style:c,onBlur:f,value:h,onChange:y,placeholder:a})]})]})}let Ye=function(e){return e.Button="Button",e.Section="Section",e}({});class et extends R.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:K.Z},this.renderAddFilterOrigin=e=>{const t=this.styles;return(0,me.jsx)(Y.Z,{...e,style:t.addFilterButtonMobile,icon:L.I,isBlue:!0,children:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Add filter",id:"search.addFilter.button.label"})})},this.renderAddFilterMenu=()=>(0,me.jsxs)(k.Z,{menuType:p.og.ActionSheet,children:[this.renderSuggestedFilters(),(0,me.jsxs)(Re.Z,{title:this.renderMoreFiltersTitle(),children:[this.renderCreatedByFilter(ge.Z.Mode.Button),this.renderCreatedTimeFilter(ge.Z.Mode.Button),this.renderLastEditedTimeFilter(ge.Z.Mode.Button),this.renderAncestorFilter(ge.Z.Mode.Button),this.renderInTeamFilter(ge.Z.Mode.Button)]})]}),this.searchExperimentsToToggle=this.createComputedStore((()=>Object.entries(Z.g6).map((e=>{let[t,s]=e;return{experimentId:t,experimentVersion:1,group:U.default.getGroup(t),groups:["control",...s]}})))),this.closeAddFilterMenu=()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})},this.callTitleFilterUpdateFns=e=>{M.ZP.updateFilters({navigableBlockContentOnly:e})},this.closeSidebar=()=>M.ZP.setState({...M.ZP.state,isDebugSidebarOpen:!1,isSidePeekPanelOpen:u.ih(this.environment)}),this.styles={sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 250px",minHeight:400},sidebarHidden:{display:"none"},addFilterButtonMobile:{fontSize:this.props.isMobile?N.Z.fontSize.UISmall.mobile:N.Z.fontSize.UISmall.desktop,fontWeight:N.Z.fontWeight.medium,marginRight:-8}}}renderComponent(){return this.props.isMobile?this.props.mode===Ye.Button?this.renderAddButtonMobile():this.props.mode===Ye.Section?this.renderActiveFiltersMobile():void(0,V.t1)(this.props.mode):this.renderSidebar()}renderActiveFiltersMobile(){const{state:e}=M.ZP,t=g.De(e.query.filters);return(0,me.jsxs)(ee.Z,{disableMobilePadding:!0,disableMobileBorders:!0,children:[this.renderTitlesOnlyFilter(ge.z.Section),this.renderDeletedOnlyFilter(ge.z.Section),this.renderActiveFilters(t,ge.Z.Mode.Section)]})}renderAddButtonMobile(){const{buttonPopupStore:e}=this.stores;return(0,me.jsx)(J.ZP,{popupType:J.Z4.SlideUp,buttonPopupStore:e,renderOrigin:this.renderAddFilterOrigin,render:this.renderAddFilterMenu})}renderActiveFilters(e,t){return(0,me.jsxs)(r.Fragment,{children:[e.createdBy&&this.renderCreatedByFilter(t),e.createdTime&&this.renderCreatedTimeFilter(t),e.lastEditedTime&&this.renderLastEditedTimeFilter(t),e.ancestors&&this.renderAncestorFilter(t),e.inTeams&&this.renderInTeamFilter(t)]})}renderSuggestedFilters(){const{filters:e}=M.ZP.state.query,t=Qe.isActive(this.environment,e),s=$e.isActive(e),r=Ue.isActive(e);if(!(t&&s&&r))return(0,me.jsxs)(Re.Z,{title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.quickFiltersSection.title",defaultMessage:"Quick filters"}),marginAfter:!0,children:[!t&&(0,me.jsx)(Qe,{mode:We.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!s&&(0,me.jsx)($e,{mode:We.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!r&&(0,me.jsx)(Ue,{mode:We.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu,isLastInSection:!0})]})}renderSidebar(){const e=this.styles,t=this.getThemeColors(),s={...e.sidebar,...t.sidebar,...!M.ZP.isDebugSidebarOpen()&&e.sidebarHidden};return(0,me.jsxs)("aside",{style:s,children:[(0,me.jsx)($.Z,{onClick:this.closeSidebar,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16,position:"absolute",top:10,right:10},children:(0,O.D)({width:14,fill:this.theme.mediumTextColor})}),this.renderDevToolsSection()]})}renderForcedClusterPatternInput(){return null}renderShowDebugInfoToggle(){return(0,me.jsx)(Be,{mode:ge.z.Button,focused:!1,title:"Show debug info",icon:B.S,value:b.ZP.state.showDebugInfo,onChange:e=>{b.ZP.setState({...b.ZP.state,showDebugInfo:Boolean(e)})}})}renderShowDebugSearchToggle(){return(0,me.jsx)(Be,{mode:ge.z.Button,focused:!1,title:"Profile query",icon:B.S,value:"everything"===b.ZP.state.debug,onChange:e=>{b.ZP.setState({...b.ZP.state,debug:e?"everything":void 0})}})}renderDevToolsSection(){if((0,q.x)(H.default))return(0,me.jsx)(Re.Z,{title:"Dev Tools",children:(0,me.jsx)(Q.Z,{isVisible:!0,animationStyle:{height:"100%"},render:()=>(0,me.jsxs)("div",{style:{overflow:"scroll"},children:[this.renderShowDebugInfoToggle(),this.renderShowDebugSearchToggle(),this.renderForcedClusterPatternInput(),(0,me.jsxs)(Re.Z,{style:{marginTop:16},title:"Quick Switch",children:[(0,me.jsx)(st,{title:"No local at all",searchExperimentOverrides:{"search-no-local-blending":"on","search-debug-only-no-recent-boosting":"on"}}),(0,me.jsx)(st,{title:"No local results",searchExperimentOverrides:{"search-no-local-blending":"on"}}),(0,me.jsx)(st,{title:"No local boosting",searchExperimentOverrides:{"search-debug-only-no-recent-boosting":"on"}}),(0,me.jsx)(st,{title:"Vector only",searchExperimentOverrides:{"search-vectors":"log-norm"}})]}),(0,me.jsx)(Re.Z,{style:{marginTop:16},title:"Dev Experiments",right:(0,me.jsx)(Y.Z,{onClick:()=>{b.v_.reset(),b.BJ.reset()},style:{paddingLeft:0,paddingRight:0,height:"unset"},children:(0,D.b)({width:12})}),children:(0,me.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr 1fr",minWidth:"100%",maxWidth:"100%",paddingLeft:14},children:[(0,me.jsx)("div",{}),(0,me.jsx)("div",{}),(0,me.jsx)(tt,{columnStore:b.BJ}),this.searchExperimentsToToggle.state.map((e=>(0,me.jsx)(Ve,{experiment:e},e.experimentId))),(0,me.jsx)(Xe,{leftValue:b.v_.state.forcedClusterPattern,rightValue:b.BJ.state.forcedClusterPattern,setLeftValue:b.v_.updateForcedClusterPattern,setRightValue:b.BJ.updateForcedClusterPattern,placeholder:"cluster-pattern",label:"forced cluster pattern"}),(0,me.jsx)(Xe,{leftValue:b.v_.state.forcedBlockIds,rightValue:b.BJ.state.forcedBlockIds,setLeftValue:b.v_.updateForcedBlockIds,setRightValue:b.BJ.updateForcedBlockIds,placeholder:"block ids",label:"forced block ids"})]})})]})})})}renderTitlesOnlyFilter(e){const{filters:t}=M.ZP.state.query;return(0,me.jsx)(Be,{mode:e,focused:!1,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"}),icon:_.c,value:t.navigableBlockContentOnly||!1,onChange:this.callTitleFilterUpdateFns})}renderDeletedOnlyFilter(e){const{filters:t}=M.ZP.state.query;return(0,me.jsx)(Be,{mode:e,focused:!1,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.deletedOnlyToggle.label",defaultMessage:"Deleted only"}),icon:E.y,value:t.isDeletedOnly||!1,onChange:this.createUpdateFunction("isDeletedOnly")})}renderMoreFiltersTitle(){return(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFiltersSection.title",defaultMessage:"More filters"})}renderAncestorFilter(e){const{filters:t}=M.ZP.state.query;return(0,me.jsx)(F.SearchStoresContext.Consumer,{children:s=>{let{parentStore:r}=s;return(0,me.jsx)(ye,{mode:e,focused:!1,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"}),parentStore:r,blockIds:t.ancestors,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("ancestors")})}})}renderCreatedByFilter(e){const{filters:t}=M.ZP.state.query;return(0,me.jsx)(F.SearchStoresContext.Consumer,{children:s=>{let{parentStore:r}=s;return(0,me.jsx)(xe.Z,{mode:e,focused:!1,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.createdBy",defaultMessage:"Created by"}),parentStore:r,userIds:t.createdBy,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdBy")})}})}renderCreatedTimeFilter(e){const{filters:t}=M.ZP.state.query;return(0,me.jsx)(te.Z,{mode:e,focused:!1,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"}),icon:A.C,value:t.createdTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdTime")})}renderLastEditedTimeFilter(e){const{filters:t}=M.ZP.state.query;return(0,me.jsx)(te.Z,{mode:e,focused:!1,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),icon:A.C,value:t.lastEditedTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("lastEditedTime")})}renderInTeamFilter(e){if(!(0,W.bq)())return;const{filters:t}=M.ZP.state.query;return(0,me.jsx)(F.SearchStoresContext.Consumer,{children:s=>{let{parentStore:r}=s;return(0,me.jsx)(Ie,{mode:e,focused:!1,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"}),parentStore:r,teamIds:t.inTeams,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("inTeams")})}})}createUpdateFunction(e){return t=>M.ZP.updateFilters({[e]:t})}getThemeColors(){return{sidebar:{backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:`1px solid ${this.theme.regularDividerColor}`}}}}function tt(e){let{columnStore:t}=e;window.__c={n:"ExperimentColumnShowHeader"};const s=(0,n.VK)((()=>t.state.visible),[t]);return(0,me.jsx)(G.Z,{icon:(0,me.jsx)(X.Z,{checked:s,size:14,onClick:()=>t.update((e=>({...e,visible:!e.visible})))}),focused:!1,title:"Show",onClick:()=>t.update((e=>({...e,visible:!e.visible})))})}function st(e){let{title:t,searchExperimentOverrides:s}=e;return(0,me.jsx)(G.Z,{focused:!1,title:t,onClick:()=>{b.BJ.update((e=>({...e,visible:!1}))),b.v_.update((e=>({...e,searchExperimentOverrides:s})))}})}et.displayName="SearchFilterMenu";const rt=et;var it=s(28992),nt=s(98519),ot=s(4023),at=s(7931);const lt=function(e){window.__c={n:"SearchSortMenu"};const t=r.useRef(),s=(0,i.Fy)(),{isMobile:n}=s,{activeOption:a,items:l}=r.useMemo((()=>function(e){const{currentSortBy:t,setSortBy:s,sortOptions:r,selectButton:i}=e;let n=r[0];const o=r.map((e=>{const r=t.field,o=`${r}.${"relevance"===r?"":t.direction}`,a=e.key===o;return a&&(n=e),{key:e.key,action:()=>{s(e.sort),i&&i.current&&i.current.closeMenu()},render:t=>(0,me.jsx)(G.Z,{...t,title:e.formattedName,right:a&&(0,nt.k)({fill:Ae.ZP.regularIconColor,width:14,height:14})})}}));return{activeOption:n,items:o}}({...e,selectButton:t})),[e,t]),d=(0,o.yK)((e=>({selectedTitle:{color:e.mediumTextColor},label:{marginRight:2,fontSize:n?N.Z.fontSize.UISmall.mobile:N.Z.fontSize.UISmall.desktop,transform:"translateY(0.5px)"},innerButton:{color:e.mediumTextColor,fontWeight:N.Z.fontWeight.semibold,fontSize:n?N.Z.fontSize.UISmall.mobile:N.Z.fontSize.UISmall.desktop,height:20,padding:"2px 4px",marginRight:1,transform:"translateY(0.5px)"},menu:{minWidth:200}})),[n]),c=n?(0,me.jsx)(z.FormattedMessage,{id:"search.sort.sortMenuTitle",defaultMessage:"Sort By"}):void 0;return(0,me.jsx)(at.Z,{ref:e=>{e&&(t.current=e)},alignmentToOrigin:ot.v.Start,selectedTitle:(0,me.jsx)("div",{style:d.selectedTitle,children:a.formattedName}),label:void 0,renderMenuSections:()=>[{key:"searchSortOrder",render:e=>(0,me.jsx)(Re.Z,{...e,title:c,desktopStyle:d.menu,disableDesktopPadding:!1}),items:l}],labelStyle:d.label,innerButtonStyle:d.innerButton})};class dt extends R.Z{constructor(){super(...arguments),this.styles={menuItemMobile:{paddingBottom:0},titleWrapper:{flex:void 0,marginTop:-3,marginBottom:-1},showSidebarButton:()=>{const{device:e}=this.environment;return{padding:"0 4px",fontSize:e.isMobile?N.Z.fontSize.UISmall.mobile:N.Z.fontSize.UISmall.desktop,fontWeight:N.Z.fontWeight.medium,borderRadius:3,height:20,lineHeight:"20px"}}}}renderComponent(){const{device:e}=this.environment,t=this.styles,s={...e.isMobile&&t.menuItemMobile},r=this.shouldAllowFilters()&&this.renderAddFilterButton();return(0,me.jsx)(it.Z,{title:this.renderSortMenu(),right:r,textWrapperStyle:t.titleWrapper,style:s})}renderSortMenu(){return(0,me.jsx)(lt,{currentSortBy:M.ZP.state.query.sort,setSortBy:e=>{M.ZP.setState({...M.ZP.state,query:{...M.ZP.state.query,sort:e}})},sortOptions:ct})}renderAddFilterButton(){const{device:e}=this.environment;if(e.isMobile)return(0,me.jsx)(rt,{isMobile:!0,mode:Ye.Button})}shouldAllowFilters(){const{isPublicPageSearch:e}=this.props;return!e}}dt.displayName="SearchHeader";const ct=[{key:"relevance.",formattedName:(0,me.jsx)(z.FormattedMessage,{id:"search.sort.sortOrder.bestMatches",defaultMessage:"Best matches"}),sort:{field:"relevance"}},{key:"lastEdited.desc",formattedName:(0,me.jsx)(z.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.newestFirst",defaultMessage:"Last edited: Newest first"}),sort:{field:"lastEdited",direction:"desc"}},{key:"lastEdited.asc",formattedName:(0,me.jsx)(z.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.oldestFirst",defaultMessage:"Last edited: Oldest first"}),sort:{field:"lastEdited",direction:"asc"}},{key:"created.desc",formattedName:(0,me.jsx)(z.FormattedMessage,{id:"search.sort.sortOrder.created.newestFirst",defaultMessage:"Created: Newest first"}),sort:{field:"created",direction:"desc"}},{key:"created.asc",formattedName:(0,me.jsx)(z.FormattedMessage,{id:"search.sort.sortOrder.created.oldestFirst",defaultMessage:"Created: Oldest first"}),sort:{field:"created",direction:"asc"}}],ut=dt;var ht=s(1924),pt=(s(57658),s(11751)),gt=s(41752),mt=s(16091),ft=s(38755),vt=s(5737),yt=s(69327),xt=s(29798),St=s(88923),bt=s(27724),Ct=s(43145),Mt=s(94184),jt=s.n(Mt),wt=s(75e3),kt=s(63296),It=s(64369);function Tt(e,t){window.__c={n:"SearchActionMenuItem"};const{inline:s,title:r,focused:i,className:n,blueOutlineFocused:a,compact:l}=e,{icon:d,...c}=e,u=(0,o.yK)((e=>({hoveredStyle:{background:e.buttonHoveredBackground}})),[]),h=(0,o.yK)((e=>({style:{minHeight:36,paddingTop:8,paddingBottom:8,width:l?"min-content":"100%",display:"flex"},textWrapper:{marginLeft:4,alignItems:void 0,flex:void 0,display:"block",textOverflow:"ellipsis",...s&&{alignItems:"baseline"}},icon:{display:"block",flexShrink:0,height:18,width:18,color:e.mediumTextColor,overflow:"visible",marginRight:6},enterIcon:{height:12,width:12,fill:e.mediumIconColor},iconContainer:{overflow:"visible"},compactButtonHover:{background:e.buttonHoveredBackground},compactButton:{borderRadius:44,marginLeft:10,marginRight:10,padding:"6px 12px",display:"inline-flex",boxShadow:a?e.focusedShadow:void 0,maxWidth:"calc(100% - 20px)"},menuItem:{overflow:"hidden"},menuItemTextWrapper:{marginLeft:0,marginRight:0},right:{marginLeft:i?8:void 0,marginRight:2}})),[s,a,i,l]),p={title:r,icon:d?Pt(d,h.icon,h.iconContainer):void 0,style:h.style,textWrapperStyle:h.textWrapper,right:Ft(i,h.enterIcon),className:jt()("notranslate",n),buttonStyle:{paddingLeft:2,width:l?"min-content":void 0},hoveredStyle:u.hoveredStyle};return l?(0,me.jsx)(kt.Z,{style:h.compactButton,icon:e=>p.icon,...c,ref:t,hoveredStyle:h.compactButtonHover,children:(0,me.jsx)(it.Z,{title:(0,me.jsx)("div",{style:h.menuItem,children:r}),textWrapperStyle:h.menuItemTextWrapper,style:h.menuItem,allowTextSelection:void 0,right:i?p.right:void 0,rightStyle:h.right})}):(0,me.jsx)(G.Z,{...c,...p,disableTransition:!0,ignoreLocalHoverState:!0})}function Pt(e,t,s){return(0,me.jsx)(It.Z,{style:s,children:e(t)})}function Ft(e,t){const s={...t,opacity:e?1:0};return(0,me.jsx)("div",{style:{display:"flex"},children:(0,wt.U)(s)})}const Rt=r.forwardRef(Tt);var Zt=s(18442),Bt=s(75024);class At extends R.Z{constructor(){super(...arguments),this.openSidebar=()=>M.ZP.setState({...M.ZP.state,isDebugSidebarOpen:!0}),this.styles={footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?N.Z.fontSize.UIRegular.mobile:N.Z.fontSize.UIRegular.desktop}},footerWrapper:{flexShrink:0},footerText:{color:this.theme.lightTextColor,fontSize:Bt.yv(this.environment,"UISmall"),...N.Z.textOverflowStyle},footerDebugButton:{...Ot(this.theme),marginRight:6},debugGearIcon:{color:this.theme.accentColors.gray[400]},hoveredDebugGearIcon:{color:this.theme.accentColors.gray[600]}}}renderComponent(){const e=this.styles;return(0,me.jsx)("footer",{style:e.footerWrapper,children:(0,me.jsxs)(ee.Z,{topBorder:!0,style:e.footer(),disableDesktopPadding:!0,children:[(0,me.jsx)(it.Z,{...this.props,style:e.footerText}),(0,q.x)(H.default)&&!M.ZP.state.isDebugSidebarOpen&&(0,me.jsx)(Y.Z,{onClick:()=>M.ZP.setState({...M.ZP.state,isDebugSidebarOpen:!0,isSidePeekPanelOpen:!1}),isSmall:!0,style:e.debugGearIcon,hoveredStyle:e.hoveredDebugGearIcon,children:(0,Zt.H)({width:12,height:12})})]})})}}At.displayName="SearchFooterContainer";const Ot=e=>({fontSize:12,color:e.lightTextColor,marginLeft:6,paddingRight:4,paddingLeft:4,height:24}),Lt=At;var Dt=s(33907),Et=s(22109),_t=s(62134);function qt(){window.__c={n:"SearchFooterNavigationHints"};const e=(0,i.O7)(),t=(0,z.useIntl)(),s=(0,o.yK)((t=>({upDownIcon:{marginRight:4,marginBottom:-2,display:"inline",width:12,height:12,fill:t.mediumIconColor},enterIcon:{marginRight:4,marginBottom:-2,display:"inline",width:11,height:11,fill:t.mediumIconColor},commandGlyph:{fontSize:.75*Bt.yv(e,"UIRegular"),paddingRight:1,color:t.mediumIconColor},footerText:{fontSize:Bt.yv(e,"UISmall"),color:t.lightTextColor,...N.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},forwardSlash:{fontSize:9,userSelect:"none",fontWeight:500,display:"flex",lineHeight:1.4},toggleSidePeekHotkey:{display:"inline-flex",marginRight:4}})),[e]),r={...Bt.mK,...s.footerText},[a,l]=(0,n.VK)((()=>{const e=M.ZP.state.query.text.length>0;return[C.default.isSidePeekPanelEnabled()&&U.default.checkGate("search_toggle_side_peek")&&e,M.ZP.isSidePeekPanelOpen()]}),[]),{command:d}=_t.fg(e);return(0,me.jsxs)("ul",{style:r,children:[(0,me.jsxs)("li",{style:s.inlineHint,children:[(0,Et.T)(s.upDownIcon),t.formatMessage({id:"searchFooter.helpText.selectHint",defaultMessage:"Select"})]}),(0,me.jsxs)("li",{style:s.inlineHint,children:[(0,wt.U)(s.enterIcon),t.formatMessage({id:"searchFooter.helpText.openHint",defaultMessage:"Open"})]}),(0,me.jsxs)("li",{style:s.inlineHint,children:[(0,me.jsx)("span",{style:s.commandGlyph,children:d}),(0,wt.U)(s.enterIcon),t.formatMessage({id:"searchFooter.helpText.openNewTab",defaultMessage:"Open in a new tab"})]}),a?(0,me.jsxs)("li",{style:s.inlineHint,children:[(0,me.jsxs)("span",{style:s.toggleSidePeekHotkey,children:[(0,me.jsx)("span",{style:s.commandGlyph,children:d}),(0,me.jsx)("span",{style:s.forwardSlash,children:"\\"})]}),l?t.formatMessage({id:"searchFooter.helpText.closeSidePeek",defaultMessage:"Close preview"}):t.formatMessage({id:"searchFooter.helpText.openSidePeek",defaultMessage:"Preview"})]}):null]})}Dt.n;var Vt=s(49085),Nt=s(15145);function zt(e){var t;let{explanation:s,simple:r=!1,filterZeros:i=!1}=e;return function e(t,s){if(!t)return[];const{value:n,description:o,details:a}=t;if(0===n&&i)return[];const l=(0===n?"0":n.toFixed(4)).padStart(8);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return`${"  ".repeat(s+t)}${e}`}const c=`[${l}] ${o}`;if(o.startsWith("match on required clause")){return[d(`[${l}] match on required clause ${null==a?void 0:a[1].description}`)]}if(["max of:","sum of:","min of:"].includes(o)&&1===(null==a?void 0:a.length))return e(a[0],s);if(o.startsWith("tf")||o.startsWith("idf")){var u;const e=o.split(",")[0],t=null===(u=o.split(" computed as ")[1])||void 0===u?void 0:u.replace(" from:","");return[d(`[${l}] ${e}: [${(a??[]).map((e=>`${e.description.split(",")[0]}=${e.value}`)).join(" ")}] --\x3e ${t}`)]}if(o.startsWith("ConstantScore(_id:"))return[d(`[${l}] ids query`)];const h=r&&0!==s&&(o.startsWith("weight")||o.startsWith("Function"));return[d(c.replace(", result of:","").replace(" from:","").replace(" [PerFieldSimilarity]","").replace(/:$/,"").trim()),...(h?[]:a??[]).flatMap((t=>e(t,s+1)))]}(null==s||null===(t=s.details)||void 0===t?void 0:t[0],0)}s(75553),s(32240);var Ht=s(94308);var Wt=s(14871),Kt=s(75018),Ut=s(97820),Qt=s(28020),$t=s(69988),Gt=s(84210),Jt=s(98742),Xt=s(98165),Yt=s(16402),es=s(77907),ts=s(35057),ss=s(24039),rs=s(90403),is=s(64133),ns=s(73063),os=s(50506),as=s(86176),ls=s(26388),ds=s(3043),cs=s(96525);function us(e){window.__c={n:"SearchBreadcrumbFilterPopup"};const{parent:t,store:s,onClick:n}=e,o=(0,i.O7)(),{device:a}=o;let l;l=a.isMobile?{menuType:p.og.Modal,title:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Breadcrumb",id:"breadcrumb.mobileBreadcrumbMenu.title"}),right:(0,me.jsx)(I.DoneMenuText,{}),onClickRight:t.close}:{menuType:p.og.Popup,width:240};const d=(0,r.useCallback)((()=>{null==n||n({store:s,action:"include"})}),[n,s]),c=(0,r.useCallback)((()=>{null==n||n({store:s,action:"exclude"})}),[n,s]),u=s instanceof le.zX?"teamspace":"parent page",h={key:"results",render:e=>(0,me.jsx)(ee.Z,{...e}),items:[{key:"include-filter",render:e=>(0,me.jsx)(G.Z,{...e,title:`Add ${u} to filter`}),action:d},{key:"exclude-filter",render:e=>(0,me.jsx)(G.Z,{...e,title:`Exclude ${u} from results`}),action:c}]};return(0,me.jsx)(k.Z,{...l,children:(0,me.jsx)(Le.Z,{type:Le.i.Vertical,onAccept:t.close,initialFocus:void 0,sections:[h]})})}class hs extends R.Z{constructor(){super(...arguments),this.getFilterPopupRenderer=e=>t=>(0,me.jsx)(us,{parent:t,store:e,onClick:this.props.onClick}),this.getBreadcrumbCommonProps=e=>({maxWidth:this.props.ancestorMaxWidth,popupRenderer:this.getFilterPopupRenderer(e),iconSize:this.props.iconSize,titleStyle:this.getTitleStyle(),iconStyle:hs.iconStyle,highlighter:this.props.highlighter})}renderComponent(){const{store:e}=this.props,t=e.getTitleStore();if(t&&t.isReady())return(0,me.jsx)("div",{style:this.getStyle(),className:"notranslate",children:this.renderAncestors()})}renderAncestors(){const{store:e,maxAncestorCount:t}=this.props,s=Xt.uJ(e),r=e.isNavigableBlock()?s.slice(1):[...s];if(r.reverse(),s.reverse(),r.length>t){const[e,i,n]=[r[0],r.slice(1,r.length-t+1),r.slice(r.length-t+1)];if((0,W.bq)()){const t=n.length;return[this.renderButtonForStore({store:e,showDivider:!this.props.isMobile}),this.renderBlocksAsPopup(this.props.isMobile?s:i),...n.map(((e,s)=>{const r=!this.props.hideCurrentPage||s!==t-1;return e instanceof le.zX?(0,me.jsx)(ds.Yo,{store:e,showDivider:r,...this.getBreadcrumbCommonProps(e)},e.id):(0,me.jsx)(ds.Qe,{store:e,showDivider:r,...this.getBreadcrumbCommonProps(e)},e.id)}))]}{const e=r.filter((e=>e instanceof le.G)),s=r.filter((e=>e instanceof le.G)),i=e.length;return[(0,me.jsx)(ds.Qe,{store:e[0],showDivider:!this.props.isMobile,...this.getBreadcrumbCommonProps(e[0])},e[0].id),this.renderBlocksAsPopup(this.props.isMobile?s:e.slice(1,e.length-t+1)),...e.slice(e.length-t+1).map(((e,t)=>(0,me.jsx)(ds.Qe,{store:e,showDivider:!this.props.hideCurrentPage||t!==i-1,...this.getBreadcrumbCommonProps(e)},e.id)))]}}{const e=r.length;return r.map(((t,s)=>this.renderButtonForStore({store:t,showDivider:!this.props.hideCurrentPage||s!==e-1})))}}renderButtonForStore(e){const{store:t,showDivider:s}=e;return t instanceof le.zX?(0,me.jsx)(ds.Yo,{store:t,showDivider:s,...this.getBreadcrumbCommonProps(t)}):(0,me.jsx)(ds.Qe,{store:t,showDivider:s,...this.getBreadcrumbCommonProps(t)})}getMenuListSections(e){const t=this.props.isMobile?J.Z4.SlideUp:J.Z4.Popup;return[{key:"results",render:e=>(0,me.jsx)(ee.Z,{...e}),items:e.map(((e,s)=>({key:e.id,render:r=>(0,me.jsx)(cs.Z,{...r,stopClickPropagation:!0,popupType:t,renderOrigin:t=>(0,me.jsx)(ce.Z,{...t,isSubpage:0!==s,store:e,hidePath:!0,focused:!1}),render:t=>(0,me.jsx)(us,{parent:t,store:e,onClick:this.props.onClick})}),action:()=>{}})))}]}renderBlocksAsPopup(e){return(0,me.jsx)(J.ZP,{popupType:this.props.isMobile?J.Z4.SlideUp:J.Z4.Popup,renderOrigin:e=>{var t;return this.props.isMobile?(0,me.jsxs)($.Z,{style:{...hs.dividerWrapStyle},mobileFeedback:!0,...e,children:[(0,me.jsx)(ds.fY,{}),(0,me.jsx)("div",{style:ps,children:"..."}),(0,me.jsx)(ds.fY,{})]}):(0,me.jsxs)("div",{style:hs.dividerWrapStyle,children:[(0,me.jsx)(Y.Z,{isSmall:!0,...e,style:{paddingLeft:2,paddingRight:2,fontSize:null===(t=this.props.style)||void 0===t?void 0:t.fontSize},children:"..."}),(0,me.jsx)(ds.fY,{})]})},render:t=>{let s;return s=this.props.isMobile?{menuType:p.og.Modal,title:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Breadcrumb",id:"breadcrumb.mobileBreadcrumbMenu.title"}),right:(0,me.jsx)(I.DoneMenuText,{}),onClickRight:t.close}:{menuType:p.og.Popup,width:240},(0,me.jsx)(k.Z,{...s,children:(0,me.jsx)(Le.Z,{type:Le.i.Vertical,initialFocus:void 0,sections:this.getMenuListSections(e)})})}},"pages-popup")}getStyle(){return{display:"flex",alignItems:"center",lineHeight:1.2,fontSize:this.props.isMobile?N.Z.fontSize.UIRegular.mobile:N.Z.fontSize.UIRegular.desktop,color:this.theme.text.tertiary,filter:"grayscale(70%)",...this.props.style}}getTitleStyle(){return{lineHeight:1.2,fontSize:this.props.isMobile?N.Z.fontSize.UISmall.mobile:N.Z.fontSize.UISmall.desktop,color:this.theme.text.tertiary}}}hs.displayName="SearchPathBreadcrumb",hs.iconStyle={marginRight:3},hs.dividerWrapStyle={display:"flex",alignItems:"center",flexShrink:0};const ps={marginLeft:3,marginRight:3};var gs=s(66897),ms=s(95341),fs=s(96895),vs=s(90683);function ys(e){window.__c={n:"SearchResultToolTip"};const{store:t}=e,s=(0,n.VK)((()=>{const e=t.getCreatedByPointer();if(e)return(0,gs.Hl)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),r=(0,n.VK)((()=>{const e=t.getLastEditedByPointer();if(e)return(0,gs.Hl)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),i=(0,o.yK)((e=>({container:{backgroundColor:Ae.FN.light.gray[900],display:"flex",flexDirection:"column",borderRadius:8},preview:{fontSize:14,color:Ae.FN.light.gray[100],fontWeight:400,display:"flex",gap:10,alignItems:"center"}})),[]),a=(0,z.useIntl)();return(0,me.jsxs)("div",{style:i.container,children:[s&&(0,me.jsx)(xs,{store:t,activity:"created",actor:s}),r&&(0,me.jsx)(xs,{store:t,activity:"edited",actor:r}),(0,me.jsxs)("div",{style:{padding:10,display:"flex",justifyContent:"space-between",cursor:"pointer",alignItems:"center"},onClick:()=>M.ZP.update((e=>({...e,isSidePeekPanelOpen:!0}))),children:[(0,me.jsxs)("div",{style:i.preview,children:[(0,me.jsx)("span",{children:(0,fs.q)({height:14,width:14})}),(0,me.jsx)("span",{children:a.formatMessage({id:"searchResultMenuItem.tooltip.sidePeek",defaultMessage:"Preview"})})]}),(0,me.jsx)("div",{style:{color:"#7F7F7F"},children:(0,ms.d)({height:14,width:14})})]})]})}function xs(e){window.__c={n:"UserActivity"};const{activity:t,actor:s,store:r}=e,i=(0,o.yK)((e=>({container:{display:"flex",flexDirection:"column",padding:"8px 10px 10px 10px",gap:8,borderBottom:`1px solid ${Ae.FN.light.gray[800]}`,minWidth:195},actorAvatarAndName:{display:"flex",alignItems:"center",gap:5},actorActivityInfo:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:10,fontSize:14},description:{color:"#7F7F7F",fontSize:12,fontWeight:600},date:{color:"#7F7F7F",fontSize:12}})),[]),[a]=(0,n.VK)((()=>{const e="created"===t?r.getCreatedTime():r.getLastEditedTime();return[(0,Yt.IS)(e,{useCompactFormat:!0,useLowercase:!0})]}),[t,r]),l=(0,z.useIntl)();return(0,me.jsxs)("div",{style:i.container,children:[(0,me.jsx)("div",{style:i.description,children:"edited"===t?l.formatMessage({id:"searchResultMenuItem.tooltip.lastEditedBy",defaultMessage:"Last edited by"}):l.formatMessage({id:"searchResultMenuItem.tooltip.createdBy",defaultMessage:"Created by"})}),(0,me.jsxs)("div",{style:i.actorActivityInfo,children:[(0,me.jsxs)("div",{style:i.actorAvatarAndName,children:[(0,me.jsx)("span",{children:(0,vs.a)({actor:s,size:20,style:{}})}),(0,me.jsx)("span",{children:(0,gs.$4)(l,s)})]}),(0,me.jsx)("div",{style:i.date,children:a})]})]})}(0,z.defineMessages)({openInSidePeekButtonLabel:{id:"search.result.openInSidePeek.button.label",defaultMessage:"Open search result in side peek"},copySearchResultLinkButtonLabel:{id:"search.result.copyLink.button.label",defaultMessage:"Copy link to search result"}});class Ss extends R.Z{constructor(){super(...arguments),this.storeTypes={explanationModalOpen:Vt.default.createClass(!1)},this.renderTooltip=()=>C.default.state.intentBasedSearch.enablesSidePeekPanel?(0,me.jsx)(ys,{store:this.props.store}):(0,me.jsx)(ss.Z,{store:this.props.store}),this.handleSearchPathBreadcrumbClick=e=>{let{store:t,action:s}=e;"block"===t.table?"include"===s?M.ZP.updateFilters({ancestors:a.jj(M.ZP.state.query.filters.ancestors.concat(t.id))}):M.ZP.updateFilters({dev_excludedPages:a.jj((M.ZP.state.query.filters.dev_excludedPages||[]).concat(t.id))}):"team"===t.table&&("include"===s?M.ZP.updateFilters({inTeams:a.jj((Ce.iY(M.ZP.state.query.filters.inTeams)||[]).concat(t.id))}):M.ZP.updateFilters({dev_excludedTeams:a.jj((M.ZP.state.query.filters.dev_excludedTeams||[]).concat(t.id))}))},this.renderVerifiedBadge=()=>(0,me.jsx)(rs.Z,{style:this.styles.badge,content:(0,me.jsxs)("div",{style:this.styles.badgeContent,children:[(0,Ht.f)(this.styles.verifiedBadgeIcon),(0,me.jsx)("div",{style:this.styles.badgeCaption,children:(0,me.jsx)(z.FormattedMessage,{id:"search.result.verified.badge.text",defaultMessage:"Verified"})})]})}),this.renderPopularThisWeekBadge=()=>(0,me.jsx)(rs.Z,{style:this.styles.badge,content:(0,me.jsx)("div",{style:this.styles.badgeCaption,children:(0,me.jsx)(z.FormattedMessage,{id:"search.result.popularThisWeek.badge.text",defaultMessage:"Popular this week"})})}),this.renderMostViewedBadge=()=>(0,me.jsx)(rs.Z,{style:this.styles.badge,content:(0,me.jsx)("div",{style:this.styles.badgeCaption,children:(0,me.jsx)(z.FormattedMessage,{id:"search.result.mostViewed.badge.text",defaultMessage:"Most viewed"})})}),this.renderIsTemplateBadge=()=>(0,me.jsx)(rs.Z,{content:(0,me.jsx)("div",{style:this.styles.grayedOutBadgeCaption,children:(0,me.jsx)(z.FormattedMessage,{id:"search.result.template.badge.text",defaultMessage:"Template"})})}),this.getPageVisitSource=()=>"recent_pages"===this.props.type?Nt.tY.SearchRecents:Nt.tY.SearchQuery,this.handleOpenInSidePeek=()=>{const{store:e,queryId:t,result:s}=this.props,r=this.getPageVisitSource();s?Kt.navigateToSearchResult({searchResult:s,openInSidePeek:!0,environment:this.environment,pageVisitSource:r,queryId:t,openInNew:void 0}):Kt.navigateToPage({store:e,queryId:t,environment:this.environment,pageVisitSource:r,openInSidePeek:!0,peekMode:"s"})},this.handleCopy=()=>{const{store:e,queryId:t}=this.props,s=(0,Gt.ZP)({store:e,pageVisitSource:this.getPageVisitSource(),queryId:t});Wt.RD({environment:this.environment,stringValue:s,copiedMessage:Wt.tq.copiedLinkToClipboard})},this.styles={title:{fontWeight:N.Z.fontWeight.medium,lineHeight:"20px"},titleContent:{display:"flex",...this.props.inline?{}:{width:0,flexGrow:1}},menuItem:{minHeight:36,paddingTop:this.environment.device.isMobile?12:8,paddingBottom:this.environment.device.isMobile?12:8},textWrapper:{marginLeft:4,alignItems:"center",width:"100%"},inlineTextWrapper:{alignItems:"center"},highlight:{fontWeight:N.Z.fontWeight.medium},vectorHighlight:{fontWeight:N.Z.fontWeight.medium,whiteSpace:"pre-wrap"},rightContentWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},rightIcon:{height:12,width:12},rightIconButtonIcon:{height:12,width:12},rightIconButtonWrapper:{height:18,width:18,marginRight:6},uniqueIDBadgeWrapper:{display:"flex",gap:8,marginRight:8,alignItems:"center"},caption:{marginTop:1},debugArea:{fontFamily:"monospace"},timestamp:{fontSize:N.Z.fontSize.UISmall.desktop,fontWeight:N.Z.fontWeight.regular},tooltip:{maxWidth:300},sidePeekTooltip:{background:"transparent",boxShadow:"none"},tooltipTitle:{fontWeight:N.Z.fontWeight.medium,fontSize:N.Z.fontSize.UISmall.desktop},tooltipText:{fontWeight:N.Z.fontWeight.medium,fontSize:N.Z.fontSize.UISmall.desktop,marginLeft:0,paddingRight:20},tooltipValue:{fontSize:N.Z.fontSize.UISmall.desktop,fontWeight:N.Z.fontWeight.regular},tooltipMenuItem:{minHeight:20},badge:{background:"light"===this.theme.mode?this.theme.accentColors.blue[30]:this.theme.accentColors.blue[200]},badgeContent:{display:"flex",alignItems:"center",width:"100%"},badgeCaption:{marginLeft:2,color:this.theme.blueColor},grayedOutBadgeCaption:{marginLeft:1},vectorBadge:{background:this.theme.invoiceGreen,color:this.theme.contentBackground},verifiedBadgeIcon:{width:10,height:10,fill:this.theme.blueColor},right:{display:"flex"},collectionTextMatchingProperty:{lineHeight:2,fontSize:12}},this.debugHitCustomRenderer=e=>{let{data:t,keyPath:s}=e;if(2===s.length&&"_explanation"===s[0])return{element:(0,me.jsx)(me.Fragment,{children:(0,me.jsx)("button",{onClick:e=>{this.stores.explanationModalOpen.setState(!0),e.stopPropagation()},children:"show simplified explanation"})}),expanded:!1};const r=t._ltrlog;if(r)return function(e){const t=Object.keys(e[0])[0],s=e[0][t].map(((e,t)=>{const s=t%2==0?js:Ms;return(0,me.jsxs)("tr",{children:[(0,me.jsx)("td",{style:s,children:`${t}`}),(0,me.jsx)("td",{style:s,children:`${e.name}`}),(0,me.jsx)("td",{style:s,children:`${e.value}`})]},e.name)}));return{element:(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)("div",{children:(0,me.jsx)("b",{children:`Featureset: ${t}`})}),(0,me.jsx)("div",{style:ws,children:(0,me.jsx)("table",{style:ks,children:s})})]}),expanded:!1}}(r);if(!["_score","matched_queries"].every((e=>t[e])))return null;const{_score:i,matched_queries:n}=t;return{element:(0,me.jsx)(me.Fragment,{children:`score ${i}, ${(n??[]).length} matched query clauses`}),expanded:!1}}}renderComponent(){const{focused:e,isLastInSection:t,inline:s,className:r}=this.props,i=this.styles,n=this.getThemeColors(),o={...i.menuItem,...!s&&!t&&!e&&n.menuItemBorder},a={...i.caption,...n.caption},l={...i.timestamp,...n.timestamp},d={...i.textWrapper,...this.props.inline&&i.inlineTextWrapper},c={title:this.renderTitle(),icon:this.renderIcon(),caption:this.renderCaption(),body:this.renderPreview(),right:this.renderRight(),rightStyle:e?void 0:l,dontShrinkRight:!0,captionStyle:a,style:o,spacerStyle:this.hasPath()?void 0:Is,textWrapperStyle:d,className:jt()("notranslate",r),buttonStyle:{paddingLeft:2},hoveredStyle:{background:this.theme.tint.regular}},u=U.default.checkGate("search_toggle_side_peek"),h=C.default.state.intentBasedSearch.enablesSidePeekPanel&&u,p=(0,ts.Mk)()&&!M.ZP.state.isSidePeekPanelOpen&&!M.ZP.state.isDebugSidebarOpen,g=p&&h&&this.props.focused;return p?(0,me.jsx)(ls.Z,{delayThreshold:50,placement:ls.Z.Placement.Right,originGap:18,renderTooltip:this.renderTooltip,style:g?i.sidePeekTooltip:i.tooltip,forceVisibleState:!!g||void 0,allowHover:!!g,render:e=>(0,me.jsx)(G.Z,{...this.props,...c,disableTransition:!0,...(0,Jt.Z)(this.props,e)}),closeDelay:0}):(0,me.jsx)(G.Z,{...this.props,...c,disableTransition:!0,ignoreLocalHoverState:!0})}renderTitle(){var e;const{store:t,result:s,placeholder:r,index:i}=this.props,n=this.styles,o=this.getThemeColors(),a=void 0===s,l={...n.title,...!a&&!this.props.focused&&o.nonHighlightedTextColor},d=[];if(s&&s.highlight)if(d.push(...(0,$t.fe)(s.highlight.pathText)),this.isANonLocalResult())d.push(...(0,$t.fe)(s.highlight.title));else{le.G.createChildStore(this.props.store,{table:ie.iU,id:s.id,spaceId:s.spaceId}).isNavigableBlock()&&d.push(...(0,$t.fe)(s.highlight.text))}const c=this.props.focused?void 0:this.getWordHighlighter({words:d}),u=null===(e=(0,Xt.VP)(t))||void 0===e?void 0:e.isArchived(),h=function(e){if(e)return e.sources.includes(Ce.vp.ElasticsearchUniqueID)}(s),p=(0,Qt.zj)(),g=p&&p===(null==s?void 0:s.id)&&"on"===U.default.getGroup("search-includes-current-page-in-local-search");const m=(0,ts.Mk)()&&!g&&!u?function(){function e(e){var t;return void 0!==(null==s||null===(t=s.badges)||void 0===t?void 0:t.find((t=>t.type===e)))}return e("is_template")?"is_template":e("verified")?"verified":e("popular_this_week")?"popular_this_week":e("most_viewed")?"most_viewed":void 0}():void 0,f={is_template:this.renderIsTemplateBadge,verified:this.renderVerifiedBadge,popular_this_week:this.renderPopularThisWeekBadge,most_viewed:this.renderMostViewedBadge};return(0,me.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",...l},children:[(0,me.jsxs)("div",{style:n.titleContent,children:[b.ZP.state.showDebugInfo&&void 0!==i&&`${i+1}. `,h&&this.renderUniqueIdHighlight(s),(0,me.jsx)(ue.Z,{style:l,store:t,placeholder:r,highlighter:c}),!1,u&&(0,me.jsx)(rs.Z,{content:(0,me.jsx)("div",{style:this.styles.grayedOutBadgeCaption,children:(0,me.jsx)(z.FormattedMessage,{id:"search.result.archived.badge.text",defaultMessage:"Archived"})})}),g&&(0,me.jsx)(rs.Z,{content:(0,me.jsx)("div",{style:this.styles.grayedOutBadgeCaption,children:(0,me.jsx)(z.FormattedMessage,{id:"search.result.currentPage.badge.text",defaultMessage:"Current page"})})}),m&&f[m]()]}),b.ZP.state.showDebugInfo&&this.renderDebugIcons()]})}renderUniqueIdHighlight(e){var t;const{focused:s}=this.props,r=null==e||null===(t=e.highlight)||void 0===t?void 0:t.uniqueId;if(!r)return;const i="dark"===this.environment.ThemeStore.state.mode,n=this.styles,o=this.getWordHighlighter({words:[r]}),a=s?i?Ae.FN.dark.translucentGray[300]:Ae.se.light.darkgray.alpha(.09):i?Ae.FN.dark.translucentGray[200]:Ae.se.light.darkgray.alpha(.06);return(0,me.jsxs)("div",{style:n.uniqueIDBadgeWrapper,children:[(0,me.jsx)("div",{children:(0,me.jsx)(is.Z,{text:r,highlighter:o})}),(0,me.jsx)("div",{style:{borderRight:`1.5px solid ${a}`,height:14,borderRadius:1}})]})}renderRight(){return(0,me.jsx)("div",{style:this.styles.right,children:this.rightContent()})}rightContent(){const{lastViewed:e,focused:t}=this.props;if(this.environment.device.isMobile)return;if(e&&!t)return(0,Yt.IS)(e,{useCompactFormat:!0});const s=this.styles,r=this.getThemeColors(),i={...s.rightIcon,...r.enterIcon,opacity:t?1:0};s.rightIconButtonIcon;return(0,wt.U)(i)}renderDebugIcons(){var e;const{result:t,index:s,originalPosition:r}=this.props,i=null===(e=(null==t?void 0:t.sources)??[])||void 0===e?void 0:e.flatMap((e=>e===Ce.vp.Local?["💻"]:e===Ce.vp.ElasticSearch?["🌐"]:e===Ce.vp.Postgres?["🐘"]:e===Ce.vp.VectorDBBlock||e===Ce.vp.VectorDBCollection?["🔭"]:e===Ce.vp.ElasticsearchRandom?["🎲"]:e===Ce.vp.ElasticsearchUniqueID?["🆔"]:e===Ce.vp.ElasticsearchForcedRecentRecall?["⏰"]:void(0,V.t1)(e))).reverse(),n=[...void 0===s||void 0===r?[" "]:s>r?["⬇️"]:s<r?["⬆️"]:[],...i].join("").trim();return n&&(0,me.jsx)("span",{children:n})}renderIcon(){const{store:e}=this.props;return(0,me.jsx)(de.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:20,largeIcon:!1})}renderCaption(){const{store:e,inline:t,result:s,debugLocal:r,debugHits:i}=this.props,{device:n}=this.environment,o=this.getWordHighlighter({words:(0,$t.fe)(s&&s.highlight&&s.highlight.pathText),removeDuplicate:!0}),a=t||n.isMobile?0:2,l=(i??[]).find((e=>"elasticsearch"===e.type&&void 0!==e._explanation)),d="elasticsearch"===(null==l?void 0:l.type)?null==l?void 0:l._explanation:void 0,c=Boolean(b.ZP.getDebugLevel());return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(as.Z,{store:e,extraLength:a,showFullPathInTooltip:!0,highlighter:o,enableHoverAncestor:!0,tooltipStyle:this.getThemeColors().captionTooltip,tooltipDividerStyle:this.getThemeColors().captionTooltipDivider}),(0,me.jsxs)("div",{ref:this.props.debugAreaRef,children:[r&&(0,me.jsx)("div",{style:this.styles.debugArea,children:(0,me.jsx)(es.LazyAdminReactJson,{data:{debugLocal:r},defaultCollapsed:!0,customCollapsedRenderers:[Cs],showCopyButton:!1,showModalButton:!1})}),i&&(0,me.jsx)("div",{style:this.styles.debugArea,children:(0,me.jsx)(es.LazyAdminReactJson,{data:{debugHits:i},defaultCollapsed:!0,customCollapsedRenderers:[this.debugHitCustomRenderer],showCopyButton:"small",showModalButton:!0})}),i&&(null==s?void 0:s.rankingSignals)&&(0,me.jsx)("div",{style:this.styles.debugArea,children:(0,me.jsx)(es.LazyAdminReactJson,{data:{rankingSignals:s.rankingSignals},defaultCollapsed:!0,showCopyButton:"small",showModalButton:!1})}),c&&(null==s?void 0:s.featureGroups)&&(0,me.jsx)("div",{style:this.styles.debugArea,children:(0,me.jsx)(es.LazyAdminReactJson,{data:{featureGroups:s.featureGroups},defaultCollapsed:!0,showCopyButton:"small",showModalButton:!1})}),d&&(0,me.jsx)(os.Z,{open:this.stores.explanationModalOpen.state,innerStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},onDismiss:()=>{this.stores.explanationModalOpen.setState(!1)},render:()=>(0,me.jsx)("pre",{children:zt({explanation:d}).join("\n")})})]})]})}renderPreview(){var e,t;const{result:s}=this.props;if(!s)return;if(!s.highlight)return;if(le.G.createChildStore(this.props.store,{table:ie.iU,id:s.id,spaceId:s.spaceId}).isNavigableBlock()&&!this.isANonLocalResult())return;let r,i;if(s.highlight.text)r=s.highlight.text;else if(s.highlight.collectionText){var n;r=s.highlight.collectionText,i=null==s||null===(n=s.matchedCollectionProperties)||void 0===n?void 0:n.collectionText}if(!r)return;const o=(0,$t.ZP)(r);let a=!1;if(this.isANonLocalResult()){const e=e=>e.filter($t.il).map((e=>e[0].toLowerCase())),t=t=>void 0===t?[]:e((0,$t.ZP)(t)),r=[...new Set([...t(s.highlight.title),...t(s.highlight.pathText)])],i=e=>r.some((t=>t.includes(e)));a=e(o).every((e=>i(e)))}const l=null!==(e=s.sources)&&void 0!==e&&e.includes(Ce.vp.VectorDBBlock)||null!==(t=s.sources)&&void 0!==t&&t.includes(Ce.vp.VectorDBCollection)?this.styles.vectorHighlight:this.styles.highlight,{highlightedText:d}=this.getThemeColors(),c=a?{}:{...l,...d};return(0,me.jsxs)(me.Fragment,{children:[void 0!==i&&(0,me.jsx)(Ut.Z,{propertySchema:i,showIcon:!0,style:this.styles.collectionTextMatchingProperty}),(0,me.jsx)(is.Z,{text:r,highlighter:{tokenize:e=>(0,$t.Vu)(o),style:c}})]})}isANonLocalResult(){const{result:e}=this.props;return e&&!e.sources.includes(Ce.vp.Local)}getWordHighlighter(e){const{words:t,removeDuplicate:s}=e;if(0===t.length)return;const r={...this.styles.highlight,...this.getThemeColors().highlightedText},i=s?new Set:void 0;return{tokenize:e=>(0,$t.XT)({text:e,patterns:t,uniqueTokenHighlighterContext:i}),style:r}}shouldComponentUpdate(e,t,s){var r,i;const n=e.focused!==this.props.focused,o=(null===(r=e.result)||void 0===r?void 0:r.highlight)!==(null===(i=this.props.result)||void 0===i?void 0:i.highlight);return n||o}hasPath(){const{hidePath:e,store:t}=this.props;return!e&&(0,as.L)(t)}getThemeColors(){return{nonHighlightedTextColor:{color:this.theme.text.secondary},menuItemBorder:{boxShadow:`0 1px 0 ${this.theme.lightDividerColor}`},highlightedText:{color:this.theme.text.primary},enterIcon:{fill:this.theme.icon.secondary},bookmarkedIcon:{fill:this.theme.topbarFavorite},caption:{color:this.theme.text.secondary},captionTooltip:{color:this.theme.text.contrast},captionTooltipDivider:{color:this.theme.text.contrast},timestamp:{color:this.theme.text.tertiary},tooltipTitle:{color:this.theme.text.secondary},tooltipText:{color:this.theme.text.primary},tooltipValue:{color:this.theme.text.tertiary}}}}Ss.displayName="SearchResultMenuItem",Ss.contextTypes={...p.mw,...R.w};const bs=Ss,Cs=e=>{let{data:t}=e;const s=t;if(!s)return null;const{localSource:r}=s;let i=r;return i||(i=new Set(["unknown"])),{element:(0,me.jsx)(me.Fragment,{children:`from ${[...i].join(",")}`}),expanded:!1}},Ms={paddingLeft:5,paddingRight:20,paddingTop:2,paddingBottom:2,border:"1px solid black",color:Ae.FN.dark.green[900]},js={...Ms,color:Ae.FN.dark.gray[30]},ws={maxHeight:200,overflowY:"scroll"},ks={border:"1px solid black"};const Is={visibility:"hidden"};function Ts(e){switch(e){case"Today":return(0,me.jsx)(z.FormattedMessage,{id:"search.recentPagesTimeBuckets.today.text",defaultMessage:"Today"});case"Yesterday":return(0,me.jsx)(z.FormattedMessage,{id:"search.recentPagesTimeBuckets.yesterday.text",defaultMessage:"Yesterday"});case"Past Week":return(0,me.jsx)(z.FormattedMessage,{id:"search.recentPagesTimeBuckets.pastWeek.text",defaultMessage:"Past Week"});case"Past 30 Days":return(0,me.jsx)(z.FormattedMessage,{id:"search.recentPagesTimeBuckets.past30Days.text",defaultMessage:"Past 30 Days"});case"Older":return(0,me.jsx)(z.FormattedMessage,{id:"search.recentPagesTimeBuckets.older.text",defaultMessage:"Older"})}(0,V.t1)(e)}const Ps=function(e){window.__c={n:"SearchDefaultBody"};const{onSelect:t,spaceId:s,extraTopPadding:l}=e,[d,c]=r.useState(!1),[h,p]=r.useState(!1),g=(0,n.qz)(void 0,xt.Z),{section:m,indexLocal:f}=(0,n.VK)((()=>g.state.focus),[g]),x=(0,i.O7)(),S=(0,i.Fy)(),b=(0,o.yK)((e=>({wrapper:{width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},sectionHeader:{marginBottom:8},section:{marginBottom:18},sectionBorderBottom:{paddingBottom:10,boxShadow:`0 1px 0 ${e.lightDividerColor}`},notionAiLabel:{lineHeight:"20px",fontSize:14,textOverflow:"ellipsis",overflow:"hidden",display:"block",fontWeight:N.Z.fontWeight.medium},notionAiIcon:{fill:e.aiPurpleColor,overflow:"visible"}})),[]),{defaultBodyFocusedResult:C,isQuickSearch:M}=(0,r.useContext)(F.SearchStaticContext),j=(0,n.VK)((()=>ae.X4.state),[]),w=(0,n.VK)((()=>{const e=St.default.state,t=St.default.isMiniOrCenterPeekOpen()||bt.default.isInPeekRenderer();return e.open&&(t||e.isOpening)?e.target:v.default.state.mainEditorCurrentBlockStore}),[]),k=(0,n.VK)((()=>y.Z.shouldShowSearchMenuItemAskAI()),[]),I=(0,n.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t,mainEditorCurrentBlockStore:s}=v.default.state;if(!e||!e.isReady())return!1;if(!t||!s||!s.canRead())return!1;if(x.device.isMobile)return!1;const r=e.getSettings();return!!r&&"tooltip"===r.ai_qna_intro_onboarding_phase}),[x.device]);(0,r.useEffect)((()=>()=>{C.setState(void 0)}),[C]);const T=(0,r.useRef)(null),P=(0,n.VK)((()=>k?[{key:"actionMenuItem.assistant",action:()=>{const{currentUserSettingsStore:e}=v.default.state;e&&(0,gt.C)(x,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipClose",userSettingsStore:e}),u.em({environment:x,shouldResetAssistantStore:(0,vt.Sr)(),isQuickSearch:M}),vt.NM.setLastSessionInitializedUnixEpochTime()},render:e=>{const t=null==w?void 0:w.getSpaceStore(),s=t?(0,ft.rn)(x,t):void 0;return(0,me.jsxs)(me.Fragment,{children:[I&&(0,me.jsx)(mt.gc,{origin:T}),(0,me.jsx)(Rt,{type:"assistant",...e,blueOutlineFocused:I,ref:T,title:(0,me.jsx)("div",{className:"notranslate",style:b.notionAiLabel,children:s?(0,me.jsx)(z.FormattedMessage,{id:"searchDefaultBody.searchActionMenuItem.askAiInSpace",defaultMessage:"Ask AI anything in {spaceName}",values:{spaceName:s}}):(0,me.jsx)(z.FormattedMessage,{id:"searchDefaultBody.searchActionMenuItem.askNotionAi",defaultMessage:"Ask Notion AI about..."})}),icon:e=>(0,pt.t)({...e,...b.notionAiIcon})})]})}}]:[]),[M,k,x,w,I,b.notionAiLabel,b.notionAiIcon]),R=j.filter((e=>e.pageId!==(null==w?void 0:w.id))),Z=(0,n.VK)((()=>{const e={};return R.forEach((t=>{let{pageId:s,visitedAt:r}=t;return e[s]=r})),e}),[R]),B=(0,n.VK)((()=>{const e=new Map;return R.map(((s,r)=>{const i=ae._5(s.visitedAt),n="Today"!==i&&"Yesterday"!==i,o={result:{key:`${s.store.id}:${r}`,action:e=>t({action:{...e,index:e.index-P.length},sectionName:"recents",selectedResult:{store:s.store,id:s.store.id,score:-1,spaceId:s.store.getSpaceId(),sources:[Ce.vp.Local],featureGroups:[],originalPosition:r,serverEventProperties:void 0}}),render:e=>(0,me.jsx)(bs,{...e,inline:!S.isMobile,store:s.store,hidePath:!1,lastViewed:n?Z[s.store.id]:void 0,buttonStyle:{paddingLeft:1},type:"recent_pages"})},store:s.store};var a;e.has(i)?null===(a=e.get(i))||void 0===a||a.push(o):e.set(i,[o])})),e}),[P.length,S.isMobile,R,t,Z]),A=(0,n.VK)((()=>{const e=[];P.length>0&&e.push({key:"actions",items:P,render:e=>(0,me.jsx)(ee.Z,{title:"Actions",desktopTitleStyle:b.sectionHeader,disableDesktopPadding:!0,extraTopPadding:l,style:{...b.section,...b.sectionBorderBottom},children:e.children})});for(const[t,s]of B.entries()){const r=Ts(t),i={key:t,items:s.map((e=>e.result)),render:e=>(0,me.jsx)(ee.Z,{title:r,desktopTitleStyle:b.sectionHeader,disableDesktopPadding:!0,style:b.section,children:e.children})};e.push(i)}return e}),[P,B,l,b.section,b.sectionHeader,b.sectionBorderBottom]),O=(0,r.useCallback)((e=>{const t=()=>{const e=yt.Z.getWithoutSubscribing(s),t=e[e.length-1];return null==t?void 0:t.visitedAt},r=a.P2((async()=>{const e=t(),r=x.currentUser.id;if(!r||!e)return;c(!0);const i=await ae.Od(e,{environment:x,userId:r,spaceId:s});c(!1),i||p(!0)}),300);t()&&e<=200&&!d&&!h&&r()}),[h,d,x,s]);(0,r.useEffect)((()=>{var e;if(void 0===m&&void 0===f)return;const t=null===(e=A[m])||void 0===e?void 0:e.key;var s;if(t&&"string"==typeof t)if("actions"===t)"assistant"!==(null===(s=C.state)||void 0===s?void 0:s.type)&&C.setState({type:"assistant"});else if(ae._k.includes(t)){var r;const e=null===(r=B.get(t))||void 0===r||null===(r=r[f])||void 0===r?void 0:r.store;e&&C.setState({type:"page_result",value:e})}}),[C,m,f,B,A]);const L=(0,n.VK)((()=>u.yt()),[]),D=!S.isMobile&&R.length>0&&!L;return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsxs)("div",{style:b.wrapper,children:[(0,me.jsx)(Le.Z,{store:g,type:Le.i.Vertical,initialFocus:0,disableKeyboardArrowWrap:!0,sections:A,unfocusOnScroll:!0}),(0,me.jsx)(Ct.Z,{onChange:O})]}),D&&(0,me.jsx)(Lt,{title:(0,me.jsx)(qt,{})})]})};var Fs=s(36308),Rs=s(15157),Zs=s(34859),Bs=s(79131),As=s(53336),Os=s(53437);function Ls(e,t){window.__c={n:"SearchWorkspaceMenuItem"};const{spaceStore:s}=e,r=(0,i.O7)(),{name:o}=(0,n.VK)((()=>({name:s.getName()})),[s]),a=(0,n.VK)((()=>(0,ft.Wd)(r,s)),[r,s]);return(0,me.jsx)(G.Z,{ref:t,...e,icon:(0,me.jsx)(de.Z,{title:o,icon:a,size:16,isEmptyPage:!1,isLarge:!1,largeIcon:!1,disabled:!0}),title:o})}const Ds=r.forwardRef(Ls);function Es(e){return(0,me.jsx)(Te.Z,{disabled:!1,title:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.workspaceSwitcher.title",defaultMessage:"Workspace"}),onClick:e.onClick})}const _s=function(e){window.__c={n:"SearchWorkspaceSwitcher"};const{onChange:t}=e,s=(0,o.yK)((()=>({popup:{paddingTop:12,paddingBottom:8}})),[]),r=(0,n.VK)((()=>{var e;return null===(e=v.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),i=(0,n.VK)((()=>{var e;return a.mN(a.oA((null===(e=v.default.state.currentUserRootStore)||void 0===e?void 0:e.getSpaceViewStores())??[]),(e=>e.getSpaceId()))}),[]);return!r||i.length<=1?null:(0,me.jsx)(J.ZP,{popupType:J.Z4.Popup,renderOrigin:Es,render:e=>function(e){const{currentSpaceId:t,spaceViews:s,onChange:r}=e,i=[],n=[];for(const a of s){const e=a.getSpaceStore();e&&(n.push(e.id),i.push({key:e.key,render:t=>(0,me.jsx)(Ds,{...t,spaceStore:e}),action:()=>{r(a)}}))}const o=n.indexOf(t);return(0,me.jsx)(k.Z,{menuType:p.og.Popup,children:(0,me.jsx)(Le.Z,{type:Le.i.Vertical,initialFocus:o<0?0:o,sections:[{key:"workspaces",items:i,render:e=>(0,me.jsx)(ee.Z,{...e,disableDesktopPadding:!0})}]})})}({currentSpaceId:r,spaceViews:i,onChange:s=>{t(s),e.close()}}),disabled:!1,placementToOrigin:Os.ZP.Placement.Bottom,alignmentToOrigin:Os.ZP.Alignment.Start,style:s.popup})};var qs=s(76725),Vs=s(19889),Ns=s(7928);function zs(e){window.__c={n:"SearchFilterBarTitle"};const{filterUIName:t}=e,{parentStore:s}=(0,r.useContext)(F.SearchStoresContext),i=(0,n.VK)((()=>M.ZP.state.query.filters),[]),l=(0,o.yK)((e=>({title:{maxWidth:220,...N.Z.textOverflowStyle}})),[]),d=(0,n.VK)((()=>{switch(t){case"workspaceSwitcher":return[];case"personFilter":return function(e,t){const s=e.createdBy,r=oe.default.getIntl(),i=a.oA(s.map((e=>{const s=le.U6.createChildStore(t,{table:Vs.KJ,id:e});return(0,Ns.Nz)(r,s.getModel())})));return(0,qs.Z)(i,Us)}(i,s);case"teamsFilter":case"dev_notInTeamFilter":return function(e,t){const s=(0,Ce.iY)(e.inTeams);if(!s)return[];const r=a.oA(s.map((e=>le.zX.createChildStore(t,{table:be.e0,id:e}).getName())));return(0,qs.Z)(r,Us)}(i,s);case"pageFilter":return Qs(i,s);case"dateFilter":return function(e){const t=oe.default.getIntl(),s=Ws(e);if("createdTime"===s)return g._Q(e.createdTime,t);if("lastEditedTime"===s)return g._Q(e.lastEditedTime,t);return""}(i);case"pageFilter":case"dev_notInPageFilter":return Qs(i,s);case"titleToggle":return[];default:(0,V.t1)(t)}}),[s,t,i]);return(0,me.jsx)("div",{style:l.title,children:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"{filterName}{colon} {filterOperator} {filterValues}",id:"search.filterBarFilter.title",values:{filterName:Hs(t),filterOperator:0===d.length?void 0:Ks(t,i),filterValues:d,colon:0===d.length?void 0:":"}})})}function Hs(e){switch(e){case"workspaceSwitcher":return(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.workspaceToggle.label",defaultMessage:"Different workspace"});case"personFilter":return(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.person",defaultMessage:"Created by"});case"teamsFilter":return(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"});case"pageFilter":return(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"});case"dateFilter":return(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.date",defaultMessage:"Date"});case"titleToggle":return(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"});case"dev_notInPageFilter":return(0,me.jsx)(z.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInPageFilter.label",defaultMessage:"[dev] Not in page"});case"dev_notInTeamFilter":return(0,me.jsx)(z.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInTeamFilter.label",defaultMessage:"[dev] Not in teamspace"})}(0,V.t1)(e)}function Ws(e){const t=g.VD.createdTime(e.createdTime),s=g.VD.lastEditedTime(e.lastEditedTime);return t?"createdTime":s?"lastEditedTime":void 0}function Ks(e,t){switch(e){case"workspaceSwitcher":case"personFilter":case"teamsFilter":case"pageFilter":case"dev_notInPageFilter":case"dev_notInTeamFilter":case"dateFilter":case"titleToggle":return}(0,V.t1)(e)}const Us=e=>", ";function Qs(e,t){const s=e.ancestors,r=a.oA(s.map((e=>{const s=le.G.createChildStore(t,{table:ie.iU,id:e});return s.isDefined()?s.getModel().getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,ze.r)(),intl:oe.default.getIntl()}):""})));return(0,qs.Z)(r,Us)}var $s=s(41558),Gs=s(3386),Js=s(45959),Xs=s(83264);const Ys={today:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Today",id:"searchDateFilter.quickActions.today.label"}),pastWeek:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Last 7 days",id:"searchDateFilter.quickActions.last7Days.label"}),pastMonth:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Last 30 days",id:"searchDateFilter.quickActions.last30Days.label"})};function er(e){let{date:t,onClick:s,onDismiss:r}=e;const i=(0,ze.r)(),n=Ne.Lg(i),o=n;let a;const l=Ys[t];"today"===t?a=n:"pastWeek"===t?a=Ne.Oo(i):"pastMonth"===t?a=Ne.dj(i):(0,V.t1)(t);return(0,me.jsx)(G.Z,{focused:!1,icon:(0,A.C)({height:18,width:18}),title:l,onClick:e=>{s({value:{starting:{type:"date",start_date:a.start_date},ending:{type:"date",start_date:o.start_date}}}),r(e)}})}class tr extends R.Z{constructor(){super(...arguments),this.storeTypes={store:$s.Z},this.renderPillButtonOrigin=()=>{const{icon:e,title:t}=this.props,{store:s}=this.stores,r=this.styles,{dateFilterType:i}=s.state,n=M.ZP.state.query.filters[i].starting;return(0,me.jsx)(Te.Z,{on:Boolean(n),icon:e(r.pillIcon),title:(0,me.jsx)("span",{children:t}),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e}=this.props,{store:t}=this.stores;return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsxs)("div",{style:this.styles.dateFilterHeader,children:[this.renderOperatorSelect(),(0,me.jsx)($.Z,{style:this.styles.clearButton,onClick:this.handleClear,children:(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Clear",id:"searchDateFilter.clearButton.label"})})]}),(0,me.jsxs)("div",{style:this.styles.quickDatesWrapper,children:[(0,me.jsx)(er,{date:"today",onClick:this.updateTemporary,onDismiss:this.handleMenuClose}),(0,me.jsx)(er,{date:"pastWeek",onClick:this.updateTemporary,onDismiss:this.handleMenuClose}),(0,me.jsx)(er,{date:"pastMonth",onClick:this.updateTemporary,onDismiss:this.handleMenuClose})]}),(0,me.jsx)(Xs.Z,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:t,onDismiss:this.handleMenuClose,hideDateInputMenuItems:!0})]})},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t}=this.stores;e||t.setState({...t.state,isOpen:!0,focus:"starting"})},this.handleMenuClose=e=>{const{onMenuDismiss:t}=this.props,{store:s}=this.stores,{temporaryDateRange:r,dateFilterType:i}=s.state;g.zD(e)||(this.updateFilter(i,r),s.setState({...s.state,isOpen:!1}),t&&t())},this.handleClear=()=>{const{store:e}=this.stores,{dateFilterType:t}=e.state;this.updateFilter(t,{starting:void 0,ending:void 0}),e.clearTemporaryDateRange()},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t}=this.stores;if(e.error)return;t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}});const{dateFilterType:s,temporaryDateRange:r}=t.state,{starting:i,ending:n}=r;i&&n&&this.updateFilter(s,{starting:i,ending:n})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},sectionMenuItem:{display:"flex"},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"},quickDatesWrapper:{marginTop:12,boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,paddingBottom:15,marginBottom:15},clearButton:{color:this.theme.mediumTextColor,fill:this.theme.lightIconColor,fontWeight:500,fontSize:13,paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:3,flexShrink:0},dateFilterHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginLeft:12,marginRight:12}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{store:t}=this.stores,s=this.styles;return(0,me.jsx)(Re.Z,{style:s.sectionMenuItem,children:(0,me.jsx)(Gs.Z,{capture:t.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey,children:(0,me.jsx)(Os.ZP,{popupType:this.getPopupType(),open:t.state.isOpen,origin:this.renderPillButtonOrigin(),render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:Os.ZP.Placement.Bottom,alignmentToOrigin:Os.ZP.Alignment.Start,keepFocus:!0,style:s.popup})})})}updateFilter(e,t){M.ZP.updateFilters({[e]:t})}getHumanReadableDateFilterType(e){return{lastEditedTime:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),createdTime:(0,me.jsx)(z.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"})}[e]}updateFilterFromToggle(e){const{value:t}=this.props,{store:s}=this.stores,{dateFilterType:r}=s.state;this.updateFilter(e,t),e!==r&&(this.updateFilter(r,{starting:void 0,ending:void 0}),s.setState({...s.state,dateFilterType:e}))}renderOperatorSelect(){const{device:e}=this.environment,{store:t}=this.stores,{dateFilterType:s}=t.state,r={width:190,items:["createdTime","lastEditedTime"],selectedItem:s,getKey:e=>e,onSelect:e=>this.updateFilterFromToggle(e),renderItem:e=>(0,me.jsx)(G.Z,{title:this.getHumanReadableDateFilterType(e.value),...e}),renderOrigin:t=>(0,me.jsx)($.Z,{...t,style:{paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:3,flexShrink:0},children:(0,me.jsxs)("div",{style:{display:"flex",alignItems:"center",...!e.isMobile&&{color:this.theme.mediumTextColor,fill:this.theme.lightIconColor,fontWeight:500,fontSize:13}},children:[(0,me.jsx)("span",{style:{marginRight:4},children:this.getHumanReadableDateFilterType(s)}),this.renderOperatorChevron()]})})};return(0,me.jsx)(Js.Z,{...r,mobileActionSheet:!0})}renderOperatorChevron(){const{device:e}=this.environment;return(0,Oe.i)({width:10,height:10,...e.isMobile&&{marginTop:2}})}renderMobile(e){const{store:t}=this.stores,s=e===ge.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return(0,me.jsx)(Os.ZP,{popupType:Os.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:s,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:s}=this.props,r=this.styles;return(0,me.jsx)(G.Z,{disabled:s,focused:!1,icon:e(r.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,dateFormat:s,disabled:r,intl:i}=this.props,n=this.styles,o=(0,me.jsxs)("div",{style:n.summary,children:[(0,A.C)(n.iconActiveMobile),g._Q(t,i,s)]});return(0,me.jsx)(Fe.Z,{disabled:r,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:o})}getCurrentValue(){const{store:e}=this.stores,{dateFilterType:t,temporaryDateRange:s}=e.state;return{...M.ZP.state.query.filters[t],...s}}getPopupType(){const{device:e}=this.environment;return e.isMobile?Os.ZP.PopupType.SlideUp:Os.ZP.PopupType.Popup}}tr.displayName="SearchGenericDateFilter";const sr=(0,z.injectIntl)(tr);function rr(e){const t=M.ZP.state.query.sort,s=ct.find((e=>a.Xy(e.sort,t)))??ct[0],r="relevance"===s.sort.field?(0,me.jsx)(z.FormattedMessage,{id:"search.sort.sortOrder.bestMatches.title",defaultMessage:"Sort"}):s.formattedName;return(0,me.jsx)(Te.Z,{disabled:!1,title:r,onClick:e.onClick,icon:(0,Et.T)({width:16,marginRight:6,fill:"currentColor"})})}function ir(){const e=M.ZP.state.query.sort,t=ct.findIndex((t=>a.Xy(t.sort,e))),s=[];for(const r of ct)s.push({key:r.key,render:e=>(0,me.jsx)(G.Z,{...e,title:r.formattedName}),action:()=>{M.ZP.setState({...M.ZP.state,query:{...M.ZP.state.query,sort:r.sort}})}});return(0,me.jsx)(k.Z,{menuType:p.og.Popup,children:(0,me.jsx)(Le.Z,{type:Le.i.Vertical,initialFocus:t<0?0:t,sections:[{key:"sortOptions",items:s,render:e=>(0,me.jsx)(ee.Z,{...e,disableDesktopPadding:!0})}]})})}const nr=function(){window.__c={n:"SearchSortButton"};const e=(0,o.yK)((()=>({popup:{paddingTop:12,paddingBottom:8}})),[]);return(0,me.jsx)(J.ZP,{popupType:J.Z4.Popup,renderOrigin:rr,render:ir,disabled:!1,placementToOrigin:Os.ZP.Placement.Bottom,alignmentToOrigin:Os.ZP.Alignment.Start,style:e.popup})},or="SearchFilterSettings";function ar(e){window.__c={n:"SearchFilterBar"};const{isQuickSearch:t}=(0,r.useContext)(F.SearchStaticContext),s=(0,n.qz)(void 0,K.Z),{isMobile:l}=e,{parentStore:d}=(0,r.useContext)(F.SearchStoresContext),c=(0,i.O7)(),u=(0,n.VK)((()=>c.currentUser.id),[c]),h=(0,n.VK)((()=>M.ZP),[]),p=(0,n.Kw)(h),g=p.query.filters,m=(0,n.VK)((()=>C.default.state.isPublicPageSearch),[]),f=(0,n.VK)((()=>(0,W.bq)()&&U.default.checkGate("enable_search_team_filter")&&!m),[m]),y=(0,n.VK)((()=>!m),[m]),x=!1,S=(0,o.yK)((e=>({scroller:{display:"flex",alignItems:"center",paddingTop:10,paddingRight:12,paddingBottom:10,paddingLeft:12},barContainer:{display:"flex",alignItems:"center"},scrollerContainer:{position:"relative",flexGrow:0,overflow:"hidden"},draggableList:{display:"flex",flexShrink:0,marginLeft:6},divider:{height:16,width:1,borderRadius:1,backgroundColor:e.stroke.deemphasized}})),[]),b=(0,r.useCallback)((e=>t=>h.updateFilters({[e]:t})),[h]),j=(0,r.useCallback)((()=>{s.setState({...s.state,open:!1})}),[s]),w=(0,r.useCallback)((e=>{e&&u&&(v.default.update((t=>({...t,currentSpaceViewStore:e,currentSpaceStore:null==e?void 0:e.getSpaceStore()}))),yt.Z.reinitializeState(c,u,e.id))}),[u,c]),k=(0,r.useCallback)((()=>{if(y)return(0,me.jsx)(xe.Z,{mode:ge.z.Pill,focused:!1,title:(0,me.jsx)(zs,{filterUIName:"personFilter"}),parentStore:d,userIds:g.createdBy,onMenuDismiss:j,onChange:b("createdBy")})}),[y,d,g.createdBy,j,b]),I=(0,r.useCallback)((()=>f&&(0,me.jsx)(Ie,{mode:ge.z.Pill,focused:!1,title:(0,me.jsx)(zs,{filterUIName:"teamsFilter"}),parentStore:d,teamIds:g.inTeams,onMenuDismiss:j,onChange:b("inTeams")})),[d,g.inTeams,j,b,f]),T=(0,r.useCallback)((()=>(0,me.jsx)(ye,{mode:ge.z.Pill,focused:!1,title:(0,me.jsx)(zs,{filterUIName:"pageFilter"}),parentStore:d,blockIds:g.ancestors,onMenuDismiss:j,onChange:b("ancestors")})),[d,g.ancestors,j,b]),P=(0,r.useCallback)((()=>null),[d,g.dev_excludedPages,j,b,x]),R=(0,r.useCallback)((()=>null),[d,g.dev_excludedTeams,j,b,x]),Z=(0,r.useCallback)((()=>(0,me.jsx)(sr,{mode:ge.z.Pill,focused:!1,title:(0,me.jsx)(zs,{filterUIName:"dateFilter"}),icon:A.C,value:g.lastEditedTime,onMenuDismiss:j})),[g.lastEditedTime,j]),B=(0,r.useCallback)((()=>!l&&(0,me.jsx)(Be,{mode:ge.z.Pill,focused:!1,title:(0,me.jsx)(zs,{filterUIName:"titleToggle"}),icon:Fs.V,value:g.navigableBlockContentOnly||!1,onChange:b("navigableBlockContentOnly")})),[g.navigableBlockContentOnly,b,l]),O=(0,r.useCallback)((()=>t&&(0,me.jsx)(_s,{onChange:w})),[t,w]);(0,r.useEffect)((()=>{const e=Rs.Z.get({userId:u,key:or});e&&a.Xy(new Set(e.filterOrder),new Set(p.filterState.filterOrder))&&!a.Xy(e.filterOrder,p.filterState.filterOrder)&&e.filterOrder&&h.updateFilterState(e)}),[p.filterState.filterOrder,u,h]);const L={workspaceSwitcher:O(),titleToggle:B(),personFilter:k(),teamsFilter:I(),pageFilter:T(),dateFilter:Z(),dev_notInPageFilter:P(),dev_notInTeamFilter:R()};const D=(0,r.useCallback)((()=>(0,me.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,me.jsx)(nr,{}),(0,me.jsx)("div",{style:S.divider})]})),[S.divider]);return(0,me.jsx)("div",{style:S.barContainer,children:(0,me.jsx)("div",{style:S.scrollerContainer,children:(0,me.jsxs)(As.Z,{type:Zs.Z.X,style:S.scroller,showLeftRightOverlay:!1,children:[(0,me.jsx)(me.Fragment,{children:D()}),(0,me.jsx)(me.Fragment,{children:(0,me.jsx)(Bs.ZP,{direction:"horizontal",keys:p.filterState.filterOrder,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,renderKey:e=>L[e],style:S.draggableList,onDrop:e=>function(e){const t={...p.filterState,filterOrder:e};Rs.Z.set({userId:u,key:or,value:t}),h.updateFilterState(t)}(e)})})]})})})}var lr=s(68785),dr=s(33411),cr=s(25904),ur=s(1800),hr=s(54642),pr=s(47307),gr=s(64964),mr=s(31194),fr=s(1310),vr=s(16354),yr=s(43765),xr=s(92660);const Sr=(0,z.defineMessages)({additionalInformationPlaceholder:{id:"SearchBadResultsForm.additionalInformation.placeholder",defaultMessage:"Any additional comments or context (e.g. ...)"},urlPlaceholder:{id:"SearchBadResultsForm.url.placeholder",defaultMessage:"Link to page you were looking for"}}),br=e=>{window.__c={n:"SearchResultPicker"};const t=(0,o.Fg)(),s=(0,n.qz)(void 0,K.Z);return(0,me.jsx)(J.ZP,{popupType:J.Z4.Popup,buttonPopupStore:s,renderOrigin:e=>(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)(Y.Z,{style:{width:"100%"},...e,children:[(0,me.jsx)(yr.Z,{title:"Select Result"}),(0,Oe.i)({width:10,marginLeft:4,fill:t.lightIconColor})]})}),placementToOrigin:mr.Iw.Bottom,alignmentToOrigin:mr.lU.Start,render:t=>{var s;const r=[{key:"results",render:e=>(0,me.jsx)(ee.Z,{...e,topBorder:0!==e.index}),items:(null===(s=e.results)||void 0===s?void 0:s.map((s=>({key:s.id,render:e=>(0,me.jsx)(ce.Z,{store:s.store,checkState:!1,hidePath:!0,...e}),action:()=>{e.onSelect(s),t.close()}}))))||[]}],i={menuType:p.og.Popup,width:240};return(0,me.jsx)(k.Z,{...i,children:(0,me.jsx)(Le.Z,{type:Le.i.Vertical,initialFocus:void 0,sections:r})})}})};function Cr(){cr.Z.reset()}const Mr=e=>{var t;let{searchStoreState:s,currentSpaceStore:r,serverResults:i,localResults:n,environment:o,experiments:a}=e;const l=cr.Z.getState(),d=g.AX(i),c=g.AX(n),u={query:s.query,limit:s.limit,debug:"everything"},{publicAccessPermissionAncestorBlockId:h}=g.bC(o),p=g.gC({input:u,spaceId:null==r?void 0:r.id,publicAccessPermissionAncestorBlockId:h,source:"report_bad_search"});if(!p)return;const m=null===(t=document.getElementsByClassName("search-results-list")[0])||void 0===t?void 0:t.outerHTML,f="on"===(null==a?void 0:a["vector-search-vanilla-ltr"])||d.some((e=>e.sources.includes(Ce.vp.VectorDBBlock)||e.sources.includes(Ce.vp.VectorDBCollection)));f&&d.splice(0,-20);const v={queryText:s.query.text.trim(),apiRequest:p,serverResults:JSON.stringify(d,null,2),localResults:JSON.stringify(c,null,2),desiredUrl:l.desiredUrl,additionalInformation:l.additionalInformation,renderedHtml:m,experiments:JSON.stringify(a??{},null,2),isVectorSearchEnabled:f};hr.reportBadSearch(o,v).then((e=>{if("failed"===e.type)pr.showErrorMessage((0,me.jsx)("h1",{children:"Failed to submit report"}));else{const{url:t}=e.data;gr.oV({label:(0,me.jsx)("div",{children:(0,me.jsx)(vr.Z,{href:t,children:"Your report has been submitted, thanks!"})}),durationMs:fr.JY})}})),cr.Z.reset()},jr=function(e){window.__c={n:"ReportBadSearchForm"};const{serverResults:t,localResults:s,experiments:a}=e,l=(0,o.yK)((e=>({textArea:{width:"100%",background:e.popoverBackground,display:"block",marginTop:17,marginBottom:17},urlArea:{width:"100%",height:"50%",background:e.popoverBackground,display:"block",marginTop:17,marginBottom:17},modalWrap:{width:360,padding:24,fontSize:14},modalTitle:{fontSize:16,marginBottom:12,fontWeight:N.Z.fontWeight.medium},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18},outlineButton:{marginRight:12}})),[]),[d]=(0,r.useState)(M.ZP),c=(0,n.VK)((()=>v.default.state.currentSpaceStore),[]),[u,h]=(0,n.AF)(cr.Z),p=(0,i.O7)(),m=(0,r.useCallback)((e=>{h({...u,desiredUrl:e?(0,ur.Z)({pageId:e.store.id,pageModel:e.store.getModel(),baseUrl:H.default.domainBaseUrl,pageVisitSource:void 0}):void 0})}),[u,h]),f=(0,r.useCallback)((()=>{Mr({searchStoreState:d.state,currentSpaceStore:c,serverResults:t,localResults:s,experiments:a,environment:p})}),[d,c,t,s,a,p]);return(0,me.jsx)(xr.Z,{onDismiss:Cr,render:()=>(0,me.jsx)(j.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:e=>(0,me.jsxs)("div",{style:l.modalWrap,...e,children:[(0,me.jsx)("div",{style:l.modalTitle,children:(0,me.jsx)(z.FormattedMessage,{id:"SearchBadResultsForm.title",defaultMessage:"Report Bad Search"})}),(0,me.jsx)(Je.Z,{textarea:!0,style:l.textArea,placeholder:oe.default.formatMessage(Sr.additionalInformationPlaceholder),value:u.additionalInformation,onChange:e=>{h({...u,additionalInformation:e.target.value})},focusInitial:!0}),(0,me.jsx)(br,{results:g.oO({localResults:s,serverResults:t}),onSelect:m}),(0,me.jsx)(Je.Z,{textarea:!0,style:l.urlArea,placeholder:oe.default.formatMessage(Sr.urlPlaceholder),value:u.desiredUrl,onChange:e=>{h({...u,desiredUrl:e.target.value})}}),(0,me.jsxs)("div",{style:l.buttonArea,children:[(0,me.jsx)(kt.Z,{isLarge:!0,onClick:Cr,style:l.outlineButton,children:(0,me.jsx)(z.FormattedMessage,{id:"SearchBadResultsForm.cancelButton.label",defaultMessage:"Cancel"})}),(0,me.jsx)(kt.Z,{isRed:!0,isLarge:!0,onClick:f,disabledFeedback:!0,children:(0,me.jsx)(z.FormattedMessage,{id:"SearchBadResultsForm.reportButton.label",defaultMessage:"Submit"})})]})]})}),requireOnline:!0,modalStore:cr.Z})};function wr(e){window.__c={n:"ReportBadSearchButton"};const[t,s]=(0,n.AF)(cr.Z),r=(0,o.yK)((t=>({button:{...Ot(t),...e.buttonStyles}})),[e.buttonStyles]);return(0,me.jsxs)(kt.Z,{style:r.button,onClick:()=>{s({...t,open:!0})},children:[(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Report bad search",id:"search.header.badSearch.button.label"}),(0,me.jsx)(jr,{...e})]})}class kr extends R.Z{constructor(){super(...arguments),this.storeTypes={requestModalOpen:Vt.default.createClass(!1),responseModalOpen:Vt.default.createClass(!1)},this.styles={footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?N.Z.fontSize.UIRegular.mobile:N.Z.fontSize.UIRegular.desktop}},footerText:{fontSize:Bt.yv(this.environment,"UISmall"),...N.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},resultCountWrapper:{display:"flex",alignItems:"center",...N.Z.textOverflowStyle},resultCount:{fontWeight:N.Z.fontWeight.medium},resultText:{verticalAlign:"middle",marginRight:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginRight:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*Bt.yv(this.environment,"UISmall")},commandGlyph:{fontSize:.75*Bt.yv(this.environment,"UIRegular")},footerDebugButton:Ot(this.theme),debugModalStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},navigationHints:{marginLeft:15}}}renderComponent(){const{localResults:e,serverResults:t}=this.props.searchResultStore.state,{shouldShow:s}=this.props;if(!s)return;const r=this.styles,i=this.getThemeColors(),n={...r.resultCount,...i.resultCount},{count:o,isLowerBound:a}=this.props.searchResultStore.getResultCount(),l=(0,me.jsx)("span",{style:r.resultText,children:a?this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCountApproximate",defaultMessage:"{resultCount, plural, other {<resultwrapper>{resultCount}+</resultwrapper> results}}"},{resultCount:o,resultwrapper:e=>(0,me.jsx)("span",{style:n,children:e})}):this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCount",defaultMessage:"{resultCount, plural, one {<resultwrapper>{resultCount}</resultwrapper> result} other {<resultwrapper>{resultCount}</resultwrapper> results}}"},{resultCount:o,resultwrapper:e=>(0,me.jsx)("span",{style:n,children:e})})}),d=C.default.state.intentBasedSearch.enablesGrouping,c=d?(0,me.jsx)(qt,{}):(0,me.jsxs)("div",{style:r.resultCountWrapper,children:[d?void 0:(0,me.jsxs)("div",{children:[l,this.renderSpinner(this.props.showSpinner)]}),(0,me.jsx)("div",{style:r.navigationHints,children:(0,me.jsx)(qt,{})})]});return(0,me.jsx)(Lt,{title:c,right:(0,me.jsxs)(me.Fragment,{children:[!1,this.renderSearchDebugButtons()]})})}renderSpinner(e){const t=this.styles;return(0,me.jsx)(dr.Z,{show:e,showDelay:500,showHold:200,render:e=>e&&(0,me.jsx)(lr.Z,{style:t.spinner})})}renderSearchDebugButtons(){var e;if(!b.ZP.state.debug&&!b.ZP.state.showDebugInfo)return;const{rawRequests:t,rawResponses:s}=(null===(e=this.props.searchResultStore.state.serverResults)||void 0===e||null===(e=e.debugInfo)||void 0===e?void 0:e.response)||{};return(0,me.jsxs)(me.Fragment,{children:[t&&(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(os.Z,{open:this.stores.requestModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.requestModalOpen.setState(!1)},render:()=>(0,me.jsx)(es.LazyAdminReactJson,{showCopyButton:"large",defaultCollapsed:!1,data:t})}),(0,me.jsx)(kt.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.requestModalOpen.setState(!0),children:"Open Request"})]}),s&&(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(os.Z,{open:this.stores.responseModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.responseModalOpen.setState(!1)},render:()=>(0,me.jsx)(es.LazyAdminReactJson,{showCopyButton:"large",data:{rawResponses:s},defaultCollapsed:!1})}),(0,me.jsx)(kt.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.responseModalOpen.setState(!0),children:"Open Response"})]})]})}getThemeColors(){return{footerText:{color:this.theme.lightTextColor},resultCount:{color:this.theme.mediumTextColor},keyboardShortcut:{color:this.theme.mediumTextColor}}}}kr.displayName="SearchResultsFooter";const Ir=(0,z.injectIntl)(kr);var Tr=s(73935),Pr=s(36896),Fr=s(44604),Rr=s(36596),Zr=s(39634);class Br extends R.Z{constructor(){super(...arguments),this.styles={menuItem:{minHeight:void 0,...this.environment.device.isMobile&&{background:void 0,boxShadow:void 0},paddingTop:32,paddingBottom:32},text:{textAlign:"center"},title:{margin:0,fontWeight:N.Z.fontWeight.medium,fontSize:Bt.yv(this.environment,"UIRegular"),lineHeight:Bt.Dp(this.environment,"UIRegular")},caption:{fontSize:Bt.yv(this.environment,"UIRegular")}}}renderComponent(){const{style:e,captionStyle:t,...s}=this.props,r={...this.styles.menuItem,...e},i={...this.styles.caption,...t};return(0,me.jsx)(it.Z,{...s,title:this.renderTitle(),caption:this.renderCaption(i),textWrapperStyle:this.styles.text,style:r,captionStyle:i})}renderTitle(){const{title:e}=this.props;if(!e)return;const t=this.styles,s=this.getThemeColors(),r={...t.title,...s.title};return(0,me.jsx)("h4",{role:"alert",style:r,children:e})}renderCaption(e){const{caption:t}=this.props;if(!t)return;const s={...e,...this.getThemeColors().caption};return(0,me.jsx)("div",{style:s,children:t})}getThemeColors(){return{title:{color:this.theme.mediumTextColor},caption:{color:this.theme.lightTextColor}}}}Br.displayName="ErrorMenuItem",Br.contextTypes={...p.mw,...R.w};const Ar=Br,Or=(0,me.jsx)(z.FormattedMessage,{defaultMessage:"No results",id:"searchErrorMenuItem.error.noResults"});const Lr=function(e){window.__c={n:"SearchErrorMenuItem"};const t=(0,o.yK)((e=>({menuItem:{marginTop:"auto",marginBottom:"auto"},caption:{marginTop:"auto"},reportProblemButton:{display:"inline",color:e.blueColor},searchDeletedButton:{display:"inline",lineHeight:"25px",color:e.blueColor}})),[]),s=(0,i.O7)(),{isQuickSearch:a}=(0,r.useContext)(F.SearchStaticContext),l=()=>{Zr.j({environment:s,from:"quick_find"})};function d(s){const r=function(s){if(s)return;const r=g.FN(c);if(!g.VD.isDeletedOnly(c.isDeletedOnly))return(0,me.jsx)(z.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.searchDeleted",defaultMessage:"Some results may be in your deleted pages.{br}<searchdeleted>Search deleted pages</searchdeleted>",values:{searchdeleted:s=>(0,me.jsx)(vr.Z,{onClick:e.handleSearchDeletedOnly,style:t.searchDeletedButton,children:s}),br:(0,me.jsx)("br",{})}});return r?(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Try different search terms or filters",id:"searchErrorMenuItem.errorPrompt.searchTermsAndFilters"}):(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Try different search terms",id:"searchErrorMenuItem.errorPrompt.searchTerms"})}(s);return{title:Or,caption:r}}const c=(0,n.VK)((()=>M.ZP.state.query.filters),[]);return(0,me.jsx)(Ar,{...function(s){const r=e.error;switch(r.type){case Ce.Ix.NoResults.type:return d(s);case Ce.Ix.Offline.type:return function(){const e=(0,me.jsx)(z.FormattedMessage,{defaultMessage:"Go online for more results.",id:"searchErrorMenuItem.errorPrompt.goOnline"});return{title:Or,caption:e}}();case Ce.Ix.RequestFailed.type:return{title:(0,me.jsx)(z.FormattedMessage,{id:"searchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:(0,me.jsx)(z.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:e=>(0,me.jsx)(vr.Z,{onClick:l,style:t.reportProblemButton,children:e})}})};default:(0,V.t1)(r)}}(a??!1),style:t.menuItem,captionStyle:t.caption,shouldWrapCaption:!0})};const Dr=7;function Er(e){window.__c={n:"SearchResultShimmers"};const{numberOfShimmerResults:t,assistantActionsEnabled:s}=e,r=t===Dr&&s,i=(0,o.yK)((e=>({container:{margin:(r?"0px":"8px")+" 10px 6px 10px",display:"flex",flexDirection:"column",gap:10},icon:{width:30,height:30,borderRadius:5},titleAndPath:{width:"100%",display:"flex",flexDirection:"column",gap:5},title:{height:25,borderRadius:5},path:{height:15,width:"30%",borderRadius:5},resultContainer:{display:"flex",gap:10,boxShadow:`0 1px 0 ${e.lightDividerColor}`,paddingBottom:10},sectionHeader:{marginBottom:7,marginTop:8}})),[r]),n=Array.from({length:t},(()=>!0));return(0,me.jsxs)("div",{children:[r&&(0,me.jsx)(ee.Z,{desktopTitleStyle:i.sectionHeader,title:(0,me.jsx)(z.FormattedMessage,{id:"search.searchResultsShimmer.bestMatches.text",defaultMessage:"Best matches"})}),(0,me.jsx)("div",{style:i.container,children:n.map(((e,t)=>(0,me.jsxs)("div",{style:{...i.resultContainer,...t===n.length-1&&{boxShadow:"none"}},children:[(0,me.jsx)(Rr.Z,{style:i.icon}),(0,me.jsxs)("div",{style:i.titleAndPath,children:[(0,me.jsx)(Rr.Z,{style:{...i.title,width:a.UP(["30%","45%","55%","60%","70%","75%","80%","90%"])}}),(0,me.jsx)(Rr.Z,{style:{...i.path,width:a.UP(["10%","15%","20%","25%","30%","35%","55%","70%"])}})]})]},`shimmer-item-${t}`)))})]})}const _r=r.memo(Er);function qr(e,t){if(!e.isLoading)return e.showMajorError?(0,me.jsx)(Lr,{error:e.serverError,handleSearchDeletedOnly:()=>{const e=M.ZP.state.query.text;u.IB(),Pr.Z.setState({...Pr.Z.state,open:!0}),Fr.Z.setState({...Fr.Z.state,currentTab:"all_pages",filter:e,limit:Fr.Z.startLimit})}}):e.serverError&&e.serverError!==Ce.Ix.NoResults?function(e,t){return(0,me.jsx)(ee.Z,{disableMobilePadding:!0,disableMobileBorders:!0,children:(0,me.jsx)(yr.Z,{title:e,style:t})})}(e.serverError.message,t):void 0}function Vr(e,t){return(0,me.jsx)(ee.Z,{disableMobilePadding:!0,disableMobileBorders:!0,topBorder:!1,style:{marginTop:0,paddingTop:0},children:(0,me.jsx)(it.Z,{body:e,bodyStyle:t})})}const Nr=(0,z.injectIntl)((function(e){var t,s,l,d,c,p;window.__c={n:"SearchResultsMenuList"};const[m,f]=(0,r.useState)(!1),v=(0,i.Fy)().isMobile,x=(0,o.yK)((e=>({results:{flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%"},messageMenuItem:{...v&&{background:void 0,boxShadow:void 0}},debugMessageMenuItemTextStyle:{whiteSpace:"pre-wrap",fontFamily:"monospace",marginTop:0},actionMenuItemTitle:{fontWeight:N.Z.fontWeight.medium,lineHeight:"20px",fontSize:15,color:e.mediumTextColor,textOverflow:"ellipsis",overflow:"hidden",display:"block"},menuListContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:v?13:void 0,marginBottom:4}})),[v]),{searchResultStore:S,localResults:j,serverResults:w,resultListStore:k,searchExperimentOverrides:I,intl:T,showActions:P,extraTopPadding:R}=e,Z=e.errorState,B=(0,n.VK)((()=>M.ZP.state.query.text),[]),A=P.length>0?{key:"actions",render:e=>(0,me.jsx)(ee.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,extraTopPadding:R,title:(0,me.jsx)(z.FormattedMessage,{id:"search.searchActions.actions.text",defaultMessage:"Actions"})}),items:a.oA(P.map((e=>function(e){const{type:t,title:s,icon:r,action:i}=e;return{key:`actionMenuItem.${t}`,action:i,render:e=>(0,me.jsx)(Rt,{type:t,...e,title:s,icon:r})}}({...e,title:e.renderTitle(B,T,x.actionMenuItemTitle)}))))}:void 0,O=(0,n.VK)((()=>C.default.state.intentBasedSearch.enablesGrouping),[]),L=(0,g.IV)({intentBasedGrouping:O,localResults:j,serverResults:w}),{allSearchResults:D}=L,E=(0,r.useCallback)((t=>{const{results:s,sectionTitle:i,compact:n,rendersTimeSinceLastViewedMs:o}=t,{id:l,title:d}=function(e){if(!e)return{id:"allSearchResults",title:void 0};switch(e.type){case"unique-id":return{id:"uniqueIdSearchResults",title:(0,me.jsx)(z.FormattedMessage,{id:"search.searchResultBuckets.uniqueID.text",defaultMessage:"ID matches"})};case"jump-back-in":return{id:"jumpBackInSearchResults",title:(0,me.jsx)(z.FormattedMessage,{id:"search.searchResultBuckets.topResults.text",defaultMessage:"Top results"})};case"server":return{id:"serverOnlySearchResults",title:(0,me.jsx)(z.FormattedMessage,{id:"search.searchResultBuckets.server.text",defaultMessage:"{count}{maybeLowerBoundSign} results",values:{count:e.values.count,maybeLowerBoundSign:e.values.isLowerBound?"+":""}})};case"main":return{id:"mainSearchResults",title:(0,me.jsx)(z.FormattedMessage,{id:"search.searchResultBuckets.bestMatches.text",defaultMessage:"Best matches"})};default:(0,V.t1)(e)}}(i);return s.length>0?{key:l,render:e=>(0,me.jsx)(ee.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:d}),items:a.oA(s.map(((t,s)=>{var i,a;return function(e){var t;const{selectedResult:s,index:i,globalIndexOffset:n,sectionName:o,allSearchResults:a,props:l,compact:d,timeSinceLastViewedMs:c}=e,{store:u}=s,p=u.isNavigableBlock()?u:u.getNavigableBlockStore();if(!p)return;const g=r.createRef(),m=Boolean(b.ZP.getDebugLevel()),f=m&&s.sources.includes(Ce.vp.Local)?{score:s.score,frecencyScore:s.frecencyScore,localSource:s.localSource,personalizationBoost:s.personalizationBoost,id:s.id}:void 0,v=m&&(s.sources.includes(Ce.vp.ElasticSearch)||s.sources.includes(Ce.vp.VectorDBBlock)||s.sources.includes(Ce.vp.VectorDBCollection))?null===(t=l.debugInfo)||void 0===t||null===(t=t.response)||void 0===t?void 0:t.resultsDebugMap[u.id]:void 0,y=l.clusterInfo,x=Date.now();return{key:`${u.id}:${i}`,action:e=>{const{event:t}=e;function r(e){const s=Tr.findDOMNode(e.current);return Boolean(s&&"target"in t&&t.target&&(s===t.target||s.contains(t.target)))}g.current&&r(g)||l.handleSelectResult({action:{...e,index:e.index+(n??0)},selectedResult:s,sectionName:o,allSearchResults:a})},render:e=>{var t;return(0,me.jsx)(bs,{...e,index:i,originalPosition:s.originalPosition,isFirstInSection:0===i,store:p,hidePath:!1,result:s,className:h.ulv,debugLocal:f,debugHits:v,debugAreaRef:g,clusterInfo:y,inline:d&&!m,inlineCaptionMinWidthPercentage:20,lastViewed:c?x-c:void 0,queryId:null===(t=s.serverEventProperties)||void 0===t?void 0:t["server-queryId"],type:"query_results"})}}}({selectedResult:t,index:s,globalIndexOffset:-((null==A||null===(i=A.items)||void 0===i?void 0:i.length)??0),sectionName:l,allSearchResults:D,props:e,compact:n,timeSinceLastViewedMs:o&&null!==(a=t.localSource)&&void 0!==a&&a.has("recentVisit")?t.timeSinceLastViewedMs:void 0})})))}:void 0}),[null==A||null===(t=A.items)||void 0===t?void 0:t.length,D,e]),_=(0,n.VK)((()=>E({results:"intent-based-grouping"===L.type?L.sections.jumpBackInSearchResults:[],sectionTitle:{type:"jump-back-in"},compact:!0,rendersTimeSinceLastViewedMs:!0})),[E,L.sections,L.type]),q=(0,n.VK)((()=>{const e="intent-based-grouping"===L.type?L.sections.serverOnlySearchResults:[],{count:t,isLowerBound:s}=S.getResultCount();return E({results:e,sectionTitle:{type:"server",values:{count:t,isLowerBound:s}},compact:!1})}),[E,L.sections,L.type,S]),H=(0,n.VK)((()=>E({results:"uniqueIdSearchResults"in L.sections?L.sections.uniqueIdSearchResults:[],sectionTitle:{type:"unique-id"},compact:!1})),[E,L.sections]),W=(0,n.VK)((()=>E({results:"unique-id"===L.type?L.sections.nonUniqueIdSearchResults:"all"===L.type?L.sections.allSearchResults:[],sectionTitle:"unique-id"===L.type||((null==A?void 0:A.items)??[]).length>0?{type:"main"}:void 0,compact:!1})),[null==A?void 0:A.items,E,L.sections,L.type]),K=[A,_,H,q,W].filter(V.$K),U=null===(s=e.debugInfo)||void 0===s||null===(s=s.response)||void 0===s?void 0:s.parsedQueries,Q=null===(l=e.debugInfo)||void 0===l||null===(l=l.response)||void 0===l?void 0:l.detectedLanguages,$=null===(d=e.debugInfo)||void 0===d?void 0:d.traceLogs,G=null===(c=e.debugInfo)||void 0===c||null===(c=c.response)||void 0===c?void 0:c.debugUrls,J=(0,r.useCallback)(((t,s)=>{const{onMaybeLoadMoreResults:r}=e,i=t<=200;i&&!m&&r(),f(i),s.offsetFromTop&&M.ZP.update((e=>({...e,hasScrolled:!0})))}),[m,e]),X=W||q?(null==A||null===(p=A.items)||void 0===p?void 0:p.length)??0:0,Y=(0,n.VK)((()=>y.Z.showSearchAiFeatures()),[]),te=(0,n.VK)((()=>{const e=void 0===w;if(!(e&&(Y||u.yt())))return 0;const t=S.state.serverResultsLoading,s=(null==j?void 0:j.length)??0,r="serverError"in Z&&void 0!==Z.serverError;return(e&&!t||t)&&!r?Dr-s:0}),[S,null==j?void 0:j.length,w,Z,Y]);return(0,me.jsx)(F.SearchStaticContext.Consumer,{children:e=>{let{queryResultsSectionRef:t}=e;return(0,me.jsxs)("section",{style:x.results,ref:t,children:[!a.xb(I)&&Vr((0,me.jsx)(me.Fragment,{children:(0,me.jsx)(es.LazyAdminReactJson,{data:{searchExperimentOverrides:I},showCopyButton:!1,showModalButton:!1,defaultCollapsed:!1})}),x.debugMessageMenuItemTextStyle),U&&Vr((0,me.jsx)(es.LazyAdminReactJson,{data:{parsedQueries:U},customCollapsedRenderers:[Kr],showCopyButton:"small",showModalButton:!0,defaultCollapsed:!0}),x.debugMessageMenuItemTextStyle),Q&&Vr((0,me.jsx)(es.LazyAdminReactJson,{data:{detectedLanguages:Q},customCollapsedRenderers:[Wr]}),x.debugMessageMenuItemTextStyle),$&&Vr((0,me.jsx)(es.LazyAdminReactJson,{data:{tracer:{traceLogs:$}},customCollapsedRenderers:[Hr],defaultCollapsed:!0}),x.debugMessageMenuItemTextStyle),G&&Vr((0,me.jsx)(es.LazyAdminReactJson,{data:{debugUrls:G},defaultCollapsed:!0,customCollapsedRenderers:[Qr],showCopyButton:"small",showModalButton:!0,maxLinkValueLength:40}),x.debugMessageMenuItemTextStyle),K&&(0,me.jsx)("div",{className:"search-results-list",children:(0,me.jsx)(Le.Z,{type:Le.i.Vertical,initialFocus:X,store:k,disableKeyboardArrowWrap:!0,sections:K,style:x.menuListContainer})}),qr(Z,x.messageMenuItem)||(0,me.jsx)(Ct.Z,{onChange:J}),te>0&&(0,me.jsx)(_r,{numberOfShimmerResults:te,assistantActionsEnabled:Y})]})}})}));function zr(e){const t=e.replaceAll(/\(MatchNoDocsQuery\("Matching no documents because no terms present"\)\)\^[0-9\.]/g,"").replaceAll(/MatchNoDocsQuery\("Matching no documents because no terms present"\)/g,"").replaceAll(/ConstantScore\(([^)]+):([^)]+)\)/g,"<i>$1</i>:<b>$2</b>").replace(/function score \(\((.*)\), functions:.*\)/,"$1").replaceAll("( ","(").replaceAll(" )",")").replaceAll("|","| <br/>").replaceAll(/([^( ]+):"([^"]+)"/g,'<i>$1</i>:<b>"$2"</b>').replaceAll(/([^( ]+):([^) ]+)/g,"<i>$1</i>:<b>$2</b>");return(0,me.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})}const Hr=e=>{let{data:t,keyPath:s}=e;if("traceLogs"===(null==s?void 0:s[0])&&a.PO(t)&&Array.isArray(t.log)&&t.log.length>0){const{log:e,startTimeMs:s}=t;return{element:(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)("div",{children:(0,me.jsx)("b",{children:`Trace started at ${s}`})}),e.map(((e,t)=>(0,me.jsxs)("div",{children:[(0,me.jsx)("span",{style:Ur,children:`[${e.timestamp-s}ms][${e.callerFileName.split(".")[0]}]`}),(0,me.jsx)("span",{children:`${e.msg}`})]},t)))]}),expanded:!1}}return null},Wr=e=>{let{data:t,keyPath:s}=e;return"detectedLanguages"===s.join(".")&&a.PO(t)?{element:(0,me.jsx)(me.Fragment,{children:Object.entries(t).filter((e=>{let[t,s]=e;return Boolean(s)})).map((e=>{let[t]=e;return t})).join(", ")||"None"}),expanded:!1}:null},Kr=e=>{var t,s;let{data:r,keyPath:i}=e;const n=r,o=Object.values(n).find((e=>void 0!==e));if(!o)return null;if(!["type","description","time_in_nanos"].every((e=>o[e])))return null;if(1===i.length)return{element:zr(o.description),expanded:!1};let a=o.description??"";return null!==(t=a)&&void 0!==t&&t.includes("permissions.teamIds")&&(a="PermissionsQuery"),null!==(s=a)&&void 0!==s&&s.includes("(_id:[")&&(a="BoostRecentPageIds"),{element:zr(a),expanded:!1}},Ur={color:"blue"},Qr=e=>{let{data:t}=e;const s=t;if(!s)return null;const r=Object.values(s).find((e=>{let{clusterName:t}=e;return void 0!==t}));if(r){const{clusterName:e}=r;return{element:(0,me.jsx)(me.Fragment,{children:e}),expanded:!1}}return{element:(0,me.jsx)(me.Fragment,{children:"unknown"}),expanded:!1}};const $r=function(e){window.__c={n:"SearchResultsBody"};const{searchResultStore:t,sxsMode:s,searchDebugColumnStore:a,extraTopPadding:l}=e,d=(0,i.O7)(),c=(0,i.Fy)(),h=(0,o.yK)((e=>({container:{display:"flex",flexDirection:"column",width:s?"50%":"100%",flex:1,overflow:"hidden"},askAiLabel:{color:e.regularTextColor,fontWeight:N.Z.fontWeight.medium,fontSize:14},askAiQuery:{fontWeight:N.Z.fontWeight.regular},askAiIcon:{fill:e.aiPurpleColor}})),[s]),p=(0,n.qz)(void 0,xt.Z),m=(0,n.VK)((()=>p.state.focus.indexGlobal),[p]),{handleSelectResult:f,globalFocusedIndex:v,searchActionItemsStore:x,isQuickSearch:S}=(0,r.useContext)(F.SearchStaticContext),{localResults:C,serverResults:j,clusterInfo:w,debugInfo:k,serverResultsLoading:I,searchExperimentOverrides:T,hasPublicAccessPermission:P,errorState:R,serverResultsAllLoaded:Z}=(0,n.VK)((()=>{var e,s;const{hasPublicAccessPermission:r}=g.bC(d);return{localResults:t.state.localResults,serverResults:t.state.serverResults,serverResultsLoading:t.state.serverResultsLoading,clusterInfo:null===(e=t.state.serverResults)||void 0===e?void 0:e.clusterInfo,debugInfo:null===(s=t.state.serverResults)||void 0===s?void 0:s.debugInfo,searchExperimentOverrides:a.state.searchExperimentOverrides,hasPublicAccessPermission:r,errorState:t.state.errorState,serverResultsAllLoaded:t.state.serverResultsAllLoaded}}),[t,a,d]),B=!1===R.isLoading&&R.showMajorError,A=Boolean(C||j),O=(0,r.useCallback)((()=>{!I&&!Z&&void 0!==j&&M.ZP.update((e=>({...e,limit:e.limit+M.Xv,isScrolled:!0,source:"quick_find_scroll"})))}),[I,Z,j]),L=(0,n.VK)((()=>g.oO({localResults:null==C?void 0:C.results,serverResults:null==j?void 0:j.results})),[C,j]),D=(0,n.VK)((()=>{if(s)return[];return[{type:"assistant",renderTitle:(e,t,s)=>function(e,t){return(0,me.jsx)("div",{className:"notranslate",style:t,children:e})}((0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)("span",{children:(0,me.jsx)(z.FormattedMessage,{id:"searchResultsBody.askAiMenuItem.title",defaultMessage:"Ask Notion AI"})}),(0,me.jsx)("span",{style:h.askAiQuery,children:e?` “${e}”`:""})]}),{...s,...h.askAiLabel}),icon:e=>(0,pt.t)({...e,...h.askAiIcon}),action:()=>{u.em({environment:d,shouldResetAssistantStore:M.ZP.state.query.text.length>0||(0,vt.Sr)(),isQuickSearch:S})},shouldShow:()=>y.Z.shouldShowSearchMenuItemAskAI()}].filter((e=>e.shouldShow(d)))}),[S,d,h,s],{useDeepEqual:!0}),E=(0,n.VK)((()=>{if(s)return 0;{const e=D.map((e=>({type:e.type})));return x.update((t=>e)),x.state.length}}),[s,D,x]);(0,n.VK)((()=>{const e=t.state.insertedActionResultsCount,s=E;e!==s&&t.update((e=>({...e,insertedActionResultsCount:s})))}),[t,E]);const _=(0,r.useCallback)((()=>p.update((e=>e.focus.isInitialized&&0===e.focus.section&&0===e.focus.indexLocal&&0===e.focus.indexGlobal?e:{...e,focus:D.length>0?{section:1,indexLocal:0,indexGlobal:D.length}:{section:0,indexLocal:0,indexGlobal:0}}))),[p,D]);(0,r.useEffect)((()=>{_()}),[L,_]),(0,r.useEffect)((()=>{v.setState(m)}),[v,m]);const q=(0,n.VK)((()=>{const e=u.yt(),t=b.ZP.state.showDebugInfo;return!B&&A&&!c.isMobile&&!e||t||s}),[c.isMobile,A,B,s]);return(0,me.jsxs)("div",{style:h.container,children:[(0,me.jsx)(Nr,{errorState:R,handleSelectResult:f,onMaybeLoadMoreResults:O,resultListStore:p,searchResultStore:t,localResults:null==C?void 0:C.results,serverResults:null==j?void 0:j.results,debugInfo:k,clusterInfo:w,publicAccessPermission:P,searchExperimentOverrides:T,showActions:D,extraTopPadding:l}),(0,me.jsx)(Ir,{searchResultStore:t,showSpinner:I,shouldShow:q})]})};function Gr(){window.__c={n:"SearchNavigationalView"};const{searchFilterMenuRef:e,handleRecentPageSelect:t,searchResultStore:s,secondarySearchResultStore:a}=(0,r.useContext)(F.SearchStaticContext),l=(0,i.Fy)(),{errorState:d,shouldShowSxSView:c,hasQuery:u}=(0,n.VK)((()=>({shouldShowSxSView:Boolean((0,b.gq)({device:l})&&b.BJ.state.visible),errorState:s.state.errorState,hasQuery:Boolean(M.ZP.state.query.text.trim())||g.VA(M.ZP.state.query.filters)})),[s,l]),h=(0,o.yK)((()=>({container:{display:"flex",flexDirection:"column",width:c?"50%":"100%"},sxsContainer:{display:"flex",flexDirection:"row",height:"100%",overflow:"hidden",maxWidth:"100%"}})),[c]),p=!1===d.isLoading&&d.showMajorError,m=(0,n.VK)((()=>M.ZP.state.showFilterBar),[]),f=!l.isMobile&&!m,y={searchResultStore:s,searchDebugColumnStore:b.v_,sxsMode:c,extraTopPadding:f},x=(0,n.VK)((()=>{var e;return null===(e=v.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);return(0,me.jsxs)(me.Fragment,{children:[!l.isMobile&&m&&(0,me.jsx)(ar,{isMobile:l.isMobile}),u?(0,me.jsxs)(me.Fragment,{children:[!p&&l.isMobile&&(0,me.jsx)(rt,{isMobile:!0,mode:Ye.Section,ref:e}),(0,me.jsxs)("div",{style:h.sxsContainer,children:[(0,me.jsx)($r,{...y}),c&&(0,me.jsx)($r,{...y,searchResultStore:a,searchDebugColumnStore:b.BJ})]})]}):x?(0,me.jsx)(Ps,{onSelect:t,spaceId:x,extraTopPadding:f}):null]})}var Jr=s(97439),Xr=s(27714),Yr=s(26825),ei=s(37034),ti=s(10912),si=s(84076);function ri(e){window.__c={n:"SearchSidePeekPanelMetadataItem"};const{itemName:t,itemValue:s,isFirstInList:r,associatedUser:i}=e,n=(0,o.yK)((e=>({itemName:{fontSize:12,color:e.mediumTextColor},itemValue:{fontSize:12,...i&&{display:"grid",gridTemplateColumns:"1fr auto auto",gap:5,textAlign:"right"}},itemContainer:{height:36,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:12,borderTop:r?void 0:`1px solid ${e.regularDividerColor}`},metadataActorName:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}})),[r,i]),a=i;return(0,me.jsxs)("div",{style:n.itemContainer,children:[(0,me.jsx)("div",{style:n.itemName,children:t}),(0,me.jsxs)("div",{style:n.itemValue,children:[a&&(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(ls.Z,{delayThreshold:50,placement:ls.Z.Placement.Top,allowHover:!0,renderTooltip:()=>(0,me.jsxs)("div",{style:{display:"flex",gap:5},children:[a.avatar,a.name]}),closeDelay:0,render:e=>(0,me.jsx)("span",{...e,style:n.metadataActorName,children:a.name})}),(0,me.jsx)("span",{children:"•"})]}),(0,me.jsx)("span",{children:s})]})]})}const ii={createdBy:(0,me.jsx)(z.FormattedMessage,{id:"search.preview.metadata.createdBy",defaultMessage:"Created by"}),created:(0,me.jsx)(z.FormattedMessage,{id:"search.preview.metadata.created",defaultMessage:"Created"}),lastEditedBy:(0,me.jsx)(z.FormattedMessage,{id:"search.preview.metadata.lastEditedBy",defaultMessage:"Last edited by"}),lastEdited:(0,me.jsx)(z.FormattedMessage,{id:"search.preview.metadata.lastEdited",defaultMessage:"Edited"})},ni={type:"page_content"};function oi(e){var t;window.__c={n:"SearchSidePeekPanel"};const{selectedResult:s}=e,{type:a,value:l}=s,d="page_result"===a,c=(0,o.yK)((e=>({sidePeekPanel:{width:260,overflowY:"auto",overflowX:"hidden",minHeight:400,borderLeft:`1px solid ${e.regularDividerColor}`,display:"flex",flexDirection:d?"column":"row",justifyContent:d?"space-between":"center",alignItems:d?"normal":"center",zIndex:1},sidePeekPanelHidden:{display:"none"},emoji:{width:20},sidePeekContentContainer:{margin:16},report:{fontSize:12,position:"absolute",bottom:0,right:0,margin:16,display:"flex",gap:10},sidePeekActionContainer:{margin:16},pageIconAndTitleContainer:{marginTop:20,display:"flex",gap:10,flexDirection:"column",justifyContent:"space-between"},title:{fontSize:16,fontWeight:N.Z.fontWeight.bold,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},titleAndLinkContainer:{display:"grid",gridTemplateColumns:"1fr auto",width:"fit-content",gap:5},previewContainer:{marginTop:10,marginBottom:16,display:"flex",flexDirection:"column",position:"relative"},hoveredOrPressedPreview:{background:"unset",boxShadow:"unset"},preview:{borderRadius:6,background:"unset",boxShadow:"unset",border:`1px solid ${e.regularDividerColor}`,padding:16},previewGradientOverlay:{background:`linear-gradient(to top, ${e.contentBackground} 0px, ${e.contentBackgroundTransparent} 20px)`},metadataContainer:{marginTop:15,display:"flex",flexDirection:"column"},action:{borderRadius:4,background:"unset",fontSize:12,display:"flex"},metadataActorWrapper:{overflow:"hidden"},metadataActorAvatar:{marginRight:5},doubleChevronIcon:{color:e.accentColors.gray[400],cursor:"pointer",width:"max-content"},debugGearIcon:{color:e.accentColors.gray[400]},hoveredDebugGearIcon:{color:e.accentColors.gray[600]},linkIcon:{width:14,height:14,color:e.accentColors.gray[300],cursor:"pointer"}})),[d]),h=(0,n.VK)((()=>({...c.sidePeekPanel,...!M.ZP.isSidePeekPanelOpen()&&c.sidePeekPanelHidden})),[c.sidePeekPanel,c.sidePeekPanelHidden]),p=(0,i.O7)(),g=(0,z.useIntl)(),m=(0,n.VK)((()=>{if("page_result"===a)return(0,ei.V)(l,g,p)}),[g,p,a,l]),f=(0,n.VK)((()=>v.default.state.currentSpaceStore?(0,ft.jv)(v.default.state.currentSpaceStore):[]),[]),y=(0,r.useCallback)((e=>{const{id:t,spaceStore:s,table:r,showAvatar:i}=e;if(void 0===t||void 0===r)return;const n=(0,gs.Hl)({pointer:{id:t,spaceId:s.id,table:r},getRecordModel:s.getRecordModel}).asActor;return void 0!==n&&(0,Yr.GU)({spacePermissions:f,userId:n.id})?{name:(0,gs.$4)(g,n),avatar:i?(0,vs.a)({actor:n,size:18,style:c.metadataActorAvatar}):void 0}:void 0}),[g,f,c.metadataActorAvatar]),x=(0,r.useCallback)((e=>(0,Yt.IS)(e,{useCompactFormat:!0,useLowercase:!0})),[]),{createdBy:S,created:b,lastEditedBy:C,lastEdited:j}=(0,n.VK)((()=>{const e=v.default.state.currentSpaceStore;return void 0===e||"page_result"!==a?{createdBy:void 0,created:void 0,lastEditedBy:void 0,lastEdited:void 0}:{createdBy:y({id:l.getCreatedById(),table:l.getCreatedByTable(),spaceStore:e,showAvatar:!0}),created:x(l.getCreatedTime()),lastEditedBy:y({id:l.getLastEditedById(),table:l.getLastEditedByTable(),spaceStore:e,showAvatar:!0}),lastEdited:x(l.getLastEditedTime())}}),[x,y,l,a]),w=[{key:"created",itemName:ii.created,itemValue:b,associatedUser:S},{key:"lastEdited",itemName:ii.lastEdited,itemValue:j,associatedUser:C}],{previewIcon:k,isEmptyPage:I}=(0,n.VK)((()=>"page_result"!==a?{previewIcon:void 0,isEmptyPage:!0}:{previewIcon:l.getIcon(),isEmptyPage:l.isEmptyPage()}),[l,a]),T=(0,n.VK)((()=>{if("page_result"===a)return(0,Gt.ZP)({store:l,collectionViewId:l.id,fullyQualified:!0,pageVisitSource:Nt.tY.SearchQuery})}),[l,a]),P=(0,r.useCallback)((()=>{T&&Wt.RD({environment:p,stringValue:T,copiedMessage:Wt.tq.copiedLinkToClipboard})}),[p,T]),R=(0,n.VK)((()=>U.default.checkGate("search_toggle_side_peek")),[]),{searchResultStore:Z}=(0,r.useContext)(F.SearchStaticContext),{localResults:B,serverResults:A}=(0,n.VK)((()=>Z.state),[Z]),O=(0,q.x)(H.default);return(0,me.jsxs)("aside",{style:h,children:[(0,me.jsx)("div",{style:c.sidePeekContentContainer,children:"page_result"===a?(0,me.jsxs)(me.Fragment,{children:[R&&(0,me.jsx)("div",{onClick:()=>u.bn(p.currentUser.id),style:c.doubleChevronIcon,children:(0,Jr.D)({width:15,height:15})}),(0,me.jsxs)("div",{style:c.pageIconAndTitleContainer,children:[(0,me.jsx)(de.Z,{disabled:!0,icon:k,isEmptyPage:I,size:26,largeIcon:!0}),(0,me.jsxs)("span",{style:c.titleAndLinkContainer,children:[(0,me.jsx)("span",{style:c.title,children:m}),(0,me.jsx)("button",{onClick:P,style:Bt.W6,children:(0,Xr.N)(c.linkIcon)})]})]}),(0,me.jsx)(si.Z,{style:c.previewContainer,href:T,hoveredStyle:c.hoveredOrPressedPreview,pressedStyle:c.hoveredOrPressedPreview,children:(0,me.jsx)(ti.Z,{variant:"default",contentWrapStyle:c.preview,store:l,coverFormat:ni,coverSizeFormat:"small",showEmptyGalleryCover:!1,coverContentFadedOverlay:!0,coverContentFadedOverlayStyle:c.previewGradientOverlay,onLoadProxiedImage:()=>{},renderAdditionalBlocks:!0,rendererBlockStyle:{fontSize:9}})}),(0,me.jsx)("div",{style:c.metadataContainer,children:w.filter((e=>void 0!==e.itemValue)).map(((e,t)=>(0,me.jsx)(ri,{isFirstInList:0===t,itemName:e.itemName,itemValue:e.itemValue,associatedUser:e.associatedUser},e.key)))})]}):(0,me.jsx)(ai,{query:l??""})}),O?(0,me.jsxs)("div",{style:c.report,children:[(0,me.jsx)(wr,{experiments:null==A||null===(t=A.serverEventProperties)||void 0===t?void 0:t["server-searchExperiments"],localResults:null==B?void 0:B.results,serverResults:null==A?void 0:A.results}),(0,me.jsx)(ns.Z,{ariaLabel:"Button to open search's debug side panel",onClick:()=>M.ZP.setState({...M.ZP.state,isDebugSidebarOpen:!0,isSidePeekPanelOpen:!1}),style:c.debugGearIcon,hoveredStyle:c.hoveredDebugGearIcon,icon:e=>(0,Zt.H)({width:12,height:12})})]}):null]})}function ai(e){window.__c={n:"QnaPanel"};const{query:t}=e,s=(0,o.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:30},chatAndAvatarContainer:{display:"flex",gap:10,alignItems:"flex-end"},chatContainer:{display:"flex",flexDirection:"column",gap:10},questionBubble:{backgroundColor:"#F9F9F8",color:"#787774",padding:"8px 12px",borderRadius:16,fontSize:12,width:170,userSelect:"none",overflow:"hidden",textOverflow:"ellipsis"},introBubble:{backgroundColor:e.accentColors.purple[50],color:e.accentColors.purple[500],padding:"8px 12px",borderRadius:16,fontSize:14,width:170,userSelect:"none",overflow:"hidden",display:"flex",flexDirection:"column",gap:6,textOverflow:"ellipsis"},helperDescription:{textAlign:"center",fontSize:12,color:"#ACABA9",display:"flex",fontWeight:500,justifyContent:"center"},loadingDots:{backgroundColor:e.accentColors.purple[50],padding:12,borderRadius:100,width:"max-content"},writingIndicatorCircle:{height:6,width:6,opacity:.4,backgroundColor:"#a782c3",borderRadius:"100%"},writingButtonWrapper:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,width:"inherit",height:"inherit"}})),[]);return(0,me.jsxs)("div",{style:s.container,children:[(0,me.jsxs)("div",{style:s.chatAndAvatarContainer,children:[(0,me.jsx)(li,{}),(0,me.jsx)("div",{style:s.chatContainer,children:t?(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)("div",{style:s.questionBubble,children:t}),(0,me.jsx)("div",{style:s.loadingDots,children:(0,me.jsxs)("div",{role:"decorative",style:s.writingButtonWrapper,children:[(0,me.jsx)("div",{role:"decorative",style:s.writingIndicatorCircle}),(0,me.jsx)("div",{role:"decorative",style:s.writingIndicatorCircle}),(0,me.jsx)("div",{role:"decorative",style:s.writingIndicatorCircle})]})})]}):(0,me.jsxs)("div",{style:s.introBubble,children:[(0,me.jsx)("div",{children:(0,me.jsx)(z.FormattedMessage,{id:"assistantChat.welcomeMessage.title",defaultMessage:"Hi! I'm Notion AI."})}),(0,me.jsx)(z.FormattedMessage,{id:"assistantChat.welcomeMessage.caption",defaultMessage:"Let me help you find information and answer questions."})]})})]}),(0,me.jsx)("div",{style:s.helperDescription,children:(0,me.jsx)("div",{style:{width:"90%"},children:(0,me.jsx)(z.FormattedMessage,{id:"SearchSidePeek.caption",defaultMessage:"Get quick answers for anything in your workspace"})})})]})}function li(){window.__c={n:"AssistantLogo"};const e=(0,o.yK)((e=>({faceImgWrap:{width:37,height:37,borderRadius:"100%",background:"white",boxShadow:e.largeLightBoxShadow,overflow:"hidden",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center"},faceImg:{width:40,pointerEvents:"none"},aiSparklesFill:{height:21,width:18,fill:e.aiPurpleColor,pointerEvents:"none"}})),[]);return(0,me.jsx)("div",{style:e.faceImgWrap,children:(0,pt.t)(e.aiSparklesFill)})}function di(e){window.__c={n:"SearchContentPane"};const t=(0,i.Fy)(),s=(0,i.O7)();return(0,r.useEffect)((()=>{c.S(s)}),[s]),(0,m.Z)(),(0,me.jsx)(w.Z,{capture:!0,ignoreBlockSelection:!0,focusOffscreenInput:!1,restoreSelection:!t.isMobile,render:()=>(0,me.jsx)(j.Z,{capture:!0,allowMenuList:!0,render:t=>(0,me.jsx)(ci,{...e,ignoreAreaEvents:t})})})}function ci(e){window.__c={n:"SearchContentPaneInner"};const{ignoreAreaEvents:t,renderAsPage:s,quickSearchMode:l,onClose:d}=e,{handleQueryChange:c,searchFilterMenuRef:u,modalBodyMenuRef:m,searchResultStore:f,globalFocusedIndex:v,defaultBodyFocusedResult:j,searchActionItemsStore:w}=(0,r.useContext)(F.SearchStaticContext),[I,T]=(0,r.useState)(!1),[R,Z]=(0,r.useState)(!1),B=(0,i.O7)(),A=(0,i.Fy)(),O=(0,n.VK)((()=>M.ZP.state.query.text),[]),{isSearchMenuOpen:L,shouldShowDebugSidebar:D,hasPublicAccessPermission:E,hasQuery:_,shouldShowSpinner:q}=(0,n.VK)((()=>{const e=Boolean(x.Z.state.online),{hasPublicAccessPermission:t}=g.bC(B);return{isSearchMenuOpen:C.default.state.open,shouldShowSpinner:e&&Boolean(O)&&f.state.serverResultsLoading&&!I,shouldShowDebugSidebar:mi({device:A,isPublicAccessPermissionForPage:t}),hasPublicAccessPermission:t,hasQuery:Boolean(O.trim())||g.VA(M.ZP.state.query.filters)}}),[I,f,A,B,O]);let V=(0,n.VK)((()=>{if(A.isMobile)return!1;const{isDebugSidebarOpen:e}=M.ZP.state;return!((0,b.gq)({device:A})||e||!_)&&M.ZP.isSidePeekPanelOpen()}),[A,_]);const N=(0,r.useMemo)((()=>a.Ds((()=>{const{activeElement:e}=document;e instanceof HTMLInputElement&&e.blur()}),500,{leading:!0})),[]),z=(0,r.useCallback)((()=>{R&&N()}),[N,R]),H=(0,r.useCallback)((e=>{Z(e),e||A.isMobileNative&&S.Z.updateKeyboardPhase(B,S.i.willHide,0)}),[A.isMobileNative,B]),W=(0,n.VK)((()=>g.pG({searchResultStore:f,globalFocusedIndexStore:v,searchActionsStore:w})),[f,v,w]),K=(0,n.VK)((()=>j.state),[j]),U=(0,r.useMemo)((()=>(0,me.jsx)(ht.Z,{isOpen:Boolean(s||L),onTypingChange:T,onFocusChange:H,showSpinner:q,onQueryChange:c,quickSearchMode:l,selectedResult:"page_result"===(null==W?void 0:W.type)?W.value:void 0})),[s,L,H,q,c,l,W]),Q=(0,n.VK)((()=>ui({hasQuery:_,renderAsPage:s,environment:B})),[_,s,B]),$=(0,o.yK)((e=>({body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",zIndex:2,backgroundColor:e.popoverBackground},topbar:{height:void 0,marginTop:10,marginLeft:16,marginBottom:10,marginRight:16},topbarRightButtonWrapper:{flex:void 0,paddingLeft:16},topbarButton:{fontWeight:void 0,padding:0,color:e.mediumTextColor},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:Q.maxHeight,minHeight:Q.minHeight}})),[Q.maxHeight,Q.minHeight]),G=(0,r.useMemo)((()=>{if(A.isMobile){return{menuType:p.og.Modal,left:U,shouldRenderLeftDirectly:!0,width:s?"100vw":void 0,...pi({isPhone:A.isPhone,renderAsPage:s,style:$.topbarRightButtonWrapper,onClick:d}),header:_&&(0,me.jsx)(ut,{isPublicPageSearch:E}),disableHeaderShadow:!0,topbarStyle:$.topbar,leftRightButtonStyle:$.topbarButton,onScroll:gi(A)?z:void 0,bodyScrollerClassName:h.GZn,...t}}const e={menuType:p.og.Popup,maxHeight:Q.maxHeight,minHeight:Q.minHeight,...l?{width:"100vw"}:{},disableScroller:!0,scrollerStyle:$.scroller,...t};return s&&A.isDesktop&&(e.maxWidth="100%"),e}),[A,$,t,U,s,d,_,E,z,Q.minHeight,Q.maxHeight,l]),J=(0,n.VK)((()=>y.Z.showSearchAiFeatures()),[]),X=K||W;return"assistant"===(null==X?void 0:X.type)&&(X.value=O,V=V&&J),(0,me.jsx)(k.Z,{...G,className:h.Oau,ref:m,children:(0,me.jsxs)(hi,{enableLazyLoading:s,children:[(0,me.jsxs)("div",{style:$.body,children:[(0,me.jsx)(P.Z,{}),!A.isMobile&&U,(0,me.jsx)(Gr,{})]}),V&&void 0!==X?(0,me.jsx)(oi,{selectedResult:X}):void 0,D&&(0,me.jsx)(rt,{ref:u})]})})}function ui(e){const{hasQuery:t,renderAsPage:s,environment:r}=e,i=u.yt();if(s)return{maxHeight:"100vh",minHeight:"100vh"};if(i){const e=570,s=r.WindowSizeStore.state.height>e+(0,d.u3)(r.device.isElectronMac)?e:0;return{minHeight:`max(${t?70:50}vh, ${s}px)`,maxHeight:`max(${t?70:50}vh, ${s}px)`}}return{maxHeight:"80vh",minHeight:50}}function hi(e){window.__c={n:"SearchMenuContentsWrapper"};const{enableLazyLoading:t,children:s}=e,n=(0,i.O7)();return t?(0,me.jsx)(T.Z,{fetch:async()=>{var e;await l.Vs(0),await v.default.waitUntil((()=>void 0!==v.default.state.currentSpaceStore)),null===(e=n.mobileNative)||void 0===e||e.markTransitionReady({type:"search"})},loading:()=>(0,me.jsx)(r.Fragment,{}),render:()=>s}):(0,me.jsx)(r.Fragment,{children:s})}function pi(e){let{isPhone:t,style:s,renderAsPage:r,onClick:i}=e;return t&&(0,f.Y)("supportsNativeHome")||r?{rightOuterStyle:{display:"none"}}:{right:(0,me.jsx)(I.CancelMenuText,{}),onClickRight:i,rightOuterStyle:s}}function gi(e){return!!e.isMobile&&(!e.isIOS||e.isMobileNative)}function mi(e){let{device:t,isPublicAccessPermissionForPage:s}=e;if(!s&&!t.isMobile)return M.ZP.isDebugSidebarOpen()}},1924:(e,t,s)=>{s.d(t,{$:()=>F,Z:()=>B});s(67294);var r=s(83355),i=s(480),n=s(86628),o=s(24405),a=s(6637),l=s(35840),d=s(5366),c=s(94804),u=s(70203),h=s(82990),p=s(87531),g=s(34700),m=s(48141),f=s(38755),v=s(5162),y=s(80444),x=s(21273),S=s(25904),b=s(30857),C=s(29026),M=s(73063),j=s(74194),w=s(68785),k=s(31278),I=s(33411),T=s(26388),P=s(85893);const F=48;class R extends r.Z{constructor(){super(...arguments),this.typingTimer=void 0,this.renderLeft=()=>{const{showSpinner:e,selectedResult:t}=this.props,{device:s}=this.environment,r=this.styles,i={...this.getThemeColors().searchIcon,...r.searchIcon},n=null==t?void 0:t.getIcon(),o=Boolean(C.ZP.state.query.text.trim())&&!s.isMobile;return(0,P.jsx)(I.Z,{show:e,showDelay:500,showHold:200,render:e=>(e=>(0,P.jsx)("div",{style:r.headerIcon,children:e?(0,P.jsx)(w.Z,{style:i}):o?(0,P.jsx)(k.Z,{disabled:!0,icon:n,isEmptyPage:Boolean(n),size:20}):(0,l.R)(i)}))(e)})},this.handleQueryChange=e=>{this.handleTyping();const t=String(e.target.value);this.props.onQueryChange(t)},this.handleClearButtonClick=()=>{C.ZP.resetQuery({resetFilters:!0}),C.ZP.update((e=>({...e,source:"quick_find"})))},this.handleFocus=()=>{const{onFocusChange:e}=this.props;e(!0)},this.handleBlur=()=>{const{onFocusChange:e}=this.props;e(!1)},this.styles={inputDesktop:{fontSize:18,height:F,paddingLeft:12,paddingRight:16,alignItems:"center",flexGrow:0,flexShrink:0,zIndex:1},inputMobile:{fontSize:16,border:"none",boxShadow:"none",borderRadius:7,lineHeight:"1.2",padding:"6px 8px"},searchIcon:{width:16,height:16},headerIcon:{height:24,width:24,display:"flex",alignItems:"center",justifyContent:"center"},input:{minWidth:0,...(0,g.X)({noDrag:Boolean(this.props.quickSearchMode)}),...h.Z.textOverflowStyle},suggestedText:{whiteSpace:"pre",color:this.theme.mediumTextColor},autoCompletedText:{background:this.theme.tint.regular},clearButton:{marginLeft:8}}}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){const{device:e}=this.environment,{isOpen:t,selectedResult:s}=this.props,r=this.styles,i=this.getThemeColors(),n=C.ZP.state.query.text,o=function(e,t,s){if(0===s.length||s.length>=20||e.isMobile||void 0===t)return;const r=u.Jcv(t.getTitleValue()),i=r.replaceAll("\n"," "),n=r.slice(0,s.length),o=i.substring(s.length);if(r.length>0&&n.toLocaleLowerCase()===s.toLocaleLowerCase())return`${o} — ${R.messages.open.defaultMessage}`;return i.length>0?` — ${R.messages.open.defaultMessage} ${i}`:` — ${R.messages.open.defaultMessage}`}(e,s,n),a=o?(0,P.jsxs)("div",{children:[(0,P.jsx)("span",{children:n}),(0,P.jsx)("span",{style:r.autoCompletedText,children:o})]}):"",l=e.isMobile?j.Z.Format.ExtraLarge:j.Z.Format.Transparent,d=e.isMobile?{...r.inputMobile,...i.inputMobile}:{...r.inputDesktop,...i.inputDesktop},c=x.Z.showSearchAiFeatures()||p.yt();return(0,P.jsx)("div",{style:{display:"flex"},children:(0,P.jsx)(j.Z,{format:l,placeholder:this.getPlaceholderText(),left:this.renderLeft(),value:n,suggestedText:a,suggestedTextStyle:r.suggestedText,focus:e.isMobile?void 0:t&&!S.Z.state.open,focusInitial:!(0,v.Y)("supportsNativeHome")&&e.isMobile,focusAfterAnimation:!0,showClearButton:!0,right:!e.isMobile&&c&&(0,P.jsx)(Z,{quickSearchMode:this.props.quickSearchMode}),isRightLastElementOfInput:!0,selectAll:!0,onChange:this.handleQueryChange,onClearButtonClick:this.handleClearButtonClick,onFocus:this.handleFocus,onBlur:this.handleBlur,style:d,inputStyle:r.input,clearButtonStyle:{...(0,g.X)({noDrag:Boolean(this.props.quickSearchMode)})}})})}updateIfIsFirstKeyStroke(){void 0===b.default.state.firstKeyStrokeTimeMs&&b.default.update((e=>({...e,firstKeyStrokeTimeMs:Date.now()})))}handleTyping(){this.updateIfIsFirstKeyStroke();const{onTypingChange:e}=this.props;this.typingTimer&&window.clearTimeout(this.typingTimer),e(!0),this.typingTimer=window.setTimeout((()=>e(!1)),R.TYPING_DEBOUNCE_MS)}getPlaceholderText(){const{currentSpaceStore:e,mainEditorCurrentBlockStore:t}=y.default.state,s=e&&(0,f.rn)(this.environment,e);if(s&&x.Z.showSearchAiFeatures())return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.SearchOrAskQuestionInSpace",defaultMessage:"Search or ask question in {spaceName}…"},{spaceName:s});if(s)return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.searchInSpace",defaultMessage:"Search {spaceName}…"},{spaceName:s});if(t){const e=u.Jcv(t.getTitleValue()).slice(0,R.MAX_PLACEHOLDER_TITLE_LENGTH);return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedPage",defaultMessage:"Search in {pageTitle}…"},{pageTitle:e})}return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.unnamedPage",defaultMessage:"Search in page…"})}getThemeColors(){return{inputDesktop:{boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`},inputMobile:{background:this.theme.inputBackground},searchIcon:{fill:this.theme.mediumIconColor}}}}function Z(e){window.__c={n:"FilterIconButton"};const[t,s]=(0,n.VK)((()=>{const e=C.ZP.state.query.filters,t=(0,m.FN)(e);return[C.ZP.state.showFilterBar,t]}),[]),r=(0,i.O7)();(0,n.VK)((()=>{const e=r.currentUser.id;if(!e)return;!1===(0,c.fe)(e)&&!0===t&&C.ZP.collapseFilterBar()}),[r,t]);const l=(0,o.yK)((t=>({container:{padding:4,marginLeft:5,borderRadius:4,height:"fit-content",width:"fit-content",display:"flex",...(0,g.X)({noDrag:Boolean(e.quickSearchMode)})},hoveredContainerStyles:{background:s?t.accentColors.interactiveBlue[100]:t.accentColors.gray[50]},icon:{width:20,height:20,cursor:"pointer",fill:s?t.accentColors.interactiveBlue[500]:"light"===t.mode?t.accentColors.gray[300]:t.accentColors.gray[500]}})),[s,e.quickSearchMode]);return(0,P.jsx)(T.Z,{renderTooltip:()=>(0,P.jsx)(P.Fragment,{children:(0,P.jsx)("div",{children:t?(0,P.jsx)(d.FormattedMessage,{id:"searchInputMenuItem.filterBarToggleButtonTooltip.hide",defaultMessage:"Hide filters"}):(0,P.jsx)(d.FormattedMessage,{id:"searchInputMenuItem.filterBarToggleButtonTooltip.show",defaultMessage:"Show filters"})})}),placement:T.Z.Placement.Bottom,alignment:T.Z.Alignment.Start,disableTooltip:r.device.isMobile,delayThreshold:400,render:e=>(0,P.jsx)(M.Z,{...e,icon:e=>(0,a.I)(l.icon),ariaLabel:"Button to toggle the filter bar",style:l.container,hoveredStyle:l.hoveredContainerStyles,onClick:()=>t?C.ZP.collapseFilterBar():C.ZP.expandFilterBar()})})}R.displayName="SearchInputMenuItem",R.messages=(0,d.defineMessages)({open:{id:"search.inputMenu.suggestedText.open",defaultMessage:"Open"}}),R.TYPING_DEBOUNCE_MS=300,R.MAX_PLACEHOLDER_TITLE_LENGTH=100;const B=(0,d.injectIntl)(R)},85665:(e,t,s)=>{s.d(t,{Z:()=>L});var r=s(67294),i=s(480),n=s(86628),o=s(33991),a=s(32470),l=s(59054),d=s(72126),c=s(21202),u=s(92338),h=s(97880),p=s(63143),g=(s(21703),s(74487));const m=Symbol("JSON Schema"),f=Symbol("JSON Schema Components"),v=Symbol("No JSON Schema"),y={isNull:()=>({type:"null",[f]:{}}),boolean:()=>({type:"boolean",[f]:{}}),number:()=>({type:"number",[f]:{}}),integer:()=>({type:"integer",[f]:{}}),string:()=>({type:"string",[f]:{}}),dateString:()=>({type:"string",format:"date",[f]:{}}),literal:e=>({enum:[e],[f]:{}}),literals:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return{enum:t,[f]:{}}},uuid:()=>({type:"string",format:"uuid",[f]:{}}),uuidWithoutDashes:()=>({type:"string",format:"uuid",[f]:{}}),any:()=>S,array:e=>({type:"array",items:e[m],[f]:e[m][f]}),tuple:e=>({type:"tuple",items:!1,prefixItems:e.map((e=>e[m])).filter((e=>e!==v)),[f]:Object.assign({},...e.map((e=>e[m][f])))}),record:(e,t)=>({type:"object",additionalProperties:t[m],[f]:t[m][f]}),object:e=>{let{required:t,optional:s,exact:r}=e;return{type:"object",properties:(0,p.m8)(Object.entries({...t,...s}).filter((e=>{let[t,s]=e;return s[m]!==v})).map((e=>{let[t,s]=e;return[t,s[m]]}))),...r&&{additionalProperties:!1},...Object.keys(t).length>0&&{required:Object.keys(t)},[f]:Object.assign({},...Object.values({...t,...s}).map((e=>e[m][f])))}},union:e=>({anyOf:e.map((e=>e[m])).filter((e=>e!==v)),[f]:Object.assign({},...e.map((e=>e[m][f])))}),gte:(e,t)=>{const s=e[m];return s!==v?{...s,minimum:t}:s},lte:(e,t)=>{const s=e[m];return s!==v?{...s,maximum:t}:s},maxLength:(e,t)=>{const s=e[m];if(s===v)return s;if("type"in s){if("string"===s.type)return{...s,maxLength:t};if("array"===s.type)return{...s,maxItems:t}}throw new Error("Unknown type for max length.")},minLength:(e,t)=>{const s=e[m];if(s===v)return s;if("type"in s){if("string"===s.type)return{...s,minLength:t};if("array"===s.type)return{...s,minItems:t}}throw new Error("Unknown type for min length.")},nonEmpty:e=>{const t=e[m];if(t===v)return t;if("type"in t){if("string"===t.type)return{...t,minLength:1};if("object"===t.type)return{...t,minProperties:1};if("array"===t.type)return{...t,minItems:1}}throw new Error("Unknown non-emptyable type.")},nullable:e=>{const t=e[m];if(t===v)return t;if("type"in t)if(Array.isArray(t.type)){if("null"===t.type[1])return t;(0,h.t1)(t.type[1])}else{if("string"===t.type)return{...t,type:[t.type,"null"]};if("object"===t.type)return{...t,type:[t.type,"null"]};if("array"===t.type)return{...t,type:[t.type,"null"]};if("tuple"===t.type)return{...t,type:[t.type,"null"]};if("boolean"===t.type)return{...t,type:[t.type,"null"]};if("integer"===t.type)return{...t,type:[t.type,"null"]};if("number"===t.type)return{...t,type:[t.type,"null"]};if("null"===t.type)return t;(0,h.t1)(t.type)}else{if("const"in t)return{...t,enum:[t.const,null]};if("enum"in t)return{...t,enum:[...t.enum,null]};if("anyOf"in t)return{...t,anyOf:t.anyOf.map((e=>y.nullable({[m]:e})))};if("$ref"in t)return{anyOf:[t,{type:"null"}],[f]:t[f]};if(b(t))return t;(0,h.t1)(t)}}},x=(0,p.m8)(Object.entries(y).map((e=>{let[t,s]=e;return[t,function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return 1===r.length&&(0,h.Kn)(r[0])&&("id"in r[0]||"description"in r[0])?function(){const{description:e,examples:i,id:n}=r[0];let o={description:e,...i&&{examples:i},...s(...arguments)};return n&&(o={$ref:`#/components/schemas/${n}`,[f]:{...o[f],[n]:o}}),{[m]:o,...g[t](...arguments)}}:{[m]:s(...r),...g[t](...r)}}]}))),S=(Symbol("Exact empty object ({})"),x.object({id:"emptyObject"})({required:{},optional:{},exact:!0}),{});function b(e){return(0,h.Kn)(e)&&0===Object.keys(e).length}var C=s(50906),M=s(48141),j=s(18245),w=s(80444),k=s(88632),I=s(77080),T=s(69327),P=s(84166),F=s(35661),R=s(55320),Z=s(30857),B=s(29026);function A(e){let{dependencies:t,debugColumnStore:s,localDebounce:o=75,serverDebounce:a=225,searchResultStore:c,permanentFilterOverride:u,enabled:h}=e;const p=(0,i.O7)(),g=(0,n.VK)((()=>function(e){const{isOnline:t,debugColumnStore:s}=e,r=s.state.searchExperimentOverrides;function i(e){return(null==r?void 0:r[e])??I.default.getGroup(e,{disableExposureLogging:!0})}return{shouldSearchLocal:"on"!==i("search-no-local-blending")&&t,forcedClusterPattern:s.state.forcedClusterPattern,searchExperimentOverrides:s.state.searchExperimentOverrides,forcedBlockIds:s.state.forcedBlockIds}}({isOnline:t.isOnline,debugColumnStore:s})),[t.isOnline,s]),m=(0,r.useMemo)((()=>d.Ds(O,a)),[a]);(0,l.r5)((()=>h?async function(e){var t;const{query:s,openAsPage:r,store:i,fetchServerResultsFn:n}=e;if(r&&d.Xy(s,i.state.selectedQueryResultQuery))return;"quick_find_scroll"!==B.ZP.state.source&&function(e){const{shouldSearchLocal:t,parentStore:s,environment:r,query:i,debug:n,limit:o,hasPublicAccessPermission:a,isOnline:l,store:d,permanentFilterOverride:c}=e;let u;const h={...i,filters:{...i.filters,...c}};t&&(u=M.b9(function(e){const{parentStore:t,requestInput:s,isOnline:r,environment:i,hasPublicAccessPermission:n,localSearchCache:o}=e,{query:a}=s;if(!o)return;if(!a.text.trim())return;if(n)return;const l=j.default.mark("rum.local_quick_search_query"),d=void 0,c=M.Y_({query:s,localCachedPages:o,parentStore:t,environment:i,isOnline:r,shouldLimitLocalResultsWhenOnline:!0,applyScoreThresholdWhenOnline:!0,maxLocalResultsOverride:d,canUseLtr:!0});return j.default.measure(l,{environment:i}),c}({parentStore:s,environment:r,requestInput:{query:h,debug:n,limit:o},hasPublicAccessPermission:a,isOnline:l,localSearchCache:P.Z.state.localSearchableBlocksCache})),Z.default.update((e=>({...e,numLocalRequests:e.numLocalRequests+1}))),d.update((e=>({...e,localResults:u}))))}(e);const o=new Set;null===(t=i.state.localResults)||void 0===t||t.results.forEach((e=>o.add(e.id))),await n({...e,excludedBlockIds:[...o]})}({...t,...g,store:c,fetchServerResultsFn:m,environment:p,permanentFilterOverride:u}):Promise.resolve()),[t,g,c,m,p,u,h],{debounce:o})}async function O(e){let{parentStore:t,environment:s,query:r,debug:i,isOnline:n,publicAccessPermissionAncestorBlockId:o,currentSpaceStore:l,searchExperimentOverrides:g,forcedClusterPattern:m,store:f,forcedBlockIds:v,limit:y,permanentFilterOverride:x,excludedBlockIds:S}=e;const w={query:{...r,filters:{...r.filters,...x}},debug:i,limit:y};f.update((e=>({...e,serverResultsLoading:!0}))),Z.default.update((e=>({...e,numServerRequests:e.numServerRequests+1})));const k=f.state.serverResults,I=B.ZP.state.source,P=await async function(e){const{parentStore:t,requestInput:s,isOnline:r,environment:i,publicAccessPermissionAncestorBlockId:n,searchSessionId:o,searchSessionFlowNumber:a,source:l,spaceId:d,searchExperimentOverrides:g,forcedClusterPattern:m,forcedBlockIds:f,excludedBlockIds:v}=e,{query:y}=s;if(!y.text.trim()&&!M.FN(y.filters))return;if(!r)return{error:u.Ix.Offline};const x=j.default.mark("rum.server_quick_search_query"),S=await M.MS({environment:i,input:s,spaceId:d,publicAccessPermissionAncestorBlockId:n,searchSessionId:o,searchSessionFlowNumber:a,source:l,searchExperimentOverrides:g,forcedClusterPattern:m,recentPagesForBoosting:d&&"on"!==(null==g?void 0:g["search-debug-only-no-recent-boosting"])?T.Z.getWithoutSubscribing(d):[],forcedBlockIds:f,excludedBlockIds:v});if(!S)return;if("failed"===S.type)return S.offline?{error:u.Ix.Offline}:{error:u.Ix.RequestFailed};const C=S.data.trackEventProperties,w=b(C)?{}:(0,p.m8)((0,h.Yd)(C).map((e=>[`server-${e}`,C[e]]))),k=S.data.results.map(((e,s)=>({...e,serverEventProperties:w,originalPosition:s,store:F.G.createChildStore(t,{table:c.iU,id:e.id})})));return j.default.measure(x,{environment:i}),{value:{results:k,total:S.data.total,debugInfo:S.data.debug,serverEventProperties:w,clusterInfo:S.data.clusterInfo}}}({parentStore:t,environment:s,requestInput:w,spaceId:null==l?void 0:l.id,searchSessionId:R.default.state.sessionId,searchSessionFlowNumber:Z.default.state.numServerRequests,publicAccessPermissionAncestorBlockId:o,isOnline:n,source:I,searchExperimentOverrides:g,forcedClusterPattern:m,forcedBlockIds:v,excludedBlockIds:S}),A={query:{...B.ZP.state.query,filters:{...B.ZP.state.query.filters,...x}},limit:B.ZP.state.limit,debug:a.ZP.getDebugLevel()};if(!d.Xy(w,A))return;const O=M.b9(P),L="quick_find_scroll"===I?M.Nu({existingResults:k,newPageResults:O}):O;if(P&&!P.error){var D,E,_;const e=P.value.results;f.update((t=>({...t,serverError:null==P?void 0:P.error,serverResultsLoading:!1,serverResults:L,serverResultsAllLoaded:e.length<y,serverEventProperties:P.value.serverEventProperties})));const t=(null==L?void 0:L.results.map((e=>{var t;return{id:e.id,badges:(null===(t=e.badges)||void 0===t?void 0:t.map((e=>e.type)))??[]}})))??[],r=new Map;for(const{badges:s}of t)for(const e of s){const t=r.get(e)??0;r.set(e,t+1)}const{sections:i}=M.IV({intentBasedGrouping:R.default.state.intentBasedSearch.enablesGrouping,localResults:null===(D=f.state.localResults)||void 0===D?void 0:D.results,serverResults:null==L?void 0:L.results}),n={};for(const[s,o]of Object.entries(i))n[s]=o.map((e=>e.id));C.ZfC(s,{numLocalResults:(null===(E=f.state.localResults)||void 0===E?void 0:E.results.length)||0,numServerResults:(null==L?void 0:L.results.length)||0,localResultsIds:(null===(_=f.state.localResults)||void 0===_?void 0:_.results.map((e=>e.id)))||[],...P.value.serverEventProperties,badgeCounts:r,badgesByResultId:t,idsBySection:n})}else f.update((e=>({...e,serverError:null==P?void 0:P.error,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0})))}function L(){const e=(0,i.Fy)(),{searchResultStore:t,secondarySearchResultStore:s}=(0,r.useContext)(o.SearchStaticContext),{parentStore:l}=(0,r.useContext)(o.SearchStoresContext),d=function(e){const t=(0,i.O7)();return(0,n.VK)((()=>{const{hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:r}=M.bC(t);return{isOnline:Boolean(k.Z.state.online),limit:B.ZP.state.limit,parentStore:e,hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:r,currentSpaceStore:w.default.state.currentSpaceStore,debug:a.ZP.getDebugLevel(),openAsPage:R.default.state.openAsPage,currentSpaceViewStore:w.default.state.currentSpaceViewStore,query:B.ZP.state.query}}),[t,e])}(l),c=(0,n.VK)((()=>Boolean((0,a.gq)({device:e})&&a.BJ.state.visible)),[e]);A({dependencies:d,searchResultStore:t,debugColumnStore:a.v_,enabled:!0}),A({dependencies:d,searchResultStore:s,debugColumnStore:a.BJ,enabled:c})}},25904:(e,t,s)=>{s.d(t,{Z:()=>n});var r=s(49085);class i extends r.default{getInitialState(){return{open:!1}}}const n=new i},30857:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var r=s(49085);class i extends r.default{getInitialState(){return{selectedQueryResult:!1,numKeystrokes:0,numServerRequests:0,numLocalRequests:0,hadMetaClick:!1,firstKeyStrokeTimeMs:void 0}}}const n=new i},95341:(e,t,s)=>{s.d(t,{d:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("arrowRightSquare",{viewBox:"0 0 18 18",svg:(0,i.jsx)("path",{d:"M3.06641 17.998L14.9121 17.998C16.9629 17.998 17.9785 16.9824 17.9785 14.9707L17.9785 3.04688C17.9785 1.03516 16.9629 0.0195312 14.9121 0.0195312L3.06641 0.0195312C1.02539 0.0195312 0 1.02539 0 3.04688L0 14.9707C0 16.9922 1.02539 17.998 3.06641 17.998ZM14.1797 8.98438C14.1797 9.20898 14.082 9.38477 13.8867 9.57031L10.4883 12.9785C10.3516 13.1152 10.1758 13.1934 9.96094 13.1934C9.54102 13.1934 9.22852 12.8711 9.22852 12.4512C9.22852 12.2363 9.31641 12.0508 9.45312 11.9141L10.7129 10.6738L11.9238 9.6582L9.79492 9.73633L4.56055 9.73633C4.12109 9.73633 3.80859 9.42383 3.80859 8.98438C3.80859 8.53516 4.12109 8.22266 4.56055 8.22266L9.79492 8.22266L11.9238 8.31055L10.7129 7.29492L9.45312 6.05469C9.32617 5.9082 9.22852 5.72266 9.22852 5.50781C9.22852 5.08789 9.54102 4.77539 9.96094 4.77539C10.1758 4.77539 10.3516 4.84375 10.4883 4.98047L13.8867 8.39844C14.0918 8.60352 14.1797 8.75977 14.1797 8.98438Z"})})},22109:(e,t,s)=>{s.d(t,{T:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("arrowsUpDown",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.11 2.385a.61.61 0 01.48-.211c.191 0 .353.07.486.21L8.03 5.409a.66.66 0 01.2.475c0 .191-.061.347-.182.469a.627.627 0 01-.463.181.59.59 0 01-.451-.187L5.926 5.098l-.72-.844.04 1.219v7.242a.624.624 0 01-.187.469.624.624 0 01-.47.187.636.636 0 01-.468-.187.635.635 0 01-.182-.47V5.474l.041-1.22-.726.845-1.201 1.248a.61.61 0 01-.457.187.627.627 0 01-.463-.181.634.634 0 01-.182-.47.66.66 0 01.2-.474l2.958-3.023zm7.786 10.781a.636.636 0 01-.486.205.665.665 0 01-.486-.205l-2.947-3.035a.64.64 0 01-.206-.475c0-.191.061-.345.182-.463a.634.634 0 01.469-.181c.18 0 .33.06.451.181l1.201 1.248.727.85-.041-1.219V2.824c0-.187.06-.342.181-.463a.636.636 0 01.47-.187.627.627 0 01.65.65v7.248l-.041 1.219.726-.85 1.207-1.248a.6.6 0 01.451-.181c.188 0 .342.06.463.181a.615.615 0 01.182.463.648.648 0 01-.2.475l-2.953 3.035z"})})},6637:(e,t,s)=>{s.d(t,{I:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("filterCircled",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.41797 6.75879H11.5889C11.9307 6.75879 12.1699 6.54688 12.1699 6.22559C12.1699 5.9043 11.9307 5.68555 11.5889 5.68555H4.41797C4.07617 5.68555 3.84375 5.9043 3.84375 6.22559C3.84375 6.54688 4.07617 6.75879 4.41797 6.75879ZM5.36816 9.02148H10.6455C10.9805 9.02148 11.2197 8.80273 11.2197 8.48145C11.2197 8.16016 10.9805 7.94141 10.6455 7.94141H5.36816C5.02637 7.94141 4.78711 8.16016 4.78711 8.48145C4.78711 8.80273 5.02637 9.02148 5.36816 9.02148ZM6.35254 11.2773H9.6543C9.99609 11.2773 10.2354 11.0654 10.2354 10.7441C10.2354 10.4229 9.99609 10.2041 9.6543 10.2041H6.35254C6.01074 10.2041 5.77148 10.4229 5.77148 10.7441C5.77148 11.0654 6.01074 11.2773 6.35254 11.2773Z"})})},88507:(e,t,s)=>{s.d(t,{I:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("openTeamSearch",{viewBox:"0 0 16 14",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M9.506 13.342h4.447c.348 0 .621-.11.82-.328.2-.22.3-.516.3-.891V4.852c0-.375-.1-.67-.3-.885-.199-.219-.472-.328-.82-.328H9.922v1.136h3.709c.101 0 .178.026.228.077.051.05.076.127.076.228v6.815c0 .101-.025.177-.076.228-.05.05-.127.076-.228.076H9.506v1.143zm2.28-6.358h.925c.129 0 .193-.064.193-.193v-.896c0-.133-.064-.2-.193-.2h-.926c-.125 0-.187.067-.187.2v.896c0 .129.062.193.187.193zm0 2.168h.925c.129 0 .193-.066.193-.199v-.896c0-.133-.064-.2-.193-.2h-.926c-.125 0-.187.067-.187.2v.896c0 .133.062.2.187.2zm0 2.163h.925c.129 0 .193-.067.193-.2v-.896c0-.13-.064-.194-.193-.194h-.926c-.125 0-.187.065-.187.194v.896c0 .133.062.2.187.2zm-10.864.808c0 .375.1.672.299.89.199.22.474.329.826.329H9.44c.348 0 .621-.11.82-.328.204-.22.305-.516.305-.891V1.928c0-.38-.101-.676-.304-.89-.2-.22-.473-.329-.82-.329H2.046c-.352 0-.627.11-.826.328-.2.215-.3.512-.3.89v10.196zm1.142-.228V2.162c0-.105.026-.183.077-.234.05-.051.127-.076.228-.076h6.75c.102 0 .178.025.229.076.05.05.076.129.076.234v9.733c0 .101-.026.177-.076.228-.051.05-.127.076-.229.076H2.37c-.101 0-.178-.025-.228-.076-.051-.05-.077-.127-.077-.228zm1.588.85h.891v-1.946c0-.117.06-.176.182-.176h2.039c.12 0 .181.059.181.176v1.945h.89V10.5c0-.25-.058-.435-.175-.557-.117-.125-.295-.187-.533-.187H4.36c-.238 0-.416.062-.533.187-.117.122-.176.307-.176.557v2.244zm.17-8.362h1.12c.156 0 .234-.078.234-.235v-1.09c0-.156-.078-.234-.235-.234H3.822c-.148 0-.222.078-.222.235v1.09c0 .156.074.234.222.234zm2.719 0h1.12c.152 0 .228-.078.228-.235v-1.09c0-.156-.077-.234-.229-.234H6.541c-.152 0-.229.078-.229.235v1.09c0 .156.077.234.229.234zM3.822 6.627h1.12c.156 0 .234-.078.234-.234V5.309c0-.157-.078-.235-.235-.235H3.822c-.148 0-.222.078-.222.235v1.084c0 .156.074.234.222.234zm2.719 0h1.12c.152 0 .228-.078.228-.234V5.309c0-.157-.077-.235-.229-.235H6.541c-.152 0-.229.078-.229.235v1.084c0 .156.077.234.229.234zm-2.719 2.25h1.12c.156 0 .234-.08.234-.24V7.553c0-.157-.078-.235-.235-.235H3.822c-.148 0-.222.078-.222.235v1.084c0 .16.074.24.222.24zm2.719 0h1.12c.152 0 .228-.08.228-.24V7.553c0-.157-.077-.235-.229-.235H6.541c-.152 0-.229.078-.229.235v1.084c0 .16.077.24.229.24z"})})})},96895:(e,t,s)=>{s.d(t,{q:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("sidebarRight",{viewBox:"0 0 23 18",svg:(0,i.jsx)("path",{d:"M3.06641 17.998L19.9609 17.998C22.0117 17.998 23.0273 16.9824 23.0273 14.9707L23.0273 3.04688C23.0273 1.03516 22.0117 0.0195312 19.9609 0.0195312L3.06641 0.0195312C1.02539 0.0195312 0 1.02539 0 3.04688L0 14.9707C0 16.9922 1.02539 17.998 3.06641 17.998ZM3.08594 16.4258C2.10938 16.4258 1.57227 15.9082 1.57227 14.8926L1.57227 3.125C1.57227 2.10938 2.10938 1.5918 3.08594 1.5918L19.9414 1.5918C20.9082 1.5918 21.4551 2.10938 21.4551 3.125L21.4551 14.8926C21.4551 15.9082 20.9082 16.4258 19.9414 16.4258ZM14.082 16.7285L15.6152 16.7285L15.6152 1.29883L14.082 1.29883ZM17.4902 5.21484L19.5801 5.21484C19.8828 5.21484 20.1367 4.95117 20.1367 4.66797C20.1367 4.375 19.8828 4.12109 19.5801 4.12109L17.4902 4.12109C17.1973 4.12109 16.9336 4.375 16.9336 4.66797C16.9336 4.95117 17.1973 5.21484 17.4902 5.21484ZM17.4902 7.74414L19.5801 7.74414C19.8828 7.74414 20.1367 7.48047 20.1367 7.1875C20.1367 6.89453 19.8828 6.65039 19.5801 6.65039L17.4902 6.65039C17.1973 6.65039 16.9336 6.89453 16.9336 7.1875C16.9336 7.48047 17.1973 7.74414 17.4902 7.74414ZM17.4902 10.2637L19.5801 10.2637C19.8828 10.2637 20.1367 10.0195 20.1367 9.72656C20.1367 9.43359 19.8828 9.17969 19.5801 9.17969L17.4902 9.17969C17.1973 9.17969 16.9336 9.43359 16.9336 9.72656C16.9336 10.0195 17.1973 10.2637 17.4902 10.2637Z"})})},36308:(e,t,s)=>{s.d(t,{V:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("title",{viewBox:"0 0 14 10",svg:(0,i.jsx)("path",{d:"M10.674 9.45c.293 0 .576-.052.85-.153.273-.098.515-.238.726-.422.215-.184.383-.4.504-.65h.03v.662a.569.569 0 00.163.416c.11.101.25.152.422.152a.579.579 0 00.428-.164c.11-.105.164-.256.164-.451V4.973c0-.43-.104-.805-.31-1.125-.208-.32-.5-.569-.88-.744-.378-.18-.828-.27-1.347-.27-.594 0-1.114.115-1.559.346-.445.226-.75.533-.914.92-.031.07-.056.14-.076.21a.684.684 0 00-.03.194c0 .148.05.27.147.363.102.09.23.135.387.135a.61.61 0 00.287-.064.555.555 0 00.217-.2c.172-.32.377-.554.615-.703.238-.148.533-.223.885-.223.426 0 .76.112 1.002.334.242.223.363.528.363.915v.486l-1.828.1c-.77.042-1.361.23-1.775.562-.41.328-.616.773-.616 1.336 0 .379.09.71.27.996.183.285.435.508.756.668.324.16.697.24 1.119.24zm.328-.938c-.367 0-.666-.092-.897-.276a.906.906 0 01-.345-.738.86.86 0 01.34-.709c.23-.184.558-.29.984-.322l1.664-.106v.598c0 .293-.078.557-.234.791a1.69 1.69 0 01-.627.557c-.266.136-.56.205-.885.205zM.689 9.414c.2 0 .354-.045.463-.135.114-.086.202-.234.264-.445l.65-1.816h3.346l.65 1.816c.063.21.149.36.258.445.114.09.268.135.463.135.207 0 .371-.057.492-.17a.593.593 0 00.188-.463c0-.129-.027-.27-.082-.422L4.79 1.357c-.09-.246-.22-.43-.393-.55C4.23.686 4.012.625 3.742.625c-.508 0-.847.244-1.02.732L.116 8.39a1.3 1.3 0 00-.076.404c0 .195.057.348.17.457.117.11.277.164.48.164zm1.717-3.486L3.73 2.119h.03l1.324 3.809H2.406z"})})}}]);