"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9442],{67706:(e,t,i)=>{i.d(t,{Z:()=>l});i(67294);var n=i(24405),o=i(82990),a=i(53437),r=i(26388),s=i(85893);function l(e){let{text:t,tooltipText:i,icon:l}=e;window.__c={n:"InlineTextWithIconTooltip"};const d=(0,n.yK)((e=>({icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor,marginBottom:"0.1em"},tooltip:{background:e.contentBackground,boxShadow:e.lightBoxShadow},container:{display:"flex",alignItems:"center",fontWeight:o.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:o.Z.fontSize.UISmall.desktop,textAlign:"center"},text:{display:"inline"}})),[]);return(0,s.jsx)(r.Z,{style:d.tooltip,render:e=>(0,s.jsx)("div",{style:d.text,...e,children:t}),renderTooltip:()=>(0,s.jsxs)("div",{style:d.container,children:[l(d.icon),(0,s.jsx)("div",{children:i})]}),alignment:a.ZP.Alignment.Start,placement:a.ZP.Placement.Bottom})}},22649:(e,t,i)=>{i.d(t,{OD:()=>l,TL:()=>g,_W:()=>c,b9:()=>u,c3:()=>d,e9:()=>r,lS:()=>a,nP:()=>s});var n=i(82990);const o={userSelect:"text",WebkitUserSelect:"text"},a={padding:1,...o},r={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},s={fontWeight:n.Z.fontWeight.semibold};function l(e){return{padding:0,paddingLeft:d(e),paddingRight:16,paddingBottom:3,...o}}function d(e){const{source:t,isMobile:i}=e;return"notifications_tab"===t?52+(i?3:2):52}function c(e){return{height:26,paddingLeft:8,paddingRight:8,color:e.mediumTextColor}}function g(e){return{display:"inline",whiteSpace:"normal",marginRight:e?3:0,wordBreak:"break-word",...s}}function u(e){return{boxShadow:e.plainButtonBoxShadow,height:26,paddingLeft:8,paddingRight:8,fontWeight:500,color:e.regularTextColor}}},30573:(e,t,i)=>{i.d(t,{N:()=>U,Z:()=>K});var n=i(67294),o=i(480),a=i(86628),r=i(24405),s=i(52867),l=i(90334),d=i(5686),c=i(8843),g=i(70753),u=i(61248),h=i(55061),f=i(21202),m=i(82990),p=i(31412),b=i(62967),x=i(19719),y=i(54642),v=i(17659),S=i(39699),k=i(12534),w=i(87279),M=i(98742),Z=i(24764),I=i(57538),T=i(80444),A=i(77080),C=i(26350),R=i(48019),_=i(31945),j=i(73063),B=i(78140),P=i(72495),W=i(26388),N=i(64369),O=i(85893);const U=64,D=(0,p.defineMessages)({changePageNotificationSettings:{defaultMessage:"Change page notification settings",id:"inboxActionsMenu.notificationSettings.tooltipMessage"}});function F(e){window.__c={n:"InboxActionsMenu"};const{notification:t,rootStore:i,onArchiveClicked:U,onMarkAsReadClicked:F,onMarkAsUnreadClicked:K,useInboxRedesign:z}=e,L=(0,o.O7)(),V=(0,o.Fy)(),G=(0,p.useIntl)(),$=(0,a.VK)((()=>!!t&&(0,h.$2)(t.type)),[t]),E=(0,a.VK)((()=>{const e=null==t?void 0:t.navigable_block_id;if(e)return C.G.createChildStore(i,{table:f.iU,id:e})}),[i,t]),H=(0,a.VK)((()=>null==E?void 0:E.getFollowSettingsKey()),[E]),J=(0,a.VK)((()=>{if(!H)return[];if(!E)return[];const e="inbox";return A.default.checkGate("property_updates_notifications")?Z.CA({followSettingsKey:H,environment:L,blockStore:E,from:e}):Z.Zk({followSettingsKey:H,environment:L,blockStore:E,from:e})}),[H,L,E]),Q=(0,a.VK)((()=>$&&J.length>0),[$,J]),q=(0,n.useCallback)((e=>{t&&(0,k.ZP)({event:e,context:k.Af.NotificationClick,callback:()=>{if(U(),z&&"commented"===t.type){var e;const i=null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.id;return void 0!==i&&y.setNotificationsStatus(L,{spaceId:i,notificationIds:[t.id],archived:!0}),void(t.read||v.Jl("mentions",t.space_id,(e=>Math.max(e-1,0))))}S.createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:L,perform:e=>{v.aZ({notification:t,rootStore:i,transaction:e})}})}})}),[L,t,U,i,z]),X=(0,n.useCallback)((e=>{t&&(0,k.ZP)({event:e,context:k.Af.NotificationClick,callback:()=>{if(t.read?K():F(),z&&"commented"===t.type){var e;const i=null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.id;void 0!==i&&y.setNotificationsStatus(L,{spaceId:i,notificationIds:[t.id],read:!t.read})}S.createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:L,perform:e=>{v.$h({notification:t,rootStore:i,transaction:e,read:!t.read})}})}})}),[L,t,F,K,i,z]),Y=(0,n.useCallback)((()=>{H&&E&&t&&x.Z8({environment:L,notificationId:t.id,pageId:E.pointer.id,isCurrentlyFollowing:(0,I.Z)(H).following,from:"inbox"})}),[L,E,H,t]),ee=(0,r.yK)((e=>({container:{...z?{display:"flex",height:"min-content",borderWidth:1,borderStyle:"solid",borderColor:e.stroke.regular,background:e.buttonGroupBackground,borderRadius:6,padding:2}:{display:"flex",height:"min-content",background:e.buttonGroupBackground,boxShadow:e.lightBoxShadow,borderRadius:4,padding:2}},button:{...z&&{height:V.isMobile?30:26,width:V.isMobile?30:26}},inboxIconBase:{fill:e.icon.secondary,stroke:e.icon.secondary,strokeOpacity:1,strokeWidth:.25},iconStyle:{fill:e.mediumIconColor,padding:2},readIcon:{width:V.isMobile?21:19,height:V.isMobile?22:20},archiveIcon:{width:V.isMobile?24:23,height:V.isMobile?24:23},ellipsisIcon:{width:V.isMobile?24:23,height:V.isMobile?24:23},headerLabel:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:m.Z.fontWeight.semibold}})),[V,z]);return t?(0,O.jsxs)("div",{style:ee.container,children:[(0,O.jsx)(W.Z,{renderTooltip:()=>t.read?(0,O.jsx)(p.FormattedMessage,{defaultMessage:"Mark this notification as unread",id:"inboxActionsMenu.markNotificationAsUnread.tooltipMessage"}):(0,O.jsx)(p.FormattedMessage,{defaultMessage:"Mark this notification as read",id:"inboxActionsMenu.markNotificationAsRead.tooltipMessage"}),render:e=>(0,O.jsx)(j.Z,{style:ee.button,icon:z?t.read?c.h:d.J:t.read?u.F:g.F,iconStyle:{...ee.iconStyle,...ee.readIcon,...z&&{...t.read?{height:17,width:17}:{height:16,width:16},...ee.inboxIconBase}},onClick:X,...e})}),(0,O.jsx)(W.Z,{renderTooltip:()=>(0,O.jsx)(p.FormattedMessage,{defaultMessage:"Archive this notification",id:"inboxActionsMenu.handleArchive.tooltipMessage"}),render:e=>(0,O.jsx)(j.Z,{style:ee.button,icon:s.H,iconStyle:{...ee.iconStyle,...ee.archiveIcon,...z&&{height:18,width:18,...ee.inboxIconBase}},onClick:q,...e})}),Q&&(0,O.jsx)(W.Z,{renderTooltip:()=>(0,O.jsx)(p.FormattedMessage,{...D.changePageNotificationSettings}),render:e=>(0,O.jsx)(_.ZP,{popupType:V.isMobile?_.Z4.SlideUp:_.Z4.Popup,alignmentToOrigin:_.vR.Start,placementToOrigin:_.pO.Bottom,render:e=>(0,O.jsx)(B.Z,{menuType:w.og.Popup,minWidth:290,maxHeight:"50vh",maxWidth:V.isMobile?"100vw":void 0,header:(0,O.jsx)(N.Z,{style:ee.headerLabel,isSmall:!0,isSecondaryColor:!0,children:(0,O.jsx)(p.FormattedMessage,{id:"UpdateSidebarTabUpdatesHeader.pageNotificationSettings.label",defaultMessage:"Page notification settings"})}),children:(0,O.jsx)(R.Z,{context:{blocks:[],environment:L,publicEditMode:void 0},sections:[(0,b.$J)({key:"in-app-notifications-section",render:e=>(0,O.jsx)(P.Z,{...e}),actions:J.map((e=>e.action))})],initialFocus:void 0,onAccept:()=>e.close()})}),renderOrigin:t=>(0,O.jsx)(j.Z,{ariaLabel:G.formatMessage(D.changePageNotificationSettings),style:ee.button,icon:l.O,iconStyle:{...ee.iconStyle,...ee.archiveIcon,...z&&{height:18,width:18,...ee.inboxIconBase}},...e,...(0,M.Z)(t,{onClick:()=>Y()})})})})]}):null}const K=n.memo(F)},57538:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(57883),o=i(97880);function a(e){switch(e){case"all":return{following:!0,followSettings:(0,n.yI)({explicitly_set_by_user:!0})};case"important":return{following:!0,followSettings:(0,n.GC)({explicitly_set_by_user:!0})};case"comments":return{following:!0,followSettings:(0,n.r$)({explicitly_set_by_user:!0})};case"none":return{following:!1,followSettings:(0,n.vU)({explicitly_set_by_user:!0})};default:(0,o.t1)(e)}}},70693:(e,t,i)=>{i.d(t,{mb:()=>s,nK:()=>l,pe:()=>d});var n=i(40506),o=i(7057),a=i(53877),r=i(42875);function s(e){const{dateTime:t,intl:i,shortenDateAndRange:n}=e,r=a.OQ.toPersistedDate(t.valueOf());return o.ZV({value:r,allowRelativeDates:!0,intl:i,shortenDateAndRange:n,displayInUserTimezone:!0})}function l(e){const{dateTime:t,intl:i,userTimeZone:n,displayInUserTimezone:r,alwaysIncludeTimezone:s}=e,l=a.OQ.toPersistedDateTime(t.valueOf(),t.zoneName);return o.ZV({value:l,allowRelativeDates:!0,intl:i,userTimeZone:n,displayInUserTimezone:r,alwaysIncludeTimezone:s})}function d(e){const{luxonRange:t,intl:i}=e,s=a.OQ.toPersistedDateRange(t),l=o.ZV({value:s,allowRelativeDates:!1,shortenDateAndRange:!0,intl:i,displayInUserTimezone:!0}),d=t.end.setZone((0,r.r)()),c=o.mr({start_time:d.toFormat(n.jK),humanReadable:!1,intl:i});return i.formatMessage({id:"verification.timeRange",defaultMessage:"{formattedDateRange} at {formattedEndTime}"},{formattedDateRange:l,formattedEndTime:c})}}}]);