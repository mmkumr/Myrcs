"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8586],{24212:(e,t,s)=>{s.d(t,{Op:()=>R,Oq:()=>E,hS:()=>L});s(57658),s(67294);var i=s(41432),n=s(88437),a=s(66466),o=s(79310),r=s(37612),l=s(13289),d=s(31412),c=s(50906),u=s(3297),m=s(42858),p=s(39699),g=s(52275),h=s(31278),f=s(72495),y=s(19037),x=s(28020),v=s(38755),S=s(74948),b=s(80444),M=s(41363),j=s(82763),w=s(29768),C=s(62967),k=s(42784),T=s(71247),I=s(34658),P=s(6471),_=s(5337),Z=s(85893);const F=(0,d.defineMessages)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},removefromFavoritesName:{id:"action.removefromFavorites.name",defaultMessage:"Remove from Favorites"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"}}),A=(0,C.cN)({key:"remove pinned shared page",displayName:F.unpinName,analyticsName:F.unpinName.defaultMessage,svg:o.A,validators:[y.cW,y.uq],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const{currentSpaceViewStore:i,currentUserSettingsStore:n}=b.default.state;i&&n&&(p.createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:s,perform:e=>{for(const a of t)S.unpinSharedPage({environment:s,transaction:e,spaceViewStore:i,userSettingsStore:n,store:a})}}),c.An9(s,{type:"shared",from:"sidebar_dropdown_menu"}))}}),R=(0,C.cN)({key:"delete block without shortcuts",displayName:C.RE.deleteName,analyticsName:C.RE.deleteName.defaultMessage,svg:r.y,validators:[y.DF,y.eo,y.ff(y.sR),y.ff(y.P9(i.Ti.externalObjectInstancePage)),y.vd],closeParentMenu:!0,action:async e=>{let{blocks:t,environment:s}=e;await m.Qw({environment:s,blocks:t})}}),D=(0,C.cN)({key:"leave shared page",displayName:F.leaveName,analyticsName:F.leaveName.defaultMessage,svg:a.S,validators:[y.cW,y.zl,y.ff(y.uq)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;p.createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:s,perform:e=>{S.leaveBlocks({environment:s,blocks:t,transaction:e})}})}}),B=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,C.cN)({key:"remove from favorites",displayName:F.removefromFavoritesName,analyticsName:F.removefromFavoritesName.defaultMessage,svg:l.B,validators:[...e,y.UI,y.U7,y.ff(y.xD([y.uq,y.cW]))],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const{currentSpaceViewStore:i}=b.default.state;i&&p.createAndCommit({userAction:"actionRegistry.removeFromFavorites",environment:s,perform:e=>{S.unbookmarkPage({spaceViewStore:i,store:t[0],transaction:e})}})}})},L=B([y.tq]),N=B(),O=(0,C.MV)({key:"duplicate to workspace",displayName:F.duplicateToName,analyticsName:F.duplicateToName.defaultMessage,svg:n.a,validators:[y.DF,y.nJ,y.zz,y.ff(y.KE),y.Jl],subActions:e=>{let{blocks:t,environment:s}=e;const{currentUserRootStore:i}=b.default.state;if(!i)return[];const n=t[0],a=x.o(i),o=[];for(const r of a){const e=r.getSpaceStore();if(e){const t=(0,v.rn)(s,e),i=(0,v.Wd)(s,e);o.push({key:r.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await u.DK({environment:s,store:n,spaceStore:e,spaceViewStore:r,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,s)=>{let{environment:n}=s;return(0,Z.jsx)(g.Z,{title:t,icon:(0,Z.jsx)(h.Z,{icon:i,isEmptyPage:!1,title:t,size:n.device.isMobile?24:20,disabled:!0}),...e})}})}}return[(0,C.$J)({key:"duplicate-to",render:e=>(0,Z.jsx)(f.Z,{...e}),actions:o})]}}),E=[k.ww,{key:"outliner primary actions",render:e=>(0,Z.jsx)(f.Z,{...e}),actions:[A,R,D,M._p,N,...(0,w.jW)()?[w.o1,w.vh]:[w.Ay],...(0,w.jW)()?[w.fI,w.MI]:[w.DN],O,P.$]},{key:"outliner navigation",render:e=>(0,Z.jsx)(f.Z,{...e}),actions:[M.IK,I.KB,I.oL,I.sN,I.Jw,j.H,j.K,M.Dw]},{key:"outliner move actions",render:e=>(0,Z.jsx)(f.Z,{...e}),actions:[T.A]},{key:"turn page into teamspace or wiki",render:e=>(0,Z.jsx)(f.Z,{...e}),actions:[_.NO,_.LM,_.BW]}]},81267:(e,t,s)=>{s.d(t,{l:()=>m});s(67294);var i=s(8848),n=s(92717),a=s(31412),o=s(360),r=s(93405),l=s(19037),d=s(62967),c=s(85893);const u=(0,a.defineMessages)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),m=(0,d.cN)({key:"action report page",displayName:u.reportPageName,analyticsName:u.reportPageName.defaultMessage,validators:[l.Gg,l.iK,l.Id],closeParentMenu:!0,render:e=>(0,c.jsx)(r.Z,{...e,style:{color:i.ZP.red},svg:n.o,title:(0,c.jsx)(a.FormattedMessage,{...u.reportPageName})}),action:e=>{let{blocks:t,environment:s}=e;o.l()}})},5337:(e,t,s)=>{s.d(t,{NO:()=>F,LM:()=>_,BW:()=>R,bV:()=>B,R$:()=>L});s(67294);var i=s(62208),n=s(73039),a=s(55863),o=s(70203),r=s(82990),l=s(31412),d=s(47307),c=s(39699),u=s(29919),m=s(72495),p=s(24405),g=s(98742),h=s(93405),f=s(74420),y=s(26388),x=s(85893);function v(e){let{menuListItemProps:t,title:s,caption:i,icon:n,disabled:a,tooltipText:o,showNewBadge:r}=e;window.__c={n:"CreateFromPageMenuItem"};const l=(0,p.yK)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,x.jsx)(y.Z,{placement:y.Z.Placement.Right,textWrap:!1,disableTooltip:!o,renderTooltip:()=>o,render:e=>(0,x.jsx)(h.Z,{...(0,g.Z)(t,e),style:l.menuItem,title:s,caption:i,captionStyle:i?l.caption:void 0,svg:n,disabled:a,disabledFeedback:a,right:r&&(0,x.jsx)(f.Z,{})})})}var S=s(19037),b=s(95697),M=s(77080),j=s(21884),w=s(35057),C=s(73466),k=s(62967),T=s(11732);const I=(0,l.defineMessages)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}}),P=(e,t)=>(0,k.cN)({key:"turn page into team",displayName:t,analyticsName:I.createTeamFromPageFullName.defaultMessage,svg:i.z,validators:e,closeParentMenu:!0,render:(e,s)=>{const i=function(e){const{block:t,environment:s}=e;if(!s.currentUser.id)return;if(0===o.QaF(t.getTitleValue()).length)return(0,x.jsx)(l.FormattedMessage,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,b.Pr)(t).accessLevel&&!(0,w.Rs)())return(0,x.jsx)(l.FormattedMessage,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"})}({environment:s.environment,block:s.blocks[0]});return(0,x.jsx)(v,{menuListItemProps:e,title:(0,x.jsx)(l.FormattedMessage,{...t}),caption:(0,x.jsx)(l.FormattedMessage,{defaultMessage:I.createTeamFromPageCaption.defaultMessage,id:I.createTeamFromPageCaption.id}),disabled:Boolean(i),tooltipText:i,icon:n.K})},action:e=>{let{blocks:t,environment:s}=e;const i=t[0];C.VG({environment:s,page:i})}}),_=P([S.xD([S.jp,S.ff(S.KS)])],I.createTeamFromPageFullName),Z=P([S.jp],I.createTeamFromPageName),F=(0,k.MV)({key:"turn into teamspace or wiki",displayName:T.s.turnIntoSection,analyticsName:T.s.turnIntoSection.defaultMessage,svg:i.z,validators:[S.jp,S.KS],subActions:()=>[(0,k.$J)({key:"turn into teamspace or wiki",render:e=>(0,x.jsx)(m.Z,{...e}),actions:[Z,D]})],width:300}),A=(e,t)=>(0,k.cN)({key:"turn page into wiki",displayName:t,analyticsName:I.turnPageIntoWikiFullName.defaultMessage,svg:i.z,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;"bottom_right"===M.default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?j.E.setState({showConvertTooltip:!1,forceShow:!0}):c.createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,perform:e=>{u.Y({environment:t,blocks:s,transaction:e,source:"page_menu"})}})},render:e=>(0,x.jsx)(v,{menuListItemProps:e,title:(0,x.jsx)(l.FormattedMessage,{...t}),disabled:!1,icon:i.z,caption:(0,x.jsx)(l.FormattedMessage,{...I.turnPageIntoWikiCaption})})}),R=A([S.xD([S.KS,S.ff(S.jp)])],I.turnPageIntoWikiFullName),D=A([S.KS],I.turnPageIntoWikiName);const B=A([S.KS],I.turnPageIntoWikiFullName),L=(0,k.cN)({key:"undo turn page into wiki",displayName:I.undoTurnPageIntoWikiName,analyticsName:I.undoTurnPageIntoWikiName.defaultMessage,svg:a.s,validators:[S.U7,S.U_,S.ff(S.p1),S.f7,S.QL("wiki_database")],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:s}=e;await d.confirmUserAction({message:(0,x.jsx)("div",{style:{textAlign:"center"},children:(0,x.jsx)(l.FormattedMessage,{defaultMessage:"Are you sure you want to turn <bold>{pageName}</bold> back into a normal page?",id:"action.undoTurnIntoWiki.message",values:{pageName:o.QaF(s[0].getTitleValue()),bold:e=>(0,x.jsx)("span",{style:{fontWeight:r.Z.fontWeight.semibold},children:e})}})}),description:(0,x.jsx)("div",{style:{textAlign:"center"},children:(0,x.jsx)(l.FormattedMessage,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})})&&c.createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,perform:e=>{u.Cq({environment:t,blocks:s,transaction:e,source:"page_menu"})}})}})},41311:(e,t,s)=>{s.d(t,{B3:()=>_,T_:()=>P,XP:()=>k,bA:()=>I,h7:()=>Z,w1:()=>C,y2:()=>T});s(57658);var i=s(45433),n=s(68626),a=s(4615),o=s(99405),r=s(23867),l=s(64002),d=s(31412),c=s(95477),u=s(93959),m=s(91924),p=s(77907),g=s(80444),h=s(22756),f=s(67940),y=s(50906),x=s(54642),v=s(47307),S=s(47839),b=s(43181),M=s(15356),j=s(39699);const w=(0,d.defineMessages)({authenticatingWithAsana:{id:"asanaActions.authenticatingWithAsana.loadingMessage",defaultMessage:"Authenticating with Asana…"},titleMessage:{id:"asanaActions.loginWithAsanaPopupModal.title",defaultMessage:"Asana login"}});async function C(e){const{environment:t,flowId:s}=e;await x.disconnectAsana(t,{});const i=(0,m.eC)(t);let n=(0,o.s1)(c.default.domainBaseUrl,{authType:i,userId:t.currentUser.id});if(n=i.redirectToAuth?n:await(0,m.HU)(t,n),t.device.isElectron)return h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0}),void S.openExternalUrl(n);const a=await M.M(t,{width:580,height:800,url:n,titleMessage:w.titleMessage});if(!a)return;const r=l.Qc(a);if(!r.query.code||!r.query.state)return;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0});const d=await x.authWithAsana(t,{code:r.query.code,encryptedState:r.query.state}),u=await x.getAsanaWorkspacesNames(t,{});if("failed"===d.type)y.a1y(t,{import_source:"asana",data:{import_type:"api",status:"failure",error:d.error},flowId:s}),console.error(d.error),v.showError(d);else if(y.a1y(t,{import_source:"asana",data:{import_type:"api",status:"success"},flowId:s}),"success"===u.type){const{data:{account:e,workspaces:t}}=u;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!1,account:e,workspaces:t,currentTab:"selectData",isModalOpen:!0})}}async function k(e){const{environment:t}=e;h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!0});const s=await x.disconnectAsana(t,{});"failed"===s.type?(console.error(s.error),v.showError(s)):(y.qJZ(t,{integration_name:"asana"}),"success"===s.type&&h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!1,account:void 0,workspaces:[]}))}async function T(e){const{selectedWorkspace:t,environment:s}=e;h.Z.setState({...h.Z.state,isLoadingProjects:!0});const i=await x.getTeamsAndProjectsInAsanaWorkspace(s,{workspaceId:t,size:5});"success"===i.type&&h.Z.setState({...h.Z.state,teamsAndProjects:i.data,isLoadingProjects:!1})}async function I(e){let{environment:t}=e;h.Z.setState({...h.Z.state,isLoadingAsanaWorkspaces:!0});const s=await x.getAsanaWorkspacesNames(t,{});"success"===s.type&&h.Z.setState({...h.Z.state,account:s.data.account,workspaces:s.data.workspaces,isLoadingAsanaWorkspaces:!1})}async function P(e){let{environment:t,spaceStore:s,currentSpaceViewStore:o,teamsStores:l,flowId:d}=e;const{appTemplatesSetupActions:c,appConfigs:m}=await p.deps.AppTemplates.loader(),v=h.Z.state.selectedWorkspace;if(!v)return;h.Z.setState({...h.Z.state,templateCreationInProgress:!0});const S={},M={};try{for(const e in h.Z.state.selectedProjectsAndTeamspaces){if(0===h.Z.state.selectedProjectsAndTeamspaces[e].projects.length)continue;let n;const a=h.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:r}=a;if(!r)continue;const d=l.find((e=>e.id===a.notionTeamspaceId));if(n=d||s,M[r])S[e]=M[r];else{const{serverCommitResult:s,performResult:a}=j.createAndCommit({environment:t,perform:e=>{const s={type:"preset",uri:i.T3};if("preset"===s.type&&!s.uri.startsWith("notion://wiki")){var a;const i=s.uri,r=null===(a=(0,u.iX)(m(),i))||void 0===a?void 0:a.uri;if(!r)return;const l=m().find((e=>e.uri===r));if(null==l?void 0:l.presets.find((e=>e.uri===i))){return c.initializeApp({environment:t,spaceViewStore:o,appParentStore:n,appUri:r,presetUri:i,transaction:e,from:"asana_import"})}return[]}},userAction:"importActions.importAsana"});S[e]=a,M[r]=a,await s}}}catch(A){return void h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const w=[],C=g.default.state.currentSpaceViewStore;if(!C)return;const k=b.Ym({environment:t,spaceStore:s,spaceViewStore:C,append:!0});await k.deferred.promise;const T=k.pageId;h.Z.setState({...h.Z.state,loggerPageId:T});const I=new Set,P=[],_=[];for(const i in S){const e=h.Z.state.selectedProjectsAndTeamspaces[i],t=S[i];if(!(t&&e.notionTeamspaceId&&e.projects.length))continue;const n="string"==typeof e.projects?[]:e.projects;P.push(...n),I.add(e.notionTeamspaceId),_.push(i),w.push({collectionViewBlocks:t.map((e=>({id:e.id,spaceId:(0,r.C)(s.id)}))),projectIds:n,asanaTeamId:i,notionTeamSpaceId:e.notionTeamspaceId,importAllProjects:"all"===e.projects,importOnlyIncompleteProjects:"in_complete"===e.projects})}const Z=x.parallelAsanaImport(t,{importParams:w,spaceId:(0,r.C)(s.id),asanaWorkspaceId:v,importCompletedTasks:h.Z.state.importCompletedTasks,loggerPageId:T,flowId:d||(0,a.ZP)()});h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"importingData",choosingWorkspacesCompleted:!0}),f.Z.reset();const F=h.Z.state.workspaces.find((e=>e.gid===v));F&&function(e,t,s){try{y.qyQ(e,{import_source:"asana",data:t,flowId:s})}catch(i){n.log({level:"error",from:"asanaV2Actions",type:"parallelAsanaImport",error:{miscDataString:JSON.stringify({error:i,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceName:F.name,teams:_,projects:P,numberOfTeamspacesUsed:I.size,completedTasks:h.Z.state.importCompletedTasks,userId:t.currentUser.id,spaceId:(0,r.C)(s.id)},d);for await(const i of Z){if(!h.Z.state.isModalOpen)break;if(i.error)return void h.Z.setState({...h.Z.state,currentTab:"failure"});"success"===i.taskStatus&&h.Z.setState({...h.Z.state,currentTab:"confirm",result:i.value.status,isComplete:!0})}}function _(e){var t;let{teamId:s,spaceId:i}=e;h.Z.setState({...h.Z.state,selectedProjectsAndTeamspaces:{...h.Z.state.selectedProjectsAndTeamspaces,[s]:{projects:(null===(t=h.Z.state.selectedProjectsAndTeamspaces[s])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:i}}})}function Z(){h.Z.setState({...h.Z.state,isModalOpen:!0})}},79257:(e,t,s)=>{s.d(t,{D2:()=>h,Do:()=>g,M0:()=>m,W4:()=>p,bA:()=>c,xv:()=>u});var i=s(85680),n=s(98452),a=s(52258),o=s(50906),r=s(6404),l=s(96802),d=s(39699);function c(e){const{originRect:t}=e;a.Z.reset(),n.Z.reset(),r.xv(),i.Z.setState({isOpen:!0,rect:t})}function u(){i.Z.setState({isOpen:!1})}function m(e){const{format:t,store:s,property:i,visibility:n,transaction:a}=e,o=t.property_visibility;o&&a&&l.FH({stores:[s],update:{property_visibility:Object.values(o||{}).map((e=>({property:e.property,visibility:i===e.property?n:e.visibility})))},transaction:a})}function p(e){const{store:t,pageSection:s,visibility:i,environment:n,format:a}=e,r=a.page_section_visibility;r&&(o.Mzl(n,{section:s,visibility:i}),d.createAndCommit({userAction:"customizePageActions.updatePageSectionVisibility",environment:n,perform:e=>{l.FH({stores:[t],update:{page_section_visibility:{...r,[s]:i}},transaction:e})}}))}function g(e){const{store:t,transaction:s,pageSectionFormats:i}=e;l.FH({stores:[t],update:{collection_page_sections:i},transaction:s})}function h(e){const{store:t,properties:s,environment:i}=e;d.createAndCommit({userAction:"customizePageActions.updateCollectionPageProperties",environment:i,perform:e=>{l.FH({stores:[t],update:{collection_page_properties:s},transaction:e})}})}},43181:(e,t,s)=>{s.d(t,{Ym:()=>U,A1:()=>z,am:()=>K,ro:()=>V,su:()=>W});s(57658),s(21703);var i=s(13991),n=s(41432),a=s(7057),o=s(7406),r=s(68626),l=s(59730);const d=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],c=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],u={markdown:c,csv:["text/plain",".csv"],html:["text/html"],docx:d,gdocs:d,dropbox:d,quip:["text/html",c],workflowy:["text/plain"],confluence:["application/zip"],genericImporter:["application/zip"]};var m=s(72126),p=s(91155),g=s(32056),h=s(29477),f=s(4615),y=s(21202),x=s(23867),v=s(31412),S=s(72340),b=s(33954),M=s(8989),j=s(33929),w=s(36214),C=(s(46190),s(78900)),k=s(90365),T=s(82066),I=s(88923),P=s(26350),_=s(50906),Z=s(54642),F=s(47307),A=s(94419),R=s(92625),D=s(9953),B=s(28014),L=s(39699),N=s(53471);const O=(0,v.defineMessages)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importingFromConfluenceViaAPIMessage:{id:"importActions.importingFromConfluenceViaAPI.loadingMessage",defaultMessage:"Importing confluence space: {confluenceSpaceKey}."},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed."},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB."},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},confluenceImportViaAPIFailed:{id:"importActions.confluenceImportViaAPIFailedError.message",defaultMessage:"Confluence space import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}"},importTitleForGenericFileImporter:{id:"importActions.importTitleForGenericFileImporter",defaultMessage:"{fileName} Import {date}"}}),E=1073741824;async function V(e){const{environment:t,pageStore:s,spaceStore:n,isTeamPage:d,spaceViewStore:c,uploadType:m,flowId:x}=e;let v;try{var w;const o=await N.y({multiple:!0,accept:u[m].join(",")});if(0===o.length)return;const r=1===o.length;if("confluence"===m){const s=(Number((0,S.$6)(t))||15)*E;if(o[0].size>s)throw _.a1y(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:o[0].size},flowId:x}),new l.nY("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:g.td(s,1)}}})}else if("genericImporter"===m){const s=(0,M.b)(t)||15,i=s*E;if(o[0].size>i)throw _.a1y(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:o[0].size},flowId:x}),new l.p8("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${s} GB}`}}})}const p=await new Promise(((e,s)=>{N.IL({environment:t,uploadType:m,files:o,bucket:"temporary",preventLimitFreeFileSize:!0,flowId:x,onBatchStart:()=>{R.j({message:r?O.uploadingOneFile:O.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:o.length,percentComplete:0}})},onBatchProgress:e=>{let{uploadedFiles:t,progressPercent:s}=e;R.j({message:r?O.uploadingOneFile:O.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:t,totalNumberOfFiles:o.length,percentComplete:s}})},onBatchComplete:t=>{R.j({message:r?O.uploadingOneFile:O.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:o.length,percentComplete:100}}),e(t)},onBatchError:s})}));let b,C;if(I.default.isSidePeekOpen()&&null!==(w=I.default.peekTarget.state)&&void 0!==w&&w.isEmptyPage())b=I.default.peekTarget.state.id,C="ReplaceBlock";else if(s&&s.isEmptyPage())o.length>1||s.isInsideCollection()?(b=s.id,C="AppendToBlock"):(b=s.id,C="ReplaceBlock");else{const e={date:(0,a.Yx)(Date.now(),"medium",i.SP)};"genericImporter"===m&&(null!=o&&o[0].name?e.fileName=null==o?void 0:o[0].name.replace(".zip",""):e.fileName=(null==o?void 0:o[0].name)||"Universal File");const{performResult:s}=L.createAndCommit({userAction:"importActions.result",environment:t,perform:s=>{const i=j.default.formatMessage("genericImporter"===m?O.importTitleForGenericFileImporter:O.importTitle,e),a=B.KE({environment:t,spaceStore:n,spaceViewStore:c,isPrivate:!d,prepend:!d,title:i,transaction:s});let r;r=o.length>1?"AppendToBlock":"ReplaceBlock";const l=h.UZ();return s.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,createdPage:a,pageId:a.id,importType:r}}});v=s.createdPage,b=s.pageId,C=s.importType,await s.deferred.promise}const k=p.map(((e,t)=>({fileURL:e,fileName:o[t].name})));let T=0;R.j({message:r?O.importingOneFile:O.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:T,totalNumberOfFiles:o.length}});for(const{fileURL:e,fileName:s}of k){if("confluence"===m){_.a1y(t,{import_source:"confluence",data:{import_type:"file",status:"success",fileSize:o[0].size},flowId:x});const i=U({environment:t,spaceStore:n,spaceViewStore:c});await i.deferred.promise;const a=i.pageId,r=Z.parallelImportConfluenceExport(t,{fileURL:e,fileName:s,page:{id:b,spaceId:n.id},loggerPageId:a,flowId:x||(0,f.ZP)()});for await(const e of r){if(e.error)throw e.error;e.value.isComplete||R.j(e.value.status)}}else if("AppendToBlock"===C){const i={fileURL:e,fileName:s,importType:C,block:{id:b,spaceId:n.id},flowId:x};_.qyQ(t,{import_source:"file",data:i,flowId:x});const{value:a}=await Z.importFile(t,i).next();if(a.error)throw a.error}else if("ReplaceBlock"===C){const i={fileURL:e,fileName:s,importType:C,block:{id:b,spaceId:n.id},flowId:x};_.qyQ(t,{import_source:"file",data:i,flowId:x});const{value:a}=await Z.importFile(t,i).next();if(a.error)throw a.error}T++,R.j({message:r?O.importingOneFile:O.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:T,totalNumberOfFiles:o.length}})}return R.x(),P.G.createChildStore(n,{table:y.iU,id:b})}catch(k){var C;let e;r.log({level:"error",from:"importFiles",type:"importFilesFailure",error:(0,p.Ui)(k),data:{spaceId:n.id}}),R.x(),L.createAndCommit({userAction:"importActions.importFiles",environment:t,perform:e=>{v&&A.Od({parent:n.getPagesStore(),childToRemove:v,transaction:e})}});let s=null,i=null;if(k instanceof l.hm&&k.clientData?(s=k.clientData,b.Em[k.clientData.type]&&"ImportFileSizeTooLargeError"===(0,o.tg)(k).message?i=b.Em[k.clientData.type]:b.$5[k.clientData.type]&&"CsvImportError"===(0,o.tg)(k).message?i=b.$5[k.clientData.type]:b.zP[k.clientData.type]&&(i=b.zP[k.clientData.type])):k instanceof l.nY&&"upload_file_size_exceeded"===(null===(C=k.body)||void 0===C||null===(C=C.clientData)||void 0===C?void 0:C.type)&&b.zP[k.body.clientData.type]&&(s=k.body.clientData,i=b.zP[s.type]),s&&i){const t="messageValues"in s?s.messageValues:void 0;e=j.default.formatMessage(i,t)}else e="ImportFileSizeTooLargeError"===(0,o.tg)(k).message?j.default.formatMessage(O.fileImportFailedSizeTooLarge):j.default.formatMessage(O.importFailed);throw F.showErrorMessage(e),k}}function U(e){const{environment:t,spaceStore:s,spaceViewStore:n,append:o}=e,{performResult:r}=L.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const r=j.default.formatMessage(O.importTitle,{date:(0,a.Yx)(Date.now(),"medium",i.SP)}),l=B.KE({environment:t,spaceStore:s,spaceViewStore:n,isPrivate:!0,prepend:!o,title:`${r} Logs`,transaction:e}),d=h.UZ();return e.postSubmitCallbacks.push((e=>{e?d.reject(e):d.resolve()})),{deferred:d,pageId:l.id}}});return r}async function W(e){const{environment:t,boards:s,spaceStore:i,spaceViewStore:n}=e;R.j({message:O.importingFromTrelloMessage,interpolatedValues:{importingCount:s.length}}),T.Z.setState({open:!1});const{performResult:{deferred:a,pages:r}}=L.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{const a=s.map((s=>B.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!0,title:s.name,transaction:e}))),o=h.UZ();return e.postSubmitCallbacks.push((e=>{e?o.reject(e):o.resolve()})),{deferred:o,pages:a}}});await a.promise;try{return await Promise.all(r.map((async(e,i)=>{const n=s[i],{value:a}=await Z.importTrello(t,{boardId:n.id,block:{id:e.id,spaceId:(0,x.C)(e.pointer.spaceId)}}).next();if(a.error)throw a.error}))),R.x(),r[0]}catch(l){throw L.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{for(const t of r)A.Od({parent:i.getPagesStore(),childToRemove:t,transaction:e})}}),F.showErrorMessage(j.default.formatMessage(O.trelloImportFailed)),R.x(),new Error((0,o.tg)(l).message)}}async function K(e){const{environment:t,spaceStore:s,spaceViewStore:i,notebooks:a,userSettingsStore:o}=e;if(0===a.length)throw new Error("Expected at least one notebook");R.j({message:O.importingFromEvernoteMessage,interpolatedValues:{importingCount:a.length}}),k.Z.setState({open:!1});const r=await async function(e){const{environment:t,spaceStore:s,spaceViewStore:i,notebooks:a}=e,{serverCommitResult:o,performResult:{blockStores:r}}=L.createAndCommit({userAction:"importActions.createStacks",environment:t,perform:e=>{const o=m.jj(m.oA(a.map((e=>e.stack)))).sort().reverse(),r={};let l=e=>!0;return a.length>1&&o.length>0&&(o.forEach((o=>{const l=B.KE({environment:t,spaceStore:s,spaceViewStore:i,isPrivate:!0,prepend:!0,loading:!1,title:o,transaction:e}),d=l.getContentStore();a.filter((e=>e.stack===o)).forEach((s=>{const i=D.j4({environment:t,type:n.Ti.copyIndicator,inMemoryRecordCache:l.inMemoryRecordCache,transaction:e,spaceId:d.pointer.spaceId,useCrdt:l.useCrdt()});A.R3({parent:d,append:i,transaction:e}),r[s.guid]=i}))})),l=e=>!Boolean(e.stack)),a.filter(l).reverse().forEach((n=>{const a=B.KE({environment:t,spaceStore:s,spaceViewStore:i,isPrivate:!0,prepend:!0,loading:!0,title:n.title,transaction:e});r[n.guid]=a})),{blockStores:r}}});return await o,r}({environment:t,spaceStore:s,spaceViewStore:i,notebooks:a}),l=r[a[0].guid];try{return await async function(e){const{environment:t,spaceStore:s,spaceViewStore:i,notebooks:n,waitForNotebook:a,notebookMapping:o,userSettingsStore:r}=e;let l;if(h.dC(n,2,(async e=>{await Promise.all(e.map((async e=>{const s=o[e.guid];if(!s)throw new Error(`Missing notebook page ${e.guid}`);const i=h.UZ();s===a&&(l=i),await async function(e){const{environment:t,notebookStore:s,notebook:i,firstCompleted:n}=e,a=Z.importEvernote(t,{notebookId:i.guid,block:{id:s.id,spaceId:(0,x.C)(s.pointer.spaceId)},timestamp:Date.now(),parentTable:y.iU}),{value:o}=await a.next();o.error&&(console.error(o.error),L.createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,perform:e=>{const t=s.getParentBlockStore();if(t){const i=t.getContentStore();A.Od({parent:i,childToRemove:s,transaction:e})}}}),F.showErrorMessage(j.default.formatMessage(O.evernoteImportFailed)));n.resolve(void 0)}({environment:t,notebookStore:s,notebook:e,firstCompleted:i})})))})),!l)throw new Error("waitForNotebookFirstCompleted not defined.");const d=r.getSettings();null!=d&&d.created_evernote_getting_started||await w.FI({environment:t,type:"evernote",spaceStore:s,spaceViewStore:i,userSettingsStore:r});await l.promise}({environment:t,waitForNotebook:l,notebookMapping:r,notebooks:a,spaceStore:s,spaceViewStore:i,userSettingsStore:o}),R.x(),l}catch(d){throw R.x(),F.showErrorMessage(j.default.formatMessage(O.evernoteImportFailed)),d}}async function z(e){const{environment:t,spaceStore:s,spaceViewStore:n,space:l,flowId:d}=e;if(!t.currentUser.id)throw new Error("User does not exist.");R.j({message:O.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:l.name}}),C.Z.setState({open:!1});const c=U({environment:t,spaceStore:s,spaceViewStore:n});await c.deferred.promise;const u=c.pageId,{performResult:m}=L.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{const o=j.default.formatMessage(O.importTitle,{date:(0,a.Yx)(Date.now(),"medium",i.SP)}),r=B.KE({environment:t,spaceStore:s,spaceViewStore:n,isPrivate:!0,prepend:!0,title:o,transaction:e}),l=h.UZ();return e.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,createdPage:r,pageId:r.id}}});await m.deferred.promise;const g=m.createdPage;try{if(!g)throw new Error("No root page");const e=Z.parallelImportConfluenceViaApi(t,{userId:t.currentUser.id,confluenceSpaceKey:l.key,confluenceSpaceId:l.id,page:{id:m.pageId,spaceId:s.id},loggerPageId:u,flowId:d});for await(const t of e){if(t.error)throw t.error;t.value.isComplete||R.j(t.value.status)}return R.x(),g}catch(f){throw r.log({level:"error",from:"importConfluenceViaAPI",type:"importConfluenceViaAPIFailure",error:(0,p.Ui)(f),data:{spaceId:s.id}}),L.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{g&&A.Od({parent:s.getPagesStore(),childToRemove:g,transaction:e})}}),F.showErrorMessage(j.default.formatMessage(O.confluenceImportViaAPIFailed)),R.x(),new Error((0,o.tg)(f).message)}}},61397:(e,t,s)=>{s.d(t,{C8:()=>C,FM:()=>M,IO:()=>j,eL:()=>w,h7:()=>v,qF:()=>S,sC:()=>b});s(57658);var i=s(45433),n=s(23867),a=s(31412),o=s(47307),r=s(93959),l=s(33929),d=s(77907),c=s(80444),u=s(67940),m=s(69122),p=s(50906),g=s(54642),h=s(43181),f=s(92625),y=s(39699);const x=(0,a.defineMessages)({successfullyConnected:{id:"mondayActions.successfullyConnected.message",defaultMessage:"Successfully connected monday.com instance."}});function v(){m.Z.setState({...m.Z.state,isModalOpen:!0})}async function S(e){const{environment:t,userEmail:s,APIToken:i,flowId:n,spaceId:a}=e;if(!t.currentUser.id||!s||!i)return o.showMessage({message:"Invalid details"}),void f.x();const r=await g.authenticateMondayUser(t,{userId:t.currentUser.id,spaceId:a,userEmail:s,APIToken:i});"failed"===r.type?(p.a1y(t,{import_source:"monday.com",data:{import_type:"api",status:"failure",error:r.error},flowId:n}),console.error(r.error),o.showError(r)):(p.a1y(t,{import_source:"monday.com",data:{import_type:"api",status:"success"},flowId:n}),m.Z.setState({...m.Z.state,account:s}),o.showMessage({message:l.default.formatMessage(x.successfullyConnected)})),f.x()}async function b(e){const{environment:t,spaceId:s}=e,i=await g.disconnectMonday(t,{spaceId:s});"failed"===i.type?o.showError(i):(p.qJZ(t,{integration_name:"monday.com"}),"success"===i.type&&m.Z.setState({...m.Z.state,account:void 0,workspaces:[]}))}async function M(e){const{environment:t,spaceId:s}=e;m.Z.setState({...m.Z.state,isLoadingMondayWorkspaces:!0});const i=await g.getMondayWorkspaces(t,{spaceId:s});"success"===i.type&&m.Z.setState({...m.Z.state,workspaces:i.data.workspaces,isLoadingMondayWorkspaces:!1})}async function j(e){const{environment:t,spaceId:s,selectedWorkspace:i}=e;if(!s)return;m.Z.setState({...m.Z.state,isLoadingProjects:!0});const n=await g.getMondayFoldersAndBoards(t,{spaceId:s,selectedWorkspace:i});"success"===n.type&&m.Z.setState({...m.Z.state,mondayFoldersAndBoards:n.data.mondayFoldersAndBoards,isLoadingProjects:!1})}function w(e){var t;let{folderId:s,spaceId:i}=e;m.Z.setState({...m.Z.state,selectedProjectsAndTeamspaces:{...m.Z.state.selectedProjectsAndTeamspaces,[s]:{projects:(null===(t=m.Z.state.selectedProjectsAndTeamspaces[s])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:i}}})}async function C(e){const{environment:t,spaceStore:s,currentSpaceViewStore:a,teamsStores:o}=e,{appTemplatesSetupActions:l,appConfigs:p}=await d.deps.AppTemplates.loader();if(!m.Z.state.selectedWorkspace)return;m.Z.setState({...m.Z.state,templateCreationInProgress:!0});const f={},x={};try{for(const e in m.Z.state.selectedProjectsAndTeamspaces){const n=m.Z.state.selectedProjectsAndTeamspaces[e].projects;if(0===n.length)continue;let d;const c=m.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:u}=c;if(!u)continue;const g=o.find((e=>e.id===c.notionTeamspaceId));if(d=g||s,!f[u]){const{serverCommitResult:e,performResult:s}=y.createAndCommit({environment:t,perform:e=>{const s={type:"preset",uri:i.T3};if("preset"===s.type&&!s.uri.startsWith("notion://wiki")){var n;const i=s.uri,o=null===(n=(0,r.iX)(p(),i))||void 0===n?void 0:n.uri;if(!o)return;const c=p().find((e=>e.uri===o));if(null==c?void 0:c.presets.find((e=>e.uri===i))){return l.initializeApp({environment:t,spaceViewStore:a,appParentStore:d,appUri:o,presetUri:i,transaction:e,from:"monday_import"})}return[]}},userAction:"importActions.importMonday"});f[u]=s,await e}x.hasOwnProperty(u)?x[u]=[...x[u],{mondayFolderId:e,projects:n}]:x[u]=[{mondayFolderId:e,projects:n}]}}catch(w){return void m.Z.setState({...m.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const v=[],S=c.default.state.currentSpaceViewStore;if(!S)return;const b=h.Ym({environment:t,spaceStore:s,spaceViewStore:S,append:!0});await b.deferred.promise;const M=b.pageId;m.Z.setState({...m.Z.state,loggerPageId:M});for(const[i,r]of Object.entries(x)){const e=f[i];e&&v.push({collectionViewBlocks:e.map((e=>({id:e.id,spaceId:(0,n.C)(s.id)}))),notionTeamSpaceId:i,mondayProjectsAndFolders:r})}const j=g.parallelMondayImport(t,{importParams:v,loggerPageId:M,spaceId:s.id});m.Z.setState({...m.Z.state,templateCreationInProgress:!1,currentTab:"importingData"}),u.Z.reset();for await(const i of j){if(!m.Z.state.isModalOpen)break;if(i.error)return void m.Z.setState({...m.Z.state,currentTab:"failure"});"success"===i.taskStatus&&m.Z.setState({...m.Z.state,currentTab:"confirm",result:i.value.status,isComplete:!0})}}},360:(e,t,s)=>{s.d(t,{l:()=>n,q:()=>a});var i=s(25399);function n(){i.Z.setState({open:!0,submitted:!1,error:void 0})}function a(){i.Z.setState({open:!1})}},16859:(e,t,s)=>{s.d(t,{d:()=>_});var i=s(67294),n=s(480),a=s(31412),o=s(73063),r=s(53437),l=s(26388),d=s(935),c=s(24405),u=s(64275),m=s(81570),p=s(83065),g=s(82990),h=s(42922),f=s(64921),y=s(60458),x=s(1743),v=s(74194),S=s(16354),b=s(64369),M=s(42402),j=s(43250),w=s(18514),C=s(85893);function k(e){const{checked:t,onChange:s}=e;return(0,C.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[(0,C.jsx)(y.Z,{checked:t,onClick:s,size:14}),(0,C.jsx)("div",{onClick:s,children:(0,C.jsx)(b.Z,{style:{cursor:"pointer"},isSmall:!0,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Share this AI session with Notion",id:"completions.FeedbackPopup.shareWithNotion"})})})]})}function T(){window.__c={n:"OptInLearnMore"};const e=(0,c.yK)((e=>({container:{display:"flex",flexDirection:"row"},giftIcon:{width:16,height:16,fill:e.lightIconColor},message:{marginLeft:9,color:e.mediumTextColor,fontSize:12}})),[]);return(0,C.jsxs)("div",{style:e.container,children:[(0,m.T)(e.giftIcon),(0,C.jsx)("div",{style:e.message,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"You’re sharing data with Notion for AI quality improvement. <aiTerms>Learn more</aiTerms>",id:"completions.OptInLearnMore.description",values:{aiTerms:e=>(0,C.jsx)(M.Z,{external:!0,href:(0,w.UY)("ai.dataSharingTerms"),children:e})}})})]})}function I(e){window.__c={n:"ShareDataPopup"};const{onSubmit:t}=e,s=(0,c.yK)((e=>({container:{width:300,display:"flex",flexDirection:"column",alignItems:"center",padding:19,position:"relative"},closeButtonContainer:{position:"absolute",top:10,right:10},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor},giftIcon:{width:24,height:24,fill:e.lightIconColor},terms:{color:e.mediumTextColor,textAlign:"center",fontSize:13},shareButton:{width:"100%",marginTop:17,paddingTop:7,paddingBottom:7},notNowButton:{color:e.mediumTextColor,fontSize:14,marginTop:15},title:{textAlign:"center",marginTop:9,marginBottom:8,fontWeight:g.Z.fontWeight.semibold}})),[]);return(0,C.jsxs)("div",{style:s.container,children:[(0,C.jsx)("div",{style:s.closeButtonContainer,children:(0,C.jsx)(f.Z,{onClick:()=>{t({optIn:!1})},style:s.closeButton,hoveredStyle:s.closeButtonHover,children:(0,u.D)(s.closeButtonIcon)})}),(0,m.T)(s.giftIcon),(0,C.jsx)("div",{style:s.title,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Always share data to improve Notion AI?",id:"completions.ShareDataPopup.title"})}),(0,C.jsx)("div",{style:s.terms,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Help Notion improve AI quality by automatically sharing data from your usage of AI powered features.{br}By continuing, you agree to <aiTerms>AI Data Sharing Terms</aiTerms>",id:"completions.ShareDataPopup.description",values:{br:(0,C.jsx)("br",{}),aiTerms:e=>(0,C.jsx)(M.Z,{external:!0,href:(0,w.UY)("ai.dataSharingTerms"),children:e})}})}),(0,C.jsx)(h.Z,{style:s.shareButton,onClick:()=>{t({optIn:!0})},children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Always share",id:"completions.ShareDataPopup.alwaysShareButton"})}),(0,C.jsx)(S.Z,{style:s.notNowButton,onClick:()=>{t({optIn:!1})},children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Not now",id:"completions.ShareDataPopup.notNowButton"})})]})}function P(e){window.__c={n:"FeedbackPopup"};const{state:t,onUpdate:s,onSubmit:r,onCancel:l,userOptIn:d}=e,c=(0,i.useCallback)((()=>{s({...t,shareWithNotion:!t.shareWithNotion})}),[t,s]),u=(0,i.useCallback)((()=>{r(t)}),[r,t]),m=(0,i.useCallback)((e=>{s({...t,userContent:e.target.value})}),[s,t]),g=(0,a.useIntl)(),h=(0,n.O7)(),f=!d;return(0,C.jsx)("div",{style:{padding:14,...h.device.isMobile?{width:"100%"}:{minWidth:400}},className:j.YOJ,children:(0,C.jsxs)(x.Z,{capture:!0,children:[(0,C.jsx)(v.Z,{value:t.userContent,onChange:m,onSubmit:e=>{e.stopPropagation(),u()},onCancel:l,focusInitial:!0,placeholder:g.formatMessage({id:"completions.FeedbackPopup.userCommentPlaceholder",defaultMessage:"How could the output be improved? (optional)"})}),(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingTop:10},children:[f?(0,C.jsx)(k,{checked:t.shareWithNotion,onChange:c}):(0,C.jsx)(T,{}),(0,C.jsx)(o.Z,{icon:p._,onClick:u,ariaLabel:g.formatMessage({id:"completions.FeedbackPopup.submitButtonLabel",defaultMessage:"Submit feedback"}),isBlue:!0,iconStyle:{height:24,width:24},style:{height:20,width:20}})]})]})})}function _(e){window.__c={n:"FeedbackButtonWithPopup"};const{type:t,ariaLabel:s,onClick:c,feedbackState:u,onDismiss:m,onSubmit:p,onUpdate:g,showShareDataPopup:h,onDataShareSubmit:f,userOptIn:y,iconButtonStyles:x}=e,v=(0,n.O7)(),S=t===(null==u?void 0:u.type),b=(0,d.L)(t,S),M=(0,i.useCallback)((()=>c(t)),[c,t]),j=(0,C.jsx)(l.Z,{renderTooltip:()=>(0,C.jsx)("div",{children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Share feedback with Notion",id:"completions.CompletionMenuActionBar.feedbackTooltip"})}),placement:l.Z.Placement.Bottom,render:e=>(0,C.jsx)(o.Z,{onClick:M,icon:b,ariaLabel:s,style:{...x},...e})});return(0,C.jsx)(r.ZP,{origin:j,open:(null==u?void 0:u.type)===t,popupType:v.device.isMobile?r.kQ.SlideUp:r.kQ.Popup,onDismiss:m,render:()=>u?h?(0,C.jsx)(I,{onCancel:m,onSubmit:f}):(0,C.jsx)(P,{state:u,onSubmit:p,onUpdate:g,onCancel:m,userOptIn:y}):null})}},935:(e,t,s)=>{s.d(t,{L:()=>b,u:()=>M});var i=s(67294),n=s(480),a=s(86628),o=s(33676),r=s(97022),l=s(39986),d=s(10498),c=s(31412),u=s(50906),m=s(64964),p=s(39699),g=s(37181),h=s(80444),f=s(77080),y=s(35057),x=s(84254),v=s(16859),S=s(85893);function b(e,t){switch(e){case"thumbsup":return t?d.w:l.P;case"thumbsdown":return t?r.E:o.A}}function M(e){window.__c={n:"FeedbackButtons"};const{revision:t}=e,s=(0,c.useIntl)(),o=(0,n.O7)(),[r,l]=(0,i.useState)(void 0),[d,b]=(0,i.useState)(!1),M=(0,i.useRef)(null),j=(0,a.VK)((()=>f.default.checkGate("ai_data_sharing")),[]),w=(0,a.VK)((()=>h.default.state.currentUserSettingsStore),[]),C=(0,a.VK)((()=>{var e;const t=null==w||null===(e=w.getSettings())||void 0===e?void 0:e.seen_ai_data_share_prompt_at,s=!(0,y.mq)();return!Boolean(t)&&s}),[w]),k=(0,a.VK)((()=>{var e;return(null==w||null===(e=w.getSettings())||void 0===e?void 0:e.ai_data_share_opt_in)??false}),[w]),T=(0,i.useCallback)((()=>{m.oV({label:s.formatMessage({id:"completions.CompletionMenuFooter.showFeedbackThanksMessage",defaultMessage:"Thanks for submitting feedback!"})})}),[s]),I=(0,i.useCallback)((e=>{M.current=document.activeElement,l((t=>({userContent:"",shareWithNotion:true,...t,type:e})))}),[]),P=(0,i.useCallback)((e=>{e.shareWithNotion&&C&&j?b(!0):(T(),l(void 0)),x.submitFeedbackForRevision({...e,environment:o,revision:t,userOptIn:k})}),[t,o,k,C,j,T]),_=(0,i.useCallback)((e=>{e&&e.stopPropagation&&e.stopPropagation(),l(void 0),M.current&&M.current instanceof HTMLElement&&M.current.focus()}),[]),Z=(0,i.useCallback)((e=>{const{optIn:t}=e;w&&(p.createAndCommit({userAction:"FeedbackButtons.aiDataShareOptIn",environment:o,userId:w.id,perform:e=>{g.d2({userSettingsStore:w,data:{ai_data_share_opt_in:t,seen_ai_data_share_prompt_at:Date.now()},transaction:e})}}),u.bd0(o,{user_opt_in:t}),t?m.oV({label:s.formatMessage({id:"completions.CompletionMenuFooter.dataShareThanks",defaultMessage:"Thank you for your help making Notion better!"})}):T(),b(!1),l(void 0))}),[s,w,o,T]);return t.hasFeedback&&!d?null:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(v.d,{type:"thumbsup",ariaLabel:s.formatMessage({id:"completions.CompletionMenuFooter.thumbsUp",defaultMessage:"Submit positive feedback"}),onClick:I,feedbackState:r,onDismiss:_,onSubmit:P,onUpdate:l,showShareDataPopup:d,onDataShareSubmit:Z,userOptIn:k}),(0,S.jsx)(v.d,{type:"thumbsdown",ariaLabel:s.formatMessage({id:"completions.CompletionMenuFooter.thumbsDown",defaultMessage:"Submit negative feedback"}),onClick:I,feedbackState:r,onDismiss:_,onSubmit:P,onUpdate:l,showShareDataPopup:d,onDataShareSubmit:Z,userOptIn:k})]})}},87636:(e,t,s)=>{s.d(t,{Z:()=>f});var i=s(67294),n=s(13991),a=s(480),o=s(24405),r=s(22491),l=s(97880),d=s(82990),c=s(17311),u=s(23063),m=s(64921),p=s(26388),g=s(85893);function h(e){window.__c={n:"ActionMenuGroupButton"};const{button:t,isLast:s}=e,n=(0,o.yK)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:d.Z.fontWeight.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return i.cloneElement(t,{...(0,r.iv)(t.props.style,n.button,s&&n.buttonLast),hoveredStyle:(0,r.iv)(n.buttonHovered,s&&n.buttonLast).style,pressedStyle:n.buttonPressed})}const f=function(e){let{children:t,isVisible:s,position:f,style:y}=e;window.__c={n:"ActionMenuGroup"};const x=(0,a.O7)(),v=(0,o.yK)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.lightBoxShadow,display:"flex",whiteSpace:"nowrap",borderRadius:c.Z.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:x.device.isMobile?"auto":"none",opacity:x.device.isMobile?1:0,fontFamily:d.Z.getCompositeFontFamily(n.SP).sans,position:"absolute",right:c.Z.horizontal.small,bottom:c.Z.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:c.Z.vertical.small,bottom:void 0}})),[x]),S=i.Children.toArray(t).filter(l.$K),b=S.length;return(0,g.jsx)(u.Z,{isVisible:!0,animationStyle:{opacity:s?1:0},render:()=>(0,g.jsx)("div",{...(0,r.iv)(v.container,y,s&&v.containerHover,"top"===f&&v.containerTop),children:S.map(((e,t)=>{const s=t===b-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===p.Z&&i.isValidElement(e))return i.cloneElement(e,{render:(t,i)=>{const n=e.props.render(t,i);return(0,g.jsx)(h,{isLast:s,button:n},e.key)}});if(e.type===m.Z&&i.isValidElement(e))return(0,g.jsx)(h,{isLast:s,button:e},e.key)}}))})})}},41229:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(41892),l=s(64275),d=s(31412),c=s(41752),u=s(33932),m=s(1853),p=s(80444),g=s(21273),h=s(56887),f=s(66309),y=s(89024),x=s(90403),v=s(97122),S=s(64921),b=s(64369),M=s(85893);function j(){window.__c={n:"IntroVideo"};return"dark"===(0,o.Fg)().mode?(0,M.jsx)("img",{src:r.Z.images.onboarding.aiQnaDarkPng,style:{width:353,height:145}}):(0,M.jsx)("img",{src:r.Z.images.onboarding.aiQnaLightPng,style:{width:353,height:145}})}const w=(0,d.injectIntl)((function(e){window.__c={n:"AiQnaIntroModal"};const[t,s]=(0,i.useState)(!1),r=(0,n.O7)(),w=(0,o.Fg)(),C=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e}=p.default.state;e&&(0,c.C)(r,{userSettingsStore:e,phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickCancel"})}),[r]),k=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e}=p.default.state;e&&((0,u.O)({view:"chat"}),(0,c.C)(r,{userSettingsStore:e,phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTryNow"}))}),[r]),T=(0,a.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t,mainEditorCurrentBlockStore:s,inAppCalloutStore:i}=p.default.state;if(!i.canShow("ai_qna_alpha"))return!1;if(!e||!e.isReady())return!1;const n=e.getSettings();return!!n&&(!!(t&&s&&s.canRead())&&(!r.device.isMobile&&(!(void 0!==n.ai_qna_intro_onboarding_phase||!g.Z.showAiQnaOnboardingModalForAlphaLaunch())||void 0)))}),[r.device]);(0,i.useEffect)((()=>{s(!!T)}),[T]);const I=(0,h.useNamedStyles)();return(0,M.jsx)(f.default,{shouldShow:t,calloutId:"ai_qna_alpha",desktopRenderInner:()=>{const{WindowSizeStore:e}=r;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(S.Z,{onClick:C,style:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:w.buttonHoveredBackground,width:18,height:18,marginTop:e.state.paddingTopCSS},hoveredStyle:{background:w.buttonPressedBackground},children:(0,l.D)({width:14,fill:w.mediumTextColor})}),(0,M.jsx)(m.U4,{}),(0,M.jsxs)(y.jX,{gap:30,children:[(0,M.jsx)(y.jX,{padding:"10px 22px 0px 22px",children:(0,M.jsx)(j,{})}),(0,M.jsxs)("div",{style:I.introCopyArea,children:[(0,M.jsx)(h.NotionAI,{}),(0,M.jsxs)("div",{style:I.introTitle,children:[(0,M.jsx)(d.FormattedMessage,{defaultMessage:"Welcome to Q&A",id:"AiQnaIntroModal.intro.title"}),(0,M.jsx)(x.Z,{style:I.betaBadge,content:(0,M.jsx)(d.FormattedMessage,{id:"AiQnaIntroModal.intro.betaLabel",defaultMessage:"Beta"})})]}),(0,M.jsx)(b.Z,{isSecondaryColor:!0,isMultiline:!0,style:I.mainCopyText,children:(0,M.jsx)(d.FormattedMessage,{defaultMessage:"Get instant answers to your questions, using information from across your workspace.",id:"AiQnaIntroModal.intro.caption"})})]}),(0,M.jsxs)(h.Footer,{children:[(0,M.jsx)(h.LearnMoreLink,{shouldShowHelpCenterLink:!0}),(0,M.jsx)(y.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:(0,M.jsx)(v.h,{onClick:k,children:(0,M.jsx)(d.FormattedMessage,{defaultMessage:"Continue",id:"AiQnaIntroModal.intro.signup.nextMessage"})})})]})]})]})},desktopInnerStyle:{background:w.sidebarBackground,borderRadius:12,width:450},desktopOnDismiss:C,phoneRenderInner:()=>null})}))},56887:(e,t,s)=>{s.r(t),s.d(t,{Footer:()=>N,LearnMoreLink:()=>V,NotionAI:()=>W,default:()=>Q,useNamedStyles:()=>H});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(41892),l=s(3338),d=s(1436),c=s(11751),u=s(97880),m=s(82990),p=s(31412),g=s(54642),h=s(64964),f=s(97627),y=s(1865),x=(s(95477),s(1853)),v=s(15010),S=s(99622),b=s(12205),M=s(80444),j=s(77080),w=s(80671),C=s(35057),k=s(66309),T=s(89024),I=s(90403),P=s(97122),_=s(42922),Z=s(84076),F=s(89728),A=s(64369),R=s(6175),D=s(85893);const B=24;function L(e){const{stage:t,setStage:s}=e;switch(t){case"intro":return(0,D.jsx)(O,{onAddedToWaitlist:()=>s("thank-u-next")});case"thank-u-next":return(0,D.jsx)(q,{});default:(0,u.t1)(t)}}function N(e){window.__c={n:"Footer"};const{children:t}=e,s=H(),{isPhone:i}=(0,n.Fy)();return i?(0,D.jsx)(T.jX,{align:"center-right",gap:12,padding:B,style:s.footer,children:t}):(0,D.jsx)(T.jX,{align:"center",direction:"row",gap:"auto",padding:B,style:s.footer,children:t})}function O(e){window.__c={n:"IntroStage"};const{onAddedToWaitlist:t}=e,s=H(),a=(0,i.useContext)(x.gv),o=function(e){const t=(0,n.O7)();return(0,i.useCallback)((()=>{const{currentSpaceStore:s,currentSpaceViewStore:i}=M.default.state;s&&i&&(g.addUserToWaitlist(t,{program:"ai",spaceId:s.id}),e())}),[t,e])}(t);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(x.U4,{}),(0,D.jsxs)(T.jX,{gap:32,children:[(0,D.jsx)(E,{}),(0,D.jsx)("div",{style:s.introCopyArea,children:(0,D.jsxs)(T.jX,{gap:8,children:[(0,D.jsx)(W,{}),(0,D.jsxs)("div",{style:s.introTitle,children:[(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Introducing Q&A",id:"AiQnaWaitlistModal.intro.title"}),(0,D.jsx)(I.Z,{style:s.betaBadge,content:(0,D.jsx)(p.FormattedMessage,{id:"AiQnaWaitlistModal.intro.betaLabel",defaultMessage:"Beta"})})]}),(0,D.jsx)(A.Z,{isSecondaryColor:!0,isMultiline:!0,style:s.mainCopyText,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Get instant answers to your questions, using information from across your workspace.",id:"AiQnaWaitlistModal.intro.caption"})})]})}),(0,D.jsxs)(N,{children:[(0,D.jsx)(V,{}),(0,D.jsxs)(T.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:[(0,D.jsx)(F.Z,{isSmall:!0,style:s.skipButton,onClick:a,children:(0,D.jsx)(A.Z,{isSmall:!0,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Skip",id:"AiQnaWaitlistModal.intro.skip.nextMessage"})})}),(0,D.jsx)(P.h,{onClick:o,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Request access to Q&A",id:"AiQnaWaitlistModal.intro.signup.nextMessage"})})]})]})]})]})}function E(){window.__c={n:"IntroVideo"};const e=H();return(0,D.jsx)(R.Z,{src:"https://player.vimeo.com/video/879544506?h=9314829857",defaultTextTrack:"en",options:{background:!0},style:e.stubPng})}function V(e){let{shouldShowHelpCenterLink:t}=e;window.__c={n:"LearnMoreLink"};const s=H();return(0,D.jsx)("div",{style:s.learnMoreCopy,children:(0,D.jsxs)(Z.Z,{style:s.learnMoreLink,innerStyle:s.learnMoreLinkInner,href:t?"https://www.notion.so/help/qna":"https://www.notion.so/ai",external:!0,children:[(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Learn more about Q&A",id:"AiQnaWaitlistModal.intro.learnMoreUrl"}),(0,d.g)(s.connectedAppsIcon)]})})}function U(){window.__c={n:"NextSteps"};const e=(0,b.J)(),t=(0,S.Y)();return t&&e?null:t&&!e?(0,D.jsx)(z,{}):!t&&e?(0,D.jsx)(G,{}):t||e?null:(0,D.jsx)(z,{})}function W(){window.__c={n:"NotionAI"};const e=H();return(0,D.jsxs)(T.jX,{direction:"row",children:[(0,c.t)(e.sparklesIcon),(0,D.jsx)(A.Z,{isSmall:!0,style:e.notionAiText,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Notion AI",id:"AiQnaWaitlistModal.intro.brandingHero"})})]})}function K(){window.__c={n:"QnaBuds"};const e=H(),t="dark"===(0,o.Fg)().mode?r.Z.images.onboarding.aiQnaBudsDarkPng:r.Z.images.onboarding.aiQnaBudsPng;return(0,D.jsx)("img",{style:e.qnaBuds,src:t})}function z(){window.__c={n:"RequestAccess"};const e=H(),t=function(){const e=(0,n.O7)(),t=(0,i.useContext)(x.gv);return(0,i.useCallback)((()=>{(0,w.jw)(e),null==t||t(),h.oV({label:(0,D.jsx)(p.FormattedMessage,{id:"AiQnaWaitlistModal.requestAccess.snackbar",defaultMessage:"Thank you! We received your request"})})}),[e,t])}();return(0,D.jsxs)("div",{style:e.nextSteps,children:[(0,D.jsx)(A.Z,{isMultiline:!0,style:e.upsellHeader,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Request an upgrade",id:"AiQnaWaitlistModal.thankunext.requestUpgrade"})}),(0,D.jsx)(A.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,style:e.upsellCopy,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Send a request to your workspace owner to upgrade for unlimited usage of Notion AI.",id:"AiQnaWaitlistModal.thankunext.captionRequest"})}),(0,D.jsx)(_.Z,{style:e.upsellButton,onClick:t,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Send upgrade request",id:"AiQnaWaitlistModal.requestUpgrade.nextMessage"})}),(0,D.jsx)(K,{})]})}function q(){window.__c={n:"ThankYouStage"};const e=H(),t=(0,i.useContext)(x.gv),s=(0,a.VK)((()=>{var e;return null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(x.U4,{}),(0,D.jsxs)(T.jX,{gap:32,children:[(0,D.jsxs)(T.jX,{gap:32,padding:"0 24px",children:[(0,D.jsx)("div",{children:(0,D.jsxs)(T.jX,{gap:6,children:[(0,D.jsx)("div",{style:e.thanksHeaderArea,children:(0,D.jsxs)(T.jX,{gap:6,children:[(0,l.p)(e.circleCheckIcon),(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Thanks, you're on the list!",id:"AiQnaWaitlistModal.thankunext.title"})]})}),(0,D.jsx)(A.Z,{isSecondaryColor:!0,isMultiline:!0,style:e.thanksCopy,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Your workspace owners will get an email when {spaceName} receives access to Q&A.",id:"AiQnaWaitlistModal.thankunext.caption",values:{spaceName:s}})})]})}),(0,D.jsx)(U,{})]}),(0,D.jsxs)(N,{children:[(0,D.jsx)(V,{}),(0,D.jsx)(F.Z,{isSmall:!0,style:e.thanksDoneButton,onClick:t,children:(0,D.jsx)(A.Z,{isSmall:!0,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Got it",id:"AiQnaWaitlistModal.thankunext.gotIt"})})})]})]})]})}function G(){window.__c={n:"Upsell"};const e=H(),t=function(){const e=(0,n.O7)();return(0,i.useCallback)((()=>{y.y(e,{from:"ai_qna_waitlist",for:(0,C.zt)(),addOnFeature:"ai"})}),[e])}();return(0,D.jsxs)("div",{style:e.nextSteps,children:[(0,D.jsx)(A.Z,{isMultiline:!0,style:e.upsellHeader,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Upgrade to go unlimited",id:"AiQnaWaitlistModal.thankunext.headerUpsell"})}),(0,D.jsx)(A.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,style:e.upsellCopy,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Give everyone in your workspace unlimited use of Notion AI's writing assistant and database autofill. Plus, we'll bump you to the top of the list for Q&A!",id:"AiQnaWaitlistModal.thankunext.captionUpsell"})}),(0,D.jsx)(_.Z,{style:e.upsellButton,onClick:t,children:(0,D.jsx)(p.FormattedMessage,{defaultMessage:"Get Notion AI",id:"AiQnaWaitlistModal.thankunext.nextMessage"})}),(0,D.jsx)(K,{})]})}function H(){return(0,o.yK)((e=>({betaBadge:{borderRadius:4,display:"inline-block",fontSize:11,fontWeight:500,padding:"1px 4px"},circleCheckIcon:{color:e.grayButtonBackground,paddingBottom:4,width:32},connectedAppsIcon:{height:14,marginLeft:4,width:14},desktopInner:{background:e.sidebarBackground,borderRadius:12,width:450},footer:{borderTop:`1px solid ${e.tableLightDividerColor}`},introCopyArea:{paddingLeft:B,paddingRight:B},introTitle:{fontWeight:m.Z.fontWeight.bold,fontSize:25,display:"flex"},learnMoreCopy:{color:e.mediumTextColor,fontSize:12},learnMoreLink:{width:"max-content",marginLeft:-4},learnMoreLinkInner:{display:"flex",alignItems:"center",paddingLeft:4,paddingRight:4},mainCopyText:{width:350},nextSteps:{borderRadius:8,background:"dark"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[50],padding:16,position:"relative"},notionAiText:{marginTop:2,paddingLeft:4,color:e.accentColors.gray[900],fontWeight:m.Z.fontWeight.medium},qnaBuds:{position:"absolute",height:103,bottom:0,right:0},sparklesIcon:{width:14},skipButton:{height:32},stubPng:{width:"100%",height:252,borderBottomLeftRadius:0,borderBottomRightRadius:0},thanksCopy:{width:375},thanksDoneButton:{height:32},thanksHeaderArea:{fontWeight:m.Z.fontWeight.bold,fontSize:25,marginTop:40},upsellButton:{marginTop:12,height:32,minWidth:72,width:"fit-content"},upsellCopy:{width:270},upsellHeader:{fontWeight:600,fontSize:16,paddingBottom:6,paddingTop:4}})),[])}const Q=function(){window.__c={n:"AiQnaWaitlistModal"};const[e,t]=(0,i.useState)(!1),[s,o]=(0,i.useState)("intro"),r=H(),l=function(){const e=(0,n.O7)(),t=(0,a.VK)((()=>j.default.checkGate("qna_nov_9_rollout")),[]);return(0,a.VK)((()=>{const{currentSpaceViewStore:s,currentSpaceStore:i,mainEditorCurrentBlockStore:n,inAppCalloutStore:a,currentUserSettingsStore:o}=M.default.state;if(!a.canShow("ai_qna_beta_waitlist"))return!1;if(!s||!s.isReady())return!1;if(!o||!o.isReady())return!1;const r=s.getSettings();return!!r&&(!!(i&&n&&n.canRead())&&(!(Number((0,v.e2)(o))<=2)&&(!e.device.isMobile&&(!i.getZeroRetentionEnabled()&&(!i.getSettings().disable_ai_feature&&!i.getSettings().embedding_index_is_live&&!(void 0!==r.ai_qna_waitlist_shown||!t))))))}),[e.device,t])}(),d=function(e,t){const s=(0,n.O7)();return(0,i.useCallback)((()=>{const{currentSpaceViewStore:i}=M.default.state;i&&(e(!1),t("intro"),f.aW(s,{spaceViewStore:i,shown:!0,transactionUserAction:"AiQnaWaitlistModal.cancel"}))}),[s,e,t])}(t,o);return(0,i.useEffect)((()=>{t(!!l)}),[l]),(0,D.jsx)(x.gv.Provider,{value:d,children:(0,D.jsx)(k.default,{shouldShow:e,calloutId:"ai_qna_beta_waitlist",desktopRenderInner:()=>(0,D.jsx)(L,{stage:s,setStage:o}),desktopInnerStyle:r.desktopInner,desktopOnDismiss:d,phoneRenderInner:()=>(0,D.jsx)(L,{stage:s,setStage:o})})})}},87493:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});s(67294);var i=s(480),n=s(41363),a=s(87279),o=s(48019),r=s(78140),l=s(85893);const d=function(e){let{block:t,onAccept:s}=e;window.__c={n:"AliasBlockPopupMenu"};const d={blocks:[t],environment:(0,i.O7)(),publicEditMode:void 0};return(0,l.jsx)(r.Z,{menuType:a.og.Popup,children:(0,l.jsx)(o.Z,{sections:n.Qi,context:d,onAccept:s})})}},66309:(e,t,s)=>{s.r(t),s.d(t,{default:()=>M});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(27328),r=s(24677),l=s(98104),d=s(95477),c=s(18514),u=s(34859),m=s(80444),p=s(77080),g=s(69454),h=s(36488),f=s(28451),y=s(50506),x=s(53437),v=s(53336),S=s(32662),b=s(85893);function M(e){window.__c={n:"AnnouncementModal"};const t=(0,i.O7)(),s=(0,a.Fg)(),M=(0,i.Fy)(),j=(0,n.VK)((()=>(0,c.__)(t)),[t]),w=(0,n.VK)((()=>t.TabbedRouterStore),[t.TabbedRouterStore]),C=(0,n.VK)((()=>(0,o.w_)(w.state)),[w]),k=(0,n.VK)((()=>{var e;return"web"===C.type&&((null===(e=C.redirectedTo)||void 0===e?void 0:e.route)||C.route)}),[C]),T=(0,n.VK)((()=>{const t="rendered"===m.default.state.renderPhase,s=p.default.state.isLoaded;if(!t||!s)return!1;const i=d.default.isAdminMode;return M.isPhone&&j?e.shouldShow&&!i&&k&&"page"===k.name:e.shouldShow&&!d.default.isAdminMode}),[M.isPhone,j,e.shouldShow,k]),I=(0,n.VK)((()=>t.WindowSizeStore.isLandscape()),[t.WindowSizeStore]),P=(0,n.VK)((()=>{const e=g.Z.state.phase===g.i.hidden||g.Z.state.phase===g.i.willHide;let s=g.Z.estimatedNativeWebBottomOverlap();return M.isMobileBrowser&&(s+=32),e?t.WindowSizeStore.getSafePaddingBottomPx(s):s}),[M.isMobileBrowser,t.WindowSizeStore]);if(M.isPhone){function i(){var s;null===(s=e.onModalShow)||void 0===s||s.call(e),r.ZH(t),l.sD()}return(0,b.jsx)(f.g,{calloutId:e.calloutId,shouldShow:T,onShow:i,children:(0,b.jsx)(x.ZP,{open:T,forceFullScreenSlideUp:!0,hidesMobileNativeBottomBar:!0,preventBlockRenderQueueOnEnter:!0,popupType:x.ZP.PopupType.SlideUp,style:{background:s.sidebarBackground,borderRadius:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},render:()=>(0,b.jsxs)(v.Z,{type:u.Z.Y,style:{background:s.sidebarBackground,width:I?"80%":"100%",height:I?void 0:"100%",display:"flex",flexDirection:"column",alignItems:"center",...e.phoneInnerStyle},children:[(0,b.jsx)(S.Z,{size:I?200:0}),e.phoneRenderInner(),(0,b.jsx)(S.Z,{size:P})]})})})}return(0,b.jsx)(f.g,{calloutId:e.calloutId,shouldShow:T,onShow:e.onModalShow,children:(0,b.jsx)(y.Z,{open:T,preventHideChildrenWhileOpening:!0,onDismiss:e.desktopOnDismiss,innerStyle:{background:s.sidebarBackground,borderRadius:12,...e.desktopInnerStyle},render:()=>(0,b.jsx)(h.Z,{capture:!0,allowEsc:!0,render:e.desktopRenderInner})})})}},10266:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Vl});var i=s(67294),n=s(480),a=s(86628),o=s(47839),r=s(52989),l=s(83355),d=s(31412),c=s(36488),u=s(78140),m=s(53437),p=s(43250),g=s(87279),h=s(77907),f=s(95306),y=s(34047),x=s(9080),v=s(85893);class S extends l.Z{constructor(){super(...arguments),this.renderDiscussion=()=>{const{device:e}=this.environment;if(x.Z.state.open){const{discussionStore:t,discussionInputStore:s,blockStore:i,discussionLocation:n}=x.Z.state;let a;return a=e.isMobile?{menuType:g.og.Modal,title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Comments",id:"discussion.mobileReplyMenu.title"}),right:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Close",id:"discussion.mobileReplyMenu.closeButton.label"}),onClickRight:()=>f.UZ(this.environment),whiteBackground:!0}:{menuType:g.og.Popup,width:420,maxWidth:e.isMobileBrowser?"80vw":"100%"},(0,v.jsx)(u.Z,{className:p.LoZ,...a,children:(0,v.jsx)(c.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,v.jsx)(h.LazyDiscussion,{store:t,discussionInputStore:s,onDismiss:()=>f.UZ(this.environment),format:y.O2.Menu,isFirst:!0,isOnly:!0,discussionLocation:n,showResolveButtonByDefaultIfPossible:!0,blockStore:i})})})}}}renderComponent(){const{device:e}=this.environment,{open:t,rect:s}=x.Z.state;return(0,v.jsx)(m.ZP,{popupType:e.isMobile?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:t,originRect:s,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Center,originGap:4,onDismiss:()=>f.UZ(this.environment),render:this.renderDiscussion})}}S.displayName="ReplyDiscussionMenu";const b=S;var M=s(72126),j=s(70203),w=s(50906),C=s(4727),k=s(39699),T=s(68056),I=s(31352),P=s(24666),_=s(72187),Z=s(69783),F=(s(57658),s(8848)),A=s(90902),R=s(15095),D=s(54153),B=s(73657),L=s(32163),N=s(43145),O=s(72495),E=s(70177),V=s(33929),U=s(29798),W=s(60682),K=s(24990),z=s(49085);const q="recentEmojis";class G extends z.default{getInitialState(){return{recentEmojis:[],loadEmojiCount:0}}cleanupSkinTonedRecents(e){const t=M.jj(R.p4(D.Z.get(q)).map((t=>void 0===e?t:R.Gb(t))));return D.Z.set(q,t.join("")),this.setState({...this.state,recentEmojis:t}),t}}const H=new G;var Q=s(64921),Y=s(31945),$=s(1743),J=s(3386),X=s(26388),ee=s(98742),te=s(61766),se=s(11059),ie=s(37181),ne=s(68894),ae=s(80444);function oe(){window.__c={n:"EmojiPickerSkinTonePicker"};const e=(0,a.VK)((()=>{var e;return null===(e=ae.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}),[]),t=(0,n.O7)(),s=(0,a.qz)(void 0,te.Z);return(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Select skin tone",id:"emojiPickerSkinTonePicker.selectSkinTone"}),placement:X.Z.Placement.Bottom,render:i=>(0,v.jsx)(Y.ZP,{buttonPopupStore:s,popupType:Y.Z4.Popup,renderOrigin:t=>(0,v.jsx)(ne.DO,{icon:()=>(0,v.jsx)("div",{style:{paddingRight:6},children:void 0!==e?A.YN[e]:"✋"}),style:{fontSize:20},...(0,ee.Z)(t,i)}),render:s=>function(e){const{parent:t,environment:s,currentSkinTone:i}=e,n=A.YN.map(((e,i)=>({key:e,action:()=>{t.close(),re({environment:s,skinTone:i})},render:t=>(0,v.jsx)(de,{...t,insertEmoji:()=>{},emoji:e,variations:void 0,tooltip:void 0})})));return(0,v.jsx)($.Z,{capture:!0,allowEsc:!0,children:(0,v.jsx)(L.Z,{type:L.i.Horizontal,initialFocus:i,sections:[{key:"variations",render:e=>(0,v.jsx)("div",{style:{display:"flex",padding:4},...e}),items:n}]})})}({parent:s,environment:t,currentSkinTone:e}),...i})})}function re(e){const{environment:t,skinTone:s}=e,{currentUserSettingsStore:i}=ae.default.state;i&&(void 0!==s&&H.cleanupSkinTonedRecents(s),k.createAndCommit({userAction:"mediaPicker.setEmojiSkinTone",environment:t,perform:e=>{ie.d2({userSettingsStore:i,transaction:e,data:{emoji_picker_skin_tone:s}})}}))}class le extends l.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:te.Z},this.renderEmojiWithVariations=()=>{const{emoji:e,focused:t}=this.props,{buttonPopupStore:s}=this.stores;return(0,v.jsx)(J.Z,{capture:t,onEnter:this.handleOpenMenu,onEsc:this.handleCloseMenu,children:(0,v.jsx)(Y.ZP,{buttonPopupStore:s,popupType:Y.Z4.Popup,renderOrigin:e=>this.renderSingleEmoji(e),render:this.renderVariationMenu})},e)},this.renderSingleEmoji=e=>{const{emoji:t,focused:s,onClick:i,onMouseEnter:n,tooltip:a}=this.props,{fontSize:o}=ce(this.environment);return(0,v.jsx)(X.Z,{allowHover:Boolean(a),renderTooltip:()=>a,closeDelay:0,disableTooltip:!a,render:a=>(0,v.jsx)(Q.Z,{focused:s,onClick:i,...(0,ee.Z)(e||{},(0,ee.Z)({onMouseEnter:n},a)),ignoreLocalHoverState:!0,style:this.styles.emojiButton,children:(0,v.jsx)(se.Z,{size:o,char:t})},t)})},this.renderVariationMenu=e=>{const{emoji:t,variations:s,insertEmoji:i}=this.props,n=(s&&s.length>0?[t,...s]:[t]).map(((t,n)=>({key:t,action:a=>{e.close(),(null==s?void 0:s.length)===A.tN&&re({environment:this.environment,skinTone:n}),i(t,n)},render:e=>(0,v.jsx)(le,{...this.props,...e,emoji:t,variations:void 0})})));return(0,v.jsx)($.Z,{capture:!0,allowEsc:!0,children:(0,v.jsx)(L.Z,{type:L.i.Horizontal,initialFocus:0,sections:[{key:"variations",render:this.renderVariationWrapper,items:n}]})})},this.renderVariationWrapper=e=>(0,v.jsx)("div",{style:this.styles.variationMenu,...e}),this.handleOpenMenu=e=>{e.preventDefault();const{buttonPopupStore:t}=this.stores;t.setState({...t.state,open:!0})},this.handleCloseMenu=()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})},this.styles={emojiButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...ce(this.environment)},variationMenu:{display:"flex",padding:4}}}renderComponent(){const{variations:e}=this.props;return void 0===(0,W.sg)()&&e&&e.length>0?this.renderEmojiWithVariations():this.renderSingleEmoji()}}le.displayName="EmojiPickerMenuItem";const de=le;function ce(e){const{device:t}=e;return t.isMobile?{width:_.mz,height:_.mz,fontSize:_.jo}:{width:_.T8,height:_.T8,fontSize:_.WB}}const ue=["💡","👉","☝","👌","🔑","🚧","⚠️","🔥","📌","✂️","❓","🚫","⛔","⏰","☎️","🚨","♻️","✅","🔒","📎","📖","🗣","➡️","📢","🛠","⚙"],me=(0,d.defineMessages)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});var pe=!1;class ge extends l.Z{constructor(){super(...arguments),this.filter="",this.splitFilter=[],this.storeTypes={menuListStore:U.Z},this.insertEmoji=e=>{this.props.onSubmit(e),this.addToRecentEmojis(e),this.props.iconLoggingData&&w.fAb(this.environment,"pick_emoji",{icon:e,...this.props.iconLoggingData})},this.createCategory=e=>{let t=[];if(t="recent"===e.id?H.state.recentEmojis||[]:"callout"===e.id?ue:K.Z.state.emojiByCategory[e.id]||[],this.filter&&(t=ye(t,this.filter,this.splitFilter)),0!==t.length)return{key:e.id,items:t.map((e=>this.getTonedEmojiIfSkinToneSet(e))).map(this.createListItem),render:t=>(0,v.jsx)(O.Z,{isTitleUppercase:!0,title:e.title,children:(0,v.jsx)("div",{style:this.getEmojiSectionWrapStyle(),children:t.children})},t.key)}},this.createListItem=e=>{const t=R.Hk(e,K.Z.state),s=void 0===(0,W.sg)()?R.yS(e,K.Z.state):[];return{key:e,action:()=>{0===s.length&&this.insertEmoji(e)},render:i=>(0,v.jsx)(de,{...i,emoji:e,tooltip:t,variations:s,insertEmoji:this.insertEmoji})}},this.removeSkinToneModifierIfSkinToneSet=e=>void 0===(0,W.sg)()?e:R.Gb(e),this.getTonedEmojiIfSkinToneSet=e=>{var t;const s=(0,W.sg)(),i=void 0!==s&&0!==s,n=null===(t=R.yz(e,K.Z.state))||void 0===t?void 0:t.variations;return(null==n?void 0:n.length)===A.tN&&i?n[s-1]:e},this.handleScroll=e=>{if(e<ge.loadMoreCategoryEdgeDistance){const{loadEmojiCount:e}=H.state,t=Math.max(xe(this.environment,this.props.menuRef)*ve(this.environment),this.getAllSectionsEmojiCount());H.setState({...H.state,loadEmojiCount:Math.min(t,e+xe(this.environment,this.props.menuRef)*ve(this.environment))})}}}willMount(e){super.willMount(e),H.setState({...H.state,loadEmojiCount:xe(this.environment,this.props.menuRef)*ve(this.environment)}),H.cleanupSkinTonedRecents((0,W.sg)()),async function(){await(0,E.L)(),await async function(){if(!pe){await K.Z.waitUntilLoaded();for(const t in K.Z.state.positionalEmojiData){var e;const s=null===(e=R.yz(t,K.Z.state))||void 0===e?void 0:e.keywords;s&&(A.Q4[t]={...A.Q4[t],uniqueKeywords:M.jj(s.flatMap((e=>e.split(" "))))})}pe=!0}}()}()}didUpdate(e){const{menuListStore:t}=this.stores;e.filter!==this.props.filter&&t.setState({...t.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}renderComponent(){const{menuListStore:e}=this.stores,t=function(e){const{loadEmojiCount:t}=H.state,s=[];let i=0;for(const n of e){if(!(i+n.items.length<=t)){s.push({...n,items:n.items.slice(0,t-i)});break}s.push(n),i+=n.items.length}return s}(this.getAllSections()),s=this.environment.device.isDesktop&&t.length>0?0:void 0;return 0===t.length&&(this.props.onNoResults&&this.props.onNoResults(),t.push({key:"no results",items:[{key:"no results",action:()=>{},render:(e,t)=>(0,v.jsx)(B.Z,{...e,caption:V.default.formatMessage(me.noResults)})}],render:e=>(0,v.jsx)(O.Z,{...e})})),(0,v.jsxs)("div",{style:ge.wrapStyle,children:[(0,v.jsx)("div",{style:{flexGrow:1},children:(0,v.jsx)(L.Z,{...(i=this.environment,n=this.props.menuRef,{type:L.i.Grid,itemsPerRow:xe(i,n),renderRow:(e,t)=>(0,v.jsx)("div",{style:{display:"flex"},children:e},t)}),store:e,initialFocus:s,sections:t,disableKeyboardArrowWrap:!0,unfocusOnScroll:this.environment.device.isMobile})}),(0,v.jsx)(N.Z,{onChange:this.handleScroll})]});var i,n}addToRecentEmojis(e){const t=D.Z.get(q),s=M.jj(M.G0([this.removeSkinToneModifierIfSkinToneSet(e)],R.p4(t))),i=M.qn(s,_.Nm*xe(this.environment,this.props.menuRef));D.Z.set(q,i.join("")),H.setState({...H.state,recentEmojis:i})}getAllSections(){this.filter=R.rJ(this.props.filter)??"",this.splitFilter=this.filter?this.filter.split(" ").filter(Boolean):[];const e=M.oA(fe(this.props.filter,this.props.isCallout).map(this.createCategory));return this.props.filter&&this.filter?function(e){let t=0;for(const s of e)t+=s.items.length;return t}(e)>xe(this.environment,this.props.menuRef)*ve(this.environment)/2?e:this.createFilteredSection():e}getAllSectionsEmojiCount(){const e=this.getAllSections();let t=0;for(const s of e)t+=s.items.length;return t}createFilteredSection(){const e=ye(M.xH(fe(this.props.filter,this.props.isCallout).map((e=>K.Z.state.emojiByCategory[e.id]))),this.filter,this.splitFilter);return 0===e.length?[]:[{key:"search-results",items:e.map((e=>this.getTonedEmojiIfSkinToneSet(e))).map(this.createListItem),render:e=>(0,v.jsx)(O.Z,{children:(0,v.jsx)("div",{style:this.getEmojiSectionWrapStyle(),children:e.children})},e.key)}]}getEmojiSectionWrapStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...e.isPhone?{background:this.theme.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:t.getSafePaddingLeftCSS(_.$P),paddingRight:t.getSafePaddingRightCSS(_.qJ),boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1}:{background:F.ZP.transparent,paddingLeft:e.isTablet?_.vP:_.PS,paddingRight:e.isTablet?_.vP:_.PS}}}}ge.displayName="EmojiPicker",ge.loadMoreCategoryEdgeDistance=100,ge.wrapStyle={display:"flex",flexDirection:"column"};const he=ge;function fe(e,t){return M.oA([!e&&{id:"recent",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.recent",defaultMessage:"Recent"})},t?{id:"callout",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.callout",defaultMessage:"Callout"})}:void 0,{id:"People & Body",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.people",defaultMessage:"People"})},{id:"Animals & Nature",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.animals",defaultMessage:"Animals and nature"})},{id:"Food & Drink",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.food",defaultMessage:"Food and drink"})},{id:"Activities",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.activity",defaultMessage:"Activity"})},{id:"Travel & Places",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.travel",defaultMessage:"Travel and places"})},{id:"Objects",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.objects",defaultMessage:"Objects"})},{id:"Symbols",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.symbols",defaultMessage:"Symbols"})},{id:"Flags",title:(0,v.jsx)(d.FormattedMessage,{id:"emojiPicker.section.flags",defaultMessage:"Flags"})}])}function ye(e,t,s){const i=M.oA(e.map((e=>{const i=R.yz(e,K.Z.state),n=i&&i.keywords||[],a=t.length<3||t.includes(" ")?n:n.map((e=>e.replaceAll(" ",""))),o=a.findIndex((e=>e===`:${t}`));if(-1!==o)return[100-o,e];const r=a.findIndex((e=>e===t));if(-1!==r)return[10*(10-r),e];const l=a.findIndex((e=>e.startsWith(t)));if(-1!==l)return[10-l,e];if(s.length>1){const t=i&&i.uniqueKeywords||[];if(s.every((e=>t.find((t=>t.startsWith(e))))))return[s.length,e]}return a.some((e=>e.includes(t)))?[1,e]:void 0})));return M.MR(i,(e=>-e[0])).map((e=>e[1]))}function xe(e,t){var s,i;const{device:n,WindowSizeStore:a}=e;return n.isPhone?(window.innerWidth-a.getSafePaddingLeftPx(_.$P)-a.getSafePaddingRightPx(_.qJ))/_.mz:n.isTablet?_.tg:null!=t&&null!==(s=t.current)&&void 0!==s&&s.offsetWidth?((null==t||null===(i=t.current)||void 0===i?void 0:i.offsetWidth)-2*_.PS)/_.T8:_.IQ}function ve(e){return e.device.isMobile?_.pq:_.II}class Se extends l.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=Z.Z.state,s=i.createRef();if(!t.open)return;let n;return n=e.isMobileNative&&!e.isTablet?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:_.fG,maxHeight:_.VJ,onClickOutside:C.xv},(0,v.jsx)(u.Z,{innerRef:s,...n,children:(0,v.jsx)(he,{filter:Me(t)||"",onSubmit:this.handleSubmit,onNoResults:this.handleNoResults,isCallout:!1,menuRef:s})})},this.handleNoResults=()=>{const e=Z.Z.state;if(!e.open)return;const t=Me(e);if(!t)return;const s=M.Z$(t);s&&(/\s/g.test(s)?C.xv():this.trackNoResultsDebounced(t))},this.trackNoResultsDebounced=M.Ds((e=>{w.VJs(this.environment,{searchQuery:e})}),500),this.handleSubmit=e=>{k.createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:this.environment,perform:t=>{C.RL({environment:this.environment,emoji:e,transaction:t})}})},this.handleCancel=()=>{C.xv()}}willMountOrUpdate(){const e=Z.Z.state;if(e.open){var t;const s=P.default.state,i=Me(e);if("editing"!==s.mode)return void C.xv();const n=j.eeV(s.multiSelection.start.store.getValue())[s.multiSelection.start.index-1];if(!i&&":"!==n)return void C.xv();((null===(t=(0,T.QY)(s.multiSelection))||void 0===t?void 0:t.store)!==e.textStore||void 0===i||":"===i||i.startsWith("\n")||i.startsWith(" "))&&C.xv()}}renderComponent(){const{device:e}=this.environment,t=Z.Z.state;let s=!1;if(t.open){const e=Me(t);e&&e.length>0&&(s=!0),t.showPopupWithEmptyFilter&&(s=!0)}return(0,v.jsx)(m.ZP,{popupType:e.isMobileNative&&!e.isTablet?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:s,originRect:t.open?t.selectionRect:void 0,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.handleCancel,render:this.renderMenu,keepFocus:!0})}}Se.displayName="EmojiMenu";const be=Se;function Me(e){return I.zK(e.textStore,e.oldTextValue,!0)}var je=s(12534),we=s(39500),Ce=s(95697),ke=s(35868);function Te(){window.__c={n:"MessageStoreDebugPanelWrapper"};return(0,a.VK)((()=>ke.Z.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,v.jsx)(h.LazyMessageStoreDebugPanel,{}):null}var Ie=s(75538),Pe=s(94416),_e=s(19671),Ze=s(13023),Fe=s(69784),Ae=s(44615),Re=s(2688),De=s(28517),Be=s(69911);function Le(){window.__c={n:"UserJoinedTeamsListener"};const e=(0,n.O7)(),{currentSpaceStore:t}=(0,a.Kw)(ae.default),s=e.currentUser.id,o=(0,a.VK)((()=>null==t?void 0:t.id),[t]);return(0,i.useEffect)((()=>{if(!o||!s)return;const t=Re.Z.addListener((0,Ae.pD)({userId:s,spaceId:o}),(async(t,i)=>{(function(e){var t;let{spaceId:s,userId:i,emitValue:n}=e;const a=null===(t=Be.Z.getUserJoinedTeamsState({userId:i,spaceId:s}))||void 0===t?void 0:t.lastEmitValue;if(a===n)return!1;if(void 0===a&&Be.Z.getHasFetched({userId:i,spaceId:s}))return!1;return!0})({spaceId:o,userId:s,emitValue:i})&&await De.m({environment:e,spaceId:o,userId:s,emitValue:i});const n=Be.Z.getUserJoinedTeamsState({userId:s,spaceId:o});n&&Be.Z.setUserJoinedTeamsState({userId:s,spaceId:o,state:{...n,lastEmitValue:i}})}),void 0,e);return function(){t&&Re.Z.removeListener(t,e)}}),[e,s,o]),null}var Ne=s(41464),Oe=s(54564),Ee=s(92650),Ve=s(24646),Ue=s(24229),We=s(41432),Ke=s(65598),ze=s(34859),qe=s(3490),Ge=s(72897),He=s(40721),Qe=s(3553),Ye=s(66957);const $e=[Ue.u.Open,Ue.u.Resolved];class Je extends l.Z{constructor(){super(...arguments),this.deepDiscussionsStores=this.createComputedStore((()=>{const{discussionIds:e}=this.props,{blockStore:t,recursivelyLoadAllDiscussions:s}=this.props;return Ke.al(t,{recursivelyLoadAllDiscussions:s}).filter((t=>!e||e.includes(t.id)||(0,y.De)(t)))})),this.handleChangeTab=e=>{const t=Ue.Z.state;t.open&&Ue.Z.setState({...t,tab:$e[e]})},this.handleBackspace=e=>{null==e||e.preventDefault(),Oe.LZ()}}renderComponent(){if((0,Ve.Sx)(this.environment))return null;const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:g.og.Modal,title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:this.renderMenuHeader(),right:(0,v.jsx)(He.DoneMenuText,{}),onClickRight:Oe.LZ,whiteBackground:!0}:{menuType:g.og.Popup,header:this.renderMenuHeader(),width:480,maxHeight:"50vh",onClickOutside:Oe.LZ},(0,v.jsx)(Ge.Z,{capture:!0,preventType:ze.Z.All,children:(0,v.jsx)(c.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,v.jsx)(J.Z,{capture:!0,onEsc:Oe.LZ,onBackspace:this.handleBackspace,onDelete:this.handleBackspace,children:(0,v.jsx)(Qe.Z,{store:this.props.blockStore,droppable:!0,render:()=>(0,v.jsx)(u.Z,{...t,children:this.renderMenuContent()})},this.props.blockStore.id)})})})}renderMenuHeader(){const{device:e}=this.environment,{resolved:t,unresolved:s}=Ke.bB(this.deepDiscussionsStores.state),i=s.length,n=t.length;return 0===n||0===i?null:(0,v.jsx)(Ye.Z,{tabs:[(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Open ({numberOfOpenDiscussions})",id:"blockDiscussionMenu.openDiscussionsTab.title",values:{numberOfOpenDiscussions:i}},"openDiscussions"),(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Resolved ({numberOfResolvedDiscussions})",id:"blockDiscussionMenu.resolvedDiscussionsTab.title",values:{numberOfResolvedDiscussions:n}},"resolvedDiscussions")],selectedIndex:$e.indexOf(this.props.tab),onChange:this.handleChangeTab,style:{...e.isAndroid&&{borderBottom:"none"}}})}renderMenuContent(){const{device:e}=this.environment,{resolved:t,unresolved:s}=Ke.bB(this.deepDiscussionsStores.state);if(this.props.tab===Ue.u.Open){if(s.length){const t=s.map(((e,t,s)=>(0,v.jsx)(h.LazyDiscussion,{store:e,format:y.O2.Menu,isFirst:0===t,isOnly:1===s.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:Oe.LZ},e.id))),n=this.props.blockStore.getType(),a=n&&We.p2[n];if(e.isMobile&&a){const e=qe.h(this.props.blockStore);return e?(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1},children:(0,v.jsx)(e,{store:this.props.blockStore,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),t]}):t}return t}return this.renderEmptyState((0,v.jsx)(d.FormattedMessage,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"}))}return t.length?t.map(((e,t,s)=>(0,v.jsx)(h.LazyDiscussion,{store:e,format:y.O2.Menu,isFirst:0===t,isOnly:1===s.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:Oe.LZ},e.id))):this.renderEmptyState((0,v.jsx)(d.FormattedMessage,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"}))}renderEmptyState(e){const{device:t}=this.environment;return(0,v.jsx)("div",{style:{textAlign:"center",padding:t.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:this.theme.mediumTextColor},children:e})}}Je.displayName="BlockDiscussionMenu";const Xe=Je;const et=function(){window.__c={n:"BlockDiscussionMenuPopup"};const e=(0,n.O7)(),{device:t}=e,s=(0,a.VK)((()=>Ue.Z.state.rect),[]),o=(0,a.VK)((()=>!(0,Ve.Sx)(e)&&Ue.Z.state.open&&!(0,Ee.az)(e,Ue.Z.state.blockStore)),[e]),r=(0,i.useCallback)((()=>{if(Ue.Z.state.open&&!(0,Ve.Sx)(e))return(0,v.jsx)(Xe,{rect:Ue.Z.state.rect,tab:Ue.Z.state.tab,blockStore:Ue.Z.state.blockStore,discussionIds:Ue.Z.state.discussionIds,recursivelyLoadAllDiscussions:Ue.Z.state.recursivelyLoadAllDiscussions})}),[e]);return(0,v.jsx)(m.ZP,{popupType:t.isMobile?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:o,originRect:s,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Center,disableMouseCapture:!0,originGap:4,render:r,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:Oe.LZ})};var tt=s(62965),st=s(79554),it=s(61207),nt=s(27724),at=s(52275);const ot=(0,d.defineMessages)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"}});class rt extends l.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=it.Z.state;if(!t.open)return;const s=this.getSections(t);let i;return i=e.isMobile?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:320,maxHeight:"40vh"},(0,v.jsx)(u.Z,{...i,className:p.srZ,children:(0,v.jsx)(L.Z,{type:L.i.Vertical,sections:s,initialFocus:0})})},this.handleDismiss=()=>{st.xv()}}willMountOrUpdate(){const e=it.Z.state;if(e.open){const{stores:t,phase:s}=nt.default.state;(0,tt.Z)(t,e.blocks)&&s===nt.SelectionPhase.Selected||st.xv()}}renderComponent(){const{device:e}=this.environment,t=it.Z.state;return(0,v.jsx)(m.ZP,{popupType:e.isMobileNative&&!e.isTablet?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.rect:void 0,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}getSections(e){const{blocks:t}=e,{currentSpaceStore:s}=ae.default.state,i=[];if("blocks"===e.type){const{copiedStores:n,pageSource:a}=e;st.H8({currentSpaceId:null==s?void 0:s.id,blocks:t,copiedStores:n})&&i.push({name:V.default.formatMessage(ot.createTransclusion),action:async()=>{await st.ry({environment:this.environment,blocks:t,copiedBlockIds:n.map((e=>e.id))})}}),st.wK({blocks:t})&&i.push({name:V.default.formatMessage(ot.linkToPage),action:async()=>st.Dq({environment:this.environment,blocks:t,source:{type:"blocks",copiedStores:n,pageSource:a}})})}"links"===e.type&&i.push({name:V.default.formatMessage(ot.linkToPage),action:async()=>st.Dq({environment:this.environment,blocks:t,source:{type:"links",copiedLinks:e.copiedLinks}})});return[{key:"embed section",render:e=>(0,v.jsx)(O.Z,{...e}),items:[{key:"dismiss",render:e=>(0,v.jsx)(at.Z,{...e,title:V.default.formatMessage(ot.dismissItem)}),action:this.handleDismiss},...i.map((e=>{let{name:t,action:s}=e;return{key:`embed ${t}`,render:e=>(0,v.jsx)(at.Z,{...e,title:t}),action:s}}))]}]}}rt.displayName="BlockPasteMenu";const lt=rt;var dt=s(87143),ct=s(74194),ut=s(64369);class mt extends l.Z{constructor(){super(...arguments),this.handleOverlayBgClick=e=>{dt.Z.setState({...dt.Z.state,active:!1,stringValue:""})}}renderComponent(){const{device:e}=this.environment,{active:t,stringValue:s}=dt.Z.state,i=window.innerWidth/2-150,n=window.innerHeight/2,a=e.isMobileNative?(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,v.jsx)(m.ZP,{popupType:e.isMobileNative?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:t,originRect:{top:n,left:i},onDismiss:this.handleOverlayBgClick,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Start,originGap:0,render:()=>(0,v.jsx)(J.Z,{capture:!0,onEnter:M.yR,onCommandEnter:M.yR,onCommandShiftEnter:M.yR,onCommandSlash:M.yR,onDelete:M.yR,onBackspace:M.yR,onEsc:M.yR,onLeft:M.yR,onRight:M.yR,onUntab:M.yR,onTab:M.yR,onSelectAll:M.yR,onRedo:M.yR,onUndo:M.yR,onToggleBold:M.yR,onToggleItalics:M.yR,onToggleStrike:M.yR,onToggleCode:M.yR,onCut:M.yR,onCopy:M.yR,onPaste:M.yR,onKeypress:M.yR,children:(0,v.jsxs)("div",{style:{padding:8,width:300},children:[(0,v.jsx)(ct.Z,{style:{width:"100%",fontSize:12},value:s,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,v.jsx)(ut.Z,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:a})]})})})}}mt.displayName="ClipboardInputRenderer";const pt=mt;var gt=s(11977),ht=s(14131),ft=s(7337),yt=s(40506),xt=s(67133),vt=s(9953),St=s(28020),bt=s(28748);class Mt extends l.Z{constructor(){super(...arguments),this.handleChangeValue=e=>{if(!e)return void this.removeDateAnnotation();if(!yt.U3(e))return;const t=wt();if(!t)return;const{date_format:s,time_format:i}=t;this.setDateAnnotationData({date_format:s,time_format:i,...e})},this.handleChangeDateFormat=e=>{const t=wt();if(!t)return;const{dateValue:s,time_format:i}=t;this.setDateAnnotationData({date_format:e,time_format:i,...s})},this.handleChangeTimeFormat=e=>{const t=wt();if(!t)return;const{dateValue:s,date_format:i}=t;this.setDateAnnotationData({date_format:i,time_format:e,...s})},this.setDateAnnotationData=e=>{const t=wt();if(!t)return;const{textStore:s,textValue:i,tokenIndex:n,annotations:a}=t,o=i.map(((t,s)=>{if(s===n){const s=a.map((t=>j.fpG(t)?["d",e]:t));return j.V3y(t[0],s)}return t}));k.createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:this.environment,perform:e=>{vt.sO({store:s,value:o,transaction:e})}})},this.removeDateAnnotation=()=>{const e=wt();if(!e)return;const{textStore:t,textValue:s,tokenIndex:i}=e,n=s.filter(((e,t)=>t!==i));k.createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:this.environment,perform:e=>{vt.sO({store:t,value:n,transaction:e})}})}}renderComponent(){const{device:e}=this.environment,t=bt.Z.state;return(0,v.jsx)(m.ZP,{popupType:e.isMobile?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:t.open,originRect:t.originRect,onDismiss:xt.x,render:()=>{const e=wt();if(!e)return null;const{date_format:s,time_format:i,dateValue:n}=e;return(0,v.jsx)(h.DependencyConsumer,{dependency:h.deps.menus,children:e=>{let{DatePropertyMenu:a}=e;return(0,v.jsx)(a,{firstDayOfWeek:St.AK.state,value:n,canConfigureCollection:!0,onChangeValue:this.handleChangeValue,dateFormat:s,onChangeDateFormat:this.handleChangeDateFormat,timeFormat:i,onChangeTimeFormat:this.handleChangeTimeFormat,onDismiss:xt.x,disabled:!1,shouldShowReminder:!!t.open&&t.allowReminders,isTemplatePage:!1})}})}})}}Mt.displayName="DateMentionMenu";const jt=Mt;function wt(){const e=bt.Z.state;if(e.open){const{textStore:t,tokenIndex:s}=e,i=t.getValue();if(i){const e=i[s];if(e){const n=j.hDy(e),a=j.K9C(n);if(a){const{date_format:o,time_format:r,...l}=j.zyO(a);return{textStore:t,textValue:i,tokenIndex:s,token:e,annotations:n,date_format:o,time_format:r,dateValue:l}}}}}}s(30541);var Ct=s(95538),kt=s(99405),Tt=s(21202),It=s(63143),Pt=s(89951),_t=s(95477),Zt=s(64233),Ft=s(26350);const At=(0,d.defineMessages)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Map",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Create embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),Rt=(0,d.defineMessages)({linkToPage:{defaultMessage:"Link to page",id:"embedMenu.actions.linkToPage.title"},mentionPage:{defaultMessage:"Mention page",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention block",id:"embedMenu.actions.mentionBlock.title"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Create linked view of database",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Create bookmark",id:"embedMenu.actions.createBookmark.title"},createTransclusionItem:{defaultMessage:"Paste and sync",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"Dismiss",id:"embedMenu.actions.dismiss.title"}}),Dt={image:V.default.formatMessage(At.image),video:V.default.formatMessage(At.video),tweet:V.default.formatMessage(At.tweet),drive:V.default.formatMessage(At.drive),gist:V.default.formatMessage(At.gist),figma:V.default.formatMessage(At.figma),invision:V.default.formatMessage(At.invision),abstract:V.default.formatMessage(At.abstract),framer:V.default.formatMessage(At.framer),whimsical:V.default.formatMessage(At.whimsical),mixpanel:V.default.formatMessage(At.mixpanel),miro:V.default.formatMessage(At.miro),sketch:V.default.formatMessage(At.sketch),excalidraw:V.default.formatMessage(At.excalidraw),replit:V.default.formatMessage(At.replit),audio:V.default.formatMessage(At.audio),maps:V.default.formatMessage(At.maps),loom:V.default.formatMessage(At.loom),typeform:V.default.formatMessage(At.typeform),codepen:V.default.formatMessage(At.codepen),pdf:V.default.formatMessage(At.pdf),embed:V.default.formatMessage(At.embed),hex:V.default.formatMessage(At.hex),deepnote:V.default.formatMessage(At.deepnote),drawing:V.default.formatMessage(At.drawing)};class Bt extends l.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=Zt.Z.state;if(!t.open)return;const s=this.getSections(t);let i;return 0===s.length&&Pt.xv(),i=e.isMobile?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:320,maxHeight:"40vh"},(0,v.jsx)(u.Z,{...i,className:p.srZ,children:(0,v.jsx)(L.Z,{type:L.i.Vertical,sections:s,initialFocus:0})})},this.handleDismiss=()=>{const e=Zt.Z.state,{url:t}=e;w.X0y(this.environment,{url:t,type:"close"}),Pt.xv()},this.handleAccept=e=>{const t=Zt.Z.state,{url:s}=t;Pt.RL({environment:this.environment,type:e}),w.X0y(this.environment,{url:s,type:e})}}willMountOrUpdate(){const e=Zt.Z.state;if(e.open){const t=P.default.state;if("editing"===t.mode){const{multiSelection:s}=t;(0,T.qS)(s)&&s.start.store.id===e.textStore.id&&s.end.index===e.urlSelection.endIndex||Pt.xv()}}}renderComponent(){const{device:e}=this.environment,t=Zt.Z.state;return(0,v.jsx)(m.ZP,{popupType:e.isMobileNative&&!e.isTablet?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}getSections(e){const{device:t}=this.environment,{url:s,textStore:i}=e,{currentSpaceStore:n}=ae.default.state,a=[],o=(0,kt.Wj)({url:s,baseUrl:_t.default.domainBaseUrl,publicDomainName:_t.default.publicDomainName,isMobile:t.isMobile,protocol:_t.default.protocol,currentUrl:window.location.href});if("page"===o.name){const e=Ft.G.createChildStore(i,{table:Tt.iU,id:o.blockId}),t=o.scrollToBlockId?Ft.G.createChildStore(i,{table:Tt.iU,id:o.scrollToBlockId}):void 0;a.push({name:V.default.formatMessage(Rt.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!Nt(i)&&(!e.isCollectionViewPageWithContent()||!function(e,t){const s=e.getCollectionViewStores(),i=M.sE(s,(e=>e.id===t&&"page"===e.getType()));return Boolean(i)}(e,o.collectionViewId))&&(null==n?void 0:n.id)===e.getSpaceId()&&!(0,St.qG)(e.id),type:We.Ti.collectionView}),a.push({name:V.default.formatMessage(void 0===t?Rt.mentionPage:Rt.mentionBlock),validator:()=>!0,type:"mention-page"}),a.push({name:V.default.formatMessage(Rt.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!Nt(i)&&!t.isLocked()&&!t.isNavigableAncestorLocked()&&t.canEdit()&&t.getSpaceId()===(null==n?void 0:n.id)),type:"create-transclusion"}),a.push({name:V.default.formatMessage(Rt.linkToPage),validator:()=>!t&&!e.isCollectionView()&&!Nt(i),type:We.Ti.page})}const r=It.XP(Dt);for(const c of r)"embed"!==c&&a.push({name:Dt[c],validator:Ct.Wb[c],type:c});a.push({name:V.default.formatMessage(Rt.bookmarkMenuItem),validator:e=>!Nt(i)&&Ct.Cm(e),type:We.Ti.bookmark}),a.push({name:Dt.embed,validator:e=>!Nt(i)&&Ct.Wb.embed(e),type:"embed"});const l=M.oA(a.map((e=>{let{name:t,validator:i,type:n}=e;if(i({url:s,baseUrl:_t.default.domainBaseUrl,publicDomainName:_t.default.publicDomainName})){return{key:`embed ${t}`,render:e=>(0,v.jsx)(at.Z,{...e,title:t}),action:()=>this.handleAccept(n)}}}))),d={key:"dismiss",render:e=>(0,v.jsx)(at.Z,{...e,title:V.default.formatMessage(Rt.dismissItem)}),action:this.handleDismiss};if(0===l.length)return[];"page"===o.name?l.push(d):l.unshift(d);return[{key:"embed section",render:e=>(0,v.jsx)(O.Z,{...e}),items:l}]}}Bt.displayName="EmbedMenu";const Lt=Bt;function Nt(e){const t=e.getRecordStoreAtRootPath();return t instanceof Ft.G&&void 0!==t.getParentCollectionStore()}var Ot,Et=s(43593),Vt=s(37652),Ut=s(33907),Wt=s(59822),Kt=s(64330),zt=s(80342),qt=s(47453),Gt=s(51454),Ht=s(54604),Qt=s(42858),Yt=s(24677),$t=s(17504),Jt=s(58202),Xt=s(38302),es=s(23063),ts=s(68785),ss=s(4827),is=s(89728);class ns extends l.Z{constructor(){var e;super(...arguments),e=this,this.zoomFocusPercentageX=0,this.zoomFocusPercentageY=0,this.isListeningToWheel=!1,this.hideControlsTimeout=void 0,this.isMovingToPrevOrNextTimeout=void 0,this.isEditingZoom=z.default.createValue(!1),this.contentDimensions=z.default.createValue(void 0),this.showControls=z.default.createValue(!1),this.responsiveSettings=this.createComputedStore((()=>{const e=this.environment.WindowSizeStore.state.width;return{edgePadding:Ht.zp(e),backgroundOpacity:.8}})),this.renderOverlay=()=>{const{isOpen:e,renderFullScreenNode:t,fullScreenNodeRect:s,contentAspectRatio:i,zoomScale:n,panOffset:a,skipAnimations:o}=Xt.Z.state;if(!s)return;e&&!this.isListeningToWheel?(window.addEventListener("wheel",this.handleWheel,{passive:!1}),this.isListeningToWheel=!0):!e&&this.isListeningToWheel&&(window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1);const{edgePadding:r,backgroundOpacity:l}=this.responsiveSettings.state,d=window.innerWidth,c=window.innerHeight-2*r;let u=d-2*r;const m=i||s.height/s.width;let p=u*m;if(p>c){const e=p/c;p/=e,u/=e}const g={opacity:0},h={scale:n,opacity:1,translateX:a.x,translateY:a.y};let f,y;return t&&(f=t()),y=this.showControls.state?n>=1.5?"zoom-out":"zoom-in":"none",(0,$t.Z)((t=>(0,v.jsx)(J.Z,{capture:e,onEsc:()=>{this.handleClose(!0)},onEnter:M.yR,onSpace:()=>this.handleClose(!0),onCommandEnter:()=>this.handleClose(!0),onCommandShiftEnter:M.yR,onCommandSlash:M.yR,onUp:M.yR,onDown:M.yR,onDelete:M.yR,onBackspace:M.yR,onLeft:()=>this.handlePrevious(!0),onRight:()=>this.handleNext(!0),onUntab:M.yR,onTab:M.yR,onSelectAll:M.yR,onRedo:M.yR,onUndo:M.yR,onToggleBold:M.yR,onToggleItalics:M.yR,onToggleStrike:M.yR,onToggleCode:M.yR,onCut:M.yR,onCopy:M.yR,onPaste:M.yR,onKeypress:this.handleKeypress,children:(0,v.jsx)(Ge.Z,{capture:e,preventType:ze.Z.All,children:(0,v.jsxs)("div",{style:this.getStyle({isOpen:e}),...t,onClick:this.handleBackgroundClick,onMouseMove:this.resetHideControlsTimeout,children:[(0,v.jsx)(es.Z,{isVisible:e,enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:l},render:()=>(0,v.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:F.ZP.black}}),onAnimationEnd:this.handleBackgroundAnimationEnd}),(0,v.jsx)(es.Z,{isVisible:e,enterAnimationStyle:g,exitAnimationStyle:g,animationStyle:h,skipAnimation:o,springConfig:{scale:{stiffness:100,damping:10,precision:.001},translateX:{stiffness:100,damping:10,precision:.001},translateY:{stiffness:100,damping:10,precision:.001}},render:()=>(0,v.jsx)("div",{style:{display:"flex",cursor:y,maxWidth:u,maxHeight:p,justifyContent:"center"},ref:e=>{e&&this.contentDimensions.setState({width:e.clientWidth,height:e.clientHeight})},onClick:this.handleContentClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp,onMouseMove:this.handleMouseMove,children:f}),onAnimationEnd:this.handleFullscreenNodeAnimationEnd}),this.renderBottomBar()]})})})))},this.clearHideControlsTimeout=()=>{this.hideControlsTimeout&&clearTimeout(this.hideControlsTimeout)},this.resetHideControlsTimeout=()=>{const{isSaving:e}=Xt.Z.state;this.showControls.setState(!0),this.clearHideControlsTimeout(),this.isEditingZoom.state||e||(this.hideControlsTimeout=setTimeout((()=>this.showControls.setState(!1)),2e3))},this.enableZoomEditing=()=>{this.isEditingZoom.setState(!0),this.clearHideControlsTimeout()},this.disableZoomEditing=()=>{this.isEditingZoom.setState(!1),this.resetHideControlsTimeout()},this.handleBackgroundClick=e=>{(0,we.uG)(e)||this.handleClose()},this.handleContentClick=e=>{const{zoomScale:t,panOffset:s}=Xt.Z.state;if(e.stopPropagation(),(0,we.uG)(e))return;let i,n;i=t<1?1:t<1.5?1.5:1,n=i<=1?{x:0,y:0}:this.clampPanOffset({x:(window.innerWidth/2-e.clientX)/(i/(i-1)),y:(window.innerHeight/2-e.clientY)/(i/(i-1))})??s,Xt.Z.setState({...Xt.Z.state,zoomScale:i,panOffset:n}),this.resetHideControlsTimeout(),this.disableZoomEditing()},this.handleClose=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ht.xv(),e.resetControls(),w.Lfx(e.environment,{type:"close",triggered_by:t?"keypress":"click"}),Yt.ZH(e.environment),e.handleMouseUp()},this.handleResize=()=>{const{isOpen:e}=Xt.Z.state;e&&this.enqueueForceUpdate()},this.handleBackgroundAnimationEnd=()=>{const{isOpen:e}=Xt.Z.state;e||Xt.Z.setState({...Xt.Z.state,backgroundAnimationComplete:!0})},this.handleFullscreenNodeAnimationEnd=()=>{const{isOpen:e}=Xt.Z.state;e||Xt.Z.setState({...Xt.Z.state,fullscreenNodeAnimationComplete:!0})},this.cancelBackgroundClick=e=>{e.stopPropagation()},this.handlePrevious=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(-1,t)},this.handleNext=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(1,t)},this.handleZoomInputSubmit=e=>{const t=e.target,s=parseInt(t.value);if(!isNaN(s)){const e=s/100;w.Lfx(this.environment,{type:"set_zoom",new_zoom:e}),this.setZoomScale(e)}this.disableZoomEditing()},this.handleZoomOut=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:s}=Xt.Z.state;let i=Math.ceil((s-ns.ZOOM_STEP)*ns.INVERSE_ZOOM_STEP)/ns.INVERSE_ZOOM_STEP;s-i<ns.ZOOM_THRESHOLD&&(i-=ns.ZOOM_STEP),w.Lfx(e.environment,{type:"zoom_out",new_zoom:i,triggered_by:t?"keypress":"click"}),e.setZoomScale(i)},this.handleZoomIn=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:s}=Xt.Z.state;let i=Math.floor((s+ns.ZOOM_STEP)*ns.INVERSE_ZOOM_STEP)/ns.INVERSE_ZOOM_STEP;i-s<ns.ZOOM_THRESHOLD&&(i+=ns.ZOOM_STEP),w.Lfx(e.environment,{type:"zoom_in",new_zoom:i,triggered_by:t?"keypress":"click"}),e.setZoomScale(i)},this.addDeltaToZoomScale=e=>{const{zoomScale:t}=Xt.Z.state;this.setZoomScale(t+e)},this.setZoomScale=e=>{const{panOffset:t}=Xt.Z.state;this.resetHideControlsTimeout();const s=Math.max(Math.min(e,ns.MAX_ZOOM),ns.MIN_ZOOM),i=s<=1?{x:0,y:0}:t;Xt.Z.setState({...Xt.Z.state,zoomScale:s,panOffset:i})},this.handleWheel=e=>{const{isOpen:t,panOffset:s}=Xt.Z.state;t&&(e.preventDefault(),e.ctrlKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*ns.TRACK_PAD_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*ns.TRACK_PAD_SCALE):e.metaKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*ns.MOUSE_WHEEL_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*ns.MOUSE_WHEEL_SCALE):ls()&&this.setPanOffset({x:s.x-e.deltaX,y:s.y-e.deltaY}))},this.handleMouseDown=e=>{const{panOffset:t,zoomScale:s}=Xt.Z.state;Xt.Z.setState({...Xt.Z.state,panStartPosition:{x:e.clientX/s-t.x,y:e.clientY/s-t.y},skipAnimations:!0})},this.handleMouseUp=()=>{Xt.Z.setState({...Xt.Z.state,skipAnimations:!1})},this.handleMouseMove=e=>{const{panStartPosition:t,zoomScale:s}=Xt.Z.state;this.contentDimensions.state&&1===e.buttons&&ls()&&this.setPanOffset({x:e.clientX/s-t.x,y:e.clientY/s-t.y})},this.handleDownload=e=>{const{block:t,imageUrl:s}=Xt.Z.state;if(!t||!ds())return;Xt.Z.setState({...Xt.Z.state,isSaving:!0}),this.clearHideControlsTimeout();const i=null==t?void 0:t.getProperties();let n;if(n=s||j.QaF(null==i?void 0:i.source),!n)return;const a=j.QaF(null==i?void 0:i.caption);(0,Et.GN)(n,null==t?void 0:t.pointer,_t.default.domainBaseUrl,this.environment.currentUser.id,a).then((()=>{Xt.Z.setState({...Xt.Z.state,isSaving:!1}),w.Lfx(this.environment,{type:"download",triggered_by:"click"}),this.resetHideControlsTimeout()}))},this.handleKeypress=e=>{switch(e.key){case"+":case"=":this.handleZoomIn(!0);break;case"-":case"_":this.handleZoomOut(!0)}}}didMount(){super.didMount(),window.addEventListener("resize",this.handleResize)}willUnmount(){super.willUnmount(),window.removeEventListener("resize",this.handleResize),window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1}renderComponent(){const{isOpen:e,fullscreenNodeAnimationComplete:t,backgroundAnimationComplete:s}=Xt.Z.state;return(0,v.jsx)(ss.Z,{open:e||!t||!s,children:this.renderOverlay()})}renderBottomBar(){const{isOpen:e}=Xt.Z.state;if(!this.environment.device.isMobile)return(0,v.jsx)(es.Z,{isVisible:this.showControls.state,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>(0,v.jsxs)("div",{style:cs(e),onClick:e=>{this.cancelBackgroundClick(e),this.resetHideControlsTimeout(),this.disableZoomEditing()},children:[(0,v.jsx)("div",{style:{...ns.controlBarStyle,marginRight:10},children:this.renderPrevNextButtons()}),(0,v.jsxs)("div",{style:ns.controlBarStyle,children:[this.renderZoomControls(),(0,v.jsx)(fs,{}),ds()?(0,v.jsxs)(v.Fragment,{children:[this.renderDownloadButton(),(0,v.jsx)(fs,{})]}):void 0,this.renderCloseButton()]})]})})}renderZoomControls(){const{zoomScale:e}=Xt.Z.state,t=(100*e).toFixed(0);return(0,v.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(hs,{primaryText:(0,v.jsx)(d.FormattedMessage,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:e<=ns.MIN_ZOOM,render:t=>(0,v.jsx)(is.Z,{...t,disabled:e<=ns.MIN_ZOOM,style:{...ps(e<=ns.MIN_ZOOM),...ns.firstButtonPadding},onClick:()=>this.handleZoomOut(),icon:e=>(0,zt.$)({...e,fill:us(),height:16,margin:0,width:16})})}),this.isEditingZoom.state?(0,v.jsx)(as,{initialValue:t,onSubmit:this.handleZoomInputSubmit,onCancel:this.disableZoomEditing,primaryColor:us(),secondaryColor:ms()}):(0,v.jsx)(is.Z,{onClick:e=>{e.stopPropagation(),this.enableZoomEditing()},style:{color:ms(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${t}%`}),(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(hs,{primaryText:(0,v.jsx)(d.FormattedMessage,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:e>=ns.MAX_ZOOM,render:t=>(0,v.jsx)(is.Z,{...t,disabled:e>=ns.MAX_ZOOM,style:ps(e>=ns.MAX_ZOOM),onClick:()=>this.handleZoomIn(),icon:e=>(0,qt.R)({...e,fill:us(),height:16,margin:0,width:16})})})]})}renderPrevNextButtons(){const{block:e}=Xt.Z.state,t=rs(),s=(null==t?void 0:t.length)??0,i=(null==t?void 0:t.findIndex((t=>t===e)))??-1;return s<=1||i<0?(0,v.jsx)("div",{}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(hs,{primaryText:(0,v.jsx)(d.FormattedMessage,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,v.jsx)(gs,{imageIndex:i-1,totalImageCount:s})}),disableTooltip:0===i,render:e=>(0,v.jsx)(is.Z,{...e,disabled:i<=0,style:{...ps(i<=0),...ns.firstButtonPadding},hoveredStyle:ns.hoveredButtonStyle,onClick:()=>this.handlePrevious(),icon:e=>(0,Vt.V)({...e,fill:us(),height:16,margin:0,width:16})})}),(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(hs,{primaryText:(0,v.jsx)(d.FormattedMessage,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,v.jsx)(gs,{imageIndex:i-1,totalImageCount:s})}),disableTooltip:i+1===s,render:e=>(0,v.jsx)(is.Z,{...e,disabled:i>=s-1,style:{...ps(i>=s-1),...ns.lastButtonPadding},hoveredStyle:ns.hoveredButtonStyle,onClick:()=>this.handleNext(),icon:e=>(0,Ut.n)({...e,fill:us(),height:16,margin:0,width:16})})})]})}renderDownloadButton(){const{isSaving:e}=Xt.Z.state;return(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(hs,{primaryText:(0,v.jsx)(d.FormattedMessage,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:t=>(0,v.jsx)(is.Z,{...t,disabled:e,onClick:this.handleDownload,style:ps(!1),hoveredStyle:ns.hoveredButtonStyle,children:e?(0,v.jsx)(ts.Z,{style:{width:16}}):(0,Kt.a)({fill:us(),width:16})})})}renderCloseButton(){return(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(hs,{primaryText:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,v.jsx)(is.Z,{...e,onClick:()=>this.handleClose(),style:{...ps(!1),...ns.lastButtonPadding},hoveredStyle:ns.hoveredButtonStyle,icon:e=>(0,Wt.J)({...e,fill:us(),height:16,margin:0,width:16})})})}scrollToZoomFocus(e){const t=window.innerWidth/2,s=window.innerHeight/2,i=e.scrollWidth*this.zoomFocusPercentageX,n=e.scrollHeight*this.zoomFocusPercentageY;e.scrollLeft=i-t,e.scrollTop=n-s}resetControls(){this.isEditingZoom.setState(!1),Xt.Z.setState({...Xt.Z.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}clampPanOffset(e){const t=this.contentDimensions.state;if(!t)return;let s,i;s=t.width*ns.MAX_ZOOM>window.innerWidth?(t.width*ns.MAX_ZOOM-window.innerWidth)/(2*ns.MAX_ZOOM):(window.innerWidth-t.width*ns.MAX_ZOOM)/(2*ns.MAX_ZOOM),i=t.height*ns.MAX_ZOOM>window.innerHeight?(t.height*ns.MAX_ZOOM-window.innerHeight)/(2*ns.MAX_ZOOM):(window.innerHeight-t.height*ns.MAX_ZOOM)/(2*ns.MAX_ZOOM);return{x:Math.min(Math.max(e.x,-1*s),s),y:Math.min(Math.max(e.y,-1*i),i)}}setPanOffset(e){const{panStartPosition:t}=Xt.Z.state,s=this.clampPanOffset(e);s&&(e.x!==s.x&&(t.x=t.x+(e.x-s.x)),e.y!==s.y&&(t.y=t.y+(e.y-s.y)),Xt.Z.setState({...Xt.Z.state,panOffset:s,panStartPosition:t}))}moveToImageOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{block:s}=Xt.Z.state,i=rs();if(!i)return;const n=i.findIndex((e=>e===s));if(n+e<0||n+e>=i.length)return;w.Lfx(this.environment,{type:e>0?"next":"previous",image_count:i.length,image_index:n+e,triggered_by:t?"keypress":"click"}),Xt.Z.setState({...Xt.Z.state,skipAnimations:!0}),this.isMovingToPrevOrNextTimeout&&clearTimeout(this.isMovingToPrevOrNextTimeout),this.isMovingToPrevOrNextTimeout=setTimeout((()=>{Xt.Z.setState({...Xt.Z.state,skipAnimations:!1})}),250);const a=i[n+e];Qt.dK({blocks:[a]}),this.resetControls()}getStyle(e){const{isOpen:t}=e;return{zIndex:Gt.mJ,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:this.showControls.state?void 0:"none"}}}function as(e){window.__c={n:"ZoomInput"};const[t,s]=(0,i.useState)(e.initialValue);return(0,v.jsx)(ct.Z,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;s(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:ct.B.Transparent,right:(0,v.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}Ot=ns,ns.displayName="FullScreenRenderer",ns.MAX_ZOOM=2,ns.MIN_ZOOM=.5,ns.ZOOM_STEP=.5,ns.INVERSE_ZOOM_STEP=1/Ot.ZOOM_STEP,ns.ZOOM_THRESHOLD=.25,ns.MOUSE_WHEEL_SCALE=-.002,ns.TRACK_PAD_SCALE=-.004,ns.controlBarStyle={display:"flex",borderRadius:4,background:F.ZP.blackWithAlpha(.65)},ns.firstButtonPadding={padding:"6px 6px 6px 10px"},ns.lastButtonPadding={padding:"6px 10px 6px 6px"},ns.hoveredButtonStyle={background:"rgba(255, 255, 255, 0.055)"};const os=ns;function rs(){const e=nt.default.getCurrentRootStore();return Jt.R.getMembersByDOMOrder({filter:t=>"image"===t.renderedType&&Boolean(t.getBlockStore().findRecordStoreUIAncestor((t=>Boolean(e&&t===e))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function ls(){const{zoomScale:e}=Xt.Z.state;return e>1}function ds(){var e;const{block:t,imageUrl:s}=Xt.Z.state;return t&&(s||(null===(e=t.getProperties())||void 0===e?void 0:e.source)&&j.QaF(t.getProperties().source))}function cs(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function us(){return F.ZP.white}function ms(){return F.ZP.whiteWithAlpha(.5)}function ps(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function gs(e){let{imageIndex:t,totalImageCount:s}=e;return(0,v.jsx)(d.FormattedMessage,{values:{currentIndex:t+1,totalCount:s},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function hs(e){const{primaryText:t,secondaryText:s}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{style:{marginRight:s?4:void 0},children:t}),s?(0,v.jsx)("span",{style:{color:ms()},children:s}):void 0]})}function fs(){return(0,v.jsx)("span",{style:{borderLeft:`1px solid ${F.ZP.whiteWithAlpha(.25)}`,height:"100%"}})}var ys=s(98567),xs=s(70279),vs=s(23867),Ss=s(19889),bs=s(36280),Ms=s(73959),js=s(89086),ws=s(66949),Cs=s(3702);class ks extends l.Z{constructor(){super(...arguments),this.input=i.createRef(),this.handleInputChange=(e,t)=>{ws.Z.isOpen()&&ws.Z.setState({...ws.Z.state,value:e,error:t})},this.handleSubmit=()=>{k.createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:this.environment,perform:e=>{bs.gt({environment:this.environment,equationStore:ws.Z,transaction:e})}})},this.handleClose=()=>{bs.Wj()},this.handleLeft=e=>{if(!this.input.current)return;const t=this.input.current.getSelection();t&&"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===t.startIndex&&0===t.endIndex&&(this.handleSubmit(),bs.Wj(ws.P.Backward))},this.handleRight=e=>{if(!ws.Z.isOpen())return;if(!this.input.current)return;const t=this.input.current.getSelection();if(!t)return;const s=ws.Z.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&t.startIndex===s&&t.endIndex===s&&(this.handleSubmit(),bs.Wj())},this.isDisabled=()=>{var e;if("editing"!==P.default.state.mode&&!ws.Z.isOpen())return!0;const t=ws.Z.isOpen()?null===(e=(0,T.QY)(ws.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,Ms.J2)(t);if(e&&e.isLocked())return!0}if(t&&t.table===xs.x_){const e=Ft.T5.createChildStore(t,{table:xs.x_,id:t.id,spaceId:(0,vs.C)(t.pointer.spaceId)}),s=e.isDefined(),{currentUserStore:i}=ae.default.state;if(!s||!i)return!0;const n=e.getCreatedByTable(),a=e.getCreatedById();if(n!==Ss.KJ||i.id!==a)return!0}const s={[j.GKr.User]:j.GKr.User,[j.GKr.Page]:j.GKr.Page,[j.GKr.Comment]:j.GKr.Comment,[j.GKr.Bot]:j.GKr.Bot,[j.GKr.Date]:j.GKr.Date,[j.GKr.ExternalObjectInstance]:j.GKr.ExternalObjectInstance,[j.GKr.TemporaryPage]:j.GKr.TemporaryPage,[j.GKr.TemplateVariable]:j.GKr.TemplateVariable,[j.GKr.FormulaPageProperty]:j.GKr.FormulaPageProperty,[j.GKr.FormulaContextValue]:j.GKr.FormulaContextValue,[j.GKr.Group]:j.GKr.Group,[j.GKr.Citation]:j.GKr.Citation};for(const i of Object.values(s))if((0,js.J6)(i))return!0;return!1},this.INPUT_ORIGIN_GAP_PX=8}renderComponent(){if(!ws.Z.isOpen())return;const e=!ws.Z.isOpen(),t=this.isDisabled(),s=function(){if(!ws.Z.isOpen())return;return ws.Z.state.savedTextSelectionRect}(),i=ws.Z.state.value,n=ws.Z.state.error;return(0,v.jsx)(h.DependencyConsumer,{dependency:h.deps.prismjs,children:a=>{if(!e)return(0,v.jsx)(Cs.Z,{Prism:a,ref:this.input,isOpen:!0,equationValue:i,error:n,displayMode:"inline",disabled:t,originRect:s,originGap:this.INPUT_ORIGIN_GAP_PX,onDismiss:this.handleClose,onChange:this.handleInputChange,onSubmit:this.handleSubmit,onLeft:this.handleLeft,onRight:this.handleRight})}})}}ks.displayName="InlineEquationOverlay";const Ts=ks;var Is=s(73935),Ps=s(97880),_s=s(96313),Zs=s(73744),Fs=s(70726),As=s(48863),Rs=s(33411);function Ds(e){switch(e){case Fs.Z.Preview:return(0,v.jsx)(d.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"});case Fs.Z.Mention:return(0,v.jsx)(d.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"});case Fs.Z.Link:return(0,v.jsx)(d.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"});default:(0,Ps.t1)(e)}}const Bs=function(){window.__c={n:"InternalUnfurlingMenu"};const e=(0,n.O7)(),t=(0,i.useRef)(null),[s]=(0,a.AF)(As.Z),o=(0,i.useCallback)((t=>{if(s.open){var i;if(!t)_s.pg({actionType:s.focusedIndex,environment:e,commentStore:null===(i=s.args.commentStore)||void 0===i?void 0:i.state,useTempStores:!1});As.Z.setState({open:!1})}}),[e,s]),r=(0,i.useCallback)((e=>{s.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&o(void 0)}),[o,s.open]),l=(0,i.useCallback)((e=>{const i=t.current;if(!s.open||!e.target||!i)return;const n=Is.findDOMNode(i);n&&(n.contains(e.target)||o(void 0))}),[o,s.open]);(0,i.useEffect)((()=>((0,Zs.lj)(window,"keydown",r),(0,Zs.lj)(window,"mousedown",l),()=>{(0,Zs.ZV)(window,"keydown",r),(0,Zs.ZV)(window,"mousedown",l)})),[r,l]);const d=(0,i.useRef)(!1);function c(t){var i;s.open&&void 0!==t.indexGlobal&&(As.Z.setState({...s,focusedIndex:t.indexGlobal}),_s.pg({actionType:t.indexGlobal,environment:e,commentStore:null===(i=s.args.commentStore)||void 0===i?void 0:i.state,useTempStores:!0}))}(0,a.VK)((()=>{var t,i;const n=(s.open&&(null===(t=s.args.commentStore)||void 0===t?void 0:t.state)&&(null===(i=s.args.commentStore.state)||void 0===i?void 0:i.isReady()))??!1;var a;n&&!d.current&&s.open&&_s.pg({actionType:s.focusedIndex,environment:e,commentStore:null===(a=s.args.commentStore)||void 0===a?void 0:a.state,useTempStores:!0});d.current=n}),[e,s]);const h=(0,a.VK)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),f=e.device.isMobile;return(0,v.jsx)(m.ZP,{popupType:h?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:s.open,originRect:s.open?s.selectionRect:void 0,placementToOrigin:m.ZP.Placement.Top,alignmentToOrigin:m.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:f,keepFocus:f,render:function(){var i;const{device:n}=e;if(!s.open)return;const a=function(t){const{url:s,args:i}=t,n=[];n.push({title:Ds(Fs.Z.Preview),validator:()=>!0,type:Fs.Z.Preview}),n.push({title:Ds(Fs.Z.Mention),validator:()=>!0,type:Fs.Z.Mention}),n.push({title:Ds(Fs.Z.Link),validator:()=>!0,type:Fs.Z.Link});return[{key:"menu section",render:e=>(0,v.jsx)(O.Z,{...e}),items:M.oA(n.map((t=>{let{title:n,validator:a,type:o}=t;if(a({url:s,baseUrl:_t.default.domainBaseUrl,publicDomainName:_t.default.publicDomainName})){return{key:`item ${o}`,render:t=>(0,v.jsx)(at.Z,{...t,title:n,onMouseEnter:s=>{var n;t.onMouseEnter(s),_s.pg({actionType:o,environment:e,commentStore:null===(n=i.commentStore)||void 0===n?void 0:n.state,useTempStores:!0})}}),action:()=>{var t;return _s.pg({actionType:o,environment:e,commentStore:null===(t=i.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(s);let o;return o=n.isMobile?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:320,maxHeight:"40vh"},null!==(i=s.args.commentStore)&&void 0!==i&&i.state&&s.args.commentStore.state.isReady()?(0,v.jsx)(u.Z,{...o,className:p.srZ,ref:t,children:(0,v.jsx)(L.Z,{type:L.i.Vertical,sections:a,onKeyboardArrow:c,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,v.jsx)(Rs.Z,{show:!0,showDelay:500,showHold:0,render:()=>(0,v.jsx)(u.Z,{...o,className:p.srZ,ref:t,children:(0,v.jsx)(O.Z,{style:{display:"flex",justifyContent:"center"},children:(0,v.jsx)(ts.Z,{})})})})},onDismiss:()=>o(void 0)})};var Ls=s(64572),Ns=s(88295),Os=s(45990),Es=s(48709),Vs=s(40462),Us=s(23210),Ws=s(54882),Ks=s(23178);function zs(e){window.__c={n:"LinkMenuInput"};const{state:t,focusInitial:s,defaultValue:i,onBlur:a,onKeyDown:o,style:r}=e,l=(0,n.MO)(),c=(0,d.useIntl)(),u=c.formatMessage({defaultMessage:"Paste link or search pages",id:"selectionLinkButton.search.createNewLinkPlaceholder"}),m=c.formatMessage({defaultMessage:"Edit link or search pages",id:"selectionLinkButton.search.editLinkPlaceholder"}),p=!l||!t.showCreateIn,g=l?void 0:!t.showCreateIn&&t.focusLinkInput,h=t.editingToken?m:u;return p?(0,v.jsx)(ne.ZP,{onFocus:Es.FV,placeholder:h,value:i||t.url,onChange:qs,onBlur:a,onKeyDown:o,focus:g,focusInitial:s,focusAfterAnimation:!0,preventCaptureArrowShortcuts:!0,style:r}):null}const qs=e=>{const t=Ks.Z.state;t.open&&Ks.Z.setState({...t,url:e.target.value,focusLinkInput:!0})};function Gs(e){window.__c={n:"LinkMenuInputWithPreview"};const{state:t,showPreview:s,store:i}=e,a=(0,n.MO)(),o=(0,Es.Fs)(t),{editingToken:r,focusTitleInput:l}=t;return s&&i?(0,v.jsx)(Ws.B,{store:i,onClick:Es.FV}):(0,v.jsx)(zs,{state:t,onBlur:Es.cX,onKeyDown:Hs,defaultValue:s?o:void 0,style:r?void 0:{marginTop:6},focusInitial:!Boolean(r)||a&&!l})}const Hs=e=>{"Escape"===e.key&&(e.stopPropagation(),(0,Es.hy)())};function Qs(e){window.__c={n:"LinkMenuTitleInput"};const{title:t,focus:s,defaultTitle:a}=e,o=(0,n.O7)(),r=(0,n.MO)(),[l,d]=(0,i.useState)(),c=(0,i.useRef)(!1),u=(0,i.useMemo)((()=>({environment:o,defaultTitle:a,setPlaceholder:d,hasTitleChanged:c})),[a,o]);return(0,i.useEffect)((()=>{const e=c.current;return()=>{e&&w.pZG(o)}}),[c,o]),(0,v.jsx)(ne.ZP,{focus:s,focusInitial:r,onFocus:Js,onBlur:()=>Xs(u),onChange:e=>Ys(e,u),onKeyDown:e=>ei(e,u),value:l?"":t,placeholder:l,preventCaptureArrowShortcuts:!0,style:{paddingBottom:8}})}const Ys=(e,t)=>{$s(e.target.value,t)},$s=(e,t)=>{const s=Ks.Z.state;if(!s.open)return;const{editingToken:i,savedTextSelectionState:n}=s;if(!i)return;if(!e)return void Ks.Z.setState({...s,title:""});const{environment:a,setPlaceholder:o,hasTitleChanged:r}=t;k.createAndCommit({userAction:"LinkMenu.updateTitle",environment:a,perform:t=>{const l=Os.iX({environment:a,title:e,transaction:t,editingToken:i,savedTextSelectionState:n});l&&Ks.Z.setState({...s,...l,title:e}),o(void 0),r.current=!0}})},Js=()=>{(0,Es.ZG)(!0)},Xs=e=>{ti(e),(0,Es.ZG)(!1)},ei=(e,t)=>{"Enter"!==e.key&&"Escape"!==e.key||(e.stopPropagation(),Xs(t))},ti=e=>{const t=Ks.Z.state;if(!t.open)return;const{defaultTitle:s,setPlaceholder:i}=e;t.title||($s(s,e),i(s))};var si=s(88632),ii=s(18466),ni=s(59054),ai=s(31299),oi=s(11470),ri=s(15447);var li=s(37612);function di(e){const{state:t}=e,s=(0,i.useMemo)((()=>(0,Es.uP)(t)),[t]),o=(0,i.useMemo)((()=>(0,Es.dY)(s)),[s]),r=function(e){const{state:t,inputUrl:s,query:o,handleLinkSelection:r}=e,{url:l}=t,c=(0,n.O7)(),u=(0,n.MO)(),m=(0,a.VK)((()=>si.Z.state.online),[]),p=!!l;return(0,i.useMemo)((()=>{let e,i=!1;if(!s&&p)e=(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Type a complete URL to link",id:"selectionLinkButton.invalidUrl"}),i=!0;else{if(!s)return;if("notion"===s.type&&m)return;"web"===s.type?e=(0,v.jsx)(d.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===s.type?e=(0,v.jsx)(d.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===s.type?e=(0,v.jsx)(d.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):(0,Ps.t1)(s.type)}return{key:"link to url",action:()=>r(c,t,o,u),render:t=>(0,v.jsx)(at.Z,{...t,title:l,caption:e,icon:(0,Vs.o)({width:16,paddingTop:4}),disabled:i})}}),[t,o,c,u,m,s,r,p,l])}({state:t,inputUrl:o,query:s,handleLinkSelection:ci}),l=function(e){const{state:t,inputUrl:s,query:o,additionalItem:r}=e,{editingToken:l}=t,c=function(e){const{state:t,inputUrl:s,query:o,handleLinkSelection:r,disableEmptyQueryResults:l}=e,{savedTextSelectionState:c}=t,u=(0,n.O7)(),m=(0,n.MO)(),[{online:p}]=(0,a.AF)(si.Z),g=(0,i.useMemo)((()=>{var e;const t=null===(e=(0,T.QY)(c.multiSelection))||void 0===e?void 0:e.store;if(t&&(0,Ke.OY)(t))return t}),[c]),[{value:h,status:f}]=(0,ni.r5)((async()=>p?o?(await ai.WL({nearBlock:g,environment:u,query:o,source:"mention_menu",limit:10})).map((e=>e.id)):l?[]:ri.X4.state.map((e=>e.pageId)):[]),[o,g,u,p,l]),y=(0,i.useMemo)((()=>{if(s&&"notion"===s.type){const e=h?M.zu(h,s.notionPage.blockId):[];return[s,...e]}return h}),[h,s]);return(0,i.useMemo)((()=>{if(!y||0===y.length)return;if(s&&"web"===s.type&&s.url===o)return;const e=ii.Z.withListenerIgnored(St.RM);if(!e)return;const i=t.url?5:3,n=(0,v.jsx)(d.FormattedMessage,{id:"selectionLinkButton.linkToPage.linkToBlock",defaultMessage:"Link to block"}),a=(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Link to page",id:"selectionLinkButton.linkToPageSection.title"});return{items:y.map(((s,i)=>{const a="object"==typeof s?s.notionPage.peekViewBlockId||s.notionPage.blockId:s,o=Ft.G.createChildStore(e,{table:Tt.iU,id:a});return{key:i,action:()=>{if("object"==typeof s){const e=(0,Ls.nR)({pageId:s.notionPage.blockId,peekViewBlockId:s.notionPage.peekViewBlockId,peekMode:s.notionPage.peekMode,discussionId:s.notionPage.discussionId,collectionViewId:s.notionPage.collectionViewId,scrollToBlockId:s.notionPage.scrollToBlockId});r(u,t,e,m)}else r(u,t,(0,Ls.nR)({pageId:a}),m)},render:e=>{const t="object"==typeof s&&s.notionPage.scrollToBlockId;return(0,v.jsx)(oi.Z,{...e,store:o,caption:t?n:void 0,placeholder:(0,v.jsx)(Rs.Z,{showHold:300,showDelay:300,show:"resolved"===f,render:e=>e?(0,v.jsx)(d.FormattedMessage,{id:"selectionLinkButton.linkToPage.unknownBlock",defaultMessage:"Unknown block"}):(0,v.jsx)(d.FormattedMessage,{id:"selectionLinkButton.linkToPage.loading",defaultMessage:"Loading..."})})})}}})).slice(0,i),title:y.some((e=>Boolean("object"==typeof e&&e.notionPage.scrollToBlockId)))?n:a}}),[y,t,u,m,o,s,f,r])}({state:t,inputUrl:s,query:o,handleLinkSelection:ci,disableEmptyQueryResults:!!l});return(0,i.useMemo)((()=>{if(c||r){return{key:"results",items:M.oA([...(null==c?void 0:c.items)||[],r]),render:e=>(0,v.jsx)(O.Z,{...e,title:l||o?void 0:(0,v.jsx)(d.FormattedMessage,{id:"selectionLinkButton.recents.title",defaultMessage:"Recents"})})}}}),[c,r,l,o])}({state:t,inputUrl:o,query:s,additionalItem:r}),c=(0,Es.Fs)(t),u=c&&(0,Ls.A5)({url:c,baseUrl:_t.default.domainBaseUrl,publicDomainName:_t.default.publicDomainName}),m=(0,a.VK)((()=>{if(!u)return;const e=(0,St.RM)();return e?Ft.G.createChildStore(e,{table:Tt.iU,id:u}):void 0}),[u]),p=function(e){const{state:t,url:s,isEmptyResults:n,pageStore:a}=e;return(0,i.useMemo)((()=>{let e=(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Page or URL",id:"selectionLinkButton.currentInfo.pageOrUrl"});const i=!t.focusLinkInput&&n;let o;return a?o={key:"link to page",action:()=>{},render:()=>(0,v.jsx)(Gs,{state:t,showPreview:i,store:a})}:s?o={key:"link to web",action:()=>{},render:()=>(0,v.jsx)(Gs,{state:t,showPreview:!0})}:(e=void 0,o={key:"create link",action:()=>{},render:()=>(0,v.jsx)(Gs,{state:t,showPreview:i})}),{key:"page or url",render:t=>(0,v.jsx)(O.Z,{title:e,...t}),items:[o]}}),[t,s,n,a])}({state:t,url:c,isEmptyResults:!Boolean(l),pageStore:m}),g=function(e){const{state:t,url:s,pageStore:n}=e,{editingToken:o,title:r,focusTitleInput:l}=t,c=(0,a.VK)((()=>n?j.QaF(n.getTitleValue()):void 0),[n]);return(0,i.useMemo)((()=>{if(o)return{key:"link title",render:e=>(0,v.jsx)(O.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Link title",id:"selectionLinkButton.currentInfo.linkTitle"}),...e}),items:[{key:"update title",action:()=>{},render:()=>(0,v.jsx)(Qs,{title:r,defaultTitle:c??s,focus:l})}]}}),[o,r,l,s,c])}({state:t,url:c,pageStore:m}),h=function(e){const{state:t}=e,s=function(e){const{state:t}=e,s=(0,n.O7)();return(0,i.useMemo)((()=>{if(t.editingToken)return{key:"unlink",action:()=>{Os.PP(s);const e=(0,Es.Fs)(t);w.oSR(s,{type:"remove_link",url:e})},render:e=>(0,v.jsx)(at.Z,{...e,title:(0,v.jsx)(d.FormattedMessage,{id:"selectionLinkButton.removeLink",defaultMessage:"Remove link"}),icon:(0,li.y)({width:16})})}}),[t,s])}({state:t});return(0,i.useMemo)((()=>{const e=M.oA([s]);if(0!==e.length)return{key:"link actions",render:e=>(0,v.jsx)(O.Z,{topBorder:!0,...e}),items:e}}),[s])}({state:t});let f,y;return l?(y=1,f=M.oA([p,l])):(y=void 0,f=M.oA([p,g,h])),{initialFocus:y,sections:f}}function ci(e,t,s,i){const n=(0,Us.D)(s);if(!n)return;const{editingToken:a,savedTextSelectionState:o,title:r}=t;k.createAndCommit({userAction:"LinkMenu.handleLinkSelection",environment:e,perform:s=>{const l=Os.gp({environment:e,transaction:s,url:n,title:r,editingToken:a,savedTextSelectionState:o});l?(w.oSR(e,{type:"edit_link",url:n}),Ks.Z.setState({...t,...l,url:"",focusLinkInput:!1,focusTitleInput:Boolean(i)})):(w.oSR(e,{type:"create_link",url:n}),Ks.Z.reset())}})}var ui=s(20069),mi=s(34583),pi=s(56940);function gi(){window.__c={n:"LinkMenu"};const e=(0,a.VK)((()=>Ks.Z.state),[]),t=(0,n.Fy)(),s=(0,a.VK)(Ce.bq,[]),o=(0,a.VK)((()=>{if(!e.open)return!1;if(e.focusLinkInput||e.focusTitleInput)return!1;const t=P.default.state;if("editing"!==t.mode)return!0;const s=(0,T.QY)(t.multiSelection);if(!s)return!0;const{store:i,selection:n}=s;return(0,js.wd)(n)?!j.oP(i.getValue(),n.startIndex,n.endIndex,j.GKr.Link):!(0,T._v)(t.multiSelection,e.savedTextSelectionState.multiSelection)}),[e]);return(0,i.useEffect)((()=>{o&&Os.F5()}),[o]),(0,v.jsx)(m.ZP,{popupType:t.isMobile?t.isTablet?m.ZP.PopupType.Popup:m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,style:{width:Si(s)},keepFocus:t.isPhone,open:e.open,originRect:e.open?e.selectionRect:void 0,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Center,originGap:8,disableContentScroll:!0,onDismiss:Os.F5,render:()=>e.open?(0,v.jsx)(hi,{state:e}):void 0,preventBlockRenderQueueOnEnter:!t.isMobile})}function hi(e){window.__c={n:"LinkMenuContent"};const{state:t}=e,s=(0,n.MO)(),[a,o]=(0,i.useState)(!0);if((0,i.useEffect)((()=>o(!1)),[]),t.showCreateIn&&!s)return(0,v.jsx)(yi,{state:t});let r;return r=s?{menuType:g.og.Modal,title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Link",id:"selectionLinkButton.mobile.title"}),right:(0,v.jsx)(He.CancelMenuText,{}),onClickRight:Os.F5,footer:(0,v.jsx)(m.ZP,{popupType:m.ZP.PopupType.SlideUp,open:t.showCreateIn||!1,render:()=>(0,v.jsx)(yi,{state:t})})}:{menuType:g.og.Popup},(0,v.jsxs)($.Z,{capture:t.open&&(a||t.focusLinkInput||t.focusTitleInput),allowEsc:!0,children:[(0,v.jsx)(u.Z,{...r,children:(0,v.jsx)(pi.Z,{capture:s&&!t.focusLinkInput&&!t.focusTitleInput,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!0,render:()=>(0,v.jsx)(fi,{state:t,useMenuList:di})})}),(0,v.jsx)(J.Z,{capture:!0,onCommandSlash:Es.FV})]})}function fi(e){window.__c={n:"LinkMenuList"};const{state:t,useMenuList:s}=e,{initialFocus:i,sections:n}=s({state:t});return(0,v.jsx)(L.Z,{type:L.i.Vertical,initialFocus:i,sections:n})}function yi(e){var t;window.__c={n:"LinkCreateInMenu"};const{state:s}=e,o=(0,n.O7)(),r=(0,i.useCallback)((async e=>{var t;if(!mi.M_(o))return;const i=null===(t=(0,T.QY)(s.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;if(!i)return;const{performResult:{createInState:n}}=await k.createAndCommitAsync({environment:o,userAction:"LinkMenu.LinkCreateInMenu",waitForServerCommit:!0,perform:async t=>{const n=Ns.f8({environment:o,transaction:t,titleText:s.url||"",createInValue:e,recordStoreParent:i}),[a]=n.createdPages;return a&&(Os.gp({environment:o,url:(0,Ls.nR)({pageId:a.id}),transaction:t,editingToken:s.editingToken,savedTextSelectionState:s.savedTextSelectionState}),Ks.Z.reset()),await n.moveToStorePromise,{createInState:n}}});await Ns.c_({analyticsFrom:"link_menu",createInState:n})}),[s,o]),l=null===(t=(0,T.QY)(s.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,d=l&&"block"===l.table?l.id:void 0,c=(0,a.VK)(Ce.bq,[]);return(0,v.jsx)(ui.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:r,captureSelection:!1,restoreSelection:!1,parentBlockId:d,onAutocompleteQueryChange:xi,autocompleteQuery:s.createInQuery||"",desktopWidth:Si(c),onCancel:vi})}function xi(e){const t=Ks.Z.state;t.open&&Ks.Z.setState({...t,createInQuery:e})}function vi(){const e=Ks.Z.state;e.open&&Ks.Z.setState({...e,showCreateIn:!1,createInQuery:""})}function Si(e){return e?400:330}var bi=s(27153),Mi=s(84939),ji=s(79362),wi=s(39901),Ci=s(35840),ki=s(47691),Ti=s(11751),Ii=s(89078),Pi=s(91584),_i=s(96802),Zi=s(64964),Fi=s(53471),Ai=s(24405),Ri=s(17809),Di=s(65187);function Bi(e){window.__c={n:"AiSourcePickerQueryInput"};const{placeholder:t,onSubmit:s}=e,n=(0,Ai.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:"6px 10px",marginLeft:8,marginRight:8,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{minHeight:60},placeholder:{minHeight:60}})),[]),a=(0,i.useCallback)((e=>{if(s&&!e.shiftKey)s();else{if("editing"!==P.default.state.mode)return}}),[s]);return(0,v.jsx)("div",{style:n.wrap,className:p.Wh_,children:(0,v.jsx)(Di.Z,{placeholder:t,disabled:!1,store:e.store,style:n.text,placeholderStyle:n.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:a,disableMobileActionBar:!1,disableDateReminderMentions:!0,disableStyleAnnotations:!0})})}var Li=s(6202);function Ni(e){window.__c={n:"AiSourcePickerInputWrapper"};const{tab:t}=e,s=(0,n.O7)(),{store:a}=(0,Ri.Cl)({initialValue:void 0,onChange:M.yR}),o=(0,Ai.yK)((e=>({desktopStyle:{marginTop:8,marginBottom:6},sparkleStyle:{width:16,height:16,marginRight:4},captionStyle:{textAlign:s.device.isMobile?"left":"center"}})),[s.device.isMobile]),r=(0,i.useCallback)((async()=>{const s=a.getValue();if(!s)return;const i=[];for(const e of s){var n;if("‣"===e[0]&&null!==(n=e[1])&&void 0!==n&&n.length){if("d"===e[1][0][0]){const t=e[1][0][1].start_date;i.push(t)}else if("u"===e[1][0][0]){const t=e[1][0][1],{currentSpaceStore:s}=ae.default.state;if(!s)return{users:[],bots:[]};const n=Ft.U6.createChildStore(s,{table:Ss.KJ,id:t});await n.load();const a=n.getEmail();i.push(a||"")}}else i.push(e[0])}const o=i.join(""),r=t.integration;if(o){e.store.setState({...e.store.state,loading:!0});const s=await t.getResults(o,r);e.store.setState({...e.store.state,loading:!1,result:s.results})}}),[a,e.store,t]);return(0,v.jsxs)("div",{children:[(0,v.jsx)(O.Z,{desktopStyle:o.desktopStyle,children:(0,v.jsx)(Bi,{placeholder:e.placeholder,onSubmit:r,store:a})}),(0,v.jsx)(O.Z,{children:(0,v.jsx)(Li.Z,{onClick:r,title:t.buttonText||(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Ask",id:"mediaPicker.aiSourcePickerTab.askButtonText"}),(0,v.jsx)("div",{children:(0,Ti.t)(o.sparkleStyle)})]}),fullWidth:e.isSmallWidth})}),t.caption&&(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:t.caption,style:o.captionStyle})]})}var Oi=s(42922),Ei=s(949),Vi=s(51077),Ui=s(91839),Wi=s(63296),Ki=s(77137),zi=s(30506),qi=s(91718),Gi=s(23321),Hi=s(50265),Qi=s(73063),Yi=s(86825),$i=s(57670);const Ji=(0,d.defineMessages)({selectSpecificIconColor:{defaultMessage:"Select icon color {iconColor}",id:"iconPickerColorPicker.selectSpecificColor"},selectIconColor:{defaultMessage:"Select icon color",id:"iconPickerColorPicker.selectColor"},selectIconColorWithCurrentColor:{defaultMessage:"Select icon color, {iconColor} selected",id:"iconPickerColorPicker.selectColorWithCurrentColor"},noIconColor:{defaultMessage:"no color",id:"iconPickerColorPicker.noColor"}});function Xi(){window.__c={n:"IconPickerColorPicker"};const e=(0,a.VK)((()=>{var e;return null===(e=ae.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}),[]),t=(0,d.useIntl)(),s=(0,n.O7)(),i=(0,Ai.Fg)(),o=(0,n.Fy)(),r=(0,a.qz)(void 0,te.Z);return(0,v.jsx)(X.Z,{renderTooltip:()=>t.formatMessage(Ji.selectIconColor),placement:X.Z.Placement.Bottom,render:n=>(0,v.jsx)(Y.ZP,{preventBlockRenderQueueOnEnter:!0,buttonPopupStore:r,popupType:Y.Z4.Popup,renderOrigin:s=>(0,v.jsx)(ne.DO,{ariaLabel:t.formatMessage(Ji.selectIconColorWithCurrentColor,{iconColor:t.formatMessage(e?ji.RR[e]:Ji.noIconColor)}),icon:t=>(0,Hi.U)({...t,stroke:e?ji.Lr[i.mode][e]:ji.Lr[i.mode].lightgray,fill:e?ji.Lr[i.mode][e]:i.lightIconColor}),...(0,ee.Z)(s,n)}),render:n=>function(e){const{parent:t,environment:s,currentIconPickerColor:i,theme:n,device:a,intl:o}=e,r=ji.Oe.map((e=>({key:e,action:i=>{t.close(),en({environment:s,color:e})},render:t=>(0,v.jsx)(X.Z,{renderTooltip:()=>o.formatMessage(ji.RR[e]),placement:X.Z.Placement.Bottom,render:s=>(0,v.jsx)(Qi.Z,{...(0,ee.Z)(s,t),ariaLabel:o.formatMessage(Ji.selectSpecificIconColor,{iconColor:o.formatMessage(ji.RR[e])}),style:{...a.isMobile?{width:$i.Z.mobileButtonSize,height:$i.Z.mobileButtonSize}:{width:$i.Z.desktopButtonSize,height:$i.Z.desktopButtonSize}},icon:t=>(0,Hi.U)({...t,height:a.isMobile?18:14,width:a.isMobile?18:14,stroke:ji.Lr[n.mode][e],fill:ji.Lr[n.mode][e]})})})})));return r.push({key:"askEveryTime",action:()=>{t.close(),en({environment:s,color:void 0})},render:e=>(0,v.jsx)(Yi.Z,{...e,title:(0,v.jsx)(d.FormattedMessage,{id:"iconPickerColorPicker.askEveryTime",defaultMessage:"Ask every time"}),onClick:()=>{en(void 0!==i?{environment:s,color:void 0}:{environment:s,color:"gray"})},on:void 0===i,style:{boxShadow:void 0},textWrapperStyle:{marginLeft:a.isMobile?10:6},rightStyle:{marginRight:4}})}),(0,v.jsx)($.Z,{capture:!0,allowEsc:!0,children:(0,v.jsx)(L.Z,{type:L.i.Grid,itemsPerRow:5,initialFocus:i?Math.max(ji.Oe.indexOf(i),0):10,sections:[{key:"variations",render:e=>(0,v.jsx)("div",{...e}),items:r}],renderRow:(e,t)=>(0,v.jsx)("div",{style:{display:"flex",padding:4,...t<2&&void 0===i&&{opacity:.5},...2===t&&{padding:"0 0 4px 0",flexDirection:"row-reverse"}},children:e},t)})})}({parent:n,environment:s,currentIconPickerColor:e,theme:i,device:o,intl:t})})})}function en(e){const{environment:t,color:s}=e,{currentUserSettingsStore:i}=ae.default.state;i&&k.createAndCommit({userAction:"mediaPicker.setIconPickerColor",environment:t,perform:e=>{const t=void 0!==s?s:null;ie.d2({userSettingsStore:i,transaction:e,data:{icon_picker_color:t}})}})}var tn=s(78948),sn=s(5385),nn=s(45567);class an extends z.default{getInitialState(){return{inputValue:"",focus:!1,result:void 0,loading:!1,hover:""}}}const on=an;var rn=s(4391),ln=s(33846),dn=s(91390),cn=s(78291),un=s(88893),mn=s(3403),pn=s(12981),gn=s(16354),hn=s(81865),fn=s(62385);function yn(){const{device:e,WindowSizeStore:t}=(0,n.O7)(),s=(0,a.VK)((()=>e.isPhone),[e]),{phonePaddingLeft:i,phonePaddingRight:o}=(0,a.VK)((()=>({phonePaddingLeft:t.getSafePaddingLeftCSS(14),phonePaddingRight:t.getSafePaddingRightCSS(14)})),[t]);return(0,Ai.yK)((e=>({galleryWrap:{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:e.popoverBackground,paddingTop:s?12:0,paddingBottom:s?12:0,paddingLeft:s?i:12,paddingRight:s?o:12,boxShadow:s?`0 1px 0 ${e.regularDividerColor}`:""}})),[s,i,o])}function xn(e){let{pageCover:t,tab:s}=e;window.__c={n:"GalleryItem"};const{coverUrl:n,title:a,subtitle:o,position:r}=t,l=(0,Ai.yK)((e=>({container:{width:"25%",padding:3},tooltip:{maxWidth:180,whiteSpace:"normal"},title:{color:e.regularInvertedTextColor},subtitle:{color:e.mediumInvertedTextColor},buttonHover:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:`center ${100*(r||0)}%`,borderRadius:4}})),[r]),d=(0,i.useCallback)((()=>{s.onChange({url:n,position:r})}),[s,n,r]);return(0,v.jsx)("div",{style:l.container,children:(0,v.jsx)(X.Z,{originGap:0,placement:X.Z.Placement.Bottom,delayThreshold:600,renderTooltip:()=>(0,v.jsxs)("div",{style:l.tooltip,children:[(0,v.jsx)("span",{style:l.title,children:V.default.formatMessage(a)})," ",(0,v.jsx)("span",{style:l.subtitle,children:o&&V.default.formatMessage(o)})]}),render:e=>(0,v.jsx)(Q.Z,{hoveredStyle:l.buttonHover,...e,onClick:d,children:(0,v.jsx)(hn.Z,{url:n,width:200,isAuthenticated:!1,render:(e,t)=>t&&(0,v.jsx)(pn.Z,{src:t,style:l.imageBox})})})})})}const vn=function(e){let{tab:t}=e;window.__c={n:"GalleryMediaPickerTab"};const[s,n]=(0,i.useState)({}),[a,o]=(0,i.useState)(!1);(0,i.useEffect)((()=>{(async()=>{o(!0),await h.deps.pageCovers.loader().then((e=>{n(e.default),o(!1)}))})()}),[]);const r=yn(),l=(0,Ai.yK)((e=>({container:{paddingBottom:8},groupTitle:{marginLeft:-5},loader:{height:300}})),[]);return a?(0,v.jsx)("div",{style:l.loader,children:(0,v.jsx)(mn.Z,{})}):(0,v.jsx)("div",{style:l.container,children:M.UI(s,((e,s)=>(0,v.jsx)(O.Z,{title:(0,v.jsx)(gn.Z,{style:l.groupTitle,href:e.url,external:!0,children:(0,v.jsx)(fn.Z,{children:V.default.formatMessage(e.title)})}),isTitleUppercase:!0,noTextOverflow:!0,children:(0,v.jsx)("div",{style:r.galleryWrap,children:e.items.map(((e,s)=>(0,v.jsx)(xn,{pageCover:e,tab:t},s)))})},s)))})};var Sn=s(54642),bn=s(42402);const Mn=(0,d.defineMessages)({giphyPlaceholder:{id:"mediaPicker.giphyPlaceholder.text",defaultMessage:"Search GIPHY"}});function jn(e){window.__c={n:"GiphyResults"};const{tab:t,results:s,ready:n,isSmallWidth:a,giphyRandomId:o}=e,r=(0,Ai.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:a?"left":"center",color:e.mediumTextColor}})),[a]);return n?!s||s&&!s.length?(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.giphy.noResultsText"}),style:r.captionMenuItem}):(0,v.jsxs)(i.Fragment,{children:[s.map(((e,s)=>(0,v.jsx)(wn,{tab:t,image:e,giphyRandomId:o},s))),(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.giphy.searchText"}),style:r.captionMenuItem})]}):(0,v.jsx)("div",{style:r.loading,children:(0,v.jsx)(ts.Z,{})})}function wn(e){var t;let{tab:s,image:a,giphyRandomId:o}=e;window.__c={n:"RenderedGiphyImage"};const r=(0,n.O7)(),{device:l}=r,c=(0,Ai.yK)((e=>({container:{width:l.isMobile?"33%":"25%",padding:3},hoveredButton:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4},label:{marginTop:2,marginBottom:4}})),[l.isMobile]),u=(0,i.useCallback)((async()=>{var e;if(s.onChange({url:a.imageUrl}),null!==(e=a.analytics)&&void 0!==e&&e.onclick)try{var t;await Sn.postGiphyAnalytics(r,{url:null===(t=a.analytics)||void 0===t?void 0:t.onclick.url,timestamp:Date.now(),random_id:o})}catch(i){}}),[r,o,a.imageUrl,s,null===(t=a.analytics)||void 0===t?void 0:t.onclick]);return(0,v.jsxs)("div",{style:c.container,children:[(0,v.jsx)(Q.Z,{hoveredStyle:c.hoveredButton,onClick:u,children:(0,v.jsx)(pn.Z,{src:a.thumbUrl,style:c.imageBox})}),(0,v.jsx)(ut.Z,{isSmall:!0,isSecondaryColor:!0,style:c.label,children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.giphy.byAuthor",values:{authorName:a.authorName||"GIPHY",inlinetextlink:e=>(0,v.jsx)(bn.Z,{external:!0,href:a.imageUrl,children:e})}})})]},a.id)}const Cn=function(e){let{tab:t,isSmallWidth:s}=e;window.__c={n:"GiphyMediaPickerTab"};const[a,o]=(0,i.useState)(""),[r,l]=(0,i.useState)(""),d=(0,n.O7)(),{device:c}=d,u=yn(),m=(0,i.useCallback)((async()=>{if(!M.xb(a))return a;const e=await Sn.getGiphyRandomId(d,{});return"success"===e.type?(o(e.data.random_id),e.data.random_id):void 0}),[d,a]);return(0,v.jsxs)("div",{style:{paddingBottom:8},children:[(0,v.jsx)(O.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,v.jsx)(ne.ZP,{value:r,placeholder:V.default.formatMessage(Mn.giphyPlaceholder),showClearButton:!0,focus:!c.isMobile||void 0,onChange:e=>l(e.target.value)})}),(0,v.jsx)("div",{style:u.galleryWrap,children:(0,v.jsx)(Ki.Z,{request:r,debounce:ai.vp,performRequest:async e=>{await m();const t=await Sn.searchGiphyImages(d,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,i,n)=>(0,v.jsx)(jn,{tab:t,results:i,ready:n,isSmallWidth:s,giphyRandomId:a})})})]})};var kn=s(24608);const Tn=(0,d.defineMessages)({unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an image…"}});function In(e){window.__c={n:"UnsplashResults"};const{tab:t,results:s,ready:n,isSmallWidth:a}=e,o=(0,Ai.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:a?"left":"center",color:e.mediumTextColor}})),[a]);return n?!s||s&&!s.length?(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:o.captionMenuItem}):(0,v.jsxs)(i.Fragment,{children:[s.map(((e,s)=>(0,v.jsx)(Pn,{tab:t,image:e},s))),(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:o.captionMenuItem})]}):(0,v.jsx)("div",{style:o.loading,children:(0,v.jsx)(ts.Z,{})})}function Pn(e){let{tab:t,image:s}=e;window.__c={n:"RenderedUnsplashImage"};const a=(0,n.O7)(),{device:o}=a,r=(0,i.useCallback)((async()=>{const e=await(0,kn.ZP)({environment:a,url:s.downloadUrl,method:"GET",format:"json"});"success"===e.type&&t.onChange({url:e.data.url})}),[a,s.downloadUrl,t]);return(0,v.jsxs)("div",{style:{width:o.isMobile?"33%":"25%",padding:3},children:[(0,v.jsx)(Q.Z,{hoveredStyle:{opacity:.85},onClick:r,children:(0,v.jsx)(pn.Z,{src:s.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4}})}),(0,v.jsx)(ut.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4},children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",values:{authorName:s.authorName,inlinetextlink:e=>(0,v.jsx)(bn.Z,{external:!0,href:s.unsplashUrl,children:e})}})})]},s.id)}const _n=function(e){let{tab:t,isSmallWidth:s}=e;window.__c={n:"UnsplashMediaPickerTab"};const[a,o]=(0,i.useState)(""),r=(0,n.O7)(),{device:l}=r,d=yn();return(0,v.jsxs)("div",{style:{paddingBottom:8},children:[(0,v.jsx)(O.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,v.jsx)(ne.ZP,{value:a,placeholder:V.default.formatMessage(Tn.unsplashPlaceholder),showClearButton:!0,focus:!l.isMobile||void 0,onChange:e=>o(e.target.value)})}),(0,v.jsx)("div",{style:d.galleryWrap,children:(0,v.jsx)(Ki.Z,{request:a,debounce:ai.vp,performRequest:async e=>{const t=await Sn.searchUnsplashImages(r,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,i,n)=>(0,v.jsx)(In,{tab:t,results:i,ready:n,isSmallWidth:s})})})]})},Zn=(0,d.defineMessages)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://…"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filter…"},aiSourcePickerPlaceholder:{id:"mediaPicker.githubPlaceholder.text",defaultMessage:"Ask query here"},aiIsFetchingLoader:{id:"mediaPicker.aiIsFetchingLoader.text",defaultMessage:"Ai is fetching"}});class Fn extends l.Z{constructor(){super(...arguments),this.menuRef=i.createRef(),this.storeTypes={embedInputStore:ln.Z,emojiInputStore:ln.Z,iconInputStore:ln.Z,iconPickerStore:rn.Z,aiSourcePickerStore:on},this.handleEmbedSubmit=e=>()=>{const t=this.stores.embedInputStore.state.inputValue;if(t){const s=(0,Et.Wv)(t,_t.default.secureFileS3.url,_t.default.secureFileS3V2.url,_t.default.secureFileConfig.rootPath,_t.default.secureFileConfig.hostname),i=s?s.link:t;e.onChange(i),w.bOx(this.environment,{pastedText:i,source:"media_picker"})}},this.handleAiSourcePickerSubmit=(e,t)=>()=>{e&&t.onChange(e)},this.handleSwipeLeft=()=>{if(!dn.Z.state.isActive)return;const e=this.props.tabs,t=e.map((e=>e.type)).indexOf(dn.Z.state.currentTab),s=e[t+1];void 0!==s&&this.handleTabChange(s.type)},this.handleSwipeRight=()=>{if(!dn.Z.state.isActive)return;const e=this.props.tabs,t=e.map((e=>e.type)).indexOf(dn.Z.state.currentTab),s=e[t-1];void 0!==s&&this.handleTabChange(s.type)},this.handleTabChange=e=>{dn.Z.state.isActive&&(dn.Z.setState({...dn.Z.state,currentTab:e}),"icon"===e&&dn.Z.state.recordIconLoggingData&&w.kz9(this.environment,"select_icon_tab",dn.Z.state.recordIconLoggingData))},this.handleRandomEmojiClick=()=>{const{device:e}=this.environment,t=this.props.tabs.find((e=>e.type===this.props.currentTab));if(t&&"emoji"===t.type){const s=_i.zM();t.onChange(s,{keepVisible:!e.isMobile})}},this.handleRandomIconClick=()=>{const{device:e}=this.environment,{iconPickerStore:t}=this.stores,s=this.props.tabs.find((e=>e.type===this.props.currentTab));if(s&&"icon"===s.type){const i=s.enforceIconColor??sn.x(),n=`/icons/${M.UP(Object.keys(t.getState().allIcons))}_${i??M.UP(ji.Oe)}.svg`;s.onChange(n,{keepVisible:!e.isMobile})}},this.handleFilterChange=e=>{const{emojiInputStore:t,iconInputStore:s,iconPickerStore:i}=this.stores,n=this.getNumIconPerRow()*(this.environment.device.isMobile?_.pq:_.II),a=this.getNumIconPerRow()*(this.environment.device.isMobile?Gi.L6:Gi.OF);t.setState({...t.state,inputValue:e.currentTarget.value}),H.setState({...H.state,loadEmojiCount:n}),s.setState({...s.state,inputValue:e.currentTarget.value}),i.setState({...i.state,loadIconCount:a})}}renderComponent(){const{device:e}=this.environment,t=this.renderTabsHeader(),s=this.renderInputHeader(),n=(t||s)&&(0,v.jsxs)(i.Fragment,{children:[t,s]});let a;if(e.isMobile)a={menuType:g.og.Modal,title:this.props.title,header:n,right:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:this.props.onCancel,left:this.props.onDelete&&(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:this.props.onDelete};else{a={menuType:g.og.Popup,header:n};const e=this.props.tabs.find((e=>e.type===this.props.currentTab)),t=e&&"custom"===e.type?e.tabHeight:void 0;a.width=this.props.popupWidth||300,a.height=t||this.props.popupHeight,a.maxHeight=this.props.maxHeight,a.maxWidth=this.props.maxWidth}return(0,v.jsx)(zi.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>(0,v.jsx)(u.Z,{...a,...e,className:p.tQh,innerRef:this.menuRef,children:this.renderCurrentTab()})})}renderTabsHeader(){const{device:e}=this.environment;if(!(this.props.tabs.length<=1)||this.props.onDelete){const t={gallery:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),icon:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.icon",defaultMessage:"Icon"}),custom:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.custom",defaultMessage:"Custom"}),unsplash:(0,v.jsxs)(i.Fragment,{children:[(0,Ii.i)({width:12,marginRight:4,height:12}),(0,v.jsx)("span",{children:"Unsplash"})]}),giphy:(0,v.jsxs)(i.Fragment,{children:[(0,wi.z)({width:12,marginRight:4,height:12}),(0,v.jsx)("span",{children:"GIPHY"})]}),drive:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),box:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),aiSourcePicker:(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.ask",defaultMessage:"Ask"}),(0,Ti.t)({width:16,height:16,marginRight:4,color:this.theme.accentColors.purple[400]})]})},s=this.props.tabs,n=s.findIndex((e=>e.type===this.props.currentTab)),a=s.map((e=>e.title||t[e.type])),o=s.find((e=>e.type===this.props.currentTab)),r=o&&"emoji"!==o.type&&e.isAndroid;return(0,v.jsx)(Ye.Z,{tabs:a,selectedIndex:n,onChange:e=>{const t=s[e];this.handleTabChange(t.type)},right:this.props.onDelete&&!e.isMobile&&(0,v.jsx)(is.Z,{isGray:!0,onClick:this.props.onDelete,children:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"})}),style:{...r&&{borderBottom:"none"}}})}}renderInputHeader(){const{isPhone:e,isMobile:t,isAndroid:s}=this.environment.device,i=this.props.tabs.find((e=>e.type===this.props.currentTab));if(i&&("emoji"===i.type||"icon"===i.type)){const n="emoji"===i.type?this.stores.emojiInputStore.state.inputValue:this.stores.iconInputStore.state.inputValue,a="emoji"===i.type?this.handleRandomEmojiClick:this.handleRandomIconClick,o=(0,v.jsx)(Bn,{tabs:this.props.tabs,currentTab:this.props.currentTab,hasRandomButtonOnLeft:!i.hideRandomButton});return(0,v.jsx)("div",{style:{display:"flex",...e?{}:{marginTop:16,marginBottom:10}},children:(0,v.jsx)(ne.ZP,{value:n,placeholder:V.default.formatMessage(Zn.filterPlaceholder),autoFocus:!t||void 0,focus:!t||void 0,showClearButton:!0,inputLeft:(0,v.jsx)(ne.f_,{icon:Ci.R}),onChange:this.handleFilterChange,right:(0,v.jsxs)("div",{style:{display:"flex"},children:[null!=i&&i.hideRandomButton?void 0:(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:X.Z.Placement.Bottom,render:e=>(0,v.jsx)(ne.DO,{icon:ki.I,onClick:a,...e})}),o]}),isRightLastElementOfInput:!0,style:{...s&&{borderBottom:"none"}}})})}}renderCurrentTab(){const e=this.props.tabs.find((e=>e.type===this.props.currentTab));if(!e)return(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(e.type){case"embed":return this.renderEmbedTab(e);case"file":return this.renderUploadTab(e);case"emoji":return this.renderEmojiTab(e);case"icon":return this.renderIconTab(e);case"gallery":return(0,v.jsx)(vn,{tab:e});case"unsplash":return(0,v.jsx)(_n,{tab:e,isSmallWidth:this.props.isSmallWidth});case"giphy":return(0,v.jsx)(Cn,{tab:e,isSmallWidth:this.props.isSmallWidth});case"drive":return this.renderGoogleDriveTab(e);case"box":return this.renderBoxTab(e);case"aiSourcePicker":return this.renderAiSourcePickerTab(e);case"custom":return this.renderCustomEmbedUploadTab(e)}}renderEmojiTab(e){return(0,v.jsx)(he,{onSubmit:e.onChange,filter:this.stores.emojiInputStore.state.inputValue||"",isCallout:this.props.isCallout,iconLoggingData:this.props.recordIconLoggingData,menuRef:this.menuRef})}renderIconTab(e){return(0,v.jsx)(Gi.ZP,{store:this.stores.iconPickerStore,filter:this.stores.iconInputStore.state.inputValue||"",onSubmit:e.onChange,iconLoggingData:this.props.recordIconLoggingData,enforceIconColor:e.enforceIconColor,menuRef:this.menuRef})}renderCustomEmbedUploadTab(e){const{device:t}=this.environment,{data:s}=cn.default.state,i=(0,v.jsx)(Oi.Z,{onClick:this.handleEmbedSubmit(e),disabled:0===this.stores.embedInputStore.state.inputValue.length,hovered:!1,children:e.buttonText||(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"})}),n=(0,v.jsx)(O.Z,{desktopStyle:{marginTop:16,display:"flex",paddingTop:0,paddingBottom:12},children:(0,v.jsx)(ne.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||V.default.formatMessage(Zn.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})},inputRight:t.isPhone?i:void 0,right:t.isPhone?void 0:i,isRightLastElementOfInput:!0})}),a=(0,v.jsx)(Ei.Q,{type:Rn(e)??nn.gU,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):Zi.oV({label:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,F.fn)([F.ZP.blueWithAlpha(.14),(0,Mi.Fq)(this.theme.contentBackground,.5)])},children:(0,v.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[e.fileUpload&&(0,v.jsx)(O.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24},children:(0,v.jsx)(Li.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>Dn(e),fullWidth:this.props.isSmallWidth})}),(0,v.jsx)(Ln,{isSmallWidth:this.props.isSmallWidth,tab:e}),e.caption&&(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||s&&un.YK(s)&&(0,v.jsx)("div",{style:{height:8}}),s&&!e.preventUploadLimitFreeFileSize&&!un.YK(s)&&(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"},children:[(0,v.jsx)("div",{style:{marginRight:6,color:this.theme.mediumTextColor},children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:Fi.K_}})}),!Ie.default.isOnboarding.state&&(0,v.jsx)(qi.Z,{subscriptionTier:un.M9(this.environment)||"plus",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})});return(0,v.jsxs)(v.Fragment,{children:[n,a]})}renderUploadTab(e){const{data:t}=cn.default.state;return(0,v.jsx)(Ei.Q,{type:Rn(e)??nn.gU,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):Zi.oV({label:(0,v.jsx)(d.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,F.fn)([F.ZP.blueWithAlpha(.14),(0,Mi.Fq)(this.theme.contentBackground,.5)])},children:(0,v.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[e.fileUpload&&(0,v.jsx)(O.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24},children:(0,v.jsx)(Li.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>Dn(e),fullWidth:this.props.isSmallWidth})}),(0,v.jsx)(Ln,{isSmallWidth:this.props.isSmallWidth,tab:e}),e.caption&&(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||t&&un.YK(t)&&(0,v.jsx)("div",{style:{height:8}}),t&&!e.preventUploadLimitFreeFileSize&&!un.YK(t)&&(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"},children:[(0,v.jsx)("div",{style:{marginRight:6,color:this.theme.mediumTextColor},children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:Fi.K_}})}),!Ie.default.isOnboarding.state&&(0,v.jsx)(qi.Z,{subscriptionTier:un.M9(this.environment)||"plus",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})})}renderEmbedTab(e){const{device:t}=this.environment;return(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)(O.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,v.jsx)(ne.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||V.default.formatMessage(Zn.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})}})}),(0,v.jsx)(O.Z,{children:(0,v.jsx)(Li.Z,{onClick:this.handleEmbedSubmit(e),title:e.buttonText||(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:this.props.isSmallWidth})}),e.caption&&(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:t.isMobile?"left":"center"}})]})}renderGoogleDriveTab(e){return"accounts"in e?this.renderGoogleDriveAccounts(e):(0,v.jsx)(Ki.Z,{request:this.environment,performRequest:Pi.vQ,render:(t,s,i)=>{if(!i)return(0,v.jsx)(O.Z,{children:(0,v.jsx)(tn.Z,{})});const n=s&&s.accounts?s.accounts:[];return this.renderGoogleDriveAccounts(e,n)}})}renderGoogleDriveAccounts(e,t){return"accounts"in e?e.accounts&&0===e.accounts.length?this.renderGoogleDriveConnectAccountOption(e):(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)(O.Z,{children:e.accounts.map(((t,s)=>(0,v.jsx)(at.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.account_name}}),onClick:()=>e.onSelect(t),focused:!1},t.account_key)))}),(0,v.jsx)(O.Z,{topBorder:!0,children:(0,v.jsx)(at.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})})]}):t?0===t.length?this.renderGoogleDriveConnectAccountOption(e):(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)(O.Z,{children:t.map(((t,s)=>(0,v.jsx)(at.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.accountName}}),onClick:()=>e.onSelect(t),focused:!1},t.accountId)))}),(0,v.jsx)(O.Z,{topBorder:!0,children:(0,v.jsx)(at.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})})]}):void 0}renderGoogleDriveConnectAccountOption(e){return(0,v.jsxs)(O.Z,{children:[(0,v.jsx)(at.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),(0,v.jsx)(B.Z,{shouldWrapCaption:!1,caption:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})})]})}renderAiSourcePickerTab(e){var t,s;return(0,v.jsxs)(i.Fragment,{children:[this.stores.aiSourcePickerStore.state.result&&!1===this.stores.aiSourcePickerStore.state.loading&&(0===(null===(t=this.stores.aiSourcePickerStore.state.result)||void 0===t?void 0:t.length)?(0,v.jsx)(B.Z,{shouldWrapCaption:!0,caption:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.aiSourcePicker.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):null===(s=this.stores.aiSourcePickerStore.state.result)||void 0===s?void 0:s.map((t=>(0,v.jsxs)("div",{style:{cursor:"pointer",color:this.theme.mediumTextColor,textAlign:"left",hyphens:"auto",padding:"10px 8px",backgroundColor:this.stores.aiSourcePickerStore.state.hover===t.url?"rgba(55,53,47,0.08)":"",display:"flex",flexDirection:"row"},onClick:this.handleAiSourcePickerSubmit(t.url,e),onMouseEnter:()=>{this.stores.aiSourcePickerStore.setState({...this.stores.aiSourcePickerStore.state,hover:t.url})},children:[(0,v.jsx)(Vi.Z,{imageURL:"NONE"===t.avatar?e.defaultAvatar:t.avatar,size:24,imageStyle:{borderRadius:34,boxShadow:"0 2px 4px rgba(15, 15, 15, 0.1)"},type:"image_url"}),(0,v.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"rgb(55, 53, 47)",fontWeight:500,fontSize:"14px",paddingLeft:8},children:t.title})]},t.url)))),this.stores.aiSourcePickerStore.state.loading&&(0,v.jsxs)("div",{style:{flex:1,color:this.theme.accentColors.purple[400],fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center",padding:"12px 12px",marginLeft:10},children:[(0,v.jsx)(d.FormattedMessage,{id:"aiSourcePicker.loadingMessage.fetching",defaultMessage:V.default.formatMessage(Zn.aiIsFetchingLoader)}),(0,v.jsx)(Ui.Z,{style:{backgroundColor:this.theme.accentColors.purple[400]}})]}),!this.stores.aiSourcePickerStore.state.result&&!this.stores.aiSourcePickerStore.state.loading&&(0,v.jsx)(Ni,{tab:e,placeholder:e.inputPlaceholder||V.default.formatMessage(Zn.aiSourcePickerPlaceholder),store:this.stores.aiSourcePickerStore,isSmallWidth:this.props.isSmallWidth})]})}renderBoxTab(e){const{accounts:t}=e;return 0===t.length?(0,v.jsxs)(O.Z,{children:[(0,v.jsx)(at.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Connect Box account",id:"mediaPicker.menuItem.connectFirstBoxAccount.label"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),(0,v.jsx)(B.Z,{shouldWrapCaption:!1,caption:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Find and embed your Box files.",id:"mediaPicker.menuItem.connectFirstBoxAccount.caption"})})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(O.Z,{children:t.map((t=>(0,v.jsx)(at.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.account_name}}),onClick:()=>e.onSelect(t),focused:!1},t.account_key)))}),(0,v.jsx)(O.Z,{topBorder:!0,children:(0,v.jsx)(at.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreBoxAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})})]})}getNumIconPerRow(){var e,t;return null!==(e=this.menuRef)&&void 0!==e&&null!==(e=e.current)&&void 0!==e&&e.offsetWidth?((null===(t=this.menuRef)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.offsetWidth)-24)/32:12}}Fn.displayName="MediaPicker";const An=Fn;function Rn(e){return e.fileUpload?nn.jo:e.imageUpload?nn.LR:e.videoUpload?nn.G7:void 0}async function Dn(e,t){const s=await Fi.y({multiple:!1,accept:t});s.length&&e.onUpload(s[0])}function Bn(e){let{hasRandomButtonOnLeft:t,tabs:s,currentTab:i}=e;const n=s.find((e=>e.type===i));if(!n)return null;let a;return"emoji"===(null==n?void 0:n.type)?a=(0,v.jsx)(oe,{}):"icon"===(null==n?void 0:n.type)&&void 0===n.enforceIconColor&&(a=(0,v.jsx)(Xi,{})),t&&a?(0,v.jsx)("div",{style:{marginLeft:6},children:a}):a??null}function Ln(e){let{tab:t,isSmallWidth:s}=e;return t.imageUpload||t.videoUpload?(0,v.jsxs)(O.Z,{desktopStyle:{marginTop:4,display:"flex",justifyContent:"center",marginRight:12,marginLeft:12},children:[t.imageUpload&&(0,v.jsx)(Wi.Z,{isLarge:!0,onClick:()=>Dn(t,"image/*"),style:{width:"100%"},children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Upload file",id:"mediaPicker.chooseImage.buttonText"})}),t.videoUpload&&(0,v.jsx)(Li.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),onClick:()=>Dn(t,"video/*"),fullWidth:s})]}):null}class Nn extends l.Z{constructor(){super(...arguments),this.handleCloseOverlay=()=>{bi.Z()}}renderComponent(){const{device:e}=this.environment,{state:t}=dn.Z;return(0,v.jsx)(m.ZP,{popupType:e.isMobile?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originRect:void 0,originGap:t.isActive?t.originGap:void 0,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Center,preventScaleTransition:!0,onDismiss:this.handleCloseOverlay,render:()=>{if(t.isActive)return(0,v.jsx)(J.Z,{capture:!0,onUp:M.yR,onDown:M.yR,children:(0,v.jsx)(An,{...t,onCancel:this.handleCloseOverlay})})}})}}Nn.displayName="MediaMenu";const On=Nn;var En=s(66897),Vn=s(15145),Un=s(41892),Wn=s(7057),Kn=s(53877),zn=s(84795),qn=s(33728),Gn=s(58573),Hn=s(42875),Qn=s(47612),Yn=s(9999),$n=s(82114),Jn=s(56666),Xn=s(6746),ea=s(92338),ta=s(44805),sa=s(7928),ia=s(67060),na=s(75018),aa=s(97444),oa=s(48141),ra=s(83089),la=s(7314),da=s(13394),ca=s(18245),ua=s(14568),ma=s(77080),pa=s(63334),ga=s(55899),ha=s(84166),fa=s(19111),ya=s(69454),xa=s(72087),va=s(43765),Sa=s(82990);const ba={...Sa.Z.textOverflowStyle,fontWeight:Sa.Z.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function Ma(e){const{pageTitle:t}=e;return t?(0,v.jsx)(d.FormattedMessage,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,v.jsx)("span",{style:ba,children:t})}}):(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function ja(e){const{pageTitle:t}=e;return t?(0,v.jsx)(d.FormattedMessage,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,v.jsx)("span",{style:ba,children:t})}}):(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var wa=s(85215),Ca=s(60442),ka=s(97680);function Ta(e){window.__c={n:"SvgWorkaroundForChromiumBug"};const{svg:t,viewBox:s,fill:n}=e,a=(0,i.useMemo)((()=>{const e=Xn.Z.renderToString((0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:s,children:t}));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,s]);return(0,v.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:n,WebkitMaskImage:a,maskImage:a}})}const Ia=(0,d.defineMessages)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"},addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}}),Pa=(0,d.defineMessages)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"},noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"},groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});class _a extends l.Z{constructor(){super(...arguments),this.storeTypes={ignoreSelectionAreaStore:pa.Z,localPageMentionRequestStore:xa.Z,localCachePageMentionRequestStore:xa.Z,inviteTargetsStore:ga.ZP,personPropertyInviteStore:da.Z},this.renderMentionResult=(e,t)=>{const{intl:s}=this.props,i=fa.Z.state,n=i.open&&i.insertionType,a=this.shouldPrioritizeUserSection(t),o={sections:[],nextSectionShouldHaveTopBorder:()=>o.sections.length>0,addSection(e){e&&this.sections.push(e)}};"+"===n&&o.addSection(this.getCreatePageMenuSection(o.nextSectionShouldHaveTopBorder())),o.addSection(this.getDateResultsMenuSection(t,o.nextSectionShouldHaveTopBorder())),a&&o.addSection(this.getUserResultsMenuSection(t,o.nextSectionShouldHaveTopBorder())),o.addSection(this.getGroupResultsMenuSection(t,o.nextSectionShouldHaveTopBorder(),this.props.intl)),o.addSection(this.getPageResultsMenuSection(t,o.nextSectionShouldHaveTopBorder())),a||o.addSection(this.getUserResultsMenuSection(t,o.nextSectionShouldHaveTopBorder())),("@"===n&&this.filterStore.state||"[["===n)&&o.addSection(this.getCreatePageMenuSection(o.nextSectionShouldHaveTopBorder()));const{sections:r}=o;let l,c;if(si.Z.state.online){const e=i.mentionTypes.user,t=i.mentionTypes.page,n=i.mentionTypes.date;let a="";const o=Ia;e&&t&&n?a=s.formatMessage(o.mentionAll):e&&t?a=s.formatMessage(o.mentionPersonPage):e&&n?a=s.formatMessage(o.mentionPersonDate):t&&n?a=s.formatMessage(o.mentionPageDate):e?a=s.formatMessage(o.mentionPerson):n?a=s.formatMessage(o.mentionDate):t&&i&&(a=i.open&&"+"===i.insertionType?s.formatMessage(Ia.addPage):s.formatMessage(o.mentionPage)),this.setTemporaryInputData({title:a,icon:this.renderTemporaryInputEmptyIcon(),allowTabCompletion:!1}),l=void 0}else l=(0,v.jsx)(va.Z,{title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})});0===r.length&&(c=(0,v.jsx)(O.Z,{children:(0,v.jsx)(va.Z,{title:(0,v.jsx)(d.FormattedMessage,{...Pa.noResults})})}));const{device:m}=this.environment;let p;return p=Ba(this.environment)?{menuType:g.og.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${ya.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:g.og.Popup,width:Ra(),maxHeight:m.isMobile?"30vh":"40vh",onClickOutside:this.makeHandleCancelCallback()},(0,v.jsxs)(u.Z,{...p,header:l,children:[(0,v.jsx)(J.Z,{capture:fa.Z.state.open,onBackspace:this.shouldCaptureBackspace()?this.handleEmptyBackspace:void 0,onTab:this.handleTab}),(0,v.jsx)(L.Z,{type:L.i.Vertical,initialFocus:this.getMenuInitialFocus(),sections:r,onEmptyEnter:this.makeHandleCancelCallback(),resetInitialFocusOnSectionChange:!0}),c]})},this.handleCreateInAutocompleteQueryChange=e=>{Fa({createInQuery:e})},this.renderCreateInMenu=()=>{const e=fa.Z.state;if(!e.open)return;const t="block"===e.textStore.table?e.textStore.id:void 0;return(0,v.jsx)(ui.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{ia.Br({environment:this.environment,titleText:this.getNormalizedFilter(),ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,createInValue:e,menuListItemAction:void 0})},captureSelection:!0,restoreSelection:!0,parentBlockId:t,onAutocompleteQueryChange:this.handleCreateInAutocompleteQueryChange,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,autocompleteQuery:e.createInQuery,desktopWidth:Ra(),onCancel:this.handleCreateInCancel})},this.renderInviteMenu=()=>{const e=St.np();if(e)return(0,v.jsx)(la.Z,{inviteOrigin:Aa(),store:e,onInviteCompleteFn:e=>{if(!e.success)return void this.handleInviteCancel();const{invitedUsers:t,requestedUsers:s}=e,i=M.zo(Object.values(t),Object.values(s));i.length?k.createAndCommit({userAction:"MentionMenu.inviteMenu",environment:this.environment,perform:e=>{ia.RL({environment:this.environment,annotations:i.map((e=>(0,j.tEo)(e))),transaction:e,menuListItemAction:void 0,query:this.getNormalizedFilter(),mentionType:"user"})}}):this.handleInviteCancel()},handleBackButtonClick:this.handleInviteCancel,inviteTargetsStore:this.stores.inviteTargetsStore,personPropertyInviteStore:this.stores.personPropertyInviteStore})},this.handleCreateInStart=()=>{Fa({showCreateIn:!0})},this.handleCreateInCancel=()=>{Fa({showCreateIn:!1,createInQuery:""})},this.handleInviteStart=()=>{const e=fa.Z.state;this.stores.inviteTargetsStore.reset(),this.stores.personPropertyInviteStore.reset(),e.open&&(this.stores.inviteTargetsStore.setState({...this.stores.inviteTargetsStore.state,tokenQuery:this.getNormalizedFilter()}),this.stores.personPropertyInviteStore.setState({...this.stores.personPropertyInviteStore.state,flowId:e.flowId}),w.P0l(this.environment,{origin:Aa(),invite_flow_id:e.flowId}),Fa({showInvite:!0}))},this.handleInviteCancel=()=>{const e=fa.Z.state;e.open&&(w.Zvm(this.environment,{origin:Aa(),invite_flow_id:e.flowId}),this.stores.inviteTargetsStore.setState({tokenQuery:"",inviteTargets:[]}),this.stores.personPropertyInviteStore.setState({...this.stores.personPropertyInviteStore.state,emailMessage:""}),Fa({showInvite:!1}))},this.handleEmptyBackspace=e=>{this.shouldCaptureBackspace()&&e.preventDefault(),this.makeHandleCancelCallback()()},this.makeHandleCancelCallback=()=>{const e=fa.Z.state,t=this.getNormalizedFilter(),s=ia.WI();let i,n=Date.now();return e.open&&(n=e.openTime,i=e.flowId),()=>{w.ewV(this.environment,{timeToAbandonInMs:Date.now()-n,queryLength:t.length,analyticsFrom:s,flowId:i}),e.open&&e.showInvite&&w.Zvm(this.environment,{origin:Aa(),invite_flow_id:e.flowId}),ia.xv()}},this.handleTab=e=>{e.preventDefault();const t=this.tabCompletionString;if(!t)return;const s=P.default.state;if("editing"!==s.mode)return;const i=(0,T.QY)(s.multiSelection);if(!i)return;const n=fa.Z.state;n.open&&n.textStore===i.store&&k.createAndCommit({userAction:"MentionMenu.handleTab",environment:this.environment,perform:e=>{aa.hJ({environment:this.environment,transaction:e,string:t,store:i.store,selection:i.selection,disableMentions:!0,disableDateMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0})}})},this.tabCompletionString=void 0,this.inputSelectionsStore=this.createComputedStore((()=>{const e=fa.Z.state;if(e.open)return I.O2(e.textStore,e.oldTextValue,e.isEmptyPageTitle?"":e.insertionType)})),this.filterStore=this.createComputedStore((()=>{const e=this.inputSelectionsStore.state,t=fa.Z.state;if(e&&t.open)return I.ug(t.textStore,e)})),this.popupOpenStore=this.createComputedStore((()=>{const e=fa.Z.state;return!!e.open&&("+"!==e.insertionType||""!==this.getNormalizedFilter())})),this.performUserMentionRequest=async e=>{const t=fa.Z.state;if(!t.open)return;const s=t.mentionTypes.user?await this.getUserResults(e):[];return""===e?s.slice(0,2):s.slice(0,20)},this.performLocalCachePageMentionRequest=async()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=ae.default.state;if(!e)return;return"on"===ma.default.getEligibleGroup({experimentId:"use_global_local_search_cache"})?ha.Z.state.localSearchableBlocksCache:oa.hb({environment:this.environment,currentSpaceStore:e,currentSpaceViewStore:t})},this.performLocalPageMentionRequest=async e=>{const{localCachePageMentionRequestStore:t}=this.stores,s=t.state.result;if(!s)return;const i=St.RM();return i&&this.getNormalizedFilter()?Promise.resolve(oa.Y_({query:e,localCachedPages:s,parentStore:i,isOnline:si.Z.state.online,environment:this.environment,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0,canUseLtr:!1})):void 0},this.performServerPageMentionRequest=async e=>{const t=fa.Z.state;return t.open&&this.getNormalizedFilter()&&t.mentionTypes.page?await this.getPageResults(e):[]},this.getUserResults=async e=>{if(si.Z.state.online){return await ai.Yu({environment:this.environment,query:e,membersOnly:!1})}return[]},this.getGroupResults=e=>{var t;if(!fa.Z.state.open)return[];const s=(null===(t=ae.default.state.currentSpaceStore)||void 0===t?void 0:t.getPermissionGroups())||[];return(0,Gn.ZP)(e,s,(e=>e.name||""))},this.getPageResults=async e=>{if(!si.Z.state.online)return[];const t=fa.Z.state,s=t.open&&(0,Ke.OY)(t.textStore)&&t.textStore;return await ai.WL({nearBlock:s||void 0,environment:this.environment,query:e,source:"mention_menu",limit:20})},this.getDateResults=e=>{const t=fa.Z.state;if(!t.open)return[];const{intl:s}=this.props,i=t.mentionTypes.reminder;return t.mentionTypes.date?function(e,t,s){if(0===e.length)return M.oA([{label:s.formatMessage(Pa.autocompleteToday),value:()=>Kn.Lg((0,Hn.r)())},t?void 0:{label:s.formatMessage(Pa.autocompleteNextTuesday),value:()=>{const e=Kn.Uu((0,Hn.r)()),t=e.set({weekday:2,hour:15}),s=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:s.toFormat(Kn.Iq),start_time:s.toFormat(yt.jK),time_zone:(0,Hn.r)()}}},t?{label:s.formatMessage(Pa.autocompleteReminder),value:()=>({type:"datetime",start_date:Kn.Ro((0,Hn.r)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:yt.HZ,defaultTimeZone:(0,Hn.r)()},time_zone:(0,Hn.r)()})}:void 0]);const i=e.normalize("NFKD"),n=t?zn.parsePersistedDateWithOptionalReminder(i,s):zn.parsePersistedDate(i,s);if(n){let e=(0,Wn.ZV)({value:n,date_format:"relative",userTimeZone:(0,Hn.r)(),intl:s,allowRelativeDates:!0});return n.reminder&&(e=s.formatMessage(Pa.reminder,{dateTime:e})),[{label:e,value:()=>n}]}return[]}(e,i,s).slice(0,6):[]},this.getTemplateVariableResults=e=>{const t=fa.Z.state;if(!t.open)return[];if(!t.mentionTypes.templateVariable)return[];const{intl:s}=this.props;return j.XVI(e,s)}}willMountOrUpdate(){const e=fa.Z.state,t=this.filterStore.state;if(e.open){var s;const i=P.default.state,n="editing"===i.mode?(0,T.QY)(i.multiSelection):void 0,a=(null==n?void 0:n.store)===e.textStore,o=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,r=o&&"editing"===o.mode&&(null===(s=(0,T.QY)(o.multiSelection))||void 0===s?void 0:s.store)===e.textStore;if(!a&&!r)return void ia.xv();const l=a&&(null==n?void 0:n.selection),d=this.inputSelectionsStore.state;if(d&&l&&(l.startIndex<d.filter.startIndex||l.endIndex>d.filter.endIndex))return void ia.xv();const c=this.filterStore.state&&this.filterStore.state[0];if("+"===e.insertionType&&c&&!c.match(ra.Ff))return void ia.xv();if(void 0===t&&!e.isEmptyPageTitle)return void ia.xv()}}renderComponent(){const{device:e}=this.environment,t=fa.Z.state,s=ua.Z.find((e=>e.props.capture)),i=this.popupOpenStore.state;let n;if(s&&e.isMobile){var a;const e=null===(a=s.stores.store.state.node)||void 0===a?void 0:a.getBoundingClientRect();e&&(n={height:`calc(100vh - ${e.height}px)`})}const o=t.open&&t.showCreateIn,r=t.open&&t.showInvite;return(0,v.jsx)(m.ZP,{popupType:Ba(this.environment)?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:i,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:n,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Start,originGap:8,disableMouseCapture:!r,disableContentScroll:!0,onDismiss:this.makeHandleCancelCallback(),disableDarkOverlayBackground:e.isMobile,keepFocus:!0,render:()=>e.isMobile?(0,v.jsxs)(v.Fragment,{children:[this.renderMentionSearch(),(0,v.jsx)(m.ZP,{popupType:m.ZP.PopupType.SlideUp,render:this.renderCreateInMenu,open:o,keepFocus:!0}),(0,v.jsx)(m.ZP,{popupType:m.ZP.PopupType.SlideUp,render:this.renderInviteMenu,open:r,keepFocus:!0})]}):o?this.renderCreateInMenu():r?this.renderInviteMenu():this.renderMentionSearch()})}renderMentionSearch(){const e=this.getNormalizedFilter(),t=fa.Z.state,s=ca.default.mark("rum.mention_menu_ready"),i={field:"relevance"};return(0,v.jsx)(Ki.Z,{requestStore:t.userRequestStore,request:e,performRequest:this.performUserMentionRequest,render:n=>(0,v.jsx)(Ki.Z,{requestStore:t.pageRequestStore,request:e,performRequest:this.performServerPageMentionRequest,debounce:ai.vp,render:t=>(0,v.jsx)(Ki.Z,{requestStore:this.stores.localCachePageMentionRequestStore,request:ae.default.state.currentSpaceStore&&ae.default.state.currentSpaceStore.id,performRequest:this.performLocalCachePageMentionRequest,render:a=>(0,v.jsx)(Ki.Z,{requestStore:this.stores.localPageMentionRequestStore,debounce:ai.E5,request:{query:{text:e,filters:ea.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,requireEditPermissions:void 0}),sort:i},limit:5},performRequest:this.performLocalPageMentionRequest,render:e=>this.renderMentionResult(n||t||e,this.getCurrentMentionResults(s))})})})})}getDateResultsMenuSection(e,t){const{dateResults:s}=e,{intl:i}=this.props,n=this.getNormalizedFilter(),a=this.getTemplateVariableMenuItems(e,"date");if(0===s.length&&0===a.length)return;const o=s.map((e=>{let{label:t,value:s}=e;return{key:t,render:e=>{if(e.focused&&this.setTemporaryInputData({title:t,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),zn.parseRelativeDate(t,i)){const n=(0,Wn.ZV)({value:s(),userTimeZone:(0,Hn.r)(),intl:i,allowRelativeDates:!1});return(0,v.jsx)(at.Z,{...e,title:t,caption:n,inline:!0})}return(0,v.jsx)(at.Z,{...e,title:t})},action:e=>{k.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:t=>{ia.RL({environment:this.environment,annotations:[["d",{...s(),date_format:"relative"}]],transaction:t,menuListItemAction:e,query:n,mentionType:"date"})}})}}}));return this.applySectionLimit("date",{key:"date results",render:e=>(0,v.jsx)(O.Z,{...e,title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:t,isTitleUppercase:!0}),items:a.concat(o)})}getTemplateVariableMenuItems(e,t){const{templateVariableResults:s}=e,{intl:i}=this.props,n=this.getNormalizedFilter();return s.filter((e=>j.i6A(e,t))).map((e=>({key:e,render:t=>{const s=j.U$y(e,i),n=j.Z08(e,i);return t.focused&&this.setTemporaryInputData({title:s,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),(0,v.jsx)(at.Z,{...t,title:s,caption:n,inline:!0})},action:t=>{k.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:s=>{ia.RL({environment:this.environment,annotations:[j.WBu({type:e})],transaction:s,menuListItemAction:t,query:n,mentionType:"templateVariable"})}})}})))}renderTemporaryInputEmptyIcon(){const e=fa.Z.state;if(e.open)return"+"===e.insertionType?this.renderTemporaryInputAddIcon():(0,v.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,v.jsx)(Ta,{svg:Ci.T,viewBox:Ci.R.__iconViewBox,fill:this.theme.mediumIconColor})})}renderTemporaryInputAddIcon(){return(0,v.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,v.jsx)(Ta,{svg:qt.s,viewBox:qt.R.__iconViewBox,fill:this.theme.mediumIconColor})})}renderTemporaryInputPageIcon(e){return(0,ta.tp)({pageModel:e.getModel(),pageRole:e.getRole(),showEmojiInline:!0,emojiType:(0,W.e_)(this.environment),baseUrl:_t.default.domainBaseUrl,getRecordModel:e.getRecordModel,isClient:!0,isSafariOrIOS:this.environment.device.isSafari||this.environment.device.isIOS,currentUserId:this.environment.currentUser.id,theme:this.theme,emojiData:K.Z.state})}renderTemporaryInputAtMentionIcon(){return(0,v.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,v.jsx)(Ta,{svg:$n.Q,viewBox:$n.p.__iconViewBox,fill:this.theme.mediumIconColor})})}getUserResultsMenuSection(e,t){var s;const{userResults:i}=e,n=this.getNormalizedFilter(),a=ma.default.checkGate("inline_mention_invites"),o=this.getTemplateVariableMenuItems(e,"user"),r=i.find((e=>e.email===n)),l=a&&!r&&(0,Ce.bq)()&&(null===(s=St.np())||void 0===s?void 0:s.canEditMembership())&&!this.environment.device.isMobile&&fa.Z.state.mentionTypes.user;if(!l&&0===i.length&&0===o.length)return;const c=M.oA(i.map((e=>({key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:(0,sa.Nz)(this.props.intl,e),icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),(0,v.jsx)(ka.Z,{...t,actor:(0,En.dp)(e),useEmailAsTooltip:!0})),action:t=>{k.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:s=>{ia.RL({environment:this.environment,annotations:[(0,j.tEo)(e.id)],transaction:s,menuListItemAction:t,query:n,mentionType:"user"})}})}})))).concat(l?[{key:"__invite",action:this.handleInviteStart,render:e=>(e.focused&&this.setTemporaryInputData({title:"",icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!1}),(0,v.jsx)(at.Z,{...e,icon:(0,Qn.C)({width:20}),title:n.length>0?(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Invite ”{query}”…",id:"mentionMenu.peopleSection.invitePrompt",values:{query:n}}):(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Invite…",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[]);return this.applySectionLimit("user",{key:"user results",render:e=>(0,v.jsx)(O.Z,{...e,title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t,isTitleUppercase:!0}),items:o.concat(c)})}shouldPrioritizeUserSection(e){const{userResults:t}=e,s=this.getNormalizedFilter(),i=this.getTemplateVariableMenuItems(e,"user");return""===s||(t.length>0&&i.length>0||!!(0,qn.BZ)(s))}getGroupResultsMenuSection(e,t,s){const{groupResults:i}=e;if(0===i.length)return;const n=this.getNormalizedFilter(),a=M.oA(i.map((e=>{var t;const i=s.formatMessage(Pa.groupMentionCaption,{numMembersInGroup:(null===(t=e.user_ids)||void 0===t?void 0:t.length)||0});return{key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:e.name||"",icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),(0,v.jsx)(wa.l,{menuListItemProps:{...t,caption:i},group:e})),action:t=>{var s;const i=null===(s=ae.default.state.currentSpaceStore)||void 0===s?void 0:s.id;i&&k.createAndCommit({userAction:"MentionMenu.groupMention",environment:this.environment,perform:s=>{ia.RL({environment:this.environment,annotations:[j.XIB(e.id,i)],transaction:s,menuListItemAction:t,query:n,mentionType:"group"})}})}}})));return this.applySectionLimit("group",{key:"group results",render:e=>(0,v.jsx)(O.Z,{...e,title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),topBorder:t,isTitleUppercase:!0}),items:a})}getPageResultsMenuSection(e,t){const{pageResults:s}=e,i=this.getNormalizedFilter(),n=(0,v.jsxs)(v.Fragment,{children:[0===s.length?(0,v.jsx)(d.FormattedMessage,{...Pa.noResults}):(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}),(0,v.jsx)(Da,{show:fa.Z.state.pageRequestStore.state.loading})]});return 0===s.length?{key:"no page results",render:e=>(0,v.jsx)(O.Z,{...e,title:n,topBorder:t,isTitleUppercase:!0}),items:[]}:this.applySectionLimit("page",{key:"page results",render:e=>(0,v.jsx)(O.Z,{...e,title:n,topBorder:t,isTitleUppercase:!0}),items:M.oA(s.map((e=>{const t=St.RF();if(!t)return;const s=Ft.G.createChildStore(t,{table:Tt.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=s.getModel();if(e){const t=e.getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,Hn.r)(),intl:this.props.intl});this.setTemporaryInputData({title:t||"",icon:this.renderTemporaryInputPageIcon(s),allowTabCompletion:!0})}}return(0,v.jsx)(oi.Z,{...e,store:s})},action:t=>{k.createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:this.environment,perform:s=>{ia.RL({environment:this.environment,annotations:[["p",e]],transaction:s,menuListItemAction:t,query:i,mentionType:"page"})}})}}})))})}getCreatePageMenuSection(e){if(!function(){if(!fa.Z.state.mentionTypes.createPage)return!1;return!0}())return;const t=fa.Z.state;if(!t.open)return;const{intl:s}=this.props,i=this.getNormalizedFilter(),n="@"===t.insertionType?(0,v.jsx)(d.FormattedMessage,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:t=>(0,v.jsx)(O.Z,{title:n,isTitleUppercase:!0,...t,topBorder:e}),items:[{key:"add new subpage",action:async e=>{const s=Ns.gt(t.textStore);s&&await ia.Br({environment:this.environment,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,titleText:this.getNormalizedFilter(),createInValue:s.createInValue,onPageCreated:e=>{e&&""===j.QaF(e.getTitleValue())&&na.navigateToBlock({environment:this.environment,store:e,pageVisitSource:Vn.tY.Create})},menuListItemAction:e})},render:e=>{e.focused&&this.setTemporaryInputData({title:0===i.length?s.formatMessage(Ia.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=t=>(0,v.jsx)(at.Z,{...(0,ee.Z)(t||{},e),icon:(0,qt.R)({width:16}),title:(0,v.jsx)(ja,{pageTitle:this.getNormalizedFilter()})});return this.environment.device.isMobile?t():(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(Ca.Z,{imageURL:Un.Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,v.jsx)(d.FormattedMessage,{...ui.s.createSubpage})}),placement:X.Z.Placement.Right,delayThreshold:0,render:e=>t(e)})}},{key:"open create in menu",action:this.handleCreateInStart,render:e=>{e.focused&&this.setTemporaryInputData({title:0===i.length?s.formatMessage(Ia.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=(0,v.jsx)(Ma,{pageTitle:this.getNormalizedFilter()}),n=s=>(0,v.jsx)(at.Z,{...(0,ee.Z)(s||{},e),icon:(0,Yn.J)({width:16}),title:t});return this.environment.device.isMobile?n():(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsx)(Ca.Z,{imageURL:Un.Z.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,v.jsx)(d.FormattedMessage,{...ui.s.newPageIn})}),placement:X.Z.Placement.Right,delayThreshold:0,render:e=>n(e)})}}]}}applySectionLimit(e,t){const s=fa.Z.state;if(!s.open)return t;if(s.expandSection&&s.expandSection===e)return t;const{items:i}=t,n=this.environment.device.isPhone?3:5;if(i.length<=n)return t;const a=[...i.slice(0,n),{key:"show more",render:e=>(0,v.jsx)(at.Z,{...e,icon:(0,Jn.o)({width:16,fill:this.theme.mediumTextColor}),title:(0,v.jsx)("span",{style:{color:this.theme.mediumTextColor},children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:i.length-n}})})}),action:()=>{Fa({expandSection:e})}}];return{...t,items:a}}getNormalizedFilter(){const e=this.filterStore.state;return e?fa.Z.state.open&&"@"===fa.Z.state.insertionType&&this.environment.device.isAndroid&&e.startsWith("@")?e.slice(1).trim():fa.Z.state.open&&"[["===fa.Z.state.insertionType&&e.endsWith("]]")?e.slice(0,-2).trim():e.trim():""}setTemporaryInputData(e){const t=fa.Z.state;if(!t.open)return;if(!e)return void t.temporaryInputData.setState(void 0);const{device:s}=this.environment,{title:i,icon:n,allowTabCompletion:a}=e,o=this.filterStore.state||"",r=i.toLowerCase().startsWith(o)?i.slice(o.length):"";this.tabCompletionString=a?r:void 0;const l=s.isFirefox?void 0:n;t.temporaryInputData.setState({prefix:t.insertionType,suffix:"[["===t.insertionType&&o.endsWith("]]")?"]]":"",completion:r,prefixIcon:l})}getCurrentMentionResults(e){const t=fa.Z.state,s=t.userRequestStore.state.result||[],i=t.pageRequestStore.state.result||[],n=this.getDateResults(this.getNormalizedFilter()),a=this.getTemplateVariableResults(this.getNormalizedFilter()),o=t.mentionTypes.group?this.getGroupResults(this.getNormalizedFilter()):[];let r=i;const{result:l}=this.stores.localPageMentionRequestStore.state;if(l&&!l.error){const e=l.value.results,t=St.RM();r=t?oa.oO({localResults:e,serverResults:i.map(((e,s)=>({...e,serverEventProperties:void 0,originalPosition:s,store:Ft.G.createChildStore(t,{table:Tt.iU,id:e.id})})))})||[]:e}let d;d=this.getNormalizedFilter()?r.map((e=>e.id)):ri.X4.state.map((e=>e.pageId));const c=t.userRequestStore.state.ready&&t.pageRequestStore.state.ready;return c&&ca.default.measure(e,{environment:this.environment}),{userResults:s,groupResults:o,pageResults:d,dateResults:n,templateVariableResults:a,ready:c}}shouldCaptureBackspace(){return""===this.filterStore.state}getMenuInitialFocus(){if(""!==this.getNormalizedFilter())return 0}}_a.displayName="MentionMenu";const Za=(0,d.injectIntl)(_a);function Fa(e){const t=fa.Z.state;t.open&&fa.Z.setState({...t,...e})}function Aa(){return"comment"===ia.WI()?"comment_mention":"inline_mention"}function Ra(){return(0,Ce.bq)()?400:330}function Da(e){let{show:t}=e;return(0,v.jsx)(Rs.Z,{show:t,showDelay:500,showHold:300,render:e=>(0,v.jsx)(ts.Z,{style:{textAlign:"center",visibility:e?"visible":"hidden",display:"inline",marginLeft:8}})})}function Ba(e){const{device:t}=e;return t.isMobileNative&&!t.isTablet}var La=s(42239);class Na extends l.Z{constructor(){super(...arguments),this.cancelDragTimeout=void 0,this.handleDragOver=e=>{e.preventDefault(),this.startDrag(e),this.continueDragThrottled(e)},this.handleDrop=e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files);t.length>0&&k.createAndCommit({userAction:"NativeDragHandler.handleDrop",environment:this.environment,perform:e=>{La._4({environment:this.environment,files:t,analyticsFrom:"native_drag",transaction:e})}})},this.startDrag=e=>{La.f$(this.environment,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0})&&Yt.ZH(this.environment)},this.continueDrag=e=>{this.cancelDragTimeout&&window.clearTimeout(this.cancelDragTimeout),this.cancelDragTimeout=window.setTimeout(this.cancelDrag,function(e){const{device:t}=e;return t.isLinux?2e3:200}(this.environment)),La.td(this.environment,{currentX:e.clientX,currentY:e.clientY})},this.continueDragThrottled=M.P2(this.continueDrag,Na.dragOverThrottleMS),this.cancelDrag=()=>{La.cQ(this.environment)}}didMount(){super.didMount(),window.addEventListener("dragover",this.handleDragOver),window.addEventListener("drop",this.handleDrop)}willUnmount(){super.willUnmount(),window.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("drop",this.handleDrop)}}Na.displayName="NativeDragHandler",Na.dragOverThrottleMS=62.5;const Oa=Na;var Ea=s(40902),Va=s(65311),Ua=s(19719),Wa=s(50770),Ka=s(19034),za=s(12252);class qa extends l.Z{constructor(){super(...arguments),this.lastEmitValue=-1,this.lastSentBadgeNumber=void 0,this.lastSentCurrentSpaceBadgeNumber=void 0,this.handleNotificationEmit=async(e,t)=>{if(t===this.lastEmitValue)return;if(this.lastEmitValue=t,!function(e){if(0===Ka.Z.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(t)))return;const s=(0,Wa.H)(),i=await Sn.getUserNotifications(this.environment,{size:1e3,isInboxV2:s});if("failed"===i.type)return;const{results:n}=i.data;Ka.Z.setState({results:n}),this.syncInitialBadgeNumber();const a=M.G0.apply(null,n.map((e=>e.unreceived.notificationIds)));for(const o of a)Qa(o,this.props.rootStore,this.props.intl,this.environment)},this.handleNotificationEmitThrottled=M.P2(this.handleNotificationEmit,1e3),this.handleNotificationEmitWhenActive=(e,t)=>{za.Z.whenActive((()=>{this.handleNotificationEmitThrottled(e,t)}))},this.listenerReference=void 0,this.updateBadgeNumbers=()=>{const{mobileNative:e}=this.environment,{allSpaces:t,currentSpace:s}=Ha();e&&(t===this.lastSentBadgeNumber&&s===this.lastSentCurrentSpaceBadgeNumber||e.setBadgeNumber(t,s),this.lastSentCurrentSpaceBadgeNumber=s),t!==this.lastSentBadgeNumber&&(t>0?o.setBadge(`${t}`):o.setBadge("")),this.lastSentBadgeNumber=t},this.syncInitialBadgeNumber=M.IH(this.updateBadgeNumbers)}willMount(){this.startMessageListeners(),Ka.Z.addListener(this.updateBadgeNumbers),this.environment.mobileNative&&ae.default.addListener(this.updateBadgeNumbers)}didUpdate(e){e.rootStore.userId!==this.props.rootStore.userId&&(this.stopMessageListeners(),this.startMessageListeners(),this.handleNotificationEmit("initializeListener",-1))}willUnmount(){this.stopMessageListeners(),Ka.Z.removeListener(this.updateBadgeNumbers),this.environment.mobileNative&&ae.default.removeListener(this.updateBadgeNumbers)}startMessageListeners(){const{currentUserStore:e}=ae.default.state;if(e){const t=(0,Ae.Lp)(e.id);this.listenerReference=Re.Z.addListener(t,this.handleNotificationEmitWhenActive,void 0,this.environment)}}stopMessageListeners(){this.listenerReference&&Re.Z.removeListener(this.listenerReference,this.environment)}}qa.displayName="NotificationListener";const Ga=(0,d.injectIntl)(qa);function Ha(){return{allSpaces:Ka.Z.getTotalUnreadMentionsCount(),currentSpace:Ka.Z.getUnreadCountForCurrentSpace().mentions}}async function Qa(e,t,s,i){const n=(0,Ft.Kv)(t,{table:Va.uX,id:e});await n.load();const a=n.getValue();if(!a)return;const r=(0,Ke.No)(n,a.activity_id,a.space_id);await r.load();const l=r.getModel(),{currentUserStore:d,currentSpaceViewStore:c}=ae.default.state;if(d&&c&&l&&!l.invalid&&!Ea.BX(l,d.id)&&await o.isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await c.load(),!c.isDefined())return;if(!l.isMentionType())return;if(!c.getNotifyDesktop())return;if(!i.device.isDesktop)return;const e=(0,(await h.deps.desktop.loader()).Notification)({activity:l,getRecordValue:n.getRecordValue,userTimeZone:(0,Hn.r)(),intl:s,pageVisitSource:Vn.tY.PushNotification});if(!e)return;const{subject:t,body:a}=e,o=new Notification(t,{body:a,silent:!0}),d=Ea.Fb(l.type),u={medium:"desktop_push",type:d,badge_number:Ha().allSpaces,notification_id:n.id,activity_id:r.id},m=e=>Ua.b2({environment:i,args:u,action:e});m("sent"),o.addEventListener("show",(()=>m("shown"))),o.addEventListener("close",(()=>m("closed"))),o.addEventListener("click",(()=>{const e=Ea.hY({activity:l,getRecordModel:n.getRecordModel,baseUrl:_t.default.domainBaseUrl,pageVisitSource:Vn.tY.PushNotification}),t=(0,Vn.k6)(e,[d,"desktop_push"],Vn.tY.PushNotification);na.navigate({environment:i,url:t}),m("clicked")}))}}var Ya=s(35683),$a=s(89224),Ja=s(58261);class Xa extends l.Z{constructor(){super(...arguments),this.renderTooltip=()=>(0,v.jsx)(J.Z,{capture:!0,onEnter:this.handleEnter,onCommandEnter:this.handleCommandEnter,children:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,v.jsx)("div",{children:(0,v.jsx)(Ja.Z,{onlyShowFirst:!0,name:"enter",style:{color:this.theme.mediumInvertedTextColor}})})]})}),this.handleEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:s,store:i}=t;if(!s)return;e.preventDefault&&e.preventDefault();const n=Ft.G.createChildStore(i,{table:Tt.iU,id:s});na.navigateToBlock({store:n,environment:this.environment,visitType:Ya.vu.Link,pageVisitSource:Vn.tY.MentionInPage})},this.handleCommandEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:s,store:i}=t;if(!s)return;e.preventDefault();const n=Ft.G.createChildStore(i,{table:Tt.iU,id:s});na.navigateToBlock({store:n,environment:this.environment,visitType:Ya.vu.Link,openInNew:"tab",pageVisitSource:Vn.tY.MentionInPage})},this.pageMentionTokenStore=this.createComputedStore((()=>{const e=P.default.state;if("editing"!==e.mode)return;const t=(0,T.QY)(e.multiSelection);if(!t)return;const{store:s,selection:i}=t;if(i.endIndex!==i.startIndex+1)return;const n=s.getValue(),a=j.b1T(n,i.startIndex);if(!a||!j.eOb(a))return;const[o]=j.jDe([a]);return{pageId:o,store:s}}))}renderComponent(){if(this.environment.device.isMobile)return;const e=$a.getSelectionRect(),t=this.pageMentionTokenStore.state;return(0,v.jsx)(X.Z,{render:()=>{},renderTooltip:this.renderTooltip,originRect:e,forceVisibleState:Boolean(t&&e),placement:X.Z.Placement.Bottom})}}Xa.displayName="PageMentionOverlay";const eo=Xa;var to=s(43008),so=s(98104),io=s(64951);class no extends l.Z{constructor(){super(...arguments),this.renderPopupContent=()=>(0,v.jsx)(oo,{})}renderComponent(){const{device:e}=this.environment,{blockStore:t,originRect:s}=io.Z.state;return(0,v.jsx)(m.ZP,{popupType:e.isMobile?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:Boolean(t),originRect:s,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Center,originGap:4,onDismiss:()=>to.x(this.environment),render:this.renderPopupContent})}}no.displayName="RenameFileMenuPopup";class ao extends l.Z{didMount(){const{blockStore:e}=io.Z.state;if(!e)return;const t=e.getTitleStore();t&&so.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{blockStore:t}=io.Z.state;if(!t)return;const s=t.getTitleStore();if(!s)return;let i;return i=e.isMobile?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:380},(0,v.jsx)(u.Z,{...i,children:(0,v.jsx)("div",{style:this.getWrapStyle(),children:(0,v.jsx)(Di.Z,{store:s,disabled:!t.canEdit(),onEsc:()=>to.x(this.environment),onEnter:()=>to.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:this.props.intl.formatMessage({defaultMessage:"Untitled",id:"renameFileMenuPopup.input.placeholder"}),style:this.getInputStyle(),pasteBehavior:"inline"})})})}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}ao.displayName="LocalizableRenameFileMenu";const oo=(0,d.injectIntl)(ao),ro=no;var lo=s(52771),co=s(82187),uo=s(31278);class mo extends l.Z{constructor(){super(...arguments),this.renderPopupContent=()=>{const{renderDelete:e}=co.Z.state;return(0,v.jsx)(go,{renderDelete:Boolean(e)})}}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t,originRect:s}=co.Z.state;return(0,v.jsx)(m.ZP,{popupType:e.isMobile?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:Boolean(t),originRect:s,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Center,originGap:4,onDismiss:()=>lo.x(this.environment),render:this.renderPopupContent})}}mo.displayName="RenamePageMenuPopup";class po extends l.Z{constructor(){super(...arguments),this.handleRecordIconChange=e=>{const{clonedBlockStore:t}=co.Z.state;if(t){const s=t.getIconStore();s&&k.createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:this.environment,perform:t=>{vt.sO({store:s,value:e,transaction:t})}})}}}didMount(){const{clonedBlockStore:e}=co.Z.state;if(!e)return;const t=e.getTitleStore();t&&so.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t}=co.Z.state;if(!t)return;const s=t.getTitleStore();if(!s)return;const{renderDelete:i}=this.props;let n;return n=e.isMobile?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:380},(0,v.jsx)(u.Z,{...n,children:(0,v.jsxs)("div",{style:this.getWrapStyle(),children:[this.renderIcon(t),(0,v.jsx)(Di.Z,{store:s,disabled:!t.canEdit(),onEsc:()=>lo.x(this.environment),onEnter:()=>lo.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,placeholder:fo(this.props.intl),style:this.getInputStyle(),pasteBehavior:"inline"}),i&&t.canEdit()&&(0,v.jsx)(yo,{})]})})}renderIcon(e){const t={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${this.theme.darkDividerColor}`};if(e.canEdit()){var s,i;const n=null===(s=e.getIconStore())||void 0===s?void 0:s.table;return(0,v.jsx)(uo.Z,{disabled:!1,bucket:"secure",store:e,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t,iconLoggingData:{recordTable:n,source:"breadcrumb",block_type:e.getType(),collection_id:"collection"===n?null===(i=e.getIconStore())||void 0===i?void 0:i.id:void 0},onChange:this.handleRecordIconChange})}return(0,v.jsx)(uo.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t})}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}po.displayName="LocalizableRenamePageMenu";const go=(0,d.injectIntl)(po),ho=mo;function fo(e){const{clonedBlockStore:t}=co.Z.state;if(null!=t&&t.isDefined())return t.getModel().getEmptyTitlePlaceholder({getRecordModel:t.getRecordModel,userTimeZone:(0,Hn.r)(),intl:e})}function yo(){window.__c={n:"DeleteButton"};const e=(0,n.O7)();return(0,v.jsx)(Qi.Z,{icon:e=>(0,li.y)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=co.Z.state;t&&await Qt.Qw({environment:e,blocks:[t]}),lo.x(e)}})}var xo=s(42853),vo=s(9107),So=s(69634),bo=s(22962),Mo=s(6287),jo=s(80503),wo=s(11732),Co=s(56863),ko=s(92022),To=s(30912),Io=s(19124),Po=s(40959),_o=s(87078),Zo=s(45162),Fo=s(67669),Ao=s(35328),Ro=s(15723),Do=s(45214),Bo=s(17903),Lo=s(4548),No=s(42057),Oo=s(49557),Eo=s(4935),Vo=s(99757),Uo=s(13966),Wo=s(48019),Ko=s(64131),zo=s(82945),qo=s(40464),Go=s(32404),Ho=s(73383);class Qo extends l.Z{constructor(){super(...arguments),this.mouseIsDownExternally=!1,this.lastRenderState=void 0,this.completionContextOnOpen=void 0,this.renderOverlay=()=>{const{isActive:e}=Oo.Z.state;return(0,v.jsx)(es.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:{stiffness:100,damping:10,precision:1e-4}},render:this.renderAnimated,onAnimationEnd:this.handleAnimationEnd})},this.renderAnimated=()=>{const{top:e,left:t}=Oo.Z.state,s=this.canOnlyDiscussStore.state,i=Math.max(s?t:t-Qo.leftOffset,0),n=s?"12px 0":12;return(0,v.jsxs)("div",{className:p.Qcf,style:{pointerEvents:"none",position:"absolute",top:e,left:0,display:"flex",width:"100%"},children:[(0,v.jsx)("div",{style:{flexShrink:1,width:i,minWidth:24}}),(0,$t.Z)((e=>(0,v.jsx)("div",{style:{pointerEvents:"none",padding:n},...e,children:this.lastRenderState&&this.renderMenu(this.lastRenderState)}))),(0,v.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})},this.updateRichTextState=()=>{const e=Oo.Z.state;if(Ks.Z.state.open||Eo.Z.state.open)return;if(Vo.n.state)return Co.w();const t=P.default.state;if("empty"===t.mode)return Co.w();const s=(0,Zo.L5)(t.multiSelection);if(0===s.length)return Co.w();if(!s.every((e=>{let{store:t}=e;return t.table===Tt.iU||t.table===xs.x_||t.table===Mo.v})))return Co.w();if(!this.environment.currentUser.isLoggedIn()||!s.every((e=>{let{store:t}=e;return t.canComment()})))return;const i=$a.get();if(St.JE())return Co.w();if(s.some((e=>{let{editable:t}=e;return t.props.disableAnnotation})))return Co.w();const n=s.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(n.some(((e,t)=>{const i=s[t].store.canComment(),n=s[t].store.table===xs.x_&&s[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!i||n})))return Co.w();if(this.mouseIsDownExternally&&e.blockTarget!==n[0])return Co.w();const a=s.some((e=>{let{store:t}=e;const s=t.getRecordStoreAtRootPath();if(!(s instanceof Ft.G))return!1;const i=s.getValue();return!!i&&Qo.richTextMenuBlockTypesDenylist[i.type]}));if(a)return Co.w();const o=i?$a.getRect(i):void 0;if(o&&!Ro.kK(o,(0,_o.Z)()))return Co.w();if(co.Z.isActive()||io.Z.isActive()||ws.Z.isOpen()||a||!i||!function(){const e=$a.get();return!!e&&!e.collapsed&&"empty"!==P.default.state.mode&&!(0,T.iG)(P.default.state.multiSelection)}()||Do.Z.state.open)return Co.w();let r=0,l=0;if(o){r=o.left;const e=25,t=o.top-Qo.height-e,s=jo.R6(this.environment.device.isElectronMac),i=this.environment.WindowSizeStore.state.height-Qo.height-e;l=Math.min(Math.max(t,s),i)}0===Math.abs(Oo.Z.state.top-l)&&Math.abs(Oo.Z.state.left-r)<10&&(l=Oo.Z.state.top,r=Oo.Z.state.left),Oo.Z.setState({...Oo.Z.state,isActive:!0,isAnimatingClosed:!1,top:l,left:r,blockTarget:nt.default.state.stores[0]})},this.updateRichTextStateThrottled=M.P2(this.updateRichTextState,200,{leading:!1}),this.handleAnimationEnd=()=>{Oo.Z.state.isActive||Oo.Z.setState({...Oo.Z.state,isAnimatingClosed:!1}),this.lastRenderState=this.renderStateStore.state},this.renderStateStore=this.createComputedStore((()=>{const{isActive:e,blockTarget:t}=Oo.Z.state,s=P.default.state;if(!e||"empty"===s.mode)return;const{multiSelection:i}=s,n=(0,Zo.L5)(i),a=n.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),o=(0,T.qS)(i),r=P.default.isEditingComment(),l=P.default.isEditingCaption(),d=t&&t.getParentTable()===Mo.v,c=o&&t&&i.start.store===t.getCollectionViewSourceDescriptionStore(),u=this.pageContext&&this.pageContext.publicEditModeStore.state,m=!(0,Fo.YF)(u)&&(i.start.store.canEdit()&&i.end.store.canEdit()),p=a.some(((e,t)=>{const s=n[t].store.table===xs.x_&&!n[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!s})),g=m&&!p,h=t&&t.getType(),f=h&&Qo.richTextMenuActionsDenylist[h],y=null==t?void 0:t.isType("button"),x=(0,To.td)(i.start.store)||(0,To.td)(i.end.store),v={isSingleStoreSelection:o,showTurnInto:Boolean(o&&!r&&!d&&!c&&!l&&t&&g&&!y),showBold:Boolean(g),showItalic:Boolean(g),showStrikethrough:Boolean(g),showUnderline:Boolean(g),showCode:Boolean(g),showLink:Boolean(o&&g),showHighlight:Boolean(g),showDiscuss:Boolean(!r&&t&&!d&&!c&&!x),showEquation:Boolean(o&&g),showMention:Boolean(o&&!r&&t&&!d&&g),showActionButton:Boolean(o&&!r&&!l&&t&&!d),blockTarget:t,isComment:r,showCompletions:Boolean((0,Io.GD)(u)&&g&&!r&&!l&&t&&!d&&!c&&!y&&!x)};if(f&&f.size>0)for(const S of f)v[S]=!1;return v})),this.canOnlyDiscussStore=this.createComputedStore((()=>{const e=this.renderStateStore.state;return e&&e.showDiscuss&&!e.showBold}))}didMount(){nt.default.addListener(this.updateRichTextStateThrottled),P.default.addListener(this.updateRichTextStateThrottled),Bo.Z.addListener(this.updateRichTextState),No.Z.addListener(this.updateRichTextState),Lo.Z.addListener(this.updateRichTextState)}willUnmount(){P.default.removeListener(this.updateRichTextStateThrottled),nt.default.removeListener(this.updateRichTextStateThrottled),Bo.Z.removeListener(this.updateRichTextState),No.Z.removeListener(this.updateRichTextState),Lo.Z.removeListener(this.updateRichTextState)}willMountOrUpdate(){const e=this.renderStateStore.state;e&&(this.lastRenderState=e)}renderComponent(){const{isActive:e,isAnimatingClosed:t}=Oo.Z.state;return(0,v.jsx)(ss.Z,{open:e||t,children:this.renderOverlay()})}renderMenu(e){const{isActive:t}=Oo.Z.state;return(0,v.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:Qo.height,background:this.theme.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,pointerEvents:t?"auto":"none"},onMouseDown:e=>e.preventDefault(),children:[e.showCompletions&&this.renderCompletionsButton(),e.showTurnInto&&e.blockTarget&&this.renderTurnInto(e.blockTarget),e.showLink&&this.renderLinkButton(!0),e.showDiscuss&&e.blockTarget&&this.renderCommentButton(e.blockTarget),(0,v.jsxs)("div",{style:{display:"flex"},children:[e.showBold&&this.renderBoldButton(),e.showItalic&&this.renderItalicButton(),e.showUnderline&&this.renderUnderlineButton(),e.showStrikethrough&&this.renderStrikethroughButton(),e.showCode&&this.renderCodeButton(),e.showEquation&&this.renderEquationButton()]}),e.showHighlight&&(0,v.jsx)(Ko.Z,{style:this.getBorderRight()}),e.showMention&&this.renderMention(),e.showActionButton&&e.blockTarget&&this.renderActionButton(e.blockTarget)]})}renderTurnInto(e){let t=(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const{intl:s}=this.props,i=e.getType();if(i){const e=Po.Hc[i];t=e&&e.displayName||t}return(0,v.jsx)(Y.ZP,{popupType:Y.Z4.Popup,buttonPopupStore:Eo.Z,originGap:4,renderOrigin:e=>(0,v.jsx)(X.Z,{renderTooltip:()=>s.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:s=>(0,v.jsxs)(Q.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()},...(0,ee.Z)(e,s),children:[t,(0,xo.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]})}),render:()=>(0,v.jsx)(u.Z,{menuType:g.og.Popup,children:(0,v.jsx)(Wo.Z,{context:{blocks:[e],environment:this.environment,publicEditMode:void 0},sections:[wo.g],onAccept:t=>{const s=e.getType(),i=e.getFormat();Co.w(),w.dhV(this.environment,{analyticsName:t.analyticsName,action_type:t.analyticsActionType,from:"rich_text_menu",block_id:e.id,block_type:s,is_toggleable:s?(0,Ao._A)(s,i):void 0})}})}),onClick:()=>{w.mt_(this.environment,{action:"turn_into"})}})}renderBoldButton(){return(0,v.jsx)(qo.Z,{type:"b",tooltipLabel:(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)("div",{children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,v.jsx)("div",{children:(0,v.jsx)(Ja.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleBold"})})]}),children:(0,v.jsx)("span",{style:{fontWeight:Sa.Z.fontWeight.semibold},children:"B"})})}renderItalicButton(){return(0,v.jsx)(qo.Z,{type:"i",tooltipLabel:(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)("div",{children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,v.jsx)("div",{children:(0,v.jsx)(Ja.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleItalics"})})]}),children:(0,v.jsx)("span",{style:{fontStyle:"italic"},children:"i"})})}renderStrikethroughButton(){return(0,v.jsx)(qo.Z,{type:"s",tooltipLabel:(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)("div",{children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,v.jsx)("div",{children:(0,v.jsx)(Ja.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleStrike"})})]}),children:(0,v.jsx)("span",{style:{textDecoration:"line-through"},children:"S"})})}renderUnderlineButton(){return(0,v.jsx)(qo.Z,{type:"_",tooltipLabel:(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)("div",{children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,v.jsx)("div",{children:(0,v.jsx)(Ja.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleUnderline"})})]}),children:(0,v.jsx)("span",{style:{textDecoration:"underline"},children:"U"})})}renderCodeButton(){return(0,v.jsx)(qo.Z,{type:"c",style:{padding:"0 6px"},tooltipLabel:(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)("div",{children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,v.jsx)("div",{children:(0,v.jsx)(Ja.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleCode"})})]}),children:(0,vo.z)({width:15,height:15})})}renderLinkButton(e){const t=this.environment.device.isMobile;return(0,v.jsxs)(Ho.Z,{style:this.getBorderRight(),children:[e&&(0,Yn.J)({width:t?18:16,height:t?18:16,marginRight:4,fill:this.theme.regularIconColor}),(0,v.jsx)("span",{style:{borderBottom:`1px solid ${this.theme.linkDecorationColor}`},children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Link",id:"richTextMenu.linkButton.tooltip"})})]})}renderCompletionsButton(){const{intl:e}=this.props;return(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{children:e.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,v.jsx)("div",{children:(0,v.jsx)(Ja.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"commandJ"})})]}),render:e=>(0,v.jsxs)(Q.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()},...e,onClick:()=>{(0,ko.toggleInitialPrompt)({from:"rich_text_menu",environment:this.environment}),w.mt_(this.environment,{action:"completions"})},children:[(0,Ti.t)({width:16,height:16,fill:F.FN.light.purple[400],marginRight:4}),(0,v.jsx)("span",{style:{color:F.FN.light.purple[400],fontWeight:500},children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})}renderEquationButton(){return(0,v.jsx)(Go.Z,{style:this.getBorderRight(),onClick:()=>{w.mt_(this.environment,{action:"e"}),Co.w()},children:(0,So.G)({width:16,height:16})})}renderMention(){return(0,v.jsx)(X.Z,{renderTooltip:()=>(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)("div",{children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Mention a person,{br}page, or date",id:"richTextMenu.mentionButton.tooltip",values:{br:(0,v.jsx)("br",{})}})}),(0,v.jsx)("div",{style:{color:this.theme.mediumInvertedTextColor},children:"@"})]}),render:e=>(0,v.jsx)(Q.Z,{style:{...this.getBorderRight(),padding:"0 8px"},...e,onClick:()=>{ia.lZ(this.environment,{page:!0,createPage:!0,user:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0,group:!0}),w.mt_(this.environment,{action:"mention"})},children:(0,bo.O)({width:14,fill:this.theme.regularTextColor})})})}renderCommentButton(e){return(0,v.jsx)(zo.Z,{style:this.getBorderRight(),blockStore:e})}renderActionButton(e){return(0,v.jsx)(Uo.Z,{store:e,style:{borderRight:"none",borderRadius:0,padding:0,width:30,height:"none"},iconStyle:{fill:this.theme.regularTextColor},fadeIn:!1,onClick:()=>{w.mt_(this.environment,{action:"more"})}})}getBorderRight(){return{boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`,marginRight:1}}}Qo.displayName="RichTextMenu",Qo.richTextMenuBlockTypesDenylist={[We.Ti.factory]:!0},Qo.richTextMenuActionsDenylist={[We.Ti.code]:new Set(["showMention","showCode","showCompletions"]),[We.Ti.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[We.Ti.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},Qo.leftOffset=60,Qo.height=32;const Yo=(0,d.injectIntl)(Qo);s(21703);var $o=s(1302),Jo=s(14248),Xo=s(14714),er=s(29369),tr=s(19037),sr=s(93959),ir=s(78316),nr=s(79954),ar=s(55367),or=s(12211),rr=s(50628);const lr=200;var dr=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(dr||{});function cr(e){return e.type===dr.Selectable?{type:ar.Dl.Selectable,store:e.target.props.store,direction:e.direction}:{type:ar.Dl.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function ur(e){const{target:t,device:s,direction:i,points:n}=e;return i===ar.vh.Onto||!s.isPhone||t.props.dropzoneShouldNeverUseOrigin?n.mousePoint:{x:n.originPoint.x,y:n.mousePoint.y}}function mr(e){return e instanceof nr.Z?{type:dr.Selectable,target:e}:{type:dr.DropTarget,target:e}}function pr(e){if(!(e&&e instanceof nr.Z))return!1;let t=e;const s=ar.ZP.state;if(!s.isDragging)return!1;const{draggedStores:i}=s;for(;t;){if(i.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function gr(e){const{dropzoneMustBeWithinHorizontalBound:t,device:s}=e;return t?0:s.isPhone?9999:0}function hr(e){switch(e.direction){case ar.vh.Onto:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,canAcceptDrop:r}=e,l=ar.vh.Onto,d=ur({device:t,target:n,direction:l,points:a});if((s?n.props.canNativeDropOnto:n.props.canDropOnto)&&yr(d,i)&&!pr(n)&&r(n,l))return{...mr(n),direction:l,left:i.left,top:i.top,width:i.width,height:i.height,priority:o}}(e);case ar.vh.Left:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=ar.vh.Left,c=ur({device:t,target:n,direction:d,points:a});if((s?n.props.canNativeDropLeft:n.props.canDropLeft)&&i&&c.y>=i.top&&c.y<=i.bottom&&Math.abs(c.x-i.left)<=200&&(r||!pr(n))&&l(n,d))return{...mr(n),direction:d,left:i.left,top:i.top,width:0,height:i.height,priority:o}}(e);case ar.vh.Right:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=ar.vh.Right,c=ur({device:t,target:n,direction:d,points:a});if((s?n.props.canNativeDropRight:n.props.canDropRight)&&i&&c.y>=i.top&&c.y<=i.bottom&&Math.abs(c.x-i.right)<=lr&&(r||!pr(n))&&l(n,d))return{...mr(n),direction:d,left:i.right,top:i.top,width:0,height:i.height,priority:o}}(e);case ar.vh.Above:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=gr({dropzoneMustBeWithinHorizontalBound:n.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=ar.vh.Above,u=ur({device:t,target:n,direction:c,points:a});if((s?n.props.canNativeDropAbove:n.props.canDropAbove)&&i&&u.x>=i.left-14-d&&u.x<=i.right+d&&(r||!pr(n))&&l(n,c))return{...mr(n),direction:c,left:i.left,top:i.top,width:i.width,height:0,priority:o}}(e);case ar.vh.Below:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=gr({dropzoneMustBeWithinHorizontalBound:n.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=ar.vh.Below,u=ur({device:t,target:n,direction:c,points:a});if((s?n.props.canNativeDropBelow:n.props.canDropBelow)&&i&&u.x>=i.left-14-d&&u.x<=i.right+d&&(r||!pr(n))&&l(n,ar.vh.Below))return{...mr(n),direction:ar.vh.Below,left:i.left,top:i.bottom,width:i.width,height:0,priority:o}}(e)}}function fr(e){const{device:t,rect:s,target:i,points:n,optionKeyDown:a}=e;return yr(ur({device:t,target:i,direction:ar.vh.Onto,points:n}),s)&&pr(i)&&!a}function yr(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var xr=s(28314),vr=s(75770),Sr=s(35026),br=s(17031),Mr=s(27406),jr=s(81844),wr=s(16339),Cr=s(95802),kr=s(88923),Tr=s(91681),Ir=s(86486);class Pr extends l.Z{constructor(){super(...arguments),this.isUpdatingDragState=!1,this.didTouchEnd=!1,this.lastMouseInfo=void 0,this.handleWindowMouseMove=e=>{const t=Ir.default.state;if(!e||t.isOpen&&t.menuIsOpen||(this.lastMouseInfo={target:e.target,x:e.clientX,y:e.clientY}),this.didTouchEnd)return void(this.didTouchEnd=!1);const{isDragging:s}=ar.ZP.state;if(s)this.updateDragState();else{if(!this.lastMouseInfo)return;Ar(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}},this.handleDragBlockStoreChange=()=>{this.isUpdatingDragState||this.handleWindowMouseMoveThrottled(void 0)},this.handleWindowMouseMoveThrottled=M.P2((e=>ii.Z.withListenerIgnored((()=>this.handleWindowMouseMove(e)))),60),this.handleSelectionChange=()=>{const{isDragging:e}=ar.ZP.state;$o.default.afterNextFlush((()=>{this.lastMouseInfo&&!e&&Ar(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}))},this.handleSelectionChangeThrottled=M.P2(this.handleSelectionChange,60),this.handleWindowKeyEvent=()=>{const{isDragging:e}=ar.ZP.state;e&&this.updateDragState()},this.handleWindowTouchEnd=()=>{this.didTouchEnd=!0},this.handleWindowScroll=()=>{Yt.Ch(),Zr()},this.handleWindowResize=()=>{Yt.Ch(),Zr()},this.handleGlobalMenuIsOpenChange=()=>{const e=Ir.default.state,t=St.kw.state;e.isOpen&&!e.menuIsOpen&&t&&Ir.default.reset()},this.memoizedCanDragCache=new WeakMap,this.memoizedCanDrag=e=>{const t=this.memoizedCanDragCache.get(e);if(this.memoizedCanDragCache.has(e))return t;const s=(0,tr.OO)({environment:this.environment,blocks:e,publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state});return this.memoizedCanDragCache.set(e,s),s},this.getDropZonePriority=e=>(null==e?void 0:e.priority)??0}didMount(){super.didMount();const{device:e}=this.environment;Zs.lj(window,"mousemove",this.handleWindowMouseMoveThrottled),nt.default.addListener(this.handleSelectionChangeThrottled),e.isIOS&&Zs.lj(window,"touchend",this.handleWindowTouchEnd),Zs.lj(window,"keydown",this.handleWindowKeyEvent),Zs.lj(window,"keyup",this.handleWindowKeyEvent),ar.ZP.addListener(this.handleDragBlockStoreChange),Zs.lj(window,"scroll",this.handleWindowScroll,!0),Zs.lj(window,"resize",this.handleWindowResize),St.kw.addListener(this.handleGlobalMenuIsOpenChange),Yt.Jy()}willUnmount(){super.willUnmount();const{device:e}=this.environment;Zs.ZV(window,"mousemove",this.handleWindowMouseMoveThrottled),nt.default.removeListener(this.handleSelectionChangeThrottled),e.isIOS&&Zs.ZV(window,"touchend",this.handleWindowTouchEnd),Zs.ZV(window,"keydown",this.handleWindowKeyEvent),Zs.ZV(window,"keyup",this.handleWindowKeyEvent),ar.ZP.removeListener(this.handleDragBlockStoreChange),Zs.ZV(window,"scroll",this.handleWindowScroll,!0),Zs.ZV(window,"resize",this.handleWindowResize),St.kw.removeListener(this.handleGlobalMenuIsOpenChange)}updateDragState(){if(this.isUpdatingDragState)throw new Error("Assertion failure, updateDragState() called when this.isUpdatingDragState === true!");this.isUpdatingDragState=!0;try{this.updateDragStateInner()}finally{this.isUpdatingDragState=!1}}updateDragStateInner(){const e=ar.ZP.state;if(!e.isDragging)return;const{draggedStores:t,currentX:s,currentY:i,offsetX:n,offsetY:a,isNativeDrag:o}=e,r={x:s,y:i},l={x:s-n,y:i-a},d=this.findNearbyDropZones({mousePoint:r,originPoint:l},t[0],o);if(d.ontoDropZone)ar.ZP.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)ar.ZP.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],s=M.Gb(d.horizontalDropZones);if(t.type===ar.Dl.Selectable){const i=Cr.C.findSelectableFromStore(t.store);if(i){const n=i.getContextClosestSelectable();let a;return n&&n.props.store!==t.store&&n.props.shouldShowParentHalo&&(a=n.props.store),void ar.ZP.setState({...e,currentDropZone:t,currentHintDropZones:s,currentParentStore:a})}}else{if(Mr.Z.findDropTargetFromKey(t.key))return void ar.ZP.setState({...e,currentDropZone:t,currentHintDropZones:s,currentParentStore:void 0})}}ar.ZP.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}getHighestDropZonePriorityRects(e){const t=this.getDropZonePriority(M.UT(e,this.getDropZonePriority));return e.filter((e=>this.getDropZonePriority(e)===t))}findNearbyDropZones(e,t,s){const{device:i}=this.environment,n=xr.yA(),a=function(){const{selectableRectMap:e}=rr.Z.state,{dropTargetRectMap:t}=or.Z.state,s=new Map;return e.forEach(((e,t)=>{s.set(t,e)})),t.forEach(((e,t)=>{s.set(t,e)})),s}(),o=a.keys();let r=o.next();const l=Cr.C.findSelectableFromStore(t),d=l?l.getContextSelectableContainer():void 0;let c=[];for(;!r.done;){const t=r.value;r=o.next();const l=a.get(t),u=t.getContextSelectableContainer();if(i.isPhone&&u!==d)continue;if(!u||u.props.disable)continue;const m=Fr(u),p={device:this.environment.device,isNativeDrag:s,rect:l,target:t,points:e,priority:m,optionKeyDown:n.option,canAcceptDrop:(e,t)=>this.selectableCanAcceptDrop(e,t,n.option)};if(fr(p))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};c.push(...M.oA([hr({...p,direction:ar.vh.Onto}),hr({...p,direction:ar.vh.Left}),hr({...p,direction:ar.vh.Right}),hr({...p,direction:ar.vh.Above}),hr({...p,direction:ar.vh.Below})]))}c=this.getHighestDropZonePriorityRects(c);const u=c.filter((e=>e.direction===ar.vh.Above||e.direction===ar.vh.Below)),m=M.F(u,(t=>Math.abs(t.top-Rr(t,e,this.environment).y)));let p=u.filter((e=>{let{top:t}=e;return Math.abs(t-(m?m.top:0))<=Pr.competingHorizontalDropZoneMinDist}));if(p.length>1){p=p.filter((t=>{const s=Rr(t,e,this.environment).x,i=gr({device:this.environment.device});return s>=t.left-i&&s<=t.left+t.width+i})),p=M.MR(p,(e=>{let{left:t}=e;return t}));let t=0;for(;t<p.length-1;t++){const s=p[t+1],i=Rr(s,e,this.environment).x;if(s.left>i)break}p=p.slice(0,t+1),p.reverse()}const g=p.map(cr);let h;const f=c.filter((e=>e.direction===ar.vh.Onto)),y=M.F(f,(e=>e.height));if(y){u.some((t=>{const s=Rr(t,e,this.environment).y;return Math.abs(t.top-s)<Pr.competingOntoDropZoneVerticalOffset}))||(h=cr(y))}let x;const v=c.filter((e=>e.direction===ar.vh.Left||e.direction===ar.vh.Right));let S=M.F(v,(t=>{const s=Rr(t,e,this.environment).x;return Math.abs(t.left-s)}));if(S){const e=S,t=v.filter((t=>Math.abs(t.left-e.left)<Pr.verticalDropZoneAmbiguousDist));t.length>0&&(S=M.F(t,(e=>e.left)))}if(S){const e=S;u.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(x=cr(S))}return{ontoDropZone:h,verticalDropZone:x,horizontalDropZones:g}}selectableCanAcceptDrop(e,t,s){if(_e.Z.state.isOpen&&!kr.default.state.open)return!1;if(Ze.Z.state.isOpen)return!1;const i=ar.ZP.state,n=i.isDragging?i.draggedStores:[],a=!!i.isDragging&&i.isNativeDrag;let o,r,l,d=!1,c=!1;n.find((e=>{const t=jr.Z.findOutlinerItemFromStore(e);return!!t&&(o=t,r=t.type,d=t.isTopLevelItem,!0)}));const u=e instanceof nr.Z?jr.Z.findOutlinerItemFromStore(e.props.store):void 0,m=null==u?void 0:u.parentStore;var p;u&&(l=u.type,c=u.isTopLevelItem||"team"===(null===(p=u.parentStore)||void 0===p?void 0:p.table));if(function(e){var t;const{draggingOutlinerItem:s,selectableOutlinerItemParent:i,direction:n}=e;if(s&&"team"===s.type&&s.isTopLevelItem&&(null===(t=s.parentStore)||void 0===t?void 0:t.pointer.table)===er.e0){const e=s.parentStore;if(!(s.store.getParentId()===e.pointer.id||i&&i.pointer.id===e.pointer.id&&n!==ar.vh.Onto))return!0}return!1}({draggingOutlinerItem:o,selectableOutlinerItemParent:m,direction:t}))return!1;if(!(e instanceof nr.Z))return e.props.canAcceptDrop({direction:t,draggingStores:n,isNativeDrag:a});const g=e.props.store,h=g.getAssociatedCollectionStore();if(t===ar.vh.Onto&&h){const e=h.id,t=(0,ir.fm)(g),s=null==t?void 0:t.collectionViewStore();if(s&&"page"!==s.getType()){if(n.find((t=>{const s=t.getAssociatedCollectionStore();return Boolean(t instanceof Ft.G&&s&&s.id===e)})))return!1}}if(e.props.groupsPointer){var f;const t=null===(f=g.getCollectionViewCollectionStore())||void 0===f?void 0:f.getSchema();if(Boolean(e.props.groupsPointer.find((e=>!(0,Jo.WL)(e,(null==h?void 0:h.getSchema())??t))))){if(n.find((t=>{var s;const i=Cr.C.findSelectableFromStore(t);return(null==i||null===(s=i.props)||void 0===s?void 0:s.groupsPointer)&&e.props.groupsPointer&&!(0,Xo.HH)(i.props.groupsPointer,e.props.groupsPointer)})))return!1}}if((0,vr.ru)({targets:n,destination:g,direction:t,draggingOutlinerType:r}))return!1;if(s&&n.find((e=>e.isTypedCollectionViewBlock()||(0,sr.h7)(e))))return!1;if(u&&t!==ar.vh.Onto&&!c&&!(0,tr.M)({environment:this.environment,blocks:[u.store],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(l&&a)return!1;if("bookmarks"===r&&d&&("bookmarks"!==l||!c||t===ar.vh.Onto))return!1;if("bookmarks"===l&&c&&t!==ar.vh.Onto&&("bookmarks"!==r||!d))return!1;if(o&&o.isTopLevelItem&&"team"===o.type&&o.parentStore&&o.parentStore.table===er.e0){const e=o.parentStore,t=Ft.zX.createChildStore(e,{...e.pointer,table:er.e0});if(t&&!(0,Sr.si)({teamStore:t,environment:this.environment}))return!1}if(u&&u.isTopLevelItem&&"team"===u.type&&u.parentStore&&u.parentStore.table===er.e0){const e=u.parentStore,t=Ft.zX.createChildStore(e,{...e.pointer,table:er.e0});if(t&&!(0,Sr.si)({teamStore:t,environment:this.environment}))return!1}if("shared"===l&&c&&("shared"!==r||!d))return!1;if(l&&c&&t!==ar.vh.Onto){if(n.find((e=>{const t=e.getType();return Boolean(!t||!We.Z7[t])})))return!1}const{device:y}=this.environment;if(l&&y.isMobile&&t===ar.vh.Onto&&c)return!1;if(n.find((e=>Boolean(e instanceof Ft.G&&e.isInlineCollectionView())))&&(t===ar.vh.Left||t===ar.vh.Right))return!1;if(n.some((e=>Boolean(br.Z.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(br.Z.findCollectionTemplatePickerItemFromStore(g)))return!1;if(t===ar.vh.Onto&&g&&!(0,tr.J5)({environment:this.environment,blocks:[g],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(!this.memoizedCanDrag(n))return!1;if(n.some((e=>e.isTransclusionType()))){if(g.findRecordStoreUIAncestor((e=>{if(e===g)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getValue();return Boolean(t&&(0,We.nq)(t.type))})).ancestor)return!1}return!0}}Pr.displayName="SelectableOrDropTargetListener",Pr.competingOntoDropZoneVerticalOffset=7,Pr.verticalDropZoneAmbiguousDist=20,Pr.competingHorizontalDropZoneMinDist=2;const _r=Pr;function Zr(){const e=Ir.default.state;e.isOpen&&!e.menuIsOpen&&Ir.default.reset()}function Fr(e){return(nt.default.state.droppableContainerStack||[]).indexOf(e)}function Ar(e,t,s){const i=Ir.default.state;if(!i.isOpen||!i.menuIsOpen){const n=function(e,t,s){if(Tr.Z.state.isResizing||ar.ZP.state.isDragging||Fe.Z.state.isActive||St.kw.state)return;const{selectableRectMap:i}=rr.Z.state,n=wr.Z.getMembersByDOMOrder({filter:t=>{const s=t.getNode();return Boolean(s&&s.contains(e))}})[0],a=nt.default.getCurrentDefaultContainer(),o=n||a;if(!o)return;const r=i.keys();let l=r.next();const d=[];for(;!l.done;){const e=l.value,n=i.get(e),a=150;(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===o&&n&&s>=n.top&&s<=n.bottom&&t>=n.left-a&&t<=n.right&&d.push(e),l=r.next()}const c=M.MR(d,(e=>{const t=i.get(e);return t?-t.left:1/0})),u=c.find((e=>{const t=e.getNode();return!t||!c.find((s=>{if(s!==e){const e=s.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return u?{selectable:u,container:o}:void 0}(e,t,s);n?i.isOpen&&n.selectable.props.store===i.currentStore||Ir.default.setState({isOpen:!0,currentStore:n.selectable.props.store,container:n.container,menuIsOpen:!1}):Ir.default.reset()}}function Rr(e,t,s){return ur({device:s.device,target:e.target,points:t})}var Dr=s(49427),Br=s(74948),Lr=s(38676);class Nr extends l.Z{constructor(){super(...arguments),this.cachedPageViewRect=void 0,this.previousMousePosition=void 0,this.mouseSpeed=1/0,this.timerId=void 0,this.setPreviousMousePosition=(e,t)=>{this.previousMousePosition={x:e,y:t},clearTimeout(this.timerId),this.timerId=setTimeout((()=>{this.previousMousePosition=void 0}),100)},this.handleWindowMouseMove=e=>{(0,je.ZP)({event:e,context:je.Af.SidebarMouseMove,callback:()=>{if(this.updatePageViewRectThrottled(),void 0!==this.previousMousePosition&&(this.mouseSpeed=Math.sqrt(Math.pow(e.clientX-this.previousMousePosition.x,2)+Math.pow(e.clientY-this.previousMousePosition.y,2))),this.setPreviousMousePosition(e.clientX,e.clientY),this.cachedPageViewRect){const{sidebarMinTriggerWidth:t,sidebarOpenWidthPercent:s}=Nr,i=Lr.TC.state,n=e.clientX,a=this.cachedPageViewRect.left,o=Math.max(a*s,t,Lr.Ic.state);n<o&&!kr.default.isCenterPeekOpen()&&this.mouseSpeed<Nr.mouseSpeedThreshold&&0!==this.mouseSpeed&&!i&&Br.open(),n>(0,Ve.qG)(this.environment)&&n>o&&i&&Br.close()}}})},this.handleWindowMouseOut=e=>{e.toElement||e.relatedTarget||Br.close()},this.handleWindowResize=e=>{this.environment.WindowSizeStore.state.width<Br.OnlyOneSidebarVisibleWidthThreshold&&(0,Ve.Sx)(this.environment)&&(0,Ve.in)(this.environment)&&Br.setExpand({environment:this.environment,isExpanded:!1,from:"sidebar_listener"})},this.updatePageViewRectThrottled=M.P2(this.updatePageViewRect,500)}didMount(){window.addEventListener("mousemove",this.handleWindowMouseMove),window.addEventListener("mouseout",this.handleWindowMouseOut),window.addEventListener("resize",this.handleWindowResize)}willUnmount(){window.removeEventListener("mousemove",this.handleWindowMouseMove),window.removeEventListener("mouseout",this.handleWindowMouseOut),window.removeEventListener("resize",this.handleWindowResize)}updatePageViewRect(){const e=function(){const{mainEditorCurrentBlockStore:e}=ae.default.state,t=Dr.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}();this.cachedPageViewRect=e?e.getBoundingClientRect():document.body.getBoundingClientRect()}}Nr.displayName="SidebarListener",Nr.sidebarOpenWidthPercent=.38,Nr.sidebarMinTriggerWidth=18,Nr.mouseSpeedThreshold=5;const Or=Nr;var Er=s(84169),Vr=s(1310),Ur=s(9612),Wr=s(84076);class Kr extends l.Z{constructor(){super(...arguments),this.showingAnimatedList=z.default.createValue(!1),this.handleShow=()=>{this.showingAnimatedList.setState(!0)},this.handleHide=()=>{this.showingAnimatedList.setState(!1)}}renderComponent(){const{currentItem:e}=Vr.ZP.state,t=Boolean(e||this.showingAnimatedList.state);return(0,v.jsx)(ss.Z,{open:t,zIndex:201,children:(0,v.jsx)(Ur.Z,{render:()=>M.oA([this.renderCurrentItem()]),onShow:this.handleShow,onHide:this.handleHide})})}renderCurrentItem(){const{currentItem:e}=Vr.ZP.state;if(!e)return;const t=(null==e?void 0:e.position)??"bottom",{WindowSizeStore:s,device:i}=this.environment;let n=24;if(i.isMobileNative&&i.isIOS){n=ya.Z.state.estimatedKeyboardWebViewOverlap>0?24+ya.Z.estimatedNativeWebBottomOverlap():s.getSafePaddingBottomCSS(24+ya.Z.estimatedNativeWebBottomOverlap())}const a="top"===t?{top:24}:{bottom:n};return(0,v.jsx)(es.Z,{isVisible:!0,enterAnimationStyle:{translateY:"top"===t?-50:50,opacity:1,scale:1},animationStyle:{translateY:0,opacity:1,scale:1},exitAnimationStyle:{translateY:0,opacity:0,scale:.95},render:()=>(0,v.jsx)("div",{"aria-live":"polite",style:{...a,position:"fixed",left:0,width:"100%",display:"flex",zIndex:Gt.E,padding:4,pointerEvents:"none"},children:(0,v.jsxs)("div",{style:{background:this.theme.tooltipBackground,color:this.theme.regularInvertedTextColor,borderRadius:8,padding:"11px 16px",boxShadow:this.theme.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",...null==e?void 0:e.style},children:[e.label,e.helpUrl&&(0,v.jsx)(Wr.Z,{href:e.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:this.theme.regularInvertedTextColor},children:(0,Er.m)({fill:this.theme.mediumInvertedTextColor})}),(0,v.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:e.right})]})})},e.key)}}Kr.displayName="SnackbarRenderer";const zr=Kr;var qr=s(13991),Gr=s(6906),Hr=s(76994),Qr=s(65965),Yr=s(47425),$r=s(37834),Jr=s(1865),Xr=s(83420),el=s(52533),tl=s(18514),sl=s(46096),il=s(35057),nl=s(84787),al=s(50506),ol=s(76798),rl=s(53336),ll=s(83182),dl=s(46247),cl=s(26263),ul=s(16691),ml=s(4615),pl=s(45953),gl=s(606),hl=s(13493),fl=s(66213),yl=s(82136),xl=s(31192);class vl extends l.Z{constructor(){super(...arguments),this.handleOverrideLinkClick=e=>{$r.U4(),na.navigate({environment:this.environment,url:e})},this.loadSnapshot=async e=>{const{timestamp:t}=e,s=e.block.id,i=await Sn.getSnapshotContents(this.environment,e);if("failed"===i.type)throw i.error;const n=pl.PF.create(i.data.contentMap),a=this.environment.currentUser.id,o=new cl.Z({name:"PageSnapshotPreview"});for(const{pointer:u,model:m}of n)m&&o.setModelAndRole({pointer:u,userId:a},m,"reader");o.snapshotData={blockId:s,timestamp:t};const r=new Map,l=e=>{const t=o.getRecord({pointer:e,userId:a}),s=(0,ul.dn)(e);t||!(0,ml.e)(e.id)||r.has(s)||r.set(s,(0,Ft.Kv)(this.props.blockStore,e))};for(const{model:u}of n)if(u)if(u.table===Tt.iU){const e=u,t=e.getProperties(),s=gl.dr.uniq(M.xH(Object.keys(t).map((e=>t[e])).map(j.cCA)));for(const d of s)l(d);const i=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of i)l({table:Tt.iU,id:d});const n=e.getCollectionPointer();n&&l(n);const a=M.jj(M.xH(Object.keys(t).map((e=>t[e])).map(j.lcG)));for(const d of a)l({table:Ss.KJ,id:d});const o=u.getCreatedByPointer();o&&l(o);const r=u.getLastEditedByPointer();r&&l(r)}else if(u.table===hl.n){var d;const e=null===(d=u.getFormat())||void 0===d?void 0:d.collection_pointer;e&&l(e)}else if(u.table===xs.x_){const e=u.getCreatedByPointer();e&&l(e)}const c=Array.from(r.values());return await Promise.all(c.map((async e=>{await e.load();const t=e.getValue();t&&o.setRecord({pointer:e.pointer,userId:a},{role:"reader",value:t})}))),{blockStore:new Ft.G(this.environment,{table:Tt.iU,id:s},{inMemoryRecordCache:o}),timestamp:t}}}getChildContext(){return{...this.context,overrideLinkClick:this.handleOverrideLinkClick}}renderComponent(){const e=this.props.blockStore.id,t=this.props.timestamp,s={request:{block:{id:e,spaceId:(0,vs.C)(this.props.blockStore.pointer.spaceId)},timestamp:t},performRequest:this.loadSnapshot,render:(e,t,s)=>(0,v.jsx)(Rs.Z,{show:!s||!t,showDelay:400,showHold:400,render:s=>s?(0,v.jsx)("div",{style:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,v.jsx)(ts.Z,{})}):e?(0,v.jsx)("div",{style:{padding:32},children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})}):t?(0,v.jsx)(Qe.Z,{store:t.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:s}=e;return(0,v.jsx)(rl.Z,{style:{background:this.theme.contentBackground,zIndex:1,flexGrow:1},type:(0,St.Zy)({environment:this.environment,store:t.blockStore}),...s,children:(0,v.jsx)(xl.Z,{store:t.blockStore,disabled:!0,loadingContainerStore:void 0,context:yl.S.InAppTemplatePreview,paddingBottom:xl.Z.paddingBottom(this.environment),paddingLeft:(0,St.ui)(this.environment),paddingRight:(0,St.ui)(this.environment),pageCoverHeight:xl.Z.defaultPageCoverHeight(this.environment)})})}},t.timestamp):void 0})};return(0,v.jsx)(fl.LF,{value:this.handleOverrideLinkClick,children:(0,v.jsx)(Ki.Z,{...s})})}}vl.displayName="PageSnapshotPreview",vl.contextTypes=l.w,vl.childContextTypes={...fl.wK,...l.w};const Sl=vl;class bl extends l.Z{constructor(){super(...arguments),this.renderSnapshotsListRequest=()=>{const{device:e}=this.environment,t=sl.Z.state;if(!t.open)return;const s={request:{block:{id:t.blockStore.id,spaceId:(0,vs.C)(t.blockStore.pointer.spaceId)},size:t.size},performRequest:e=>this.loadSnapshotsList(e,t),render:(s,i,n)=>(0,v.jsx)(Rs.Z,{show:Boolean(!i||i.snapshots.length>=t.size&&t.openSnapshotNearTimestamp),showDelay:400,showHold:100,render:a=>e.isMobile?this.renderMobileHistory({snapshotValues:i?i.snapshots:[],menuState:t,error:s,initialLoading:a,loadingMore:!n}):this.renderDesktopHistory({snapshotValues:i?i.snapshots:[],menuState:t,error:s,initialLoading:a,loadingMore:!n})})};return(0,v.jsx)(Ki.Z,{...s})},this.renderMobileHistory=e=>{let t,s;return e.loadingMore||0!==e.snapshotValues.length||(t=this.renderUnavailableMessage(bl.noSnapshotsMessage,!1)),s=e.error?(0,v.jsx)("div",{style:bl.wrapStyle,children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,v.jsx)("div",{style:bl.wrapStyle,children:(0,v.jsx)(ts.Z,{})}):(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)(rl.Z,{type:ze.Z.Y,children:this.renderSnapshotsMenuList(e)}),this.renderMobileSnapshotPreview(e.menuState)]}),(0,v.jsx)(u.Z,{menuType:g.og.Modal,title:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,v.jsx)(kl,{}),right:(0,v.jsx)(He.DoneMenuText,{}),onClickRight:$r.U4,header:t,children:s})},this.renderDesktopHistory=e=>{let t;if(e.error)t=(0,v.jsx)("div",{style:bl.wrapStyle,children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})});else if(e.initialLoading)t=(0,v.jsx)("div",{style:bl.wrapStyle,children:(0,v.jsx)(ts.Z,{})});else{const s=e.menuState.snapshot&&Cl({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot});t=s?this.renderUnavailableMessage(s.message,s.tier):e.loadingMore||0!==e.snapshotValues.length?this.renderDesktopSnapshotPreview(e.menuState):this.renderUnavailableMessage(bl.noSnapshotsMessage,!1)}return(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)("div",{style:{display:"flex",flexDirection:"column",width:"calc(100% - 240px)",boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`},children:t}),this.renderDesktopSidebar(e)]})},this.renderSnapshotsMenuList=e=>{const{device:t}=this.environment,{menuState:s,loadingMore:n}=e,a=M.oA(e.snapshotValues.map(((i,n)=>{const a=n>0?e.snapshotValues[n-1]:void 0,o=Cl({snapshot:i,nextFutureSnapshot:a}),r=!o;return{key:i.id,action:()=>{$r.gs({environment:this.environment,snapshot:i,nextFutureSnapshot:a})},render:e=>{const n=i.authors||[],a=this.props.intl.formatList(M.oA(n.map((e=>(0,Xr.nc)({parentStore:s.blockStore,pointer:e}).getDisplayName(this.props.intl)))),{type:"conjunction",style:"narrow"}),l=(0,v.jsx)("div",{style:{...Sa.Z.textOverflowStyle},children:a}),c=Boolean(s.snapshot&&s.snapshot.id===i.id),u=parseInt(i.timestamp),m=u>Date.now()-6*It.A0?(0,Wn.$b)(u,qr.SP,this.props.intl):(0,Wn.Yx)(u,"medium",qr.SP),p=(0,Wn.Yx)(u,"medium_with_time",qr.SP);return r?(0,v.jsx)(X.Z,{render:s=>(0,v.jsx)(at.Z,{...(0,ee.Z)(e,s),title:m,focused:!t.isMobile&&c,caption:l}),renderTooltip:()=>(0,v.jsxs)("div",{style:{maxWidth:270,whiteSpace:"normal"},children:[(0,v.jsx)("div",{children:p}),(0,v.jsx)("div",{children:a})]})},e.key):(0,v.jsx)(X.Z,{render:s=>(0,v.jsx)(at.Z,{...(0,ee.Z)(s,e),title:(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,v.jsx)("div",{style:{...t.isMobile&&{display:"flex",flex:1},...Sa.Z.textOverflowStyle},children:m}),(0,v.jsx)(qi.Z,{subscriptionTier:o.tier,analyticsName:"history_modal",desktopStyle:{marginLeft:8},onClick:()=>this.handleUpgrade(o.tier)})]}),focused:!t.isMobile&&c,caption:l}),renderTooltip:()=>(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Upgrade to view this snapshot.",id:"historyModal.snapshotsMenuList.upgrade.tooltip"}),disableTooltip:!Yr.QM},e.key)}}}))),o=s.snapshot&&s.snapshot.id,r=a.findIndex((e=>o===e.key)),l=[{key:"snapshots",render:e=>(0,v.jsx)(O.Z,{...e}),items:a}];return(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)(L.Z,{type:L.i.Vertical,initialFocus:r,sections:l}),(0,v.jsx)(nl.Z,{loading:n,fetchSize:s.size,resultSize:e.snapshotValues.length,onLoadMore:$r.FF}),(0,v.jsx)(Rs.Z,{show:n,showDelay:300,showHold:100,render:e=>e&&(0,v.jsx)("div",{style:bl.wrapStyle,children:(0,v.jsx)(ts.Z,{})})})]})},this.handleUpgrade=e=>{Jr.y(this.environment,{from:"history_modal",for:e})},this.getAriaLabel=()=>this.props.intl.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"}),this.loadSnapshotsList=async(e,t)=>{const{device:s}=this.environment,i=await Sn.getSnapshotsList(this.environment,e);if("failed"===i.type)throw i.error;const{snapshots:n}=i.data;if(t.pageHasCollection=n.some((e=>{var t;const s=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return s&&0!==s})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),s=n.findIndex((t=>parseInt(t.timestamp)<e));0===n.length||(0===s?$r.gs({environment:this.environment,snapshot:n[s],nextFutureSnapshot:void 0}):s>0?$r.gs({environment:this.environment,snapshot:n[s-1],nextFutureSnapshot:s>1?n[s-2]:void 0}):n.length<t.size?$r.gs({environment:this.environment,snapshot:n[n.length-1],nextFutureSnapshot:n.length>1?n[n.length-2]:void 0}):$r.FF())}else Boolean(t.snapshot)||s.isMobile||sl.Z.setState({...t,snapshot:n[0],nextFutureSnapshot:void 0});return i.data},this.iconSize=()=>{const{device:e}=this.environment;return e.isMobile?24:20}}renderComponent(){const{device:e}=this.environment,t=sl.Z.state;return e.isMobile?(0,v.jsx)(m.ZP,{ariaLabel:this.getAriaLabel(),popupType:m.ZP.PopupType.SlideUp,open:t.open,render:this.renderSnapshotsListRequest,onDismiss:$r.U4}):(0,v.jsx)(al.Z,{ariaLabel:this.getAriaLabel(),open:t.open,innerStyle:{height:"80vh",width:"80vw",overflow:"hidden",display:"flex"},onDismiss:$r.U4,render:this.renderSnapshotsListRequest,className:p.Nn$})}renderMobileSnapshotPreview(e){return(0,v.jsx)(m.ZP,{popupType:m.ZP.PopupType.SlideUp,open:Boolean(e.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!e.snapshot)return;const t=Cl({snapshot:e.snapshot,nextFutureSnapshot:e.nextFutureSnapshot}),s=!t,i=s?(0,v.jsx)(Sl,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}):this.renderUnavailableMessage(t.message,t.tier);return(0,v.jsx)(u.Z,{menuType:g.og.Modal,title:(0,Wn.$b)(parseInt(e.snapshot.timestamp),qr.SP,V.default.getIntl()),right:(0,v.jsx)(He.DoneMenuText,{}),onClickRight:$r.zb,leftDisabled:!s,left:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>$r.xx(this.environment),whiteBackground:s,forceFullScreenSlideUp:!0,children:i})}})}renderDesktopSidebar(e){const{menuState:t}=e,s=Boolean(t.snapshot&&!Cl({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot})&&function(e,t){return(0,tr.k5)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(t,this.environment));return(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexShrink:0,width:240},children:[(0,v.jsx)(rl.Z,{type:ze.Z.Y,style:{flex:1},children:this.renderSnapshotsMenuList(e)}),(0,v.jsxs)("div",{style:{display:"flex",padding:14,borderTop:`\n\t\t\t\t\t\t\t1px solid ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`},children:[(0,v.jsx)(X.Z,{disableTooltip:s,renderTooltip:()=>(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:e=>(0,v.jsx)(Oi.Z,{isLarge:!0,onClick:()=>$r.xx(this.environment),disabled:!s,...e,children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Restore version",id:"historyModal.desktopModal.restoreButton.label"})})}),(0,v.jsx)(Wi.Z,{isLarge:!0,style:{marginLeft:12},onClick:$r.U4,children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Cancel",id:"historyModal.desktopModal.cancelButton.label"})})]}),(0,v.jsx)(O.Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,v.jsx)(ll.Z,{title:(0,v.jsx)(d.FormattedMessage,{id:"historyModal.desktopModal.learnMoreButton.label",defaultMessage:"Learn about page history"}),href:(0,tl.UY)("guides.pageHistory"),analyticsFrom:"page_history"})})]})}renderDesktopSnapshotPreview(e){if(e.snapshot)return(0,v.jsxs)(i.Fragment,{children:[(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",flexShrink:0,height:45,fontSize:14,paddingLeft:14},children:[e.blockStore.hasIcon()&&(0,v.jsx)(uo.Z,{disabled:!0,icon:e.blockStore.getIcon(),isEmptyPage:e.blockStore.isEmptyPage(),size:this.iconSize(),style:{marginRight:6}}),(0,v.jsx)(ol.Z,{store:e.blockStore})]}),(0,v.jsx)(Sl,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp})]})}renderUnavailableMessage(e,t){const{device:s}=this.environment,i=cn.default.state.data;let n=Tl(t,this.environment);const a=i&&un.GJ(i);return n&&(0,el.S$)({environment:this.environment})&&"personal"===t&&!a&&(n=!1),(0,v.jsxs)("div",{style:this.getUnavailableMessageStyle(),children:[Tl(t,this.environment)&&this.renderVersionHistoryIcon(),(0,v.jsx)("div",{style:{...!s.isMobile&&{maxWidth:340}},children:e}),n&&t&&(0,v.jsx)(Oi.Z,{isLarge:!0,onClick:()=>this.handleUpgrade(t),style:{marginTop:16},children:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Upgrade",id:"historyModal.upgradeForHistoryButton.label"})})]})}renderVersionHistoryIcon(){return(0,Hr.w)({width:64,height:"auto",fill:this.theme.lightIconColor,marginBottom:12})}getUnavailableMessageStyle(){const{device:e}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,...e.isMobile?{position:"relative",zIndex:1,background:this.theme.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t0 -1px 0 ${this.theme.regularDividerColor},\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`}:{height:"100%"}}}}bl.displayName="HistoryModal",bl.noSnapshotsMessage=(0,v.jsx)(d.FormattedMessage,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"}),bl.wrapStyle={display:"flex",justifyContent:"center",padding:32};const Ml=(0,d.injectIntl)(bl);function jl(){return Qr.sb.filter((e=>"personal"!==e.tier))}function wl(e){const t=jl(),s=t.findIndex((t=>t.tier===e));if(!(s<=0))return t[s-1]}function Cl(e){var t;if(_t.default.isAdminMode)return;const{nextFutureSnapshot:s}=e;if(!s)return;const i=(n=s,(Date.now()-parseInt(n.timestamp))/It.A0);var n;if((0,il.Aw)()&&i<=Qr.hy.plus.days)return;const a=function(e){return jl().filter((t=>t.days>e)).map((e=>e.tier))}(i);if((0,il.p4)(a))return;const o=a[0]??"enterprise";return(0,Yr.QM)(o)?void 0:{tier:o,message:(0,v.jsx)(d.FormattedMessage,{defaultMessage:"Please upgrade to the {upsellTier} Plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,Gr.Z)((0,Yr.eR)(o)?"plus":o),snapshotLimitDays:(null===(t=wl(o))||void 0===t?void 0:t.days)??Math.floor(i)}})}}function kl(){return(0,v.jsx)(dl.Z,{href:(0,tl.UY)("guides.pageHistory"),analyticsFrom:"page_history"})}function Tl(e,t){const{device:s}=t;return!s.isMobile||"personal"===e&&(0,el.S$)({environment:t})}var Il=s(30397);const Pl=function(){window.__c={n:"TeamsInSpaceListener"};const e=(0,n.O7)(),{currentSpaceStore:t,currentUserStore:s}=(0,a.Kw)(ae.default),[,o,r]=(0,a.AF)(Il.Z),l=null==s?void 0:s.id;return(0,i.useEffect)((()=>{if(!t||!l)return;const s=Re.Z.addListener((0,Ae.je)(t.id),(async(s,i)=>{if(!r.shouldRefetchTeamsInSpace({currentUserId:l,currentSpaceId:t.id,emitValue:i}))return;const n=await(0,Ce.qX)({environment:e,spaceStore:t,includeArchived:!1,currentUserId:l});o({teams:n,lastEmitData:{spaceId:t.id,userId:l,value:i}})}),void 0,e);return function(){s&&Re.Z.removeListener(s,e)}}),[t,l,e,o,r]),null};var _l=s(13148),Zl=s(42631),Fl=s(4926),Al=s(1634);class Rl extends l.Z{constructor(){super(...arguments),this.handleConnectClick=async()=>{const e=Al.Z.state,{currentSpaceStore:t}=ae.default.state;e.open&&t&&(await Zl.hM({environment:this.environment,integration:e.integration,spaceId:t.id,unfurlUrl:e.unfurlUrl,externalObjectInstanceBlockId:e.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),this.markPopupAsDismissed(e.integration.id),Al.Z.reset())},this.handleCloseClick=()=>{const e=Al.Z.state;e.open&&this.markPopupAsDismissed(e.integration.id),Al.Z.reset()},this.markPopupAsDismissed=e=>{const{currentUserSettingsStore:t}=ae.default.state;t&&k.createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:this.environment,perform:s=>{ie.GK({transaction:s,userSettingsStore:t,integrationId:e})}})}}renderComponent(){const e=Al.Z.state;if(!e.open)return;const t=e.integration.info.icon;return t?(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:this.theme.popoverBackground,borderRadius:4,boxShadow:this.theme.lightBoxShadow,position:"absolute",bottom:65+Fl.Z.state,right:16+Fl.Z.state,width:240,zIndex:Gt.hT,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,v.jsx)(Vi.Z,{type:"image_url",imageURL:t,size:38,style:{marginBottom:6}}),(0,v.jsx)("div",{style:{color:this.theme.regularTextColor,fontSize:14,fontWeight:Sa.Z.fontWeight.semibold,marginBottom:6,textAlign:"center"},children:(0,v.jsx)(d.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:e.integration.name}})}),(0,v.jsxs)("div",{style:{color:this.theme.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,v.jsx)(d.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,v.jsx)(bn.Z,{href:(0,tl.UY)("guides.unfurling"),external:!0,children:(0,v.jsx)(d.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,v.jsx)(Oi.Z,{onClick:this.handleConnectClick,style:{width:"100%"},children:(0,v.jsx)(d.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,v.jsx)(Qi.Z,{icon:_l.U,onClick:this.handleCloseClick,style:{position:"absolute",top:6,right:6}})]}):void 0}}Rl.displayName="UnfurlingInformationPopup";const Dl=(0,d.injectIntl)(Rl);var Bl=s(61202),Ll=s(80064);class Nl extends l.Z{constructor(){super(...arguments),this.menuRef=(0,i.createRef)(),this.renderMenu=()=>{const{device:e}=this.environment,t=Ll.Z.state;if(!t.open)return;const{allOptionTypes:s}=t,i={key:"embed section",render:e=>(0,v.jsx)(O.Z,{...e}),items:s.map((e=>({key:e,render:t=>(0,v.jsx)(at.Z,{...t,title:(0,v.jsx)(El,{optionType:e}),onMouseEnter:s=>{t.onMouseEnter(s),this.updateUnfurlingOptionType(e)}}),action:()=>this.handleDismiss(e)})))};let n;return n=e.isMobile?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:320,maxHeight:"40vh"},(0,v.jsx)(u.Z,{...n,className:p.b_f,ref:this.menuRef,children:(0,v.jsx)(L.Z,{type:L.i.Vertical,sections:[i],initialFocus:0,onKeyboardArrow:this.handleMenuListKeyboardArrow,priority:1,disallowBackspace:!0})})},this.handleDefaultDismiss=()=>{this.handleDismiss(void 0)},this.handleDismiss=e=>{k.createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:this.environment,perform:t=>{Bl.xv({environment:this.environment,setType:e,transaction:t})}})},this.updateUnfurlingOptionType=e=>{k.createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:this.environment,perform:t=>{Bl.hJ({environment:this.environment,type:e,useTemporaryRecordCache:!0,transaction:t,intl:this.props.intl})}})},this.handleMenuListKeyboardArrow=e=>{const t=Ll.Z.state;if(!t.open||void 0===e.indexGlobal)return;const s=t.allOptionTypes[e.indexGlobal];s&&this.updateUnfurlingOptionType(s)},this.handleWindowKeydown=e=>{Ll.Z.state.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&this.handleDismiss(void 0)},this.handleWindowMousedown=e=>{const t=Ll.Z.state,s=this.menuRef.current;if(!t.open||!e.target||!s)return;const i=Is.findDOMNode(s);i&&(i.contains(e.target)||this.handleDismiss(void 0))}}willMount(){(0,Zs.lj)(window,"keydown",this.handleWindowKeydown),(0,Zs.lj)(window,"mousedown",this.handleWindowMousedown)}willUnmount(){(0,Zs.ZV)(window,"keydown",this.handleWindowKeydown),(0,Zs.ZV)(window,"mousedown",this.handleWindowMousedown)}renderComponent(){const{device:e}=this.environment,t=Ll.Z.state;return(0,v.jsx)(m.ZP,{popupType:e.isMobileNative&&!e.isTablet?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:Boolean(t.open&&t.renderRect),originRect:t.open?t.renderRect:void 0,placementToOrigin:m.ZP.Placement.Top,alignmentToOrigin:m.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDefaultDismiss})}}Nl.displayName="UnfurlingMenu";const Ol=(0,d.injectIntl)(Nl);function El(e){let{optionType:t}=e;return"preview"===t?(0,v.jsx)(d.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"}):"mention"===t?(0,v.jsx)(d.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"}):"link"===t?(0,v.jsx)(d.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"}):"collection"===t?(0,v.jsx)(d.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Paste as database"}):void(0,Ps.t1)(t)}const Vl=function(){window.__c={n:"AppComponents"};const e=(0,n.Fy)(),t=(0,n.O7)(),{isMobile:s,isElectron:l}=e;(0,i.useEffect)((()=>{if(s){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[s]);const{currentSpaceStore:d,teamsEnabled:c}=(0,a.VK)((()=>({currentSpaceStore:ae.default.state.currentSpaceStore,teamsEnabled:(0,Ce.bq)()})),[]);(0,i.useEffect)((()=>{function e(){Pe.Z.setState({open:!0})}function t(){Pe.Z.setState({open:!1})}return o.inPageSearch.started.addListener(e),o.inPageSearch.stopped.addListener(t),()=>{o.inPageSearch.started.removeListener(e),o.inPageSearch.stopped.removeListener(t)}}),[]),(0,i.useEffect)((()=>{function s(s){e.isAndroid||Ie.default.isOnboarding||(0,je.ZP)({event:s,context:je.Af.EditorContextMenu,callback:()=>{e.isElectron||t.currentUser.isLoggedIn()&&s.preventDefault()}})}return window.addEventListener("contextmenu",s),()=>{window.removeEventListener("contextmenu",s)}}),[e.isAndroid,e.isElectron,t.currentUser]),(0,i.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,i.useEffect)((()=>{function e(e){Fe.Z.state.isActive&&(e.preventDefault(),r.MZ({environment:t,currentX:Fe.Z.state.currentX,currentY:Fe.Z.state.currentY,toggle:e.shiftKey}))}function s(e){Fe.Z.state.isActive&&(e.preventDefault(),r.MZ({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function i(e){Fe.Z.state.isActive&&((0,we.N9)(e)||e.preventDefault(),r.qw(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",s),window.addEventListener("mouseup",i),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",i)}}),[t]);const u=t.currentUser.isLoggedIn();return(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)(et,{}),(0,v.jsx)(h.LazyNewDiscussionMenu,{}),(0,v.jsx)(b,{}),(0,v.jsx)(Te,{}),(0,v.jsx)(Ne.Z,{priority:-1,capture:!0}),(0,v.jsx)(_r,{}),u&&!s&&(0,v.jsx)(Or,{}),u&&d&&(0,v.jsx)(Ga,{rootStore:d}),u&&(0,v.jsx)(Pl,{}),u&&c&&(0,v.jsx)(Le,{}),(0,v.jsx)(ft.Z,{}),(0,v.jsx)(Oa,{}),(0,v.jsx)(h.LazyBlockMenu,{}),(0,v.jsx)(ho,{}),(0,v.jsx)(ro,{}),(0,v.jsx)(os,{}),(0,v.jsx)(pt,{}),!s&&(0,v.jsx)(Yo,{}),(0,v.jsx)(Ts,{}),(0,v.jsx)(eo,{}),(0,v.jsx)(On,{}),(0,v.jsx)(gt.Z,{store:_e.Z}),(0,v.jsx)(gt.Z,{store:Ze.Z}),(0,v.jsx)(Za,{}),(0,v.jsx)(h.LazySlashMenu,{}),(0,v.jsx)(be,{}),(0,v.jsx)(Lt,{}),(0,v.jsx)(Ol,{}),(0,v.jsx)(Bs,{}),(0,v.jsx)(Dl,{}),(0,v.jsx)(lt,{}),(0,v.jsx)(zr,{}),(0,v.jsx)(gi,{}),l&&(0,v.jsx)(h.LazyElectronContextMenu,{}),(0,v.jsx)(jt,{}),(0,v.jsx)(ht.Z,{}),u&&(0,v.jsx)(Ml,{}),(0,v.jsx)(ys.s6,{})]})}},13713:(e,t,s)=>{s.d(t,{B:()=>j,Z:()=>w});s(67294);var i=s(13991),n=s(480),a=s(86628),o=s(24405),r=s(66897),l=s(41432),d=s(7057),c=s(31412),u=s(83420),m=s(40959),p=s(33929),g=s(4023),h=s(77080),f=s(24039),y=s(28992),x=s(72495),v=s(26388),S=s(64369),b=s(85893);function M(e){var t;let{isMobile:s,blockType:i,blockFormat:n}=e;window.__c={n:"BlockNameExp"};if(!(0,a.VK)((()=>{var e;return!(!i||null===(e=m.Hc[i])||void 0===e||!e.displayName)&&"on"===h.default.getEligibleGroup({experimentId:"block_names_in_six_dot_menu",defaultGroup:"control"})}),[i])||!i||null===(t=m.Hc[i])||void 0===t||!t.displayName)return null;let o=m.Hc[i].displayName;if(l.wZ[i]&&null!=n&&n.toggleable){const e=l.wZ[i];o=m.Hc[e].displayName}return(0,b.jsx)(S.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:s,style:{marginBottom:4},children:o})}function j(e){const t=e.getCreatedByPointer(),s=e.getCreatedTime(),n=e.getLastEditedByPointer(),a=e.getLastEditedTime(),o=e.getType(),r=e.getFormat(),l=p.default.getIntl();if(t&&s&&a&&n){const c=(0,u.ue)({parentStore:e,pointer:t}),m=(0,d.$b)(s,i.SP,l),p=(0,u.ue)({parentStore:e,pointer:n}),g=(0,d.$b)(a,i.SP,l);if(!p)return;return{createdBy:c,createdTime:m,lastEditedBy:p,lastEditedTime:g,type:o,format:r}}}const w=function(e){let{isPageMoreButton:t,hideTopBorder:s,store:i}=e;window.__c={n:"BlockAuthorInfo"};const l=(0,a.VK)((()=>j(i)),[i]),{device:d}=(0,n.O7)(),u=(0,a.VK)((()=>d.isPhone),[d]),m=p.default.getIntl(),h=(0,o.yK)((()=>({menuItem:{paddingTop:u?8:s?0:6,paddingBottom:u?8:16}})),[s,u]);return(0,b.jsx)(x.Z,{topBorder:!t&&!s,style:{paddingTop:t?0:8,paddingBottom:8},children:(0,b.jsx)(y.Z,{style:l?void 0:h.menuItem,shouldWrapTitle:!0,title:l?(0,b.jsx)(v.Z,{placement:g.u.Right,render:e=>(0,b.jsxs)("div",{...e,children:[(0,b.jsx)(M,{isMobile:d.isPhone,blockType:l.type,blockFormat:l.format}),(0,b.jsx)(S.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:d.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,b.jsx)(c.FormattedMessage,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:l.lastEditedBy.asActor?(0,r.$4)(m,l.lastEditedBy):void 0}})}),(0,b.jsx)(S.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:d.isPhone,children:l.lastEditedTime})]}),renderTooltip:()=>(0,b.jsx)(f.Z,{store:i,compactFormat:!0})}):void 0,loading:!l})})}},98692:(e,t,s)=>{s.d(t,{Z:()=>g});s(67294);var i=s(480),n=s(86628),a=s(31412),o=s(91376),r=s(1865),l=s(35700),d=s(78291),c=s(70060),u=s(88893),m=s(7124),p=s(85893);const g=function(e){window.__c={n:"BlockLimitUsage"};const{source:t,isButtonDisabled:s}=e,g=(0,i.O7)(),{isAdmin:h,isEligibleForGracePeriod:f,blockUsageData:y}=(0,n.VK)((()=>{const{data:e}=d.default.state;return{isAdmin:u.GJ(e),isEligibleForGracePeriod:(0,c.du)(),blockUsageData:e?{blockUsage:u.Lz(g,e),percentageUsed:u.zl(g,e),approachingBlockLimit:u.XZ(g,e),usageDescription:u.cA(g,e)}:void 0}}),[g]);return y&&0!==y.blockUsage&&y.approachingBlockLimit?(0,p.jsx)(l.J,{title:(0,p.jsx)(a.FormattedMessage,{id:"spaceSettings.sidebar.upgradeLink",defaultMessage:"Upgrade to go unlimited"}),description:(0,p.jsx)(m.q,{styleName:"Body-12px/Regular",colorName:!f&&y.percentageUsed>u.Tj?"destructive":void 0,children:y.usageDescription}),cta:h?(0,p.jsx)(a.FormattedMessage,{id:"spaceSettings.sidebar.button.upgrade",defaultMessage:"Upgrade plan"}):(0,p.jsx)(a.FormattedMessage,{id:"spaceSettings.sidebar.button.contactWorkspaceOwner",defaultMessage:"Contact a workspace owner"}),onClick:()=>{h||o.r$(),r.y(g,{from:"sidebar"===t?"block_limit_sidebar":"block_limit_settings",for:"plus"})},progressPercent:f?void 0:y.percentageUsed,isButtonDisabled:s}):null}},99662:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Pe});s(67294);var i=s(83355),n=s(480),a=s(86628),o=s(72126),r=s(29369),l=s(97880),d=s(31412),c=s(41363),u=s(72495),m=s(35067),p=s(85893);const g=[{key:"block in comment menu primary",render:e=>(0,p.jsx)(u.Z,{...e}),actions:[m.G,c.yN,c.TH]}];var h=s(24212),f=s(82763),y=s(34658);const x=[{key:"page mention context menu primary",render:e=>(0,p.jsx)(u.Z,{isTitleUppercase:!1,...e}),actions:[y.sN,y.Jw,y.KB,y.oL,f.K,f.H]}];var v=s(50906),S=s(6404),b=s(28020),M=s(75079),j=s(87279),w=s(18514),C=s(35328),k=s(94841),T=s(8848),I=s(40745),P=s(37652),_=s(33907),Z=s(8597),F=s(80988),A=s(53465),R=s(88437),D=s(77734),B=s(73599),L=s(37612),N=s(62967),O=s(39699),E=s(41216),V=s(19037),U=s(80025),W=s(33929),K=s(98794);const z=(0,d.defineMessages)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),q=(0,N.wL)({key:"simple table header column",displayName:z.simpleTableHeaderColumn,label:W.default.formatMessage(z.simpleTableHeaderColumn),property:"table_block_row_header",svg:D.s,validators:[V.J5,V.ff(V.b4),V.W5,V.p4],afterAction:(e,t)=>{}}),G=(0,N.wL)({key:"simple table header row",displayName:z.simpleTableHeaderRow,label:W.default.formatMessage(z.simpleTableHeaderRow),property:"table_block_column_header",svg:B.f,validators:[V.J5,V.ff(V.b4),V.W5,V.zO],afterAction:(e,t)=>{}}),H=(0,N.cN)({key:"insert column left",displayName:z.simpleTableInsertColumnLeft,analyticsName:z.simpleTableInsertColumnLeft.defaultMessage,svg:P.V,validators:[V.J5,V.ff(V.fI),V.W5,V.z2],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,perform:e=>{K.insertColumnLeft({environment:t,transaction:e})}})}}),Q=(0,N.cN)({key:"insert column right",displayName:z.simpleTableInsertColumnRight,analyticsName:z.simpleTableInsertColumnRight.defaultMessage,svg:_.n,validators:[V.J5,V.ff(V.fI),V.W5,V.z2],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,perform:e=>{K.insertColumnRight({environment:t,transaction:e})}})}}),Y=(0,N.cs)({key:"duplicate columns",displayName:N.RE.duplicateName,analyticsName:N.RE.duplicateName.defaultMessage,svg:R.a,validators:[V.J5,V.ff(V.fI),V.W5,V.z2],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,perform:e=>{K.duplicateColumns({transaction:e})}})}}),$=(0,N.cs)({key:"delete columns",displayName:N.RE.deleteName,analyticsName:N.RE.deleteName.defaultMessage,svg:L.y,validators:[V.J5,V.ff(V.fI),V.W5,V.OT,V.z2],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,perform:e=>{K.deleteColumns({environment:t,transaction:e})}})}}),J=(0,N.cN)({key:"clear column contents",displayName:z.simpleTableClearContents,analyticsName:z.simpleTableClearContents.defaultMessage,svg:A.X,validators:[V.J5,V.ff(V.fI),V.W5,V.z2],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,perform:e=>{K.clearSelectionContents({environment:t,transaction:e})}}),K.clearSelection()}}),X=(0,N.cN)({key:"insert row above",displayName:z.simpleTableInsertRowAbove,analyticsName:z.simpleTableInsertRowAbove.defaultMessage,svg:Z.Z,validators:[V.J5,V.ff(V.fI),V.W5,V.EJ],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,perform:e=>{K.insertRowAbove({environment:t,transaction:e})}})}}),ee=(0,N.cN)({key:"insert row below",displayName:z.simpleTableInsertRowBelow,analyticsName:z.simpleTableInsertRowBelow.defaultMessage,svg:I.M,validators:[V.J5,V.ff(V.fI),V.W5,V.EJ],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,perform:e=>{K.insertRowBelow({environment:t,transaction:e})}})}}),te=(0,N.cs)({key:"duplicate rows",displayName:N.RE.duplicateName,analyticsName:N.RE.duplicateName.defaultMessage,svg:R.a,validators:[V.J5,V.ff(V.fI),V.W5,V.EJ],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,perform:e=>{K.duplicateRows({environment:t,transaction:e})}})}}),se=(0,N.cs)({key:"delete rows",displayName:N.RE.deleteName,analyticsName:N.RE.deleteName.defaultMessage,svg:L.y,validators:[V.J5,V.ff(V.fI),V.W5,V.W3,V.EJ],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,perform:e=>{K.deleteRows({environment:t,transaction:e})}})}}),ie=(0,N.cN)({key:"clear row contents",displayName:z.simpleTableClearContents,analyticsName:z.simpleTableClearContents.defaultMessage,svg:A.X,validators:[V.J5,V.ff(V.fI),V.W5,V.EJ],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,perform:e=>{K.clearSelectionContents({environment:t,transaction:e})}}),K.clearSelection()}}),ne=[V.J5,V.ff(V.fI),V.W5,V.z2],ae=[V.J5,V.ff(V.fI),V.W5,V.EJ];function oe(e,t,s,i){const n=i||(0,U.qf)(e),a=(0,N.cN)({key:`color ${s||e}`,displayName:n,analyticsName:n.defaultMessage,fuzzySearchKeywords:(0,N.CJ)(e),validators:"column"===t?ne:ae,action:t=>{let{blocks:s,environment:i}=t;O.createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:i,perform:t=>{K.setColor(i,e,t)}})},closeParentMenu:!0,render:t=>(0,p.jsx)(E.Z,{...t,color:e,overrideDisplayName:a.displayName}),nativeRender:t=>{let{environment:i}=t;return(0,N.fi)(i,e,s)}});return a}const re=(0,N.$J)({key:"simple table column background color actions",title:N.RE.backgroundSection,overrideSearchTitle:N.RE.backgroundSectionKeywords,render:e=>(0,p.jsx)(u.Z,{...e}),actions:[oe("default","column","default background",U.mF.backgroundColorDefault),...T._K.map((e=>oe(e,"column")))]}),le=(0,N.$J)({key:"simple table column text color actions",title:N.RE.colorSection,overrideSearchTitle:N.RE.colorSection,render:e=>(0,p.jsx)(u.Z,{...e}),actions:[...T.CY.map((e=>oe(e,"column")))]}),de=(0,N.$J)({key:"simple table row background color actions",title:N.RE.backgroundSection,overrideSearchTitle:N.RE.backgroundSectionKeywords,render:e=>(0,p.jsx)(u.Z,{...e}),actions:[oe("default","row","default background",U.mF.backgroundColorDefault),...T._K.map((e=>oe(e,"row")))]}),ce=(0,N.$J)({key:"simple table row text color actions",title:N.RE.colorSection,overrideSearchTitle:N.RE.colorSection,render:e=>(0,p.jsx)(u.Z,{...e}),actions:[...T.CY.map((e=>oe(e,"row")))]}),ue=(0,N.MV)({key:"set column color",displayName:N.RE.colorName,analyticsName:N.RE.colorName.defaultMessage,svg:F.U,validators:ne,subActions:()=>[{key:0,title:W.default.formatMessage(z.textColorSection),render:e=>(0,p.jsx)(u.Z,{...e}),actions:le.actions},{key:1,title:W.default.formatMessage(z.backgroundColorSection),render:e=>(0,p.jsx)(u.Z,{...e}),actions:re.actions}]}),me=(0,N.MV)({key:"set row color",displayName:N.RE.colorName,analyticsName:N.RE.colorName.defaultMessage,svg:F.U,validators:ae,subActions:()=>[{key:0,title:W.default.formatMessage(z.textColorSection),render:e=>(0,p.jsx)(u.Z,{...e}),actions:ce.actions},{key:1,title:W.default.formatMessage(z.backgroundColorSection),render:e=>(0,p.jsx)(u.Z,{...e}),actions:de.actions}]}),pe=[(0,N.$J)({key:"column section",render:e=>(0,p.jsx)(u.Z,{...e}),actions:[q,ue,H,Q,Y,J,$]}),(0,N.$J)({key:"row section",render:e=>(0,p.jsx)(u.Z,{...e}),actions:[G,me,X,ee,te,ie,se]})];var ge=s(80444),he=s(8949),fe=s(26350),ye=s(27724),xe=s(13713),ve=s(80209),Se=s(48019),be=s(68894),Me=s(3386),je=s(78140),we=s(40721),Ce=s(53437),ke=s(83182);class Te extends i.Z{constructor(){super(...arguments),this.renderOverlay=()=>{const{device:e}=this.environment,t=he.Z.state;if(!t.isActive)return;const{originBlockRect:s,actionSectionGroupKey:i,inputValue:n,publicEditMode:a}=t,r={environment:this.environment,blocks:t.stores,originRect:s,publicEditMode:a},l=t.showInput&&this.renderInputSection(),c=t.stores[0];let u;return u=e.isPhone?{menuType:j.og.Modal,title:(0,p.jsx)(d.FormattedMessage,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:(0,p.jsx)(we.DoneMenuText,{}),onClickRight:this.handleOverlayBgClick,header:l}:{menuType:j.og.Popup,width:265,header:l},(0,p.jsx)(Me.Z,{capture:!0,onBackspace:o.yR,children:(0,p.jsxs)(je.Z,{...u,children:[(0,p.jsx)(Se.Z,{filter:n,context:r,sections:Ie(i),onAccept:this.handleAccept,initialFocus:n?0:void 0}),!n&&(0,p.jsx)(Ze,{}),!n&&(0,p.jsx)(ve.Z,{store:c}),!n&&c.isCollectionView()&&(0,p.jsx)(_e,{})]})})},this.handleOverlayBgClick=()=>{S.xv()},this.handleAccept=e=>{const t=he.Z.state;if(!t.isActive)return;const{stores:s}=ye.default.state,{analyticsFrom:i,collectionContextStore:n}=t,a=s[0];if(a){const t=a.getParentTable(),s=a.getType();if(s&&t){let o;if(t===r.e0){const e=a.getParentId(),{currentSpaceStore:t}=ge.default.getState();t&&void 0!==e&&(o=fe.zX.createChildStore(t,{table:r.e0,id:e}))}const l=(0,M.Pn)(n)||{};v.dhV(this.environment,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:i,block_id:a.id,block_type:s,parentTeamStore:o,is_toggleable:(0,C._A)(s,a.getFormat()),...l})}}e.closeParentMenu&&S.xv()},this.handleInputChange=e=>{he.Z.state.isActive&&he.Z.setState({...he.Z.state,inputValue:e.target.value})}}renderComponent(){const{device:e}=this.environment,t=he.Z.state;return(0,p.jsx)(Ce.ZP,{popupType:e.isPhone?Ce.ZP.PopupType.SlideUp:Ce.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:this.handleOverlayBgClick,placementToOrigin:Ce.ZP.Placement.Bottom,alignmentToOrigin:Ce.ZP.Alignment.Start,originGap:0,preventScaleTransition:!0,render:this.renderOverlay,preventBlockRenderQueueOnEnter:e.isMobile})}renderInputSection(){const{device:e}=this.environment,{intl:t}=this.props,s=he.Z.state;if(!s.isActive||e.isPhone)return;const{inputValue:i}=s;return(0,p.jsx)(u.Z,{isInput:!0,children:(0,p.jsx)(be.ZP,{value:i,onChange:this.handleInputChange,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0})})}}function Ie(e){switch(e){case"default":return c.Qi;case"simple_table":return pe;case"page_mention":return x;case"sidebar_outliner":return h.Oq;case"comment_media":return g;default:(0,l.t1)(e)}}Te.displayName="BlockMenu";const Pe=(0,d.injectIntl)(Te);function _e(){window.__c={n:"CollectionHelpButton"};const[e,t]=(0,a.VK)((()=>{const e=he.Z.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,b.qG)(t.id)]}),[]);return e?t?(0,p.jsx)(u.Z,{topBorder:!0,children:(0,p.jsx)(ke.Z,{title:(0,p.jsx)(d.FormattedMessage,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:k.h5,analyticsFrom:"block_menu"})}):(0,p.jsx)(u.Z,{topBorder:!0,children:(0,p.jsx)(ke.Z,{title:(0,p.jsx)(d.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,w.UY)("guides.database"),analyticsFrom:"block_menu"})}):null}function Ze(){window.__c={n:"BlockAuthorInfoWrapper"};const e=(0,n.O7)(),t=(0,a.VK)((()=>he.Z.state),[]),s=(0,a.VK)((()=>e.currentUser.isLoggedIn()),[e]),i=(0,a.VK)((()=>t.isActive&&1===t.stores.length&&(0,b.qG)(t.stores[0].id)),[t]);return s?!t.isActive||t.stores.length>1||i?null:(0,p.jsx)(xe.Z,{store:t.stores[0],isPageMoreButton:!1}):null}},80209:(e,t,s)=>{s.d(t,{Z:()=>f});s(67294);var i=s(83355),n=s(26825),a=s(82990),o=s(31412),r=s(47307),l=s(76464),d=s(18878),c=s(19037),u=s(98165),m=s(64921),p=s(64369),g=s(85893);class h extends i.Z{constructor(){super(...arguments),this.handleRestorePermissionAction=async()=>{const{store:e}=this.props,t=e.getPermissionItems(),s=u.Om(e),i=s?n.Wo(u.fJ(s)):[],a={type:"restore",permissionChanges:n.Xr(t,i)};await r.confirmUserAction({message:(0,d.mX)(a),acceptLabel:(0,d.nH)(a),cancelLabel:(0,g.jsx)(o.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,g.jsx)(d.mo,{openState:a})})&&l.hs({environment:this.environment,store:e})}}renderComponent(){const{store:e}=this.props,t={environment:this.environment,blocks:[e],publicEditMode:void 0};if(c.xD([c.X,c.ff(c.J5)])(t)){const{device:e}=this.environment,s=c.xD([c.c2,c.ff(c.zz)])(t);return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{style:{backgroundColor:this.theme.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${this.theme.regularDividerColor}`,marginTop:e.isMobile?28:1},children:(0,g.jsxs)(m.Z,{disabled:!s,style:{padding:12},onClick:this.handleRestorePermissionAction,children:[(0,g.jsx)(p.Z,{isMultiline:!0,isSmall:!0,children:(0,g.jsx)(o.FormattedMessage,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),s&&(0,g.jsx)(p.Z,{style:{marginTop:6,fontWeight:a.Z.fontWeight.semibold},children:(0,g.jsx)(o.FormattedMessage,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})})]})})})}}}h.displayName="BlockMenuRestrictedMessage";const f=h},81870:(e,t,s)=>{s.d(t,{Z:()=>c});s(67294);var i=s(480),n=s(24405),a=s(84169),o=s(50906),r=s(73063),l=s(16354),d=s(85893);const c=function(e){window.__c={n:"CollectionMenuHelpButton"};const t=(0,i.O7)(),s=(0,n.Fg)();return(0,d.jsx)(l.Z,{href:e.href,external:!0,onClick:()=>o.Fsx(t,{from:e.helpButtonContext}),children:(0,d.jsx)(r.Z,{icon:a.m,style:{height:24,width:24,marginRight:-6,fill:s.mediumIconColor}})})}},8895:(e,t,s)=>{s.r(t),s.d(t,{CollectionTypedDatabaseMigrationModal:()=>te});var i=s(67294),n=s(86628),a=s(45433),o=s(52489),r=s(24405),l=s(41892),d=s(6926),c=s(81570),u=s(31412),m=s(33929),p=s(72395),g=s(44731),h=s(51077),f=s(64369),y=s(85893);const x=(0,u.defineMessages)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),v=[{icon:"📅",taskName:m.default.formatMessage(x.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,c.T)({width:13,fill:"#448361"})},{icon:"📚",taskName:m.default.formatMessage(x.dummyTask2),status:"In Progress",teamspace:"Design",location:(0,d.s)({width:13,fill:"#CB912F"})},{icon:"🎨",taskName:m.default.formatMessage(x.dummyTask3),status:"In Progress",teamspace:"Design",location:(0,d.s)({width:13,fill:"#CB912F"})},{icon:"🛫",taskName:m.default.formatMessage(x.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,c.T)({width:13,fill:"#448361"})},{icon:"🚧",taskName:m.default.formatMessage(x.dummyTask5),status:"Not Started",teamspace:"Design",location:(0,d.s)({width:13,fill:"#CB912F"})},{icon:"👩‍💻",taskName:m.default.formatMessage(x.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,c.T)({width:13,fill:"#448361"})}],S={Blocked:"red","In Progress":"blue","Not Started":"gray"};function b(){window.__c={n:"MyTasksWidgetPreview"};const e=w();return(0,y.jsxs)("div",{style:e.fullBackgroundColor,children:[(0,y.jsxs)("div",{style:e.fullPreviewSection,children:[(0,y.jsx)("span",{style:e.emojiTitle,children:"📋"}),(0,y.jsx)(f.Z,{isMultiline:!0,style:e.previewTitle,children:(0,y.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,y.jsx)(p.Z,{title:(0,y.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My Tasks"}),icon:(0,y.jsx)(h.Z,{type:"app_package_asset",size:18,icon:l.Z.images.appPackages.taskDbIconSvg}),panelStyle:e.panelSection,children:(0,y.jsx)("div",{style:e.dummyAssignedToMe,children:(0,y.jsx)(M,{})})})]})}function M(){const e=v.map(((e,t)=>(0,y.jsx)(j,{row:e},t)));return(0,y.jsx)("div",{style:{display:"flex",marginTop:4,paddingLeft:16,paddingRight:16,flexDirection:"column"},children:e})}function j(e){let{row:t}=e;window.__c={n:"ListItem"};const s=w();return(0,y.jsxs)("div",{style:s.eachTask,children:[(0,y.jsxs)("div",{style:s.taskName,children:[(0,y.jsx)("span",{style:s.taskIcon,children:t.icon}),(0,y.jsx)(f.Z,{style:s.taskTitle,children:t.taskName})]}),(0,y.jsx)("div",{style:s.taskStatus,children:(0,y.jsx)(g.J,{type:"status",value:m.default.formatMessage(x[t.status]),color:S[t.status],groupColor:void 0})}),(0,y.jsxs)("div",{style:s.location,children:[(0,y.jsx)("span",{style:s.locationIndicator,children:m.default.formatMessage(x.locationIndicator)}),(0,y.jsx)("div",{style:{...s.locationIcon,..."Design"===t.teamspace?{...s.designTeamspace}:{...s.engTeamspace}},children:t.location})]})]})}function w(){return(0,r.yK)((e=>({fullBackgroundColor:{backgroundColor:e.cardBackground},fullPreviewSection:{display:"flex",alignItems:"center",margin:48,marginBottom:30},emojiTitle:{fontSize:36,marginRight:15},previewTitle:{color:e.regularTextColor,width:350,fontSize:17,fontWeight:500},panelSection:{paddingBottom:0,paddingRight:0,marginLeft:48,marginBottom:45,background:e.migrationMyTasksPreviewBackground},dummyAssignedToMe:{width:"100%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:253,display:"flex"},taskIcon:{fontSize:14,marginRight:8},taskTitle:{color:e.regularTextColor,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:152},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.mediumTextColor,marginRight:4},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}var C=s(480),k=s(15145),T=s(8848),I=s(39068),P=s(42853),_=s(47453),Z=s(72126),F=s(8406),A=s(48299),R=s(64964),D=s(39699),B=s(34045),L=s(93959),N=s(75081),O=s(27383),E=s(87279),V=s(94841),U=s(31194),W=s(1310),K=s(42922),z=s(52275),q=s(31945),G=s(78140),H=s(32163),Q=s(72495),Y=s(74523);function $(e){window.__c={n:"PropertyMappingForm"};const t=(0,C.O7)(),s=(0,u.useIntl)(),l=(0,r.yK)((e=>({propertyMappingForm:{width:350,padding:32,backgroundColor:e.whiteButtonBackground,zIndex:1,borderRadius:"0px 6px 6px 0px",borderStyle:"hidden hidden hidden solid",borderColor:e.regularDividerColor},perPropertyInstruction:{color:e.mediumTextColor,fontSize:12,marginLeft:4},requiredPropertyError:{color:T.ZP.red,fontSize:12},learnMore:{display:"flex",justifyContent:"center",marginTop:17,marginBottom:-11},submitMigrationButton:{display:"flex",height:32},propertyMappingInstructions:{marginBottom:24,color:e.mediumTextColor},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:10,marginLeft:4,fill:e.lightIconColor},propertyMappingTitle:{color:e.lightTextColor},propertyMappingMenu:{borderRadius:4,borderWidth:2,border:"solid",borderColor:e.stroke.deemphasized},checkboxMappingInfo:{display:"flex",alignItems:"center",marginLeft:4,marginTop:3,color:e.lightTextColor},a:{color:"white",cursor:"pointer"}})),[]),{databaseType:d,collectionContextStore:c}=e,[m,p]=(0,i.useState)(!1),g=(0,n.VK)((()=>{var e;return null===(e=c.collectionStore())||void 0===e?void 0:e.getSchema()}),[c]),h=(0,n.VK)((()=>L.ck((0,B.appConfigs)(),d)),[d]),x=(0,n.VK)((()=>{if(g&&h)return L.Au(h,g)}),[h,g]),v=(0,n.VK)((()=>{const e={};return Object.keys(h||{}).filter((e=>void 0!==(null==h?void 0:h[e])&&e.startsWith("notion://"))).forEach((t=>{e[t]=void 0})),Object.entries(x||{}).forEach((t=>{let[s,i]=t;e[s]=i})),e}),[h,x]),[S,b]=(0,i.useState)(v),M=(0,i.useMemo)((()=>Object.entries(S).some((e=>{let[t,s]=e;if(t===a.Es.Status){const e=null==g?void 0:g[s||""];if("checkbox"===(null==e?void 0:e.type))return!0}}))),[g,S]),j=(0,n.VK)((()=>(0,V.J2)("main")),[]),w=(0,n.VK)((()=>{var e;return null==j||null===(e=j.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==j?void 0:j.getRecordModel,pageVisitSource:k.tY.TypedDBConversionToast})}),[j]),$=(0,i.useCallback)(((e,t)=>{const s=t.type;return L.fm(e,t,g??{}).map((e=>{let[t,i]=e;return{key:t,title:null==i?void 0:i.name,icon:(null==i?void 0:i.icon)??I.wG[(null==i?void 0:i.type)||s]({width:16}),type:null==i?void 0:i.type}}))}),[g]),ee=(0,i.useCallback)((e=>{const t=null==h?void 0:h[e];if(!t)return null;const i=[...$(e,t),{key:a.bK,title:s.formatMessage(J.createNew),icon:(0,_.R)({width:16}),type:void 0}],n=S[e],o=null==g?void 0:g[n||""],r=!n&&m,d=e===a.Es.Status;let c=(0,y.jsx)(y.Fragment,{});return n===a.bK?c=(0,_.R)({width:16}):o&&(c=I.wG[null==o?void 0:o.type]({width:16})),(0,y.jsx)(q.ZP,{popupType:q.Z4.Popup,renderOrigin:t=>(0,y.jsxs)("div",{style:{marginBottom:24},children:[(0,y.jsx)(f.Z,{style:l.perPropertyInstruction,children:(0,y.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that shows the {propertyDescription}",values:{propertyDescription:s.formatMessage(X[e])}})}),(0,y.jsx)(z.Z,{focused:!1,icon:c,right:(0,y.jsxs)("div",{style:l.propertyMappingDropdown,children:[r?(0,y.jsx)("span",{style:l.requiredPropertyError,children:(0,y.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,P.i)({...l.chevronDownIconEnabled,...r?{fill:T.ZP.red}:{}})]}),title:n===a.bK?s.formatMessage(J.createNew):o?o.name:s.formatMessage(J.select),titleStyle:n?void 0:l.propertyMappingTitle,style:{...l.propertyMappingMenu,...r?{borderColor:T.ZP.red}:{}},...t}),d&&M&&(0,y.jsx)(f.Z,{isSmall:!0,isMultiline:!0,children:(0,y.jsx)("div",{style:l.checkboxMappingInfo,children:(0,y.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxMappingInfo",defaultMessage:"{checkboxPropertyName} will be converted to a Status property type.",values:{checkboxPropertyName:(null==o?void 0:o.name)||s.formatMessage(J.checkboxPropertyType)}})})})]}),placementToOrigin:U.Iw.Bottom,alignmentToOrigin:U.lU.Start,render:t=>{const s=[{key:"propertyOptions",render:e=>(0,y.jsx)(Q.Z,{...e,topBorder:0!==e.index}),items:i.map((s=>({key:s.key,render:t=>(0,y.jsx)(z.Z,{...t,icon:s.icon,title:s.title,checkState:S[e]===s.key}),action:()=>{b({...S,[e]:s.key}),p(!1),t.close()}})))}],n={menuType:E.og.Popup,width:280};return(0,y.jsx)(G.Z,{...n,children:(0,y.jsx)(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:s})})}},e)}),[s,l,S,m,h,g,$,M]),te=(0,y.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"{databaseType} databases require status, assignee, and due date properties",values:{databaseType:(0,Z.kC)((0,N.sN)(d))}}),se=(0,i.useCallback)((()=>{const e=c.collectionStore(),i=c.collectionViewBlockStore();e&&i&&(!function(e){return!Object.values(e).includes(void 0)}(S)?p(!0):D.createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:t,perform:n=>{A.vD({environment:t,collectionViewBlockStore:i,collectionStore:e,databaseType:d,propertyMapping:{...S},typedPropertySchemas:{...h},transaction:n}),o.Z.setState({isModalOpen:!1,collectionContextStore:void 0}),d===a.iS&&(O.y.locallyMutatedTasksDatabase=!0),F.g2({environment:t,database_type:d,property_mapping:S,collectionContextStore:c}),R.d4({item:{label:(0,y.jsx)(u.FormattedMessage,{defaultMessage:"{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,N.sN)(d),databaseName:e.getName()||s.formatMessage(J.defaultCollectionName),a:e=>(0,y.jsx)("a",{style:l.a,href:w,children:e})}}),durationMs:W.JY},undoFunc:()=>{D.createAndCommit({environment:t,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",perform:e=>{A.RQ({environment:t,collectionContextStore:c,transaction:e})}})}})}}))}),[w,s,l.a,t,d,h,S,c]);return(0,y.jsxs)("div",{style:l.propertyMappingForm,children:[(0,y.jsx)(f.Z,{style:l.propertyMappingInstructions,isMultiline:!0,children:te}),(0,y.jsx)("div",{children:Object.entries(v).map((e=>{let[t,s]=e;return ee(t)}))}),(0,y.jsx)(K.Z,{style:l.submitMigrationButton,onClick:se,children:(0,y.jsx)(u.FormattedMessage,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,N.sN)(d)}})}),(0,y.jsx)("div",{style:l.learnMore,children:(0,y.jsx)(Y.Z,{title:(0,y.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,N.sN)(d)}}),analyticsFrom:"set_database_type",href:V.h5})})]})}const J=(0,u.defineMessages)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Select",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},checkboxPropertyType:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxPropertyType",defaultMessage:"Checkbox"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"task's status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"task's assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"task's due date"}}),X={[a.Es.Status]:J.taskStatus,[a.Es.Assign]:J.taskAssignee,[a.Es.DueDate]:J.taskDueDate};var ee=s(50506);function te(){window.__c={n:"CollectionTypedDatabaseMigrationModal"};const e=(0,n.VK)((()=>o.Z.state),[]);return e.isModalOpen?(0,y.jsx)(ee.Z,{open:e.isModalOpen,onDismiss:()=>o.Z.reset(),render:()=>e.isModalOpen?(0,y.jsxs)("div",{style:{display:"flex"},children:[(0,y.jsx)(b,{}),(0,y.jsx)($,{databaseType:a.iS,collectionContextStore:e.collectionContextStore})]}):null}):null}},44514:(e,t,s)=>{s.d(t,{Q:()=>l});s(67294);var i=s(82990),n=s(52821),a=s(85893);const o={...i.Z.textOverflowStyle,position:"absolute",left:0,right:0,top:0,bottom:0},r={marginLeft:4,fontWeight:i.Z.fontWeight.semibold};function l(e){const{prefix:t,viewName:s,viewType:i}=e;return(0,a.jsxs)("div",{style:{position:"relative",width:"100%"},children:[" ",(0,a.jsxs)("div",{style:o,children:[t,i&&n.aW[i]({marginLeft:8,marginRight:2,width:"1em",display:"inline",verticalAlign:"bottom"}),(0,a.jsx)("span",{style:r,children:s})]})]})}},81933:(e,t,s)=>{s.r(t),s.d(t,{default:()=>L});s(67294);var i=s(83355),n=s(41892),a=s(8848),o=s(64275),r=s(45137),l=s(30845),d=s(72126),c=s(82990),u=s(31412),m=s(50906),p=s(33929),g=s(49085);class h extends g.default{getInitialState(){return{step:"initial"}}}const f=h;var y=s(73796),x=s(480),v=s(24405),S=s(37240),b=s(52275),M=s(63296),j=s(45959),w=s(85893);const C=(0,u.injectIntl)((function(e){window.__c={n:"ContactModalQuestionSelect"};const t=(0,x.O7)(),s=(0,v.Fg)(),{inputStyle:i}=(0,v.yK)((e=>{const{device:s}=t;return{inputStyle:{backgroundColor:e.whiteButtonBackground,height:31,...s.isMobile&&{height:42},padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:4,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${e.outlineButtonBorder}`,background:e.buttonBackground}}}),[t]),{intl:n,question:o}=e,r={setup_trial:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),setup_enterprise_trial:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),setup_business_trial:(0,w.jsx)(u.FormattedMessage,{id:"contactModalQuestionSelect.question.setup_business_trial",defaultMessage:"Setup a business trial"}),live_demo:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.live_demo",defaultMessage:"Schedule a live demo"}),plan_help:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.plan_help",defaultMessage:"Need help choosing a plan"}),other:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.other",defaultMessage:"Other"})},l={menuTitle:n.formatMessage({defaultMessage:"Your question",id:"enterpriseContactModal.yourQuestion.title"}),items:["setup_enterprise_trial","setup_business_trial","live_demo","plan_help","other"],width:"auto",minWidth:280,getKey:e=>e,selectedItem:o,originGap:4,onSelect:t=>{e.onSelect(t)},renderItem:e=>(0,w.jsx)(b.Z,{title:r[e.key],...e}),renderOrigin:t=>(0,w.jsxs)(M.Z,{...t,isLarge:!0,style:{...i,...e.invalid&&{border:`1px solid ${a.ZP.red}`}},children:[(0,w.jsx)("div",{style:{display:"flex",alignItems:"center",color:o?s.regularTextColor:s.lightTextColor},children:o?r[o]:(0,w.jsx)(u.FormattedMessage,{defaultMessage:"Select question",id:"enterpriseContactModal.selectQuestion.label"})}),(0,S.s)({width:10,fill:s.lightIconColor})]})};return(0,w.jsx)(j.Z,{...l},"onboarding")}));var k=s(23063),T=s(42922),I=s(64921),P=s(74194),_=s(3386),Z=s(50506),F=s(89728),A=s(26388),R=s(29551);const D=(0,u.defineMessages)({additionalFeedbackPlaceholder:{id:"enterpriseContactModal.additionalFeedback.placeholder",defaultMessage:"What would you like to learn more about?"}});class B extends i.Z{constructor(){super(...arguments),this.storeTypes={store:f},this.renderMenu=()=>(0,w.jsxs)("div",{style:this.getContainerStyle(),children:[this.renderCancel(),(0,w.jsx)(R.gq,{style:{width:320,height:470,overflow:"hidden",position:"relative",padding:20,cursor:"default",textAlign:"center",justifyContent:"center"},alignItems:"center",alignContent:"center",children:this.renderStep()})]}),this.renderInitial=()=>{const{invalidField:e}=this.stores.store.state;if(y.Z.state.open)return(0,w.jsxs)("div",{style:{...this.getSlideUpStyle(),padding:20},children:[(0,r.o)({width:"100%",height:24}),(0,w.jsx)("div",{style:{fontSize:14,fontWeight:c.Z.fontWeight.semibold,paddingTop:6,paddingBottom:4},children:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.header",defaultMessage:"Get in touch with sales"})}),(0,w.jsx)("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:200,margin:"0 auto"},children:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.caption",defaultMessage:"We'll work with you on your setup and help you land on the best plan."})}),(0,w.jsx)("div",{style:{...this.getLabelStyle(),marginTop:24},children:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.nameLabel",defaultMessage:"Your name"})}),(0,w.jsx)(P.Z,{focusInitial:!0,value:this.getName(),placeholder:"Ada Lovelace",style:{marginRight:4,...this.getInputStyle(),..."name"===e&&N()},onChange:e=>{y.Z.setState({...y.Z.state,open:!0,name:void 0}),this.stores.store.setState({...this.stores.store.state,name:e.target.value}),m.QOK(this.environment,{contactFieldType:"name",contactFieldValue:e.target.value})}}),(0,w.jsx)("div",{style:this.getLabelStyle(),children:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.emailLabel",defaultMessage:"Your work email"})}),(0,w.jsx)(P.Z,{value:this.getEmail(),placeholder:"ada@lovelace.app",type:"email",style:{marginRight:4,...this.getInputStyle(),..."email"===e&&N()},onChange:e=>{y.Z.setState({...y.Z.state,open:!0,email:void 0}),this.stores.store.setState({...this.stores.store.state,email:e.target.value}),m.QOK(this.environment,{contactFieldType:"email",contactFieldValue:e.target.value})}}),(0,w.jsx)("div",{style:this.getLabelStyle(),children:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.companySizeLabel",defaultMessage:"Company size"})}),(0,w.jsx)(R.gq,{children:[{type:"1_100",message:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}].map((e=>{let{type:t,message:s,style:i}=e;return(0,w.jsx)(F.Z,{isLightGray:!0,isLarge:!0,style:{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center",...this.stores.store.state.companySize===t&&{color:a.ZP.blue,border:`1px solid ${a.ZP.blue}`},...i},onClick:()=>{this.stores.store.setState({...this.stores.store.state,companySize:t}),m.QOK(this.environment,{contactFieldType:"companySize",contactFieldValue:t})},children:s},t)}))}),(0,w.jsx)("div",{style:this.getLabelStyle(),children:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.questionLabel",defaultMessage:"Your question"})}),(0,w.jsx)(C,{question:this.getQuestion(),invalid:"question"===e,onSelect:e=>{this.stores.store.setState({...this.stores.store.state,question:e,step:"other"===e?"additional_input":"initial"}),m.QOK(this.environment,{contactFieldType:"question",contactFieldValue:"other"===e?"additional_input":"initial"})}}),(0,w.jsx)(P.Z,{textarea:!0,textareaElementAttributes:{style:{width:"100%",height:"100%",background:"none",border:"none",resize:"none"}},style:this.getTextAreaStyle(),focus:"additional_input"===this.stores.store.state.step,value:this.stores.store.state.additionalFeedback,placeholder:p.default.formatMessage(D.additionalFeedbackPlaceholder),onChange:e=>{this.stores.store.setState({...this.stores.store.state,additionalFeedback:e.target.value}),m.QOK(this.environment,{contactFieldType:"additionalFeedback",contactFieldValue:e.target.value})}})]})},this.renderCancel=()=>(0,w.jsx)(I.Z,{onClick:()=>{m.g3X(this.environment),this.handleCancel()},style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground},children:(0,o.D)({width:14,fill:this.theme.mediumTextColor})}),this.renderThanks=()=>(0,w.jsxs)("div",{children:[(0,w.jsx)("img",{style:{width:165,height:80},src:n.Z.images.feedbackThankYouPng}),(0,w.jsx)("div",{style:this.getThanksHeaderStyle(),children:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.thanks.caption",defaultMessage:"We've received your inquiry and will be contacting you via email shortly."})})]}),this.handleCancel=()=>{y.Z.setState({open:!1})}}renderComponent(){return(0,w.jsx)(Z.Z,{preventHideChildrenWhileOpening:!0,open:y.Z.state.open,render:this.renderMenu,onDismiss:this.handleCancel})}renderStep(){const{step:e,companySize:t}=this.stores.store.state,s="1_100"===t;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(k.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,w.jsx)(_.Z,{capture:!0,onBackspace:d.yR,onLeft:d.yR,onRight:d.yR,onSelectAll:d.yR,onRedo:d.yR,onUndo:d.yR,onCut:d.yR,onCopy:d.yR,onPaste:d.yR,onKeypress:d.yR,onDelete:d.yR,onTab:d.yR,children:this.renderInitial()})}),(0,w.jsx)(k.Z,{isVisible:"thanks"===e,animationStyle:(i="thanks"===e,{opacity:i?1:0,scale:i?1:.96}),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},render:this.renderThanks}),(0,w.jsx)(k.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,w.jsx)(A.Z,{style:{width:"auto"},textWrap:!0,renderTooltip:()=>s?(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.companySize.error.label",defaultMessage:"The company size selected is not eligible for a sales assisted plan. Please message support if you have any questions."}):null,render:e=>(0,w.jsx)(T.Z,{...e,disabled:s,isLarge:!0,style:{marginTop:17,width:284,position:"absolute",bottom:20},onClick:()=>{const e=this.getInvalidField();if(e){const{question:t}=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,step:"initial",invalidField:e,question:"other"===t?this.getQuestion():t})}else this.stores.store.setState({...this.stores.store.state,invalidField:void 0,step:"thanks"}),y.Z.state.open&&m.Ls9(this.environment,{email:y.Z.state.email,name:y.Z.state.name,question:y.Z.state.question,...this.stores.store.state}),d.gw((()=>{y.Z.reset(),d.gw((()=>{this.stores.store.reset()}),1e3)}),2e3)},children:(0,w.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.sendLabel",defaultMessage:"Send"})})})})]});var i}getName(){if(y.Z.state.open)return this.stores.store.state.name||y.Z.state.name}getEmail(){if(y.Z.state.open)return this.stores.store.state.email||y.Z.state.email}getQuestion(){if(y.Z.state.open)return this.stores.store.state.question||y.Z.state.question}getInvalidField(){const e=this.getEmail(),t=this.getName(),{companySize:s}=this.stores.store.state;return t?e&&l.B(e,"email")?s?this.getQuestion()?void 0:"question":"company_size":"email":"name"}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:c.Z.fontWeight.semibold,fontSize:14}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getLabelStyle(){return{marginTop:17,fontSize:12,color:this.theme.mediumTextColor,fontWeight:c.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getInputStyle(){return{backgroundColor:this.theme.whiteButtonBackground,height:31}}getSlideUpStyle(){const{step:e}=this.stores.store.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(153px)":"translateY(-180px)"}}getTextAreaStyle(){return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:"7px 10px",height:310,marginTop:17,marginBottom:17,transition:"opacity 200ms ease-in",opacity:"additional_input"===this.stores.store.state.step?1:.001}}}B.displayName="ContactModal";const L=B;function N(){return{border:`1px solid ${a.ZP.red}`}}},85324:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var i=s(67294),n=s(480),a=s(24405),o=s(41892),r=s(86658),l=s(82990),d=s(63143),c=s(31412),u=s(50950),m=s(36867),p=s(45293),g=s(10182),h=s(42922),f=s(89728),y=s(92660),x=s(29551),v=s(85893);function S(){window.__c={n:"SaveAllButton"};const e=(0,a.yK)(j,[]),t=(0,n.O7)();return(0,v.jsx)(h.Z,{isLarge:!0,style:e.acceptAllButton,onClick:()=>{u.a9(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),p.Z.setState({open:!1}),u.qo()},children:(0,v.jsx)(c.FormattedMessage,{...r.ze.acceptAllButtonLabel})})}function b(){window.__c={n:"RejectAllButton"};const e=(0,a.yK)(j,[]),t=(0,n.O7)();return(0,v.jsx)(f.Z,{isLarge:!0,isGray:!0,style:e.moreOptionsButton,onClick:()=>{u.a9(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),p.Z.setState({open:!1}),u.qo()},children:(0,v.jsx)(c.FormattedMessage,{...r.ze.rejectAllButtonLabel})})}function M(){window.__c={n:"MoreOptionsButton"};const e=(0,a.yK)(j,[]);return(0,v.jsx)(g.Z,{hasDismissButton:!0,onDismiss:()=>{p.Z.setState({open:!1})},renderOrigin:t=>(0,v.jsx)(f.Z,{...t,isLarge:!0,isGray:!0,style:e.moreOptionsButton,children:(0,v.jsx)(c.FormattedMessage,{...r.ze.moreOptionsButtonLabel})})})}function j(e){return{modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:l.Z.fontWeight.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}}const w=(0,c.injectIntl)((function(){window.__c={n:"CookieModal"};const e=(0,n.O7)().currentUser.id;(0,i.useEffect)((()=>{if(!e)return;(0,m._)(e);const t=window.setInterval((()=>{(0,m._)(e)}),d.A0);return()=>{window.clearInterval(t)}}),[e]);const t=(0,a.yK)(j,[]);return(0,v.jsx)(y.Z,{onDismiss:()=>{},render:()=>(0,v.jsx)("div",{style:t.modal,children:(0,v.jsxs)(x.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,v.jsx)("img",{style:t.image,src:o.Z.images.feedbackThankYouPng}),(0,v.jsx)("div",{style:t.title,children:(0,v.jsx)(c.FormattedMessage,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,v.jsx)("div",{style:t.description,children:(0,r.Fd)(u.Tz,"banner")}),(0,v.jsx)(S,{}),(0,v.jsx)(b,{}),(0,v.jsx)(M,{})]})}),requireOnline:!0,modalStore:p.Z})}))},49788:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});s(67294);var i=s(83355),n=s(18466),a=s(41892),o=s(64275),r=s(60651),l=s(91427),d=s(95094),c=s(72126),u=s(82990),m=s(51454),p=s(31412),g=s(54642),h=s(73409),f=s(62992);function y(e,t,s){if(s){const{templateId:i}=s;return e.some((e=>e.milestone===t&&e.template_id===i))}return e.some((e=>e.milestone===t))}var x=s(33929),v=s(38755),S=s(80444),b=s(4926),M=s(49085);const j="rate",w="send",C="thanks";class k extends M.default{getInitialState(){return{starRating:void 0,step:j}}}const T=k;var I=s(5188),P=s(35057),_=s(23063),Z=s(42922),F=s(64921),A=s(74194),R=s(3386),D=s(31278),B=s(29551),L=s(85893);const N=(0,p.defineMessages)({additionalFeedbackPlaceholder:{id:"csatPopup.additionalFeedback.placeholder",defaultMessage:"Tell us more..."}});class O extends i.Z{constructor(){super(...arguments),this.storeTypes={csatPopupStore:T},this.renderCancel=()=>(0,L.jsx)(F.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground},children:(0,o.D)({width:14,fill:this.theme.mediumTextColor})}),this.renderStep=()=>{const{step:e}=this.stores.csatPopupStore.state,{currentSpaceStore:t}=S.default.state;let s;if(t){const e=t.getInitialUseCases();e&&(s=c.UP(e))}return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(_.Z,{isVisible:e===j,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0,translateY:-120},render:()=>(0,L.jsxs)("div",{style:{paddingBottom:40},children:[this.renderIcon(),this.renderFeedbackPrompt(s)]})}),(0,L.jsx)(_.Z,{isVisible:e===j||e===w,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,L.jsxs)("div",{style:this.getSlideContainerStyle(),children:[this.renderStars(s),this.renderInput(),this.renderSendButton()]})}),(0,L.jsx)(_.Z,{isVisible:e===C,animationStyle:U(e===C),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},render:this.renderThanks})]})},this.renderThanks=()=>(0,L.jsxs)("div",{children:[(0,L.jsx)("img",{style:{width:165,height:80},src:a.Z.images.feedbackThankYouPng}),(0,L.jsx)("div",{style:this.getThanksHeaderStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Thanks for your feedback!",id:"csatPopup.thanks.header"})}),(0,L.jsx)("div",{style:this.getThanksDescriptionStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Your feedback will help us make Notion better.",id:"csatPopup.thanks.description"})})]}),this.renderIcon=()=>{const{mainEditorCurrentBlockStore:e}=S.default.state;if(e){const t=e.getIcon();if(t)return(0,L.jsx)(B.gq,{justifyContent:"center",alignItems:"center",children:(0,L.jsx)(D.Z,{icon:t,isEmptyPage:!1,size:32,disabled:!0})})}return(0,L.jsx)(B.gq,{justifyContent:"center",alignItems:"center",children:(0,r.h)({width:32,height:32})})},this.renderFeedbackPrompt=e=>{switch(e){case"doc_notes":return(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for notes & docs?",id:"csatPopup.feedbackPrompt.docNotesLabel"})},"feedback-prompt");case"project_management":return(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How satisfied are you with managing projects and tasks in Notion?",id:"csatPopup.feedbackPrompt.projManagementLabel"})},"feedback-prompt");case"wiki":return(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for team wikis?",id:"csatPopup.feedbackPrompt.wikiLabel"})},"feedback-prompt");default:return V(e)?(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How likely are you to recommend Notion to a friend?",id:"csatPopup.feedbackPrompt.enterpriseDefaultLabel"})},"feedback-prompt"):(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion? ",id:"csatPopup.feedbackPrompt.defaultlabel"})},"feedback-prompt")}},this.renderInput=()=>{const{step:e,additionalFeedback:t}=this.stores.csatPopupStore.state;return(0,L.jsx)(R.Z,{capture:!0,onBackspace:c.yR,onLeft:c.yR,onRight:c.yR,onSelectAll:c.yR,onRedo:c.yR,onUndo:c.yR,onCut:c.yR,onCopy:c.yR,onPaste:c.yR,onKeypress:c.yR,onDelete:c.yR,onTab:c.yR,children:(0,L.jsx)(A.Z,{textarea:!0,style:this.getInputContainerStyle(),focus:e===w,value:t,placeholder:x.default.formatMessage(N.additionalFeedbackPlaceholder),onChange:e=>{this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,additionalFeedback:e.target.value})}})})},this.renderSendButton=()=>(0,L.jsx)(Z.Z,{isLarge:!0,style:{width:"calc(100% - 30px)"},onClick:this.handleSend,children:(0,L.jsx)(p.FormattedMessage,{id:"csatPopup.sendButton.label",defaultMessage:"Send"})}),this.renderStars=e=>{const{starRating:t,step:s}=this.stores.csatPopupStore.state,i=e=>{let{rating:i}=e;return(0,L.jsxs)("div",{style:{display:"inline-flex",position:"relative",width:20,height:20,marginRight:3},onMouseEnter:()=>{s===j&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:i})},onClick:()=>{this.stores.csatPopupStore.setState({starRating:i,step:w})},children:[(0,l.e)({width:18,fill:this.theme.mediumIconColor,position:"absolute",opacity:t&&t>=i?0:1}),(0,d.p)({width:18,fill:"#F6C050",position:"absolute",opacity:t&&t>=i?1:0})]})},n=()=>{const s=V(e);switch(t){case 1:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Very unlikely",id:"csatPopup.stars.1StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Very dissatisfied",id:"csatPopup.stars.1StarLabel"});case 2:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Somewhat unlikely",id:"csatPopup.stars.2StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Somewhat dissatisfied",id:"csatPopup.stars.2StarLabel"});case 3:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Not likely nor unlikely",id:"csatPopup.stars.3StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Not dissatisfied nor satisfied",id:"csatPopup.stars.3StarLabel"});case 4:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Somewhat likely",id:"csatPopup.stars.4StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Somewhat satisfied",id:"csatPopup.stars.4StarLabel"});case 5:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Very likely",id:"csatPopup.stars.5StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Very satisfied",id:"csatPopup.stars.5StarLabel"});default:return(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Select an option",id:"csatPopup.stars.notSpecifiedLabel"})}};return(0,L.jsxs)("div",{onMouseLeave:()=>{c.gw((()=>{this.stores.csatPopupStore.state.step===j&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:void 0})}),500)},style:this.getStarsContainerStyle(),children:[(0,L.jsxs)("div",{style:{display:"flex",cursor:"pointer"},children:[(0,L.jsx)(i,{rating:1}),(0,L.jsx)(i,{rating:2}),(0,L.jsx)(i,{rating:3}),(0,L.jsx)(i,{rating:4}),(0,L.jsx)(i,{rating:5})]}),(0,L.jsx)("div",{style:this.getStarLabelStyle(),children:(0,L.jsx)(n,{})})]})},this.handleCancel=async()=>{const{state:e}=I.Z;if(!e.open)return;const{open:t,...s}=e;if(t&&"trigger"===s.type){const{currentSpaceStore:e}=S.default.state;if(!e)return;await g.submitCsatFeedback(this.environment,{spaceId:e.id,rating:void 0,additionalFeedback:void 0,templateId:void 0,...s})}I.Z.setState({...I.Z.state,open:!1})},this.handleSend=async()=>{const{additionalFeedback:e,starRating:t}=this.stores.csatPopupStore.state,{currentSpaceStore:s}=S.default.state;if(!s||!t)return;const{state:i}=I.Z;if(!i.open)return;const{open:n,...a}=i,o="passive"===a.type?await g.submitCsatFeedback(this.environment,{spaceId:s.id,rating:t,additionalFeedback:e,type:a.type,milestone:void 0,templateId:void 0}):await g.submitCsatFeedback(this.environment,{spaceId:s.id,rating:t,additionalFeedback:e,templateId:void 0,...a});if("success"!==o.type)throw o.error;this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,step:C}),c.gw((()=>{I.Z.setState({...I.Z.state,open:!1}),c.gw((()=>{this.stores.csatPopupStore.reset()}),1e3)}),2e3)},this.flexCenteredStyle={display:"flex",alignItems:"center",flexDirection:"column"}}willMount(){const{userSettingsStore:e,blockStore:t,spaceStore:s}=this.props;if(e&&t&&s){const i=this.environment;if("CsatMilestoneStore"in i){const a=n.Z.withListenerIgnored((()=>function(e,t){const{userSettingsStore:s,blockStore:i,spaceStore:n}=t,a=s.getSettings(),o=null==a?void 0:a.signup_time,{CsatMilestoneStore:r}=e,{data:l}=r.state,d=864e5,u=e=>Math.floor((Date.now()-e)/d);if(!n.isDefined()||!l)return;const{milestones:m}=l;if(!m)return;if(Math.max(...m.map((e=>e.created_time)))>Date.now()-24192e5)return;if(o){const e=u(o),t=c.UP(n.getInitialUseCases())||"legacy";if(e>=180){if(!y(m,h.Hf))return{milestone:h.Hf,useCase:t}}else if(e>=90){if(!y(m,h.Vx))return{milestone:h.Vx,useCase:t}}else if(e>=28){if(!y(m,h.Sh))return{milestone:h.Sh,useCase:t}}else if(e>=7&&!y(m,h.zK))return{milestone:h.zK,useCase:t}}const p=i.getCopiedFromPointer();return i.isDefined()&&p&&(0,f.J)(p)&&u(i.getCreatedTime())>=7&&!y(m,h.a0,{templateId:p.id})?{milestone:h.a0,useCase:"legacy",templateId:p.id}:void 0}(i,{userSettingsStore:e,blockStore:t,spaceStore:s})));if(a){const{milestone:e,useCase:t,templateId:s}=a;c.gw((()=>{I.Z.setState({open:!0,milestone:e,type:"trigger",useCase:t,templateId:s})}),2e3)}}}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const{currentSpaceStore:t}=S.default.state;return t&&!(0,v.Cx)(t)?(0,L.jsx)(_.Z,{isVisible:I.Z.state.open,animationStyle:U(I.Z.state.open),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},springConfig:{scale:{stiffness:58,damping:4.3}},render:()=>(0,L.jsxs)("div",{style:this.getContainerStyle(),children:[this.renderCancel(),(0,L.jsx)("div",{style:this.getInnerContainerStyle(),children:this.renderStep()})]})}):void 0}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:u.Z.fontWeight.semibold,fontSize:14}}getThanksDescriptionStyle(){return{color:this.theme.mediumTextColor,fontSize:12}}getInputContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{width:"calc(100% - 30px)",display:"block",background:this.theme.popoverBackground,height:80,marginTop:10,marginBottom:10,opacity:e===j?0:1}}getStarLabelStyle(){return{fontSize:12,color:this.theme.mediumTextColor,paddingTop:4}}getFeedbackPromptStyle(){return{paddingTop:12,paddingBottom:12,color:this.theme.regularTextColor,fontWeight:u.Z.fontWeight.semibold,fontSize:14,lineHeight:1.4,width:188}}getSlideContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{...this.flexCenteredStyle,position:"absolute",transition:"transform 200ms ease",width:240,transform:e===j?"translateY(120px)":"translateY(0px)"}}getStarsContainerStyle(){return{width:"100%",...this.flexCenteredStyle}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"absolute",bottom:65+b.Z.state,right:16+b.Z.state,zIndex:m.hT}}getInnerContainerStyle(){return{...this.flexCenteredStyle,width:240,height:195,overflow:"hidden",position:"relative",padding:12,cursor:"default",textAlign:"center",justifyContent:"center"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}}O.displayName="CsatPopup";const E=(0,p.injectIntl)(O);function V(e){const t=(0,P.zt)(),{state:s}=I.Z,i=s.open&&"trigger"===s.type;return"enterprise"===t&&!e&&i}function U(e){return{opacity:e?1:0,scale:e?1:.96}}},42607:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ne});s(67294);var i=s(83355),n=s(31412),a=s(79257),o=s(11599),r=s(80444),l=s(85680),d=s(88923),c=s(53437),u=s(480),m=s(86628),p=s(15145),g=s(6695),h=s(9999),f=s(90199),y=s(98634),x=s(92607),v=s(37888),S=s(72126),b=s(82990),M=s(50906),j=s(96802),w=s(39699),C=s(84210),k=s(87279),T=s(18514),I=s(92547),P=s(26350),_=s(81870),Z=s(26909),F=s(44514),A=s(79131),R=s(84076),D=s(78140),B=s(28992),L=s(40721),N=s(89728),O=s(31278),E=s(76798),V=s(72495),U=s(49085),W=s(61766),K=s(43700),z=s(69872),q=s(85893);class G extends i.Z{constructor(){super(...arguments),this.storeTypes={hovered:U.default.createClass(!1),buttonPopupStore:U.default.createClass(new W.Z)}}renderComponent(){const{schema:e,property:t,format:s,showAsSectionMenu:i,handlePageSectionClick:n}=this.props,r=e[t];if(!r)return;const l=function(e,t){switch(t){case"hide_if_empty":return o.kq({propertySchema:e})?"hide_if_empty":"show";default:return t}}(r,this.props.visibility);return(0,q.jsx)(z.Z,{onMouseEnter:()=>this.stores.hovered.setState(!0),onMouseLeave:()=>this.stores.hovered.setState(!1),focused:this.stores.hovered.state,showDragHandle:!this.environment.device.isMobile,showExtensionArrow:!1,propertySchema:r,format:z.Z.DisplayFormat.Name,dontShrinkRight:!0,ignoreLocalHoverState:!0,locked:this.props.locked,onClick:()=>{if(!this.props.locked){const e=this.stores.buttonPopupStore.state;e.setState({open:!e.state.open})}},right:i&&n?(0,q.jsx)(K.Z,{buttonPopupStore:this.stores.buttonPopupStore.state,visibility:l,visibilityLevels:["show","hide","hide_if_empty","inline","minimal"],locked:this.props.locked,onSelect:e=>n(e,t,s),onClose:()=>this.stores.hovered.setState(!1),type:"relation_property",propertySchema:r,showAsMenu:!0}):(0,q.jsx)(K.Z,{buttonPopupStore:this.stores.buttonPopupStore.state,visibility:l,locked:this.props.locked,onSelect:e=>function(e,t,s,i,n){w.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:n,perform:n=>{a.M0({property:t,visibility:e,format:s,store:i,transaction:n})}})}(e,this.props.property,this.props.format,this.props.store,this.environment),onClose:()=>this.stores.hovered.setState(!1),type:"property",propertySchema:r})},t)}}G.displayName="CustomizePageMenuPropertyMenuItem";const H=G;class Q extends i.Z{constructor(){super(...arguments),this.storeTypes={lockStore:I.Z},this.handleDraggableDrop=e=>{const t=ee(this.props),s=this.props.store;if(t){const i=e.map((e=>t.find((t=>t.property===e))));a.D2({environment:this.environment,properties:i,store:s})}},this.handleDraggableDropSections=e=>{const t=te(this.props),s=this.props.store;if(t){const i=e.map((e=>t.find((t=>t.section===e))));t&&w.createAndCommit({userAction:"CustomizePageMenu.handleDraggableDropSections",environment:this.environment,perform:e=>{a.Do({environment:this.environment,pageSectionFormats:i,store:s,transaction:e})}})}},this.handleShowAsClick=(e,t,s,i)=>{const n=o.$0();if(!n)return!1;let r=i.collection_page_sections?S.Xh(i.collection_page_sections):[];if(!s[t])return;const l=r.findIndex((e=>e.section===t));-1!==l?r[l]={section:t,visibility:e}:r=[...r,{section:t,visibility:e}];const d="inline"===e||"minimal"===e?"section":"show";r&&(w.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:this.environment,perform:e=>{a.Do({environment:this.environment,pageSectionFormats:r,store:n,transaction:e}),a.M0({property:t,visibility:d,store:n,format:i,transaction:e})}}),M.K1b(this.environment,{from:"page_properties",mode:"inline"===e?"page_section":"minimal"===e?"minimal_page_section":"property"}))},this.handleShowAsSectionMenuClick=(e,t,s)=>{const i=o.$0();if(!i)return;let n=s.collection_page_sections?S.Xh(s.collection_page_sections):[];if("inline"===e||"minimal"===e){const o=n.findIndex((e=>e.section===t));-1!==o?n[o]={section:t,visibility:e}:n=[...n,{section:t,visibility:e}];const r="inline"===e||"minimal"===e?"section":"show";n&&(w.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPageSectionClick",environment:this.environment,perform:e=>{a.Do({environment:this.environment,pageSectionFormats:n,store:i,transaction:e}),a.M0({property:t,visibility:r,store:i,format:s,transaction:e})}}),M.K1b(this.environment,{from:"page_properties",mode:"minimal"===e?"minimal_page_section":"page_section"}))}else{const n=g.AX.find((t=>t===e));if(!n)return;w.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPropertyClick",environment:this.environment,perform:e=>{a.M0({property:t,visibility:n,store:i,format:s,transaction:e})}}),M.K1b(this.environment,{from:"page_properties",mode:"property"})}},this.handleToggleLockClick=()=>{const e=o.$0();if(!e)return!1;const t=e.getParentBlockStore();t&&(w.createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:this.environment,perform:e=>{j.Wq({environment:this.environment,store:t,isLocked:!o.p1(),transaction:e})}}),this.stores.lockStore.setState({justUnlocked:!this.stores.lockStore.state.justUnlocked}))}}renderComponent(){const{device:e}=this.environment,t=this.createComputedStore((()=>"page"===this.props.type?this.props.store.isExternalObjectInstancePageBlockStore():this.props.store.isSyncedCollection()));let s;s=e.isMobile?{menuType:k.og.Modal,right:(0,q.jsx)(L.DoneMenuText,{}),onClickRight:a.xv,title:this.props.intl.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:k.og.Popup,minWidth:400};const i=X(this.props.store,J({store:this.props.store,type:this.props.type}));return(0,q.jsxs)(D.Z,{...s,header:(0,q.jsx)(se,{store:this.props.store,type:this.props.type}),children:[(this.props.locked||this.stores.lockStore.state.justUnlocked)&&this.renderLockControls(),this.renderPageSectionsSectionMenuItem(i,t.state),this.renderPropertiesSectionMenuItem(i)]})}renderLockControls(){return(0,q.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${this.theme.regularDividerColor}`,borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.sidebarBackground,color:this.theme.mediumTextColor,paddingTop:6,paddingBottom:6},children:[(0,q.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:this.stores.lockStore.state.justUnlocked?(0,v.U)({height:12,width:12,fill:this.theme.mediumIconColor}):(0,f.b)({height:12,width:12,fill:this.theme.mediumIconColor})}),this.stores.lockStore.state.justUnlocked?(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),(0,q.jsx)(N.Z,{style:{fontSize:12,color:this.theme.mediumTextColor,fontWeight:b.Z.fontWeight.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:this.handleToggleLockClick,children:this.stores.lockStore.state.justUnlocked?(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})})]})}renderPropertiesSectionMenuItem(e){if(!J(this.props)||"page"===this.props.type)return;const t=$(e);if(!t)return;const{propertyVisibility:s}=t;if(!s)return;const i=s.reduce(((e,t)=>(e[t.property]=t.visibility,e)),{}),a=te(this.props).filter((e=>"inline"===e.visibility||"minimal"===e.visibility)).map((e=>e.section)),o=S.e5(ee(this.props).map((e=>e.property)),a);return(0,q.jsx)(V.Z,{style:{opacity:this.props.locked?.5:1},title:(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.propertiesSection.header",defaultMessage:"Properties"}),children:this.renderDraggablePageProperties(o,i,e,this.handleDraggableDrop)})}renderPageSectionsSectionMenuItem(e,t){const s=this.props.store,i=J(this.props);if(!i||!s)return;const r=$(e);if(!r)return;const{pageSectionVisibility:l}=r;if(!l)return;const d=te(this.props).map((e=>e.section)),c={topLevelDiscussions:!t,backLinks:!0,pageComments:!t};return(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(V.Z,{style:{opacity:this.props.locked?.5:1},title:(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.sectionsSection.header",defaultMessage:"Sections"}),topBorder:!this.props.locked&&!this.stores.lockStore.state.justUnlocked,children:(0,q.jsxs)("div",{style:{marginLeft:8},children:[d.length>0&&(0,q.jsxs)(V.Z,{style:{opacity:this.props.locked?.5:1,width:"100%",paddingBottom:0,paddingTop:0},children:[(0,q.jsx)(A.ZP,{direction:"vertical",keys:d,renderKey:t=>{if("collection"===this.props.type&&"inline"===(0,o.ab)(void 0,t))return this.renderRelationSectionMenuItem(i,t,e)},onDrop:this.handleDraggableDropSections}),(0,q.jsx)(A.ZP,{direction:"vertical",keys:d,renderKey:t=>{if("collection"===this.props.type&&"minimal"===(0,o.ab)(void 0,t))return this.renderRelationSectionMenuItem(i,t,e)},onDrop:this.handleDraggableDropSections})]}),c.topLevelDiscussions&&(0,q.jsx)(B.Z,{title:(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.pageSections.topLevelPageDiscussionsTitle",defaultMessage:"Top-level page discussions"}),icon:(0,y.r)({height:16,width:16}),right:(0,q.jsx)(K.Z,{visibility:l.comments,visibilityLevels:["section_show","section_hide"],locked:this.props.locked,onSelect:t=>{a.W4({environment:this.environment,pageSection:"comments",visibility:t,store:s,format:e})},type:"page"})}),c.backLinks&&(0,q.jsx)(B.Z,{title:(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.pageSections.backlinksTitle",defaultMessage:"Backlinks"}),icon:(0,h.J)({height:16,width:16,transform:"rotate(180deg)"}),right:(0,q.jsx)(K.Z,{visibility:l.backlinks,locked:this.props.locked,visibilityLevels:["section_show","section_hide","section_collapsed"],onSelect:t=>{a.W4({environment:this.environment,pageSection:"backlinks",visibility:t,store:s,format:e})},type:"page"})}),c.pageComments&&(0,q.jsx)(B.Z,{title:(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.pageSections.pageCommentsTitle",defaultMessage:"Page comments"}),icon:(0,y.r)({height:16,width:16}),right:(0,q.jsx)(K.Z,{visibility:(0,o.ab)(l,"margin_comments"),visibilityLevels:["inline","minimal"],locked:this.props.locked,onSelect:t=>{a.W4({environment:this.environment,pageSection:"margin_comments",visibility:t,store:s,format:e})},type:"page"})})]})})})}renderRelationSectionMenuItem(e,t,s){var i;return(0,q.jsx)("div",{style:{display:"inline-flex",width:"100%"},children:(0,q.jsx)(B.Z,{title:null===(i=e[t])||void 0===i?void 0:i.name,icon:(0,x.v)({height:14,width:14,color:this.theme.mediumIconColor,fill:this.theme.mediumIconColor,fontWeight:b.Z.fontWeight.medium}),disabled:this.props.locked,showDragHandle:!this.environment.device.isMobile,right:(0,q.jsx)(K.Z,{visibility:(0,o.ab)(void 0,t),visibilityLevels:["section_hide","inline","minimal"],locked:this.props.locked,onSelect:i=>{this.handleShowAsClick(i,t,e,s)},type:"page",showAsMenu:!0})})})}renderDraggablePageProperties(e,t,s,i){const n=J(this.props),a=this.props.store;return a instanceof P.NW?(0,q.jsx)(A.ZP,{direction:"vertical",keys:e,renderKey:e=>{var i;const o=null===(i=n[e])||void 0===i?void 0:i.type;if("collection"===this.props.type)return"relation"===o?(0,q.jsx)(H,{schema:n,visibility:t[e],property:e,format:s,store:a,locked:this.props.locked,showAsSectionMenu:!0,handlePageSectionClick:this.handleShowAsSectionMenuClick}):(0,q.jsx)(H,{schema:n,visibility:t[e],property:e,format:s,store:a,locked:this.props.locked})},onDrop:i}):null}}Q.displayName="CustomizePageMenu";const Y=Q;function $(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}function J(e){let{type:t,store:s}=e;return s.getSchema()}function X(e,t){const s=e.getFormat();if(!t)return{};return g.iB(s,t,void 0,g.j5.Collection)}function ee(e){let{type:t,store:s}=e;if("collection"!==t)return[];return X(s,J({type:t,store:s})).collection_page_properties||[]}function te(e){let{type:t,store:s}=e;if("collection"!==t)return[];return X(s,J({type:t,store:s})).collection_page_sections||[]}function se(e){let{store:t,type:s}=e;window.__c={n:"Header"};const i=(0,u.O7)(),o=(0,m.VK)((()=>t&&t.getIcon()),[t]),r=(0,m.VK)((()=>"collection"===s?t.getParentBlockStore():void 0),[t,s]);if(i.device.isMobile)return null;if(t){const e=o&&(0,q.jsx)(O.Z,{icon:o,isEmptyPage:!1,size:14,disabled:!0,style:{display:"inline-flex",marginRight:2}}),s=(0,q.jsx)(E.Z,{store:t,style:{display:"inline"}}),i=r?(0,q.jsx)(F.Q,{prefix:(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.header.allPages.label",defaultMessage:"Customize all pages in"}),viewName:r?(0,q.jsx)(q.Fragment,{children:(0,q.jsxs)(R.Z,{onClick:a.xv,href:(0,C.ZP)({store:r,fullyQualified:!1,pageVisitSource:p.tY.Breadcrumb}),inline:!0,children:[e,s]})}):(0,q.jsxs)(q.Fragment,{children:[e,s]})}):(0,q.jsx)(n.FormattedMessage,{id:"customizePageMenu.header.singlePage.label",defaultMessage:"Customize this page view"});return(0,q.jsx)(B.Z,{style:{...Z.ZP.headingStyle},title:i,right:(0,q.jsx)(_.Z,{helpButtonContext:"customize_page_menu",href:(0,T.UY)("guides.customizePageView")})})}return null}class ie extends i.Z{constructor(){super(...arguments),this.renderModal=()=>{if(!l.Z.state.isOpen)return;const e=o.$0(),{mainEditorCurrentBlockStore:t}=r.default.state,s=d.default.state.open&&d.default.state.target||t;return e?(0,q.jsx)(Y,{store:e,type:"collection",intl:this.props.intl,locked:o.p1()}):s?(0,q.jsx)(Y,{store:s,type:"page",intl:this.props.intl,locked:!1}):void 0}}renderComponent(){const{device:e}=this.environment,t=l.Z.state;return(0,q.jsx)(c.ZP,{popupType:e.isMobile?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,alignmentToOrigin:c.ZP.Alignment.Center,open:t.isOpen,render:this.renderModal,originRect:t.isOpen?t.rect:void 0,onDismiss:()=>a.xv()})}}ie.displayName="CustomizePageMenuRenderer";const ne=(0,n.injectIntl)(ie)},43700:(e,t,s)=>{s.d(t,{Z:()=>g});s(67294);var i=s(83355),n=s(42853),a=s(31412),o=s(61766),r=s(31194),l=s(31945),d=s(89728),c=s(6318),u=s(85893);const m=(0,a.defineMessages)({hideSimpleLabel:{id:"customizePageMenuVisibilitySelect.hideSimple.label",defaultMessage:"Hide"},hideLabel:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hidePageLabel:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"},showLabel:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},showPageLabel:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},hideIfEmptyLabel:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},collapsedLabel:{id:"customizePageMenuVisibilitySelect.collapsed.label",defaultMessage:"Show in popover"},defaultLabel:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimalLabel:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"},sectionLabel:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},propertyLabel:{id:"customizePageMenuVisibilitySelect.property.label",defaultMessage:"As property"}});class p extends i.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:o.Z}}renderComponent(){const{device:e}=this.environment;return(0,u.jsx)(l.ZP,{popupType:e.isMobile?l.Z4.SlideUp:l.Z4.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>(0,u.jsxs)(d.Z,{style:{color:this.theme.mediumTextColor,paddingRight:0,height:this.environment.device.isMobile?32:22},disabled:this.props.locked,...e,children:[p.getVisibilityLabel(this.props.visibility,this.props.showAsMenu),(0,n.i)({width:10,marginLeft:4,marginRight:4,fill:this.theme.lightIconColor})]}),placementToOrigin:r.Iw.Bottom,onClose:this.props.onClose,render:e=>(0,u.jsx)(c.Z,{...this.props,onClose:e.close})})}static getVisibilityLabel(e,t){switch(e){case"hide":return(0,u.jsx)(a.FormattedMessage,{...m.hideLabel});case"show":return(0,u.jsx)(a.FormattedMessage,{...m.showLabel});case"hide_if_empty":return(0,u.jsx)(a.FormattedMessage,{...m.hideIfEmptyLabel});case"section_hide":return t?(0,u.jsx)(a.FormattedMessage,{...m.propertyLabel}):(0,u.jsx)(a.FormattedMessage,{...m.hidePageLabel});case"section_show":return(0,u.jsx)(a.FormattedMessage,{...m.showPageLabel});case"section_collapsed":return(0,u.jsx)(a.FormattedMessage,{...m.collapsedLabel});case"inline":return t?(0,u.jsx)(a.FormattedMessage,{...m.sectionLabel}):(0,u.jsx)(a.FormattedMessage,{...m.defaultLabel});case"minimal":return(0,u.jsx)(a.FormattedMessage,{...m.minimalLabel})}}}p.displayName="CustomizePageMenuVisibilitySelect";const g=p},6318:(e,t,s)=>{s.d(t,{Z:()=>f});s(67294);var i=s(83355),n=s(6695),a=s(36591),o=s(31412),r=s(11599),l=s(87279),d=s(52275),c=s(78140),u=s(32163),m=s(72495),p=s(43700),g=s(85893);class h extends i.Z{constructor(){super(...arguments),this.renderMenuItem=e=>{const{device:t}=this.environment;return{key:e,render:s=>(0,g.jsx)(d.Z,{...s,textWrapperStyle:{marginRight:0},title:(0,g.jsx)("div",{style:{display:"flex",alignItems:"center",width:150},children:(0,g.jsx)("div",{children:p.Z.getVisibilityLabel(e,this.props.showAsMenu)})}),right:this.props.visibility===e?(0,g.jsx)("div",{style:{width:t.isMobile?16:14},children:(0,a.e)()}):void 0}),action:()=>{if("page"===this.props.type){const t=e;this.props.onSelect(t)}if("relation_property"===this.props.type){const t=e;this.props.onSelect(t)}else if("property"===this.props.type){const t=e;this.props.onSelect(t)}this.props.onClose&&this.props.onClose()}}}}renderComponent(){const{device:e}=this.environment,t=[{key:"visibilityLevels",render:e=>(0,g.jsx)(m.Z,{...e,topBorder:0!==e.index}),items:"page"===this.props.type||"relation_property"===this.props.type?y(this.props.type,this.props.visibilityLevels).map((e=>this.renderMenuItem(e))):n.AX.filter((e=>"property"!==this.props.type||"hide_if_empty"!==e||r.kq({propertySchema:this.props.propertySchema}))).map((e=>this.renderMenuItem(e)))}];let s;return s=e.isMobile?{menuType:l.og.Modal,title:(0,g.jsx)(o.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.title",defaultMessage:"Select visibility"}),right:(0,g.jsx)(o.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:()=>this.props.onClose&&this.props.onClose()}:{menuType:l.og.Popup,width:"auto",maxWidth:360},(0,g.jsx)(c.Z,{...s,children:(0,g.jsx)(u.Z,{type:u.i.Vertical,initialFocus:void 0,sections:t})})}}h.displayName="CustomizePageMenuVisibilitySelectMenuItem";const f=h;function y(e,t){return"page"!==e&&"relation_property"!==e?[]:t||n.Sn}},81070:(e,t,s)=>{s.r(t),s.d(t,{default:()=>J});var i=s(30120),n=s(67294),a=s(83355),o=s(13991),r=s(480),l=s(49085),d=s(8848),c=s(41797),u=s(31412),m=s(40506);const p=(0,u.defineMessages)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function g(e){const{reminder:t,shouldShowTime:s,intl:i,formatTime:n}=e;if(!t)return i.formatMessage(p.none);if(m.vJ(t)){const{unit:e,value:a,time:o}=t,r=n({start_time:o,time_format:"LT",humanReadable:!0,intl:i}),l=s?`(${r})`:"";return 0===a?i.formatMessage(p.onTheDay,{formattedTimeText:l}):"day"===e?i.formatMessage(p.daysBefore,{formattedTimeText:l,numberOfDays:a}):"year"===e?i.formatMessage(p.yearsBefore,{formattedTimeText:l,numberOfYears:a}):"month"===e?i.formatMessage(p.monthsBefore,{formattedTimeText:l,numberOfMonths:a}):i.formatMessage(p.weeksBefore,{formattedTimeText:l,numberOfWeeks:a})}{const{unit:e,value:s}=t;return 0===s?i.formatMessage(p.atTimeOf):"hour"===e?i.formatMessage(p.hoursBefore,{numberOfHours:s}):i.formatMessage(p.minutesBefore,{numberOfMinutes:s})}}var h=s(7057),f=s(53877),y=s(84795),x=s(42875),v=s(11843),S=s(36700),b=s(16001),M=s(72126),j=s(70203),w=s(97880),C=s(63143),k=s(50906),T=s(87279),I=s(18514),P=s(77907),_=s(76150),Z=s(77080),F=s(69582),A=s(52275),R=s(31945),D=s(37601),B=s(88359),L=s(1743),N=s(74194),O=s(78140),E=s(32163),V=s(72495),U=s(45959),W=s(24006),K=s(26388),z=s(64369),q=s(83182),G=s(46247),H=s(62069),Q=s(85893);class Y extends a.Z{constructor(){super(...arguments),this.storeTypes={store:_.ZP,timezoneQuery:l.default.createClass("")},this.handleWindowKeyDown=e=>{"Escape"===e.key&&this.maybePreEmptivelyBlurInput()},this.handleWindowMouseDown=e=>{e.target instanceof HTMLInputElement&&e.target===document.activeElement||this.maybePreEmptivelyBlurInput()},this.handleDateFormatChange=e=>{var t,s;null===(t=(s=this.props).onChangeDateFormat)||void 0===t||t.call(s,e)},this.handleTimeFormatChange=e=>{var t,s;const i=this.getTimeFormatOptions()[e];null===(t=(s=this.props).onChangeTimeFormat)||void 0===t||t.call(s,i)},this.handleChangeReminder=e=>{const t=this.getDateValue();var s,i;if(e){if(m.vJ(e)){var n,a;null===(n=(a=this.props).onChangeValue)||void 0===n||n.call(a,{...t,reminder:{...e,defaultTimeZone:(0,x.r)()}})}else if("datetime"===t.type||"datetimerange"===t.type){var o,r;null===(o=(r=this.props).onChangeValue)||void 0===o||o.call(r,{...t,reminder:e})}}else null===(s=(i=this.props).onChangeValue)||void 0===s||s.call(i,{...t,reminder:e});k.IMD(this.environment,{date:t,reminder:e})},this.handleInputChange=e=>{const{device:t}=this.environment,{store:s}=this.stores;s.setState({...s.state,inputTemporaryValue:{...s.state.inputTemporaryValue,[s.state.focus]:e.target.value||""}}),t.isAndroid&&this.handleInputBlur()},this.handleStartDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startDate;if(!t)return;const s=oe(t,this.props.intl,this.props.dateFormat,this.environment,this.props.locale);if(!s)return _.pd.InvalidDate;const i={...this.getDateValue(),start_date:s},n=f.XI(i);if(!n)return _.pd.InvalidRange;this.applyValidDateState({newDate:i,currentMonth:n.start,resetField:_.Hv.StartDate})},this.handleStartTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startTime;if(!t)return;const s=ae(t,this.props.timeFormat,this.props.intl);if(!s)return _.pd.InvalidTime;const i=this.getDateValue();if(m.qg(i)){const{newDate:e,currentMonth:t}=f.vz({previous:i,updatedStartTime:s});this.applyValidDateState({newDate:e,currentMonth:t,resetField:_.Hv.StartTime}),this.resetInputState(_.Hv.EndDate),this.resetInputState(_.Hv.EndTime)}else{const e={...i,start_time:s},t=f.XI(e);this.applyValidDateState({newDate:e,currentMonth:t.start,resetField:_.Hv.StartTime})}},this.handleEndDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endDate;if(!t)return;const s=oe(t,this.props.intl,this.props.dateFormat,this.environment,this.props.locale);if(!s)return _.pd.InvalidDate;const i={...this.getDateValue(),end_date:s},n=f.XI(i);if(!n)return _.pd.InvalidRange;this.applyValidDateState({newDate:i,currentMonth:n.end,resetField:_.Hv.EndDate})},this.handleEndTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endTime;if(!t)return;const s=ae(t,this.props.timeFormat,this.props.intl);if(!s)return _.pd.InvalidTime;const i={...this.getDateValue(),end_time:s},n=f.XI(i);if(!n)return _.pd.InvalidRange;this.applyValidDateState({newDate:i,currentMonth:n.end,resetField:_.Hv.EndTime})},this.handleInputBlur=e=>{const{focus:t}=this.stores.store.state;let s;t===_.Hv.StartDate?s=this.handleStartDateInputChange():t===_.Hv.StartTime?s=this.handleStartTimeInputChange():t===_.Hv.EndDate?s=this.handleEndDateInputChange():t===_.Hv.EndTime&&(s=this.handleEndTimeInputChange()),s?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[t]:s}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleInputSubmit=()=>{const{focus:e}=this.stores.store.state;let t;e===_.Hv.StartDate?t=this.handleStartDateInputChange():e===_.Hv.StartTime?t=this.handleStartTimeInputChange():e===_.Hv.EndDate?t=this.handleEndDateInputChange():e===_.Hv.EndTime&&(t=this.handleEndTimeInputChange()),t?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[e]:t}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleDayPickerDayClick=(e,t,s)=>{if(this.props.disabled)return;let n=M.Xh(this.getDateValue());const{focus:a}=this.stores.store.state,o=i.ou.fromJSDate(e).setLocale(m.ah).toFormat(f.Iq);if(!s.shiftKey||"date"!==n.type&&"datetime"!==n.type)if("daterange"===n.type||"datetimerange"===n.type){var r,l;a===_.Hv.StartDate||a===_.Hv.StartTime?n={...n,start_date:o}:a!==_.Hv.EndDate&&a!==_.Hv.EndTime||(n={...n,end_date:o});const e=f.NK(n,(0,x.r)());if(e.end&&e.end<e.start){if("datetimerange"===n.type){const{start_date:e,start_time:t,end_date:s,end_time:i}=n;n={...n,start_date:s,start_time:i,end_date:e,end_time:t}}else{const{start_date:e,end_date:t}=n;n={...n,start_date:t,end_date:e}}this.stores.store.setState({...this.stores.store.state,focus:a===_.Hv.StartDate||a===_.Hv.StartTime?_.Hv.EndDate:_.Hv.StartDate})}null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,n),this.resetInputState(a);const t=a===_.Hv.StartDate||a===_.Hv.StartTime?_.Hv.EndDate:_.Hv.StartDate;this.stores.store.setState({...this.stores.store.state,focus:t})}else{var d,c;const e={...n,start_date:o};null===(d=(c=this.props).onChangeValue)||void 0===d||d.call(c,e),this.resetInputState(a)}else this.enableEndDate({dateValue:n,endDate:o})},this.handleDayPickerMonthChange=e=>{this.stores.store.setState({...this.stores.store.state,currentMonth:i.ou.fromJSDate(e)})},this.handleEndDateControlChange=()=>{const e=this.getDateValue();if("datetimerange"===e.type){var t,s;const i={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,i)}else if("daterange"===e.type){var i,n;const t={type:"date",start_date:e.start_date,reminder:e.reminder};null===(i=(n=this.props).onChangeValue)||void 0===i||i.call(n,t)}else this.enableEndDate({dateValue:e})},this.handleAllDayChange=()=>{const e=this.getDateValue();if("date"===e.type){var t,s;const i={type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,x.r)(),reminder:e.reminder&&m.AE(e.reminder)};null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,i)}else if("daterange"===e.type){var i,n;const t={type:"datetimerange",start_date:e.start_date,start_time:"00:00",end_date:e.end_date,end_time:"00:00",time_zone:(0,x.r)(),reminder:e.reminder&&m.AE(e.reminder)};null===(i=(n=this.props).onChangeValue)||void 0===i||i.call(n,t)}else if("datetime"===e.type){var a,o;const t={type:"date",start_date:e.start_date,reminder:e.reminder&&m.wg(e.reminder,(0,x.r)())};null===(a=(o=this.props).onChangeValue)||void 0===a||a.call(o,t)}else{var r,l;const t={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:e.reminder&&m.wg(e.reminder,(0,x.r)())};null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,t)}},this.handleTimeZoneChange=e=>{const t=this.getDateValue();if("datetime"===t.type||"datetimerange"===t.type){var s,i;const n={...t,time_zone:e};null===(s=(i=this.props).onChangeValue)||void 0===s||s.call(i,n)}},this.handleStartInputDateFocus=()=>{const e=this.getDateValue(),t=f.NK(e,(0,x.r)());this.stores.store.setState({...this.stores.store.state,focus:_.Hv.StartDate,inputIsFocused:!0,currentMonth:t.start})},this.handleStartInputTimeFocus=()=>{const e=this.getDateValue(),t=f.NK(e,(0,x.r)());this.stores.store.setState({...this.stores.store.state,focus:_.Hv.StartTime,inputIsFocused:!0,currentMonth:t.start})},this.handleEndInputDateFocus=()=>{const e=this.getDateValue(),t=f.NK(e,(0,x.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:_.Hv.EndDate,inputIsFocused:!0,currentMonth:t.end})},this.handleEndInputTimeFocus=()=>{const e=this.getDateValue(),t=f.NK(e,(0,x.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:_.Hv.EndTime,inputIsFocused:!0,currentMonth:t.end})},this.handleClearClick=()=>{var e,t;null===(e=(t=this.props).onChangeValue)||void 0===e||e.call(t,void 0)},this.getTimeFormatOptions=()=>(0,v.E)(o.SP).time,this.getSelectedTimeFormatType=()=>{const e=se(this.props.timeFormat),t=this.getTimeFormatOptions();for(const s in t)if(t[s]===e)return s;return"12h"},this.tooltipOriginGap=12}willMount(e){super.willMount(e),this.openTimeFormat=f.Lg((0,x.r)()),window.addEventListener("mousedown",this.handleWindowMouseDown),window.addEventListener("keydown",this.handleWindowKeyDown,!0)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}maybePreEmptivelyBlurInput(){const{inputIsFocused:e}=this.stores.store.state;e&&this.handleInputBlur()}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,{disabled:s,canConfigureCollection:i,shouldShowReminder:n,header:a,isTemplatePage:o}=this.props,{inputIsFocused:r}=this.stores.store.state,l=this.getDateValue(),d="datetime"===l.type||"datetimerange"===l.type,c="daterange"===l.type||"datetimerange"===l.type,m=o&&Z.default.checkGate("template-variable-properties"),p=(0,Q.jsxs)("div",{style:{paddingTop:e.isMobile?16:8,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:d?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0},children:[this.renderStartInput(),c&&(0,Q.jsx)("div",{style:{width:12,height:8}}),this.renderEndInput(),this.renderTimeZone()]});let g;return g=e.isMobile?{menuType:T.og.Modal,title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),right:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),left:n?(0,Q.jsx)(re,{}):void 0,onClickRight:this.props.onDismiss,header:p}:{menuType:T.og.Popup,maxHeight:"none",width:270,header:a},(0,Q.jsx)(L.Z,{capture:r,allowEsc:!0,children:(0,Q.jsx)(L.Z,{capture:!0,allowUndo:!0,allowEsc:!0,children:(0,Q.jsxs)(O.Z,{...g,children:[(0,Q.jsx)(D.Z,{show:r}),m&&(0,Q.jsx)($,{onChangeValue:this.props.onChangeValue}),(0,Q.jsxs)(V.Z,{topBorder:!0,children:[!e.isMobile&&p,(0,Q.jsx)("div",{style:{padding:e.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...e.isMobile&&{borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}},children:this.renderCalendar()})]}),!s&&this.renderControls(),!s&&i&&(0,Q.jsx)(V.Z,{topBorder:!0,children:this.renderFormatPopup()}),!s&&(0,Q.jsx)(V.Z,{topBorder:!0,children:this.renderClearButton()}),!s&&!e.isMobile&&n&&(0,Q.jsx)(V.Z,{topBorder:!0,children:(0,Q.jsx)(re,{})})]})})})}renderStartInput(){const{device:e}=this.environment,{disabled:t}=this.props,{focus:s,inputTemporaryValue:i,error:n}=this.stores.store.state,a=this.getDateValue(),o=f.NK(a,(0,x.r)(),te(this.props.locale,this.props.intl)),r=Boolean(n.startDate||n.startTime),l="datetime"===a.type||"datetimerange"===a.type,d="daterange"===a.type||"datetimerange"===a.type,c=s===_.Hv.StartDate||s===_.Hv.StartTime,u=(0,C.z4)(i.startDate)?o.start.toFormat(ne(this.props.dateFormat,this.props.intl,this.props.locale)):i.startDate,p=(0,C.z4)(i.startTime)?o.start.toFormat(se(this.props.timeFormat)):i.startTime,g=(0,C.z4)(i.startDate)?o.start.toFormat(f.Iq):i.startDate,h=(0,C.z4)(i.startTime)?o.start.toFormat(m.jK):i.startTime;return(0,Q.jsxs)("div",{style:{...r?this.getInputWrapErrorStyle():c&&d?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14},children:[(0,Q.jsx)(K.Z,{renderTooltip:()=>ie(n.startDate,this.props.intl),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(n.startDate),placement:K.Z.Placement.Left,render:()=>e.isMobile?(0,Q.jsx)(N.Z,{type:"date",format:N.B.Transparent,value:g,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1}):(0,Q.jsx)(N.Z,{selectAll:!0,format:N.B.Transparent,value:u,focusInitial:s===_.Hv.StartDate,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1})}),l&&this.getInputSeparator(),l&&(0,Q.jsx)(K.Z,{renderTooltip:()=>ie(n.startTime,this.props.intl),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(n.startTime),placement:K.Z.Placement.Right,render:()=>e.isMobile?(0,Q.jsx)(N.Z,{type:"time",format:N.B.Transparent,value:h,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,Q.jsx)(N.Z,{format:N.B.Transparent,value:p,focusInitial:s===_.Hv.StartTime,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}renderEndInput(){const{device:e}=this.environment,{disabled:t}=this.props,s=this.getDateValue(),i=f.NK(s,(0,x.r)(),te(this.props.locale,this.props.intl)),n="datetime"===s.type||"datetimerange"===s.type;if(i.end){const{focus:s,error:a,inputTemporaryValue:o}=this.stores.store.state,r=Boolean(a.endDate||a.endTime),l=s===_.Hv.EndDate||s===_.Hv.EndTime,d=(0,C.z4)(o.endDate)?i.end.toFormat(ne(this.props.dateFormat,this.props.intl,this.props.locale)):o.endDate,c=(0,C.z4)(o.endTime)?i.end.toFormat(se(this.props.timeFormat)):o.endTime,u=(0,C.z4)(o.endDate)?i.end.toFormat(f.Iq):o.endDate,p=(0,C.z4)(o.endTime)?i.end.toFormat(m.jK):o.endTime,g=this.getDateRangeBounds(),h=g&&g.earliestValidEnd;return(0,Q.jsxs)("div",{style:{...r?this.getInputWrapErrorStyle():l?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14},children:[(0,Q.jsx)(K.Z,{renderTooltip:()=>ie(a.endDate,this.props.intl),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(a.endDate),placement:K.Z.Placement.Left,render:()=>e.isMobile?(0,Q.jsx)(N.Z,{type:"date",format:N.B.Transparent,value:u,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t,inputElementAttributes:{min:h}}):(0,Q.jsx)(N.Z,{format:N.B.Transparent,value:d,focusInitial:s===_.Hv.EndDate,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}),n&&this.getInputSeparator(),n&&(0,Q.jsx)(K.Z,{renderTooltip:()=>ie(a.endTime,this.props.intl),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(a.endTime),placement:K.Z.Placement.Right,render:()=>e.isMobile?(0,Q.jsx)(N.Z,{type:"time",format:N.B.Transparent,value:p,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,Q.jsx)(N.Z,{format:N.B.Transparent,value:c,focusInitial:s===_.Hv.EndTime,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}}renderTimeZone(){const{device:e}=this.environment,{intl:t}=this.props,s=this.getDateValue();if(("datetime"===s.type||"datetimerange"===s.type)&&s.time_zone!==(0,x.r)())return(0,Q.jsx)(z.Z,{isSmall:!0,isMobile:e.isMobile,style:{marginTop:8},children:(0,c.E)(t)[s.time_zone]})}renderCalendar(){const{firstDayOfWeek:e}=this.props,t=this.getDateValueForceCurrentTimeZone(),s=f.NK(t,(0,x.r)()),i=this.stores.store.state.currentMonth||s.start,{focus:n}=this.stores.store.state;if(s.end){const t=s.start.toJSDate(),a=s.end.toJSDate(),r=n===_.Hv.StartDate||n===_.Hv.StartTime;return(0,Q.jsx)(P.LazyDayPicker,{className:"notion-date-property-menu notranslate",weekStartsOn:e,numberOfMonths:1,defaultMonth:i.toJSDate(),month:i.toJSDate(),locale:o.SP,modifiers:{range:{from:t,to:a},...r?{end:a,start:t}:{start:t,end:a}},modifiersStyles:{range:Y.dayPickerRangeDayStyle,start:r?X():ee(),end:r?ee():X()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}{const t=s.start.toJSDate();return(0,Q.jsx)(P.LazyDayPicker,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:e,defaultMonth:i.toJSDate(),month:i.toJSDate(),locale:o.SP,selected:[t],modifiers:{start:t},modifiersStyles:{start:X()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}}renderControls(){const{device:e}=this.environment,{shouldShowReminder:t}=this.props;return e.isMobile?(0,Q.jsxs)(V.Z,{topBorder:!0,children:[t&&this.renderReminderControl(),this.renderEndDateControl(),this.renderAllDayControl()]}):(0,Q.jsxs)(n.Fragment,{children:[t&&(0,Q.jsx)(V.Z,{topBorder:!0,children:this.renderReminderControl()}),(0,Q.jsxs)(V.Z,{topBorder:!0,children:[this.renderEndDateControl(),this.renderAllDayControl()]})]})}renderEndDateControl(){const e=this.getDateValue();return(0,Q.jsx)(A.Z,{focused:!1,onClick:this.handleEndDateControlChange,title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,Q.jsx)(W.Z,{on:"daterange"===e.type||"datetimerange"===e.type,onClick:this.handleEndDateControlChange})})}renderAllDayControl(){const e=this.getDateValue();return(0,Q.jsx)(A.Z,{focused:!1,onClick:this.handleAllDayChange,title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,Q.jsx)(W.Z,{on:"date"!==e.type&&"daterange"!==e.type,onClick:this.handleAllDayChange})})}renderReminderControl(){const{device:e}=this.environment,{intl:t}=this.props,s=this.getDateValue();return(0,Q.jsx)(R.ZP,{popupType:e.isMobile?R.Z4.SlideUp:R.Z4.Popup,placementToOrigin:R.pO.Right,renderOrigin:i=>(0,Q.jsx)(B.Z,{...i,icon:(0,S.m)({width:14}),title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:e.isMobile,right:g({reminder:s.reminder,intl:t,formatTime:h.mr})}),render:i=>{let n;n=e.isMobile?{menuType:T.og.Modal,title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),right:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:i.close}:{menuType:T.og.Popup,width:250};const a=("date"===s.type||"daterange"===s.type?m.PI:m.dG).map((e=>{const s=g({reminder:e,shouldShowTime:!0,intl:t,formatTime:h.mr});return{key:s,action:t=>{this.handleChangeReminder(e),i.close()},render:(e,t)=>(0,Q.jsx)(A.Z,{...e,title:s})}}));return(0,Q.jsx)(O.Z,{...n,children:(0,Q.jsx)(E.Z,{type:E.i.Vertical,sections:[{key:"reminder section",render:e=>(0,Q.jsx)(V.Z,{...e}),items:a}],initialFocus:void 0})})}})}renderFormatPopup(){const{device:e}=this.environment;return(0,Q.jsx)(R.ZP,{popupType:e.isMobile?R.Z4.SlideUp:R.Z4.Popup,placementToOrigin:R.pO.Right,renderOrigin:t=>(0,Q.jsx)(A.Z,{...t,icon:(0,b.r)({width:14}),title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Date format & timezone",id:"LuxonDatePropertyMenu.menuItem.formatAndTimezone.label"}),focused:!1,showExtensionArrow:e.isMobile}),render:t=>{let s;return s=e.isMobile?{menuType:T.og.Modal,title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),right:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),onClickRight:t.close}:{menuType:T.og.Popup,width:250},(0,Q.jsx)(O.Z,{...s,children:(0,Q.jsxs)(V.Z,{children:[this.renderDateFormatControl(),!v.S.includes(o.SP)&&this.renderTimeFormatControl(),this.renderTimeZoneControl()]})})}})}renderDateFormatControl(){const e=this.props.dateFormat||m.sF,{intl:t}=this.props,s={menuTitle:t.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:m.Zy,getKey:e=>e,selectedItem:e,onSelect:this.handleDateFormatChange,renderItem:e=>(0,Q.jsx)(A.Z,{...e,title:t.formatMessage(m.fy[e.value])}),renderOrigin:s=>(0,Q.jsx)(B.Z,{focused:!1,title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),right:e?t.formatMessage(m.fy[e]):(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"}),...s})};return(0,Q.jsx)(U.Z,{...s})}renderTimeFormatControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,s=se(this.props.timeFormat),{intl:i}=this.props,n=this.getSelectedTimeFormatType(),a={menuTitle:i.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:m.L7,getKey:e=>e,selectedItem:n,onSelect:this.handleTimeFormatChange,renderItem:e=>(0,Q.jsx)(A.Z,{...e,title:i.formatMessage(m.Fi[e.value])}),disabled:t,renderOrigin:e=>(0,Q.jsx)(B.Z,{focused:!1,title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:t,right:!t&&(s?i.formatMessage(m.Fi[n]):(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"})),...e})};return(0,Q.jsx)(U.Z,{...a})}renderTimeZoneControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,s=this.getTimeZone();return(0,Q.jsx)(H.Z,{renderOrigin:e=>(0,Q.jsx)(B.Z,{...e,focused:!1,title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.menuItem.time.label"}),disabled:t,right:!t&&f.er(s)}),onSelect:e=>this.handleTimeZoneChange(e)})}renderClearButton(){return(0,Q.jsx)(A.Z,{focused:!1,onClick:this.handleClearClick,title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}enableEndDate(e){const{dateValue:t,endDate:s,endTime:i}=e;if("datetime"===t.type){var n,a;const e={type:"datetimerange",start_date:t.start_date,start_time:t.start_time,end_date:s||t.start_date,end_time:i||t.start_time,time_zone:t.time_zone,reminder:t.reminder};null===(n=(a=this.props).onChangeValue)||void 0===n||n.call(a,e),this.stores.store.setState({...this.stores.store.state,focus:_.Hv.EndDate})}else if("date"===t.type){var o,r;const e={type:"daterange",start_date:t.start_date,end_date:s||t.start_date,reminder:t.reminder};null===(o=(r=this.props).onChangeValue)||void 0===o||o.call(r,e),this.stores.store.setState({...this.stores.store.state,focus:_.Hv.EndDate})}else(0,w.t1)(t)}getDateValue(){const{value:e}=this.props;return e&&!M.i2(e)?e:this.openTimeFormat}getDateRangeBounds(){const e=this.getDateValue();if(m.h(e)||m.qg(e)){const t=f.NK(e,(0,x.r)());return{earliestValidEnd:t.start.toFormat(f.Iq),latestValidStart:t.end.toFormat(f.Iq)}}}getDateValueForceCurrentTimeZone(){const{value:e}=this.props;return e&&!M.i2(e)?"datetime"===e.type||"datetimerange"===e.type?{...e,time_zone:(0,x.r)()}:e:this.openTimeFormat}getTimeZone(){const e=this.getDateValue();return"datetime"===e.type||"datetimerange"===e.type?e.time_zone:(0,x.r)()}applyValidDateState(e){var t,s;const{newDate:i,currentMonth:n,resetField:a}=e;null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,i),this.stores.store.setState({...this.stores.store.state,currentMonth:n}),this.resetInputState(a)}resetInputState(e){const{state:t}=this.stores.store;this.stores.store.setState({...t,error:{...t.error,[t.focus]:void 0},inputTemporaryValue:{...t.inputTemporaryValue,[t.focus]:void 0}})}getInputSeparator(){return(0,Q.jsx)("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})}getInputWrapStyle(){return{display:"flex",alignItems:"center",borderRadius:4,height:28,lineHeight:1.2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%"}}getInputWrapInactiveStyle(){return{...this.getInputWrapStyle(),boxShadow:this.theme.inputBoxShadow,flexGrow:1}}getInputWrapErrorStyle(){return{...this.getInputWrapStyle(),boxShadow:`inset 0 0 0 2px ${d.ZP.red}`,background:d.ZP.redWithAlpha(.15),flexGrow:1}}getInputWrapActiveStyle(){return{...this.getInputWrapStyle(),boxShadow:`inset 0 0 0 2px ${d.ZP.blue}`,background:d.ZP.blueWithAlpha(.15),flexGrow:1}}}function $(e){window.__c={n:"RelativeDateShortcutsSection"};const{onChangeValue:t}=e,s=(0,u.useIntl)();return(0,Q.jsx)(V.Z,{title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,Q.jsx)(A.Z,{title:(0,Q.jsx)(F.w,{templateVariableType:e}),caption:j.Z08(e,s),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}Y.displayName="DatePropertyMenu",Y.dayPickerRangeDayStyle={backgroundColor:d.ZP.blueWithAlpha(.15)};const J=(0,u.injectIntl)(Y);function X(){return{backgroundColor:d.ZP.blue,color:d.ZP.white}}function ee(){return{backgroundColor:d.ZP.blueWithAlpha(.43)}}function te(e,t){return e||t.locale}function se(e){return e?m._F(e):m.Sc}function ie(e,t){switch(e){case _.pd.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case _.pd.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case _.pd.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}function ne(e,t,s){return void 0===e||"relative"===e||"ll"===e?m.oq(te(s,t)):m.jG(e)}function ae(e,t,s){return(0,y.parseTimeValueWithInputFormat)(e,se(t),s)}function oe(e,t,s,i,n){return i.device.isMobile?(0,y.parseDateValueWithInputFormat)(e,f.Iq,t):(0,y.parseDateValueWithInputFormat)(e,ne(s,t,n),t)}function re(){window.__c={n:"RemindersHelp"};const e=(0,r.O7)(),{device:t}=e;return t.isMobile?(0,Q.jsx)(G.Z,{href:(0,I.UY)("guides.reminders"),analyticsFrom:"date_selector"}):(0,Q.jsx)(q.Z,{title:(0,Q.jsx)(u.FormattedMessage,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,I.UY)("guides.reminders"),analyticsFrom:"date_selector"})}},92660:(e,t,s)=>{s.d(t,{Z:()=>l});s(67294);var i=s(480),n=s(86628),a=s(50506),o=s(53437),r=s(85893);function l(e){window.__c={n:"DefaultPopupOrModal"};const t=(0,i.O7)(),{modalStore:s,render:l}=e,{device:d}=t,c=(0,n.VK)((()=>s.state.open),[s]);return d.isMobile?(0,r.jsx)(o.ZP,{ariaLabel:e.ariaLabel,open:c,popupType:o.ZP.PopupType.SlideUp,origin:e.origin,onDismiss:e.onDismiss,render:l,style:e.style}):(0,r.jsx)(a.Z,{ariaLabel:e.ariaLabel,open:c,preventHideChildrenWhileOpening:!0,render:l,onDismiss:e.onDismiss,style:e.style,innerStyle:e.innerStyle})}},86249:(e,t,s)=>{s.d(t,{ZP:()=>$,UV:()=>Y,f4:()=>Q});s(57658);var i=s(67294),n=s(24405),a=s(56666),o=s(44495),r=s(37612),l=s(97880),d=s(31412),c=s(47307),u=s(40394),m=s(42922),p=s(52275),g=s(53695),h=s(64369),f=s(480),y=s(86628),x=s(50906),v=s(54642),S=s(33954),b=s(52507),M=s(50506),j=s(13991),w=s(82990),C=s(74194),k=s(68785),T=s(85893);const I=(0,d.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.addNewDomain.samlConfig.subtitle",defaultMessage:"Users with a verified domain can log in {br}using SAML SSO."},integrationSubtitle:{id:"verifyDomainModal.addNewDomain.integration.subtitle",defaultMessage:"Link preview integrations must verify {br}domains before they are published."}});const P=function(e){let{handleAddNewDomain:t,loading:s,verificationType:a}=e;window.__c={n:"AddNewDomain"};const[o,r]=(0,i.useState)(""),c=!Boolean(o),u=(0,i.useCallback)((e=>{r(e.target.value)}),[]),p=(0,n.yK)((()=>({title:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},input:{marginTop:22,marginBottom:14},button:{width:"100%",opacity:c?.5:1}})),[c]);let g;switch(a){case"integration":g=I.integrationSubtitle;break;case"saml_config":g=I.samlConfigSubtitle;break;default:(0,l.t1)(a)}return(0,T.jsxs)(i.Fragment,{children:[(0,T.jsx)(h.Z,{style:p.title,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.addNewDomain.title",defaultMessage:"Add new domain"})}),(0,T.jsx)(h.Z,{style:p.subtitle,isMultiline:!0,children:(0,T.jsx)(d.FormattedMessage,{...g,values:{br:(0,T.jsx)("br",{})}})}),(0,T.jsx)(C.Z,{value:o,style:p.input,placeholder:"notion.so",onChange:u}),(0,T.jsx)(m.Z,{onClick:()=>t(o),style:p.button,isLarge:!0,disabled:c,children:s?(0,T.jsx)(k.Z,{}):(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.addNewDomain.next",defaultMessage:"Next"})})]})};var _=s(63296);const Z=function(e){let{domain:t,isExpired:s,onClose:a}=e;window.__c={n:"InvalidDomain"};const o=(0,n.yK)((e=>({title:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);return(0,T.jsxs)(i.Fragment,{children:[(0,T.jsx)(h.Z,{style:o.title,isMultiline:!0,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.invalidDomain.title",defaultMessage:"Unable to verify {domain}",values:{domain:t}})}),(0,T.jsx)(h.Z,{style:o.subtitle,isMultiline:!0,children:s?(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.invalidDomain.expired",defaultMessage:"The code for this domain's verification has expired."}):(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.invalidDomain.invalid",defaultMessage:"You are unable to verify this domain because it has already been verified by another workspace."})}),(0,T.jsx)(_.Z,{onClick:a,style:{width:"100%"},children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.invalidDomain.okay",defaultMessage:"Okay"})})]})},F=(0,d.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.verifiedDomain.samlConfig.subtitle",defaultMessage:"Users are able to use this email domain to{br}log in using SAML SSO."},integrationSubtitle:{id:"verifyDomainModal.verifiedDomain.integration.subtitle",defaultMessage:"This integration can unfurl URLs containing this domain."}});const A=function(e){let{domain:t,onClose:s,verificationType:a}=e;window.__c={n:"VerifyDomain"};const o=(0,n.yK)((()=>({title:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);let r;switch(a){case"saml_config":r=F.samlConfigSubtitle;break;case"integration":r=F.integrationSubtitle;break;default:(0,l.t1)(a)}return(0,T.jsxs)(i.Fragment,{children:[(0,T.jsx)(h.Z,{style:o.title,isMultiline:!0,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.title",defaultMessage:"Successfully verified {domain}",values:{domain:t}})}),(0,T.jsx)(h.Z,{style:o.subtitle,isMultiline:!0,children:(0,T.jsx)(d.FormattedMessage,{...r,values:{br:(0,T.jsx)("br",{})}})}),(0,T.jsx)(_.Z,{onClick:s,style:{width:"100%"},children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.okay",defaultMessage:"Okay"})})]})};var R=s(75553),D=s(63143),B=s(14871),L=s(16402),N=s(64921);const O=function(e){let{handleVerifyDomain:t,domainVerification:s,loading:a}=e;window.__c={n:"VerifyExistingDomain"};const o=(0,f.O7)(),r=s.expiresAt-Date.now()<2*D.U6,l=(0,n.yK)((e=>({title:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},list:{paddingInlineStart:22,margin:"24px 0"},listItem:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",marginBottom:12},expiresSoonText:{color:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500]},copyButton:{borderRadius:4,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},code:{width:"100%",color:e.mediumTextColor,fontFamily:w.Z.getCompositeFontFamily(j.SP).mono,fontSize:14,fontWeight:400,lineHeight:"18px"},codeContainer:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:4,marginTop:4,marginBottom:8}})),[]);return(0,T.jsxs)(i.Fragment,{children:[(0,T.jsx)(h.Z,{style:l.title,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.title",defaultMessage:"Verify your domain"})}),(0,T.jsx)(h.Z,{style:l.subtitle,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.subtitle",defaultMessage:"Follow these steps to finalize verification."})}),(0,T.jsx)(h.Z,{isSmall:!0,style:{marginTop:22},children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeLabel",defaultMessage:"Verification code"})}),(0,T.jsxs)("div",{style:l.codeContainer,children:[(0,T.jsx)(h.Z,{style:l.code,children:`notion-domain-verification=${s.verificationCode}`}),(0,T.jsxs)(N.Z,{onClick:function(){B.RD({environment:o,stringValue:`notion-domain-verification=${s.verificationCode}`,copiedMessage:B.tq.copiedLinkToClipboard})},style:l.copyButton,children:[(0,R.U)(l.copyIcon),(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.copy",defaultMessage:"Copy"})]})]}),(0,T.jsx)(h.Z,{style:r?l.expiresSoonText:void 0,isSmall:!0,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeExpiresAt",defaultMessage:"Expires on {timeLeft}",values:{timeLeft:(0,L.gs)(s.expiresAt)}})}),(0,T.jsxs)("ol",{style:l.list,children:[(0,T.jsx)("li",{style:l.listItem,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsDNS",defaultMessage:"Navigate to the DNS record section of your domain host."})}),(0,T.jsx)("li",{style:l.listItem,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsTXT",defaultMessage:"Create a new TXT record and paste in the code above as the value."})}),(0,T.jsx)("li",{style:l.listItem,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsHangTight",defaultMessage:"Typically, this change takes only minutes to occur, however, there are cases where it may take up to 72 hours for the DNS record to propagate."})}),(0,T.jsx)("li",{style:l.listItem,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsVerify",defaultMessage:'Click "Verify" to notify Notion to check your DNS record.'})})]}),(0,T.jsx)(_.Z,{style:{width:"100%"},onClick:()=>t(s),disabled:a,children:a?(0,T.jsx)(k.Z,{}):(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verify",defaultMessage:"Verify"})})]})};const E=function(e){window.__c={n:"VerifyDomainModal"};const t=(0,f.O7)(),s=(0,d.useIntl)(),a=(0,n.Fg)(),[o,r]=(0,y.AF)(e.store,b.ZP),{verificationType:u,verificationTargetId:m,refreshDomains:p}=e,g=(0,i.useCallback)((()=>{r((e=>({...e,loading:!1,modalOpen:!1})))}),[r]),h=(0,i.useCallback)((async e=>{r((e=>({...e,loading:!0})));const i="integration"===u?{type:u,integrationId:m,domain:e}:{type:u,spaceId:m,domain:e},n=await v.createDomainVerificationCode(t,i);if("success"===n.type){p(),x.G7$(t,{type:u});const e=n.data.domainVerification,s=(0,b.Hs)(e);r((e=>({...e,domainVerification:s,loading:!1})))}else c.showErrorMessage((0,S.wf)(s,n)),r((e=>({...e,loading:!1})))}),[t,r,m,p,u,s]),j=(0,i.useCallback)((async e=>{r((e=>({...e,loading:!0})));const i=await v.verifyDomain(t,{verificationId:e.id});if(x.DoK(t,{type:u}),"success"===i.type){p(),x.aOs(t,{type:u});const s={type:"verified",domain:e.domain};r((e=>({...e,domainVerification:s,loading:!1})))}else c.showErrorMessage((0,S.wf)(s,i)),r((e=>({...e,loading:!1})))}),[t,s,r,p,u]),w=(0,i.useCallback)((()=>{if(!o.domainVerification)return(0,T.jsx)(P,{handleAddNewDomain:h,loading:o.loading,verificationType:u});switch(o.domainVerification.type){case"invalid":return(0,T.jsx)(Z,{domain:o.domainVerification.domain,isExpired:Date.now()>o.domainVerification.expiresAt,onClose:g});case"unverified":return(0,T.jsx)(O,{handleVerifyDomain:j,domainVerification:o.domainVerification,loading:o.loading});case"verified":return(0,T.jsx)(A,{domain:o.domainVerification.domain,onClose:g,verificationType:u});default:(0,l.t1)(o.domainVerification)}}),[o.domainVerification,o.loading,j,h,g,u]);return(0,T.jsx)(M.Z,{open:o.modalOpen,preventHideChildrenWhileOpening:!0,onDismiss:g,render:()=>(0,T.jsx)("div",{style:{background:a.popoverBackground,width:410,padding:24,borderRadius:4},children:w()})})};var V=s(5478);const U=[{id:"domain",headerTitle:(0,T.jsx)(d.FormattedMessage,{id:"domainVerificationTable.table.header.domain",defaultMessage:"Domain"}),renderCell:e=>(0,T.jsx)(h.Z,{children:e.domain}),widthData:{width:100},sortable:!1},{id:"status",headerTitle:(0,T.jsx)(d.FormattedMessage,{id:"domainVerificationTable.table.header.status",defaultMessage:"Status"}),renderCell:e=>(0,T.jsx)(q,{status:e.status}),widthData:{width:100},sortable:!1},{id:"actions",headerTitle:null,renderCell:e=>(0,T.jsx)(G,{onShowDetails:e.onShowDetails,onRemove:e.onRemove}),widthData:{width:20},sortable:!1}],W=(0,d.defineMessages)({verifiedSAMLWarning:{defaultMessage:"Deleting this domain will prevent others with this email from logging in using SAML SSO.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.description"},verifiedIntegrationsWarning:{defaultMessage:"Deleting this domain will prevent integrations from unfurling urls that contain this domain.",id:"domainVerificationInput.myIntegrations.emailDomainsSection.removeDomain.description"},unverifiedDomainWarning:{defaultMessage:"Deleting this domain will restart its verification process. A new verification code will be generated for this domain in the next verification attempt.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.pending.description"}}),K={fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},z={fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"};function q(e){let{status:t}=e;window.__c={n:"VerificationToken"};const s=(0,n.yK)((e=>{const s={[V.YF.Success]:e.statusTokenBackground.green,[V.YF.Pending]:e.statusTokenBackground.yellow,[V.YF.Failure]:e.statusTokenBackground.red},i={[V.YF.Success]:e.statusTokenIndicator.green,[V.YF.Pending]:e.statusTokenIndicator.yellow,[V.YF.Failure]:e.statusTokenIndicator.red},n={[V.YF.Success]:e.statusTokenText.green,[V.YF.Pending]:e.statusTokenText.yellow,[V.YF.Failure]:e.statusTokenText.red};return{container:{background:s[t],color:n[t],display:"flex",justifyContent:"center",alignItems:"center",gap:6,borderRadius:18,height:20,paddingLeft:7,paddingRight:9},dot:{background:i[t],width:10,height:10,borderRadius:"100%"}}}),[t]);return(0,T.jsxs)("div",{style:s.container,children:[(0,T.jsx)("div",{style:s.dot}),H(t)]})}function G(e){let{onShowDetails:t,onRemove:s}=e;window.__c={n:"DropdownMenu"};const i=(0,n.yK)((e=>({primaryIcon:{width:14,height:14,color:e.mediumIconColor,fill:"currentColor"},menuItem:{width:250},menuIcon:{width:14,height:14,color:e.regularIconColor,fill:"currentColor"}})),[]),l=[];return t&&l.push({key:"details",action:()=>t(),render:e=>(0,T.jsx)(p.Z,{...e,style:i.menuItem,focused:!1,icon:(0,o.D)(i.menuIcon),title:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"View details",id:"securitySAMLSettings.emailDomainsSection.details"}),caption:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"See more information about the state of this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.detailsCaption"}),shouldWrapCaption:!0})}),s&&l.push({key:"remove",action:()=>s(),render:e=>(0,T.jsx)(p.Z,{...e,style:i.menuItem,focused:!1,icon:(0,r.y)(i.menuIcon),title:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Remove domain",id:"securitySAMLSettings.emailDomainsSection.remove"}),caption:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Delete this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.removeCaption"}),shouldWrapCaption:!0})}),0===l.length?null:(0,T.jsx)(g.N,{hideDropdownIcon:!0,title:(0,a.o)(i.primaryIcon),items:l})}function H(e){switch(e){case V.YF.Success:return(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Verified",id:"domainVerificationInput.emailDomainsSection.statusToken.verified"});case V.YF.Pending:return(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Pending",id:"domainVerificationInput.emailDomainsSection.statusToken.pending"});case V.YF.Failure:return(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Failed",id:"domainVerificationInput.emailDomainsSection.statusToken.failed"});default:(0,l.t1)(e)}}function Q(e){return{domain:e,status:V.YF.Success,data:{type:"verified",domain:e}}}function Y(e){return Date.now()>e.expiresAt||Boolean(e.invalidatedAt)?{domain:e.domain,status:V.YF.Failure,data:{type:"invalid",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}:{domain:e.domain,status:V.YF.Pending,data:{type:"unverified",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}}const $=function(e){window.__c={n:"DomainVerificationTable"};const{disabled:t,domains:s,domainVerificationStore:a,verificationType:o,verificationTargetId:r,refreshDomains:p,onRemoveDomain:g,onClickAddDomain:f,renderOverrideAddDomainButton:y}=e,x=(0,n.yK)((e=>(0,u.b)({columnRenderInfo:U,theme:e,containerMarginTop:0})),[]);function v(){t||(f&&f(),a.setState({domainVerification:void 0,loading:!1,modalOpen:!0}))}const S=s.map((e=>{let{domain:s,status:i,data:n}=e;return{id:"verified"===n.type?s:n.id,isClickable:!1,domain:s,status:i,onShowDetails:t?void 0:()=>function(e){t||a.setState({domainVerification:e,loading:!1,modalOpen:!0})}(n),onRemove:t?void 0:()=>async function(e,t){let s;if(t===V.YF.Failure)return void g(e);t===V.YF.Pending?s=W.unverifiedDomainWarning:t===V.YF.Success?s="saml_config"===o?W.verifiedSAMLWarning:W.verifiedIntegrationsWarning:(0,l.t1)(t),await c.confirmUserAction({message:(0,T.jsx)("div",{style:K,children:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Are you sure you want to delete this domain?",id:"domainVerificationInput.emailDomainsSection.removeDomain.message"})}),description:(0,T.jsx)("div",{style:z,children:(0,T.jsx)(d.FormattedMessage,{...s})}),acceptLabel:(0,T.jsx)(d.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.accept",defaultMessage:"Delete domain"}),cancelLabel:(0,T.jsx)(d.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.cancel",defaultMessage:"Cancel"})})&&g(e)}(n,i)}}));return(0,T.jsxs)(i.Fragment,{children:[y?y(v):(0,T.jsx)(m.Z,{isLarge:!0,disabled:t,onClick:v,style:{margin:"4px 0px 16px",width:"fit-content"},children:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})}),(0,T.jsx)(u.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:U,rows:S,styles:x,renderNoRowsComponent:()=>(0,T.jsx)(h.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,T.jsx)(d.FormattedMessage,{id:"securitySAMLSettings.emailDomainsSection.emptyTable",defaultMessage:"No domains configured."})})}),(0,T.jsx)(E,{store:a,verificationTargetId:r,verificationType:o,refreshDomains:p})]})}},1176:(e,t,s)=>{s.r(t),s.d(t,{default:()=>G});var i=s(67294),n=s(83355),a=s(41892),o=s(43593),r=s(72126),l=s(32056),d=s(23867),c=s(15047),u=s(31412),m=s(61652),p=s(1865),g=s(77080);var h=s(33929),f=s(87279),y=s(98742),x=s(61766),v=s(88632),S=s(71071),b=s(42922),M=s(52275),j=s(1743),w=s(74194),C=s(78140),k=s(32163),T=s(89728),I=s(72495),P=s(7931),_=s(24006),Z=s(87968),F=s(33411),A=s(26388),R=s(64369),D=s(92660),B=s(6202),L=s(60442),N=s(42115),O=s(85893);const E=["pdf","html","markdown"],V=["currentView","all"],U=e=>e>.1&&e<2,W=["everything","no_files"],K=(0,u.defineMessages)({dialogLabel:{id:"exportModal.dialogLabel",defaultMessage:"Export"}});class z extends n.Z{constructor(){super(...arguments),this.storeTypes={includeContentsPopupStore:x.Z,exportTypePopupStore:x.Z,pdfFormatPopupStore:x.Z,collectionViewExportTypePopupStore:x.Z},this.renderMenu=()=>{const{device:e}=this.environment;if(!v.Z.state.online)return this.renderOffline();const t=S.ZP.state;return t.open&&e.isMobile?this.renderMobileModal(t):t.open?this.renderDesktopModal(t):void 0},this.handleSelectExportType=(e,t)=>{const s=S.ZP.state;if(!s.open)return;const{exportOptions:i}=s;if(e===i.exportType)return;let n;n="pdf"===e?{...i,exportType:"pdf",pdfFormat:m.GI(t)}:{...i,exportType:e},m.BO(this.environment,{...s,exportOptions:n})},this.handleSelectPaperFormat=e=>{const t=S.ZP.state;t.open&&S.Sw(t)&&m.BO(this.environment,{...t,exportOptions:{...t.exportOptions,pdfFormat:e}})},this.handleSelectIncludeContents=e=>{const t=S.ZP.state;t.open&&m.BO(this.environment,{...t,exportOptions:{...t.exportOptions,includeContents:e}})},this.handleSelectCollectionExportType=e=>{const t=S.ZP.state;t.open&&m.BO(this.environment,{...t,exportOptions:{...t.exportOptions,collectionViewExportType:e}})},this.handleToggleFlattenExportFiletree=()=>{const e=S.ZP.state;e.open&&m.BO(this.environment,{...e,exportOptions:{...e.exportOptions,flattenExportFiletree:!e.exportOptions.flattenExportFiletree}})},this.handleToggleShouldExportComments=()=>{const e=S.ZP.state;e.open&&m.BO(this.environment,{...e,shouldExportComments:!e.shouldExportComments})},this.handleToggleRecursive=()=>{const e=S.ZP.state;if(e.open){if(S.Sw(e)&&!m.y1(this.environment))return p.y(this.environment,{from:"export_modal",for:"enterprise"}),void this.handleUpgrade();m.BO(this.environment,{...e,recursive:!e.recursive})}},this.handleSetScalePercent=e=>{const t=S.ZP.state;t.open&&S.Sw(t)&&m.BO(this.environment,{...t,exportOptions:{...t.exportOptions,scale:e}})},this.handleCancel=()=>{m.Qr()},this.handleSubmit=()=>{if(!X())return;const e=S.ZP.state;e.open&&(m.Qr(),e.root.table===c.bx?m.AW(this.environment,{spaceId:e.root.id,exportOptions:e.exportOptions,shouldExportComments:e.shouldExportComments}):m.ZO(this.environment,{block:{id:e.root.id,spaceId:(0,d.C)(e.root.spaceId)},recursive:e.recursive,exportOptions:e.exportOptions,shouldExportComments:e.shouldExportComments}))},this.handleUpgrade=()=>{m.Qr()}}renderComponent(){return(0,O.jsx)(D.Z,{ariaLabel:h.default.formatMessage(K.dialogLabel),onDismiss:this.handleCancel,render:this.renderMenu,requireOnline:!0,modalStore:S.ZP})}renderOffline(){return(0,O.jsx)("div",{style:this.getOfflineStyle(),children:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Please go online to export.",id:"exportModal.offlineMessage.description"})})}renderMobileModal(e){const t={menuType:f.og.Modal,title:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.title",defaultMessage:"Export"}),right:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return(0,O.jsx)(C.Z,{...t,children:(0,O.jsx)(k.Z,{type:k.i.Vertical,initialFocus:void 0,sections:[{key:"exportOptions",render:e=>(0,O.jsx)(I.Z,{...e}),items:this.getMobileExportOptionsMenuItems(e)},{key:"actions",render:e=>{let{children:t,...s}=e;return(0,O.jsx)(I.Z,{isSubmitButton:!0,...s,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...s}=e;return(0,O.jsx)(B.Z,{...s,onClick:t||this.handleSubmit,disabled:!X(),title:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.exportButton.label",defaultMessage:"Export"})})},action:this.handleSubmit}]}]})})}renderDesktopModal(e){const{device:t,currentUser:s}=this.environment,i=S.Sw(e)&&!m.y1(this.environment)&&"business",n=this.environment.device.isWindows;return(0,O.jsxs)("div",{style:{width:320,padding:24,fontSize:14},children:[(0,O.jsx)(P.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.exportFormat.description",defaultMessage:"Export format"}),selectedTitle:H(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,O.jsx)(I.Z,{...e}),items:E.map((t=>this.getBlockExportTypeMenuListItem(t,e,s.id)))}]}),e.exportOptions.collectionViewExportType&&(0,O.jsx)(P.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.collectionViewExportTypePopupStore,label:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.includeDatabases.description",defaultMessage:"Include databases"}),selectedTitle:Y(e.exportOptions.collectionViewExportType||"currentView"),renderMenuSections:e=>[{key:"exportCollection",render:e=>(0,O.jsx)(I.Z,{...e}),items:V.map((t=>this.getCollectionViewExportTypeMenuListItem(t,e)))}]}),(0,O.jsx)(P.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.includeContentsPopupStore,label:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.includeContents.description",defaultMessage:"Include content"}),selectedTitle:Q(e.exportOptions.includeContents||"everything"),renderMenuSections:e=>[{key:"includeContents",render:e=>(0,O.jsx)(I.Z,{...e}),items:W.map((t=>this.getIncludeContentsMenuListItem(t,e)))}]}),S.Sw(e)&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(P.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.pageFormat.description",defaultMessage:"Page format"}),selectedTitle:$(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,O.jsx)(I.Z,{...e}),items:o.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>(0,O.jsx)(I.Z,{topBorder:!0,...e}),items:o.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]}),this.renderScalePercent()]}),"space"!==e.root.table&&(0,O.jsx)(N.Z,{requireUpgradeToTier:i,analyticsName:"export_modal",onClick:this.handleToggleRecursive,render:(t,s)=>(0,O.jsxs)("div",{...t,style:{display:"flex",alignItems:"center",height:32},children:[(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:"auto",color:this.theme.lightTextColor,fontSize:14},children:[(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",s&&(0,O.jsx)("div",{style:{marginLeft:8},children:s})]}),(0,O.jsx)(_.Z,{on:e.recursive,disabled:Boolean(i)})]}),renderUpgradeTooltip:()=>(0,O.jsx)(L.Z,{imageURL:a.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:A.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade}),(0,O.jsx)(Z.Z,{title:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.flattenExportFiletree.description",defaultMessage:"Create folders for subpages"}),subtitle:"",style:{color:this.theme.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:void 0===e.exportOptions.flattenExportFiletree?!n:!e.exportOptions.flattenExportFiletree,disabled:!e.recursive,onChange:()=>this.handleToggleFlattenExportFiletree()}),"on"===g.default.getEligibleGroup({experimentId:"export_comments",defaultGroup:"control"})&&"html"===e.exportOptions.exportType?(0,O.jsx)(Z.Z,{title:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.shouldExportComments.description",defaultMessage:"Export comments"}),subtitle:"",style:{color:this.theme.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:e.shouldExportComments,onChange:()=>this.handleToggleShouldExportComments()}):null,(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:16},children:[(0,O.jsx)(T.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleCancel,children:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Cancel",id:"exportModal.cancelButton.label"})}),(0,O.jsx)(b.Z,{onClick:this.handleSubmit,disabled:!X(),children:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Export",id:"exportModal.exportButton.label"})})]})]})}renderScalePercent(){const e=J();return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:32},children:[(0,O.jsx)(R.Z,{style:{color:this.theme.lightTextColor},children:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.pageScale.description",defaultMessage:"Scale percent"})}),(0,O.jsx)(q,{value:e,onChange:this.handleSetScalePercent})]}),!U(e)&&(0,O.jsx)(F.Z,{show:!0,showDelay:500,showHold:100,render:e=>e&&(0,O.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:32,padding:"4px 0"},children:(0,O.jsx)(R.Z,{isSmall:!0,isMultiline:!0,style:{color:this.theme.errorText},children:(0,O.jsx)(u.FormattedMessage,{id:"exportModal.pageScale.invalidScaleError",defaultMessage:"Scale percent must be a number between 10 and 200"})})})})]})}getMobileExportOptionsMenuItems(e){const{currentUser:t,device:s}=this.environment;return r.oA([{key:"export type",render:i=>(0,O.jsx)(P.Z,{...i,isMenuItem:s.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Export format",id:"exportModal.exportFormat.description"}),selectedTitle:H(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,O.jsx)(I.Z,{...e}),items:E.map((s=>this.getBlockExportTypeMenuListItem(s,e,t.id)))}]}),action:()=>{this.stores.exportTypePopupStore.setState({open:!0})}},S.Sw(e)&&{key:"pdf format",render:t=>(0,O.jsx)(P.Z,{...t,isMenuItem:s.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Page format",id:"exportModal.pageFormat.description"}),selectedTitle:$(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,O.jsx)(I.Z,{...e}),items:o.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>(0,O.jsx)(I.Z,{topBorder:!0,...e}),items:o.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]}),action:()=>{this.stores.pdfFormatPopupStore.setState({open:!0})}},"space"!==e.root.table&&{key:"recursive",render:t=>{let{onClick:s,key:i,...n}=t;const o=S.Sw(e)&&!m.y1(this.environment)&&"business";return(0,O.jsx)(N.Z,{requireUpgradeToTier:o,analyticsName:"export_modal",onClick:s,render:(t,s)=>{const i=(0,y.Z)(n,t);return(0,O.jsx)(M.Z,{...i,title:(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",s&&(0,O.jsx)("div",{style:{marginLeft:8},children:s})]}),right:(0,O.jsx)(_.Z,{...i,on:e.recursive,disabled:Boolean(o)})})},renderUpgradeTooltip:()=>(0,O.jsx)(L.Z,{imageURL:a.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:A.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade},i)},action:this.handleToggleRecursive}])}getBlockExportTypeMenuListItem(e,t,s){const i=S.ZP.state,n=i.open&&"pdf"===e&&"space"===i.root.table&&!m.y1(this.environment)&&"business";return{key:e,action:()=>{if(t.close(),n)return p.y(this.environment,{from:"export_modal",for:n}),void this.handleUpgrade();this.handleSelectExportType(e,s)},render:s=>{let{onClick:i,key:o,...r}=s;return(0,O.jsx)(N.Z,{requireUpgradeToTier:n,analyticsName:"export_modal",onClick:i,onUpgradeClick:()=>{t.close(),this.handleUpgrade()},render:(t,s)=>(0,O.jsx)(M.Z,{...(0,y.Z)(r,t),title:H(e),right:s}),renderUpgradeTooltip:()=>(0,O.jsx)(L.Z,{imageURL:a.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Upgrade to export the workspace as PDFs",id:"exportModal.workspacePdfUpgradeTooltip.title"}),caption:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Creates a zip file containing all pages in the workspace as PDF files.",id:"exportModal.workspacePdfUpgradeTooltip.caption"})}),tooltipPlacement:A.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2}},o)}}}getIncludeContentsMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectIncludeContents(e)},render:t=>(0,O.jsx)(M.Z,{...t,title:Q(e)})}}getCollectionViewExportTypeMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectCollectionExportType(e)},render:t=>(0,O.jsx)(M.Z,{...t,title:Y(e)})}}getPaperFormatMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectPaperFormat(e)},render:t=>(0,O.jsx)(M.Z,{...t,title:$(e)})}}getOfflineStyle(){return{width:320,padding:24,fontSize:14,color:this.theme.mediumTextColor}}}function q(e){let{value:t,onChange:s}=e;window.__c={n:"PercentInput"};const n=(0,u.useIntl)(),a=i.useCallback((e=>{const t=e.target.value,i=(0,l._g)(t)||(0,l.p3)(t);let n;"object"==typeof i?n="percent"===i.format?i.value:i.value/100:"number"==typeof i&&(n=i/100),void 0!==n&&s(n)}),[s]),[o,r]=i.useState(!1),d=i.useMemo((()=>(0,l.uf)(Math.round(100*t),"number",n)),[t,n]);return(0,O.jsx)(j.Z,{capture:o,children:(0,O.jsx)(w.Z,{value:d,onChange:a,onFocus:()=>r(!0),onBlur:()=>r(!1),style:{width:60},inputStyle:{textAlign:"right"}})})}z.displayName="ExportModal";const G=z;function H(e){switch(e){case"pdf":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.exportFormatButton.pdf.label",defaultMessage:"PDF"});case"markdown":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.exportFormatButton.markdownAndCSV.label",defaultMessage:"Markdown & CSV"});case"html":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.exportFormatButton.html.label",defaultMessage:"HTML"})}}function Q(e){switch(e){case"everything":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.includeContentTypes.everything.label",defaultMessage:"Everything"});case"no_files":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.includeContentTypes.no_files.label",defaultMessage:"No files or images"})}}function Y(e){switch(e){case"all":return g.default.checkGate("export_collections_v1")?(0,O.jsx)(u.FormattedMessage,{id:"exportModal.includeDatabases.all.label.defaultView",defaultMessage:"Default View"}):(0,O.jsx)(u.FormattedMessage,{id:"exportModal.includeDatabases.all.label.everything",defaultMessage:"Everything"});case"currentView":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.includeDatabases.currentView.label",defaultMessage:"Current view"})}}function $(e){switch(e){case"Letter":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.letter.label",defaultMessage:"Letter"});case"A3":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.a3.label",defaultMessage:"A3"});case"A4":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.a4.label",defaultMessage:"A4"});case"Legal":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.legal.label",defaultMessage:"Legal"});case"Tabloid":return(0,O.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.tabloid.label",defaultMessage:"Tabloid"})}}function J(){const e=S.ZP.state;return e.open&&S.Sw(e)?void 0===e.exportOptions.scale?1:e.exportOptions.scale:1}function X(){return U(J())}},16972:(e,t,s)=>{s.d(t,{Z:()=>z});var i=s(67294),n=s(73935),a=s(83355),o=s(72126),r=s(31412),l=s(47307),d=s(27153),c=s(53471),u=s(33929),m=s(87279),p=s(83279),g=s(13401),h=s(79131),f=s(1743),y=s(78140),x=s(40721),v=s(72495),S=(s(57658),s(95538)),b=s(43593),M=s(50066),j=s(50906),w=s(54604),C=s(75018),k=s(95477),T=s(49085);class I extends T.default{getInitialState(){return{open:!1}}}const P=I;var _=s(24736),Z=s(52275),F=s(31945),A=s(74194),R=s(32163),D=s(53437),B=s(81865),L=s(85893);class N extends a.Z{constructor(){super(...arguments),this.storeTypes={filePropertyMenuItemStore:P},this.imageNode=void 0,this.renderRenameMenu=()=>{const{device:e}=this.environment,t=this.stores.filePropertyMenuItemStore.state;if(!t.open)return;let s;return s=e.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:380},(0,L.jsx)(y.Z,{...s,children:(0,L.jsx)("div",{style:this.getInputWrapStyle(),children:(0,L.jsx)(A.Z,{style:this.getInputStyle(),value:t.inputValue,placeholder:b.w2(this.props.url),onChange:this.handleRenameInputChange,onSubmit:this.handleCloseRename,focusInitial:!0,selectAll:!0})})})},this.handleFullScreen=()=>{w.ui({environment:this.environment,renderFullScreenNode:()=>(0,L.jsx)(B.Z,{url:this.props.url,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>(0,L.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:this.imageNode.getBoundingClientRect(),block:this.props.store,imageUrl:this.props.url})},this.handleRename=()=>{this.stores.filePropertyMenuItemStore.setState({open:!0,inputValue:this.props.name})},this.handleCloseRename=()=>{this.stores.filePropertyMenuItemStore.setState({open:!1})},this.handleRenameInputChange=e=>{const t=this.stores.filePropertyMenuItemStore.state;if(!t.open)return;const s=e.target.value;this.stores.filePropertyMenuItemStore.setState({...t,inputValue:s});const i=b.rF({title:s,source:this.props.url});this.props.onChange({url:this.props.url,name:i})},this.handleViewOriginal=()=>{const{url:e,name:t}=this.props;C.openFileUrl(this.environment,{url:e,type:"file",from:"view_original",downloadName:t,permissionRecord:this.props.store.pointer})},this.handleDownload=()=>{const{url:e,name:t}=this.props;j.Uk(this.environment,{url:e,fileName:t,from:"FilePropertyMenuItem"}),C.downloadFileUrl(this.environment,{url:e,download:!0,downloadName:t,permissionRecord:this.props.store.pointer})},this.handleDelete=()=>{this.props.onDelete(this.props.url)}}renderComponent(){const{url:e}=this.props;return S.SR({url:e})?this.renderImage(e):this.renderFile()}renderImage(e){const{device:t}=this.environment,{disabled:s}=this.props;return(0,L.jsx)(Z.Z,{focused:!1,showDragHandle:!s&&!t.isMobile,style:{paddingTop:t.isMobile?12:8,paddingBottom:t.isMobile?12:8,alignItems:"flex-start"},title:(0,L.jsx)(B.Z,{url:e,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>(0,L.jsx)("div",{style:N.innerStyle,children:(0,L.jsx)("img",{src:t,style:N.imageStyle,onClick:this.handleFullScreen,ref:e=>this.imageNode=e})})}),right:this.renderActionMenu(!0),dontShrinkRight:!0})}renderFile(){const{device:e}=this.environment,{disabled:t}=this.props,{name:s}=this.props;return(0,L.jsx)(D.GI,{open:this.stores.filePropertyMenuItemStore.state.open,popupType:e.isMobile?F.Z4.SlideUp:F.Z4.Popup,origin:(0,L.jsx)(Z.Z,{focused:!1,showDragHandle:!t&&!e.isMobile,onClick:this.handleViewOriginal,title:s,icon:(0,L.jsx)("div",{style:{width:e.isMobile?16:14},children:(0,M.R)()}),right:this.renderActionMenu(!1),dontShrinkRight:!0}),render:this.renderRenameMenu,onDismiss:this.handleCloseRename})}getActionMenuItems(e){const{device:t}=this.environment,{url:s,disabled:i}=this.props,n=[];return e&&n.push({key:"fullscreen",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})}),action:this.handleFullScreen}),(b.E$(s,[k.default.secureFileS3.url,k.default.secureFileS3V2.url])||t.isNative)&&n.push({key:"download",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})}),action:this.handleDownload}),n.push({key:"original",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})}),action:this.handleViewOriginal}),i||e||n.push({key:"rename",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})}),action:this.handleRename}),i||n.push({key:"delete",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})}),action:this.handleDelete}),n}renderActionMenu(e){const{device:t}=this.environment;return(0,L.jsx)(F.ZP,{popupType:t.isMobile?F.Z4.SlideUp:F.Z4.Popup,renderOrigin:e=>(0,L.jsx)(_.Z,{isMobile:t.isMobile,...e}),render:s=>{let i;return i=t.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:200},(0,L.jsx)(y.Z,{...i,children:(0,L.jsx)(R.Z,{type:R.i.Vertical,initialFocus:0,onAccept:s.close,sections:[{key:"section",render:e=>(0,L.jsx)(v.Z,{...e}),items:this.getActionMenuItems(e)}]})})}})}getInputWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}N.displayName="FilePropertyMenuItem",N.imageStyle={display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"},N.innerStyle={flex:"auto",overflow:"hidden"};const O=N;var E=s(68785),V=s(28992),U=s(32854);const W=function(e){return(0,L.jsx)(V.Z,{title:(0,L.jsxs)("div",{style:{display:"flex"},children:[(0,L.jsx)(E.Z,{style:{marginTop:1,marginRight:6}}),(0,L.jsx)(U.Z,{percentage:e.progressPercent})]})})};class K extends a.Z{constructor(){super(...arguments),this.uploadingFiles=void 0,this.storeTypes={fileUploadStore:p.Z},this.renderFile=e=>{const{device:t}=this.environment,{value:s,disabled:i}=this.props,n=s.find((t=>t.url===e));if(n){const e=n.url,s=n.name;return t.isMobile?(0,L.jsx)(v.Z,{children:(0,L.jsx)(O,{store:this.props.store,name:s,url:e,onDelete:this.handleFileDelete,onChange:this.handleFileChange,disabled:i})},e):(0,L.jsx)(O,{store:this.props.store,name:s,url:e,onDelete:this.handleFileDelete,onChange:this.handleFileChange,disabled:i},e)}},this.handleAddFileMount=e=>{e&&(this.addFileButton=e)},this.handleAddFileClick=e=>{this.showMediaPicker()},this.handleDraggableDrop=e=>{const{onChange:t,value:s}=this.props;t({value:o.MR(s,(t=>{const s=t.url;return s?e.indexOf(s):1/0}))})},this.handleMediaPickerUploadStart=e=>{d.Z(),this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=[e]},this.handleMediaPickerUploadComplete=e=>{const{value:t,onChange:s}=this.props;if(!this.uploadingFiles)return;const i=this.uploadingFiles[0];if(!i)return;s({value:[...t,{name:i.name||e,url:e}]}),this.stores.fileUploadStore.reset(),d.Z()},this.handleMediaPickerEmbedComplete=e=>{const{value:t,onChange:s}=this.props;s({value:[...t,{name:e,url:e}]}),this.stores.fileUploadStore.reset(),d.Z()},this.handleUploadFilesStart=e=>{this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=e},this.handleUploadFilesComplete=e=>{const{value:t,onChange:s}=this.props;if(!this.uploadingFiles)return;s({value:[...this.uploadingFiles.map(((t,s)=>{const i=e[s];return{name:t.name||i,url:i}})),...t]}),this.stores.fileUploadStore.reset()},this.handleUploadProgress=e=>{const{progressPercent:t}=e;this.stores.fileUploadStore.setState({...this.stores.fileUploadStore.state,progressPercent:t})},this.handleUploadError=()=>{this.stores.fileUploadStore.reset(),l.showErrorMessage((0,L.jsx)(r.FormattedMessage,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."}))},this.handleFileChange=e=>{const{value:t,onChange:s}=this.props;s({value:t.map((t=>t.url===e.url?{name:e.name,url:e.url}:t))})},this.handleFileDelete=e=>{const{value:t,onChange:s}=this.props;s({value:t.filter((t=>t.url!==e))})}}didMount(){const{device:e}=this.environment,{uploadFiles:t,store:s}=this.props;t?c.IL({environment:this.environment,files:t,bucket:"secure",record:s.pointer,onBatchStart:this.handleUploadFilesStart,onBatchProgress:this.handleUploadProgress,onBatchComplete:this.handleUploadFilesComplete,onBatchError:this.handleUploadError}):q(this.props.value)&&!e.isMobile&&this.showMediaPicker()}willUnmount(){d.Z()}renderComponent(){const{device:e}=this.environment,{disabled:t}=this.props,s=q(this.props.value),{isLoading:i,progressPercent:n}=this.stores.fileUploadStore.state;let a;return a=e.isMobile?{menuType:m.og.Modal,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:(0,L.jsx)(x.DoneMenuText,{}),onClickRight:this.props.onDismiss}:{menuType:m.og.Popup},(0,L.jsx)(f.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,L.jsxs)(y.Z,{...a,children:[this.renderFiles(),(0,L.jsxs)(v.Z,{topBorder:!s&&!t,desktopStyle:{...s&&{paddingTop:3,paddingBottom:3}},children:[i&&(0,L.jsx)(W,{progressPercent:n}),!i&&!t&&(0,L.jsx)(g.Z,{focused:!1,onClick:this.handleAddFileClick,title:(0,L.jsx)(r.FormattedMessage,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:this.handleAddFileMount})]})]})})}renderFiles(){const{device:e}=this.environment,{value:t,disabled:s}=this.props,n=o.oA(t.map((e=>e.url)));return 0===n.length?void 0:e.isMobile||s?(0,L.jsx)(i.Fragment,{children:n.map(this.renderFile)}):(0,L.jsx)(v.Z,{children:(0,L.jsx)(h.ZP,{direction:"vertical",keys:n,renderKey:this.renderFile,onDrop:this.handleDraggableDrop})})}showMediaPicker(){const{store:e}=this.props,t=n.findDOMNode(this.addFileButton);if(!t)return;if(!(t instanceof Element))return;const s=u.default.getIntl();d.$(this.environment,{originRect:t.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:s.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:t=>{c.cT({environment:this.environment,file:t,bucket:"secure",record:e.pointer,onStart:this.handleMediaPickerUploadStart,onProgress:this.handleUploadProgress,onComplete:this.handleMediaPickerUploadComplete,onError:this.handleUploadError})}},{type:"embed",onChange:this.handleMediaPickerEmbedComplete}]})}}K.displayName="FilePropertyMenu";const z=K;function q(e){return 0===e.length}},79027:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(41892),l=s(82990),d=s(31412),c=s(91376),u=s(17311),m=s(7844),p=s(42922),g=s(50506),h=s(62385),f=s(85893);function y(){window.__c={n:"GoogleAuthPromptModal"};const e=(0,n.Fy)(),t=(0,a.VK)((()=>m.Z.state.open),[]),s=()=>{m.Z.state.open&&m.Z.state.onDecline&&m.Z.state.onDecline(),m.Z.setState({open:!1})},y=()=>{m.Z.state.open&&m.Z.state.onConfirm(),m.Z.setState({open:!1})},x=()=>{s(),c.r$({currentTab:"connected_apps"})},v=(0,o.yK)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:l.Z.fontWeight.medium,marginTop:15,marginBottom:20,color:e.mediumTextColor}})),[]);return(0,f.jsx)(g.Z,{open:t,innerStyle:v.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,f.jsx)(i.Fragment,{children:(0,f.jsxs)("div",{style:v.modalHeaderWrap,children:[(0,f.jsx)("img",{src:r.Z.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,f.jsx)("div",{style:v.modalMessage,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,f.jsx)("div",{style:v.modalMessage,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,f.jsx)(p.Z,{isLarge:!0,onClick:y,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),!e.isMobile&&(0,f.jsx)("div",{style:{display:"block",marginTop:u.Z.vertical.tiny},children:(0,f.jsx)(h.Z,{underlined:!0,onClick:x,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]})}),onDismiss:s})}},7523:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var i=s(67294),n=s(83355),a=s(480),o=s(15145),r=s(84169),l=s(82990),d=s(31412),c=s(50906),u=s(75018),m=s(18514),p=s(80444),g=s(47593),h=s(16354),f=s(50506),y=s(89728),x=s(3666),v=s(85893);class S extends n.Z{constructor(){super(...arguments),this.handleModalDismiss=()=>{g.Z.setState({open:!1})},this.handleImportComplete=e=>{g.Z.setState({open:!1}),u.navigateToBlock({environment:this.environment,store:e,pageVisitSource:o.tY.Import})}}renderComponent(){const e=g.Z.state;return(0,v.jsx)(f.Z,{open:e.open,innerStyle:S.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>(0,v.jsxs)(i.Fragment,{children:[(0,v.jsxs)("div",{style:S.modalTopbarWrapStyle,children:[(0,v.jsx)("div",{style:S.modalTopbarHeaderStyle,children:(0,v.jsx)(d.FormattedMessage,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,v.jsx)(M,{})]}),(0,v.jsx)("div",{children:this.renderImportOptions(e)})]}),onDismiss:this.handleModalDismiss})}renderImportOptions(e){const{mainEditorCurrentBlockStore:t,currentSpaceStore:s,currentSpaceViewStore:i,currentUserSettingsStore:n}=p.default.state;if(t&&s&&i&&n)return(0,v.jsx)(x.Z,{pageStore:e.open&&e.pageStore?e.pageStore:t,spaceStore:s,spaceViewStore:i,userSettingsStore:n,analyticsFrom:"modal",onComplete:this.handleImportComplete,readOnlyCreditButton:!1})}}S.displayName="ImportModal",S.wrapStyle={padding:"24px 36px 24px",minWidth:300},S.modalTopbarWrapStyle={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},S.modalTopbarHeaderStyle={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:l.Z.fontWeight.bold,marginRight:"auto"};const b=S;function M(){window.__c={n:"HelpButton"};const e=(0,a.O7)();return(0,v.jsx)(h.Z,{href:(0,m.UY)("guides.import"),onClick:()=>c.Fsx(e,{from:"import"}),external:!0,children:(0,v.jsx)(y.Z,{isSmall:!0,icon:r.m,isGray:!0,children:(0,v.jsx)(d.FormattedMessage,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}},3666:(e,t,s)=>{s.d(t,{Z:()=>gt});var i=s(67294),n=s(83355),a=s(86628),o=s(41892),r=s(56666),l=s(84169),d=s(82356),c=s(63079),u=s(68838),m=s(39370),p=s(4615),g=s(31412),h=s(50906),f=s(47307),y=s(49085);class x extends y.default{getInitialState(){return{}}}const v=new x;var S=s(54642),b=s(92625);async function M(e){const{environment:t,spaceId:s,requestStore:i}=e;if(!t.currentUser.id)return f.showMessage({message:"Invalid details"}),void b.x();v.setState({...v.state,[s]:{...v.state[s],showLoader:!0}});const n=await S.getConfluenceSpaces(t,{spaceId:s});if(await(null==i?void 0:i.refresh()),v.setState({...v.state,[s]:{...v.state[s],showLoader:!1}}),"failed"!==n.type)return v.setState({...v.state,[s]:{...v.state[s],spacesResult:n.data}}),n.data;console.error(n.error),f.showError(n),b.x()}var j=s(43181),w=s(68821),C=s(72340),k=s(8989),T=s(22756),I=s(69122);async function P(e){const t=await S.getTrelloAccount(e,{});return"success"===t.type?t.data:(console.error(t.error),{})}async function _(e){T.Z.setState({...T.Z.state,isFetchingAsanaAccount:!0});const t=await S.getAsanaAccount(e,{});if("success"===t.type){const{account:e}=t.data;return T.Z.setState({...T.Z.state,account:e,isFetchingAsanaAccount:!1}),e?t.data:{}}return console.error(t.error),T.Z.setState({...T.Z.state,isFetchingAsanaAccount:!1}),{}}async function Z(e){try{const t=await S.getEvernoteAccount(e,{});if("success"===t.type){const{userInfo:e}=t.data;return{userInfo:e}}return console.error(t.error),{userInfo:void 0}}catch(t){return console.error(t),{userInfo:void 0}}}var F=s(77080);var A=s(87279);var R=s(18514),D=s(88632),B=s(67940),L=s(72087),N=s(480),O=s(8848),E=s(41311),V=s(80444);const U=new(s(61766).Z);var W=s(93405),K=s(31945),z=s(73063),q=s(16354),G=s(68785),H=s(78140),Q=s(32163),Y=s(53437),$=s(72495),J=s(26388),X=s(64369),ee=s(82990),te=s(64921),se=s(85893);const ie=28;class ne extends n.Z{renderComponent(){const{title:e,actionButton:t,onClick:s,tooltipEvents:i}=this.props;return(0,se.jsxs)(te.Z,{...i,onClick:s,style:this.getButtonStyle(),children:[this.renderIcon(),(0,se.jsxs)("div",{style:{minWidth:0,width:"100%"},children:[(0,se.jsxs)("div",{style:{display:"flex"},children:[(0,se.jsx)("div",{style:ne.titleStyle,children:e}),(0,se.jsx)("div",{style:{marginLeft:"auto"},children:t})]}),this.renderCaption()]})]})}renderIcon(){const{icon:e,logo:t}=this.props;return t?(0,se.jsx)("img",{style:ne.imageIconStyle,src:t}):e?(0,se.jsx)("div",{style:this.getIconWrapStyle(),children:e({flexShrink:0,width:ie,height:ie})}):void 0}renderCaption(){const{caption:e}=this.props;if(e)return(0,se.jsx)("div",{style:this.getCaptionStyle(),children:e})}getButtonStyle(){return{display:"flex",alignItems:"center",padding:10,paddingRight:8,borderRadius:4,marginBottom:12,cursor:"pointer",boxShadow:this.theme.lightBoxShadow,transition:"background 200ms ease-out",background:this.theme.importOptionsButtonBackground}}getIconWrapStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",width:ie,height:ie,borderRadius:4,marginRight:8,color:this.theme.mediumTextColor,background:this.theme.importOptionsIconWrapBackground}}getCaptionStyle(){return{fontSize:12,color:this.theme.mediumTextColor,wordBreak:"keep-all",...!this.props.shouldWrapCaption&&{...ee.Z.textOverflowStyle}}}}ne.displayName="ImportOptionsItem",ne.imageIconStyle={flexShrink:0,width:ie,height:ie,borderRadius:4,marginRight:10,background:O.ZP.white},ne.titleStyle={fontSize:16,fontWeight:ee.Z.fontWeight.medium};const ae=ne;const oe={whiteSpace:"pre-wrap"};function re(e,t){return(0,se.jsx)(J.Z,{renderTooltip:()=>(0,se.jsx)(X.Z,{style:{color:O.ZP.white},isSmall:!0,children:(0,se.jsx)(g.FormattedMessage,{id:"AsanaImportOption.helpButton.tooltip",defaultMessage:"Learn about how to import"})}),render:s=>(0,se.jsx)(q.Z,{...s,external:!0,href:e,style:{marginLeft:"auto"},children:(0,se.jsx)(z.Z,{icon:l.m,ariaLabel:t.formatMessage({id:"AsanaImportOption.helpButton.ariaLabel",defaultMessage:"Learn about how to asana import help icon"})})})})}const le=function(){window.__c={n:"AsanaV2ImportOption"};const e=(0,a.VK)((()=>T.Z.state),[]),t=(0,a.VK)((()=>B.Z.state),[]),{account:s,isLoadingAsanaWorkspaces:i,isAccountDelinkingInProgress:n,isAccountLinkingInProgress:l}=e,d=(0,N.O7)(),c=(0,g.useIntl)(),{device:u}=d,m=t.flowId||(0,p.ZP)();t.flowId||B.Z.setState({flowId:m});const f={title:c.formatMessage({id:"asanaImportOption.asanaButton.title",defaultMessage:"Asana"}),logo:o.Z.images.import.asanaPng,caption:l?c.formatMessage({id:"asanaImportOption.asanaButton.accountLinkingInProgress",defaultMessage:"Authenticating..."}):n?c.formatMessage({id:"asanaImportOption.asanaButton.accountDelinkingInProgress",defaultMessage:"Removing account..."}):s,actionButton:s?(y=[{name:c.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),captionText:c.formatMessage({id:"asanaImportOption.connectAnotherAccount.captionText",defaultMessage:"Ensure you are logged into the new Asana account in your browser"}),action:()=>E.w1({environment:d,flowId:m}).catch((()=>{}))},{name:c.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>E.XP({environment:d})}],(0,se.jsx)(K.ZP,{popupType:Y.kQ.Popup,renderOrigin:e=>i?(0,se.jsx)(G.Z,{}):(0,se.jsx)(z.Z,{ariaLabel:c.formatMessage({id:"asanaImportOption.asanaButton.ariaLabel",defaultMessage:"Import from Asana button"}),icon:r.o,...e}),render:e=>{const t={key:"section",render:e=>(0,se.jsx)($.Z,{...e}),items:y.map((t=>{let{name:s,captionText:i,action:n}=t;return{key:s,render:e=>(0,se.jsx)(W.Z,{...e,title:s,caption:i,captionStyle:i?oe:void 0}),action:()=>{n(),e.close()}}}))};return(0,se.jsx)(H.Z,{menuType:A.og.Popup,width:200,children:(0,se.jsx)(Q.Z,{type:Q.i.Vertical,initialFocus:void 0,sections:[t]})})}})):re((0,R.UY)("guides.importAsana"),c),onClick:()=>{}};var y;return(0,se.jsx)(K.ZP,{onClick:async()=>{var e;T.Z.resetImport(),i||l||n||(s?(h.ays(d,{import_source:"asana",from:"settings_modal",userId:d.currentUser.id,spaceId:null===(e=V.default.state.currentSpaceStore)||void 0===e?void 0:e.id,flowId:m}),await E.bA({environment:d}),E.h7()):E.w1({environment:d,flowId:m}).catch((()=>{})))},popupType:u.isMobile?K.Z4.SlideUp:K.Z4.Popup,buttonPopupStore:U,renderOrigin:e=>{let{onClick:t}=e;return(0,se.jsx)(ae,{...f,onClick:t})},render:()=>null})};var de=s(24405),ce=s(36591),ue=s(42853),me=s(44495),pe=s(22711),ge=s(78900),he=s(42922),fe=s(52275),ye=s(61519),xe=s(1743),ve=s(74194),Se=s(50506),be=s(63296),Me=s(89728),je=s(74523),we=s(58573);class Ce extends y.default{getInitialState(){return{searchQuery:"",selection:new Set}}}const ke=Ce;var Te=s(68894),Ie=s(43765),Pe=s(29551);class _e extends n.Z{constructor(){super(...arguments),this.storeTypes={store:ke},this.handleToggleItem=e=>{this.props.onComplete(e)}}willMount(e){const t=this.stores.store.state.selection,[s]=e.sections;if(s){const[e]=s.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return(0,se.jsx)(H.Z,{menuType:A.og.Popup,header:this.renderMenuHeader(),width:280,maxHeight:350,children:this.renderMenuList()})}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state;return(0,se.jsx)($.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:(0,se.jsx)(Te.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e})})}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:s}=this.stores,{searchQuery:i}=s.state,n=e.map((e=>{const t=(0,we.ZP)(i,e.items,(t=>`${t.key} ${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===n.length)return(0,se.jsx)($.Z,{children:(0,se.jsx)(Ie.Z,{title:t})});const a=n.map((t=>{const s=t.items.map((e=>e.name)),i={};return s.forEach((e=>{i[e]=i[e]?i[e]+1:1})),{key:t.name,render:s=>(0,se.jsx)($.Z,{...s,title:e.length>1?t.name:void 0}),items:t.items.map((e=>({key:e.key,render:t=>(0,se.jsx)(fe.Z,{...t,title:(0,se.jsxs)(Pe.gq,{gap:2,alignItems:"center",children:[e.name,i[e.name]>1&&(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,renderTooltip:()=>e.key,render:t=>(0,se.jsx)(z.Z,{ariaLabel:`Associated space key is ${e.key}`,disableBackground:!0,icon:me.D,...t})})]}),right:void 0!==e.count&&(0,se.jsx)(X.Z,{isSmall:!0,children:e.count})}),action:()=>{this.props.handleClickImportConfluenceWorkspace(e.key,e.name),this.handleToggleItem(e)}})))}}));return(0,se.jsx)(Q.Z,{type:Q.i.Vertical,initialFocus:void 0,sections:a})}}_e.displayName="IntegrationConfluenceImportPopup";const Ze=_e,Fe={whiteSpace:"pre-wrap"};function Ae(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:i,currentOption:n}=e,a=null===(t=i.find((e=>{let{key:t}=e;return t===n})))||void 0===t?void 0:t.label,o=(0,de.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,se.jsx)(K.ZP,{popupType:K.Z4.Popup,placementToOrigin:K.pO.Left,renderOrigin:e=>(0,se.jsxs)(Me.Z,{...e,isLarge:!0,style:{opacity:1},disabled:!1,children:[a,(0,ue.i)(o.icon)]}),render:e=>{const t={menuType:A.og.Popup,width:250,left:50},n=[{key:"settings-item-section",render:e=>(0,se.jsx)($.Z,{...e}),items:i.map((t=>{let{key:i,label:n}=t;return{key:i,action:()=>{s(i),e.close()},render:e=>(0,se.jsx)(fe.Z,{...e,title:n,shouldWrapCaption:!0,right:a===n?(0,se.jsx)("div",{style:{width:14},children:(0,ce.e)()}):void 0})}}))}];return(0,se.jsx)(H.Z,{...t,children:(0,se.jsx)(Q.Z,{type:Q.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}async function Re(e){await async function(e){const{environment:t,requestStore:s,userEmail:i,site:n,access_token:a,instance:o,spaceId:r,username:l,password:d,flowId:c}=e;if(!t.currentUser.id)return f.showMessage({message:"Invalid details"}),void b.x();const u=await S.authenticateConfluenceUser(t,{userEmail:i,site:n,access_token:a,instance:o,userId:t.currentUser.id,spaceId:r,username:l,password:d});await s.refresh(),"failed"===u.type?(h.a1y(t,{import_source:"confluence",data:{import_type:"api",status:"failure",error:u.error},flowId:c}),console.error(u.error),f.showError(u)):(h.a1y(t,{import_source:"confluence",data:{import_type:"api",status:"success"},flowId:c}),f.showMessage({message:"Successfully connected confluence instance."}),await M({environment:t,requestStore:s,spaceId:r})),b.x()}(e)}function De(e){let{environment:t,title:s,email:n,accountType:a,site:o,APIToken:r,personalAccessToken:l,confluenceVersion:d,username:c,password:u,hidePopup:m,spaceId:p,flowId:h,requestStore:f}=e;window.__c={n:"ModalContent"};const[y,x]=(0,i.useState)(""),[v,S]=(0,i.useState)("Cloud"),[b,M]=(0,i.useState)(""),[j,w]=(0,i.useState)(""),[C,k]=(0,i.useState)("OAuth2.0"),[T,I]=(0,i.useState)(""),[P,_]=(0,i.useState)(""),Z=(0,de.yK)((e=>({title:{fontWeight:ee.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,se.jsx)(xe.Z,{capture:!0,children:(0,se.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,se.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,se.jsxs)("div",{style:{marginBottom:24},children:[(0,se.jsx)("div",{style:Z.title,children:s}),(0,se.jsx)(je.Z,{title:(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Confluence"}),href:"https://www.notion.so/help/import-from-confluence",analyticsFrom:"import",style:{marginTop:8}})]}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[(0,se.jsx)("label",{htmlFor:"accountType",style:{...Z.inputLabels},children:a}),(0,se.jsx)(Ae,{onSelectOption:S,options:[{key:"Cloud",label:(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud"})},{key:"Server",label:(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownServerOption.label",defaultMessage:"Server/On-Premise"})}],currentOption:v})]}),(0,se.jsx)(ye.Z,{size:12,isHidden:!0}),(0,se.jsx)("div",{children:"Server"===v?(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row",alignItems:"center"},children:[(0,se.jsx)("label",{htmlFor:"confluenceVersion",style:{...Z.inputLabels},children:d}),(0,se.jsx)(Ae,{onSelectOption:k,options:[{key:"OAuth2.0",label:(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownNewVersionOption.label",defaultMessage:"7.9 or later"})},{key:"Basic",label:(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownOlderVersionOption.label",defaultMessage:"Prior to 7.9"})}],currentOption:C})]}),(0,se.jsx)(ye.Z,{size:12,isHidden:!0})]}):void 0}),(0,se.jsx)("label",{htmlFor:"email",style:{...Z.inputLabels},children:n}),(0,se.jsx)(ve.Z,{id:"email",value:y,autoComplete:"off",autoCapitalize:"off",onChange:e=>{x(e.target.value)},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,se.jsx)(ye.Z,{size:12,isHidden:!0}),(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{htmlFor:"site",style:{...Z.inputLabels},children:o}),(0,se.jsx)(ve.Z,{id:"site",value:b,onChange:e=>M(e.target.value),showClearButton:!0,placeholder:"Cloud"===v?"https://confluence.atlassian.net":"https://domain.com",inputElementAttributes:{minLength:4}}),(0,se.jsx)(ye.Z,{size:12,isHidden:!0}),"Cloud"===v?(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{htmlFor:"APIToken",style:{...Z.inputLabels},children:r}),(0,se.jsx)(ve.Z,{id:"AccessToken",type:"password",value:j,onChange:e=>{w(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]}):(0,se.jsx)("div",{children:(0,se.jsx)("div",{children:"Basic"===C?(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{htmlFor:"username",style:{...Z.inputLabels},children:c}),(0,se.jsx)(ve.Z,{id:"username",value:T,onChange:e=>{I(e.target.value)},showClearButton:!0,placeholder:"confluenceUser",inputElementAttributes:{minLength:1}}),(0,se.jsx)(ye.Z,{size:12,isHidden:!0}),(0,se.jsx)("label",{htmlFor:"password",style:{...Z.inputLabels},children:u}),(0,se.jsx)(ve.Z,{type:"password",id:"password",value:P,onChange:e=>{_(e.target.value)},showClearButton:!0,placeholder:"P@S$w0rd",inputElementAttributes:{minLength:1}})]}):(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{htmlFor:"AccessToken",style:{fontSize:"14px",fontWeight:"400"},children:l}),(0,se.jsx)(ve.Z,{id:"AccessToken",type:"password",value:j,onChange:e=>{w(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABCi7h",inputElementAttributes:{minLength:4}})]})})})]})]})]}),(0,se.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,se.jsx)(ye.Z,{size:24}),(0,se.jsx)(he.Z,{isLarge:!0,onClick:async()=>{await Re({environment:t,userEmail:y,site:b,access_token:"Server"===v&&"Basic"===C?void 0:j,instance:v,username:"Basic"===C?T:void 0,password:"Basic"===C?P:void 0,spaceId:p,flowId:h,requestStore:f}),m()},children:(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,se.jsx)(be.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{m()},children:(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const Be=(0,g.injectIntl)((function(e){var t;window.__c={n:"ConfluenceImportOption"};const[s,n]=(0,i.useState)(!1),r=(0,a.VK)((()=>v.getState()),[]),{spaceStore:l,flowId:d}=e,c=[{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi",defaultMessage:"Import via API"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi.message",defaultMessage:"Recommended for the best import experience"}),action:()=>{e.handleApiImportClick("confluence",d),n(!0)}},{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile.message",defaultMessage:"Best for importing partial workspace content"}),action:()=>e.handleFileUploadClick("confluence",d)}],u=(0,N.O7)(),{device:m}=u,{confluenceResult:f,onComplete:y,intl:x,requestStore:S,spaceViewStore:b}=e,{account:w}=f,C={spacesResult:void 0,showLoader:!1},{showLoader:k}=r[l.id]||C;function T(e,t){h.qyQ(u,{import_source:"confluence",data:{spaceKey:e,spaceName:t},flowId:d})}function I(e){return(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{style:{fontSize:"12px",color:"rgba(55, 53, 47, 0.65)",paddingLeft:"12px"},children:(0,se.jsx)(g.FormattedMessage,{id:"confluenceImportOption.search.title",defaultMessage:"Select a space to import"})}),(0,se.jsx)(Ze,{searchInputPlaceholder:x.formatMessage({id:"confluenceImportOption.search.placeholder",defaultMessage:"Search for a Space"}),noSearchResultsPlaceholder:x.formatMessage({id:"confluenceImportOption.search.noResultsPlaceholder",defaultMessage:"No Spaces"}),sections:[e],onComplete:async e=>{await async function(e){const{environment:t,onComplete:s,selectedSpace:i,spaceStore:n,spaceViewStore:a,flowId:o}=e,r=await j.A1({environment:t,spaceStore:n,spaceViewStore:a,space:i,flowId:o||(0,p.ZP)()});s(r)}({environment:u,onComplete:y,selectedSpace:e,spaceStore:l,spaceViewStore:b,flowId:d})},handleClickImportConfluenceWorkspace:T})]})}const P={title:"Confluence",logo:o.Z.images.import.confluencePng,caption:w,actionButton:w&&k?(0,se.jsx)(G.Z,{}):w&&e.renderItemActionsButton([{name:x.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),action:()=>e.handleFileUploadClick("confluence",d)},{name:x.formatMessage({id:"confluenceImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{e.handleApiImportClick("confluence",d),n(!0)}},{name:x.formatMessage({id:"confluenceImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e){const{environment:t,spaceId:s,requestStore:i}=e;v.setState({...v.state,[s]:{...v.state[s],showLoader:!1}}),await pe.DP(t,i,s)}({environment:u,spaceId:l.id,requestStore:S})}]),onClick:()=>{}},_=(null===(t=r[l.id])||void 0===t||null===(t=t.spacesResult)||void 0===t?void 0:t.spaces)||[],Z={key:"default",name:x.formatMessage({id:"confluenceImportOption.spacesProperty.defaultName",defaultMessage:"Spaces"}),items:_.map((e=>({id:e.id,key:e.key,name:e.name})))},F={key:"section",render:e=>(0,se.jsx)($.Z,{...e}),items:c.map((e=>{let{name:t,captionText:s,action:i}=e;return{key:t,render:e=>(0,se.jsx)(W.Z,{...e,title:t,caption:s,captionStyle:s?Fe:void 0}),action:i}}))};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(K.ZP,{popupType:m.isMobile?K.Z4.SlideUp:K.Z4.Popup,onClick:()=>{w&&M({environment:u,requestStore:S,spaceId:l.id}).catch((()=>{}))},buttonPopupStore:ge.Z,render:e=>w?function(e){return k?(0,se.jsx)(se.Fragment,{}):I(e)}(Z):(0,se.jsx)(H.Z,{menuType:A.og.Popup,width:200,children:(0,se.jsx)(Q.Z,{onAccept:e.close,type:Q.i.Vertical,initialFocus:void 0,sections:[F]})}),renderOrigin:e=>{let{onClick:t}=e;return(0,se.jsx)(ae,{...P,onClick:t})}}),(0,se.jsx)(Se.Z,{open:s,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{n(!1)},render:()=>(0,se.jsx)(De,{hidePopup:()=>{n(!1)},environment:u,title:(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.emailMessage",defaultMessage:"Email"}),(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.emailHelpText",defaultMessage:"Email address of the Confluence user importing the data"}),render:e=>(0,se.jsx)(z.Z,{ariaLabel:"Email help text button",disableBackground:!0,icon:me.D,...e})})]}),accountType:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.instanceMessage",defaultMessage:"Confluence instance"}),(0,se.jsx)(J.Z,{style:{width:300,whiteSpace:"normal"},placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.instanceHelperText",defaultMessage:"On Confluence, click 'Help', the (?) next to your profile, then click on 'About Confluence' this will tell you if it is a Server, Cloud or Data Center"}),render:e=>(0,se.jsx)(z.Z,{ariaLabel:"Confluence instance type help text button",disableBackground:!0,icon:me.D,...e})})]}),site:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.siteMessage",defaultMessage:"Site"}),(0,se.jsx)(J.Z,{style:{width:300,whiteSpace:"normal"},placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Confluence. If you are running on a non-standard port, please provide the input in host:port format"}),render:e=>(0,se.jsx)(z.Z,{ariaLabel:"Confluence site help text button",disableBackground:!0,icon:me.D,...e})})]}),APIToken:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceAccessToken.captions",defaultMessage:"Click to learn how to get access token from Confluence cloud"}),render:e=>(0,se.jsx)(z.Z,{ariaLabel:"Confluence access token help text button",onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account","_blank")},icon:me.D,...e})})]}),personalAccessToken:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.personalAccessTokenMessage",defaultMessage:"Personal Access Token"}),(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,style:{width:300,whiteSpace:"normal"},renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluencePAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Confluence server"}),render:e=>(0,se.jsx)(z.Z,{ariaLabel:"Confluence personal access token help text button",onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:me.D,...e})})]}),confluenceVersion:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.confluenceVersion",defaultMessage:"Confluence version"}),(0,se.jsx)(J.Z,{style:{width:300,whiteSpace:"normal"},placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceVersion.captions",defaultMessage:"Click to learn how to know the version of Confluence you are running"}),render:e=>(0,se.jsx)(z.Z,{ariaLabel:"Confluence version help text button",onClick:()=>{window.open("https://confluence.atlassian.com/confkb/how-do-i-know-what-version-of-confluence-is-running-179441565.html","_blank")},icon:me.D,...e})})]}),username:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.username",defaultMessage:"Username"}),(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.usernameHelpText",defaultMessage:"Username of the Confluence user importing the data"}),render:e=>(0,se.jsx)(z.Z,{ariaLabel:"Confluence user's username help text button",disableBackground:!0,icon:me.D,...e})})]}),password:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.password",defaultMessage:"Password"}),(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.passwordHelpText",defaultMessage:"Password of the Confluence user importing the data"}),render:e=>(0,se.jsx)(z.Z,{ariaLabel:"Confluence user's password help text button",disableBackground:!0,icon:me.D,...e})})]}),spaceId:l.id,flowId:d,requestStore:S})})]})}));var Le=s(77137),Ne=s(72126),Oe=s(23867),Ee=s(83805),Ve=s(75018),Ue=s(53833),We=s(90365),Ke=(s(57658),s(60458)),ze=s(28992),qe=s(62385);const Ge=function(e){window.__c={n:"DotSeparator"};const{style:t}=(0,de.yK)((t=>({style:{display:"inline-block",textAlign:"center",color:e.disabled?t.lightTextColor:t.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8}})),[e]);return(0,se.jsx)("div",{style:t,children:"·"})};class He extends n.Z{constructor(){super(...arguments),this.storeTypes={store:ke},this.handleSelectAllClick=()=>{const{sections:e,analyticsName:t}=this.props,{store:s}=this.stores,{selection:i}=s.state;for(const n of e)for(const e of n.items)i.add(e.key);s.emit(),h.VfZ(this.environment,{integration_name:t})},this.handleDeselectAllClick=()=>{const{analyticsName:e}=this.props,{store:t}=this.stores,{selection:s}=t.state;s.clear(),t.emit(),h.FIS(this.environment,{integration_name:e})},this.handleToggleItem=e=>{const{analyticsName:t}=this.props,{store:s}=this.stores,{selection:i}=s.state;i.has(e.key)?(i.delete(e.key),h.Z36(this.environment,{integration_name:t})):(i.add(e.key),h.Glf(this.environment,{integration_name:t})),s.emit()},this.handleImport=()=>{const{sections:e}=this.props,{selection:t}=this.stores.store.state,s=Ne.xH(e.map((e=>e.items))),i=[];t.forEach((e=>{const t=s.find((t=>t.key===e));t&&i.push(t)})),this.props.onComplete(i)}}willMount(e){const t=this.stores.store.state.selection,[s]=e.sections;if(s){const[e]=s.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return(0,se.jsx)(H.Z,{menuType:A.og.Popup,header:this.renderMenuHeader(),footer:this.renderMenuFooter(),width:280,maxHeight:350,children:this.renderMenuList()})}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state,s=Boolean(t);return(0,se.jsxs)($.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:[(0,se.jsx)(Te.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e}),(0,se.jsx)(ze.Z,{isTokenTitle:!0,style:{marginTop:2},title:(0,se.jsxs)("div",{style:{marginLeft:-3},children:[(0,se.jsx)(qe.Z,{onClick:this.handleSelectAllClick,disabled:s,disabledFeedback:!0,children:(0,se.jsx)(g.FormattedMessage,{id:"importPopup.selectAll",defaultMessage:"Select all"})}),(0,se.jsx)(Ge,{disabled:s}),(0,se.jsx)(qe.Z,{onClick:this.handleDeselectAllClick,disabled:s,disabledFeedback:!0,children:(0,se.jsx)(g.FormattedMessage,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})})]})})]})}renderMenuFooter(){const e=0===this.stores.store.state.selection.size;return(0,se.jsx)($.Z,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8},children:(0,se.jsx)(ze.Z,{title:(0,se.jsx)(he.Z,{disabled:e,onClick:this.handleImport,children:(0,se.jsx)(g.FormattedMessage,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"})})})})}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:s}=this.stores,{searchQuery:i,selection:n}=s.state,a=e.map((e=>{const t=(0,we.ZP)(i,e.items,(t=>`${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===a.length)return(0,se.jsx)($.Z,{children:(0,se.jsx)(Ie.Z,{title:t})});const o=a.map((t=>({key:t.name,render:s=>(0,se.jsx)($.Z,{...s,title:e.length>1?t.name:void 0}),items:t.items.map((e=>{const t=()=>this.handleToggleItem(e);return{key:e.key,render:s=>(0,se.jsx)(fe.Z,{...s,title:e.name,icon:(0,se.jsx)(Ke.Z,{checked:n.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&(0,se.jsx)(X.Z,{isSmall:!0,children:e.count})}),action:t}}))})));return(0,se.jsx)(Q.Z,{type:Q.i.Vertical,initialFocus:void 0,sections:o})}}He.displayName="IntegrationImportPopup";const Qe=He;class Ye extends n.Z{constructor(){super(...arguments),this.evernoteStoreState=this.createComputedStore((()=>Ue.Z.getState())),this.handleClickImportEvernote=async()=>{var e;const{isFetchingNotebooks:t}=this.evernoteStoreState.state;t&&await Ee.B({environment:this.environment,requestStore:this.props.requestStore});const s=B.Z.getOrCreateFlowId();h.ays(this.environment,{import_source:"evernote",from:this.props.analyticsFrom,flowId:s,userId:this.environment.currentUser.id,spaceId:null===(e=V.default.state.currentSpaceStore)||void 0===e?void 0:e.id})},this.handleRemoveEvernote=async()=>{await S.disconnectEvernote(this.environment,{}),Ue.Z.setState({notebooksResponse:{notebooks:[]},isFetchingNotebooks:!0,showLoader:!1}),await this.props.requestStore.refresh(),h.qJZ(this.environment,{integration_name:"evernote"})},this.handleEvernoteAuth=async()=>{await Ee.e({environment:this.environment,requestStore:this.props.requestStore})},this.handleImportEvernoteComplete=async(e,t)=>{const{notebooks:s}=e,i=s.filter((e=>Boolean(t.find((t=>t.key===e.guid)))));h.G7t(this.environment,{integration_name:"evernote",count:t.length});const n=await j.am({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore,notebooks:i});h.qyQ(this.environment,{import_source:"evernote",data:{notebooks:i.map((e=>e.guid)),userId:this.environment.currentUser.id,spaceId:(0,Oe.C)(this.props.spaceStore.id)},flowId:B.Z.getOrCreateFlowId()}),this.props.onComplete(n)},this.handleEvernoteHelpClick=()=>{Ve.navigateToExternalURL({environment:this.environment,url:(0,R.UY)("guides.importEvernote")})}}renderComponent(){const{device:e}=this.environment,{evernoteResult:t,intl:s}=this.props,{userInfo:i}=t,{notebooksResponse:n,showLoader:a}=this.evernoteStoreState.state,r=(null==n?void 0:n.notebooks)||[],l=Ne.vM(r,(e=>e.stack||"")),d=Object.keys(l).map((e=>{const t=e||"Top-Level";return{key:t,name:t,items:(l[e]||[]).map((e=>({key:e.guid,name:e.title,count:e.noteCount})))}})),c={title:"Evernote",logo:o.Z.images.import.evernotePng,shouldWrapCaption:!i,caption:i?i.name||i.username||i.email:void 0,actionButton:i&&a?(0,se.jsx)(G.Z,{}):i?this.props.renderItemActionsButton([{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:this.handleEvernoteHelpClick},{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>We.Z.setState({open:!0})},{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleEvernoteAuth},{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveEvernote}]):this.props.defaultActionButton,onClick:()=>{}};return(0,se.jsx)(K.ZP,{popupType:e.isMobile?K.Z4.SlideUp:K.Z4.Popup,buttonPopupStore:We.Z,onClick:this.handleClickImportEvernote,render:()=>a?(0,se.jsx)(se.Fragment,{}):(0,se.jsx)(Qe,{searchInputPlaceholder:s.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebook…"}),noSearchResultsPlaceholder:s.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks"}),analyticsName:"evernote",sections:d,onComplete:e=>this.handleImportEvernoteComplete(n,e)}),renderOrigin:e=>{let{onClick:t}=e;return(0,se.jsx)(ae,{...c,onClick:i?t:this.handleEvernoteAuth})}})}}Ye.displayName="EvernoteImportOption";const $e=(0,g.injectIntl)(Ye);var Je=s(33929);const Xe=(0,g.defineMessages)({JiraAuthorizationError:{id:"jiraImport.unauthorizedAccess",defaultMessage:"Unauthorized Error: API key does not belong to Jira Admin."},JiraAuthenticationSuccess:{id:"jiraImport.successfulAuth",defaultMessage:"Successfully established Jira connection"},JiraAuthenticationInvalidDetails:{id:"jiraImport.invalidDetails",defaultMessage:"Invalid Details"}});function et(e){let{environment:t,title:s,email:n,site:a,APIToken:o,hidePopup:r,handleAuthentication:l}=e;window.__c={n:"ModalContent"};const[d,c]=(0,i.useState)(""),[u,m]=(0,i.useState)(""),[p,h]=(0,i.useState)(""),f=(0,de.yK)((e=>({title:{fontWeight:ee.Z.fontWeight.semibold},inputLabels:{fontSize:ee.Z.fontSize.UIRegular.desktop,fontWeight:ee.Z.fontWeight.regular},helpText:{textAlign:"center",marginTop:"5px",lineHeight:ee.Z.lineHeight.UISmall.desktop,fontSize:ee.Z.fontSize.UISmall.desktop,color:e.lightTextColor}})),[]);return(0,se.jsx)(xe.Z,{capture:!0,children:(0,se.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,se.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,se.jsx)("div",{style:{marginBottom:24},children:(0,se.jsx)("div",{style:f.title,children:s})}),(0,se.jsxs)("div",{children:[(0,se.jsx)(ye.Z,{size:12,isHidden:!0}),(0,se.jsx)("label",{htmlFor:"email",style:{...f.inputLabels},children:n}),(0,se.jsx)(ve.Z,{id:"email",value:d,autoComplete:"off",autoCapitalize:"off",onChange:e=>{c(e.target.value)},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,se.jsx)(ye.Z,{size:12,isHidden:!0}),(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{htmlFor:"site",style:{...f.inputLabels},children:a}),(0,se.jsx)(ve.Z,{id:"site",value:u,onChange:e=>m(e.target.value),showClearButton:!0,placeholder:"https://jira.atlassian.net",inputElementAttributes:{minLength:4}}),(0,se.jsx)(ye.Z,{size:12,isHidden:!0}),(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{htmlFor:"APIToken",style:{...f.inputLabels},children:o}),(0,se.jsx)(ve.Z,{id:"AccessToken",type:"password",value:p,onChange:e=>{h(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]})]})]})]}),(0,se.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,se.jsx)(ye.Z,{size:24}),(0,se.jsx)(he.Z,{isLarge:!0,onClick:()=>{l({email:d,site:u,apiToken:p}),r()},children:(0,se.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,se.jsx)(be.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{r()},children:(0,se.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const tt=function(e){const{showPopup:t,hidePopup:s,environment:i,handleAuthentication:n}=e;return(0,se.jsx)(Se.Z,{open:t,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:s,render:()=>(0,se.jsx)(et,{hidePopup:s,environment:i,title:(0,se.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.emailMessage",defaultMessage:"Email"}),(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.emailHelpText",defaultMessage:"Email address of the Atlassian user importing the data"}),render:e=>(0,se.jsx)(z.Z,{...e,ariaLabel:"Email help text button",disableBackground:!0,icon:me.D})})]}),site:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.siteMessage",defaultMessage:"Site"}),(0,se.jsx)(J.Z,{style:{width:300,whiteSpace:"normal"},placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Atlassian app. If you are running on a non-standard port, please provide the input in host:port format"}),render:e=>(0,se.jsx)(z.Z,{...e,ariaLabel:"Atlassian API token site help text button",disableBackground:!0,icon:me.D})})]}),APIToken:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.stepsToGetAPIToken.captions",defaultMessage:"Click to learn how to get access token from Atlassian account"}),render:e=>(0,se.jsx)(z.Z,{...e,ariaLabel:"Atlassian access token help text button",onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account/#Create-an-API-token","_blank")},icon:me.D})})]}),handleAuthentication:e=>n(e)})})};const st=function(e){window.__c={n:"JiraImportOption"};const{requestStore:t,spaceStore:s,flowId:n}=e,a=(0,N.O7)(),{device:r}=a,[l,d]=(0,i.useState)(!1),c={title:"Jira",logo:o.Z.images.externalIntegrations.jiraIconPng,onClick:()=>{}},u=async e=>{await async function(e){const{environment:t,userEmail:s,site:i,apiToken:n,spaceId:a,flowId:o}=e;if(!t.currentUser.id)return f.showMessage({message:Je.default.formatMessage(Xe.JiraAuthenticationInvalidDetails)}),void b.x();const r=await S.authenticateJiraUser(t,{userEmail:s,site:i,apiKey:n,userId:t.currentUser.id,spaceId:a});var l;"failed"===r.type?(h.a1y(t,{import_source:"jira",data:{import_type:"api",status:"failure",error:r.error},flowId:o}),console.error(r.error),f.showError(r)):null!=r&&null!==(l=r.data)&&void 0!==l&&l.isAdmin?(h.a1y(t,{import_source:"jira",data:{import_type:"api",status:"success"},flowId:o}),f.showMessage({message:Je.default.formatMessage(Xe.JiraAuthenticationSuccess)})):(h.a1y(t,{import_source:"jira",data:{import_type:"api",status:"failure"},flowId:o}),f.showErrorMessage(Je.default.formatMessage(Xe.JiraAuthorizationError))),b.x()}({environment:a,requestStore:t,userEmail:e.email,site:e.site,apiToken:e.apiToken,spaceId:s.id,flowId:n})};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(K.ZP,{renderOrigin:e=>{let{onClick:t}=e;return(0,se.jsx)(ae,{...c,onClick:()=>d(!0)})},popupType:r.isMobile?K.Z4.SlideUp:K.Z4.Popup,render:()=>(0,se.jsx)(se.Fragment,{})}),(0,se.jsx)(tt,{showPopup:l,hidePopup:()=>d(!1),environment:a,handleAuthentication:async e=>await u(e)})]})};var it=s(61397);const nt={whiteSpace:"pre-wrap"};const at=e=>{window.__c={n:"MondayPopup"};const t=(0,a.VK)((()=>I.Z.state),[]),{environment:s,spaceStore:i}=e;return(0,se.jsx)(se.Fragment,{children:(0,se.jsx)(Se.Z,{open:t.showAuthPopup,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{I.Z.setState({...I.Z.state,showAuthPopup:!1})},render:()=>(0,se.jsx)(ot,{hidePopup:()=>{I.Z.setState({...I.Z.state,showAuthPopup:!1})},environment:s,title:(0,se.jsx)(g.FormattedMessage,{id:"mondayAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"mondayAuthentication.emailMessage",defaultMessage:"Email"}),(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"mondayAuthentication.emailHelpText",defaultMessage:"Email address of the Monday.com user importing the data"}),render:e=>(0,se.jsx)(z.Z,{...e,ariaLabel:"Email help text button",disableBackground:!0,icon:me.D})})]}),APIToken:(0,se.jsxs)(Pe.gq,{style:{alignItems:"center",gap:2},children:[(0,se.jsx)(g.FormattedMessage,{id:"mondayAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,se.jsx)(J.Z,{placement:J.Z.Placement.Right,renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"mondayAuthentication.stepsToGetMondayAPIToken.captions",defaultMessage:"Click to learn how to get API token from Monday.com"}),render:e=>(0,se.jsx)(z.Z,{...e,ariaLabel:"Monday.com API token help text button",onClick:()=>{window.open("https://developer.monday.com/api-reference/docs/authentication#accessing-api-tokens","_blank")},icon:me.D})})]}),flowId:"",spaceStore:i})})})};function ot(e){let{environment:t,title:s,email:i,APIToken:n,hidePopup:o,flowId:r,spaceStore:l}=e;window.__c={n:"ModalContent"};const d=(0,a.VK)((()=>I.Z.state),[]),c=(0,de.yK)((e=>({title:{fontWeight:ee.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,se.jsx)(xe.Z,{capture:!0,children:(0,se.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,se.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,se.jsxs)("div",{style:{marginBottom:24},children:[(0,se.jsx)("div",{style:c.title,children:s}),(0,se.jsx)(je.Z,{title:(0,se.jsx)(g.FormattedMessage,{id:"mondayAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Monday.com"}),href:"",analyticsFrom:"import",style:{marginTop:8}})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{htmlFor:"email",style:{...c.inputLabels},children:i}),(0,se.jsx)(ve.Z,{id:"email",value:d.email,autoComplete:"off",autoCapitalize:"off",onChange:e=>{I.Z.setState({...I.Z.state,email:e.target.value})},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,se.jsx)(ye.Z,{size:12,isHidden:!0}),(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{htmlFor:"APIToken",style:{...c.inputLabels},children:n}),(0,se.jsx)(ve.Z,{id:"AccessToken",type:"password",value:d.APIToken,onChange:e=>{I.Z.setState({...I.Z.state,APIToken:e.target.value})},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]})]})]}),(0,se.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,se.jsx)(ye.Z,{size:24}),(0,se.jsx)(he.Z,{isLarge:!0,onClick:async()=>{await it.qF({environment:t,userEmail:d.email,APIToken:d.APIToken,flowId:r,spaceId:l.id}),o()},children:(0,se.jsx)(g.FormattedMessage,{id:"mondayAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,se.jsx)(be.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{o()},children:(0,se.jsx)(g.FormattedMessage,{id:"mondayAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const rt=function(e){window.__c={n:"MondayImportOption"};const t=(0,a.VK)((()=>I.Z.state),[]),s=(0,a.VK)((()=>B.Z.state),[]),{account:i,isLoadingMondayWorkspaces:n}=t,{spaceStore:l}=e,d=(0,N.O7)(),c=(0,g.useIntl)(),{device:u}=d,m=s.flowId||(0,p.ZP)();s.flowId||B.Z.setState({flowId:m});const f={title:c.formatMessage({id:"mondayImportOption.mondayButton.title",defaultMessage:"Monday.com"}),logo:o.Z.images.import.mondayPng,caption:i,actionButton:i?(y=[{name:c.formatMessage({id:"mondayImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>{I.Z.setState({...I.Z.state,showAuthPopup:!0})}},{name:c.formatMessage({id:"mondayImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>it.sC({environment:d,spaceId:l.id})}],(0,se.jsx)(K.ZP,{popupType:Y.kQ.Popup,renderOrigin:e=>n?(0,se.jsx)(G.Z,{}):(0,se.jsx)(z.Z,{ariaLabel:c.formatMessage({id:"mondayImportOption.mondayButton.ariaLabel",defaultMessage:"Import from Monday.com button"}),icon:r.o,...e}),render:e=>{const t={key:"section",render:e=>(0,se.jsx)($.Z,{...e}),items:y.map((t=>{let{name:s,captionText:i,action:n}=t;return{key:s,render:e=>(0,se.jsx)(W.Z,{...e,title:s,caption:i,captionStyle:i?nt:void 0}),action:()=>{n(),e.close()}}}))};return(0,se.jsx)(H.Z,{menuType:A.og.Popup,width:200,children:(0,se.jsx)(Q.Z,{type:Q.i.Vertical,initialFocus:void 0,sections:[t]})})}})):void 0,onClick:()=>{}};var y;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(K.ZP,{onClick:async()=>{I.Z.resetImport(),i?(h.ays(d,{import_source:"monday.com",from:"settings_modal",userId:d.currentUser.id,spaceId:l.id,flowId:m}),await it.FM({environment:d,spaceId:l.id}),it.h7()):I.Z.setState({...I.Z.state,showAuthPopup:!0})},popupType:u.isMobile?K.Z4.SlideUp:K.Z4.Popup,buttonPopupStore:U,renderOrigin:e=>{let{onClick:t}=e;return(0,se.jsx)(ae,{...f,onClick:t})},render:()=>null}),(0,se.jsx)(at,{environment:d,spaceStore:l})]})};var lt=s(52192),dt=s(82066),ct=s(81676);class ut extends n.Z{constructor(){super(...arguments),this.trelloStoreState=this.createComputedStore((()=>ct.Z.getState())),this.handleClickImportTrello=async()=>{this.trelloStoreState.state.isFetchingBoards&&await lt.u(this.environment,this.props.requestStore),h.ays(this.environment,{import_source:"trello",from:this.props.analyticsFrom})},this.handleTrelloAuth=async()=>{await lt.M({environment:this.environment,requestStore:this.props.requestStore})},this.handleRemoveTrello=async()=>{await S.disconnectTrello(this.environment,{}),ct.Z.setState({boardsResponse:{boards:[]},isFetchingBoards:!0,showLoader:!1}),await this.props.requestStore.refresh(),h.qJZ(this.environment,{integration_name:"trello"})},this.handleImportTrelloComplete=async(e,t)=>{const{boards:s}=e,i=s.filter((e=>Boolean(t.find((t=>t.key===e.id)))));h.G7t(this.environment,{integration_name:"trello",count:t.length});const n=await j.su({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,boards:i});this.props.onComplete(n)}}renderComponent(){const{device:e}=this.environment,{trelloResult:t,intl:s}=this.props,{account:i}=t,{boardsResponse:n,showLoader:a}=this.trelloStoreState.state,r=n.boards,l={key:"default",name:s.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:r.map((e=>({key:e.id,name:e.name})))},d={title:"Trello",logo:o.Z.images.import.trelloPng,actionButton:i&&a?(0,se.jsx)(G.Z,{}):i&&this.props.renderItemActionsButton([{name:s.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>dt.Z.setState({open:!0})},{name:s.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleTrelloAuth},{name:s.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveTrello}]),onClick:()=>{}};return(0,se.jsx)(K.ZP,{popupType:e.isMobile?K.Z4.SlideUp:K.Z4.Popup,buttonPopupStore:dt.Z,onClick:this.handleClickImportTrello,render:()=>a?(0,se.jsx)(se.Fragment,{}):(0,se.jsx)(Qe,{searchInputPlaceholder:s.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a board…"}),noSearchResultsPlaceholder:s.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards found."}),analyticsName:"trello",sections:[l],onComplete:e=>this.handleImportTrelloComplete(n,e)}),renderOrigin:e=>{let{onClick:t}=e;return(0,se.jsx)(ae,{...d,onClick:i?t:this.handleTrelloAuth})}})}}ut.displayName="TrelloImportOption";const mt=(0,g.injectIntl)(ut);class pt extends n.Z{constructor(){super(...arguments),this.storeTypes={trelloRequestStore:L.Z,asanaRequestStore:L.Z,evernoteRequestStore:L.Z,confluenceRequestStore:L.Z,mondayRequestStore:L.Z,jiraRequestStore:L.Z},this.handleFileUploadClick=async(e,t)=>{h.ays(this.environment,{import_source:e,from:this.props.analyticsFrom,import_type:"file",flowId:t});const s=await j.ro({environment:this.environment,pageStore:this.props.pageStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,uploadType:e,flowId:t});s&&(h.W2j(this.environment,{from:"import",type:"page",new_page_id:s.id}),this.props.onComplete(s))},this.handleApiImportClick=(e,t)=>{M({environment:this.environment,requestStore:this.props.confluenceRequestStore,spaceId:this.props.spaceStore.id}).catch((()=>{})),h.ays(this.environment,{import_source:e,from:this.props.analyticsFrom,import_type:"api",flowId:t})},this.getAnalyticsFlowId=()=>B.Z.state.flowId||(0,p.ZP)()}renderComponent(){if(!D.Z.state.online)return(0,se.jsx)("div",{style:{...pt.wrapStyle,fontSize:14,color:this.theme.mediumTextColor},children:(0,se.jsx)(g.FormattedMessage,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."})});const{analyticsFrom:e}=this.props;return this.renderRequests((t=>t?(0,se.jsx)("div",{style:pt.wrapStyle,children:this.renderOptions(t)}):(0,se.jsx)("div",{style:"onboarding"===e?{}:pt.wrapStyle,children:(0,se.jsx)(G.Z,{})})))}renderOptions(e){const t=this.getAnalyticsFlowId();return(0,se.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[(0,se.jsx)(ht,{asanaResult:e.asanaResult}),(0,C.Tc)(this.environment)?this.renderConfluenceImportViaAPIOption(e.confluenceResult,t):this.renderConfluenceImportViaFileOption(t),(0,se.jsx)(ae,{title:"Google Docs",logo:o.Z.images.import.googleDocsPng,actionButton:(0,se.jsx)(ft,{url:(0,R.UY)("guides.importGoogleDocs")}),onClick:()=>this.handleFileUploadClick("gdocs")}),this.renderCsvImportWithTooltip(),(0,se.jsx)(ae,{title:(0,se.jsx)(g.FormattedMessage,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown"}),icon:m.S,onClick:()=>this.handleFileUploadClick("markdown")}),(0,se.jsx)(ae,{title:"HTML",icon:u.S,onClick:()=>this.handleFileUploadClick("html")}),(0,se.jsx)(ae,{title:"Word",logo:o.Z.images.import.wordPng,onClick:()=>this.handleFileUploadClick("docx")}),(0,se.jsx)(ae,{title:"Dropbox Paper",logo:o.Z.images.import.dropboxPaperPng,actionButton:(0,se.jsx)(ft,{url:(0,R.UY)("guides.importDropboxPaper")}),onClick:()=>this.handleFileUploadClick("dropbox")}),this.renderTrelloImportOption(e.trelloResult),this.renderEvernoteImportOption(e.evernoteResult),"on"===F.default.getEligibleGroup({experimentId:"monday_importer",defaultGroup:"control"})&&(0,se.jsx)(rt,{spaceStore:this.props.spaceStore}),(0,se.jsx)(ae,{title:"Quip",logo:o.Z.images.import.quipPng,actionButton:(0,se.jsx)(ft,{url:(0,R.UY)("guides.importQuip")}),onClick:()=>this.handleFileUploadClick("quip")}),(0,se.jsx)(ae,{title:"Workflowy",logo:o.Z.images.import.workflowyPng,actionButton:(0,se.jsx)(ft,{url:(0,R.UY)("guides.importWorkflowy")}),onClick:()=>this.handleFileUploadClick("workflowy")}),(0,k.t)()&&(0,se.jsx)(ae,{title:(0,se.jsx)(g.FormattedMessage,{id:"importOptions.genericImporter.title",defaultMessage:"Universal import"}),icon:d.l,onClick:()=>this.handleFileUploadClick("genericImporter",t),actionButton:(0,se.jsx)(ft,{url:"",helpButtonMessage:(0,se.jsx)(g.FormattedMessage,{id:"importOptions.universalImport.tooltip",defaultMessage:"Import any ZIP file that contains text, Markdown, CSV, HTML, and other files"}),helpMessageWidth:240,disableBackground:!0})}),"on"===F.default.getEligibleGroup({experimentId:"jira_import_and_sync",defaultGroup:"control"})&&this.renderJiraImportOption(t)]})}renderRequests(e){return(0,se.jsx)(Le.Z,{request:this.environment,performRequest:P,requestStore:this.stores.trelloRequestStore,render:(t,s)=>(0,se.jsx)(Le.Z,{request:this.environment,performRequest:_,requestStore:this.stores.asanaRequestStore,render:(t,i)=>(0,se.jsx)(Le.Z,{request:this.environment,performRequest:Z,requestStore:this.stores.evernoteRequestStore,render:(t,n)=>(0,se.jsx)(Le.Z,{request:this.environment,performRequest:()=>async function(e,t){const s=await S.getConfluenceAccount(e,{spaceId:t});return"success"===s.type?s.data:(console.error(s.error),{})}(this.environment,this.props.spaceStore.id),requestStore:this.stores.confluenceRequestStore,render:(t,a)=>(0,se.jsx)(Le.Z,{request:this.environment,performRequest:()=>async function(e,t){I.Z.setState({...I.Z.state,isFetchingMondayAccount:!0});const s=await S.getMondayUser(e,{spaceId:t});var i,n;return"success"===s.type?null!==(i=s.data.user)&&void 0!==i&&i.email?(I.Z.setState({...I.Z.state,isFetchingMondayAccount:!1,account:null===(n=s.data.user)||void 0===n?void 0:n.email}),s.data):{user:void 0}:(I.Z.setState({...I.Z.state,isFetchingMondayAccount:!1}),console.error(s.error),{user:void 0})}(this.environment,this.props.spaceStore.id),requestStore:this.stores.mondayRequestStore,render:(t,o)=>e(s&&i&&n&&a&&o?{trelloResult:s,asanaResult:i,evernoteResult:n,confluenceResult:a,mondayResult:o}:void 0)})})})})})}renderTrelloImportOption(e){return(0,se.jsx)(mt,{trelloResult:e,analyticsFrom:this.props.analyticsFrom,renderItemActionsButton:e=>(0,se.jsx)(yt,{actions:e}),onComplete:this.props.onComplete,requestStore:this.stores.trelloRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderConfluenceImportViaAPIOption(e,t){const{analyticsFrom:s,onComplete:i,spaceStore:n,spaceViewStore:a,userSettingsStore:o}=this.props;return(0,se.jsx)(Be,{confluenceResult:e,analyticsFrom:s,flowId:t,renderItemActionsButton:e=>(0,se.jsx)(yt,{actions:e}),onComplete:i,spaceStore:n,requestStore:this.stores.confluenceRequestStore,spaceViewStore:a,userSettingsStore:o,handleFileUploadClick:this.handleFileUploadClick,handleApiImportClick:this.handleApiImportClick})}renderJiraImportOption(e){const{spaceStore:t}=this.props;return(0,se.jsx)(st,{flowId:e,spaceStore:t,requestStore:this.stores.jiraRequestStore})}renderConfluenceImportViaFileOption(e){return(0,se.jsx)(ae,{title:"Confluence",logo:o.Z.images.import.confluencePng,onClick:()=>this.handleFileUploadClick("confluence",e),actionButton:(0,se.jsx)(ft,{url:(0,R.UY)("guides.importConfluence")})})}renderEvernoteImportOption(e){return(0,se.jsx)($e,{evernoteResult:e,analyticsFrom:"onboarding",renderItemActionsButton:e=>(0,se.jsx)(yt,{actions:e}),defaultActionButton:(0,se.jsx)(ft,{url:(0,R.UY)("guides.importEvernote")}),onComplete:this.props.onComplete,requestStore:this.stores.evernoteRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderCsvImportWithTooltip(){return(0,se.jsx)(J.Z,{placement:J.Z.Placement.Bottom,render:e=>(0,se.jsx)(ae,{tooltipEvents:e,title:"CSV",icon:c.Y,onClick:()=>this.handleFileUploadClick("csv")}),renderTooltip:()=>(0,se.jsx)(g.FormattedMessage,{id:"importOptions.csvImport.tooltip",defaultMessage:"Ensure first row in the CSV is the header"})})}}pt.displayName="ImportOptions",pt.wrapStyle={display:"flex",alignItems:"center",justifyContent:"center",width:752,minHeight:240},pt.optionsColumnStyle={width:240};const gt=pt;function ht(e){let{asanaResult:t}=e;window.__c={n:"AsanaImportOption"};return(0,a.VK)((()=>(0,w.c)()),[])?(0,se.jsx)(le,{}):null}function ft(e){let{url:t,helpButtonMessage:s,helpMessageWidth:i,disableBackground:n}=e;return(0,se.jsx)(J.Z,{renderTooltip:()=>s??(0,se.jsx)(g.FormattedMessage,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),style:{width:i??170},textWrap:!0,render:e=>(0,se.jsx)(q.Z,{external:!0,href:t,style:{marginLeft:"auto"},...e,children:(0,se.jsx)(z.Z,{icon:l.m,disableBackground:n??!1})})})}function yt(e){let{actions:t}=e;return(0,se.jsx)(K.ZP,{popupType:Y.kQ.Popup,renderOrigin:e=>(0,se.jsx)(z.Z,{icon:r.o,...e}),render:e=>{const s={key:"section",render:e=>(0,se.jsx)($.Z,{...e}),items:t.map((t=>{let{name:s,action:i}=t;return{key:s,render:e=>(0,se.jsx)(fe.Z,{...e,title:s}),action:()=>{i(),e.close()}}}))};return(0,se.jsx)(H.Z,{menuType:A.og.Popup,width:200,children:(0,se.jsx)(Q.Z,{type:Q.i.Vertical,initialFocus:void 0,sections:[s]})})}})}},15474:(e,t,s)=>{s.r(t),s.d(t,{IntegrationGalleryModal:()=>_});s(57658);var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(58573),l=s(2585),d=s(5257),c=s(35840),u=s(74181),m=s(72126),p=s(31412),g=s(42631),h=s(61202),f=s(80444),y=s(30874),x=s(49900),v=s(35878),S=s(42922),b=s(52275),M=s(73063),j=s(74194),w=s(3386),C=s(32163),k=s(50506),T=s(74136),I=s(72495),P=s(85893);function _(){window.__c={n:"IntegrationGalleryModal"};const e=(0,a.VK)((()=>x.d.state.open),[]),t=(0,n.Fy)(),s=(0,o.yK)((e=>({modal:{width:t.isMobile?"auto":"90vw",height:t.isMobile?"auto":"90vh",borderRadius:8}})),[t.isMobile]);return(0,P.jsx)(k.Z,{open:e,innerStyle:s.modal,onDismiss:()=>{x.d.setState({open:!1})},render:()=>(0,P.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:[(0,P.jsx)(A,{}),(0,P.jsx)(Z,{})]})})}function Z(){window.__c={n:"GalleryModalDetail"};const e=(0,n.O7)(),t=(0,o.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor,padding:20},text:{color:e.darkTextColor}})),[]),s=(0,a.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return null==e?void 0:e.id}),[]),i=(0,a.VK)((()=>{if(x.d.state.open)return x.d.state.selectedIntegration}),[]),r=(0,a.VK)((()=>i?y.Z.externalAuthentications.state.filter((e=>e.integration_id===i.id)):[]),[i]);if(!i||!s)return null;const l=i.info.icon,d=i.name,c=i.info.developer_name,m=i.info.description,b=[];(0,u.mo)(i)&&b.push("linkPreview"),(0,u.zc)(i)&&b.push("databaseSync");const M=i.info.screenshots,j=M?(0,P.jsx)(F,{imageUrls:M},i.id):null;return(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)("div",{style:t.container,children:[j,(0,P.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",paddingBottom:20},children:[(0,P.jsxs)("div",{style:{display:"flex"},children:[(0,P.jsx)("img",{src:l,style:{width:50,marginRight:10}}),(0,P.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,P.jsx)("span",{children:(0,P.jsx)("b",{style:{fontSize:18},children:d})}),(0,P.jsx)("span",{style:t.text,children:(0,P.jsx)(p.FormattedMessage,{id:"integrationGalleryModalDetail.madeBy.name",defaultMessage:"By {name}",values:{name:c}})})]})]}),(0,P.jsx)(S.Z,{style:{width:120},onClick:()=>(async t=>{await g.hM({environment:e,integration:t,spaceId:s,from:"integration_gallery"}),h.pJ({environment:e})})(i),children:r.length>0?(0,P.jsx)(p.FormattedMessage,{id:"integrationGalleryModalDetail.button.installAnother",defaultMessage:"Install another"}):(0,P.jsx)(p.FormattedMessage,{id:"integrationGalleryModalDetail.button.install",defaultMessage:"Install"})})]}),(0,P.jsx)("span",{style:{...t.text,fontSize:14},children:m}),(0,P.jsx)("div",{style:{display:"flex",marginTop:10},children:b.map(((e,t)=>e&&(0,P.jsx)(T.Z,{desktopStyle:{marginLeft:4},innerStyle:{fontSize:12},children:v.a_[e]},t)))})]})})}function F(e){window.__c={n:"ImageCarousel"};const{imageUrls:t}=e,[s,n]=(0,i.useState)(0),a=(0,o.yK)((e=>({heroImg:{width:"100%",objectFit:"contain",objectPosition:"top",paddingBottom:30},arrows:{fill:"#000"}})),[]),r=e=>{let i="right"===e?s+1:s-1;i<0&&(i=t.length-1),i>t.length-1&&(i=0),n(i)},c=t.length>0;return(0,P.jsxs)("div",{style:{width:"100%",position:"relative"},children:[c&&(0,P.jsx)(M.Z,{style:{position:"absolute",top:"50%",left:10},iconStyle:a.arrows,icon:l.f,onClick:()=>r("left")}),(0,P.jsx)("img",{style:a.heroImg,src:t[s]}),c&&(0,P.jsx)(M.Z,{style:{position:"absolute",top:"50%",right:10},iconStyle:a.arrows,icon:d.o,onClick:()=>r("right")})]})}function A(){window.__c={n:"GalleryModalSidebar"};const e=(0,p.useIntl)(),t=(0,o.yK)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500}})),[]),[s,n]=(0,i.useState)(""),l=(0,a.VK)((()=>y.Z.integrations.state),[]),d=(0,a.VK)((()=>m.vM(y.Z.externalAuthentications.state,(e=>e.integration_id))),[]),u=(0,a.VK)((()=>{if(x.d.state.open)return x.d.state.selectedIntegration}),[]),g=(0,r.ZP)(s,l,(e=>e.name)),h=g.filter((e=>{var t;return null===(t=d[e.id])||void 0===t?void 0:t.length})),f=g.filter((e=>{var t;return!(null!==(t=d[e.id])&&void 0!==t&&t.length)})),v=[{key:"installed",render:e=>(0,P.jsx)(I.Z,{...e,title:"Installed"}),items:h.map((e=>({key:e.id,action:()=>{x.d.state.open&&x.d.setState({...x.d.state,selectedIntegration:e})},render:s=>(0,P.jsx)(b.Z,{...s,title:e.name,icon:(0,P.jsx)("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==u?void 0:u.id)?t.selectedItem:void 0}})})))},{key:"not_installed",render:e=>(0,P.jsx)(I.Z,{...e,title:"Not Installed"}),items:f.map((e=>({key:e.id,action:()=>{x.d.state.open&&x.d.setState({...x.d.state,selectedIntegration:e})},render:s=>(0,P.jsx)(b.Z,{...s,title:e.name,icon:(0,P.jsx)("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==u?void 0:u.id)?t.selectedItem:void 0}})})))}];return(0,P.jsxs)("div",{style:t.sidebar,children:[(0,P.jsx)("div",{style:t.header,children:(0,P.jsx)(w.Z,{capture:!0,onBackspace:m.yR,onLeft:m.yR,onRight:m.yR,onSelectAll:m.yR,onRedo:m.yR,onUndo:m.yR,onCut:m.yR,onCopy:m.yR,onPaste:m.yR,onKeypress:m.yR,onDelete:m.yR,onTab:m.yR,children:(0,P.jsx)(j.Z,{placeholder:e.formatMessage({id:"integrationGallery.sidebar.searchbar.placeholder",defaultMessage:"Search integrations"}),left:(0,c.R)(t.searchIcon),showClearButton:!0,format:j.Z.Format.Small,value:s,style:t.searchBar,onChange:e=>{n(e.target.value)}})})}),(0,P.jsx)(C.Z,{type:C.i.Vertical,initialFocus:0,sections:v})]})}},74661:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(66673),l=s(88145),d=s(64275),c=s(99405),u=s(89101),m=s(82990),p=s(31412),g=s(50906),h=s(54642),f=s(75018),y=s(21969),x=s(4023),v=s(45946),S=s(42922),b=s(60458),M=s(73063),j=s(16354),w=s(53437),C=s(62385),k=s(64369),T=s(85893);function I(){window.__c={n:"OpenInDesktopAppPopup"};const e=(0,n.O7)(),t=(0,p.useIntl)(),[s,I]=(0,i.useState)(!0),{isDesktopBrowser:P,os:_}=(0,n.Fy)(),Z=(0,a.VK)((()=>e.RouterStore.state.route.name in c.c$),[e]),F=e.currentUser.isLoggedIn(),A=(0,a.VK)((()=>v.Z.state),[]),[R,D]=(0,i.useState)(!1),B=!R&&F&&void 0===A&&P&&("mac"===_||"windows"===_)&&Z&&v.Z.canPersistToLocalStorage(),[L,N]=(0,i.useState)(!1),O=B&&L,E=(0,i.useRef)(!1);(0,i.useEffect)((()=>{B&&!E.current&&(async function(e,t){const s=await h.getDesktopAppRegistration(e,{os:t});return"data"in s&&s.data.isRegistered}(e,_).then((e=>{N(e)})),E.current=!0)}),[B,N,e,_]);const V=(0,r.D9)(O);(0,i.useEffect)((()=>{O&&!V&&g.wWx(e)}),[O,V,e]);const U=(0,o.yK)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",width:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:m.Z.fontWeight.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34}})),[]);return(0,T.jsx)(w.ZP,{popupType:w.kQ.Popup,placementToOrigin:x.u.Bottom,origin:(0,T.jsx)("div",{style:U.origin}),disableMouseCapture:!0,open:O,style:U.container,render:()=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{style:U.header,children:[(0,T.jsx)(k.Z,{style:U.headerText,children:(0,T.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,T.jsx)(M.Z,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:d.D,onClick:()=>{v.Z.setState("never"),D(!0),g.ZyU(e)}})]}),(0,T.jsx)(j.Z,{href:u.AR.desktop,external:!0,onClick:()=>{g.iDe(e)},children:(0,T.jsxs)(C.Z,{style:U.appDownloadButton,children:[(0,l.E)(U.appDownloadIcon),(0,T.jsx)("span",{children:(0,T.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,T.jsxs)("div",{style:U.actions,children:[(0,T.jsxs)("div",{style:U.alwaysOpenLinks,children:[(0,T.jsx)(b.Z,{checked:s,size:16,onClick:()=>{I(!s)}}),(0,T.jsx)(k.Z,{isInline:!0,style:U.alwaysOpenLinksLabel,children:(0,T.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,T.jsx)("strong",{children:e})}})})]}),(0,T.jsx)(S.Z,{style:U.alwaysOpenLinksButton,onClick:()=>{v.Z.setState(s?"always":"never"),D(!0),f.openInNativeApp({url:(0,y.W)(window.location.href),environment:e}),g.LC7(e,{always_open_in_app:s})},children:(0,T.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,T.jsx)("strong",{children:e})}})})]})]})})}},74169:(e,t,s)=>{s.d(t,{Z:()=>R});var i=s(67294),n=s(83355),a=s(72126),o=s(31412),r=s(47307),l=s(96802),d=s(27153),c=s(39699),u=s(53471),m=s(33929),p=s(94841),g=s(49085);const h="loadingLocalImage",f="uploading",y="loaded";class x extends g.default{getInitialState(){return{loadingMode:y}}}const v=x;var S=s(31792),b=s(87636),M=s(23063),j=s(64921),w=s(12981),C=s(65107),k=s(68785),T=s(32854),I=s(81865),P=s(97496),_=s(56282),Z=s(85893);const F=(0,o.defineMessages)({embedPlaceholder:{defaultMessage:"Paste an image link…",id:"pageCover.embedType.placeholder"}});class A extends n.Z{constructor(){super(...arguments),this.lastProxiedUrl=void 0,this.storeTypes={imageUploadStore:v,mouseStore:S.Z},this.handleLoadComplete=()=>{this.stores.imageUploadStore.reset()},this.renderControl=e=>{let{isVisible:t,isRepositioning:s,handleCancelClick:i,handleRepositionClick:n,handleSavePositionClick:a}=e;if(this.props.disabled||this.stores.imageUploadStore.state.loadingMode!==y)return;const{device:r}=this.environment,{isMobile:l}=r,d=(0,p.WE)(this.props.store);return(0,Z.jsx)(M.Z,{isVisible:!0,animationStyle:{width:D(this.props.store),opacity:t?1:0},render:()=>(0,Z.jsx)("div",{style:{position:d?"absolute":"relative",pointerEvents:t?"auto":"none",maxWidth:"100%",top:d?48:void 0},children:(0,Z.jsxs)(b.Z,{isVisible:t,position:"bottom",style:{marginRight:this.props.paddingRight,marginLeft:this.props.paddingLeft},children:[!s&&(0,Z.jsx)(j.Z,{style:{...P.Z.actionButtonStyle,...l&&{borderRight:"none"}},onClick:this.handleChangeCoverClick,children:(0,Z.jsx)(o.FormattedMessage,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!s&&!l&&(0,Z.jsx)(j.Z,{style:{...P.Z.actionButtonStyle,borderRight:"none"},onClick:e=>n(e,this.lastProxiedUrl),children:(0,Z.jsx)(o.FormattedMessage,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),s&&!l&&(0,Z.jsx)(j.Z,{style:P.Z.actionButtonStyle,onClick:a,children:(0,Z.jsx)(o.FormattedMessage,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),s&&!l&&(0,Z.jsx)(j.Z,{style:{...P.Z.actionButtonStyle,borderRight:"none"},onClick:i,children:(0,Z.jsx)(o.FormattedMessage,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})})},this.handleFlushTemporaryPosition=e=>{let{imagePosition:t,reset:s}=e;c.createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:this.environment,perform:e=>{l.Mp({store:this.props.store,coverPosition:t,transaction:e}),s()}})},this.handleChangeCoverClick=e=>{const{intl:t,store:s}=this.props;this.stores.mouseStore.reset();const i=e.target.getBoundingClientRect();d.$(this.environment,{originGap:3,originRect:i,isSmallWidth:!1,popupWidth:540,maxHeight:485,title:t.formatMessage({defaultMessage:"Page cover",id:"pageCover.mobileMenu.title"}),onDelete:this.handleDelete,currentTab:"gallery",tabs:[{type:"gallery",onChange:this.handleGalleryChange},{type:"file",fileUpload:!1,imageUpload:!0,videoUpload:!1,caption:(0,Z.jsx)(o.FormattedMessage,{defaultMessage:"Images wider than {idealImageWidth} pixels work best.",id:"pageCover.fileType.caption",values:{idealImageWidth:1500}}),onUpload:e=>{this.props.store.getCoverStore()&&u.cT({environment:this.environment,file:e,bucket:"secure",record:s.pointer,onStart:this.handleUploadStart,onProgress:this.handleUploadProgress,onComplete:this.handleUploadComplete,onError:()=>{r.showErrorMessage(t.formatMessage({defaultMessage:"Upload failed",id:"pageCover.errorDialogMessage.uploadFailed"}))}})}},{type:"embed",title:(0,Z.jsx)(o.FormattedMessage,{defaultMessage:"Link",id:"pageCover.embedType.title"}),inputPlaceholder:m.default.formatMessage(F.embedPlaceholder),caption:(0,Z.jsx)(o.FormattedMessage,{defaultMessage:"Works with any image from the web.",id:"pageCover.embedType.caption"}),buttonText:(0,Z.jsx)(o.FormattedMessage,{defaultMessage:"Submit",id:"pageCover.embedType.buttonText"}),onChange:this.handleEmbedLinkChange},{type:"unsplash",onChange:this.handleGalleryChange}]})},this.handleUploadComplete=e=>{this.updatePageCover({url:e,position:.5})},this.handleGalleryChange=e=>{const{url:t,position:s}=e;this.updatePageCover({url:t,position:a.hj(s)?s:.5});const{device:i}=this.environment;i.isMobile&&d.Z()},this.handleEmbedLinkChange=e=>{this.updatePageCover({url:e,position:.5}),d.Z()},this.coverWithRecordStore=this.createComputedStore((()=>this.props.store.getCover()),!0),this.updatePageCover=async e=>{const{url:t,position:s}=e,{serverCommitResult:i}=c.createAndCommit({userAction:"PageCover.updatePageCover",environment:this.environment,perform:e=>{l.fs({store:this.props.store,url:t,position:s,transaction:e})}});await i,this.stores.imageUploadStore.state.loadingMode===f&&this.stores.imageUploadStore.setState({loadingMode:"downloading",dataURL:this.stores.imageUploadStore.state.dataURL,uploadProgress:100})},this.handleUploadStart=e=>{const{file:t,name:s,size:i}=e;if(d.Z(),this.stores.imageUploadStore.setState({loadingMode:h,file:t,name:s,size:i}),t.type.indexOf("image")>=0){const e=new FileReader;e.onload=e=>{this.stores.imageUploadStore.state.loadingMode===h&&this.stores.imageUploadStore.setState({...this.stores.imageUploadStore.state,uploadProgress:0,loadingMode:f,dataURL:e.target.result})},e.readAsDataURL(t)}},this.handleUploadProgress=e=>{const{progressPercent:t}=e;this.stores.imageUploadStore.state.loadingMode===f&&this.stores.imageUploadStore.setState({...this.stores.imageUploadStore.state,uploadProgress:t})},this.handleDelete=()=>{d.Z(),c.createAndCommit({userAction:"PageCover.handleDelete",environment:this.environment,perform:e=>{l.MF({store:this.props.store,transaction:e})}})}}renderComponent(){const e=this.coverWithRecordStore.getState();if(!e)return;const t=this.stores.imageUploadStore.state,s=(0,p.WE)(this.props.store),n=t.loadingMode!==y&&t.loadingMode!==h;return(0,Z.jsx)(_.Z,{mouseStore:this.stores.mouseStore,onFlushTemporaryPosition:this.handleFlushTemporaryPosition,renderControl:this.renderControl,source:"page",store:this.props.store,style:{display:"flex",flexDirection:"column",alignItems:"center",height:this.props.height,cursor:"default"},dragMessageContainerStyle:s?{top:56}:void 0,render:s=>(0,Z.jsxs)(i.Fragment,{children:[(0,Z.jsx)(I.Z,{url:e.cover,isAuthenticated:!0,permissionRecord:e.pointer,width:this.props.proxyWidth,render:(e,i)=>{this.lastProxiedUrl=i;const a={width:"100%",height:this.props.height,objectFit:"cover",opacity:n?.5:1,objectPosition:`center ${100*(1-(s.imagePosition||0))}%`,borderRadius:0},o={width:"100%",height:this.props.height};return(0,Z.jsx)(C.B,{src:i,placeholderSrc:n?t.dataURL:void 0,placeholderBehavior:n?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:o,imageStyle:a,onLoadComplete:this.handleLoadComplete})}}),n&&(0,Z.jsxs)("div",{style:w.Z.loadingContainerStyle,children:[(0,Z.jsx)(k.Z,{style:{width:16,height:16,marginRight:4}}),(0,Z.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,Z.jsx)(T.Z,{percentage:t.uploadProgress})})]})]})})}}A.displayName="PageCover";const R=(0,o.injectIntl)(A);function D(e){let t;return t=!!e.isFullWidth()?"100%":900,t}},73085:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Y});s(67294);var i=s(83355),n=s(82990),a=s(31412),o=s(54564),r=s(47307),l=s(86282),d=s(39699),c=s(80444),u=s(56638),m=s(88923),p=s(26263),g=s(49085);class h extends g.default{getInitialState(){return{inMemoryRecordCache:new p.Z({name:"TemplateRecordCacheStore"})}}}var f=s(68785),y=s(40721),x=s(53437),v=s(45953),S=s(99405),b=s(21202),M=s(77420),j=s(23867),w=s(19889),C=s(70203),k=s(54642),T=s(61045),I=s(95477),P=s(66213),_=s(28020),Z=s(88632),F=s(4548);class A extends g.default{getInitialState(){return{}}}const R=A;var D=s(82136),B=s(26350),L=s(78291),N=s(88893),O=s(77137),E=s(53336),V=s(64369),U=s(81059),W=s(31192),K=s(3553),z=s(85893);class q extends i.Z{constructor(){super(...arguments),this.storeTypes={store:R,templateRecordCacheStore:h},this.renderResult=(e,t)=>{const{navigatedRootId:s}=this.stores.store.state;if(t){let e;return e=s?B.G.createChildStore(t,{table:b.iU,id:s}):t,(0,z.jsx)("div",{style:this.props.style,children:(0,z.jsx)(K.Z,{store:e,isDefaultContainer:!0,droppable:!0,render:s=>{let{selectableEvents:i,selectableHoverMenuOverlay:n}=s;return(0,z.jsxs)(E.Z,{style:H(this.environment),type:(0,_.Zy)({environment:this.environment,store:t}),store:F.Z,preventType:T.Q7(this.environment),...i,children:[n,(0,z.jsx)(W.Z,{store:e,loadingContainerStore:void 0,context:D.S.InAppTemplatePreview,paddingBottom:W.Z.paddingBottom(this.environment),paddingLeft:(0,_.ui)(this.environment),paddingRight:(0,_.ui)(this.environment),pageCoverHeight:W.Z.defaultPageCoverHeight(this.environment),disabled:this.props.disabled})]},e.id)}},e.id)})}return(0,z.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...this.props.style},children:(0,z.jsx)(f.Z,{style:{width:U.Z.spinnerSize,height:U.Z.spinnerSize}})})},this.handleOverrideLinkClick=e=>{const{device:t}=this.environment,s=(0,S.Wj)({url:e,isMobile:t.isMobile,baseUrl:I.default.domainBaseUrl,publicDomainName:I.default.publicDomainName,protocol:I.default.protocol,currentUrl:window.location.href});"page"===s.name&&(s.peekViewBlockId?this.stores.store.setState({...this.stores.store.state,navigatedRootId:s.peekViewBlockId}):this.stores.store.setState({...this.stores.store.state,navigatedRootId:s.blockId}))},this.performRequest=async e=>{const t=await k.loadBlockSubtree(this.environment,{block:{id:e,spaceId:(0,j.C)(void 0)},shallow:!1});if("failed"===t.type)throw t.error;const{currentSpaceStore:s}=c.default.state,{data:i}=L.default.state,{inMemoryRecordCache:n}=this.stores.templateRecordCacheStore.state;n.clearCache(),n.isTemplatePreview=!0;const a=new Set,o=new Set,r=v.PF.create(t.data.subtreeRecordMap);for(const c of r){const{pointer:e,model:t,role:s}=c;if(!s)return;if(n.setModelAndRole({pointer:e,userId:this.environment.currentUser.id},t,"editor"),(null==t?void 0:t.table)===b.iU){const e=t.getProperties();for(const t of Object.keys(e)){const s=(0,C.lcG)(e[t]);for(const e of s)a.add(e);const i=(0,C.zyy)(e[t]);for(const e of i)o.add(e)}t.created_by_table&&t.created_by_id&&(t.created_by_table===w.KJ?a.add(t.created_by_id):o.add(t.created_by_id)),t.last_edited_by_table&&t.last_edited_by_id&&(t.last_edited_by_table===w.KJ?a.add(t.last_edited_by_id):o.add(t.last_edited_by_id))}}if(i)for(const c of(0,N.CM)(i))a.add(c.userId);const l=await Promise.all(Array.from(a).map((async e=>{if(s){const t=B.U6.createChildStore(s,{table:w.KJ,id:e});await t.load();return t.getValue()}{const t=await k.syncRecordValue(this.environment,{pointer:{table:w.KJ,id:e},userId:this.environment.currentUser.id,version:-1});return t&&t.value}})));for(const c of l)c&&n.setRecord({pointer:{table:w.KJ,id:c.id},userId:this.environment.currentUser.id},{role:"reader",value:c});const d=await Promise.all(Array.from(o).map((async e=>{if(s){const t=(0,B.Kv)(s,{table:M.cZ,id:e,spaceId:s.id});await t.load();return t.getValue()}{const t=await k.syncRecordValue(this.environment,{pointer:{table:M.cZ,id:e},userId:this.environment.currentUser.id,version:-1});return t&&t.value}})));for(const c of d)c&&n.setRecord({pointer:{table:M.cZ,id:c.id,spaceId:c.space_id},userId:this.environment.currentUser.id},{role:"reader",value:c});const{currentUserStore:u}=c.default.state;u&&(await u.load(),n.setRecord({pointer:u.pointer,userId:this.environment.currentUser.id},{role:"editor",value:u.getValue()}));return new B.G(this.environment,{table:b.iU,id:e},{inMemoryRecordCache:n})}}getChildContext(){return{...this.context,overrideLinkClick:this.handleOverrideLinkClick}}renderComponent(){return Z.Z.state.online?(0,z.jsx)(P.LF,{value:this.handleOverrideLinkClick,children:(0,z.jsx)(O.Z,{request:this.props.previewRootId,performRequest:this.performRequest,render:this.renderResult})}):(0,z.jsx)(P.LF,{value:this.handleOverrideLinkClick,children:(0,z.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...this.props.style},children:(0,z.jsx)(V.Z,{isSmall:!0,children:(0,z.jsx)(a.FormattedMessage,{defaultMessage:"Please go online to view this template.",id:"pageTemplatePreview.offline.message"})})})})}}q.displayName="PageTemplatePreview",q.contextTypes=i.w,q.childContextTypes={...P.wK,...i.w};const G=q;function H(e){const{device:t}=e;return{flex:1,...t.isSafari&&{zIndex:1}}}class Q extends i.Z{constructor(){super(...arguments),this.storeTypes={templateRecordCacheStore:h},this.renderMobilePopup=()=>{const e=u.Z.state;if(e.open)return(0,z.jsx)(y.default,{title:(0,z.jsx)(a.FormattedMessage,{defaultMessage:"Try this template",id:"pageTemplateModal.mobileModal.title"}),left:(0,z.jsx)(y.CancelMenuText,{}),onClickLeft:this.handleDismiss,right:e.isLoading?(0,z.jsx)(f.Z,{}):(0,z.jsx)(a.FormattedMessage,{defaultMessage:"Use",id:"pageTemplateModal.mobileModal.useButton.label"}),onClickRight:this.handleUseTemplateClick,forceFullScreenSlideUp:!0,children:this.renderPreview(e)})},this.handleDismiss=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await $()?this.accept(!0):J(this.environment)}else J(this.environment)},this.handleUseTemplateClick=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await $()?this.accept(!0):this.accept(!1)}else this.accept(!1)}}willMountOrUpdate(){const e=u.Z.state,{currentSpaceViewStore:t}=c.default.state;e.open&&t&&d.createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:this.environment,perform:s=>{l.GF({item:e.item,spaceViewStore:t,transaction:s})}})}renderComponent(){const{device:e}=this.environment,t=u.Z.state;if(e.isMobile)return(0,z.jsx)(x.GI,{open:t.open,render:this.renderMobilePopup,forceFullScreenSlideUp:!0,onDismiss:this.handleDismiss,popupType:x.GI.PopupType.SlideUp})}renderPreview(e){return(0,z.jsx)(G,{previewRootId:e.item.previewRootId,style:Q.previewMobileStyle,templateRecordCacheStore:this.stores.templateRecordCacheStore,disabled:!0},e.item.previewRootId)}accept(e){const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state,s=u.Z.state,{currentSpaceViewStore:i,currentSpaceStore:n,mainEditorCurrentBlockStore:a}=c.default.state;if(s.open&&i&&n){const o=a&&a.isEmptyPage()?a:void 0,r=m.default.state.open&&m.default.state.target&&m.default.state.target.isEmptyPage()?m.default.state.target:void 0;l.RL({environment:this.environment,item:s.item,spaceStore:n,spaceViewStore:i,useRecordCache:e?t:void 0,initializeStore:s.createNewPage?void 0:o||r,isPrivate:s.isPrivate,from:s.createNewPage?"sidebar":"newPage"})}}getIconWrapStyle(){return{color:this.theme.regularTextColor,position:"relative"}}hoveredButtonStyle(){return{color:this.theme.regularTextColor,fontWeight:n.Z.fontWeight.medium}}fixedLinkStyle(){return{padding:12,color:this.theme.mediumTextColor,background:"dark"===this.theme.mode?this.theme.popoverBackground:this.theme.sidebarBackground,fontSize:13,fontWeight:n.Z.fontWeight.medium,display:"flex",alignItems:"center",position:"absolute",bottom:0,right:0,height:45,width:Q.sidebarWidth,borderTop:`1px solid ${this.theme.regularDividerColor}`}}fixedLinkIconStyle(){return{width:12,height:12,marginLeft:8,marginRight:10,marginBottom:0,fill:this.theme.regularIconColor,fontWeight:n.Z.fontWeight.medium}}}Q.displayName="PageTemplateModal",Q.sidebarWidth=240,Q.previewMobileStyle={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"},Q.scrollerStyle={flexGrow:1,flexShrink:1,paddingBottom:44};const Y=(0,a.injectIntl)(Q);function $(){return new Promise(((e,t)=>{r.showDialog({message:(0,z.jsx)(a.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:(0,z.jsx)(a.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:(0,z.jsx)(a.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}function J(e){l.xv(e),o.LZ()}},57806:(e,t,s)=>{s.r(t),s.d(t,{PermissionsInviteBase:()=>A,default:()=>R});s(67294);var i=s(83355),n=s(8848),a=s(72126),o=s(94044),r=s(31412),l=s(50906),d=s(95209),c=s(43250),u=s(87279),m=s(45101),p=s(65598),g=s(18514),h=s(38755),f=s(95697),y=s(18245),x=s(85834),v=s(1903),S=s(29677),b=s(26350),M=s(34583),j=s(35057),w=s(78140),C=s(40721),k=s(72495),T=s(83182),I=s(7567),P=s(44385),_=s(24145),Z=s(43579),F=s(85893);class A extends i.Z{constructor(){super(...arguments),this.renderInShareMenu=this.createComputedStore((()=>Boolean(this.props.renderInShareMenu&&!this.environment.device.isMobile))),this.inviteOrigin=this.createComputedStore((()=>this.props.store instanceof b.G?this.renderInShareMenu.state?"page_share_modal":"page_permission_modal":"space_share_modal")),this.defaultRoleForSpaceBot=this.createComputedStore((()=>"editor")),this.defaultRoleForNonBot=this.createComputedStore((()=>{const{store:e,isSubscribed:t}=this.props;return m.xT({environment:this.environment,store:e,isSubscribed:t})})),this.inputDebounce=void 0,this.storeTypes={permissionsInviteStore:v.Z,contextualInviteStore:x.ZP},this.handleUpgradeClick=()=>{d.Vu({environment:this.environment,upgradeButtonName:this.props.upgradeButtonName,onUpgradeButtonClick:this.props.onUpgradeButtonClick})},this.handleModalDismiss=async()=>{await d.kL({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,from:"share_menu"})},this.handleInputChange=async e=>{var t;null===(t=this.inputDebounce)||void 0===t||t.cancel(),this.inputDebounce=a.Ds((()=>{l.UWw(this.environment,{invite_flow_id:this.stores.permissionsInviteStore.state.flowId,subscription_tier:(0,j.zt)(),invite_origin:this.inviteOrigin.state})}),1e3),this.inputDebounce(),await d.jC({environment:this.environment,event:e,permissionsInviteStore:this.stores.permissionsInviteStore})},this.handleClickRemoveToken=e=>{d.PV({targetToRemove:e,permissionsInviteStore:this.stores.permissionsInviteStore,defaultRoleForNonBot:this.defaultRoleForNonBot.state})}}async willMount(){await M.bi(this.environment)}willUnmount(){var e;null===(e=this.inputDebounce)||void 0===e||e.flush()}renderComponent(){if(this.renderInShareMenu.state)return this.renderComponentInShareMenu();const e=this.renderHeader(),t=this.renderSearchRequest();return this.renderComponentOriginal(e,t)}renderHeader(){const{permissionsInviteStore:e}=this.stores,{device:t}=this.environment;return(0,F.jsx)(_.Z,{permissionsInviteStore:e,store:this.props.store,handleClickRemoveToken:e=>{this.handleClickRemoveToken(e)},handleInputChange:async e=>{await this.handleInputChange(e)},handleInputSubmit:async()=>{await this.handleInviteInputSubmit()},origin:Boolean(this.renderInShareMenu.state)?"share_menu":"share_modal",defaultRoleForNonBot:this.defaultRoleForNonBot.state,isTeamsEnabled:(0,f.bq)(),right:!t.isMobile&&this.renderDesktopInputRightInner(),focus:"invitee"===e.state.inputFocus||"invitee-popup-closed"===e.state.inputFocus,handleFocus:()=>{t.isMobile||e.setState({...e.state,inputFocus:"invitee"})}})}renderSearchRequest(){const{permissionsInviteStore:e}=this.stores,t=(0,p.OY)(this.props.store),s=(0,p.OY)(this.props.store),i=this.props.store instanceof b.G&&(0,h.Q6)(this.props.store.getSpaceStore());return(0,F.jsx)(Z.Z,{permissionsInviteStore:e,store:this.props.store,defaultRoleForSpaceBot:this.defaultRoleForSpaceBot.state,shouldShowBots:t,shouldShowGroups:s,sectionRenderLimit:this.renderInShareMenu.state?5:10,membersOnly:this.props.membersOnly,guestsMustBeRequested:i})}renderComponentOriginal(e,t){const{device:s}=this.environment;let i;return i=s.isMobile?{menuType:u.og.Modal,title:(0,p.Mm)(this.props.store)?(0,F.jsx)(r.FormattedMessage,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,F.jsx)(r.FormattedMessage,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,F.jsx)("div",{style:{color:n.ZP.blue},children:(0,F.jsx)(r.FormattedMessage,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,F.jsx)(C.CancelMenuText,{}),onClickLeft:this.handleModalDismiss,onClickRight:async()=>{await this.handleInviteClick()},header:e}:{menuType:u.og.Popup,width:480,height:"60vh",header:e,tokenInputHeader:!0,footer:this.renderHelpButton(),disableScroller:!1},(0,F.jsxs)(w.Z,{...i,className:c.FJA,children:[s.isMobile&&(0,F.jsx)(k.Z,{title:(0,F.jsx)(r.FormattedMessage,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:this.renderDesktopInputRightInnerSelect()}),(0,F.jsx)("div",{children:t}),s.isMobile&&this.renderHelpButton()]})}renderHelpButton(){return this.renderInShareMenu.state?null:(0,F.jsx)(k.Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,F.jsx)(T.Z,{title:(0,F.jsx)(r.FormattedMessage,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,g.UY)("guides.invitePerson"),analyticsFrom:"invite_person"})})}renderDesktopInputRightInner(){return(0,F.jsxs)("div",{style:{marginLeft:o.p_,display:"flex",alignItems:"center"},children:[this.renderDesktopInputRightInnerSelect(),!this.renderInShareMenu.state&&this.renderDesktopInputRightInnerButton({isLarge:!0})]})}renderDesktopInputRightInnerButton(e){const{isLarge:t}=e;return(0,F.jsx)(P.Z,{store:this.props.store,permissionsInviteStore:this.stores.permissionsInviteStore,handleUpgradeClick:()=>this.handleUpgradeClick(),handleInviteClick:()=>this.handleInviteClick(),disabled:this.props.disabled,isLarge:t})}renderDesktopInputRightInnerSelect(){const{device:e}=this.environment,{store:t}=this.props,{permissionsInviteStore:s}=this.stores;if(s.state.isInviteTargetsEmpty||!(0,S.ow)(s.state))return(0,F.jsx)(I.ZP,{disabled:(0,p.Mm)(t)&&!t.canAdmin(),role:s.state.inviteRole,table:s.state.table,type:"user_permission",blockType:(0,p.OY)(t)?t.getType():void 0,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",height:26,color:n.ZP.uiGray,...this.renderInShareMenu.state&&{marginTop:e.isMobile?4:s.state.isInviteTargetsEmpty?1:6,marginBottom:e.isMobile?4:s.state.isInviteTargetsEmpty?1:6,marginRight:0}},isMenuItem:e.isMobile,onChange:e=>{d.XC({environment:this.environment,newRole:e,permissionsInviteStore:this.stores.permissionsInviteStore})}})}renderComponentInShareMenu(){const e={menuType:u.og.Popup,header:(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"top",marginLeft:12,marginRight:12,gap:10},children:[this.renderHeader(),this.renderDesktopInputRightInnerButton({isLarge:!0})]}),footer:this.renderHelpButton(),disableScroller:!1};return(0,F.jsx)("div",{style:{paddingTop:14,paddingBottom:14,paddingLeft:2,paddingRight:2},children:(0,F.jsx)(w.Z,{...e,children:this.renderSearchRequest()})})}async handleInviteInputSubmit(){await this.handleInviteClick()}async handleInviteClick(){const e=y.default.mark("share_menu.invite_user_lag");await d.qg({environment:this.environment,store:this.props.store,sudoModeStore:this.props.sudoModeStore,permissionsInviteStore:this.stores.permissionsInviteStore,contextualInviteStore:this.stores.contextualInviteStore,onInviteClick:this.props.onInviteClick,onInviteComplete:this.props.onInviteComplete,inviteOrigin:this.inviteOrigin.state,intl:this.props.intl}),y.default.measure(e,{environment:this.environment})}}A.displayName="PermissionsInviteBase";const R=(0,r.injectIntl)(A)},44385:(e,t,s)=>{s.d(t,{Z:()=>y,e:()=>f});s(67294);var i=s(480),n=s(86628),a=s(94044),o=s(47425),r=s(31412),l=s(67669),d=s(45101),c=s(26781),u=s(4023),m=s(35057),p=s(42922),g=s(26388),h=s(85893);function f(){window.__c={n:"GuestLimitTooltip"};const e=(0,n.VK)((()=>(0,o.tP)((0,m.zt)())),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{children:(0,h.jsx)(r.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your plan allows up to {guestLimit} unique guests.",values:{guestLimit:e}})}),(0,h.jsx)("div",{children:(0,h.jsx)(r.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine2",defaultMessage:"Upgrade to go unlimited."})})]})}const y=function(e){window.__c={n:"PermissionsInviteButton"};const{store:t,permissionsInviteStore:s,handleUpgradeClick:o,handleInviteClick:m,isLarge:y}=e,x=(0,i.O7)(),[v]=(0,n.AF)(s),S=(0,n.VK)((()=>v.inviteTargets.some((e=>d.OA(e)))),[v]),b=(0,c.S)(t),M=(0,n.VK)((()=>{const e=v.inviteTargets,t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),s=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return l.dA(x,[...t,...s])}),[x,v]),j=S?b:void 0;return(0,h.jsx)(g.Z,{alignment:u.v.Center,disableTooltip:!(M||j),renderTooltip:()=>M?(0,h.jsx)(f,{}):j,render:e=>(0,h.jsx)(p.Z,{isLarge:y,style:{minWidth:a.UF},disabled:Boolean(j),onClick:M?o:m,...e,children:M?(0,h.jsx)(r.FormattedMessage,{id:"inviteUserModal.inviteButton.upgradeLabel",defaultMessage:"Upgrade"}):(0,h.jsx)(r.FormattedMessage,{id:"inviteUserModal.inviteButton.label",defaultMessage:"Invite"})})})}},7378:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});s(67294);var i=s(83355),n=s(41892),a=s(31412),o=s(1865),r=s(45101),l=s(65598),d=s(1903),c=s(78291),u=s(34583),m=s(35057),p=s(42922),g=s(9019),h=s(26388),f=s(57806),y=s(60442),x=s(85893);class v extends i.Z{constructor(){super(...arguments),this.storeTypes={permissionsInviteStore:d.Z},this.renderOverlay=()=>(0,x.jsx)(f.default,{...this.props,permissionsInviteStore:this.stores.permissionsInviteStore}),this.handleUpgradeClick=()=>{o.y(this.environment,{from:this.props.upgradeButtonName,for:"plus"}),this.props.onUpgradeButtonClick&&this.props.onUpgradeButtonClick()},this.handleButtonClick=()=>{(0,r.z5)({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,store:this.props.store,renderInShareModal:!1,isSubscribed:this.props.isSubscribed})},this.handleModalDismiss=async()=>{const{permissionsInviteStore:e}=this.stores;await(0,r.Aw)({environment:this.environment,permissionsInviteStoreState:e.state,from:(0,l.Mm)(this.props.store)?"space_share_modal":"page_share_modal"})||e.reset()}}async willMount(){await u.bi(this.environment)}renderComponent(){const{store:e}=this.props,{modalOpen:t}=this.stores.permissionsInviteStore.state;let s,i,o=!1;return e.canEditMembership()?e.canEditMembership()&&(0,l.Mm)(e)&&c.default.state.data&&!m.Mk()?(s=!1,o=!0,i=(0,x.jsx)(y.Z,{imageURL:n.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,x.jsx)(a.FormattedMessage,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,x.jsx)(a.FormattedMessage,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})})):s=!0:(s=!1,i=(0,l.Mm)(e)?(0,x.jsx)(a.FormattedMessage,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."}):(0,x.jsx)(a.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."})),(0,x.jsx)("div",{children:(0,l.Mm)(e)?(0,x.jsx)(g.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:(0,x.jsx)(h.Z,{renderTooltip:()=>i,disableTooltip:s,render:e=>(0,x.jsx)(p.Z,{isLarge:!0,onClick:o?this.handleUpgradeClick:this.handleButtonClick,disabled:!s&&!o,style:{flex:this.props.shouldGrow?1:0,...this.props.buttonStyle},...e,children:(0,x.jsx)(a.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})})}):(0,x.jsx)(g.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:null})})}}v.displayName="PermissionsInviteWithModal";const S=(0,a.injectIntl)(v)},35229:(e,t,s)=>{s.d(t,{Z:()=>G});s(57658);var i=s(67294),n=s(83355),a=s(49085),o=s(66897),r=s(72126),l=s(19889),d=s(70203),c=s(97880),u=s(31412),m=s(31299),p=s(87279),g=s(480),h=s(86628),f=s(24405),y=s(33728),x=s(47612),v=s(10020),S=s(50906),b=s(49068),M=s(52275),j=s(31945),w=s(96525),C=s(43765),k=s(72495),T=s(95697),I=s(80444),P=s(77080),_=s(55899),Z=s(35057),F=s(22508),A=s(13394),R=s(7314),D=s(85893);function B(e){window.__c={n:"PersonPropertyInviteMenuItem"};const t=(0,h.qz)(void 0,_.ZP),s=(0,h.qz)(void 0,A.Z),{store:n,inputValue:a,intl:o,propertySchemaLimit:r,isLoading:d,handlePersonPropertyMenuChange:c}=e,m=(0,g.O7)(),p=(0,f.yK)((e=>({moreBarTitleStyle:{color:e.text.secondary,fontSize:11},inviteIconStyle:{width:20,height:20,fill:e.icon.primary},rightIconStyle:{width:20,height:20,fill:e.icon.secondary},desktopTitleStyle:{color:e.text.secondary,fontSize:11},messageBodyStyle:{color:e.text.tertiary,paddingLeft:2},messageTitleStyle:{color:e.text.tertiary},inviteBodyStyle:{color:e.text.primary}})),[]),{isMobile:B}=(0,g.Fy)(),L=(0,h.VK)((()=>{var e;return null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),N=(0,h.VK)((()=>s.state.flowId),[s]),{email:O,isEmail:E,inviteButtonTitle:V}=(0,i.useMemo)((()=>{const e=(0,y.H3)(a),t=(0,y.oH)(e),s=o.formatMessage({id:"invite.person_property.button.invite_people",defaultMessage:"Invite people"}),i=o.formatMessage({id:"invite.person_property.button.invite_email",defaultMessage:"Invite ”{email}”"},{email:e});return{email:e,isEmail:t,inviteButtonTitle:t?i:s}}),[a,o]),U=(0,i.useCallback)((()=>{E&&O&&F.Co({email:O,inviteTargetsStore:t}),S.P0l(m,{origin:"person_property_invite",invite_flow_id:N})}),[E,N,O,m,t]),W=(0,i.useCallback)((()=>{S.Zvm(m,{origin:"person_property_invite",invite_flow_id:N})}),[N,m]);return(0,h.VK)((()=>{const e=function(e){const{canAddPermissions:t,isMobile:s}=e,i="enterprise"===e.subscriptionTier;if(s||!T.bq||i||!t)return!1;return"on"===P.default.getEligibleGroup({experimentId:"acq_person_property_invite_v1",defaultGroup:"control"})}({canAddPermissions:n.canEditMembership(),isMobile:B,isTeamsEnabled:(0,T.bq)(),subscriptionTier:(0,Z.zt)()});return e&&S.x8E(m,{origin:"person_property_invite",invite_flow_id:N}),e}),[n,N,B,m])?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(k.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"People",id:"database.personPropertyValue.selectPerson.noSearchResults.resultsTitle"}),desktopTitleStyle:p.desktopTitleStyle,loading:d,desktopStyle:{paddingBottom:4},children:(0,D.jsx)(C.Z,{title:(0,D.jsx)("span",{style:p.messageBodyStyle,children:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"No matches in {spaceName}",id:"database.personPropertyMenu.noSearchResults.messageWithSpaceName",values:{spaceName:L}})}),titleStyle:p.messageTitleStyle})}),(0,D.jsx)(k.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"More",id:"database.personPropertyValue.selectPerson.noSearchResults.suggestionTitle"}),desktopTitleStyle:p.moreBarTitleStyle,topBorder:!0,desktopStyle:{marginTop:0,paddingTop:10},children:(0,D.jsx)(w.Z,{focused:!1,stopClickPropagation:!0,popupType:j.Z4.Popup,renderOrigin:e=>(0,D.jsx)(M.Z,{...e,focused:!1,icon:(0,x.C)(p.inviteIconStyle),title:V,right:(0,v.C)(p.rightIconStyle),textWrapperStyle:p.inviteBodyStyle}),onClick:U,onClose:W,borderRadius:8,render:e=>(0,D.jsx)(R.Z,{inviteOrigin:"person_property_invite",store:n,handleBackButtonClick:()=>e.close(),inviteTargetsStore:t,personPropertyInviteStore:s,onInviteCompleteFn:t=>{e.close();const s=(t.success?Object.values(t.invitedUsers):[]).map((e=>({table:l.KJ,id:e})));c(s)}})})})]}):(0,D.jsx)(k.Z,{title:(0,b.$)(r),loading:d,children:(0,D.jsx)(C.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"No results",id:"database.personPropertyMenu.noSearchResults.message"})})})}var L=s(69582),N=s(78140),O=s(32163),E=s(40721),V=s(77137),U=s(92864),W=s(47082),K=s(97680);const z=(0,u.defineMessages)({searchForPerson:{defaultMessage:"Search for a person…",id:"database.personPropertyValue.searchPlaceholder"}});class q extends n.Z{constructor(){super(...arguments),this.inputValue=a.default.createValue(""),this.handlePersonPropertyMenuChange=e=>{const{schema:t,property:s}=this.props,i=t[s];if(!i||"person"!==i.type)return;let n;n=1===i.limit?e.length>0?[e[e.length-1]]:[]:e,this.props.onChange({value:n}),this.inputValue.setState("")}}willMount(e){super.willMount(e),e.insertChar&&this.inputValue.setState(e.insertChar)}renderComponent(){const{device:e}=this.environment,{disabled:t,intl:s,schema:n,property:a,isTemplatePage:g}=this.props,h=g&&P.default.checkGate("template-variable-properties"),f=n[a];if(!f||"person"!==f.type)return;const y=[],x=this.props.value.map((s=>{if((0,d.D4X)(s))return y.push(s),(0,D.jsx)(L.w,{templateVariableType:s,showRemoveButton:!t,onRemove:()=>{const e=this.props.value.filter((e=>(0,o.Wk)(e)));this.props.onChange({value:e})},style:{margin:"0px 6px 6px 0px"}},s);if((0,o.Wk)(s)){const i=(0,o.Hl)({pointer:s,getRecordValue:this.props.parentStore.getRecordValue});return(0,D.jsx)(U.ZP,{actor:i,format:e.isMobile?U.ZP.Format.Large:U.ZP.Format.Medium,showRemoveButton:!t,onClickRemove:()=>{const e=this.props.value.filter((e=>(0,d.D4X)(e)||(0,o.Wk)(e)&&e.id!==s.id));this.props.onChange({value:e})},shouldShrink:!0,isSingle:!1},s.id)}(0,c.t1)(s)})),v=d.s8k.filter((e=>!y.includes(e))),S={request:{query:this.inputValue.state,actors:r.hX(this.props.value,o.Wk)},performRequest:async e=>{let{query:t,actors:s}=e;const{users:i}=await m.CO({environment:this.environment,query:t,membersOnly:!1});return{users:i.filter((e=>!s.some((t=>t.id===e.id)))).slice(0,20)}},render:(e,t,i)=>{if(e)return(0,D.jsx)(k.Z,{title:(0,b.$)(f.limit),loading:!i,children:(0,D.jsx)(C.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"Something went wrong.",id:"database.personPropertyMenu.searchErrorMessage"})})});if(t&&0===t.users.length)return(0,D.jsx)(B,{store:this.props.parentStore,inputValue:this.inputValue.state,intl:s,propertySchemaLimit:f.limit,isLoading:!i,handlePersonPropertyMenuChange:e=>{this.handlePersonPropertyMenuChange([...this.props.value,...e])}});const n=r.oA((t&&t.users||[]).map((e=>({key:e.id,render:t=>(0,D.jsx)(K.Z,{...t,actor:(0,o.dp)(e)}),action:()=>{this.handlePersonPropertyMenuChange([...this.props.value,{table:l.KJ,id:e.id}])}})))),a=r.oA([n.length>0?{key:"person section",render:e=>(0,D.jsx)(k.Z,{...e,title:(0,b.$)(f.limit),loading:!i}),items:n}:void 0]);return(0,D.jsx)(O.Z,{type:O.i.Vertical,initialFocus:this.inputValue.state.length>0?0:void 0,sections:a})}},j=(0,D.jsx)(W.Z,{focus:!e.isMobile||void 0,focusAfterAnimation:!0,format:W.Z.Format.Person,tokens:x,placeholder:s.formatMessage(z.searchForPerson),hideInput:t,onRemoveLastToken:()=>{this.props.onChange({value:this.props.value.slice(0,this.props.value.length-1)})},value:this.inputValue.state,onChange:e=>this.inputValue.setState(e.target.value),dontShowBorderBottom:e.isAndroid});let w;return w=e.isMobile?{menuType:p.og.Modal,title:f.name,right:(0,D.jsx)(E.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:j}:{menuType:p.og.Popup,header:j,tokenInputHeader:!0,maxHeight:333},t?(0,D.jsx)(N.Z,{...w}):(0,D.jsxs)(N.Z,{...w,children:[h&&(0,D.jsx)(k.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"Shortcuts",id:"PersonPropertyMenu.menuItem.shortcuts.label"}),children:v.length>0?(0,D.jsx)(i.Fragment,{children:v.map((e=>(0,D.jsx)(M.Z,{focused:!1,title:(0,D.jsx)(L.w,{templateVariableType:e}),caption:(0,d.Z08)(e,s),inline:!0,onClick:()=>{this.handlePersonPropertyMenuChange([...this.props.value,e])}},`relative-person-shortcut-${e}`)))}):(0,D.jsx)(C.Z,{title:(0,D.jsx)(u.FormattedMessage,{id:"database.personPropertyMenu.noShorcuts.message",defaultMessage:"No shortcuts"})})}),(0,D.jsx)(V.Z,{...S})]})}}q.displayName="PersonPropertyMenu";const G=(0,u.injectIntl)(q)},1244:(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var i=s(67294),n=s(83355),a=s(480),o=s(86628),r=s(24405),l=s(41892),d=s(8848),c=s(64275),u=s(72126),m=s(89101),p=s(60949),g=s(82990),h=s(31412),f=s(50906),y=s(29974),x=s(97627),v=s(39699),S=s(37181),b=s(36867),M=s(75538),j=s(80444),w=s(4926),C=s(77080),k=s(5188),T=s(49085);class I extends T.default{getInitialState(){return{open:!1,step:"prompt"}}}const P=new I;var _=s(23063),Z=s(42922),F=s(64921),A=s(28451),R=s(3386),D=s(89728),B=s(53437),L=s(42402),N=s(29551),O=s(38294),E=s(85893);class V extends n.Z{constructor(){super(...arguments),this.hasSeenInitial=!1,this.renderMenu=()=>(0,E.jsx)(A.P,{calloutId:"persona_collection",children:(0,E.jsxs)("div",{style:this.getContainerStyle(),children:[this.renderCancel(),(0,E.jsx)(N.gq,{style:{width:320,height:"prompt"===P.state.step||"thanks"===P.state.step?200:450,overflow:"hidden",position:"relative",right:"auto",padding:30,paddingTop:0,cursor:"default",textAlign:"center",justifyContent:"center"},alignItems:"center",alignContent:"center",children:this.renderStep()})]})}),this.renderInitial=()=>{const e=this.environment.currentUser.id;if(!P.state.open||!e)return;this.hasSeenInitial||(f.q5U(this.environment,{user_id:e,event:"initial"}),this.hasSeenInitial=!0);const{invalidField:t}=P.state;return(0,E.jsxs)("div",{style:{...q(),padding:8},children:[(0,E.jsx)("img",{style:{width:40,height:32},src:l.Z.images.chatButtonSmallPng}),(0,E.jsx)("div",{style:{fontSize:14,fontWeight:g.Z.fontWeight.semibold,paddingTop:0,paddingBottom:8},children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.header",defaultMessage:"Tell us more about yourself"})}),(0,E.jsx)("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:270,margin:"0 auto"},children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you"})}),(0,E.jsx)("div",{style:{...this.getLabelStyle(),marginTop:10},children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.roleLabel",defaultMessage:"What is your role?"})}),(0,E.jsx)(O.Z,{questionType:"role",title:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.roleLabel",defaultMessage:"Role"}),question:P.state.role,invalid:"role"===t,onSelect:e=>{P.state.open&&P.setState({...P.state,role:e,step:"initial"})}}),(0,E.jsx)("div",{style:this.getLabelStyle(),children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.workLabel",defaultMessage:"What kind of work do you do?"})}),(0,E.jsx)(O.Z,{questionType:"work",title:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.workLabel",defaultMessage:"Work"}),question:P.state.work,invalid:"work"===t,onSelect:e=>{P.state.open&&P.setState({...P.state,work:e,step:"initial"})}}),(0,E.jsx)("div",{style:this.getLabelStyle(),children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.questionLabel",defaultMessage:"What are you planning to use Notion for?"})}),(0,E.jsx)(O.Z,{questionType:"use",title:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.useLabel",defaultMessage:"Use"}),question:P.state.use,invalid:"use"===t,onSelect:e=>{P.state.open&&P.setState({...P.state,use:e,step:"initial"})}}),(0,E.jsx)("div",{style:this.getLabelStyle(),children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.companySizeLabel",defaultMessage:"Company size"})}),(0,E.jsx)(N.gq,{children:[{type:"1_100",message:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}].map((e=>{let{type:t,message:s,style:i}=e;return(0,E.jsx)(D.Z,{isLightGray:!0,isLarge:!0,style:{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center",...P.state.open&&P.state.companySize===t&&{color:d.ZP.blue,border:`1px solid ${d.ZP.blue}`},...i},onClick:()=>{P.state.open&&P.setState({...P.state,companySize:t,step:"initial"})},children:s},t)}))})]})},this.renderCancel=()=>(0,E.jsx)(F.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground},children:(0,c.D)({width:14,fill:this.theme.mediumTextColor})}),this.renderThanks=()=>{const e=this.environment.currentUser.id;if(e)return(0,E.jsx)(K,{userId:e})},this.renderPrompt=()=>{const e=this.environment.currentUser.id;if(e)return(0,E.jsx)(W,{userId:e})},this.handleCancel=()=>{const{currentUserSettingsStore:e}=j.default.state,t=this.environment.currentUser.id;e&&t&&(f.jPN(this.environment,{user_id:t,event:"cancel"}),v.createAndCommit({userAction:"PersonaCollectionModal.handleCancel",environment:this.environment,perform:t=>{S.d2({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}}),P.reset())}}willMountOrUpdate(){var e;if(P.state.open)return;const t=this.environment,s=t.currentUser.id,i=(0,b.g)(s),{currentUserSettingsStore:n,inAppCalloutStore:a}=j.default.state;if(!n||t.device.isMobile)return;if(i<3)return;const o=n.getSettings();if(!o)return;Boolean(o.seen_persona_collection||(null===(e=o.persona_version)||void 0===e?void 0:e.version))||!M.default.state.isOnboarding&&"closed"!==P.state.step&&!1===k.Z.state.open&&a.canShow("persona_collection")&&P.setState({...P.state,open:!0})}renderComponent(){return(0,E.jsx)(B.GI,{keepFocus:!1,open:P.state.open,render:this.renderMenu,onDismiss:this.handleCancel,popupType:B.kQ.Popup,disableDarkOverlayBackground:!0,disableMouseCapture:!0})}renderStep(){if(!1===P.state.open)return;const{step:e}=P.state;return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(_.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,E.jsx)(R.Z,{capture:!0,onBackspace:u.yR,onLeft:u.yR,onRight:u.yR,onSelectAll:u.yR,onRedo:u.yR,onUndo:u.yR,onCut:u.yR,onCopy:u.yR,onPaste:u.yR,onKeypress:u.yR,onDelete:u.yR,onTab:u.yR,children:this.renderInitial()})}),(0,E.jsx)(_.Z,{isVisible:"prompt"===e,animationStyle:z("prompt"===e),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},render:this.renderPrompt}),(0,E.jsx)(_.Z,{isVisible:"thanks"===e,animationStyle:z("thanks"===e),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},render:this.renderThanks}),(0,E.jsx)(_.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,E.jsx)(Z.Z,{isLarge:!0,style:{marginTop:17,width:270,position:"absolute",bottom:20},onClick:()=>function(e){const t=e.currentUser.id;if(!P.state.open||!t)return;const s=function(){if(!P.state.open)return"closed";const{use:e,role:t,work:s,companySize:i}=P.state;if(!i)return"company_size";if(!e)return"use";if(!t)return"role";if(!s)return"work"}();if(s)return void P.setState({...P.state,step:"initial",invalidField:s});f.jPN(e,{user_id:t,event:"submit"});const{currentUserSettingsStore:i}=j.default.state;if(i&&P.state.open){const t=P.state;if(v.createAndCommit({userAction:"PersonaCollectionModal.handleSubmitClick",environment:e,perform:e=>{S.d2({userSettingsStore:i,data:{seen_persona_collection:!0,persona:t.work,team_role:t.role,use_case:t.use,source:"persona_collection",persona_version:{version:"V3",timestamp:(new Date).getTime()}},transaction:e})}}),C.default.checkGate("survey_data_writes")){const s=(new Date).getTime(),i=p.Dh({maybeFunction:t.work,guessedFunctionVersion:4,maybeRole:t.role,guessedRoleVersion:2,collectedFrom:"inapp_modal",collectedAt:s});void 0!==i&&x.Q1(e,i);const n=p.K0({maybeCompanySize:t.companySize,guessedCompanySizeVersion:1,maybeUseCases:[t.use],guessedUseCasesVersion:3,collectedFrom:"inapp_modal",collectedAt:s});void 0!==n&&y.wg(e,n)}}return P.setState({...P.state,invalidField:void 0,step:"thanks"}),void u.gw((()=>{P.reset()}),6e3)}(this.environment),children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.sendLabel",defaultMessage:"Submit"})})})]})}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"fixed",bottom:65+w.Z.state,right:16+w.Z.state}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getLabelStyle(){return{marginTop:10,fontSize:12,color:this.theme.mediumTextColor,fontWeight:g.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}}V.displayName="PersonaCollectionModal";const U=V;function W(e){window.__c={n:"PersonaCollectionPrompt"};const[t,s]=(0,o.AF)(P),n=(0,r.yK)((e=>({promptHeaderStyle:{color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,fontSize:14},promptTextStyle:{fontSize:12,color:e.mediumTextColor,width:270,margin:"0 auto"}})),[]),d=(0,a.O7)();return(0,i.useEffect)((()=>{f.q5U(d,{user_id:e.userId,event:"prompt"})}),[d,e.userId]),(0,E.jsxs)("div",{style:{paddingTop:24},children:[(0,E.jsx)("img",{style:{width:40,height:56,paddingTop:24},src:l.Z.images.chatButtonSmallPng}),(0,E.jsx)("div",{style:n.promptHeaderStyle,children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.header",defaultMessage:"Tell us more about yourself"})}),(0,E.jsx)("div",{style:n.promptTextStyle,children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you"})}),(0,E.jsx)(Z.Z,{isLarge:!0,style:{marginTop:6,width:260,bottom:20},onClick:()=>{!0===t.open&&s({...t,step:"initial"});const{currentUserSettingsStore:e}=j.default.state;e&&v.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:d,perform:t=>{S.d2({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}})},children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.survey",defaultMessage:"Take the 20 second survey"})}),(0,E.jsx)(D.Z,{isLightGray:!0,isLarge:!0,onClick:()=>{const{currentUserSettingsStore:t}=j.default.state;t&&e.userId&&(v.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:d,perform:e=>{S.d2({userSettingsStore:t,data:{seen_persona_collection:!0},transaction:e})}}),f.jPN(d,{user_id:e.userId,event:"skip"}),P.setState({open:!1,step:"closed"}))},children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.skipLabel",defaultMessage:"Skip"})})]})}function K(e){window.__c={n:"PersonaCollectionThanks"};const t=(0,r.yK)((e=>({thanksHeaderStyle:{color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,fontSize:14}})),[]),s=(0,a.O7)();return(0,i.useEffect)((()=>{f.q5U(s,{user_id:e.userId,event:"thanks"})}),[s,e.userId]),(0,E.jsxs)("div",{children:[(0,E.jsx)("img",{style:{width:208,height:89,paddingTop:30},src:l.Z.images.heroIllustrationPng}),(0,E.jsx)("div",{style:t.thanksHeaderStyle,children:(0,E.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.thanks.caption",defaultMessage:"Thank you! Discover new ways to use Notion in the <textlink>Template Gallery</textlink>",values:{textlink:t=>(0,E.jsx)(L.Z,{disableUnderline:!0,disableHover:!0,href:m._j.templates,external:!0,style:{color:d.ZP.blue,fontSize:g.Z.fontSize.UIRegular.desktop,fontWeight:500},onClick:()=>{e.userId&&f.jPN(s,{user_id:e.userId,event:"template_gallery"})},children:t})}})})]})}function z(e){return{opacity:e?1:0,scale:e?1:.96}}function q(){if(!P.state.open)return{};const{step:e}=P.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(0px)":"translateY(-180px)"}}},38294:(e,t,s)=>{s.d(t,{Z:()=>S});s(67294);var i=s(83355),n=s(8848),a=s(37240),o=s(29091),r=s(31412),l=s(52275),d=s(63296),c=s(45959),u=s(64369),m=s(85893);const p="other",g={exec:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.exec",defaultMessage:"Executive (C-level / VP)"}),dept_lead:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.dept_lead",defaultMessage:"Department lead"}),team_manager:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.team_manager",defaultMessage:"Team manager"}),member:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.member",defaultMessage:"Team member"}),solo:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.solo",defaultMessage:"Solo-preneur / Freelancer"}),personal:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.personal",defaultMessage:"Using Notion just for myself"})},h={creative:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.creative",defaultMessage:"Creative"}),founderCeo:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.founderCeo",defaultMessage:"Founder / CEO"}),internalCommunication:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.internalCommunication",defaultMessage:"Internal Communication"}),eng:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.eng",defaultMessage:"Engineering"}),productDesign:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.productDesign",defaultMessage:"Product Design"}),projectProgramMgmt:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.projectProgramMgmt",defaultMessage:"Project / Program Management"}),product:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.product",defaultMessage:"Product Management"}),marketing:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.marketing",defaultMessage:"Marketing"}),sales:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.sales",defaultMessage:"Sales"}),support:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.support",defaultMessage:"Customer Service"}),finance:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.finance",defaultMessage:"Finance"}),hr:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.hr",defaultMessage:"Human Resources"}),itAdmin:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.itAdmin",defaultMessage:"IT Admin"}),knowledgeManagement:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.knowledgeManagement",defaultMessage:"Knowledge Management"}),operations:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.operations",defaultMessage:"Operations"}),educator:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.educator",defaultMessage:"Educator"}),other:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.other",defaultMessage:"Other"}),student:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.student",defaultMessage:"Student"})},f={student:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.student",defaultMessage:"Student"}),educator:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.educator",defaultMessage:"Educator"}),other:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.other",defaultMessage:"Other"})},y={docs:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.docs",defaultMessage:"Collaborate with others in docs"}),wikis:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.wikis",defaultMessage:"Create a knowledge base / wiki"}),notes:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.notes",defaultMessage:"Write notes"}),project:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.project",defaultMessage:"Manage projects"}),goals:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.goals",defaultMessage:"Track company goals and OKRs"}),ai:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.question.ai",defaultMessage:"Write with AI"}),other:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.other",defaultMessage:"Other"})},x={"1_49":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.1_49",defaultMessage:"1-49"}),"50_99":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.50_99",defaultMessage:"50-99"}),"100_299":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.100_299",defaultMessage:"100-299"}),"300_999":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.300_999",defaultMessage:"300-999"}),"1000_5000":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.1000_5000",defaultMessage:"1000-5000"}),"5000+":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.5000+",defaultMessage:"5000+"})};class v extends i.Z{renderComponent(){const{question:e,questionType:t,title:s,randomizeSelectionOrder:i,className:o,width:p,placeholder:v}=this.props,{device:S}=this.environment;let M={};"role"===t&&(M=g),"school"===t&&(M=f),"work"===t&&(M=h),"use"===t&&(M=y),"companySize"===t&&(M=x);const j={menuTitle:s,items:b(M,i,this.environment.currentUser.id),width:p||280,disabled:this.props.disabled||!1,getKey:e=>e,selectedItem:t,originGap:4,onSelect:e=>{this.props.onSelect(e)},renderItem:e=>(0,m.jsx)(l.Z,{title:M[e.key],...e,className:`${o}-${e.key}`}),renderOrigin:t=>(0,m.jsxs)(d.Z,{...t,isLarge:!0,style:{...this.getInputStyle(),...this.props.invalid&&{border:`1px solid ${n.ZP.red}`},...this.props.styles},className:o,focused:this.props.focus,children:[(0,m.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,m.jsx)(u.Z,{isMobile:S.isMobile,isSecondaryColor:!Boolean(e),children:e?M[e]:v||(0,m.jsx)(r.FormattedMessage,{defaultMessage:"Select response",id:"PersonaCollectionModal.selectQuestion.label"})})}),(0,a.s)({width:10,fill:this.theme.lightIconColor})]})};return(0,m.jsx)(c.Z,{...j},"persona")}getInputStyle(){const{device:e}=this.environment;return{backgroundColor:this.theme.whiteButtonBackground,height:e.isMobile?44:32,padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:4,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${this.theme.outlineButtonBorder}`,background:this.theme.buttonBackground}}}v.displayName="PersonaCollectionModalQuestionSelect";const S=(0,r.injectIntl)(v);function b(e,t,s){const i=Object.keys(e);if(!t)return i;const n=(0,o.yH)(s);return i.filter((e=>e!==p)).sort((()=>n()-.5)).concat(i.filter((e=>e===p)))}},46471:(e,t,s)=>{s.r(t),s.d(t,{default:()=>re});var i=s(67294),n=s(480),a=s(86628),o=s(15145),r=s(86658),l=s(15769),d=s(88437),c=s(43876),u=s(27714),m=s(73942),p=s(60651),g=s(25651),h=s(18442),f=s(45137),y=s(89101),x=s(64002),v=s(31412),S=s(14871),b=s(47307),M=s(3297),j=s(40277),w=s(75018),C=s(29974),k=s(10182),T=s(93405),I=s(72495),P=s(19037),_=s(28020),Z=s(84210),F=s(33929),A=s(80444),R=s(83212),D=s(82763),B=s(62967),L=s(81267),N=s(62466),O=s(85893);const E=(0,v.defineMessages)({whatIsNotionName:{id:"action.whatIsNotion.name",defaultMessage:"What is Notion?"},createNotionPageName:{id:"action.createNotionPage.name",defaultMessage:"Create your own Notion page"},signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},loginName:{id:"action.logIn.name",defaultMessage:"Log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate page"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"}}),V=(0,x.SK)(y._j.signup,{try_notion_cta:"mobile"}),U=(0,B.cN)({key:"Create Notion Page",displayName:E.createNotionPageName,analyticsName:E.createNotionPageName.defaultMessage,svg:p.h,validators:[P.ff(P.jl),P.ff(P.tY)],closeParentMenu:!0,action:e=>{let{environment:t}=e;w.navigateOnBaseUrl({environment:t,url:V})}}),W=(0,B.cN)({key:"log in",displayName:E.signUpOrLogInName,analyticsName:E.signUpOrLogInName.defaultMessage,svg:m.H,validators:[P.ff(P.jl)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;await w.publicPageTopBarAction(t,{utmContent:"sign_up_or_log_in",nextRoute:y._j.login})}}),K=(0,B.cN)({key:"log in",displayName:E.loginName,analyticsName:E.loginName.defaultMessage,svg:m.H,validators:[P.ff(P.jl)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;w.navigateOnBaseUrl({environment:t,url:y._j.login,extraSearchParams:await w.generatePartnerStackPathParam(t)})}}),z=(0,B.cN)({key:"ios share link",displayName:E.shareLinkName,analyticsName:E.shareLinkName.defaultMessage,svg:c.s,validators:[P.U7,P.Fx,P.gn],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const i=t[0],n=i.getNavigableBlockStore();if(n){const e=(0,Z.ZP)({store:n,scrollToBlockId:n.id===i.id?void 0:i.id,fullyQualified:!0,pageVisitSource:o.tY.NativeShareLink});s.mobileNative&&s.mobileNative.share(e)}}}),q=(0,B.cN)({key:"android share link",displayName:E.shareLinkName,analyticsName:E.shareLinkName.defaultMessage,svg:l.Q,validators:[P.U7,P.Fx,P.Dt],closeParentMenu:z.closeParentMenu,action:z.action}),G=(0,B.cs)({key:"copy link",displayName:B.RE.copyLinkName,analyticsName:B.RE.copyLinkName.defaultMessage,svg:u.N,shortcuts:["copyLinkToBlock"],validators:[P.jl,P.U7,P.ff(P.Fx),P.ff(P.DF)],closeParentMenu:!0,action:(e,t)=>{S.Hs({...e,event:t})}}),H=(0,B.cN)({key:"edit page",displayName:E.editPageName,analyticsName:E.editPageName.defaultMessage,svg:g.R,validators:[P.U7,P.DF,P.Zk,P.ff(P.eM)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;const{RouterStore:i}=t,n=i.state.route,a=_.np();if("page"===n.name&&n.requestedOnPublicDomain&&a){const e=(0,Z.ZP)({store:a,preferPublicLink:!1,pageVisitSource:o.tY.EditPublicPage});w.navigateOnBaseUrl({environment:t,url:e})}else t.currentUser.isLoggedIn()?b.showDialog({showCancel:!0,keepFocus:!1,message:(0,O.jsx)(v.FormattedMessage,{defaultMessage:"When you start editing, your name, email and photo may become visible to anyone who can view the page.",id:"action.startPublicEditDialog.message"}),items:[{label:(0,O.jsx)(v.FormattedMessage,{defaultMessage:"Continue",id:"action.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){R.Z.setState({editing:!0,commenting:!0})}}]}):(j.Hr({currentUserId:t.currentUser.id,blockId:s[0].id}),w.navigateOnBaseUrl({environment:t,url:y._j.login}))}}),Q=(0,B.cN)({key:"comment page",displayName:E.commentPageName,analyticsName:E.commentPageName.defaultMessage,svg:f.o,validators:[P.U7,P.DF,P.RF,P.ff(P.jl)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;j.Hr({currentUserId:t.currentUser.id,blockId:s[0].id}),w.navigateOnBaseUrl({environment:t,url:y._j.login})}}),Y=(0,B.cN)({key:"duplicate page",displayName:E.duplicatePageName,analyticsName:E.duplicatePageName.defaultMessage,svg:d.a,validators:[P.U7,P.tq,P.DF,P.S4],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:s,environment:i}=e;M.S({environment:i,store:t[0],originRect:s})}}),$=(0,B.cN)({key:"back to my content",displayName:E.backtoNotionName,analyticsName:E.backtoNotionName.defaultMessage,svg:p.h,validators:[P.jl,P.tq],closeParentMenu:!0,action:(e,t)=>{let{environment:s}=e;const{currentUserRootStore:i,currentUserSettingsStore:n}=A.default.state;i&&n&&C.L5({environment:s,userRootStore:i,userSettingsStore:n,pageVisitSource:o.tY.SwitchSpace})}}),J=(0,B.cN)({key:"cookie settings",displayName:r.ze.cookieSettingsLabel,analyticsName:r.ze.cookieSettingsLabel.defaultMessage,validators:[P.ff(P.tY)],closeParentMenu:!1,render:e=>(0,O.jsx)(k.Z,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:s,...i}=e;return(0,O.jsx)(T.Z,{...i,...t,title:F.default.formatMessage(r.ze.cookieSettingsLabel),svg:h.H})}}),action:()=>{}}),X=(0,B.cN)({key:"What is Notion?",displayName:E.whatIsNotionName,analyticsName:E.whatIsNotionName.defaultMessage,svg:p.h,validators:[P.ff(P.jl),P.ff(P.tY)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;await w.publicPageTopBarAction(t,{utmContent:"what_is_notion",nextRoute:y._j.product})}}),ee=[(0,B.$J)({key:"page",render:e=>(0,O.jsx)(I.Z,{...e}),actions:[U,N.y,K,H,Q,Y,G,D.K,z,q,$,L.l,J]})],te=[(0,B.$J)({key:"page",render:e=>(0,O.jsx)(I.Z,{...e}),actions:[X,H,Q,Y,G,D.K,z,q]}),(0,B.$J)({key:"user",render:e=>(0,O.jsx)(I.Z,{...e}),actions:[$,W]}),(0,B.$J)({key:"report page actions",render:e=>(0,O.jsx)(I.Z,{...e}),actions:[L.l,J]})];var se=s(50906),ie=s(87279),ne=s(35328),ae=s(48019),oe=s(78140);const re=function(e){let{block:t,onDismiss:s}=e;window.__c={n:"PublicTopbarMoreMenu"};const o=(0,n.O7)(),{currentUser:r,device:l}=o,d=Boolean(r.isLoggedIn()||o.publicDomainUserId),c=(0,a.VK)((()=>R.Z.getMode(o,t)),[o,t]),u={environment:o,blocks:[t],publicEditMode:c};let m;m=l.isMobile?{menuType:ie.og.ActionSheet}:{menuType:ie.og.Popup,width:210,maxHeight:"80vh"};const p=(0,i.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=A.default.state;if(t){const s=t.getType();s&&se.dhV(o,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:t.id,block_type:s,is_toggleable:(0,ne._A)(s,t.getFormat())})}e.closeParentMenu&&s()}),[o,s]),g=!d&&l.isMobile?ee:te;return(0,O.jsx)(oe.Z,{...m,children:(0,O.jsx)(ae.Z,{sections:g,onAccept:p,context:u})})}},76351:(e,t,s)=>{s.r(t),s.d(t,{default:()=>A});s(67294);var i=s(83355),n=s(8848),a=s(66226),o=s(31412);const r=(0,o.defineMessages)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"}});var l=s(7250),d=s(82990),c=s(54642),u=s(47307),m=s(360),p=s(28020),g=s(33929),h=s(87279),f=s(18514),y=s(88632),x=s(25399),v=s(36488),S=s(74194),b=s(78140),M=s(28992),j=s(32163),w=s(17293),C=s(63296),k=s(72495),T=s(92660),I=s(74523),P=s(6202),_=s(85893);const Z=(0,o.defineMessages)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Add additional information (optional)"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});class F extends i.Z{constructor(){super(...arguments),this.handleCancel=()=>{m.q()},this.renderContent=()=>{const{device:e}=this.environment;if(!y.Z.state.online)return this.renderOffline();const t=x.Z.state;return t.open?e.isMobile?this.renderMobileModal(t):this.renderDesktopModal(t):void 0},this.onSubmit=async()=>{const e=this.environment,t=x.Z.getState();if(!t.open)return;const{additionalInformation:s,reason:i}=t,n=(0,p.Fv)();if(!i||null==n||!n.id)return void u.showErrorMessage((0,_.jsx)(o.FormattedMessage,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const r=await(d=(0,l.OP)(),c.reportPage(e,{reason:i,page:n,intercomVisitorId:d,additionalInformation:s}));var d;"failed"===r.type?u.showError(r):(x.Z.setState({open:!1}),u.showMessage({message:(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,a.X)({width:40}),(0,_.jsx)("div",{style:{paddingTop:12,paddingBottom:8,fontSize:"large",textAlign:"center"},children:(0,_.jsx)(o.FormattedMessage,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})})}))},this.modalTitleStyle={fontSize:16,marginBottom:12,fontWeight:d.Z.fontWeight.medium}}renderComponent(){return(0,_.jsx)(T.Z,{ariaLabel:g.default.formatMessage(Z.dialogLabel),onDismiss:this.handleCancel,render:this.renderContent,requireOnline:!0,modalStore:x.Z})}renderMobileModal(e){if(!e.open)return;const{reason:t}=e,s={menuType:h.og.Modal,title:(0,_.jsx)(o.FormattedMessage,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,_.jsx)(o.FormattedMessage,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return(0,_.jsx)(b.Z,{...s,children:(0,_.jsx)(j.Z,{type:j.i.Vertical,initialFocus:void 0,sections:[{key:"help",render:e=>{let{children:t,...s}=e;return(0,_.jsx)(k.Z,{...s,children:t})},items:[{key:"help",render:()=>(0,_.jsx)(M.Z,{title:(0,_.jsx)(I.Z,{title:(0,_.jsx)(o.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,f.UY)("contentPolicy"),analyticsFrom:"report_page"}),right:(0,_.jsx)(_.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...s}=e;return(0,_.jsx)(k.Z,{...s,children:t})},items:[{key:"options",render:()=>(0,_.jsx)(D,{modalState:e}),action:()=>{}},{key:"additionalInfo",render:()=>t&&(0,_.jsx)(S.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:g.default.formatMessage(Z.additionalInformationPlaceholder),onChange:t=>{x.Z.setState({...e,additionalInformation:t.target.value})}}),action:()=>{}}]},{key:"actions",render:e=>{let{children:t,...s}=e;return(0,_.jsx)(k.Z,{isSubmitButton:!0,...s,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...s}=e;return(0,_.jsx)(P.Z,{...s,disabled:!R(),title:(0,_.jsx)("div",{style:{color:n.ZP.red},children:(0,_.jsx)(o.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||this.onSubmit})},action:this.onSubmit}]}]},"main list")})}renderDesktopModal(e){if(!e.open)return;const{reason:t}=e;return(0,_.jsx)(v.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,_.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,_.jsx)("div",{style:this.modalTitleStyle,children:(0,_.jsx)(o.FormattedMessage,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,_.jsx)("div",{style:{paddingBottom:12},children:(0,_.jsx)(I.Z,{title:(0,_.jsx)(o.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,f.UY)("contentPolicy"),analyticsFrom:"report_page"})}),(0,_.jsx)("div",{children:(0,_.jsx)(D,{modalState:e})}),t&&(0,_.jsx)(S.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:g.default.formatMessage(Z.additionalInformationPlaceholder),onChange:t=>{x.Z.setState({...e,additionalInformation:t.target.value})}}),(0,_.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,_.jsx)(C.Z,{isLarge:!0,onClick:this.handleCancel,style:{marginRight:12},children:(0,_.jsx)(o.FormattedMessage,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,_.jsx)(C.Z,{isRed:!0,isLarge:!0,onClick:this.onSubmit,disabled:!R(),disabledFeedback:!0,children:(0,_.jsx)(o.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}renderOffline(){return(0,_.jsx)("div",{style:this.getOfflineStyle(),children:(0,_.jsx)(o.FormattedMessage,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}getOfflineStyle(){return{width:360,padding:24,fontSize:14,color:this.theme.mediumTextColor}}getTextAreaStyle(){const{device:e}=this.environment;return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:e.isMobile?16:"10px 12px",height:e.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:e.isMobile?16:14}}}F.displayName="ReportPageModal";const A=F;function R(){const{state:e}=x.Z;if(e.open){const{reason:t}=e;return void 0!==t}return!1}function D(e){let{modalState:t}=e;const{reason:s}=t;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(w.Z,{title:(0,_.jsx)(o.FormattedMessage,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===s,onClick:()=>x.Z.setState({...t,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,_.jsx)(w.Z,{title:g.default.formatMessage(r.inappropriate_content),isSelected:"inappropriate_content"===s,onClick:()=>x.Z.setState({...t,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,_.jsx)(w.Z,{title:(0,_.jsx)(o.FormattedMessage,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===s,onClick:()=>x.Z.setState({...t,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}},18878:(e,t,s)=>{s.d(t,{mX:()=>f,mo:()=>g,nH:()=>h});s(67294);var i=s(86628),n=s(24405),a=s(27006),o=s(97880),r=s(82990),l=s(31412),d=s(34859),c=s(80444),u=s(53336),m=s(63381),p=s(85893);function g(e){window.__c={n:"RestorePermissionEdits"};const{openState:t}=e,{mainEditorCurrentBlockStore:s,currentSpaceStore:a}=(0,i.VK)((()=>c.default.state),[]),o=(0,n.yK)((e=>({scroller:{display:"flex",flexDirection:"column",maxHeight:290},editContainer:{marginTop:2,marginBottom:2,color:e.regularTextColor}})),[]);if(!s||!a)return null;const r=Date.now();return(0,p.jsx)(u.Z,{type:d.Z.Y,style:o.scroller,children:t.permissionChanges.map(((e,t)=>{let[i,n]=e;const l={timestamp:r,space_id:a.id,type:"permission-changed",permission_data:{before:i,after:n}};return(0,p.jsx)("div",{style:o.editContainer,children:(0,p.jsx)(m.Z,{rootStore:s,edit:l})},`${i.type}-${t}`)}))})}function h(e){return["remove","restrict"].includes(e.type)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restrictAccess",defaultMessage:"Restrict access"}):"restoreTeamPermissions"===e.type?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreTeamPermissions",defaultMessage:"Reset Permissions"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreAccess",defaultMessage:"Restore access"})}function f(e){switch(e.type){case"remove":return(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restrict.description",defaultMessage:"Are you sure you want to remove this {permissionGroup} and restrict access? This page will no longer inherit share settings from the parent page.",values:{permissionGroup:y(e)}});case"restrict":return(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.remove.description",defaultMessage:"Are you sure you want to change this role and restrict access? This page will no longer inherit share settings from the parent page."});case"restore":return e.permissionChanges.length>0?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restore.description",defaultMessage:"Are you sure you want to restore access? This will inherit the following permissions from the parent page:"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreNoChanges.description",defaultMessage:"Are you sure you want to restore access?"});case"restoreTeamPermissions":return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{style:{fontWeight:r.Z.fontWeight.semibold,marginBottom:4},children:(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.mainDescription",defaultMessage:"Are you sure you want to reset permissions to match the teamspace defaults?"})}),(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.warningMessage",defaultMessage:"Everyone else who is not part of the teamspace will lose access, including guests."})]});default:throw o.t1(e)}}function y(e){return(0,a.jg)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.user",defaultMessage:"user"}):(0,a.hV)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.group",defaultMessage:"group"}):(0,a.ix)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.space",defaultMessage:"workspace"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.generic",defaultMessage:"permission"})}},18168:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var i=s(24405),n=s(64921),a=s(85893);function o(e){window.__c={n:"SegmentedItemView"};const{isFirst:t,isLast:s,isSelected:o,item:r,itemStyle:l,innerStyle:d,children:c,colors:u,onClick:m}=e,{isDisabled:p}=r,g=(0,i.yK)((e=>{const i=(null==u?void 0:u.selectedOutline)??e.blueColor,n=(null==u?void 0:u.unselectedOutline)??e.accentColors.gray[100];return{SegmentedItem:{alignItems:"center",background:o?null==u?void 0:u.selectedBackground:void 0,borderBottomLeftRadius:t?3:0,borderBottomRightRadius:s?3:0,borderColor:o?i:n,borderStyle:"solid",borderTopLeftRadius:t?3:0,borderTopRightRadius:s?3:0,borderWidth:1,cursor:p?void 0:"pointer",display:"flex",flexBasis:"50%",marginLeft:t?0:-1,padding:0,userSelect:"none",zIndex:o?10:0,...l},Inner:{borderBottomLeftRadius:t?2:0,borderBottomRightRadius:s?2:0,borderColor:o?i:"transparent",borderStyle:"solid",borderTopLeftRadius:t?2:0,borderTopRightRadius:s?2:0,borderWidth:1,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",padding:"12px 20px",textAlign:"center",width:"100%",...d}}}),[null==u?void 0:u.selectedBackground,null==u?void 0:u.selectedOutline,null==u?void 0:u.unselectedOutline,t,s,o,p,l,d]);return(0,a.jsx)(n.Z,{ariaLabel:r.ariaLabel,"aria-pressed":o,onClick:()=>{m&&m(r.key)},style:g.SegmentedItem,disabled:p,children:(0,a.jsx)("div",{style:g.Inner,children:c})})}function r(e){window.__c={n:"SegmentedButton"};const{items:t=[],itemStyle:s,innerStyle:n,value:r,onChange:l,colors:d}=e,c=(0,i.yK)((e=>({SegmentedButton:{background:e.cardContentBackground,display:"flex",width:"100%"}})),[]);return 0===t.length?null:(0,a.jsx)("div",{style:c.SegmentedButton,children:t.map(((e,i)=>(0,a.jsx)(o,{isFirst:0===i,isLast:i===t.length-1,isSelected:e.key===r,item:e,itemStyle:s,innerStyle:n,colors:d,onClick:l,children:e.render()},e.key)))})}},40424:(e,t,s)=>{s.d(t,{Z:()=>se});s(57658);var i=s(43261),n=s.n(i),a=s(67294),o=s(83355),r=s(480),l=s(99036),d=s(80951),c=s(84619),u=s(72126),m=s(4615),p=s(71644),g=s(6287),h=s(3791),f=s(31412),y=s(50906),x=s(66890),v=s(75079),S=s(78316),b=s(19124),M=s(87279),j=s(77080),w=s(29798),C=s(49085);class k extends C.default{getInitialState(){return{inputValue:"",openPropertyActionMenu:void 0}}}const T=k;var I=s(78291),P=s(86628),_=s(24405),Z=s(11751),F=s(54642),A=s(99417),R=s(4023),D=s(64921),B=s(36596),L=s(72495),N=s(22084),O=s(85893);function E(e){window.__c={n:"SelectPropertyMenuAiSuggestionSection"};const{menuArgs:t,environment:s,store:i,property:n,propertySchema:o,addNewTokens:r}=e,[l,d]=(0,a.useState)(!1),[p,g]=(0,a.useState)([]),h=(0,_.Fg)();(0,a.useEffect)((()=>{if(0===p.length){d(!0);const e=(0,m.ZP)();F.publishAiSession(s,{inference_type:"autofill",id:e,metadata:{is_select_property_menu:!0}}),F.getCompletionForSelectOption(s,{blockPropertyPointer:{...i.pointer,spaceId:i.getSpaceId(),propertyId:n},collectionId:i.getParentId()??"",model:(0,A.PD)(),aiSessionId:e}).then((e=>{"success"===e.type&&"success"===e.data.type&&(d(!1),g(e.data.completion.split(",")))}))}}),[s,n,o,i,p.length]);const y=(0,P.VK)((()=>(0,u.oA)(p.map((e=>{var t;return null===(t=o.options)||void 0===t?void 0:t.find((t=>t.value===e))})))),[o.options,p]),x=()=>(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",color:h.accentColors.purple[400]},children:[(0,Z.t)({width:16,height:16,fill:h.accentColors.purple[400],marginRight:5}),(0,O.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.aiSuggestionSectionTitle",defaultMessage:"AI suggested"})]});return l?(0,O.jsx)(L.Z,{...t,title:x(),children:(0,O.jsx)("div",{style:{display:"flex",flexDirection:"row",maxWidth:"100%",overflow:"clip"},children:[...Array("select"===o.type?1:4)].map(((e,t)=>(0,O.jsx)(B.Z,{style:{width:100,height:24,marginLeft:0===t?20:10,borderRadius:4}},t)))})}):y.length>0?(0,O.jsx)(L.Z,{...t,title:x(),right:y.length>1?(0,O.jsx)(D.Z,{style:{color:h.blueColor},onClick:()=>{r(p)},children:(0,O.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.aiSuggestionSectionTitle.addAllButton",defaultMessage:"Add all"})}):null,children:(0,O.jsx)("div",{className:"hide-scrollbar",style:{display:"flex",flexDirection:"row",maxWidth:"100%",overflow:"scroll"},children:y.map(((e,t)=>(0,O.jsx)(D.Z,{style:{display:"flex",marginLeft:0===t?20:10,textAlign:"center",borderRadius:4},hoveredStyle:{display:"flex"},onClick:()=>{r([e.value])},children:(0,O.jsx)(N.a,{format:s.device.isMobile?c.lo.Large:c.lo.Medium,value:e.value,color:e.color,descriptionTooltip:e.description,tooltipPlacement:R.u.Left,showRemoveButton:!1,isSingle:!0,showEllipsis:!0})},t)))})}):(0,O.jsx)(O.Fragment,{})}var V=s(52275),U=s(79131),W=s(78140),K=s(32163),z=s(43765),q=s(40721),G=s(12534),H=s(33846),Q=s(24736),Y=s(3386),$=s(73456);class J extends o.Z{constructor(){super(...arguments),this.storeTypes={renameInputStore:H.Z},this.renderActionMenuButton=()=>{const{property:e,collectionId:t,analyticsFrom:s,onChange:i,onCloseActionMenu:n,actionMenuOpen:a,focused:o,option:r,propertySchema:l}=this.props,{device:d}=this.environment;return(0,O.jsx)($.Z,{open:a,origin:(0,O.jsx)(Q.Z,{onClick:this.handleActionButtonClick,isMobile:d.isMobile,style:{opacity:o||d.isMobile?1:0}}),option:r,propertySchema:l,property:e,collectionId:t,analyticsFrom:s,onChange:i,onClose:n})},this.handleActionButtonClick=e=>{(0,G.ZP)({event:e,context:G.Af.MenuListClick,callback:()=>this.props.onOpenActionMenu(this.props.option.value)})}}willMountOrUpdate(e){e.actionMenuOpen&&!this.props.actionMenuOpen&&this.stores.renameInputStore.setState({...this.stores.renameInputStore.state,inputValue:this.props.option.value})}renderComponent(){const{locked:e,option:t}=this.props;return(0,O.jsx)(Y.Z,{capture:this.props.actionMenuOpen,onEnter:u.yR,children:(0,O.jsx)(V.Z,{...this.props,title:(0,O.jsx)(N.a,{format:this.environment.device.isMobile?c.lo.Large:c.lo.Medium,value:t.value,color:t.color,descriptionTooltip:t.description,tooltipPlacement:R.u.Left,showRemoveButton:!1,isSingle:!0,showEllipsis:!0}),desktopTitleStyle:{marginRight:6},isTokenTitle:!0,right:!e&&this.renderActionMenuButton()})})}}J.displayName="SelectPropertyMenuItem",J.contextTypes={...M.mw,...o.w};const X=J;var ee=s(47082);class te extends o.Z{constructor(){super(...arguments),this.storeTypes={store:T,menuListStore:w.Z},this.handleSelectPropertyMenuItemChange=e=>{const{property:t,schema:s}=this.props,i=s[t];if(!i)return;if(!l.cu(i))return;const n=i.options||[],a=[...n],o={},r=this.props.value.filter((e=>{const t=n.find((t=>t.value===e));return!t||a.some((e=>e.id===t.id))}));o.operations=e,u.Xy(r,this.props.value)||(o.value=r),this.props.onChange(o)},this.handleCloseActionMenu=()=>{this.stores.store.setState({...this.stores.store.state,openPropertyActionMenu:void 0})},this.handleOpenActionMenu=e=>{this.stores.store.setState({...this.stores.store.state,openPropertyActionMenu:e})},this.handleTokenInputChange=e=>{this.stores.store.setState({...this.stores.store.state,inputValue:""});const{collectionId:t,allowMultiple:s,property:i,schema:n,onChange:a,analyticsFrom:o}=this.props,r=n[i];if(!r)return;if(!l.cu(r))return;const d=r.options||[];let c;c=s?e:e.length>0?[e[e.length-1]]:[];const p=u.jj(u.oA(c.map((e=>{const t=d.find((t=>t.value===e));if(t)return t.value})))),h=c.find((e=>!d.find((t=>t.value===e)))),f={value:p.concat(u.oA([h]))};if(h){const e={id:(0,m.ZP)(),value:h,color:this.createSelectColor};let s;s="alphabetical"!==r.auto_sort_options&&"reverse_alphabetical"!==r.auto_sort_options||!j.default.checkGate("collection_properties_select_auto_sort_options")?[{pointer:{table:g.v,id:t},command:"keyedObjectListAfter",path:["schema",i,"options"],args:{value:e}}]:[(0,S.Ch)({collectionId:t,property:i,propertySchema:r,newOption:e,isAscending:"alphabetical"===r.auto_sort_options})],f.operations=s,this.setRandomCreateSelectColor(),y.$qu(this.environment,{...(0,v.Pn)(this.context.collectionContextStore),property_type:r.type,action:"select_add_option",from:o})}a(f)},this.handleDraggableListDrop=e=>{const{collectionId:t,property:s,schema:i,onChange:n}=this.props,a=(0,S.YL)({newOptions:e,collectionId:t,property:s,schema:i});if(a){const e=i[s];if(e&&l.cu(e)){"manual"!==(e.auto_sort_options||"manual")&&a.push({pointer:{table:g.v,id:t},command:"update",path:["schema",s],args:{auto_sort_options:"manual"}})}n({operations:a})}this.stores.menuListStore.reset()}}willMount(e){if(this.setRandomCreateSelectColor(),e.insertChar){const t=e.insertChar;this.stores.store.setState({...this.stores.store.state,inputValue:t})}}renderComponent(){const{device:e}=this.environment,{disabled:t,canConfigureCollection:s}=this.props,i=this.props.schema[this.props.property];if(!i)return;if(!l.cu(i))return;const a=i.options||[],o=this.renderCurrentTokens(a),r=function(e,t,s){const i=t.map((e=>e.value));let a;if(e){a=n().filter(e,i).map((e=>e.original));!t.find((t=>t.value===e))&&e.trim().length>0&&s&&a.push(e.trim().replace(/,/g,""))}else a=i;return a}(this.stores.store.state.inputValue,a,this.props.canConfigureCollection),d=0===r.length,c=(0,O.jsx)(ee.Z,{focus:e.isMobile?void 0:!this.stores.store.state.openPropertyActionMenu,focusAfterAnimation:!0,format:ee.Z.Format.Select,tokens:o,placeholder:this.props.intl.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:()=>{this.handleTokenInputChange(this.props.value.slice(0,this.props.value.length-1))},value:this.stores.store.state.inputValue,disabled:t,hideInput:t,onChange:e=>this.stores.store.setState({...this.stores.store.state,inputValue:e.target.value}),dontShowBorderBottom:e.isAndroid});let u;return u=e.isMobile?{menuType:M.og.Modal,title:i.name,right:(0,O.jsx)(q.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:c}:{menuType:M.og.Popup,header:c,tokenInputHeader:!0},t?(0,O.jsx)(W.Z,{...u}):(0,O.jsx)(W.Z,{...u,children:d?(0,O.jsx)(L.Z,{title:s?(0,O.jsx)(ae,{}):(0,O.jsx)(ie,{}),children:e.isMobileNative&&(0,O.jsx)(z.Z,{title:(0,O.jsx)(ie,{})})}):(0,O.jsx)(K.Z,{type:K.i.Vertical,initialFocus:this.stores.store.state.inputValue.length>0?0:void 0,sections:[{key:0,render:e=>this.renderAiSuggestionSection(e),items:[]},{key:1,render:e=>this.renderMenuListSection(e,r),items:this.getSelectMenuListItems(r,a)}],onAccept:(e,t,s)=>{this.props.onAccept(s)},store:this.stores.menuListStore})})}renderAiSuggestionSection(e){var t;const s=(null===(t=I.default.state.data)||void 0===t?void 0:t.addOns)??[];if(!(0,h.de)(s)||!(0,b.KZ)()||!(0,b.q)())return;const i=this.props.schema[this.props.property];return i&&l.cu(i)?(0,O.jsx)(E,{menuArgs:e,environment:this.environment,property:this.props.property,propertySchema:i,store:this.props.blockStore,addNewTokens:e=>{this.handleTokenInputChange([...this.props.value,...e])}}):void 0}renderMenuListSection(e,t){const{canConfigureCollection:s}=this.props;return s?(0,O.jsx)(L.Z,{...e,title:(0,O.jsx)(ae,{}),children:(0,O.jsx)(U.ZP,{direction:"vertical",keys:t,renderKey:s=>e.children[t.indexOf(s)],onDrop:this.handleDraggableListDrop})}):(0,O.jsx)(L.Z,{...e,title:(0,O.jsx)(ne,{}),children:e.children})}renderFoundSelectPropertyMenuItem(e,t){const{schema:s,property:i}=this.props,n=s[i];if(n&&l.cu(n))return(0,O.jsx)(X,{...e,option:t,showDragHandle:this.props.canConfigureCollection,locked:!this.props.canConfigureCollection,property:this.props.property,analyticsFrom:this.props.analyticsFrom,collectionId:this.props.collectionId,onChange:this.handleSelectPropertyMenuItemChange,actionMenuOpen:this.stores.store.state.openPropertyActionMenu===t.value,propertySchema:n,onCloseActionMenu:this.handleCloseActionMenu,onOpenActionMenu:this.handleOpenActionMenu})}getSelectMenuListItems(e,t){return e.map((e=>{const s=t.find((t=>t.value===e));return{key:e,render:t=>{if(s)return this.renderFoundSelectPropertyMenuItem(t,s);{const s={id:(0,p.ZP)(),value:e,color:this.createSelectColor};return(0,O.jsx)(oe,{props:t,newOption:s,token:e})}},action:()=>{this.handleTokenInputChange([...this.props.value,e])}}}))}renderCurrentTokens(e){const{disabled:t}=this.props,{device:s}=this.environment;return u.oA(this.props.value.map((i=>{const n=(0,d.i7)(e,i);if(n)return(0,O.jsx)(N.a,{value:n.value,color:n.color,showRemoveButton:!t,isSingle:!1,format:s.isMobile?c.lo.Large:c.lo.Medium,shouldShrink:!0,onClickRemove:()=>{this.handleTokenInputChange(this.props.value.filter((e=>e!==i)))},showEllipsis:!0},n.id)})))}setRandomCreateSelectColor(){const{schema:e,property:t}=this.props,s=e[t];if(!s)return;if(!l.cu(s))return;const i=s.options||[],n=(0,l.TL)(i);this.createSelectColor=n}}te.displayName="SelectPropertyMenu",te.contextTypes={...o.w,...x.xm};const se=(0,f.injectIntl)(te);function ie(){return(0,O.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}function ne(){return(0,O.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}function ae(){return(0,O.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}function oe(e){let{props:t,newOption:s,token:i}=e;window.__c={n:"CreateSelectPropertyMenuItem"};const n=(0,r.O7)(),{device:a}=n;return(0,O.jsx)(V.Z,{...t,title:(0,O.jsxs)("div",{style:{display:"flex",minWidth:0},children:[(0,O.jsx)("div",{style:{marginRight:6,lineHeight:1.3},children:(0,O.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})}),(0,O.jsx)(N.a,{value:s.value,color:s.color,showRemoveButton:!1,isSingle:!0,format:a.isMobile?c.lo.Large:c.lo.Medium,showEllipsis:!0})]}),isTokenTitle:!0})}},77376:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var i=s(67294),n=s(480),a=s(86628),o=s(31412),r=s(41363),l=s(50906),d=s(75079),c=s(78316),u=s(87279),m=s(18514),p=s(35328),g=s(27724),h=s(13713),f=s(80209),y=s(48019),x=s(68894),v=s(78140),S=s(72495),b=s(83182),M=s(85893);const j=(0,o.defineMessages)({filterActions:{defaultMessage:"Search actions…",id:"selectableHoverMenu.filterActions.placeholder"}});function w(e){window.__c={n:"SelectableHoverMenuPopup"};const{hasEditorPermissions:t,isWorkspaceAdmin:s,store:o,onDismiss:m,containerRef:x,query:S,setQuery:b}=e,j=(0,n.O7)(),w=(0,n.MO)(),T=(0,a.VK)((()=>{var e;return{environment:j,blocks:g.default.state.stores.length?g.default.state.stores:[o],originRect:null===(e=x.current)||void 0===e?void 0:e.getBoundingClientRect(),publicEditMode:void 0}}),[j,o,x]),I=(0,a.VK)((()=>o.isNavigableAncestorLocked()),[o]),[P,_]=(0,i.useState)(void 0),Z=(0,i.useCallback)((e=>{const t=g.default.state.stores[0],s=t.getType();if(s){const i=(0,c.fm)(t),n=(0,d.Pn)(i)||{};l.dhV(j,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"selection_menu",block_id:t.id,block_type:s,is_toggleable:(0,p._A)(s,t.getFormat()),...n})}e.closeParentMenu&&m()}),[j,m]),F=(0,a.VK)((()=>o.isCollectionView()),[o]),A=!w&&t&&!I&&(0,M.jsx)(C,{filter:S,setQuery:b,comboboxAriaProps:P});let R;return R=w?{menuType:u.og.ActionSheet,header:A}:{menuType:u.og.Popup,width:265,header:A},(0,M.jsxs)(v.Z,{...R,children:[(0,M.jsx)(y.Z,{filter:S,initialFocus:S?0:void 0,sections:r.Qi,context:T,onAccept:Z,setComboboxAriaProps:_}),!S&&(t||s)&&(0,M.jsx)(h.Z,{store:o,isPageMoreButton:!1,hideTopBorder:!1}),!S&&(0,M.jsx)(f.Z,{store:o}),!S&&F&&(0,M.jsx)(k,{})]})}function C(e){window.__c={n:"SelectableHoverMenuHeader"};const{filter:t,setQuery:s,comboboxAriaProps:i,title:a}=e,r=(0,n.Fy)(),l=(0,o.useIntl)();return(0,M.jsx)(S.Z,{isInput:!a,title:a,children:(0,M.jsx)(x.ZP,{value:t,onChange:e=>s(e.target.value),focus:!r.isMobile||void 0,focusAfterAnimation:!0,placeholder:l.formatMessage(j.filterActions),preventCaptureDeleteWhenEmpty:!0,preventCaptureClipboardShortcuts:!0,...i})})}function k(){return(0,M.jsx)(S.Z,{topBorder:!0,children:(0,M.jsx)(b.Z,{title:(0,M.jsx)(o.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.hoverBlockMenu.collectionHelpButton"}),href:(0,m.UY)("guides.database"),analyticsFrom:"selectable_hover_menu"})})}},30761:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});s(67294);var i=s(480),n=s(24405),a=s(50506),o=s(38493),r=s(85893);function l(e){window.__c={n:"SidebarConnectionsModal"};const t=(0,i.Fy)(),s=(0,n.yK)((e=>({modal:{width:t.isMobile?"auto":890,height:t.isMobile?"auto":606,borderRadius:8}})),[t.isMobile]);return(0,r.jsx)(a.Z,{open:e.modalOpened,innerStyle:s.modal,onDismiss:e.onModalClose,render:()=>(0,r.jsx)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:(0,r.jsx)(o.Z,{location:"sidebar-modal"})})})}},51779:(e,t,s)=>{s.r(t),s.d(t,{MembersTabTitle:()=>cs,PeopleRow:()=>ls,SettingToggle:()=>us,SidebarTeamModal:()=>ds});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(72126),l=s(97880),d=s(82990),c=s(31412),u=s(50906),m=s(1865),p=s(43250),g=s(95697),h=s(55838),f=s(80444),y=s(26350),x=s(86232),v=s(43488),S=(s(57658),s(8848)),b=s(10254),M=s(64964),j=s(39699),w=s(42922),C=s(36488),k=s(74194),T=s(26388),I=s(64369),P=s(33929),_=s(78122),Z=s(4023),F=s(9867),A=s(73365),R=s(56187);function D(e){return!(0,R.q)(e)}var B=s(97082),L=s(64552),N=s(8787),O=s(80068),E=s(74016),V=s(80993),U=s(38755),W=s(60701),K=s(85893);const z=(0,c.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),q=(0,c.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function G(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsPermissionCard"};const s=(0,o.yK)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),[i,n]=(0,a.AF)(h.Z),r=h.a.Members,l=(0,a.VK)((()=>t.getTeamAccessLevel()),[t]);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{style:s.spacer}),(0,K.jsx)(V.Ph,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,K.jsx)(W._,{currentAccessLevel:l,teamStore:t,disabledWithRightChevron:!0,style:s.accessLevelButton},"visibility"),(0,K.jsx)(H,{teamStore:t},"permissions")],onClick:()=>{i.open&&n({...i,tab:r})},itemStyle:s.listItem})]})}function H(e){let{teamStore:t}=e;window.__c={n:"PermissionsRow"};const s=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),i=(0,n.O7)(),r=(0,o.yK)((e=>({label:{color:e.regularTextColor,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,a.VK)((()=>t.getTeamPermission()||{type:"team_permission",role:"none"}),[t]),d=(0,a.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,a.VK)((()=>{if(!s)return{spaceIcon:void 0,spaceName:void 0};const e=(0,U.rn)(i,s);return{spaceIcon:(0,K.jsx)(E.p,{disabled:!0,store:s,size:20,style:r.icon}),spaceName:e}}),[s,i,r.icon]),m=(0,a.VK)((()=>(0,K.jsx)(E.p,{disabled:!0,store:t,size:20,style:r.icon})),[t,r.icon]),p=!(l.role===d.role),g=p?m:c,h=P.default.formatMessage(q[d.role],{showTeam:p,spaceName:u}),y=P.default.formatMessage(z[l.role]);return(0,K.jsxs)("div",{style:r.row,children:[g,(0,K.jsxs)(I.Z,{isSmall:!0,style:r.label,children:[p&&(0,K.jsxs)(K.Fragment,{children:[y,(0,K.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),h]})]})}var Q=s(52867),Y=s(89728),$=s(91718),J=s(11628),X=s(42853),ee=s(27006),te=(s(59730),s(26825));const se=["none","reader","comment_only","read_and_write","editor"],ie=["reader","comment_only","read_and_write"],ne=["reader","comment_only","read_and_write","editor"],ae=["editor"];function oe(e){const t=function(e){var t,s;let{teamId:i,permissions:n}=e;const a=(null===(t=n.find((e=>(0,ee.ix)(e))))||void 0===t?void 0:t.role)??"none",o=(null===(s=n.find((e=>(0,ee.zU)(e)&&e.team_id===i)))||void 0===s?void 0:s.role)??a,r=n.find((e=>(0,ee.bm)(e)));return{spacePermission:{type:"space_permission",role:a},teamMemberPermission:{type:"explicit_team_permission",team_id:i,role:o},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:i,role:"editor"},...r&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:i,role:r.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:s,teamMemberPermission:i}=t,n={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},a={spacePermission:le({roles:se,currentRole:i.role}),teamGuestPermission:ie,teamMemberPermission:re({roles:ne,currentRole:s.role}),teamOwnerPermission:ae},{visibility:o,space_member_join_access:r}=e.settings;return"team_members"===o&&(n.space_member_join_access=["invite_only"],a.spacePermission=["none"]),"self_join"===r&&(n.visibility=["space_members"],n.invite_access=["team_members"],a.spacePermission=a.spacePermission.filter((e=>"none"!==e))),e.is_default&&(a.teamMemberPermission=[i.role],a.spacePermission=[i.role]),{settingsOptions:n,permissionItemRoleOptions:a,currentTeamPermissionItems:t}}function re(e){let{roles:t,currentRole:s}=e;return t.filter((e=>(0,te.IF)(e,s)))}function le(e){let{roles:t,currentRole:s}=e;return t.filter((e=>(0,te.SL)(e,s)))}var de=s(52275),ce=s(31945),ue=s(78140),me=s(32163),pe=s(72495),ge=s(24006),he=s(4708),fe=s(87279),ye=s(98742);function xe(e){let{teamStore:t}=e;window.__c={n:"TeamSecuritySection"};const{teamSettings:s,isInviteToggleVisible:i}=(0,a.VK)((()=>({teamSettings:t.getSettingsStore().getValue(),isInviteToggleVisible:(0,he.s$)()})),[t]),n=(0,a.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return oe({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!s||!n)return null;const o=[(0,K.jsx)(Se,{teamStore:t,hasMultiInviteAccessOptions:1===n.settingsOptions.invite_access.length,inviteAccess:s.invite_access},"invite"),(0,K.jsx)(ve,{teamStore:t,disablePageEdits:s.disable_team_page_edits},"editSidebar")];return i&&o.push((0,K.jsx)(be,{teamStore:t},"toggleInviteLink")),(0,K.jsx)(V.Ph,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:o,hideDividers:!0})}function ve(e){window.__c={n:"EditSidebarPermissionRow"};const{teamStore:t,disablePageEdits:s}=e,o=(0,n.O7)(),r=D(t),l=(0,a.VK)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),d=(0,i.useCallback)((e=>{j.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:o,perform:s=>{F.$x({environment:o,store:t,update:{disable_team_page_edits:e},transaction:s})}})}),[o,t]),u=(0,ee.J5)(l),m=[{option:!0,label:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d(!0)}];return u&&m.push({option:!1,label:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d(!1)}),(0,K.jsx)(Me,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:r||!u,currentOption:!u||Boolean(s),allOptions:m,optionTooltip:u?void 0:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function Se(e){window.__c={n:"InvitePermissionRow"};const{teamStore:t,hasMultiInviteAccessOptions:s,inviteAccess:a}=e,o=(0,R.q)(t),r=(0,n.O7)(),l=(0,i.useCallback)((e=>{j.createAndCommit({userAction:"team.setInviteAccess",environment:r,perform:s=>{F.$x({environment:r,store:t,update:{invite_access:e},transaction:s})}})}),[r,t]),d=!o||s;return(0,K.jsx)(Me,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite teamspace members"}),disabled:d,optionTooltip:d&&o&&(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:a,allOptions:[{option:"team_members",label:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>l("team_members")},{option:"team_owners",label:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>l("team_owners")}]})}function be(e){window.__c={n:"ToggleInviteLinkRow"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,a.VK)((()=>g.U2(t)),[t]),r=D(t),l=(0,o.yK)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,K.jsxs)("div",{style:l.container,children:[(0,K.jsxs)("div",{children:[(0,K.jsx)(I.Z,{children:(0,K.jsx)(c.FormattedMessage,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,K.jsx)(I.Z,{isSmall:!0,style:l.subtitle,children:(0,K.jsx)(c.FormattedMessage,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,K.jsx)("div",{style:l.switcher,children:(0,K.jsx)(ge.Z,{disabled:r,on:!i,onClick:()=>{j.createAndCommit({userAction:"team.setInviteAccess",environment:s,perform:e=>{F.$x({environment:s,store:t,update:{disable_invite_link:!i},transaction:e})}})}})})]})}function Me(e){window.__c={n:"SettingSelect"};const{title:t,caption:s,currentOption:i,allOptions:a,disabled:r,optionTooltip:l}=e,d=(0,n.Fy)(),c=(0,o.yK)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),u=a.find((e=>e.option===i));return u?(0,K.jsxs)("div",{style:c.root,children:[(0,K.jsxs)("div",{style:c.title,children:[t,s&&(0,K.jsx)(I.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:s})]}),(0,K.jsx)(T.Z,{style:c.tooltipWidth,placement:Z.u.Top,alignment:T.Z.Alignment.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,K.jsx)(ce.ZP,{...e,disablePopup:r,popupType:d.isMobile?ce.Z4.SlideUp:ce.Z4.Popup,alignmentToOrigin:ce.vR.End,renderOrigin:t=>(0,K.jsxs)(Y.Z,{style:c.buttonStyle,disabled:r,...(0,ye.Z)(e,t),children:[u.label,!r&&(0,X.i)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:fe.og.ActionSheet}:{menuType:fe.og.Popup,minWidth:150};const s=[{key:"options",render:e=>(0,K.jsx)(pe.Z,{...e}),items:a.map((t=>({key:t.option.toString(),render:e=>(0,K.jsx)(de.Z,{...e,title:t.label,caption:t.caption,checkState:i===t.option}),action:()=>{t.action(),e.close()}})))}];return(0,K.jsx)(ue.Z,{...t,children:(0,K.jsx)(me.Z,{type:me.i.Vertical,initialFocus:void 0,sections:s})})}})})]}):null}function je(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsSecurity"};const{currentSpaceStore:s}=(0,a.Kw)(f.default),i=(0,n.O7)(),o=(0,J.z)(),r="enterprise",l=i.currentUser.id,d=(0,a.VK)((()=>({disable_public_access:{spaceIsDisabled:(null==s?void 0:s.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess()},disable_export:{spaceIsDisabled:(null==s?void 0:s.getDisableExport())??!1,teamIsDisabled:t.getDisableExport()},disable_guests:{spaceIsDisabled:(null==s?void 0:s.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests()},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits()}})),[s,t]),u=(0,R.q)(t),m=(0,a.VK)((()=>(null==s?void 0:s.canAdmin())??!1),[s]);if(!s)return null;if(!l)return null;const p=e=>o||d[e].teamIsDisabled,g=e=>{if(!p(e))return!1;if(!u)return!1;return!(e=>d[e].spaceIsDisabled&&d[e].teamIsDisabled)(e)||m},h=e=>!p(e)&&m,y=e=>{const{teamIsDisabled:s,spaceIsDisabled:n}=d[e],a=!s;F.d({environment:i,store:t,settingName:e,newTeamSettingValue:Te(a),spaceSettingValue:void 0===n?void 0:Te(n)})},x=e=>{if((e=>d[e].spaceIsDisabled)(e))return(e=>d[e].teamIsDisabled)(e)?(0,K.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,K.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,K.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,K.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},v=(0,K.jsx)($.Z,{subscriptionTier:r,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),S=(0,K.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),b=[(0,K.jsx)(us,{upsellTier:r,on:d.disable_public_access.teamIsDisabled,disabled:!g("disable_public_access"),onChange:()=>y("disable_public_access"),shouldTriggerUpsell:h("disable_public_access"),secondCaption:x("disable_public_access"),title:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable public page sharing"}),!p("disable_public_access")&&v]}),tooltip:!p("disable_public_access")&&S}),(0,K.jsx)(us,{upsellTier:r,on:d.disable_guests.teamIsDisabled,disabled:!g("disable_guests"),onChange:()=>y("disable_guests"),shouldTriggerUpsell:h("disable_guests"),secondCaption:x("disable_guests"),title:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),!p("disable_guests")&&v]}),tooltip:!p("disable_guests")&&S}),(0,K.jsx)(us,{upsellTier:r,on:d.disable_export.teamIsDisabled,disabled:!g("disable_export"),onChange:()=>y("disable_export"),shouldTriggerUpsell:h("disable_export"),secondCaption:x("disable_export"),title:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),!p("disable_export")&&v]}),tooltip:!p("disable_export")&&S})];return(0,K.jsx)(we,{teamStore:t,toggles:b})}function we(e){let{teamStore:t,toggles:s}=e;window.__c={n:"TeamsSettingsSecurity"};const i=(0,o.yK)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]),n=(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(xe,{teamStore:t}),(0,K.jsx)("div",{style:i.spacer}),(0,K.jsx)(V.Ph,{title:n,rows:s,hideDividers:!0}),(0,K.jsx)(O.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:i.learnMoreLinkContainer,message:(0,K.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function Ce(e){window.__c={n:"RestoreTeamButton"};const t=(0,n.O7)();return(0,K.jsx)(K.Fragment,{children:(0,K.jsx)(Y.Z,{style:e.style,icon:e=>(0,Q.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),onClick:()=>(e=>{let{teamStore:s,teamName:i}=e;return F.YH({environment:t,teamStore:s,teamName:i,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStoreInstance}),children:(0,K.jsxs)("div",{children:[(0,K.jsx)(I.Z,{children:(0,K.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,K.jsx)(I.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,K.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})})}function ke(e){window.__c={n:"ArchiveTeamButton"};const t=(0,n.O7)(),s=(0,o.yK)((()=>({archiveLabel:{color:S.ZP.red}})),[]);return(0,K.jsx)(Y.Z,{style:e.style,isRed:!0,icon:e=>(0,Q.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:()=>e.disabled?void 0:async function(e){let{teamStore:t,environment:s}=e;await F.aQ({environment:s,teamStore:t,from:"sidebar_team_modal"})}({environment:t,teamStore:e.teamStoreInstance}),...e.tooltipEvents,children:(0,K.jsxs)("div",{children:[(0,K.jsx)(I.Z,{style:s.archiveLabel,children:(0,K.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,K.jsx)(I.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,K.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function Te(e){return e?"disable":"allow"}const Ie=(0,c.defineMessages)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Pe(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsGeneral"};const s=(0,n.O7)(),r=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),l=D(t),[d,u]=(0,i.useState)(void 0),[m,p]=(0,i.useState)(void 0),g=(0,o.yK)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[h,y]=(0,a.VK)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===h)return null;const x=h||"",v=y??"",S=v.length>0,b=null==d?void 0:d.trim(),C=null==m?void 0:m.trim(),k=""===b||(void 0===m||C===v.trim())&&(void 0===d||b===x.trim()),T=(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),Z=(0,K.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,K.jsx)(E.p,{disabled:l,store:t,style:g.icon,size:20,onChange:e=>{j.createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:s,perform:s=>{F.fs({store:t,update:{icon:e},transaction:s})}})}}),l?(0,K.jsx)(I.Z,{children:x}):(0,K.jsx)(_e,{value:d??x,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:l,placeholder:"Acme Labs"})]}),A=(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),R=P.default.formatMessage(Ie.noDescription),B=l?(0,K.jsx)(I.Z,{isMultiline:!0,isSecondaryColor:!S,children:S?v:R}):(0,K.jsx)(_e,{value:void 0===m?v:m,onBlur:e=>{p(e)},onChange:e=>{p(e)},disabled:l,textarea:!0,autosize:!0,placeholder:R,style:g.description}),L=[(0,K.jsxs)(i.Fragment,{children:[(0,K.jsx)(I.Z,{isSmall:!0,children:T}),Z]},"name"),(0,K.jsxs)(i.Fragment,{children:[(0,K.jsx)(I.Z,{isSmall:!0,children:A}),B]},"description")];return(0,K.jsxs)("div",{style:g.container,children:[(0,K.jsx)(V.Ph,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:L}),!l&&(0,K.jsx)(w.Z,{style:g.updateButton,disabled:k,isLarge:!0,onClick:async()=>{if(k)return;if(b&&b!==x.trim()){if(!(await(0,_.Xg)({environment:s,spaceStore:r,teamName:b})))return}const{performResult:e,serverCommitResult:i}=j.createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:s,perform:e=>{F.fs({store:t,update:{name:b??x,description:C??v},transaction:e})}});try{await Promise.all([e,i])}catch(n){return}M.oV({label:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},children:(0,K.jsx)(c.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,K.jsx)("br",{}),(0,K.jsx)(G,{teamStore:t}),(0,K.jsx)(Ze,{teamStore:t}),(0,K.jsx)(O.Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function _e(e){window.__c={n:"EditableInput"};const{value:t,style:s,onBlur:n,onChange:a,placeholder:o,disabled:r}=e,[l,d]=(0,i.useState)(!1),c=(0,i.useRef)(null);return(0,K.jsx)(C.Z,{capture:l,render:i=>(0,K.jsx)(k.Z,{textarea:e.textarea,autosize:e.autosize,ref:c,onFocus:e=>{d(!0)},onBlur:e=>{d(!1),n(e.target.value)},onChange:e=>{d(!1),a&&a(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:o,disabled:r,value:t,style:s,...i})})}function Ze(e){let{teamStore:t}=e;window.__c={n:"MaybeDangerZone"};const s=(0,o.yK)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:V.MQ,paddingBottom:V.MQ,paddingLeft:V.oM,paddingRight:V.oM}})),[]),[i,n]=(0,a.VK)((()=>[t.getName(),t.isArchived()]),[t]),r=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),l=(0,R.q)(t),d=(0,L.e)(t),u=(0,B.y)(t.id),m=(0,A.n)(r),p=u&&!m;if(void 0===i||!d)return null;const g=[],h=(0,K.jsx)(N.Z,{buttonInternals:(0,K.jsx)(Fe,{isTeamOwner:l}),teamStore:t,placement:Z.u.Bottom,alignment:Z.v.Start,from:"sidebar_team_modal",style:s.buttonStyle,icon:e=>(0,b.q)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),isRed:!l});if(g.push(h),l)if(n)g.push((0,K.jsx)(Ce,{teamStoreInstance:t,teamName:i,style:s.buttonStyle}));else{const e=(0,K.jsx)(T.Z,{disableTooltip:!p,placement:Z.u.Bottom,alignment:Z.v.Start,renderTooltip:()=>(0,K.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>(0,K.jsx)(ke,{disabled:p,teamStoreInstance:t,tooltipEvents:e,style:s.buttonStyle})});g.push(e)}return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{style:{height:20,width:"100%"}}),(0,K.jsx)(V.Ph,{title:(0,K.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:g,itemStyle:{padding:0,margin:0}})]})}function Fe(e){let{isTeamOwner:t}=e;window.__c={n:"LeaveTeamButton"};const s=(0,o.yK)((()=>({label:{color:t?"inherit":S.ZP.red}})),[t]);return(0,K.jsxs)("div",{children:[(0,K.jsx)(I.Z,{style:s.label,children:(0,K.jsx)(c.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,K.jsx)(I.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,K.jsx)(c.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var Ae=s(35840),Re=s(77907),De=s(33052),Be=s(82740),Le=s(38078);function Ne(e){let{teamStore:t}=e;window.__c={n:"TeamFilterAndAddMemberRow"};const s=(0,o.yK)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),i=(0,c.useIntl)(),[n,r]=(0,a.AF)(h.Z),[l,d,u]=(0,a.AF)(void 0,De.Z),m=(0,Be.e)(t),p=(0,a.VK)((()=>(0,he.s$)()&&!g.U2(t)),[t]);return(0,K.jsxs)("div",{style:s.container,children:[(0,K.jsxs)("div",{children:[(0,K.jsx)(Re.LazyTeamPermissionsInviteWithModal,{store:t,permissionsInviteStore:u,origin:(0,K.jsx)(T.Z,{placement:T.Z.Placement.Left,alignment:T.Z.Alignment.Start,textWrap:!0,renderTooltip:()=>m?(0,K.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,K.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,K.jsx)("div",{style:{width:220},children:(0,K.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,K.jsx)(w.Z,{disabled:!m,isLarge:!0,onClick:()=>{d({...l,modalOpen:!0})},...e,children:(0,K.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),p&&(0,K.jsx)(Le.u,{store:t,isSmall:!0})]}),(0,K.jsx)(k.Z,{placeholder:i.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:s.input,value:n.memberFilterQuery,onChange:e=>{r({...n,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,Ae.R)(s.searchIcon),showClearButton:!0,format:k.Z.Format.Small})]})}var Oe=s(58573),Ee=s(59054),Ve=s(31299),Ue=s(62385),We=s(15047),Ke=s(64684),ze=s(7928),qe=s(86125),Ge=s(12793),He=s(31278),Qe=s(45653),Ye=s(25735),$e=s(67669),Je=(s(21703),s(36591)),Xe=s(47307),et=s(61519),tt=s(61766),st=s(31194),it=s(29369),nt=s(7567);function at(e){window.__c={n:"TeamMemberPermissionRoleSelect"};const{teamStore:t,memberInfo:s,permissionItem:r,memberName:l,style:d,onMenuItemClicked:u,isPermissionOverridden:m}=e,p=(0,n.O7)(),g=(0,c.useIntl)(),h=(0,o.Fg)(),y=(0,i.useMemo)((()=>new tt.Z),[]),x=(0,o.yK)((e=>({header:{display:"flex",flexDirection:"column",backgroundColor:e.sidebarSecondaryBackground,fontSize:12,color:e.mediumTextColor,alignItems:"flex-start",paddingTop:10,paddingLeft:12,paddingRight:12,paddingBottom:10},overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},overrideLabel:{paddingLeft:8,color:e.mediumTextColor}})),[]),v=(0,a.VK)((()=>t.getTeamPermission()),[t]),S=(0,a.VK)((()=>{if(null==t||!t.isDefined())return;const e=g.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),s=(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});function i(s){return(0,Ke.bk)({teamValue:{id:t.id,permissions:t.getPermissionItems()},permissionRole:s})?{isDisabled:!0,disabledMessage:e}:void 0}return["editor","read_and_write","comment_only","reader"].map((e=>({role:e,disabledInfo:i(e),tag:(null==v?void 0:v.role)===e?s:void 0})))}),[v,g,t]);const b=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),M=(0,a.VK)((()=>!("enterprise"===(null==b?void 0:b.getSubscriptionTier()))&&!m),[b,m]),w=(0,K.jsxs)("div",{style:x.overrideTitle,children:[(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),M?(0,K.jsx)($.Z,{subscriptionTier:"enterprise",analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,K.jsx)(nt.ZP,{role:"owner"===s.type?"none":r.role,table:it.e0,type:"user"===s.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===s.entity_type?"user_permission_item":"group_permission_item",buttonStyle:{marginRight:0,fontSize:12,color:h.mediumTextColor,visibility:m?void 0:"hidden"},availableRoleItems:S,header:(0,K.jsx)(I.Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){Xe.showDialog({message:(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:l,role:(0,$e.r_)(e).toLowerCase()}}),description:(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:Xe.dismissDialog,items:[{label:(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:i}=j.createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:p,perform:i=>{F.jg({memberInfo:s,teamStore:t,transaction:i,environment:p,permissionRole:e})}});await i,t.isDefault()&&(t.getMembershipDefinedOnTeam().some((e=>(0,Ke.ah)(e,s)))||await F.Uj({environment:p,teamStore:t,teamMemberInfos:[s],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),u&&u())},buttonPopupStore:y,placementToOrigin:st.Iw.Right,alignmentToOrigin:st.lU.End})]});return(0,K.jsx)(T.Z,{placement:T.Z.Placement.Left,textWrap:!0,renderTooltip:()=>(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,K.jsx)(de.Z,{...e,focused:!1,style:d,textWrapperStyle:{marginRight:0},disabled:M,onClick:()=>y.setState({open:!0}),title:w,icon:m?(0,K.jsx)("div",{style:{marginTop:8},children:(0,Je.e)({width:14})}):void 0})})}function ot(e){let{teamStore:t,memberInfo:s,permissionItem:i,memberName:o,isPermissionOverridden:r,disabled:d}=e;window.__c={n:"TeamMemberOwnerSelect"};const u=(0,a.qz)(void 0,tt.Z),[m,p]=(0,a.AF)(u),h=(0,n.O7)(),y=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),x=(0,a.VK)((()=>f.default.state.currentUserStore),[]),v=(0,a.VK)((()=>{const e=null==x?void 0:x.userId;return"user"===s.entity_type&&s.user_id===e}),[null==x?void 0:x.userId,s]),S=()=>p({...m,open:!1}),b=async e=>{S();const i="owner"===e?(0,K.jsx)(c.FormattedMessage,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,K.jsx)(c.FormattedMessage,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==s.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===s.entity_type){const{serverCommitResult:e}=j.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:h,perform:e=>{F.W8({environment:h,userId:s.user_id,teamStore:t,transaction:e})}});await e}}else v?Xe.showDialog({message:(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:Xe.dismissDialog,items:[{label:(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:M}]}):await M();else{const n=(0,g.Mf)(s.user_id).length;Xe.showDialog({message:(0,K.jsx)(K.Fragment,{children:n>1?(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:i,numberOfOtherTeams:n-1}}):(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:i}})}),showCancel:!0,keepFocus:!1,handleCancel:Xe.dismissDialog,items:[{label:(0,K.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(y){const{serverCommitResult:i}=j.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:h,perform:i=>{F.Ce({environment:h,userId:s.user_id,teamStore:t,transaction:i,spaceStore:y,newTeamRole:e})}});await i}}}]})}},M=async()=>{if("owner"===s.type&&"user"===s.entity_type){const{serverCommitResult:e}=j.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{F.mX({userId:s.user_id,teamStore:t,transaction:e,environment:h})}});await e}else if("member"===s.type){const{serverCommitResult:e}=j.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{F.X0({environment:h,memberInfo:s,teamStore:t,transaction:e})}});await e}},w=async()=>{const{entity_type:e}=s;switch(S(),e){case"group":const i=(0,U.TC)({spaceStore:y,groupId:s.group_id});if(!i)throw new Error("Permission group not found in space.");F.mN({environment:h,teamStore:t,group:i});break;case"user":await F.WO({environment:h,teamStore:t,currentSpaceStore:y,userId:s.user_id,from:"team_settings_member_table"});break;default:(0,l.t1)(e)}};return(0,K.jsx)(ce.ZP,{buttonPopupStore:u,placementToOrigin:st.Iw.Bottom,renderOrigin:e=>(0,K.jsx)(lt,{buttonPopupEvents:e,isPermissionOverridden:r,permissionItem:i,memberInfo:s,disabled:d}),render:()=>(0,K.jsx)(rt,{teamStore:t,isPermissionOverridden:r,memberInfo:s,permissionItem:i,memberName:o,onMenuItemClicked:b,onRemoveClicked:w,onSubMenuItemClicked:S}),popupType:ce.Z4.Popup})}function rt(e){let{teamStore:t,isPermissionOverridden:s,memberInfo:i,permissionItem:n,memberName:l,onRemoveClicked:u,onMenuItemClicked:m,onSubMenuItemClicked:h}=e;window.__c={n:"OwnerMemberMenuList"};const y=(0,a.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,he.F$)()}),[]),x=(0,a.VK)((()=>t.isDefault()),[t]),v=(0,a.VK)((()=>(0,g.Hu)({membership:t.getKeyStore("membership").getValue()})),[t]),S=(0,a.VK)((()=>1===t.getMembers().filter((e=>"owner"===e.type)).length),[t]),b=(0,o.yK)((e=>{const t={paddingTop:5,paddingBottom:5},s={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:s,indentedMenuItem:{...s,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.mediumTextColor,fontSize:12,fontWeight:d.Z.fontWeight.regular}}}),[]),M=(e,t)=>{const i=("owner"===e||"team_level_guest"===e)&&"group"===t.entity_type,a="member"===e&&"owner"===t.type&&S,o="team_level_guest"===e&&("owner"===t.type||"member"===t.type),r=i||a||o;return{key:e,action:()=>m(e),render:l=>{const d=!s&&t.type===e;return(0,K.jsx)(T.Z,{disableTooltip:!r,placement:T.Z.Placement.Right,textWrap:!0,renderTooltip:()=>i?"owner"===e?(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableOwnerForGroupsTooltip",defaultMessage:"Groups can't be teamspace owners"}):(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableTeamGuestForGroupsTooltip",defaultMessage:"Groups can't be teamspace guests"}):a?(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableWithOnlyOneOwnerTooltip",defaultMessage:"Add another teamspace owner to downgrade yourself to member"}):o?(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableDowngradeToGuestTooltip",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."}):void 0,render:t=>(0,K.jsx)("span",{...t,children:(0,K.jsx)(de.Z,{...l,style:d?b.menuItem:b.indentedMenuItem,disabled:r,disabledFeedback:r,title:(0,K.jsx)(dt,{isPermissionOverridden:s,type:e,permissionItem:n}),caption:ut(e),shouldWrapCaption:!0,icon:d?(0,Je.e)({width:14}):void 0})})})}}},j=x&&"user"===i.entity_type,w="group"!==i.entity_type,C="group"!==i.entity_type&&y,k=[{key:"teamRoles",items:r.oA([w?M("owner",i):void 0,M("member",i),C?M("team_level_guest",i):void 0,mt({onRemoveClicked:u,styles:b,isMemberInDefaultTeam:j}),..."owner"===i.type||v?[]:[{key:"divider",action:()=>{},render:()=>(0,K.jsx)(et.Z,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,K.jsx)("span",{...e,children:(0,K.jsx)(at,{teamStore:t,memberInfo:i,permissionItem:n,memberName:l,onMenuItemClicked:h,isPermissionOverridden:s,style:s?b.menuItem:b.indentedMenuItem})})}]]),render:e=>(0,K.jsx)(pe.Z,{...e,topBorder:0!==e.index})}];return(0,K.jsx)(ue.Z,{className:p.a6i,menuType:fe.og.Popup,children:(0,K.jsx)(me.Z,{type:me.i.Vertical,initialFocus:void 0,sections:k})})}function lt(e){let{buttonPopupEvents:t,disabled:s,isPermissionOverridden:i,permissionItem:n,memberInfo:a}=e;window.__c={n:"SelectButton"};const r=(0,o.yK)((e=>({label:{color:e.regularTextColor,fontSize:12.5,fontWeight:d.Z.fontWeight.regular},overrideLabel:{color:e.mediumTextColor,fontSize:12,fontWeight:d.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),u=function(e,t,s){if(t&&s)return function(e){switch(e){case"none":return(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,l.t1)(e)}}(s);return ct(e)}(a.type,i,n.role);return(0,K.jsxs)(Y.Z,{disabled:s,...t,children:[i&&(0,K.jsxs)("span",{style:r.overrideLabel,children:[(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,K.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,K.jsx)("span",{style:r.label,children:u}),!s&&(0,X.i)(r.chevron)]})}function dt(e){let{isPermissionOverridden:t,permissionItem:s,type:i}=e;const n=ct(i);return(0,K.jsx)("div",{children:(0,K.jsx)("span",{children:n})})}function ct(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,K.jsx)(c.FormattedMessage,{...g.q9[e].label});case"none":return;default:(0,l.t1)(e)}}function ut(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,K.jsx)(c.FormattedMessage,{...g.q9[e].caption});case"none":return;default:(0,l.t1)(e)}}function mt(e){let{styles:t,onRemoveClicked:s,isMemberInDefaultTeam:i}=e;const n=i?(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.remove.disabledTooltip.cannotRemoveFromDefault",defaultMessage:"Members cannot be removed from a default teamspace."}):void 0;return{key:"remove",action:s,render:e=>(0,K.jsx)(T.Z,{disableTooltip:!n,placement:T.Z.Placement.Right,textWrap:!1,renderTooltip:()=>n,render:s=>(0,K.jsx)("span",{...s,children:(0,K.jsx)(de.Z,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:Boolean(n),disabledFeedback:!0,title:(0,K.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var pt=s(30765);function gt(e){window.__c={n:"TeamPermissionRowAvatar"};const{icon:t,label:s,name:i,tag:n,style:a}=e,r=(0,o.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...a},labelContainer:{display:"flex",flexDirection:"column",...d.Z.textOverflowStyle,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[a]);return(0,K.jsxs)("div",{style:r.container,children:[t,(0,K.jsxs)("div",{style:r.labelContainer,children:[(0,K.jsxs)("div",{style:r.nameContainer,children:[(0,K.jsx)(pt.s,{style:r.name,children:i}),n]}),s&&(0,K.jsx)(I.Z,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,K.jsx)(pt.s,{children:s})})]})]})}function ht(e){window.__c={n:"TeamPermissionRowItem"};const{iconComponent:t,label:s,name:i,permissionRoleSelectComponent:n,tag:a,tooltip:r,style:l}=e,d=(0,o.yK)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,K.jsxs)("div",{style:d.permissionRow,children:[(0,K.jsx)(gt,{icon:t,name:i,tag:a,label:s,style:{minWidth:200,marginRight:6}}),(0,K.jsx)(T.Z,{textWrap:!0,style:{width:210},disableTooltip:!r,placement:T.Z.Placement.Left,renderTooltip:()=>r,render:e=>(0,K.jsx)("span",{...e,children:n})})]})}function ft(e){window.__c={n:"SpecificTeamMemberPermissionRow"};const{type:t,store:s,permissionItem:i,memberInfo:r}=e,d=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),u=(0,c.useIntl)(),m=(0,a.VK)((()=>{switch(t){case"group":return"none";case"user":return null!=d&&d.isDefined()?(0,$e.su)(null==d?void 0:d.getPermissionItems(),e.memberInfo.user_id):"none";default:(0,l.t1)(t)}}),[d,t,e]),p=(0,R.q)(s),g=(0,a.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return null==e?void 0:e.canEditMembership()}),[]),h=(0,n.O7)(),y=(0,a.VK)((()=>{const e=h.currentUser.id,t=s.getSettingsStore().getValue();return!!(null!=d&&d.isDefined()&&s.isDefined()&&t&&e)&&(0,Ke.W9)({membership:s.getMembers(),settings:t,is_default:s.isDefault()},e,{permissions:d.getPermissionItems(),subscription_tier:d.getSubscriptionTier(),permission_groups:d.getPermissionGroups()})}),[h.currentUser.id,d,s]),x=(0,a.VK)((()=>{const e=s.getPermissionItems()||[];switch(r.entity_type){case"group":return!!e.find((e=>(0,ee.hV)(e)&&e.group_id===r.group_id));case"user":return!!e.find((e=>(0,ee.jg)(e)&&e.user_id===r.user_id));default:return!1}}),[r,s]),{name:v,label:S,icon:b}=(0,a.VK)((()=>{switch(t){case"group":return xt({permissionGroup:e.permissionGroup,spaceId:null==d?void 0:d.id});case"user":return function(e){let{intl:t,userStore:s}=e;return{name:(0,ze.Nz)(t,null==s?void 0:s.getModel()),label:null==s?void 0:s.getEmail(),icon:(0,K.jsx)(Qe.Z,{avatarShouldShowShadow:!0,userStore:s,size:32})}}({intl:u,userStore:e.userStore});default:(0,l.t1)(t)}}),[t,e,u,null==d?void 0:d.id]),M=(0,K.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,K.jsx)(ot,{teamStore:s,memberInfo:r,memberName:v,permissionItem:i,isPermissionOverridden:x,disabled:!p&&!y||"team_level_guest"===r.type&&!g})}),j=(0,o.yK)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17}})),[]);return(0,K.jsx)(ht,{style:j.row,tag:(0,ee.Bc)(m)?(0,K.jsx)(qe.Z,{desktopStyle:j.pill,mobileStyle:j.pill,role:yt(m)}):"group"===t?(0,K.jsx)("div",{style:j.pill,children:b}):void 0,permissionRoleSelectComponent:M,iconComponent:"group"===t?(0,K.jsx)(Ge.Z,{size:32}):b,name:v,label:S})}function yt(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,l.t1)(e)}}function xt(e){let{spaceId:t,permissionGroup:s}=e;const{name:i,user_ids:n,icon:a}=s,o=(null==n?void 0:n.length)??0;return{name:i??(0,K.jsx)(c.FormattedMessage,{id:"teamPermissionSettings.unknownGroup",defaultMessage:"Unknown Group"}),label:(0,K.jsx)(T.Z,{placement:T.Z.Placement.Bottom,alignment:T.Z.Alignment.Start,disableTooltip:0===o,renderTooltip:()=>(0,K.jsx)(Ye.Y,{group:s,limit:10,noMembersMessage:void 0}),render:e=>(0,K.jsxs)("div",{...e,children:[(0,K.jsx)(c.FormattedMessage,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,K.jsx)(c.FormattedMessage,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:o}})]})}),icon:a&&(0,K.jsx)(He.Z,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:i,size:18,icon:a&&t?{icon:a,pointer:{table:We.bx,id:t}}:void 0})}}var vt=s(47453),St=s(34583);function bt(e){let{teamStore:t,...s}=e;window.__c={n:"SpecificTeamMemberToAddRow"};const r=(0,n.O7)(),l=(0,a.VK)((()=>{var e;return null===(e=f.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),d=(0,c.useIntl)(),u=(0,o.yK)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),m=(0,i.useCallback)((e=>{M.oV({label:(0,K.jsx)(c.FormattedMessage,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),p=(0,i.useCallback)((async(e,s)=>{await F.Uj({environment:r,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await St.bi(r):m(s)}),[r,m,t]),g=(0,i.useCallback)(((e,t)=>p({type:"member",entity_type:"user",user_id:e.id},t)),[p]),h=(0,i.useCallback)(((e,t)=>p({type:"member",entity_type:"group",group_id:e.id},t)),[p]);if("memberToAdd"in s){const{memberToAdd:e}=s,t=(0,ze.Nz)(d,e);return(0,K.jsxs)("div",{style:u.container,children:[(0,K.jsx)(gt,{icon:(0,K.jsx)(Qe.Z,{userValue:e,size:32}),name:t,label:e.email}),Mt((()=>{g(e,t)}))]})}{if(!l)return(0,K.jsx)(K.Fragment,{});const{groupToAdd:e}=s,t=xt({spaceId:l,permissionGroup:e});return(0,K.jsxs)("div",{style:u.container,children:[(0,K.jsx)(gt,{icon:(0,K.jsx)(Ge.Z,{size:32}),name:t.name,label:t.label,tag:(0,K.jsx)("div",{style:u.pill,children:t.icon})}),Mt((()=>{h(e,t.name)}))]})}}const Mt=e=>(0,K.jsx)(Y.Z,{isBlue:!0,onClick:e,icon:vt.R,children:(0,K.jsx)(c.FormattedMessage,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})});var jt=s(40745),wt=s(8597);function Ct(e){let{sortType:t,onChangeSortType:s}=e;window.__c={n:"TeamPermissionsListHeader"};const i=(0,o.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),n=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",a=e=>{const i=e===t.column&&!t.sortedAscending;s({column:e,sortedAscending:i})};return(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{style:i.container,children:[(0,K.jsx)(kt,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:n("name"),onClick:()=>a("name")}),(0,K.jsx)(kt,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:n("role"),onClick:()=>a("role")})]})})}function kt(e){let{sortedType:t,title:s,onClick:i}=e;window.__c={n:"HeaderLabel"};const n=(0,o.yK)((e=>({button:{color:e.mediumTextColor,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return(0,K.jsxs)(Y.Z,{style:n.button,hoveredStyle:n.buttonHover,onClick:i,children:["ascending"===t&&(0,wt.Z)(n.sortIcon),"descending"===t&&(0,jt.M)(n.sortIcon),s]})}function Tt(e){var t;let{store:s}=e;window.__c={n:"TeamPermissionsList"};const r=(0,n.O7)(),u=(0,o.yK)((e=>({container:{display:"block",overflow:"hidden"},membersHeader:{marginBottom:8},noResult:{fontSize:d.Z.fontSize.UIRegular.desktop,color:e.mediumTextColor,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),m=(0,c.useIntl)(),[p,y]=(0,i.useState)({column:"role",sortedAscending:!1}),[x]=(0,a.AF)(h.Z),v=(0,Be.e)(s),S=(0,a.VK)((()=>s.getMembers()),[s]),b=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),M=(0,a.VK)((()=>f.default.state.currentUserStore),[]),{permissionRowInfos:j,numNotShown:w}=(0,a.VK)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:s,intl:i}=e;if(""===s)return t;return(0,Oe.ZP)(s,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name??"";case"user":const{userStore:s}=e;return s.getSearchName(i);default:(0,l.t1)(t)}}))}({permissionRowInfos:(0,g.tu)({currentUserStore:M,currentSpaceStore:b,teamStore:s,members:S}),memberFilterQuery:x.memberFilterQuery,intl:m}),t=function(e){let{permissionRowInfos:t,sortType:s,intl:i}=e;const{column:n,sortedAscending:a}=s,o={permissionRowInfos:t,sortedAscending:a};if("role"===n)return function(e){let{permissionRowInfos:t,sortedAscending:s}=e;const i=["owner","member","team_level_guest"],n=["group","user"];return[...t].sort(((e,t)=>{const s=e.memberInfo.entity_type,i=t.memberInfo.entity_type;return n.indexOf(s)-n.indexOf(i)})).sort(((e,t)=>{const n=e.memberInfo.type,a=t.memberInfo.type,o=i.indexOf(n)-i.indexOf(a);return s?-o:o}))}(o);if("name"===n)return function(e){let{permissionRowInfos:t,sortedAscending:s,intl:i}=e;return[...t].sort(((e,t)=>{const n=It(e,i)??"",a=It(t,i)??"";if(n===a)return 0;const o=n<a?-1:1;return s?-o:o}))}({...o,intl:i});(0,l.t1)(n)}({permissionRowInfos:e,sortType:p,intl:m}),i=x.limitMembers?t.slice(0,50):t;return{permissionRowInfos:i,numNotShown:e.length-i.length}}),[b,M,S,s,p,x.memberFilterQuery,x.limitMembers,m]),[C]=(0,Ee.r5)((async()=>{var e;if(!v||null===(e=x.memberFilterQuery)||void 0===e||!e.trim().length)return[];const t=(await Ve.Yu({environment:r,query:x.memberFilterQuery,membersOnly:!0})).map((e=>({type:"user",value:e}))),s=Ve.$w({query:x.memberFilterQuery,intl:m}).map((e=>({type:"group",value:e}))),i=new Set(j.map(_t));return[...t,...s].filter((e=>!i.has(e.value.id))).slice(0,5)}),[v,x.memberFilterQuery,r,m,j]),k=Boolean(null===(t=x.memberFilterQuery)||void 0===t?void 0:t.trim().length),T=j.length>0,I="resolved"===C.status?C.value:[];return(0,K.jsxs)("div",{style:u.container,children:[(0,K.jsx)(Pt,{title:k?(0,K.jsx)(c.FormattedMessage,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,K.jsx)(Ct,{sortType:p,onChangeSortType:y}),rows:j,renderRow:e=>(0,K.jsx)(ft,{store:s,...e})}),w>0&&(0,K.jsx)(Ue.Z,{style:u.showMore,onClick:()=>{h.Z.setState({...x,limitMembers:!1})},children:(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:w}})}),I.length>0&&(0,K.jsx)(Pt,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"}),rows:I,renderRow:e=>"user"===e.type?(0,K.jsx)(bt,{teamStore:s,memberToAdd:e.value}):(0,K.jsx)(bt,{teamStore:s,groupToAdd:e.value})}),!T&&0===I.length&&(0,K.jsx)("div",{style:u.noResult,children:(0,K.jsx)(c.FormattedMessage,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})})]})}function It(e,t){const{type:s}=e;if("user"===s){const{userStore:s}=e;return s.getDisplayName(t)}if("group"===s){const{permissionGroup:t}=e;return t.name}(0,l.t1)(s)}function Pt(e){let{rows:t,renderRow:s,title:n}=e;window.__c={n:"TeamPermissionListInner"};const a=(0,o.yK)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?(0,K.jsxs)(K.Fragment,{children:[n&&(0,K.jsx)(I.Z,{isSmall:!0,children:n}),(0,K.jsx)("div",{style:a.membersList,children:t.map(((e,t)=>(0,K.jsxs)(i.Fragment,{children:[t>0&&(0,K.jsx)("div",{style:a.memberDivider}),s(e)]},t)))})]}):null}function _t(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,l.t1)(e)}}function Zt(e){let{teamStore:t}=e;window.__c={n:"TeamMembersListSection"};const s=(0,o.yK)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,K.jsxs)("div",{style:s.content,children:[(0,K.jsx)(Ne,{teamStore:t}),(0,K.jsx)(Tt,{store:t})]})}var Ft=s(79362);function At(e){window.__c={n:"TeamGuestsPermissionRow"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,c.useIntl)(),{teamGuestPermissionItem:r,teamPermissions:l}=(0,a.VK)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),d=D(t),u=(0,a.VK)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:i.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[i]),m=(0,o.yK)((e=>({button:{fontSize:12.5,marginRight:0,color:e.mediumTextColor}})),[]),p=r&&(0,K.jsx)(nt.ZP,{role:r.role,table:it.e0,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:d,buttonStyle:m.button,availableRoleItems:u,onChange:async e=>{if(l.filter((t=>((0,ee.jg)(t)||(0,ee.hV)(t))&&(0,te.xO)(e,t.role))).length>0){if(!(await(0,_.Bt)()))return}j.createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:s,perform:i=>{F.$J({environment:s,teamStore:t,newRole:e,transaction:i,permissionsToClear:[]})}})}}),g=(0,a.VK)((()=>t.getName()),[t]),h=(0,a.VK)((()=>t.getIcon()),[t]),f=h&&Ft.V2(h.icon)?Ft.mk(h.icon):"gray",y=h?{...h,icon:`/icons/user-circle_${f}.svg`}:void 0,x=(0,K.jsx)(E.p,{disabled:!0,store:t,size:V.Kt,icon:y});return p?(0,K.jsx)(ht,{permissionRoleSelectComponent:p,iconComponent:x,name:Rt(g)}):null}function Rt(e){return e?(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function Dt(e){window.__c={n:"TeamMembersPermissionRow"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,o.Fg)(),r=(0,c.useIntl)(),{teamPermissionItem:l,teamPermissions:d}=(0,a.VK)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=D(t),m=(0,a.VK)((()=>{var e;const s=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),i=r.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function n(e){return s&&e!==s.role&&(0,te.nl)(e,s.role)===s.role&&!t.isDefault()?{isDisabled:!0,disabledMessage:i}:void 0}return[{role:"editor",disabledInfo:n("editor")},{role:"read_and_write",disabledInfo:n("read_and_write")},{role:"comment_only",disabledInfo:n("comment_only")},{role:"reader",disabledInfo:n("reader")}]}),[r,t]),p=l&&(0,K.jsx)(nt.ZP,{role:l.role,table:it.e0,type:(0,ee.zU)(l)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:i.mediumTextColor},availableRoleItems:m,onChange:async e=>{const i=d.filter((t=>((0,ee.jg)(t)||(0,ee.hV)(t))&&(0,te.xO)(e,t.role)));if(i.length>0){if(!(await(0,_.Bt)()))return}j.createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:s,perform:n=>{F.xI({environment:s,teamStore:t,newRole:e,transaction:n,permissionsToClear:i})}})}}),{teamName:g}=(0,a.VK)((()=>({teamName:t.getName()})),[t]),h=(0,K.jsx)(E.p,{disabled:!0,store:t,size:V.Kt});return(0,K.jsx)(ht,{permissionRoleSelectComponent:p,iconComponent:h,name:Bt(g)})}function Bt(e){return e?(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var Lt=s(19889),Nt=s(79414);function Ot(e){window.__c={n:"TeamOwnersPermissionRow"};const{teamStore:t,teamOwnerIds:s}=e,i=(0,o.Fg)(),n=(0,a.VK)((()=>t.getName()),[t]),r=(0,a.VK)((()=>t.getTeamOwnerPermission()),[t]),l=(0,a.VK)((()=>f.default.state.currentUserStore),[]),d=(0,a.VK)((()=>l?s.map((e=>y.U6.createChildStore(l,{table:Lt.KJ,id:e}))):[]),[l,s]);return(0,K.jsx)(ht,{tooltip:(0,K.jsx)(c.FormattedMessage,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,K.jsx)(nt.ZP,{role:"editor",table:it.e0,type:r&&(0,ee.LW)(r)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:i.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:(0,K.jsx)(Nt.n,{teamStore:t,ownerStores:d,isSmall:!0}),name:Et(n)})}function Et(e){return e?(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Vt=s(16184),Ut=s(76464);function Wt(e){window.__c={n:"TeamSpacePermissionRow"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),{iconComponent:o,spaceName:r}=(0,a.VK)((()=>{if(!i)return{iconComponent:void 0,spaceName:void 0};const e=(0,U.rn)(s,i);return{iconComponent:(0,K.jsx)(E.p,{disabled:!0,store:i,size:V.Kt}),spaceName:e}}),[i,s]);return(0,K.jsx)(ht,{permissionRoleSelectComponent:(0,K.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,K.jsx)(zt,{teamStore:t})}),iconComponent:o,name:Kt(r)})}function Kt(e){return e?(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function zt(e){window.__c={n:"TeamPermissionRoleSelect"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,o.Fg)(),l=(0,a.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),d=D(t),u=(0,a.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return oe({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const m=u.permissionItemRoleOptions.spacePermission;if(1===m.length&&"none"===m[0])return(0,K.jsx)(T.Z,{renderTooltip:()=>(0,K.jsx)(c.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,Vt.Q)({width:14,height:14,fill:i.timelineRed,marginRight:4}),(0,K.jsx)("div",{style:{fontSize:12.5,color:i.timelineRed,marginRight:8},children:(0,K.jsx)(c.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=r.MR(m,(e=>-ee.xm[e])).map((e=>({role:e})));return(0,K.jsx)(nt.ZP,{role:l.role,table:it.e0,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:d||1===m.length,buttonStyle:{fontSize:12.5,marginRight:0,color:i.mediumTextColor},availableRoleItems:e,onChange:e=>{const i={...l,role:e};j.createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:s,perform:e=>{Ut.ep({environment:s,store:t,permissionItems:[i],transaction:e})}})}})}}function qt(e){let{teamStore:t}=e;window.__c={n:"TeamPermissionRowsSection"};const s=(0,a.VK)((()=>t.isDefault()),[t]),i=(0,a.VK)((()=>(0,Ke.XO)({membership:t.getMembers()})),[t]),n=(0,a.VK)((()=>{const e=f.default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!s&&(0,he.F$)())}),[s]),r=(0,o.yK)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,K.jsxs)("div",{style:r.container,children:[(0,K.jsx)(Ot,{teamStore:t,teamOwnerIds:i},"0"),(0,K.jsx)(Dt,{teamStore:t},"1"),n&&(0,K.jsx)(At,{teamStore:t},"2"),!s&&(0,K.jsx)(Wt,{teamStore:t},"3")]})}var Gt=s(14465);function Ht(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsMembers"};const s=(0,o.yK)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(Qt,{teamStore:t}),(0,K.jsx)("div",{style:s.spacer}),(0,K.jsx)(Gt.z,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:s.heading}),(0,K.jsx)(Zt,{teamStore:t})]})}function Qt(e){let{teamStore:t}=e;window.__c={n:"PermissionsCard"};const s=(0,n.O7)(),r=(0,a.VK)((()=>t.getName()),[t]),l=(0,o.yK)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),d=(0,i.useCallback)(((e,i)=>{F.Ju({environment:s,accessLevel:e,isDefault:i,store:t,teamName:r,from:"sidebar_team_modal"})}),[s,t,r]),u=(0,a.VK)((()=>t.getTeamAccessLevel()),[t]),m=[(0,K.jsx)(W._,{teamStore:t,currentAccessLevel:u,onChange:d,style:l.accessButton},"visibility"),(0,K.jsx)(qt,{teamStore:t},"permissions")];return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(V.Ph,{title:(0,K.jsx)(c.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:m,itemStyle:l.teamSettingsListItems}),(0,K.jsx)(O.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,K.jsx)(c.FormattedMessage,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:l.learnMoreLinkContainer})]})}var Yt=s(22487),$t=s(3386),Jt=s(50506),Xt=s(76798),es=s(53336),ts=s(29302),ss=s(13490),is=s(66957),ns=s(74136);function as(e){return(0,K.jsx)(ns.Z,{...e,children:(0,K.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function os(e){window.__c={n:"ModalContent"};const{teamStore:t}=e,s=(0,a.VK)((()=>h.Z.state.tab),[]);if(void 0===s)return null;switch(s){case h.a.General:return(0,K.jsx)(Pe,{teamStore:t});case h.a.Members:return(0,K.jsx)(Ht,{teamStore:t});case h.a.Security:return(0,K.jsx)(je,{teamStore:t});default:(0,l.t1)(s)}}function rs(e){window.__c={n:"UserWithAvatar"};const{userId:t,currentSpaceStore:s}=e,{userStore:i,isDefined:n}=(0,a.VK)((()=>{const e=y.U6.createChildStore(s,{table:"notion_user",id:t,spaceId:s.id});return{userStore:e,isDefined:e.isDefined()}}),[s,t]);return n?(0,K.jsx)(ts.Z,{avatarShouldShowShadow:!0,userStore:i,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function ls(e){window.__c={n:"PeopleRow"};const{userIds:t,label:s,hasMarginTop:i}=e,n=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]);return n?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(ss.Z,{hasMarginTop:i,children:s}),t.map((e=>(0,K.jsx)(rs,{userId:e,currentSpaceStore:n},e)))]}):null}function ds(){window.__c={n:"SidebarTeamModal"};const e=(0,n.O7)(),t=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),s=(0,a.VK)((()=>f.default.state.currentSpaceViewStore),[]),i=(0,n.Fy)(),m=(0,o.yK)((e=>({modal:{width:i.isMobile?"auto":630,height:i.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:d.Z.fontWeight.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:d.Z.fontWeight.regular,textTransform:"unset",fontSize:11}})),[i.isMobile]),{open:y,tab:S,teamStore:b}=(0,a.VK)((()=>{const{open:e,tab:t}=h.Z.state;return{open:e,tab:t,teamStore:h.Z.getTeamStore()}}),[]),M=(0,a.VK)((()=>null==b?void 0:b.getSettings()),[b]),j=(0,R.q)(b);if(!t||!s||!b)return null;const w=[h.a.General,h.a.Members,h.a.Security];return(0,K.jsx)(Jt.Z,{open:y,innerStyle:m.modal,onDismiss:()=>{h.Z.reset()},render:()=>y?(0,K.jsx)("div",{className:p.rIj,style:{height:"100%"},children:(0,K.jsx)("div",{style:m.modalWrap,children:(0,K.jsx)($t.Z,{capture:!0,onBackspace:r.yR,onLeft:r.yR,onRight:r.yR,onSelectAll:r.yR,onRedo:r.yR,onUndo:r.yR,onCut:r.yR,onCopy:r.yR,onPaste:r.yR,onKeypress:r.yR,onDelete:r.yR,onTab:r.yR,children:(0,K.jsxs)("div",{style:m.innerWrap,children:[(0,K.jsxs)("div",{style:m.header,children:[(0,K.jsx)(E.p,{disabled:!0,store:b,size:24,style:m.icon}),(0,K.jsx)(Xt.Z,{store:b,style:{fontSize:16,fontWeight:d.Z.fontWeight.semibold}}),(0,g.C2)(M)&&(0,K.jsx)(v.Z,{iconStyle:m.lockIcon}),(0,g.Hu)({membership:b.getRawMembership()})&&(0,K.jsx)("div",{style:{gap:5,display:"flex"},children:(0,K.jsx)(as,{desktopStyle:m.unownedPill,mobileStyle:m.unownedPill,innerStyle:m.unownedPillInner})}),(0,K.jsx)("div",{style:{flexGrow:1}}),(0,K.jsx)(x.M,{teamStore:b,onLeavingTeam:()=>h.Z.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,K.jsx)(is.Z,{tabs:w.map((e=>function(e,t){switch(e){case h.a.General:return(0,K.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case h.a.Members:return(0,K.jsx)(cs,{teamStore:t});case h.a.Security:return(0,K.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,l.t1)(e)}}(e,b))),selectedIndex:(0,l.$K)(S)?w.indexOf(S):1,onChange:t=>{y&&(u.rFP(e,{store:b,tab_old_value:S??h.a.General,tab_new_value:w[t]}),h.Z.update((e=>e.open?{...e,tab:w[t]}:e)))},tabStyle:{marginLeft:-8},style:m.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,K.jsx)(es.Z,{type:es.Z.OverflowType.Y,style:m.scroller,children:(0,K.jsx)("div",{style:m.contentWrap,children:(0,K.jsx)(os,{currentSpaceStore:t,teamStore:b,userIsTeamOwner:j})})})]})})})}):null})}function cs(e){let{teamStore:t}=e;window.__c={n:"MembersTabTitle"};const s=(0,Yt.K)(t),i=(0,o.Fg)();return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,K.jsx)("span",{children:" "}),(0,K.jsx)("div",{style:{color:i.lightTextColor},children:s})]})}function us(e){let{title:t,caption:s,secondCaption:i,on:a,disabled:r,tooltip:l,style:d,onChange:c,shouldTriggerUpsell:u,upsellTier:p}=e;window.__c={n:"SettingToggle"};const g=(0,n.O7)(),h=(0,o.yK)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:u?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18}})),[d,u]);return(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{style:h.root,onClick:()=>{if(u)return m.y(g,{from:"team_security_settings",for:p,dontOpenPlansOnCancel:!0})},children:[(0,K.jsxs)("div",{style:h.title,children:[t,s&&(0,K.jsx)(I.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:s}),i&&(0,K.jsx)(I.Z,{isSmall:!0,children:i})]}),(0,K.jsx)("div",{style:h.switcherWrap,children:(0,K.jsx)(T.Z,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,K.jsx)("div",{...e,children:(0,K.jsx)(ge.Z,{on:a,disabled:r,onClick:c})})})})]})})}},636:(e,t,s)=>{s.r(t),s.d(t,{default:()=>C});s(67294);var i=s(83355),n=s(13991),a=s(46225),o=s(50906),r=s(15944),l=s(84084),d=s(39699),c=s(68204),u=s(64286),m=s(87279),p=s(68056),g=s(31352),h=s(35328),f=s(80444),y=s(27724),x=s(10743),v=s(24666),S=s(48019),b=s(78140),M=s(53437),j=s(85893);class w extends i.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=x.Z.state;if(!t.open)return;const s=T(t),i=k(t);let n;return n=e.isMobileNative&&!e.isTablet?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:I(),maxHeight:"40vh",onClickOutside:l.xv},(0,j.jsx)(b.Z,{...n,children:(0,j.jsx)(S.Z,{sections:s,onAccept:this.handleAccept,context:{environment:this.environment,blocks:y.default.state.stores,originRect:t.selectionRect,publicEditMode:void 0},filter:i,initialFocus:0,onEmptyEnter:this.handleCancel,useLimit:!0})})},this.handleCancel=()=>{l.xv()},this.handleAccept=(e,t,s,i)=>{const n=y.default.state.stores[0];if(n){const t=n.getType(),s=n.getFormat();o.dhV(this.environment,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"slash_menu",block_id:n.id,block_type:t,is_toggleable:t?(0,h._A)(t,s):void 0,slash_menu_filter_length:this.filterLength(),slash_menu_section:i})}d.createAndCommit({userAction:"SlashMenu.handleAccept",environment:this.environment,perform:e=>{l.RL({environment:this.environment,transaction:e})}})},this.filterLength=()=>{const e=x.Z.state;return e.open?e.filter.length:0}}willMountOrUpdate(){let e=x.Z.state;if(e.open){var t;const s=v.default.state;if("editing"!==s.mode)return!1;const i=k(e),n=(0,c.sG)({sections:T(e),context:{blocks:y.default.state.stores,environment:this.environment,publicEditMode:void 0},query:i||""});let a=0;if(i)if(0===n.length)a=i.length-e.lettersAtLastResult;else{const t={...e,lettersAtLastResult:(null==i?void 0:i.length)??0,filter:i};x.Z.setState(t),e=t}const{currentUserSettingsStore:o}=f.default.state;!o||null!==(t=o.getSettings())&&void 0!==t&&t.pressed_slash_tooltip||!(0,u.u)(this.environment)||r.q(this.environment);const{multiSelection:d}=s;(0,p.qS)(d)&&d.start.store===e.textStore&&!g.Ye(i,!0,n.length,a,e.textStore)||l.xv()}}renderComponent(){const{device:e}=this.environment,t=x.Z.state;return(0,j.jsx)(M.ZP,{popupType:e.isMobileNative&&!e.isTablet?M.ZP.PopupType.SlideUp:M.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:M.ZP.Placement.Bottom,alignmentToOrigin:M.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,preventBlockRenderQueueOnEnter:!0,onDismiss:this.handleCancel,render:this.renderMenu})}}w.displayName="SlashMenu";const C=w;function k(e){return g.zK(e.textStore,e.oldTextValue,!e.isAddMenu)}function T(e){const{insertActions:t,slashActions:s}=a.w.state;return e.isAddMenu?t:s}function I(){return"fr-FR"===n.SP?375:324}},79845:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Wv});s(21703);var i=s(67294),n=s(83355),a=s(86628),o=s(16184),r=s(31980),l=s(72126),d=s(4615),c=s(3791),u=s(47425),m=s(82990),p=s(31412),g=s(48298),h=s(7512),f=s(50906),y=s(47307),x=s(91376),v=s(75018),S=s(29974),b=s(71119),M=s(54642);async function j(e,t){const s=await M.getEmailDomainSettings(e,{});"success"===s.type&&t.setState({...t.state,emailDomainSettings:s.data});try{const s=await(0,b.pu)(e);t.setState({...t.state,accountSettings:{...s,error:void 0}})}catch(i){t.setState({...t.state,accountSettings:{...t.state.accountSettings,error:i}})}}var w=s(97627),C=s(39699),k=s(37181),T=s(480),I=s(53877),P=s(59730),_=s(80085),Z=s(77420),F=s(19889),A=s(31299),R=s(33954),D=s(33929),B=s(49085),L=s(27617);class N extends B.default{getInitialState(){return{pageNum:1,pageSize:10,timeRange:{},actors:[],actions:[],sortOrder:_.NQ.CreatedNewest}}}const O=new N,E=e=>{const{timeRange:t,actors:s,actions:i,sortOrder:n}=e,a=new URLSearchParams;return t.starting&&a.append("starting",`${I.OQ.toUnixMs(t.starting)}`),t.ending&&a.append("ending",`${I.OQ.toUnixMs(t.ending)}`),(null==s?void 0:s.length)>0&&a.append("actors",s.map(L.eW).join(",")),(null==i?void 0:i.length)>0&&a.append("actions",i.join(",")),a.append("sort",`${n||_.NQ.CreatedNewest}`),a.toString()};class V extends B.default{getInitialState(){return{spaceId:void 0,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set}}isUserOrBotRemoved(e){return Boolean(e&&(this.state.removedUserIds.has(e)||this.state.removedBotIds.has(e)))}}const U=new V;class W extends B.default{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,s){if(s<=1||this.state.spaceId!==e)return;const i=E(t);if(this.state.filterStr!==i)return;const n=this.state.cachedResponses[s-1];return"success"===n.status?null==n?void 0:n.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,s){this.updateResultHelper(e,t,{...s,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,s){const i=E(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===i?this.setState({spaceId:e,filterStr:i,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...s}}}):this.setState({spaceId:e,filterStr:i,cachedResponses:{[t.pageNum||1]:{...s}}})}}const K=new W,z=(0,p.defineMessages)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs"}}),q=async e=>{const{environment:t,spaceId:s}=e,i=await M.getHistoricalAuditLogUsers(t,{spaceId:s});return"success"!==i.type?[]:i.data.results},G=async e=>{const{environment:t,spaceId:s}=e;if(U.getState().spaceId!==s&&U.reset(),!s)return;const[i,n]=await Promise.all([A.Te({environment:t,membersOnly:!1}),q({environment:t,spaceId:s})]),a={spaceId:s,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};i.userIds.forEach((e=>{a.allUserIds.add(e)})),i.botIds.forEach((e=>{a.allBotIds.add(e)})),n.forEach((e=>{var t;(t=e.actorId)!==Z._H.id&&t!==F.s$.id&&t!==F.el.id||a.allUserIds.has(e.actorId)?e.actorType!==F.KJ||a.allUserIds.has(e.actorId)?e.actorType!==Z.cZ||a.allBotIds.has(e.actorId)||(a.allBotIds.add(e.actorId),a.removedBotIds.add(e.actorId)):(a.allUserIds.add(e.actorId),a.removedUserIds.add(e.actorId)):a.allUserIds.add(e.actorId)})),U.setState(a)};var H=s(61652),Q=s(42922),Y=s(52275),$=s(78140),J=s(32163),X=s(53437),ee=s(72495),te=s(26388),se=s(87279),ie=s(80444);class ne extends B.default{getInitialState(){return{open:!1}}}const ae=new ne;var oe=s(85893);const re=(0,p.defineMessages)({30:{id:"auditLogCSV.menu.30days",defaultMessage:"Last 30 days"},60:{id:"auditLogCSV.menu.60days",defaultMessage:"Last 60 days"},90:{id:"auditLogCSV.menu.90days",defaultMessage:"Last 90 days"},365:{id:"auditLogCSV.menu.365days",defaultMessage:"Last 1 year"},Export:{id:"auditLogCSV.menu.export",defaultMessage:"Export"}});class le extends n.Z{constructor(){super(...arguments),this.renderCSVMenu=()=>{const e=[this.getCSVMenuItem(30),this.getCSVMenuItem(60),this.getCSVMenuItem(90),this.getCSVMenuItemWithConfirmation(365)];return(0,oe.jsx)($.Z,{menuType:se.og.Popup,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,sections:[{key:"results",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:e}],initialFocus:0})})},this.getCSVMenuItem=e=>({key:e,render:()=>(0,oe.jsx)(Y.Z,{focused:!1,title:D.default.formatMessage(re[e]),onClick:()=>{this.handleDismiss(),de(this.environment,e)}}),action:()=>{}}),this.getCSVMenuItemWithConfirmation=e=>({key:e,render:()=>(0,oe.jsx)(Y.Z,{focused:!1,title:D.default.formatMessage(re[e]),onClick:()=>{y.showDialog({message:(0,oe.jsx)(p.FormattedMessage,{id:"auditLogCSV.menu.365days.prompt",defaultMessage:"Are you sure you want to export a one year CSV? You can't repeat this action while this is processing in the background."}),showCancel:!0,keepFocus:!0,items:[{label:(0,oe.jsx)(p.FormattedMessage,{id:"AuditLogCSV.exportConfirmationDialog.label",defaultMessage:"Export"}),color:"blue",onAccept:()=>{this.handleDismiss(),de(this.environment,e)}}]})}}),action:()=>{}}),this.handleDismiss=()=>{ae.setState({open:!1})},this.popOpenOptions=e=>{ae.setState({open:e})}}renderComponent(){const e=ae.state;return(0,oe.jsx)(X.ZP,{popupType:X.ZP.PopupType.Popup,open:e.open,placementToOrigin:X.ZP.Placement.Bottom,alignmentToOrigin:X.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,keepFocus:!1,render:this.renderCSVMenu,onDismiss:this.handleDismiss,enableOutsideClickDismiss:!0,origin:(0,oe.jsx)(te.Z,{renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"auditLogCSV.popup.tooltip",defaultMessage:"Click for options to export the Audit Log in CSV form"}),render:t=>(0,oe.jsx)(Q.Z,{isLarge:!0,onClick:()=>this.popOpenOptions(!e.open),...t,children:D.default.formatMessage(re.Export)})})})}}le.displayName="AuditLogCSV";const de=(e,t)=>{const{currentSpaceStore:s}=ie.default.state;s&&H.PN(e,{spaceId:s.id,exportOptions:{duration:t}})},ce=(0,p.injectIntl)(le);var ue=s(69651),me=s(97880),pe=s(48141),ge=s(76150),he=s(13854),fe=s(41558),ye=s(33338),xe=s(3386),ve=s(89728),Se=s(42875),be=s(67950),Me=s(40721),je=s(86825),we=s(46945),Ce=s(84795);const ke="Invalid date",Te="Invalid range";class Ie extends B.default{getInitialState(){return{dateEdited:!1,timeEdited:!1,temporaryValue:{date:void 0,time:void 0},error:void 0}}}const Pe=Ie;var _e=s(74194);class Ze extends n.Z{constructor(){super(...arguments),this.storeTypes={store:Pe},this.renderInput=()=>{const{device:e}=this.environment,{store:t,hideClearButton:s,focus:i,showTime:n,placeholder:a,...o}=this.props,r=e.isMobile?"date":"text",l=e.isMobile?"time":"text",d=_e.Z.Format.Transparent,c=e.isMobile?void 0:i;return(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",borderRadius:4,lineHeight:2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%",...this.getInputStyles().inputOuterStyle},children:[(0,oe.jsx)(_e.Z,{...o,type:r,format:d,placeholder:a,focus:"date"===c,onFocus:this.handleDateFocus,onChange:this.handleDateChange,onSubmit:e=>this.handleSubmit(e,"date"),onBlur:this.handleBlur,value:this.getDateInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:!n&&Ae(this.environment,this.props.hideClearButton),onClearButtonClick:this.handleClear}),n&&(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}}),(0,oe.jsx)(_e.Z,{...o,placeholder:D.default.formatMessage(Re.timePlaceholder),type:l,format:d,focus:"time"===c,onFocus:this.handleTimeFocus,onChange:this.handleTimeChange,onSubmit:e=>this.handleSubmit(e,"time"),onBlur:this.handleBlur,value:this.getTimeInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:Ae(this.environment,this.props.hideClearButton),onClearButtonClick:this.handleClear})]})]})},this.handleDateFocus=e=>{const{onDateFocus:t}=this.props,{store:s}=this.stores;s.setState({...s.state,dateEdited:!1}),t&&t(e)},this.handleTimeFocus=e=>{const{onTimeFocus:t}=this.props,{store:s}=this.stores;s.setState({...s.state,timeEdited:!1}),t&&t(e)},this.handleClear=()=>{const{onClear:e,onUpdate:t}=this.props,{store:s}=this.stores;s.setState({...s.state,dateEdited:!0,timeEdited:!0,temporaryValue:{date:void 0,time:void 0},error:void 0});const i=this.validateCurrent();i&&t(i),s.setState({...s.state,dateEdited:!1,timeEdited:!1}),e&&e()},this.handleDateChange=e=>{const{device:t}=this.environment,{store:s}=this.stores;s.setState({...s.state,dateEdited:!0,temporaryValue:{...s.state.temporaryValue,date:e.target.value||""}}),t.isAndroid&&this.handleBlur()},this.handleTimeChange=e=>{const{device:t}=this.environment,{store:s}=this.stores;s.setState({...s.state,timeEdited:!0,temporaryValue:{...s.state.temporaryValue,time:e.target.value||""}}),t.isAndroid&&this.handleBlur()},this.handleSubmit=(e,t)=>{var s,i;const{onUpdate:n,onSubmit:a,showTime:o}=this.props,{store:r}=this.stores;let l;(!o||"date"===t&&null!==(s=this.props.value)&&void 0!==s&&s.start_time||"time"===t&&null!==(i=this.props.value)&&void 0!==i&&i.start_date)&&(l=this.validateCurrent(),l&&(n(l),l.error?r.setState({...r.state,dateEdited:!1,error:l.error}):r.reset())),a&&a(e,l)},this.handleBlur=e=>{const{onUpdate:t,onBlur:s}=this.props,{store:i}=this.stores,n=this.validateCurrent();n?(t(n),n.error?i.setState({...i.state,dateEdited:!1,timeEdited:!1,error:n.error}):i.reset()):i.setState({...i.state,dateEdited:!1,timeEdited:!1}),e&&s&&s(e)},this.styles={menuItem:{marginBottom:this.environment.device.isMobile?1:12},inputWrapper:{borderRadius:4,height:28,paddingRight:Ae(this.environment,this.props.hideClearButton)?6:0,position:"relative"},inputEditRegion:{width:Ae(this.environment,this.props.hideClearButton)?"calc(100% - 14px)":"100%"},inputEditRegionMobile:{padding:"2px 6px",position:"relative"},tooltipOriginGap:-8}}didUpdate(e){const{store:t}=this.stores;l.Xy(e.value,this.props.value)||t.reset()}renderComponent(){const e=this.styles,t=this.getError();return t?(0,oe.jsx)(te.Z,{renderTooltip:()=>t,forceVisibleState:!0,placement:te.Z.Placement.Left,render:this.renderInput,originGap:e.tooltipOriginGap}):this.renderInput()}getDateInputValue(){const{device:e}=this.environment,{value:t,intl:s}=this.props,{store:i}=this.stores;return e.isMobile?t?L.dd(t,s):"":i.state.temporaryValue.date?i.state.temporaryValue.date:i.state.dateEdited?i.state.temporaryValue.date||"":t?L.dd(t,s):""}getTimeInputValue(){const{device:e}=this.environment,{value:t,intl:s}=this.props,{store:i}=this.stores;return e.isMobile?t?L.KN(t,s):"":i.state.temporaryValue.time?i.state.temporaryValue.time:i.state.timeEdited?i.state.temporaryValue.time||"":t?L.KN(t,s):""}getError(){const{store:e}=this.stores,{intl:t}=this.props;if(e.state.error)switch(e.state.error){case ke:return t.formatMessage({id:"dateInputError.invalidDateError.tooltip",defaultMessage:"Invalid date"});case Te:return t.formatMessage({id:"dateInputError.invalidDateRangeError.tooltip",defaultMessage:"Invalid range"});default:(0,me.t1)(e.state.error)}}validateCurrent(){const{validate:e}=this.props,t=this.parseCurrentDateTimeValue();if(t)return e?e(t):t}parseCurrentDateTimeValue(){const{store:e}=this.stores,{value:t,showTime:s,isEndingDate:i}=this.props;if(!e.state.dateEdited&&!e.state.timeEdited)return;if(!e.state.temporaryValue.date&&!e.state.temporaryValue.time)return{value:void 0};const n=(0,Ce.parseDateValue)(e.state.temporaryValue.date||"",this.props.intl);if(n){let e="";return e=s?(null==t?void 0:t.start_time)||"00:00":i?"23:59":"00:00",{value:{type:"datetime",start_date:n,time_zone:(null==t?void 0:t.time_zone)||(0,Se.r)(),start_time:e}}}const a=(0,Ce.parseTimeValue)(e.state.temporaryValue.time||"",this.props.intl);return(null!=t&&t.start_date||n)&&a?{value:{type:"datetime",start_date:(null==t?void 0:t.start_date)||n,start_time:a,time_zone:(null==t?void 0:t.time_zone)||(0,Se.r)()}}:{error:ke}}getInputStyles(){const{device:e}=this.environment,{inputStyle:t,inputOuterStyle:s,style:i}=this.props,n=this.styles;return{style:{...n.menuItem,...i},inputOuterStyle:{...n.inputWrapper,...s,...this.getInputBorders()},inputStyle:{...n.inputEditRegion,...e.isMobile&&n.inputEditRegionMobile,...t}}}getInputBorders(){const{disabled:e,focus:t}=this.props,s=this.getThemeColors(),i=this.getError();if(!e)return i?s.inputError:t?s.inputFocused:s.inputDefault}getThemeColors(){return{inputDefault:{background:this.theme.inputBackground,boxShadow:this.theme.inputBoxShadow},inputFocused:{boxShadow:this.theme.outlineBlueInputBoxShadow},inputError:{boxShadow:this.theme.outlineRedInputBoxShadow},placeholder:{color:this.theme.lightTextColor}}}}Ze.displayName="DateTimeInputMenuItem";const Fe=(0,p.injectIntl)(Ze);function Ae(e,t){const{device:s}=e;return!!s.isMobile||!t}const Re=(0,p.defineMessages)({startingDateMessage:{defaultMessage:"Starting",id:"auditLog.dateTimeRangeMenu.startingDatePlaceholder"},endingDateMessage:{defaultMessage:"Ending",id:"auditLog.dateTimeRangeMenu.endingDatePlaceholder"},timePlaceholder:{defaultMessage:"12:00 AM",id:"auditLog.dateTimeRangeMenu.timePlaceholderInNumber"}});class De extends n.Z{constructor(){super(...arguments),this.storeTypes={store:he.ZP,dayRangeStore:fe.Z},this.renderInputs=()=>{const{device:e,WindowSizeStore:t}=this.environment,{value:s,disabled:i}=this.props,{store:n}=this.stores,a=n.getFocus();let o="date";a!==ge.Hv.StartTime&&a!==ge.Hv.EndTime||(o="time");const r=function(e,t){const s=e.starting&&L.o0(e.starting,t),i=e.ending&&L.o0(e.ending,t);return{earliestValidEnding:s,latestValidStarting:i}}(this.props.value,this.props.intl);return(0,oe.jsxs)("div",{style:{paddingTop:e.isMobile?16:12,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:n.state.showTime?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0},children:[(0,oe.jsx)(Fe,{disabled:i,placeholder:D.default.formatMessage(Re.startingDateMessage),focus:a===ge.Hv.StartDate||a===ge.Hv.StartTime?o:void 0,value:s.starting,validate:this.validateStart,onUpdate:this.handleUpdateStart,onDateFocus:()=>this.handleDateFocus(ge.Hv.StartDate),onTimeFocus:()=>this.handleTimeFocus(ge.Hv.StartTime),onSubmit:(e,t)=>this.handleStartSubmit(e,t,a),inputElementAttributes:{max:r.latestValidStarting},showTime:n.state.showTime}),(0,oe.jsx)("div",{style:{width:12,height:8}}),(0,oe.jsx)(Fe,{disabled:i,placeholder:D.default.formatMessage(Re.endingDateMessage),focus:a===ge.Hv.EndDate||a===ge.Hv.EndTime?o:void 0,value:s.ending,validate:this.validateEnd,onUpdate:this.handleUpdateEnd,onDateFocus:()=>this.handleDateFocus(ge.Hv.EndDate),onTimeFocus:()=>this.handleTimeFocus(ge.Hv.EndTime),onSubmit:(e,t)=>this.handleEndSubmit(e,t,a),inputElementAttributes:{min:r.earliestValidEnding},showTime:n.state.showTime})]})},this.renderCalendar=()=>{const{device:e}=this.environment,{value:t,onUpdate:s}=this.props,{store:i,dayRangeStore:n}=this.stores,a=this.styles,o=this.getThemeColors(),r={...a.pickerSection,...e.isMobile&&a.pickerSectionMobile,...e.isMobile&&o.pickerSectionMobile};return(0,oe.jsx)(ee.Z,{children:(0,oe.jsx)("div",{style:r,children:(0,oe.jsx)(we.Z,{value:L.Zy(t),dateTimeStore:i,store:n,onUpdate:e=>{if(e.error)return;const i=L.PM(t,e.value);return s({error:e.error,value:i})},validate:this.validateDateRangeField})})})},this.handleDateFocus=e=>{const{store:t,dayRangeStore:s}=this.stores;t.setState({...t.state,focus:e});const i=he.QJ[e];s.setState({...s.state,focus:i})},this.handleTimeFocus=e=>{const{store:t}=this.stores;t.setState({...t.state,focus:e})},this.handleUpdateStart=e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,starting:e.value}})},this.handleUpdateEnd=e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,ending:e.value}})},this.handleStartSubmit=(e,t,s)=>{const{store:i,dayRangeStore:n}=this.stores;t&&t.error||(s===ge.Hv.StartDate&&i.state.showTime?i.setState({...i.state,focus:ge.Hv.StartTime}):(i.setState({...i.state,focus:ge.Hv.EndDate}),n.setState({...n.state,focus:"ending"})))},this.handleEndSubmit=(e,t,s)=>{const{store:i}=this.stores;t&&t.error||s===ge.Hv.EndDate&&i.state.showTime&&i.setState({...i.state,focus:ge.Hv.EndTime})},this.validateStart=e=>{const t=this.validateField("starting",e);return t.error?t:{value:t.value.starting}},this.validateEnd=e=>{const t=this.validateField("ending",e);return t.error?t:{value:t.value.ending}},this.validateField=(e,t)=>{const{value:s}=this.props;return t.error?t:this.validateRange({...s,[e]:t.value})},this.validateRange=e=>{if(e.starting&&e.ending){const t=I.OQ.notionDateTimeToLuxon(e.starting);return I.OQ.notionDateTimeToLuxon(e.ending)>=t?{value:e}:{error:be.B.INVALID_RANGE}}return{value:e}},this.getMenuProps=()=>{const{device:e}=this.environment,{onDismiss:t,title:s}=this.props;if(e.isMobile){return{menuType:se.og.Modal,title:s,right:(0,oe.jsx)(Me.DoneMenuText,{}),onClickRight:t,header:this.renderInputs()}}return{menuType:se.og.Popup,onClickOutside:t,footer:this.props.footer}},this.validateDateRangeField=(e,t)=>{const{value:s}=this.props;if(t.error)return t;const i=L.Zy(s);return this.validateDateRange({...i,[e]:t.value})},this.validateDateRange=e=>{if(e.starting&&e.ending){const t=I.OQ.notionDateToLuxon(e.starting);return I.OQ.notionDateToLuxon(e.ending)>=t?{value:e}:{error:be.B.INVALID_RANGE}}return{value:e}},this.styles={pickerSection:{paddingLeft:16,paddingRight:16},pickerSectionMobile:{paddingTop:16,paddingBottom:8},sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 220px",backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:`1px solid ${this.theme.regularDividerColor}`,maxWidth:"fit-content"},menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4,color:this.theme.mediumTextColor}}}didMount(){const{store:e}=this.stores;void 0!==this.props.showTime&&e.setState({...e.state,showTime:this.props.showTime})}renderComponent(){const{device:e}=this.environment;return(0,oe.jsx)($.Z,{...this.getMenuProps(),children:(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,oe.jsxs)("div",{children:[this.props.header,!e.isMobile&&this.renderInputs(),this.renderCalendar()]}),this.renderSidebar()]})})}renderSidebar(){const{store:e}=this.stores,{onUpdate:t,value:s,hideTime:i}=this.props;return(0,oe.jsxs)("aside",{style:this.styles.sidebar,children:[i?null:(0,oe.jsx)(je.Z,{title:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogDateFilter.timeToggle",defaultMessage:"Use time"}),on:e.state.showTime,onClick:()=>{if(e.toggleShowTime(),e.state.showTime){const e=s;e.starting&&(e.starting.start_time="00:00"),e.ending&&(e.ending.start_time="23:59"),t({value:e})}},focused:!1}),(0,oe.jsx)(Y.Z,{focused:!1,title:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogDateFilter.quickFilters.today",defaultMessage:"Today"}),onClick:()=>{const e=Date.now(),t=I.CQ(e,(0,Se.r)());this.setStoresTemporaryValue({starting:{...t,start_time:"00:00"},ending:t})},style:this.styles.menuItem}),(0,oe.jsx)(Y.Z,{focused:!1,title:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogDateFilter.quickFilters.yesterday",defaultMessage:"Yesterday"}),onClick:()=>{const e=I.Cv((0,Se.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,Se.r)()},ending:{type:"datetime",start_date:e.start_date,start_time:"23:59",time_zone:(0,Se.r)()}})},style:this.styles.menuItem}),(0,oe.jsx)(Y.Z,{focused:!1,title:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastWeek",defaultMessage:"Last 7 days"}),onClick:()=>{const e=I.Oo((0,Se.r)()),t=I.CQ(Date.now(),(0,Se.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,Se.r)()},ending:t})},style:this.styles.menuItem}),(0,oe.jsx)(Y.Z,{focused:!1,title:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastMonth",defaultMessage:"Last 30 days"}),onClick:()=>{const e=I.dj((0,Se.r)()),t=I.CQ(Date.now(),(0,Se.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,Se.r)()},ending:t})},style:this.styles.menuItem})]})}setStoresTemporaryValue(e){const{store:t,dayRangeStore:s}=this.stores;e.ending&&this.handleDateFocus(ge.Hv.EndDate),t.setState({...t.state,temporaryDateRange:e}),s.setState({...s.state,displayMonth:e.starting||e.ending?I.Sy(e.starting||e.ending):void 0,temporaryDateRange:{starting:L.Qb(e.starting),ending:L.Qb(e.ending)}})}getThemeColors(){return{pickerSectionMobile:{background:this.theme.popoverBackground,boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1}}}}De.displayName="DateTimeRangeMenu";const Be=(0,p.injectIntl)(De);var Le=s(255),Ne=s(8319),Oe=s(75689),Ee=s(91642);class Ve extends n.Z{constructor(){super(...arguments),this.storeTypes={store:he.ZP,dayRangeStore:fe.Z},this.renderActiveButtonOrigin=()=>{const{value:e,disabled:t,focused:s,intl:i}=this.props,n=this.styles,a=this.getThemeColors(),o={...n.menuItem,...a.activeMenuItem},r=pe._Q(e,i),l=(0,oe.jsx)(Le.Z,{onClick:this.handleClear,disabled:t});return(0,oe.jsx)(Y.Z,{focused:s,disabled:t,icon:(0,ue.C)(n.iconActiveDesktop),title:r,right:l,isTokenTitle:!0,alignIconTop:!0,onClick:this.handleOriginActivate,desktopTitleStyle:n.menuItemTitleDesktop,desktopIconStyle:n.iconActiveDesktopWrapper,style:o})},this.renderInactiveButtonOrigin=()=>{const{title:e,icon:t,disabled:s,focused:i,mode:n}=this.props,a=this.styles,o=this.getThemeColors(),r={...a.menuItem,...o.buttonMenuItem,...n===Ne.Z.Mode.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return(0,oe.jsx)(Y.Z,{focused:i,disabled:s,icon:t(a.icon),title:e,onClick:this.handleOriginActivate,style:r})},this.renderPillButtonOrigin=()=>{const{value:e,pillTitle:t}=this.props,s=(0,oe.jsx)(p.FormattedMessage,{id:"searchDateFilter.shortTitle",defaultMessage:"Date"});return(0,oe.jsx)(ye.Z,{on:Boolean(e.starting||e.ending),icon:(0,ue.C)({width:16,marginRight:6,fill:"currentColor"}),title:(0,oe.jsx)("span",{children:t||s}),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e,header:t,showButtons:s,sidebar:i,hideTime:n}=this.props,{store:a,dayRangeStore:o}=this.stores;return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Be,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:a,dayRangeStore:o,onDismiss:this.handleMenuClose,footer:"footer"===s&&this.renderFooter(),sidebar:i,hideTime:n,header:t}),"side"===s&&(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"},children:[(0,oe.jsx)(ve.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleMenuClose,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})}),(0,oe.jsx)(Q.Z,{onClick:()=>this.props.onChange(this.stores.store.state.temporaryDateRange),children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"})})]})]})},this.renderFooter=()=>{const{store:e,dayRangeStore:t}=this.stores;return(0,oe.jsxs)(ee.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},children:[(0,oe.jsx)(ve.Z,{onClick:()=>{e.clearTemporaryDateRange(),t.clearTemporaryDateRange(),this.props.onChange({starting:void 0,ending:void 0})},children:(0,oe.jsx)(p.FormattedMessage,{id:"searchDateFilter.clearButton",defaultMessage:"Clear"})}),(0,oe.jsx)(Q.Z,{onClick:e=>{this.props.onChange(this.stores.store.state.temporaryDateRange),this.handleMenuClose(e)},children:(0,oe.jsx)(p.FormattedMessage,{id:"searchDateFilter.applyButton",defaultMessage:"Apply"})})]})},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t,dayRangeStore:s}=this.stores;e||(t.setState({...t.state,isOpen:!0,focus:ge.Hv.StartDate}),s.setState({...s.state,isOpen:!0,focus:"starting"}))},this.handleMenuClose=e=>{const{onChange:t,onMenuDismiss:s,showButtons:i}=this.props,{store:n,dayRangeStore:a}=this.stores,{temporaryDateRange:o}=n.state;pe.zD(e)||(i||t(o),n.setState({...n.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),a.setState({...a.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),s&&s())},this.handleClear=()=>{const{onChange:e}=this.props;e({starting:void 0,ending:void 0})},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t,dayRangeStore:s}=this.stores;if(e.error)return;const i={starting:(0,L.Qb)(e.value.starting),ending:(0,L.Qb)(e.value.ending)};return s.setState({...s.state,temporaryDateRange:{...s.state.temporaryDateRange,...i}}),t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:16,width:16,marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:0,paddingBottom:8},popupWithSidebar:{display:"flex"},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t,sidebar:s}=this.props,{store:i}=this.stores,n=this.styles,a=e===Ne.z.Section,o=a?t:void 0,r=(()=>e===Ne.Z.Mode.Section?this.renderActiveButtonOrigin():e===Ne.Z.Mode.Button?this.renderInactiveButtonOrigin():e===Ne.Z.Mode.Pill?this.renderPillButtonOrigin():void(0,me.t1)(e))();return(0,oe.jsx)(Ee.Z,{title:o,marginAfter:a,children:(0,oe.jsx)(xe.Z,{capture:i.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey,children:(0,oe.jsx)(X.ZP,{popupType:We(this.environment),open:i.state.isOpen,origin:r,render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:X.ZP.Placement.Bottom,alignmentToOrigin:X.ZP.Alignment.Start,style:s?n.popupWithSidebar:n.popup})})})}renderMobile(e){const{store:t}=this.stores,s=e===Ne.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return(0,oe.jsx)(X.ZP,{popupType:X.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:s,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:s}=this.props,i=this.styles;return(0,oe.jsx)(Y.Z,{disabled:s,focused:!1,icon:e(i.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,disabled:s,intl:i}=this.props,n=this.styles,a=(0,oe.jsxs)("div",{style:n.summary,children:[(0,ue.C)(n.iconActiveMobile),pe._Q(t,i)]});return(0,oe.jsx)(Oe.Z,{disabled:s,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:a})}getCurrentValue(){const{value:e}=this.props,{store:t}=this.stores,{temporaryDateRange:s}=t.state;return{...e,...s}}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},activeMenuItem:{color:this.theme.regularTextColor}}}}Ve.displayName="DateTimeFilter";const Ue=(0,p.injectIntl)(Ve);function We(e){const{device:t}=e;return t.isMobile?X.ZP.PopupType.SlideUp:X.ZP.PopupType.Popup}var Ke=s(66897),ze=s(22686),qe=s(74136),Ge=s(97680),He=s(26350);class Qe extends B.default{getInitialState(){return{tempSelections:new Set([])}}setTempSelections(e){this.setState({tempSelections:new Set(e)})}}class Ye extends n.Z{constructor(){super(...arguments),this.storeTypes={localStore:Qe},this.renderResultMenuItem=(e,t)=>{var s;const{intl:n,auditLogHistoricalUserStore:a}=this.props,{localStore:o}=this.stores,r=this.getActor(e);return(0,i.createElement)(Ge.Z,{...t,key:e,actor:r,useEmailAsTooltip:!0,checkState:o.state.tempSelections.has(e),userTitle:(0,oe.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,Ke.$4)(n,r),a.isUserOrBotRemoved(null===(s=r.asActor)||void 0===s?void 0:s.id)&&(0,oe.jsx)(qe.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogActorFilter.removed_user",defaultMessage:"Removed"})})]})})},this.performRequest=async e=>{let{query:t,current:s}=e;const{allUserIds:i,allBotIds:n}=this.props.auditLogHistoricalUserStore.getState(),a=await A.ri({environment:this.environment,query:t,userIds:[...i],botIds:[...n]}),o=[...a.users.map((e=>`notion_user:${e.id}`)),...a.bots.map((e=>`bot:${e.id}`))];if(t.length>0)return o.slice(0,100);const r=this.props.selectedActors.map(L.eW),l=new Set(r),d=o.filter((e=>!l.has(e)));return[...r,...d].slice(0,Math.max(r.length,100))},this.createUserValue=e=>He.U6.createChildStore(this.props.parentStore,{table:F.KJ,id:e}).getValue(),this.createBotValue=e=>(0,He.Kv)(this.props.parentStore,{table:Z.cZ,id:e}).getValue()}didMount(){this.updateTempSelectionFromProps()}renderComponent(){const{selectedActors:e,intl:t}=this.props,{localStore:s}=this.stores,i=(0,oe.jsx)(p.FormattedMessage,{id:"auditlogActorFilter.title",defaultMessage:"User"});return(0,oe.jsx)(Ne.Z,{mode:Ne.z.Pill,title:i,icon:ze.f,iconStyles:{marginRight:2},items:Array.from(s.state.tempSelections),hasItemsSelected:(null==e?void 0:e.length)>0,onChange:e=>{s.setTempSelections(e)},renderFooter:!0,allowApplyBatchSelection:!0,keepInputOnItemConfirm:!0,onMenuDismiss:e=>{"applyButton"!==e?this.updateTempSelectionFromProps():this.updateOnChangeToParent()},labelText:{title:i,tokenInputPlaceholder:t.formatMessage({defaultMessage:"Search user...",id:"auditlogActorFilter.searchActor.placeholder"}),resultSectionTitle:t.formatMessage({defaultMessage:"Select users",id:"auditlogActorFilter.searchActor.resultsTitle"}),componentDebugName:"SearchActorFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}updateOnChangeToParent(){const{onChange:e}=this.props,{localStore:t}=this.stores;e(Array.from(t.state.tempSelections).map(L.Ij).filter((e=>Boolean(e))))}updateTempSelectionFromProps(){const{selectedActors:e}=this.props,{localStore:t}=this.stores,s=e.map(L.eW);t.setTempSelections(s)}getActor(e){const t=(0,L.Ij)(e);return t?"notion_user"===t.actorType?(0,Ke.m3)(this.createUserValue(t.actorId)):(0,Ke.ON)(this.createBotValue(t.actorId)):(0,Ke.m3)(void 0)}}Ye.displayName="AuditLogActorFilter";const $e=(0,p.injectIntl)(Ye);s(57658);var Je=s(24405),Xe=s(11378),et=s(8848),tt=s(61275),st=s(58573),it=s(67220),nt=s(60458),at=s(64369),ot=s(4708),rt=s(95697),lt=s(77080),dt=s(29798);let ct=function(e){return e.All="All",e.Partial="Partial",e.None="None",e}({});class ut extends B.default{getInitialState(){return{categorySelections:{page:ct.All,space:ct.All,team:ct.All,account:ct.All},categoryToggleOpen:{page:!0,space:!0,team:!0,account:!0},searchQuery:void 0,actionSelections:(0,me.Xc)(_.yv,(()=>!0)),isMenuOpen:!1,renderOrder:[{category:"page",orderedActions:_.dq.page},{category:"space",orderedActions:_.dq.space},{category:"account",orderedActions:_.dq.account},{category:"team",orderedActions:_.dq.team}]}}getAllActionNames(){return(0,me.Yd)(this.state.actionSelections)}getSelectedActionNames(){return this.getAllActionNames().filter((e=>this.state.actionSelections[e]))}hasActionNameSelected(){const e=this.getAllActionNames(),t=this.getSelectedActionNames();return t.length>0&&t.length!==e.length}updateSearchQuery(e){this.setState({...this.state,searchQuery:e})}toggleCategorySelection(e){const t=e.category;this.setState({...this.state,categoryToggleOpen:{...this.state.categoryToggleOpen,[t]:!this.state.categoryToggleOpen[t]}})}selectCategorySelection(e){const t=e.category,s=this.state.categorySelections[t],i=s===ct.None||s===ct.Partial?ct.All:ct.None,n=i===ct.All,a={...this.state.actionSelections},o=this.state.renderOrder.find((e=>e.category===t));o&&(o.orderedActions.forEach((e=>{a[e]=n})),this.setState({...this.state,actionSelections:a,categorySelections:{...this.state.categorySelections,[o.category]:i}}))}selectActionName(e,t){const s=this.state.actionSelections[e],i={...this.state.actionSelections,[e]:!s},n=t.orderedActions.filter((e=>i[e])).length,a=0===n?ct.None:n===t.orderedActions.length?ct.All:ct.Partial;this.setState({...this.state,actionSelections:i,categorySelections:{...this.state.categorySelections,[t.category]:a}})}clearAllSelections(){const e=this.getBulkUpdateNextActionSelectionState((0,me.Yd)(this.state.actionSelections),!1),t=this.getBulkUpdateNextCategorySelectionState((0,me.Yd)(this.state.categorySelections),ct.None);this.setState({...this.state,actionSelections:e,categorySelections:t})}getBulkUpdateNextCategorySelectionState(e,t){const s={...this.state.categorySelections};return e.forEach((e=>{s[e]=t})),s}getBulkUpdateNextActionSelectionState(e,t){const s={...this.state.actionSelections};return e.forEach((e=>{s[e]=t})),s}}var mt=s(5210);const pt={page:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.categoryName.page",defaultMessage:"Page"}),space:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.categoryName.workspace",defaultMessage:"Workspace"}),team:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.categoryName.team",defaultMessage:"Teamspace"}),account:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.categoryName.account",defaultMessage:"Account"})};function gt(e){let{totalNumEventsForCategory:t,numSelectedForCategory:s,category:i,categoryOpen:n,shouldShowCount:a,onCategoryClick:o,onCategoryToggleClick:r,...l}=e;window.__c={n:"AuditLogCategoryMenuItem"};const d=(0,Je.yK)((e=>({textWrapperStyle:{margin:0},title:{margin:0,display:"flex",alignItems:"center"},categoryText:{marginLeft:8,fontWeight:600},categorySubHeader:{marginLeft:6},toggleButton:{marginLeft:2,marginRight:2}})),[]);let c,u;return c=a?t===s?(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.allEventsSelected",defaultMessage:"({totalNum} events)",values:{totalNum:t}}):(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.numEventsSelected",defaultMessage:"({numSelected} of {totalNum} events selected)",values:{numSelected:s,totalNum:t}}):null,u=t===s||0!==s&&"partial",(0,oe.jsx)(Y.Z,{...l,className:"notranslate",textWrapperStyle:d.textWrapperStyle,focused:!1,title:(0,oe.jsxs)("div",{style:d.title,children:[(0,oe.jsx)(mt.Z,{style:d.toggleButton,open:n,onClick:r,isSidebar:!1,fill:!1,icon:"chevron"}),(0,oe.jsx)(nt.Z,{checked:u,size:14,checkSize:8,onClick:o}),(0,oe.jsx)(at.Z,{style:d.categoryText,children:pt[i]}),(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:d.categorySubHeader,children:c})]})})}class ht extends n.Z{constructor(){super(...arguments),this.storeTypes={componentStore:ut,lastSelectionStore:ut,menuListStore:dt.Z},this.renderMenu=()=>{const{componentStore:e,menuListStore:t}=this.stores,s=this.styles,i=[];let n=0,a=0;const o=e.state.searchQuery;for(const l of e.state.renderOrder){const t=l.category;if("team"===t&&!(0,rt.bq)())continue;const s=[];let r=0;for(const i of l.orderedActions)this.eventsToFilterOut.includes(i)||(s.push(this.renderActionNameMenu(i,l)),e.state.actionSelections[i]&&r++);if(n+=r,a+=s.length,i.push(this.renderCategoryMenu({renderGroup:l,shouldShowCount:!Boolean(o),totalNumEventsForCategory:s.length,numSelectedForCategory:r})),e.state.categoryToggleOpen[t])if(o){const e=(0,st.ZP)(o,s,yt);i.push(...e)}else i.push(...s)}const r={key:"results",items:i,render:e=>(0,oe.jsx)(ee.Z,{...e,title:null,loading:!1})};return(0,oe.jsxs)("div",{style:s.container,children:[(0,oe.jsx)(_e.Z,{style:s.searchInput,placeholder:this.props.intl.formatMessage({id:"auditlogEventFilter.searchPlaceholder",defaultMessage:"Search for an event"}),onChange:this.handleUpdateSearchQuery,value:e.state.searchQuery,showClearButton:!0}),o&&(0,oe.jsx)(xt,{totalNumSelected:n,totalNumEvents:a}),(0,oe.jsx)($.Z,{menuType:se.og.Popup,header:null,maxHeight:356,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,store:t,initialFocus:0,sections:[r]})}),(0,oe.jsxs)(ee.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},children:[(0,oe.jsx)(ve.Z,{onClick:()=>{this.handleClear()},children:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.clearButton",defaultMessage:"Clear"})}),(0,oe.jsx)(Q.Z,{onClick:()=>{this.handleApply()},children:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.applyButton",defaultMessage:"Apply"})})]})]})},this.renderPillButtonOrigin=e=>{const{componentStore:t}=this.stores,s=t.hasActionNameSelected();return(0,oe.jsx)(ye.Z,{on:s,icon:(0,it.S)({width:16,marginRight:6,fill:"currentColor"}),title:(0,oe.jsx)("span",{children:e}),onClick:()=>{this.setMenuOpen(!0)}})},this.featureGatedEventsToFilterOut=(0,me.qP)(Xe.lo).reduce(((e,t)=>{let[s,i]=t;return lt.default.checkGate(s)?e:[...e,...i]}),[]),this.teamspaceGuestEventsToFilterOut=(0,ot.F$)()?[]:["team_guest_default_permission_updated"],this.guestMembershipEventsToFilterOut=(0,ot.Ye)()?[]:["guest_membership_requests_toggled"],this.eventsToFilterOut=[...this.featureGatedEventsToFilterOut,...this.teamspaceGuestEventsToFilterOut,...this.guestMembershipEventsToFilterOut],this.setMenuOpen=e=>{const{componentStore:t}=this.stores;t.setState({...t.state,isMenuOpen:e})},this.handleUpdateSearchQuery=e=>{this.stores.componentStore.updateSearchQuery(e.target.value)},this.styles={container:{minWidth:460},searchInput:{padding:8,borderBottomLeftRadius:0,borderBottomRightRadius:0,boxShadow:"none",borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:this.theme.lightDividerColor},popup:{paddingBottom:8}}}renderComponent(){const{componentStore:e}=this.stores,t=this.styles,s=(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.title",defaultMessage:"Event"}),i=this.renderPillButtonOrigin(s);return(0,oe.jsx)(Ee.Z,{marginAfter:!1,children:(0,oe.jsx)(X.ZP,{popupType:X.ZP.PopupType.Popup,placementToOrigin:X.ZP.Placement.Bottom,alignmentToOrigin:X.ZP.Alignment.Start,open:e.state.isMenuOpen,render:this.renderMenu,onDismiss:()=>{this.handleMenuCloseFromOutside()},keepFocus:!0,origin:i,preventScaleTransition:!0,style:t.popup})})}renderCategoryMenu(e){const{renderGroup:t,shouldShowCount:s,totalNumEventsForCategory:i,numSelectedForCategory:n}=e,{componentStore:a}=this.stores,o=t.category,r=()=>{a.toggleCategorySelection(t)},l=()=>{a.selectCategorySelection(t)};return{key:o,action:r,render:e=>(0,oe.jsx)(gt,{totalNumEventsForCategory:i,numSelectedForCategory:n,category:o,categoryOpen:a.state.categoryToggleOpen[o],shouldShowCount:s,onCategoryToggleClick:r,onCategoryClick:l,...e}),localizedActionName:null,actionName:null}}renderActionNameMenu(e,t){const{intl:s}=this.props,{componentStore:i}=this.stores,n=()=>{i.selectActionName(e,t)},a=s.formatMessage(tt.TE[e]);return{key:e,action:n,render:t=>(0,oe.jsx)(Y.Z,{...t,icon:(0,oe.jsx)(nt.Z,{checked:i.state.actionSelections[e],size:14,checkSize:8,onClick:n}),focused:!1,title:a,className:"notranslate",style:{paddingLeft:32},textWrapperStyle:{marginLeft:4}}),actionName:e,localizedActionName:a}}handleMenuCloseFromOutside(){const{componentStore:e,lastSelectionStore:t}=this.stores;e.setState({...e.state,actionSelections:{...t.state.actionSelections}}),this.setMenuOpen(!1)}handleClear(){const{componentStore:e}=this.stores;e.clearAllSelections()}handleApply(){const{onChange:e}=this.props,{componentStore:t,lastSelectionStore:s}=this.stores,i=t.getAllActionNames(),n=t.getSelectedActionNames();e(i.length===n.length?[]:n),0===n.length&&t.reset(),s.setState({...s.state,actionSelections:{...t.state.actionSelections}}),this.setMenuOpen(!1)}}ht.displayName="AuditLogEventFilter";const ft=(0,p.injectIntl)(ht);function yt(e){var t;return l.oA([e.key,null===(t=e.localizedActionName)||void 0===t?void 0:t.toLowerCase()]).join(" ")}function xt(e){let{totalNumSelected:t,totalNumEvents:s}=e;window.__c={n:"SelectedEventsPill"};const i=(0,Je.yK)((e=>({container:{background:et.ZP.diffBackground,color:et.ZP.diffTextColor,paddingInline:6,margin:8,marginBottom:0,borderRadius:4,fontWeight:510,width:"fit-content"},textWrapperStyle:{marginLeft:8}})),[]);return(0,oe.jsx)(at.Z,{style:i.container,children:(0,oe.jsx)(p.FormattedMessage,{id:"auditLogEventFilter.selectedPill",defaultMessage:"{totalNumSelected} of {totalNumEvents} selected",values:{totalNumSelected:t,totalNumEvents:s}})})}const vt=(0,p.injectIntl)((function(e){window.__c={n:"AuditLogFilterContainer"};const{spaceStore:t}=e,[s,i]=(0,a.AF)(O),[n,o,r]=(0,a.AF)(U);return(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:4},children:[(0,oe.jsx)(Ue,{mode:Ne.z.Pill,focused:!1,title:(0,oe.jsx)(p.FormattedMessage,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:ue.C,value:s.timeRange,showButtons:"footer",onChange:e=>{i({...s,timeRange:e,pageNum:1})}}),(0,oe.jsx)($e,{parentStore:t,auditLogHistoricalUserStore:r,selectedActors:s.actors,onChange:e=>{i({...s,actors:e,pageNum:1})}}),(0,oe.jsx)(ft,{parentStore:t,selectedEvents:s.actions,onChange:e=>{i({...s,actions:e,pageNum:1})}})]})}));var St=s(63296),bt=s(23189),Mt=s(95477);function jt(){return(0,oe.jsxs)(bt.Z,{large:!0,style:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:m.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},children:[(0,oe.jsx)("div",{style:{gap:8,display:"flex"},children:(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.title",defaultMessage:"Audit log"})}),(0,oe.jsx)(wt,{})]})}function wt(){window.__c={n:"AuditLogFeedbackButton"};const e=(0,T.O7)();return Mt.default.isLocalhost?(0,oe.jsx)(St.Z,{style:{marginLeft:10},isSmall:!0,onClick:()=>{v.navigateToExternalURL({environment:e,url:"https://dev.notion.so/notion/Audit-Log-Dev-feedback-e9048c4e7d544369b0b8413ec20f02cf",targetSelf:!0})},children:"🎁 Feedback is a gift!"}):null}var Ct=s(43568);const kt=function(){return(0,oe.jsx)("div",{style:{},children:(0,oe.jsx)(Ct.Z,{paragraphs:[{lineHeight:45,lineMargin:20,sectionWidths:[100],repeat:1,sectionMargin:15},{lineHeight:40,lineMargin:5,sectionWidths:[100],repeat:8,sectionMargin:10}]})})};var Tt=s(75553),It=s(14871),Pt=s(40394),_t=s(64921),Zt=s(21752);function Ft(e){window.__c={n:"AuditLogColumnActor"};const{auditLogEntry:t,spaceStore:s,id:n}=e,o=(0,p.useIntl)(),r=(0,a.VK)((()=>{if(t.actor.actorType===F.KJ){const e=He.U6.createChildStore(s,{id:t.actor.actorId,table:F.KJ});if(e.isDefined()&&!e.getIsDeleted())return{actorStore:e};if(t.actor.email)return{avatar:{name:t.actor.name,email:t.actor.email}}}else if(t.actor.actorType===Z.cZ){const e=He.Qx.createChildStore(s,{id:t.actor.actorId,table:Z.cZ});return e.isDefined()?{actorStore:e}:{avatar:{name:t.actor.name,email:t.actor.actorId}}}return{actorStore:void 0}}),[s,t]),l=(0,a.VK)((()=>{var e,t;if(r)return(null===(e=r.actorStore)||void 0===e?void 0:e.getDisplayName(o))??(null===(t=r.avatar)||void 0===t?void 0:t.name)}),[r,o]),d=(0,a.VK)((()=>{var e,t;if(r)return(null===(e=r.actorStore)||void 0===e?void 0:e.getDetail())??(null===(t=r.avatar)||void 0===t?void 0:t.email)}),[r]),c=(0,i.useMemo)((()=>{var e;if(t.actor.actorType===F.KJ)return(0,Zt.K)(null===(e=t.actor.meta)||void 0===e?void 0:e.spaceRole)}),[t]),u=(0,Je.yK)((()=>({container:{display:"block",width:"100%",paddingBlock:6}})),[]),m=(0,i.createRef)();return(0,oe.jsx)(te.Z,{disableTooltip:At(m.current),renderTooltip:()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{children:l}),(0,oe.jsx)("div",{children:d})]}),placement:te.Z.Placement.Bottom,render:e=>(0,oe.jsx)("div",{...e,style:u.container,children:(0,oe.jsx)(Zt.Z,{id:n,...r,spaceRole:c})})})}function At(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var Rt=s(13991),Dt=s(7057),Bt=s(4023);function Lt(e){window.__c={n:"AuditLogColumnDateTime"};const{auditLogEntry:t,id:s}=e,i=(0,Je.yK)((()=>({container:{display:"block",width:"100%"}})),[]);return(0,oe.jsx)(te.Z,{renderTooltip:()=>(0,oe.jsx)("div",{style:{display:"flex",flexDirection:"column",fontVariantNumeric:"tabular-nums"},children:(0,oe.jsx)("div",{children:(0,oe.jsx)(p.FormattedMessage,{id:"auditLogSettings.timeTooltip.utcTime",defaultMessage:"UTC: {time}",values:{time:(0,Dt.$I)(t.serverTimestamp)}})})}),render:e=>(0,oe.jsx)("div",{id:s,style:i.container,children:(0,oe.jsx)(at.Z,{isSecondaryColor:!0,...e,children:(0,Dt.Yx)(t.serverTimestamp,"medium_with_time",Rt.SP)})}),placement:Bt.u.Bottom})}var Nt=s(44317),Ot=s(68626),Et=s(26825),Vt=s(21202),Ut=s(19639),Wt=s(15047),Kt=s(29369),zt=s(73123);function qt(e){return"workspace"!==e}const Gt=(0,p.defineMessages)({password_cleared:{id:"auditlog.actionNames.eventColumn.password_cleared",defaultMessage:"Cleared login password"},password_set:{id:"auditlog.actionNames.eventColumn.password_set",defaultMessage:"Created a login password"},password_changed:{id:"auditlog.actionNames.eventColumn.password_changed",defaultMessage:"Changed login password"},logout:{id:"auditlog.actionNames.eventColumn.logout",defaultMessage:"Logged out"},user_deleted:{id:"auditlog.actionNames.eventColumn.user_deleted",defaultMessage:"User was deleted"},member_joined:{id:"auditlog.actionNames.eventColumn.member_joined",defaultMessage:"Joined the workspace"},file_uploaded:{id:"auditlog.actionNames.eventColumn.file_uploaded",defaultMessage:"Uploaded a file"},invite_link_reset:{id:"auditlog.actionNames.eventColumn.invite_link_reset",defaultMessage:"Reset invite link"},workspace_exported:{id:"auditlog.actionNames.eventColumn.workspace_exported",defaultMessage:"Exported all workspace content"},audit_log_exported:{id:"auditlogEventFilter.eventColumn.audit_log_exported",defaultMessage:"Exported audit log for last {duration} days"},user_analytics_exported:{id:"auditlogEventFilter.eventColumn.user_analytics_exported",defaultMessage:"Exported user analytics for {daysFilterString}"},content_analytics_exported:{id:"auditlogEventFilter.eventColumn.content_analytics_exported",defaultMessage:"Exported content analytics for {daysFilterString}"},workspace_icon_changed:{id:"auditlog.actionNames.eventColumn.workspace_icon_changed",defaultMessage:"Changed workspace icon"},public_page_cleared:{id:"auditlogEventFilter.actionNames.public_page_cleared",defaultMessage:"Public home page link cleared"},scim_token_generated:{id:"auditlog.actionNames.scim_token_generated",defaultMessage:"Generated API SCIM token"},scim_token_revoked:{id:"auditlog.actionNames.scim_token_revoked",defaultMessage:"Revoked API SCIM token"},"workspace.members_exported":{id:"auditlog.actionName.eventColumn.workspace.members_exported",defaultMessage:"Exported workspace members CSV"},page_access_requests_toggled:{id:"auditlog.actionNames.eventColumn.page_access_requests_toggled",defaultMessage:"page access requests from non-members"},public_page_sharing_toggled:{id:"auditlog.actionNames.eventColumn.public_page_sharing_toggled",defaultMessage:"members sharing pages publicly"},workspace_sidebar_editing_toggled:{id:"auditlog.actionNames.eventColumn.workspace_sidebar_editing_toggled",defaultMessage:"members changing the Workspace section"},disable_team_guests_toggled:{id:"auditlog.actionNames.eventColumn.disable_team_guests_toggled",defaultMessage:"teamspace guests"},disable_guests_toggled:{id:"auditlog.actionNames.eventColumn.disable_guests_toggled",defaultMessage:"guests"},pages_to_other_workspaces_toggled:{id:"auditlog.actionNames.eventColumn.pages_to_other_workspaces_toggled",defaultMessage:"moving or duplicating pages to other workspaces"},export_toggled:{id:"auditlog.actionNames.eventColumn.export_toggled",defaultMessage:"export"},idp_metadata_xml_updated:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_updated",defaultMessage:"Updated IDP metadata XML"},idp_metadata_xml_removed:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_removed",defaultMessage:"Removed IDP metadata XML"},saml_enabled:{id:"auditlog.actionNames.saml_enabled",defaultMessage:"Enabled SAML"},saml_disabled:{id:"auditlog.actionNames.saml_disabled",defaultMessage:"Disabled SAML"},saml_enforced:{id:"auditlog.actionNames.saml_enforced",defaultMessage:"Enabled enforcing SAML"},saml_unenforced:{id:"auditlog.actionNames.saml_unenforced",defaultMessage:"Disabled enforcing SAML"},automatic_account_creation_enabled:{id:"auditlog.actionNames.automatic_account_creation_enabled",defaultMessage:"Enabled automatically creating accounts on sign-in"},automatic_account_creation_disabled:{id:"auditlog.actionNames.automatic_account_creation_disabled",defaultMessage:"Disabled automatically creating accounts on sign-in"},workspace_analytics_enabled:{id:"auditlog.actionNames.workspace_analytics_enabled",defaultMessage:"Enabled page view tracking for workspace analytics"},workspace_analytics_disabled:{id:"auditlog.actionNames.workspace_analytics_disabled",defaultMessage:"Disabled page view tracking for workspace analytics"},enabled:{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumnPrefix.enabled"},disabled:{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.disabled"},a_private_page:{defaultMessage:"a private page",id:"auditlog.actionNames.eventColumn.private_page"},an_untitled_page:{defaultMessage:"an untitled page",id:"auditlog.actionNames.eventColumn.untitled_page"},thisWorkspace:{defaultMessage:"this workspace",id:"auditlog.actionNames.eventColumn.thisWorkspace"},otherWorkspace:{defaultMessage:"another workspace",id:"auditlog.actionNames.eventColumn.otherWorkspace"},workspaceLevel:{defaultMessage:"the workspace level",id:"auditlog.actionNames.eventColumn.workspaceLevel"},private:{defaultMessage:"private",id:"auditlog.actionNames.eventColumn.private"},a_file:{defaultMessage:"a file",id:"auditlog.actionNames.eventColumn.a_file"},a_file_with_extension:{defaultMessage:"a {extension} file",id:"auditlog.actionNames.eventColumn.a_file_with_extension"},team:{defaultMessage:"teamspace",id:"auditlog.actionNames.eventColumn.team"},for_a_private_team:{defaultMessage:"for a private teamspace",id:"auditlog.actionNames.eventColumn.for_private_team"},a_private_team:{defaultMessage:"a private teamspace",id:"auditlog.actionNames.eventColumn.private_team"},a_team_and_page:{defaultMessage:"a teamspace and page",id:"auditlog.actionNames.eventColumn.team_and_page"},team_member:{defaultMessage:"teamspace member",id:"auditlog.actionNames.eventColumn.team_member"},team_owner:{defaultMessage:"teamspace owner",id:"auditlog.actionNames.eventColumn.team_owner"},team_level_guest:{defaultMessage:"teamspace guest",id:"auditlog.actionNames.eventColumn.team_level_guest"},group:{defaultMessage:"group",id:"auditlog.actionNames.eventColumn.group"},user:{defaultMessage:"user",id:"auditLogEntry.user.noName"},bot:{defaultMessage:"integration",id:"auditLogEntry.bot.noName"},externalIntegration:{defaultMessage:"connection",id:"auditLogEntry.externalIntegration.noName"},guestIntegration:{defaultMessage:"integration",id:"auditLogEntry.guestIntegration.noName"},adminContentSearchQuery:{defaultMessage:"query=“{query}“",id:"auditLogEntry.adminContentSearch.query"},adminContentSearchAudience:{defaultMessage:"audience=“{audience}“",id:"auditLogEntry.adminContentSearch.audience"},adminContentSearchCreatedBy:{defaultMessage:"created by=“{createdBy}“",id:"auditLogEntry.adminContentSearch.createdBy"},adminContentSearchSharedWith:{defaultMessage:"shared with=“{sharedWith}“",id:"auditLogEntry.adminContentSearch.sharedWith"},adminContentSearchTeamspaces:{defaultMessage:"{teamspaceCount, plural, one {teamspace=“{teamspaces}“} other {teamspaces=“{teamspaces}“}}",id:"auditLogEntry.adminContentSearch.teamspace"},adminContentSearchCreatedTime:{defaultMessage:"created time=“{createdTime}“",id:"auditLogEntry.adminContentSearch.createdTime"},adminContentSearchLastEditedTime:{defaultMessage:"last edited time=“{lastEditedTime}“",id:"auditLogEntry.adminContentSearch.lastEditedTime"},adminContentSearchPredicateSplit:{defaultMessage:", ",id:"auditLogEntry.adminContentSearch.predicateSplit"},from:{defaultMessage:"from",id:"auditLogEntry.spaceContentDuplication.from"},into:{defaultMessage:"into",id:"auditLogEntry.spaceContentDuplication.into"}});function Ht(e,t){if(t.target)return"user"in t.target&&t.target.user?Qt(e,t.target.user):"bot"in t.target&&t.target.bot?Yt(e,t.target.bot):"group"in t.target&&t.target.group?t.target.group.name?`“${t.target.group.name}“`:"group":void 0}function Qt(e,t){return t?t.name&&t.email?`“${t.name}“ (${t.email})`:t.name?`“${t.name}“`:t.email?`“${t.email}“`:e.formatMessage(Gt.user):e.formatMessage(Gt.user)}function Yt(e,t){return t.name?`“${t.name}“`:e.formatMessage(Gt.bot)}const $t=(0,p.defineMessages)({started:{id:"space.spaceContentDuplicationStatus.started",defaultMessage:"Started"},completed:{id:"space.spaceContentDuplicationStatus.completed",defaultMessage:"Completed"},failed:{id:"space.spaceContentDuplicationStatus.failed",defaultMessage:"Failed"}}),Jt=(0,p.defineMessages)({equallyRestrictive:{defaultMessage:". This is the same as the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_equal"},moreRestrictive:{defaultMessage:". This is more restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_more_restrictive"},lessRestrictive:{defaultMessage:". This is less restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_less_restrictive"}});function Xt(e,t){if(void 0!==e&&void 0!==t)return e===t?(0,oe.jsx)(p.FormattedMessage,{...Jt.equallyRestrictive}):!e&&t?(0,oe.jsx)(p.FormattedMessage,{...Jt.moreRestrictive}):e&&!t?(0,oe.jsx)(p.FormattedMessage,{...Jt.lessRestrictive}):void 0}function es(e){return e.name?`“${e.name}“ group`:(0,oe.jsx)(p.FormattedMessage,{...Gt.group})}function ts(e){return e.changes.name.oldValue&&e.changes.name.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"from “{oldTeamName}“ to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_old_team_name_to_new_team_name",values:{oldTeamName:e.changes.name.oldValue,newTeamName:e.changes.name.newValue}}):!e.changes.name.oldValue&&e.changes.name.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"from some teamspace name to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_unknown_team_name_to_new_team_name",values:{newTeamName:e.changes.name.newValue}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"for {teamName}",id:"auditlog.actionNames.eventColumn.for_team_name",values:{teamName:ss(e)}})}function ss(e){return"team"in e.target?is(e.target.team):(0,oe.jsx)(p.FormattedMessage,{...Gt.team})}function is(e){return e.name?`“${e.name}“ teamspace`:(0,oe.jsx)(p.FormattedMessage,{...Gt.team})}function ns(e){if(e)switch(e){case"owner":return(0,oe.jsx)(p.FormattedMessage,{...Gt.team_owner});case"member":return(0,oe.jsx)(p.FormattedMessage,{...Gt.team_member});case"team_level_guest":return(0,oe.jsx)(p.FormattedMessage,{...Gt.team_level_guest})}return(0,oe.jsx)(p.FormattedMessage,{...Gt.team_member})}function as(e){return(0,oe.jsx)(p.FormattedMessage,{...os(e)})}function os(e){if(!e)return Et.mq.noAccessLabel;switch(e){case"editor":return Et.mq.fullAccessLabel;case"membership_admin":case"read_and_write":return Et.mq.canEditLabel;case"content_only_editor":return Et.mq.canEditContentLabel;case"reader":return Et.mq.canReadLabel;case"comment_only":return Et.mq.canCommentLabel;case"none":return Et.mq.noAccessLabel;default:(0,me.t1)(e)}}function rs(e){var t,s;return{oldRole:(0,oe.jsx)(p.FormattedMessage,{...ls(null===(t=e.changes)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.oldValue)}),newRole:(0,oe.jsx)(p.FormattedMessage,{...ls(null===(s=e.changes)||void 0===s||null===(s=s.permission)||void 0===s?void 0:s.newValue)})}}const ls=e=>{if(!e)return Et.mq.noAccessLabel;switch(e){case"editor":return Et.mq.workspaceOwnerLabel;case"membership_admin":return Et.mq.membershipAdminLabel;case"read_and_write":return Et.mq.memberLabel;default:return Et.mq.noAccessLabel}};function ds(e){return cs(e.target.page)}function cs(e){return e.title?`“${e.title}“`:(0,oe.jsx)(p.FormattedMessage,{...Gt.an_untitled_page})}function us(e){var t,s;return null!==(t=e.target)&&void 0!==t&&null!==(t=t.page)&&void 0!==t&&null!==(t=t.meta)&&void 0!==t&&t.parent&&"title"in(null===(s=e.target)||void 0===s||null===(s=s.page)||void 0===s||null===(s=s.meta)||void 0===s?void 0:s.parent)?`“${e.target.page.meta.parent.title}“`:(0,oe.jsx)(p.FormattedMessage,{...Gt.an_untitled_page})}function ms(e){var t;return null!==(t=e.actor.meta)&&void 0!==t&&t.platform?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"on {platform}",id:"auditlog.actionNames.eventColumn.logged_in_platform",values:{platform:e.actor.meta.platform}}):""}function ps(e){switch(e){case"google":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Google",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.google"});case"email":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"temporary passcode",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.email"});case"admin":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"admin mode",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.admin"});case"saml":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"SAML SSO",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.saml"});case"apple":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Apple ID",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.apple"});case"password":case"password-no-mfa":case"password-sms":case"password-totp":case"password-backup-code":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"password",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.password"});default:(0,me.t1)(e)}}function gs(e){return e.changes.name.oldValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"from “{oldDomain}“",id:"auditlog.actionNames.eventColumn.old_domain",values:{oldDomain:e.changes.name.oldValue}}):""}function hs(e,t){return"block"===e.table?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{teamName} page {parentPage}",id:"auditlog.actionNames.eventColumn.team_parent_page",values:{teamName:is(t),parentPage:fs(e)}}):"team"===e.table?is(t):void 0}function fs(e){return"title"in e?`“${e.title}“`:(0,oe.jsx)(p.FormattedMessage,{...Gt.an_untitled_page})}function ys(e,t){if(!t)return(0,oe.jsx)(p.FormattedMessage,{...Gt.an_untitled_page});const s=t.table;return"space"===s?t.id!==e?(0,oe.jsx)(p.FormattedMessage,{...Gt.otherWorkspace}):qt(t.permissionLevel)?(0,oe.jsx)(p.FormattedMessage,{...Gt.private}):(0,oe.jsx)(p.FormattedMessage,{...Gt.thisWorkspace}):"team"===s?is(t):"block"===s?t.title?`“${t.title}“`:(0,oe.jsx)(p.FormattedMessage,{...Gt.an_untitled_page}):void 0}const xs=(0,p.defineMessages)({open:{defaultMessage:"Open",id:"auditlog.actionNames.eventColumn.team_privacy_types.open"},closed:{defaultMessage:"Closed",id:"auditlog.actionNames.eventColumn.team_privacy_types.closed"},private:{defaultMessage:"Private",id:"auditlog.actionNames.eventColumn.team_privacy_types.private"},default:{defaultMessage:"Default",id:"auditlog.actionNames.eventColumn.team_privacy_types.default"},unknown:{defaultMessage:"an unknown privacy state",id:"auditlog.actionNames.eventColumn.team_privacy_types.unknown"}});function vs(e){return e?(0,oe.jsx)(p.FormattedMessage,{...xs[e]}):(0,oe.jsx)(p.FormattedMessage,{...xs.unknown})}function Ss(e){return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.membership_requests_toggled.disabled"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.membership_requests_toggled.enabled"})}function bs(e){return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.external_membership_requests_toggled.disabled"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.external_membership_requests_toggled.enabled"})}function Ms(e){return"approved"===e.changes.requestStatus.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Approved",id:"auditlog.actionNames.eventColumn.membership_request_resolved.approved"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Declined",id:"auditlog.actionNames.eventColumn.membership_request_resolved.declined"})}function js(e){return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.disabled"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.enabled"})}function ws(e){return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled.disabled"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled.enabled"})}function Cs(e,t){return t?e.formatMessage(Gt.enabled):e.formatMessage(Gt.disabled)}const ks=(0,p.defineMessages)({team_members:{defaultMessage:"any teamspace member",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_members"},team_owners:{defaultMessage:"only teamspace owners",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_owners"},unknown:{defaultMessage:"unknown",id:"auditlog.actionNames.eventColumn.team_access_level_types.unknown"}});function Ts(e){return"recurrence"===e?(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_type.recurrence",defaultMessage:"a repeating automation"}):(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_type.automation",defaultMessage:"an automation"})}function Is(e){return!!e.meta&&("inSudoMode"in e.meta&&e.meta.inSudoMode)}function Ps(e,t,s){var i,n,a,o,r,d,c,u,m,g,h,f,y,x,v,S,b,M,j,w,C,k,T,I,P,Z;switch(e.actionName){case"page.properties_edited":{const t=e.meta.propertiesUpdated,s=e.meta.propertiesUpdated.map((e=>`“${e.propertyName}“`)).join(", ");return 1===t.length?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Edited property {properties} on {pageName}",id:"auditlog.actionNames.eventColumn.page_properties_edited.single_property",values:{properties:s,pageName:ds(e)}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Edited properties {properties} on {pageName}",id:"auditlog.actionNames.eventColumn.page_properties_edited.multiple_properties",values:{properties:s,pageName:ds(e)}})}case"page.discussion.comment.created":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Commented on {pageName}",id:"auditlog.actionNames.eventColumn.page.discussion.comment.created",values:{pageName:ds(e)}});case"page.discussion.comment.deleted":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Deleted comment on {pageName}",id:"auditlog.actionNames.eventColumn.page.discussion.comment.deleted",values:{pageName:ds(e)}});case"page.discussion.comment.updated":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Edited comment on {pageName}",id:"auditlog.actionNames.eventColumn.page.discussion.comment.updated",values:{pageName:ds(e)}});case"page_edited":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Edited {pageName}",id:"auditlog.actionNames.eventColumn.page_edited",values:{pageName:ds(e)}});case"page_viewed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Viewed {pageName}",id:"auditlog.actionNames.eventColumn.page_viewed_under",values:{pageName:ds(e)}});case"page_deleted":return e.target.page.meta.permanentDeletion?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Permanently deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_permanently_deleted",values:{pageName:ds(e)}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_deleted",values:{pageName:ds(e)}});case"page.permanently_deleted":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Permanently deleted {pageName}",id:"auditlog.actionNames.eventColumn.page.permanently_deleted",values:{pageName:ds(e)}});case"page_restored":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Restored {pageName}",id:"auditlog.actionNames.eventColumn.page_restored",values:{pageName:ds(e)}});case"page_exported":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Exported {pageName}",id:"auditlog.actionNames.eventColumn.page_exported",values:{pageName:ds(e)}});case"page_moved":{var F,A,R;const t=null===(F=e.changes)||void 0===F?void 0:F.team,i=e.changes.parent.oldValue,n=e.changes.parent.newValue;let a=ys(e.spaceId,e.changes.parent.oldValue),o=ys(e.spaceId,e.changes.parent.newValue);null!=t&&t.oldValue&&null!=t&&t.newValue&&i&&n&&("block"===i.table||"block"===n.table)?(a=hs(i,null==t?void 0:t.oldValue),o=hs(n,null==t?void 0:t.newValue)):"space"===(null===(A=e.changes.parent.oldValue)||void 0===A?void 0:A.table)&&"space"===(null===(R=e.changes.parent.newValue)||void 0===R?void 0:R.table)&&e.changes.parent.oldValue.id===e.changes.parent.newValue.id&&(qt(e.changes.parent.oldValue.permissionLevel)||qt(e.changes.parent.newValue.permissionLevel))&&(a=qt(e.changes.parent.oldValue.permissionLevel)?(0,oe.jsx)(p.FormattedMessage,{...Gt.private}):(0,oe.jsx)(p.FormattedMessage,{...Gt.workspaceLevel}),o=qt(e.changes.parent.newValue.permissionLevel)?(0,oe.jsx)(p.FormattedMessage,{...Gt.private}):(0,oe.jsx)(p.FormattedMessage,{...Gt.workspaceLevel}));const r=a?s.formatMessage({id:"auditLogEntry.changes.page_moved.old_parent",defaultMessage:" from {oldParentName}"},{oldParentName:a}):"",l=o?s.formatMessage({id:"auditLogEntry.changes.page_moved.new_parent",defaultMessage:" to {newParentName}"},{newParentName:o}):"";return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Moved {pageName}{oldParentMessage}{newParentMessage}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_moved",values:{pageName:ds(e),oldParentMessage:r,newParentMessage:l,inSudoMode:Is(e)}})}case"page_permission_updated":return function(e,t){var s,i,n;const a="bot"in t.target,o="space"in t.target,r="team"in t.target,l="group"in t.target,d="user"in t.target&&"guest"===(null===(s=t.target.user.meta)||void 0===s?void 0:s.spaceRole);var c,u;if(a)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for bot {botName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_bot",values:{botName:Ht(e,t),oldRole:as(null===(c=t.changes)||void 0===c||null===(c=c.permission)||void 0===c?void 0:c.oldValue),newRole:as(null===(u=t.changes)||void 0===u||null===(u=u.permission)||void 0===u?void 0:u.newValue),pageName:ds(t),inSudoMode:Is(t)}});var m,g,h,f,y,x;if(o)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for everyone in the workspace from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_space",values:{oldRole:as(null===(m=t.changes)||void 0===m||null===(m=m.permission)||void 0===m?void 0:m.oldValue),newRole:as(null===(g=t.changes)||void 0===g||null===(g=g.permission)||void 0===g?void 0:g.newValue),pageName:ds(t),inSudoMode:Is(t)}});if(r)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {teamName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_team",values:{oldRole:as(null===(h=t.changes)||void 0===h||null===(h=h.permission)||void 0===h?void 0:h.oldValue),newRole:as(null===(f=t.changes)||void 0===f||null===(f=f.permission)||void 0===f?void 0:f.newValue),pageName:ds(t),teamName:ss(t),inSudoMode:Is(t)}});if(d)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for guest {guestNameAndEmail} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_guest",values:{guestNameAndEmail:Ht(e,t),oldRole:as(null===(y=t.changes)||void 0===y||null===(y=y.permission)||void 0===y?void 0:y.oldValue),newRole:as(null===(x=t.changes)||void 0===x||null===(x=x.permission)||void 0===x?void 0:x.newValue),pageName:ds(t),inSudoMode:Is(t)}});if(l){var v,S;return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for group {groupName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_group",values:{groupName:Ht(e,t),oldRole:as(null===(v=t.changes)||void 0===v||null===(v=v.permission)||void 0===v?void 0:v.oldValue),newRole:as(null===(S=t.changes)||void 0===S||null===(S=S.permission)||void 0===S?void 0:S.newValue),pageName:ds(t),inSudoMode:Is(t)}})}return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {memberNameAndEmail} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_default",values:{memberNameAndEmail:Ht(e,t),oldRole:as(null===(i=t.changes)||void 0===i||null===(i=i.permission)||void 0===i?void 0:i.oldValue),newRole:as(null===(n=t.changes)||void 0===n||null===(n=n.permission)||void 0===n?void 0:n.newValue),pageName:ds(t),inSudoMode:Is(t)}})}(s,e);case"page_created":const O=(0,_.zV)(e);if(null!=O&&null!==(i=O.meta)&&void 0!==i&&i.parent){var D,B,L,N;if(O.meta.parent.table===Wt.bx)return"private"===(null===(L=O.meta)||void 0===L?void 0:L.permissionLevel)||"private"===(null===(N=O.meta)||void 0===N?void 0:N.pageAudience)?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Created a private page",id:"auditlog.actionNames.eventColumn.page_created_private"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Created a page in the workspace",id:"auditlog.actionNames.eventColumn.page_created_workspace"});if((null===(D=O.meta)||void 0===D?void 0:D.parent.table)===Kt.e0)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Created a page under {teamName}",id:"auditlog.actionNames.eventColumn.page_created_team",values:{teamName:is(O.meta.parent)}});if((null===(B=O.meta)||void 0===B?void 0:B.parent.table)===Vt.iU)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Created a page under {parentPageName}",id:"auditlog.actionNames.eventColumn.page_created_under",values:{parentPageName:us(e)}})}return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Created a page",id:"auditlog.actionNames.eventColumn.page_created_general"});case"page_shared_to_web":return function(e){var t;if(void 0===e.changes.permission.newValue||"none"===e.changes.permission.newValue)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled sharing {pageName} to web{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_shared_to_web.disabled",values:{pageName:ds(e),inSudoMode:Is(e)}});return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled sharing {pageName} to web{inSudoMode, select, true { using administrator privileges} other {}} with permissions {newRole}",id:"auditlog.actionNames.eventColumn.page_shared_to_web.enabled",values:{pageName:ds(e),inSudoMode:Is(e),newRole:as(null===(t=e.changes)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.newValue)}})}(e);case"login":return function(e,t){var s,i,n;const a=null===(s=e.meta)||void 0===s?void 0:s.authType;return null!==(i=e.actor.meta)&&void 0!==i&&i.countryCode&&a?(0,oe.jsx)(p.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithCityStateAndCountry.withAuthType",defaultMessage:"Logged in {platform} via {loginMethod} in {geolocation}",values:{platform:ms(e),geolocation:(0,tt.xk)(e,t),loginMethod:ps(a)}}):null!==(n=e.actor.meta)&&void 0!==n&&n.countryCode&&!a?(0,oe.jsx)(p.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithCityStateAndCountry",defaultMessage:"Logged in {platform} in {geolocation}",values:{platform:ms(e),geolocation:(0,tt.xk)(e,t)}}):a?(0,oe.jsx)(p.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithPlatform.withAuthType",defaultMessage:"Logged in {platform} via {loginMethod}",values:{platform:ms(e),loginMethod:ps(a)}}):(0,oe.jsx)(p.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithPlatform",defaultMessage:"Logged in {platform}",values:{platform:ms(e)}})}(e,s);case"allowed_support_access":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Granted support access for {name} until {date}",id:"auditlog.actionNames.allowed_support_access",values:{date:s.formatDate(e.changes.expiresAt),name:e.target.user.name}});case"revoked_support_access":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Revoked support access for {name}",id:"auditlog.actionNames.revoked_support_access",values:{name:e.target.user.name}});case"preferred_name_changed":return function(e,t){var s;const i=!!e.target&&e.actor.actorId!==(null===(s=e.target)||void 0===s?void 0:s.user.id),n=e.changes.name.oldValue,a=e.changes.name.newValue;if(i){if(n&&a)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} name from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.external_preferred_name_changed",values:{memberNameAndEmail:Ht(t,e),oldValue:n,newValue:a}});if(!n&&a)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Set {memberNameAndEmail} name to “{newValue}“",id:"auditlog.actionNames.eventColumn.external_preferred_name_changed_to_value",values:{memberNameAndEmail:Ht(t,e),newValue:a}});if(n&&!a)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} name “{oldValue}“",id:"auditlog.actionNames.eventColumn.external_preferred_name_changed_from_value",values:{memberNameAndEmail:Ht(t,e),oldValue:n}})}if(n&&a)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed name from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.preferred_name_changed",values:{oldValue:n,newValue:a}});if(!n&&a)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Set name to “{newValue}“",id:"auditlog.actionNames.eventColumn.preferred_name_changed_to_value",values:{newValue:a}});if(n&&!a)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed name “{oldValue}“",id:"auditlog.actionNames.eventColumn.preferred_name_changed_from_value",values:{oldValue:n}});return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Name was changed",id:"auditlog.actionNames.eventColumn.preferred_name_changed_generic"})}(e,s);case"email_changed":return function(e,t){var s;return e.target&&e.actor.actorId!==(null===(s=e.target)||void 0===s?void 0:s.user.id)?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} email from {oldEmail} to {newEmail}",id:"auditlog.actionNames.eventColumn.external_email_changed",values:{memberNameAndEmail:Ht(t,e),oldEmail:e.changes.email.oldValue,newEmail:e.changes.email.newValue}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed email from {oldEmail} to {newEmail}",id:"auditlog.actionNames.eventColumn.email_changed",values:{oldEmail:e.changes.email.oldValue,newEmail:e.changes.email.newValue}})}(e,s);case"picture_changed":return function(e,t){var s;return e.target&&e.actor.actorId!==(null===(s=e.target)||void 0===s?void 0:s.user.id)?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} profile picture",id:"auditlog.actionNames.eventColumn.external_picture_changed",values:{memberNameAndEmail:Ht(t,e)}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed profile picture",id:"auditlog.actionNames.eventColumn.picture_changed"})}(e,s);case"member_invited":{const t=rs(e);return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to the workspace as {newRole}",id:"auditlog.actionNames.eventColumn.member_invited",values:{memberNameAndEmail:Ht(s,e),newRole:t.newRole}})}case"member_role_updated":{const t=rs(e);return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.member_role_updated",values:{memberNameAndEmail:Ht(s,e),oldRole:t.oldRole,newRole:t.newRole}})}case"member_removed":return e.actor.actorId===e.target.user.id?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Left the workspace",id:"auditlog.actionNames.eventColumn.member_left"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.member_removed",values:{memberNameAndEmail:Ht(s,e)}});case"guest_removed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed guest {guestNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.guest_removed",values:{guestNameAndEmail:Ht(s,e)}});case"file_uploaded":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Uploaded a file to {pageName}",id:"auditlog.actionNames.eventColumn.file_uploaded_public",values:{pageName:ds(e)}});case"file_downloaded":return function(e){return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Downloaded {fileName} from {pageName}",id:"auditlog.actionNames.eventColumn.file_downloaded",values:{fileName:_s(e),pageName:ds(e)}})}(e);case"invite_link_toggled":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.enabled",defaultMessage:"Enabled invite link"}):(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.disabled",defaultMessage:"Disabled invite link"});case"public_page_sharing_toggled":case"workspace_sidebar_editing_toggled":case"disable_team_guests_toggled":case"disable_guests_toggled":case"pages_to_other_workspaces_toggled":case"export_toggled":case"page_access_requests_toggled":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.disabled",defaultMessage:"Disabled {workspaceSetting}",values:{workspaceSetting:s.formatMessage(Gt[e.actionName])}}):(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.enabled",defaultMessage:"Enabled {workspaceSetting}",values:{workspaceSetting:s.formatMessage(Gt[e.actionName])}});case"workspace_name_changed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed workspace name from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_name_changed",values:{oldValue:e.changes.name.oldValue,newValue:e.changes.name.newValue}});case"workspace_domain_changed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed workspace domain {oldValue} to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_domain_changed",values:{oldValue:gs(e),newValue:e.changes.name.newValue}});case"workspace_integration_restriction_changed":return function(e){const t=void 0,{oldValue:s,newValue:i}=e.changes.integration_restrictions;if(i===t)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.no_restrictions"});if(s===t&&"approved_only"===i)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.approved_only"});if("approved_or_built_by_notion"===s&&"approved_only"===i)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.disabled_built_by_notion.from_approved_or_built_by_notion"});if("approved_only"===s&&"approved_or_built_by_notion"===i)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.enabled_built_by_notion"});return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed workspace integration restriction",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.fallback_message"})}(e);case"allowed_email_domain_added":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Added “{addedValue}“ into allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_added",values:{addedValue:e.changes.domain}});case"allowed_email_domain_removed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed “{removedValue}“ from allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_removed",values:{removedValue:e.changes.domain}});case"public_page_set":return e.changes.name.oldValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed public home page from “{oldPage}“ to “{newPage}“",id:"auditlog.actionNames.eventColumn.public_page_changed",values:{oldPage:e.changes.name.oldValue,newPage:e.changes.name.newValue}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Set “{newPage}“ as public home page",id:"auditlog.actionNames.eventColumn.public_page_set",values:{newPage:e.changes.name.newValue}});case"idp_metadata_url_updated":return e.changes.url.oldValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed IDP metadata URL from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.idp_metadata_url_updated",values:{oldValue:e.changes.url.oldValue,newValue:e.changes.url.newValue}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Set IDP metadata URL to “{newValue}“",id:"auditlog.actionNames.eventColumn.idp_metadata_url_set",values:{newValue:e.changes.url.newValue}});case"saml_toggled":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{...Gt.saml_enabled}):(0,oe.jsx)(p.FormattedMessage,{...Gt.saml_disabled});case"saml_enforce_toggled":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{...Gt.saml_enforced}):(0,oe.jsx)(p.FormattedMessage,{...Gt.saml_unenforced});case"automatic_account_creation_toggled":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{...Gt.automatic_account_creation_enabled}):(0,oe.jsx)(p.FormattedMessage,{...Gt.automatic_account_creation_disabled});case"workspace_analytics_toggled":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{...Gt.workspace_analytics_enabled}):(0,oe.jsx)(p.FormattedMessage,{...Gt.workspace_analytics_disabled});case"workspace_creation_set_for_email_domain":return function(e,t){const{oldValue:s,newValue:i}=e.changes.workspace_creation;if(!s&&!i)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed workspace creation setting",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain.fallback_message"});const n=e.changes.workspace_creation.oldValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.beforeSetting",defaultMessage:" from {prevWorkspaceCreationSetting}"},{prevWorkspaceCreationSetting:(0,Ut.nJ)(e.changes.workspace_creation.oldValue,t)}):"",a=e.changes.workspace_creation.newValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.afterSetting",defaultMessage:" to {afterWorkspaceCreationSetting}"},{afterWorkspaceCreationSetting:(0,Ut.nJ)(e.changes.workspace_creation.newValue,t)}):"";return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed workspace creation setting{before}{after}.",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain",values:{before:n,after:a}})}(e,s);case"member_added_to_group":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Added {memberNameAndEmail} to {groupName}",id:"auditlog.actionNames.eventColumn.member_added_to_group",values:{memberNameAndEmail:Ht(s,e),groupName:es(e.target.group)}});case"member_removed_from_group":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {groupName}",id:"auditlog.actionNames.eventColumn.member_removed_from_group",values:{memberNameAndEmail:Ht(s,e),groupName:es(e.target.group)}});case"space_transfer_status_changed":return function(e,t){const{oldValue:s,newValue:i}=e.changes.spaceTransferStatus,n=e.target.space.name?t.formatMessage({id:"auditLogEntry.changes.space_transfer_status_changed.space_name",defaultMessage:" for {spaceName}"},{spaceName:e.target.space.name}):"";if(!s&&!i)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Workspace transfer status changed{spaceNameMessage}",id:"auditlog.actionNames.eventColumn.space_transfer_status_changed.fallback_message",values:{spaceNameMessage:n}});if(!i)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Workspace transfer request cleared{spaceNameMessage} from prior status of {oldStatus}",id:"auditlog.actionNames.eventColumn.space_transfer_status_cleared",values:{spaceNameMessage:n,oldStatus:s}});return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{newStatus, select, requested {Workspace transfer request initiated{spaceNameMessage}.} started {Workspace transfer started{spaceNameMessage}} completed {Workspace transfer completed{spaceNameMessage}} other {Workspace transfer status change to {newStatus}{spaceNameMessage}}}",id:"auditlog.actionNames.eventColumn.space_transfer_status_changed.newStatus",values:{spaceNameMessage:n,newStatus:i}})}(e,s);case"space_claim_and_upgrade_status_changed":return function(e){const{oldValue:t,newValue:s}=e.changes.claimAndUpgradeStatus,i=(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Status changed for workspace claim of {workspaceName}",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_changed.fallback_message",values:{workspaceName:e.target.space.name}});if(!t&&!s)return i;if(!s&&"completed"!==t)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Pending workspace claim for {workspaceName} has been cleared from {oldStatus}",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_cleared",values:{workspaceName:e.target.space.name,oldStatus:t}});if("completed"===s)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{workspaceName} has been claimed and upgraded to the Enterprise plan",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_completed",values:{workspaceName:e.target.space.name}});if("requested"===s)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Request to claim and upgrade {workspaceName} has been sent.",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_requested",values:{workspaceName:e.target.space.name}});return i}(e);case"space_claim_deletion_status_changed":return function(e){const{oldValue:t,newValue:s}=e.changes.claimDeletionStatus,i=(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Claimable workspace deletion status change for {spaceName}",id:"auditlog.actionNames.eventColumn.space_claim_deletion_status_changed.fallback_message",values:{spaceName:e.target.space.name}});if(!t&&!s)return i;if(!s||"canceled"===s)return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Recovered workspace {spaceName} using Domain Management",id:"auditlog.actionNames.eventColumn.space_claim_deletion.status_cleared",values:{spaceName:e.target.space.name}});return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Deleted workspace {spaceName} using Domain Management",id:"auditlog.actionNames.eventColumn.space_claim_deletion.deleted",values:{spaceName:e.target.space.name}})}(e);case"membership_requests_toggled":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{enabled} allowing members to request adding new members",id:"auditlog.actionNames.eventColumn.membership_requests_toggled",values:{enabled:Ss(e)}});case"external_membership_requests_toggled":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{enabled} allowing external users to request to be added to the workspace as members",id:"auditlog.actionNames.eventColumn.external_membership_requests_toggled",values:{enabled:bs(e)}});case"membership_request_resolved":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{status} request to add {email} to the workspace as a member",id:"auditlog.actionNames.eventColumn.membership_request_resolved",values:{status:Ms(e),email:Ht(s,e)}});case"guest_membership_requests_toggled":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{enabled} allowing page guests to request to be added to the workspace as members",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled",values:{enabled:js(e)}});case"team_created":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Created {teamName}",id:"auditlog.actionNames.eventColumn.team_created",values:{teamName:ss(e)}});case"team_archived":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Archived {teamName}",id:"auditlog.actionNames.eventColumn.team_archived",values:{teamName:ss(e)}});case"team_restored":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Restored {teamName}",id:"auditlog.actionNames.eventColumn.team_restored",values:{teamName:ss(e)}});case"team_default_toggled":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Added {teamName} to the default teamspace list. Workspace members will automatically be added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_enabled",values:{teamName:ss(e)}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed {teamName} from the default teamspace list. Workspace members will no longer be automatically added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_disabled",values:{teamName:ss(e)}});case"team_public_page_sharing_toggled":return e.changes.enabled.newValue?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_disabled",values:{teamName:ss(e)}}),Xt((null===(n=e.meta)||void 0===n?void 0:n.spacePublicPageSharingDisabled)??(null==e?void 0:e.spacePublicPageSharingDisabled),e.changes.enabled.newValue)]}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_enabled",values:{teamName:ss(e)}}),Xt((null===(a=e.meta)||void 0===a?void 0:a.spacePublicPageSharingDisabled)??(null==e?void 0:e.spacePublicPageSharingDisabled),e.changes.enabled.newValue)]});case"team_export_toggled":return e.changes.enabled.newValue?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_disabled",values:{teamName:ss(e)}}),Xt((null===(o=e.meta)||void 0===o?void 0:o.spaceExportDisabled)??(null==e?void 0:e.spaceExportDisabled),e.changes.enabled.newValue)]}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_enabled",values:{teamName:ss(e)}}),Xt((null===(r=e.meta)||void 0===r?void 0:r.spaceExportDisabled)??(null==e?void 0:e.spaceExportDisabled),e.changes.enabled.newValue)]});case"team_sidebar_editing_toggled":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_disabled",values:{teamName:ss(e)}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_enabled",values:{teamName:ss(e)}});case"team_creation_admins_setting_toggled":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_disabled",values:{teamName:ss(e)}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_enabled",values:{teamName:ss(e)}});case"team_guests_toggled":return e.changes.enabled.newValue?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_disabled",values:{teamName:ss(e)}}),Xt((null===(d=e.meta)||void 0===d?void 0:d.spaceDisableGuests)??e.spaceDisableGuests,e.changes.enabled.newValue)]}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_enabled",values:{teamName:ss(e)}}),Xt((null===(c=e.meta)||void 0===c?void 0:c.spaceDisableGuests)??e.spaceDisableGuests,e.changes.enabled.newValue)]});case"team_name_changed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed teamspace name {oldTeamNameToNewTeamName}",id:"auditlog.actionNames.eventColumn.team_name_changed",values:{oldTeamNameToNewTeamName:ts(e)}});case"team_description_changed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed description of {teamName}",id:"auditlog.actionNames.eventColumn.team_description_changed",values:{teamName:ss(e)}});case"team_icon_changed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed icon of {teamName}",id:"auditlog.actionNames.eventColumn.team_icon_changed",values:{teamName:ss(e)}});case"member_added_to_team":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_added_to_team",values:{memberNameAndEmail:Ht(s,e),teamName:ss(e),teamRole:ns(e.changes.teamRole.newValue)}});case"group_added_to_team":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Invited {groupName} to {teamName} as teamspace member",id:"auditlog.actionNames.eventColumn.group_added_to_team",values:{groupName:es(e.target.group),teamName:ss(e)}});case"member_removed_from_team":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {teamName}",id:"auditlog.actionNames.eventColumn.member_removed_from_team",values:{memberNameAndEmail:Ht(s,e),teamName:ss(e)}});case"group_removed_from_team":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed {groupName} from {teamName}",id:"auditlog.actionNames.eventColumn.group_removed_from_team",values:{groupName:es(e.target.group),teamName:ss(e)}});case"member_joined_team":const E=ss(e),V=ns(e.changes.teamRole.newValue);return Is(e)?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Joined {teamName} as {teamRole} using administrator privileges",id:"auditlog.actionNames.eventColumn.member_joined_team_privileged",values:{teamName:E,teamRole:V}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Joined {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_joined_team",values:{teamName:E,teamRole:V}});case"member_left_team":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Left {teamName}",id:"auditlog.actionNames.eventColumn.member_left_team",values:{teamName:ss(e)}});case"member_team_role_updated":const U=Ht(s,e),W=ns(e.changes.teamRole.oldValue),K=ns(e.changes.teamRole.newValue),z=ss(e);return Is(e)?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldTeamRole} to {newTeamRole} in {teamName} using administrator privileges",id:"auditlog.actionNames.eventColumn.member_team_role_updated_privileged",values:{memberNameAndEmail:U,oldTeamRole:W,newTeamRole:K,teamName:z}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldTeamRole} to {newTeamRole} in {teamName}",id:"auditlog.actionNames.eventColumn.member_team_role_updated",values:{memberNameAndEmail:U,oldTeamRole:W,newTeamRole:K,teamName:z}});case"team_user_permission_updated":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated {userNameOrEmail}’s custom permissions in {teamName} from {oldPermission} to {newPermission}.",id:"auditlog.actionNames.eventColumn.team_user_permission_updated",values:{userNameOrEmail:Ht(s,e),oldPermission:as(e.changes.permission.oldValue),newPermission:as(e.changes.permission.newValue),teamName:ss(e)}});case"team_group_permission_updated":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated {groupName}’s custom permissions in {teamName} from {oldPermission} to {newPermission}.",id:"auditlog.actionNames.eventColumn.team_group_permission_updated",values:{groupName:es(e.target.group),oldPermission:as(e.changes.permission.oldValue),newPermission:as(e.changes.permission.newValue),teamName:ss(e)}});case"team_member_default_permission_updated":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated default page permissions for teamspace members in {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_member_default_permission_updated",values:{teamName:ss(e),oldRole:as(null===(u=e.changes)||void 0===u||null===(u=u.permission)||void 0===u?void 0:u.oldValue),newRole:as(null===(m=e.changes)||void 0===m||null===(m=m.permission)||void 0===m?void 0:m.newValue)}});case"team_guest_default_permission_updated":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated default page permissions for teamspace guests in {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_guest_default_permission_updated",values:{teamName:ss(e),oldRole:as(null===(g=e.changes)||void 0===g||null===(g=g.permission)||void 0===g?void 0:g.oldValue),newRole:as(null===(h=e.changes)||void 0===h||null===(h=h.permission)||void 0===h?void 0:h.newValue)}});case"team_workspace_default_permission_updated":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Updated default page permissions for everyone else in the workspace for {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_workspace_default_permission_updated",values:{teamName:ss(e),oldRole:as(null===(f=e.changes)||void 0===f||null===(f=f.permission)||void 0===f?void 0:f.oldValue),newRole:as(null===(y=e.changes)||void 0===y||null===(y=y.permission)||void 0===y?void 0:y.newValue)}});case"team_privacy_type_changed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed the teamspace privacy type for {teamName} from {oldType} to {newType}",id:"auditlog.actionNames.eventColumn.team_privacy_type_changed",values:{teamName:ss(e),oldType:vs(null===(x=e.changes)||void 0===x?void 0:x.teamAccessLevel.oldValue),newType:vs(null===(v=e.changes)||void 0===v?void 0:v.teamAccessLevel.newValue)}});case"team_invite_access_changed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed who can invite teamspace members to {newType} for {teamName}",id:"auditlog.actionNames.eventColumn.team_invite_access_changed",values:{teamName:ss(e),newType:(Z=null===(S=e.changes)||void 0===S||null===(S=S.teamInviteAccess)||void 0===S?void 0:S.newValue,Z?(0,oe.jsx)(p.FormattedMessage,{...ks[Z]}):(0,oe.jsx)(p.FormattedMessage,{...ks.unknown}))}});case"teams_enabled_for_space":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled teamspaces for {workspaceName}",id:"auditlog.actionNames.eventColumn.teams_enabled_for_space",values:{workspaceName:e.target.space.name}});case"private_content_transferred":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Transferred private content from {fromUserName} to {toUserName}",id:"auditLog.actionNames.eventColumn.private_content_transferred",values:{fromUserName:Qt(s,e.changes.userPermission.oldValue),toUserName:Qt(s,e.changes.userPermission.newValue)}});case"audit_log_exported":return(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.eventColumn.audit_log_exported",defaultMessage:"Exported audit log for last {duration} days",values:{duration:e.meta.duration}});case"user_analytics_exported":return(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.eventColumn.user_analytics_exported",defaultMessage:"Exported user analytics for {daysFilterString}",values:{daysFilterString:s.formatMessage(zt.Rh[(null===(b=e.meta)||void 0===b?void 0:b.daysFilter)||"last_90_days"]).toLowerCase()}});case"content_analytics_exported":return(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.eventColumn.content_analytics_exported",defaultMessage:"Exported content analytics for {daysFilterString}",values:{daysFilterString:s.formatMessage(zt.Rh[(null===(M=e.meta)||void 0===M?void 0:M.daysFilter)||"last_90_days"]).toLowerCase()}});case"admin_content_search_queried":case"admin_content_search_exported":function q(e){return e.join(s.formatMessage(Gt.adminContentSearchPredicateSplit))}function G(e){return"starting"in e&&"ending"in e?`${e.starting} - ${e.ending}`:"starting"in e?`${e.starting} - `:"ending"in e?` - ${e.ending}`:void 0}const H=e.searchParameters.query&&s.formatMessage(Gt.adminContentSearchQuery,{query:e.searchParameters.query}),Q=e.searchParameters.teamspaces&&e.searchParameters.teamspaces.length>0&&s.formatMessage(Gt.adminContentSearchTeamspaces,{teamspaceCount:e.searchParameters.teamspaces.length,teamspaces:q(e.searchParameters.teamspaces)}),Y=e.searchParameters.createdBy&&e.searchParameters.createdBy.length>0&&s.formatMessage(Gt.adminContentSearchCreatedBy,{createdBy:q(e.searchParameters.createdBy)}),$=e.searchParameters.sharedWith&&e.searchParameters.sharedWith.length>0&&s.formatMessage(Gt.adminContentSearchSharedWith,{sharedWith:q(e.searchParameters.sharedWith)}),J=e.searchParameters.audience&&e.searchParameters.audience.length>0&&s.formatMessage(Gt.adminContentSearchAudience,{audience:q(e.searchParameters.audience)}),X=e.searchParameters.createdTime&&s.formatMessage(Gt.adminContentSearchCreatedTime,{createdTime:G(e.searchParameters.createdTime)}),ee=e.searchParameters.lastEditedTime&&s.formatMessage(Gt.adminContentSearchLastEditedTime,{lastEditedTime:G(e.searchParameters.lastEditedTime)}),te=l.oA([H,Q,Y,$,J,X,ee]);if("admin_content_search_queried"===e.actionName){if(0===te.length)return(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_queried.no_filters",defaultMessage:"Ran a content search with no filters"});{const e=q(te);return(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_queried",defaultMessage:"Ran a content search with the following criteria: {searchCriteria}",values:{searchCriteria:e}})}}if(0===te.length)return(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_exported.no_filters",defaultMessage:"Exported a content search result with no filters"});{const e=q(te);return(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_exported",defaultMessage:"Exported a content search result with the following criteria: {searchCriteria}",values:{searchCriteria:e}})}case"admin_managed_users_log_out_all":{const t=s.formatList(e.meta.emailDomains,{type:"conjunction"});return(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_managed_users_log_out_all",defaultMessage:"Logged out all managed users with the email domains {emailDomains}",values:{emailDomains:t}})}case"admin_managed_users_log_out_one":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Logged out {guestNameAndEmail} from all of their active sessions",id:"auditlog.actionNames.eventColumn.admin_managed_users_log_out_one",values:{guestNameAndEmail:Ht(s,e)}});case"admin_managed_users_password_cleared_one":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Reset the password and MFA settings for {guestNameAndEmail} and logged them out of their active sessions",id:"auditlog.actionNames.eventColumn.admin_managed_users_password_cleared_one",values:{guestNameAndEmail:Ht(s,e)}});case"admin_managed_users_password_cleared":{const t=s.formatList(e.meta.emailDomains,{type:"conjunction"});return(0,oe.jsx)(p.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_managed_users_password_cleared",defaultMessage:"Cleared passwords for all users with the email domains {emailDomains}",values:{emailDomains:t}})}case"automation_created":return(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_created",defaultMessage:"Created {automationType} on {pageTitle}",values:{automationType:Ts(e.meta.automationType),pageTitle:ds(e)}});case"automation_edited":return(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_edited",defaultMessage:"Edited {automationType} on {pageTitle}",values:{automationType:Ts(e.meta.automationType),pageTitle:ds(e)}});case"ai_admin_legal_acceptance_toggled":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{enabled} Notion AI for the workspace.",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled",values:{enabled:ws(e)}});case"space_consolidation_started":case"space_consolidation_completed":case"space_consolidation_failed":const se=e.spaceId===e.meta.spaceConsolidationMetadata.source_space_id,ie=e.meta.spaceConsolidationMetadata.source_space_name??e.meta.spaceConsolidationMetadata.source_space_id,ne=e.meta.spaceConsolidationMetadata.target_space_name??e.meta.spaceConsolidationMetadata.target_space_id,ae=e.changes.spaceContentDuplicationStatus.newValue;return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{status} workspace consolidation {direction} {spaceName}.",id:"auditlog.actionNames.eventColumn.space_consolidation_status_changed",values:{status:ae?(0,oe.jsx)(p.FormattedMessage,{...$t[ae]}):"",spaceName:se?ne:ie,direction:(0,oe.jsx)(p.FormattedMessage,{...se?Gt.into:Gt.from})}});case"mfa_sms_toggled":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{enabled} SMS MFA on “{value}“",id:"auditlog.actionNames.eventColumn.mfa_sms_toggled",values:{value:null!==(j=e.changes)&&void 0!==j&&j.maskedPhoneNumber.oldValue?null===(w=e.changes)||void 0===w?void 0:w.maskedPhoneNumber.oldValue:null===(C=e.changes)||void 0===C?void 0:C.maskedPhoneNumber.newValue,enabled:null!==(k=e.changes)&&void 0!==k&&k.enabled.newValue?"Enabled":"Disabled"}});case"mfa_totp_toggled":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{enabled} TOTP MFA",id:"auditlog.actionNames.eventColumn.mfa_totp_toggled",values:{enabled:null!==(T=e.changes)&&void 0!==T&&T.enabled.newValue?"Enabled":"Disabled"}});case"mfa_backup_code_toggled":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{enabled} backup codes for MFA",id:"auditlog.actionNames.eventColumn.mfa_backup_code_toggled",values:{enabled:null!==(I=e.changes)&&void 0!==I&&I.enabled.newValue?"Enabled":"Disabled"}});case"user_suspended":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Suspended {userNameAndEmail}",id:"auditLogEntry.user_suspended",values:{userNameAndEmail:Ht(s,e)}});case"user_unsuspended":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Reactivated {userNameAndEmail}",id:"auditLogEntry.user_unsuspended",values:{userNameAndEmail:Ht(s,e)}});case"user_deleted":return e.target?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Deleted {userNameAndEmail}",id:"auditLogEntry.user_deleted",values:{userNameAndEmail:Qt(s,e.target.user)}}):(0,oe.jsx)(p.FormattedMessage,{...Gt.user_deleted});case"workspace.settings.prevent_granting_support_access_updated":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled managed user members' ability to grant support access for their account.",id:"auditLogEntry.workspace_domain_settings_prevent_granting_support_access_updated.enabled"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled managed user members' ability to grant support access for their account.",id:"auditLogEntry.workspace_domain_settings_prevent_granting_support_access_updated.disabled"});case"workspace.settings.prevent_profile_edits_updated":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled managed user members' ability to edit their profile information.",id:"auditLogEntry.workspace_domain_settings_prevent_profile_edits_updated.enabled"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled managed user members' ability to edit their profile information.",id:"auditLogEntry.workspace_domain_settings_prevent_profile_edits_updated.disabled"});case"workspace.settings.external_workspace_access_updated":return e.changes.enabled.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disabled managed user members' ability to join external workspaces.",id:"auditLogEntry.workspace_domain_settings_external_workspace_access_updated.enabled"}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Enabled managed user members' ability to join external workspaces.",id:"auditLogEntry.workspace_domain_settings_external_workspace_access_updated.disabled"});case"workspace.settings.custom_session_duration_updated":return void 0!==e.changes.valueMs.oldValue&&void 0!==e.changes.valueMs.newValue?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed the session duration for all managed users from {oldDuration} to {newDuration}.",id:"auditLogEntry.workspace_domain_settings_session_duration_updated",values:{oldDuration:(0,Nt.Ct)(e.changes.valueMs.oldValue,s),newDuration:(0,Nt.Ct)(e.changes.valueMs.newValue,s)}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changed the session duration for all managed users.",id:"auditLogEntry.workspace_domain_settings_session_duration_updated.disabled"});case"integration.created":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Added {botName} to the workspace",id:"auditLogEntry.integration.created",values:{botName:Yt(s,e.meta.bot)}});case"integration.deleted":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed {botName} from workspace",id:"auditLogEntry.integration.deleted",values:{botName:Yt(s,e.meta.bot)}});case"page.automation_deleted":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Deleted automation {automationType} from {pageTitle}",id:"auditLogEntry.page.automation_deleted",values:{automationType:Ts(e.meta.automationType),pageTitle:ds(e)}});case"page.file_deleted":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Deleted file {fileName} from {pageTitle}",id:"auditLogEntry.page.file_deleted",values:{fileName:_s(e),pageTitle:ds(e)}});case"integration.secret_reset":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Reset authentication secret of {botName}",id:"auditLogEntry.integration.secret_reset",values:{botName:Yt(s,e.meta.bot)}});case"workspace.external_account_connected":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Connected external/public integration {integrationName}",id:"auditLogEntry.workspace.external_account_connected",values:{integrationName:Yt(s,e.meta.bot)}});case"workspace.external_account_disconnected":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Disconnected external/public integration {integrationName}",id:"auditLogEntry.workspace.external_account_disconnected",values:{integrationName:Yt(s,e.meta.bot)}});case"workspace.integration_added":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Added {integrationName} to the workspace",id:"auditLogEntry.workspace.workspace.integration_added",values:{integrationName:Yt(s,e.meta.bot)}});case"workspace.integration_removed":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Removed {integrationName} from workspace",id:"auditLogEntry.workspace.workspace.integration_removed",values:{integrationName:Yt(s,e.meta.bot)}});case"user.settings.analytics_tracking_setting_updated":return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{enabledOrDisabled} page view tracking on their user account",id:"auditLogEntry.user.settings.analytics_tracking_setting_updated",values:{enabledOrDisabled:Cs(s,Boolean(null===(P=e.changes)||void 0===P||null===(P=P.enabled)||void 0===P?void 0:P.newValue))}});case"workspace.settings.guest_invite_request_setting_updated":return function(e,t){var s;return(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{enabledOrDisabled} allowing members to request inviting guests",id:"auditLogEntry.workspace.settings.guest_invite_request_setting_updated",values:{enabledOrDisabled:Cs(t,Boolean(null===(s=e.changes)||void 0===s||null===(s=s.enabled)||void 0===s?void 0:s.newValue))}})}(e,s);case"workspace.guest_invite_request_resolved":return function(e,t){const s=e.changes.requestStatus.newValue;return"approved"===s?(0,oe.jsx)(p.FormattedMessage,{id:"auditLog.actionNames.eventColumn.workspace.guest_invite_request_resolved.approved",defaultMessage:"Approved {requestorNameAndEmail}'s request to add guest {guestNameAndEmail} to {pageTitle}",values:{requestorNameAndEmail:Qt(t,e.target.user),guestNameAndEmail:Qt(t,e.meta.targetGuest),pageTitle:cs(e.meta.pagesAndRoles[0].page)}}):"rejected"===s?(0,oe.jsx)(p.FormattedMessage,{id:"auditLog.actionNames.eventColumn.workspace.guest_invite_request_resolved.rejected",defaultMessage:"Declined request to add guest {guestNameAndEmail} to {pageTitle}",values:{guestNameAndEmail:Qt(t,e.meta.targetGuest),pageTitle:cs(e.meta.pagesAndRoles[0].page)}}):(0,oe.jsx)(oe.Fragment,{})}(e,s);case"workspace_exported":case"workspace_icon_changed":case"public_page_cleared":case"logout":case"password_changed":case"password_cleared":case"password_set":case"revoked_support_access":case"user_suspended":case"user_unsuspended":case"member_joined":case"invite_link_toggled":case"scim_token_generated":case"scim_token_revoked":case"invite_link_reset":case"idp_metadata_xml_removed":case"idp_metadata_xml_updated":case"workspace.members_exported":return(0,oe.jsx)(p.FormattedMessage,{...Gt[e.actionName]});case"organization.created":return(0,oe.jsx)(oe.Fragment,{});default:if("local"!==t)return Ot.log({level:"error",from:"auditLogEvent",type:"AuditLogEvent",data:{miscDataToConvertToString:{data:e}}}),(0,oe.jsx)(oe.Fragment,{});(0,me.t1)(e)}}function _s(e){const{name:t,extension:s}=e.target.file;return t?`“${t}“`:s?(0,oe.jsx)(p.FormattedMessage,{...Gt.a_file_with_extension,values:{extension:s}}):(0,oe.jsx)(p.FormattedMessage,{...Gt.a_file})}function Zs(e){window.__c={n:"AuditLogColumnEvent"};const{auditLogEntry:t,id:s}=e,[n,a]=(0,i.useState)(""),o=(0,p.useIntl)();return(0,i.useEffect)((()=>{const e=document.getElementById(s);a((null==e?void 0:e.textContent)||"")}),[s]),(0,oe.jsx)(te.Z,{style:{whiteSpace:"normal"},delayThreshold:80,renderTooltip:()=>(0,oe.jsx)(As,{text:n,auditLogEntry:t}),placement:te.Z.Placement.Bottom,render:e=>(0,oe.jsx)("div",{...e,style:{fontSize:14,...m.Z.textOverflowStyle},id:s,children:(0,oe.jsx)(Fs,{auditLogEntry:t,env:"production",intl:o})})})}function Fs(e){const{auditLogEntry:t,env:s,intl:i}=e;return Ps(t,s,i)}function As(e){var t,s;window.__c={n:"AuditLogEventTooltip"};const{auditLogEntry:i,text:n}=e,a=(0,p.useIntl)(),o=(0,tt.q6)({auditLogEntry:i,intl:a});return(0,oe.jsxs)("div",{children:[n,(null===(t=i.actor.meta)||void 0===t?void 0:t.ipAddress)&&(0,oe.jsx)("div",{children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"IP address: {ip}",values:{ip:null===(s=i.actor.meta)||void 0===s?void 0:s.ipAddress},id:"auditLogSettings.metadata.ipAddress"})}),(0,oe.jsx)("div",{children:(0,tt.xk)(i,a)}),o&&(0,oe.jsx)(p.FormattedMessage,{id:"auditLogColumnEvent.tooltip.audienceMessage",defaultMessage:"Page audience: {audience}",values:{audience:o}})]})}function Rs(e){const{children:t,disabled:s,onClick:i}=e;return(0,oe.jsx)(ve.Z,{onClick:i,disabled:s,style:{justifyContent:"center",marginLeft:6},isBlue:!s,isLightGray:s,children:t})}const Ds={id:"actor",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`;return(0,oe.jsx)(Ft,{spaceStore:e.spaceStore,auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:30},sortable:!1},Bs={id:"event",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),renderCell:e=>{const t=`event-${e.auditLogEntry.actionName}-${e.id}`;return(0,oe.jsx)(Zs,{auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:40},sortable:!1},Ls={id:"dateTimeAndMenu",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`,s=`event-${e.auditLogEntry.actionName}-${e.id}`,i=`datetime-${e.auditLogEntry.actionName}-${e.id}`;return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Lt,{auditLogEntry:e.auditLogEntry,id:i}),(0,oe.jsx)(Es,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:t,eventColumnId:s,dateTimeColumnId:i}})]})},widthData:{width:25},sortable:!0},Ns=[Ds,Bs,Ls];function Os(){return(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"},children:[(0,oe.jsx)("div",{children:(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:{fontWeight:500},children:(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.logTable.noResults",defaultMessage:"No results"})})}),(0,oe.jsx)(at.Z,{isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."})})]})}function Es(e){window.__c={n:"AuditLogColumnMenu"};const{auditLogEntry:t,ids:s}=e,i=(0,a.VK)((()=>(0,ot.F$)()),[]),n=(0,a.VK)((()=>lt.default.checkGate("audit_log_event_name_column")?tt.pz:tt.C9),[]),o=(0,p.useIntl)(),r=(0,T.O7)(),l=(0,Je.Fg)(),d=(0,Je.yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}})),[]);return(0,oe.jsx)(te.Z,{delayThreshold:80,placement:te.Z.Placement.Bottom,render:e=>(0,oe.jsx)("div",{style:d.container,...e,children:(0,oe.jsx)(_t.Z,{style:d.button,onClick:()=>{var e;It.RD({environment:r,stringValue:(0,tt.eA)({auditLogEntry:t,intl:o,getAuditLogEventText:(e=s.eventColumnId,t=>{var s;return null===(s=document.getElementById(e))||void 0===s?void 0:s.textContent}),isTeamGuestsEnabled:i,csvColumnNames:n}),copiedMessage:It.tq.copiedToClipboard})},children:(0,Tt.U)({width:16,height:16,fill:l.mediumIconColor})})}),renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"AuditLogSettings.copyAuditLogEvent",defaultMessage:"Copy row"})})}const Vs=(0,p.injectIntl)((function(e){window.__c={n:"AuditLogPaginatedTable"};const{searchResponse:t,spaceStore:s}=e,[n,o]=(0,a.AF)(O),r=t.results||[],l=t.hasMoreResults,d=Boolean(r.length),c=e=>{const t={...n,pageNum:e};o(t)},u=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:Ns,theme:e,containerMarginTop:0})),[]),m=r.map(((e,t)=>({id:t.toString(),auditLogEntry:e,spaceStore:s,isClickable:!1}))),g=(0,i.useCallback)((()=>{const e=n.sortOrder===_.NQ.CreatedOldest?_.NQ.CreatedNewest:_.NQ.CreatedOldest;o({...n,sortOrder:e,pageNum:1})}),[n,o]),h=(0,i.useMemo)((()=>({column:Ls,sortAscending:n.sortOrder===_.NQ.CreatedOldest})),[n]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Pt.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Ns,rows:m,sortState:h,onSortStateChanged:g,renderNoRowsComponent:Os,styles:u}),d?(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:[(0,oe.jsx)(Rs,{onClick:()=>{c(n.pageNum-1)},disabled:1===n.pageNum,children:(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})}),(0,oe.jsx)(Rs,{disabled:!l,onClick:()=>{c(n.pageNum+1)},children:(0,oe.jsx)(p.FormattedMessage,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"})})]}):null]})}));const Us=(0,p.injectIntl)((function(e){window.__c={n:"AuditLogSettingsImpl"};const{spaceStore:t}=e,s=(0,T.O7)(),n=null==t?void 0:t.id,[o]=(0,a.AF)(K),[r]=(0,a.AF)(O),l=E(r)!==o.filterStr?void 0:o.cachedResponses[r.pageNum];return(0,i.useEffect)((()=>{n&&(async e=>{var t,s;const{environment:i,spaceId:n}=e,a=O.getState();K.startLoading(n,a);const{sortOrder:o,pageSize:r,pageNum:l}=a,d={spaceId:n,limit:r,cursor:K.getCursor(n,a,l),filters:{timeRange:{starting:a.timeRange.starting?I.OQ.toUnixMs(a.timeRange.starting):void 0,ending:a.timeRange.ending?I.OQ.toUnixMs(a.timeRange.ending):void 0},...(null===(t=a.actors)||void 0===t?void 0:t.length)>0?{actors:a.actors}:void 0,...(null===(s=a.actions)||void 0===s?void 0:s.length)>0?{actions:a.actions}:void 0},sort:o||_.NQ.CreatedNewest},c=await M.searchAuditLog(i,d);if("success"!==c.type)if(K.updateError(n,a),(0,P.Jx)(c.body)){const e=(0,R.wf)(D.default.getIntl(),c);y.showErrorMessage(e)}else y.showErrorMessage(D.default.formatMessage(z.loadCurrentAuditLogError));else K.updateLoadedResult(n,a,c.data)})({environment:s,spaceId:n})}),[s,n,r]),(0,i.useEffect)((()=>{G({environment:s,spaceId:n})}),[s,n]),(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(jt,{}),(0,oe.jsxs)("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12},children:[(0,oe.jsx)(vt,{spaceStore:t}),(0,oe.jsx)(ce,{})]}),"loading"===(null==l?void 0:l.status)&&(0,oe.jsx)(kt,{}),"success"===(null==l?void 0:l.status)&&(0,oe.jsx)(Vs,{searchResponse:l,spaceStore:t})]})}));var Ws=s(28020),Ks=s(68821),zs=s(43250),qs=s(8989),Gs=s(18514),Hs=s(50770),Qs=s(67940);class Ys extends B.default{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaces:[],createAccount:!1,useMetadataUrl:!0}}}const $s=Ys;var Js=s(53680);class Xs extends B.default{getInitialState(){return{displaySummary:!0,openDropdown:!1,query:""}}}const ei=new Xs;let ti=function(e){return e.Overview="overview",e.Users="users",e.Content="content",e.Search="search",e}({});class si extends B.default{getInitialState(){return{}}shouldRefreshState(e){const t=this.getState();return e!==t.currentSpaceId||!(t.currentTab!==ti.Users||t.usersTabData&&t.usersTabData.usersAndStats)}}const ii=new si;class ni extends B.default{getInitialState(){return{name:"",domain:"",domainState:"current-space",emailDomains:[],publicHomePage:void 0}}getValueForSpace(e){const t=e.getPublicContentDomain(),s=e.getPublicHomePage();if(e.isDefined())return{name:e.getName()||"",domain:t||"",emailDomains:e.getEmailDomains(),domainState:"current-space",publicHomePage:s}}}const ai=ni;class oi extends B.default{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only",settings:{}}}async updateValueForSpace(e){const{environment:t,spaceId:s,store:i}=e,n=await M.getEmailDomainsForSpace(t,{spaceId:s});if("failed"===n.type)return void y.showError(n);const{data:a}=n,o=Object.keys(a);return 0!==o.length?i.setState({emailDomains:o,spaceCreation:a[o[0]].spaceCreationEnum,settings:a[o[0]].settings}):i.setState(this.getInitialState()),i.state}}const ri=oi;class li extends B.default{getInitialState(){return{uploadingProfilePhoto:!1,givenName:"",familyName:"",name:"",startDayOfWeek:(0,I.aN)(),accountSettings:{hasPassword:!1,canConfigurePassword:!1,isSamlEnforced:!1,mfaStatus:"loading",numMfaSettings:0,regenerateBackupCodes:!1,error:void 0}}}getValueForUser(e,t,s){if(e.isDefined()){const i=e.getFullName(s),n=e.getProfilePhoto(),a=t.getSettings();return{...this.state,uploadingProfilePhoto:!1,profilePhoto:n,name:i||"",startDayOfWeek:void 0===(null==a?void 0:a.start_day_of_week)?(0,I.aN)():null==a?void 0:a.start_day_of_week}}}}const di=li;var ci=s(92083),ui=s(78291),mi=s(98905),pi=s(85703),gi=s(34583),hi=s(67742),fi=s(78780),yi=s(88893),xi=s(5220),vi=s(60396);class Si extends B.default{getInitialState(){return{loadingState:"uninitialized"}}}const bi=new Si;async function Mi(e){let{environment:t,messageStoreEmitValue:s}=e;if(!function(e){const t=bi.state;if("loading"===t.loadingState)return!1;if(("uninitialized"===t.loadingState?void 0:t.messageStoreEmitValue)===e)return!1;return!0}(s))return!1;const{currentSpaceStore:i,currentUserStore:n}=ie.default.state;if(!i||!n)return!1;"uninitialized"===bi.state.loadingState&&bi.setState({loadingState:"loading"});const a=await async function(e){let{environment:t,currentSpaceStore:s,currentUserStore:i}=e;const n=s.getModel();if(!n)return;if((0,xi.H)({userId:i.id,spaceModel:n})){return await(0,rt.sj)({environment:t,spaceStore:s,includeArchived:!0,currentUserId:i.id,minRoleOnTeamStores:"reader"})}return await(0,rt.qX)({environment:t,spaceStore:s,includeArchived:!0,currentUserId:i.id})}({environment:t,currentSpaceStore:i,currentUserStore:n});if(!(0,me.$K)(a))return bi.setState({loadingState:"uninitialized"}),!1;const{archivedTeams:o,unarchivedTeams:r}=(0,rt.tV)(a);return bi.setState({loadingState:"loaded",archivedTeamIds:o.map((e=>e.id)),unarchivedTeamIds:r.map((e=>e.id)),messageStoreEmitValue:s}),!0}var ji=s(88632),wi=s(27386);function Ci(e){let{spaceId:t,filters:s,disabled:n}=e;window.__c={n:"AdminContentSearchExportButton"};const[a,o]=(0,i.useState)(!1),r=(0,T.O7)(),l=n||a,d=(0,Je.yK)((e=>({button:{opacity:l?.5:1}})),[l]);return(0,oe.jsx)(St.Z,{style:d.button,disabled:l,onClick:async function(){o(!0),f.j_p(r,{filters:s}),await H.gJ(r,{spaceId:t,filters:s}),o(!1)},children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.export",defaultMessage:"Export results"})})}var ki=s(98165),Ti=s(68785),Ii=s(71291),Pi=s(44678),_i=s(44495);function Zi(e){window.__c={n:"AdminContentSearchAcknowledgement"};const t=(0,T.O7)(),s=(0,Je.yK)((e=>({container:{marginTop:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},headerIcon:{width:36,height:36,color:e.lightTextColor,fill:"currentColor"},disclaimerTitle:{margin:"12px auto",fontWeight:m.Z.fontWeight.medium,fontSize:16},disclaimer:{fontWeight:m.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:432,margin:"0 auto 16px"},acknowledgeButton:{width:195,margin:"8px auto 0"},learnMoreButton:{width:195,margin:"8px auto 0",justifyContent:"center",color:e.lightTextColor},learnMoreButtonIcon:{width:12,height:12,marginRight:4}})),[]),n=(0,i.useCallback)((()=>{f.vN5(t),w.NY(t)}),[t]);return(0,oe.jsxs)("div",{style:s.container,children:[(0,o.Q)(s.headerIcon),(0,oe.jsx)("h1",{style:s.disclaimerTitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimerTitle",defaultMessage:"Before using this feature"})}),(0,oe.jsx)("p",{style:s.disclaimer,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimer",defaultMessage:"As a workspace owner, you can use content search to find pages that you don't have access to, including the private pages of other workspace members. Consult with your organization's legal department on how to use this feature. Actions taken here will be recorded in the audit log."})}),(0,oe.jsx)(Q.Z,{style:s.acknowledgeButton,onClick:n,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.confirm",defaultMessage:"Acknowledge"})}),(0,oe.jsxs)(ve.Z,{style:s.learnMoreButton,onClick:()=>{const e=(0,Gs.UY)("adminContentSearch");v.navigateToExternalURL({environment:t,url:e})},children:[(0,_i.D)(s.learnMoreButtonIcon),(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.learnMore",defaultMessage:"Learn more"})]})]})}var Fi=s(80750);function Ai(e){let{runNewSearch:t,error:s}=e;window.__c={n:"AdminContentSearchError"};const i=(0,Je.yK)((e=>({container:{marginTop:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},headerIcon:{width:28,height:28,color:e.redBadgeBackground,fill:"currentColor"},title:{margin:"8px auto",fontWeight:m.Z.fontWeight.medium,fontSize:16},description:{fontWeight:m.Z.fontWeight.regular,fontSize:14,lineHeight:1.3,color:e.lightTextColor,textAlign:"center",width:328,margin:"0 auto 16px"},errorMessage:{borderRadius:4,background:e.cardBackground,fontFamily:m.Z.baseFontFamily.mono,fontSize:12,color:e.lightTextColor,padding:"18px 24px",margin:"0 auto 12px"},errorButton:{width:195,margin:"8px auto 0",textAlign:"center"}})),[]);return(0,oe.jsxs)("div",{style:i.container,children:[(0,Fi.l)(i.headerIcon),(0,oe.jsx)("h1",{style:i.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.title",defaultMessage:"Something went wrong"})}),(0,oe.jsx)("p",{style:i.description,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.description",defaultMessage:"Something went wrong when we were loading the results. Try to run your search again."})}),null,(0,oe.jsx)(St.Z,{style:i.errorButton,onClick:()=>t(!0),children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.confirm",defaultMessage:"Retry"})})]})}var Ri=s(80721),Di=s(26774);function Bi(e){let{selectedAudience:t,setSelectedAudience:s,onMenuClose:n,setPillTitleToActiveSelection:o}=e;window.__c={n:"AudienceFilter"};const r=(0,a.qz)(void 0,dt.Z),l=(0,Je.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:4},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},teamIcon:{marginRight:8}})),[]),[d,c]=(0,i.useState)(!1),u=["private","shared_internally","shared_externally","shared_to_web"];function m(){c(!1),n&&n()}function g(){s&&s([])}function h(e){const i=t.includes(e)?[...t.filter((t=>t!==e))]:[...t,e];s&&s(i)}const f=(0,oe.jsx)(ye.Z,{on:t.length>0,icon:(0,Di.O)(l.icon),title:o&&t[0]?Li(t[0]):(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.title",defaultMessage:"Audience"}),onClick:()=>c(!0),disabled:!s,hideChevron:!s});return s?(0,oe.jsx)(Ee.Z,{children:(0,oe.jsx)(X.ZP,{popupType:X.ZP.PopupType.Popup,placementToOrigin:X.ZP.Placement.Bottom,alignmentToOrigin:X.ZP.Alignment.Start,open:d,render:function(){const e={key:"teamOptions",items:u.map((e=>({key:e,action:()=>h(e),render:s=>(0,oe.jsx)(Y.Z,{...s,icon:(0,oe.jsx)(nt.Z,{checked:t.includes(e),onClick:()=>h(e),size:16}),focused:!1,title:Li(e),caption:Ni(e),shouldWrapCaption:!0})}))),render:e=>(0,oe.jsx)(ee.Z,{...e,title:null,loading:!1})};return(0,oe.jsxs)("div",{style:l.container,children:[(0,oe.jsx)($.Z,{menuType:se.og.Popup,header:null,maxHeight:250,width:300,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,store:r,initialFocus:0,sections:[e]})}),(0,oe.jsxs)(ee.Z,{topBorder:!0,style:l.footer,children:[(0,oe.jsx)(ve.Z,{onClick:g,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.clearButton",defaultMessage:"Clear"})}),(0,oe.jsx)(Q.Z,{onClick:m,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.doneButton",defaultMessage:"Done"})})]})]})},onDismiss:m,keepFocus:!0,origin:f,preventScaleTransition:!0})}):f}function Li(e){switch(e){case"private":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.private",defaultMessage:"Private"});case"shared_externally":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.external",defaultMessage:"Shared externally"});case"shared_internally":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.internal",defaultMessage:"Shared internally"});case"shared_to_web":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.publishedToWeb",defaultMessage:"Shared to web"});default:(0,me.t1)(e)}}function Ni(e){switch(e){case"private":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.private",defaultMessage:"Pages that only a single workspace member has access to."});case"shared_externally":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.external",defaultMessage:"Pages that are shared with guests or connections."});case"shared_internally":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.internal",defaultMessage:"Pages that are shared with other workspace members."});case"shared_to_web":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.publishedToWeb",defaultMessage:"Pages that are available for anyone to see on the web."});default:(0,me.t1)(e)}}function Oi(e){let{filters:t,setFilters:s}=e;window.__c={n:"AdminContentSearchSuggestions"};const i=(0,Je.yK)((e=>({container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},title:{margin:"12px auto",fontWeight:m.Z.fontWeight.medium,fontSize:16},description:{fontWeight:m.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:386,margin:"0 auto 16px"},suggestion:{position:"relative",height:38,width:440,margin:"12px auto 0",justifyContent:"center",color:e.darkTextColor,boxShadow:e.borderBoxShadow},filterContainer:{margin:"0 8px",display:"flex",alignItems:"center",justifyContent:"center"},arrowIconContainer:{position:"absolute",right:12,transform:"rotate(180deg)"},arrowIcon:{width:18,height:18,opacity:.5,color:e.lightTextColor,fill:"currentColor"}})),[]);return(0,oe.jsxs)("div",{style:i.container,children:[(0,oe.jsx)("h1",{style:i.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.title",defaultMessage:"Search pages in your workspace"})}),(0,oe.jsx)("p",{style:i.description,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.description",defaultMessage:"Use filters to find pages with specific sharing and permissions settings, such as:"})}),(0,oe.jsxs)(ve.Z,{style:i.suggestion,onClick:function(){s({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_externally"],teamIds:[]},{runSearchAfter:!0})},children:[(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>(0,oe.jsx)("div",{style:i.filterContainer,children:(0,oe.jsx)(Bi,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_externally"]})})}}),(0,oe.jsx)("div",{style:i.arrowIconContainer,children:(0,Ri.W)(i.arrowIcon)})]}),(0,oe.jsxs)(ve.Z,{style:i.suggestion,onClick:function(){s({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_to_web"],teamIds:[]},{runSearchAfter:!0})},children:[(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>(0,oe.jsx)("div",{style:i.filterContainer,children:(0,oe.jsx)(Bi,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_to_web"]})})}}),(0,oe.jsx)("div",{style:i.arrowIconContainer,children:(0,Ri.W)(i.arrowIcon)})]})]})}var Ei=s(27006),Vi=s(69219);function Ui(e){let{blockStore:t}=e;window.__c={n:"AudienceCell"};const[s,n]=(0,i.useState)();(0,i.useEffect)((()=>{!async function(){const{currentSpaceStore:e}=ie.default.state,s=ki.fJ(t),i=Et.Wo(s),a=null==e?void 0:e.getPermissionItems().filter(Ei.jg),o=await Et.uq({permissionItems:i,hasTeamLevelGuests:function(t){return!!e&&He.zX.createChildStore(e,{table:Kt.e0,id:t}).getMembers().some((e=>"team_level_guest"===e.type))},spaceUserPermissions:a});n(o)}()}),[t]);const a=(0,i.useMemo)((()=>{if(s)return Wi(s)}),[s]);return(0,oe.jsx)(Vi.i,{useThinTitle:!0,title:a})}function Wi(e){switch(e){case"private":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.private",defaultMessage:"Private"});case"shared_internally":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.sharedInternally",defaultMessage:"Shared internally"});case"shared_externally":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.sharedExternally",defaultMessage:"Shared externally"});case"shared_to_web":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.publishedToWeb",defaultMessage:"Published to web"});default:(0,me.t1)(e)}}var Ki=s(36409),zi=function(e){return e.Shared="shared",e.Private="private",e.Hidden="hidden",e}(zi||{});function qi(e){let{blockStore:t,teamStore:s}=e;window.__c={n:"LocationCell"};const i=(0,Je.yK)((e=>({icon:{height:18,width:18,color:e.lightIconColor,fill:"currentColor"}})),[]),n=(0,a.VK)((()=>{const e=(0,ki.fJ)(t),s=(0,Et.Wo)(e),i=s.filter((e=>!(0,Ei.Le)(e)));return 1===i.length&&(0,Ei.jg)(i[0])?zi.Private:s.length>0?zi.Shared:zi.Hidden}),[t]);return s?(0,oe.jsx)(Ki.r,{useThinTitle:!0,teamStore:s}):function(){switch(n){case zi.Shared:return(0,oe.jsx)(Vi.i,{useThinTitle:!0,icon:(0,Di.O)(i.icon),title:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.locationCell.shared",defaultMessage:"Shared"})});case zi.Hidden:case zi.Private:return(0,oe.jsx)(Vi.i,{useThinTitle:!0,icon:(0,o.Q)(i.icon),title:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.locationCell.private",defaultMessage:"Private"})})}}()}var Gi=s(15145),Hi=s(56666),Qi=s(27714),Yi=s(62397),$i=s(84210),Ji=s(77907),Xi=s(28578),en=s(61766),tn=s(55899),sn=s(8675),nn=s(31945),an=s(73063);function on(e){let{blockStore:t}=e;window.__c={n:"PageCellActions"};const s=(0,T.O7)(),n=(0,a.qz)(void 0,en.Z),o=(0,a.qz)(void 0,sn.Z),r=(0,a.qz)(void 0,tn.ZP),l=(0,Je.yK)((e=>({changePermissionsIcon:{height:18,width:18,color:e.regularIconColor,fill:"currentColor"},copyLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor"}})),[]),[d,c]=(0,i.useState)(!1);(0,i.useEffect)((()=>{o.setState({...o.state,privatePageStore:t,changePermissionsEnabled:!0,loading:!1,error:void 0})}),[t,o]);const u={key:"actions",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:[{key:"change-permissions",render:e=>(0,oe.jsx)(Y.Z,{...e,icon:(0,Yi.I)(l.changePermissionsIcon),title:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.changePermissions",defaultMessage:"Change permissions"})}),action:function(){c(!0)}},{key:"copy-link",render:e=>(0,oe.jsx)(Y.Z,{...e,icon:(0,Qi.N)(l.copyLinkIcon),title:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page"})}),action:async function(){const e=(0,$i.ZP)({store:t,pageVisitSource:Gi.tY.CopyLink});await It.RD({environment:s,stringValue:e,copiedMessage:It.tq.copiedLinkToClipboard}),n.setState({open:!1})}}]};return(0,oe.jsx)(nn.ZP,{popupType:X.kQ.Popup,alignmentToOrigin:X.ZP.Alignment.Center,placementToOrigin:X.ZP.Placement.Right,style:{width:d?450:248},render:()=>d?(0,oe.jsx)(Ji.LazyShareMenuContainer,{store:t,sudoModeStore:o,inviteTargetsStore:r,location:"admin_content_search"}):(0,oe.jsx)($.Z,{menuType:se.og.Popup,width:248,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:void 0,sections:[u]})}),onClose:()=>{c(!1),Xi.ZP.reset()},buttonPopupStore:n,renderOrigin:e=>(0,oe.jsx)(an.Z,{icon:Hi.o,...e})})}var rn=s(53695),ln=s(36596),dn=s(28992),cn=s(70301);function un(e){let{botId:t}=e;window.__c={n:"BotMenuItem"};const s=(0,p.useIntl)(),i=(0,T.O7)(),n=(0,a.VK)((()=>He.t1.createUniqueRootStore(i,{table:Z.cZ,id:t})),[t,i]),o=(0,a.VK)((()=>n.getDisplayName(s)),[n,s]),r=(0,a.VK)((()=>n.getParentStore()),[n]),l=(0,a.VK)((()=>{if(r){if(r instanceof He.U6)return r.getDisplayName(s);if(r instanceof He.H2)return r.getName()}}),[r,s]),d=(0,Je.yK)((()=>({desktopIconStyle:{alignSelf:"center",width:24,fontSize:18}})),[]);return o?(0,oe.jsx)(dn.Z,{desktopIconStyle:d.desktopIconStyle,icon:(0,oe.jsx)(cn.Z,{botStore:n,size:24}),title:o,caption:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.botMenuItem.createdBy",defaultMessage:"Created by {creatorName}",values:{creatorName:l}})}):(0,oe.jsx)(mn,{})}function mn(){window.__c={n:"ShimmerLoader"};const e=(0,Je.yK)((e=>({container:{userSelect:"none",minHeight:45,fontSize:14,padding:"4px 8px",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},textContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",gap:6},icon:{flexGrow:0,flexShrink:0,width:24,height:24,borderRadius:"0.25em",marginRight:4,marginTop:1},title:{flexGrow:0,flexShrink:0,width:80,height:14,borderRadius:"0.25em",marginLeft:4},byline:{flexGrow:0,flexShrink:0,width:150,height:10,borderRadius:"0.25em",marginLeft:4}})),[]);return(0,oe.jsxs)("div",{style:e.container,children:[(0,oe.jsx)(ln.Z,{style:e.icon}),(0,oe.jsxs)("div",{style:e.textContainer,children:[(0,oe.jsx)(ln.Z,{emphasized:!1,style:e.title}),(0,oe.jsx)(ln.Z,{emphasized:!1,style:e.byline})]})]})}var pn=s(31278);const gn=(0,p.defineMessages)({editor:{id:"adminContentSearchTab.sharedWith.permissions.editor",defaultMessage:"Full access"},readAndWrite:{id:"adminContentSearchTab.sharedWith.permissions.readAndWrite",defaultMessage:"Can edit"},commentOnly:{id:"adminContentSearchTab.sharedWith.permissions.commentOnly",defaultMessage:"Can comment"},reader:{id:"adminContentSearchTab.sharedWith.permissions.reader",defaultMessage:"Can view"},none:{id:"adminContentSearchTab.sharedWith.permissions.none",defaultMessage:"None"}});function hn(e,t){switch(t){case"editor":return e.formatMessage(gn.editor);case"read_and_write":return e.formatMessage(gn.readAndWrite);case"comment_only":return e.formatMessage(gn.commentOnly);case"reader":return e.formatMessage(gn.reader);case"none":return e.formatMessage(gn.none)}}function fn(e){let{name:t,icon:s,role:i}=e;window.__c={n:"GroupMenuItem"};const n=(0,p.useIntl)(),o=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),r=hn(n,i),l=(0,Je.yK)((e=>({defaultIcon:{height:18,width:18,color:e.lightTextColor,fill:"currentColor"},defaultGroupIcon:{height:20,width:20,color:e.lightTextColor,fill:"currentColor"}})),[]);return(0,oe.jsx)(dn.Z,{desktopIconStyle:{alignSelf:"center",width:24,fontSize:18},icon:(0,oe.jsx)(pn.Z,{disabled:!0,icon:s&&o?{pointer:o.pointer,icon:s}:void 0,size:20,isEmptyPage:!1,title:t,defaultIcon:(0,Di.O)(l.defaultGroupIcon)}),title:t||(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.untitledPage",defaultMessage:"Untitled{maybeRoleString}",values:{maybeRoleString:r?` · ${r}`:""}}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.group",defaultMessage:"Group{maybeRoleString}",values:{maybeRoleString:r?` · ${r}`:""}})})}var yn=s(74016);function xn(e){let{permissionItem:t}=e;window.__c={n:"SpaceMenuItem"};const s=(0,p.useIntl)(),i=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),n=(0,a.VK)((()=>{var e;return null===(e=ie.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),o=null==t?void 0:t.role,r=(0,Ei.iC)(o)?hn(s,o):void 0;return(0,oe.jsx)(dn.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:i?(0,oe.jsx)(yn.p,{disabled:!0,store:i,size:24}):void 0,title:n,caption:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.spaceMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:r?` · ${r}`:""}})})}var vn=s(91192);function Sn(e){let{teamId:t,role:s,onlyOwners:i}=e;window.__c={n:"TeamMenuItem"};const n=(0,T.O7)(),o=(0,p.useIntl)(),r=(0,a.VK)((()=>new He.zX(n,{table:Kt.e0,id:t})),[n,t]),l=hn(o,s),d=(0,a.VK)((()=>r.getName()),[r]),c=d||(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.unknownTeamName",defaultMessage:"Private teamspace"});return(0,oe.jsx)(dn.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:d?(0,oe.jsx)(yn.p,{disabled:!0,store:r,size:24}):(0,vn.x)(),title:c,caption:i?(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamOwners",defaultMessage:"Owners{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}}):(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}})})}var bn=s(64684),Mn=s(67669);var jn=s(7928),wn=s(45653);function Cn(e){let{userId:t,role:s,isGuest:i}=e;window.__c={n:"UserMenuItem"};const n=(0,p.useIntl)(),o=(0,T.O7)(),{userStore:r,userName:l}=(0,a.VK)((()=>{const e=new He.U6(o,{table:F.KJ,id:t}),s=(0,jn.Nz)(n,e.getModel());return{userStore:e,userName:s}}),[o,t,n]),d=hn(n,s);return(0,oe.jsx)(dn.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:(0,oe.jsx)(wn.Z,{userStore:r,size:24}),title:l,caption:i?(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.guest",defaultMessage:"Guest{maybeRoleString}",values:{maybeRoleString:d?` · ${d}`:""}}):(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.member",defaultMessage:"Member{maybeRoleString}",values:{maybeRoleString:d?` · ${d}`:""}})})}const kn=(0,p.defineMessages)({sharedWithWorkspaceMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWorkspaceMembers",defaultMessage:"Workspace members"},sharedWithTeamOwners:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamOwners",defaultMessage:"Teamspace owners"},sharedWithTeamMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamMembers",defaultMessage:"Teamspace members"},sharedWithMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithMembers",defaultMessage:"{numMembers, plural, one {# member} other {# members}}"},sharedWithGroups:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGroups",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"},sharedWithGuests:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGuests",defaultMessage:"{numGuests, plural, one {# guest} other {# guests}}"},sharedWithBots:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithBots",defaultMessage:"{numBots, plural, one {# connection} other {# connections}}"},separator:{defaultMessage:", ",id:"adminContentSearchTab.pagesTable.sharedWithCell.separator"}});function Tn(e){let{blockStore:t}=e;window.__c={n:"SharedWithCellImpl"};const s=function(e){return(0,a.VK)((()=>{const{data:t}=ui.default.state,s=t?(0,yi.CM)(t):[],i=ie.default.state.currentSpaceStore,n=(0,Mn.YO)(e),a=(null==i?void 0:i.getPermissionGroups())||[],o=(0,ki.VP)(e),r=n.find((e=>{let{permissionItem:t}=e;return Ei.$D(t)})),l=n.find((e=>{let{permissionItem:t}=e;return Ei.ix(t)})),d=o?n.find((e=>{let{permissionItem:t}=e;return(0,bn.J2)(t,o.id)})):void 0,c=n.map((e=>{let{permissionItem:t}=e;return t})).filter(Ei.zU),u=n.map((e=>{let{permissionItem:t}=e;return t})).filter(Ei.LW),m=n.map((e=>{let{permissionItem:t}=e;return t})).filter(Ei.hV).reduce(((e,t)=>{const s=t.group_id,i=t.role,n=a.find((e=>e.id===s));if(n){const t={...n,role:i};e.push(t)}return e}),[]),[p,g]=n.map((e=>{let{permissionItem:t}=e;return t})).filter(Ei.jg).reduce(((e,t)=>{const i=s.find((e=>e.userId===t.user_id));return Boolean(i&&!Ei.zz(i.role)&&!Ei.J5(i.role))?[e[0].concat(t),e[1]]:[e[0],e[1].concat(t)]}),[[],[]]);return{groupPermissions:m,mostPermissivePublicItem:r,spacePermission:l,teamPermission:d,teamSharePermissions:c,teamOwnerSharePermissions:u,guestUserPermissions:p,memberUserPermissions:g,botPermissions:n.map((e=>{let{permissionItem:t}=e;return t})).filter((e=>(0,Ei.FB)(e)))}}),[e])}(t),i=(0,p.useIntl)(),n=function(e,t){const{mostPermissivePublicItem:s,spacePermission:i,groupPermissions:n,guestUserPermissions:a,memberUserPermissions:o,teamSharePermissions:r,teamOwnerSharePermissions:l,botPermissions:d}=e,c=i&&"none"!==i.permissionItem.role;if(s&&"none"!==s.permissionItem.role)return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWeb",defaultMessage:"Shared to web"});if(!c&&0===n.length&&0===a.length&&0===o.length&&0===r.length&&0===l.length&&0===d.length)return(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage",defaultMessage:"Nobody"}),(0,oe.jsx)(te.Z,{render:e=>(0,oe.jsx)("div",{...e,children:(0,_i.D)({marginLeft:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage.tooltip",defaultMessage:"No person, group, or teamspace has any access to this page."})})]});const u=[];c?u.push(t.formatMessage(kn.sharedWithWorkspaceMembers)):(l.length>0&&0===r.length?u.push(t.formatMessage(kn.sharedWithTeamOwners)):r.length>0&&u.push(t.formatMessage(kn.sharedWithTeamMembers)),o.length>0&&u.push(t.formatMessage(kn.sharedWithMembers,{numMembers:o.length})),n.length>0&&u.push(t.formatMessage(kn.sharedWithGroups,{numGroups:n.length})));a.length>0&&u.push(t.formatMessage(kn.sharedWithGuests,{numGuests:a.length}));d.length>0&&u.push(t.formatMessage(kn.sharedWithBots,{numBots:d.length}));return u.join(t.formatMessage(kn.separator))}(s,i),o=[...s.spacePermission?[{key:"space-permission",render:e=>{var t;return(0,oe.jsx)(xn,{...e,permissionItem:null===(t=s.spacePermission)||void 0===t?void 0:t.permissionItem})},action:()=>{}}]:[],...s.teamOwnerSharePermissions.map((e=>({key:`${e.team_id}-owners`,render:t=>(0,oe.jsx)(Sn,{...t,onlyOwners:!0,teamId:e.team_id,role:e.role}),action:()=>{}}))),...s.teamSharePermissions.map((e=>({key:`${e.team_id}-members`,render:t=>(0,oe.jsx)(Sn,{...t,teamId:e.team_id,role:e.role}),action:()=>{}}))),...s.groupPermissions.map((e=>({key:e.id,render:t=>(0,oe.jsx)(fn,{...t,name:e.name,icon:e.icon,role:e.role}),action:()=>{}}))),...s.memberUserPermissions.map((e=>({key:e.user_id,render:t=>(0,oe.jsx)(Cn,{...t,userId:e.user_id,role:e.role}),action:()=>{}}))),...s.guestUserPermissions.map((e=>({key:e.user_id,render:t=>(0,oe.jsx)(Cn,{...t,isGuest:!0,userId:e.user_id,role:e.role}),action:()=>{}}))),...s.botPermissions.map((e=>({key:e.bot_id,render:t=>(0,oe.jsx)(un,{...t,botId:e.bot_id}),action:()=>{}})))];return(0,oe.jsx)(rn.N,{title:n,items:o,disabled:0===o.length})}const In=i.memo(Tn);var Pn=s(17290);function _n(e){let{blockStore:t,userIds:s,isClickable:i}=e;window.__c={n:"UsersFromIdsCell"};const n=(0,a.VK)((()=>s.map((e=>He.U6.createChildStore(t,{table:F.KJ,id:e})))),[t,s]);return(0,oe.jsx)(Pn.G,{userStores:n,isClickable:i})}const Zn={id:"page",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.name",defaultMessage:"Page"}),renderCell:e=>(0,oe.jsx)(Pi.o,{blockStore:e.pageStore,rightIcon:(0,oe.jsx)(on,{blockStore:e.pageStore})}),widthData:{width:320,maxWidth:320},sortable:!1},Fn={id:"location",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.location.name",defaultMessage:"Location"}),renderCell:e=>(0,oe.jsx)(qi,{blockStore:e.pageStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},An={id:"createdTime",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdTime.name",defaultMessage:"Created on"}),renderCell:e=>(0,oe.jsx)(Ii.T,{dateTs:e.createdTime}),widthData:{width:140},sortable:!1},Rn={id:"lastEditedTime",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedTime.name",defaultMessage:"Last edited on"}),renderCell:e=>(0,oe.jsx)(Ii.T,{dateTs:e.lastEditedTime}),widthData:{width:140},sortable:!1},Dn={id:"createdBy",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdBy.name",defaultMessage:"Created by"}),renderCell:e=>e.createdById?(0,oe.jsx)(_n,{blockStore:e.pageStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},Bn={id:"lastEditedBy",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedBy.name",defaultMessage:"Last edited by"}),renderCell:e=>e.lastEditedById?(0,oe.jsx)(_n,{blockStore:e.pageStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},Ln=[Zn,Fn,{id:"audience",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audience.name",defaultMessage:"Audience"}),renderCell:e=>(0,oe.jsx)(Ui,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},{id:"sharedWith",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWith.name",defaultMessage:"Shared with"}),renderCell:e=>(0,oe.jsx)(In,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},Bn,Rn,Dn,An];function Nn(e){let{loading:t,error:s,loadNextPage:i,filters:n,setFilters:o,pageStores:r,showSuggestions:l,runNewSearch:d}=e;window.__c={n:"AdminContentSearchTable"};const c=(0,a.VK)((()=>{const e=ie.default.state.currentSpaceViewStore,t=null==e?void 0:e.getSettings();return null==t?void 0:t.admin_content_search_acknowledgement}),[]),u=c&&!t&&!l,m=c&&!l,g=(0,a.VK)((()=>r.map((e=>({id:e.id,isClickable:!1,pageStore:e,teamStore:(0,ki.VP)(e),createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById()})))),[r]),h=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:Ln,theme:e,containerMarginTop:0})),[]);return s?(0,oe.jsx)(Ai,{runNewSearch:d,error:s}):c?l&&0===g.length?(0,oe.jsx)(Oi,{filters:n,setFilters:o}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Pt.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:400,columnRenderInfo:Ln,rows:g,onScrollBottom:m?i:void 0,renderNoRowsComponent:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:u&&(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.empty",defaultMessage:"No pages found with your query."})}),styles:h}),t?(0,oe.jsx)(Ti.Z,{style:{margin:"24px auto 24px"}}):null]}):(0,oe.jsx)(Zi,{})}var On=s(2438);function En(e){let{spaceStore:t}=e;return(0,a.VK)((()=>{const{data:e}=ui.default.state;if(!e)return{loading:!0};const s=yi.CM(e);if(!s.every((e=>He.U6.createChildStore(t,{table:F.KJ,id:e.userId}).isReady())))return{loading:!0};const i=s.filter(On.CF),n=s.filter(On.du);return{loading:!1,members:i.map((e=>{let{userId:s}=e;return He.U6.createChildStore(t,{table:F.KJ,id:s})})),guests:n.map((e=>{let{userId:s}=e;return He.U6.createChildStore(t,{table:F.KJ,id:s})}))}}),[t])}var Vn=s(84619),Un=s(40462),Wn=s(16639),Kn=s(43145),zn=s(46978),qn=s(85567),Gn=s(719);const Hn=(0,p.defineMessages)({usersPlaceholder:{id:"adminContentSearchTab.pagesTable.filters.users.usersPlaceholder",defaultMessage:"Search for users..."},usersAndGroupsPlaceholder:{id:"adminContentSearchTab.pagesTable.filters.users.usersAndGroupsPlaceholder",defaultMessage:"Search for users and groups..."}});function Qn(e){let{userStores:t,title:s,selectedItems:n,setSelectedItems:o,onMenuClose:r,isMultiSelect:l,includePermissionGroups:d,guestUserIdSet:c}=e;window.__c={n:"UsersFilter"};const u=(0,p.useIntl)(),m=(0,a.qz)(void 0,dt.Z),g=(0,Je.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:8},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%",maxHeight:200,overflowY:"auto"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},defaultGroupIcon:{height:22,width:22,color:e.mediumTextColor,fill:"currentColor"},defaultGroupIconPill:{height:14,width:14,color:e.mediumTextColor,fill:"currentColor"},groupIconSpacing:{marginRight:8},pillContainer:{margin:"0px 6px 6px 0px",background:e.legacyDefaultSelectColor,height:20},guestPillContainer:{margin:"0px 6px 6px 0px",background:e.guestTokenBackground,height:20},guestIcon:{height:16,width:16,color:e.guestIconColor},pillContents:{display:"inline-flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},pillText:{marginLeft:4},noResultsMessage:{width:"100%",margin:"8px 12px"},optionTitle:{display:"block"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"}})),[]),[h,f]=(0,i.useState)(10),[y,x]=(0,i.useState)(!1),[v,S]=(0,i.useState)(""),b=t.length,M=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),j=(0,i.useMemo)((()=>n.map((e=>{let{id:t}=e;return t}))),[n]),w=(0,a.VK)((()=>{const e=ie.default.state.currentSpaceStore;return d&&e?e.getPermissionGroups():[]}),[d]),C=(0,a.VK)((()=>j.map((e=>t.find((t=>t.id===e)))).filter(me.$K)),[j,t]),k=(0,a.VK)((()=>j.map((e=>w.find((t=>t.id===e)))).filter(me.$K)),[j,w]);function T(){f(10),x(!1),S(""),r()}function I(){S(""),o([])}function P(e){e<5&&h<b&&f(h+10)}function _(e){if(l){return j.includes(e.id)?[...n.filter((t=>{let{id:s}=t;return s!==e.id}))]:[...n,e]}return j.includes(e.id)?[]:[e]}function Z(e){const t=_({id:e,type:"user"});o(t),S("")}function F(e){const t=_({id:e,type:"permission_group"});o(t),S("")}const A=(0,i.useCallback)((e=>{S(e.target.value)}),[]),R=(0,a.VK)((()=>C.map((e=>{const t=(0,jn.Nz)(u,e.getModel()),s=!!c&&c.has(e.id);return(0,oe.jsx)(qn.Z,{isSingle:!0,format:Vn.lo.Inline,showRemoveButton:!0,onClickRemove:()=>{const t=j.filter((t=>t!==e.id)).map((e=>({id:e,type:"user"})));o(t)},style:s?g.guestPillContainer:g.pillContainer,value:(0,oe.jsxs)("div",{style:g.pillContents,children:[s?(0,Un.o)(g.guestIcon):(0,oe.jsx)(wn.Z,{userStore:e,size:16}),(0,oe.jsx)(at.Z,{style:g.pillText,children:t})]})},e.id)}))),[j,C,o,c,g,u]),B=(0,a.VK)((()=>k.map((e=>{const t=Wn.kF({intl:u,group:e});return(0,oe.jsx)(qn.Z,{isSingle:!0,format:Vn.lo.Inline,showRemoveButton:!0,onClickRemove:()=>{const t=j.filter((t=>t!==e.id)).map((e=>({id:e,type:"permission_group"})));o(t)},style:g.pillContainer,value:(0,oe.jsxs)("div",{style:g.pillContents,children:[(0,oe.jsx)(pn.Z,{disabled:!0,icon:e.icon&&M?{pointer:M.pointer,icon:e.icon}:void 0,size:14,isEmptyPage:!1,title:t,defaultIcon:(0,Di.O)(g.defaultGroupIconPill),style:g.groupIconSpacing}),(0,oe.jsx)(at.Z,{style:g.pillText,children:t})]})},e.id)}))),[j,k,o,g,M,u]);const L=(0,oe.jsx)(ye.Z,{on:j.length>0,icon:(0,ze.f)(g.icon),title:s,onClick:()=>x(!0)});return(0,oe.jsx)(Ee.Z,{children:(0,oe.jsx)(X.ZP,{popupType:X.ZP.PopupType.Popup,placementToOrigin:X.ZP.Placement.Bottom,alignmentToOrigin:X.ZP.Alignment.Start,open:y,render:function(){const e=[];for(const n of t){var s;const t=(0,jn.Nz)(u,n.getModel()),i=!!c&&c.has(n.id);(t.toLocaleLowerCase().includes(v)||null!==(s=n.getEmail())&&void 0!==s&&s.toLocaleLowerCase().includes(v))&&e.push({key:n.id,action:()=>Z(n.id),render:e=>(0,oe.jsx)(Y.Z,{...e,icon:l?(0,oe.jsx)(nt.Z,{checked:j.includes(n.id),onClick:()=>Z(n.id),size:16}):(0,oe.jsx)(zn.Z,{isSelected:j.includes(n.id)}),focused:!1,title:(0,oe.jsxs)("div",{style:g.optionContainer,children:[(0,oe.jsx)(wn.Z,{userStore:n,size:24,style:g.optionAvatar}),(0,oe.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,oe.jsx)(at.Z,{style:g.optionTitle,children:t}),(0,oe.jsx)(at.Z,{style:g.optionCaption,children:i?(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.guestCaption",defaultMessage:"Guest"}):(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.memberCaption",defaultMessage:"Member"})})]})]})})})}const i=[];for(const t of w){const e=Wn.kF({intl:u,group:t});e.toLocaleLowerCase().includes(v)&&i.push({key:t.id,action:()=>F(t.id),render:s=>(0,oe.jsx)(Y.Z,{...s,icon:l?(0,oe.jsx)(nt.Z,{checked:j.includes(t.id),onClick:()=>F(t.id),size:16}):(0,oe.jsx)(zn.Z,{isSelected:j.includes(t.id)}),focused:!1,title:(0,oe.jsxs)("div",{style:g.optionContainer,children:[(0,oe.jsx)(pn.Z,{disabled:!0,icon:t.icon&&M?{pointer:M.pointer,icon:t.icon}:void 0,size:22,isEmptyPage:!1,title:e,defaultIcon:(0,Di.O)(g.defaultGroupIcon),style:g.groupIconSpacing}),(0,oe.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,oe.jsx)(at.Z,{style:g.optionTitle,children:e}),(0,oe.jsx)(at.Z,{style:g.optionCaption,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.groupCaption",defaultMessage:"Group"})})]})]})})})}const a={key:"no-results",action:()=>{},render:e=>(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:g.noResultsMessage,...e,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.noResultsMessage",defaultMessage:"No results found."})})},r=[...e,...i],f={key:"userOptions",items:r.length>0?r.slice(0,h):[a],render:e=>(0,oe.jsx)(ee.Z,{...e,title:null,loading:!1})};return(0,oe.jsxs)("div",{style:g.container,children:[(0,oe.jsx)(Gn.Z,{focus:!0,value:v,style:g.input,placeholder:D.default.formatMessage(d?Hn.usersAndGroupsPlaceholder:Hn.usersPlaceholder),onChange:A,onRemoveLastToken:()=>{const e=n.slice(0,-1);o(e)},tokens:[...R,...B]}),(0,oe.jsxs)($.Z,{menuType:se.og.Popup,header:null,maxHeight:250,width:300,children:[(0,oe.jsx)(J.Z,{type:J.i.Vertical,store:m,initialFocus:0,sections:[f]}),(0,oe.jsx)(Kn.Z,{onChange:P})]}),(0,oe.jsxs)(ee.Z,{topBorder:!0,style:g.footer,children:[(0,oe.jsx)(ve.Z,{onClick:I,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.clearButton",defaultMessage:"Clear"})}),(0,oe.jsx)(Q.Z,{onClick:T,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.doneButton",defaultMessage:"Done"})})]})]})},onDismiss:T,keepFocus:!0,origin:L,preventScaleTransition:!0})})}function Yn(e){let{spaceStore:t,createdByFilterIds:s,setCreatedByFilter:n,runNewSearch:a,includeGuests:o}=e;window.__c={n:"CreatedByFilter"};const r=En({spaceStore:t}),l=(0,i.useMemo)((()=>r.loading?[]:o?[...r.members,...r.guests]:r.members),[r,o]),d=(0,i.useMemo)((()=>r.loading?new Set:new Set(r.guests.map((e=>e.id)))),[r]);const c=(0,i.useMemo)((()=>s.map((e=>({id:e,type:"user"})))),[s]);return(0,oe.jsx)(Qn,{userStores:l,title:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdBy.title",defaultMessage:"Created by"}),selectedItems:c,setSelectedItems:function(e){const t=e.map((e=>{let{id:t}=e;return t}));n(t)},onMenuClose:a,guestUserIdSet:d})}var $n=s(40506),Jn=s(42853),Xn=s(45959);function ea(e){let{lastEditedTime:t,createdTime:s,setLastEditedTime:n,setCreatedOnTime:o}=e;window.__c={n:"DateFilter"};const r=(0,p.useIntl)(),[l,d]=(0,i.useState)("createdTime"),c=(0,i.useMemo)((()=>{switch(l){case"createdTime":return s;case"lastEditedTime":return t;default:(0,me.t1)(l)}}),[t,s,l]),u=(0,i.useMemo)((()=>{switch(l){case"createdTime":return o;case"lastEditedTime":return n;default:(0,me.t1)(l)}}),[n,o,l]);const m=(0,a.VK)((()=>{if((0,L.mK)(c))switch(l){case"createdTime":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.title",defaultMessage:"Created on"});case"lastEditedTime":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.title",defaultMessage:"Last edited on"});default:(0,me.t1)(l)}const e=(0,L.Hq)(c),t=pe._Q(e,r,$n.sF);switch(l){case"createdTime":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.titleWithDateRange",defaultMessage:"Created on: {dateRangeString}",values:{dateRangeString:t}});case"lastEditedTime":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.titleWithDateRange",defaultMessage:"Last edited on: {dateRangeString}",values:{dateRangeString:t}});default:(0,me.t1)(l)}}),[c,l,r]);return(0,oe.jsx)(Ue,{header:(0,oe.jsx)(ta,{selectedItem:l,setSelectedItem:function(e){d(e)}}),mode:Ne.z.Pill,focused:!1,hideTime:!0,pillTitle:m,title:m,icon:ue.C,value:c,showButtons:"footer",onChange:e=>{u(e)}})}function ta(e){let{selectedItem:t,setSelectedItem:s}=e;window.__c={n:"DateTimeFilterSelector"};const i=(0,Je.yK)((e=>({button:{margin:"14px 12px 4px",padding:"2px 8px",width:"fit-content",borderRadius:4},text:{display:"flex",alignItems:"center",color:e.mediumTextColor,fill:e.lightIconColor,fontWeight:500,fontSize:13},icon:{height:10,width:10,marginLeft:4}})),[]),n={width:190,items:["createdTime","lastEditedTime"],selectedItem:t,getKey:e=>e,onSelect:e=>s(e),renderItem:e=>(0,oe.jsx)(Y.Z,{title:sa(e.value),...e}),renderOrigin:e=>(0,oe.jsx)(_t.Z,{...e,style:i.button,children:(0,oe.jsxs)("div",{style:i.text,children:[sa(t),(0,Jn.i)(i.icon)]})})};return(0,oe.jsx)(Xn.Z,{...n,mobileActionSheet:!0})}function sa(e){return{lastEditedTime:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.option",defaultMessage:"Last edited on"}),createdTime:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.option",defaultMessage:"Created on"})}[e]}var ia=s(49019);let na=function(e){return e.OnChange="on-change",e.Button="button",e}({});const aa=(0,p.defineMessages)({placeholder:{id:"adminContentSearchTab.pagesTable.filters.query.placeholder",defaultMessage:"Search by page ID, title or content"}});function oa(e){let{mode:t,query:s,setQueryFilter:n,placeholderText:a}=e;window.__c={n:"QuerySearchInput"};const[o,r]=(0,i.useState)(s??""),d=(0,Je.yK)((e=>({searchIcon:{color:e.lightIconColor,width:14},input:{padding:"4px 4px 4px 10px",margin:"0 auto 8px",width:"100%",background:e.modalBackground}})),[]),c=(0,i.useMemo)((()=>(0,l.Ds)(n,500)),[n]),u=(0,i.useCallback)((e=>{r(e.target.value),t===na.OnChange&&c(e.target.value)}),[c,t]);return(0,oe.jsx)(_e.Z,{value:o,style:d.input,left:(0,ia.e)(d.searchIcon),placeholder:a||D.default.formatMessage(aa.placeholder),onChange:u,onSubmit:()=>n(o),right:t===na.Button?(0,oe.jsx)(Q.Z,{onClick:()=>n(o),children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.query.searchButton",defaultMessage:"Search"})}):null})}function ra(e){let{spaceStore:t,sharedWithFilterItems:s,setSharedWithFilter:n,runNewSearch:a,includeGroups:o,includeGuests:r}=e;window.__c={n:"SharedWithFilter"};const l=En({spaceStore:t}),d=(0,i.useMemo)((()=>l.loading?[]:r?[...l.members,...l.guests]:l.members),[l,r]),c=(0,i.useMemo)((()=>l.loading?new Set:new Set(l.guests.map((e=>e.id)))),[l]);return(0,oe.jsx)(Qn,{isMultiSelect:!0,includePermissionGroups:o,userStores:d,title:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.sharedWith.title",defaultMessage:"Shared with"}),selectedItems:s??[],setSelectedItems:function(e){const t=e.map((e=>{let{id:t,type:s}=e;return{type:s,id:t}}));n(t.length>0?t:void 0)},onMenuClose:a,guestUserIdSet:c})}const la=(0,p.defineMessages)({placeholder:{id:"adminContentSearchTab.pagesTable.filters.teams.placeholder",defaultMessage:"Search for teamspaces..."}});function da(e){let{selectedTeamIds:t,setSelectedTeamIds:s,onMenuClose:n,teamStores:o}=e;window.__c={n:"TeamsFilter"};const r=(0,a.qz)(void 0,dt.Z),l=(0,Je.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:4},pillContainer:{margin:"0px 6px 6px 0px",background:e.legacyDefaultSelectColor,height:20},pillContents:{display:"inline-flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:4},pillText:{marginLeft:4},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},teamIcon:{marginRight:8},optionTitle:{display:"block"},noResultsMessage:{width:"100%",margin:"8px 12px"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"}})),[]),[d,c]=(0,i.useState)(!1),[u,m]=(0,i.useState)(""),g=(0,a.VK)((()=>[...o].sort(rt.KP)),[o]),h=(0,a.VK)((()=>t.map((e=>o.find((t=>t.id===e)))).filter(me.$K)),[o,t]);function f(){c(!1),m(""),n()}function y(){m(""),s([])}function x(e){const i=t.includes(e)?[]:[e];s(i),m("")}const v=(0,i.useCallback)((e=>{m(e.target.value)}),[]),S=(0,a.VK)((()=>h.map((e=>{const i=e.getName();return(0,oe.jsx)(qn.Z,{isSingle:!0,format:Vn.lo.Inline,showRemoveButton:!0,onClickRemove:()=>{const i=t.filter((t=>t!==e.id));s(i)},style:l.pillContainer,value:(0,oe.jsxs)("div",{style:l.pillContents,children:[(0,oe.jsx)(yn.p,{disabled:!0,store:e,size:16}),(0,oe.jsx)(at.Z,{style:l.pillText,children:i})]})},e.id)}))),[h,t,s,l]);const b=(0,oe.jsx)(ye.Z,{on:t.length>0,icon:(0,Di.O)(l.icon),title:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.title",defaultMessage:"Teamspace"}),onClick:()=>c(!0)});return(0,oe.jsx)(Ee.Z,{children:(0,oe.jsx)(X.ZP,{popupType:X.ZP.PopupType.Popup,placementToOrigin:X.ZP.Placement.Bottom,alignmentToOrigin:X.ZP.Alignment.Start,open:d,render:function(){const e=[];for(const n of g){const s=n.getName(),i=n.getTeamAccessLevel(),a=n.isDefault();s&&s.toLocaleLowerCase().includes(u)&&e.push({key:n.id,action:()=>x(n.id),render:e=>(0,oe.jsx)(Y.Z,{...e,icon:(0,oe.jsx)(zn.Z,{isSelected:t.includes(n.id)}),focused:!1,title:(0,oe.jsxs)("div",{style:l.optionContainer,children:[(0,oe.jsx)(yn.p,{disabled:!0,store:n,size:24,style:l.teamIcon}),(0,oe.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,oe.jsx)(at.Z,{style:l.optionTitle,children:s}),(0,oe.jsx)(at.Z,{style:l.optionCaption,children:ca(i,a)})]})]})})})}const s={key:"no-results",action:()=>{},render:e=>(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:l.noResultsMessage,...e,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.noResultsMessage",defaultMessage:"No results found."})})},i={key:"teamOptions",items:e.length>0?e:[s],render:e=>(0,oe.jsx)(ee.Z,{...e,title:null,loading:!1})};return(0,oe.jsxs)("div",{style:l.container,children:[(0,oe.jsx)(Gn.Z,{focus:!0,value:u,style:l.input,placeholder:D.default.formatMessage(la.placeholder),onChange:v,onRemoveLastToken:y,tokens:S}),(0,oe.jsx)($.Z,{menuType:se.og.Popup,header:null,maxHeight:250,width:300,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,store:r,initialFocus:0,sections:[i]})}),(0,oe.jsxs)(ee.Z,{topBorder:!0,style:l.footer,children:[(0,oe.jsx)(ve.Z,{onClick:y,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.clearButton",defaultMessage:"Clear"})}),(0,oe.jsx)(Q.Z,{onClick:f,children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.doneButton",defaultMessage:"Done"})})]})]})},onDismiss:f,keepFocus:!0,origin:b,preventScaleTransition:!0})})}function ca(e,t){if(t)return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.default",defaultMessage:"Default"});switch(e){case"private":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.private",defaultMessage:"Private"});case"closed":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.closed",defaultMessage:"Closed"});case"open":return(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.open",defaultMessage:"Open"});default:(0,me.t1)(e)}}function ua(e){let{spaceStore:t,filters:s,runNewSearch:n,setFilters:o}=e;window.__c={n:"FiltersSection"};const r=function(){const[e,t]=(0,i.useState)([]),s=(0,T.O7)(),n=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),o=(0,a.VK)((()=>{var e;return null===(e=ie.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]);return(0,i.useEffect)((()=>{!async function(){const e=await(0,rt.sj)({spaceStore:n,currentUserId:o,includeArchived:!1,minRoleOnTeamStores:"editor",environment:s});t(e)}()}),[n,o,s]),e}(),l=(0,Je.yK)((e=>({container:{margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItemsCenter:"center"}})),[]);return(0,oe.jsxs)("div",{style:l.container,children:[(0,oe.jsx)(oa,{mode:na.Button,query:s.query,setQueryFilter:function(e){o({query:e},{runSearchAfter:!0})}}),(0,oe.jsxs)("div",{style:l.filterPillsContainer,children:[(0,oe.jsx)(ea,{lastEditedTime:s.lastEditedTime,createdTime:s.createdTime,setLastEditedTime:function(e){o({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){o({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}}),(0,oe.jsx)(da,{selectedTeamIds:s.teamIds,setSelectedTeamIds:function(e){o({teamIds:e})},onMenuClose:n,teamStores:r}),(0,oe.jsx)(ra,{spaceStore:t,sharedWithFilterItems:s.sharedWith,setSharedWithFilter:function(e){o({sharedWith:e})},runNewSearch:n,includeGroups:!0,includeGuests:!0}),(0,oe.jsx)(Bi,{selectedAudience:s.audience,setSelectedAudience:function(e){o({audience:e})},onMenuClose:n}),(0,oe.jsx)(Yn,{spaceStore:t,createdByFilterIds:s.createdBy,setCreatedByFilter:function(e){o({createdBy:e})},runNewSearch:n,includeGuests:!0})]})]})}var ma=s(26263),pa=s(7406),ga=s(59753),ha=s(45953),fa=s(66504);const ya={query:"",createdBy:[],sharedWith:void 0,audience:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},xa={...ya,audience:["shared_externally","shared_internally","shared_to_web"]},va={filters:ya,pageStores:[],numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0,shouldReRunSearch:!1,showSuggestions:!0},Sa={...va,filters:xa};function ba(e){let{spaceStore:t,userStore:s}=e;const n=(0,a.VK)((()=>lt.default.checkGate("enabled_bev_default_audience_filter")),[])?Sa:va,o=(0,T.O7)(),[r,d]=(0,i.useState)(n),c=(0,i.useRef)(n.filters),u=(0,i.useCallback)((async e=>{let{restartSearch:i,ignoreFilterComparison:n}=e;if(!n&&l.Xy(r.filters,c.current))return;c.current=r.filters;let a=r.loading,u=r.error,m=r.hasNextPage,p=r.numPagesLoaded,g=r.paginationToken;if(i&&(d((e=>({...va,showSuggestions:e.showSuggestions,filters:e.filters}))),a=va.loading,u=va.error,m=va.hasNextPage,p=va.numPagesLoaded,g=va.paginationToken),m&&!a&&!u){d((e=>({...e,showSuggestions:!1,loading:!0})));try{const e=await M.adminContentSearch(o,{spaceId:t.id,sort:{field:"relevance",direction:"desc"},limit:20,paginationToken:g,query:r.filters.query,audience:r.filters.audience,lastEditedTime:(0,L.Hq)(r.filters.lastEditedTime),createdTime:(0,L.Hq)(r.filters.createdTime),createdBy:r.filters.createdBy,sharedWith:r.filters.sharedWith,teamspaceIds:r.filters.teamIds});if("failed"===e.type)throw e.error;f.jdc(o,{filters:r.filters,pageNumber:p});const i=e.data.paginationToken,n=e.data.recordIds,a=function(e){const{recordMapWithRoleJson:t}=e,s=ha.PF.create(t),i=ha.PF.create();for(const{pointer:n,model:a}of s)if(a){const e=ga.kk.fromValue(n.table,l.Xh(a.__IM_SORRY__getValue()));i.setModelAndRole(n,e,"editor")}return i}({recordMapWithRoleJson:e.data.recordMap}),c=new ma.Z({name:"adminContentSearchSettings.useContentSearch",data:new fa.o({[s.id]:a})});c.addCacheFallback(o.defaultRecordCache.inMemoryRecordCache),d((e=>{const t=[],s=new Set(e.pageStores.map((e=>e.id)));for(const i of n)if(!s.has(i)){const e=new He.G(o,{table:Vt.iU,id:i},{inMemoryRecordCache:c});t.push(e)}const a=[...e.pageStores,...t];return{...e,pageStores:a,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:i,hasNextPage:Boolean(i)}}))}catch(h){const e=(0,pa.tg)(h);d((t=>({...t,loading:!1,error:e})))}}}),[o,t,s,r.filters,r.loading,r.error,r.hasNextPage,r.numPagesLoaded,r.paginationToken]);(0,i.useEffect)((()=>{r.shouldReRunSearch&&(d((e=>({...e,shouldReRunSearch:!1}))),u({restartSearch:!0,ignoreFilterComparison:!1}))}),[r.shouldReRunSearch,u]);const m=(0,i.useCallback)((async()=>{r.shouldReRunSearch||await u({restartSearch:!1,ignoreFilterComparison:!0})}),[r.shouldReRunSearch,u]),p=(0,i.useCallback)((async e=>{await u({restartSearch:!0,ignoreFilterComparison:e||!1})}),[u]),g=(0,i.useCallback)(((e,t)=>{f.gL0(o,{newFilters:e}),d((s=>({...s,filters:{...s.filters,...e},...null!=t&&t.runSearchAfter?{shouldReRunSearch:null==t?void 0:t.runSearchAfter}:void 0})))}),[o]);return{showSuggestions:r.showSuggestions,filters:r.filters,pageStores:r.pageStores,loading:r.loading,error:r.error,hasNextPage:r.hasNextPage,loadNextPage:m,runNewSearch:p,setFilters:g}}const Ma=function(e){let{spaceStore:t,userStore:s}=e;window.__c={n:"AdminContentSearchTab"};const i=(0,T.O7)(),n=(0,a.VK)((()=>ji.Z.state.online),[]),{showSuggestions:o,loadNextPage:r,pageStores:l,loading:d,error:c,runNewSearch:u,filters:m,setFilters:g}=ba({spaceStore:t,userStore:s});return n?(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsx)(bt.Z,{large:!i.device.isMobile||void 0,divider:i.device.isMobile?void 0:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.title",defaultMessage:"Content Search"})}),(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:24},children:[(0,oe.jsx)(at.Z,{isMultiline:!0,style:{marginBottom:20},children:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.description",defaultMessage:"Search and filter for any page in the workspace, including private pages. Only workspace owners can use content search."})}),(0,oe.jsx)(Ci,{spaceId:t.id,disabled:0===l.length,filters:m})]}),(0,oe.jsx)(ua,{spaceStore:t,runNewSearch:u,setFilters:g,filters:m}),(0,oe.jsx)(Nn,{loading:d,error:c,pageStores:l,loadNextPage:r,filters:m,setFilters:g,showSuggestions:o,runNewSearch:u})]}):(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Please go online to access content search.",id:"adminContentSearchTab.offline.message"})})})};var ja=s(98692),wa=s(76463),Ca=s(98688),ka=s(61202),Ta=s(38755),Ia=s(72087),Pa=s(9999),_a=s(80920),Za=s(74181),Fa=s(90965),Aa=s(94826),Ra=s(9953),Da=s(1865),Ba=s(72371),La=s(74021),Na=s(17549),Oa=s(30874),Ea=s(20454),Va=s(22616),Ua=s(35057),Wa=s(33493),Ka=s(47453),za=s(77657),qa=s(9844),Ga=s(77137),Ha=s(78948);function Qa(e){window.__c={n:"AdminIntegrationSettingsSearchResults"};const{query:t}=e,s=(0,T.O7)(),n=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),o=(0,a.VK)((()=>null==n?void 0:n.getBotSettingsStore().getValue()),[n]),r="approved_or_built_by_notion"===(null==o?void 0:o.integration_restrictions),l=(0,a.VK)((()=>null!=o&&o.integration_approval_statuses?Object.keys(o.integration_approval_statuses):[]),[o]),c=(0,a.VK)((()=>Object.keys(za.u2).map((e=>{const t=null==n?void 0:n.getRecordModel({id:e,table:qa.K2});if("published"===(null==t?void 0:t.status))return e})).filter(me.$K)),[n]),u=(0,i.useMemo)((()=>c.some((e=>e===za.f3))),[c]),g=(0,a.VK)((()=>c.filter((e=>!l.includes(e))).slice(0,5)),[l,c]);return(0,oe.jsx)($.Z,{menuType:se.og.Popup,width:255,header:Ja(t,g,r),children:(0,oe.jsx)(Ga.Z,{request:t,performRequest:e=>async function(e){const{query:t,integrationType:s,environment:i,spaceId:n,approvedIntegrationIds:a,popularIntegrationIds:o,autoApproveBuiltByNotion:r}=e;if(!ji.Z.state.online||!n)return[];if((0,d.e)(t)||(0,d.qn)(t))return[t];if(""===t&&!r)return o;const l=await M.searchIntegrations(i,{query:t,type:s,spaceId:n});if("success"===l.type){const e=l.data.integrationIds.filter((e=>!a.includes(e))),t="production";if(!r){return e.sort(((e,s)=>(0,za.BP)({integrationId:e,env:t})===(0,za.BP)({integrationId:s,env:t})?0:(0,za.BP)({integrationId:e,env:t})?-1:1)).slice(0,5)}return e.filter((e=>!(0,za.BP)({integrationId:e,env:t}))).slice(0,5)}if("failed"===l.type)throw l.error;return(0,me.t1)(l)}({query:e,environment:s,spaceId:null==n?void 0:n.id,approvedIntegrationIds:l,popularIntegrationIds:g,autoApproveBuiltByNotion:r}),debounce:A.vp,render:(i,a,r)=>{if(!a||!r)return(0,oe.jsx)(ee.Z,{children:(0,oe.jsx)(Ha.Z,{})});const d=Za.ns.filter((e=>t&&e.name.toLowerCase().includes(t.toLowerCase())&&!l.includes(e.id)&&(e.id!==Za._o||!u))),c=[];if(0===a.length&&0===d.length)c.push({key:"no_results",render:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginLeft:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=a.map((t=>{var i;const a={table:qa.K2,id:t};if(!n)return;const r=He.y2.createChildStore(n,a),l=null===(i=r.getInfo())||void 0===i?void 0:i.icon;return{key:`${t}`,render:e=>{var t;return(0,oe.jsx)(Y.Z,{...e,title:(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.semibold},children:r.getName()}),icon:l&&(0,oe.jsx)(pn.Z,{disabled:!0,icon:{pointer:a,icon:l},isEmptyPage:!1,size:20}),style:l?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,oe.jsx)(Xa,{tagline:null===(t=r.getInfo())||void 0===t?void 0:t.tagline,isNotionIntegration:(0,za.BP)({integrationId:r.id,env:"production"})}),className:"notranslate"})},action:()=>{e.closeDropdown(),$a({environment:s,currentSpaceStore:n,botSettings:o,integrationId:t})}}})).filter(me.$K),i=d.map((t=>({key:`${t.id}`,render:e=>(0,oe.jsx)(Y.Z,{...e,title:(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.semibold},children:t.name}),icon:(0,oe.jsx)("img",{src:t.info.icon,style:{height:20}}),caption:t.info.tagline,style:{paddingBottom:12},shouldWrapCaption:!0,className:"notranslate"}),action:()=>{e.closeDropdown(),$a({environment:s,currentSpaceStore:n,botSettings:o,integrationId:t.id})}}))).filter(me.$K);c.push(...t,...i)}return(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:c}]})}})})}function Ya(e){window.__c={n:"AdminComplianceIntegrationSettingsSearchResults"};const{query:t}=e,s=(0,T.O7)(),i=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]);return i?(0,oe.jsx)($.Z,{menuType:se.og.Popup,width:255,header:Ja(t,[],!1),children:(0,oe.jsx)(Ga.Z,{request:t,performRequest:e=>async function(e){const{query:t,environment:s,spaceId:i}=e;if(!ji.Z.state.online||!i)return[];if((0,d.e)(t)||(0,d.qn)(t))return[t];const n=await M.searchIntegrations(s,{query:t,type:"compliance",spaceId:i});if("success"===n.type)return n.data.integrationIds;if("failed"===n.type)throw n.error;return(0,me.t1)(n)}({query:e,environment:s,spaceId:null==i?void 0:i.id}),debounce:A.vp,render:(t,s,n)=>{if(!s||!n)return(0,oe.jsx)(ee.Z,{children:(0,oe.jsx)(Ha.Z,{})});const a=[];if(0===s.length)a.push({key:"no_results",render:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginLeft:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=Ba.Z.state.loaded&&Oa.Z.state.loaded?Ba.Z.state.webhookSubscriptions.map((e=>{var t;return null===(t=Oa.Z.getBotsAsRecordMap().getValue({table:Z.cZ,id:e.bot_id}))||void 0===t?void 0:t.integration_id})):[],n=s.map((s=>{const n=He.y2.createChildStore(i,{id:s,table:qa.K2});if(t.includes(s))return;const a={table:qa.K2,id:s},o=He.y2.createChildStore(i,a),r=(0,Aa.I$)(o.id);return{key:`${s}`,render:e=>(0,oe.jsx)(Y.Z,{...e,title:(0,oe.jsxs)("div",{style:{display:"flex",float:"left",alignItems:"center"},children:[(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.semibold},children:o.getName()}),(null==r?void 0:r.type)&&(0,oe.jsx)("div",{style:{marginLeft:4},children:(0,oe.jsx)(qe.Z,{children:r.type})})]}),icon:(null==r?void 0:r.icon)&&(0,oe.jsx)(pn.Z,{disabled:!0,icon:{pointer:a,icon:r.icon},isEmptyPage:!1,size:20}),style:null!=r&&r.icon?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,oe.jsx)(Xa,{tagline:null!=r&&r.tagline?D.default.formatMessage(null==r?void 0:r.tagline):"A SIEM or DLP partner",isNotionIntegration:!1})}),action:()=>{var t;e.closeDropdown();n.getModel()&&(null!=r&&null!==(t=r.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==r?void 0:r.type))?Na.Z.setState({open:!0,integrationId:o.id}):La.Z.setState({open:!0,integrationId:o.id})}}})).filter(me.$K);a.push(...n)}return(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:a}]})}})}):null}function $a(e){const{environment:t,currentSpaceStore:s,botSettings:i,integrationId:n}=e;if(s&&!(0,Aa.z6)(n)){const e={...null==i?void 0:i.integration_approval_statuses,[n]:{type:"integration",status:"approved"}};C.createAndCommit({userAction:"AdminIntegrationSettingsSearchResults.handleIntegrationSelection",environment:t,perform:t=>{Ra.sW({store:s,data:{bot_settings:{...i,integration_approval_statuses:e}},transaction:t})}})}}const Ja=(e,t,s)=>!e&&!s&&t.length>0&&(0,oe.jsx)(dn.Z,{title:(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginTop:4,fontWeight:m.Z.fontWeight.medium},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Popular integrations",id:"adminIntegrationSettings.search.title.popularIntegrations"})})}),Xa=e=>{window.__c={n:"IntegrationCaption"};const{tagline:t,isNotionIntegration:s}=e,i=(0,Je.Fg)(),n=s?{}:{maxHeight:52,overflow:"auto"};return t?(0,oe.jsxs)("div",{style:n,children:[t,s&&(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:8},children:[(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Developed by Notion",id:"adminIntegrationSettings.search.subtitle.notionBuilt"}),(0,_a.X)({marginLeft:3,width:12,height:12,fill:i.invoiceGreen})]})]}):null},eo=(0,p.defineMessages)({searchInputPlaceholder:{id:"adminConnectionsSettings.search.input.placeholder",defaultMessage:"Add by name or integration ID"},complianceIntegrationSearchInputPlaceholder:{id:"adminConnectionsSettings.search.input.complianceIntegrationPlaceholder",defaultMessage:"Add by name"}});function to(){window.__c={n:"AdminConnectionsSettingsAddMenu"};const e=(0,T.O7)(),t=(0,Je.Fg)(),[s,n]=(0,i.useState)(!0),[a,o]=(0,i.useState)(!1),[r,l]=(0,i.useState)(""),d=i.createRef();return s?(0,oe.jsx)(_t.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:m.Z.fontWeight.medium,fontSize:m.Z.fontSize.UIRegular.desktop,color:et.ZP.blue,padding:"0px 6px"},onClick:()=>{n(!1)},children:(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.search.button.label",defaultMessage:"{plusIcon} Add approved connection",values:{plusIcon:(0,Ka.R)({fill:et.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,oe.jsx)(X.ZP,{alignmentToOrigin:X.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=d.current)||void 0===e||e.handleBlur(),n(!0),o(!1)},origin:(0,oe.jsx)(_e.Z,{type:"text",style:{width:255},left:(0,Ka.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),ref:d,value:r,onFocus:()=>{o(!0)},placeholder:D.default.formatMessage(eo.searchInputPlaceholder),onChange:e=>l(e.target.value)}),open:a,popupType:X.ZP.PopupType.Popup,style:{width:255},render:()=>(0,oe.jsx)(Qa,{query:r,closeDropdown:()=>o(!1)})})}function so(){window.__c={n:"AdminConnectionsSettingsAddComplianceMenu"};const e=(0,T.O7)(),t=(0,Je.Fg)(),[s,n]=(0,i.useState)(!0),[a,o]=(0,i.useState)(!1),[r,l]=(0,i.useState)(""),d=i.createRef();return s?(0,oe.jsx)(ve.Z,{isBlue:!0,style:{display:"flex",alignItems:"center",height:28,fontWeight:m.Z.fontWeight.medium,fontSize:m.Z.fontSize.UIRegular.desktop,color:et.ZP.blue,padding:"0px 6px"},onClick:()=>{var e;n(!1),null===(e=d.current)||void 0===e||e.focusInput()},children:(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettingsAddComplianceMenu.search.button.label",defaultMessage:"{plusIcon} Add connection",values:{plusIcon:(0,Ka.R)({fill:et.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,oe.jsx)(X.ZP,{alignmentToOrigin:X.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=d.current)||void 0===e||e.handleBlur(),n(!0),o(!1)},origin:(0,oe.jsx)(_e.Z,{type:"text",style:{width:255},left:(0,Ka.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),focus:!0,ref:d,value:r,onFocus:()=>{o(!0)},placeholder:D.default.formatMessage(eo.complianceIntegrationSearchInputPlaceholder),onChange:e=>l(e.target.value)}),open:a,popupType:X.ZP.PopupType.Popup,style:{width:255},render:()=>(0,oe.jsx)(Ya,{query:r,closeDropdown:()=>{n(!0),o(!1)}})})}var io=s(35878),no=s(94512),ao=s(70578),oo=s(11066),ro=s(61519),lo=s(74420),co=s(42402),uo=s(55422),mo=s(66957);const po=["member_connections","workspace_connections"];function go(e){window.__c={n:"AdminConnectionsSettings"};const t=(0,T.O7)(),{isMobile:s}=t.device,{guestBotIds:n}=e,o=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),r=(0,a.VK)((()=>Ba.Z.webhookSubscriptions.state.reduce(((e,t)=>{const s=t.getBotId();return s&&(e[s]=t.id),e}),{})),[]),d=(0,a.VK)((()=>lt.default.checkGate("webhooks_beta")||lt.default.checkGate("e_discovery")),[]),c=(0,a.VK)((()=>o?(0,l.jj)([...n,...Oa.Z.bots.state.map((e=>e.id))]).map((e=>{const t=He.Qx.createChildStore(o,{table:Z.cZ,id:e,spaceId:o.id});return t.getAlive()?t:void 0})).filter(me.$K):[]),[o,n]),u=(0,a.VK)((()=>function(e){return e.reduce(((e,t)=>{const s=t.getIntegrationId();if(!s)return e;return(0,Aa.EY)(s)?(s in e.compliance||(e.compliance[s]=[]),e.compliance[s].push(t.id)):(s in e.nonCompliance||(e.nonCompliance[s]=[]),e.nonCompliance[s].push(t.id)),e}),{compliance:{},nonCompliance:{}})}(c)),[c]),g=(0,a.VK)((()=>function(e){return e.filter((e=>!e.getIntegrationId())).map((e=>e.id))}(c)),[c]),h=(0,a.VK)((()=>function(e,t){if(!t)return{};return e.reduce(((e,s)=>{const i=Ea.U.createChildStore(t,{table:F.KJ,id:s.getCreatedById()}),n=s.getIntegrationId();return n?e[n]=n in e?[...e[n],i]:[i]:e[s.id]=[i],e}),{})}(c,o)),[c,o]),f=(0,a.VK)((()=>null==o?void 0:o.getBotSettingsStore().getValue()),[o]),y=(0,a.VK)((()=>Object.keys(u.nonCompliance).length+g.length),[u.nonCompliance,g]),x=(0,a.VK)((()=>Object.values(u.compliance).flat().length),[u.compliance]),S=(0,a.VK)((()=>null!=f&&f.integration_approval_statuses?Object.keys(f.integration_approval_statuses).length+g.length:g.length),[f,g]),b={member_connections:(0,oe.jsx)(p.FormattedMessage,{id:"admin.connections.tabs.member_connections",defaultMessage:"Member{numberOfIntegrations}",values:{numberOfIntegrations:0!==y&&(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:y+Za.T2.length})}}),workspace_connections:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(p.FormattedMessage,{id:"admin.connections.tabs.workspace_connections",defaultMessage:"Workspace{numberOfIntegrations}",values:{numberOfIntegrations:0!==x&&(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:x})}}),(0,oe.jsx)(lo.Z,{})]})},M=po.map((e=>b[e])),j=(0,a.VK)((()=>"integrations"===ci.Z.state.currentTab?ci.Z.state.defaultSubtab:void 0),[]),w=(0,a.VK)((()=>Ba.Z.integrations.state),[]),[C,k]=(0,i.useState)(j||"member_connections"),I=(0,a.VK)((()=>(0,Ua.wP)()),[]),P=(0,Je.yK)((e=>({connectedSection:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19,marginTop:20,position:"relative"},addMenu:{position:"absolute",right:0,top:0},discoverSectionUpsell:{backgroundColor:e.accentColors.interactiveBlue[100],padding:16,borderRadius:4},discoverSectionHeader:{display:"flex",justifyContent:"space-between",marginBottom:8},discoverSectionTitle:{fontSize:16,fontWeight:510},discoverSectionSubtitle:{fontSize:14,marginRight:8,color:e.lightTextColor,fontWeight:400},discoverSectionButtons:{display:"flex"},learnMoreButton:{padding:"0px 8px",borderRadius:4,display:"flex",alignItems:"center",color:e.blueColor},upgradeButton:{marginLeft:12,padding:"0px 14px"},alias:{marginLeft:6,width:"0.9em",height:"0.9em",padding:1,border:"1px solid",borderRadius:2}})),[]),_={member_connections:()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(ho,{}),(null==f?void 0:f.integration_restrictions)&&(0,oe.jsx)("div",{style:{marginTop:"19px"},children:(0,oe.jsx)(fo,{})}),(0,oe.jsx)(ro.Z,{size:s?32:18,isHidden:!s}),Boolean(null==f?void 0:f.integration_restrictions)?(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19},children:[(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28},children:(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.table.allowIntegrations.title",defaultMessage:"Approved connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==S&&(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:S})}})}),(0,oe.jsx)(to,{})]}):(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.medium,display:"flex",height:28,alignItems:"center",marginBottom:"19px"},children:(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.table.default.title",defaultMessage:"All connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==y&&(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:y+Za.T2.length})}})}),(0,oe.jsx)(io.ZP,{integrationIdToBotIds:u.nonCompliance,internalIntegrationIds:g,integrationIdToUsers:h}),(0,oe.jsx)("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4},children:(0,oe.jsx)(ao.Z,{})})]}),workspace_connections:()=>{const e=Object.keys(u.compliance),s=e.length>0,i=function(e){const{allIntegrations:t,connectedIntegrationIds:s,isEnterprise:i}=e,n=[];for(const a of t)if(!s.includes(a.id)){const e=(0,Aa.I$)(a.id);if(!e)continue;n.push({id:a.id,appName:a.name,account:void 0,caption:a.getInfo().tagline,logo:a.getInfo().icon,shouldHideInDiscover:!1,shouldShowNewBadge:!1,shouldHideConnectAccount:!0,shouldShowUpsell:!i,integrationTypes:[e.type],capabilities:(0,oe.jsx)(oe.Fragment,{}),canSelectPageAccess:!1,onConnect:()=>{var t;null!=e&&null!==(t=e.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==e?void 0:e.type)||"ediscovery"===(null==e?void 0:e.type)?Na.Z.setState({open:!0,integrationId:a.id}):La.Z.setState({open:!0,integrationId:a.id})},onDisconnect:()=>{}})}return n}({allIntegrations:w,connectedIntegrationIds:e,isEnterprise:I});return(0,oe.jsx)(oe.Fragment,{children:d?(0,oe.jsxs)(oe.Fragment,{children:[s&&(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)("div",{style:P.connectedSection,children:[(0,oe.jsx)("div",{style:P.addMenu,children:(0,oe.jsx)(so,{})}),(0,oe.jsx)(io.cP,{botIdToWebhookSubscriptionId:r,complianceIntegrationsIdToBotIds:u.compliance})]})}),(0,oe.jsx)("div",{style:{...I?{}:P.discoverSectionUpsell,marginTop:s?32:void 0},children:(0,oe.jsx)(no.Z,{apps:i,numberOfConnectedApps:e.length,numberOfDisplayRows:2,title:(0,oe.jsxs)("div",{style:P.discoverSectionHeader,children:[(0,oe.jsx)("div",{style:P.discoverSectionTitle,children:I?(0,oe.jsx)(p.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.title",defaultMessage:"Discover new connections"}):(0,oe.jsx)(p.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.titleUpsell",defaultMessage:"Upgrade to Enterprise to use these connections"})}),!I&&(0,oe.jsxs)("div",{style:P.discoverSectionButtons,children:[(0,oe.jsxs)(oo.Z,{onClick:()=>{v.navigateToExternalURL({environment:t,url:"https://www.notion.so/integrations/collections/security-and-compliance"})},style:P.learnMoreButton,children:[(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Learn more",id:"connectionsSettings.discoverNewConnectionsSection.learnMore"}),(0,Pa.J)(P.alias)]}),(0,oe.jsx)(Q.Z,{style:P.upgradeButton,onClick:async()=>{o&&(Va.Z({environment:t,spaceId:o.id}),await Wa.Z.waitUntilReady()),Da.y(t,{from:"workspace_connections",for:"enterprise",dontOpenPlansOnCancel:!0})},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Upgrade",id:"connectionsSettings.discoverNewConnectionsSection.upgrade"})})]})]}),subtitle:(0,oe.jsx)("span",{style:P.discoverSectionSubtitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"admin.connections.tab.workspace_connections.header",defaultMessage:"These integrations connect your workspace to external apps, or improve security and compliance. Only workspace owners can install them."})})})})]}):null})}},A=e=>_[e];return d?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(mo.Z,{tabs:M,selectedIndex:po.findIndex((e=>e===C)),onChange:e=>(e=>{k(po[e])})(e),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),A(C)()]}):A("member_connections")()}const ho=()=>{window.__c={n:"RequireApprovalDropdown"};const e=(0,T.O7)(),t=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),{isMobile:s}=e.device,i=(0,a.VK)((()=>(0,Ua.wP)()),[]),n=(0,a.VK)((()=>null==t?void 0:t.getBotSettingsStore().getValue()),[t]);return(0,oe.jsx)(uo.Z,{isMobile:s,title:(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.title",defaultMessage:"Restrict members from adding connections"}),caption:(0,Fa.CJ)(n)?(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.allowList.workspaceOwner.caption",defaultMessage:"Workspace members can only install connections pre-approved by workspace owners."}):(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.off.caption",defaultMessage:"Workspace members can install any new connection."}),upsellOptions:{shouldUpsell:!i,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"dropdown",currentOption:(0,Fa.CJ)(n)?"allow_list":"any_integrations",options:[{key:"any_integrations",label:(0,oe.jsx)(p.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.title",defaultMessage:"No restrictions"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.off.caption",defaultMessage:"Workspace members can install any connection."})},{key:"allow_list",label:(0,oe.jsx)(p.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.allowList.title",defaultMessage:"Only from approved list"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.allowList.caption",defaultMessage:"Workspace members can only install connections pre-approved by a workspace owner."})}],onSelectOption:s=>{!function(e){const{environment:t,currentSpaceStore:s,botSettings:i,setting:n}=e;if(s){if("allow_list"===n&&(0,Fa.CJ)(i))return;const e="allow_list"===n?"approved_only":void 0;C.createAndCommit({userAction:"AdminIntegrationSettings.handleIntegrationRestrictionSelect",environment:t,perform:t=>{Ra.sW({store:s,data:{bot_settings:{...i,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:t,botSettings:n,setting:s})},info:[{key:"learn_more",label:(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.info.title",defaultMessage:"Workspace owners can always install and approve new connections."})}]})};const fo=()=>{window.__c={n:"AutoApproveBuiltByNotionToggle"};const e=(0,T.O7)(),t=(0,Je.Fg)(),s=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),{isMobile:i}=e.device,n=(0,a.VK)((()=>(0,Ua.wP)()),[]),o=(0,a.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]);return(0,oe.jsx)(uo.Z,{isMobile:i,title:(0,oe.jsx)(p.FormattedMessage,{id:"adminConnectionsSettings.autoApproveBuiltByNotion.title",defaultMessage:"Auto-approve <builtbynotion>Built by Notion</builtbynotion> connections",values:{builtbynotion:e=>(0,oe.jsxs)("span",{style:{color:t.invoiceGreen,marginRight:4,marginLeft:4},children:[(0,_a.X)({width:14,display:"inline",verticalAlign:"bottom",marginRight:2}),e]})}}),caption:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Toggle this on to approve all workspace members to install connections <helpcenterlink>built by Notion</helpcenterlink>.",id:"adminConnectionsSettings.autoApproveBuiltByNotion.caption",values:{helpcenterlink:e=>(0,oe.jsx)(co.Z,{href:(0,Gs.UY)("guides.enterpriseIntegrationSettings"),children:e})}}),upsellOptions:{shouldUpsell:!n,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"toggle",isOn:"approved_or_built_by_notion"===(null==o?void 0:o.integration_restrictions),onToggle:()=>function(e){const{environment:t,currentSpaceStore:s,botSettings:i}=e;if(s){const e="approved_or_built_by_notion"===(null==i?void 0:i.integration_restrictions)?"approved_only":"approved_or_built_by_notion";C.createAndCommit({userAction:"AdminIntegrationSettings.handleAutoApproveBuiltByNotionToggle",environment:t,perform:t=>{Ra.sW({store:s,data:{bot_settings:{...i,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:s,botSettings:o})})};var yo=s(25777);class xo extends n.Z{constructor(){super(...arguments),this.storeTypes={requestStore:Ia.Z},this.renderResult=(e,t,s)=>{const{currentSpaceStore:i}=ie.default.state;if(i)return(0,oe.jsxs)(yo.Z,{loaded:s,spinnerSize:16,showSpinnerTimeout:600,children:[e&&(0,oe.jsx)("div",{children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})}),t&&(0,oe.jsx)(go,{...t})]})},this.fetchBotsInSpace=async e=>{let{spaceId:t}=e;return{guestBotIds:(await Promise.all([wa.Yw({environment:this.environment,table:Wt.bx,id:t,type:"guest"}),wa.Yw({environment:this.environment,table:Wt.bx,id:t,type:"external"}),ka.pJ({environment:this.environment}),Ca.v({environment:this.environment})]))[0].botIds}}}renderComponent(){const{device:e}=this.environment;if((0,Ta.Fn)(this.environment))return(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsx)(bt.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",style:{paddingBottom:12},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceConnectionsSettings.title",defaultMessage:"Connections"})}),this.renderRequest()]});x.r$({currentTab:"members"})}renderRequest(){const{spaceStore:e,userStore:t}=this.props;return(0,oe.jsx)(Ga.Z,{requestStore:this.stores.requestStore,request:{spaceId:e.id,userId:t.id},performRequest:this.fetchBotsInSpace,render:this.renderResult})}}xo.displayName="IntegrationSettings";const vo=(0,p.injectIntl)(xo);var So=s(36488),bo=s(56940),Mo=s(50506),jo=s(79603),wo=s(53770);const Co=[50,100,200,500,1e3];function ko(e){let{spaceStore:t,samlConfigStore:s,memberCountFilter:n,isPrimarySpace:o}=e;const r=(0,T.O7)(),l=(0,a.VK)((()=>s.state.emailDomains),[s]),[d,c]=(0,i.useState)({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),u=(0,a.VK)((()=>(0,Ua.wP)()),[]),m=(0,i.useCallback)((async e=>{if(u&&0!==l.length&&o&&d.nextEarliestCreatedAt&&!d.loading&&!(e&&d.numPagesLoaded>0||d.error)){c((e=>({...e,loading:!0})));try{const{spaces:e,earliestCreatedAt:s,hasMoreSpaces:i}=await(0,wo.XD)({fn:async()=>await async function(e,t,s,i,n){const a=await M.getSpacesCreatedByUserWithDomains(e,{spaceId:t,emailDomains:s,spacesLimit:10,memberCountFilter:n,spaceCreatedTimeUpperBound:i});if("failed"===a.type)throw a.error;return{spaces:a.data.results.map((e=>({id:e.id,name:e.spaceName,icon:e.spaceIcon,createdAt:e.spaceCreatedTime,memberCount:e.memberCount,subscriptionTier:e.subscriptionTier,creatorEmailDomain:e.spaceCreatedByDomain,creator:e.spaceCreator,admins:e.admins,spaceRequest:e.spaceRequest,isDelinquent:e.isDelinquent,isPendingBilling:e.isPendingBilling,isActorInSpace:e.isActorInSpace}))),earliestCreatedAt:a.data.hasMoreSpaces?a.data.earliestCreatedAt:void 0,hasMoreSpaces:a.data.hasMoreSpaces}}(r,t.id,l,d.nextEarliestCreatedAt?d.nextEarliestCreatedAt-1:Date.now(),n),handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:Co,retryAttemptRandomOffsetMS:50,initialInput:void 0});c((t=>{const n=[...t.spaces],a=new Set(t.spaces.map((e=>e.id)));for(const s of e)a.has(s.id)||n.push(s);return{spaces:n,nextEarliestCreatedAt:s,numPagesLoaded:t.numPagesLoaded+1,hasNextPage:i,loading:!1,error:void 0}}))}catch(s){const e=(0,pa.tg)(s);c((t=>({...t,loading:!1,error:e})))}}}),[r,u,n,o,t,l,d.nextEarliestCreatedAt,d.numPagesLoaded,d.loading,d.error]);const p=(0,i.useCallback)((async()=>{await m(!1)}),[m]),g=(0,i.useCallback)((async()=>{await m(!0)}),[m]),h=(0,i.useCallback)((async()=>{c({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),await m(!0)}),[m]);return{claimableSpaces:d.spaces,loading:d.loading,error:d.error,hasNextPage:d.hasNextPage,loadFirstPage:g,loadNextPage:p,resetFirstPage:h,setSpaceRequest:function(e,t){c((s=>{const i=s.spaces.map((s=>s.id===e?{...s,spaceRequest:t}:s));return{...s,spaces:i}}))},removeClaimableSpace:function(e){c((t=>{const s=t.spaces.filter((t=>t.id!==e));return{...t,spaces:s}}))}}}var To=s(59054);async function Io(e){const{environment:t,spaceId:s,store:i}=e;if(!(0,Ua.Rs)())return i.reset(),{};const n=await M.getSamlConfigForSpace(t,{spaceId:s});if("failed"===n.type)y.showError(n);else if(n.data&&n.data.samlConfig){const e={...n.data.samlConfig,useMetadataUrl:!Boolean(n.data.samlConfig.idpMetadata)};return i.setState(e),n.data}return i.reset(),{}}const Po="settings-page",_o="workspaces-page",Zo="managed-users-page";let Fo=function(e){return e[e.Single=0]="Single",e[e.Multi=1]="Multi",e}({});const Ao=(0,i.createContext)(null),Ro=e=>{let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n,children:o}=e;window.__c={n:"PageProvider"};const r=(0,T.O7)(),[l,d]=(0,i.useState)(Po),[c,m]=(0,i.useState)(Fo.Single),p=(0,a.VK)((()=>s.state.emailDomains),[s]),g=(0,a.VK)((()=>Boolean(s.state.id)&&s.state.id===t.id),[s,t]),{loading:h,error:y,loaded:x}=function(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i}=e;const n=(0,T.O7)(),[{status:a,error:o}]=(0,To.r5)((async()=>{const e=await Io({environment:n,spaceId:t.id,store:s});return(0,P.Zw)(e)?e:e.samlConfig?{samlResponse:e,domainResponse:await i.updateValueForSpace({environment:n,spaceId:t.id,store:i})}:{samlResponse:e,domainResponse:void 0}}),[n,s,t,i]);return{loading:"pending"===a,loaded:"resolved"===a,error:o}}({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),{loading:v,error:S,claimableSpaces:b,setSpaceRequest:j,removeClaimableSpace:w,hasNextPage:C,loadNextPage:k,loadFirstPage:I,resetFirstPage:_}=ko({spaceStore:t,samlConfigStore:s,isPrimarySpace:g,memberCountFilter:"single"}),{loading:Z,error:F,claimableSpaces:A,setSpaceRequest:R,removeClaimableSpace:D,hasNextPage:B,loadNextPage:L,loadFirstPage:N,resetFirstPage:O}=ko({spaceStore:t,samlConfigStore:s,isPrimarySpace:g,memberCountFilter:"multi"}),E=b.length+A.length>0,[V,U,W,K,z,q,G,H]=c===Fo.Single?[v,S,b,j,w,C,k,I,_]:[Z,F,A,R,D,B,L,N,O],{loading:Q,error:Y,domainVerifications:$}=function(e){let{spaceStore:t}=e;const s=(0,T.O7)(),[n,a]=(0,i.useState)([]),[{status:o,error:r}]=(0,To.r5)((async()=>{if(!(0,u.Rs)(t.getSubscriptionTier()))return void a([]);const e=await M.getDomainVerificationCodesForSpace(s,{spaceId:t.id,verifiedOnly:!0});"success"===e.type?a(e.data.domainVerifications):a([])}),[s,t]);return{loading:"pending"===o,domainVerifications:"resolved"===o?n:[],error:r}}({spaceStore:t,emailDomains:p});(0,i.useEffect)((()=>{I(),N()}),[W,I,N]);const J={page:l,navigateTo:function(e){d(e),0===b.length&&A.length>0&&m(Fo.Multi),"workspaces-page"===e&&f.Cez(r,{verifiedDomains:p,tab:c===Fo.Single?"single":"multi"})},loadingSaml:h,loadingSpaces:V,loadingVerifications:Q,errorSaml:y,errorClaimableSpaces:U,errorVerifications:Y,loadedSaml:x,domainVerifications:$,hasBrowsableSpaces:E,claimableSpaces:W,setSpaceRequest:K,removeClaimableSpace:z,resetInitialClaimableSpaces:H,hasMoreClaimableSpaces:q,loadMoreClaimableSpaces:G,tab:c,setSelectedTab:function(e){m(e),"workspaces-page"===l&&f.Cez(r,{verifiedDomains:p,tab:e===Fo.Single?"single":"multi"})},verifiedDomains:p};return(0,oe.jsx)(Ao.Provider,{value:J,children:o})};var Do=s(84169),Bo=s(19981),Lo=s(66466),No=s(25651),Oo=s(29851),Eo=s(2356),Vo=s(37612);let Uo=function(e){return e.User="user",e.Domains="domains",e}({});var Wo=s(64964);const Ko={managedUsers:[],filters:{query:"",multiFactorStatus:void 0,workspaceId:void 0},numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0};function zo(e){let{spaceStore:t,samlConfigStore:s,userStatus:n}=e;const o=(0,T.O7)(),[r,d]=(0,i.useState)(Ko),c=(0,i.useRef)(r.filters),u=(0,a.VK)((()=>Boolean(s.state.id)&&s.state.id===t.id),[s,t]),m=(0,a.VK)((()=>s.state.emailDomains),[s]),p=(0,i.useCallback)((async e=>{if(0===m.length)return;if(!u)return;let s=r.loading,i=r.error,a=r.hasNextPage,l=r.paginationToken;if(e.restartSearch&&(d((e=>({...Ko,filters:e.filters}))),s=Ko.loading,i=Ko.error,a=Ko.hasNextPage,l=Ko.paginationToken),a&&!s&&!i){d((e=>({...e,loading:!0}))),c.current=r.filters;try{var p;const e=await M.getManagedUsers(o,{spaceId:t.id,emailDomains:m,query:r.filters.query,multiFactorStatus:r.filters.multiFactorStatus,workspaceId:r.filters.workspaceId,paginationToken:l,userStatus:n});if(f.HH5(o,{filters:{multiFactorStatus:r.filters.multiFactorStatus,workspaceId:r.filters.workspaceId},query_length:(null===(p=r.filters.query)||void 0===p?void 0:p.length)??0,current_page:l,user_status:n}),"failed"===e.type)throw e.error;const s=e.data.nextPaginationToken,i=e.data.results;d((e=>{const t=[...e.managedUsers],n=new Set(e.managedUsers.map((e=>e.userId)));for(const s of i)n.has(s.userId)||t.push(s);return{...e,managedUsers:t,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:s,hasNextPage:Boolean(s)}}))}catch(g){const e=(0,pa.tg)(g);d((t=>({...t,loading:!1,error:e})))}}}),[o,t,m,u,r.loading,r.error,r.hasNextPage,r.paginationToken,r.filters,n]);(0,i.useEffect)((()=>{l.Xy(c.current,r.filters)||p({restartSearch:!0})}),[r.filters,p]);const g=(0,i.useCallback)((()=>p({restartSearch:!1})),[p]),h=(0,i.useCallback)((e=>{d((t=>({...t,filters:{...t.filters,...e}})))}),[]),y=(0,i.useCallback)(((e,t)=>{d((s=>({...s,managedUsers:s.managedUsers.map((s=>s.userId===e?{...s,workspaces:s.workspaces.filter((e=>e.id!==t))}:s))})))}),[]),x=(0,i.useCallback)((e=>{d((t=>({...t,managedUsers:[...t.managedUsers,e]})))}),[]),v=(0,i.useCallback)((e=>{d((t=>({...t,managedUsers:t.managedUsers.filter((t=>t.userId!==e))})))}),[]);return{managedUsers:r.managedUsers,filters:r.filters,loading:r.loading,error:r.error,removeWorkspaceFromUser:y,addUserToManagedUsers:x,removeUserFromManagedUsers:v,setFilters:h,hasNextPage:r.hasNextPage,loadNextPage:g}}let qo=function(e){return e[e.NotSuspended=0]="NotSuspended",e[e.Suspended=1]="Suspended",e}({});function Go(e){switch(e){case qo.Suspended:return"suspended";case qo.NotSuspended:return"notSuspended";default:(0,me.t1)(e)}}function Ho(e){let{lastActiveAt:t}=e;window.__c={n:"LastActiveDate"};const s=(0,Je.yK)((e=>({container:{opacity:.5}})),[]);return(0,oe.jsx)("div",{style:s.container,children:t?(0,oe.jsx)(Ii.T,{dateTs:t}):(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.unknown",defaultMessage:"No activity"})})})}const Qo={defaultMessage:"External workspace",id:"managedUsers.externalWorkspaceName",description:"A generic name to replace the real name of an external workspace."};function Yo(e){return e.formatMessage(Qo)}function $o(e){if(!e)return;const t=Object.entries(Ut.nb).find((t=>{let[s,i]=t;return i===e}));if(t){return t[0]}}function Jo(e){let{workspace:t}=e;window.__c={n:"WorkspaceSummaryName"};const s=(0,p.useIntl)(),i=(0,Je.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"}})),[]);return(0,oe.jsxs)("div",{style:i.container,children:[t.name??Yo(s),t.isExternal?(0,oe.jsx)(Xo,{}):null]})}function Xo(){window.__c={n:"ExternalWorkspaceInfoIcon"};const e=(0,Je.yK)((e=>({icon:{marginLeft:4,height:14,width:14,opacity:.5}})),[]);return(0,oe.jsx)(te.Z,{render:t=>(0,oe.jsx)("div",{...t,children:(0,_i.D)(e.icon)}),renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.userAccess.externalSpaceNameTooltipText",defaultMessage:"This is an external workspace that does not belong to this user."})})}function er(e){let{workspaceSummaries:t}=e;window.__c={n:"UserAccess"};const s=(0,p.useIntl)(),i=(0,Je.yK)((e=>({title:{marginRight:8},noWorkspaces:{paddingInline:8,opacity:.5},workspaceName:{maxWidth:"80%"},plusMore:{opacity:.5,marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",marginLeft:4}})),[]);if(t.length<=0)return(0,oe.jsx)(at.Z,{style:i.noWorkspaces,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.noWorkspaces",defaultMessage:"No workspaces"})});const n=t.find((e=>e.name)),a=n?n.name:Yo(s),o=t.length-1;return(0,oe.jsxs)("div",{style:i.titleContainer,children:[(0,oe.jsx)(at.Z,{isInline:!0,style:i.workspaceName,children:a}),!n||n.isExternal?(0,oe.jsx)(Xo,{}):null,o>0?(0,oe.jsxs)(at.Z,{isInline:!0,style:i.plusMore,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.additionalCount",defaultMessage:"+{numRemainingWorkspaces}",values:{numRemainingWorkspaces:o}}),""]}):null]})}var tr=s(93405),sr=s(83182);const ir=(0,p.defineMessages)({menuAriaLabel:{defaultMessage:"Open action menu for this user.",id:"identityAndProvisioning.managedUsers.table.menu.ariaLabel"}});function nr(e){let{managedUser:t,managedUserActionSections:s}=e;window.__c={n:"UserActionsMenu"};const i=(0,a.qz)(void 0,en.Z),n=(0,p.useIntl)(),o=(0,Je.yK)((()=>({container:{minWidth:265}})),[]);return(0,oe.jsx)(nn.ZP,{popupType:X.kQ.Popup,style:o.container,buttonPopupStore:i,renderOrigin:e=>(0,oe.jsx)(an.Z,{ariaLabel:n.formatMessage(ir.menuAriaLabel),icon:Hi.o,...e}),render:()=>(0,oe.jsx)(ar,{managedUser:t,popupStore:i,managedUserActionSections:s})})}function ar(e){let{managedUser:t,popupStore:s,managedUserActionSections:i}=e;window.__c={n:"ActionsMenu"};const n=[],a=(0,Je.yK)((()=>({destructiveIcon:{fill:et.ZP.red,color:et.ZP.red}})),[]);for(const[o,r]of i.entries()){const e=r.map(((e,s)=>({key:s,render:s=>{var i,n;return(0,oe.jsx)(tr.Z,{...s,shouldWrapCaption:!0,svg:t=>e.icon(e.isDestructive?{...t,...a.destructiveIcon}:t),title:e.title,style:{paddingTop:8,paddingBottom:8,...e.isDestructive?a.destructiveIcon:{}},disabled:null===(i=e.getDisabledState)||void 0===i?void 0:i.call(e,t),disabledFeedback:null===(n=e.getDisabledState)||void 0===n?void 0:n.call(e,t)})},action:()=>e.onClick(t)}))),s={key:`section-${o}`,render:e=>(0,oe.jsx)(ee.Z,{topBorder:o>0,...e}),items:e};n.push(s)}return(0,oe.jsxs)($.Z,{menuType:se.og.Popup,children:[(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:void 0,sections:n,onAccept:()=>{s.setState({open:!1})}}),(0,oe.jsx)(ee.Z,{topBorder:!0,children:(0,oe.jsx)(sr.Z,{title:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Learn about user suspension",id:"managedUsersDashboard.userActionsMenu.helpButton"}),href:(0,Gs.UY)("guides.managedUsers"),analyticsFrom:"managed_users_dashboard_user_actions_menu"})})]})}function or(e){let{userId:t}=e;window.__c={n:"UserSummary"};const s=(0,p.useIntl)(),i=(0,Je.yK)((e=>({iconStyle:{color:e.lightTextColor,fontWeight:500}})),[]),n=(0,a.VK)((()=>{const e=ie.default.state.currentSpaceStore;if(!e)return;const i=He.U6.createChildStore(e,{table:F.KJ,id:t});return{userStore:i,isReady:i.isReady(),userName:i.getDisplayName(s),userEmail:i.getEmail()}}),[t,s]);return null!=n&&n.isReady?(0,oe.jsx)(Vi.i,{useThinTitle:!0,title:n.userName,byline:n.userEmail,icon:(0,oe.jsx)(wn.Z,{size:28,userStore:n.userStore,iconStyle:i.iconStyle})}):(0,oe.jsx)(rr,{})}function rr(){window.__c={n:"LoadingUserSummary"};const e=(0,Je.yK)((()=>({icon:{borderRadius:"100%",height:28,width:28,marginLeft:-4}})),[]);return(0,oe.jsx)(Vi.H,{includeByline:!0,includeIcon:!0,iconStyles:e.icon})}var lr=function(e){return e.ManagedUser="managed-user",e.Loading="loading",e}(lr||{});const dr={marginLeft:4,height:14,width:14,opacity:.5},cr=[{id:"user",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.user",defaultMessage:"Users"}),renderCell:e=>e.type===lr.ManagedUser?(0,oe.jsx)(or,{userId:e.managedUser.userId}):(0,oe.jsx)(rr,{}),widthData:{width:70},sortable:!1},{id:"access",headerTitle:(0,oe.jsx)("span",{style:{paddingInline:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.access",defaultMessage:"Workspaces"})}),renderCell:e=>e.type===lr.ManagedUser?(0,oe.jsx)(er,{workspaceSummaries:e.managedUser.workspaces}):(0,oe.jsx)(rn.z,{}),widthData:{width:60},sortable:!1},{id:"lastActive",headerTitle:(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive",defaultMessage:"Last active"}),(0,oe.jsx)(te.Z,{render:e=>(0,oe.jsx)("div",{...e,children:(0,_i.D)(dr)}),renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.tooltip",defaultMessage:"This may be delayed by several hours."})})]}),renderCell:e=>e.type===lr.ManagedUser?(0,oe.jsx)(Ho,{lastActiveAt:e.managedUser.lastActiveAt}):(0,oe.jsx)(Ii.I,{}),widthData:{width:60},sortable:!1},{id:"menu",headerTitle:null,renderCell:e=>e.type===lr.ManagedUser?(0,oe.jsx)(nr,{managedUser:e.managedUser,managedUserActionSections:e.managedUserActionSections}):null,widthData:{width:15},sortable:!1,hasClickableContents:!0}],ur=[{id:"1",isClickable:!1,type:lr.Loading},{id:"2",isClickable:!1,type:lr.Loading},{id:"3",isClickable:!1,type:lr.Loading}];function mr(e){let{managedUsers:t,loadMoreManagedUsers:s,onEditDetails:i,loading:n,managedUserActionSections:a}=e;window.__c={n:"ManagedUsersTable"};const o=t.map((e=>({id:e.userId,type:lr.ManagedUser,managedUser:e,isClickable:!0,managedUserActionSections:a}))),r=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:cr,theme:e,containerMarginTop:0})),[]);const l=n?[...o,...ur]:o;return(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(Pt.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:cr,rows:l,onRowClick:function(e){e.type===lr.ManagedUser&&i(e.managedUser)},renderNoRowsComponent:()=>(0,oe.jsx)(pr,{loading:n}),styles:r,onScrollBottom:s})})}function pr(e){window.__c={n:"EmptyState"};const t=(0,Je.yK)((()=>({text:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]);return(0,oe.jsx)(at.Z,{isSmall:!0,style:t.text,children:!e.loading&&(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.empty",defaultMessage:"No users found."})})}var gr=s(33679),hr=s(93667);function fr(e){let{selectedMfaMethod:t,setSelectedMfaMethod:s}=e;return(0,oe.jsx)(hr.u,{pillTitle:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.title",defaultMessage:"2-step verification method"}),pillIcon:gr.j,selectedItem:t,setSelectedItem:s,items:yr})}const yr=[{key:"totp",value:"totp",title:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp",defaultMessage:"Authenticator"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp.caption",defaultMessage:"Users who have enabled 2-step verification through an authenticator app"}),wrapCaption:!0},{key:"sms",value:"sms",title:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms",defaultMessage:"Phone number"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms.caption",defaultMessage:"Users who have enabled 2-step verification through their phone number"}),wrapCaption:!0},{key:"backup_code",value:"backup_code",title:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backupCode",defaultMessage:"Backup code"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backup_code.caption",defaultMessage:"Users who have enabled 2-step verification with active backup codes."}),wrapCaption:!0}];var xr=s(24211),vr=s(16402),Sr=s(23063),br=s(65252),Mr=s(13490),jr=s(24006);function wr(e){let{title:t,byline:s,settingItem:i}=e;window.__c={n:"GenericSetting"};const n=(0,Je.yK)((e=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},settingLeft:{width:"60%"},settingTitle:{fontWeight:m.Z.fontWeight.regular},settingByline:{marginBottom:4}})),[]);return(0,oe.jsxs)("div",{style:n.settingContainer,children:[(0,oe.jsxs)("div",{style:n.settingLeft,children:[(0,oe.jsx)(bt.Z,{smallMarginBottom:!0,style:n.settingTitle,children:t}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:n.settingByline,children:s})]}),i]})}function Cr(e){let{title:t,byline:s,isOn:i,onToggle:n,disabled:a,tooltipForDisabled:o}=e;function r(){a||n()}return(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Top,alignment:te.Z.Alignment.End,disableTooltip:!o||!a,renderTooltip:()=>o,render:e=>(0,oe.jsx)("div",{...e,children:(0,oe.jsx)(wr,{title:t,byline:s,settingItem:(0,oe.jsx)(jr.Z,{on:i,disabled:a,onClick:r})})})})}var kr=s(53471);const Tr=(0,p.defineMessages)({uploadFailed:{defaultMessage:"Upload failed.",id:"identityAndProvisioning.managedUsers.modal.failedUpload"}});var Ir=s(50501);const Pr=(0,p.defineMessages)({getSupportAccessFailed:{defaultMessage:"Failed to load user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.getSupportAccessFailed"},setSupportAccessFailed:{defaultMessage:"Failed to update user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.setSupportAccessFailed"},toastDisabled:{id:"managedUsers.toastMessage.supportAccessDisabled",defaultMessage:"Successfully disabled user's support access status"},toastEnabled:{id:"managedUsers.toastMessage.supportAccessEnabled",defaultMessage:"Successfully enabled user's support access status"}});function _r(e){const{spaceId:t,userId:s}=e,n=(0,p.useIntl)(),a=(0,T.O7)(),[o,r]=(0,i.useState)({loading:!1,error:void 0}),[l,d]=(0,i.useState)(void 0);(0,i.useEffect)((()=>{!async function(){const e=await async function(){r({loading:!0,error:void 0});const e=await M.getDataAccessConsentForManagedUser(a,{spaceId:t,userId:s});return"failed"===e.type?(r({loading:!1,error:e.error}),void y.deprecatedShowErrorMessage(n.formatMessage(Pr.getSupportAccessFailed))):(r({loading:!1,error:void 0}),e.data.expiryTime)}();d(e)}()}),[a,n,t,s]);const c=(0,i.useMemo)((()=>Boolean(l&&Number(l)>Date.now())),[l]),u=(0,i.useCallback)((async()=>{r({loading:!0,error:void 0});const e=c?void 0:Date.now()+Ir.g,i=await M.setDataAccessConsentForManagedUser(a,{spaceId:t,userId:s,expiryTime:e});if(f.EfR(a,{new_value:Boolean(e)}),"failed"===i.type)return r({loading:!1,error:i.error}),void y.deprecatedShowErrorMessage(n.formatMessage(Pr.setSupportAccessFailed));d(e),e?Wo.oV({label:n.formatMessage(Pr.toastEnabled)}):Wo.oV({label:n.formatMessage(Pr.toastDisabled)}),r({loading:!1,error:void 0})}),[a,n,t,s,c]);return{isAccessGranted:c,toggleDataAccessConsent:u,loading:o.loading,error:o.error}}function Zr(e){window.__c={n:"WorkspacesOverview"};const{userId:t,workspaces:s,spaceStore:n,removeWorkspaceFromUser:a}=e,o=(0,Je.yK)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",gap:8,marginTop:12}})),[]);return(0,oe.jsx)("div",{style:o.container,children:s.map(((e,o)=>(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)(Fr,{userId:t,spaceStore:n,workspace:e,removeWorkspaceFromUser:a}),o<s.length-1?(0,oe.jsx)(ro.Z,{size:8}):null]},e.id)))})}function Fr(e){window.__c={n:"WorkspaceOverview"};const{userId:t,spaceStore:s,workspace:i,removeWorkspaceFromUser:n}=e,a=(0,p.useIntl)(),o=(0,T.O7)(),r=(0,Je.yK)((()=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%",gap:12,overflow:"hidden"},workspaceContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",gap:12,overflow:"hidden"},iconContainer:{alignSelf:"center"},textContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},name:{fontSize:14,fontWeight:500},nameUntitled:{fontSize:14,fontWeight:500,opacity:.25},byline:{lineHeight:1.3,fontSize:12,opacity:.5}})),[]);const l=i.icon?{pointer:{table:Wt.bx,id:i.id,spaceId:i.id},icon:i.icon}:void 0;return(0,oe.jsx)("div",{style:r.container,children:(0,oe.jsxs)("div",{style:r.workspaceContainer,children:[(0,oe.jsx)("div",{style:r.iconContainer,children:(0,oe.jsx)(pn.Z,{disabled:!0,icon:l,isEmptyPage:!1,size:28,title:i.name,isLarge:!0,emojiSize:24,isRaw:!1})}),(0,oe.jsxs)("div",{style:r.textContainer,children:[(0,oe.jsx)(at.Z,{style:r.name,isMultiline:!0,children:(0,oe.jsx)(Jo,{workspace:i})}),(0,oe.jsx)(at.Z,{style:r.byline,children:Array.isArray(i.membersCount)?1===i.membersCount.length?(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd}+ members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersLowerEndRange",values:{plan:(0,yi.t1)(i.plan,a),lowerEnd:i.membersCount[0]}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd} - {higherEnd} members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersRange",values:{plan:(0,yi.t1)(i.plan,a),lowerEnd:i.membersCount[0],higherEnd:i.membersCount[1]}}):(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"{plan} · {numMembers} {numMembers, plural, one {member} other {members}}",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembers",values:{plan:(0,yi.t1)(i.plan,a),numMembers:i.membersCount}})})]}),(0,oe.jsx)("div",{children:(0,oe.jsx)(ve.Z,{isRed:!0,onClick:async function(){f.wVl(o,{external_space_id:i.id});const e="number"==typeof i.membersCount?i.membersCount:i.membersCount[0],{accept:a}=await y.confirmUserActionV2({message:(0,oe.jsx)(at.Z,{style:y.dialogStyles.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.message",defaultMessage:"Remove user from workspace?"})}),description:(0,oe.jsx)(at.Z,{isMultiline:!0,isSecondaryColor:!0,children:e>1?(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.description",defaultMessage:"This user will no longer have access to the workspace you are removing them from. This action is not reversible."}):(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.descriptionWithDeletion",defaultMessage:"This user will no longer have access to the workspace you are removing them from. <b>The workspace will be deleted</b> since this user is the only member. This action is not reversible.",values:{b:e=>(0,oe.jsx)("b",{children:e})}})}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.acceptLabel",defaultMessage:"Remove"}),cancelLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.cancelLabel",defaultMessage:"Go back"})});if(!a)return;const r=await M.removeManagedUserFromSpace(o,{userId:t,targetSpaceId:i.id,requestingSpaceId:s.id});f.dwr(o,{external_space_id:i.id}),"success"===r.type?(n(t,i.id),Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Successfully removed user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceConfirmation",values:{workspaceName:i.name}})})):Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Failed to remove user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceFailure",values:{workspaceName:i.name}})})},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Remove",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspace"})})})]})})}const Ar=(0,p.defineMessages)({namePlaceholder:{defaultMessage:"Display name",id:"identityAndProvisioning.managedUsers.table.userAccess.namePlaceholder"},emailPlaceholder:{defaultMessage:"Email",id:"identityAndProvisioning.managedUsers.table.userAccess.emailPlaceholder"},supportAccessFailed:{defaultMessage:"Failed to load user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.supportAccessFailed"}});function Rr(e){let{spaceStore:t,managedUser:s,onClose:i,removeWorkspaceFromUser:n}=e;const a=Boolean(s);return(0,oe.jsx)(Mo.Z,{open:a,onDismiss:i,preventHideChildrenWhileOpening:!0,render:()=>s?(0,oe.jsx)(Dr,{spaceStore:t,managedUser:s,removeWorkspaceFromUser:n}):null})}function Dr(e){let{spaceStore:t,managedUser:s,removeWorkspaceFromUser:n}=e;window.__c={n:"ManagedUserDetailsScene"};const o=(0,p.useIntl)(),r=(0,T.O7)(),l=(0,a.VK)((()=>new He.U6(r,{id:s.userId,table:F.KJ})),[s,r]),d=(0,a.VK)((()=>t.id),[t]),{hasStagedChanges:c,resetState:u,saveChanges:m,loading:g,profilePhoto:h,name:x,email:v}=function(e){const{userStore:t}=e,s=(0,p.useIntl)(),n=(0,T.O7)(),{userProfilePhoto:o,userName:r,userEmail:l,isSuspended:d}=(0,a.VK)((()=>({userProfilePhoto:t.getProfilePhoto(),userName:t.getFullName(s),userEmail:t.getEmail(),isSuspended:t.getIsSuspended()})),[t,s]),[c,u]=(0,i.useState)({loading:!1,error:void 0}),[m,g]=(0,i.useState)({value:o,loading:!1}),[h,x]=(0,i.useState)(r),[v,S]=(0,i.useState)(l);return{hasStagedChanges:m.value!==o||h!==r||v!==l,saveChanges:async function(){var e;const i=null===(e=ie.default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(!i)return;const a=[];m.value!==o&&a.push("profile_photo"),h!==r&&a.push("name"),v!==l&&a.push("email"),f.amv(n,{user_status:d?"suspended":"notSuspended",edited_fields:a});const{accept:c}=await y.confirmUserActionV2({message:(0,oe.jsx)(at.Z,{style:y.dialogStyles.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.message",defaultMessage:"Confirm changes"})}),description:(0,oe.jsxs)(at.Z,{isMultiline:!0,isSecondaryColor:!0,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.description",defaultMessage:"Changes made to this user's account will be reflected across all workspaces they have access to."}),(0,oe.jsx)("br",{}),(0,oe.jsx)("br",{}),(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.descriptionForScim",defaultMessage:"If this user is being provisioned through SCIM, your changes be later overwritten by the next SCIM sync."})]}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.acceptLabel",defaultMessage:"Save changes"}),cancelLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.cancelLabel",defaultMessage:"Go back"})});if(!c)return;u({loading:!0,error:void 0});const g=await M.updateUserProfile(n,{userId:t.id,spaceId:i,name:h,email:v,profilePhoto:m.value});if(f.$B1(n,{user_status:d?"suspended":"notSuspended",edited_fields:a}),"failed"===g.type)return y.showErrorMessage((0,R.wf)(s,g)),void u({loading:!1,error:g.error});Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsers.toastMessage.updateProfileData.success",defaultMessage:"Successfully updated user's profile"})}),setTimeout((()=>{u({loading:!1,error:void 0})}),500)},resetState:function(){g({value:o,loading:!1}),x(r),S(l)},loading:c.loading,error:c.error,profilePhoto:{value:m.value,loading:m.loading,set:function(){kr.cR({environment:n,onStart:()=>{g((e=>({...e,loading:!0})))},bucket:"public",onError:()=>{g((e=>({...e,loading:!1}))),y.showErrorMessage(s.formatMessage(Tr.uploadFailed))},onComplete:e=>{const t=e[0];g({value:t,loading:!1})},accept:"image/*"})},remove:function(){g({value:"",loading:!1})}},name:{value:h,set:x},email:{value:v,set:S}}}({userStore:l}),{isAccessGranted:S,toggleDataAccessConsent:j,loading:w}=_r({userId:s.userId,spaceId:d}),C=(0,a.VK)((()=>l.getIsSuspended()?{type:"suspended"}:(0,br.os)({profilePhoto:h.value,name:x.value,email:v.value})),[l,h.value,x.value,v.value]),k=function(e){const{loadingSupportAccess:t}=e;return(0,Je.yK)((e=>({container:{position:"relative",display:"flex",flexDirection:"column",background:e.popoverBackground,width:420,maxHeight:520,overflow:"hidden",borderRadius:8},innerContainer:{position:"relative",display:"flex",flexDirection:"column",width:"100%",height:"100%",overflowY:"auto",padding:"36px 24px",gap:16},label:{color:e.mediumTextColor},horizontalLabel:{color:e.mediumTextColor,display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:4},value:{color:e.regularTextColor},input:{padding:"4px 4px 4px 10px",margin:"0 auto 8px",width:"100%",background:e.modalBackground},avatarContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},iconStyle:{border:`1px solid ${e.tableDividerColor}`,color:e.lightTextColor,fontWeight:500},inputContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%",gap:8},inputRow:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},icon:{color:e.lightIconColor,fill:"currentColor",width:14,height:14},supportAccessRow:{position:"relative",width:"100%",opacity:t?.5:1},infoContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%"},infoRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},footer:{position:"absolute",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",paddingInline:4,boxShadow:e.borderBoxShadow,background:e.popoverBackground,left:0,right:0,bottom:0,height:48},button:{height:30,marginInline:4}})),[t])}({loadingSupportAccess:w}),I=(0,xr.E2)(o),P=(0,a.VK)((()=>!ji.Z.state.online),[]),_=s.mfaMethods.filter((e=>"backup_code"!==e)),Z=o.formatList(_.map((e=>(0,b.cR)(e))),{type:"conjunction"});return(0,oe.jsxs)("div",{style:k.container,children:[(0,oe.jsxs)("div",{style:k.innerContainer,children:[(0,oe.jsx)("div",{style:k.avatarContainer,children:(0,oe.jsx)(br.ZP,{size:56,avatarType:C,isOffline:P,loading:h.loading,onUploadProfilePhoto:h.set,onRemoveProfilePhoto:h.remove})}),(0,oe.jsxs)("div",{style:k.inputContainer,children:[(0,oe.jsxs)("div",{style:k.inputRow,children:[(0,oe.jsx)(Mr.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.nameLabel",defaultMessage:"Name"})}),(0,oe.jsx)(_e.Z,{style:k.input,disabled:g,value:x.value,placeholder:o.formatMessage(Ar.namePlaceholder),onChange:e=>{x.set(e.target.value)}})]}),(0,oe.jsxs)("div",{style:k.inputRow,children:[(0,oe.jsx)(Mr.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emailLabel",defaultMessage:"Email"})}),(0,oe.jsx)(_e.Z,{style:k.input,disabled:g,value:v.value,placeholder:o.formatMessage(Ar.emailPlaceholder),onChange:e=>{v.set(e.target.value)}})]})]}),(0,oe.jsxs)("div",{style:k.infoContainer,children:[(0,oe.jsxs)("div",{style:k.infoRow,children:[(0,oe.jsx)(at.Z,{style:k.label,isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.accountCreatedLabel",defaultMessage:"Account created"})}),s.accountCreatedAt?(0,oe.jsx)(at.Z,{isSmall:!0,style:k.value,children:(0,Dt.Yx)(s.accountCreatedAt,"medium",I)}):(0,oe.jsx)(at.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyAccountCreated",defaultMessage:"Incomplete"})})]}),(0,oe.jsx)(ro.Z,{size:16}),(0,oe.jsxs)("div",{style:k.infoRow,children:[(0,oe.jsx)(at.Z,{style:k.label,isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.lastActiveLabel",defaultMessage:"Last active"})}),s.lastActiveAt?(0,oe.jsx)(at.Z,{isSmall:!0,style:k.value,children:(0,vr.gs)(s.lastActiveAt)}):(0,oe.jsx)(at.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyLastActive",defaultMessage:"No activity"})})]}),(0,oe.jsx)(ro.Z,{size:16}),(0,oe.jsxs)("div",{style:k.infoRow,children:[(0,oe.jsx)(at.Z,{style:k.label,isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.mfaLabel",defaultMessage:"2-step verification method"})}),_.length>0?(0,oe.jsx)(at.Z,{isSmall:!0,style:k.value,children:Z}):(0,oe.jsx)(at.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyMfa",defaultMessage:"Not configured"})})]}),(0,oe.jsx)(ro.Z,{size:16}),(0,oe.jsx)("div",{style:k.supportAccessRow,children:(0,oe.jsx)(Cr,{title:(0,oe.jsxs)(at.Z,{style:k.horizontalLabel,isSmall:!0,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.supportAccessToggleMessage",defaultMessage:"Support access"}),(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Bottom,render:e=>(0,oe.jsx)("div",{...e,children:(0,Do.m)(k.icon)}),renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.supportAccessToggleMessage.tooltip",defaultMessage:"Grant Notion support temporary access to this account so we can troubleshoot problems or recover content on its behalf"})})]}),byline:null,isOn:S,onToggle:j,disabled:w})})]}),(0,oe.jsx)("div",{children:s.workspaces.length>0?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Mr.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.workspacesLabel",defaultMessage:"Workspaces"})}),(0,oe.jsx)(Zr,{userId:s.userId,workspaces:s.workspaces,spaceStore:t,removeWorkspaceFromUser:n})]}):null})]}),(0,oe.jsx)(Sr.Z,{isVisible:c||g,enterAnimationStyle:{translateY:48,opacity:0},animationStyle:{opacity:1,translateY:0},exitAnimationStyle:{translateY:48,opacity:0},render:()=>(0,oe.jsxs)("div",{style:k.footer,children:[(0,oe.jsx)(St.Z,{isRed:!0,disabled:g,style:k.button,onClick:u,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.cancelButton",defaultMessage:"Cancel"})}),(0,oe.jsx)(Q.Z,{disabled:g,style:k.button,onClick:m,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.saveButton",defaultMessage:"Save changes"})})]})})]})}var Br=s(73039);function Lr(e){let{selectedSpaceId:t,setSelectedSpaceId:s,spaceData:i}=e;window.__c={n:"WorkspacesFilter"};const n=(0,p.useIntl)(),o=(0,Je.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:8},optionTitle:{display:"block"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"},container:{padding:"6px 0 6px"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:6,fill:"currentColor"}})),[]),r=(0,a.VK)((()=>i.map((e=>{const t=e.name,s=e.icon?{pointer:{table:Wt.bx,id:e.id,spaceId:e.id},icon:e.icon}:void 0;return{key:e.id,value:e.id,title:(0,oe.jsxs)("div",{style:o.optionContainer,children:[(0,oe.jsx)(pn.Z,{disabled:!0,icon:s,isEmptyPage:!1,size:24,title:t,isLarge:!0,emojiSize:24,isRaw:!1}),(0,oe.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,oe.jsx)(at.Z,{style:o.optionTitle,children:t}),(0,oe.jsx)(at.Z,{style:o.optionCaption,children:(0,yi.t1)(e.subscriptionTier,n)})]})]})}}))),[i,n,o]);return(0,oe.jsx)(hr.u,{pillTitle:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsersTab.table.filters.workspaces.title",defaultMessage:"Workspace"}),pillIcon:Br.K,selectedItem:t,setSelectedItem:s,items:r})}const Nr=(0,p.defineMessages)({placeholder:{id:"identityProvisioningSettings.managedUsers.searchInput.placeholder",defaultMessage:"Search name, email, or user ID"}});function Or(e){let{spaceStore:t,samlConfigStore:s}=e;window.__c={n:"ManagedUsersPage"};const{navigateTo:n}=(0,i.useContext)(Ao),o=(0,T.O7)(),r=(0,p.useIntl)(),l=(0,Je.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:m.Z.fontWeight.semibold,fontSize:17,display:"flex",justifyContent:"flex-start",alignItems:"center"},byline:{fontSize:14,fontWeight:m.Z.fontWeight.regular,color:e.mediumTextColor,paddingBottom:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"},filters:{display:"flex",justifyContent:"flex-start",alignItems:"center",width:"100%",margin:"0 auto 12px"}})),[]),d=(0,a.VK)((()=>s.state.spaces),[s]),{managedUsers:c,filters:u,loadNextPage:g,setFilters:h,removeWorkspaceFromUser:x,loading:S,selectedTab:b,setSelectedTab:j,onOpenDetailsModal:w,onCloseDetailsModal:C,selectedUser:k,managedUserActionSections:I}=function(e){let{spaceStore:t,samlConfigStore:s}=e;const n=(0,T.O7)(),o=(0,p.useIntl)(),[r,l]=(0,i.useState)(),[d,c]=(0,i.useState)(qo.NotSuspended),u=(0,a.VK)((()=>n.currentUser.id),[n]),m=(0,i.useCallback)(((e,t)=>{f.JX1(n,{user_status:Go(d),from:t}),l(e.userId)}),[n,d]),g=zo({userStatus:"notSuspended",spaceStore:t,samlConfigStore:s}),h=zo({userStatus:"suspended",spaceStore:t,samlConfigStore:s});let x;x=d===qo.NotSuspended?g:h;const v=(0,i.useCallback)((async e=>{f.rZG(n);const{accept:s}=await y.confirmUserActionV2({message:(0,oe.jsx)(at.Z,{style:y.dialogStyles.title,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Suspend this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.title"})}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.acceptLabel"}),description:(0,oe.jsx)(at.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"This user will not be able to log into Notion and their Notion integrations will stop working. They can be unsuspended at any time from the Managed Users dashboard.",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.description"})})});if(!s)return;const i=await M.updateUserSuspension(n,{userId:e.userId,spaceId:t.id,suspend:!0});f.rvR(n),"failed"===i.type&&y.showErrorMessage((0,R.wf)(D.default.getIntl(),i)),h.addUserToManagedUsers(e),g.removeUserFromManagedUsers(e.userId)}),[n,t.id,h,g]),S=(0,i.useCallback)((async e=>{f.NFM(n);const{accept:s}=await y.confirmUserActionV2({message:(0,oe.jsx)(at.Z,{style:y.dialogStyles.title,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Log out this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.title"})}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Log out user",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.acceptLabel"}),description:(0,oe.jsx)(at.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.description",defaultMessage:"You are about to log out this user from their current session. They will need to re-authenticate to log back into Notion."})})});if(!s)return;const i=await M.logoutManagedUsers(n,{spaceId:t.id,target:{type:Uo.User,userId:e.userId}});if(f._mq(n),"failed"===i.type)return y.showErrorMessage((0,R.wf)(D.default.getIntl(),i)),void Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsers.toastMessage.logout.failed",defaultMessage:"Failed to logged out user"})});Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsers.toastMessage.logout.success",defaultMessage:"Successfully logged out user"})})}),[n,t.id]),b=(0,i.useCallback)((async e=>{f.Zm$(n);const{accept:s}=await y.confirmUserActionV2({message:(0,oe.jsx)(at.Z,{style:y.dialogStyles.title,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Reset password for this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.title"})}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.acceptLabel",defaultMessage:"Reset passwords for user"}),description:(0,oe.jsx)(at.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.description",defaultMessage:"You are about to reset the password for this user. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}This user will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,oe.jsx)("br",{})}})})});if(!s)return;const i=await M.resetPasswordsForManagedUsers(n,{spaceId:t.id,target:{type:Uo.User,userId:e.userId}});if(f.vCG(n),"failed"===i.type)return y.showErrorMessage((0,R.wf)(o,i)),void Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.fail",defaultMessage:"Failed to reset password for user"})});Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.success",defaultMessage:"Successfully reset password for user"})})}),[n,o,t.id]),j=(0,i.useCallback)((async e=>{const s=await M.updateUserSuspension(n,{userId:e.userId,spaceId:t.id,suspend:!1});f.Cis(n),"failed"===s.type&&y.deprecatedShowErrorMessage(s.error.message),h.removeUserFromManagedUsers(e.userId),g.addUserToManagedUsers(e)}),[n,t.id,h,g]),w=(0,i.useCallback)((async e=>{f.P1A(n,{user_status:Go(d)});const{accept:s}=await y.confirmUserActionV2({message:(0,oe.jsx)(at.Z,{style:y.dialogStyles.title,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Delete this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.title"})}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.acceptLabel"}),description:(0,oe.jsx)(at.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"This action cannot be undone. This will permanently delete the user's entire account. All private workspaces will be deleted, and they will be removed from all shared workspaces.",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.description"})})});if(!s)return;const i=await M.deleteManagedUser(n,{userId:e.userId,spaceId:t.id});f.j72(n,{user_status:Go(d)}),"failed"===i.type&&y.deprecatedShowErrorMessage(i.error.message),h.removeUserFromManagedUsers(e.userId),g.removeUserFromManagedUsers(e.userId)}),[n,d,t.id,h,g]),C=(0,i.useMemo)((()=>x.managedUsers.find((e=>{let{userId:t}=e;return t===r}))),[r,x.managedUsers]),k=(0,i.useMemo)((()=>{let e;const t={onClick:e=>m(e,"dropdown_menu"),icon:No.R,title:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.userDetails",defaultMessage:"Edit details"})},s={onClick:e=>w(e),icon:Vo.y,title:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser",defaultMessage:"Delete user"}),isDestructive:!0};switch(d){case qo.NotSuspended:e=[[t,{onClick:S,icon:Lo.S,title:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logout",defaultMessage:"Log out"})},{onClick:b,icon:Oo.z,title:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.passwordReset",defaultMessage:"Reset password"})}],[{onClick:v,icon:Bo.V,title:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser",defaultMessage:"Suspend user"}),getDisabledState:e=>e.userId===u},s]];break;case qo.Suspended:e=[[t],[{onClick:e=>j(e),icon:Eo.u,title:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.unSuspendUser",defaultMessage:"Reactivate user"})},s]];break;default:(0,me.t1)(d)}return e.filter((e=>e.length>0))}),[m,u,d,w,v,j,S,b]);return{...x,selectedTab:d,setSelectedTab:c,selectedUser:C,managedUserActionSections:k,onOpenDetailsModal:m,onCloseDetailsModal:function(){l(void 0)}}}({spaceStore:t,samlConfigStore:s}),P=(0,i.useCallback)((e=>w(e,"row_click")),[w]);return(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsx)(co.Z,{style:l.link,onClick:()=>n(Po),children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,oe.jsxs)(bt.Z,{large:!0,style:l.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.title",defaultMessage:"User management"}),(0,oe.jsx)(an.Z,{icon:Do.m,ariaLabel:r.formatMessage({defaultMessage:"Managed users settings help button",id:"identityProvisioningSettings.managedUsers.helpButton.label"}),onClick:()=>v.navigateToExternalURL({environment:o,url:(0,Gs.UY)("guides.managedUsers")})})]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:l.byline,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.byline",defaultMessage:"Manage and view users that are using your verified domains"})}),(0,oe.jsx)(mo.Z,{tabs:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.notSuspendedTab.title",defaultMessage:"Active"},"notSuspended.title"),(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.suspendedTab.title",defaultMessage:"Suspended"},"suspended")],selectedIndex:b,onChange:e=>j(e),style:l.tabBarMenu}),(0,oe.jsx)(oa,{mode:na.Button,query:u.query,setQueryFilter:e=>{h({query:e})},placeholderText:D.default.formatMessage(Nr.placeholder)}),(0,oe.jsxs)("div",{style:l.filters,children:[(0,oe.jsx)(Lr,{selectedSpaceId:u.workspaceId,setSelectedSpaceId:e=>{h({workspaceId:e})},spaceData:d}),(0,oe.jsx)(fr,{selectedMfaMethod:u.multiFactorStatus,setSelectedMfaMethod:e=>{h({multiFactorStatus:e})}})]}),(0,oe.jsx)(mr,{managedUsers:c,loading:S,loadMoreManagedUsers:g,onEditDetails:P,managedUserActionSections:I},b),(0,oe.jsx)(Rr,{spaceStore:t,managedUser:k,onClose:C,removeWorkspaceFromUser:x})]})}function Er(e){let{environment:t,samlConfigStore:s}=e;const i=s.state.emailDomains.length>0,n=(0,Ua.zt)();return i||("business"===n||"enterprise"===n)}var Vr=s(81236);async function Ur(e){let{onRequest:t,onSuccess:s}=e;const i=await t();switch(i.type){case"success":s&&await s(i);break;case"failed":y.showErrorMessage((0,R.wf)(D.default.getIntl(),i));break;default:(0,me.t1)(i)}}function Wr(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n}=e;const o=(0,T.O7)(),r=(0,a.VK)((()=>s.state.emailDomains),[s]),l=(0,a.VK)((()=>"disabled"!==s.state.status&&"unconfigured"!==s.state.status),[s]),d=(0,a.VK)((()=>Er({environment:o,samlConfigStore:s})),[s,o]),c=(0,a.VK)((()=>d&&(!s.state.id||s.state.id===t.id)),[d,s,t]),u=(0,a.VK)((()=>n.state.emailDomains.length>0&&(0,Ua.wP)()),[n]),m=(0,a.VK)((()=>r.length>0),[r]),p=(0,i.useCallback)((async()=>{if(s.state.emailDomains.length>0)return Ur({onRequest:()=>M.updateWorkspaceCreationForEmailDomains(o,{emailDomains:s.state.emailDomains,workspaceCreationEnum:n.state.spaceCreation,spaceId:t.id}),onSuccess:()=>{n.setState({...n.state,emailDomains:s.state.emailDomains})}})}),[o,t,n,s]),g=(0,i.useCallback)((async()=>{if(s.state.emailDomains.length>0)return Ur({onRequest:()=>M.updateEmailDomainSettings(o,{emailDomains:s.state.emailDomains,spaceId:t.id,preventProfileEdits:n.state.settings.prevent_profile_edits,preventMembersJoiningExternalWorkspace:n.state.settings.prevent_members_joining_external_workspace,customSessionDuration:$o(n.state.settings.custom_session_duration),preventGrantingSupportAccess:n.state.settings.prevent_granting_support_access}),onSuccess:()=>{n.setState({...n.state,emailDomains:s.state.emailDomains})}})}),[o,t,n,s]),h=(0,a.VK)((()=>d&&(0,Ua.wP)()),[d]);return{verifiedDomains:r,isSamlStatusEnabled:l,isSamlAvailable:d,isSamlEditable:c,isDomainSettingsAvailable:u,isClaimSpacesAvailable:h,canSaveWorkspaceCreationSetting:m,saveWorkspaceCreationSetting:p,saveEmailDomainSettings:g}}var Kr=s(91718);function zr(e){let{title:t,byline:s,targetTier:n}=e;window.__c={n:"Upsell"};const a=(0,T.O7)(),o=(0,i.useCallback)((()=>Da.y(a,{from:"space_saml",for:n})),[a,n]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)(bt.Z,{smallMarginBottom:!0,style:{fontWeight:m.Z.fontWeight.regular,display:"flex",alignItems:"center"},children:[(0,oe.jsx)("span",{style:{marginRight:8},children:t}),(0,oe.jsx)(Kr.Z,{subscriptionTier:n,analyticsName:"space_saml",onClick:o})]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,children:s})]})}const qr={browseWorkspaces:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Browse workspaces",id:"identityAndProvisioning.claimWorkspaces.button"}),noWorkspaces:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"No workspaces",id:"identityAndProvisioning.claimWorkspaces.buttonEmpty"}),loadingError:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Error loading workspaces.",id:"identityAndProvisioning.claimWorkspaces.errorByline"})};function Gr(e){let{promptUpgrade:t}=e;window.__c={n:"ClaimSpaces"};const{navigateTo:s,loadingSpaces:n,hasBrowsableSpaces:a,errorClaimableSpaces:o}=(0,i.useContext)(Ao),r=Boolean(o),l=!a||n,d=!a&&!n,c=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces"}),u=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.message",defaultMessage:"Claim workspaces created by users with a verified domain or require owners to use an external domain."}),m=(0,Je.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:l?.5:1,minWidth:160},settingErrorByline:{color:e.errorText,marginTop:8,fontSize:13}})),[l]);if(t)return(0,oe.jsx)(zr,{title:c,byline:u,targetTier:"enterprise"});let g;return g=n?(0,oe.jsx)(Ti.Z,{}):a?qr.browseWorkspaces:qr.noWorkspaces,(0,oe.jsx)("div",{style:m.settingContainer,children:(0,oe.jsx)(wr,{title:c,byline:u,settingItem:(0,oe.jsxs)("div",{style:m.buttonAndErrorContainer,children:[(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Top,alignment:te.Z.Alignment.End,render:e=>(0,oe.jsx)(St.Z,{disabled:l,isLarge:!0,style:m.button,onClick:()=>s(_o),...e,children:g}),disableTooltip:!d,renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.tooltip",defaultMessage:"There are no available workspaces to claim"})}),r?(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:m.settingErrorByline,children:qr.loadingError}):null]})})})}var Hr=s(52507),Qr=s(86249);function Yr(e){let{spaceStore:t,samlConfigStore:s,promptUpgrade:n,disabled:o,saveWorkspaceCreationSetting:r}=e;window.__c={n:"EmailDomains"};const l=(0,T.O7)(),d=(0,a.qz)(void 0,Hr.ZP),c=(0,Je.yK)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{position:"relative",marginLeft:"auto",marginRight:0,opacity:o?.5:1},plusIcon:{width:14,height:14,fill:"inherit",marginRight:"6px"}})),[o]),u=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains"}),g=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single-sign on."}),h=[...(0,a.VK)((()=>s.state.emailDomains.map(Qr.f4)),[s]),...(0,a.VK)((()=>s.state.domainVerifications.filter((e=>!s.state.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map(Qr.UV)),[s])],f=(0,i.useCallback)((async()=>{await Io({environment:l,spaceId:t.id,store:s})}),[l,t,s]),{resetInitialClaimableSpaces:y}=(0,i.useContext)(Ao),x=(0,i.useCallback)((async e=>{switch(e.type){case"verified":return Ur({onRequest:()=>M.setSamlConfig(l,{spaceId:t.id,removedEmailDomains:[e.domain]}),onSuccess:async()=>{await f(),y()}});case"unverified":case"invalid":return Ur({onRequest:()=>M.deleteDomainVerificationCode(l,{id:e.id}),onSuccess:()=>f()})}}),[l,t,f,y]),v=(0,i.useCallback)((()=>Ur({onRequest:()=>M.setSamlConfig(l,{spaceId:t.id}),onSuccess:()=>f()})),[l,f,t]),S=(0,i.useCallback)((async()=>{await f(),await r()}),[r,f]);return n?(0,oe.jsx)(zr,{title:u,byline:g,targetTier:"business"}):(0,oe.jsx)(Qr.ZP,{disabled:o,domains:h,onRemoveDomain:x,domainVerificationStore:d,verificationType:"saml_config",verificationTargetId:t.id,refreshDomains:S,onClickAddDomain:v,renderOverrideAddDomainButton:e=>(0,oe.jsxs)("div",{style:c.flex,children:[(0,oe.jsxs)("div",{children:[(0,oe.jsx)(bt.Z,{smallMarginBottom:!0,style:{fontWeight:m.Z.fontWeight.medium},children:u}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginBottom:4},children:g})]}),(0,oe.jsx)("div",{children:(0,oe.jsx)(ve.Z,{isBlue:!0,style:c.button,icon:e=>(0,Ka.R)({...e,...c.plusIcon}),disabled:o,onClick:e,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})})})]})})}function $r(e){let{domainSettingsStore:t,samlConfigStore:s,disabled:n,promptUpgrade:o,verifiedDomains:r,tooltip:l,saveWorkspaceCreationSetting:d}=e;window.__c={n:"WorkspaceCreation"};const c=(0,T.O7)(),u=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),m=(0,a.VK)((()=>{const e=s.state.id;if(!e)return;return new He.H2(c,{table:Wt.bx,id:e}).getName()}),[c,s]),g=(0,i.useCallback)((async e=>{t.setState({...t.state,spaceCreation:e}),await d(),f.tir(c,{workspace_creation:e})}),[t,d,c]),h=(0,a.VK)((()=>r.length>0?t.state.spaceCreation:"admins_only"),[t,r]),y=(0,oe.jsx)(p.FormattedMessage,{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation"}),x=(0,oe.jsx)(p.FormattedMessage,{id:"domainSettings.workspaceCreation.byline",defaultMessage:"Customize who can create new workspaces."}),v=(0,oe.jsx)(p.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} workspace owners",values:{primaryWorkspaceName:m}}),S=(0,oe.jsx)(p.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.title",defaultMessage:"Only workspace owners"});return o?(0,oe.jsx)("div",{style:u.settingContainer,children:(0,oe.jsx)(zr,{title:y,byline:x,targetTier:"enterprise"})}):(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Top,alignment:te.Z.Alignment.End,render:e=>(0,oe.jsx)("div",{...e,style:u.settingContainer,children:(0,oe.jsx)(uo.Z,{isMobile:c.device.isMobile,disabled:n,title:y,caption:x,type:"dropdown",currentOption:h,options:[{key:"unrestricted",label:(0,oe.jsx)(p.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.title",defaultMessage:"Anyone"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.caption",defaultMessage:"Any user can create new workspaces."})},{key:"admins_only",label:m?v:S,caption:(0,oe.jsx)(p.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.captionWithSpaceName",defaultMessage:"Only workspace owners of this workspace can create new workspaces."})}],onSelectOption:g})}),disableTooltip:!l,renderTooltip:()=>l})}function Jr(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i,isCurrentSpaceEnterprise:n}=e;window.__c={n:"DomainSection"};const{verifiedDomains:a,isSamlAvailable:o,saveWorkspaceCreationSetting:r,isSamlEditable:l,isDomainSettingsAvailable:d,canSaveWorkspaceCreationSetting:c,isClaimSpacesAvailable:u}=Wr({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),m=d&&l;return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Yr,{disabled:!l,promptUpgrade:!o,spaceStore:t,samlConfigStore:s,saveWorkspaceCreationSetting:r}),(0,oe.jsx)($r,{disabled:!m||!c,promptUpgrade:!n,verifiedDomains:a,samlConfigStore:s,domainSettingsStore:i,tooltip:0===a.length?(0,oe.jsx)(p.FormattedMessage,{id:"domainSettings.workspaceCreation.disabledTooltip",defaultMessage:"There must be at least one verified domain to configure the workspace creation setting."}):void 0,saveWorkspaceCreationSetting:r}),(0,oe.jsx)(Gr,{promptUpgrade:!u})]})}var Xr=s(74523);function el(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:n,disabled:o}=e;window.__c={n:"CustomSessionDurationSetting"};const r=(0,T.O7)(),l=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),d=(0,i.useMemo)((()=>Object.entries(Ut.nb).map((e=>{let[t,s]=e;return{key:t,label:(0,oe.jsx)(at.Z,{children:(0,vr.hH)(0,s)})}}))),[]),c=(0,a.VK)((()=>$o(t.state.settings.custom_session_duration)??Ut.gl),[t]),u=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.title",defaultMessage:"Session duration"}),m=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.message",defaultMessage:"Control how long your managed users can be logged in for before they must re-authenticate."});return n?(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(zr,{title:u,byline:m,targetTier:"enterprise"})}):(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(uo.Z,{isMobile:r.device.isMobile,disabled:o,title:u,caption:m,type:"dropdown",currentOption:c,options:d,onSelectOption:async function(e){const i=t.state.settings.custom_session_duration??Ut.nb[Ut.gl],n=Ut.nb[e];if(void 0===n)return;f.LOF(r,{custom_session_duration_ms:i});const{accept:a}=await y.confirmUserActionV2({message:(0,oe.jsx)(at.Z,{style:y.dialogStyles.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.message",defaultMessage:"Confirm change"})}),description:(0,oe.jsxs)(at.Z,{isMultiline:!0,isSecondaryColor:!0,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.description",defaultMessage:"You are about to change the session duration for all of your managed users from <b>{oldDuration}</b> to <b>{newDuration}.</b>",values:{oldDuration:(0,vr.hH)(0,i),newDuration:(0,vr.hH)(0,n),b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,oe.jsx)("b",{children:t})}}}),(0,oe.jsx)("br",{}),(0,oe.jsx)("br",{}),(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.secondDescription",defaultMessage:"This may log some users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})]}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.acceptLabel",defaultMessage:"Confirm change"}),cancelLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.cancelLabel",defaultMessage:"Cancel"})});a&&(t.setState({...t.state,settings:{...t.state.settings,custom_session_duration:n}}),f.l0P(r,{new_session_duration_ms:n}),await s())}})})}function tl(e){let{spaceId:t,domainSettingsStore:s,promptUpgrade:i,verifiedDomains:n,disabled:a}=e;window.__c={n:"ForcePasswordResetSetting"};const o=n.length>0,r=(0,T.O7)(),l=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&o?1:.5}})),[a,o]),d=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.title",defaultMessage:"Reset passwords for all users"}),c=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.message",defaultMessage:"Force reset the passwords for all managed users and require them to create a new one the next time they log in."});async function u(){f.JoV(r,{email_domains:n});const{accept:e}=await y.confirmUserActionV2({message:(0,oe.jsx)(at.Z,{style:y.dialogStyles.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.message",defaultMessage:"Reset passwords for your managed users?"})}),description:(0,oe.jsx)(at.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.description",defaultMessage:"You are about to reset the passwords for of your managed users, including you. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}The affected users will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,oe.jsx)("br",{})}})}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.acceptLabel",defaultMessage:"Reset passwords for all managed users"}),cancelLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const i=s.state.emailDomains;await M.resetPasswordsForManagedUsers(r,{spaceId:t,target:{type:Uo.Domains,emailDomains:i}}),Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.all.success",defaultMessage:"Successfully reset passwords for all managed users"})}),f.aT6(r,{email_domains:i})}return i?(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(zr,{title:d,byline:c,targetTier:"enterprise"})}):(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(wr,{title:d,byline:c,settingItem:(0,oe.jsx)("div",{style:l.buttonAndErrorContainer,children:(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Top,alignment:te.Z.Alignment.End,render:e=>(0,oe.jsx)(ve.Z,{isRed:!0,disabled:a||!o,style:l.button,onClick:u,...e,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.logoutButton",defaultMessage:"Reset passwords for all users"})}),disableTooltip:o,renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function sl(e){let{spaceId:t,domainSettingsStore:s,promptUpgrade:i,verifiedDomains:n,disabled:a}=e;window.__c={n:"LogoutUsersSetting"};const o=n.length>0,r=(0,T.O7)(),l=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&o?1:.5}})),[a,o]),d=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.title",defaultMessage:"Log out all users"}),c=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.message",defaultMessage:"Force log out all managed users and require them to re-authenticate."});async function u(){f.KFD(r,{email_domains:n});const{accept:e}=await y.confirmUserActionV2({message:(0,oe.jsx)(at.Z,{style:y.dialogStyles.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.message",defaultMessage:"Log out all of your managed users?"})}),description:(0,oe.jsx)(at.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.description",defaultMessage:"You are about to log all of your managed users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.acceptLabel",defaultMessage:"Log out all managed users"}),cancelLabel:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const i=s.state.emailDomains;await M.logoutManagedUsers(r,{spaceId:t,target:{type:Uo.Domains,emailDomains:i}}),Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"managedUsers.toastMessage.logout.all.success",defaultMessage:"Successfully logged out all managed users"})}),f._6M(r,{email_domains:i})}return i?(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(zr,{title:d,byline:c,targetTier:"enterprise"})}):(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(wr,{title:d,byline:c,settingItem:(0,oe.jsx)("div",{style:l.buttonAndErrorContainer,children:(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Top,alignment:te.Z.Alignment.End,render:e=>(0,oe.jsx)(ve.Z,{isRed:!0,disabled:a||!o,style:l.button,onClick:u,...e,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.logoutButton",defaultMessage:"Log out all users"})}),disableTooltip:o,renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function il(e){let{promptUpgrade:t,hasVerifiedDomains:s,disabled:n}=e;window.__c={n:"ManageUsersButton"};const{navigateTo:a}=(0,i.useContext)(Ao),o=(0,T.O7)(),r=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.title",defaultMessage:"Managed users dashboard"}),l=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.message",defaultMessage:"Manage and view users that are using your verified domains"}),d=(0,Je.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!n&&s?1:.5}})),[s,n]);return t?(0,oe.jsx)("div",{style:d.settingContainer,children:(0,oe.jsx)(zr,{title:r,byline:l,targetTier:"enterprise"})}):(0,oe.jsx)("div",{style:d.settingContainer,children:(0,oe.jsx)(wr,{title:r,byline:l,settingItem:(0,oe.jsx)("div",{style:d.buttonAndErrorContainer,children:(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Top,alignment:te.Z.Alignment.End,render:e=>(0,oe.jsx)(St.Z,{disabled:n||!s,isLarge:!0,style:d.button,onClick:()=>{f.pCf(o),a(Zo)},...e,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"View dashboard",id:"identityAndProvisioning.managedUsers.button"})}),disableTooltip:s,renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function nl(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:i,verifiedDomains:n,disabled:o}=e;window.__c={n:"PreventGrantingSupportAccessSetting"};const r=(0,T.O7)(),l=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),d=n.length>0,c=(0,a.VK)((()=>Boolean(t.state.settings.prevent_granting_support_access)),[t]),u=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.title",defaultMessage:"Prevent managed users from granting support access"}),m=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.message",defaultMessage:"Control if managed users can enable support access on their accounts."});return i?(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(zr,{title:u,byline:m,targetTier:"enterprise"})}):(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(Cr,{title:(0,oe.jsx)("div",{style:l.settingsTitle,children:u}),byline:m,isOn:c,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_granting_support_access);t.setState({...t.state,settings:{...t.state.settings,prevent_granting_support_access:e}}),f.DnI(r,{new_value:e}),await s()},disabled:o||!d})})}function al(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:i,disabled:n}=e;window.__c={n:"PreventMembersJoiningExternalSpaces"};const o=(0,T.O7)(),r=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),l=(0,a.VK)((()=>Boolean(t.state.settings.prevent_members_joining_external_workspace)),[t]),d=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.title",defaultMessage:"External workspace access"}),c=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.message",defaultMessage:"Control if managed users are able to join workspaces that aren't owned by your organization."});if(i)return(0,oe.jsx)("div",{style:r.settingContainer,children:(0,oe.jsx)(zr,{title:d,byline:c,targetTier:"enterprise"})});const u=l?"on":"off";return(0,oe.jsx)("div",{style:r.settingContainer,children:(0,oe.jsx)(uo.Z,{isMobile:o.device.isMobile,disabled:n,title:d,caption:c,type:"dropdown",currentOption:u,options:[{key:"on",label:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.titleGeneric",defaultMessage:"Only workspace owners"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.caption",defaultMessage:"Only workspace owners of your connected workspaces can join external workspaces."})},{key:"off",label:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.titleWithSpaceName",defaultMessage:"Anyone"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.caption",defaultMessage:"All users can join any workspace."})}],onSelectOption:async function(){const e=Boolean(!t.state.settings.prevent_members_joining_external_workspace);t.setState({...t.state,settings:{...t.state.settings,prevent_members_joining_external_workspace:e}}),f.T4J(o,{new_value:e}),await s()}})})}function ol(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:i,hasVerifiedDomains:n,disabled:o}=e;window.__c={n:"PreventProfileEditsSetting"};const r=(0,T.O7)(),l=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),d=(0,a.VK)((()=>Boolean(t.state.settings.prevent_profile_edits)),[t]),c=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.title",defaultMessage:"Allow managed users to change profile information"}),u=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.message",defaultMessage:"Control if managed users can change their preferred name, email address, and profile photo."});return i?(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(zr,{title:c,byline:u,targetTier:"enterprise"})}):(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(Cr,{title:(0,oe.jsx)("div",{style:l.settingsTitle,children:c}),byline:u,isOn:!d,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_profile_edits);t.setState({...t.state,settings:{...t.state.settings,prevent_profile_edits:e}}),f.DnI(r,{new_value:e}),await s()},disabled:o||!n})})}function rl(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i}=e;window.__c={n:"ManagedUsersSection"};const{verifiedDomains:n,isDomainSettingsAvailable:o,isSamlEditable:r,saveEmailDomainSettings:l}=Wr({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),d=(0,Je.yK)((e=>({byline:{fontSize:14,fontWeight:m.Z.fontWeight.regular,color:e.mediumTextColor},helpButton:{marginTop:18,marginBottom:16}})),[]),c=o&&r,u=(0,a.VK)((()=>t.id),[t]),g=(0,a.VK)((()=>(0,Ua.wP)()),[]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:d.byline,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.byline",defaultMessage:"These settings apply to all users with a verified domain, even if they are not a member of this workspace."})})}),(0,oe.jsx)(Xr.Z,{title:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.managedUsers.helpButton",defaultMessage:"Learn about managed users"}),href:(0,Gs.UY)("guides.managedUsers"),style:d.helpButton,analyticsFrom:"managed_users_section"}),(0,oe.jsx)(il,{promptUpgrade:!g,hasVerifiedDomains:n.length>0,disabled:!c}),(0,oe.jsx)(ol,{promptUpgrade:!g,hasVerifiedDomains:n.length>0,domainSettingsStore:i,saveEmailDomainSettings:l,disabled:!c}),(0,oe.jsx)(al,{promptUpgrade:!g,domainSettingsStore:i,saveEmailDomainSettings:l,disabled:!c}),(0,oe.jsx)(nl,{promptUpgrade:!g,verifiedDomains:n,domainSettingsStore:i,saveEmailDomainSettings:l,disabled:!c}),(0,oe.jsx)(el,{promptUpgrade:!g,domainSettingsStore:i,saveEmailDomainSettings:l,disabled:!c}),(0,oe.jsx)(sl,{spaceId:u,promptUpgrade:!g,domainSettingsStore:i,verifiedDomains:n,disabled:!c}),(0,oe.jsx)(tl,{spaceId:u,promptUpgrade:!g,domainSettingsStore:i,verifiedDomains:n,disabled:!c})]})}function ll(e){let{spaceStore:t,samlConfigStore:s}=e;const n=(0,T.O7)();return{updateSamlIdpUrl:(0,i.useCallback)((async e=>{let i=!1;return await Ur({onRequest:()=>M.setSamlConfig(n,{spaceId:t.id,idpMetadataUrl:e}),onSuccess:()=>{i=!0,s.setState({...s.state,useMetadataUrl:!0,idpMetadataUrl:e,idpMetadata:void 0})}}),i}),[s,t,n]),updateSamlIdpXml:(0,i.useCallback)((async e=>{let i=!1;return await Ur({onRequest:()=>M.setSamlConfig(n,{spaceId:t.id,idpMetadata:e}),onSuccess:()=>{i=!0,s.setState({...s.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:e})}}),i}),[s,t,n]),updateStatus:(0,i.useCallback)((e=>Ur({onRequest:()=>M.setSamlConfig(n,{spaceId:t.id,status:e}),onSuccess:()=>{s.setState({...s.state,status:e})}})),[s,t,n]),updateCreateAccount:(0,i.useCallback)((e=>Ur({onRequest:()=>M.setSamlConfig(n,{spaceId:t.id,createAccount:e}),onSuccess:()=>{s.setState({...s.state,createAccount:e})}})),[s,t,n])}}function dl(e){let{spaceStore:t,samlConfigStore:s,disabled:i}=e;window.__c={n:"CreateAccountSetting"};const{updateCreateAccount:n}=ll({samlConfigStore:s,spaceStore:t}),o=(0,T.O7)(),r=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),l=(0,a.VK)((()=>s.state.createAccount),[s]);return(0,oe.jsx)("div",{style:r.settingContainer,children:(0,oe.jsx)(Cr,{title:(0,oe.jsxs)("div",{style:r.settingsTitle,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation"}),(0,oe.jsx)(an.Z,{icon:Do.m,onClick:()=>v.navigateToExternalURL({environment:o,url:(0,Gs.UY)("guides.samlJIT")})})]}),byline:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO."}),isOn:l,onToggle:async function(){await n(!s.state.createAccount)},disabled:i})})}function cl(e){let{spaceStore:t,samlConfigStore:s,promptUpgrade:i,disabled:n}=e;window.__c={n:"SamlEnforceSetting"};const o=(0,T.O7)(),{updateStatus:r}=ll({samlConfigStore:s,spaceStore:t}),l=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),d=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method"}),c=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access SAML SSO-enabled workspaces."}),u=(0,a.VK)((()=>"enforced"===s.state.status?"enforced":"not_enforced"),[s]);return i?(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(zr,{title:d,byline:c,targetTier:"business"})}):(0,oe.jsx)("div",{style:l.settingContainer,children:(0,oe.jsx)(uo.Z,{isMobile:o.device.isMobile,disabled:n,title:d,caption:c,type:"dropdown",currentOption:u,options:[{key:"enforced",label:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO"})},{key:"not_enforced",label:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method"})}],onSelectOption:async function(){"enforced"===s.state.status?await r("configured"):await r("enforced")}})})}var ul=s(54497),ml=s(5228);function pl(e){let{isOpen:t,...s}=e;window.__c={n:"SamlConfigModal"};const i=(0,a.VK)((()=>({active:s.samlConfigStore.state.useMetadataUrl?"url":"xml",url:s.samlConfigStore.state.idpMetadataUrl||"",xml:s.samlConfigStore.state.idpMetadata||""})),[s.samlConfigStore]);return(0,oe.jsx)(Mo.Z,{open:t,onDismiss:s.onClose,render:()=>(0,oe.jsx)(gl,{...s,initialConfiguration:i})})}function gl(e){let{onSaveChanges:t,initialConfiguration:s,samlConfigStore:n,spaceStore:o,onClose:r}=e;window.__c={n:"SamlConfigSettings"};const[l,d]=(0,i.useState)(s),c=(0,T.O7)(),u=(0,Je.yK)((e=>({container:{background:e.popoverBackground,width:450,padding:24,borderRadius:4,transition:"all 500ms ease"},title:{fontFamily:m.Z.getCompositeFontFamily(Rt.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:m.Z.getCompositeFontFamily(Rt.SP).sans,fontSize:14,fontWeight:500,lineHeight:"19px",margin:"20px 0 0"},copyButton:{borderRadius:4,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:m.Z.getCompositeFontFamily(Rt.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},url:{width:"100%",color:e.mediumTextColor,fontFamily:m.Z.getCompositeFontFamily(Rt.SP).sans,fontSize:14,fontWeight:400,lineHeight:"18px"},readonlyInput:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:4},divider:{margin:"20px auto 20px"},radioContainer:{display:"flex",justifyContent:"space-evenly",flexDirection:"column",height:60},radioOption:{display:"flex",alignItems:"center"},caption:{margin:"4px 0 8px"},centeredCaption:{margin:"4px 24px 8px",textAlign:"center"},buttonContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:24},buttonSpacing:{marginRight:8},feedback:{color:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400],display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px",height:20}})),[]),g=(0,i.useMemo)((()=>fl(l)),[l]),h=(0,a.VK)((()=>"unconfigured"===n.state.status),[n]),f=(0,a.VK)((()=>(0,ml.v9)(o.id,Mt.default.domainBaseUrl)),[o]),y=(0,i.useCallback)((()=>{It.RD({environment:c,stringValue:f,copiedMessage:It.tq.copiedLinkToClipboard})}),[c,f]),x=(0,i.useCallback)((()=>{d((e=>({...e,active:"url"})))}),[]),v=(0,i.useCallback)((()=>{d((e=>({...e,active:"xml"})))}),[]),S=(0,Je.yK)((e=>({input:{transition:"all 200ms ease-in-out",boxShadow:"none",margin:"12px 0",width:"100%",background:e.popoverBackground,border:`1px solid ${e.outlineButtonBorder}`}})),[]),b=(0,i.useMemo)((()=>"url"===l.active?{placeholder:"https://...",value:l.url,onChange:e=>{const t=e.target.value;d((e=>({...e,url:t})))},style:{height:32,...S.input}}:{placeholder:'<md:EntityDescriptor entityID="...',value:l.xml,onChange:e=>{const t=e.target.value;d((e=>({...e,xml:t})))},textarea:!0,style:{height:118,...S.input},inputStyle:{width:"100%",height:"100%"}}),[l,S]),M=(0,i.useCallback)((()=>{t(l)}),[t,l]);return(0,oe.jsxs)("div",{style:u.container,children:[(0,oe.jsx)(at.Z,{style:u.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.title",defaultMessage:"SAML SSO Configuration"})}),(0,oe.jsx)(at.Z,{isSmall:!0,style:u.centeredCaption,isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",values:{guidelink:e=>(0,oe.jsx)(co.Z,{href:(0,Gs.UY)("guides.samlSettings"),external:!0,children:e})}})}),(0,oe.jsx)(at.Z,{style:u.subtitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsTitle",defaultMessage:"Assertion Consumer Service (ACS) URL"})}),(0,oe.jsx)(at.Z,{isSmall:!0,style:u.caption,isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsByline",defaultMessage:"Enter this in your IDP's SAML configuration."})}),(0,oe.jsxs)("div",{style:u.readonlyInput,children:[(0,oe.jsx)(at.Z,{style:u.url,children:f}),(0,oe.jsxs)(_t.Z,{onClick:y,style:u.copyButton,children:[(0,Tt.U)(u.copyIcon),(0,oe.jsx)(p.FormattedMessage,{id:"verifyDomainModal.editSamlConfig.copy",defaultMessage:"Copy"})]})]}),(0,oe.jsx)(at.Z,{style:u.subtitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpTitle",defaultMessage:"Identity Provider Details"})}),(0,oe.jsx)(at.Z,{isSmall:!0,style:u.caption,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrlByline",defaultMessage:"Enter the value provided by your IDP."})}),(0,oe.jsxs)("div",{style:u.radioContainer,children:[(0,oe.jsxs)(ve.Z,{style:u.radioOption,onClick:x,children:[(0,oe.jsx)(zn.Z,{isSelected:"url"===l.active}),(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrl",defaultMessage:"Identity Provider URL"})})]}),(0,oe.jsxs)(ve.Z,{style:u.radioOption,onClick:v,children:[(0,oe.jsx)(zn.Z,{isSelected:"xml"===l.active}),(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpXml",defaultMessage:"Identity Provider Metadata XML"})})]})]}),(0,oe.jsx)(_e.Z,{...b}),(0,oe.jsx)("div",{style:u.feedback,children:(0,oe.jsx)(hl,{validation:g})}),(0,oe.jsxs)("div",{style:u.buttonContainer,children:[(0,oe.jsx)(St.Z,{isLarge:!0,style:u.buttonSpacing,onClick:r,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.cancel",defaultMessage:"Cancel"})}),(0,oe.jsx)(Q.Z,{isLarge:!0,disabled:"invalid"===g.type,onClick:M,children:h?(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML"}):(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes"})})]})]})}function hl(e){let t,{validation:s}=e;if("valid"===s.type)return null;switch(s.reason){case"empty":t=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.empty",defaultMessage:"You cannot leave this field blank"});break;case"signed_request":t=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.signed_request",defaultMessage:"Requests cannot be signed"})}return(0,oe.jsxs)(oe.Fragment,{children:[(0,ul.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,oe.jsx)("span",{children:t})]})}function fl(e){return"url"===e.active?(0,ml.jY)(e.url):"xml"===e.active?(0,ml.a7)(e.xml):void(0,me.t1)(e.active)}function yl(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n,isSamlStatusEnabled:a,promptUpgrade:o,disabled:r}=e;window.__c={n:"SamlToggle"};const[l,d]=(0,i.useState)({isOpened:!1,enableSamlOnSave:!1}),{updateStatus:c,updateSamlIdpUrl:u,updateSamlIdpXml:g}=ll({samlConfigStore:s,spaceStore:t}),{verifiedDomains:h}=Wr({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),f=(0,Je.yK)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:r?"default":"pointer"},settingTitle:{fontWeight:m.Z.fontWeight.medium},settingByline:{marginBottom:4},configButton:{marginTop:14}})),[r]),y=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO"}),x=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO."});return o?(0,oe.jsx)(zr,{title:y,byline:x,targetTier:"business"}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Cr,{title:y,byline:x,isOn:a,disabled:r,tooltipForDisabled:0===h.length?(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML."}):void 0,onToggle:function(){if(r)return;const{useMetadataUrl:e,idpMetadata:t,idpMetadataUrl:i}=s.state,n=e&&i||!e&&t;switch(s.state.status){case"disabled":n?c("configured"):d({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":d({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":c("disabled")}}}),(0,oe.jsx)(St.Z,{disabled:r,disabledFeedback:r,isLarge:!0,style:f.configButton,onClick:function(){r||d({isOpened:!0,enableSamlOnSave:!1})},children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration"})}),(0,oe.jsx)(pl,{isOpen:l.isOpened,onClose:()=>d({isOpened:!1,enableSamlOnSave:!1}),onSaveChanges:async function(e){if("invalid"===fl(e).type)return;let t=!1;switch(e.active){case"url":t=await u(e.url);break;case"xml":t=await g(e.xml)}t&&(l.enableSamlOnSave&&await c("configured"),d({isOpened:!1,enableSamlOnSave:!1}))},spaceStore:t,samlConfigStore:s})]})}var xl=s(39634);const vl={id:"name",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",defaultMessage:"Name"}),renderCell:e=>(0,oe.jsx)(Cl,{space:e.space,isCurrentSpace:e.isCurrentSpace}),widthData:{width:50},sortable:!0},Sl={id:"memberCount",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",defaultMessage:"Members"}),renderCell:e=>(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",defaultMessage:"{count} members",values:{count:e.space.memberCount}})}),widthData:{width:20},sortable:!0},bl={id:"createdAt",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",defaultMessage:"Created at"}),renderCell:e=>{const t=e.space.createdTime;return(0,oe.jsx)(at.Z,{children:t&&(0,Dt.Yx)(t,"medium",Rt.SP)})},widthData:{width:20},sortable:!0},Ml=[vl,Sl,bl];function jl(e){let{spaceStore:t,spaces:s}=e;window.__c={n:"WorkspacesTable"};const[n,o]=(0,i.useState)({column:vl,sortAscending:!1}),r=(0,a.VK)((()=>s.map((e=>({id:e.id,isClickable:!1,isCurrentSpace:t.id===e.id,space:e})))),[s,t]),l=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:Ml,theme:e,containerMarginTop:12})),[]);return(0,oe.jsx)(Pt.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Ml,rows:wl(r,n),sortState:n,onSortStateChanged:o,renderNoRowsComponent:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:l})}function wl(e,t){let{column:s,sortAscending:i}=t,n=[];switch(s.id){case"name":n=l.MR(e,(e=>e.space.name));break;case"createdAt":n=l.MR(e,(e=>e.space.createdTime));break;case"memberCount":n=l.MR(e,(e=>e.space.memberCount))}return i?n:n.reverse()}function Cl(e){window.__c={n:"WorkspaceNameCell"};const t=(0,Je.yK)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",gap:4}})),[]);return(0,oe.jsxs)(at.Z,{style:t.container,children:[e.space.name,e.isCurrentSpace?(0,oe.jsx)(qe.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name.currentBadge",defaultMessage:"Current"})}):null]})}function kl(e){let{spaceStore:t,spaces:s}=e;window.__c={n:"SecondaryWorkspaces"};const n=(0,T.O7)(),a=(0,Je.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),o=(0,i.useCallback)((()=>{xl.j({environment:n,from:"saml_settings",prepopulatedContent:`Request to add or remove a workspace for SAML Single Sign-on on workspace ${t.id}.`})}),[t,n]);return(0,oe.jsxs)("div",{style:a.settingContainer,children:[(0,oe.jsx)(wr,{title:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces"}),byline:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.message",defaultMessage:"This SAML SSO configuration applies to the following other workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:e=>(0,oe.jsx)(co.Z,{onClick:o,children:e})}}),settingItem:null}),(0,oe.jsx)(jl,{spaceStore:t,spaces:s})]})}function Tl(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i}=e;window.__c={n:"SamlSection"};const{verifiedDomains:n,isSamlAvailable:o,isSamlEditable:r,isSamlStatusEnabled:l}=Wr({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),d=!r||!o||!l,c=(0,a.VK)((()=>s.state.spaces),[s]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Xr.Z,{title:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO"}),href:(0,Gs.UY)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),(0,oe.jsx)(yl,{disabled:!r||0===n.length,promptUpgrade:!o,isSamlStatusEnabled:l,spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),(0,oe.jsx)(cl,{disabled:d,promptUpgrade:!o,spaceStore:t,samlConfigStore:s}),(0,oe.jsx)(dl,{disabled:d,spaceStore:t,samlConfigStore:s}),(0,oe.jsx)(kl,{spaceStore:t,spaces:c})]})}const Il=(0,p.defineMessages)({failedCreatingNewScimToken:{id:"scimTokenSettings.error.failedCreatingNewScimToken",defaultMessage:"Failed to create a new SCIM token, please try again later."}});function Pl(e){window.__c={n:"NewScimTokenButton"};const[t,s]=(0,i.useState)(!1),n=(0,T.O7)();const a=!t&&"Able"===e.tokenCreationAbility,o=t||"Able"!==e.tokenCreationAbility,r=(0,oe.jsx)(ve.Z,{isBlue:a,isLightGray:o,disabled:o,style:{position:"relative",marginLeft:"auto",marginRight:0},icon:e=>(0,Ka.R)({...e,width:14,height:14,fill:"inherit",marginRight:"6px"}),onClick:async function(){s(!0);try{const t=await async function(e){let{environment:t,spaceStore:s,userStore:i}=e;const{botStore:n,transactionPromise:a}=wa.lz({environment:t,spaceStore:s,name:"SCIM",userId:i.id,spaceRole:"editor",type:"scim"});return await a,n.id}({...e,environment:n});e.onNewScimToken(t)}catch(t){y.showErrorMessage(D.default.formatMessage(Il.failedCreatingNewScimToken))}s(!1)},children:(0,oe.jsx)(p.FormattedMessage,{id:"scimTokenSettings.NewSCIMTokenButton.title",defaultMessage:"Add token"})});let l;switch(e.tokenCreationAbility){case"Able":return r;case"Undefined":l=(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Not able to create a new SCIM token right now. Please try again later.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.undefined"});break;case"SpaceHasExistingToken":l=(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"To create a new SCIM token, please revoke the existing token.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.spaceHasLegacyToken"});break;case"UserHasExistingToken":l=(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"You already have a registered SCIM token. To create a new one, please revoke the token created by you.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.userHasExistingToken"});break;default:(0,me.t1)(e.tokenCreationAbility)}return(0,oe.jsx)(te.Z,{textWrap:!1,renderTooltip:()=>l,placement:te.Z.Placement.Right,render:e=>(0,oe.jsx)("div",{...e,style:{paddingLeft:"4px"},children:r})})}var _l=s(15070);function Zl(e){let{userId:t,currentSpaceStore:s}=e;return He.U6.createChildStore(s,{table:F.KJ,id:t})}var Fl=s(62385);const Al={container:{display:"flex",alignItems:"center",fontSize:m.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},userName:{flexShrink:1,...m.Z.textOverflowStyle}};function Rl(e,t){const s=ga.kk.fromValue(Z.cZ,e);return s.getCreatedByTable()===F.KJ&&s.getCreatedById()===t}const Dl={buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:20,width:20,marginRight:1},menuItemButton:{minWidth:200}};function Bl(e){let{onRevokeToken:t}=e;window.__c={n:"RevokeTokenButton"};const s=(0,Je.Fg)();return(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(te.Z,{textWrap:!1,renderTooltip:()=>(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Revoke this token.",id:"revokeTokenButton.tooltip"})}),placement:te.Z.Placement.Right,render:e=>(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,placementToOrigin:nn.pO.Right,renderOrigin:t=>(0,oe.jsx)(_t.Z,{className:zs.TAd,style:Dl.buttonStyle,mobileFeedback:!1,...e,...t,children:(0,Vo.y)({fill:s.mediumIconColor,width:12,height:12})}),onClick:()=>{y.confirmUserAction({message:(0,oe.jsx)(p.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.message",defaultMessage:"Are you sure you want to revoke this token?"}),description:(0,oe.jsx)(p.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.description",defaultMessage:"Existing SCIM configurations that use this token will no longer work once the token is revoked, and you'll have to provide them with a new token."}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.acceptButton.label",defaultMessage:"Revoke token"}),cancelLabel:(0,oe.jsx)(p.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.cancelButton.label",defaultMessage:"Cancel"})}).then((e=>e&&t()))},render:e=>(e.close(),(0,oe.jsx)(oe.Fragment,{}))})})})}const Ll=()=>{window.__c={n:"OutdatedWarningIcon"};const e=(0,Je.Fg)();return(0,oe.jsx)(te.Z,{textWrap:!1,renderTooltip:()=>(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Outdated token. Revoke this token and generate a new one to view its contents.",id:"manageScimTokenTable.OutdatedWarningIcon.tooltip"})}),placement:te.Z.Placement.Right,render:t=>(0,oe.jsx)("div",{...t,style:{paddingLeft:"4px"},children:(0,ul.t)({fill:(0,et.fi)("orange",e).fill,width:12,height:12})})})};function Nl(e){let{clipboardTextFn:t}=e;window.__c={n:"RenderCopyToClipboardButton"};const s=(0,T.O7)();const i=(0,Je.Fg)(),n={height:25,background:i.whiteButtonBackground,color:i.regularTextColor,fontWeight:m.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return(0,oe.jsxs)(Fl.Z,{onClick:async function(){const e=await t();void 0!==e&&It.RD({environment:s,stringValue:e,copiedMessage:It.tq.copiedTokenToClipboard,showCopyModal:!!s.device.isSafari||void 0})},style:n,children:[(0,Tt.U)({height:16,width:16,paddingRight:4}),(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]})}const Ol="•••••••••••";function El(){return(0,oe.jsx)(te.Z,{textWrap:!1,renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"This token can only be viewed by its creator.",id:"manageScimTokenTable.renderTokenThatCannotBeViewed.tooltip"}),placement:te.Z.Placement.Right,render:e=>(0,oe.jsx)("div",{...e,children:Ol})})}function Vl(e){let{row:t}=e;window.__c={n:"BotTokenCell"};const s=(0,T.O7)();return t.legacy?(0,oe.jsxs)(oe.Fragment,{children:[Ol,(0,oe.jsx)(Ll,{})]}):t.ownedByCurrentUser?(0,oe.jsxs)(oe.Fragment,{children:[Ol,(0,oe.jsx)(Nl,{clipboardTextFn:()=>wa.VG({environment:s,botId:t.id})})]}):(0,oe.jsx)(El,{})}const Ul={id:"token",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"manageScimTokenTable.columnTitle.token",defaultMessage:"Token"}),renderCell:e=>(0,oe.jsx)(Vl,{row:e}),widthData:{width:40},sortable:!1,hasClickableContents:!0},Wl=()=>{const e=Al;return(0,oe.jsx)(te.Z,{textWrap:!1,renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"This token was created by a user who is no longer an admin in the workspace.",id:"scimTableLegacyUserCell.tooltip"}),placement:te.Z.Placement.Right,render:t=>(0,oe.jsx)("div",{...t,children:(0,oe.jsxs)("div",{style:e.container,children:[(0,oe.jsx)(wn.Z,{style:e.userAvatar,avatarShouldShowShadow:!0,size:20}),(0,oe.jsx)("div",{style:e.userName,children:(0,oe.jsx)("i",{children:"Deactivated user"})})]})})})},Kl={id:"addedBy",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"manageScimTokenTable.columnTitle.addedBy",defaultMessage:"Added by"}),renderCell:e=>{if(e.legacy)return(0,oe.jsx)(Wl,{});{const t=e.ownedByCurrentUser?(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:{marginLeft:4,textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{id:"manageSCIMTokenTable.colums.addedBy.selfIndicator",defaultMessage:"(you)"})}):(0,oe.jsx)(oe.Fragment,{});return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Pn.G,{isClickable:!1,userStores:[e.ownerUserStore]}),t]})}},widthData:{width:40},sortable:!1,hasClickableContents:!1},zl={id:"created",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"manageScimTokenTable.columnTitle.created",defaultMessage:"Created"}),renderCell:e=>(0,oe.jsx)(Ii.T,{includeTime:!0,dateTs:e.createdAt}),widthData:{width:40},sortable:!0,hasClickableContents:!1},ql=[Ul,Kl,zl,{id:"revokeToken",headerTitle:void 0,renderCell:e=>(0,oe.jsx)(Bl,{onRevokeToken:()=>{e.onRevokeToken()}}),widthData:{width:10},sortable:!1,hasClickableContents:!0}];function Gl(e,t){let{column:s,sortAscending:i}=t;const n=null==s?void 0:s.id;let a=e=>e.id;switch(n){case"name":a=e=>e.name;break;case"created":a=e=>e.createdAt;break;case"token":case"addedBy":case"revokeToken":case void 0:break;default:(0,me.t1)(n)}const o=l.MR(e,a);return i||o.reverse(),o}function Hl(e){let{botStores:t,onRevokeToken:s}=e;window.__c={n:"ManageScimTokenTable"};const n=(0,a.VK)((()=>ie.default.state.currentUserStore),[]),o=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),r=(0,p.useIntl)(),d=(0,a.VK)((()=>{if(!o)return[];const e=null==n?void 0:n.id;return l.oA(t.map((t=>{const i=t.getModel();if(!i||!(0,_l.xe)(i))return;const n={id:i.id,isClickable:!1,createdAt:i.getCreatedAt(),userLocale:r.locale,name:i.getName(),onRevokeToken:()=>{s(i.id)}},a=function(e){const t=ga.kk.fromValue(Z.cZ,e);return"notion_user"===t.getCreatedByTable()&&t.getCreatedById()===F.s$.id}(i);return a?{...n,legacy:a}:{...n,legacy:a,ownedByCurrentUser:Rl(i,e),ownerUserStore:"notion_user"===i.getCreatedByTable()?Zl({userId:i.getCreatedById(),currentSpaceStore:o}):void 0}})))}),[t,o,n,r.locale,s]),[c,u]=(0,i.useState)({column:zl,sortAscending:!1}),m=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:ql,theme:e,containerMarginTop:0})),[]);return(0,oe.jsx)(Pt.D,{columnRenderInfo:ql,rows:Gl(d,c),sortState:c,onSortStateChanged:u,onRowClick:()=>(0,oe.jsx)(oe.Fragment,{}),renderNoRowsComponent:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{id:"manageSCIMTokenTable.noTokensFound.message",defaultMessage:"No active SCIM tokens."})}),styles:m})}async function Ql(e){let{environment:t,spaceId:s}=e;return(await wa.Yw({environment:t,table:Wt.bx,id:s,type:"scim"})).botIds}const Yl=function(e){let{botIds:t,setBotIds:s,spaceStore:n}=e;window.__c={n:"ScimTokenSettings"};const a=(0,T.O7)(),o=n.id;if((0,i.useEffect)((()=>{void 0===t&&Ql({environment:a,spaceId:o}).then(s)}),[t,a,s,o]),t){const e=t.map((e=>He.t1.createChildStore(n,{table:Z.cZ,id:e,spaceId:o})));return(0,oe.jsx)(Hl,{botStores:e,onRevokeToken:e=>{wa.P0({environment:a,botId:e,onSuccess:()=>{Ql({environment:a,spaceId:o}).then(s)}})}})}return(0,oe.jsx)(Ti.Z,{})};function $l(e){let{userStore:t,spaceStore:s,promptUpgrade:n}=e;window.__c={n:"ScimTokens"};const[o,r]=(0,i.useState)(void 0),l=(0,T.O7)(),d=(0,a.VK)((()=>function(e){let{botIds:t,spaceStore:s,environment:i}=e;if(void 0===t)return"Undefined";const n=t.map((e=>He.t1.createChildStore(s,{table:Z.cZ,id:e,spaceId:s.id}))).filter((e=>e.isDefined()));if(n.some((e=>e.getCreatedByTable()===F.KJ&&e.getCreatedById()===F.s$.id)))return"SpaceHasExistingToken";if(n.some((e=>e.getCreatedByTable()===F.KJ&&e.getCreatedById()===i.currentUser.id)))return"UserHasExistingToken";return"Able"}({botIds:o,spaceStore:s,environment:l})),[o,l,s]),c=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens"}),u=(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM."});return n?(0,oe.jsx)(zr,{title:c,byline:u,targetTier:"enterprise"}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(wr,{title:c,byline:u,settingItem:(0,oe.jsx)(Pl,{onNewScimToken:e=>r((t=>[...t??[],e])),spaceStore:s,userStore:t,tokenCreationAbility:d})}),(0,oe.jsx)(Xr.Z,{title:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,Gs.UY)("guides.scim"),analyticsFrom:"scim_settings"}),(0,oe.jsx)(Yl,{spaceStore:s,userStore:t,botIds:o,setBotIds:r})]})}function Jl(e){let{userStore:t,spaceStore:s}=e;window.__c={n:"ScimSection"};const i=(0,a.VK)((()=>(0,Ua.wP)()),[]);return(0,oe.jsx)($l,{promptUpgrade:!i,userStore:t,spaceStore:s})}function Xl(e){let{primarySpaceName:t}=e;window.__c={n:"SecondaryWorkspaceNotice"};const s=(0,Je.yK)((e=>({container:{background:e.accentColors.blue[100],padding:"18px 24px",borderRadius:4,margin:"0 0 24px"}})),[]);return(0,oe.jsxs)("div",{style:s.container,children:[(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableTitle",defaultMessage:"The primary workspace is <bold>{primaryWorkspaceName}</bold>.",values:{primaryWorkspaceName:t,bold:e=>(0,oe.jsx)("span",{style:{fontWeight:m.Z.fontWeight.semibold},children:e})}})}),(0,oe.jsx)("br",{}),(0,oe.jsx)(at.Z,{isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableMessage",defaultMessage:"The domain management settings and SAML SSO configuration are being managed by the workspace <bold>{primaryWorkspaceName}</bold>. Please navigate there or contact an admin of that workspace to edit the verified domains or SSO configuration.",values:{primaryWorkspaceName:t,bold:e=>(0,oe.jsx)("span",{style:{fontWeight:m.Z.fontWeight.semibold},children:e})}})})]})}var ed=s(89101),td=s(23124);function sd(e){let{spaceStore:t,isEnterprise:s}=e;window.__c={n:"SetupInformation"};const i=(0,p.useIntl)(),n=(0,a.VK)((()=>t.id),[t]);return(0,oe.jsxs)(td.rj,{gap:8,children:[(0,oe.jsx)(td.r8,{row:1,col:1,children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.workspaceId",defaultMessage:"Workspace ID"})})}),(0,oe.jsx)(td.r8,{row:1,col:2,children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,children:(0,oe.jsx)(id,{text:n,tooltip:i.formatMessage({id:"securitySAMLSettings.SetupInformationSection.workspaceId.copyTooltip",defaultMessage:"Click to copy ID"})})})}),s?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(td.r8,{row:2,col:1,children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityIDLink",defaultMessage:"SAML SSO/SAML Entity ID"})})}),(0,oe.jsx)(td.r8,{row:2,col:2,children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,children:(0,oe.jsx)(id,{text:(0,ml.AE)(Mt.default.domainBaseUrl),tooltip:i.formatMessage({id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityID.copyTooltip",defaultMessage:"Click to copy link"})})})}),(0,oe.jsx)(td.r8,{row:3,col:1,children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl",defaultMessage:"SCIM base URL"})})}),(0,oe.jsx)(td.r8,{row:3,col:2,children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,children:(0,oe.jsx)(id,{text:Mt.default.domainBaseUrl+ed._j.scimApiBasePath,tooltip:i.formatMessage({id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl.copyTooltip",defaultMessage:"Click to copy link"})})})})]}):null]})}function id(e){let{tooltip:t,text:s}=e;window.__c={n:"CopyableText"};const i=(0,T.O7)();return(0,oe.jsx)(te.Z,{delayThreshold:0,renderTooltip:()=>t,render:e=>(0,oe.jsx)(co.Z,{onClick:()=>{It.RD({environment:i,stringValue:s,copiedMessage:It.tq.copiedPropertyToClipboard})},...e,children:s})})}function nd(e){let{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:o}=e;window.__c={n:"SettingsPage"};const r=(0,T.O7)(),l=(0,a.VK)((()=>ji.Z.state.online),[]),{loadingSaml:d,loadedSaml:c,errorSaml:u}=(0,i.useContext)(Ao),m=(0,a.VK)((()=>function(e){let{environment:t,samlConfigStore:s,spaceStore:i}=e;const n=Er({environment:t,samlConfigStore:s}),a=!s.state.id||s.state.id===i.id;return n&&a}({environment:r,samlConfigStore:n,spaceStore:s})),[r,n,s]),g=(0,a.VK)((()=>n.state.id?Vr.Z.getPublicSpaceData(r,n.state.id):void 0),[r,n]),h=(0,Je.yK)((()=>({header:{marginTop:48}})),[]),f=(0,a.VK)((()=>(0,Ua.wP)()),[]);return l?d?(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(Ti.Z,{style:{margin:"0 auto"}})}):u?(y.deprecatedShowErrorMessage(u.message),null):c?(0,oe.jsxs)(wi.Z,{children:[!m&&g?(0,oe.jsx)(Xl,{primarySpaceName:g.name}):null,(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management"})}),(0,oe.jsx)(Jr,{spaceStore:s,samlConfigStore:n,domainSettingsStore:o,isCurrentSpaceEnterprise:f}),(0,oe.jsx)(bt.Z,{large:!0,divider:"full",style:h.header,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.userManagement.title",defaultMessage:"User management"})}),(0,oe.jsx)(rl,{spaceStore:s,samlConfigStore:n,domainSettingsStore:o}),(0,oe.jsx)(bt.Z,{large:!0,divider:"full",style:h.header,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML Single sign-on (SSO)"})}),(0,oe.jsx)(Tl,{spaceStore:s,samlConfigStore:n,domainSettingsStore:o}),(0,oe.jsx)(bt.Z,{large:!0,divider:"full",style:h.header,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning"})}),(0,oe.jsx)(Jl,{userStore:t,spaceStore:s}),(0,oe.jsx)(bt.Z,{large:!0,divider:"full",style:h.header,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.setupInfo.title",defaultMessage:"Setup information"})}),(0,oe.jsx)(sd,{spaceStore:s,isEnterprise:f})]}):null:(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message"})})})}function ad(e,t){return(void 0===e||!(0,Fa.XR)(e))&&(!(void 0===e||!(0,Fa.TZ)(e)||0!==t)||1===t)}var od=s(92595),rd=s(92165),ld=s(94400),dd=s(63143),cd=s(27242),ud=s(73420);function md(){return(0,oe.jsx)(te.Z,{renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceClaim.Explanation",defaultMessage:"Workspace claim request is being processed."}),render:e=>(0,oe.jsx)(at.Z,{...e,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingClaim",defaultMessage:"Pending"})})})}function pd(e){let{admin:t}=e;window.__c={n:"PendingSpaceTransferMessage"};const s=(0,p.useIntl)();return(0,oe.jsx)(te.Z,{renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceTransferExplanation",defaultMessage:"Waiting for {name} to transfer the workspace to an external account.",values:{name:(0,jn.Nz)(s,t)}}),render:e=>(0,oe.jsx)(at.Z,{...e,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingTransfer",defaultMessage:"Pending"})})})}let gd=function(e){return e.Single="single",e.Multi="multi",e}({});function hd(e){window.__c={n:"SpaceActionsMenu"};const{space:t,mode:s}=e,i=(0,a.qz)(void 0,en.Z),n=(0,Je.yK)((()=>({container:{minWidth:325}})),[]);return s===gd.Single?(0,oe.jsx)(yd,{action:e.action,space:t}):(0,oe.jsx)(nn.ZP,{popupType:X.kQ.Popup,style:n.container,buttonPopupStore:i,renderOrigin:e=>(0,oe.jsx)(an.Z,{icon:Hi.o,...e}),render:()=>(0,oe.jsx)(fd,{space:t,actions:e.actions,popupStore:i})})}function fd(e){let{space:t,actions:s,popupStore:i}=e;const n={key:"workspace-actions",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:s.map((e=>{const s=!!e.getDisabledState&&e.getDisabledState(t),i=e.getTooltip?e.getTooltip(t):null;return{key:e.id,render:t=>(0,oe.jsx)(te.Z,{render:i=>(0,oe.jsx)(tr.Z,{...t,...i,shouldWrapCaption:!0,svg:t=>e.getIcon(t),title:e.name,caption:e.caption,style:{paddingTop:8,paddingBottom:8,opacity:s?.5:1},disabled:s}),renderTooltip:()=>i,disableTooltip:!Boolean(i),placement:te.Z.Placement.Left}),action:()=>e.onAction(t)}}))};return(0,oe.jsx)($.Z,{menuType:se.og.Popup,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:void 0,sections:[n],onAccept:()=>{i.setState({open:!1})}})})}function yd(e){window.__c={n:"SingleSpaceActionButton"};const{action:t,space:s}=e,n=(0,Je.yK)((e=>({button:{paddingLeft:5,paddingRight:5}})),[]),a=i.useCallback((()=>{t.onAction(s)}),[t,s]);return(0,oe.jsx)(ve.Z,{isSmall:!0,style:n.button,onClick:a,children:t.name})}var xd=s(33941);function vd(e){let{id:t,name:s,icon:i,subscriptionTier:n,memberCount:a,highlightIconContainer:o}=e;window.__c={n:"SpaceSummary"};const r=(0,p.useIntl)(),l=i?{pointer:{table:Wt.bx,id:t,spaceId:t},icon:i}:void 0,d=(0,Je.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%"},summaryContainer:{width:"calc(100% - 38px)"},iconContainer:{height:38,width:38,flexGrow:0,flexShrink:0,flexBasis:38,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",background:o?e.selectLightGray[50]:void 0,borderRadius:6},name:{fontSize:14,fontWeight:500},byline:{fontSize:12,opacity:.5}})),[o]);return(0,oe.jsxs)("div",{style:d.container,children:[(0,oe.jsx)("div",{style:d.iconContainer,children:(0,oe.jsx)(pn.Z,{disabled:!0,icon:l,isEmptyPage:!1,size:32,title:s,isLarge:!0,emojiSize:28,isRaw:!1})}),(0,oe.jsxs)("div",{style:d.summaryContainer,children:[(0,oe.jsx)(at.Z,{style:d.name,showTooltipWhenTruncated:!0,children:s}),(0,oe.jsx)(at.Z,{style:d.byline,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.summaryByline",defaultMessage:"{subscriptionTier} · {memberCount, plural, one {{memberCount} member} other {{memberCount} members}}",values:{subscriptionTier:Sd(n,r),memberCount:a}})})]})]})}function Sd(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(xd.a.free);case"personal":return t.formatMessage(xd.a.personal);case"plus":return t.formatMessage(xd.a.plusPlan);case"business":return t.formatMessage(xd.a.business);default:(0,me.t1)(e)}}var bd=s(3556);function Md(e){let{users:t,deletedUserEmailDomain:s}=e;window.__c={n:"SpaceUsers"};const i=(0,a.qz)(void 0,en.Z),n=(0,Je.yK)((()=>({container:{minWidth:275}})),[]);return(0,oe.jsx)(nn.ZP,{popupType:X.kQ.Popup,style:n.container,buttonPopupStore:i,renderOrigin:e=>(0,oe.jsx)(Cd,{users:t,deletedUserEmailDomain:s,...e}),render:()=>(0,oe.jsx)(jd,{users:t,popupStore:i})})}function jd(e){let{users:t,popupStore:s}=e;window.__c={n:"WorkspaceUsersMenu"};const i=(0,T.O7)(),n={key:"workspace-users-menu",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:t.map((e=>({key:e.id,render:t=>(0,oe.jsx)(wd,{user:e,...t}),action:()=>v.navigateToExternalURL({environment:i,url:`mailto:${e.email}`})})))};return(0,oe.jsx)($.Z,{menuType:se.og.Popup,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:0,sections:[n],onAccept:()=>{s.setState({open:!1})}})})}function wd(e){let{user:t,...s}=e;window.__c={n:"EmailableUserSummary"};const i=(0,p.useIntl)(),n=(0,Je.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8,margin:"0 6px"},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return(0,oe.jsxs)(ve.Z,{style:n.container,...s,children:[(0,oe.jsx)("div",{style:n.avatarContainer,children:(0,oe.jsx)(wn.Z,{userValue:t,size:24})}),(0,oe.jsxs)("div",{style:n.nameContainer,children:[(0,oe.jsx)(at.Z,{style:n.name,children:(0,jn.Nz)(i,t)}),(0,oe.jsx)(at.Z,{style:n.email,children:t.email})]}),(0,oe.jsx)("div",{style:n.copyContainer,children:(0,bd.Z)({height:18,width:18})})]})}function Cd(e){let{users:t,deletedUserEmailDomain:s,...i}=e;window.__c={n:"MultiUsersDisplay"};const n=(0,p.useIntl)(),a=(0,Je.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginLeft:"-8px",maxWidth:"100%"},empty:{fontSize:14,maxWidth:150,opacity:.5},name:{fontSize:14,maxWidth:150},plusMore:{opacity:.5,display:"inline"}})),[]);return 0===t.length?(0,oe.jsx)(te.Z,{render:e=>(0,oe.jsx)(ve.Z,{style:a.container,disabled:!0,...i,...e,children:(0,oe.jsx)(at.Z,{style:a.empty,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.empty",defaultMessage:"Deleted user"})})}),disableTooltip:!s,renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.emptyTooltip",defaultMessage:"Deleted user from {domain}",values:{domain:`@${s}`}})}):(0,oe.jsx)(ve.Z,{style:a.container,...i,children:(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.name",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} <gray>+{remainingCount}</gray>} other {{firstUser} <gray>+{remainingCount}</gray>}}",values:{firstUser:(0,jn.Nz)(n,t[0]),remainingCount:t.length-1,gray:e=>(0,oe.jsx)(at.Z,{style:a.plusMore,children:e})}})})})}const kd=[{id:"spaces",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.name",defaultMessage:"Workspaces"}),renderCell:e=>(0,oe.jsx)(vd,{id:e.space.id,name:e.space.name,icon:e.space.icon,subscriptionTier:e.space.subscriptionTier,memberCount:e.space.memberCount}),widthData:{width:60},sortable:!1},{id:"admins",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.admins",defaultMessage:"Workspace owners"}),renderCell:e=>(0,oe.jsx)(Md,{users:e.space.admins}),widthData:{width:40},sortable:!1},{id:"createdBy",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdBy",defaultMessage:"Created by"}),renderCell:e=>e.space.creator?(0,oe.jsx)(Md,{users:[e.space.creator]}):(0,oe.jsx)(Md,{users:[],deletedUserEmailDomain:e.space.creatorEmailDomain}),widthData:{width:40},sortable:!1},{id:"createdAt",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdAt",defaultMessage:"Created date"}),renderCell:e=>(0,oe.jsx)(at.Z,{style:{opacity:.5},children:(0,vr.gs)(e.space.createdAt)}),widthData:{width:30},sortable:!1},{id:"action",headerTitle:null,renderCell:e=>{if((0,Fa.DI)(e.space.spaceRequest))return(0,oe.jsx)(pd,{admin:e.space.admins[0]});if((0,Fa.XR)(e.space.spaceRequest))return(0,oe.jsx)(md,{});if((0,Fa.TZ)(e.space.spaceRequest)){const t=e.actions.find((e=>"recover-space"===e.id));return t&&(0,oe.jsx)(hd,{space:e.space,action:t,mode:gd.Single})}return e.actions.length>0?(0,oe.jsx)(hd,{space:e.space,actions:e.actions.filter((e=>"recover-space"!==e.id)),mode:gd.Multi}):null},widthData:{width:15},sortable:!1}];function Td(e){let{claimableSpaces:t,spaceActions:s,loadMoreClaimableSpaces:i,loading:n}=e;window.__c={n:"ClaimableSpacesTable"};const a=t.map((e=>({id:e.id,isClickable:!1,space:e,actions:s}))),o=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:kd,theme:e,containerMarginTop:0})),[]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Pt.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:kd,rows:a,renderNoRowsComponent:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:!n&&(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.empty",defaultMessage:"No claimable workspaces."})}),styles:o,getStyleForRow:function(e){if((0,Fa.DI)(e.space.spaceRequest)||(0,Fa.XR)(e.space.spaceRequest)||(0,Fa.TZ)(e.space.spaceRequest))return{opacity:.5}},onScrollBottom:i}),n&&(0,oe.jsx)(Ti.Z,{style:{margin:"24px auto 24px"}})]})}var Id=s(33728),Pd=s(64275),_d=s(36329),Zd=s(98519),Fd=s(16354);const Ad=(0,p.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.placeholder",defaultMessage:"it@example.com"}}),Rd=e=>{let{onDismiss:t,spaceQueuedForTransfer:s,currentSpaceId:n}=e;window.__c={n:"PersonalTransferSpaceConfirmationModal"};const[a,o]=(0,i.useState)(),[r,l]=(0,i.useState)(!1),{setSpaceRequest:d}=(0,i.useContext)(Ao),c=(0,T.O7)(),u=(0,Je.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:m.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:m.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},dividerContainer:{marginTop:20},dividerInner:{borderBottomColor:e.regularDividerColor},contactEmailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},contactEmailTitle:{fontWeight:m.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},primaryButton:{width:"100%",marginTop:32},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:m.Z.fontWeight.medium,color:e.lightTextColor},buttonCaptionError:{color:e.errorText,marginTop:8,fontSize:13}})),[]),g=Boolean(s);return(0,oe.jsx)(Mo.Z,{open:g,innerStyle:u.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:u.closeIconContainer,children:(0,oe.jsx)(ve.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Pd.D)(u.closeIcon)})}),(0,oe.jsx)("div",{children:(0,_d._)(u.modalIcon)}),(0,oe.jsxs)(at.Z,{style:u.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.selfServe.title",defaultMessage:"Require account change"}),(0,oe.jsx)(Fd.Z,{href:(0,Gs.UY)("guides.domainManagement"),children:(0,oe.jsx)(an.Z,{icon:Do.m})})]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:u.description,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.byline",defaultMessage:"You’re about to require the Workspace Owner of 1 workspace to use an external Notion accounts. They will be unable to use the workspace until the change is made."})}),(0,oe.jsxs)("div",{style:u.workspaceContainer,children:[s?(0,oe.jsx)(vd,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,oe.jsx)("div",{style:u.checkContainer,children:(0,Zd.k)(u.check)})]}),(0,oe.jsx)(ro.Z,{size:"100%",innerStyle:u.dividerInner,style:u.dividerContainer}),(0,oe.jsxs)("div",{style:u.contactEmailContainer,children:[(0,oe.jsxs)(at.Z,{style:u.contactEmailTitle,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.title",defaultMessage:"Send request from"}),(0,oe.jsx)(te.Z,{renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingExplanation",defaultMessage:"The Workspace Owner can contact this email for inquiries"}),render:e=>(0,oe.jsx)("span",{...e,children:(0,Do.m)(u.helpIcon)})})]}),(0,oe.jsx)(_e.Z,{value:a,placeholder:D.default.formatMessage(Ad.emailPlaceholder),onChange:e=>{l(!1),o(e.target.value)}}),r&&(0,oe.jsx)(at.Z,{isSmall:!0,style:u.buttonCaptionError,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.error",defaultMessage:"Invalid email address"})})]}),(0,oe.jsx)(Q.Z,{isLarge:!0,style:u.primaryButton,onClick:async()=>{const e=(0,Id.H3)(a);var i;if((0,Id.oH)(e)){if(s&&e){const a=await M.initiateWorkspaceTransfer(c,{requestingSpaceId:n,targetSpaceId:s.id,contactEmail:e});if("failed"===a.type)y.showErrorMessage((0,R.wf)(D.default.getIntl(),a));else{const n=a.data.workspaceTransfer;d(s.id,n),f.azK(c,{contactEmail:e,currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,subscriptionTier:s.subscriptionTier}),t(),i=s.name,Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.toast",defaultMessage:"Account change successfully requested for “{spaceName}“",values:{spaceName:i}})})}}}else l(!0)},children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.confirm",defaultMessage:"Confirm change"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:u.buttonCaption,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.buttonCaption",defaultMessage:"This cannot be undone"})}),(0,oe.jsx)(ve.Z,{style:u.secondaryButton,onClick:t,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.cancel",defaultMessage:"Cancel"})})]})})};const Dd=e=>{let{onDismiss:t,spaceQueuedForClaiming:s,requestingSpaceId:n}=e;window.__c={n:"SalesAssistedClaimSpaceConfirmationModal"};const a=(0,T.O7)(),{setSpaceRequest:o}=(0,i.useContext)(Ao),r=(0,Je.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},title:{fontWeight:m.Z.fontWeight.medium,fontSize:16,marginBottom:8,display:"inline-flex",alignItems:"center",justifyContent:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:m.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:m.Z.fontWeight.medium,color:e.lightTextColor},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12}})),[]),l=Boolean(s),d=async()=>{if(!s)return;const e=await M.requestClaimAndUpgrade(a,{requestingSpaceId:n,targetSpaceId:s.id});var i;"failed"===e.type?y.showError(e):(f.eO1(a,{currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,memberCount:s.memberCount}),o(s.id,e.data.spaceRequest),i=s.name,Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.toast",defaultMessage:"Workspace claim successfully requested for “{spaceName}“",values:{spaceName:i}})})),t()};return(0,oe.jsx)(Mo.Z,{open:l,innerStyle:r.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:r.closeIconContainer,children:(0,oe.jsx)(ve.Z,{isSmall:!0,onClick:t,children:(0,Pd.D)(r.closeIcon)})}),(0,oe.jsxs)(at.Z,{style:r.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.title",defaultMessage:"Request workspace claim"}),(0,oe.jsx)(Fd.Z,{href:(0,Gs.UY)("guides.domainManagement"),children:(0,oe.jsx)(an.Z,{icon:Do.m})})]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:r.description,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:s?s.name:"the workspace below"}})}),(0,oe.jsxs)("div",{style:r.workspaceContainer,children:[s?(0,oe.jsx)(vd,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,oe.jsx)("div",{style:r.checkContainer,children:(0,Zd.k)(r.check)})]}),(0,oe.jsx)(Q.Z,{isLarge:!0,style:r.primaryButton,onClick:d,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.sendRequest",defaultMessage:"Send request"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:r.buttonCaption,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.buttonCaption",defaultMessage:"This request may take a few days to process. For more information, contact your <accountmanageremail>Account Management team</accountmanageremail>.",values:{accountmanageremail:e=>(0,oe.jsx)(co.Z,{href:"mailto:am@makenotion.com",children:e})}})}),(0,oe.jsx)(ve.Z,{style:r.secondaryButton,onClick:t,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.cancel",defaultMessage:"Cancel"})})]})})};const Bd=e=>{let{onDismiss:t,spaceQueuedForClaiming:s}=e;window.__c={n:"SelfServeClaimSpaceConfirmationModal"};const i=(0,Je.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:m.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:m.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:m.Z.fontWeight.medium,color:e.lightTextColor}})),[]),n=Boolean(s);return(0,oe.jsx)(Mo.Z,{open:n,innerStyle:i.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:i.closeIconContainer,children:(0,oe.jsx)(ve.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Pd.D)(i.closeIcon)})}),(0,oe.jsx)("div",{children:(0,ld.l)(i.modalIcon)}),(0,oe.jsxs)(at.Z,{style:i.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.title",defaultMessage:"Claim workspace"}),(0,oe.jsx)(Fd.Z,{href:(0,Gs.UY)("guides.domainManagement"),children:(0,oe.jsx)(an.Z,{icon:Do.m})})]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:i.description,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:s?s.name:"the workspace below"}})}),(0,oe.jsxs)("div",{style:i.workspaceContainer,children:[s?(0,oe.jsx)(vd,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,oe.jsx)("div",{style:i.checkContainer,children:(0,Zd.k)(i.check)})]}),(0,oe.jsx)(Q.Z,{isLarge:!0,style:i.primaryButton,onClick:()=>{s&&gi.Xb(s)},children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.reviewAndPay",defaultMessage:"Review and pay"})}),(0,oe.jsx)(ve.Z,{style:i.secondaryButton,onClick:t,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.cancel",defaultMessage:"Cancel"})})]})})};var Ld=s(84939);const Nd=(0,p.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.placeholder",defaultMessage:"it@example.com"}}),Od=e=>{let{onDismiss:t,spaceQueuedForDeletion:s,currentSpaceId:n}=e;window.__c={n:"SpaceDeletionConfirmationModal"};const[a,o]=(0,i.useState)({email:void 0,didError:!1}),[r,l]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!1),{setSpaceRequest:u}=(0,i.useContext)(Ao),g=(0,Je.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],height:24,width:24},title:{fontWeight:m.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:m.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},checkboxContainer:{display:"inline-flex",marginTop:8,alignItems:"center"},checkbox:{color:"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[200],marginRight:8},primaryButton:{width:"100%",marginTop:32,background:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],justifyContent:"center",fontWeight:m.Z.fontWeight.medium,color:et.ZP.white},primaryButtonHovered:{background:"dark"===e.mode?(0,Ld._j)(e.accentColors.red[700],.3):(0,Ld._j)(e.accentColors.red[500],.3)},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:m.Z.fontWeight.medium,color:e.lightTextColor},checkboxCaption:{color:e.mediumTextColor,textAlign:"center",fontSize:12},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),h=(0,T.O7)(),x=(0,i.useCallback)((()=>{o({email:void 0,didError:!1}),l(!1),c(!1),t()}),[t]),v=(0,i.useCallback)((e=>{o({didError:!1,email:e.target.value})}),[]),S=(0,i.useCallback)((()=>l((e=>!e))),[]),b=(0,i.useCallback)((async()=>{const e=(0,Id.H3)(a.email);if(!(0,Id.oH)(e))return void o({...a,didError:!0});if(!s)return;c(!0);const t=await M.deleteSpaceForDomain(h,{requestingSpaceId:n,targetSpaceId:s.id,contactEmail:e});if("failed"===t.type)c(!1),y.showErrorMessage((0,R.wf)(D.default.getIntl(),t));else{const n=t.data.spaceDeletion;u(s.id,n),f.QFO(h,{contactEmail:e,currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,targetSubscriptionTier:s.subscriptionTier}),x(),i=s.name,Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.toast",defaultMessage:"Successfully deleted “{spaceName}“",values:{spaceName:i}})})}var i}),[x,a,n,h,u,s]),j=Boolean(s);return(0,oe.jsx)(Mo.Z,{open:j,innerStyle:g.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:x,render:()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:g.closeIconContainer,children:(0,oe.jsx)(ve.Z,{isSmall:!0,onClick:x,ignoreLocalHoverState:!0,children:(0,Pd.D)(g.closeIcon)})}),(0,oe.jsx)("div",{children:(0,Vo.y)(g.modalIcon)}),(0,oe.jsxs)(at.Z,{style:g.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.title",defaultMessage:"Delete workspace"}),(0,oe.jsx)(Fd.Z,{href:(0,Gs.UY)("guides.domainManagement"),children:(0,oe.jsx)(an.Z,{icon:Do.m})})]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:g.description,children:s?(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.byline",defaultMessage:"You’re about to permanently delete {currentWorkspaceName} and all of its contents. The workspace owner will be notified.",values:{currentWorkspaceName:s.name}}):void 0}),(0,oe.jsxs)("div",{style:g.workspaceContainer,children:[s?(0,oe.jsx)(vd,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):void 0,(0,oe.jsx)("div",{style:g.checkContainer,children:(0,Zd.k)(g.check)})]}),(0,oe.jsx)(ro.Z,{size:0,style:g.dividerContainer,innerStyle:g.divider}),(0,oe.jsx)(Ed,{value:a.email,placeholder:D.default.formatMessage(Nd.emailPlaceholder),onChange:v,labelMessage:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.title",defaultMessage:"Contact email"}),helpMessage:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.deleteWorkspaces.deletionModal.tooltipExplanation",defaultMessage:"The Workspace Owner of the deleted workspace can contact this email for inquiries"}),errorMessage:a.didError?(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.error",defaultMessage:"Invalid email address"}):void 0}),(0,oe.jsx)(ve.Z,{disabled:!r||!a.email||d,disabledFeedback:!0,isLarge:!0,style:g.primaryButton,hoveredStyle:g.primaryButtonHovered,onClick:b,children:d?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.deleteButton",defaultMessage:"Delete workspace"})}),(0,oe.jsxs)("div",{style:g.checkboxContainer,children:[(0,oe.jsx)(nt.Z,{style:g.checkbox,size:14,checked:r,onClick:S}),(0,oe.jsx)(at.Z,{isSmall:!0,style:g.checkboxCaption,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.checkboxLabel",defaultMessage:"I'm sure I want to delete this workspace"})})]}),(0,oe.jsx)(ve.Z,{style:g.secondaryButton,onClick:x,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.cancel",defaultMessage:"Cancel"})})]})})};function Ed(e){window.__c={n:"EmailInput"};const t=(0,Je.yK)((e=>({emailInputTitle:{fontWeight:m.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},emailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},inputCaptionError:{color:e.errorText,marginTop:8,fontSize:13},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16}})),[]);return(0,oe.jsxs)("div",{style:t.emailContainer,children:[(0,oe.jsxs)(at.Z,{style:t.emailInputTitle,children:[e.labelMessage,e.helpMessage&&(0,oe.jsx)(te.Z,{renderTooltip:()=>e.helpMessage,render:e=>(0,oe.jsx)("span",{...e,children:(0,Do.m)(t.helpIcon)})})]}),(0,oe.jsx)(_e.Z,{value:e.value,placeholder:e.placeholder,onChange:e.onChange}),e.errorMessage&&(0,oe.jsx)(at.Z,{isSmall:!0,style:t.inputCaptionError,children:e.errorMessage})]})}const Vd=e=>{let{onDismiss:t,onAccept:s,spaceQueued:i,descriptionMessage:n,divider:a,modalIcon:o,title:r,acceptMessage:l,isLoading:d}=e;window.__c={n:"ClaimableSpaceConfirmationModal"};const c=(0,Je.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{height:24,width:24,fill:e.mediumIconColor},title:{fontWeight:m.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:m.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32,justifyContent:"center",fontWeight:m.Z.fontWeight.medium},secondaryButton:{margin:"8px auto 0",width:"100%",justifyContent:"center",fontWeight:m.Z.fontWeight.medium,color:e.lightTextColor},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),u=Boolean(i);return(0,oe.jsx)(Mo.Z,{open:u,innerStyle:c.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:c.closeIconContainer,children:(0,oe.jsx)(ve.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Pd.D)(c.closeIcon)})}),o&&(0,oe.jsx)("div",{children:o(c.modalIcon)}),(0,oe.jsxs)(at.Z,{style:c.title,children:[r,(0,oe.jsx)(Fd.Z,{href:(0,Gs.UY)("guides.domainManagement"),children:(0,oe.jsx)(an.Z,{icon:Do.m})})]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:c.description,children:n}),(0,oe.jsxs)("div",{style:c.workspaceContainer,children:[i?(0,oe.jsx)(vd,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):void 0,(0,oe.jsx)("div",{style:c.checkContainer,children:(0,Zd.k)(c.check)})]}),a&&(0,oe.jsx)(ro.Z,{size:0,style:c.dividerContainer,innerStyle:c.divider}),(0,oe.jsx)(Q.Z,{isLarge:!0,style:c.primaryButton,onClick:s,disabled:d,children:d?(0,oe.jsx)(Ti.Z,{}):l}),(0,oe.jsx)(ve.Z,{style:c.secondaryButton,onClick:t,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimableSpaceConfirmationModal.cancel",defaultMessage:"Cancel"})})]})})};const Ud=e=>{let{onDismiss:t,spaceQueuedForRecovery:s,currentSpaceId:n}=e;window.__c={n:"SpaceRecoveryConfirmationModal"};const{setSpaceRequest:a}=(0,i.useContext)(Ao),o=(0,T.O7)(),[r,l]=(0,i.useState)(!1),d=(0,i.useCallback)((()=>{l(!1),t()}),[t]),c=(0,i.useCallback)((async()=>{if(!n||!s)return;l(!0);const e=await M.cancelSpaceDeletionForDomain(o,{requestingSpaceId:n,targetSpaceId:s.id});if("failed"===e.type)return l(!1),void y.showErrorMessage((0,R.wf)(D.default.getIntl(),e));var t;a(s.id,void 0),f.JvT(o,{targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain}),d(),t=s.name,Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.table.recoverSpace.toast",defaultMessage:"Successfully recovered “{spaceName}“",values:{spaceName:t}})})}),[a,n,o,s,d]);return(0,oe.jsx)(Vd,{onDismiss:d,onAccept:c,spaceQueued:s,modalIcon:Eo.u,title:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.title",defaultMessage:"Recover workspace"}),descriptionMessage:s?(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.byline",defaultMessage:"Restore workspace content and the workspace owner's access.",values:{currentWorkspaceName:s.name}}):void 0,acceptMessage:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.deleteButton",defaultMessage:"Recover"}),isLoading:r,divider:!1})};let Wd=!1;function Kd(e){let{spaceStore:t}=e;window.__c={n:"WorkspacesPage"};const{claimableSpaces:s,domainVerifications:n,loadingSpaces:o,errorClaimableSpaces:r,errorVerifications:l,navigateTo:d,removeClaimableSpace:c,loadMoreClaimableSpaces:g,tab:h,setSelectedTab:f,verifiedDomains:x}=(0,i.useContext)(Ao),v=(0,T.O7)(),S=(0,a.VK)((()=>!cd.Z.state.open&&Boolean(cd.Z.state.succeeded)),[]),[b,M]=(0,i.useState)(),[j,w]=(0,i.useState)(),[C,k]=(0,i.useState)(),[I,P]=(0,i.useState)(),_=(0,a.VK)((()=>yi.Q6(ui.default.state.data)),[]);function Z(){M(void 0),w(void 0),k(void 0),P(void 0)}(0,i.useEffect)((()=>{S&&b&&(c(b.id),M(void 0),cd.Z.reset())}),[S,b,c,M]);const F=(0,Je.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:m.Z.fontWeight.semibold,fontSize:17},byline:{fontSize:14,fontWeight:m.Z.fontWeight.regular,color:e.mediumTextColor,marginRight:"auto",paddingRight:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"}})),[]);if(r)return y.deprecatedShowErrorMessage(r.message),null;if(l)return y.deprecatedShowErrorMessage(l.message),null;const A=s.filter((e=>ad(e.spaceRequest,e.memberCount))),R=s.filter((e=>!ad(e.spaceRequest,e.memberCount))),D=[{id:"external-transfer",getIcon:e=>(0,rd.Z)({...e,height:14,width:14}),name:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransfer",defaultMessage:"Require account change"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransferCaption",defaultMessage:"Owner will be prompted to change workspace ownership to a personal account."}),onAction:e=>w(e)},{id:"space-deletion",getIcon:e=>(0,Vo.y)({...e,height:14,width:14}),name:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace",defaultMessage:"Delete workspace"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpaceCaption",defaultMessage:"Owner will lose access to the workspace immediately."}),onAction:e=>k(e),getDisabledState:e=>{const{isEligible:t}=zd(n,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling||!(0,u.QM)(e.subscriptionTier)},getTooltip:e=>{const t=zd(n,e.creatorEmailDomain);return t.isEligible?!(0,u.QM)(e.subscriptionTier)||e.isDelinquent||e.isPendingBilling?(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for deletion."}):void 0:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,oe.jsx)("br",{})}})}},{id:"recover-space",getIcon:()=>{},name:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.actions.recoverSpace",defaultMessage:"Recover"}),caption:void 0,onAction:e=>P(e)}],B=[{id:"claim-and-upgrade",getIcon:e=>(0,ld.l)({...e,height:14,width:14}),name:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgrade",defaultMessage:"Claim and upgrade"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgradeCaption",defaultMessage:"Take ownership of the workspace and upgrade it to an Enterprise plan"}),onAction:e=>M(e),getDisabledState:e=>{const{isEligible:t}=zd(n,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling},getTooltip:e=>{const t=zd(n,e.creatorEmailDomain);return e.isDelinquent||e.isPendingBilling?(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for claiming."}):t.isEligible?void 0:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,oe.jsx)("br",{})}})}}];return(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsx)(co.Z,{style:F.link,onClick:()=>d(Po),children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,oe.jsx)(bt.Z,{large:!0,style:F.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.title",defaultMessage:"Manage workspaces"})}),(0,oe.jsxs)(ud.X2,{children:[(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:F.byline,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.byline",defaultMessage:"Claim verified-domain workspaces to your Enterprise plan or require Owners to use an external domain."})}),(0,oe.jsx)(St.Z,{isLarge:!0,onClick:()=>{H.g({environment:v,data:{spaceId:t.id,emailDomains:x}})},children:(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.exportClaimableWorkspaces.button",defaultMessage:"Export to CSV"})})]}),(0,oe.jsx)(mo.Z,{tabs:[(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.singleSpaces",defaultMessage:"Single-member"},"single"),(0,oe.jsx)(p.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.multiSpaces",defaultMessage:"Multi-member"},"multi")],selectedIndex:h,onChange:e=>f(e),style:F.tabBarMenu}),(0,oe.jsx)(Rd,{onDismiss:Z,spaceQueuedForTransfer:j,currentSpaceId:t.id}),h===Fo.Single?(0,oe.jsx)(Td,{claimableSpaces:A,spaceActions:D,loadMoreClaimableSpaces:g,loading:o},"single"):(0,oe.jsx)(Td,{claimableSpaces:R,spaceActions:B,loadMoreClaimableSpaces:g,loading:o},"multi"),_?(0,oe.jsx)(Dd,{onDismiss:Z,spaceQueuedForClaiming:b,requestingSpaceId:t.id}):(0,oe.jsx)(Bd,{onDismiss:Z,spaceQueuedForClaiming:b}),(0,oe.jsx)(Od,{onDismiss:Z,spaceQueuedForDeletion:C,currentSpaceId:t.id}),(0,oe.jsx)(Ud,{onDismiss:Z,spaceQueuedForRecovery:I,currentSpaceId:t.id})]})}function zd(e,t){if(Wd)return{isEligible:!0};const s=e.find((e=>{let{domain:s}=e;return t===s}));if(!s||!s.verified_at)return{isEligible:!0};const i=(Date.now()-s.verified_at)/dd.A0;return i>=14?{isEligible:!0}:{isEligible:!1,daysUntilEligible:Math.ceil(14-i)}}function qd(e){let{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:a}=e;window.__c={n:"PageRouter"};const{page:o}=(0,i.useContext)(Ao);switch(o){case Po:return(0,oe.jsx)(nd,{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:a});case _o:return(0,oe.jsx)(Kd,{spaceStore:s});case Zo:return(0,oe.jsx)(Or,{spaceStore:s,samlConfigStore:n})}}["local","development","staging"].includes("production")&&(0,od.exposeDebugValue)("bypassDomainVerificationWaitingPeriod",(function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Wd=e}));const Gd=function(e){let{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:n}=e;return(0,oe.jsx)(Ro,{spaceStore:s,samlConfigStore:i,domainSettingsStore:n,children:(0,oe.jsx)(qd,{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:n})})};var Hd=s(22756),Qd=s(41892),Yd=s(1800);s(40902),s(41432),s(99036),s(45433);s(42613),s(71644),s(6287),s(68955),s(46227),s(20302),s(89789);var $d=s(74446);s(70203),s(18844),s(70279),s(91644);s(58129),s(70921),s(30842),s(39050),s(54368),s(51650),s(88179),s(80926),s(98963),s(7470),s(60014),s(13493),s(75908),s(6359),s(7678),s(73409),s(60897),s(33709),s(44312),s(4986),s(52719),s(58912),s(73387),s(36077),s(97715),s(32161),s(82447),s(9713),s(57398),s(49953),s(14710),s(9508),s(62643),s(57883),s(66726),s(30754),s(6946),s(25753),s(84683),s(38429),s(89488),s(65311),s(16427),s(61220),s(96683),s(70017),s(89470),s(49126),s(94578),s(4137),s(80396),s(24836),s(86135),s(78929),s(84323),s(83200),s(67627),s(65963),s(14130),s(34406),s(42314),s(16663),s(19221),s(93646),s(63787),s(38952),s(40837),s(96740),s(63921),s(75990),s(57829),s(63188),s(58529),s(56877),s(76413),s(47238),s(35623),s(77858),s(37202),s(26195),s(60113),s(14718),s(14327),s(53412),s(65836),s(5505),s(24494),s(66295),s(10354),s(19716),s(98897),s(46769),s(66079),s(58161),s(28182),s(35794),s(11045);s(2607);(0,me.AO)((e=>"title"===e||"text"===e||"url"===e||"email"===e||"phone_number"===e||"checkbox"===e||"person"===e||"file"===e||"select"===e||"multi_select"===e||"status"===e||"number"===e||"date"===e||"relation"===e||"button"===e||"auto_increment_id"===e||"verification"===e?{true:e}:{false:e}));s(38297),s(606);const Jd=ha.Ak.create();ha.PF.create();Date.now();$d.mF.fromRecordMap(Jd),$d.zF.fromRecordMap(Jd);const Xd=ga.om.fromRecordMap(Jd);ga.s8.fromRecordMap(Jd);var ec=s(26139),tc=s(50063),sc=s(41311),ic=s(30397),nc=s(33907),ac=s(36591),oc=s(75071),rc=s(91),lc=s(9867),dc=s(29551),cc=s(93963),uc=s(40235);const mc=function(){window.__c={n:"AsanaImportStepChooseWorkspaceTab"};const e=(0,T.O7)(),t=(0,p.useIntl)(),s=(0,a.VK)((()=>Hd.Z.getState()),[]),{workspaces:n,selectedWorkspace:o,teamsAndProjects:r}=s;return(0,i.useEffect)((()=>{o&&sc.y2({selectedWorkspace:o,environment:e}).catch((()=>{}))}),[o,e]),(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,oe.jsx)("img",{src:Qd.Z.images.import.asanaPng,width:16,height:16}),(0,oe.jsx)(gc,{onSelectOption:e=>{Hd.Z.setState({...s,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:n.map((e=>({key:e.gid,label:e.name}))),currentOption:s.selectedWorkspace,placeHolder:t.formatMessage({id:"asanaImporter.chooseWorkspace.chooseWorkspacePlaceholder",defaultMessage:"Choose a workspace"})})]}),s.selectedWorkspace?(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.semibold,marginTop:18},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.selectProjects",defaultMessage:"Select projects"})}):(0,oe.jsx)(oe.Fragment,{}),s.isLoadingProjects?(0,oe.jsxs)(dc.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,oe.jsx)(Ti.Z,{style:{fontSize:12}}),(0,oe.jsx)(at.Z,{isSmall:!0,style:{color:et.FN.light.gray[400]},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):r.filter((e=>0!==e.projects.length)).map((e=>(0,oe.jsx)(pc,{team:e,selectedWorkspace:o},`${e.gid}-table`)))]})};function pc(e){var t;let{team:s,selectedWorkspace:n}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const r=(0,T.O7)(),l=(0,p.useIntl)(),d=(0,Je.Fg)(),[c,u]=(0,i.useState)(!1),[g,h]=(0,i.useState)(!1),[f,y]=(0,i.useState)(),x=(0,a.VK)((()=>Hd.Z.getState()),[]),v=(0,a.VK)((()=>ie.default.state.currentSpaceViewStore),[]),S=(0,a.VK)((()=>{const e=null==v?void 0:v.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,oe.jsx)(yn.p,{disabled:!0,store:e})})))}),[v]);(0,i.useEffect)((()=>{if(!S||!v)return;if(!x.selectedProjectsAndTeamspaces[s.gid]){y("private"),sc.B3({teamId:s.gid,spaceId:null==v?void 0:v.id});for(const i of S){var e,t;if((null===(e=i.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.name)||void 0===t?void 0:t.toLowerCase())){y(i.id),sc.B3({teamId:s.gid,spaceId:i.id});break}}}}),[S,s,v,x.selectedProjectsAndTeamspaces]);const b=(0,i.useCallback)((e=>{sc.B3({teamId:s.gid,spaceId:e}),y(e)}),[s.gid]),j=(0,i.useCallback)((e=>{if("create"===e)return void lc.lo("asana_importer",{onClose:b});let t;if("private"===e){if(null==v||!v.id)return;t=v.id}else t=e;sc.B3({teamId:s.gid,spaceId:t}),y(e)}),[null==v?void 0:v.id,s.gid,b]),{importCompletedTasks:w}=x,C=[{key:"private",searchTerm:"private",label:(0,oe.jsxs)(dc.gq,{alignItems:"center",style:{gap:8},children:[(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:et.FN.light.gray[75]},children:(0,o.Q)({color:d.mediumIconColor,width:12.5,height:12.5})}),(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.regular},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.privateSpaceTitle",defaultMessage:"Private"})})]})}];return S&&C.push(...S.map((e=>({key:e.id,searchTerm:e.name,label:(0,oe.jsxs)(dc.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),C.push({key:"create",searchTerm:"New teamspace",label:(0,oe.jsxs)(dc.gq,{alignItems:"center",style:{gap:4},children:[(0,oc.f)({color:d.mediumIconColor,width:16,height:16}),(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,oe.jsxs)(dc.gq,{children:[(0,oe.jsx)(an.Z,{ariaLabel:"collapse toggle",icon:rc.L,onClick:()=>u((e=>!e)),style:{transform:c?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,oe.jsx)(uc.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:2,children:[(0,oe.jsx)(hc,{onSelectOption:e=>{var t;Hd.Z.setState({...x,selectedProjectsAndTeamspaces:{...x.selectedProjectsAndTeamspaces,[s.gid]:{notionTeamspaceId:null===(t=x.selectedProjectsAndTeamspaces[s.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=x.selectedProjectsAndTeamspaces[s.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),(0,oe.jsx)(at.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.name})]}),style:{width:300}},{key:"importInto",header:(0,oe.jsxs)(dc.gq,{style:{alignItems:"center"},children:[(0,oe.jsx)("div",{children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.importInto",defaultMessage:"Import into"})}),(0,oe.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,nc.n)({width:12})}),(0,oe.jsxs)(dc.gq,{style:{alignItems:"center",gap:8},children:[(0,oe.jsx)("img",{src:Qd.Z.emails.notionLogoBlackSmallPng,height:18}),(0,oe.jsx)(gc,{options:C,onSelectOption:j,currentOption:null===(t=C.find((e=>e.key===f)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:l.formatMessage({id:"asanaImport.importsTab.chooseWorkspace.selectATeamspace",defaultMessage:"Select a teamspace"}),width:250})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const i=s.projects.map((e=>({key:e.gid,columns:[(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,oe.jsx)(nt.Z,{style:{marginRight:2},onClick:()=>{const t={...x.selectedProjectsAndTeamspaces[s.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:i,projects:n}=t;let a;a="all"===n||"in_complete"===n?[]:n.includes(e.gid)?n.filter((t=>t!==e.gid)):n.concat(e.gid),Hd.Z.setState({...x,selectedProjectsAndTeamspaces:{...x.selectedProjectsAndTeamspaces,[s.gid]:{notionTeamspaceId:i,projects:a}}})},checked:(()=>{const t={...x.selectedProjectsAndTeamspaces[s.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),(0,oe.jsx)(cc.z,{color:e.color,size:6}),(0,oe.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:e.completed?(0,oe.jsxs)(at.Z,{isMultiline:!0,style:{color:d.lightTextColor},children:[e.name,(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.completedHelperText",defaultMessage:" (Completed)"})]}):(0,oe.jsx)(at.Z,{isMultiline:!0,children:e.name})})]},`${e.gid}-container`),(0,oe.jsxs)(at.Z,{isSmall:!0,children:[w?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tasksHelperText",defaultMessage:" tasks"})]},`${s.gid}-tasks-count`)]})));return s.nextPage&&i.push({key:"loadMore",columns:[(0,oe.jsx)(oo.Z,{disabled:g,style:{marginLeft:20,color:et.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!n)return;h(!0);const e=await M.getTeamsAndProjectsInAsanaWorkspace(r,{workspaceId:n,teamId:s.gid,size:5,nextPage:s.nextPage}),{teamsAndProjects:t}={...x},i=t.find((e=>e.gid===s.gid));if(i){if("success"===e.type){const n=e.data.find((e=>e.gid===s.gid));if(!n)return;i.projects.push(...n.projects),i.nextPage=n.nextPage,Hd.Z.setState({...x,teamsAndProjects:t,loadMoreClicks:x.loadMoreClicks+1})}h(!1)}},children:g?(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:8,children:[(0,oe.jsx)(Ti.Z,{style:{fontSize:12}}),(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.loadingMoreProjects",defaultMessage:"Loading more projects..."})]}):(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.loadMoreProjects",defaultMessage:"Load more projects..."})},`${s.gid}-loadmore`)]}),i}({collapsed:c})})]})}function gc(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:n,currentOption:a,placeHolder:o,narrow:r,allowSearch:l,width:d}=e,c=(0,p.useIntl)(),[u,g]=(0,i.useState)(""),h=null===(t=n.find((e=>{let{key:t}=e;return t===a})))||void 0===t?void 0:t.label,f=(0,Je.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,placementToOrigin:nn.pO.Bottom,renderOrigin:e=>(0,oe.jsxs)(ve.Z,{...e,style:{paddingTop:r?2:8,paddingBottom:r?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:d??376,border:`1px solid ${et.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,color:a?void 0:et.FN.light.gray[300]},disabled:!1,children:[(0,oe.jsx)(at.Z,{style:{textOverflow:"ellipsis",fontSize:"14px",font:"SF Pro Text",color:a?void 0:"#ACABA9",lineHeight:"19.6px"},children:h||o}),(0,Jn.i)(f.icon)]}),render:e=>{const t={menuType:se.og.Popup,width:376,left:50},i=[{key:"asanaImport.dropdown.menuList",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:(u.trim()?n.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(u.toLowerCase())})):n).map((t=>{let{key:i,label:n}=t;return{key:i,action:()=>{s(i),e.close()},render:e=>(0,oe.jsx)(Y.Z,{...e,title:n,shouldWrapCaption:!0,right:h===n?(0,oe.jsx)("div",{style:{width:14},children:(0,ac.e)()}):void 0})}}))}];return(0,oe.jsxs)(oe.Fragment,{children:[l?(0,oe.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:et.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${et.FN.light.gray[100]}`,justifyContent:"space-between",background:et.FN.light.gray[50],fontSize:m.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:c.formatMessage({id:"asanaImport.importsTab.chooseWorkspace.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>g(e.target.value),value:u}):(0,oe.jsx)(oe.Fragment,{}),(0,oe.jsx)($.Z,{...t,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}function hc(e){var t;window.__c={n:"CheckboxDropdown"};const{onSelectOption:s,options:n,currentOption:a}=e,o=null===(t=n.find((e=>{let{key:t}=e;return t===a})))||void 0===t?void 0:t.label,r=(0,i.useMemo)((()=>void 0!==a&&"specific"!==a&&("all"===a||"partial")),[a]);return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,placementToOrigin:nn.pO.Bottom,alignmentToOrigin:nn.vR.Start,renderOrigin:e=>(0,oe.jsx)(ve.Z,{...e,style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{},children:(0,oe.jsx)(nt.Z,{checked:r,disabled:!0,size:14,checkSize:8})}),render:e=>{const t={menuType:se.og.Popup,width:250,left:50},i=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:n.map((t=>{let{key:i,label:n}=t;return{key:i,action:()=>{s(i),e.close()},render:e=>(0,oe.jsx)(Y.Z,{...e,title:n,shouldWrapCaption:!0,right:o===n?(0,oe.jsx)("div",{style:{width:14},children:(0,ac.e)()}):void 0})}}))}];return(0,oe.jsx)($.Z,{...t,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}var fc=s(91315);const yc=function(){window.__c={n:"AsanaImportStepConfirmTab"};const e=(0,a.VK)((()=>Hd.Z.state),[]);return e.result?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(at.Z,{isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,oe.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,oe.jsx)(xc,{importStatus:e},e.asanaTeamId)))})]}):(0,oe.jsx)(oe.Fragment,{})};function xc(e){let{importStatus:t}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const s=(0,Je.Fg)(),[n,r]=(0,i.useState)(!1),l=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),d=(0,a.VK)((()=>Hd.Z.state.teamsAndProjects),[]),c=(0,a.VK)((()=>ie.default.state.currentSpaceViewStore),[]),u=(0,a.VK)((()=>{if(!c)return;const e=c.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,oe.jsx)(yn.p,{disabled:!0,store:e})})));return l?(e||[]).concat({id:c.id,name:"Private",icon:(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:et.FN.light.gray[75]},children:(0,o.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[c,l,s]),{notionTeamspaceName:m,notionTeamspaceIcon:g}=(0,i.useMemo)((()=>{const e=null==u?void 0:u.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[u,t]),h=(0,i.useMemo)((()=>{const e=d.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[d,t]);return(0,oe.jsxs)(dc.gq,{style:{marginTop:16},children:[(0,oe.jsx)(an.Z,{ariaLabel:"collapse toggle",icon:rc.L,onClick:()=>r((e=>!e)),style:{transform:n?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),(0,oe.jsx)(uc.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,oe.jsx)(dc.gq,{alignItems:"center",gap:2,children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:h})}),style:{width:300}},{key:"importedInto",header:(0,oe.jsxs)(dc.gq,{gap:4,children:[(0,oe.jsxs)(dc.gq,{style:{alignItems:"center",gap:4},children:[(0,oe.jsx)(at.Z,{isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,nc.n)({width:12})]}),(0,oe.jsxs)(dc.gq,{style:{alignItems:"center",gap:4},children:[g,m]})]}),style:{width:300}}],rows:function(e){let{collapsed:s}=e;return s?[]:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,oe.jsxs)(dc.gq,{gap:8,alignItems:"center",children:[(0,fc.r)({width:12,color:et.FN.dark.green[600]}),(0,oe.jsx)(at.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId),(0,oe.jsxs)(at.Z,{isSmall:!0,children:[e.numberOfTasks,(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})))}({collapsed:n})})]})}var vc=s(86793),Sc=s(92607);const bc=function(){window.__c={n:"AsanaImportStepImportCompleteTab"};const e=(0,a.VK)((()=>Hd.Z.state),[]);if(!e.result)return(0,oe.jsx)(oe.Fragment,{});const t=e.result;let s=0;return t.forEach((e=>{s+=e.numberOfProjects})),(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(0,oe.jsx)(at.Z,{isMultiline:!0,style:{font:"SF Pro",fontWeight:m.Z.fontWeight.semibold,fontSize:m.Z.fontSize.UIRegular.mobile,paddingTop:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.importComplete.subtitle",defaultMessage:"Imported {projectCount} projects into Notion",values:{projectCount:s}})}),(0,oe.jsx)("div",{style:{marginTop:20},children:e.result.map((e=>(0,oe.jsx)(Mc,{importStatus:e},e.asanaTeamId)))})]})};function Mc(e){let{importStatus:t}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const s=(0,Je.Fg)(),n=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),r=(0,a.VK)((()=>Hd.Z.state.teamsAndProjects),[]),l=(0,a.VK)((()=>ie.default.state.currentSpaceViewStore),[]),d=(0,a.VK)((()=>{if(!l)return;const e=l.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,oe.jsx)(yn.p,{disabled:!0,store:e})})));return n?(e||[]).concat({id:l.id,name:"Private",icon:(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:et.FN.light.gray[75]},children:(0,o.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[l,n,s]),{notionTeamspaceName:c,notionTeamspaceIcon:u}=(0,i.useMemo)((()=>{const e=null==d?void 0:d.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[d,t]),g=(0,i.useMemo)((()=>{const e=r.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[r,t]);return(0,oe.jsx)(dc.gq,{style:{marginTop:16},children:(0,oe.jsx)(uc.Z,{tableStyle:{borderTop:0,gap:10},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,oe.jsx)(dc.gq,{children:(0,oe.jsx)(dc.gq,{alignItems:"center",gap:2,children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis",font:"SF Pro",fontWeight:m.Z.fontWeight.regular,fontSize:m.Z.fontSize.UIRegular.desktop},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.importComplete.importFrom",defaultMessage:"From {asanaTeamName} in Asana",values:{asanaTeamName:g}})})})}),style:{width:300}},{key:"seperator",header:(0,oe.jsx)(dc.gq,{style:{alignItems:"center",gap:4},children:(0,oe.jsx)(at.Z,{isMultiline:!0,style:{fontWeight:m.Z.fontWeight.regular,font:"SF Pro",fontSize:m.Z.fontSize.UIRegular.desktop,color:"rgba(172, 171, 169, 1)"},children:"→"})}),style:{width:13,height:18,paddingRight:20}},{key:"importedInto",header:(0,oe.jsxs)(dc.gq,{style:{alignItems:"center",gap:4},children:[u,(0,oe.jsx)(at.Z,{style:{font:"SF Pro",fontWeight:m.Z.fontWeight.medium,fontSize:m.Z.fontSize.UIRegular.desktop},children:c}),(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.regular,fontSize:m.Z.fontSize.UIRegular.desktop,font:"SF Pro Text",color:"rgba(172, 171, 169, 1)"},children:"/"}),(0,oe.jsx)(oe.Fragment,{children:(0,vc.D)({width:"16px",height:"16px",color:s.mediumIconColor})}),(0,oe.jsx)(at.Z,{style:{font:"SF Pro",fontWeight:m.Z.fontWeight.medium,fontSize:m.Z.fontSize.UIRegular.desktop},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.importComplete.projectLabel",defaultMessage:"Projects"})})]}),style:{width:300}}],rows:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,oe.jsxs)(dc.gq,{gap:8,alignItems:"start",flexDirection:"column",children:[(0,oe.jsx)(at.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300,fontWeight:m.Z.fontWeight.medium,font:"SF Pro",fontSize:m.Z.fontSize.UIRegular.desktop},children:e.name}),(0,oe.jsxs)(at.Z,{isSmall:!0,children:[e.numberOfTasks,(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]},e.projectId),(0,oe.jsx)(dc.gq,{},`${e.projectId}-seperator`),(0,oe.jsx)(dc.gq,{children:(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",gap:4,paddingBottom:6},children:[(0,vc.D)({width:20,height:20,color:s.mediumIconColor}),(0,oe.jsx)(co.Z,{href:e.notionProjectId?(0,Yd.Z)({pageId:e.notionProjectId,pageModel:Xd({table:Vt.iU,id:e.notionProjectId}),baseUrl:Mt.default.domainBaseUrl,pageVisitSource:Gi.tY.Import}):void 0,style:{wordWrap:"break-word",fontWeight:m.Z.fontWeight.medium,font:"SF Pro",fontSize:m.Z.fontSize.UIRegular.desktop,textDecorationLine:"underline",textDecorationColor:"rgba(227, 226, 224, 1)"},disableHover:!0,children:e.name})]}),(0,oe.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,Sc.v)({width:14,height:14,color:s.mediumIconColor}),(0,oe.jsxs)(co.Z,{href:e.notionProjectId?(0,Yd.Z)({pageId:e.notionProjectId,pageModel:Xd({table:Vt.iU,id:e.notionProjectId}),baseUrl:Mt.default.domainBaseUrl,pageVisitSource:Gi.tY.Import}):void 0,style:{color:"rgba(120, 119, 116, 1)",font:"SF Pro",fontSize:m.Z.fontSize.UISmall.desktop,fontWeight:m.Z.fontWeight.regular},disableUnderline:!0,disableHover:!0,children:[e.numberOfTasks,(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})]})},`${e.projectId}-notionProjects`)]})))})})}const jc=function(){window.__c={n:"AsanaImportStepSelectDataTab"};const e=(0,T.O7)(),t=(0,p.useIntl)(),s=(0,a.VK)((()=>Hd.Z.getState()),[]),{workspaces:n,selectedWorkspace:o,teamsAndProjects:r}=s;return(0,i.useEffect)((()=>{o&&sc.y2({selectedWorkspace:o,environment:e}).catch((()=>{}))}),[o,e]),(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(at.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,oe.jsx)(Cc,{onSelectOption:e=>{Hd.Z.setState({...s,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:n.map((e=>({key:e.gid,label:e.name}))),currentOption:s.selectedWorkspace,placeHolder:t.formatMessage({id:"asanaImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),s.selectedWorkspace?(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.semibold,marginTop:18},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,oe.jsx)(oe.Fragment,{}),s.isLoadingProjects?(0,oe.jsxs)(dc.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,oe.jsx)(Ti.Z,{style:{fontSize:12}}),(0,oe.jsx)(at.Z,{isSmall:!0,style:{color:et.FN.light.gray[400]},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):r.filter((e=>0!==e.projects.length)).map((e=>(0,oe.jsx)(wc,{team:e,selectedWorkspace:o},`${e.gid}-table`)))]})};function wc(e){var t;let{team:s,selectedWorkspace:n}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const r=(0,T.O7)(),l=(0,p.useIntl)(),d=(0,Je.Fg)(),[c,u]=(0,i.useState)(!1),[g,h]=(0,i.useState)(!1),[f,y]=(0,i.useState)(),x=(0,a.VK)((()=>Hd.Z.getState()),[]),v=(0,a.VK)((()=>ie.default.state.currentSpaceViewStore),[]),S=(0,a.VK)((()=>{const e=null==v?void 0:v.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,oe.jsx)(yn.p,{disabled:!0,store:e})})))}),[v]);(0,i.useEffect)((()=>{if(!S||!v)return;if(!x.selectedProjectsAndTeamspaces[s.gid]){y("private"),sc.B3({teamId:s.gid,spaceId:null==v?void 0:v.id});for(const i of S){var e,t;if((null===(e=i.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.name)||void 0===t?void 0:t.toLowerCase())){y(i.id),sc.B3({teamId:s.gid,spaceId:i.id});break}}}}),[S,s,v,x.selectedProjectsAndTeamspaces]);const b=(0,i.useCallback)((e=>{sc.B3({teamId:s.gid,spaceId:e}),y(e)}),[s.gid]),j=(0,i.useCallback)((e=>{if("create"===e)return void lc.lo("asana_importer",{onClose:b});let t;if("private"===e){if(null==v||!v.id)return;t=v.id}else t=e;sc.B3({teamId:s.gid,spaceId:t}),y(e)}),[null==v?void 0:v.id,s.gid,b]),{importCompletedTasks:w}=x,C=[{key:"private",searchTerm:"private",label:(0,oe.jsxs)(dc.gq,{alignItems:"center",style:{gap:8},children:[(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:et.FN.light.gray[75]},children:(0,o.Q)({color:d.mediumIconColor,width:12.5,height:12.5})}),(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.regular},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];return S&&C.push(...S.map((e=>({key:e.id,searchTerm:e.name,label:(0,oe.jsxs)(dc.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),C.push({key:"create",searchTerm:"New teamspace",label:(0,oe.jsxs)(dc.gq,{alignItems:"center",style:{gap:4},children:[(0,oc.f)({color:d.mediumIconColor,width:16,height:16}),(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,oe.jsxs)(dc.gq,{style:{marginLeft:-18},children:[(0,oe.jsx)(an.Z,{ariaLabel:"collapse toggle",icon:rc.L,onClick:()=>u((e=>!e)),style:{transform:c?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,oe.jsx)(uc.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:2,children:[(0,oe.jsx)(kc,{onSelectOption:e=>{var t;Hd.Z.setState({...x,selectedProjectsAndTeamspaces:{...x.selectedProjectsAndTeamspaces,[s.gid]:{notionTeamspaceId:null===(t=x.selectedProjectsAndTeamspaces[s.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=x.selectedProjectsAndTeamspaces[s.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),(0,oe.jsx)(at.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.name})]}),style:{width:300}},{key:"importInto",header:(0,oe.jsxs)(dc.gq,{style:{alignItems:"center"},children:[(0,oe.jsx)("div",{children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,oe.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,nc.n)({width:12})}),(0,oe.jsxs)(dc.gq,{style:{alignItems:"center",gap:8},children:[(0,oe.jsx)("img",{src:Qd.Z.emails.notionLogoBlackSmallPng,height:18}),(0,oe.jsx)(Cc,{options:C,onSelectOption:j,currentOption:null===(t=C.find((e=>e.key===f)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:l.formatMessage({id:"asanaImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const i=s.projects.map((e=>({key:e.gid,columns:[(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,oe.jsx)(nt.Z,{style:{marginRight:2},onClick:()=>{const t={...x.selectedProjectsAndTeamspaces[s.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:i,projects:n}=t;let a;a="all"===n||"in_complete"===n?[]:n.includes(e.gid)?n.filter((t=>t!==e.gid)):n.concat(e.gid),Hd.Z.setState({...x,selectedProjectsAndTeamspaces:{...x.selectedProjectsAndTeamspaces,[s.gid]:{notionTeamspaceId:i,projects:a}}})},checked:(()=>{const t={...x.selectedProjectsAndTeamspaces[s.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),(0,oe.jsx)(cc.z,{color:e.color,size:6}),(0,oe.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:e.completed?(0,oe.jsxs)(at.Z,{isMultiline:!0,style:{color:d.lightTextColor},children:[e.name,(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.completedHelperText",defaultMessage:" (Completed)"})]}):(0,oe.jsx)(at.Z,{isMultiline:!0,children:e.name})})]},`${e.gid}-container`),(0,oe.jsxs)(at.Z,{isSmall:!0,children:[w?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${s.gid}-tasks-count`)]})));return s.nextPage&&i.push({key:"loadMore",columns:[(0,oe.jsx)(oo.Z,{disabled:g,style:{marginLeft:20,color:et.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!n)return;h(!0);const e=await M.getTeamsAndProjectsInAsanaWorkspace(r,{workspaceId:n,teamId:s.gid,size:5,nextPage:s.nextPage}),{teamsAndProjects:t}={...x},i=t.find((e=>e.gid===s.gid));if(i){if("success"===e.type){const n=e.data.find((e=>e.gid===s.gid));if(!n)return;i.projects.push(...n.projects),i.nextPage=n.nextPage,Hd.Z.setState({...x,teamsAndProjects:t,loadMoreClicks:x.loadMoreClicks+1})}h(!1)}},children:g?(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:8,children:[(0,oe.jsx)(Ti.Z,{style:{fontSize:12}}),(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingMoreProjects",defaultMessage:"Loading more projects..."})]}):(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadMoreProjects",defaultMessage:"Load more projects..."})},`${s.gid}-loadmore`)]}),i}({collapsed:c})})]})}function Cc(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:n,currentOption:a,placeHolder:o,narrow:r,allowSearch:l}=e,d=(0,p.useIntl)(),[c,u]=(0,i.useState)(""),g=null===(t=n.find((e=>{let{key:t}=e;return t===a})))||void 0===t?void 0:t.label,h=(0,Je.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,placementToOrigin:nn.pO.Bottom,renderOrigin:e=>(0,oe.jsxs)(ve.Z,{...e,style:{paddingTop:r?2:8,paddingBottom:r?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${et.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:a?void 0:et.FN.light.gray[50],color:a?void 0:et.FN.light.gray[300]},disabled:!1,children:[(0,oe.jsx)(at.Z,{style:{textOverflow:"ellipsis"},children:g||o}),(0,Jn.i)(h.icon)]}),render:e=>{const t={menuType:se.og.Popup,width:250,left:50},i=[{key:"asanaImport.dropdown.menuList",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:(c.trim()?n.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase())})):n).map((t=>{let{key:i,label:n}=t;return{key:i,action:()=>{s(i),e.close()},render:e=>(0,oe.jsx)(Y.Z,{...e,title:n,shouldWrapCaption:!0,right:g===n?(0,oe.jsx)("div",{style:{width:14},children:(0,ac.e)()}):void 0})}}))}];return(0,oe.jsxs)(oe.Fragment,{children:[l?(0,oe.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:et.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${et.FN.light.gray[100]}`,justifyContent:"space-between",background:et.FN.light.gray[50],fontSize:m.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:d.formatMessage({id:"asanaImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>u(e.target.value),value:c}):(0,oe.jsx)(oe.Fragment,{}),(0,oe.jsx)($.Z,{...t,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}function kc(e){var t;window.__c={n:"CheckboxDropdown"};const{onSelectOption:s,options:n,currentOption:a}=e,o=null===(t=n.find((e=>{let{key:t}=e;return t===a})))||void 0===t?void 0:t.label,r=(0,i.useMemo)((()=>void 0!==a&&"specific"!==a&&("all"===a||"partial")),[a]);return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,placementToOrigin:nn.pO.Bottom,alignmentToOrigin:nn.vR.Start,renderOrigin:e=>(0,oe.jsx)(ve.Z,{...e,style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{},children:(0,oe.jsx)(nt.Z,{checked:r,disabled:!0,size:14,checkSize:8})}),render:e=>{const t={menuType:se.og.Popup,width:250,left:50},i=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:n.map((t=>{let{key:i,label:n}=t;return{key:i,action:()=>{s(i),e.close()},render:e=>(0,oe.jsx)(Y.Z,{...e,title:n,shouldWrapCaption:!0,right:o===n?(0,oe.jsx)("div",{style:{width:14},children:(0,ac.e)()}):void 0})}}))}];return(0,oe.jsx)($.Z,{...t,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}var Tc=s(53465),Ic=s(64878);const Pc=function(e){var t;window.__c={n:"ImportStepImportingDataFailedTab"};const s=(0,Je.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},closeIconStyle:{width:16,height:16,fill:e.redBadgeBackground},lightText:{color:e.lightTextColor}})),[]);return(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,oe.jsxs)(dc.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,oe.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,Ic.h)(s.iconStyle),(0,Ic.h)(s.iconStyle),(0,Ic.h)(s.iconStyle),(0,Tc.X)(s.closeIconStyle),(0,Ic.h)(s.iconStyle),(0,Ic.h)(s.iconStyle),(0,Ic.h)(s.iconStyle),(0,oe.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:Qd.Z.images.notionLogoPng})]}),(0,oe.jsx)(at.Z,{style:s.lightText,children:e.failedMessage}),(0,oe.jsx)(at.Z,{style:s.lightText,children:(0,oe.jsx)(p.FormattedMessage,{id:"import.importingData.failed.viewLoggerPage",defaultMessage:"Please try again or read the {link} to troubleshoot.",values:{link:(0,oe.jsx)("a",{style:{color:et.ZP.black,cursor:"pointer"},href:`/${null===(t=e.loggerPageId)||void 0===t?void 0:t.replaceAll("-","")}`,children:(0,oe.jsx)(p.FormattedMessage,{id:"import.importingData.failed.linkText",defaultMessage:"import logs"})})}})})]})};const _c=function(e){window.__c={n:"LoaderWithDots"};const{dotCount:t=6,speed:s=800}=e,[n,a]=(0,i.useState)(1),o=(0,Je.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor,opacity:.5},iconStyleBold:{width:6,height:6,fill:e.lightIconColor}})),[]);return(0,i.useEffect)((()=>{const e=setInterval((()=>a((e=>e<t?e+1:1))),s);return()=>clearInterval(e)}),[t,s]),(0,oe.jsx)(dc.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:Array.from({length:t},((e,t)=>t+1)).map((e=>(0,oe.jsx)("div",{children:(0,Ic.h)(n===e?o.iconStyleBold:o.iconStyle)},e)))})};const Zc=function(e){window.__c={n:"ImportStepImportingDataTab"};const t=(0,Je.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},iconStyleBold:{width:8,height:8,fill:e.mediumIconColor},lightText:{color:e.lightTextColor}})),[]);return(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,oe.jsxs)(dc.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,oe.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,oe.jsx)(_c,{}),(0,oe.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:Qd.Z.images.notionLogoPng})]}),(0,oe.jsx)(dc.gq,{children:(0,oe.jsx)(at.Z,{style:t.lightText,children:(0,oe.jsx)(p.FormattedMessage,{id:"import.importingData.feelFreeToLeave",defaultMessage:"Data is being imported. Feel free to leave this window."})})}),(0,oe.jsx)(dc.gq,{children:(0,oe.jsx)(at.Z,{style:t.lightText,children:(0,oe.jsx)(p.FormattedMessage,{id:"import.importingData.sendEmail",defaultMessage:"We will send you an email when the import is complete or if any problems occur."})})})]})},Fc=(0,p.defineMessages)({failed:{defaultMessage:"Some problems occurred while importing data from your Asana workspace.",id:"Asanaimport.importingData.failed.problemsOccured"}});function Ac(e){switch(e){case"selectData":return(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.semibold},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.selectData.tabTitle",defaultMessage:"Select Asana workspace"})});case"chooseWorkspace":return(0,oe.jsx)(at.Z,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",lineHeight:"22px"},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tabTitle",defaultMessage:"Choose Asana workspace"})});default:return(0,oe.jsx)(oe.Fragment,{})}}function Rc(e){switch(e){case"chooseWorkspace":return(0,oe.jsx)(at.Z,{style:{font:"SF Pro",fontWeight:m.Z.fontWeight.regular,fontSize:m.Z.fontSize.UIRegular.desktop,lineHeight:"19.6px",whiteSpace:"normal",wordWrap:"break-word",paddingBottom:20},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tabContext",defaultMessage:"Import your Asana projects and tasks into Notion. Assignees, due dates, attachments, and more will be kept, and you can use Notion’s database features to customize your projects and tasks for your team’s needs"})});default:return(0,oe.jsx)(oe.Fragment,{})}}function Dc(e){window.__c={n:"GetStepIndicator"};const t="chooseWorkspace",s=(0,Je.yK)((e=>({stepIndicator:{font:"SF Pro",alignItems:"center",fontWeight:510,fontSize:m.Z.fontSize.UIRegular.desktop,lineHeight:"18px"},stepIndicatorContainer:{display:"flex",height:32,padding:6,gap:"8px",borderRadius:4,justifyContent:"center",alignItems:"center"},verificationCheck:{width:16,height:16,padding:"0.5px, 0px, 0px, 0px",gap:"10px",color:et.ZP.lightIconColor}})),[]),i=(0,a.VK)((()=>Hd.Z.getState()),[]);return(0,oe.jsxs)("div",{style:{paddingBottom:20,display:"flex",gap:"12px",padding:"12px",alignItems:"center",alignContent:"center",paddingLeft:0},children:[(0,oe.jsxs)("div",{style:{...s.stepIndicatorContainer,width:i.choosingWorkspacesCompleted?191:165,background:e===t?"rgba(0, 0, 0, 0.05)":void 0},children:[i.choosingWorkspacesCompleted?(0,tc.X)(s.verificationCheck):(0,oe.jsx)(oe.Fragment,{}),(0,oe.jsx)(at.Z,{style:{...s.stepIndicator,color:i.choosingWorkspacesCompleted?et.ZP.lightTextColor:e===t?et.ZP.regularTextColor:et.ZP.mediumTextColor},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.stepIndicator.chooseWorkspaceTab",defaultMessage:"Choose what to import"})})]}),(0,oe.jsxs)("div",{style:{...s.stepIndicatorContainer,width:"confirm"===e?83:57,background:"importingData"===e?"rgba(0, 0, 0, 0.05)":void 0},children:["confirm"===e?(0,tc.X)(s.verificationCheck):(0,oe.jsx)(oe.Fragment,{}),(0,oe.jsx)(at.Z,{style:{...s.stepIndicator,color:"confirm"===e?et.ZP.lightTextColor:"importingData"===e?et.ZP.regularTextColor:et.ZP.mediumTextColor},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.importsTab.stepIndicator.importTab",defaultMessage:"Import"})})]})]})}const Bc=function(e){let{tab:t,fetchActiveImportTasks:s}=e;window.__c={n:"AsanaImportStepTab"};const n=D.default.getIntl(),o=(0,T.O7)(),r=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),l=(0,a.VK)((()=>ie.default.state.currentSpaceViewStore),[]),c=(0,a.VK)((()=>ic.Z.state.teams),[]),u=(0,a.VK)((()=>Hd.Z.state),[]),g=(0,a.VK)((()=>lt.default.checkGate("improved_asana_importer_screens")),[]),h=(0,a.VK)((()=>Qs.Z.state),[]).flowId||(0,d.ZP)(),{workspaces:f}=u,y=(0,i.useCallback)((()=>Object.values(u.selectedProjectsAndTeamspaces).some((e=>0!==e.projects.length))),[u.selectedProjectsAndTeamspaces]),x=(0,Je.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor},helpCenterButtonStytles:{display:"flex",alignItems:"baseline",justifyContent:"center",alignContent:"center",fontSize:m.Z.fontSize.UIRegular.desktop,padding:"6px, 0px, 0px, 0px",borderRadius:4,color:e.mediumTextColor,marginTop:2,width:298,height:28,gap:"4px",lineHeight:"18px"},externalLinkIcon:{width:"16px",height:"16px",padding:"0.5px, 0px, 0px, 0px",gap:"8px"}})),[]);function S(){return(0,oe.jsx)(oo.Z,{style:x.helpCenterButtonStytles,onClick:()=>{v.navigate({url:(0,Gs.UY)("guides.importAsana"),environment:o})},hoveredStyle:{background:"none"},children:(0,oe.jsxs)("div",{style:{width:282,height:18,display:"flex",justifyContent:"center",alignItems:"start"},children:[(0,oe.jsx)("div",{style:{width:264,height:18,font:"SF Pro",fontWeight:m.Z.fontWeight.medium,fontSize:m.Z.fontSize.UIRegular.desktop,lineHeight:"18px"},children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.confirm.helpCenter",defaultMessage:"Learn more about importing from Asana"})}),(0,ec.K)(x.externalLinkIcon)]})})}let b=t;return g&&("selectData"===t?b="chooseWorkspace":"confirm"===t&&(b="importComplete")),(0,oe.jsxs)(wi.Z,{controlRow:(e=>"selectData"===e?(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,oe.jsx)(St.Z,{style:{border:0},disabled:!f.length,onClick:()=>{s(),Hd.Z.resetImport()},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:8,children:[u.selectedWorkspace?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(jr.Z,{on:u.importCompletedTasks,onClick:()=>Hd.Z.setState({...u,importCompletedTasks:!u.importCompletedTasks})}),(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.selectData.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}):(0,oe.jsx)(oe.Fragment,{}),(0,oe.jsx)("div",{style:{gap:2},children:(0,oe.jsx)(Q.Z,{style:{marginLeft:16},disabled:!y()||u.templateCreationInProgress,onClick:()=>{r&&l&&sc.T_({environment:o,currentSpaceViewStore:l,spaceStore:r,teamsStores:c,flowId:h}).catch((()=>{}))},children:u.templateCreationInProgress?(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:2,children:[(0,oe.jsx)(Ti.Z,{isWhite:!0}),(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})})})]})]}):"chooseWorkspace"===e?(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[S(),(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:8,children:[u.selectedWorkspace?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(jr.Z,{on:u.importCompletedTasks,onClick:()=>Hd.Z.setState({...u,importCompletedTasks:!u.importCompletedTasks})}),(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.chooseWorkspace.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}):(0,oe.jsx)(oe.Fragment,{}),(0,oe.jsxs)("div",{style:{gap:2},children:[(0,oe.jsx)(St.Z,{style:{border:0},disabled:!f.length,onClick:()=>{s(),Hd.Z.resetImport()},children:(0,oe.jsx)(p.FormattedMessage,{id:"asanaImport.chooseWorkspace.backButtonText",defaultMessage:"Back"})}),(0,oe.jsx)(Q.Z,{style:{marginLeft:16},disabled:!y()||u.templateCreationInProgress,onClick:()=>{r&&l&&sc.T_({environment:o,currentSpaceViewStore:l,spaceStore:r,teamsStores:c,flowId:h}).catch((()=>{}))},children:u.templateCreationInProgress?(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:2,children:[(0,oe.jsx)(Ti.Z,{isWhite:!0}),(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.chooseWorkspace.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.chooseWorkspace.nextButtonText",defaultMessage:"Next"})})]})]})]}):"importingData"===e?(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:g?"space-between":"right"},children:[g?S():(0,oe.jsx)(oe.Fragment,{}),(0,oe.jsx)(St.Z,{disabled:!f.length,onClick:()=>{s(),Hd.Z.resetImport()},children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})]}):"confirm"===e?(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,oe.jsx)(Q.Z,{onClick:()=>{u.loggerPageId&&v.navigate({url:(0,Yd.Z)({pageId:u.loggerPageId,pageModel:Xd({table:Vt.iU,id:u.loggerPageId}),baseUrl:Mt.default.domainBaseUrl,pageVisitSource:Gi.tY.Import}),environment:o}),Hd.Z.resetImport(),ci.Z.reset()},children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,oe.jsx)(St.Z,{disabled:!f.length,onClick:()=>{s(),Hd.Z.resetImport()},children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"importComplete"===e?(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",height:48,paddingTop:35,paddingBottom:28,border:"1px, 0px, 0px, 0px"},children:[S(),(0,oe.jsx)(Q.Z,{style:{width:"181px",height:"32px",padding:"0px, 0px, 0px, 8px",borderRadius:"4px",gap:"4px"},onClick:()=>{var e;if(null!==(e=u.result)&&void 0!==e&&e.length&&u.loggerPageId){const e=u.result.find((e=>void 0!==e.projectCollectionPageId));v.navigate({url:(0,Yd.Z)({pageId:(null==e?void 0:e.projectCollectionPageId)||u.loggerPageId,pageModel:Xd({table:Vt.iU,id:(null==e?void 0:e.projectCollectionPageId)||u.loggerPageId}),baseUrl:Mt.default.domainBaseUrl,pageVisitSource:Gi.tY.Import}),environment:o})}Hd.Z.resetImport(),ci.Z.reset()},children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.confirm.viewImportedProjects",defaultMessage:"View imported projects"})})]}):void 0)(b),controlRowPaddingTopBottom:"confirm"===t&&g?0:g?10:20,removeBoxShadow:"confirm"===t&&g,contentPaddingLeftRight:g?25:void 0,controlRowPaddingLeftRight:g?15:void 0,getPaddingTopBottom:g?()=>2:void 0,children:[(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[g?Dc(b):(0,oe.jsx)(oe.Fragment,{}),(0,oe.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,oe.jsx)(oo.Z,{onClick:()=>{s(),Hd.Z.resetImport()},style:x.closeButton,hoveredStyle:x.closeButtonHover,children:(0,Pd.D)(x.closeButtonIcon)})})]}),Rc(b),(0,oe.jsx)(at.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:m.Z.fontWeight.medium,width:"100%"},children:Ac(b)}),(e=>"selectData"===e?(0,oe.jsx)(jc,{}):"importingData"===e?(0,oe.jsx)(Zc,{assetSrc:Qd.Z.images.import.asanaPng}):"confirm"===e?(0,oe.jsx)(yc,{}):"failure"===e?(0,oe.jsx)(Pc,{assetSrc:Qd.Z.images.import.asanaPng,loggerPageId:u.loggerPageId,failedMessage:n.formatMessage(Fc.failed)}):"chooseWorkspace"===e?(0,oe.jsx)(mc,{}):"importComplete"===e?(0,oe.jsx)(bc,{}):void 0)(b)]})};const Lc=function(e){let{fetchActiveImportTasks:t}=e;window.__c={n:"AsanaImportModal"};const s=(0,a.VK)((()=>Hd.Z.state),[]);return(0,oe.jsx)(Mo.Z,{open:s.isModalOpen,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>(0,oe.jsx)(So.Z,{capture:!0,allowEsc:!0,render:()=>(0,oe.jsx)(bo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>(()=>{const{currentTab:e}=s;return(0,oe.jsx)(Bc,{fetchActiveImportTasks:t,tab:e})})()})}),onDismiss:()=>{Hd.Z.resetImport()}})};var Nc=s(3666),Oc=s(69122),Ec=s(61397);const Vc=function(){window.__c={n:"MondayImportStepConfirmTab"};const e=(0,a.VK)((()=>Oc.Z.state),[]);return e.result?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(at.Z,{isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"mondayImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,oe.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,oe.jsx)(Uc,{importStatus:e},e.mondayFolderId)))})]}):(0,oe.jsx)(oe.Fragment,{})};function Uc(e){let{importStatus:t}=e;window.__c={n:"CollapsibleMondayProjectsTable"};const s=(0,Je.Fg)(),[n,r]=(0,i.useState)(!1),l=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),d=(0,a.VK)((()=>Oc.Z.state.mondayFoldersAndBoards),[]),c=(0,a.VK)((()=>ie.default.state.currentSpaceViewStore),[]),u=(0,a.VK)((()=>{if(!c)return;const e=c.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,oe.jsx)(yn.p,{disabled:!0,store:e})})));return l?(e||[]).concat({id:c.id,name:"Private",icon:(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:et.FN.light.gray[75]},children:(0,o.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[c,l,s]),{notionTeamspaceName:m,notionTeamspaceIcon:g}=(0,i.useMemo)((()=>{const e=null==u?void 0:u.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[u,t]),h=(0,i.useMemo)((()=>{const e=d.find((e=>e.folderId===t.mondayFolderId));return null==e?void 0:e.folderName}),[d,t]);return(0,oe.jsxs)(dc.gq,{style:{marginTop:16},children:[(0,oe.jsx)(an.Z,{ariaLabel:"collapse toggle",icon:rc.L,onClick:()=>r((e=>!e)),style:{transform:n?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),(0,oe.jsx)(uc.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,oe.jsx)(dc.gq,{alignItems:"center",gap:2,children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:h})}),style:{width:300}},{key:"importedInto",header:(0,oe.jsxs)(dc.gq,{gap:4,children:[(0,oe.jsxs)(dc.gq,{style:{alignItems:"center",gap:4},children:[(0,oe.jsx)(at.Z,{isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"mondayImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,nc.n)({width:12})]}),(0,oe.jsxs)(dc.gq,{style:{alignItems:"center",gap:4},children:[g,m]})]}),style:{width:300}}],rows:function(e){let{collapsed:s}=e;return s?[]:t.projects.map((e=>({key:e.projectId,columns:[(0,oe.jsxs)(dc.gq,{gap:8,alignItems:"center",children:[(0,fc.r)({width:12,color:et.FN.dark.green[600]}),(0,oe.jsx)(at.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId)]})))}({collapsed:n})})]})}const Wc=function(){window.__c={n:"MondayImportStepSelectDataTab"};const e=(0,T.O7)(),t=(0,p.useIntl)(),s=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),n=(0,a.VK)((()=>Oc.Z.getState()),[]),{workspaces:o,selectedWorkspace:r,mondayFoldersAndBoards:l}=n;return(0,i.useEffect)((()=>{r&&Ec.IO({environment:e,spaceId:null==s?void 0:s.id,selectedWorkspace:r}).catch((()=>{}))}),[r,e,null==s?void 0:s.id]),(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(at.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,oe.jsx)(p.FormattedMessage,{id:"mondayImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,oe.jsx)(zc,{onSelectOption:e=>{Oc.Z.setState({...n,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:o.map((e=>({key:e.id,label:e.name}))),currentOption:n.selectedWorkspace,placeHolder:t.formatMessage({id:"mondayImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),n.selectedWorkspace?(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.semibold,marginTop:18},children:(0,oe.jsx)(p.FormattedMessage,{id:"mondayImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,oe.jsx)(oe.Fragment,{}),n.isLoadingProjects?(0,oe.jsxs)(dc.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,oe.jsx)(Ti.Z,{style:{fontSize:12}}),(0,oe.jsx)(at.Z,{isSmall:!0,style:{color:et.FN.light.gray[400]},children:(0,oe.jsx)(p.FormattedMessage,{id:"mondayImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):l.map((e=>(0,oe.jsx)(Kc,{mondayFolderAndBoards:e},`${e.folderId}-table`)))]})};function Kc(e){var t;let{mondayFolderAndBoards:s}=e;window.__c={n:"CollapsibleMondayProjectsTable"};const n=(0,p.useIntl)(),r=(0,Je.Fg)(),[l,d]=(0,i.useState)(!1),[c,u]=(0,i.useState)(),g=(0,a.VK)((()=>Oc.Z.getState()),[]),h=(0,a.VK)((()=>ie.default.state.currentSpaceViewStore),[]),f=(0,a.VK)((()=>{const e=null==h?void 0:h.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,oe.jsx)(yn.p,{disabled:!0,store:e})})))}),[h]);(0,i.useEffect)((()=>{if(!f||!h)return;if(!g.selectedProjectsAndTeamspaces[s.folderId]){u("private"),Ec.eL({folderId:s.folderId,spaceId:null==h?void 0:h.id});for(const i of f){var e,t;if((null===(e=i.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.folderName)||void 0===t?void 0:t.toLowerCase())){u(i.id),Ec.eL({folderId:s.folderId,spaceId:i.id});break}}}}),[f,s,h,g.selectedProjectsAndTeamspaces]);const y=(0,i.useCallback)((e=>{Ec.eL({folderId:s.folderId,spaceId:e}),u(e)}),[s.folderId]),x=(0,i.useCallback)((e=>{if("create"===e)return void lc.lo("monday_importer",{onClose:y});let t;if("private"===e){if(null==h||!h.id)return;t=h.id}else t=e;Ec.eL({folderId:s.folderId,spaceId:t}),u(e)}),[null==h?void 0:h.id,s.folderId,y]),v=[{key:"private",searchTerm:"private",label:(0,oe.jsxs)(dc.gq,{alignItems:"center",style:{gap:8},children:[(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:et.FN.light.gray[75]},children:(0,o.Q)({color:r.mediumIconColor,width:12.5,height:12.5})}),(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.regular},children:(0,oe.jsx)(p.FormattedMessage,{id:"mondayImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];return f&&v.push(...f.map((e=>({key:e.id,searchTerm:e.name,label:(0,oe.jsxs)(dc.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),v.push({key:"create",searchTerm:"New teamspace",label:(0,oe.jsxs)(dc.gq,{alignItems:"center",style:{gap:4},children:[(0,oc.f)({color:r.mediumIconColor,width:16,height:16}),(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"mondayImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,oe.jsxs)(dc.gq,{style:{marginLeft:-18},children:[(0,oe.jsx)(an.Z,{ariaLabel:"collapse toggle",icon:rc.L,onClick:()=>d((e=>!e)),style:{transform:l?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,oe.jsx)(uc.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:2,children:[(0,oe.jsx)(nt.Z,{style:{marginRight:4,height:14},checked:(()=>{const e={...g.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}};return Boolean(e.isEntireFolderSelected)})(),size:14,checkSize:8,onClick:()=>{const e={...g.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}},{notionTeamspaceId:t,isEntireFolderSelected:i}=e;let n,a;if(i)n=[],a=!1;else{n=[...s.projects.map((e=>({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}))),...s.taskBoards.map((e=>({name:e.name,mondayProjectId:e.id,collectionType:"tasks"})))],a=!0}Oc.Z.setState({...g,selectedProjectsAndTeamspaces:{...g.selectedProjectsAndTeamspaces,[s.folderId]:{notionTeamspaceId:t,projects:n,isEntireFolderSelected:a}}})}}),(0,oe.jsx)(at.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.folderName})]}),style:{width:300}},{key:"importInto",header:(0,oe.jsxs)(dc.gq,{style:{alignItems:"center"},children:[(0,oe.jsx)("div",{children:(0,oe.jsx)(p.FormattedMessage,{id:"mondayImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,oe.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,nc.n)({width:12})}),(0,oe.jsxs)(dc.gq,{style:{alignItems:"center",gap:8},children:[(0,oe.jsx)("img",{src:Qd.Z.emails.notionLogoBlackSmallPng,height:18}),(0,oe.jsx)(zc,{options:v,onSelectOption:x,currentOption:null===(t=v.find((e=>e.key===c)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:n.formatMessage({id:"mondayImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const i=s.projects.map((e=>({key:e.id,columns:[(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,oe.jsx)(nt.Z,{style:{marginRight:2},onClick:()=>{const t={...g.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:i,projects:n}=t;let a;a=n.find((t=>t.mondayProjectId===e.id))?n.filter((t=>t.mondayProjectId!==e.id)):n.concat({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}),Oc.Z.setState({...g,selectedProjectsAndTeamspaces:{...g.selectedProjectsAndTeamspaces,[s.folderId]:{notionTeamspaceId:i,projects:a}}})},checked:{...g.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,oe.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,oe.jsx)(at.Z,{isMultiline:!0,children:e.name})})]},`${e.id}-container`)]}))),n=s.taskBoards.map((e=>({key:e.id,columns:[(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,oe.jsx)(nt.Z,{style:{marginRight:2},onClick:()=>{const t={...g.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:i,projects:n}=t;let a;a=n.find((t=>t.mondayProjectId===e.id))?n.filter((t=>t.mondayProjectId!==e.id)):n.concat({name:e.name,mondayProjectId:e.id,collectionType:"tasks"}),Oc.Z.setState({...g,selectedProjectsAndTeamspaces:{...g.selectedProjectsAndTeamspaces,[s.folderId]:{notionTeamspaceId:i,projects:a}}})},checked:{...g.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,oe.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,oe.jsx)(at.Z,{isMultiline:!0,children:e.name})})]},`${e.id}-container`)]})));return[...i,...n]}({collapsed:l})})]})}function zc(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:n,currentOption:a,placeHolder:o,narrow:r,allowSearch:l}=e,d=(0,p.useIntl)(),[c,u]=(0,i.useState)(""),g=null===(t=n.find((e=>{let{key:t}=e;return t===a})))||void 0===t?void 0:t.label,h=(0,Je.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,placementToOrigin:nn.pO.Bottom,renderOrigin:e=>(0,oe.jsxs)(ve.Z,{...e,style:{paddingTop:r?2:8,paddingBottom:r?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${et.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:a?void 0:et.FN.light.gray[50],color:a?void 0:et.FN.light.gray[300]},disabled:!1,children:[(0,oe.jsx)(at.Z,{style:{textOverflow:"ellipsis"},children:g||o}),(0,Jn.i)(h.icon)]}),render:e=>{const t={menuType:se.og.Popup,width:250,left:50},i=[{key:"mondayImport.dropdown.menuList",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:(c.trim()?n.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase())})):n).map((t=>{let{key:i,label:n}=t;return{key:i,action:()=>{s(i),e.close()},render:e=>(0,oe.jsx)(Y.Z,{...e,title:n,shouldWrapCaption:!0,right:g===n?(0,oe.jsx)("div",{style:{width:14},children:(0,ac.e)()}):void 0})}}))}];return(0,oe.jsxs)(oe.Fragment,{children:[l?(0,oe.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:et.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${et.FN.light.gray[100]}`,justifyContent:"space-between",background:et.FN.light.gray[50],fontSize:m.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:d.formatMessage({id:"mondayImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>u(e.target.value),value:c}):(0,oe.jsx)(oe.Fragment,{}),(0,oe.jsx)($.Z,{...t,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}const qc=(0,p.defineMessages)({failed:{defaultMessage:"Some problems occurred while importing data from your Monday workspace.",id:"Mondayimport.importingData.failed.problemsOccured"}});function Gc(e){switch(e){case"selectData":return(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.semibold},children:(0,oe.jsx)(p.FormattedMessage,{id:"MondayImport.importsTab.selectData.tabTitle",defaultMessage:"Select Monday.com workspace"})});default:return(0,oe.jsx)(oe.Fragment,{})}}const Hc=function(e){let{tab:t,fetchActiveImportTasks:s}=e;window.__c={n:"MondayImportStepTab"};const n=D.default.getIntl(),o=(0,T.O7)(),r=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),l=(0,a.VK)((()=>ie.default.state.currentSpaceViewStore),[]),c=(0,a.VK)((()=>ic.Z.state.teams),[]),u=(0,a.VK)((()=>Oc.Z.state),[]),g=(0,a.VK)((()=>Qs.Z.state),[]).flowId||(0,d.ZP)(),{workspaces:h}=u,f=(0,i.useCallback)((()=>Object.values(u.selectedProjectsAndTeamspaces).some((e=>0!==e.projects.length))),[u.selectedProjectsAndTeamspaces]),y=(0,Je.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,oe.jsxs)(wi.Z,{controlRow:(e=>"selectData"===e?(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,oe.jsx)(St.Z,{style:{border:0},disabled:!h.length,onClick:()=>{s(),Oc.Z.resetImport()},children:(0,oe.jsx)(p.FormattedMessage,{id:"mondayImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,oe.jsx)(dc.gq,{alignItems:"center",gap:8,children:(0,oe.jsx)(Q.Z,{style:{marginLeft:16},disabled:!f()||u.templateCreationInProgress,onClick:()=>{r&&l&&Ec.C8({environment:o,spaceStore:r,currentSpaceViewStore:l,teamsStores:c,flowId:g}).catch((()=>{}))},children:u.templateCreationInProgress?(0,oe.jsxs)(dc.gq,{alignItems:"center",gap:2,children:[(0,oe.jsx)(Ti.Z,{isWhite:!0}),(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})})})]}):"importingData"===e?(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,oe.jsx)(St.Z,{disabled:!h.length,onClick:()=>{s(),Oc.Z.resetImport()},children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"confirm"===e?(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,oe.jsx)(Q.Z,{onClick:()=>{u.loggerPageId&&v.navigate({url:(0,Yd.Z)({pageId:u.loggerPageId,pageModel:Xd({table:Vt.iU,id:u.loggerPageId}),baseUrl:Mt.default.domainBaseUrl,pageVisitSource:Gi.tY.Import}),environment:o}),Oc.Z.resetImport(),ci.Z.reset()},children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,oe.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,oe.jsx)(St.Z,{disabled:!h.length,onClick:()=>{s(),Oc.Z.resetImport()},children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):void 0)(t),controlRowPaddingTopBottom:20,children:[(0,oe.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,oe.jsx)(oo.Z,{onClick:()=>{s(),Oc.Z.resetImport()},style:y.closeButton,hoveredStyle:y.closeButtonHover,children:(0,Pd.D)(y.closeButtonIcon)})}),(0,oe.jsx)(at.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:m.Z.fontWeight.medium,width:"100%"},children:Gc(t)}),(e=>"selectData"===e?(0,oe.jsx)(Wc,{}):"importingData"===e?(0,oe.jsx)(Zc,{assetSrc:Qd.Z.images.import.mondayPng}):"confirm"===e?(0,oe.jsx)(Vc,{}):"failure"===e?(0,oe.jsx)(Pc,{assetSrc:Qd.Z.images.import.mondayPng,loggerPageId:u.loggerPageId,failedMessage:n.formatMessage(qc.failed)}):void 0)(t)]})};const Qc=function(e){let{fetchActiveImportTasks:t}=e;window.__c={n:"MondayImportModal"};const s=(0,a.VK)((()=>Oc.Z.state),[]);return(0,oe.jsx)(Mo.Z,{open:s.isModalOpen,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>(0,oe.jsx)(So.Z,{capture:!0,allowEsc:!0,render:()=>(0,oe.jsx)(bo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>(()=>{const{currentTab:e}=s;return(0,oe.jsx)(Hc,{fetchActiveImportTasks:t,tab:e})})()})}),onDismiss:()=>{Oc.Z.resetImport()}})};const Yc=function(e){window.__c={n:"ImportsTab"};const t=(0,a.VK)((()=>ie.default.state),[]),s=(0,a.VK)((()=>Hd.Z.state),[]),{currentSpaceStore:n,mainEditorCurrentBlockStore:o,currentSpaceViewStore:r,currentUserSettingsStore:d}=t,c=(0,T.O7)(),{device:u}=(0,T.O7)(),[m,g]=(0,i.useState)([]),h=(0,i.useCallback)((async()=>{if(null==n||!n.id)return;const e=await M.getActiveImportTasks(c,{spaceId:n.id});"success"===e.type&&g(e.data)}),[n,c]);return(0,i.useEffect)((()=>{h().catch((()=>{}));const e=setInterval(h,6e4);return()=>clearInterval(e)}),[n,c,h]),(0,i.useEffect)((()=>{let e;const t=async s=>{const n=await M.getAsanaWorkspacesNames(c,{});if(s+=1,"success"===n.type)if(null!=n&&n.data.account)Hd.Z.setState({...Hd.Z.state,account:n.data.account,workspaces:n.data.workspaces,isLoadingAsanaWorkspaces:!1,isAccountLinkingInProgress:!1,currentTab:"selectData",isModalOpen:!0});else{if(s>i)return;e=setTimeout((()=>t(s)),2e3)}},i=180;if(s.isAccountLinkingInProgress){t(0).catch((()=>{}))}return()=>{clearTimeout(e)}}),[s.isAccountLinkingInProgress,c]),n&&r&&r&&d?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(bt.Z,{large:!u.isMobile||void 0,divider:u.isMobile?void 0:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.title",defaultMessage:"Import data"})}),(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.subtitle",defaultMessage:"Import data from other apps and files into Notion"})}),(0,oe.jsx)(at.Z,{isSmall:!0,children:e.genericImporterEnabled?(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.unsupportedImportsHelperTextForUniversalImport",defaultMessage:"If the app you’re using isn’t listed below, try the <boldtext>Universal import</boldtext> ",values:{boldtext:e=>(0,oe.jsx)("span",{style:{fontWeight:600},children:e})}}):(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.unsupportedImportsHelperText",defaultMessage:"If your data is located somewhere we don't support yet, you can try importing it via CSV file."})}),(0,oe.jsxs)("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[(0,oe.jsx)(Nc.Z,{pageStore:o,spaceStore:n,spaceViewStore:r,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>{v.navigateToBlock({environment:c,store:e,pageVisitSource:Gi.tY.Import}),ci.Z.reset()},readOnlyCreditButton:!1}),(0,oe.jsx)(Lc,{fetchActiveImportTasks:h}),(0,oe.jsx)(Qc,{fetchActiveImportTasks:h})]}),(0,oe.jsxs)("div",{style:{marginTop:32},children:[(0,oe.jsx)(at.Z,{isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.activeImports.title",defaultMessage:"Active Imports"})}),(0,oe.jsx)(uc.Z,{tableStyle:{borderTop:0},columns:[{key:"importTime",header:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.activeImports.importTime",defaultMessage:"Import time"})},{key:"importFrom",header:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.activeImports.importFrom",defaultMessage:"Import from"})},{key:"importStatus",header:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.activeImports.importStatus",defaultMessage:"Status"})}],rows:m.map((e=>({key:`table-${e.taskId}`,columns:[e.startedAt?`${(0,Dt.Yx)(e.startedAt,"long",D.default.getIntl().locale)} ${(0,Dt.Yx)(e.startedAt,"time",D.default.getIntl().locale)}`:"",(0,l.kC)(e.source),(0,oe.jsx)(qn.Z,{isRound:!0,showRemoveButton:!1,value:(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"activeImports.status.inProgress",defaultMessage:"In progress"})}),backgroundColor:et.FN.light.blue[200],showColoredDot:"blue",format:Vn.lo.Small,isSingle:!0},`progress-${e.taskId}`)]})))}),m.length?(0,oe.jsx)(oe.Fragment,{}):(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginTop:16},children:(0,oe.jsx)(p.FormattedMessage,{id:"importsTab.activeImportsTable.noActiveImports",defaultMessage:"There are no ongoing imports associated with your account."})})]})]}):(0,oe.jsx)(oe.Fragment,{})};var $c=s(79092),Jc=s(54153),Xc=s(47839),eu=s(5315),tu=s(57222),su=s(65680),iu=s(31194);class nu extends n.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:en.Z},this.handleSelectChange=e=>{const{label:t}=ou(e,this.props.intl);if(this.props.confirm){const s=()=>{this.props.onChange(e)};y.showDialog({showCancel:!0,keepFocus:!1,message:(0,oe.jsx)(p.FormattedMessage,{id:"languagePicker.changeLanguage.confirmationMessage",defaultMessage:"Are you sure you want to update the language to {language}?",values:{language:t}}),items:[{label:(0,oe.jsx)(p.FormattedMessage,{id:"languagePicker.changeLanguage.updateButton.label",defaultMessage:"Update"}),color:"red",onAccept:s}]})}else this.props.onChange(e)}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const t="ja-JP"===this.props.currentLocale&&lt.default.checkGate("japan_full_launch");return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(ve.Z,{style:{marginLeft:-8,paddingLeft:8,paddingRight:8},...e,children:[this.props.pickerLabel?this.props.pickerLabel:ou(this.props.currentLocale,this.props.intl).label,(0,su.ay)(this.props.currentLocale)&&!t&&(0,oe.jsx)(qe.Z,{desktopStyle:{marginLeft:4},children:(0,oe.jsx)(p.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})}),(0,Jn.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]})}),placementToOrigin:iu.Iw.Bottom,alignmentToOrigin:iu.lU.Start,render:e=>{let t;t=lt.default.checkGate("polyglot")?[...su.tp,...su.is]:[...su.tp];const s=[{key:"languages",render:e=>(0,oe.jsx)(ee.Z,{...e,topBorder:0!==e.index}),items:t.map((t=>({key:t,render:e=>this.getItem(t,e.focused,e),action:()=>{this.handleSelect(t),e.close()}})))}],i={menuType:se.og.Popup,width:240};return(0,oe.jsx)($.Z,{className:zs.hKO,...i,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:void 0,sections:s})})}})}renderItem(e){const t="ja-JP"===e.locale&&lt.default.checkGate("japan_full_launch");return(0,oe.jsx)(Y.Z,{...e.props,title:(0,oe.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,oe.jsx)("div",{style:{...e.style,marginRight:0},children:e.label})}),caption:e.caption&&(0,oe.jsx)("span",{style:{color:this.theme.mediumTextColor},children:e.caption}),shouldWrapCaption:!0,right:(0,su.ay)(e.locale)&&!t&&(0,oe.jsx)(qe.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})})})}handleSelect(e){this.props.currentLocale!==e&&this.handleSelectChange(e)}getItem(e,t,s){return this.renderItem({...ou(e,this.props.intl),focused:t,props:s,locale:e})}}nu.displayName="LanguagePicker";const au=(0,p.injectIntl)(nu);function ou(e,t){return(0,tu.t)(t)[e]}const ru=function(e){window.__c={n:"LanguageSettings"};const t=(0,T.O7)(),{device:s,WindowSizeStore:i}=t,n=(0,a.VK)((()=>i.state.paddingLeftCSS),[i]),o=(0,a.VK)((()=>i.state.paddingRightCSS),[i]);return(0,oe.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:s.isMobile?n:0,paddingRight:s.isMobile?o:0},children:(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,oe.jsxs)("div",{style:{flex:1},children:[(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"languageRegionSettings.language.label",defaultMessage:"Language"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"languageSettings.languageSwitcher.subtitle",defaultMessage:"Change the language used in the user interface."})})]}),(0,oe.jsx)(au,{confirm:!0,onChange:async e=>{f.A01(t,{locale:e});const s=await M.setLocale(t,{locale:e});"success"===s.type?(Jc.Z.set("preferredLocale",e),await eu.transactionQueue.drain(),t.device.isElectron?Xc.refreshAll({includeFocusedWindow:!0}):window.location.reload(!0)):y.showError(s)},currentLocale:e.locale})]})})};var lu=s(32056);function du(e){var t;return(null==e||null===(t=e.getSettingsStore())||void 0===t||null===(t=t.getKeyStore("regional_format_settings"))||void 0===t?void 0:t.getKeyStore("region").getValue())||"US"}function cu(e,t){var s;const i=null==e||null===(s=e.getKeyStore("settings"))||void 0===s||null===(s=s.getKeyStore("regional_format_settings"))||void 0===s?void 0:s.getValue();return"full_date"===t?null!=i&&i.use_default_region_settings?uu(du(e)):(null==i?void 0:i.full_date)||uu(du(e)):"short_date"===t?null!=i&&i.use_default_region_settings?{type:"short"}:(null==i?void 0:i.short_date)||{type:"short"}:"number"===t?null!=i&&i.use_default_region_settings?"number":(null==i?void 0:i.number)||"number":"week_start_on"===t?null!=i&&i.use_default_region_settings?"sunday":(null==i?void 0:i.week_start_on)||"sunday":(0,me.t1)(t)}function uu(e){return"JP"===e?{type:"short"}:{type:"long"}}const mu={full_date:(0,p.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,p.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,p.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,p.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})},pu=(0,p.defineMessages)({full_date:{defaultMessage:"Full date",id:"regionalFormatSettings.defaultSetting.fullDate"},short_date:{defaultMessage:"Short date",id:"regionalFormatSettings.defaultSetting.shortDate"},number:{defaultMessage:"Numbers",id:"regionalFormatSettings.defaultSetting.numbers"},week_start_on:{defaultMessage:"Week starts",id:"regionalFormatSettings.defaultSetting.weekStart"}});function gu(e,t){if("full_date"===t){return mu[t][cu(e,t).type]}if("short_date"===t){return mu[t][cu(e,t).type]}if("number"===t){return mu[t][cu(e,t)]}if("week_start_on"===t){return mu[t][cu(e,t)]}return(0,me.t1)(t)}function hu(e,t){return(0,lu.uf)(1234567,e,t)}const fu=(0,p.defineMessages)({sunday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.sunday",defaultMessage:"Sunday"},monday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.monday",defaultMessage:"Monday"}});function yu(e,t){const s=e.type;return"short"===s||"long"===s||"medium"===s?(0,Dt.Yx)(Date.now(),s,(0,xr.E2)(t)):"iso"===s?(0,Dt.$6)(Date.now()):(0,Dt.Yx)(Date.now(),"long",(0,xr.E2)(t))}function xu(e,t){const s=e.type;return"iso"===s?(0,Dt.$6)(Date.now()):"short"===s?(0,Dt.Yx)(Date.now(),s,(0,xr.E2)(t)):(0,Dt.Yx)(Date.now(),"short",(0,xr.E2)(t))}var vu=s(68894),Su=s(42782);const bu={full_date:(0,p.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,p.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,p.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,p.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})};function Mu(e){window.__c={n:"CustomRegionalFormatSettingPicker"};const[,,t]=(0,a.AF)(void 0,en.Z),s=(0,Je.Fg)(),[i,n]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),gu(e.userSettingsStore,e.option)]),[e.option,e.userSettingsStore]);return i?(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,oe.jsxs)(ve.Z,{...e,children:[D.default.formatMessage(n),(0,Jn.i)({width:10,marginLeft:4,fill:s.lightIconColor})]}),placementToOrigin:iu.Iw.Bottom,alignmentToOrigin:iu.lU.Start,render:t=>"week_start_on"===e.option||"number"===e.option?(0,oe.jsx)(ju,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):"full_date"===e.option||"short_date"===e.option?(0,oe.jsx)(wu,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):(0,me.t1)(e.option)}):(0,oe.jsx)(Ti.Z,{})}function ju(e){window.__c={n:"SimpleFormatPicker"};const t=(0,T.O7)(),s=(0,p.useIntl)();return(0,oe.jsx)($.Z,{menuType:se.og.Popup,width:216,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,oe.jsx)(ee.Z,{...e,topBorder:0!==e.index}),items:(0,me.Yd)(bu[e.option]).map((i=>({key:i,render:t=>{const n="number"===e.option?hu(i,s):void 0;return(0,oe.jsx)(Y.Z,{...t,title:D.default.formatMessage(bu[e.option][i]),caption:n})},action:()=>{C.createAndCommit({userAction:"CustomRegionalFormatSettings.SimpleFormatPicker",environment:t,perform:t=>{k.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:du(e.userSettingsStore),[e.option]:i}},transaction:t})}}),e.onAccept()}})))}]})})}function wu(e){window.__c={n:"CustomizableFormatPicker"};const t=(0,T.O7)(),[s,n]=(0,i.useState)((()=>{})),a=(0,p.useIntl)(),o=(0,me.Yd)(bu[e.option]),r=i=>{const n="custom"===i?{type:i,format:s}:{type:i};C.createAndCommit({userAction:"CustomRegionalFormatSettings.onAction",environment:t,perform:t=>{k.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:du(e.userSettingsStore),[e.option]:n}},transaction:t})}}),e.onAccept()};return(0,oe.jsx)($.Z,{menuType:se.og.Popup,width:216,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,oe.jsx)(ee.Z,{...e,topBorder:0!==e.index}),items:o.map((t=>({key:t,render:i=>{if("custom"===t)return(0,oe.jsx)(Su.Z,{...i,renderOrigin:s=>(0,oe.jsx)(Y.Z,{...s,title:D.default.formatMessage(bu[e.option][t])}),onFocus:()=>{},renderExtension:()=>(0,oe.jsx)(Cu,{customFormat:s,onChange:e=>{n(e)},onAccept:()=>{r(t)}}),title:D.default.formatMessage(bu[e.option][t])});{const s="full_date"===e.option?yu({type:t},a):xu({type:t},a);return(0,oe.jsx)(Y.Z,{...i,title:D.default.formatMessage(bu[e.option][t]),caption:s})}},action:()=>{r(t)}})))}]})})}function Cu(e){window.__c={n:"CustomDateFormatExtension"};const t=(0,Je.yK)((e=>({container:{},label:{color:e.mediumTextColor,fontWeight:m.Z.fontWeight.semibold,paddingTop:6,paddingBottom:6,paddingLeft:14,paddingRight:14},actionButton:{marginTop:6}})),[]);return(0,oe.jsxs)("div",{style:t.container,children:[(0,oe.jsx)("div",{children:(0,oe.jsx)(at.Z,{isSmall:!0,style:t.label,children:(0,oe.jsx)(p.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.title",defaultMessage:"Custom format"})})}),(0,oe.jsx)(vu.ZP,{focus:!0,value:e.customFormat||"",onChange:t=>{e.onChange(t.target.value)}}),(0,oe.jsx)(Y.Z,{style:t.actionButton,focused:!1,onClick:e.onAccept,title:(0,oe.jsx)(p.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.applyChanges",defaultMessage:"Apply changes"})})]})}function ku(e){window.__c={n:"RegionalFormatSettings"};const t=(0,Je.yK)((()=>({container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]),s=(0,a.VK)((()=>e.userSettingsStore.isReady()),[e.userSettingsStore]),i=(0,a.VK)((()=>e.userSettingsStore.shouldUseDefaultRegionalFormatting()),[e.userSettingsStore]),n=(0,T.O7)();return s?(0,oe.jsxs)("div",{style:t.container,children:[(0,oe.jsxs)("div",{style:t.controlRow,children:[(0,oe.jsxs)("div",{style:t.label,children:[(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"regionalFormatSettings.label.title",defaultMessage:"Use regional defaults"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"regionalFormatSettings.label.subtitle",defaultMessage:"Automatically apply standard formats of your region"})})]}),(0,oe.jsx)(jr.Z,{on:i,onClick:()=>{C.createAndCommit({userAction:"RegionalFormatSettings.RegionalFormatSettings",environment:n,perform:t=>{const s=i?{use_default_region_settings:!1,full_date:void 0,short_date:void 0,time:void 0,number:void 0,week_start_on:void 0}:{use_default_region_settings:!0};k.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{region:du(e.userSettingsStore),...s}},transaction:t})}})}})]}),(0,oe.jsx)("div",{children:i?(0,oe.jsx)(Tu,{userSettingsStore:e.userSettingsStore}):(0,oe.jsx)(Zu,{userSettingsStore:e.userSettingsStore})})]}):(0,oe.jsx)(Ti.Z,{})}function Tu(e){window.__c={n:"DefaultRegionalFormatSettings"};const t=(0,Je.yK)((()=>({container:{marginTop:12}})),[]);return(0,oe.jsx)("div",{style:t.container,children:_u.map((t=>(0,oe.jsx)(Iu,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function Iu(e){window.__c={n:"DefaultRegionalFormatSetting"};const t=(0,Je.yK)((e=>({container:{display:"flex"},option:{color:e.lightTextColor,fontSize:m.Z.fontSize.UIRegular.desktop,width:100},example:{color:e.mediumTextColor,fontSize:m.Z.fontSize.UIRegular.desktop}})),[]),s=(0,p.useIntl)(),[i,n]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),Pu(e.userSettingsStore,s,e.option)]),[s,e.option,e.userSettingsStore]);return i?(0,oe.jsxs)("div",{style:t.container,children:[(0,oe.jsx)("div",{style:t.option,children:D.default.formatMessage(pu[e.option])}),(0,oe.jsx)("div",{style:t.example,children:n})]}):(0,oe.jsx)(Ti.Z,{})}function Pu(e,t,s){if("full_date"===s){return yu(cu(e,s),t)}if("short_date"===s){return xu(cu(e,s),t)}if("number"===s){return hu(cu(e,s),t)}if("week_start_on"===s){return function(e){return"sunday"===e?D.default.formatMessage(fu.sunday):"monday"===e?D.default.formatMessage(fu.monday):(0,me.t1)(e)}(cu(e,s))}return(0,me.t1)(s)}const _u=["full_date","short_date","number","week_start_on"];function Zu(e){return(0,oe.jsx)("div",{children:_u.map((t=>(0,oe.jsx)(Fu,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function Fu(e){window.__c={n:"CustomRegionalFormatSetting"};const t=(0,p.useIntl)(),[s,i,n]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),du(e.userSettingsStore),Pu(e.userSettingsStore,t,e.option)]),[t,e.option,e.userSettingsStore]),o=(0,Je.yK)(Au,[]);return s?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(ro.Z,{size:24}),(0,oe.jsx)("div",{style:o.container,children:(0,oe.jsxs)("div",{style:o.controlRow,children:[(0,oe.jsxs)("div",{style:o.label,children:[(0,oe.jsx)(at.Z,{children:D.default.formatMessage(pu[e.option])}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:o.subtitle,children:n})]}),(0,oe.jsx)(Mu,{userSettingsStore:e.userSettingsStore,region:i,option:e.option})]})})]}):(0,oe.jsx)(Ti.Z,{})}function Au(){return{container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}}var Ru=s(80994);function Du(e){window.__c={n:"RegionSettings"};const t=(0,Je.yK)((()=>({container:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]);return(0,oe.jsxs)("div",{style:t.container,children:[(0,oe.jsxs)("div",{style:t.label,children:[(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"regionSettings.region.label",defaultMessage:"Region"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"regionSettings.region.subtitle",defaultMessage:"Affects the default formats for dates, numbers, and currencies"})})]}),(0,oe.jsx)(Bu,{userSettingsStore:e.userSettingsStore,onChange:e.onChange,pickerLabel:e.pickerLabel})]})}function Bu(e){window.__c={n:"RegionPicker"};const t=(0,Je.Fg)(),[,,s]=(0,a.AF)(void 0,en.Z),n=(0,a.VK)((()=>du(e.userSettingsStore)),[e.userSettingsStore]),[o,r]=i.useState("");return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,buttonPopupStore:s,renderOrigin:s=>(0,oe.jsxs)(ve.Z,{...s,children:[e.userSettingsStore?n:e.pickerLabel,(0,Jn.i)({width:10,marginLeft:4,fill:t.lightIconColor})]}),placementToOrigin:iu.Iw.Bottom,alignmentToOrigin:iu.lU.Start,render:t=>(0,oe.jsx)($.Z,{menuType:se.og.Popup,width:216,header:(0,oe.jsx)(Nu,{value:o,onChange:e=>r(e)}),children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:void 0,sections:[{key:"regions",render:e=>(0,oe.jsx)(ee.Z,{...e,topBorder:0!==e.index}),items:(0,st.ZP)(o,Ru.hW,(e=>e.name)).map((s=>({key:s.countryCode,render:e=>(0,oe.jsx)(Y.Z,{...e,title:s.name}),action:()=>{e.onChange(s.countryCode),t.close(),r("")}})))}]})})})}const Lu=(0,p.defineMessages)({regionSearchPlaceholder:{defaultMessage:"Search for a region...",id:"settings.regionSettings.regionSearch"}});function Nu(e){return(0,oe.jsx)(ee.Z,{isInput:!0,children:(0,oe.jsx)(vu.ZP,{value:e.value,onChange:t=>{e.onChange(t.target.value)},focus:!0,placeholder:D.default.formatMessage(Lu.regionSearchPlaceholder),focusAfterAnimation:!0})})}var Ou=s(758),Eu=s(77058),Vu=s(91155);const Uu=function(e){window.__c={n:"SpellcheckerLanguagesPicker"};const[t,s]=i.useState([]),[n,o]=i.useState([]),r=(0,T.O7)(),l=(0,a.qz)(void 0,en.Z),d=(0,Je.yK)((e=>({span:{color:e.mediumTextColor},plainButton:{paddingLeft:8,paddingRight:8,marginLeft:-8},icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function c(e){return n.some((t=>t.code===e.code))}(0,i.useEffect)((()=>{const e=r.SpellCheckStore;e&&!(0,Ou.x)(e)&&(e.getAvailableLanguages().then(s).catch((e=>{Ot.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getAvailableLanguages",error:(0,Vu.Ui)(e)})})),e.getLanguages().then(o).catch((e=>{Ot.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getLanguages",error:(0,Vu.Ui)(e)})})))}),[r]),(0,i.useEffect)((()=>{const e=r.SpellCheckStore;if(!e||(0,Ou.x)(e))return;const t=n.map((e=>{let{code:t}=e;return t}));e.setLanguages(t)}),[n,r.SpellCheckStore]);const u=n.length>0?n.slice(0,3).map((e=>{let{name:t}=e;return t})).join(", ")+(n.length>3?"…":""):(0,oe.jsx)(p.FormattedMessage,{id:"languageRegionSettings.spellchecker.picker.label",defaultMessage:"Select languages"});return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,buttonPopupStore:l,renderOrigin:e=>(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(ve.Z,{style:d.plainButton,...e,children:[u,(0,Jn.i)(d.icon)]})}),placementToOrigin:iu.Iw.Bottom,alignmentToOrigin:iu.lU.Start,render:e=>{const s=[{key:"spellcheckerlanguages",render:e=>(0,oe.jsx)(ee.Z,{...e,topBorder:0!==e.index}),items:t.map((e=>({key:e.code,render:t=>function(e){const t=e.language.name||e.language.code;return(0,oe.jsx)(Y.Z,{...e.props,title:(0,oe.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,oe.jsx)("div",{style:{marginRight:0},children:t})}),shouldWrapCaption:!0,right:c(e.language)?(0,Eu.$)({width:12,height:12}):void 0})}({language:e,props:t}),action:()=>{c(e)?o(n.filter((t=>t.code!==e.code))):o([...n,e])}})))}],i={menuType:se.og.Popup,width:240};return(0,oe.jsx)($.Z,{className:zs.hKO,...i,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:void 0,sections:s})})}})};const Wu=function(e){window.__c={n:"SpellcheckerSettings"};const t=(0,T.O7)();return t.device.isElectron&&t.device.isWindows&&!Ou.x(t.SpellCheckStore)?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(ro.Z,{size:24,isHidden:!0}),(0,oe.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"},children:(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,oe.jsxs)("div",{style:{flex:1},children:[(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"languageRegionSettings.spellchecker.label",defaultMessage:"Spellchecker languages"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"languageSettings.spellcheckerSwitcher.subtitle",defaultMessage:"Change the languages used by the spellchecker."})})]}),(0,oe.jsx)(Uu,{})]})})]}):null};const Ku=function(){return window.__c={n:"LanguageRegionSettings"},(0,a.VK)((()=>ji.Z.state.online),[])?(0,oe.jsx)(qu,{}):(0,oe.jsx)(zu,{})};function zu(){return(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Please go online to manage your language and region.",id:"languageSettings.offline.message"})})})}function qu(){window.__c={n:"Settings"};const e=(0,a.VK)((()=>ie.default.state.currentUserSettingsStore),[]),t=(0,a.VK)((()=>{var t;return(null==e||null===(t=e.getSettings())||void 0===t?void 0:t.preferred_locale)||xr.al}),[e]),s=(0,a.VK)((()=>"on"===lt.default.getGroup("aloha")),[]);return e?(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})}),(0,oe.jsx)(ru,{locale:t,userSettingsStore:e}),(0,oe.jsx)(Wu,{}),(0,oe.jsx)(ro.Z,{size:24}),s?(0,oe.jsxs)("div",{style:{marginTop:12},children:[(0,oe.jsx)(Du,{locale:t,userSettingsStore:e,onChange:e=>{}}),(0,oe.jsx)(ro.Z,{size:24}),(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"languageSettings.formatsSection.title",defaultMessage:"Formats"})}),(0,oe.jsx)(ku,{locale:t,userSettingsStore:e}),(0,oe.jsx)(ro.Z,{size:24})]}):(0,oe.jsx)($c.Z,{})]}):null}var Gu=s(15311),Hu=s(28187),Qu=s(21291),Yu=s(51124),$u=s(97876);function Ju(){window.__c={n:"NotificationSettings"};const{isElectron:e,isMobile:t}=(0,T.Fy)(),s=(0,T.O7)(),i=(0,a.VK)((()=>ji.Z.state.online),[]),n=(0,a.VK)((()=>{const s=(0,Hu.kC)();return function(e){const{isMobile:t,isElectron:s,showSlackNotificationSetting:i}=e;return[{key:"notify_mobile",renderSettingsItem:()=>(0,oe.jsx)(Qu.A,{target:"notify_mobile"})},!t&&s?{key:"notify_desktop",renderSettingsItem:()=>(0,oe.jsx)(Qu.A,{target:"notify_desktop"})}:void 0,i?{key:"notify_slack",renderSettingsItem:()=>(0,oe.jsx)($u.O,{target:"notify_slack"})}:void 0].filter(me.$K)}({isMobile:t,isElectron:e,showSlackNotificationSetting:s})}),[t,e]),o=(0,a.VK)((()=>{var e;return function(e){const{showNotifyEmailAlwaysSetting:t}=e;return[{key:"notify_email",renderSettingsItem:()=>(0,oe.jsx)(Qu.A,{target:"notify_email"})},t?{key:"notify_email_always",renderSettingsItem:()=>(0,oe.jsx)(Qu.A,{target:"notify_email_always"})}:void 0,{key:"notify_email_digest",renderSettingsItem:()=>(0,oe.jsx)(Qu.A,{target:"notify_email_digest"})},{key:"marketing_emails",renderSettingsItem:()=>(0,oe.jsx)(Qu.A,{target:"marketing_emails"})}].filter(me.$K)}({showNotifyEmailAlwaysSetting:(null===(e=ie.default.state.currentSpaceViewStore)||void 0===e?void 0:e.getNotifyEmail())||!1})}),[]),r=(0,a.VK)((()=>s.WindowSizeStore.state.paddingBottomCSS),[s.WindowSizeStore]);return i?(0,oe.jsxs)(wi.Z,{disableScroller:t,children:[(0,oe.jsx)(bt.Z,{large:!t,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"notificationSettings.notificationsSection.title",defaultMessage:"My notifications"})}),(0,oe.jsx)(Yu.O,{items:n}),(0,oe.jsx)(ro.Z,{size:48,isHidden:!0}),(0,oe.jsx)(bt.Z,{large:!t,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"notificationSettings.emailNotificationsSection.title",defaultMessage:"Email notifications"})}),(0,oe.jsx)(Yu.O,{items:o}),(0,oe.jsx)(ro.Z,{size:48,isHidden:!0}),(0,oe.jsx)("div",{style:{marginTop:4,marginBottom:t?r:void 0},children:(0,oe.jsx)(Xr.Z,{title:(0,oe.jsx)(p.FormattedMessage,{id:"myNotificationSettings.helpButton.caption",defaultMessage:"Learn about notifications"}),href:(0,Gs.UY)("guides.notificationSettings"),analyticsFrom:"notifications_settings"})})]}):(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Please go online to manage your notification settings.",id:"myNotificationsSettings.goOnline.prompt"})})})}var Xu=s(11470);function em(e){let{spaceStore:t}=e;const s=(0,T.O7)(),[{status:i,value:n}]=(0,To.r5)((async()=>await async function(e,t){const{spaceId:s}=t,i=await M.getPublishedPagesForUser(e,{spaceId:s});if("failed"===i.type)throw y.showError(i),new Error("Failed to fetch published pages.");return i.data}(s,{spaceId:t.id})),[s,t]);return{loading:"pending"===i,publishedPages:"resolved"===i?ha.PF.create(null==n?void 0:n.recordMap):void 0}}const tm={key:"pages",header:(0,oe.jsx)(p.FormattedMessage,{id:"publishing.publicPages.pageColumn.header",defaultMessage:"Pages"}),style:{width:"50%"}},sm={key:"domain",header:(0,oe.jsx)(p.FormattedMessage,{id:"publishing.publicPages.domainColumn.header",defaultMessage:"Domain"}),style:{width:"50%"}};function im(e){window.__c={n:"PublishingSettingsTab"};const{spaceStore:t}=e,s=(0,a.VK)((()=>t),[t]),i=(0,a.VK)((()=>`${s.getPublicContentDomain()}.${Mt.default.publicDomainName}`),[s]),{publishedPages:n,loading:o}=em({spaceStore:s}),r=(n?(()=>{const e=[];for(const{model:t}of n)t&&t.table===Vt.iU&&e.push(t);return e})():[]).map((e=>{const t=He.G.createChildStore(s,{table:Vt.iU,id:e.id});return{key:e.id,columns:[(0,oe.jsx)(Xu.Z,{focused:!1,store:t,hidePath:!0,caption:void 0},e.id),i]}}));return(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"publishing.publicPages.title",defaultMessage:"Published pages"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",marginBottom:6},children:(0,oe.jsx)(p.FormattedMessage,{id:"publishing.publicPages.caption",defaultMessage:"See all pages visible to you that are published to the web."})}),(0,oe.jsx)(ro.Z,{size:16,isHidden:!0}),o?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsx)(uc.Z,{columns:[tm,sm],rows:r})]})}var nm=s(5851),am=s(78730),om=s(98481),rm=s(64404),lm=function(e){return e[e.Keep=0]="Keep",e[e.Remove=1]="Remove",e}(lm||{});function dm(e){return(0,oe.jsx)(Mo.Z,{open:e.isOpen,onDismiss:e.onDismiss,render:()=>(0,oe.jsx)(cm,{...e})})}function cm(e){window.__c={n:"DisableGuestsConfig"};const{onDismiss:t,onSave:s,guestCount:n}=e,[a,o]=(0,i.useState)(lm.Keep),r=(0,Je.yK)((e=>({container:{width:350,padding:30,borderRadius:5,height:400,alignItems:"center"},title:{fontFamily:m.Z.getCompositeFontFamily(Rt.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:m.Z.getCompositeFontFamily(Rt.SP).sans,fontSize:14,fontWeight:300,lineHeight:"19px",margin:10,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column"},button:{justifyContent:"space-between",marginTop:10,height:70,borderRadius:5},buttonText:{display:"flex",flexDirection:"column"},optionSubtitle:{whiteSpace:"break-spaces"},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{justifyContent:"center",margin:"8px auto 0"}})),[]),l=(0,i.useCallback)((()=>{const e=a===lm.Keep;s(e)}),[s,a]);return(0,oe.jsxs)("div",{style:r.container,children:[(0,oe.jsx)(at.Z,{style:r.title,children:(0,oe.jsx)(p.FormattedMessage,{id:"disableGuestsConfig.title",defaultMessage:"Disable inviting guests?"})}),(0,oe.jsx)(at.Z,{isSmall:!0,style:r.subtitle,isMultiline:!0,children:(0,me.$K)(n)?(0,oe.jsx)(p.FormattedMessage,{id:"disableGuestsConfig.description",defaultMessage:"Your workspace currently has {guestCount, plural, one {1 guest} other {{guestCount} guests}}. You can choose to:",values:{guestCount:n}}):(0,oe.jsx)(p.FormattedMessage,{id:"disableGuestsConfig.description.noGuestCount",defaultMessage:"You are turning off guests in this workspace. You can choose to:"})}),(0,oe.jsxs)("div",{style:r.radioContainer,children:[(0,oe.jsxs)(St.Z,{isLarge:!0,onClick:()=>o(lm.Keep),style:r.button,children:[(0,oe.jsx)(zn.Z,{isSelected:a===lm.Keep}),(0,oe.jsxs)("div",{style:r.buttonText,children:[(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.title",defaultMessage:"Keep existing guests"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:r.optionSubtitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.description",defaultMessage:"Guests will still be able to access the pages they've been invited to"})})]})]}),(0,oe.jsxs)(St.Z,{isLarge:!0,onClick:()=>o(lm.Remove),style:r.button,children:[(0,oe.jsx)(zn.Z,{isSelected:a===lm.Remove}),(0,oe.jsxs)("div",{style:r.buttonText,children:[(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.title",defaultMessage:"Remove existing guests"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:r.optionSubtitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.description",defaultMessage:"All guests will be removed from your workspace"})})]})]})]}),(0,oe.jsxs)("div",{style:r.actionButtonsContainer,children:[(0,oe.jsx)(Q.Z,{isLarge:!0,onClick:l,children:(0,oe.jsx)(p.FormattedMessage,{id:"disableGuestsModal.saveChanges",defaultMessage:"Disable inviting guests"})}),(0,oe.jsx)(ve.Z,{onClick:t,style:r.cancelButton,children:(0,oe.jsx)(p.FormattedMessage,{id:"disableGuestsModal.cancel",defaultMessage:"Cancel"})})]})]})}var um=s(64768),mm=s(69435);const pm=.5;class gm extends n.Z{constructor(){super(...arguments),this.storeTypes={tokenOptionsButtonPopupStore:en.Z,domainVerificationStore:Hr.ZP},this.handleDisablePublicAccessSwitcherClick=async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disablePublicAccess;if(!t){if(!(await y.confirmUserAction({message:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.message",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}ym({disablePublicAccess:!t},this.props.securitySettingsStore,this.props.spaceStore,this.environment)},this.handleAllowDisableGuestsSwitcherClick=async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disableGuests,s=e.state.enableGuestInviteRequests;if(t)ym({disableGuests:!t,...s&&{enableGuestInviteRequests:!s}},this.props.securitySettingsStore,this.props.spaceStore,this.environment);else{if(lt.default.checkGate("show_keep_existing_guests_modal"))return void e.setState({...e.state,disableGuestsModalOpen:!0});if(!(await y.confirmUserAction({message:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.message",defaultMessage:"Are you sure? All guests in this workspace will be removed."}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return;ym({disableGuests:!t},this.props.securitySettingsStore,this.props.spaceStore,this.environment)}},this.handleToggleClick=e=>{const{name:t,isToggleEnabled:s,showUpgradeIfDisabled:i}=e;if(!s)return i?this.handleUpgradeClick():void 0;const{securitySettingsStore:n}=this.props;ym({[t]:!n.state[t]},this.props.securitySettingsStore,this.props.spaceStore,this.environment)},this.handleUpgradeClick=()=>{Da.y(this.environment,{from:"space_saml",for:"enterprise"})}}renderComponent(){return ji.Z.state.online?(0,oe.jsx)(wi.Z,{children:this.renderSecuritySettings()}):(0,oe.jsx)(fm,{})}renderUpsell(){if(!(0,om.J)({environment:this.environment}))return(0,oe.jsxs)("div",{style:{border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:4,padding:16,marginTop:void 0,marginBottom:24},children:[!(0,Ua.Rs)()&&(0,oe.jsx)(mm.Z,{for:"business",from:"space_saml",upgradeMessage:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.upsell.button.business",defaultMessage:"Upgrade to Business"}),title:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.upsell.title.business",defaultMessage:"Upgrade for SAML SSO & more admin tools"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.business",defaultMessage:"The Business Plan includes single sign-on to manage employee access at scale, private teamspaces to collaborate on sensitive docs, and more."}),learnMoreRoute:"guides.securitySettings",style:{marginBottom:"20px"}}),(0,oe.jsx)(mm.Z,{for:"enterprise",from:"space_saml",upgradeMessage:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.upsell.button.enterprise",defaultMessage:"Upgrade to Enterprise"}),title:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.upsell.title.enterprise",defaultMessage:"Upgrade for SCIM, advanced security & more"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.enterprise",defaultMessage:"The Enterprise Plan allows you to automatically provision users and groups, and gain more visibility and controls across the workspace."}),learnMoreRoute:"guides.securitySettings"})]})}renderSecuritySettings(){const{securitySettingsStore:e}=this.props,t=(0,ot.wd)(),s=this.renderUpsellButton(),n=t=>(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:t?this.handleDisablePublicAccessSwitcherClick:this.handleUpgradeClick,children:[(0,oe.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.label",defaultMessage:"Disable public page sharing"}),!t&&s,(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.caption",defaultMessage:"Disable the Share to web option in the Share menu on every page in this workspace."})})]}),(0,oe.jsx)("div",{style:{marginTop:5,opacity:t?void 0:pm},children:(0,oe.jsx)(jr.Z,{on:e.state.disablePublicAccess,disabled:!t})})]}),(0,oe.jsx)(ro.Z,{size:24,style:{opacity:0}})]}),a=t=>{if(!(0,rt.bq)())return(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick({name:"disableSpacePageEdits",isToggleEnabled:t,showUpgradeIfDisabled:!0}),children:[(0,oe.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),!t&&s,(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."})})]}),(0,oe.jsx)("div",{style:{marginTop:5,opacity:t?void 0:pm},children:(0,oe.jsx)(jr.Z,{on:e.state.disableSpacePageEdits,disabled:!t})})]}),(0,oe.jsx)(ro.Z,{size:24,style:{opacity:0}})]})},o=t=>(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:t?this.handleAllowDisableGuestsSwitcherClick:this.handleUpgradeClick,children:[(0,oe.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.label",defaultMessage:"Disable guests"}),!t&&s,(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.caption",defaultMessage:"Prevent anyone from inviting people outside the workspace to pages."})})]}),(0,oe.jsx)("div",{style:{marginTop:5,opacity:t?void 0:pm},children:(0,oe.jsx)(jr.Z,{on:e.state.disableGuests,disabled:!t})})]}),(0,oe.jsx)(ro.Z,{size:24,style:{opacity:0}}),(0,oe.jsx)(dm,{isOpen:Boolean(e.state.disableGuestsModalOpen),onDismiss:()=>{e.setState({...e.state,disableGuestsModalOpen:!1})},onSave:t=>{ym({disableGuests:!0,keepExistingGuests:t},this.props.securitySettingsStore,this.props.spaceStore,this.environment),e.setState({...e.state,disableGuestsModalOpen:!1})},guestCount:void 0})]}),r=t=>(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick({name:"disableMoveToSpace",isToggleEnabled:t,showUpgradeIfDisabled:!0}),children:[(0,oe.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable duplicating pages to other workspaces"}),!t&&s,(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from duplicating pages to other workspaces via the Move To or Duplicate To actions."})})]}),(0,oe.jsx)("div",{style:{marginTop:5,opacity:t?void 0:pm},children:(0,oe.jsx)(jr.Z,{on:e.state.disableMoveToSpace,disabled:!t})})]}),(0,oe.jsx)(ro.Z,{size:24,style:{opacity:0}})]}),{state:l}=e,d=t=>(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick({name:"disableExport",isToggleEnabled:t,showUpgradeIfDisabled:!0}),children:[(0,oe.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),!t&&s,(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."})})]}),(0,oe.jsx)("div",{style:{marginTop:5,opacity:t?void 0:pm},children:(0,oe.jsx)(jr.Z,{on:e.state.disableExport,disabled:!t})})]}),(0,oe.jsx)(ro.Z,{size:24,style:{opacity:0}})]});return(0,om.J)({environment:this.environment})?(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:t?(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"}):(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})}),void 0,n(!0),a(!0),!t&&o(!0),r(!0),d(!0),t&&this.renderGuestAndRequestSection(!0,(0,Ua.wP)()),(0,oe.jsx)("div",{style:{height:36}})]}):(0,oe.jsxs)(i.Fragment,{children:[this.renderUpsell(),(0,oe.jsx)("div",{style:this.getHeaderStyle(),children:(0,oe.jsx)("span",{style:{marginRight:8},children:t?(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"}):(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})})}),void 0,n(l.disablePublicAccess),a(l.disableSpacePageEdits),!t&&o(l.disableGuests),r(l.disableMoveToSpace),d(l.disableExport),t&&this.renderGuestAndRequestSection(l.disableGuests,l.enableGuestInviteRequests),(0,oe.jsx)("div",{style:{height:32}})]})}renderUpsellButton(e){return(0,oe.jsx)(Kr.Z,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:this.handleUpgradeClick,desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3,...e}})}renderGuestAndRequestSection(e,t){const{data:s}=ui.default.state;if(!s)return(0,oe.jsx)(Ti.Z,{});const i=yi.CM(s).filter(On.du).filter((e=>!e.isTeamGuest&&e.isPageGuest)).length;return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.guestsSection.title",defaultMessage:"Inviting members & guests"})}),this.renderDisableGuestsV2(e,i),this.renderEnableGuestInviteRequests(t),this.renderMembershipRequestToggles((0,ot.p1)())]})}renderMembershipRequestToggles(e){const t=(0,am.U)(this.props.spaceStore,this.environment),s=(0,ot.Or)();return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(um.dy,{environment:this.environment,toggleOn:e&&!Boolean(this.props.securitySettingsStore.state.disableMembershipRequests),onClick:()=>this.handleToggleClick({name:"disableMembershipRequests",isToggleEnabled:e,showUpgradeIfDisabled:!1}),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!e}),s&&(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(um.ms,{environment:this.environment,toggleOn:e&&!Boolean(this.props.securitySettingsStore.state.disableExternalMembershipRequests),onClick:()=>this.handleToggleClick({name:"disableExternalMembershipRequests",isToggleEnabled:e,showUpgradeIfDisabled:!1}),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!e})}),t&&(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(um.Xr,{environment:this.environment,toggleOn:e&&!Boolean(this.props.securitySettingsStore.state.disableGuestMembershipRequests),onClick:()=>this.handleToggleClick({name:"disableGuestMembershipRequests",isToggleEnabled:e,showUpgradeIfDisabled:!1}),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!e})})]})}renderDisableGuestsV2(e,t){return(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,oe.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.label",defaultMessage:"Disable members inviting guests to pages"}),!e&&this.renderUpsellButton(),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.caption",defaultMessage:"Your workspace currently has <gueststablink> {guestCount, plural, one {1 guest} other {{guestCount} guests}}</gueststablink>",values:{gueststablink:e=>(0,oe.jsx)(co.Z,{onClick:()=>{f.jkE(this.environment,{source_tab:ci.Z.state.currentTab,destination_tab:"members",destination_subtab:rm.Q.Guests}),ci.Z.setState({...ci.Z.state,currentTab:"members",defaultSubtab:rm.Q.Guests})},children:e}),guestCount:t}})})]}),(0,oe.jsx)("div",{onClick:e?this.handleAllowDisableGuestsSwitcherClick:this.handleUpgradeClick,style:{marginTop:5,opacity:e?void 0:pm},children:(0,oe.jsx)(jr.Z,{on:this.props.securitySettingsStore.state.disableGuests,disabled:!e})})]}),(0,oe.jsx)(ro.Z,{size:24,style:{opacity:0}}),(0,oe.jsx)(dm,{isOpen:Boolean(this.props.securitySettingsStore.state.disableGuestsModalOpen),onDismiss:()=>{this.props.securitySettingsStore.setState({...this.props.securitySettingsStore.state,disableGuestsModalOpen:!1})},onSave:e=>{ym({disableGuests:!0,keepExistingGuests:e},this.props.securitySettingsStore,this.props.spaceStore,this.environment),this.props.securitySettingsStore.setState({...this.props.securitySettingsStore.state,disableGuestsModalOpen:!1})},guestCount:t})]})}renderEnableGuestInviteRequests(e){let t=()=>this.handleToggleClick({name:"enableGuestInviteRequests",isToggleEnabled:e,showUpgradeIfDisabled:!0});e&&!this.props.securitySettingsStore.state.disableGuests&&(t=()=>{});const s=!e||!this.props.securitySettingsStore.state.disableGuests;return(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,oe.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,oe.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.label",defaultMessage:"Allow members to request adding guests"}),e&&(0,oe.jsx)(Xr.Z,{style:{marginLeft:0},href:(0,Gs.UY)("guides.guestRequests"),analyticsFrom:"space_saml"}),!e&&this.renderUpsellButton({marginTop:0})]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.caption",defaultMessage:"{hasRequestTab, select, true {Requests must be approved by a workspace owner. You can view all requests <requeststablink>here</requeststablink>} other {Requests must be approved by a workspace owner}}",values:{hasRequestTab:(0,ot.p1)(),requeststablink:e=>(0,oe.jsx)(co.Z,{onClick:()=>{f.jkE(this.environment,{source_tab:ci.Z.state.currentTab,destination_tab:"members",destination_subtab:rm.Q.Requests}),ci.Z.setState({...ci.Z.state,currentTab:"members",defaultSubtab:rm.Q.Requests})},children:e})}})})]}),(0,oe.jsx)(te.Z,{render:i=>(0,oe.jsx)("div",{onClick:t,style:{marginTop:5,opacity:e&&this.props.securitySettingsStore.state.disableGuests?void 0:pm},...i,children:(0,oe.jsx)(jr.Z,{on:this.props.securitySettingsStore.state.enableGuestInviteRequests,disabled:s})}),renderTooltip:()=>(0,oe.jsx)("div",{style:{},children:(0,oe.jsx)(p.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.disabled.label",defaultMessage:"Disable inviting guests to use this feature"})}),disableTooltip:!e||this.props.securitySettingsStore.state.disableGuests,placement:te.Z.Placement.Top})]}),(0,oe.jsx)(ro.Z,{size:24,style:{opacity:0}})]})}getHeaderStyle(){return{fontWeight:m.Z.fontWeight.medium,fontSize:18,borderBottom:`1px solid ${this.theme.regularDividerColor}`,paddingBottom:6,marginBottom:12,display:"flex",alignItems:"center"}}}gm.displayName="SecuritySettings";const hm=(0,p.injectIntl)(gm);function fm(){return(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Please go online to manage security settings.",id:"securitySAMLSettings.offline.message"})})})}function ym(e,t,s,i){nm.y(i,{spaceStore:s,securitySettingsStore:t,fields:e})}var xm=s(58047);function vm(e){window.__c={n:"SettingsPrompt"};const t=(0,T.O7)(),{onView:s}=e;return(0,i.useEffect)((()=>{s(t)}),[t,s]),(0,oe.jsxs)("div",{children:[(0,oe.jsx)(ro.Z,{size:0}),(0,oe.jsx)(xm.N,{icon:e.icon,title:e.title,description:e.descriptionMessage,onDismiss:e.onDismiss,primaryAction:{text:e.buttonText,onClick:t=>(e.onDismiss(),e.onClick(t))},secondaryAction:{icon:e=>(0,Do.m)(e),text:(0,oe.jsx)(p.FormattedMessage,{id:"settingsPrompt.learnMore.button",defaultMessage:"Learn more"}),onClick:e.onClickLearnMore}})]})}const Sm=function(e){window.__c={n:"SidebarBox"};const t=(0,Je.yK)((t=>({style:{display:"flex",height:"100%",flexDirection:e.isReversed?"row-reverse":"row"},sidebarStyle:{height:"100%",background:t.cardSidebarBackground,flexGrow:0,flexShrink:0,width:240,overflowY:"auto"},childrenStyle:{flexGrow:1,position:"relative",zIndex:1,height:"100%"}})),[e]);return(0,oe.jsxs)("div",{style:t.style,onMouseDown:e.onMouseDown,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,children:[(0,oe.jsx)("div",{style:t.sidebarStyle,children:e.sidebar}),(0,oe.jsx)("div",{style:t.childrenStyle,children:e.children})]})},bm="last_90_days",Mm={field:"last_active",direction:"desc"};async function jm(e){var t,s;const{environment:i,filter:n,spaceId:a,spaceAnalyticsStore:o}=e,r=null===(t=o.usersTabData)||void 0===t?void 0:t.dailyUsersData;if(!r||n!==(null===(s=o.usersTabData)||void 0===s?void 0:s.graphFilter)||o.currentSpaceId!==a){const e=await M.getDailyUsersAnalytics(i,{spaceId:a,activeWindow:"all_time"===n?"last_90_days":n});return"failed"===e.type?e.body:e.data}return r}async function wm(e){var t,s,i;const{environment:n,filter:a,sort:o,spaceStore:r,spaceAnalyticsStore:l}=e,d=null===(t=l.usersTabData)||void 0===t?void 0:t.tableFilter,c=null===(s=l.usersTabData)||void 0===s?void 0:s.userTableSort;if(null===(i=l.usersTabData)||void 0===i||!i.usersAndStats||d!==a||!c||c.direction!==o.direction||c.field!==o.field||l.currentSpaceId!==r.id){const e=await M.loadWorkspaceAnalyticsUsers(n,{spaceId:r.id,filters:{timeRange:a},sort:o});return"failed"===e.type?e.body:e.data.users.map((e=>({stats:e,userStore:He.U6.createChildStore(r,{table:F.KJ,id:e.userId})}))).filter((e=>{let{userStore:t}=e;return t.isDefined()}))}return l.usersTabData.usersAndStats}function Cm(e,t){if((0,P.qC)(e)){const s=(0,R.nX)(t,e);if(s)return s}return t.formatMessage({defaultMessage:"Failed to retrieve analytics. Try refreshing and reopening the settings.",id:"workspaceAnalytics.usersTab.refershUserAnalytics.defaultFailed"})}const km={pageViews:0,uniquePageViews:0,pagesCreated:0,pageEdits:0,topPages:[]};const Tm={activeMembersCount:0,previousActiveMembersCount:0,activeGuestsCount:0,previousActiveGuestsCount:0,topTeamspaces:[],topViewers:[],topEditors:[]};function Im(e){return(0,oe.jsx)(nn.ZP,{popupType:X.kQ.Popup,alignmentToOrigin:Bt.v.End,render:t=>{let{close:s}=t;return(0,oe.jsx)(Pm,{closePopup:s,analyticsType:e.analyticsType})},renderOrigin:t=>{let{onClick:s}=t;return(0,oe.jsx)(St.Z,{style:e.style,onClick:s,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceAnalytics.usersTab.export",defaultMessage:"Export as CSV"})})}})}function Pm(e){window.__c={n:"ExportAnalyticsMenu"};const{analyticsType:t,closePopup:s}=e,n=(0,T.O7)(),o=(0,a.VK)((()=>{var e;return null===(e=ie.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),r=(0,i.useCallback)((async e=>{if(o){switch(t){case ti.Users:f.LbR(n,{daysFilter:e}),await H.Tp(n,{spaceId:o,daysFilter:e});break;case ti.Content:f.ZaS(n,{daysFilter:e}),await H.hN(n,{spaceId:o,daysFilter:e});break;default:(0,me.t1)(t)}s()}}),[n,o,t,s]),l=zt.Hz.map((e=>(0,oe.jsx)(Y.Z,{focused:!1,onClick:()=>r(e),title:D.default.formatMessage(zt.Rh[e])},e)));return(0,oe.jsx)($.Z,{menuType:se.og.Popup,children:(0,oe.jsx)(ee.Z,{children:l})})}var _m=s(83176);const Zm=(0,p.defineMessages)({emptyAnalyticsHeading:{id:"workspaceAnalyticsTabs.empty.heading",defaultMessage:"No workspace analytics yet"},emptyAnalyticsDescription:{id:"workspaceAnalyticsTabs.empty.description",defaultMessage:"It may take some time for workspace analytics information to appear."},disabledAnalyticsHeading:{id:"workspaceAnalyticsTabs.disabled.heading",defaultMessage:"Analytics are disabled"},disabledAnalyticsDescription:{id:"workspaceAnalyticsTabs.disabled.description",defaultMessage:"A workspace owner has turned off page view recording for {name}.{br}This information will not be available in your workspace settings or on individual pages."},disabledAnalyticsDescriptionNoSpaceName:{id:"workspaceAnalyticsTabs.disabled.description.unnamed",defaultMessage:"A workspace owner has turned off page view recording for this space.{br}This information will not be available in your workspace settings or on individual pages."}});function Fm(e){window.__c={n:"SpaceAnalyticsEmptyState"};const t=(0,Je.yK)((e=>({outerDiv:{display:"flex",flexDirection:"column",justifyContent:"center",height:"80%",gap:24},innerDiv:{display:"flex",flexDirection:"column",textAlign:"center",alignItems:"center",gap:4},header:{fontSize:16,fontWeight:500},analyticsIcon:{fill:e.mediumTextColor,padding:20,height:150,width:150},learnMoreIcon:{width:14,height:14},learnMore:{gap:4}})),[]),s=(0,T.O7)(),{type:i,spaceName:n}=e,a=function(e,t){switch(e){case"empty":return{heading:D.default.formatMessage(Zm.emptyAnalyticsHeading),description:D.default.formatMessage(Zm.emptyAnalyticsDescription)};case"disabled":const e=t?(0,oe.jsx)(p.FormattedMessage,{...Zm.disabledAnalyticsDescription,values:{name:t,br:(0,oe.jsx)("br",{})}}):(0,oe.jsx)(p.FormattedMessage,{...Zm.disabledAnalyticsDescriptionNoSpaceName,values:{br:(0,oe.jsx)("br",{})}});return{heading:D.default.formatMessage(Zm.disabledAnalyticsHeading),description:e}}}(i,n);return(0,oe.jsx)("div",{style:t.outerDiv,children:(0,oe.jsxs)("div",{style:t.innerDiv,children:[(0,_m.z)(t.analyticsIcon),(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:t.header,children:a.heading}),(0,oe.jsx)(at.Z,{isSecondaryColor:!0,children:a.description}),(0,oe.jsxs)(ve.Z,{onClick:()=>v.navigateToExternalURL({environment:s,url:(0,Gs.UY)("guides.workspaceAnalytics")}),style:t.learnMore,children:[(0,Do.m)(t.learnMoreIcon),(0,oe.jsx)(at.Z,{isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalyticsTabs.disabled.learnMore",defaultMessage:"Learn more"})})]})]})})}var Am=s(55964),Rm=s(90028),Dm=s(35314);function Bm(e){let{num:t,abbreviateNumber:s}=e;window.__c={n:"NumberDisplay"};const i=(0,p.useIntl)(),n=(0,xr.E2)(i),a=t.toLocaleString(n),o=Intl.NumberFormat(n,{notation:"compact",maximumFractionDigits:1}).format(t);return s?(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Bottom,render:e=>(0,oe.jsx)("span",{...e,children:o}),renderTooltip:()=>a}):(0,oe.jsx)("span",{children:a})}function Lm(e){let{icon:t,iconStyles:s,textStyles:i,style:n,title:a,byline:o,loading:r,error:l}=e;window.__c={n:"AnalyticsCardOverview"};const d=function(e,t,s){return(0,Je.yK)((i=>({title:{fontWeight:m.Z.fontWeight.medium,fontSize:16},byline:{fontSize:m.Z.fontSize.UISmall.desktop,marginTop:4},textContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",...t},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:8},icon:{height:28,width:28,color:i.lightTextColor,fill:"currentcolor",...e},container:{height:"100%",flex:1,display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",border:`1px solid ${i.outlineButtonBorder}`,borderRadius:4,padding:12,gap:8,...s},loadingTitle:{display:"block",width:"40%"},loadingByline:{display:"block",width:"60%",marginTop:8,marginBottom:8},errorTitle:{textAlign:"center",color:et.ZP.red}})),[e,t,s])}(s,i,n);return r?(0,oe.jsx)("div",{style:d.container,children:(0,oe.jsxs)("div",{style:d.textContainer,children:[(0,oe.jsx)("div",{style:d.loadingTitle,children:(0,oe.jsx)(Ct.Z,{paragraphs:[{lineHeight:18,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]})}),o?(0,oe.jsx)("div",{style:d.loadingByline,children:(0,oe.jsx)(Ct.Z,{paragraphs:[{lineHeight:14,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]})}):null]})}):l?(0,oe.jsx)("div",{style:d.container,children:(0,oe.jsx)("div",{style:d.titleContainer,children:(0,oe.jsx)(at.Z,{style:d.errorTitle,children:(0,P.Jx)(l)?l.message:(0,oe.jsx)(p.FormattedMessage,{id:"spaceAnalytics.basicErrorMessage",defaultMessage:"Something went wrong.{br}Try refreshing the page.",values:{br:(0,oe.jsx)("br",{})}})})})}):(0,oe.jsxs)("div",{style:d.container,children:[t?t(d.icon):null,(0,oe.jsxs)("div",{style:d.textContainer,children:[(0,oe.jsx)(at.Z,{style:d.title,children:a}),o?(0,oe.jsx)(at.Z,{style:d.byline,children:o}):null]})]})}var Nm=s(67579);const Om=640;function Em(e){let{data:t,loading:s,error:n,daysFilter:a,setDaysFilter:o}=e;window.__c={n:"ContentAnalyticsSummaries"};const[r,l]=(0,Dm.e)(),d=(0,Je.yK)((e=>({title:{fontWeight:m.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center",justifyContent:"center"},infoIcon:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{pageViews:c,uniquePageViews:u,pagesCreated:g,pageEdits:h}=t,y=(0,T.O7)(),x=(0,i.useCallback)((e=>{f.kyK(y,{daysFilter:e}),o(e)}),[y,o]);return(0,oe.jsxs)("div",{style:d.container,ref:r,children:[(0,oe.jsxs)("div",{style:d.titleContainer,children:[(0,oe.jsxs)(at.Z,{style:d.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.title",defaultMessage:"Content engagement"}),(0,oe.jsx)(te.Z,{placement:Bt.u.Bottom,render:e=>(0,oe.jsx)(Xr.Z,{...e,href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:d.infoIcon}),renderTooltip:()=>"all_time"!==a?(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all workspace pages (includes private and shared) over the {dateRange}",values:{dateRange:D.default.formatMessage(zt.xX[a])}}):(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace (includes private and shared)"})})]}),(0,oe.jsx)(Nm.f,{currentFilter:a,onChangeFilter:x})]}),(0,oe.jsxs)(td.rj,{gap:16,children:[(0,oe.jsx)(td.r8,{row:1,col:1,children:(0,oe.jsx)(Lm,{style:d.cardContainer,textStyles:d.cardTextContainer,loading:s,error:n,icon:Am.N,iconStyles:{height:48,width:48},title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.totalViews",defaultMessage:"{pageViews} total views",values:{pageViews:(0,oe.jsx)(Bm,{abbreviateNumber:l<Om,num:c})}}),byline:(0,oe.jsx)(at.Z,{isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews} unique page views",values:{uniquePageViews:(0,oe.jsx)(Bm,{abbreviateNumber:l<Om,num:u})}})})})}),(0,oe.jsx)(td.r8,{row:1,col:2,children:(0,oe.jsx)(Lm,{style:d.cardContainer,textStyles:d.cardTextContainer,loading:s,error:n,icon:Rm.j,iconStyles:{height:36,width:36},title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.pagesCreated",defaultMessage:"{pagesCreated} pages created",values:{pagesCreated:(0,oe.jsx)(Bm,{abbreviateNumber:l<Om,num:g})}}),byline:(0,oe.jsx)(at.Z,{isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.pageEdits.byline",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,oe.jsx)(Bm,{abbreviateNumber:l<Om,num:h})}})})})})]})]})}function Vm(e){const{tooltipMessageDescriptor:t,columnHeader:s}=e;return(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Top,renderTooltip:e=>(0,oe.jsx)("div",{...e,children:(0,oe.jsx)(p.FormattedMessage,{...t})}),render:e=>(0,oe.jsx)("div",{...e,children:D.default.formatMessage(s)})})}function Um(e){let{blockStore:t}=e;window.__c={n:"PageCellActions"};const s=(0,T.O7)(),i=(0,a.qz)(void 0,en.Z),n=(0,Je.yK)((e=>({changePermissionsIcon:{height:18,width:18,color:e.regularIconColor,fill:"currentColor"},copyLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor"},openLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor",transform:"rotate(-45deg)"}})),[]);const o={key:"actions",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:[{key:"copy-link",render:e=>(0,oe.jsx)(Y.Z,{...e,icon:(0,Qi.N)(n.copyLinkIcon),title:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page"})}),action:async function(){const e=(0,$i.ZP)({store:t,pageVisitSource:Gi.tY.CopyLink});await It.RD({environment:s,stringValue:e,copiedMessage:It.tq.copiedLinkToClipboard}),i.setState({open:!1})}},{key:"open-page-in-new-tab",render:e=>(0,oe.jsx)(Y.Z,{...e,icon:(0,nc.n)(n.openLinkIcon),title:(0,oe.jsx)(p.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.openLink",defaultMessage:"Open in new tab"})}),action:function(){const e=(0,$i.ZP)({store:t,pageVisitSource:Gi.tY.LinkInPage});v.navigateToExternalURL({environment:s,url:e}),i.setState({open:!1})}}]};return(0,oe.jsx)(nn.ZP,{popupType:X.kQ.Popup,alignmentToOrigin:X.ZP.Alignment.Center,placementToOrigin:X.ZP.Placement.Right,style:{width:248},render:()=>(0,oe.jsx)($.Z,{menuType:se.og.Popup,width:248,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:void 0,sections:[o]})}),buttonPopupStore:i,renderOrigin:e=>(0,oe.jsx)(an.Z,{icon:Hi.o,...e})})}const Wm=(0,p.defineMessages)({views:{id:"workspaceAnalytics.contentTab.contentTable.viewsColumn.tooltip",defaultMessage:"Number of times users have viewed the page"},uniqueViews:{id:"workspaceAnalytics.contentTab.contentTable.uniqueViewsColumn.tooltip",defaultMessage:"Total number of users that have viewed page in the selected period"}}),Km={id:"page",headerTitle:(0,oe.jsx)(Xm,{message:zt.y3.page}),renderCell:e=>(0,oe.jsx)(Pi.o,{blockStore:e.navigableBlockStore,rightIcon:(0,oe.jsx)(Um,{blockStore:e.navigableBlockStore})}),widthData:{width:320,maxWidth:320},sortable:!1},zm={id:"location",headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.table.location.name",defaultMessage:"Location"}),renderCell:e=>(0,oe.jsx)(qi,{blockStore:e.navigableBlockStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},qm={id:"audience",headerTitle:(0,oe.jsx)(Xm,{message:zt.y3.audience}),renderCell:e=>(0,oe.jsx)(at.Z,{children:Wi(e.audience)}),widthData:{width:140},sortable:!1},Gm={id:"views",headerTitle:(0,oe.jsx)(Vm,{tooltipMessageDescriptor:Wm.views,columnHeader:zt.y3.allViews}),renderCell:e=>(0,oe.jsx)(at.Z,{children:e.views.toLocaleString()}),widthData:{width:100},sortable:!0},Hm={id:"uniqueViews",headerTitle:(0,oe.jsx)(Vm,{tooltipMessageDescriptor:Wm.uniqueViews,columnHeader:zt.y3.uniqueViews}),renderCell:e=>(0,oe.jsx)(at.Z,{children:e.uniqueViews.toLocaleString()}),widthData:{width:100},sortable:!0},Qm={id:"createdBy",headerTitle:(0,oe.jsx)(Xm,{message:zt.y3.createdBy}),renderCell:e=>e.createdById?(0,oe.jsx)(_n,{blockStore:e.navigableBlockStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},Ym={id:"createdTime",headerTitle:(0,oe.jsx)(Xm,{message:zt.y3.createdAt}),renderCell:e=>(0,oe.jsx)(Ii.T,{dateTs:e.createdTime}),widthData:{width:100},sortable:!1},$m=[Km,Gm,Hm,zm,qm,{id:"lastEditedBy",headerTitle:(0,oe.jsx)(Xm,{message:zt.y3.lastEditedBy}),renderCell:e=>e.lastEditedById?(0,oe.jsx)(_n,{blockStore:e.navigableBlockStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},{id:"lastEditedTime",headerTitle:(0,oe.jsx)(Xm,{message:zt.y3.lastEditedAt}),renderCell:e=>(0,oe.jsx)(Ii.T,{dateTs:e.lastEditedTime}),widthData:{width:100},sortable:!1},Qm,Ym];function Jm(e){let{navigableBlockStores:t,analyticsByPageId:s,runNewSearch:n,sort:o,setSort:r,loadNextPage:l,loading:d,error:c}=e;window.__c={n:"ContentAnalyticsTable"};const u=(0,a.VK)((()=>t.map((e=>{var t,i,n;return{id:e.id,isClickable:!1,navigableBlockStore:e,teamStore:(0,ki.VP)(e),views:(null===(t=s.get(e.id))||void 0===t?void 0:t.pageViews)||0,uniqueViews:(null===(i=s.get(e.id))||void 0===i?void 0:i.uniquePageViews)||0,createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById(),audience:(null===(n=s.get(e.id))||void 0===n?void 0:n.audience)||"private"}}))),[t,s]),m=(0,i.useMemo)((()=>function(e){const t=$m.find((t=>"pageViews"===e.field&&"views"===t.id||"uniquePageViews"===e.field&&"uniqueViews"===t.id));return t?{column:t,sortAscending:"asc"===e.direction}:void 0}(o)),[o]),g=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:$m,theme:e,containerMarginTop:0})),[]),h=(0,Je.yK)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return c?(0,oe.jsx)(Ai,{error:c,runNewSearch:n}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Pt.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:$m,rows:u,sortState:m,onSortStateChanged:e=>{r(function(e){const t="views"===e.column.id?"pageViews":"uniquePageViews",s=e.sortAscending?"asc":"desc";return{field:t,direction:s}}(e))},onScrollBottom:l,renderNoRowsComponent:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:h.emptyQuery,children:!d&&0===t.length&&(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.table.empty",defaultMessage:"No pages found with your query."})}),styles:g}),d?(0,oe.jsx)(Ti.Z,{style:h.loadingSpinner}):null]})}function Xm(e){let{message:t}=e;window.__c={n:"FormatDefinedMessage"};const s=(0,p.useIntl)();return(0,oe.jsx)(oe.Fragment,{children:s.formatMessage(t)})}const ep={query:"",createdBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},tp={field:"pageViews",direction:"desc"},sp=bm,ip={filters:ep,sort:tp,timeRange:sp,navigableBlockStores:[],analyticsByPageId:new Map,numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};const np=(0,p.defineMessages)({placeholder:{id:"settings.workspaceAnalytics.contentTab.placeholder",defaultMessage:"Search by title"}});function ap(e){let{spaceStore:t,timeRange:s,filters:i,runNewSearch:n,setFilters:o,setTimeRange:r}=e;window.__c={n:"SearchInputsSection"};const l=(0,a.VK)((()=>ic.Z.state.teams),[]),d=(0,Je.yK)((e=>({container:{width:"100%",margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItems:"center"},timeRangeContainer:{display:"flex",flexDirectionRow:"row",alignItems:"center",justifyContent:"center",gap:4,borderRight:`1px solid ${e.tableDividerColor}`,marginRight:12,paddingRight:6}})),[]);return(0,oe.jsxs)("div",{style:d.container,children:[(0,oe.jsx)(oa,{mode:na.OnChange,query:i.query,setQueryFilter:function(e){o({query:e},{runSearchAfter:!0})},placeholderText:D.default.formatMessage(np.placeholder)}),(0,oe.jsxs)("div",{style:d.filterPillsContainer,children:[(0,oe.jsxs)("div",{style:d.timeRangeContainer,children:[(0,oe.jsx)(at.Z,{isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.timeRange",defaultMessage:"Views from"})}),(0,oe.jsx)(Nm.f,{currentFilter:s,onChangeFilter:r})]}),(0,oe.jsx)(da,{selectedTeamIds:i.teamIds,setSelectedTeamIds:function(e){o({teamIds:e})},onMenuClose:n,teamStores:l}),(0,oe.jsx)(Yn,{spaceStore:t,createdByFilterIds:i.createdBy,setCreatedByFilter:function(e){o({createdBy:e})},runNewSearch:n,includeGuests:!1}),(0,oe.jsx)(ea,{lastEditedTime:i.lastEditedTime,createdTime:i.createdTime,setLastEditedTime:function(e){o({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){o({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}})]})]})}function op(e){var t;let{spaceStore:s,contentEngagement:n}=e;window.__c={n:"SpaceAnalyticsContentTab"};const o=(0,i.useRef)(!1),{loadNextPage:r,navigableBlockStores:d,analyticsByPageId:c,runNewSearch:u,setFilters:m,setTimeRange:p,timeRange:g,filters:h,sort:y,setSort:x,loading:v,error:S}=function(e){let{spaceStore:t}=e;const s=(0,T.O7)(),[n,a]=(0,i.useState)(ip),o=(0,i.useRef)(ep),r=(0,i.useRef)(tp),d=(0,i.useRef)(sp),c=(0,i.useCallback)((async e=>{let{fetchFromFirstPage:i,ignoreSearchInputComparison:c}=e;const u=!l.Xy(n.filters,o.current)||!l.Xy(n.sort,r.current)||!l.Xy(n.timeRange,d.current);if(!c&&!u)return;o.current=n.filters,r.current=n.sort,d.current=n.timeRange;let m=n.loading,p=n.error,g=n.hasNextPage,h=n.paginationToken;if(i&&(a((e=>({...ip,filters:e.filters,timeRange:e.timeRange,sort:e.sort}))),m=ip.loading,p=ip.error,g=ip.hasNextPage,h=ip.paginationToken),!g||m)return;if(p)return;a((e=>({...e,loading:!0})));const f=await M.loadContentAnalytics(s,{spaceId:t.id,sort:n.sort,titleQuery:n.filters.query,filters:{inTeams:n.filters.teamIds,lastEditedTime:(0,L.Hq)(n.filters.lastEditedTime),createdTime:(0,L.Hq)(n.filters.createdTime),createdBy:n.filters.createdBy},timeRange:n.timeRange,startCursor:h});if("failed"===f.type)return void a((e=>({...e,loading:!1,error:f.error})));const y=f.data.results;a((e=>{const t=[],i=new Map(e.analyticsByPageId),n=new Set(e.navigableBlockStores.map((e=>e.id)));for(const o of y){const e=o.id,a=o.analytics;if(!n.has(e)){const n=new He.G(s,{table:Vt.iU,id:e});t.push(n),i.set(e,a)}}const a=[...e.navigableBlockStores,...t];return{...e,navigableBlockStores:a,analyticsByPageId:i,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:f.data.nextCursor,hasNextPage:Boolean(f.data.nextCursor)}}))}),[s,t,n.filters,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]);(0,i.useEffect)((()=>{n.shouldReRunSearch&&(a((e=>({...e,shouldReRunSearch:!1}))),c({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,c]);const u=(0,i.useCallback)((async()=>{n.shouldReRunSearch||await c({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,c]),m=(0,i.useCallback)((async e=>{await c({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[c]),p=(0,i.useCallback)(((e,t)=>{a((s=>({...s,filters:{...s.filters,...e},...null!=t&&t.runSearchAfter?{shouldReRunSearch:null==t?void 0:t.runSearchAfter}:void 0})));for(const i of(0,me.Yd)(e))l.Xy(e[i],ep[i])||f.uSc(s,{filter:i,value:"createdBy"===i||"teamIds"===i?e[i]:void 0})}),[s]),g=(0,i.useCallback)((e=>{a((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),f.e2(s,{daysFilter:e})}),[s]),h=(0,i.useCallback)((e=>{a((t=>({...t,sort:e,shouldReRunSearch:!0}))),f.jMN(s,{column:e.field,isAscending:"asc"===e.direction})}),[s]);return{...n,loadNextPage:u,runNewSearch:m,setFilters:p,setTimeRange:g,setSort:h}}({spaceStore:s}),b=(0,Je.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:16}})),[]),j=(0,a.VK)((()=>Boolean(s.canAdmin())),[s]);(0,i.useEffect)((()=>{o.current||(u(!0),o.current=!0)}),[u]);const w=(0,a.VK)((()=>s.getName()),[s]);return"NotFoundError"===(null==n||null===(t=n.error)||void 0===t?void 0:t.name)?(0,oe.jsx)(Fm,{type:"empty",spaceName:w}):(0,oe.jsxs)("div",{style:b.container,children:[(0,oe.jsx)(Em,{data:n.data,loading:n.loading,error:n.error,daysFilter:n.daysFilter,setDaysFilter:n.setDaysFilter}),(0,oe.jsx)(rp,{canAdmin:j,daysFilter:g}),(0,oe.jsx)(ap,{spaceStore:s,runNewSearch:u,setFilters:m,filters:h,timeRange:g,setTimeRange:p}),(0,oe.jsx)(Jm,{navigableBlockStores:d,analyticsByPageId:c,runNewSearch:u,sort:y,setSort:x,loadNextPage:r,loading:v,error:S})]})}function rp(e){window.__c={n:"ContentTableHeader"};const t=(0,Je.yK)((()=>({sectionTitle:{fontWeight:m.Z.fontWeight.semibold,fontSize:16},sectionTitleSection:{display:"flex",flexFlow:"row",alignItems:"center"},helpInfo:{marginLeft:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:12},exportButton:{marginLeft:5}})),[]),{canAdmin:s,daysFilter:i}=e,n=(0,oe.jsxs)("div",{style:t.sectionTitleSection,children:[(0,oe.jsx)(at.Z,{style:t.sectionTitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.title",defaultMessage:"Pages"})}),(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Bottom,render:e=>(0,oe.jsx)(Xr.Z,{...e,href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:t.helpInfo}),renderTooltip:()=>"all_time"!==i?(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.lastDays",defaultMessage:"Activity from the {dateRange} on pages you have access to",values:{dateRange:D.default.formatMessage(zt.xX[i])}}):(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.allTime",defaultMessage:"All time activity on pages you have access to in the workspace"})})]});return(0,oe.jsxs)("div",{style:t.wrapper,children:[n,s&&(0,oe.jsx)(Im,{style:t.exportButton,analyticsType:ti.Content})]})}var lp=s(50780),dp=s(28495),cp=s(76798);function up(e){let{title:t,items:s,loading:i,error:n}=e;window.__c={n:"AnalyticsCardList"};const a=(0,Je.yK)((e=>({title:{fontWeight:m.Z.fontWeight.semibold,marginBottom:8},container:{flex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",height:"100%",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,padding:12}})),[]);return(0,oe.jsxs)("div",{style:a.container,children:[(0,oe.jsx)(at.Z,{style:a.title,children:t}),i?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(pp,{}),(0,oe.jsx)(pp,{}),(0,oe.jsx)(pp,{}),(0,oe.jsx)(pp,{}),(0,oe.jsx)(pp,{})]}):n?(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(gp,{})}):s.map(((e,t)=>(0,oe.jsx)(mp,{item:e},t)))]})}function mp(e){let{item:t}=e;window.__c={n:"CardListItem"};const{store:s,caption:i}=t,n=(0,p.useIntl)(),o=hp(),r=(0,a.VK)((()=>{switch(s.table){case"block":return(0,oe.jsxs)("div",{style:o.nameAndIconContainer,children:[(0,oe.jsx)(pn.Z,{icon:s.getIcon(),size:18,isEmptyPage:!1,disabled:!0}),(0,oe.jsx)(cp.Z,{store:s})]});case"notion_user":return(0,oe.jsxs)("div",{style:o.nameAndIconContainer,children:[(0,oe.jsx)(wn.Z,{userStore:s,size:18}),(0,oe.jsx)(at.Z,{children:s.getDisplayName(n)})]});case"team":const e=s.getName();return(0,oe.jsxs)("div",{style:o.nameAndIconContainer,children:[(0,oe.jsx)(yn.p,{disabled:!0,store:s,size:20}),(0,oe.jsx)(at.Z,{children:e})]});default:(0,me.t1)(s)}}),[s,o.nameAndIconContainer,n]);return(0,oe.jsxs)("div",{style:o.container,children:[(0,oe.jsx)(at.Z,{style:o.label,children:r}),(0,oe.jsx)("div",{style:o.caption,children:(0,oe.jsx)(at.Z,{isSecondaryColor:!0,isSmall:!0,children:i})})]})}function pp(){window.__c={n:"LoadingCardListItem"};const e=hp();return(0,oe.jsxs)("div",{style:e.container,children:[(0,oe.jsx)(at.Z,{style:e.label,children:(0,oe.jsx)(Ct.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})}),(0,oe.jsx)("div",{style:e.loadingCaption,children:(0,oe.jsx)(Ct.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})})]})}function gp(){window.__c={n:"ErrorCardListItem"};const e=hp();return(0,oe.jsx)("div",{style:e.container,children:(0,oe.jsx)(at.Z,{style:e.errorLabel,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceAnalytics.basicErrorMessage",defaultMessage:"Something went wrong.{br}Try refreshing the page.",values:{br:(0,oe.jsx)("br",{})}})})})}function hp(){return(0,Je.yK)((e=>({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBlock:4,gap:4},nameAndIconContainer:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:8,alignItems:"center",width:"100%"},label:{width:"100%"},caption:{display:"flex",justifyContent:"center",alignItems:"center"},loadingCaption:{display:"block",width:"50%"},errorLabel:{width:"100%",textAlign:"center",color:et.ZP.red}})),[])}function fp(e){let{data:t,loading:s,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"ContentEngagement"};const l=(0,T.O7)(),d=(0,Je.yK)((e=>({title:{fontWeight:m.Z.fontWeight.medium,fontSize:16,marginBlock:"9px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},overviewCard:{width:"fit-content"}})),[]),[c,u]=(0,Dm.e)(),{pageViews:g,uniquePageViews:h,pageEdits:y,topPages:x}=t,v=(0,a.VK)((()=>x.map((e=>{let{pageId:t,pageViews:s}=e;return{store:new He.G(l,{id:t,table:Vt.iU}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:(0,oe.jsx)(Bm,{abbreviateNumber:!1,num:s})}})}}))),[l,x]),S=(0,i.useCallback)((e=>{r(e),f.m0A(l,{filter:"content_engagement",daysFilter:e})}),[l,r]);return(0,oe.jsxs)("div",{style:d.container,ref:c,children:[(0,oe.jsxs)("div",{style:d.titleContainer,children:[(0,oe.jsxs)(at.Z,{style:d.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.title",defaultMessage:"Content engagement"}),(0,oe.jsx)(te.Z,{placement:Bt.u.Bottom,render:e=>(0,oe.jsx)(Xr.Z,{...e,href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:d.helpInfo}),renderTooltip:()=>"all_time"!==o?(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all pages in the workspace over the {dateRange}",values:{dateRange:D.default.formatMessage(zt.xX[o])}}):(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace"})})]}),(0,oe.jsx)(Nm.f,{currentFilter:o,onChangeFilter:S})]}),(0,oe.jsxs)(td.rj,{gap:16,children:[(0,oe.jsx)(td.r8,{row:1,col:1,colEnd:3,children:(0,oe.jsx)(Lm,{loading:s,error:n,icon:Am.N,textStyles:d.overviewCard,title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.views",defaultMessage:"{pageViews} total views",values:{pageViews:(0,oe.jsx)(Bm,{abbreviateNumber:u<640,num:g})}})})}),(0,oe.jsx)(td.r8,{row:2,col:1,colEnd:3,children:(0,oe.jsx)(Lm,{loading:s,error:n,icon:dp.v,textStyles:d.overviewCard,iconStyles:{height:18,width:18},title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews} unique page views",values:{uniquePageViews:(0,oe.jsx)(Bm,{abbreviateNumber:u<640,num:h})}})})}),(0,oe.jsx)(td.r8,{row:3,col:1,colEnd:3,children:(0,oe.jsx)(Lm,{loading:s,error:n,icon:lp.E,textStyles:d.overviewCard,iconStyles:{height:18,width:18},title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,oe.jsx)(Bm,{abbreviateNumber:u<640,num:y})}})})}),(0,oe.jsx)(td.r8,{row:1,rowEnd:4,col:3,colEnd:5,children:(0,oe.jsx)(up,{loading:s,error:n,title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.popularPages",defaultMessage:"Most popular pages"}),items:v})})]})]})}function yp(e){let{data:t,loading:s,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"UserEngagement"};const l=(0,T.O7)(),{activeMembersCount:d,previousActiveMembersCount:c,activeGuestsCount:u,previousActiveGuestsCount:g,topTeamspaces:h,topViewers:y,topEditors:x}=t,v=(0,Je.yK)((e=>({title:{fontWeight:m.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},summaryCard:{height:70},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16}})),[]),[S,b]=(0,Dm.e)(),M=(0,i.useCallback)((e=>{f.m0A(l,{filter:"user_engagement",daysFilter:e}),r(e)}),[l,r]),j=(0,a.VK)((()=>h.map((e=>{let{teamspaceId:t,pageViews:s}=e;return{store:new He.zX(l,{id:t,table:Kt.e0}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageViews",defaultMessage:"{pageViews} views",values:{pageViews:(0,oe.jsx)(Bm,{abbreviateNumber:!0,num:s})}})}})).filter((e=>e.store.canRead())).slice(0,5)),[l,h]),w=(0,a.VK)((()=>y.map((e=>{let{userId:t,pageViews:s}=e;return{store:new He.U6(l,{id:t,table:F.KJ}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:(0,oe.jsx)(Bm,{abbreviateNumber:!0,num:s})}})}})).slice(0,5)),[l,y]),C=(0,a.VK)((()=>x.map((e=>{let{userId:t,pageEdits:s}=e;return{store:new He.U6(l,{id:t,table:F.KJ}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,oe.jsx)(Bm,{abbreviateNumber:!0,num:s})}})}})).slice(0,5)),[l,x]);return(0,oe.jsxs)("div",{style:v.container,ref:S,children:[(0,oe.jsxs)("div",{style:v.titleContainer,children:[(0,oe.jsxs)(at.Z,{style:v.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.title",defaultMessage:"User engagement"}),(0,oe.jsx)(te.Z,{placement:Bt.u.Bottom,render:e=>(0,oe.jsx)(Xr.Z,{...e,href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:v.helpInfo}),renderTooltip:()=>"all_time"!==o?(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",values:{dateRange:D.default.formatMessage(zt.xX[o])}}):(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace"})})]}),(0,oe.jsx)(Nm.f,{currentFilter:o,onChangeFilter:M})]}),(0,oe.jsxs)(td.rj,{gap:16,children:[(0,oe.jsx)(td.r8,{row:1,col:1,children:(0,oe.jsx)(Lm,{style:v.summaryCard,loading:s,error:n,title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",values:{activeMembersCount:(0,oe.jsx)(Bm,{abbreviateNumber:b<640,num:d})}}),byline:void 0!==c?(0,oe.jsx)(xp,{userType:"members",daysFilter:o,count:d,previousCount:c}):null})}),(0,oe.jsx)(td.r8,{row:1,col:2,children:(0,oe.jsx)(Lm,{style:v.summaryCard,loading:s,error:n,title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",values:{activeGuestsCount:(0,oe.jsx)(Bm,{abbreviateNumber:b<640,num:u})}}),byline:void 0!==g?(0,oe.jsx)(xp,{userType:"guests",daysFilter:o,count:u,previousCount:g}):null})})]}),(0,oe.jsxs)(td.rj,{gap:16,children:[(0,oe.jsx)(td.r8,{row:1,col:1,children:(0,oe.jsx)(up,{loading:s,error:n,title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeTeamspaces",defaultMessage:"Most active teamspaces"}),items:j})}),(0,oe.jsx)(td.r8,{row:1,col:2,children:(0,oe.jsx)(up,{loading:s,error:n,title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeViewers",defaultMessage:"Most active viewers"}),items:w})}),(0,oe.jsx)(td.r8,{row:1,col:3,children:(0,oe.jsx)(up,{loading:s,error:n,title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeEditors",defaultMessage:"Most active editors"}),items:C})})]})]})}function xp(e){let{userType:t,daysFilter:s,count:i,previousCount:n}=e;window.__c={n:"MetricsChangeMessage"};const a=0===i&&0===n?0:Math.round((i-n)/n*100);let o;o=a===1/0?function(e,t,s){if("all_time"===s)return(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet"});return"guests"===e?(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.guests.positive",defaultMessage:"{changeValue} more guests than previous {numberOfDays} days",values:{changeValue:t.toLocaleString(),numberOfDays:zt.ez[s].toLocaleString()}}):(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.members.positive",defaultMessage:"{changeValue} more members than previous {numberOfDays} days",values:{changeValue:t.toLocaleString(),numberOfDays:zt.ez[s].toLocaleString()}})}(t,i,s):function(e,t){switch(t){case"all_time":return 0===e?(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet"}):e>0?(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.positive",defaultMessage:"{changeInPercentage}% more since the start",values:{changeInPercentage:Math.abs(e)}}):(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.negative",defaultMessage:"{changeInPercentage}% less since the start",values:{changeInPercentage:Math.abs(e)}});case"last_90_days":return 0===e?(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.none",defaultMessage:"No changes in previous 90 days"}):e>0?(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.positive",defaultMessage:"{changeInPercentage}% more than previous 90 days",values:{changeInPercentage:Math.abs(e)}}):(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.negative",defaultMessage:"{changeInPercentage}% less than previous 90 days",values:{changeInPercentage:Math.abs(e)}});case"last_28_days":return 0===e?(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.none",defaultMessage:"No changes in previous 28 days"}):e>0?(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.positive",defaultMessage:"{changeInPercentage}% more than previous 28 days",values:{changeInPercentage:Math.abs(e)}}):(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.negative",defaultMessage:"{changeInPercentage}% less than previous 28 days",values:{changeInPercentage:Math.abs(e)}});case"last_7_days":return 0===e?(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.none",defaultMessage:"No changes in previous 7 days"}):e>0?(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.positive",defaultMessage:"{changeInPercentage}% more than previous 7 days",values:{changeInPercentage:Math.abs(e)}}):(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.negative",defaultMessage:"{changeInPercentage}% less than previous 7 days",values:{changeInPercentage:Math.abs(e)}});default:(0,me.t1)(t)}}(a,s);const r=a>0?(0,Pa.J)({height:12,width:12,fill:"currentColor"}):a<0?(0,Pa.J)({height:12,width:12,transform:"rotate(90deg)",fill:"currentColor"}):void 0,l=(0,Je.yK)((e=>({text:{color:a>0?e.accentColors.green[500]:a<0?e.accentColors.red[500]:e.lightTextColor,display:"flex",alignItems:"center",gap:4}})),[a]);return(0,oe.jsxs)("span",{style:l.text,children:[r,o]})}function vp(e){var t,s;let{onUserTabFilterChange:i,spaceStore:n,contentEngagement:o,userEngagement:r}=e;window.__c={n:"SpaceAnalyticsOverviewTab"};const l=(0,Je.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:24}})),[]),d=(0,a.VK)((()=>n.getName()),[n]);if("NotFoundError"===(null===(t=o.error)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(s=r.error)||void 0===s?void 0:s.name))return(0,oe.jsx)(Fm,{type:"empty",spaceName:d});return(0,oe.jsxs)("div",{style:l.container,children:[(0,oe.jsx)(yp,{data:r.data,loading:r.loading,error:r.error,daysFilter:r.daysFilter,setDaysFilter:function(e){i({graphFilter:"all_time"===e?"last_90_days":e}),r.setDaysFilter(e)}}),(0,oe.jsx)(fp,{data:o.data,loading:o.loading,error:o.error,daysFilter:o.daysFilter,setDaysFilter:o.setDaysFilter})]})}const Sp={field:"num_searches",direction:"desc"},bp=bm,Mp={sort:Sp,timeRange:bp,searchAnalyticsDataList:[],numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};const jp=(0,p.defineMessages)({numSearches:{id:"workspaceAnalytics.searchTab.searchTable.searches.tooltip",defaultMessage:"Number of times users in the workspace have searched the query"},numUniqueUsers:{id:"workspaceAnalytics.searchTab.searchTable.uniqueSearches.tooltip",defaultMessage:"Total number of users that have searched the query"},ctr:{id:"workspaceAnalytics.searchTab.searchTable.ctr.tooltip",defaultMessage:"Percentage of times users have opened page from results of this query"}}),wp=(0,p.defineMessages)({queryText:{id:"spaceAnalyticsSearchTable.column.query",defaultMessage:"Query"},numSearches:{id:"spaceAnalyticsSearchTable.column.searches",defaultMessage:"Searches"},numUniqueUsers:{id:"spaceAnalyticsSearchTable.column.uniqueSearches",defaultMessage:"Unique searches"},ctr:{id:"spaceAnalyticsSearchTable.column.ctr",defaultMessage:"Click-through rate"}}),Cp={queryText:{id:"queryText",headerTitle:D.default.formatMessage(wp.queryText),renderCell:e=>(0,oe.jsx)(at.Z,{children:e.queryText}),widthData:{width:200,maxWidth:300},sortable:!1},numSearches:{id:"numSearches",headerTitle:(0,oe.jsx)(Vm,{tooltipMessageDescriptor:jp.numSearches,columnHeader:wp.numSearches}),renderCell:e=>(0,oe.jsx)(Ip,{value:e.numSearches}),widthData:{width:120,maxWidth:120},sortable:!0},numUniqueUsers:{id:"numUniqueUsers",headerTitle:(0,oe.jsx)(Vm,{tooltipMessageDescriptor:jp.numUniqueUsers,columnHeader:wp.numUniqueUsers}),renderCell:e=>(0,oe.jsx)(Ip,{value:e.numUniqueUsers}),widthData:{width:120,maxWidth:120},sortable:!0},ctr:{id:"ctr",headerTitle:(0,oe.jsx)(Vm,{tooltipMessageDescriptor:jp.ctr,columnHeader:wp.ctr}),renderCell:e=>(0,oe.jsx)(Ip,{value:Math.round(1e3*e.ctr)/1e3,isPercentage:!0}),widthData:{width:120,maxWidth:120},sortable:!0}},kp=(0,me.Yd)(Cp).map((e=>Cp[e]));function Tp(e){let{searchAnalyticsDataList:t,runNewSearch:s,sort:n,setSort:o,loadNextPage:r,loading:l,error:d}=e;window.__c={n:"SpaceAnalyticsTable"};const c=(0,a.VK)((()=>t.map((e=>({id:e.queryText,isClickable:!1,...e})))),[t]),u=(0,i.useMemo)((()=>function(e){const t=zt.Fi[e.field];if(!t)return;return{column:Cp[t],sortAscending:"asc"===e.direction}}(n)),[n]),m=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:kp,theme:e,containerMarginTop:0})),[]),g=(0,Je.yK)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return d?(0,oe.jsx)(Ai,{error:d,runNewSearch:s}):(0,oe.jsxs)("div",{children:[(0,oe.jsx)(Pt.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:kp,rows:c,sortState:u,onSortStateChanged:e=>{o(function(e){const t=zt.hx[e.column.id],s=e.sortAscending?"asc":"desc";if(!t)return{field:"num_searches",direction:s};return{field:t,direction:s}}(e))},onScrollBottom:r,renderNoRowsComponent:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:g.emptyQuery,children:!l&&0===t.length&&(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.searchTable.table.empty",defaultMessage:"No search query analytics to display."})}),styles:m}),l?(0,oe.jsx)(Ti.Z,{style:g.loadingSpinner}):null]})}function Ip(e){let{value:t,isPercentage:s}=e;window.__c={n:"CenteredNumericCell"};const i=(0,Je.yK)((e=>({centered:{width:"100%",textAlign:"center"}})),[]),n=s?`${t}%`:t;return(0,oe.jsx)(at.Z,{style:i.centered,children:n})}function Pp(e){window.__c={n:"SpaceAnalyticsSearchTab"};const{spaceStore:t}=e,s=(0,Je.yK)((()=>({header:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontWeight:m.Z.fontWeight.semibold,fontSize:16,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4}})),[]),n=(0,i.useRef)(!1),{searchAnalyticsDataList:o,timeRange:r,sort:d,loading:c,error:u,loadNextPage:g,runNewSearch:h,setTimeRange:y,setSort:x}=function(e){let{spaceStore:t}=e;const s=(0,T.O7)(),[n,a]=(0,i.useState)(Mp),o=(0,i.useRef)(Sp),r=(0,i.useRef)(bp),d=(0,p.useIntl)(),c=(0,i.useCallback)((async e=>{let{fetchFromFirstPage:i,ignoreSearchInputComparison:d}=e;const c=!l.Xy(n.sort,o.current)||!l.Xy(n.timeRange,r.current);if(!d&&!c)return;o.current=n.sort,r.current=n.timeRange;let u=n.loading,m=n.error,p=n.hasNextPage,g=n.paginationToken;if(i&&(a((e=>({...Mp,timeRange:e.timeRange,sort:e.sort}))),u=Mp.loading,m=Mp.error,p=Mp.hasNextPage,g=Mp.paginationToken),!p||u)return;if(m)return;a((e=>({...e,loading:!0})));const h=await M.loadSearchAnalytics(s,{spaceId:t.id,sort:n.sort,timeRange:n.timeRange,startCursor:g});if("failed"===h.type)return void a((e=>({...e,loading:!1,error:h})));const f=h.data.results;a((e=>{const t=[],s=new Set(e.searchAnalyticsDataList.map((e=>e.queryText)));for(const n of f){const e=n.queryText;s.has(e)||(t.push(n),s.add(e))}const i=[...e.searchAnalyticsDataList,...t];return{...e,searchAnalyticsDataList:i,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:h.data.nextCursor,hasNextPage:Boolean(h.data.nextCursor)}}))}),[s,t,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]);(0,i.useEffect)((()=>{n.shouldReRunSearch&&(a((e=>({...e,shouldReRunSearch:!1}))),c({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,c]);const u=(0,i.useCallback)((async()=>{n.shouldReRunSearch||await c({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,c]),m=(0,i.useCallback)((async e=>{await c({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[c]),g=(0,i.useCallback)((e=>{"all_time"!==e&&(a((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),f.yef(s,{daysFilter:e}))}),[s]),h=(0,i.useCallback)((e=>{a((t=>({...t,sort:e,shouldReRunSearch:!0}))),f.$fF(s,{column:e.field,isAscending:"asc"===e.direction})}),[s]),y=(0,i.useMemo)((()=>{if(n.error)return 404===n.error.status?new P.dR({message:(0,R.wf)(d,n.error)}):new Error((0,R.wf)(d,n.error))}),[n.error,d]);return{...n,error:y,loadNextPage:u,runNewSearch:m,setTimeRange:g,setSort:h}}({spaceStore:t});(0,i.useEffect)((()=>{n.current||(h(!0),n.current=!0)}),[h]);const v=(0,a.VK)((()=>t.getName()),[t]);return"NotFoundError"===(null==u?void 0:u.name)?(0,oe.jsx)(Fm,{type:"empty",spaceName:v}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("div",{style:s.header,children:[(0,oe.jsxs)(at.Z,{style:s.sectionTitle,children:[(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.title",defaultMessage:"Search queries"}),(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Bottom,render:e=>(0,oe.jsx)(Xr.Z,{...e,href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:s.helpInfo}),renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.tooltip",defaultMessage:"Displays popular search queries in the workspace from the {dateRange}",values:{dateRange:D.default.formatMessage(zt.xX[r])}})})]}),(0,oe.jsx)(Nm.f,{currentFilter:r,onChangeFilter:y,hideAllTime:!0})]}),(0,oe.jsx)(Tp,{searchAnalyticsDataList:o,runNewSearch:h,sort:d,setSort:x,loadNextPage:g,loading:c,error:u})]})}var _p=s(30251);function Zp(e){let{data:t,loading:s,error:i,daysFilter:n,setDaysFilter:a}=e;window.__c={n:"UsersAnalyticsSummaries"};const[o,r]=(0,Dm.e)(),l=(0,Je.yK)((e=>({title:{fontWeight:m.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},container:{display:"flex",flexDirection:"column",gap:16},helpInfo:{marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},summaryCard:{height:70},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{activeMembersCount:d,previousActiveMembersCount:c,activeGuestsCount:u,previousActiveGuestsCount:g}=t;return(0,oe.jsxs)("div",{style:l.container,ref:o,children:[(0,oe.jsxs)("div",{style:l.titleContainer,children:[(0,oe.jsxs)(at.Z,{style:l.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.title",defaultMessage:"User engagement"}),(0,oe.jsx)(te.Z,{placement:Bt.u.Bottom,render:e=>(0,oe.jsx)(Xr.Z,{...e,href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:l.helpInfo}),renderTooltip:()=>"all_time"!==n?(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",values:{dateRange:D.default.formatMessage(zt.xX[n])}}):(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace"})})]}),(0,oe.jsx)(Nm.f,{currentFilter:n,onChangeFilter:a})]}),(0,oe.jsxs)(td.rj,{gap:16,children:[(0,oe.jsx)(td.r8,{row:1,col:1,children:(0,oe.jsx)(Lm,{style:l.summaryCard,loading:s,error:i,title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",values:{activeMembersCount:(0,oe.jsx)(Bm,{abbreviateNumber:r<640,num:d})}}),byline:void 0!==c?(0,oe.jsx)(xp,{userType:"members",daysFilter:n,count:d,previousCount:c}):null})}),(0,oe.jsx)(td.r8,{row:1,col:2,children:(0,oe.jsx)(Lm,{style:l.summaryCard,loading:s,error:i,title:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",values:{activeGuestsCount:(0,oe.jsx)(Bm,{abbreviateNumber:r<640,num:u})}}),byline:void 0!==g?(0,oe.jsx)(xp,{userType:"guests",daysFilter:n,count:u,previousCount:g}):null})})]})]})}var Fp=s(44643),Ap=s(88775);const Rp=(0,p.defineMessages)({page_views:{id:"workspaceAnalytics.usersTab.usersTable.pageViews.tooltip",defaultMessage:"Total number of page views for the user across all pages in the workspace"},page_edits:{id:"workspaceAnalytics.usersTab.usersTable.pageEdits.tooltip",defaultMessage:"Total number of page edits for the user across all pages in the workspace"}}),Dp=(0,p.defineMessages)({user:{id:"spaceAnalyticsUsersTab.column.user",defaultMessage:"User"},page_views:{id:"spaceAnalyticsUsersTab.column.pageViews",defaultMessage:"Page views"},page_edits:{id:"spaceAnalyticsUsersTab.column.pageEdits",defaultMessage:"Page edits"},last_active:{id:"spaceAnalyticsUsersTab.column.lastActive",defaultMessage:"Last active"},teams:{id:"spaceAnalyticsUsersTab.column.teams",defaultMessage:"Teamspaces"}}),Bp={user:{id:"user",renderCell:function(e){window.__c={n:"UserCell"};const t=(0,Je.yK)((e=>({container:{height:52}})),[]);return(0,oe.jsx)(Zt.Z,{containerStyle:t.container,actorStore:e.userStore,spaceRole:e.role&&(0,Zt.K)(e.role)})},headerTitle:D.default.formatMessage(Dp.user),widthData:{width:100},sortable:!1},page_views:{id:"page_views",renderCell:function(e){window.__c={n:"PageViewsCell"};const{page_views:t}=e,s=(0,Je.yK)((e=>({eyeHideIcon:{width:20,height:20,color:e.lightIconColor},cell:{marginLeft:10}})),[]);if(void 0===t)return(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Bottom,render:e=>(0,oe.jsx)("div",{...e,children:(0,Fp.L)(s.eyeHideIcon)}),renderTooltip:e=>(0,oe.jsx)(p.FormattedMessage,{id:"spaceAnalyticsUsersTab.optedOutUser.icon.tooltip",defaultMessage:"User has disabled page view tracking"})});return(0,oe.jsx)(at.Z,{children:t})},headerTitle:(0,oe.jsx)(Vm,{tooltipMessageDescriptor:Rp.page_views,columnHeader:Dp.page_views}),widthData:{width:80},sortable:!0},page_edits:{id:"page_edits",renderCell:function(e){const{page_edits:t}=e;return(0,oe.jsx)(at.Z,{children:t})},headerTitle:(0,oe.jsx)(Vm,{tooltipMessageDescriptor:Rp.page_edits,columnHeader:Dp.page_edits}),widthData:{width:80},sortable:!0},last_active:{id:"last_active",renderCell:function(e){const t=e.last_active;let s;s=t?(0,oe.jsx)(Ii.T,{dateTs:t}):(0,oe.jsx)(at.Z,{isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userTable.lastActiveTimestamp.noLastActive",defaultMessage:"No activity"})});return(0,oe.jsx)("div",{children:s})},headerTitle:D.default.formatMessage(Dp.last_active),widthData:{width:50},sortable:!0},teams:{id:"teams",renderCell:function(e){const{userStore:t,role:s}=e;if(!s)return(0,oe.jsx)(at.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.teamsColumn.guest",defaultMessage:"None"})});return(0,oe.jsx)(Ap.ZP,{member:{userId:t.id,role:s}})},headerTitle:D.default.formatMessage(Dp.teams),widthData:{width:50},sortable:!1}};const Lp=(0,me.Yd)(Bp).map((e=>Bp[e]));function Np(e){window.__c={n:"UsersTable"};const t=(0,T.O7)(),[s,n]=(0,i.useState)(25),{usersAndStats:o,filter:r,onUserTabFilterChange:l,usersAndStatsError:d}=e,c=(0,a.VK)((()=>{const{currentSpaceStore:e}=ie.default.state,t=(null==e?void 0:e.getPermissionItems().filter(Ei.jg))||[],s={};for(const i of t)s[i.user_id]=i.role;return s}),[]),[u,m]=(0,i.useState)({column:Bp.last_active,sortAscending:!1}),g=(0,i.useCallback)((e=>{f.gEE(t,{column:e.column.id,isAscending:e.sortAscending}),m(e)}),[m,t]),h=o.map((e=>{let{userStore:t,stats:s}=e;return{id:s.userId,userStore:t,isClickable:!1,last_active:s.lastActive,page_views:s.numPageViews,page_edits:s.numPageEdits,role:c[s.userId]}})).sort(function(e){switch(e.column.id){case"last_active":return(t,s)=>(0,zt.Zj)(t.last_active,s.last_active,e.sortAscending);case"page_views":return(t,s)=>(0,zt.yM)(t.page_views,s.page_views,e.sortAscending);case"page_edits":return(t,s)=>e.sortAscending?t.page_edits-s.page_edits:s.page_edits-t.page_edits;default:return(e,t)=>0}}(u)),y=(0,i.useMemo)((()=>h.slice(0,s)),[h,s]),x=(0,Je.yK)((e=>({error:{color:et.ZP.red},dateFilterPill:{display:"flex",marginTop:10,marginBottom:15,flexFlow:"row",alignItems:"center"},timeFilterDescription:{marginRight:5}})),[]);const v=(0,i.useCallback)((e=>{f.IwD(t,{daysFilter:e}),l({tableFilter:e})}),[t,l]),S=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:Lp,theme:e,containerMarginTop:0})),[]);return(0,oe.jsxs)(oe.Fragment,{children:[d&&(0,oe.jsx)(at.Z,{isMultiline:!1,style:x.error,children:d}),(0,oe.jsxs)("div",{style:x.dateFilterPill,children:[(0,oe.jsx)(at.Z,{isSecondaryColor:!0,style:x.timeFilterDescription,children:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.timeFilter.description",defaultMessage:"Views and edits from"})}),(0,oe.jsx)(Nm.f,{currentFilter:r,onChangeFilter:v})]}),(0,oe.jsx)(Pt.D,{allowHorizontalScroll:!0,hideHeaderRowPadding:!0,setStickyHeaderRow:!0,maxHeight:500,sortState:u,onSortStateChanged:g,columnRenderInfo:Lp,rows:y,renderNoRowsComponent:()=>(0,oe.jsx)("div",{children:"N/A"}),styles:S,onScrollBottom:function(){s<o.length&&n(s+25)}})]})}function Op(e){var t,s;let{spaceStore:n,usersTabData:o,onUserTabFilterChange:r,userEngagement:l}=e;window.__c={n:"SpaceAnalyticsUsersTab"};const[d,c]=(0,Dm.e)(),u=(0,Je.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},sectionTitle:{fontWeight:m.Z.fontWeight.medium,fontSize:16},sectionTitleLeft:{marginBlock:"8px 4px",marginBottom:5,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-around"},numUsersCaption:{display:"flex"},overviewText:{textAlign:"center"},error:{color:et.ZP.red},tableHeader:{marginTop:20,flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"end"},tooltip:{marginLeft:3},infoIcon:{height:14,width:14,color:e.mediumTextColor}})),[]),g=(0,T.O7)(),h=(0,p.useIntl)(),y=(0,i.useCallback)((e=>{f.KCu(g,{daysFilter:e});r({graphFilter:"all_time"===e?"last_90_days":e}),l.setDaysFilter(e)}),[r,l,g]),x=(0,a.VK)((()=>n.getName()),[n]);if("NotFoundError"===(null==o||null===(t=o.usersAndStatsError)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(s=l.error)||void 0===s?void 0:s.name))return(0,oe.jsx)(Fm,{type:"empty",spaceName:x});const v=Math.floor(c-8);return(0,oe.jsxs)("div",{style:u.container,children:[(0,oe.jsx)(Zp,{data:l.data,loading:l.loading,error:l.error,daysFilter:l.daysFilter,setDaysFilter:y}),(0,oe.jsx)(Ep,{children:(0,oe.jsx)("div",{ref:d,children:o?(0,oe.jsx)(Vp,{width:v,dailyUsersData:o.dailyUsersData,userEngagementDaysFilter:l.daysFilter,daysFilter:o.graphFilter,dailyUsersError:o.dailyUsersError&&Cm(o.dailyUsersError,h)}):(0,oe.jsx)(Up,{})})}),(0,oe.jsxs)("div",{style:u.tableHeader,children:[(0,oe.jsxs)("div",{style:u.sectionTitleLeft,children:[(0,oe.jsx)(at.Z,{style:u.sectionTitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.allUsers.title",defaultMessage:"All members in Notion"})}),(0,oe.jsx)(te.Z,{placement:Bt.u.Bottom,render:e=>(0,oe.jsx)(Xr.Z,{...e,href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:u.helpInfo}),renderTooltip:()=>o&&"all_time"!==o.tableFilter?(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.lastDays",defaultMessage:"Per member workspace activity over the {dateRange}",values:{dateRange:D.default.formatMessage(zt.xX[o.tableFilter])}}):(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.allTime",defaultMessage:"All time per member workspace activity"})})]}),(0,oe.jsx)(Im,{analyticsType:ti.Users})]}),o?(0,oe.jsx)(Np,{filter:o.tableFilter,usersAndStats:o.usersAndStats,onUserTabFilterChange:r,usersAndStatsError:o.usersAndStatsError&&Cm(o.usersAndStatsError,h)}):null]})}function Ep(e){window.__c={n:"DisplayBox"};const t=(0,Je.yK)((e=>({border:{borderRadius:4,overflow:"hidden",border:`1px solid ${e.regularDividerColor}`,backgroundColor:e.contentBackground,color:e.regularTextColor,padding:20}})),[]);return(0,oe.jsx)("div",{style:t.border,children:e.children})}function Vp(e){window.__c={n:"UsersOverTimeGraph"};const{width:t,dailyUsersData:s,userEngagementDaysFilter:i,daysFilter:n,dailyUsersError:o}=e,r=(0,Je.yK)((e=>({graphHeader:{marginBottom:10,display:"flex",justifyContent:"space-between"},graphTitle:{fontSize:m.Z.fontSize.UIRegular.desktop,fontWeight:"bolder",display:"flex",alignItems:"center",height:24},graphCaption:{fontSize:m.Z.fontSize.UISmall.desktop},graphTooltip:{marginLeft:5,width:14,height:14},helpInfo:{marginLeft:4},emptyGraphBody:{textAlign:"center",paddingTop:50,paddingBottom:50},error:{color:et.ZP.red},graphSubLabel:{paddingTop:4,color:"grey"}})),[]),{blueLayer:l}=(0,_p.useTimeSeriesPalette)(),d=(0,a.VK)((()=>{if(0===s.length)return;return{startDate:s[0].ds,endDate:s[s.length-1].ds}}),[s]),c=(0,a.VK)((()=>s.map((e=>({ds:e.ds,values:{active_members:e.active_members||0}})))),[s]);let u;return u=!d||s.length<3?(0,oe.jsx)("div",{style:r.emptyGraphBody,children:(0,oe.jsx)(at.Z,{isSecondaryColor:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.emptyGraph",defaultMessage:"Not enough data to display graph"})})}):(0,oe.jsx)(Ji.LazyTimeSeries,{startDate:d.startDate,endDate:d.endDate,width:t,data:c,height:300,layers:[{key:"active_members",...l,renderLabel:e=>(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers",defaultMessage:"{activeMembers, plural, one {1 active member} other {{activeMembers} active members}}",values:{activeMembers:e}})}],renderTooltipSubLabel:()=>(0,oe.jsx)("div",{style:r.graphSubLabel,children:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers.sublabel",defaultMessage:"Viewed a page in the {dateRange}",values:{dateRange:D.default.formatMessage(zt.xX[n])}})})}),(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:r.graphHeader,children:(0,oe.jsxs)(at.Z,{style:r.graphTitle,children:[(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.membersOverTime.title",defaultMessage:"Active members over time"}),"all_time"===i&&(0,oe.jsx)(te.Z,{placement:Bt.u.Bottom,render:e=>(0,oe.jsx)(Xr.Z,{...e,href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:r.helpInfo}),renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.membersOverTime.allTimeTooltip",defaultMessage:"All Time selection shows members who have viewed a page in the last 90 days."})})]})}),o&&(0,oe.jsx)(at.Z,{isMultiline:!1,style:r.error,children:o}),u]})}function Up(){return(0,oe.jsxs)("div",{children:[(0,oe.jsx)(Ct.Z,{paragraphs:[{lineHeight:18,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]}),(0,oe.jsx)(Ct.Z,{paragraphs:[{lineHeight:300,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:12}]})]})}const Wp={[ti.Overview]:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalyticsTabs.overview.title",defaultMessage:"Overview"}),[ti.Users]:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members"}),[ti.Content]:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content"}),[ti.Search]:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalyticsTabs.search.title",defaultMessage:"Search"})};function Kp(e){const{currentTab:t,spaceAnalyticsStore:s,onUserTabFilterChange:i,spaceStore:n}=e;switch(t){case ti.Content:return(0,oe.jsx)(op,{spaceStore:n,contentEngagement:e.contentEngagementData});case ti.Users:return(0,oe.jsx)(Op,{spaceStore:n,usersTabData:s.usersTabData,onUserTabFilterChange:i,userEngagement:e.userEngagementData});case ti.Overview:return(0,oe.jsx)(vp,{contentEngagement:e.contentEngagementData,userEngagement:e.userEngagementData,spaceStore:n,onUserTabFilterChange:i});case ti.Search:return(0,oe.jsx)(Pp,{spaceStore:n});default:(0,me.t1)(t)}}const zp=function(e){let{spaceStore:t}=e;window.__c={n:"SpaceAnalytics"};const s=(0,Je.yK)((e=>({headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:m.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},title:{display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},tabsStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14}})),[]),n=(0,T.O7)(),o=(0,a.VK)((()=>{var e;return null===(e=ie.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),r=function(e){let{spaceId:t}=e;const s=(0,T.O7)(),[n,a]=(0,i.useState)("last_90_days"),[{status:o,value:r,error:l}]=(0,To.r5)((async()=>{const e=await M.getContentEngagementAnalytics(s,{spaceId:t,daysFilter:n});switch(e.type){case"success":return{pageViews:e.data.pageViews,uniquePageViews:e.data.uniquePageViews,pagesCreated:e.data.pagesCreated,pageEdits:e.data.pageEdits,topPages:e.data.topPages};case"failed":throw e.body;default:(0,me.t1)(e)}}),[s,t,n]);return{data:(0,i.useMemo)((()=>r||km),[r]),loading:"pending"===o||"idle"===o,error:l,daysFilter:n,setDaysFilter:a}}({spaceId:t.id}),l=function(e){let{spaceStore:t,userId:s}=e;const n=(0,T.O7)(),[a,o]=(0,i.useState)("last_90_days"),[{status:r,value:l,error:d}]=(0,To.r5)((async()=>{if(!s||!(0,Fa.wv)({permissions:t.getPermissionItems()},s))return Tm;const e=await M.getUserEngagementAnalytics(n,{spaceId:t.id,daysFilter:a});switch(e.type){case"success":return{activeMembersCount:e.data.activeMembersCount,previousActiveMembersCount:e.data.previousActiveMembersCount,activeGuestsCount:e.data.activeGuestsCount,previousActiveGuestsCount:e.data.previousActiveGuestsCount,topTeamspaces:e.data.topTeamspaces,topViewers:e.data.topViewers,topEditors:e.data.topEditors};case"failed":throw e.body;default:(0,me.t1)(e)}}),[n,t,s,a]);return{data:(0,i.useMemo)((()=>l||Tm),[l]),loading:"pending"===r||"idle"===r,error:d,daysFilter:a,setDaysFilter:o}}({spaceStore:t,userId:o}),[d,c]=(0,a.AF)(ii),u=(0,a.VK)((()=>Boolean(null==t?void 0:t.getSettings().disable_page_analytics)),[t]),g=(0,a.VK)((()=>null==t?void 0:t.getName()),[t]),h=(0,i.useCallback)((async e=>{await async function(e){var t,s,i;const{environment:n,spaceStore:a,spaceAnalyticsStore:o,setState:r,graphFilter:l,tableFilter:d}=e,c=l||(null===(t=o.usersTabData)||void 0===t?void 0:t.graphFilter)||bm,u=d||(null===(s=o.usersTabData)||void 0===s?void 0:s.tableFilter)||bm,m=(null===(i=o.usersTabData)||void 0===i?void 0:i.userTableSort)||Mm,[p,g]=await Promise.all([jm({environment:n,filter:c,spaceId:a.id,spaceAnalyticsStore:o}),wm({environment:n,filter:u,sort:m,spaceStore:a,spaceAnalyticsStore:o})]),h=(0,P.Rp)(p)||!p?[]:p,f=(0,P.Rp)(g)||!g?[]:g;r({currentSpaceId:a.id,currentTab:o.currentTab,usersTabData:{graphFilter:c,tableFilter:u,userTableSort:m,dailyUsersError:(0,P.Rp)(p)?p:void 0,dailyUsersData:h,usersAndStatsError:(0,P.Rp)(g)?g:void 0,usersAndStats:f}})}({environment:n,spaceStore:t,spaceAnalyticsStore:d,setState:c,graphFilter:e.graphFilter,tableFilter:e.tableFilter})}),[n,t,d,c]),y=(0,i.useCallback)((e=>{f.nKJ(n,{tab:e}),c({...d,currentTab:e})}),[c,d,n]),x=(0,a.VK)((()=>{const e=[];return function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(ti.Overview),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(ti.Users),e.push(ti.Content),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(ti.Search),e}),[t]),S=(0,a.VK)((()=>x.length>1),[x]),b=d.currentTab||x[0];(0,i.useEffect)((()=>{!async function(){const e=t.id;e&&ii.shouldRefreshState(e)&&(b===ti.Users?await h({graphFilter:"last_90_days",tableFilter:"last_90_days"}):b===ti.Content||b===ti.Overview||b===ti.Search||(0,me.t1)(b))}()}));const j=(0,i.useCallback)((()=>{v.navigateToExternalURL({environment:n,url:(0,Gs.UY)("guides.workspaceAnalytics")})}),[n]),w=(0,a.VK)((()=>t.getCreatedTime()<16593264e5),[t]),C=x.map((e=>Wp[e])),k=u?(0,oe.jsx)(Fm,{type:"disabled",spaceName:g}):(0,oe.jsxs)(oe.Fragment,{children:[S&&(0,oe.jsx)(mo.Z,{tabs:C,selectedIndex:x.indexOf(b),onChange:e=>{y(x[e])},style:s.tabsStyle}),Kp({currentTab:b,spaceAnalyticsStore:d,onUserTabFilterChange:h,spaceStore:t,contentEngagementData:r,userEngagementData:l})]});return(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsxs)(bt.Z,{large:!0,style:s.headingStyle,children:[(0,oe.jsxs)("div",{style:s.title,children:[(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics"}),w&&(0,oe.jsx)(te.Z,{placement:Bt.u.Right,render:e=>(0,oe.jsx)(Xr.Z,{...e,href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:s.helpInfo}),renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"settings.workspaceAnalytics.dataDisclaimerTooltip",defaultMessage:"Data available from August 1, 2022 onwards"})})]}),(0,oe.jsx)(St.Z,{isSmall:!0,onClick:j,icon:Do.m,children:(0,oe.jsx)(p.FormattedMessage,{id:"workspaceAnalytics.title.helpButton",defaultMessage:"Learn more"})})]}),wi.Z.renderDivider(),k]})};var qp=s(11751),Gp=s(86080);var Hp=s(24215),Qp=s(64251),Yp=s(33293),$p=s(17329),Jp=s(13630);const Xp=function(e){let{handleExportClick:t}=e;window.__c={n:"ExportSpaceTab"};const s=(0,a.VK)((()=>ie.default.state),[]),{currentSpaceStore:n}=s,o=(0,a.VK)((()=>Jp.Z.state),[]),r=(0,T.O7)();return(0,i.useEffect)((()=>{H.zh({environment:r,spaceId:null==n?void 0:n.id})}),[null==n?void 0:n.id,r]),(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)(bt.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.title",defaultMessage:"Export content"})}),(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,oe.jsx)(St.Z,{disabled:!!o.count,isLarge:!0,onClick:t,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportButton.label",defaultMessage:"Export all workspace content"})}),o.count?(0,oe.jsxs)(dc.gq,{gap:4,children:[(0,oe.jsx)(Ti.Z,{}),(0,oe.jsx)(at.Z,{isSmall:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportInProgress",defaultMessage:"Export in progress"})})]}):(0,oe.jsx)(oe.Fragment,{})]}),(0,oe.jsx)("div",{style:{height:12}}),(0,oe.jsx)(Xr.Z,{title:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.helpButton.caption",defaultMessage:"Learn about exporting workspaces."}),href:(0,Gs.UY)("guides.exportWorkspace"),analyticsFrom:"space_settings"}),wi.Z.renderDivider()]})};var eg=s(44071),tg=s(33411);const sg=(0,p.defineMessages)({workspaceDomainInputPlaceholder:{id:"spaceBasicSettingsDomain.domainSection.workspaceDomainInput.placeholder",defaultMessage:"Your domain"},copyDomainTooltip:{id:"spaceBasicSettingsDomain.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}}),ig=(e,t)=>{const s=t=>(0,oe.jsx)(te.Z,{delayThreshold:0,renderTooltip:()=>D.default.formatMessage(sg.copyDomainTooltip),render:s=>(0,oe.jsx)(co.Z,{onClick:()=>{It.RD({environment:e,stringValue:t,copiedMessage:It.tq.copiedLinkToClipboard})},...s,children:t})});return(0,oe.jsxs)("div",{style:{paddingTop:8},children:[(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.viewPublicPage.caption",defaultMessage:"Pages shared to web will be under {linkText}.",values:{linkText:s(`${t}.${Mt.default.publicDomainName}`)}}),(0,oe.jsx)("div",{style:{paddingTop:6}}),(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.joinWorkspace.caption",defaultMessage:"Anyone with an allowed email domain can join this workspace via {linkText}.",values:{linkText:s(`${window.location.host}/${t}`)}})]})},ng=()=>{window.__c={n:"AvailableField"};const e=(0,Je.Fg)();return(0,oe.jsxs)("div",{style:{color:e.invoiceGreen,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,fc.r)({height:16,width:16,margin:"0 4px 0 8px",color:e.invoiceGreen}),(0,oe.jsx)("span",{children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Available",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.available"})})]})},ag=()=>(0,oe.jsxs)("div",{style:{color:et.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,ul.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,oe.jsx)("span",{children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Used",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.used"})})]}),og=()=>(0,oe.jsxs)("div",{style:{color:et.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,ul.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,oe.jsx)("span",{children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Not allowed",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.notAllowed"})})]}),rg=()=>(0,oe.jsx)(tg.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,oe.jsx)(Ti.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),lg=e=>{window.__c={n:"SpaceBasicSettingsDomain"};const[t,s]=(0,a.AF)(e.spaceBasicSettingsStore),{domain:n,domainState:o}=t,r=(0,T.O7)(),l=(0,Je.Fg)(),[d,c]=(0,i.useState)(!0),u=i.createRef();return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(bt.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.domainSection.title",defaultMessage:"Domain"})}),(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,oe.jsx)("div",{style:{background:l.inputBackground,borderRadius:4,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex"},children:(0,oe.jsx)(_e.Z,{type:"text",style:{background:"none",boxShadow:"none",padding:"4px 6px",width:255},ref:u,value:n,placeholder:D.default.formatMessage(sg.workspaceDomainInputPlaceholder),readOnly:!e.canAdminSpaceStore,onChange:e.handleSpaceUrlChange,onFocus:e=>{c(!1),e.target.select()}})}),d&&e.domainIsAutogenerated&&(0,oe.jsx)("div",{style:{color:et.ZP.blue,fontSize:m.Z.fontSize.UIRegular.desktop,fontWeight:500,textAlign:"right",padding:"4px 6px",whiteSpace:"nowrap"},onClick:()=>{var e;null===(e=u.current)||void 0===e||e.focusInput(),c(!1),s({...t,domain:""})},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.changeDomain.cta.text",defaultMessage:"Set your own"})}),n&&"available"===o&&(0,oe.jsx)(ng,{}),"inuse"===o&&(0,oe.jsx)(ag,{}),"disallowed"===o&&(0,oe.jsx)(og,{}),"loading"===o&&rg()]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:ig(r,n)})]})};var dg=s(35840);const cg=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageInputMenu"};const t=(0,p.useIntl)(),s=(0,Je.Fg)(),i=(0,T.O7)(),n=(0,a.VK)((()=>(0,yi.M9)(i)),[i]),o=!Boolean(n),[r,l]=(0,a.AF)(ei);return(0,oe.jsx)("div",{onClick:()=>{n&&Da.y(i,{from:"public_domain_home_page",for:n})},children:(0,oe.jsx)(_e.Z,{type:"text",ref:e.textInputRef,style:{background:s.inputBackground,borderRadius:4,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex",padding:"4px 6px"},value:r.query,onChange:e=>{l({...r,query:e.target.value})},onFocus:()=>{o&&l({...r,openDropdown:!0})},disabled:!o,left:(0,dg.R)({fill:s.mediumIconColor,width:16,height:16,marginRight:8,marginLeft:8,flexGrow:0,flexShrink:0}),placeholder:t.formatMessage({defaultMessage:"Select a page shared to web",id:"spaceBasicSettings.PublicHomePageSection.input.placeholder"})})})};var ug=s(29026);const mg=()=>(0,oe.jsx)(tg.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,oe.jsx)(Ti.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),pg=async(e,t)=>{if(!ji.Z.state.online)return[];const s=await A.UJ({environment:t,query:e,source:"public_home_page_menu",limit:ug.Xv});return""===e?s.splice(0,5):s},gg=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSearchResults"};const t=(0,T.O7)(),[s,i]=(0,a.AF)(e.spaceBasicSettingsStore,ai),[n,o]=(0,a.AF)(ei),{query:r}=n,[{value:l,status:d}]=(0,To.r5)((()=>pg(r,t)),[r,t]),c=(0,a.VK)((()=>(0,Ws.RM)()),[]);if(!(r||l&&0!==l.length))return null;return(0,oe.jsx)("div",{style:{marginTop:2,marginBottom:2},children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,sections:[{key:"recent public pages section",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:"idle"===d||"pending"===d?[{key:"loading spinner",render:mg,action:()=>{}}]:c&&l&&0!==l.length?[...l.map((e=>{const t=He.G.createChildStore(c,{table:Vt.iU,id:e.id});return{key:`${e.id} page`,render:e=>(0,oe.jsx)(Xu.Z,{store:t,...e}),action:()=>{i({...s,publicHomePage:e.id}),o({...n,openDropdown:!1,displaySummary:!0})}}}))]:[{key:"no results",render:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginLeft:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel.noResults",defaultMessage:"No results"})}),action:()=>{}}]}],initialFocus:void 0})})},hg=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSummary"};const[t,s]=(0,a.AF)(e.spaceBasicSettingsStore,ai),[i,n]=(0,a.AF)(ei),[o,r]=(0,a.VK)((()=>{const e=(0,Ws.RM)();if(!e||!t.publicHomePage)return[];const s=He.G.createChildStore(e,{table:Vt.iU,id:t.publicHomePage});return[s,s.getIcon()]}),[t]);return o?(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,oe.jsxs)("div",{style:{display:"flex",paddingRight:8,alignItems:"center"},children:[r&&(0,oe.jsx)(pn.Z,{icon:r,isEmptyPage:!1,size:18,disabled:!0,style:{display:"inline-flex",marginRight:2,verticalAlign:"text-top"}}),(0,oe.jsx)(cp.Z,{store:o,style:{display:"inline",whiteSpace:"normal",marginRight:Boolean(r)?3:0,wordBreak:"break-word"}})]}),(0,oe.jsx)(St.Z,{onClick:()=>{n({...i,displaySummary:!1}),s({...t,publicHomePage:void 0})},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel",defaultMessage:"Clear"})})]}):null},fg=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePage"};const t=(0,T.O7)(),s=i.createRef(),[n,o]=(0,a.AF)(ei),[r]=(0,a.AF)(e.spaceBasicSettingsStore),{openDropdown:l,displaySummary:d}=n,{publicHomePage:c,domain:u}=r,m=`${u}.${Mt.default.publicDomainName}`,g=(0,a.VK)((()=>(0,yi.M9)(t)),[t]),h=!Boolean(g);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)(bt.Z,{style:{display:"flex",alignItems:"center"},children:[(0,oe.jsx)("span",{style:{marginRight:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.title",defaultMessage:"Public home page"})}),g&&(0,oe.jsx)(Kr.Z,{subscriptionTier:g,analyticsName:"public_domain_home_page",desktopStyle:{marginTop:-1}})]}),h&&c&&d?(0,oe.jsx)(hg,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}):(0,oe.jsx)(X.ZP,{alignmentToOrigin:X.ZP.Alignment.Start,keepFocus:t.device.isPhone,onDismiss:()=>{var e;null===(e=s.current)||void 0===e||e.handleBlur(),o({...n,openDropdown:!1,displaySummary:!0})},origin:(0,oe.jsx)(cg,{textInputRef:s}),open:l,popupType:X.ZP.PopupType.Popup,style:{width:250},render:()=>(0,oe.jsx)($.Z,{menuType:se.og.Popup,width:250,children:(0,oe.jsx)(gg,{spaceBasicSettingsStore:e.spaceBasicSettingsStore})})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption",defaultMessage:"Access your public home page via {linkText}.",values:{linkText:(0,oe.jsx)(te.Z,{delayThreshold:0,renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption.tooltip",defaultMessage:"Click to copy link"}),render:e=>(0,oe.jsx)(co.Z,{onClick:()=>{It.RD({environment:t,stringValue:m,copiedMessage:It.tq.copiedLinkToClipboard})},...e,children:m})})}})})]})};function yg(){return(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your organization or company name. Keep it simple."})}const xg=(0,p.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"},turnOffAiWhenSubscribedToAiWarning:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAiWarning",defaultMessage:"Your current plan includes Notion AI. You can turn off access to AI, but you will continue to be billed for it."},turnOffAiWhenSubscribedToAccept:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAccept",defaultMessage:"Turn off AI"}});class vg extends n.Z{constructor(){super(...arguments),this.storeTypes={spaceBasicSettingsStore:ai,securitySettingsStore:Js.Z,store:Qp.Z,tokenQuery:B.default.createClass("")},this.handleEnableAiFeatureClick=async e=>{var t;const{securitySettingsStore:s}=this.props,i=(null===(t=ui.default.state.data)||void 0===t?void 0:t.addOns)??[],n=c.de(i),a=!s.state.enableAiFeature;if(!a&&n){if(!(await y.confirmUserActionV2({message:D.default.formatMessage(xg.turnOffAiWhenSubscribedToAiWarning),acceptLabel:D.default.formatMessage(xg.turnOffAiWhenSubscribedToAccept)})).accept)return}s&&!e&&s.setState({...s.state,enableAiFeature:a})},this.handleSpaceNameChange=e=>{this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,name:e.target.value})},this.handleCheckDomainAvailability=e=>{const{spaceBasicSettingsStore:t}=this.stores,{spaceStore:s}=this.props;S._u({environment:this.environment,spaceStore:s,domain:e}).then((e=>{if("success"!==e.type)this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:"loading"});else{const s=e.data.domain===t.state.domain;this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:s?e.data.domainState:t.state.domainState})}}))},this.checkSpaceDomainAvailabilityDebounced=l.Ds(this.handleCheckDomainAvailability,250),this.handleSpaceUrlChange=e=>{const t=S.$U(e.target.value);this.checkSpaceDomainAvailabilityDebounced(t),this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domain:t}),this.forceUpdate()},this.handleConfirm=async()=>{const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t,securitySettingsStore:s}=this.stores;await S.Y5({environment:this.environment,spaceId:e.id,spaceBasicSettingsStore:t})&&(await S.OF({environment:this.environment,spaceStore:e,spaceBasicSettingsStore:t,securitySettingsStore:s}),ei.setState(ei.getInitialState()),ci.Z.setState({...ci.Z.state,open:!1}))},this.handleCancelClick=()=>{ci.Z.setState({...ci.Z.state,open:!1}),ei.setState(ei.getInitialState())},this.handleExportClick=()=>{const{currentSpaceStore:e}=ie.default.state;e&&H.q$({environment:this.environment,root:{table:"space",id:e.id,spaceId:e.id},isCollectionViewExportTypeSupported:!0})},this.handleExportMembersClick=()=>{const{currentSpaceStore:e}=ie.default.state,{data:t}=ui.default.state;e&&t&&"subscribed_admin"===t.type&&H.$G(this.environment,{spaceStore:e,subscriptionData:t,intl:this.props.intl})},this.handleLeaveClick=()=>{const{spaceStore:e}=this.props,{currentUserSettingsStore:t}=ie.default.state;t&&y.showDialog({message:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await S.bf({environment:this.environment,spaceId:e.id,userSettingsStore:t})&&(f.z01(this.environment),ci.Z.setState({...ci.Z.state,open:!1}))}}]})},this.renderChurnSurveyModal=()=>{const{data:e}=ui.default.state,t=this.stores.store.state,s=yi.XX(e);if(s&&t.churnSurveyModalOpen)return(0,oe.jsx)($p.Z,{churnType:t.churnType,currentPlan:t.churnType,isWorkspaceDeletion:!0,periodEnd:s.periodEnd,hasAI:c.de(s.addOns),hasPendingChanges:Boolean(s.schedule||s.willCancelAt),customerId:s.customerId,onAccept:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onAccept()},onClose:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()}})},this.handleDeleteClick=async()=>{const e=(0,Ua.zt)();if(!e)return;const{data:t}=ui.default.state,s=yi.XX(t);if(f.YO0(this.environment),s){if(!(await new Promise((t=>{const{store:s}=this.stores;s.setState({...s.state,churnType:e,churnSurveyModalOpen:!0,onAccept:async()=>{t(!0),await this.showWorkspaceDeletionConfirmation()},onClose:()=>t(!1)})}))))return}await this.showWorkspaceDeletionConfirmation()},this.showWorkspaceDeletionConfirmation=async()=>{const{currentUserSettingsStore:e}=ie.default.state;if(!e)return;const{spaceStore:t,intl:s}=this.props,i=(0,Ta.rn)(this.environment,t)||s.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"}),n=(0,su.Bd)(Rt.SP)?(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."}):(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(eg.Z,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}})});await Gp.b({message:(0,oe.jsx)("div",{children:(0,oe.jsx)("div",{children:n})}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:i})&&(S.Ns({environment:this.environment,spaceId:t.id,userSettingsStore:e}),f.BPl(this.environment),ci.Z.setState({...ci.Z.state,open:!1}))},this.handleRecordIconChange=e=>{const{spaceStore:t}=this.props;C.createAndCommit({userAction:"SpaceBasicSettings.handleRecordIconChange",environment:this.environment,perform:s=>{Ra.sO({store:t.getIconStore(),value:e,transaction:s})}})}}willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{spaceBasicSettingsStore:s}=this.stores,i=s.getValueForSpace(t);i&&s.setState(i)}renderComponent(){return ji.Z.state.online?this.renderSettings():(0,oe.jsx)(bg,{})}validateDomain(){const{spaceBasicSettingsStore:e}=this.stores,{domain:t,domainState:s}=e.state;return!!t&&("available"===s||"current-space"===s)}renderSettings(){const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t}=this.stores,{name:s}=t.state,{data:n}=ui.default.state,{device:a}=this.environment;if(!n)return;const o=e.canAdmin(),r=(0,Ta.Cx)(e),l=(0,Ta.jv)(e),d=yi.qF(this.environment),c=o&&!e.getDisableExport(),u=o,m=(0,Ua.zt)(),g="subscribed_admin"===n.type&&("enterprise"===m||"business"===m),h=e.getSettings().disable_page_analytics,f=Vr.Z.getPublicSpaceData(this.environment,e.id);return(0,oe.jsxs)(wi.Z,{controlRow:o&&this.renderControlRow(),children:[o&&(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(wg,{}),(0,oe.jsx)(bt.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})}),(0,oe.jsx)(_e.Z,{value:s,placeholder:D.default.formatMessage(xg.nameInputPlaceholder),readOnly:!o,onChange:this.handleSpaceNameChange}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,oe.jsx)(yg,{})}),wi.Z.renderDivider(),(0,oe.jsx)(bt.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})}),(0,oe.jsx)("div",{style:{width:72,height:72,border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,oe.jsx)(pn.Z,{bucket:"public",disabled:!1,icon:(0,Ta.Wd)(this.environment,e),isEmptyPage:!1,title:s,size:64,iconLoggingData:{recordTable:e.table,source:"workspace_settings"},onChange:this.handleRecordIconChange})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})}),wi.Z.renderDivider()]}),(y=this.environment,!(null===(x=ie.default.state.currentSpaceStore)||void 0===x||!x.canAdmin())&&(0,yi.qb)(y,"enterprise")&&(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(jg,{}),this.renderAiFeature(),wi.Z.renderDivider()]})),(0,oe.jsx)(Mg,{}),r&&(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages."})}),wi.Z.renderDivider()]}),o&&(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(lg,{canAdminSpaceStore:o,domainIsAutogenerated:null==f?void 0:f.domainIsAutogenerated,spaceStore:e,spaceBasicSettingsStore:t,handleSpaceUrlChange:this.handleSpaceUrlChange}),wi.Z.renderDivider()]}),o&&d&&(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)(bt.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})}),this.renderAllowedEmailDomains(),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."})}),wi.Z.renderDivider()]}),o&&(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)(fg,{spaceBasicSettingsStore:t}),wi.Z.renderDivider()]}),c&&(0,oe.jsx)(Xp,{handleExportClick:this.handleExportClick}),u&&(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsxs)(bt.Z,{style:{display:"flex",alignItems:"center"},children:[(0,oe.jsx)("span",{style:{marginRight:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})}),!g&&(0,oe.jsx)(Kr.Z,{subscriptionTier:"business",analyticsName:"space_export_members",desktopStyle:{marginTop:-1}})]}),(0,oe.jsx)("div",{style:{display:"flex"},children:(0,oe.jsx)(St.Z,{isLarge:!0,disabled:!g,onClick:this.handleExportMembersClick,disabledFeedback:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"})})}),(0,oe.jsx)("div",{style:{height:12}}),(0,oe.jsx)(Xr.Z,{title:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:(0,Gs.UY)("guides.exportMembers"),analyticsFrom:"space_settings"}),wi.Z.renderDivider()]}),o&&(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)(bt.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.analytics.title",defaultMessage:"Analytics"})}),(0,oe.jsxs)("div",{style:{display:"flex",gap:12,flexDirection:"column"},children:[(0,oe.jsx)(uo.Z,{isMobile:a.isMobile,title:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.title",defaultMessage:"Save and display page view analytics"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.description",defaultMessage:"People with edit or full access will be able to see how many views a page has. If this is turned off, page views will not be stored for all pages in {workspaceName}.",values:{workspaceName:s}}),type:"toggle",isOn:!h,onToggle:()=>{const t=!h;C.createAndCommit({userAction:"SpaceBasicSettings.analyticsSettings.onSelectOption",environment:this.environment,perform:s=>{Ra.sW({store:e,data:{settings:{...e.getSettings(),disable_page_analytics:t}},transaction:s})}}),Hp.j(this.environment,t?"page_analytics_workspace_opt_out":"page_analytics_workspace_opt_in")}}),(0,oe.jsx)(Xr.Z,{title:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Learn about workspace analytics.",id:"spaceBasicSettings.workspaceAnalytics.helpButton.caption"}),href:(0,Gs.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq"})]}),wi.Z.renderDivider()]}),(0,oe.jsx)(bt.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})}),(0,oe.jsxs)("div",{style:{display:"flex"},children:[(l.length>1||r)&&(0,oe.jsx)(St.Z,{isLarge:!0,onClick:this.handleLeaveClick,style:{marginRight:o?12:void 0},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})}),o&&(0,oe.jsxs)(oe.Fragment,{children:[this.renderModal(),(0,oe.jsx)(St.Z,{isLarge:!0,isRed:!0,onClick:this.handleDeleteClick,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"})})]})]}),o&&(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)("div",{style:{height:12}}),(0,oe.jsx)(Xr.Z,{title:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:(0,Gs.UY)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})]})]});var y,x}renderAiFeature(){const{securitySettingsStore:e,spaceStore:t}=this.props,s=(0,Ta.CV)(t),i=!s&&Boolean(null==e?void 0:e.state.enableAiFeature);return(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(te.Z,{placement:te.Z.Placement.Bottom,alignment:te.Z.Alignment.Start,textWrap:!0,style:{maxWidth:240},disableTooltip:!s,renderTooltip:()=>s?(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.aiFeature.hipaaTooltip",defaultMessage:"Notion AI is not currently available for HIPAA compliant workspaces."}):void 0,render:e=>(0,oe.jsx)("div",{children:(0,oe.jsxs)("div",{...e,style:{display:"flex",alignItems:"center",cursor:s?"not-allowed":"pointer"},onClick:()=>{this.handleEnableAiFeatureClick(s)},children:[(0,oe.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,qp.t)({width:16,height:16,marginRight:6}),(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.aiFeature.label",defaultMessage:"Notion AI"})]}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.aiFeature.ga.caption",defaultMessage:"Enable to provide AI-powered functionality for all members of your workspace.{br}By enabling Notion AI, you are agreeing to the <inlinelink>Notion AI Supplementary Terms</inlinelink>",values:{br:(0,oe.jsx)("br",{}),inlinelink:e=>(0,oe.jsx)(co.Z,{href:"https://notion.notion.site/fa9034c8b5a04818a6baf3eac2adddbb",external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,oe.jsx)("div",{style:{marginTop:5},children:(0,oe.jsx)(jr.Z,{on:i,disabled:s})})]})})})})}renderControlRow(){return(0,oe.jsxs)("div",{style:{display:"flex"},children:[(0,oe.jsx)(Q.Z,{isLarge:!0,onClick:this.handleConfirm,disabled:!this.validateDomain(),children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})}),(0,oe.jsx)(St.Z,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})})]})}renderAllowedEmailDomains(){const{device:e}=this.environment,{spaceStore:t}=this.props,{spaceBasicSettingsStore:s}=this.stores,{emailDomains:i}=s.state,n=t.canAdmin();return(0,oe.jsx)(X.ZP,{popupType:e.isMobile?X.ZP.PopupType.SlideUp:X.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:this.stores.tokenQuery.state.length>0,origin:(0,oe.jsx)(Gn.Z,{placeholder:D.default.formatMessage(xg.allowedEmailDomainsInputPlaceholder),value:this.stores.tokenQuery.state,onChange:e=>this.stores.tokenQuery.setState(e.target.value),readOnly:!n,onRemoveLastToken:()=>{const e=i.slice(0,i.length-1);s.setState({...s.state,emailDomains:e})},tokens:i.map((e=>(0,oe.jsx)(qn.Z,{showRemoveButton:!0,isSingle:!1,format:Vn.lo.Medium,onClickRemove:()=>{const t=i.filter((t=>t!==e));s.setState({...s.state,emailDomains:t})},value:e},e)))}),render:()=>{const t=this.stores.tokenQuery.state.trim(),{data:n}=ui.default.state,{spaceStore:a}=this.props,o=(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),r=(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),l=n?yi.hn(n).map((e=>{if(("unsubscribed_admin"===n.type||"unsubscribed_member"===n.type||"subscribed_admin"===n.type)&&n.joinedMemberIds.includes(e.userId)){const t=He.U6.createChildStore(a,{table:F.KJ,id:e.userId}).getEmail();return t&&(0,Id.Gd)(t)}})).filter(((e,t,s)=>Boolean(e&&t===s.indexOf(e)&&!i.includes(e)))):[],d=(0,st.ZP)(t,l,(e=>e)).map(((e,t)=>({key:t,render:t=>(0,oe.jsx)(Y.Z,{...t,title:e}),action:()=>{const t=[...i,e];s.setState({...s.state,emailDomains:t}),this.stores.tokenQuery.setState("")}})));let c;return c=e.isMobile?{menuType:se.og.ActionSheet}:{menuType:se.og.Popup,width:"100%"},(0,oe.jsx)($.Z,{...c,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:d.length>0?0:void 0,sections:[{key:0,render:e=>(0,oe.jsx)(ee.Z,{...e,disableDesktopPadding:!0,title:d.length>0?o:r}),items:d}]})})},onDismiss:()=>{this.stores.tokenQuery.setState("")}})}renderModal(){const{churnSurveyModalOpen:e}=this.stores.store.state;return(0,oe.jsx)(Yp.q,{isOpen:e,dismissUsing:"onlyEscape",onDismiss:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()},children:this.renderChurnSurveyModal()})}}vg.displayName="SpaceBasicSettings";const Sg=(0,p.injectIntl)(vg);function bg(){return(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})})})}function Mg(){return(0,oe.jsx)(bt.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.public.subtitle",defaultMessage:"Public settings"})})}function jg(){return(0,oe.jsx)(bt.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.feature.subtitle",defaultMessage:"Feature settings"})})}function wg(){return(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"})})}var Cg=s(65829),kg=s(97832),Tg=s(90403),Ig=s(78873);let Pg=function(e){return e.Password="Password",e.CurrentEmail="TemporaryPasscode",e}({});class _g extends B.default{getInitialState(){return{open:!1,authorized:!1,authorizationType:void 0}}}const Zg=_g;var Fg=s(83785);const Ag=(0,p.defineMessages)({dialogLabel:{id:"profileSettings.accountSecuritySection.emailSetting.dialogLabel",defaultMessage:"Change email"}});class Rg extends n.Z{constructor(){super(...arguments),this.storeTypes={store:Zg},this.renderModalContent=()=>{const{store:e}=this.stores,{state:t}=e;return(0,oe.jsx)("div",{style:{...this.styles.modal,...this.getColors().modal},children:(0,oe.jsx)(Fg.Z,{fetch:this.getAuthorizationType,loading:e=>e&&(0,oe.jsx)("div",{style:this.styles.loadingSpinner,children:(0,oe.jsx)(Ti.Z,{})}),render:()=>(0,oe.jsxs)(i.Fragment,{children:[t.authorizationType===Pg.Password?this.renderVerifyPassword(t):t.authorizationType===Pg.CurrentEmail?this.renderVerifyCurrentEmail(t):void 0,t.authorized&&this.renderSetNewEmail(t)]})})})},this.renderSetNewEmail=e=>{const{store:t}=this.stores,{userValue:s}=this.props;if(t.state.authorized)return(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)("p",{style:this.styles.paragraph,children:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.newEmailInstructions",defaultMessage:"Please enter a new email and we will send you a verification code."})}),(0,oe.jsx)("div",{children:this.renderNewEmailInput()}),t.state.newEmailContainsVerifiedDomain&&(0,Id.Gd)(t.state.newEmail)!==(0,Id.Gd)((null==s?void 0:s.email)||"")&&this.renderClaimedEmailDomainWarning(e),t.state.newEmailPasscodeSent?this.renderNewEmailPasscodeInput(e):this.renderSendNewEmailPasscodeButton(e),this.renderEducationPlanDowngradeWarning()]})},this.handleSendCurrentEmailVerification=async()=>{const{userValue:e}=this.props,{store:t}=this.stores;if(!e)return;t.setState({...t.state,loading:!0});const s=await M.sendEmailVerification(this.environment,{email:e.email});"success"===s.type?t.setState({...t.state,currentEmailPasscodeSent:!0,currentEmailPasscode:"",error:void 0,loading:!1}):t.setState({...t.state,currentEmailPasscodeSent:!0,loading:!1,error:(0,R.wf)(this.props.intl,s)})},this.handleChangeCurrentEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,currentEmailPasscode:e.currentTarget.value,error:void 0})},this.handleChangePassword=e=>{const{store:t}=this.stores;t.setState({open:!0,authorized:!1,authorizationType:Pg.Password,password:e.currentTarget.value,error:void 0})},this.handleClearPassword=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:Pg.Password,password:""})},this.handleSubmitAuthorization=async()=>{const{store:e}=this.stores;if(!e.state.authorized)if(e.state.authorizationType===Pg.Password){if(!this.getUserCurrentEmail())return;e.setState({...e.state,loading:!0});const t=await M.authVerifyPassword(this.environment,{password:e.state.password});if("failed"===t.type)return void e.setState({...e.state,loading:!1,error:(0,R.wf)(this.props.intl,t)});e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})}else e.state.authorizationType===Pg.CurrentEmail&&e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})},this.handleChangeNewEmail=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmail:e.currentTarget.value,error:void 0})},this.handleClearNewEmail=()=>{const{store:e}=this.stores;e.setState({...e.state,newEmail:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0})},this.handleSendNewEmailVerification=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=(0,Id.Gd)(e.state.newEmail);e.setState({...e.state,loading:!0});const[s,i]=await Promise.all([await M.sendEmailVerification(this.environment,{email:e.state.newEmail}),t?await M.getVerifiedEmailDomain(this.environment,{emailDomain:t}):void 0]);if("success"===s.type){const t=(0,me.$K)(i)&&"failed"===i.type?(0,R.wf)(this.props.intl,i):void 0;e.setState({...e.state,newEmailPasscodeSent:!0,newEmailPasscode:"",error:t,loading:!1,newEmailContainsVerifiedDomain:(0,me.$K)(i)&&"success"===i.type&&void 0!==i.data.id})}else e.setState({...e.state,loading:!1,error:(0,R.wf)(this.props.intl,s)})},this.handleChangeNewEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmailPasscode:e.currentTarget.value,error:void 0})},this.handleSubmit=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=e.state.authorizationType===Pg.Password?{type:"Password",password:e.state.password,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode}:{type:"CurrentEmail",currentEmailPasscode:e.state.currentEmailPasscode,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode};e.setState({...e.state,loading:!0});const s=await M.changeEmail(this.environment,t);if("success"===s.type)f.txh(this.environment,{new_email:e.state.newEmail,error:void 0}),e.setState({...e.state,loading:!1}),await this.closeModal();else{var i;const t=(0,R.wf)(this.props.intl,s);if(f.txh(this.environment,{new_email:e.state.newEmail,error:t}),"IntercomError"===(null===(i=s.body)||void 0===i?void 0:i.name))return e.setState({...e.state,loading:!1}),void(await this.closeModal());e.setState({...e.state,loading:!1,error:t})}},this.handleSendUsMessageClick=()=>{xl.j({environment:this.environment,from:"change_email_student"})},this.openModal=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:void 0})},this.closeModal=async()=>{const{store:e}=this.stores,{hasEducationPlan:t}=this.props;e.reset(),t&&await gi.bi(this.environment)},this.getAuthorizationType=async()=>{const{store:e}=this.stores,{intl:t}=this.props,s=this.getUserCurrentEmail();if(!s)return;const i=await Ig.c({environment:this.environment,userEmail:s});i.error?e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorFetchingAccountData",defaultMessage:"Could not fetch account information for {currentEmail}."},{currentEmail:s})}):i.value.isSamlEnforced||!i.value.hasPassword?e.setState({open:!0,authorized:!1,authorizationType:Pg.CurrentEmail,currentEmailPasscodeSent:!1,currentEmailPasscode:""}):e.setState({open:!0,authorized:!1,authorizationType:Pg.Password,password:""})},this.styles={modal:{width:460,padding:32,borderRadius:4,fontSize:14},loadingSpinner:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},paragraph:{marginTop:12,marginBottom:14},error:{color:et.ZP.red,fontSize:12,marginTop:4,marginLeft:8},bold:{fontWeight:m.Z.fontWeight.bold},input:{padding:"4px 8px"},button:{marginTop:14,width:"100%"},educationPlanWarning:{display:"flex",marginTop:14,paddingTop:14},claimedEmailDomainWarning:{marginTop:14,marginBottom:14}}}renderComponent(){const{userValue:e}=this.props,{store:t}=this.stores;return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(uo.Z,{type:"custom",isMobile:!1,title:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.label",defaultMessage:"Email"}),caption:e&&e.email,customButton:this.renderChangeEmailButton()}),(0,oe.jsx)(Mo.Z,{ariaLabel:D.default.formatMessage(Ag.dialogLabel),open:t.state.open,onDismiss:this.closeModal,render:this.renderModalContent})]})}renderChangeEmailButton(){const{userValue:e,areProfileEditsDisabled:t}=this.props,s=(0,oe.jsx)(St.Z,{isLarge:!0,onClick:t?()=>{}:this.openModal,disabled:t,disabledFeedback:t,children:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.changeEmailButton.label",defaultMessage:"Change email"})});return t?(0,oe.jsx)(te.Z,{renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:e?(0,Id.Gd)(e.email):""}}),placement:te.Z.Placement.Bottom,alignment:te.Z.Alignment.Center,render:e=>(0,oe.jsx)("div",{...e,children:s})}):s}renderVerifyPassword(e){const{userValue:t}=this.props;if(t)return(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)("p",{style:{margin:0},children:this.renderCurrentEmail()}),(0,oe.jsx)("p",{style:this.styles.paragraph,children:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.enterPasswordInstructions",defaultMessage:"Please enter your password."})}),(0,oe.jsx)(_e.Z,{style:{display:"none"},type:"text",value:t.email,autoComplete:"username",disabled:!0}),(0,oe.jsx)(_e.Z,{type:"password",disabled:e.authorized,value:e.password,onChange:this.handleChangePassword,showClearButton:!0,onClearButtonClick:this.handleClearPassword,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.passwordInput.label",defaultMessage:"Password"}),style:this.styles.input,focusInitial:!0,autoComplete:"current-password"}),!e.authorized&&e.error&&(0,oe.jsx)("div",{style:this.styles.error,children:e.error}),!e.authorized&&(0,oe.jsx)(Q.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization,disabled:e.loading,children:e.loading?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]})}renderVerifyCurrentEmail(e){return(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsxs)("p",{style:{...this.styles.paragraph,marginTop:0},children:[this.renderCurrentEmail()," ",e.currentEmailPasscodeSent?(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.sentVerificationCodeToCurrentEmail",defaultMessage:"We've sent a temporary verification code to this email."}):(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeToCurrentEmail",defaultMessage:"We'll send a temporary verification code to this email."})]}),e.currentEmailPasscodeSent?this.renderCurrentEmailPasscodeInput(e):this.renderSendCurrentEmailPasscodeButton()]})}renderSendCurrentEmailPasscodeButton(){return(0,oe.jsx)(Q.Z,{isLarge:!0,onClick:this.handleSendCurrentEmailVerification,disabled:this.stores.store.state.loading,children:this.stores.store.state.loading?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.sendCurrentEmailVerificationCode.label",defaultMessage:"Send verification code"})})}renderCurrentEmailPasscodeInput(e){return(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)(_e.Z,{value:e.currentEmailPasscode,onChange:this.handleChangeCurrentEmailPasscode,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterCurrentEmailVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),!e.authorized&&(0,oe.jsx)(Q.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization,disabled:e.loading,children:e.loading?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]})}renderNewEmailInput(){const{store:e}=this.stores;if(e.state.authorized)return(0,oe.jsx)(_e.Z,{value:e.state.newEmail,onChange:this.handleChangeNewEmail,onSubmit:this.handleSendNewEmailVerification,showClearButton:!0,onClearButtonClick:this.handleClearNewEmail,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.newEmailInput.placeholder",defaultMessage:"Enter new email"}),style:this.styles.input,focusInitial:!0})}renderSendNewEmailPasscodeButton(e){return(0,oe.jsxs)(i.Fragment,{children:[e.error&&(0,oe.jsx)("div",{style:this.styles.error,children:e.error}),(0,oe.jsx)(Q.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSendNewEmailVerification,disabled:e.loading,children:e.loading?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeButton.label",defaultMessage:"Send verification code"})})]})}renderNewEmailPasscodeInput(e){const t=this.getSubmitHandler();return(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)("p",{style:this.styles.paragraph,children:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.verificationCodeSentMessage",defaultMessage:"We just sent you a temporary verification code to {newEmail}.",values:{newEmail:(0,oe.jsx)("span",{style:this.styles.bold,children:e.newEmail})}})}),(0,oe.jsx)(_e.Z,{value:e.newEmailPasscode,onChange:this.handleChangeNewEmailPasscode,onSubmit:t,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),e.error&&(0,oe.jsx)("div",{style:this.styles.error,children:e.error}),(0,oe.jsx)(Q.Z,{isLarge:!0,style:this.styles.button,onClick:t,disabled:e.loading,children:e.loading?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.changeEmailButton.label",defaultMessage:"Change email"})})]})}renderEducationPlanDowngradeWarning(){const{hasEducationPlan:e}=this.props;if(e)return(0,oe.jsxs)("div",{style:{...this.styles.educationPlanWarning,...this.getColors().educationPlanWarning},children:[(0,Do.m)({width:14,marginTop:4,marginRight:6,fill:this.theme.lightIconColor})," ",(0,oe.jsx)("div",{children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Changing your email may downgrade your workspace on a Free Education Plan to the basic Free Plan. You won't lose any data, but you'll need to upgrade to re-access paid features. Have questions about this? <sendmessagelink>Message support</sendmessagelink>.",id:"emailChangeSettings.downgradeEducationPlan.warning.message",values:{sendmessagelink:e=>(0,oe.jsx)(co.Z,{onClick:this.handleSendUsMessageClick,children:e})}})})]})}renderCurrentEmail(){const{userValue:e}=this.props;if(e)return(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.currentEmail",defaultMessage:"Your current email is {currentEmail}.",values:{currentEmail:(0,oe.jsx)("span",{style:this.styles.bold,children:e&&e.email})}})}renderClaimedEmailDomainWarning(e){return(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:this.styles.claimedEmailDomainWarning,children:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.claimedEmailDomainWarning",defaultMessage:"The email domain {newEmailDomain} has been claimed by an organization. If you continue with changing this email address, any workspaces created by this account can be managed by the organization. See <domainclaimlink>this page</domainclaimlink> for more info.",values:{newEmailDomain:(0,Id.Gd)(e.newEmail)??e.newEmail,domainclaimlink:e=>(0,oe.jsx)(co.Z,{href:(0,Gs.UY)("guides.domainManagement"),external:!0,children:e})}})})}getUserCurrentEmail(){const{store:e}=this.stores,{userValue:t,intl:s}=this.props;if(t)return t.email;e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:s.formatMessage({id:"profileSettings.changeEmailModal.errorNoUserValue",defaultMessage:"User value is undefined."})})}getSubmitHandler(){const{store:e}=this.stores,{userValue:t}=this.props;if(!e.state.authorized)return()=>{};if(e.state.newEmailContainsVerifiedDomain&&(0,Id.Gd)(e.state.newEmail)!==(0,Id.Gd)((null==t?void 0:t.email)||"")){const t=e.state.newEmail;return async()=>{await function(e){return y.confirmUserAction({message:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.title",defaultMessage:"Are you sure you want to change your email?"}),description:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.description",defaultMessage:"If you continue changing this email address to this domain, any workspaces created by this account can be managed by the organization.",values:{verifiedDomain:(0,Id.Gd)(e)}}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.acceptButton.label",defaultMessage:"Change email"}),cancelLabel:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.cancelButton.label",defaultMessage:"Go back"})})}(t)&&await this.handleSubmit()}}return this.handleSubmit}getColors(){return{modal:{background:this.theme.contentBackground},educationPlanWarning:{color:this.theme.lightTextColor,borderTop:`1px solid ${this.theme.regularDividerColor}`}}}}Rg.displayName="EmailChangeSettings";const Dg=(0,p.injectIntl)(Rg);var Bg=s(10020);class Lg extends B.default{getInitialState(){return{open:!1}}}const Ng=new Lg;const Og=function(){window.__c={n:"ManageActiveSessions"};const e=(0,T.O7)(),{iconStyle:t}=(0,Je.yK)((e=>({iconStyle:{width:20,height:20,fill:e.lightIconColor}})),[]),s=(0,oe.jsx)(p.FormattedMessage,{id:"manageActiveSessions.title",defaultMessage:"Log out of all devices"}),i=(0,oe.jsx)(p.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.label",defaultMessage:"Log out of all other active sessions on other devices besides this one."});return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(uo.Z,{type:"custom",isMobile:!1,title:s,caption:i,customButton:(0,oe.jsx)(_t.Z,{style:{borderRadius:"0.25em"},onClick:async()=>{f.AQD(e),await M.logoutActiveSessions(e,{}),Ng.setState({...Ng.state,open:!0})},children:(0,Bg.C)(t)})}),(0,oe.jsx)(Vg,{})]})};function Eg(){Ng.setState({...Ng.state,open:!1})}function Vg(){window.__c={n:"ManageActiveSessionsModal"};const e=(0,a.VK)((()=>Ng.state.open),[]),t=(0,a.VK)((()=>function(){let e;const{currentUserStore:t}=ie.default.state;return t&&(e=t.getEmail()),e}()),[]);return(0,oe.jsx)(Mo.Z,{open:e,onDismiss:Eg,innerStyle:{width:350,padding:24,display:"flex",flexDirection:"column"},render:()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:{marginBottom:24},children:t?(0,oe.jsx)(p.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withEmail",defaultMessage:"You have been logged out from other active sessions for {email}.",values:{email:t}}):(0,oe.jsx)(p.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withoutEmail",defaultMessage:"You have been logged out from other active sessions for your account."})}),(0,oe.jsx)(Q.Z,{onClick:Eg,children:(0,oe.jsx)(p.FormattedMessage,{id:"manageActiveSessions.confirmationModal.close",defaultMessage:"Close"})})]})})}var Ug=s(1799),Wg=s(16010);class Kg extends B.default{getInitialState(){return{step:"backupCodesUninitialized"}}}class zg extends Wg.o{constructor(e,t){super(e,"backupCodes"),this.service=void 0,this.service=t}backupCodesInitialSetup(e){if(!this.checkStep("backupCodesUninitialized"))return;const{onLoadingComplete:t,onComplete:s}=e;this.store.setState({step:"backupCodesLoading"}),this.doCreateBackupCodes({forceRecreate:!1,onComplete:s,onLoadingComplete:t}).catch(this.handleUnexpectedError)}backupCodesShowCreate(){this.checkStep("backupCodesUninitialized")&&this.store.setState({step:"backupCodesRegenerateCodes"})}backupCodesRegenerateCodes(){this.checkStep("backupCodesRegenerateCodes")&&(this.store.setState({step:"backupCodesRegenerateCodes",isLoading:!0}),this.doCreateBackupCodes({forceRecreate:!0,onComplete:()=>{},onLoadingComplete:()=>{}}).catch(this.handleUnexpectedError))}exit(){this.store.setState({step:"backupCodesUninitialized"})}async doCreateBackupCodes(e){const{forceRecreate:t,onComplete:s,onLoadingComplete:i}=e,n=await this.withStep(["backupCodesLoading","backupCodesRegenerateCodes"],(()=>this.service.createBackupCodes(t)));if(!n)return;const{result:a}=n;if("already-exists"===a.status)s();else{const e=function(e){const t=D.default.getIntl(),s=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.title",defaultMessage:"Notion Backup Codes"}),i=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.createdAt",defaultMessage:"Created at {createdAt}"},{createdAt:`${new Date}`}),n=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.warningMessage",defaultMessage:"Please store these in a secure location and mark off codes as they are used."}),a=`${s}\n${i}\n\n${e.map(Ug.K).join("\n")}\n\n${n}\n`;return encodeURIComponent(a)}(a.backupCodes);this.store.setState({step:"backupCodesShowCodes",backupCodes:a.backupCodes,mfaSettingId:a.mfaSettingId,backupCodesFile:e}),i()}}}var qg=s(75752),Gg=s(88175);function Hg(e){let{errorMessage:t,isLoading:s,onDisplayBackupCodes:i,onCancel:n,onDismiss:a}=e;const o=(0,oe.jsx)(p.FormattedMessage,{id:"mfa.regenerateBackupCodes.title",defaultMessage:"Regenerate backup codes"}),r=(0,oe.jsx)(p.FormattedMessage,{id:"mfa.regenerateBackupCodes.message",defaultMessage:"Backup codes are used to log in if you lose access to your password and second factors. <boldtext>Your existing codes won't work after regenerating new ones.</boldtext>",values:{boldtext:e=>(0,oe.jsx)("span",{style:{fontWeight:m.Z.fontWeight.semibold},children:e})}}),l={text:s?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsx)(p.FormattedMessage,{id:"mfa.regenerateBackupCodes.regenerateBackupCodes.button.message",defaultMessage:"Generate new backup codes"}),onClick:i,view:"outline",disabled:s,isRed:!0},d=[{text:(0,oe.jsx)(p.FormattedMessage,{id:"mfa.regenerateBackupCodes.cancel.button.message",defaultMessage:"Cancel"}),onClick:n,view:"outline",type:"button"}];return(0,oe.jsx)(Gg.Z,{title:o,header:r,errorMessage:t,primaryAction:l,secondaryActions:d,onDismiss:a})}var Qg=s(457);function Yg(e){let{backupCodes:t,backupCodeDownload:s,backupCodeFileName:i,errorMessage:n,onNoted:a,onDownload:o}=e;const r=(0,oe.jsx)(p.FormattedMessage,{id:"mfa.showBackupCodes.title",defaultMessage:"Save your backup codes"}),l=(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(p.FormattedMessage,{id:"mfa.showBackupCodes.message",defaultMessage:"<boldtext>You can only see this once</boldtext>, so be sure to keep them to avoid getting locked out of your account.",values:{boldtext:e=>(0,oe.jsx)("span",{style:{fontWeight:m.Z.fontWeight.semibold},children:e})}})}),d={text:(0,oe.jsx)(p.FormattedMessage,{id:"mfa.showBackupCodes.codesNotedDown.button.message",defaultMessage:"I've saved them"}),onClick:a},c=[{text:(0,oe.jsx)(p.FormattedMessage,{id:"mfa.showBackupCodes.downloadAsTextFile.button.message",defaultMessage:"Download as text file"}),href:`data:text/plain;charset=UTF-8,${s}`,saveAs:i,view:"outline",type:"link",onClick:o}];return(0,oe.jsx)(Gg.Z,{title:r,header:l,errorMessage:n,primaryAction:d,secondaryActions:c,children:(0,oe.jsx)(Qg.Z,{type:"unencryptedCodes",backupCodes:t})})}function $g(e){const{backupCodesStateMachine:t,onGoToSettings:s,onDismiss:i}=e,n=t.useCurrentStep(),a=()=>t.backupCodesRegenerateCodes();switch(n.step){case"backupCodesUninitialized":case"backupCodesLoading":return null;case"backupCodesRegenerateCodes":return(0,oe.jsx)(Hg,{isLoading:n.isLoading,errorMessage:n.error,onDisplayBackupCodes:a,onDismiss:i,onCancel:s});case"backupCodesShowCodes":return(0,oe.jsx)(Yg,{errorMessage:n.error,backupCodes:n.backupCodes,backupCodeDownload:n.backupCodesFile,backupCodeFileName:"Notion Backup Codes.txt",onNoted:s});default:return(0,me.t1)(n)}}var Jg=s(88606),Xg=s(3338);function eh(e){let{type:t,errorMessage:s,onDismiss:i,onAddMethod:n}=e;window.__c={n:"MFAPromptSetupComplete"};const a=(0,Je.yK)(th,[]),o=(0,oe.jsx)(p.FormattedMessage,{id:"mfa.setupComplete.confirmation.header",defaultMessage:"Every time you enter your password, Notion will ask you for a verification code to confirm your identity."}),r=[{text:(0,oe.jsx)(p.FormattedMessage,{id:"mfa.setupComplete.confirmation.viewTwoStepMethods.button.message",defaultMessage:"View 2-step methods"}),onClick:n,type:"button",view:"outline"}];return(0,oe.jsx)(Gg.Z,{title:"totp"===t?(0,oe.jsx)(p.FormattedMessage,{id:"mfa.totp.setupComplete.confirmation.title",defaultMessage:"2-step verification with authenticator is turned on"}):"sms"===t?(0,oe.jsx)(p.FormattedMessage,{id:"mfa.sms.setupComplete.confirmation.title",defaultMessage:"2-step verification with phone number is turned on"}):(0,me.t1)(t),header:o,errorMessage:s,icon:(0,Xg.p)(a.confirmationIcon),secondaryActions:r,onDismiss:i})}function th(e){return(0,Je.EM)({confirmationIcon:{width:30,fill:"green"}})}s(30541);var sh=s(4387);const ih={name:"United States",countryCode:"1",regionCode:"US"};function nh(e){let{isLoading:t,phoneNumber:s,country:n,errorMessage:o,onDismiss:r,onBack:l,onContinue:d}=e;window.__c={n:"MFAPromptSMSAddPhone"};const c=(0,Je.yK)(ah,[]),u=(0,p.useIntl)(),[m,g]=(0,i.useState)(s??""),[h,f]=(0,i.useState)([]),[y,x]=(0,i.useState)(""),[v,S]=(0,i.useState)(n??ih),M=(0,a.qz)(void 0,en.Z),j=(0,i.useMemo)((()=>(0,sh.PG)(v.regionCode)),[v.regionCode]),w=(0,i.useCallback)((e=>{const t=e.target.value.replace(/\D/g,"");g(j.reset(t))}),[j]);(0,i.useEffect)((()=>{g(n!==v?j.reset(m??""):j.reset(s??""));const e=new Intl.DisplayNames(["en"],{type:"region"}),t=(0,sh.wJ)();let i=-1;const a=t.map(((t,s)=>{const n=(0,sh.t7)(t).toString(),a=e.of(t);return t===v.regionCode&&(i=s),{name:a??t,countryCode:n,regionCode:t}}));-1!==i&&a.unshift(a.splice(i,1)[0]),f(a)}),[v]);const C=(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneTitle",defaultMessage:"Add a phone number"}),k=(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneHeader",defaultMessage:"Enter your phone number to receive a 2-step verification code."}),T={text:t?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.sms.continueButton",defaultMessage:"Continue"}),onClick:()=>d(v,m.trim()),disabled:t||""===m},I=[{text:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneNeedHelp",defaultMessage:"Need help?"}),href:(0,Gs.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}],P=u.formatMessage({id:"profileSettings.mfa.sms.phoneNumberInput.placeholder",defaultMessage:"Enter phone number"}),_=u.formatMessage({defaultMessage:"Search country code",id:"profileSettings.mfa.sms.countryCodeSelect.placeholder"}),Z=e=>(0,oe.jsxs)("div",{style:c.countryCodeSelectTitle,children:[e.name,(0,oe.jsx)(at.Z,{isSmall:!0,children:`+${e.countryCode}`})]}),F=(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,placementToOrigin:iu.Iw.Bottom,alignmentToOrigin:iu.lU.Start,buttonPopupStore:M,renderOrigin:e=>(0,oe.jsx)(St.Z,{...e,children:`+${v.countryCode}`}),render:e=>(0,oe.jsx)($.Z,{menuType:se.og.Popup,minWidth:280,maxHeight:"30vh",header:(0,oe.jsx)(ee.Z,{isInput:!0,children:(0,oe.jsx)(vu.ZP,{value:y,onChange:e=>x(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:_})}),children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:0,sections:[{key:"countries",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:(0,st.ZP)(y,h,(e=>/\d/.test(y)?`${e.countryCode}`:e.name)).map((t=>({key:t.regionCode,render:e=>(0,oe.jsx)(Y.Z,{...e,title:Z(t),right:t.name===v.name?(0,Zd.k)(c.selectedCountryCodeIcon):void 0}),action:()=>{x(""),S(t),e.close()}})))}]})})});return(0,oe.jsx)(Gg.Z,{onDismiss:r,onBack:l,title:C,header:k,errorMessage:o,primaryAction:T,secondaryActions:I,children:(0,oe.jsxs)("div",{style:c.container,children:[(0,oe.jsx)("div",{style:c.countryCodeDropdownMenu,children:F}),(0,oe.jsx)(_e.Z,{autoFocus:!0,value:m,placeholder:P,spellCheck:!1,style:c.phoneNumberInput,onChange:w,disabled:void 0!==t,customElementAttributes:b.pf})]})})}function ah(e){return(0,Je.EM)({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:16,marginBottom:4},countryCodeDropdownMenu:{marginRight:5},selectedCountryCodeIcon:{width:15,height:15},countryCodeSelectTitle:{paddingTop:8,paddingBottom:8},phoneNumberInput:{background:"light"===e.mode?et.ZP.transparent:e.inputBackground}})}var oh=s(56839);function rh(e){const{smsStateMachine:t,onGoToSettings:s,onDismiss:i,onStartBackupCodes:n}=e,a=t.useCurrentStep();switch(a.step){case"smsUninitialized":return null;case"smsSendingSMS":case"smsSetPhoneNumber":return(0,oe.jsx)(nh,{phoneNumber:a.phoneNumber,country:a.country,isLoading:"smsSendingSMS"===a.step,errorMessage:a.error,onDismiss:i,onBack:s,onContinue:(e,s)=>t.smsCreateSMS(e,s)});case"smsVerifyCode":case"smsResendSMS":case"smsBackupCodesLoading":case"smsVerifying":return(0,oe.jsx)(oh.ZP,{isLoading:"smsVerifying"===a.step||"smsBackupCodesLoading"===a.step,errorMessage:a.error,phoneNumber:`+${a.country.countryCode} ${a.phoneNumber}`,onDismiss:i,onBack:()=>t.smsRestart(),onVerifyCode:e=>t.smsVerifyCode({code:e,onVerified:n}),resentStatus:"smsResendSMS"===a.step?"resending":"resentAt"in a&&void 0!==a.resentAt?"resent":"not-resent",resentAt:"resentAt"in a&&a.resentAt?a.resentAt:0,onResendLink:()=>t.smsResendSMS()});case"smsVerified":return null;case"smsComplete":return(0,oe.jsx)(eh,{type:"sms",errorMessage:a.error,onAddMethod:s,onDismiss:i});default:return(0,me.t1)(a)}}function lh(e){window.__c={n:"MFAAuthenticatorNameInput"};const{placeholder:t,value:s,maxlength:i,style:n,onChange:a}=e,o=(0,Je.yK)((e=>(0,Je.EM)({input:{background:et.ZP.transparent,color:e.darkTextColor,...n}})),[n]);return(0,oe.jsx)(_e.Z,{value:s,placeholder:t,maxlength:i,style:o.input,inputStyle:m.Z.textOverflowStyle,autoFocus:!0,spellCheck:!1,onChange:a,autoComplete:"off",customElementAttributes:b.pf})}function dh(e){let{isLoading:t,qrCode:s,friendlyName:n,errorMessage:a,onDismiss:o,onBack:r,onCantScanCode:l,onContinue:d}=e;window.__c={n:"MFAPromptTOTPScanQRCode"};const c=(0,Je.yK)(ch,[]),u=(0,p.useIntl)(),[m,g]=(0,i.useState)(n??""),h=(0,i.useCallback)((e=>{g(e.target.value)}),[g]),f=(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeTitle",defaultMessage:"Scan code in authenticator app"}),y=(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeHeader",defaultMessage:"Generate a verification code with an authenticator app, then enter a name to remember it by."}),x={text:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>d(m),disabled:!s||t||0===m.length},v=[{text:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.totp.cantScanCodeButton",defaultMessage:"Can't scan code?"}),onClick:l,type:"button",view:"plain",disabled:t}],S=u.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput.placeholder",defaultMessage:"Enter authenticator name"});return(0,oe.jsx)(Gg.Z,{onDismiss:o,onBack:r,title:f,header:y,errorMessage:a,primaryAction:x,secondaryActions:v,children:(0,oe.jsxs)("div",{style:c.body,children:[(0,oe.jsx)("div",{style:c.qrCodeContainer,children:s?(0,oe.jsx)("img",{style:c.qrCode,src:s}):(0,oe.jsx)(Ti.Z,{})}),(0,oe.jsx)(lh,{placeholder:S,value:m,maxlength:30,onChange:h})]})})}function ch(e){return(0,Je.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},qrCodeContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:116,height:116,marginBottom:15},qrCode:{width:"100%"}})}function uh(e){let{textCode:t,friendlyName:s,errorMessage:n,isLoading:a,onDismiss:o,onBack:r,onUseQrCode:l,onContinue:d}=e;window.__c={n:"MFAPromptTOTPTypeTextCode"};const c=(0,Je.yK)(mh,[]),[u,m]=(0,i.useState)(s??""),g=(0,p.useIntl)(),h=(0,i.useCallback)((e=>{m(e.target.value)}),[m]),f=(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.totp.typeTextCodeTitle",defaultMessage:"Type code from authenticator app"}),y=(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.totp.typeText.message",defaultMessage:"Input this setup key in your authenticator app, then enter a name to remember it by.",values:{authenticatorlink:e=>(0,oe.jsx)(co.Z,{external:!0,href:(0,Gs.UY)("guides.mfa"),children:e})}}),x={text:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>d(u),disabled:a||0===u.length},v=[{text:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeButton",defaultMessage:"Scan QR code"}),onClick:l,type:"button",view:"plain",disabled:a}],S=g.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput",defaultMessage:"Enter authenticator name"});return(0,oe.jsx)(Gg.Z,{onDismiss:o,onBack:r,title:f,header:y,errorMessage:n,primaryAction:x,secondaryActions:v,children:(0,oe.jsxs)("div",{style:c.body,children:[(0,oe.jsx)("div",{style:c.content,children:(0,oe.jsx)("div",{style:c.textCode,children:t})}),(0,oe.jsx)(lh,{placeholder:S,value:u,maxlength:30,onChange:h})]})})}function mh(e){return(0,Je.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},textCode:{fontWeight:m.Z.fontWeight.medium,fontSize:m.Z.fontSize.UIRegular.desktop,color:e.darkTextColor,textAlign:"center",verticalAlign:"middle"},content:{display:"flex",flexDirection:"column",justifyContent:"center",height:50,marginBottom:15}})}var ph=s(18469);function gh(e){const{totpStateMachine:t,onGoToSettings:s,onStartBackupCodes:i,onDismiss:n}=e,a=t.useCurrentStep();switch(a.step){case"totpUninitialized":return null;case"totpLoadingQRCode":case"totpDisplayQRCode":const e="totpLoadingQRCode"===a.step?{isLoading:!0,qrCode:void 0}:{isLoading:a.isLoading,qrCode:a.qrCode};return(0,oe.jsx)(dh,{...e,friendlyName:"totpDisplayQRCode"===a.step?a.friendlyName:void 0,errorMessage:a.error,onDismiss:n,onBack:s,onCantScanCode:()=>t.totpDisplayTextCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpDisplayTextCode":return(0,oe.jsx)(uh,{textCode:a.rawString,friendlyName:a.friendlyName,errorMessage:a.error,isLoading:a.isLoading,onDismiss:n,onBack:s,onUseQrCode:()=>t.totpDisplayQRCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpVerifyCode":case"totpBackupCodesLoading":case"totpVerifying":return(0,oe.jsx)(ph.ZP,{isLoading:"totpVerifying"===a.step||"totpBackupCodesLoading"===a.step,errorMessage:a.error,onDismiss:n,onBack:()=>t.totpDisplayQRCode(),onVerifyCode:e=>t.totpVerifyCode({code:e,onVerified:i})});case"totpVerified":return null;case"totpComplete":return(0,oe.jsx)(eh,{type:"totp",errorMessage:a.error,onDismiss:n,onAddMethod:s});default:return(0,me.t1)(a)}}function hh(e){window.__c={n:"RootRouter"};const{rootStateMachine:t,settingsStateMachine:s,totpStateMachine:n,smsStateMachine:a,backupCodesStateMachine:o,onReloadSettings:r}=e,l=t.useCurrentStep(),[{showSettings:d,onRootExit:c}]=(0,i.useState)((()=>({onRootExit:()=>t.exit((()=>{s.exit(),n.exit(),a.exit(),o.exit(),r&&r()})),showSettings:()=>t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{s.settingsConfirmIdentityForSettings()}})}))),u=()=>t.rootCloseSettings((()=>{s.exit(),r&&r()})),m=()=>t.rootStartTOTP((()=>n.totpStart())),p=()=>t.rootStartSMS((()=>a.smsStart())),g=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{n.exit(),s.settingsShow({refresh:!0})}})},h=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{a.exit(),s.settingsShow({refresh:!0})}})},f=()=>{o.exit(),t.rootEndBackupCodes({completeTotp:()=>{n.totpComplete()},completeSMS:()=>{a.smsComplete()},showSettings:d})},y=()=>{o.backupCodesInitialSetup({onLoadingComplete:()=>{n.totpBackupCodesComplete(),t.rootShowBackupCodesFromTOTP()},onComplete:()=>{n.totpBackupCodesComplete(),n.totpComplete(),f()}})},x=()=>{o.backupCodesInitialSetup({onLoadingComplete:()=>{a.smsBackupCodesComplete(),t.rootShowBackupCodesFromSMS()},onComplete:()=>{a.smsBackupCodesComplete(),a.smsComplete(),f()}})},v=()=>{t.rootStartBackupCodesFromSettings((()=>o.backupCodesShowCreate()))},S=s.useCurrentStep(),b=n.useCurrentStep(),M=a.useCurrentStep(),j=o.useCurrentStep();let w;switch(l.step){case"rootUninitialized":break;case"rootSettings":w={open:"settingsUninitialized"!==S.step,onDismiss:c,render:()=>(0,oe.jsx)(Jg.Z,{settingsStateMachine:s,onDismiss:u,onStartTOTP:m,onStartSMS:p,onStartBackupCodes:v})};break;case"rootTOTP":w={open:"totpUninitialized"!==b.step,onDismiss:c,render:()=>(0,oe.jsx)(gh,{totpStateMachine:n,onGoToSettings:g,onStartBackupCodes:y,onDismiss:c})};break;case"rootSMS":w={open:"smsUninitialized"!==M.step,onDismiss:c,render:()=>(0,oe.jsx)(rh,{smsStateMachine:a,onGoToSettings:h,onStartBackupCodes:x,onDismiss:c})};break;case"rootBackupCodes":w={open:"backupCodesUninitialized"!==j.step,onDismiss:"backupCodesRegenerateCodes"===j.step?c:void 0,render:()=>(0,oe.jsx)($g,{backupCodesStateMachine:o,onGoToSettings:f,onDismiss:c})};break;default:throw(0,me.t1)(l)}return w?(0,oe.jsx)(Mo.Z,{...w,preventHideChildrenWhileOpening:!0}):null}class fh extends B.default{getInitialState(){return{step:"rootUninitialized"}}}class yh extends Wg.o{constructor(e){super(e,"root")}rootShowSettings(e){const{refresh:t,startConfirmIdentity:s}=e;if(this.checkStep("rootSettings")){if(!t)return}else this.store.setState({step:"rootSettings"});s()}rootStartBackupCodesFromSettings(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootBackupCodes",source:"settings"}),e())}rootStartTOTP(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootTOTP"}),e())}rootShowBackupCodesFromTOTP(){this.checkStep("rootTOTP")&&this.store.setState({step:"rootBackupCodes",source:"totp"})}rootStartSMS(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootSMS"}),e())}rootShowBackupCodesFromSMS(){this.checkStep("rootSMS")&&this.store.setState({step:"rootBackupCodes",source:"sms"})}rootEndBackupCodes(e){const t=this.checkStep("rootBackupCodes");if(t)switch(t.source){case"settings":return this.store.setState({step:"rootSettings"}),e.showSettings();case"sms":return this.store.setState({step:"rootSMS"}),e.completeSMS();case"totp":return this.store.setState({step:"rootTOTP"}),e.completeTotp();default:(0,me.t1)(t.source)}}rootCloseSettings(e){e(),this.store.setState({step:"rootUninitialized"})}exit(e){this.store.setState({step:"rootUninitialized"}),e()}}var xh=s(24173),vh=s(49682);class Sh extends B.default{getInitialState(){return{step:"smsUninitialized"}}}class bh extends Wg.o{constructor(e,t){super(e,"sms"),this.service=void 0,this.service=t}smsStart(){this.checkStep("smsUninitialized")&&this.store.setState({step:"smsSetPhoneNumber"})}smsRestart(){const e=this.checkStep(["smsResendSMS","smsVerifyCode","smsVerifying"]);e&&this.store.setState({step:"smsSetPhoneNumber",country:e.country,phoneNumber:e.phoneNumber,error:void 0})}smsCreateSMS(e,t){this.checkStep("smsSetPhoneNumber")&&(this.store.setState({country:e,phoneNumber:t,step:"smsSendingSMS"}),this.doCreateSMS().catch(this.handleUnexpectedError))}smsResendSMS(){const e=this.checkStep(["smsVerifyCode","smsVerifying"]);e&&(this.store.setState({...e,step:"smsResendSMS",error:void 0}),this.doResendSMS().catch(this.handleUnexpectedError))}smsVerifyCode(e){const{code:t,onVerified:s}=e,i=this.checkStep("smsVerifyCode");i&&(this.store.setState({...i,step:"smsVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:s}).catch(this.handleUnexpectedError))}smsBackupCodesComplete(){this.checkStep("smsBackupCodesLoading")&&this.store.setState({step:"smsVerified"})}smsComplete(){this.checkStep("smsVerified")&&this.store.setState({step:"smsComplete"})}exit(){this.store.setState({step:"smsUninitialized"})}async doCreateSMS(){const e=await this.withStep("smsSendingSMS",(e=>this.service.createSMS(e.country.countryCode,e.phoneNumber)));if(!e)return;const{result:t,state:s}=e;switch(t.status){case"created":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:t.mfaSettingId,error:void 0});break;case"already_verified_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:vh.Qj.smsAlreadyVerifiedPhoneNumber});break;case"invalid_country_code":this.store.setState({step:"smsSetPhoneNumber",error:vh.Qj.smsInvalidCountryCode});break;case"invalid_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:vh.Qj.smsInvalidPhoneCode});break;case"sms_unsupported_country_code_for_enrollment":this.store.setState({step:"smsSetPhoneNumber",error:vh.Qj.smsUnsupportedCountryCodeForEnrollment});break;default:return(0,me.t1)(t)}}async doVerifyCode(e){const{code:t,onVerified:s}=e,i=await this.withStep("smsVerifying",(e=>this.service.verifySMS({mfaSettingId:e.mfaSettingId,code:t})));if(!i)return;const{result:n,state:a}=i;switch(n.status){case"match":this.store.setState({step:"smsBackupCodesLoading",country:a.country,phoneNumber:a.phoneNumber}),s();break;case"error":this.store.setState({...a,step:"smsVerifyCode",error:vh.Qj.unexpectedError});break;case"incorrect":this.store.setState({...a,step:"smsVerifyCode",error:vh.Qj.smsIncorrectCode});break;default:return(0,me.t1)(n.status)}}async doResendSMS(){const e=await this.withStep("smsResendSMS",(e=>this.service.sendSMS({mfaSettingId:e.mfaSettingId})));if(!e)return;const{result:t,state:s}=e;switch(t.status){case"ok":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:s.mfaSettingId,error:void 0,resentAt:Date.now()});break;case"error":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:s.mfaSettingId,error:vh.Qj.unexpectedError});break;default:return(0,me.t1)(t.status)}}}class Mh extends B.default{getInitialState(){return{step:"totpUninitialized"}}}class jh extends Wg.o{constructor(e,t){super(e,"totp"),this.service=void 0,this.service=t}totpStart(){this.checkStep("totpUninitialized")&&(this.store.setState({step:"totpLoadingQRCode"}),this.doCreateTOTP().catch(this.handleUnexpectedError))}totpDisplayTextCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayQRCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayTextCode",error:void 0,isLoading:!1})}}totpDisplayQRCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayTextCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayQRCode",error:void 0,isLoading:!1})}}totpDisplayVerification(e){this.checkStep(["totpDisplayQRCode","totpDisplayTextCode"])&&this.doRenameTOTP(e).catch(this.handleUnexpectedError)}totpVerifyCode(e){const{code:t,onVerified:s}=e,i=this.checkStep("totpVerifyCode");i&&(this.store.setState({...i,step:"totpVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:s}).catch(this.handleUnexpectedError))}totpBackupCodesComplete(){this.checkStep("totpBackupCodesLoading")&&this.store.setState({step:"totpVerified"})}totpComplete(){this.checkStep("totpVerified")&&this.store.setState({step:"totpComplete"})}exit(){this.store.setState({step:"totpUninitialized"})}async doCreateTOTP(){const e=await this.withStep("totpLoadingQRCode",(()=>this.service.createTOTP()));if(!e)return;const{result:t}=e;this.store.setState({step:"totpDisplayQRCode",qrCode:t.qrCode,rawString:t.secret,mfaSettingId:t.mfaSettingId,isLoading:!1})}async doRenameTOTP(e){const t=await this.withStep(["totpDisplayQRCode","totpDisplayTextCode"],(t=>this.service.renameSettings({mfaSettingId:t.mfaSettingId,friendlyName:e})));if(!t)return;const{result:s,state:i}=t;switch(s.status){case"saved":this.store.setState({...i,step:"totpVerifyCode",friendlyName:e,error:void 0});break;case"duplicate":this.store.setState({...i,isLoading:!1,error:vh.Qj.totpDuplicateFriendlyName});break;case"empty":this.store.setState({...i,isLoading:!1,error:vh.Qj.totpEmptyFriendlyName});break;case"bad_friendly_name":this.store.setState({...i,isLoading:!1,error:vh.Qj.totpBadFriendlyName});break;default:return(0,me.t1)(s)}}async doVerifyCode(e){const{code:t,onVerified:s}=e,i=await this.withStep("totpVerifying",(e=>this.service.verifyTOTP({mfaSettingId:e.mfaSettingId,code:t})));if(!i)return;const{result:n,state:a}=i;switch(n.status){case"match":this.store.setState({step:"totpBackupCodesLoading"}),s();break;case"error":this.store.setState({...a,step:"totpVerifyCode",error:vh.Qj.unexpectedError});break;case"incorrect":this.store.setState({...a,step:"totpVerifyCode",error:vh.Qj.totpIncorrectCode});break;default:return(0,me.t1)(n.status)}}}function wh(e){let{status:t,numMfaSettings:s,onReloadSettings:n,regenerateBackupCodes:o}=e;window.__c={n:"MFASettings"};const r=(0,T.O7)(),[{rootStateMachine:l,settingsStateMachine:d,totpStateMachine:c,smsStateMachine:u,backupCodesStateMachine:g}]=(0,i.useState)((()=>{const e=new qg.r(r),t={totpStore:new Mh,settingsStore:new xh.c,smsStore:new Sh,backupCodesStore:new Kg,rootStore:new fh};return{mfaService:e,rootStateMachine:new yh(t.rootStore),settingsStateMachine:new xh.W(t.settingsStore,e),totpStateMachine:new jh(t.totpStore,e),smsStateMachine:new bh(t.smsStore,e),backupCodesStateMachine:new zg(t.backupCodesStore,e)}})),h=r.device.isMobile,f=(0,Je.yK)((e=>({configureButton:{marginTop:h?12:0,marginBottom:h?4:0},regenerateBackupCodesBadge:{fontWeight:m.Z.fontWeight.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?et.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content"}})),[h]),y=(0,a.VK)((()=>ci.Z.state.highlightedSetting===ci.R.TwoStepVerification),[]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(uo.Z,{type:"toggleToButton",isMobile:!1,title:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.label",defaultMessage:"2-step verification"}),caption:"on"===t?(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.settingConfigured.message",defaultMessage:"You have {numMfaSettings} verification methods turned on.",values:{numMfaSettings:s}}):(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.message",defaultMessage:"Add an additional layer of security to your account during login."}),isOn:"on"===t,buttonStyle:f.configureButton,buttonLabel:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.label",defaultMessage:"Change verification methods"}),onClick:()=>{!function(e){let{rootStateMachine:t,settingsStateMachine:s}=e;t.rootShowSettings({refresh:!1,startConfirmIdentity:()=>s.settingsConfirmIdentityForSettings()})}({rootStateMachine:l,settingsStateMachine:d})},tooltipLabel:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.tooltip",defaultMessage:"A password is required to enable 2-step verification"}),disableTooltip:"disabled"!==t,disabled:"disabled"===t,badge:o&&(0,oe.jsx)(Tg.Z,{style:f.regenerateBackupCodesBadge,content:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.regenerateBackupCodes.badge",defaultMessage:"Regenerate backup codes"})}),shouldHighlight:y}),(0,oe.jsx)(hh,{onReloadSettings:n,rootStateMachine:l,settingsStateMachine:d,totpStateMachine:c,smsStateMachine:u,backupCodesStateMachine:g})]})}var Ch=s(1548),kh=s(30045);class Th extends n.Z{constructor(){super(...arguments),this.storeTypes={isEducationStore:B.default.createClass(!1)},this.handleUploadProfilePhoto=()=>{f.Her(this.environment),kr.cR({environment:this.environment,onStart:this.handleUploadStart,bucket:"public",onError:this.handleUploadError,onComplete:this.handleUploadComplete,accept:"image/*"})},this.handleRemoveProfilePhoto=()=>{this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,profilePhoto:void 0}),C.createAndCommit({userAction:"SpaceProfileSettings.handleRemoveProfilePhoto",environment:this.environment,perform:e=>{const{currentUserStore:t}=ie.default.state;t&&h.A({userStore:t,data:{profilePhoto:null},transaction:e})}})},this.handleNameChange=e=>{const t=e.target.value;f.O$H(this.environment,{from:this.props.spaceProfileSettingsStore.state.name,to:t}),this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,name:t}),C.createAndCommit({userAction:"SpaceProfileSettings.handleNameChange",environment:this.environment,perform:e=>{const{currentUserStore:s}=ie.default.state;s&&h.A({userStore:s,data:{name:t},transaction:e})}})},this.handleUploadStart=()=>{this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,uploadingProfilePhoto:!0})},this.handleUploadError=()=>{this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,uploadingProfilePhoto:!1}),y.showErrorMessage((0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadProfilePhotoError.message",defaultMessage:"Upload failed."}))},this.handleUploadComplete=e=>{const t=e[0];this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,profilePhoto:t,uploadingProfilePhoto:!1}),C.createAndCommit({userAction:"SpaceProfileSettings.handleUploadComplete",environment:this.environment,perform:e=>{const{currentUserStore:s}=ie.default.state;s&&h.A({userStore:s,data:{profilePhoto:t},transaction:e})}})}}async willMount(e){super.willMount(e);const{isEducationStore:t}=this.stores,{spaceProfileSettingsStore:s}=this.props,{currentUserStore:i,currentUserSettingsStore:n,currentUserRootStore:a,currentSpaceStore:o}=ie.default.state;if(i&&n){const t=s.getValueForUser(i,n,e.intl);t&&s.setState({...s.state,...t})}if(a&&o){const e=await(0,yi.Gh)({environment:this.environment,userRootStore:a}),s=o.canAdmin()&&(e||[]).some((e=>e===Mt.default.pricing.student.productId));t.setState(s)}await j(this.environment,s)}willUnmount(){ci.Z.state.highlightedSetting&&ci.Z.setState({...ci.Z.state,highlightedSetting:void 0}),super.willUnmount()}renderComponent(){return ji.Z.state.online?this.renderSettings():(0,oe.jsx)(Ph,{})}renderSettings(){const{currentUserStore:e}=ie.default.state;if(!e)return;const t=e.getValue();if(!t)return;const{name:s}=this.props.spaceProfileSettingsStore.state;return(0,oe.jsx)(wi.Z,{children:this.renderPersonalSettings({currentUserStore:e,currentUserValue:t,userName:s})})}renderPersonalSettings(e){var t;const{userName:s,currentUserStore:i,currentUserValue:n}=e,a=D.default.getIntl(),o=(0,br.N5)(i,a),r=(0,Id.Gd)(n.email),l=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.prevent_profile_edits);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(_h,{spaceProfileSettingsStore:this.props.spaceProfileSettingsStore,emailDomainForUser:r}),(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,oe.jsx)(br.ZP,{size:60,avatarType:o,isOffline:!ji.Z.state.online,onUploadProfilePhoto:this.handleUploadProfilePhoto,onRemoveProfilePhoto:this.handleRemoveProfilePhoto,disabled:l,disabledTooltipMessage:(0,oe.jsx)(p.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:r}})}),(0,oe.jsxs)("div",{style:{marginLeft:20,width:250},children:[(0,oe.jsx)(Mr.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.personalInfoSection.nameInput.label",defaultMessage:"Preferred name"})}),this.renderUserNameDisplay({userName:s,emailDomainForUser:r,areProfileEditsDisabled:l})]})]}),"photo"!==o.type&&!l&&(0,oe.jsx)("div",{style:{color:this.theme.mediumIconColor,fontSize:14,marginTop:8},children:(0,oe.jsx)(p.FormattedMessage,{id:"editableUserAvatar.profilePhoto.addPhoto",defaultMessage:"Add photo"})})]}),(0,oe.jsx)(ro.Z,{size:48,isHidden:!0}),this.renderAccountSecuritySection({currentUserValue:n}),(0,oe.jsx)(ro.Z,{size:48,isHidden:!0}),(0,oe.jsx)(Zh,{spaceProfileSettingsStore:this.props.spaceProfileSettingsStore})]})}renderUserNameDisplay(e){const{userName:t,emailDomainForUser:s,areProfileEditsDisabled:i}=e;return i?(0,oe.jsx)(te.Z,{renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:s}}),placement:te.Z.Placement.Bottom,alignment:te.Z.Alignment.Center,render:e=>(0,oe.jsx)("div",{...e,style:{opacity:.4},children:(0,oe.jsx)(_e.Z,{disabled:!0,value:t})})}):(0,oe.jsx)(_e.Z,{value:t,onChange:this.handleNameChange})}renderAccountSecuritySection(e){var t;const{currentUserValue:s}=e,i=this.props.spaceProfileSettingsStore.state.accountSettings,n=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.prevent_profile_edits),a=()=>{j(this.environment,this.props.spaceProfileSettingsStore)};return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.accountSecurity.title",defaultMessage:"Account security"})}),(0,oe.jsx)(Dg,{userValue:s,hasEducationPlan:this.stores.isEducationStore.state,areProfileEditsDisabled:n}),(0,oe.jsx)(ro.Z,{size:18,isHidden:!0}),(0,oe.jsx)(Ch.Z,{hasPassword:i.hasPassword,hasPasswordActions:i.canConfigurePassword,isEducationPlan:this.props.isEducationPlan,samlEnforced:i.isSamlEnforced,email:s.email,isError:Boolean(i.error),onReloadSettings:a,mfaStatus:i.mfaStatus}),(0,oe.jsx)(ro.Z,{size:18,isHidden:!0}),(0,oe.jsx)(wh,{status:i.mfaStatus,numMfaSettings:i.numMfaSettings,onReloadSettings:a,regenerateBackupCodes:i.regenerateBackupCodes})]})}}Th.displayName="SpaceProfileSettings";const Ih=(0,p.injectIntl)(Th);function Ph(){return(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Please go online to manage your profile.",id:"profileSettings.offline.message"})})})}function _h(e){window.__c={n:"MyProfileHeader"};const{emailDomainForUser:t,spaceProfileSettingsStore:s}=e,i=(0,a.VK)((()=>{var e;return Boolean(null===(e=s.state.emailDomainSettings)||void 0===e?void 0:e.isDomainVerified)}),[s]);return(0,oe.jsxs)(bt.Z,{large:!0,divider:"full",children:[i?(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",margin:"0 0 8px"},children:[(0,oe.jsx)(Tg.Z,{style:{fontWeight:m.Z.fontWeight.medium,letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",margin:0},content:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.myProfile.managedByline",defaultMessage:"Your account is managed by {domain}",values:{domain:t}})}),(0,oe.jsx)(te.Z,{render:e=>(0,oe.jsx)("div",{...e,children:(0,_i.D)({marginLeft:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.myProfile.managedByTooltip",defaultMessage:"Contact your organization's administrator to change your profile information."})})]}):null,(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.myProfile.title",defaultMessage:"My profile"})]})}function Zh(e){let{spaceProfileSettingsStore:t}=e;window.__c={n:"AccountSupportSection"};const[s,i]=(0,a.VK)((()=>{var e;return[(null===(e=t.state.emailDomainSettings)||void 0===e?void 0:e.settings)??{},t.state.emailDomainSettings]}),[t]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.support.title",defaultMessage:"Support"})}),(0,oe.jsx)(kh.Z,{emailDomainSettings:s}),(0,oe.jsx)(ro.Z,{size:18,isHidden:!0}),(0,oe.jsx)(Og,{}),(0,oe.jsx)(ro.Z,{size:18,isHidden:!0}),(0,oe.jsx)(kg.Z,{userEmailDomainSettings:i})]})}function Fh(e){let{spaceStore:t,environment:s,requestType:i}=e;const[{value:n}]=(0,To.r5)((async()=>{const e=await M.getAccessRequests(s,{parentTable:"space",parentId:t.id,size:100,status:"pending"});if("failed"===e.type)throw e.error;const n=e.data.accessRequestIds;return(await g.Vy(t,n)).filter((e=>e.requestType===i))}),[t,s,i]);return{requests:(0,a.VK)((()=>null==n?void 0:n.filter((e=>"pending"===e.accessRequestStore.getKeyStore("status").getValue()))),[n])}}var Ah=s(79362),Rh=s(80136),Dh=s(60071);function Bh(e){let{guest:t,spaceStore:s}=e;window.__c={n:"GuestActionsCell"};const{styles:n,isSubscribed:o,handleConvertToMemberClick:r}=function(e){let{guest:t,spaceStore:s}=e;const n=(0,Je.yK)((e=>({buttonIcon:{width:20,height:20,fill:"#91918E"},upgradeButton:{},removeButton:{color:Ah.Lr[e.mode].red},upgradeIcon:{width:17,height:17}})),[]),o=(0,a.VK)((()=>{const{data:e}=ui.default.state;return Boolean(e&&yi.YK(e))}),[]),r=(0,T.O7)(),l=(0,i.useCallback)((()=>{const e=He.U6.createChildStore(s,{table:F.KJ,id:t.userId}),i=o?"read_and_write":"editor";Rh.s({environment:r,guestUserStore:e,role:i,store:s,isConvertToAdmin:!o,origin:"guest_pages_popup"})}),[o,s,r,t.userId]);return{styles:n,isSubscribed:o,handleConvertToMemberClick:l}}({guest:t,spaceStore:s});return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,renderOrigin:e=>(0,oe.jsx)(ve.Z,{...e,children:(0,oe.jsx)(oe.Fragment,{children:(0,Hi.o)(n.buttonIcon)})}),render:()=>(0,oe.jsx)("div",{children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:0,sections:[{key:"upgrade",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:[{key:"upgrade",render:e=>(0,oe.jsx)(Y.Z,{...e,focused:!1,buttonStyle:n.upgradeButton,icon:(0,Dh.Mnh)(n.upgradeIcon),title:(0,oe.jsx)(p.FormattedMessage,{id:"peopleSectionguestsTab.upgradeToAdmin",defaultMessage:"Upgrade to {isSubscribed, select, true {admin} other {member}}",values:{isSubscribed:o}})}),action:()=>{r()}}]},{key:"remove",render:e=>(0,oe.jsx)(ee.Z,{...e,style:{borderTop:"1px solid rgba(227, 226, 224, 0.50)"}}),items:[{key:"remove",render:e=>(0,oe.jsx)(Y.Z,{...e,focused:!1,buttonStyle:n.removeButton,icon:(0,Dh.ISU)(n.upgradeIcon),title:(0,oe.jsx)(p.FormattedMessage,{id:"peopleSectionguestsTab.remove",defaultMessage:"Remove from workspace"})}),action:()=>{r()}}]}]})})})}function Lh(e){let{guest:t,spaceStore:s}=e;window.__c={n:"GuestPagesContent"};const{menuListItems:i,styles:n}=function(e){let{guest:t,spaceStore:s}=e;const i=(0,Je.yK)((e=>({container:{width:256},chevron:{marginLeft:8,width:16,height:16}})),[]),n=(0,T.O7)(),o=(0,p.useIntl)();return{menuListItems:(0,a.VK)((()=>t.guestPageIds.map((e=>{var i;const a=He.G.createChildStore(s,{table:Vt.iU,id:e}),r=null===(i=a.getPermissionItems().find((e=>"user_permission"===e.type&&e.user_id===t.userId)))||void 0===i?void 0:i.role;return{key:e,render:e=>(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(Xu.Z,{...e,store:a,placeholder:(0,oe.jsx)(p.FormattedMessage,{id:"guestPagesPopup.privatePagePlaceholder",defaultMessage:"Private page"}),caption:r?o.formatMessage((0,Et.kD)(r,"block")):void 0})}),action:()=>{const e=(0,$i.ZP)({store:a,fullyQualified:!1,pageVisitSource:Gi.tY.LinkInPage});v.navigate({environment:n,url:e,openInNew:"tab"})}}}))),[s,t,n,o]),styles:i}}({guest:t,spaceStore:s});return(0,oe.jsx)("div",{style:n.container,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:0,sections:[{key:"pages",render:e=>(0,oe.jsx)(ee.Z,{...e}),items:i}]})})}function Nh(e){let{guest:t,spaceStore:s}=e;window.__c={n:"GuestPagesCell"};const{styles:i,numOfPages:n}=function(e){let{guest:t,spaceStore:s}=e;return{styles:(0,Je.yK)((e=>({button:{marginRight:8},noTeams:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),numOfPages:t.guestPageIds.length}}({guest:t,spaceStore:s});return 0===n?(0,oe.jsx)(ve.Z,{disabled:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"peopleSectionguestsTab.guestPagesCell.noPages",defaultMessage:"No pages"})}):(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,renderOrigin:e=>(0,oe.jsxs)(ve.Z,{...e,children:[(0,oe.jsx)(p.FormattedMessage,{id:"guestPagesCell.button",defaultMessage:"{numOfPages, plural, one {{numOfPages} page} other {{numOfPages} pages}}",values:{numOfPages:n}}),(0,Jn.i)(i.chevron)]}),render:()=>(0,oe.jsx)(Lh,{guest:t,spaceStore:s})})}function Oh(e){let{user:t,spaceStore:s}=e;window.__c={n:"UserCell"};const{name:i,email:n,userStore:o,styles:r}=function(e){let{user:t,spaceStore:s}=e;const i=(0,Je.yK)((()=>({container:{display:"flex",alignItems:"center",fontSize:m.Z.fontSize.UIRegular.desktop,gap:10,flex:"1 0 0",maxWidth:50},userAvatar:{paddingRight:6},userName:{height:17,alignSelf:"stretch",fontSize:m.Z.fontSize.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",maxWidth:220,...m.Z.textOverflowStyle},userEmail:{height:17,alignSelf:"stretch",fontSize:m.Z.fontSize.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:"#787774",maxWidth:220,...m.Z.textOverflowStyle}})),[]),n=(0,p.useIntl)(),o=He.U6.createChildStore(s,{table:F.KJ,id:t.userId}),{name:r,email:l}=(0,a.VK)((()=>({name:o.getDisplayName(n),email:o.getEmail()})),[o,n]);return{name:r,email:l,styles:i,userStore:o}}({user:t,spaceStore:s});return(0,oe.jsxs)("div",{style:r.container,children:[(0,oe.jsx)(wn.Z,{style:r.userAvatar,avatarShouldShowShadow:!0,userStore:o,size:28}),(0,oe.jsxs)("div",{children:[(0,oe.jsx)("div",{style:r.userName,children:i}),(0,oe.jsx)("div",{style:r.userEmail,children:n})]})]})}function Eh(e){let{guests:t,spaceStore:s}=e;window.__c={n:"GuestsTable"};const{tableStyles:n,styles:o,sortState:r,setSortState:l,selectedRowIds:d,setSelectedRowIds:c,rows:u}=function(e){let{guests:t,spaceStore:s}=e;const n=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:Vh,theme:e,containerMarginTop:12})),[]),o=(0,Je.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510},titleNumber:{color:"#ACABA9"},emptyMessage:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),[r,l]=(0,i.useState)({column:Vh[0],sortAscending:!0}),[d,c]=(0,i.useState)([]),u=(0,p.useIntl)(),m=(0,a.VK)((()=>t.map((e=>{const t=He.U6.createChildStore(s,{table:F.KJ,id:e.userId});return{spaceStore:s,user:e,email:t.getEmail(),userName:t.getDisplayName(u),id:e.userId,isClickable:!1}}))),[s,t,u]);return{tableStyles:n,styles:o,sortState:r,setSortState:l,selectedRowIds:d,setSelectedRowIds:c,rows:m}}({guests:t,spaceStore:s});return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("div",{style:o.titleContainer,children:[(0,oe.jsx)("span",{children:(0,oe.jsx)(p.FormattedMessage,{id:"peopleSectionguestsTab.activeguests.title",defaultMessage:"Active"})}),(0,oe.jsx)("span",{style:o.titleNumber,children:t.length})]}),(0,oe.jsx)(Pt.D,{setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Vh,rows:Uh(u,r),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:r,onSortStateChanged:l,renderNoRowsComponent:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:o.emptyMessage,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:n,multiselect:{header:{isDisabled:!1,isSelected:d.length===u.length,onClick:()=>{d.length===u.length?c([]):c(u.map((e=>e.id)))}},row:{getDisabledState:()=>!1,getSelectedState:e=>d.includes(e.id),onClick:e=>{c((t=>t.includes(e.id)?t.filter((t=>t!==e.id)):t.concat(e.id)))}}}})]})}const Vh=[{id:"user",headerTitle:"User",renderCell:e=>(0,oe.jsx)(Oh,{user:e.user,spaceStore:e.spaceStore}),widthData:{width:100},sortable:!0},{id:"access",headerTitle:"Access",renderCell:e=>(0,oe.jsx)(Nh,{guest:e.user,spaceStore:e.spaceStore}),widthData:{width:100},sortable:!0},{id:"actions",headerTitle:"",renderCell:e=>(0,oe.jsx)(Bh,{guest:e.user,spaceStore:e.spaceStore}),widthData:{width:50},sortable:!0}];function Uh(e,t){let{sortAscending:s}=t;const i=l.MR(e,(e=>e.email));return s||i.reverse(),i}var Wh=s(5705),Kh=s(20586),zh=s(85740);function qh(e){let{request:t,spaceStore:s,shouldDisableInteraction:n}=e;window.__c={n:"RequestActionsCell"};const{styles:a,handleApprove:o,handleDecline:r,isApproveButtonLoading:l,isDeclineButtonLoading:d}=function(e){let{request:t,spaceStore:s}=e;const n=(0,Je.yK)((e=>({approveButton:{background:e.outlineBlueButtonHoveredBackground,color:e.blueColor,fontWeight:510,fontSize:14,borderRadius:4,paddingLeft:10,paddingRight:10},declineButton:{marginRight:10,borderRadius:4,paddingLeft:10,paddingRight:10}})),[]),a=(0,T.O7)(),o=(0,i.useMemo)((()=>ga.kk.fromAccessRequest(t.accessRequest)),[t]),[r,l]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!1),{forActor:u,accessRequestStore:m}=t,h=(0,i.useCallback)((()=>{c(!0),o.isGuestInviteRequest()?g.yW({environment:a,accessRequest:o,status:"approved",from:"requests_center",forActor:ga.kk.fromUser(u),onResolveComplete:e=>{c(!1),e?Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveGuestInvite.success",defaultMessage:"Invited {actorEmail} as guest",values:{actorEmail:u.email}})}):Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveGuestInvite.failure",defaultMessage:"Failed to invite {actorEmail} as a guest",values:{actorEmail:u.email}})})}}):o.isSpaceMembershipRequest()&&g.kn({environment:a,store:s,accessRequestStore:m,forActor:u,status:"approved",from:"requests_center",onResolveComplete:e=>{c(!1),e?Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveSpaceMembership.success",defaultMessage:"Added {actorEmail} as a member",values:{actorEmail:u.email}})}):Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveSpaceMembership.failure",defaultMessage:"Failed to add {actorEmail} as a member",values:{actorEmail:u.email}})})}})}),[o,a,m,u,s]),f=(0,i.useCallback)((()=>{l(!0),o.isGuestInviteRequest()?g.yW({environment:a,accessRequest:o,status:"rejected",from:"requests_center",forActor:ga.kk.fromUser(u),onResolveComplete:()=>{l(!0)}}):o.isSpaceMembershipRequest()&&g.kn({environment:a,store:s,accessRequestStore:m,forActor:u,status:"rejected",from:"requests_center",onResolveComplete:()=>{l(!0)}})}),[o,a,m,u,s]);return{styles:n,handleApprove:h,handleDecline:f,isApproveButtonLoading:d,isDeclineButtonLoading:r}}({request:t,spaceStore:s});return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{children:(0,oe.jsx)(ve.Z,{style:a.declineButton,onClick:r,isLoading:d,disabled:n,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.Decline",defaultMessage:"Decline"})})}),(0,oe.jsx)("div",{children:(0,oe.jsx)(ve.Z,{style:a.approveButton,onClick:o,isLoading:l,disabled:n,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.approve",defaultMessage:"Approve"})})})]})}function Gh(e){let{spaceStore:t,createdByActorsWithReason:s,latestRequestTime:i}=e;return(0,oe.jsx)("div",{style:{width:241,maxHeight:600,overflowY:"auto",whiteSpace:"pre-wrap",padding:"12px 12px 12px 12px"},children:s.map((e=>(0,oe.jsx)(Hh,{spaceStore:t,createdByActorWithReason:e,latestRequestTime:i},e.actor.id)))})}function Hh(e){let{spaceStore:t,createdByActorWithReason:s,latestRequestTime:i}=e;window.__c={n:"RequestReasonContentInternal"};const{requestorName:n,reason:o,actor:r,styles:l}=function(e){let{spaceStore:t,createdByActorWithReason:s}=e;const{actor:i,reason:n}=s,o=(0,p.useIntl)(),r=(0,a.VK)((()=>He.U6.createChildStore(t,{table:F.KJ,id:i.id}).getDisplayName(o)),[o,i,t]),l=(0,Je.yK)((()=>({avatar:{marginRight:10,marginTop:2,userSelect:"none",WebkitUserSelect:"none"},userName:{textOverflow:"ellipsis",fontSize:14,fontWeight:510,whiteSpace:"normal"},timestamp:{margin:"0 6px",flexBasis:140,whiteSpace:"normal",flexGrow:1,display:"inline",fontSize:12,fontWeight:400,color:"#ACABA9"},userRow:{alignItems:"center",position:"relative",display:"flex",flexDirection:"row",userSelect:"none",WebkitUserSelect:"none"},reason:{paddingLeft:30,fontSize:14,fontWeight:400,color:"#1D1B16",letterSpacing:"-0.154px",display:"inline-block",overflowWrap:"break-word",inlineSize:200},noReason:{color:"#ACABA9"}})),[]);return{requestorName:r,reason:n,actor:i,styles:l}}({spaceStore:t,createdByActorWithReason:s});return(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:l.userRow,children:[(0,oe.jsx)(wn.Z,{hasTooltip:!0,userValue:r,style:l.avatar,size:20,avatarShouldShowShadow:!0}),(0,oe.jsx)("div",{style:{overflow:"hidden"},children:(0,oe.jsx)("span",{style:l.userName,children:n})}),(0,oe.jsx)(at.Z,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:l.timestamp,children:(0,vr.IS)(i)})]}),(0,oe.jsx)("span",{style:l.reason,children:o||(0,oe.jsx)("div",{style:l.noReason,children:(0,oe.jsx)(p.FormattedMessage,{id:"requestReasonContent.noReason",defaultMessage:"No request reason provided"})})})]})}function Qh(e){let{request:t,spaceStore:s,shouldDisableInteraction:i}=e;window.__c={n:"RequestedByCell"};const{styles:n,firstRequestorName:o,numberOfRequestors:r}=function(e){let{request:t,spaceStore:s}=e;const i=(0,Je.yK)((e=>({firstRequestorName:{color:e.lightTextColor},buttonSuffix:{color:"#ACABA9",paddingLeft:4},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),n=(0,p.useIntl)(),{firstRequestorName:o}=(0,a.VK)((()=>{if(0===t.createdByActorsWithReason.length)return{firstRequestorName:void 0};return{firstRequestorName:He.U6.createChildStore(s,{table:F.KJ,id:t.createdByActorsWithReason[0].actor.id}).getDisplayName(n)}}),[n,t.createdByActorsWithReason,s]);return{styles:i,firstRequestorName:o,numberOfRequestors:t.createdByActorsWithReason?t.createdByActorsWithReason.length:0}}({request:t,spaceStore:s});return void 0===o||0===r?null:(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,renderOrigin:e=>(0,oe.jsx)(ve.Z,{...e,disabled:i,children:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("span",{style:n.firstRequestorName,children:o}),(0,oe.jsx)("span",{style:n.buttonSuffix,children:r>1?(0,oe.jsxs)("div",{children:["+",r-1]}):null}),(0,Jn.i)(n.chevron)]})}),render:()=>(0,oe.jsx)(Gh,{spaceStore:s,createdByActorsWithReason:t.createdByActorsWithReason,latestRequestTime:t.latestRequestTime})})}function Yh(e){let{request:t,spaceStore:s}=e;window.__c={n:"RequestUserCell"};const{relativeDate:i,email:n,userStore:o,styles:r}=function(e){let{request:t,spaceStore:s}=e;const i=(0,Je.yK)((()=>({container:{display:"flex",alignItems:"center",fontSize:m.Z.fontSize.UIRegular.desktop,gap:10,flex:"1 0 0",maxWidth:50},userAvatar:{paddingRight:6},title:{height:17,alignSelf:"stretch",fontSize:m.Z.fontSize.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",maxWidth:220,...m.Z.textOverflowStyle},subtitle:{height:17,alignSelf:"stretch",fontSize:m.Z.fontSize.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:"#787774",maxWidth:220,...m.Z.textOverflowStyle}})),[]),n=He.U6.createChildStore(s,{table:F.KJ,id:t.forActor.id}),{email:o}=(0,a.VK)((()=>({email:n.getEmail()})),[n]),r=(0,p.useIntl)(),l=I.CQ(t.latestRequestTime,(0,Se.r)()),d=(0,Dt.ZV)({value:l,date_format:"relative",userTimeZone:(0,Se.r)(),intl:r,allowRelativeDates:!0});return{email:o,styles:i,userStore:n,relativeDate:d}}({request:t,spaceStore:s});return(0,oe.jsxs)("div",{style:r.container,children:[(0,oe.jsx)(wn.Z,{style:r.userAvatar,avatarShouldShowShadow:!0,userStore:o,size:28}),(0,oe.jsxs)("div",{children:[(0,oe.jsx)("div",{style:r.title,children:n}),(0,oe.jsx)("div",{style:r.subtitle,children:i})]})]})}function $h(e){let{spaceStore:t,requests:s}=e;window.__c={n:"PeopleSectionRequestsTable"};const{tableStyles:n,styles:o,sortState:r,setSortState:l,selectedRowIds:d,setSelectedRowIds:c,rows:u,isDeclineButtonLoading:m,isApproveButtonLoading:h,onClickApprove:f,onClickDecline:y}=function(e){let{spaceStore:t,requests:s}=e;const n=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:Jh,theme:e,containerMarginTop:12})),[]),o=(0,Je.yK)((e=>({headerContainer:{display:"flex",justifyContent:"space-between"},titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,minHeight:30},titleNumber:{color:"#ACABA9"},actionsContainer:{display:"flex",borderRadius:6,border:"1px solid #E3E2E0",boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderRadius:"4px 0px 0px 4px",paddingLeft:0,paddingRight:0},buttonContainer:{display:"flex",padding:"0px 12px 0px 10px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch"},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonDivider:{width:1,background:"rgba(227, 226, 224, 0.50)"},actionRightButton:{borderRadius:"0px 4px 4px 0px",paddingLeft:0,paddingRight:0}})),[]),[r,l]=(0,i.useState)({column:Jh[0],sortAscending:!0}),[d,c]=(0,i.useState)([]),u=(0,a.VK)((()=>s.map((e=>{const s=He.U6.createChildStore(t,{table:F.KJ,id:e.forActor.id});return{spaceStore:t,request:e,email:s.getEmail(),id:e.forActor.id,isClickable:!1,shouldDisableInteraction:d.includes(e.forActor.id)}}))),[t,s,d]),m=(0,a.VK)((()=>u.filter((e=>d.includes(e.id))).map((e=>e.request))),[d,u]),[h,f]=(0,i.useState)(!1),[y,x]=(0,i.useState)(!1),v=(0,T.O7)(),S=(0,i.useCallback)((()=>{if(0===m.length)return;x(!0);const e=ga.kk.fromAccessRequest(m[0].accessRequest);e.isGuestInviteRequest()?g.mY({environment:v,requests:m,status:"approved",from:"requests_center",onResolveComplete:(e,t)=>{x(!1),c([]),e.length>0?Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests",defaultMessage:"Approved {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:e.length,userEmail:e[0].email}})}):t.length>0&&Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests.failed",defaultMessage:"Failed approve {numberOfRequests, plural, one {guest request for {userEmail}} other {{numberOfRequests} guest requests}}, please try again.",values:{numberOfRequests:t.length,userEmail:t[0].email}})})}}):e.isSpaceMembershipRequest()&&g.YN({environment:v,store:t,requests:m,status:"approved",from:"requests_center",onResolveComplete:e=>{x(!1),c([]),e?Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.success",defaultMessage:"Approved {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:m.length,userEmail:m[0].forActor.email}})}):Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.failed",defaultMessage:"Failed approve {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:m.length,userEmail:m[0].forActor.email}})})}})}),[m,v,t]),b=(0,i.useCallback)((()=>{if(0===m.length)return;f(!0);const e=ga.kk.fromAccessRequest(m[0].accessRequest);e.isGuestInviteRequest()?g.mY({environment:v,requests:m,status:"rejected",from:"requests_center",onResolveComplete:(e,t)=>{f(!1),c([]),e.length>0?Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.success",defaultMessage:"Declined {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:e.length,userEmail:e[0].email}})}):t.length>0&&Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.failed",defaultMessage:"Failed decline {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}, please try again.",values:{numberOfSuccesses:t.length,userEmail:t[0].email}})})}}):e.isSpaceMembershipRequest()&&g.YN({environment:v,store:t,requests:m,status:"rejected",from:"requests_center",onResolveComplete:e=>{f(!1),c([]),e?Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.success",defaultMessage:"Declined {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:m.length,userEmail:m[0].forActor.email}})}):Wo.oV({label:(0,oe.jsx)(p.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.failed",defaultMessage:"Failed decline {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:m.length,userEmail:m[0].forActor.email}})})}})}),[m,v,t]);return{tableStyles:n,styles:o,sortState:r,setSortState:l,selectedRowIds:d,setSelectedRowIds:c,rows:u,selectedRequests:m,isDeclineButtonLoading:h,isApproveButtonLoading:y,onClickApprove:S,onClickDecline:b}}({spaceStore:t,requests:s});return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("div",{style:o.headerContainer,children:[(0,oe.jsxs)("div",{style:o.titleContainer,children:[(0,oe.jsx)("div",{children:(0,oe.jsx)(p.FormattedMessage,{id:"peopleSectionMembersTab.memberRequests.title",defaultMessage:"Requests"})}),(0,oe.jsx)("span",{style:o.titleNumber,children:s.length})]}),d.length>0&&(0,oe.jsxs)("div",{style:o.actionsContainer,children:[(0,oe.jsx)(zh.Z,{style:o.actionLeftButton,onClick:f,isLoading:h,children:(0,oe.jsxs)("div",{style:{...o.buttonContainer,color:"#2383E2"},children:[(0,oe.jsx)("div",{style:o.buttonIcon,children:(0,Wh.M)({width:20,height:16})}),(0,oe.jsx)("div",{style:o.buttonText,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.bulkApprove",defaultMessage:"Approve {numberOfRequests, plural, one {1 request} other {{numberOfRequests} requests}}",values:{numberOfRequests:d.length}})})]})}),(0,oe.jsx)("div",{style:o.buttonDivider}),(0,oe.jsx)(zh.Z,{style:o.actionRightButton,onClick:y,isLoading:m,children:(0,oe.jsxs)("div",{style:{...o.buttonContainer,color:"#787774"},children:[(0,oe.jsx)("div",{style:{...o.buttonIcon,paddingTop:3},children:(0,Kh.$)({width:20,height:16})}),(0,oe.jsx)("div",{style:o.buttonText,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.bulkDecline",defaultMessage:"Decline"})})]})})]})]}),(0,oe.jsx)(Pt.D,{setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Jh,rows:Xh(u,r),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:r,onSortStateChanged:l,renderNoRowsComponent:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:n,getStyleForRow:e=>{if(e.shouldDisableInteraction)return{opacity:.5,backgroundColor:"rgba(35, 131, 226, 0.07)"}},multiselect:{header:{isDisabled:!1,isSelected:d.length===u.length,onClick:()=>{d.length===u.length?c([]):c(u.map((e=>e.id)))}},row:{getDisabledState:()=>!1,getSelectedState:e=>d.includes(e.id),onClick:e=>{c((t=>t.includes(e.id)?t.filter((t=>t!==e.id)):t.concat(e.id)))}}}})]})}const Jh=[{id:"user",headerTitle:"User",renderCell:e=>(0,oe.jsx)(Yh,{request:e.request,spaceStore:e.spaceStore}),widthData:{width:100},sortable:!0},{id:"requestBy",headerTitle:"Requested by",renderCell:e=>(0,oe.jsx)(Qh,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:100},sortable:!0},{id:"actions",headerTitle:(0,oe.jsx)(oe.Fragment,{}),renderCell:e=>(0,oe.jsx)(qh,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:50},sortable:!0}];function Xh(e,t){let{sortAscending:s}=t;const i=l.MR(e,(e=>e.email));return s||i.reverse(),i}function ef(e){let{environment:t,spaceStore:s,guests:i}=e;window.__c={n:"PeopleSectionGuestsTab"};const{requests:n}=Fh({spaceStore:s,environment:t,requestType:"guest"});return(0,oe.jsxs)(oe.Fragment,{children:[n&&n.length>0?(0,oe.jsx)($h,{requests:n,spaceStore:s}):void 0,(0,oe.jsx)(Eh,{guests:i,spaceStore:s})]})}function tf(e){let{environment:t,spaceStore:s}=e;return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(sf,{}),(0,oe.jsx)(nf,{environment:t,spaceStore:s})]})}function sf(){window.__c={n:"PeopleSettingHeader"};const e=rf();return(0,oe.jsxs)("div",{style:e.commonTitle,children:[(0,oe.jsx)("div",{style:e.commonTitleText,children:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.people.common.title",defaultMessage:"People"})}),(0,oe.jsx)("div",{style:e.commonHelpButton,children:(0,oe.jsx)(Xr.Z,{analyticsFrom:"invite_people",href:(0,Gs.UY)("guides.invitePerson")})})]})}function nf(e){let{environment:t,spaceStore:s}=e;window.__c={n:"SpaceInviteLink"};const i=(0,a.qz)(void 0,rm.Z),n=(0,a.VK)((()=>{const e=ui.default.state.data;return function(e){let{environment:t,spaceStore:s,subscriptionData:i}=e;if(!s.canEditMembership())return;const n=s.id,a=i&&("subscribed_admin"===i.type||"unsubscribed_admin"===i.type||"subscribed_membership_admin"===i.type)&&i.inviteLinkCode;if(!a)return;return(0,Ta.cJ)(t,n,a)}({spaceStore:s,environment:t,subscriptionData:e})}),[s,t]),o=(0,a.VK)((()=>function(e){let{environment:t,spaceStore:s}=e;return s.canEditMembership()&&yi.qF(t)}({environment:t,spaceStore:s})),[t,s]),r=(0,a.VK)((()=>Boolean(s.getInviteLinkEnabled())),[s]),l=rf();return o&&n?(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:l.inviteLinkSection,children:[(0,oe.jsxs)("div",{style:{marginRight:8,flexGrow:1},children:[(0,oe.jsx)(bt.Z,{children:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.title",defaultMessage:"Invite link"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.caption.v2",defaultMessage:"Enable a secret link for Workspace Owners and Membership Admins to invite new members."})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:i&&r&&n&&of({environment:t,spaceStore:s})})]}),(0,oe.jsx)("div",{style:{marginTop:28},children:(0,oe.jsx)(jr.Z,{on:r,onClick:()=>{!function(e){let{environment:t,spaceStore:s,inviteLinkEnabled:i}=e;const n=!i;f.eoz(t,{enabled:n}),C.createAndCommit({userAction:"SpacePermissionsSettings.handleInviteLinkClick",environment:t,perform:e=>{S.ys({transaction:e,spaceStore:s,inviteLinkEnabled:Boolean(n)})}})}({environment:t,spaceStore:s,inviteLinkEnabled:r})}})})]}),i&&r&&n&&af({inviteLinkUrl:n,environment:t}),(0,oe.jsx)(ro.Z,{size:40})]}):null}function af(e){let{environment:t,inviteLinkUrl:s}=e;return(0,oe.jsx)("div",{children:(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px",alignSelf:"stretch",paddingBottom:"0px"},children:[(0,oe.jsx)(_e.Z,{type:"text",format:_e.B.Default,value:s,disabled:!0,style:{height:32,padding:"0px 4px 0px 8px",alignItems:"center",gap:"8px",flex:"1 0 0",borderRadius:"6px",border:"1px solid rgba(227, 226, 224, 0.50)",background:"#F9F9F8"}}),(0,oe.jsx)(_t.Z,{onClick:()=>{!function(e){let{environment:t,inviteLinkUrl:s}=e;It.RD({environment:t,stringValue:s,copiedMessage:It.tq.copiedLinkToClipboard}),f.nlj(t)}({environment:t,inviteLinkUrl:s})},style:{display:"flex",height:"32px",padding:"0px 12px",justifyContent:"center",alignItems:"center",borderRadius:"6px",border:"1px solid #E3E2E0",paddingLeft:12,paddingRight:12},children:(0,oe.jsx)("div",{style:{fontSize:"14px",fontWeight:"510",lineHeight:"18px",textAlign:"center",fontStyle:"normal"},children:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.copyButton",defaultMessage:"Copy link"})})})]})})}function of(e){let{spaceStore:t,environment:s}=e;return(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.resetLink.v2",defaultMessage:"You can also <resetlink>generate a new link</resetlink>",values:{resetlink:e=>(0,oe.jsx)(co.Z,{onClick:()=>{y.showDialog({message:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.description",defaultMessage:"Are you sure you want to reset the invite link for all space members? Your old one will no longer be able to be used."}),showCancel:!0,keepFocus:!1,handleCancel:y.dismissDialog,items:[{label:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.accept",defaultMessage:"Reset"}),color:"red",onAccept:async()=>{await M.refreshInviteLink(s,{spaceId:t.id}),gi.bi(s)}}]})},children:e})}})}function rf(){return(0,Je.yK)((()=>({commonTitle:{display:"flex",width:"790px",alignItems:"flex-start",gap:"5px"},commonTitleText:{fontSize:"17px",lineHeight:"22px",fontWeight:590,color:"#1D1B16",fontStyle:"normal"},commonHelpButton:{paddingLeft:"1px"},inviteLinkSection:{paddingTop:"16px",paddingBottom:"16px",display:"flex",alignItems:"flex-start"}})),[])}function lf(e){let{user:t,spaceStore:s}=e;window.__c={n:"UserGroupsCell"};const{styles:i,numberOfGroups:n,firstGroupName:o}=function(e){let{user:t,spaceStore:s}=e;const i=(0,a.VK)((()=>s.getPermissionGroups().filter((e=>(0,Wn.kQ)({group:e,spaceStore:s}).includes(t.userId)))),[s,t.userId]),n=(0,Je.yK)((e=>({button:{marginRight:8},noGroups:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},noneGroupText:{color:"#ACABA9"},groupNameText:{color:e.lightTextColor,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:50},groupNumberText:{color:e.lightTextColor}})),[]),o=(0,p.useIntl)(),r=i.length,l=r>0?(0,Wn.kF)({group:i[0],intl:o}):void 0;return{styles:n,numberOfGroups:r,firstGroupName:l}}({user:t,spaceStore:s});return(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,renderOrigin:e=>(0,oe.jsx)(ve.Z,{disabled:0===n,style:0===n?i.noGroups:i.button,...e,children:0===n?(0,oe.jsx)("span",{style:i.noneGroupText,children:(0,oe.jsx)(p.FormattedMessage,{id:"userGroupsCell.noGroups",defaultMessage:"None"})}):1===n?(0,oe.jsx)("span",{style:i.groupNameText,children:o}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:i.groupNumberText,children:n}),(0,Jn.i)(i.chevron)]})}),render:()=>null})})}var df=s(92625),cf=s(76464),uf=s(15010),mf=s(24665),pf=s(9634),gf=s(2469),hf=s(91567),ff=s(7567);function yf(e){let{user:t,spaceStore:s}=e;window.__c={n:"UserAccessLevelButton"};const i=(0,T.O7)(),{isPermissionSelectDisabled:n,currentUserId:o}=(0,a.VK)((()=>{let e=!0;return(s.canAdmin()||s.canEditMembership()&&(Ei.RN(t.role)||t.userId===i.currentUser.id))&&(e=!1),{isPermissionSelectDisabled:e,currentUserId:i.currentUser.id}}),[s,i,t.role,t.userId]),r=(0,a.VK)((()=>ie.default.state.currentUserSettingsStore),[]),c=(0,p.useIntl)(),u=(0,a.VK)((()=>{const e=c.formatMessage({id:"spacePermissionSettings.memberRoleSelect.permissionitem.roleUpgradeDisabled",defaultMessage:"Cannot upgrade to a higher role than member"}),t="enterprise"===s.getSubscriptionTier();return l.oA(Ei.an.map((i=>{if(t||"membership_admin"!==i)return{role:i,disabledInfo:!s.canAdmin()&&Ei.Bc(i)?{isDisabled:!0,disabledMessage:e}:void 0}})))}),[c,s]);return r?(0,oe.jsx)(ff.ZP,{role:t.role,table:Wt.bx,type:"user_permission",disabled:n,isUserPermission:t.userId===o,upgradeButtonName:"space_permission_item",availableRoleItems:u,onChange:async e=>{await xf({member:t,newRole:e,currentUserSettingsStore:r,spaceStore:s,environment:i})},onRemoveMemberClick:async()=>{let e,n;if(gf.U()&&(n=(0,d.ZP)(),e=await(0,hf.f)({environment:i,contractionSurveyId:n}),!e))return;await(async()=>await(0,pf.q)(i,t.userId,s.id))()&&(await(async e=>{await xf({member:t,newRole:"none",currentUserSettingsStore:r,spaceStore:s,environment:i}),f.SwX(i,{member_user_id:t.userId,member_role:t.role,contraction_survey_id:e,is_space:!0,invite_origin:"workspace_remove_member",domainType:(0,uf.JF)(),new_workspace_member_count:-1})})(n),e&&mf.w(i))}}):null}async function xf(e){let{member:t,newRole:s,currentUserSettingsStore:i,spaceStore:n,environment:a}=e;const o=a.currentUser.id;if(t.userId!==o||"none"!==s)!function(){const e=(0,p.defineMessages)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updating…"}});df.j({message:e.updatingPermissions})}(),"none"===s?(await M.removeUsersFromSpace(a,{userIds:[t.userId],spaceId:n.id,removePagePermissions:!0,revokeUserTokens:!0}),await gi.bi(a)):C.createAndCommit({userAction:"SpacePermissionsSettings.handleMemberPermissionRoleChange",environment:a,perform:e=>cf.ep({environment:a,store:n,permissionItems:[{type:"user_permission",role:s,user_id:t.userId}],transaction:e,from:"space_permission_setting_table"})}),df.x();else{await S.bf({environment:a,spaceId:n.id,userSettingsStore:i})&&(f.JkE(a,{invite_origin:"workspace_remove_member",domainType:(0,uf.JF)(),new_workspace_member_count:-1}),ci.Z.setState({...ci.Z.state,open:!1}))}}function vf(e){let{user:t,spaceStore:s}=e;return(0,oe.jsx)(yf,{user:t,spaceStore:s})}function Sf(e){let{spaceStore:t,user:s}=e;window.__c={n:"UserTeamspacesCell"};const{numberOfTeams:i,userTeamStores:n,styles:o}=function(e){let{spaceStore:t,user:s}=e;const i=(0,a.VK)((()=>ic.Z.state.teams.filter((e=>e.getMembers().some((e=>"user"===e.entity_type&&e.user_id===s.userId))))),[s.userId]),n=(0,Je.yK)((e=>({button:{marginRight:8},noTeams:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},teamspaceName:{color:e.lightTextColor},teamspaceNameSuffix:{color:"#ACABA9",paddingLeft:4}})),[]);return{numberOfTeams:i.length,userTeamStores:i,styles:n}}({spaceStore:t,user:s});return(0,oe.jsx)(nn.ZP,{popupType:nn.Z4.Popup,renderOrigin:e=>(0,oe.jsx)(ve.Z,{disabled:0===i,style:0===i?o.noTeams:o.button,...e,children:0===i?(0,oe.jsx)(p.FormattedMessage,{id:"teamsDropdownForMember.teamsCountNone.label",defaultMessage:"No access"}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("span",{style:o.teamspaceName,children:n[0].getName()}),(0,oe.jsx)("span",{style:o.teamspaceNameSuffix,children:i>1?(0,oe.jsxs)("div",{children:["+",i-1]}):null}),(0,Jn.i)(o.chevron)]})}),render:()=>(0,oe.jsx)(Ap.iQ,{member:s,teamStores:n})})}function bf(e){let{members:t,spaceStore:s}=e;window.__c={n:"MembersTable"};const{tableStyles:n,styles:o,sortState:r,setSortState:l,selectedRowIds:d,setSelectedRowIds:c,rows:u}=function(e){let{members:t,spaceStore:s}=e;const n=(0,Je.yK)((e=>(0,Pt.b)({columnRenderInfo:Mf,theme:e,containerMarginTop:12})),[]),o=(0,Je.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510},titleNumber:{color:"#ACABA9"},emptyMessage:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),[r,l]=(0,i.useState)({column:Mf[0],sortAscending:!0}),[d,c]=(0,i.useState)([]),u=(0,p.useIntl)(),m=(0,a.VK)((()=>t.map((e=>{const t=He.U6.createChildStore(s,{table:F.KJ,id:e.userId});return{spaceStore:s,user:e,email:t.getEmail(),userName:t.getDisplayName(u),id:e.userId,isClickable:!1}}))),[s,t,u]);return{tableStyles:n,styles:o,sortState:r,setSortState:l,selectedRowIds:d,setSelectedRowIds:c,rows:m}}({members:t,spaceStore:s});return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("div",{style:o.titleContainer,children:[(0,oe.jsx)("span",{children:(0,oe.jsx)(p.FormattedMessage,{id:"peopleSectionMembersTab.activeMembers.title",defaultMessage:"Active"})}),(0,oe.jsx)("span",{style:o.titleNumber,children:t.length})]}),(0,oe.jsx)(Pt.D,{setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Mf,rows:jf(u,r),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:r,onSortStateChanged:l,renderNoRowsComponent:()=>(0,oe.jsx)(at.Z,{isSmall:!0,style:o.emptyMessage,children:(0,oe.jsx)(p.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:n,multiselect:{header:{isDisabled:!1,isSelected:d.length===u.length,onClick:()=>{d.length===u.length?c([]):c(u.map((e=>e.id)))}},row:{getDisabledState:()=>!1,getSelectedState:e=>d.includes(e.id),onClick:e=>{c((t=>t.includes(e.id)?t.filter((t=>t!==e.id)):t.concat(e.id)))}}}})]})}const Mf=[{id:"user",headerTitle:"User",renderCell:e=>(0,oe.jsx)(Oh,{user:e.user,spaceStore:e.spaceStore}),widthData:{width:100},sortable:!0},{id:"teamspaces",headerTitle:"Teamspaces",renderCell:e=>(0,oe.jsx)(Sf,{user:e.user,spaceStore:e.spaceStore}),widthData:{width:50},sortable:!0},{id:"groups",headerTitle:"Groups",renderCell:e=>(0,oe.jsx)(lf,{user:e.user,spaceStore:e.spaceStore}),widthData:{width:50},sortable:!0},{id:"roles",headerTitle:"Roles",renderCell:e=>(0,oe.jsx)(vf,{user:e.user,spaceStore:e.spaceStore}),widthData:{width:50},sortable:!0}];function jf(e,t){let{sortAscending:s}=t;const i=l.MR(e,(e=>e.email));return s||i.reverse(),i}function wf(e){let{environment:t,spaceStore:s,members:i}=e;window.__c={n:"PeopleSectionMembersTab"};const{requests:n}=Fh({spaceStore:s,environment:t,requestType:"member"});return(0,oe.jsxs)(oe.Fragment,{children:[n&&n.length>0?(0,oe.jsx)($h,{requests:n,spaceStore:s}):void 0,(0,oe.jsx)(bf,{members:i,spaceStore:s})]})}var Cf=s(29825);function kf(e){let{spaceStore:t}=e;window.__c={n:"SpaceSettingsInviteButton"};const{shouldShowRequestMemberButtion:s,canEditMembership:i}=(0,a.VK)((()=>({shouldShowRequestMemberButtion:!t.canEditMembership()&&!t.getDisableMembershipRequests()&&(0,ot.p1)(),canEditMembership:t.canEditMembership()})),[t]),n=(0,a.VK)((()=>{const{data:e}=ui.default.state;return Boolean(e&&yi.YK(e))}),[]);return s?(0,oe.jsx)(Cf.Z,{store:t,analyticsFrom:"space_settings_add_members",origin:(0,oe.jsx)(Q.Z,{isLarge:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"inviteUserButton.requestMemberLabel",defaultMessage:"Add members"})})}):(0,oe.jsx)(Ji.LazyPermissionsInviteWithModal,{disabled:!i,store:t,onInviteClick:()=>{},onInviteComplete:()=>{},isSubscribed:n,membersOnly:!1,upgradeButtonName:"space_permission_settings",shouldGrow:!1})}function Tf(){window.__c={n:"SpaceSettingsPeopleSection"};const e=(0,T.O7)(),t=(0,a.VK)((()=>{const e=ie.default.state.currentSpaceStore;if(null!=e&&e.isDefined())return e}),[]),s=(0,a.VK)((()=>ji.Z.state.online),[]),i=(0,a.VK)((()=>ui.default.state.data),[]),n=(0,a.qz)(void 0,rm.Z);return t&&i?s?(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsx)(tf,{environment:e,spaceStore:t}),(0,oe.jsx)(Pf,{subscriptionData:i,spaceStore:t,spacePermissionsSettingsStore:n,environment:e})]}):(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})})}):(0,oe.jsx)(If,{})}function If(){return(0,oe.jsx)(Ti.Z,{style:{margin:"calc(50% - 1em) auto"}})}function Pf(e){let{subscriptionData:t,spaceStore:s,spacePermissionsSettingsStore:i,environment:n}=e;window.__c={n:"PeopleSectionContent"};const{visibleUsersLoaded:o,members:r,guests:d,currentTab:c,canReprovisionContent:m,tabs:g,currentTabs:h}=function(e){let{subscriptionData:t,spaceStore:s,spacePermissionsSettingsStore:i,environment:n}=e;const{visibleUsersLoaded:o,members:r,guests:d,numberOfGuests:c}=(0,a.VK)((()=>{const e=yi.CM(t);return{visibleUsersLoaded:l.yW(e.map((e=>He.U6.createChildStore(s,{table:F.KJ,id:e.userId}).isReady()))),members:e.filter(On.CF),guests:e.filter(On.du),numberOfGuests:e.filter(On.du).filter((e=>!e.isTeamGuest&&e.isPageGuest)).length}}),[t,s]),m=(0,a.VK)((()=>i.state.currentTab),[i]),g=(0,a.VK)((()=>s.canAdmin()&&u.wP(t.subscriptionTier)),[t,s]),h=(0,Je.yK)((e=>({activeTabStyle:{color:e.regularTextColor},inactiveTabStyle:{color:e.lightTextColor}})),[]),f=(0,a.VK)((()=>r?{[rm.Q.Members]:Ff({text:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.membersTab.title",defaultMessage:"Members"}),number:r.length,isCurrentTab:m===rm.Q.Members,styles:h}),[rm.Q.Guests]:Ff({text:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.title",defaultMessage:"Guests"}),number:c,isCurrentTab:m===rm.Q.Guests,styles:h}),[rm.Q.Groups]:Ff({text:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.groupsTab.title",defaultMessage:"Groups"}),number:r.length,isCurrentTab:m===rm.Q.Groups,styles:h}),[rm.Q.Reprovisioning]:Ff({text:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.reprovisioningTab.title",defaultMessage:"Recently left"}),number:c,isCurrentTab:m===rm.Q.Reprovisioning,styles:h}),[rm.Q.Requests]:(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceBasicSettings.requestsTab.title",defaultMessage:"Requests"})})}:{}),[r,c,m,h]),y=Zf(g),x=y.map((e=>f[e]));return{visibleUsersLoaded:o,members:r,guests:d,numberOfGuests:c,currentTab:m,canReprovisionContent:g,tabs:x,currentTabs:y}}({subscriptionData:t,spaceStore:s,spacePermissionsSettingsStore:i,environment:n});return o?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(mo.Z,{tabs:g,selectedIndex:h.indexOf(c),onChange:e=>function(e){let{newSelectedIndex:t,environment:s,spacePermissionsSettingsStore:i,currentTab:n,canReprovisionContent:a}=e;const o=Zf(a)[t];switch(o){case rm.Q.Members:f.qTS(s,{tab:"members"});break;case rm.Q.Groups:f.qTS(s,{tab:"groups"});break;case rm.Q.Guests:f.qTS(s,{tab:"guests"});break;case rm.Q.Reprovisioning:f.qTS(s,{tab:"reprovisioning"});break;case rm.Q.Requests:f.qTS(s,{tab:"requests"});break;default:(0,me.t1)(o)}n===rm.Q.Requests&&o!==rm.Q.Requests&&mi.Z.reset();i.setState({...i.state,currentTab:o})}({newSelectedIndex:e,environment:n,spacePermissionsSettingsStore:i,currentTab:c,canReprovisionContent:m}),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16,fontWeight:400},right:(0,oe.jsx)(kf,{spaceStore:s})}),_f({currentTab:c,spaceStore:s,environment:n,guests:d,members:r})]}):(0,oe.jsx)(If,{})}function _f(e){let{currentTab:t,spaceStore:s,environment:i,members:n,guests:a}=e;switch(t){case rm.Q.Members:return(0,oe.jsx)(wf,{spaceStore:s,environment:i,members:n});case rm.Q.Guests:return(0,oe.jsx)(ef,{spaceStore:s,environment:i,guests:a});default:return null}}function Zf(e){return[rm.Q.Members,rm.Q.Guests,rm.Q.Groups,...e?[rm.Q.Reprovisioning]:[]]}function Ff(e){let{text:t,number:s,isCurrentTab:i,unread:n,styles:a}=e;return(0,oe.jsxs)("div",{style:{fontSize:m.Z.fontSize.UIRegular.desktop,fontWeight:i?510:400,lineHeight:"18px",...i?a.activeTabStyle:a.inactiveTabStyle},children:[t,s&&s>0?(0,oe.jsx)("span",{style:{fontSize:m.Z.fontSize.UIRegular.desktop,lineHeight:"18px",paddingLeft:4,...a.inactiveTabStyle},children:s}):void 0]})}var Af=s(7189);function Rf(e){const{up:t}=e,s={width:10,height:10,marginLeft:4};return t?(0,Af.K)({...s,transform:"rotate(180deg)"}):(0,Af.K)(s)}function Df(e){let{users:t,store:s,extraColumns:n,initialSort:o}=e;window.__c={n:"UserTableBox"};const[r,d]=(0,i.useState)(o),c=(0,p.useIntl)();function u(e,t){return(0,oe.jsxs)(_t.Z,{disabled:!t.sortable,ignoreLocalHoverState:!0,onClick:()=>{!function(e){d({column:e,asc:(null==r?void 0:r.column)===e&&!(null!=r&&r.asc)})}(e)},style:{display:"flex",alignItems:"center"},children:[t.title,t.sortable&&r&&r.column===e&&Rf({up:r.asc})]},e)}const m=(0,i.useMemo)((()=>({title:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>(0,oe.jsx)(Zt.Z,{actorStore:e}),getValue:e=>e.getDisplayName(c)})),[c]),g=(0,i.useMemo)((()=>({name:m,...n})),[n,m]),h=l.XP(g).map((e=>({key:e,header:u(e,g[e]),style:g[e].style}))),f=(0,a.VK)((()=>{const e=t.map((e=>He.U6.createChildStore(s,{table:F.KJ,id:e.userId}))).filter((e=>e.isDefined()));return r?e.sort(((e,t)=>{const s=g[r.column].getValue(e),i=g[r.column].getValue(t);var n=s<i?-1:s>i?1:0;return r.asc?n:-1*n})):e}),[t,s,g,r]);return(0,oe.jsx)(uc.Z,{columns:h,rows:f.map((e=>{const t=Object.values(g).map(((t,s)=>t.renderer?t.renderer(e):(0,oe.jsx)(i.Fragment,{children:t.getValue(e)},s)));return{key:e.id,columns:t}}))})}var Bf=function(e){return e[e.UserUserSimilarity=0]="UserUserSimilarity",e}(Bf||{});const Lf={[Bf.UserUserSimilarity]:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettingsDebugZone.userUserSimilarity.title",defaultMessage:"User Similarity"})};function Nf(){const e=(0,jo.mS)();return["on"===lt.default.getGroup("user_similarity_debugging")||e?Bf.UserUserSimilarity:void 0].filter(me.$K)}function Of(e){let{store:t}=e;window.__c={n:"DebugZoneUserUserSimilarityTab"};const{isOnline:s,subscriptionDataStoreData:i,userSimilarityData:n,visibleUsersLoaded:o,visibleUsers:r}=(0,a.VK)((()=>{var e,s;const i=null===(e=ui.default.state)||void 0===e?void 0:e.data,n=i?yi.CM(i):[],a=l.yW(n.map((e=>He.U6.createChildStore(t,{table:F.KJ,id:e.userId}).isReady())));return{isOnline:ji.Z.state.online,subscriptionDataStoreData:i,userSimilarityData:(null===(s=ui.default.state.data)||void 0===s?void 0:s.userSimilarity)||{},visibleUsersLoaded:a,visibleUsers:n}}),[t]);if(!s)return(0,oe.jsx)(at.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})});if(!i)return(0,oe.jsx)(Ti.Z,{style:{margin:"calc(50% - 1em) auto"}});if(!o)return(0,oe.jsx)(Ti.Z,{style:{margin:"calc(50% - 1em) auto"}});const d={style:{},title:(0,oe.jsx)(oe.Fragment,{children:"Similarity Score"}),sortable:!0,renderer:e=>{var t;return(0,oe.jsx)(oe.Fragment,{children:(null===(t=n[e.id])||void 0===t?void 0:t.toFixed(3))||0})},getValue:e=>n[e.id]||0};return(0,oe.jsx)(Df,{users:r,store:t,extraColumns:{similarityColumn:d},initialSort:{column:"similarityColumn",asc:!1}})}function Ef(e){let{store:t}=e;window.__c={n:"SpaceSettingsDebugZone"};const{tabs:s}=(0,a.VK)((()=>({tabs:Nf()})),[]),[n,o]=(0,i.useState)(s[0]);return(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsx)(mo.Z,{tabs:s.map((e=>Lf[e])),selectedIndex:s.indexOf(n),onChange:e=>o(s[e]),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),n===Bf.UserUserSimilarity&&(0,oe.jsx)(Of,{store:t})]})}var Vf=s(93108),Uf=s(82356),Wf=s(47409),Kf=s(18442),zf=s(15967),qf=s(1436),Gf=s(36312),Hf=s(87393),Qf=s(72569),Yf=s(5108),$f=s(38400),Jf=s(64530),Xf=s(5517),ey=s(94157),ty=s(72263),sy=s(46783),iy=s(69196);const ny=(0,p.defineMessages)({accountTab:{id:"spaceSettingsSidebar.accountTab.title",defaultMessage:"My account"},settingsTab:{id:"spaceSettingsSidebar.settingsTab.title",defaultMessage:"Settings"},teamsTab:{id:"spaceSettingsSidebar.teamsTab.title",defaultMessage:"Teamspaces"},peopleTab:{id:"spaceSettingsSidebar.peopleTab.title",defaultMessage:"People"},membersTab:{id:"spaceSettingsSidebar.membersTab.title",defaultMessage:"Members"},plansTab:{id:"spaceSettingsSidebar.plansTab.title",defaultMessage:"Plans"},upgradeTab:{id:"spaceSettingsSidebar.upgradeTab.title",defaultMessage:"Upgrade"},billingTab:{id:"spaceSettingsSidebar.billingTab.title",defaultMessage:"Billing"},subscriptionTab:{id:"spaceSettingsSidebar.subscriptionTab.title",defaultMessage:"Subscription"},connectedAppsTab:{id:"spaceSettingsSidebar.connectedAppsTab.title",defaultMessage:"My connected apps"},userConnectionsTab:{id:"spaceSettingsSidebar.userConnectionsTab.title",defaultMessage:"My connections"},securitySAMLTab:{id:"spaceSettingsSidebar.securityAndSAMLTab.title",defaultMessage:"Security & identity"},securityTab:{id:"spaceSettingsSidebar.securityTab.title",defaultMessage:"Security"},identityProvisioningTab:{id:"spaceSettingsSidebar.identity&ProvisioningTab.title",defaultMessage:"Identity & provisioning"},publishingTab:{id:"spaceSettingsSidebar.publishingTab.title",defaultMessage:"Published pages"},adminContentSearchTab:{id:"spaceSettingsSidebar.adminContentSearch.title",defaultMessage:"Content search"},languageAndRegionTab:{id:"spaceSettingsSidebar.languageAndRegionTab.title",defaultMessage:"Language & region"},integrationsTab:{id:"spaceSettingsSidebar.integrationsTab.title",defaultMessage:"Integrations"},spaceConnectionsTab:{id:"spaceSettingsSidebar.spaceConnectionsTab.title",defaultMessage:"Connections"},experimentsTab:{id:"spaceSettingsSidebar.experimentsTab.title",defaultMessage:"Experiments"},auditLogTab:{id:"spaceSettingsSidebar.auditLogTab.title",defaultMessage:"Audit log"},notificationsAndSettings:{id:"spaceSettingsSidebar.notificationsAndSettings.title",defaultMessage:"My notifications & settings"},mySettings:{id:"spaceSettingsSidebar.mySettings.title",defaultMessage:"My settings"},myNotifications:{id:"spaceSettingsSidebar.myNotifications.title",defaultMessage:"My notifications"},debugZoneTab:{id:"spaceSettingsSidebar.debugZoneTab.title",defaultMessage:"Debug Zone"},analyticsTab:{id:"spaceSettingsSidebar.analyticsTab.title",defaultMessage:"Analytics"},importTab:{id:"spaceSettingsSidebar.importsTab.title",defaultMessage:"Import"}}),ay={width:20,height:20},oy={profile:e=>(0,iy.H)(ay),notifications_and_settings:()=>(0,Jf.y)(ay),user_settings:()=>(0,Jf.y)(ay),notifications:()=>(0,$f.V)(ay),connected_apps:()=>(0,qf.g)(ay),language_and_region:()=>(0,Qf.f)(ay),settings:()=>(0,Kf.H)(ay),teams:()=>(0,Br.K)(ay),members:()=>(0,Yf.n)(ay),plans:()=>{const{data:e}=ui.default.state;return e&&yi.YK(e)?(0,Xf.q)(ay):(0,ty._)(ay)},billing:()=>(0,zf.J)(ay),subscription:()=>(0,ey.t)(ay),security:()=>(0,Yi.I)(ay),identity_provisioning:()=>(0,Gf.o)(ay),admin_content_search:()=>(0,Vf.p)(ay),integrations:()=>(0,Hf.L)(ay),experiments:()=>(0,qp.t)(ay),audit_log:()=>(0,Wf.N)(ay),debug_zone:()=>(0,sy.w)(ay),analytics:()=>(0,r.v)(ay),imports:()=>(0,Uf.l)(ay),publishing:()=>(0,No.R)(ay)},ry={profile:()=>`${D.default.formatMessage(ny.accountTab)}`,notifications_and_settings:()=>D.default.formatMessage(ny.notificationsAndSettings),user_settings:()=>D.default.formatMessage(ny.mySettings),notifications:()=>D.default.formatMessage(ny.myNotifications),connected_apps:()=>D.default.formatMessage(ny.userConnectionsTab),language_and_region:()=>D.default.formatMessage(ny.languageAndRegionTab),settings:()=>D.default.formatMessage(ny.settingsTab),teams:()=>D.default.formatMessage(ny.teamsTab),members:()=>(0,ot.F$)()?D.default.formatMessage(ny.peopleTab):D.default.formatMessage(ny.membersTab),plans:()=>{const{data:e}=ui.default.state;return e&&yi.YK(e)?D.default.formatMessage(ny.plansTab):D.default.formatMessage(ny.upgradeTab)},billing:()=>D.default.formatMessage(ny.billingTab),subscription:()=>D.default.formatMessage(ny.subscriptionTab),security:()=>D.default.formatMessage(ny.securityTab),identity_provisioning:()=>D.default.formatMessage(ny.identityProvisioningTab),admin_content_search:()=>D.default.formatMessage(ny.adminContentSearchTab),integrations:()=>D.default.formatMessage(ny.spaceConnectionsTab),experiments:()=>D.default.formatMessage(ny.experimentsTab),audit_log:()=>D.default.formatMessage(ny.auditLogTab),debug_zone:()=>D.default.formatMessage(ny.debugZoneTab),analytics:()=>D.default.formatMessage(ny.analyticsTab),imports:()=>D.default.formatMessage(ny.importTab),publishing:()=>D.default.formatMessage(ny.publishingTab)},ly={profile:()=>null,notifications_and_settings:()=>null,user_settings:()=>null,notifications:()=>null,connected_apps:()=>null,language_and_region:()=>null,settings:()=>null,teams:()=>null,members:()=>null,plans:()=>null,billing:()=>null,subscription:()=>null,security:()=>null,identity_provisioning:()=>null,publishing:()=>null,admin_content_search:()=>null,integrations:()=>lt.default.checkGate("webhooks_beta")?(0,oe.jsx)(lo.Z,{}):null,experiments:()=>null,audit_log:()=>null,debug_zone:()=>null,analytics:()=>null,imports:()=>null};var dy=s(34859),cy=s(93349),uy=s(31796),my=s(27533);const py={workspaceBalance:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var gy=s(53336);const hy=(0,p.defineMessages)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit"},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});const fy=(0,p.injectIntl)((function(e){window.__c={n:"SubscriptionBillingSettingOption"};const t=(0,Je.Fg)(),s={marginLeft:18,marginRight:-4,fontWeight:m.Z.fontWeight.medium},{title:i,caption:n,buttonArgs:a}=e,o=(0,oe.jsx)(p.FormattedMessage,{...hy[a.buttonPurpose]});return(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:14},children:[(0,oe.jsx)("div",{style:{marginRight:"auto"},children:i}),(0,oe.jsx)("div",{style:{color:t.mediumTextColor},children:n}),(0,oe.jsx)("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"},children:a.showButton&&(0,oe.jsx)(ve.Z,{isBlue:!0,onClick:a.onClick,style:s,children:o})})]})}));class yy extends n.Z{constructor(){super(...arguments),this.storeTypes={store:cy.Z}}willMount(){gi.bi(this.environment),gi.zb(this.environment,this.stores.store)}renderComponent(){const{data:e}=this.props;return ji.Z.state.online?(0,oe.jsx)("div",{style:yy.wrapStyle,children:(0,oe.jsxs)(gy.Z,{style:yy.scrollerStyle,type:dy.Z.Y,children:[(0,oe.jsx)(bt.Z,{large:!0,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{...ny.billingTab})}),(0,oe.jsx)(vy,{data:e}),(0,oe.jsx)(Sy,{}),(0,oe.jsx)(uy.V,{spaceStore:this.props.spaceStore,events:this.stores.store.state.billingEvents,upcomingInvoiceData:void 0})]})}):yy.renderOfflineMessage()}static renderOfflineMessage(){return(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{textAlign:"center"},children:fi.s.offline})})}}yy.displayName="SpaceSubscriptionBillingUnsubscribed",yy.wrapStyle={display:"flex",flexDirection:"column",height:"100%"},yy.scrollerStyle={height:"100%",padding:"36px 60px"};const xy=yy;function vy(e){var t;let{data:s}=e;const i=null===(t=s.customerData)||void 0===t?void 0:t.stripe.currencyCode;if(!i)return null;const n=-Math.min(0,s.accountBalance);return(0,oe.jsx)(fy,{title:py.workspaceBalance,caption:(0,oe.jsx)("div",{children:(0,oe.jsx)(my.W,{cost:{amount:n,currencyCode:i},trailingZeroDisplay:"stripIfInteger"})}),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:l.ZT}})}function Sy(){return(0,oe.jsx)("div",{style:{flex:"none",marginTop:30}})}var by=s(2585),My=s(12139),jy=s(64891),wy=s(38461),Cy=s(65965),ky=s(89024),Ty=s(7124);const Iy=function(e){return!!e.device.isMobile||e.WindowSizeStore.state.width<960};var Py=s(73796),_y=s(173);const Zy=["free","plus","business","enterprise"];class Fy extends n.Z{renderComponent(){const e=(0,Cy.Sl)();return(0,oe.jsx)("div",{children:(0,oe.jsxs)("table",{style:Fy.getTableStyle(),children:[this.renderHeader(),(0,oe.jsx)("tbody",{children:e.map(((e,t)=>this.renderSection(e,t)))})]})})}renderCheck(){return(0,Zd.k)({display:"inline",height:12,width:12,color:this.theme.regularTextColor})}upgradeLink(e,t){const{planState:s}=this.props;if(s)return(0,oe.jsx)(co.Z,{onClick:s.plans[e].onClick,style:{fontSize:12,fontWeight:500,textDecoration:"none",color:this.theme.mediumTextColor,lineHeight:1.2},children:t||(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.planAttribute.button.upgrade",defaultMessage:"Upgrade"})})}renderPlanContent(e){const{label:t,upgradeCta:s,upgradeCTALabel:n}=e;return t&&s?(0,oe.jsxs)(i.Fragment,{children:[t,(0,oe.jsx)("br",{}),this.upgradeLink(s,n)]}):t||(s?(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.planAttribute.notInTrial",defaultMessage:"Not in trial"}),(0,oe.jsx)("br",{}),this.upgradeLink(s,n)]}):this.renderCheck())}renderPlan(e,t,s){return(0,oe.jsx)("td",{style:{...Fy.getRowStyle(this.theme),...Fy.getValueStyle(),...Fy.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)},children:s.hasFeature&&(0,oe.jsx)(te.Z,{delayThreshold:0,placement:te.Z.Placement.Right,renderTooltip:()=>(0,Cy.O_)(t),textWrap:!0,render:e=>(0,oe.jsx)("div",{style:{cursor:"help",lineHeight:1.3,padding:"6px 0"},...e,children:this.renderPlanContent(s)})})})}renderItem(e,t){const s="auto",i=this.props.planState&&this.props.planState.isTeamTrial;return(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("td",{style:{...Fy.getRowStyle(this.theme),...Fy.getRowLabelStyle(this.theme),width:s,maxWidth:s,minWidth:s},children:(0,oe.jsx)(te.Z,{delayThreshold:0,placement:te.Z.Placement.Right,renderTooltip:()=>(0,Cy.O_)(e.tooltip),textWrap:!0,render:t=>(0,oe.jsxs)("span",{...t,style:Fy.getTooltipInnerStyle(),children:[e.label,e.isComingSoon&&this.renderBadge("comingSoon"),e.isBeta&&this.renderBadge("beta")]})})}),Zy.map((t=>{const s="plus"===t&&i?"teamTrial":t;return this.renderPlan(t,e.tooltip,e.plans[s])}))]},`table-row-${t}`)}renderEmptyTableCell(e,t){return(0,oe.jsx)("td",{style:{...Fy.getSectionStyle(this.theme,t),...Fy.getValueStyle(),...Fy.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e),color:et.ZP.lightTextColor,fontWeight:400}})}renderEmptyTableCells(e){return(0,oe.jsx)(i.Fragment,{children:Zy.map((t=>this.renderEmptyTableCell(t,e)))})}renderSection(e,t){const s="auto";return(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("td",{style:{...Fy.getSectionStyle(this.theme,t),width:s,maxWidth:s,minWidth:s},children:e.label}),this.renderEmptyTableCells(t)]}),e.items.map(((e,t)=>this.renderItem(e,t)))]},`table-section-${t}`)}renderButton(e,t){const s=this.getProductCost(e),i=t.plans[e],n=`notion-pricing-grid-upgrade-${e}`;let a;switch(i.buttonType){case"current":a=(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.currentPlanButton.label",defaultMessage:"Current"});break;case"upgrade":a=(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.upgradePlanButton.label",defaultMessage:"Upgrade"});break;case"downgrade":a=(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.downgradePlanButton.label",defaultMessage:"Downgrade"});break;case"will-downgrade":a=(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.willDowngradePlanButton.label",defaultMessage:"Future plan"});break;case"resubscribe":a=(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.resubscribePlanButton.label",defaultMessage:"Resubscribe"});break;default:me.t1(i.buttonType)}if("current"===i.buttonType)return(0,oe.jsx)(Ry,{tooltip:(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.currentPlan.tooltip",defaultMessage:"This is your current active plan"}),label:(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.currentPlan.largeScreenLabel",defaultMessage:"Current plan"}),buttonClassName:n,wrapTooltip:!1});if(!t.canSwitchPlans){let e;return e=t.isInAppPurchase?(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.switchPlanFromInAppPurchase.tooltip",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."}):(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.switchPlanAsMember.tooltip",defaultMessage:"You need to be an administrator of this workspace to switch plans."}),(0,oe.jsx)(Ry,{tooltip:e,label:a,buttonClassName:n,wrapTooltip:!0})}return"will-downgrade"===i.buttonType?(0,oe.jsx)(Ry,{tooltip:(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.willDowngradePlan.tooltip",defaultMessage:"This is the plan after your current plan expires"}),label:(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.willDowngradePlan.largeScreenLabel",defaultMessage:"Future plan"}),buttonClassName:n,wrapTooltip:!1}):"downgrade"===i.buttonType?(0,oe.jsx)(St.Z,{isLarge:!0,style:{width:"100%"},onClick:()=>{f.rOZ(this.environment,{plan:e,currency_code:Wa.Z.selectedCurrencyCode,from:"pricing_grid_top",button_text:i.buttonType}),i.onClick()},className:n,children:a}):(0,oe.jsx)(Q.Z,{isLarge:!0,style:{width:"100%"},disabled:!s,onClick:()=>{f.rOZ(this.environment,{plan:e,currency_code:Wa.Z.selectedCurrencyCode,from:"pricing_grid_top",button_text:i.buttonType}),i.onClick()},className:n,children:a})}renderSalesContactLink(e){const t=`setup_${e}_trial`;return(0,oe.jsx)(co.Z,{onClick:()=>{const{currentUserStore:e}=ie.default.state,s=null!=e&&e.isDefined()?e.getModel():void 0;f.EUb(this.environment),Py.Z.setState({open:!0,email:s&&s.getEmail(),name:null==s?void 0:s.getDisplayName(this.props.intl),question:t})},children:(0,oe.jsx)("div",{style:Fy.getUpgradeButtonBelowLinkStyle(),children:(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.requestATrial",defaultMessage:"or Request a Trial"})})})}getPlanName(e){const{intl:t}=this.props;switch(e){case"free":return t.formatMessage(xd.a.free);case"plus":return t.formatMessage(xd.a.plus);case"business":return t.formatMessage(xd.a.business);case"enterprise":return t.formatMessage(xd.a.enterprise);default:me.t1(e)}}getProductCost(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"month";if("free"===e)return{amount:0,currencyCode:Wa.Z.selectedCurrencyCode};const i=Wa.Z.getPrice(this.environment,(t=>t.billingInterval===s&&t.product===e));return i.isLoaded?null===(t=i.result)||void 0===t?void 0:t.getMonthlyUnitCost().toMoneyValue():void 0}renderHeaderTitle(e){const t=this.getPlanName(e),s=function(e){switch(e){case"free":return;case"plus":case"business":case"enterprise":return"per_member_per_month";default:me.t1(e)}}(e),i=this.getProductCost(e,"month"),n=this.getProductCost(e,"year");return(0,oe.jsxs)("td",{style:{...Fy.getHeaderStyle(),...Fy.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)},children:[(0,oe.jsx)("div",{style:this.getHeaderTitleStyle(),children:t}),i&&n?this.renderMonthlyAndAnnualPrices(i,n,s):(0,oe.jsx)(_y.u,{})]})}renderMonthlyAndAnnualPrices(e,t,s){return(0,oe.jsxs)(ky.jX,{gap:4,children:[(0,oe.jsxs)(ky.jX,{direction:Iy(this.environment)?"column":"row",gap:6,children:[(0,oe.jsx)(Ty.q,{styleName:"Page-Content/H3",children:(0,oe.jsx)("div",{style:{lineHeight:"normal"},children:(0,oe.jsx)(my.W,{cost:t,trailingZeroDisplay:"stripIfInteger"})})}),s&&(0,oe.jsxs)(Ty.q,{styleName:"Micro-10px/Regular",colorName:"secondary",children:[(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"per user / month",id:"pricingPlanPrice.perUserPerMonth"}),(0,oe.jsx)("br",{}),(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"billed annually",id:"pricingPlanPrice.billedAnnually"})]})]}),s&&(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(Ty.q,{styleName:"Micro-10px/Regular",colorName:"secondary",children:[(0,oe.jsx)("div",{style:{fontWeight:"590",display:"inline"},children:(0,oe.jsx)(my.W,{cost:e,trailingZeroDisplay:"stripIfInteger"})})," ",(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"billed monthly",id:"pricingPlanPrice.billedMonthly"})]})})]})}renderHeaderTitles(){return(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("td",{}),Zy.map((e=>(0,oe.jsx)(i.Fragment,{children:this.renderHeaderTitle(e)},e)))]})}renderHeaderAction(e){const{planState:t}=this.props;if(t)return(0,oe.jsxs)("td",{style:{...Fy.getHeaderStyle(),...Fy.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)},children:[this.renderButton(e,t),this.renderHeaderSubAction(e)]})}renderHeaderSubAction(e){if((0,u.Rs)(e))return(0,oe.jsx)("div",{style:{marginTop:7},children:this.renderSalesContactLink(e)})}renderHeaderActions(){if(this.props.planState)return(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("td",{style:{width:"28%",verticalAlign:"top",paddingTop:16}}),Zy.map((e=>this.renderHeaderAction(e)))]})}renderHeader(){return(0,oe.jsxs)("thead",{children:[this.renderHeaderTitles(),this.renderHeaderActions()]})}renderBadge(e){return(0,oe.jsxs)("div",{style:{background:this.theme.buttonHoveredBackground,fontSize:10,fontWeight:500,letterSpacing:"0.015em",color:this.theme.mediumTextColor,display:"inline",textTransform:"uppercase",padding:"2px 4px",marginLeft:6,borderRadius:4,whiteSpace:"nowrap",position:"relative",top:-1},children:["comingSoon"===e&&(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.comingSoonBadge",defaultMessage:"Coming soon"}),"beta"===e&&(0,oe.jsx)(p.FormattedMessage,{id:"pricingGrid.betaBadge",defaultMessage:"Beta"})]})}didMount(){f.$lr(this.environment,{from:this.props.from})}isPlanActive(e){return Boolean(this.props.planState&&this.props.planState.plans[e].isActive)}static getTableStyle(){return{fontSize:14,width:"100%",tableLayout:"fixed",borderCollapse:"initial"}}static getSectionStyle(e,t){const s={borderBottom:`1px solid ${e.regularDividerColor}`,paddingBottom:7,paddingRight:15,fontWeight:500,verticalAlign:"bottom"};return 0===t?{...s,paddingTop:0}:{...s,paddingTop:20}}static getUpgradeButtonBelowLinkStyle(){return{fontSize:12}}static getRowStyle(e){return{borderBottom:`1px solid ${e.regularDividerColor}`}}static getRowLabelStyle(e){return{color:e.mediumTextColor,paddingRight:10,paddingTop:5,paddingBottom:6,verticalAlign:"top"}}static getValueStyle(){return{paddingLeft:10,paddingRight:10,textAlign:"left",overflow:"hidden",verticalAlign:"top"}}static getActiveStyle(e,t){const s=e.cardSidebarBackground;return{background:t?s:et.ZP.transparent}}getBorderStyle(e){return{borderLeft:`1px solid ${this.theme.lightDividerColor}`,borderRight:["enterprise"].includes(e)?`1px solid ${this.theme.lightDividerColor}`:void 0}}static getHeaderStyle(){return{paddingLeft:10,paddingRight:10,verticalAlign:"top",width:"18%",paddingTop:10}}getHeaderTitleStyle(){return{fontSize:16,fontWeight:Iy(this.environment)?500:700,lineHeight:1.3,marginBottom:2,paddingTop:40}}static getTooltipInnerStyle(){return{cursor:"help",width:"100%",display:"inline-block"}}}Fy.displayName="PricingGrid";const Ay=(0,p.injectIntl)(Fy);function Ry(e){const{tooltip:t,label:s,buttonClassName:i,wrapTooltip:n}=e;return(0,oe.jsx)(te.Z,{style:{width:n?320:"auto"},textWrap:n,renderTooltip:()=>t,render:e=>(0,oe.jsx)(St.Z,{style:{width:"100%",opacity:.5},isLarge:!0,disabled:!0,...e,className:i,children:s})})}var Dy=s(87598),By=s(40001),Ly=s(39343),Ny=s(91754),Oy=s(22398),Ey=s(10644);function Vy(e){window.__c={n:"StudentUpgrade"};const{handleEducationPlanClick:t}=e,s=(0,Je.yK)((e=>({subsection:{fontSize:14,marginTop:40},subsectionTitle:{fontSize:20,fontWeight:m.Z.fontWeight.bold,marginBottom:12},content:{color:e.mediumTextColor,marginBottom:15},paragraph:{marginBottom:4},link:{textDecoration:"underline"}})),[]);return(0,oe.jsxs)("div",{style:s.subsection,children:[(0,oe.jsx)("div",{style:s.subsectionTitle,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.title",defaultMessage:"Students & educators"})}),(0,oe.jsx)("div",{style:s.content,children:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(p.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.description",defaultMessage:"<p>Students and educators can get access to the Plus Plan features (with a 1-member limit) for free! Just sign up with your school email address, or change your existing email in the 'My account' tab.</p>",values:{p:e=>(0,oe.jsx)("div",{style:s.paragraph,children:e})}}),(0,oe.jsx)("div",{children:(0,oe.jsx)(co.Z,{onClick:t,style:s.link,children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Get the Education Plan",id:"sidebarStudentPlanPrompt.eligible.getFreePromptPlus"})})}),(0,oe.jsx)("div",{children:(0,oe.jsx)(co.Z,{external:!0,href:(0,Gs.UY)("guides.students"),children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSubscriptionPlans.studentSection.link",defaultMessage:"For more info, go to notion.com/students."})})})]})})]})}function Uy(e){window.__c={n:"TrialBanner"};const{subscriptionData:t}=e,s=(0,Je.yK)((e=>({text:{color:e.accentColors[500],display:"flex",columnGap:10}})),[]),i=yi.XX(t);if(!i||!i.trialEnd)return null;if(!(0,Ly.Fk)(i))return null;const n=(0,Ly.nx)(i),a=void 0!==i.willCancelAt,o=a?null:(0,oe.jsx)(zy,{}),r=n&&(a?(0,oe.jsx)(Ky,{trialEndDate:n}):(0,oe.jsx)(Wy,{trialEndDate:n}));return(0,oe.jsx)(Ny.Z,{styleKey:Ny.v.Beige,isMobile:!1,children:(0,oe.jsxs)("div",{style:s.text,children:[r,o]})})}function Wy(e){const{trialEndDate:t}=e;return(0,oe.jsx)(p.FormattedMessage,{id:"SpaceSubscriptionPlans.onTrial.bannerText",defaultMessage:"Your workspace is on a free trial until {trialEndDate}",values:{trialEndDate:t}})}function Ky(e){const{trialEndDate:t}=e;return(0,oe.jsx)(p.FormattedMessage,{id:"SpaceSubscriptionPlans.cancelledTrial.bannerText",defaultMessage:"Your workspace will be downgraded to Free on {trialEndDate}",values:{trialEndDate:t}})}function zy(){window.__c={n:"CancelTrialButton"};const e=(0,T.O7)(),t=(0,Je.yK)((e=>({cancelTrial:{cursor:"pointer",fontWeight:m.Z.fontWeight.semibold}})),[]);return(0,oe.jsx)("div",{style:t.cancelTrial,onClick:()=>{y.showDialog({message:D.default.formatMessage(Dy.z.cancellationConfirmationMessage),showCancel:!0,keepFocus:!1,items:[{label:D.default.formatMessage(Dy.z.yes),color:"red",onAccept:async()=>await(0,jy.Zo)(e)}]})},children:(0,oe.jsx)(p.FormattedMessage,{id:"app.banner.trial_subscription.cancel",defaultMessage:"Cancel trial"})})}class qy extends n.Z{constructor(){super(...arguments),this.storeTypes={store:Qp.Z,downgradeModalStore:By.ZP,securitySettingsStore:Js.Z},this.renderChurnSurveyModal=()=>{const e=this.stores.store.state,{data:t}=this.props,s=yi.XX(t),i=Ua.zt();if(e.churnSurveyModalOpen&&i&&s)return(0,oe.jsx)($p.Z,{churnType:e.churnType,currentPlan:i,isWorkspaceDeletion:!1,periodEnd:s.periodEnd,hasAI:(0,c.de)(s.addOns),hasPendingChanges:Boolean(s.schedule||s.willCancelAt),customerId:s.customerId,onAccept:this.handleChurnSurveyModalAccept,onClose:this.handleChurnSurveyModalClose})},this.handlePlansBackButtonClick=()=>{const{store:e}=this.stores;e.setState({...e.state,page:"default"})},this.handleFreeClick=async()=>{const{data:e}=this.props;let t="no_confirmation_required";e&&"subscribed_admin"===e.type&&(t=await new Promise((e=>{const{store:t}=this.stores;t.setState({...t.state,churnType:"free",churnSurveyModalOpen:!0,onAccept:t=>e(t?"churn_immediately":"churn_by_end_of_billing_period"),onClose:()=>e("no_churn")})})),"no_churn"===t)||await gi.EO({environment:this.environment,spaceStore:this.props.spaceStore,planType:"personal",from:"space_settings-plans_tab",cancelImmediately:"churn_immediately"===t})},this.handleEducationPlanClick=()=>{const{spaceStore:e}=this.props;gi.r7({environment:this.environment,spaceStore:e})},this.handlePlanChangeClick=async e=>{const{spaceStore:t,data:s}=this.props,i=yi.XX(s);if(!i||!yi.MM(s))return void gi.I0(this.environment,{subscriptionTier:e,from:"pricing_grid"});const n=Ua.zt();if(n&&u.rC[e]<u.rC[n]){if(!(await new Promise((t=>{const{store:s}=this.stores;s.setState({...s.state,churnType:e,churnSurveyModalOpen:!0,onAccept:()=>t(!0),onClose:()=>t(!1)})}))))return;try{const s=await async function(e){const{billingInterval:t,environment:s,product:i}=e;await Wa.Z.waitUntilReady();const n=Wa.Z.getPrice(s,(e=>e.product===i&&e.billingInterval===t));if(!n.result)throw new Error("Could not find price model");return n.result}({environment:this.environment,billingInterval:i.interval,product:e});await gi.Mg({environment:this.environment,spaceStore:t,plan:s.externalId,from:"space_settings-plans_tab"})}catch(a){My.IE(a),y.deprecatedShowErrorMessage("Sorry, something went wrong. Please try again.")}}else jy.af({environment:this.environment,from:"plans_page",view:"plans",temporarySubscriptionTier:e,billingInterval:i.interval,pageSection:"all_plans_grid"})},this.handleChurnSurveyModalAccept=e=>{const{store:t}=this.stores;t.state.churnSurveyModalOpen&&t.state.onAccept(e),t.reset()},this.handleChurnSurveyModalClose=()=>{const{store:e}=this.stores;if(e.state.churnSurveyModalOpen&&e.state.onClose(),"grid"===e.state.page)return e.reset(),void e.setState({...e.state,page:"grid"});e.reset()}}willMount(){gi.bi(this.environment),gi.px(this.environment)}renderComponent(){if(ji.Z.state.online){const{churnSurveyModalOpen:e,page:t}=this.stores.store.state,s="grid"===t;return(0,oe.jsxs)(oe.Fragment,{children:[this.renderBanner(yi.wY(this.props.data),this.props.intl),(0,oe.jsx)(Uy,{subscriptionData:this.props.data}),s?(0,oe.jsx)(Gy,{handlePlansBackButtonClick:this.handlePlansBackButtonClick}):null,(0,oe.jsxs)(gy.Z,{style:{height:"100%",padding:s?"0px 30px 100px 60px":"100px 0px 100px 60px"},type:dy.Z.Y,children:[(0,oe.jsx)(Oy.ZP,{data:this.props.data,spaceStore:this.props.spaceStore,spaceSubscriptionPlansStore:this.stores.store}),s?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(ro.Z,{size:0}),this.renderPricingGrid(),this.allowEducationUpgrade()?(0,oe.jsx)(Vy,{handleEducationPlanClick:this.handleEducationPlanClick}):null,(0,oe.jsx)(Yy,{}),(0,oe.jsx)(Mo.Z,{innerStyle:{width:300,height:"auto",overflow:"scroll"},open:e,render:this.renderChurnSurveyModal,onDismiss:this.handleChurnSurveyModalClose})]}):null]})]})}return(0,oe.jsx)(Ey.Z,{})}renderPricingGrid(){const e=this.getPlanState();return(0,oe.jsx)(Ay,{planState:e,data:this.props.data,from:"plans_page"})}renderBanner(e,t){const s=(0,Ua.zt)();if(!s)return null;if((0,Oy.lu)(e,s)){const i=(0,Oy.QH)(e,s);return(0,oe.jsx)(Ny.Z,{styleKey:Ny.v.Beige,isMobile:!1,children:(0,oe.jsx)("div",{style:{color:this.theme.accentColors[500]},children:i&&t.formatMessage(i)})})}return null}getPlanState(){const e=Ua.zt();if(!e)return;const t=yi.wY(this.props.data),s=function(e,t){const s=yi.DH(t);if((0,u.QM)(e))return{free:"current",plus:"upgrade",business:"upgrade",enterprise:"upgrade"};if((0,u.Aw)(e))return{free:s?"current":"downgrade",plus:"upgrade",business:"upgrade",enterprise:"upgrade"};if((0,u.eR)(e))return{free:"downgrade",plus:s?"resubscribe":"current",business:"upgrade",enterprise:"upgrade"};if("business"===e)return{free:"downgrade",plus:"downgrade",business:s?"resubscribe":"current",enterprise:"upgrade"};if("enterprise"===e)return{free:"downgrade",plus:"downgrade",business:"downgrade",enterprise:s?"resubscribe":"current"};(0,me.t1)(e)}(e,this.props.data);var i;return{plans:{free:{buttonType:s.free,isActive:Qy(s.free),onClick:this.handleFreeClick},plus:{buttonType:s.plus,isActive:Qy(s.plus),onClick:()=>this.handlePlanChangeClick("plus")},business:{buttonType:s.business,isActive:Qy(s.business),onClick:()=>this.handlePlanChangeClick("business")},enterprise:{buttonType:s.enterprise,isActive:Qy(s.enterprise),onClick:()=>this.handlePlanChangeClick("enterprise")}},isTeamTrial:!1,isInAppPurchase:t,canSwitchPlans:$y(this.props.data,this.props.spaceStore),memberCount:(i=this.props.data,yi.su(i))}}allowEducationUpgrade(){const{data:e}=this.props,t=this.getPlanState(),s=Ua.zt();return t&&t.canSwitchPlans&&!yi.wl(e)&&1===t.memberCount&&("free"===s||"personal"===s)}}function Gy(e){window.__c={n:"AllPlansButton"};const{handlePlansBackButtonClick:t}=e,s=(0,Je.yK)((()=>({backButton:{display:"inline-flex",padding:10},icon:{height:16,marginTop:4,width:16},settingHeader:{alignItems:"center",display:"flex",flexGrow:1,fontSize:16,fontWeight:m.Z.fontWeight.medium,justifyContent:"space-between",marginBottom:0,padding:"10px 0 10px 5px"},wrapper:{display:"flex",padding:"30px 30px 0px 60px"}})),[]),{availableCurrencyCodes:i,selectedCurrencyCode:n}=(0,a.VK)((()=>({availableCurrencyCodes:Wa.Z.availableCurrencyCodes,selectedCurrencyCode:Wa.Z.selectedCurrencyCode})),[]);return(0,oe.jsxs)("div",{style:s.wrapper,children:[(0,oe.jsx)(oo.Z,{style:s.backButton,onClick:t,children:(0,by.f)(s.icon)}),(0,oe.jsxs)(bt.Z,{large:!0,style:s.settingHeader,children:[(0,oe.jsx)(p.FormattedMessage,{id:"spaceSubscriptionPlans.allPlans.title",defaultMessage:"All plans"}),(0,oe.jsx)(wy.V,{availableCurrencyCodes:i,from:"pricing_grid",onSelectCurrency:Va.y,selectedCurrencyCode:n})]})]})}qy.displayName="SpaceSubscriptionPlans";const Hy=(0,p.injectIntl)(qy);function Qy(e){return["current","resubscribe"].includes(e)}function Yy(){const e={fontSize:20,fontWeight:m.Z.fontWeight.bold,marginBottom:12};return(0,oe.jsxs)("div",{style:{fontSize:14,marginTop:40},children:[(0,oe.jsx)("div",{style:e,children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.title",defaultMessage:"FAQ"})}),(0,oe.jsx)(co.Z,{external:!0,href:(0,Gs.UY)("guides.billingAndPaymentRevised"),children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.link",defaultMessage:"Plans, Billing & Payment"})})]})}function $y(e,t){const s=yi.wY(e);return t.canAdmin()&&!s}var Jy=s(42982);const Xy="teamColumn",ex="ownersColumn",tx="membersColumn",sx="AccessLevelColumn",ix="lastUpdatedColumn",nx="contextMenuColumn",ax=[Xy,tx,sx,ix],ox="filterAccessAny",rx="filterAccessOnlyOpen",lx="filterAccessOnlyClosed",dx="filterAccessOnlyPrivate",cx="filterOwnerAny",ux="filterOwnerShowOrphaned",mx="filterOwnerById";class px extends B.default{getInitialState(){return{searchQuery:"",sortColumn:ix,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:cx},filterAccess:ox,showTeamsWithSecurityOverrides:!1}}}const gx=new px;function hx(e){let{environment:t,teamIds:s}=e;const{currentSpaceStore:i,currentUserStore:n}=ie.default.state;return i&&n?s.map((e=>{const s=He.zX.createChildStore(i,{table:Kt.e0,id:e,spaceId:i.id});if(s.canRead())return s;const n=i&&lc.Dv({environment:t,teamId:s.id,spaceStore:i,from:"manage_teams_table"});return null!=n&&n.canRead()?n:void 0})).filter(me.$K):[]}var fx=s(80068);class yx extends B.default{getInitialState(){return{tokenQuery:"",showAutoCompletePopup:!1,defaultTeams:{}}}addedAndCurrentTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"current-default"===t||"add-default"===t}))}addedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"add-default"===t}))}removedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"remove-default"===t}))}}const xx=new yx;function vx(e){var t;let{team:s}=e;return null===(t=xx.state.defaultTeams[s.id])||void 0===t?void 0:t.state}function Sx(e){let{team:t,persistedDefaultTeams:s}=e;if(s.includes(t))bx({store:t,state:"current-default"});else{const e={...xx.state.defaultTeams};delete e[t.id],xx.setState({...xx.state,defaultTeams:e})}}function bx(e){const t=xx.state;xx.setState({...t,defaultTeams:{...t.defaultTeams,[e.store.id]:e}})}var Mx=s(30676),jx=s(47082),wx=s(75024);function Cx(e){let{}=e;window.__c={n:"DefaultTeamsInput"};const t=(0,T.Fy)(),s=(0,p.useIntl)(),n=(0,T.O7)(),{allTeams:o,loaded:r}=(0,a.VK)((()=>{const e=bi.state;return"loaded"!==e.loadingState?{allTeams:[],loaded:!1}:{allTeams:hx({environment:n,teamIds:e.unarchivedTeamIds}),loaded:!0}}),[n]),[d,c]=(0,i.useState)(!1),u=(0,a.qz)(xx),m=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),{defaultTeams:g,tokenQuery:h}=(0,a.VK)((()=>{const{defaultTeams:e,tokenQuery:t}=u.state;return{defaultTeams:e,tokenQuery:t}}),[u]),f=!h,{addedTeams:y,removedTeams:x,addedAndCurrentTeams:v}=(0,a.VK)((()=>({addedAndCurrentTeams:u.addedAndCurrentTeams(),addedTeams:u.addedTeams(),removedTeams:u.removedTeams()})),[u]),S=(0,a.VK)((()=>o.reduce(((e,t)=>(e[t.id]=t.getName(),e)),{})),[o]),b=(0,a.VK)((()=>o.filter((e=>e.isDefault()))),[o]);(0,i.useEffect)((()=>function(e){let{persistedDefaultTeams:t}=e;const s=t.reduce(((e,t)=>(e[t.id]={state:"current-default",store:t},e)),{}),i=xx.state;xx.setState({...i,defaultTeams:s})}({persistedDefaultTeams:b})),[b]);const M=y.length>0||x.length>0,j=e=>function(e){let{team:t,persistedDefaultTeams:s}=e;"add-default"===vx({team:t})?Sx({team:t,persistedDefaultTeams:s}):bx({store:t,state:"remove-default"})}({team:e,persistedDefaultTeams:b}),w=e=>{!function(e){let{team:t,persistedDefaultTeams:s}=e;"remove-default"===vx({team:t})?Sx({team:t,persistedDefaultTeams:s}):bx({store:t,state:"add-default"})}({team:e,persistedDefaultTeams:b}),u.update((e=>({...e,showAutoCompletePopup:!1,tokenQuery:""})))},C=new Set(x.map((e=>e.store.id))),k=n.currentUser.id,I=(0,a.VK)((()=>k?o.filter((e=>{const t=e.getMembers(),s=e.getSettingsStore().getValue();return!!s&&((0,bn.pd)({membership:t},k)&&"open"===(0,bn.B5)(s))})):[]),[o,k]),P=function(e){let{query:t,addedAndCurrentTeams:s,eligibleDefaultTeams:i,teamIdsToNames:n}=e;const a=new Set;for(const o of s)a.add(o.store.id);return(0,st.ZP)(t,i,(e=>n[e.id]??""))}({query:h,addedAndCurrentTeams:v,teamIdsToNames:S,eligibleDefaultTeams:I}),_=[];P.length>0&&!f&&_.push({key:"default-teams-list",render:e=>(0,oe.jsx)(ee.Z,{...e,title:(0,oe.jsx)(p.FormattedMessage,{id:"defaultTeamsInput.defaultTeamList.title",defaultMessage:"Teamspaces"}),loading:!1}),items:P.map((e=>({key:e.id,render:t=>(0,oe.jsx)(Mx.F,{...t,teamStore:e}),action:()=>w(e)})))});const Z=(0,a.VK)((()=>u.state.showAutoCompletePopup&&_.length>0),[u,_.length]),F=(0,Je.yK)((e=>({defaultTeamsHeader:{fontSize:14,marginBottom:2},inputAndButtonContainer:{paddingTop:12,display:"flex"},inputContainer:{flexGrow:1},tokenInputMenu:{borderRadius:Z?Ix:Tx,margin:0},menuList:{maxHeight:300,border:`1px solid ${e.regularDividerColor}`,borderTop:0,borderRadius:Px},updateButton:{marginLeft:10,height:35}})),[Z]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{style:F.defaultTeamsHeader,children:(0,oe.jsx)(p.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.title",defaultMessage:"Default teamspaces"})}),(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,children:(0,oe.jsx)(p.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})}),(0,oe.jsxs)("div",{style:F.inputAndButtonContainer,children:[(0,oe.jsx)("div",{style:F.inputContainer,children:(0,oe.jsx)(X.ZP,{popupType:X.ZP.PopupType.Popup,placementToOrigin:X.ZP.Placement.Bottom,sameWidthAsOrigin:!0,open:Z,borderRadius:Px,onDismiss:()=>u.update((e=>({...e,showAutoCompletePopup:!1}))),origin:(0,oe.jsx)(jx.Z,{disabled:!r||d,style:F.tokenInputMenu,focusInitial:t.isMobile,focusAfterAnimation:!0,format:jx.Z.Format.Share,inputDivStyle:{alignItems:"center"},value:h,onChange:e=>u.update((t=>({...t,tokenQuery:e.target.value,showAutoCompletePopup:!0}))),type:"default-teams",tokens:Object.values(g).filter((e=>!C.has(e.store.id))).map((e=>(0,oe.jsx)(kx,{teamStore:e.store,onClickRemove:j},e.store.id))),placeholder:s.formatMessage({id:"teamsWorkspaceSettings.defaultTeams.inputPlaceholder",defaultMessage:"Select a default teamspace..."}),onRemoveLastToken:()=>{const e=v,t=l.Z$(e);t&&j(t.store)},onEmptySubmit:l.yR,showBorder:!0}),render:()=>(0,oe.jsx)($.Z,{menuType:se.og.Popup,tokenInputHeader:!0,disableHeaderBorder:!0,children:(0,oe.jsx)("div",{style:F.menuList,children:(0,oe.jsx)(J.Z,{type:J.i.Vertical,initialFocus:0,sections:_})})})})}),(0,oe.jsx)(Q.Z,{style:F.updateButton,disabled:!M||d,isLarge:!0,onClick:async()=>{if(m){c(!0);try{await async function(e){let{addedTeams:t,removedTeams:s,environment:i,spaceStore:n}=e;if(!n.isDefined())return!1;const a=n.getPermissionItems();return await lc.lH({addedStores:t.map((e=>{let{store:t}=e;return t})),removedStores:s.map((e=>{let{store:t}=e;return t})),environment:i,spaceValue:{permissions:a},createNewTeamFlowId:void 0,from:"workspace_settings"})}({environment:n,addedTeams:y,removedTeams:x,spaceStore:m})}finally{c(!1)}}},children:(0,oe.jsx)(p.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})})]})]})}function kx(e){window.__c={n:"DefaultTeamsToken"};const t=(0,T.Fy)(),{teamStore:s,onClickRemove:i}=e,{name:n}=(0,a.VK)((()=>({name:s.getName()})),[s]);return(0,oe.jsx)(qn.Z,{showRemoveButton:!0,isSingle:!1,format:t.isMobile?Vn.lo.Large:Vn.lo.Medium,style:{marginLeft:6},onClickRemove:()=>i(s),value:(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,oe.jsx)(yn.p,{disabled:!0,store:s,size:14,style:{marginRight:4}}),n]})})}const Tx=3,Ix=(0,wx.wK)({topLeft:Tx,topRight:Tx,bottomLeft:0,bottomRight:0}),Px=(0,wx.wK)({topLeft:0,topRight:0,bottomLeft:Tx,bottomRight:Tx});var _x=s(43121),Zx=s(17224);function Fx(e){let{selectItems:t,currentSelectedItem:s,onChange:i,icon:n}=e;return(0,oe.jsx)(Xn.Z,{items:t,getKey:e=>e.key,selectedItem:s,onSelect:i,renderItem:e=>(0,oe.jsx)(Y.Z,{title:e.value.name,...e,checkState:s.key===e.value.key}),renderOrigin:e=>(0,oe.jsx)(ye.Z,{...e,title:s.originName??s.name,on:!s.showFilterAsOffWhenSelected,icon:n})})}const Ax={[ox]:{key:ox,name:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any"}),originName:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access"}),showFilterAsOffWhenSelected:!0},[rx]:{key:rx,name:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open"})},[lx]:{key:lx,name:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed"})},[dx]:{key:dx,name:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private"})}},Rx=l.oA([Ax.filterAccessAny,Ax.filterAccessOnlyOpen,Ax.filterAccessOnlyClosed,Ax.filterAccessOnlyPrivate]);function Dx(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsAccessFilter"};const s=(0,T.O7)(),n=(0,a.VK)((()=>t.state.filterAccess),[t]),o=(0,Je.yK)((e=>({keyIcon:{width:18,height:18,...n!==ox?{fill:et.ZP.blue}:{fill:e.mediumIconColor}}})),[n]),r=(0,i.useCallback)((e=>{t.update((t=>({...t,filterAccess:e.key}))),Zx.GZ(s,{filter:"access",value:e.key})}),[t,s]),l=Ax[n];return(0,oe.jsx)(Fx,{selectItems:Rx,currentSelectedItem:l,onChange:r,icon:(0,_x.f)(o.keyIcon)})}var Bx=s(66474);const Lx="showArchived",Nx="hideArchived",Ox={[Nx]:{key:Nx,name:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active"}),originName:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Archived"}),showFilterAsOffWhenSelected:!0},[Lx]:{key:Lx,name:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived"})}};function Ex(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsArchivedFilter"};const s=(0,T.O7)(),n=(0,a.VK)((()=>t.state.showOnlyArchivedTeams),[t]),o=(0,Je.yK)((e=>({archiveIcon:{width:16,height:16,marginRight:5,...n?{fill:et.ZP.blue}:{fill:e.mediumIconColor}}})),[n]),r=[Ox.hideArchived,Ox.showArchived],l=(0,i.useCallback)((e=>{t.update((t=>({...t,showOnlyArchivedTeams:e.key===Lx}))),Zx.GZ(s,{filter:"archived",value:e.key})}),[t,s]),d=Ox[n?Lx:Nx];return(0,oe.jsx)(Fx,{selectItems:r,currentSelectedItem:d,onChange:l,icon:(0,Bx.c)(o.archiveIcon)})}const Vx="ShowTeamsWithNoOwnersId";function Ux(e){let{teamStores:t,manageTeamsStore:s}=e;window.__c={n:"ManageTeamsOwnerFilter"};const n=(0,T.O7)(),o=(0,a.VK)((()=>s.state.filterByOwner),[s]),r=function(e){switch(e.type){case cx:return;case mx:return e.id;case ux:return Vx;default:(0,me.t1)(e)}}(o),d=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),c=(0,p.useIntl)(),u=(0,a.VK)((()=>{const e=t.flatMap((e=>(0,bn.XO)({membership:e.getMembers()})));return l.jj(e)}),[t]),m=(0,Je.yK)((e=>({icon:{marginRight:2,fill:e.mediumIconColor},blueFill:{fill:et.ZP.blue}})),[]),g=(0,i.useCallback)((e=>{if(d)return Zl({userId:e,currentSpaceStore:d}).getValue()}),[d]),h=(0,i.useCallback)((e=>{const t=e[e.length-1];let i;i=t===r||void 0===t?{type:cx}:t===Vx?{type:ux}:{type:mx,id:t},s.update((e=>({...e,filterByOwner:i}))),Zx.GZ(n,{filter:"owner",value:i.type})}),[r,s,n]),f=(0,i.useCallback)((async e=>{let{query:t}=e;if(!d)return[];const s=(await A.pz({query:t,currentSpaceStore:d,userIds:u})).map((e=>e.id));return""===t?[Vx,...s]:s}),[d,u]),y=(0,i.useCallback)(((e,t)=>{if(!d)return null;if(e===Vx)return(0,oe.jsx)(Y.Z,{...t,title:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",defaultMessage:"No owners"}),checkState:o.type===ux,className:"notranslate"});const s=g(e);return s?(0,i.createElement)(Ge.Z,{...t,key:e,actor:(0,Ke.m3)(s),checkState:r===e}):null}),[d,g,r,o.type]),x=(0,a.VK)((()=>{if(o.type!==mx)return;const e=g(o.id);return e?(0,jn.Nz)(c,e):void 0}),[o,g,c]);let v;return v=o.type===ux?(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",defaultMessage:"Owner: None"}):x?(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:x}}):(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.unset",defaultMessage:"Owner"}),(0,oe.jsx)(Ne.Z,{mode:Ne.z.Pill,title:v,disabled:0===t.length,icon:ze.f,iconStyles:{...m.icon,...o.type!==cx&&m.blueFill},items:l.oA([r]),hasItemsSelected:(0,me.$K)(r),onChange:h,labelText:{title:v,tokenInputPlaceholder:c.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder"}),resultSectionTitle:c.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:f,renderResultMenuItem:y,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}const Wx="showAll",Kx="showTeamsWithSecurityOverrides",zx={[Wx]:{key:Wx,name:(0,oe.jsx)(p.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllOption",defaultMessage:"Show all"}),originName:(0,oe.jsx)(p.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllPlaceholder",defaultMessage:"Security"}),showFilterAsOffWhenSelected:!0},[Kx]:{key:Kx,name:(0,oe.jsx)(p.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showTeamsWithSecurityOverrides",defaultMessage:"Has overrides"})}};function qx(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsSecurityOverridesFilter"};const s=(0,T.O7)(),n=(0,a.VK)((()=>t.state.showTeamsWithSecurityOverrides),[t]),o=(0,Je.yK)((e=>({securityIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor},blueFill:{fill:et.ZP.blue}})),[]),r=[zx.showAll,zx[Kx]],l=(0,i.useCallback)((e=>{t.setState({...t.state,showTeamsWithSecurityOverrides:e.key===Kx}),Zx.GZ(s,{filter:"securityOverrides",value:e.key})}),[t,s]),d=zx[n?Kx:Wx];return(0,oe.jsx)(Fx,{selectItems:r,currentSelectedItem:d,onChange:l,icon:(0,_a.X)({...o.securityIcon,...n&&o.blueFill})})}function Gx(e){let{manageTeamsStore:t,teamStores:s}=e;window.__c={n:"ManageTeamsFilterRow"};const n=(0,Je.yK)((()=>({container:{display:"flex",alignItems:"center",marginTop:20},searchContainer:{maxWidth:250,marginRight:"auto"},archivedTeamsSwitch:{display:"flex",alignItems:"center",marginLeft:15,marginRight:15},archivedTeamsLabel:{marginLeft:10},dropdownContainer:{display:"flex",alignContent:"stretch",marginLeft:5}})),[]),o=(0,a.VK)((()=>t.state.searchQuery),[t]),r=(0,i.useCallback)((e=>{t.update((t=>({...t,searchQuery:e})))}),[t]);return(0,oe.jsxs)("div",{style:n.container,children:[(0,oe.jsx)(Hx,{style:n.searchContainer,onChange:r,value:o}),(0,oe.jsxs)("div",{style:n.dropdownContainer,children:[(0,oe.jsx)(Ex,{manageTeamsStore:t}),(0,oe.jsx)(Ux,{teamStores:s,manageTeamsStore:t}),(0,oe.jsx)(Dx,{manageTeamsStore:t}),(0,oe.jsx)(qx,{manageTeamsStore:t})]})]})}function Hx(e){let{style:t,value:s,onChange:n}=e;window.__c={n:"Search"};const a=(0,p.useIntl)(),o=(0,Je.yK)((e=>({input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),r=(0,i.useCallback)((e=>n(e.target.value)),[n]);return(0,oe.jsx)(_e.Z,{placeholder:a.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder"}),style:{...o.input,...t},value:s,onChange:r,left:(0,dg.R)(o.searchIcon),format:_e.Z.Format.Small,showClearButton:!0})}var Qx=s(12534),Yx=s(55838),$x=s(64552),Jx=s(73343),Xx=s(98742),ev=s(11628);var tv=s(26160),sv=s(30765);function iv(e){let{teamStore:t,accessLevel:s,isTeamOwner:i,onChangeAccessLevel:n,width:o}=e;window.__c={n:"ManageTeamsAccessCell"};const r=(0,T.O7)(),l=function(e){return(0,a.VK)((()=>e.isDefault()),[e])}(t),d=(0,tv.U)({teamStore:t,onChange:n,isDefault:l}),c=l?"default":s,u=d.find((e=>e.key===c)),g=!i||Boolean(null==u?void 0:u.disableAllOptionsTooltip),h=(null==u?void 0:u.disableAllOptionsTooltip)||g&&!i&&(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsAccessCell.onlyTeamOwnersCanChangeAccessLevel",defaultMessage:"Only teamspace owners can change teamspace access levels"}),f=(0,ev.P)(),y=(0,Je.yK)((e=>{const t=e.lightTextColor;return{selectButton:{paddingLeft:8,marginLeft:-8,maxWidth:o},label:{...g&&{color:t},fontSize:m.Z.fontSize.UIRegular.desktop,fontWeight:m.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.mediumIconColor,...g&&{fill:t}},tooltip:{width:200}}}),[g,o]);if(!u)throw new Error(`Selected access level is not an option found in team access level option: ${c}`);return(0,oe.jsx)(Xn.Z,{items:d,getKey:e=>e.key,selectedItem:u,onSelect:e=>"private"!==e.key||f?e.onSelect():Da.y(r,{from:"team_security_settings",for:"business"}),renderItem:e=>(0,oe.jsx)(te.Z,{textWrap:!0,style:y.tooltip,placement:Bt.u.Bottom,disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>(0,oe.jsx)(Y.Z,{title:e.value.title,...(0,Xx.Z)(e,t)})}),disabled:g,renderOrigin:e=>(0,oe.jsx)(te.Z,{textWrap:!0,style:y.tooltip,disableTooltip:!h,renderTooltip:()=>h,alignment:Bt.v.Center,placement:Bt.u.Left,render:t=>(0,oe.jsxs)(ve.Z,{style:y.selectButton,disabled:g,...(0,Xx.Z)(e,t),children:[(0,oe.jsx)(sv.s,{style:y.label,children:u.level}),(0,Jn.i)(y.chevron)]})})})}function nv(e){let{teamOwners:t,manageTeamsStore:s}=e;window.__c={n:"ManageTeamsOwnersCell"};const i=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),n=(0,p.useIntl)(),o=(0,a.VK)((()=>{if(!i)return;const{filterByOwner:e}=s.state;let n=t[0];if(e.type===mx){const s=e.id;t.includes(s)&&(n=s)}return n?Zl({userId:n,currentSpaceStore:i}):void 0}),[i,s,t]),r=(0,a.VK)((()=>{if(null!=o&&o.isDefined())return(0,jn.Nz)(n,o.getModel())}),[o,n]),l=(0,Je.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:m.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},nMoreOwnersText:{paddingLeft:3,color:e.mediumTextColor},noOwners:{marginRight:8,color:e.lightTextColor},userName:{flexShrink:1}})),[]);return t.length<1?(0,oe.jsx)("div",{style:l.noOwners,children:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsOwnersCell.noOwners",defaultMessage:"No owners"})}):(0,oe.jsxs)("div",{style:l.container,children:[(0,oe.jsx)(wn.Z,{style:l.userAvatar,avatarShouldShowShadow:!0,userStore:o,size:20}),(0,oe.jsx)(sv.s,{style:l.userName,children:r}),t.length>1&&(0,oe.jsx)("div",{style:l.nMoreOwnersText,children:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:t.length-1}})})]})}const av=[Xy,ex,sx,ix,nx],ov={[sx]:{headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTable.columnTitle.access",defaultMessage:"Access"}),renderCell:e=>{let{data:t,environment:s}=e;return(0,oe.jsx)(iv,{teamStore:t.store,accessLevel:t.accessLevel,isTeamOwner:t.isCurrentUserOwnerOfTeam,onChangeAccessLevel:(e,i)=>lc.Ju({environment:s,store:t.store,accessLevel:e,isDefault:i,teamName:t.name,from:"manage_teams_table"}),width:90})},colWidth:{width:90},hasClickableContents:!0},[Xy]:{headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamspacesTable.columnTitle.teamspace",defaultMessage:"Teamspace"}),renderCell:e=>{let{data:t}=e;return(0,oe.jsx)(rv,{teamStore:t.store,isArchivedTeam:t.isArchivedTeam,name:t.name})},colWidth:{minWidth:30,widthPercent:35}},[ex]:{headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTable.columnTitle.owners",defaultMessage:"Owners"}),renderCell:e=>{let{data:t,manageTeamsStore:s}=e;return(0,oe.jsx)(nv,{teamOwners:t.owners,manageTeamsStore:s})},colWidth:{minWidth:60,widthPercent:25}},[tx]:{headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTable.columnTitle.members",defaultMessage:"Members"}),renderCell:e=>{let{data:t}=e;return(0,oe.jsx)(sv.s,{children:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTable.numMembersCell",defaultMessage:"{numTeamMembers, plural, one {# member} other {# members}}",values:{numTeamMembers:t.members.length}})})},colWidth:{minWidth:40,widthPercent:15}},[ix]:{headerTitle:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTable.columnTitle.updated",defaultMessage:"Updated"}),renderCell:e=>{let{data:t}=e;return t.lastUpdated&&(0,oe.jsx)(lv,{lastUpdatedMillis:t.lastUpdated})},colWidth:{minWidth:50,widthPercent:15}},[nx]:{headerTitle:void 0,renderCell:e=>{let{data:t}=e;return(0,oe.jsx)(Jx.OutlinerTeamOverflow,{teamStore:t.store,from:"manage_teams_table"})},colWidth:{width:30},hasClickableContents:!0}};function rv(e){let{teamStore:t,name:s,isArchivedTeam:i}=e;window.__c={n:"TeamCell"};const n=(0,T.O7)(),o=(0,p.useIntl)(),r=(0,$x.e)(t),d=(0,Je.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginRight:12},nameAndMembersContainer:{display:"flex",flexDirection:"column",minWidth:0},nameAndArchivedPillContainer:{display:"flex"},nameText:{lineHeight:"18px",fontWeight:m.Z.fontWeight.regular},smallText:{fontSize:(0,wx.yv)(n,"UISmall"),color:e.mediumTextColor,fontWeight:m.Z.fontWeight.regular},archivedTag:{marginLeft:5}})),[n]),c=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>{if(!c)return;const e=(0,rt.tO)({teamStore:t,spaceStore:c}).length;return(0,lu.uf)(e,"compact",o)}),[c,o,t]),g=(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTableColumnData.numMembersLabel",defaultMessage:"{numMembers, plural, one {1 member} other {{numMembers} members}}",values:{numMembers:u}}),h=r?(0,oe.jsxs)(oe.Fragment,{children:[" • ",(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTableColumnData.joinedLabel",defaultMessage:"Joined"})]}):void 0,f=l.oA([g,h]);return(0,oe.jsxs)("div",{style:d.container,children:[(0,oe.jsx)(yn.p,{style:d.teamIcon,size:28,store:t,disabled:!0}),(0,oe.jsxs)("div",{style:d.nameAndMembersContainer,children:[(0,oe.jsxs)("div",{style:d.nameAndArchivedPillContainer,children:[(0,oe.jsx)(sv.s,{style:d.nameText,children:s}),i&&(0,oe.jsx)(qe.Z,{desktopStyle:d.archivedTag,mobileStyle:d.archivedTag,children:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTable.archivedTag",defaultMessage:"Archived"})})]}),(0,oe.jsx)(sv.s,{style:d.smallText,children:f})]})]})}function lv(e){let{lastUpdatedMillis:t}=e;return(0,oe.jsx)(sv.s,{children:(0,Dt.Yx)(t,"very_short",Rt.SP)})}function dv(e){let{teamStores:t,manageTeamsStore:s}=e;window.__c={n:"ManageTeamsTable"};const n=(0,T.O7)(),o=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),r=(0,a.VK)((()=>ie.default.state.currentUserStore),[]),{sortAscending:d,sortColumn:c}=(0,a.VK)((()=>{const{sortAscending:e,sortColumn:t}=s.state;return{sortAscending:e,sortColumn:t}}),[s]),u=(0,a.VK)((()=>{const e=null==r?void 0:r.id;return e?l.oA(t.map((t=>{if(!t.canRead()||!t.isReady())return;const s=t.getMembers(),i=(0,bn.XO)({membership:s});return{store:t,name:t.getName()??"",owners:i,isCurrentUserOwnerOfTeam:i.includes(e),members:(0,rt.tO)({teamStore:t,spaceStore:o}),hasSecurityOverrides:t.hasSecurityOverrides(),accessLevel:t.getTeamAccessLevel(),isArchivedTeam:(0,bn.m4)({archived_by:t.getArchivedBy()}),lastUpdated:t.getLastEditedTime()}}))):[]}),[o,null==r?void 0:r.id,t]),m=(0,a.VK)((()=>{const{showOnlyArchivedTeams:e,filterByOwner:t,showTeamsWithSecurityOverrides:i,filterAccess:n}=s.state;return u.filter((t=>e?t.isArchivedTeam:!t.isArchivedTeam)).filter((e=>!i||e.hasSecurityOverrides)).filter((e=>{if(n===rx&&"open"!==e.accessLevel)return!1;if(n===lx&&"closed"!==e.accessLevel)return!1;if(n===dx&&"private"!==e.accessLevel)return!1;switch(t.type){case ux:return 0===e.owners.length;case mx:return e.owners.includes(t.id);case cx:return!0;default:(0,me.t1)(t)}}))}),[s,u]),p=(0,a.VK)((()=>{const{sortAscending:e,sortColumn:t}=s.state;return function(e){let{data:t,sortColumn:s,sortAscending:i}=e;const n=[i?"asc":"desc"],a=[i?"desc":"asc"];switch(s){case Xy:return l.Xo(t,(e=>e.name),a);case tx:return l.Xo(t,(e=>e.members.length),n);case sx:return l.Xo(t,(e=>Kt.bx.indexOf(e.accessLevel)),n);case ix:return l.Xo(t,(e=>e.lastUpdated),n);default:(0,me.t1)(s)}}({data:m,sortAscending:e,sortColumn:t})}),[s,m]),g=(0,a.VK)((()=>(0,st.ZP)(s.state.searchQuery,p,(e=>e.name))),[s,p]),h=(0,i.useCallback)((e=>lc.RF({environment:n,teamId:e,tab:Yx.a.Members,from:"manage_teams_table"})),[n]),f=(0,Je.yK)((e=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:av.reduce(((e,t)=>e+yv(ov[t].colWidth)+hv),0)},tableHeaderRow:{borderTop:`1px solid ${e.tableDividerColor}`,borderBottom:`1px solid ${e.tableDividerColor}`},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),y=(0,i.useCallback)((e=>{const{sortColumn:t,sortAscending:i}=s.state,a=e===t&&!i;s.setState({...s.state,sortAscending:a,sortColumn:e}),Zx.dw(n,{sortBy:e,sortOrder:i?"ascending":"descending"})}),[s,n]),x=(0,i.useCallback)((()=>{s.reset()}),[s]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("table",{style:f.container,children:[(0,oe.jsx)("tr",{style:f.tableHeaderRow,children:av.map((e=>(0,oe.jsx)(uv,{column:e,onSortableColumnClick:y,sortAscending:d,sortColumn:c},`header_${e}`)))}),(0,oe.jsx)("tr",{children:av.map((e=>(0,oe.jsx)("td",{},`padding_row_${e}`)))}),g.map((e=>(0,oe.jsx)(cv,{onShowTeamSettings:h,teamData:e,manageTeamsStore:s},`${e.store.id}_row`)))]}),(0,oe.jsx)(pv,{style:f.noTeamsLabel,numItemsAfterFilter:g.length,numItemsBeforeFilter:t.length,onResetFilters:x})]})}function cv(e){let{teamData:t,manageTeamsStore:s,onShowTeamSettings:n}=e;window.__c={n:"TeamRow"};const[a,o]=(0,i.useState)(!1),r=(0,i.useCallback)((()=>o(!0)),[]),l=(0,i.useCallback)((()=>o(!1)),[]),d=(0,i.useCallback)((e=>{gv(e,(()=>n(t.store.id)))}),[n,t.store.id]),c=(0,Je.yK)((e=>({teamRow:{cursor:"pointer",borderBottom:`1px solid ${e.tableDividerColor}`}})),[]);return(0,oe.jsx)("tr",{onMouseLeave:l,onMouseEnter:r,style:c.teamRow,onClick:d,children:av.map((e=>(0,oe.jsx)(mv,{isRowHovered:a,teamData:t,columnData:ov[e],manageTeamsStore:s},`${t.store.id}_${e}`)))})}function uv(e){let{column:t,onSortableColumnClick:s,sortColumn:i,sortAscending:n}=e;window.__c={n:"HeaderCell"};const a=ov[t],o=(0,Je.yK)((e=>({th:xv(a),innerDiv:{display:"flex",alignItems:"center",minWidth:yv(a.colWidth),height:32},text:{fontSize:m.Z.fontSize.UISmall.desktop,fontWeight:m.Z.fontWeight.regular,color:e.mediumTextColor},sortButton:{padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"},sortIcon:{fill:e.mediumTextColor,width:12,height:12,marginLeft:4}})),[a]),r=(0,oe.jsx)(sv.s,{style:o.text,children:a.headerTitle}),l=(d=t,ax.includes(d)?(0,oe.jsxs)(ve.Z,{style:o.sortButton,onClick:()=>s(t),children:[r,(()=>{if(t===i)return(0,Af.K)({...o.sortIcon,...n&&{transform:"rotate(180deg)"}})})()]}):r);var d;return(0,oe.jsx)("th",{style:o.th,children:(0,oe.jsx)("div",{style:o.innerDiv,children:l})})}function mv(e){let{teamData:t,columnData:s,isRowHovered:i,manageTeamsStore:n}=e;window.__c={n:"Cell"};const a=(0,T.O7)(),o=(0,Je.yK)((e=>({td:{...xv(s),...i&&{background:e.buttonHoveredBackground}},innerDiv:{minWidth:yv(s.colWidth),fontSize:m.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,height:56,display:"flex",alignItems:"center"}})),[s,i]),r=gv,l=Boolean(s.hasClickableContents);return(0,oe.jsx)("td",{style:o.td,children:(0,oe.jsx)("div",{style:o.innerDiv,onClick:l?r:void 0,children:s.renderCell({environment:a,data:t,manageTeamsStore:n})})})}function pv(e){let{style:t,numItemsBeforeFilter:s,numItemsAfterFilter:i,onResetFilters:n}=e;if(0!==i)return null;let a;return a=0!==s?(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",values:{linkbutton:e=>(0,oe.jsx)(co.Z,{onClick:n,children:e})}}):(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces."}),(0,oe.jsx)(at.Z,{isSmall:!0,style:t,children:a})}function gv(e,t){(0,Qx.ZP)({event:e,context:Qx.Af.ManageTeamsRowClick,callback:t})}const hv=10,fv={paddingLeft:hv/2,paddingRight:hv/2};function yv(e){return"minWidth"in e?e.minWidth:e.width}function xv(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:`${e.colWidth.widthPercent}%`,minWidth:e.colWidth.minWidth},{...fv,...t}}function vv(e){let{}=e;window.__c={n:"ManageTeamsBrowser"};const{isMobile:t=!1}=(0,T.Fy)(),s=(0,T.O7)(),n=(0,a.qz)(gx),o=(0,Je.yK)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},subheader:{display:"flex",flexDirection:"column"}})),[]),{unarchivedTeamIds:r,archivedTeamIds:l,isLoading:d}=(0,a.VK)((()=>{const e=bi.state;return"loaded"!==e.loadingState?{unarchivedTeamIds:[],archivedTeamIds:[],isLoading:!0}:{unarchivedTeamIds:e.unarchivedTeamIds,archivedTeamIds:e.archivedTeamIds,isLoading:!1}}),[]),c=(0,a.VK)((()=>d?[]:hx({environment:s,teamIds:[...r,...l]})),[l,s,d,r]),u=(0,i.useCallback)((()=>lc.lo("workspace_settings")),[]);return(0,oe.jsxs)("div",{style:o.container,children:[(0,oe.jsxs)(bt.Z,{large:!t,style:o.header,small:!0,children:[(0,oe.jsxs)("div",{style:o.subheader,children:[(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsBrowser.title",defaultMessage:"Manage teamspaces"}),(0,oe.jsx)(at.Z,{isSmall:!0,style:{marginTop:3},children:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsBrowser.subtitle",defaultMessage:"Manage all teamspaces you have access here"})})]}),(0,oe.jsx)(Q.Z,{onClick:u,isLarge:!0,className:zs.myM,children:(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsBrowser.newTeamButton.text",defaultMessage:"New teamspace"})})]}),d?(0,oe.jsx)(Ti.Z,{}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Gx,{teamStores:c,manageTeamsStore:n}),(0,oe.jsx)(dv,{teamStores:c,manageTeamsStore:n})]})]})}var Sv=s(44615),bv=s(2688);function Mv(){window.__c={n:"ManageTeamsListener"};const e=(0,T.O7)(),{currentSpaceStore:t,currentUserStore:s}=(0,a.VK)((()=>{const{currentSpaceStore:e,currentUserStore:t}=ie.default.state;return{currentSpaceStore:e,currentUserStore:t}}),[]);return(0,i.useEffect)((()=>{if("loading"===bi.state.loadingState||!t||!s)return;const i=bv.Z.addListener((0,Sv.pD)({userId:s.id,spaceId:t.id}),((t,s)=>{Mi({environment:e,messageStoreEmitValue:s})}),void 0,e);return function(){i&&bv.Z.removeListener(i,e)}}),[t,s,e]),null}const jv=i.memo(Mv);function wv(e){let{title:t,description:s,disabled:i=!1,selected:n,onChange:a=(()=>{})}=e;return(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!i&&a(!n),children:[(0,oe.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[t,s&&(0,oe.jsx)(at.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:s})]}),(0,oe.jsx)("div",{style:{marginTop:5},children:(0,oe.jsx)(jr.Z,{on:n,disabled:i})})]})}function Cv(){window.__c={n:"Header"};const e=(0,T.Fy)();return(0,oe.jsx)(bt.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"teamsWorkspaceSettings.title",defaultMessage:"Teamspace settings"})})}function kv(){window.__c={n:"TeamSecuritySettings"};const e=(0,T.O7)(),t=(0,a.VK)((()=>ie.default.state.currentSpaceStore),[]),s=(0,a.qz)(void 0,Js.Z),n=(0,a.VK)((()=>t&&s.getValueForSpace(t)),[t,s]),o=(0,a.VK)((()=>(0,ot.F$)()),[]),r=(null==n?void 0:n.disableTeamCreation)??!1,l=(null==n?void 0:n.disableTeamGuests)??!1,d=void 0===n,c=(0,i.useCallback)((()=>{t&&n&&async function(e){let{newSettingValue:t,environment:s,workspaceSecuritySettings:i,spaceStore:n}=e;const a="allowTeamCreation"===t?(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Are you sure you want to allow all members of this workspace to create teamspaces?"}):(0,oe.jsx)(p.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Are you sure you want to limit teamspace creation to only workspace owners?"});!!(await y.confirmUserAction({message:a}))&&nm.n(s,{securitySettingsState:{...i,disableTeamCreation:"disableTeamCreation"===t},spaceStore:n})}({newSettingValue:r?"allowTeamCreation":"disableTeamCreation",environment:e,spaceStore:t,workspaceSecuritySettings:n})}),[t,r,e,n]);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(ro.Z,{size:34}),(0,oe.jsx)(wv,{disabled:d,onChange:c,title:(0,oe.jsx)(p.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",defaultMessage:"Limit teamspace creation to only workspace owners"}),description:(0,oe.jsx)(p.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.caption",defaultMessage:"Only allow workspace owners to create teamspaces"}),selected:r}),(0,oe.jsx)(ro.Z,{size:34}),o&&(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(wv,{disabled:d,onChange:async function(){if(t&&n){if(!Boolean(n.disableTeamGuests)){if(!(await y.confirmUserAction({message:(0,oe.jsx)(p.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.message",defaultMessage:"Are you sure you want to disable teamspace guests?"}),description:(0,oe.jsx)(p.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.description",defaultMessage:"This action will remove all teamspace guests from the workspace."}),acceptLabel:(0,oe.jsx)(p.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.acceptButton",defaultMessage:"Disable and remove teamspace guests"})})))return}nm.n(e,{securitySettingsState:{...n,disableTeamGuests:!n.disableTeamGuests},spaceStore:t})}},title:(0,oe.jsx)(p.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.title",defaultMessage:"Allow teamspace owners to add teamspace guests"}),description:(0,oe.jsx)(p.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.caption",defaultMessage:"This will allow teamspace owners with membership admin permissions to add teamspace guests. Disabling will remove all teamspace guests."}),selected:!l}),(0,oe.jsx)(ro.Z,{size:34})]})]})}function Tv(e){let{}=e;window.__c={n:"TeamsWorkspaceSettings"};const t=(0,Je.yK)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]);return(0,oe.jsxs)(wi.Z,{children:[(0,oe.jsx)(Cv,{}),(0,oe.jsx)(fx.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:t.learnMoreLinkContainer}),(0,oe.jsx)(Cx,{}),(0,oe.jsx)(kv,{}),(0,oe.jsx)(vv,{}),(0,oe.jsx)(jv,{})]})}var Iv=s(38493),Pv=s(3924),_v=s(39675),Zv=s(67729),Fv=s(75493),Av=s(2832),Rv=s(73966);function Dv(e){let{isMobile:t}=e;window.__c={n:"ManualUpdateTimezoneSetting"};const s=(0,T.O7)(),i=D.default.getIntl(),n=(0,a.VK)((()=>ie.default.state.currentUserSettingsStore),[]),{currentTimeZone:o,auto_update_disabled:r}=(0,a.VK)((()=>{const e=null==n?void 0:n.getSettings();return{currentTimeZone:null==e?void 0:e.time_zone,auto_update_disabled:null==e?void 0:e.disable_auto_set_timezone}}),[n]),l=(0,a.VK)((()=>Av.S.map((e=>({key:e,label:(0,Fv.Z)(i,e)})))),[i]);return(n&&(0,oe.jsx)(uo.Z,{isMobile:t,disabled:!r,title:(0,oe.jsx)(p.FormattedMessage,{id:"dateAndTimeSettings.timeZone.title",defaultMessage:"Time Zone"}),caption:(0,oe.jsx)(p.FormattedMessage,{id:"dateAndTimeSettings.timeZone.caption",defaultMessage:"Current time zone setting."}),type:"dropdown",currentOption:o??"error_fetch_timezone",options:l,onSelectOption:e=>{Rv.l6({environment:s,userSettingsStore:n,timeZone:e})}}))??null}function Bv(e){let{isMobile:t}=e;window.__c={n:"AutoUpdateTimezoneSetting"};const s=(0,T.O7)(),n=(0,a.VK)((()=>ie.default.state.currentUserSettingsStore),[]),o=(0,a.VK)((()=>{var e;return null==n||null===(e=n.getSettings())||void 0===e?void 0:e.disable_auto_set_timezone}),[n])??!1,r=(0,i.useCallback)((e=>{const t=!o;Rv.k2({environment:s,userSettingsStore:e,disableAutoSetTimezone:t}),t||Rv.wk({environment:s,userSettingsStore:e})}),[s,o]),l=(0,oe.jsx)(p.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.title",defaultMessage:"Set timezone automatically using your location"}),d=(0,oe.jsx)(p.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.caption",defaultMessage:"Reminders, notifications and emails are delivered based on your time zone."});return(n&&(0,oe.jsx)(uo.Z,{isMobile:t,title:l,caption:d,type:"toggle",isOn:!o,onToggle:()=>r(n)}))??null}var Lv=s(16347);const Nv=(0,Pv.M)((function(e){let{passwordRequestStore:t,userEmailDomainSettings:s}=e;window.__c={n:"UserSettings"};const{isPhone:i,isIOS:n,isMobile:o}=(0,T.Fy)(),r=(0,T.O7)(),l=(0,a.VK)((()=>ji.Z.state.online),[]),d=(0,a.VK)((()=>o&&t?(0,_v.E)({isPhone:i,isIOS:n,passwordRequestStore:t,userEmailDomainSettings:s}):(0,_v.Z)({environment:r})),[r,o,i,n,t,s]),c=[{key:"timezone-auto",renderSettingsItem:()=>(0,oe.jsx)(Bv,{isMobile:o})},{key:"timezone-manual",renderSettingsItem:()=>(0,oe.jsx)(Dv,{isMobile:o})}].filter(me.$K),u=[(0,a.VK)((()=>(0,Zv.h)(r)),[r])?{key:"cookies",renderSettingsItem:()=>(0,oe.jsx)(Zv.Z,{isMobile:o})}:void 0,{key:"view-history",renderSettingsItem:()=>(0,oe.jsx)(Lv.H,{isMobile:o})}].filter(me.$K);return l?(0,oe.jsxs)(wi.Z,{disableScroller:o,children:[(0,oe.jsx)(bt.Z,{large:!o,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"mySettings.settingsSection.title",defaultMessage:"My settings"})}),(0,oe.jsx)(Yu.O,{items:d}),(0,oe.jsx)(ro.Z,{size:48,isHidden:!0}),(0,oe.jsx)(bt.Z,{large:!o,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"notificationAndPersonalSettings.dateAndTimeSection.title",defaultMessage:"Date & time"})}),(0,oe.jsx)(Yu.O,{items:c}),(0,oe.jsx)(ro.Z,{size:48,isHidden:!0}),(0,oe.jsx)(bt.Z,{large:!o,divider:"full",children:(0,oe.jsx)(p.FormattedMessage,{id:"mySettings.privacySection.title",defaultMessage:"Privacy"})}),(0,oe.jsx)(Yu.O,{items:u})]}):(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(at.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,oe.jsx)(p.FormattedMessage,{defaultMessage:"Please go online to manage settings.",id:"mySettings.goOnline.prompt"})})})})),Ov={user_settings:{},profile:{},notifications:{},notifications_and_settings:{},connected_apps:{},language_and_region:{},debug_zone:{},settings:{},teams:{adminOnly:!0,membersOnly:!0},members:{membersOnly:!0},analytics:{membersOnly:!0,enterpriseOnly:!0},plans:{membersOnly:!0},billing:{},subscription:{},security:{adminOnly:!0},identity_provisioning:{adminOnly:!0},admin_content_search:{adminOnly:!0,enterpriseOnly:!0},integrations:{adminOnly:!0},imports:{},audit_log:{adminOnly:!0,enterpriseOnly:!0},experiments:{},publishing:{adminOnly:!0}},Ev=(0,p.defineMessages)({dialogLabel:{id:"spaceSettings.dialogLabel",defaultMessage:"Settings & members"}});class Vv extends n.Z{constructor(){super(...arguments),this.lastSpaceSettingsStoreState=void 0,this.lastSpaceSettingsModalStoreOpen=!1,this.storeTypes={spaceBasicSettingsStore:ai,spaceProfileSettingsStore:di,securitySettingsStore:Js.Z,samlSettingsStore:$s,spaceDomainSettingsStore:ri},this.renderContent=()=>{const e=ci.Z.state.currentTab,t=this.getTabRenderer(e);return(0,oe.jsx)(So.Z,{capture:!0,allowEsc:!0,render:e=>(0,oe.jsx)(bo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>(0,oe.jsx)(Sm,{sidebar:this.renderSidebar(),...e,children:t()})})})},this.renderTabDot=e=>{const{currentSpaceStore:t}=ie.default.state;return"members"===e&&this.environment.device.isDesktop&&null!=t&&t.canEditMembership()&&(0,ot.p1)()&&mi.Z.state.count>0?(0,oe.jsx)(cc.z,{color:this.theme.redBadgeBackground}):null},this.renderProfile=()=>(0,oe.jsx)(Ih,{isEducationPlan:yi.wl(ui.default.state.data),spaceProfileSettingsStore:this.stores.spaceProfileSettingsStore}),this.renderNotificationsAndSettings=()=>(0,oe.jsx)(Gu.Z,{isMobile:!1}),this.renderLanguageAndRegion=()=>(0,oe.jsx)(Ku,{}),this.renderSettings=()=>(0,oe.jsx)(Sg,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,securitySettingsStore:this.stores.securitySettingsStore}),this.renderMySettings=()=>(0,oe.jsx)(Nv,{}),this.renderMyNotifications=()=>(0,oe.jsx)(Ju,{}),this.renderTeamsSettings=()=>(0,oe.jsx)(Tv,{}),this.renderMembers=()=>(0,ot.wE)(this.environment)?(0,oe.jsx)(Tf,{}):(0,oe.jsx)(Cg.Z,{store:this.props.spaceStore,unreadAccessRequests:mi.Z.state.count}),this.renderAnalytics=()=>{const{spaceStore:e}=this.props;return(0,oe.jsx)(zp,{spaceStore:e})},this.renderPlans=()=>{const{data:e}=ui.default.state,{data:t}=pi.Z.state;if(e)return(0,oe.jsx)(Hy,{spaceStore:this.props.spaceStore,upcomingInvoiceData:t,securitySettingsStore:this.stores.securitySettingsStore,data:e})},this.renderBilling=()=>{const{data:e}=ui.default.state,{data:t}=pi.Z.state;if(!e)return null;const s="unsubscribed_admin"===e.type&&e.customerData&&(0,c.E3)(e.customerData.stripe.addOns);if("subscribed_admin"===e.type||s){var i;const s=null===(i=e.customerData)||void 0===i?void 0:i.stripe;return s?(0,oe.jsx)(fi.Z,{spaceStore:this.props.spaceStore,subscriptionData:e,upcomingInvoiceData:t,customerData:s}):null}return e&&"unsubscribed_admin"===e.type?(0,oe.jsx)(xy,{spaceStore:this.props.spaceStore,data:e}):void 0},this.renderExperiments=()=>(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(jo.Ub,{})}),this.shouldRenderAnalyticsPrompt=()=>{var e,t;const{currentSpaceViewStore:s,currentSpaceStore:i,currentUserStore:n}=ie.default.state;if(!i||!Uv("analytics",i))return!1;if(null==n||!n.id)return!1;if(null==i||!i.isDefined())return!1;const a=null==s?void 0:s.getSettings();return"dismissed"!==(null==a||null===(e=a.space_analytics_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==a||null===(t=a.space_analytics_settings_prompt)||void 0===t?void 0:t.status)&&(w.lo(this.environment),!0)},this.shouldRenderMfaPrompt=()=>{var e,t;const{currentSpaceViewStore:s,currentSpaceStore:i,currentUserStore:n}=ie.default.state;if(null==n||!n.id)return!1;if(null==i||!i.isDefined())return!1;const a=null==s?void 0:s.getSettings();return"dismissed"!==(null==a||null===(e=a.mfa_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==a||null===(t=a.mfa_settings_prompt)||void 0===t?void 0:t.status)&&("off"===this.stores.spaceProfileSettingsStore.state.accountSettings.mfaStatus&&(w.GZ(this.environment),!0))},this.renderAuditLog=()=>(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(Us,{spaceStore:this.props.spaceStore})})}),this.renderSubscription=()=>(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(Jy.Z,{})}),this.renderImports=()=>(0,oe.jsx)(wi.Z,{children:(0,oe.jsx)(Yc,{genericImporterEnabled:(0,qs.t)()})}),this.renderConnectedApps=()=>(0,oe.jsx)(Iv.Z,{location:"settings-page"}),this.renderDebugZone=()=>(0,oe.jsx)(Ef,{store:this.props.spaceStore}),this.renderSecurity=()=>(0,oe.jsx)(hm,{spaceStore:this.props.spaceStore,securitySettingsStore:this.stores.securitySettingsStore,userStore:this.props.userStore}),this.renderIdentityProvisioning=()=>(0,oe.jsx)(Gd,{spaceStore:this.props.spaceStore,samlConfigStore:this.stores.samlSettingsStore,domainSettingsStore:this.stores.spaceDomainSettingsStore,userStore:this.props.userStore}),this.renderAdminContentSearch=()=>(0,oe.jsx)(Ma,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),this.renderIntegrations=()=>(0,oe.jsx)(vo,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),this.renderPublishing=()=>(0,oe.jsx)(im,{spaceStore:this.props.spaceStore,userStore:this.props.userStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore}),this.renderNewFeaturePrompt=()=>{if(this.shouldRenderAnalyticsPrompt()){const{currentSpaceStore:e}=ie.default.state,t=null!=e&&e.canAdmin()?(0,oe.jsx)(p.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.workspaceOwner",defaultMessage:"Explore how members & guests are engaging with this workspace, common searches that are made, and content engagement metrics with workspace analytics."}):(0,oe.jsx)(p.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.member",defaultMessage:"See how your content is performing by reviewing metrics like number of views or unique visitors using workspace analytics."});return(0,oe.jsx)(vm,{onDismiss:()=>w.TY(this.environment),onClick:()=>{this.attemptCloseCurrentTab((()=>{ci.Z.setState({...ci.Z.state,currentTab:"analytics",defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),f.XI1(this.environment,{tab:"analytics"}),w.pE(this.environment)}))},onView:t=>{"enterprise"===(null==e?void 0:e.getSubscriptionTier())&&w.pE(t)},onClickLearnMore:()=>{const e=(0,Gs.UY)("guides.workspaceAnalytics");v.navigateToExternalURL({environment:this.environment,url:e})},descriptionMessage:t,title:(0,oe.jsx)(p.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.title",defaultMessage:"New workspace analytics"}),buttonText:(0,oe.jsx)(p.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),icon:(0,r.v)(this.getSettingsPromptIconStyle())})}if(this.shouldRenderMfaPrompt())return(0,oe.jsx)(vm,{onClick:()=>{this.attemptCloseCurrentTab((()=>{ci.Z.setState({...ci.Z.state,open:!0,currentTab:"profile",defaultSubtab:void 0,highlightedSetting:ci.R.TwoStepVerification}),f.XI1(this.environment,{tab:"profile"})}))},onView:w.E6,onDismiss:()=>w.ZJ(this.environment),onClickLearnMore:()=>{const e=(0,Gs.UY)("guides.mfa");v.navigateToExternalURL({environment:this.environment,url:e})},descriptionMessage:(0,oe.jsx)(p.FormattedMessage,{id:"mfaSettingsPrompt.description",defaultMessage:"2-step verification, also known as 2FA or MFA, is now available. Add a secondary method of verification used during login."}),title:(0,oe.jsx)(p.FormattedMessage,{id:"mfaSettingsPrompt.title",defaultMessage:"Add an extra layer of security to your account."}),buttonText:(0,oe.jsx)(p.FormattedMessage,{id:"mfaSettingsPrompt.button.label",defaultMessage:"Enable 2-step verification"}),icon:(0,o.Q)(this.getSettingsPromptIconStyle())})},this.handleModalOpen=()=>{gi.bi(this.environment),Kv(),g.kj({environment:this.environment,spaceId:this.props.spaceStore.id,canAdmin:this.props.spaceStore.canAdmin()})},this.handleModalDismiss=()=>this.attemptCloseCurrentTab((()=>{ci.Z.setState({...ci.Z.state,open:!1}),ei.reset(),this.stores.spaceDomainSettingsStore.reset(),Kv(),mi.Z.reset()}))}async willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{securitySettingsStore:s}=this.stores,i=s.getValueForSpace(t);i&&s.setState(i),await j(this.environment,this.stores.spaceProfileSettingsStore)}willMountOrUpdate(e){super.willMountOrUpdate(e);const{open:t}=ci.Z.state,s=ci.Z.state;this.lastSpaceSettingsModalStoreOpen===t&&l.Xy(this.lastSpaceSettingsStoreState,s)||t&&f.SUq(this.environment,{tab:s.currentTab,from:s.openedFrom}),this.lastSpaceSettingsModalStoreOpen=t,this.lastSpaceSettingsStoreState=l.d9(s)}renderComponent(){const{open:e}=ci.Z.state;return(0,oe.jsx)(Mo.Z,{ariaLabel:D.default.formatMessage(Ev.dialogLabel),open:e,innerStyle:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:715},onOpen:this.handleModalOpen,onDismiss:this.handleModalDismiss,render:this.renderContent,className:zs.zYS})}getTabRenderer(e){const t={profile:this.renderProfile,notifications_and_settings:this.renderNotificationsAndSettings,user_settings:this.renderMySettings,notifications:this.renderMyNotifications,language_and_region:this.renderLanguageAndRegion,connected_apps:this.renderConnectedApps,debug_zone:this.renderDebugZone,settings:this.renderSettings,teams:this.renderTeamsSettings,members:this.renderMembers,analytics:this.renderAnalytics,plans:this.renderPlans,billing:this.renderBilling,subscription:this.renderSubscription,security:this.renderSecurity,identity_provisioning:this.renderIdentityProvisioning,admin_content_search:this.renderAdminContentSearch,integrations:this.renderIntegrations,experiments:this.renderExperiments,audit_log:this.renderAuditLog,imports:this.renderImports,publishing:this.renderPublishing},{spaceStore:s}=this.props;if(Uv(e,s))return t[e];{const e=x.CT(s);return x.r$({currentTab:e}),t[e]}}renderSidebar(){const{spaceStore:e}=this.props,{data:t}=ui.default.state,s=ci.Z.state.currentTab,i=yi.wY(t),n=(0,jo.mS)(),a=Nf().length>0;return(0,oe.jsxs)("div",{style:Vv.sidebarStyle,children:[(0,oe.jsx)("div",{style:Vv.sidebarTabsStyle,children:(0,oe.jsxs)("div",{children:[(0,oe.jsx)("div",{style:this.getSidebarHeader(),children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Account"})}),this.renderUserDetails(),this.renderTabButton("profile",e),(0,Hs.r)()?(0,oe.jsxs)(oe.Fragment,{children:[this.renderTabButton("user_settings",e),this.renderTabButton("notifications",e)]}):(0,oe.jsx)(oe.Fragment,{children:this.renderTabButton("notifications_and_settings",e)}),this.renderTabButton("connected_apps",e),this.renderTabButton("language_and_region",e),a&&this.renderTabButton("debug_zone",e),(0,oe.jsx)(ro.Z,{size:18,isHidden:!0}),(0,oe.jsx)("div",{style:this.getSidebarHeader(),children:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})}),this.renderTabButton("settings",e),(0,rt.bq)()&&this.renderTabButton("teams",e),this.renderTabButton("publishing",e),this.renderTabButton("members",e),!this.environment.device.isMobile&&this.renderTabButton("analytics",e),this.renderTabButton("plans",e),qv(i,this.props.spaceStore)&&this.renderTabButton("billing",e),i&&this.renderTabButton("subscription",e),this.renderTabButton("security",e),this.renderTabButton("identity_provisioning",e),!this.environment.device.isMobile&&this.renderTabButton("admin_content_search",e),this.renderTabButton("integrations",e),(0,Ks.c)()&&!this.environment.device.isMobile&&(0,oe.jsx)("span",{onClick:()=>{const e=(0,d.ZP)();Qs.Z.setState({flowId:e}),f.Syn(this.environment,{from:"settings",flowId:e})},children:this.renderTabButton("imports",e)}),!this.environment.device.isMobile&&this.renderTabButton("audit_log",e),n&&this.renderTabButton("experiments",e)]})}),e.canRead()&&(0,oe.jsx)(ja.Z,{source:"settings",isButtonDisabled:"plans"===s}),e.canRead()&&!(0,c.E3)(null==t?void 0:t.addOns)&&(0,oe.jsx)(hi.Z,{source:"settings"}),this.renderNewFeaturePrompt()]})}renderUserDetails(){const e=(0,Ws.B7)(this.environment),t={size:20,hasTooltip:!0,avatarShouldShowShadow:!0,userStore:e};return(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",height:44,paddingLeft:12,paddingRight:12},children:[(0,oe.jsx)("div",{style:this.getIconWrapStyle(),children:(0,oe.jsx)(wn.Z,{...t})}),e?(0,oe.jsxs)("div",{children:[(0,oe.jsx)(zv,{userStore:e}),e.getEmail()&&(0,oe.jsx)(at.Z,{isSmall:!0,children:e.getEmail()})]}):(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.userDetails.title",defaultMessage:"Me"})]})}renderTabButton(e,t){if(!Uv(e,t))return null;const s=ci.Z.state.currentTab===e,i=oy[e](this.environment),n=ry[e](),a=ly[e]();return(0,oe.jsxs)(_t.Z,{hovered:s,style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:12,paddingRight:12,borderRadius:4,marginTop:1,marginBottom:1,minHeight:27},onClick:t=>{s||this.attemptCloseCurrentTab((()=>{ci.Z.setState({...ci.Z.state,currentTab:e,defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),f.XI1(this.environment,{tab:e})}))},children:[(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center",...s&&{fontWeight:m.Z.fontWeight.semibold}},children:[(0,oe.jsx)("div",{style:this.getIconWrapStyle(),children:i}),(0,oe.jsx)(at.Z,{isMultiline:!0,children:n}),a]}),this.renderTabDot(e)]})}async attemptCloseCurrentTab(e){const{spaceStore:t}=this.props,{spaceProfileSettingsStore:s}=this.stores,{currentUserStore:i,currentUserSettingsStore:n}=ie.default.state;if(!i||!n)throw new Error("No user or settings store.");const a=(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),o=(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes"}),r=(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No"}),{currentTab:d}=ci.Z.state;if("profile"===d){if(!l.Xy(s.state,s.getValueForUser(i,n,D.default.getIntl()))){const{profilePhoto:t,name:i,startDayOfWeek:o}=s.state;return i?y.showDialog({message:a,showCancel:!0,keepFocus:!0,items:[{label:(0,oe.jsx)(p.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{C.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{const{currentUserStore:s}=ie.default.state;if(s&&h.A({userStore:s,data:{name:i,profilePhoto:t},transaction:e}),n){const t=n.getSettings();(null==t?void 0:t.start_day_of_week)!==o&&k.d2({userSettingsStore:n,data:{start_day_of_week:o},transaction:e})}}}),e()}}],handleCancel:()=>{e()}}):y.showErrorMessage((0,oe.jsx)(p.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}e()}else if("settings"===d&&t.canEdit()){const{spaceBasicSettingsStore:s}=this.stores,{securitySettingsStore:i}=this.stores,n=!l.Xy(i.state,i.getValueForSpace(t)),d=!l.Xy(s.state,s.getValueForSpace(t));if(n||d){if(await y.confirmUserAction({message:a,acceptLabel:o,cancelLabel:r})){if(!(await S.Y5({environment:this.environment,spaceId:t.id,spaceBasicSettingsStore:s})))return!1;d&&S.OF({environment:this.environment,spaceStore:this.props.spaceStore,spaceBasicSettingsStore:s}),n&&Gv(i,this.props.spaceStore,this.environment),e()}else e();return!0}e()}else if("audit_log"===d)Kv(),e();else if("analytics"===d)ii.reset(),e();else if("plans"===d&&t.canAdmin()){const{securitySettingsStore:s}=this.stores,i=s.getValueForSpace(t);!l.Xy(s.state,s.getValueForSpace(t))&&i&&(s.setState(i),Gv(s,this.props.spaceStore,this.environment)),e()}else"teams"===d?(vi.Z.reset(),bi.reset(),e()):e();return!1}getSidebarHeader(){return{fontSize:12,lineHeight:1,marginBottom:1,color:this.theme.mediumTextColor,fontWeight:m.Z.fontWeight.semibold,alignItems:"center",display:"flex",height:24,paddingLeft:12,paddingRight:11,textOverflow:"ellipsis",overflow:"hidden"}}getIconWrapStyle(){return{width:20,height:20,marginRight:8,color:this.theme.regularIconColor,fill:this.theme.regularIconColor}}getSettingsPromptIconStyle(){return{width:14,height:14,color:this.theme.regularIconColor}}}function Uv(e,t){if("publishing"===e)return(0,ot.yq)();const s=Ov[e];return!(s.adminOnly&&!t.canAdmin())&&(!(s.membersOnly&&!t.canRead())&&!(s.enterpriseOnly&&!(0,u.wP)(t.getSubscriptionTier())))}Vv.displayName="SpaceSettings",Vv.theme=void 0,Vv.sidebarStyle={display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingTop:10,paddingLeft:4,paddingRight:4},Vv.sidebarTabsStyle={overflow:"auto",paddingBottom:12};const Wv=Vv;function Kv(){O.reset(),K.reset()}function zv(e){let{userStore:t}=e;window.__c={n:"UserName"};const s=(0,p.useIntl)(),i=(0,a.VK)((()=>t.getFullName(s)),[s,t]);return i?(0,oe.jsx)(at.Z,{style:{fontWeight:m.Z.fontWeight.medium},children:i}):null}function qv(e,t){var s;const{data:i}=ui.default.state;return!(!i||e||!t.canAdmin())&&("subscribed_admin"===i.type||(!("unsubscribed_admin"!==i.type||!(0,c.E3)(null===(s=i.customerData)||void 0===s?void 0:s.stripe.addOns))||!!(0,yi.MM)(i)))}function Gv(e,t,s){const{disablePublicAccess:i,disableGuests:n,disableMoveToSpace:a,disableExport:o,disableSpacePageEdits:r,disablePublicAccessRequests:l,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:m,enableAiFeature:p,disableTeamGuests:g,enableGuestInviteRequests:h}=e.state;C.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:s,perform:e=>{S.Xr({environment:s,disablePublicAccess:i,disableGuests:n,disableMoveToSpace:a,disableExport:o,disableSpacePageEdits:r,disablePublicAccessRequests:l,transaction:e,spaceStore:t,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:m,enableAiFeature:Boolean(p),disableTeamGuests:g,enableGuestInviteRequests:h})}})}},10644:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var i=s(31412),n=s(64369),a=s(27386),o=s(85893);const r=function(){return(0,o.jsx)(a.Z,{children:(0,o.jsx)(n.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,o.jsx)(i.FormattedMessage,{id:"spaceSubscriptionPlans.offlineMessage",defaultMessage:"Please go online to manage your plan."})})})}},56633:(e,t,s)=>{s.d(t,{G:()=>y});var i=s(67294),n=s(480),a=s(86628),o=s(45433),r=s(40652),l=s(42875),d=s(59054),c=s(23014),u=s(31412),m=s(54642),p=s(66890),g=s(56596),h=s(85893);const f=(0,u.defineMessages)({cannotSetSprintToCurrentTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToCurrentTooltip",defaultMessage:"Current sprint already exists"},cannotSetSprintToNextTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToNextTooltip",defaultMessage:"Next sprint already exists"}});function y(e){window.__c={n:"SprintStatusPropertyMenu"};const{blockPropertyValueOverlayStore:t}=e,s=(0,n.O7)(),y=(0,p.Y$)(),x=(0,a.VK)((()=>y.normalizedSchemaStore.state),[y.normalizedSchemaStore]),v=function(e){let{sprintCollectionStore:t,environment:s,normalizedBlockSchema:i}=e;const[{value:n,status:a}]=(0,d.r5)((async()=>{var e;if(!t)return;const n=c.qB[r.p$].current.reducer.get(i),a=c.qB[r.p$].next.reducer.get(i);if(!n)return;if(!a)return;const d={type:"reducer",userId:s.currentUser.id,userTimeZone:(0,l.r)(),searchQuery:void 0,reducers:{[o.SF]:n,[o.YE]:a}},u=null===(e=t.getParentBlockStore())||void 0===e?void 0:e.getCollectionViewStores()[0],p=t.getSpaceId();if(!u)return;const g=await m.queryCollection(s,{source:{type:"collection",id:t.id,spaceId:p},collectionView:{id:u.id,spaceId:p},loader:d},void 0,{src:"sprint_status_overlay_check"});if("success"!==g.type)return;const h=g.data.result.reducerResults[o.SF],f=g.data.result.reducerResults[o.YE];return"results"===h.type&&"results"===f.type?{hasCurrentSprint:h.blockIds.length>0,hasNextSprint:f.blockIds.length>0}:void 0}),[s,i,t]);if("resolved"!==a||!n)return;return n}({sprintCollectionStore:(0,a.VK)((()=>{const e=t.state;if(e.isOpen)return e.store.getAssociatedCollectionStore()}),[t]),environment:s,normalizedBlockSchema:x}),S=(0,u.useIntl)(),b=(0,i.useCallback)((e=>void 0===v&&[o.YE,o.SF].includes(e)?{disabled:!0}:e===o.YE&&null!=v&&v.hasNextSprint?{disabled:!0,disableReasonMessage:S.formatMessage(f.cannotSetSprintToNextTooltip)}:e===o.SF&&null!=v&&v.hasCurrentSprint?{disabled:!0,disableReasonMessage:S.formatMessage(f.cannotSetSprintToCurrentTooltip)}:{disabled:!1}),[v,S]);return(0,h.jsx)(g.x,{...e,shouldDisableOption:b})}},56596:(e,t,s)=>{s.d(t,{x:()=>I});var i=s(43261),n=s.n(i),a=s(67294),o=s(480),r=s(86628),l=s(80951),d=s(84619),c=s(4635),u=s(72126),m=s(97880),p=s(31412),g=s(5149),h=s(58023),f=s(87279),y=s(4023),x=s(97180),v=s(52275),S=s(78140),b=s(32163),M=s(40721),j=s(72495),w=s(26388),C=s(22084),k=s(47082),T=s(85893);function I(e){window.__c={n:"StatusPropertyMenu"};const{device:t}=(0,o.O7)(),[s,i]=a.useState(e.initialValue??""),[I,P]=a.useState(""),_=(0,p.useIntl)(),Z=(0,r.VK)((()=>{const t=e.blockPropertyValueOverlayStore.state;if(t.isOpen)return t.collectionContextStore}),[e.blockPropertyValueOverlayStore]),F=(0,r.VK)((()=>(null==Z?void 0:Z.permissionScopes.state.canConfigureCollection)&&"collectionPage"!==(null==Z?void 0:Z.contextType)),[Z]),A=e.propertySchema.options??[],R=(0,l.i7)(A,s),D=e.propertySchema.groups??[],B=R&&D.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(R.id)})),L=R&&(0,T.jsx)(C.F,{value:R.value,color:R.color,descriptionTooltip:R.description,tooltipPlacement:y.u.Left,groupColor:null==B?void 0:B.color,isSingle:!1,format:t.isMobile?d.lo.Large:d.lo.Medium,onClickRemove:()=>{i(""),e.onChange("")},showRemoveButton:!0,shouldShrink:!0,showEllipsis:!0}),N=(0,T.jsx)(k.Z,{focus:!t.isMobile||void 0,focusAfterAnimation:!0,format:k.Z.Format.Select,tokens:[L],placeholder:_.formatMessage({id:"database.selectPropertyEditMenu.searchStatusPlaceholder",defaultMessage:"Search for an option"}),onRemoveLastToken:()=>{},value:I,disabled:e.disabled,hideInput:e.disabled,onChange:e=>{P(e.target.value)},dontShowBorderBottom:t.isAndroid});let O;if(O=t.isMobile?{menuType:f.og.Modal,title:e.propertySchema.name,right:(0,T.jsx)(M.DoneMenuText,{}),onClickRight:e.onDismiss,header:N}:{menuType:f.og.Popup,header:N,tokenInputHeader:!0},e.disabled)return(0,T.jsx)(S.Z,{...O});const{propertySchema:E}=e,V=E.options??[];let U=V;if(""!==I){const e=n().filter(I,V.map((e=>e.value))).map((e=>e.original));U=V.filter((t=>e.includes(t.value)))}const W=(E.groups??[]).map((e=>{const t=U.filter((t=>{var s;return null===(s=e.optionIds)||void 0===s?void 0:s.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(m.$K),K=W.length>1,z=W.map(((s,i)=>{let{group:n,groupOptions:a}=s;return{items:a.map((s=>{const i=e.shouldDisableOption?e.shouldDisableOption(s.id):{disabled:!1};return{key:s.value,render:e=>(0,T.jsx)(v.Z,{...e,disabled:i.disabled,disabledFeedback:!0,focused:e.focused,title:(0,T.jsx)(w.Z,{disableTooltip:!i.disabled||!i.disableReasonMessage,renderTooltip:()=>i.disabled&&i.disableReasonMessage,render:e=>(0,T.jsx)(C.F,{...e,value:s.value,color:s.color,descriptionTooltip:s.description,tooltipPlacement:y.u.Left,groupColor:n.color,showRemoveButton:!1,isSingle:!0,format:t.isMobile?d.lo.Large:d.lo.Medium})}),isTokenTitle:!0}),action:()=>{e.onChange(s.value)}}})),key:`group-${i}`,render:e=>(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(j.Z,{...e,topBorder:e.index>0,title:K&&(0,T.jsx)(x.r_,{group:n,showColor:!1,style:{fontSize:12}})})})}})),q=Z&&F?{items:[{key:"edit property",render:e=>(0,T.jsx)(v.Z,{...e,title:(0,T.jsx)(p.FormattedMessage,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,c.W)({width:14})}),action:()=>{const t=Z.settingsStore;Z.collectionStore()&&(e.onDismiss(),h.n1({collectionContextStore:Z}),g.r$({collectionContextStore:Z,collectionSettingsStore:t}),g.H4({collectionSettingsStore:t,item:{type:"property",formatKey:Z.getPropertyFormatKey(),property:e.property}}))}}],key:"edit-property",render:e=>(0,T.jsx)(j.Z,{...e,topBorder:e.index>0})}:void 0;return(0,T.jsx)(S.Z,{...O,children:(0,T.jsx)(b.Z,{type:b.i.Vertical,initialFocus:I.length>0?0:void 0,sections:u.oA([...z,q]),onAccept:(t,s,i)=>{e.onAccept(i)}})})}},5478:(e,t,s)=>{s.d(t,{YF:()=>l,ZP:()=>c});s(67294);var i=s(24405),n=s(4023),a=s(26388),o=s(85567),r=s(85893);const l={Success:"success",Pending:"pending",Failure:"failure"};const d={display:"flex",justifyContent:"center",alignItems:"baseline"},c=function(e){let{status:t,value:s,renderTooltip:c,...u}=e;window.__c={n:"StatusToken"};const m=(0,i.Fg)(),p={[l.Success]:m.statusTokenBackground.green,[l.Pending]:m.statusTokenBackground.yellow,[l.Failure]:m.statusTokenBackground.red},g={[l.Success]:m.statusTokenIndicator.green,[l.Pending]:m.statusTokenIndicator.yellow,[l.Failure]:m.statusTokenIndicator.red},h={[l.Success]:m.statusTokenText.green,[l.Pending]:m.statusTokenText.yellow,[l.Failure]:m.statusTokenText.red};return c?(0,r.jsx)(o.Z,{...u,backgroundColor:p[t],color:h[t],value:(0,r.jsx)(a.Z,{placement:n.u.Bottom,alignment:n.v.Start,renderTooltip:c,render:e=>(0,r.jsxs)("div",{style:d,...e,children:[(0,r.jsx)("div",{style:{background:g[t],width:8,height:8,borderRadius:"100%",marginRight:4}}),s]})})}):(0,r.jsx)(o.Z,{...u,backgroundColor:p[t],color:h[t],value:(0,r.jsxs)("div",{style:d,children:[(0,r.jsx)("div",{style:{background:g[t],width:8,height:8,borderRadius:"100%",marginRight:4}}),s]})})}},13787:(e,t,s)=>{s.r(t),s.d(t,{default:()=>M});var i=s(67294),n=s(83355),a=s(49085),o=s(8848),r=s(84169),l=s(89101),d=s(82990),c=s(31412),u=s(54642),m=s(28020),p=s(33846),g=s(92083),h=s(9209),f=s(42922),y=s(74194),x=s(50506),v=s(42402),S=s(85893);class b extends n.Z{constructor(){super(...arguments),this.storeTypes={promoCodeStore:p.Z,promoError:a.default.createClass(void 0)},this.handleModalDismiss=()=>{h.Z.setState({open:!1})},this.handleChangeEmail=()=>{this.handleModalDismiss(),g.Z.setState({open:!0,openedFrom:"upsell",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})},this.handleInputChange=e=>{this.stores.promoCodeStore.setState({...this.stores.promoCodeStore.state,inputValue:e.target.value.toUpperCase()}),this.stores.promoError.setState(void 0)},this.handleSubmitPromoCode=async()=>{const e=this.stores.promoCodeStore.state.inputValue;if(e){const t=await u.getPromoCode(this.environment,{code:e});"failed"!==t.type&&t.data.promo?h.Z.state.open&&(await h.Z.state.handlePromoCode(this.stores.promoCodeStore.state.inputValue),this.handleModalDismiss()):this.stores.promoError.setState(this.props.intl.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:e}))}}}renderComponent(){const{open:e}=h.Z.state;return(0,S.jsx)(x.Z,{open:e,innerStyle:b.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>this.renderModalContents(),onDismiss:this.handleModalDismiss})}renderModalContents(){return(0,S.jsxs)("div",{style:{fontSize:14},children:[(0,S.jsx)("div",{children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,S.jsx)("br",{}),p:e=>(0,S.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:i.Children.toArray(e)}),pricinglink:e=>(0,S.jsx)(v.Z,{external:!0,href:l.AR.pricing,children:e})}})}),this.renderSchoolEmailCodePrompt(),this.renderPromoCode(),this.renderContactUs()]})}renderSchoolEmailCodePrompt(){const e=(0,m.B7)(this.environment);return(0,S.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,S.jsx)("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,S.jsxs)("div",{style:{flexGrow:1},children:[(0,S.jsx)("div",{style:{color:this.theme.mediumTextColor},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,S.jsx)("div",{style:{fontWeight:d.Z.fontWeight.medium,marginTop:0},children:e&&e.getEmail()}),(0,S.jsx)("div",{style:{color:this.theme.mediumTextColor,marginTop:4},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,S.jsx)(f.Z,{style:{marginTop:12},onClick:this.handleChangeEmail,isLarge:!0,children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}renderPromoCode(){const e=this.stores.promoError.state,t=this.props.intl.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,S.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,S.jsx)("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,S.jsxs)("div",{style:{flexGrow:1},children:[(0,S.jsx)("div",{style:{color:this.theme.mediumTextColor},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,S.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,S.jsx)(y.Z,{style:{marginRight:8,height:32},value:this.stores.promoCodeStore.state.inputValue,onChange:this.handleInputChange,onSubmit:this.handleSubmitPromoCode,placeholder:t}),(0,S.jsx)(f.Z,{onClick:this.handleSubmitPromoCode,disabled:!this.stores.promoCodeStore.state.inputValue,isLarge:!0,children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,S.jsx)("div",{style:{color:o.ZP.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:e})]})]})}renderContactUs(){return(0,S.jsxs)("div",{style:{display:"flex",alignItems:"center",color:this.theme.lightTextColor,borderTop:`1px solid ${this.theme.regularDividerColor}`,paddingTop:14},children:[(0,r.m)({width:14,marginTop:1,marginRight:6,fill:this.theme.lightIconColor})," ",(0,S.jsx)("div",{children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,S.jsx)(v.Z,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}}b.displayName="StudentNotEligibleModal",b.wrapStyle={padding:"24px 36px 24px",minWidth:300,maxWidth:400};const M=(0,c.injectIntl)(b)},6202:(e,t,s)=>{s.d(t,{Z:()=>m});s(67294);var i=s(83355),n=s(480),a=s(8848),o=s(87279),r=s(42922),l=s(64921),d=s(28992),c=s(85893);class u extends i.Z{renderComponent(){return(0,c.jsx)(d.Z,{title:(0,c.jsx)(p,{onClick:this.props.onClick,disabled:this.props.disabled,title:this.props.title})})}}u.displayName="SubmitButtonMenuItem",u.contextTypes={...o.mw,...i.w};const m=u;function p(e){let{onClick:t,disabled:s,title:i}=e;window.__c={n:"SubmitButtonMenuItemButton"};const o=(0,n.O7)(),{isMobile:d}=o.device,u={width:"100%",color:a.ZP.blue};return d?(0,c.jsx)(l.Z,{onClick:t,mobileFeedback:!0,disabled:s,style:u,children:i}):(0,c.jsx)(r.Z,{onClick:t,disabled:s,style:{width:"100%",maxWidth:300,display:"flex",margin:"auto"},children:i})}},30676:(e,t,s)=>{s.d(t,{F:()=>r});s(67294);var i=s(86628),n=s(74016),a=s(52275),o=s(85893);function r(e){window.__c={n:"TeamMenuItem"};const{teamStore:t}=e,{name:s}=(0,i.VK)((()=>({name:t.getName()})),[t]);return(0,o.jsx)(a.Z,{...e,icon:(0,o.jsx)(n.p,{size:14,store:t,disabled:!0}),title:s})}},719:(e,t,s)=>{s.d(t,{Z:()=>l});s(67294);var i=s(83355),n=s(98742),a=s(74194),o=s(85893);class r extends i.Z{constructor(){super(...arguments),this.handleKeyDown=e=>{"Backspace"===e.key&&0===this.props.value.length&&this.props.onRemoveLastToken()}}renderComponent(){const{device:e}=this.environment;return(0,o.jsxs)("div",{className:this.props.readOnly?void 0:"notion-focusable-within",onClick:this.props.onClick,style:e.isMobile?this.getMobileWrapStyle():this.getDesktopWrapStyle(),children:[this.props.tokens,this.renderInput()]})}renderInput(){const{device:e}=this.environment,t=0===this.props.tokens.length;return(0,o.jsx)(a.Z,{format:a.Z.Format.Transparent,...(0,n.Z)({onKeyDown:this.handleKeyDown},{onChange:this.props.onChange}),value:this.props.value,onSubmit:this.props.onSubmit,onBlur:this.props.onBlur,focus:this.props.focus,style:{...r.inputStyle,margin:e.isMobile?"0 8px 8px 0":"0 6px 6px 0"},readOnly:this.props.readOnly,inputStyle:{height:18},size:1,type:this.props.type,placeholder:t?this.props.placeholder:"",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})}getDesktopWrapStyle(){return{display:"flex",flexWrap:"wrap",alignItems:"flex-start",minHeight:32,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,borderRadius:4,fontSize:14,cursor:"text",overflow:"hidden",padding:"7px 9px 0px",...this.props.style}}getMobileWrapStyle(){return{...this.getDesktopWrapStyle(),fontSize:14,padding:"7px 10px 0"}}}r.displayName="TokenInput",r.inputStyle={flexGrow:1,flexShrink:1,flexBasis:60,minWidth:60,width:"auto",lineHeight:"20px"};const l=r},53930:(e,t,s)=>{s.r(t),s.d(t,{TopbarMoreMenu:()=>Bs});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(31412),l=s(13991),d=s(15145),c=s(41432),u=s(90792),m=s(77366),p=s(88437),g=s(50066),h=s(82356),f=s(27714),y=s(90199),x=s(60651),v=s(2356),S=s(37888),b=s(76994),M=s(23867),j=s(82990),w=s(50906),C=s(14871),k=s(30188),T=s(79257),I=s(54532),P=s(61652),_=s(96802),Z=s(94419),F=s(72711),A=s(19785),R=s(75018),D=s(37834),B=s(39699),L=s(93405),N=s(72495),O=s(8848),E=s(98742),V=s(64921),U=s(26388),W=s(64369),K=s(85893);function z(e,t){let{id:s,caption:i,focused:a,isActive:r,onClick:l,onMouseDown:d,onMouseEnter:c,onMouseLeave:u,role:m,style:p,tooltip:g,ignoreLocalHoverState:h,disallowTabbing:f}=e;window.__c={n:"FontMenuItem"};const y=(0,n.Fy)(),x=(0,o.yK)((()=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...y.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:r?O.ZP.blue:"inherit"}})),[r,y]);return(0,K.jsx)(U.Z,{renderTooltip:()=>g,placement:U.Z.Placement.Bottom,delayThreshold:80,render:e=>{const n=(0,E.Z)(e,{onMouseEnter:c,onMouseLeave:u}),{onMouseDown:o,...r}=n;return(0,K.jsx)(V.Z,{...r,id:s,role:m,ref:t,mobileFeedback:y.isMobile,onClick:l,onMouseDown:n.onMouseDown||d,hovered:a,style:x.button,ignoreLocalHoverState:h,disallowTabbing:f,className:"notranslate",children:(0,K.jsxs)("div",{style:x.optionItem,children:[(0,K.jsx)("div",{style:{...p,height:25},children:"Ag"}),(0,K.jsx)(W.Z,{isSmall:!0,style:{marginTop:4},children:i})]})})}})}const q=i.forwardRef(z);var G=s(83355),H=s(87279);class Q extends G.Z{constructor(){super(...arguments),this.desktopStyle={display:"flex",justifyContent:"space-between",marginLeft:14,marginRight:14}}renderComponent(){return(0,K.jsx)(N.Z,{...this.props,children:(0,K.jsx)("div",{style:this.environment.device.isMobile?this.getMobileStyle():this.desktopStyle,children:this.props.children})})}getMobileStyle(){return{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}}}Q.displayName="FontSectionMenuItem",Q.contextTypes={...H.mw,...G.w};const Y=Q;s(57658);var $=s(27006),J=s(77420),X=s(97880),ee=s(63163),te=s(18442),se=s(39248),ie=s(74181),ne=s(21202),ae=s(15070),oe=s(80444),re=s(52275),le=s(70301);function de(e){window.__c={n:"BotMenuItem"};const{bot:t}=e,s=(0,a.VK)((()=>oe.default.state.currentUserRootStore),[]);return t&&s?(0,K.jsx)(re.Z,{...e,icon:(0,K.jsx)(le.Z,{botValue:t}),title:(0,ae.Mh)(t)}):null}const ce=i.forwardRef(de);var ue=s(68894),me=s(68785),pe=s(28992),ge=s(43765),he=s(31278),fe=s(76798),ye=s(84015),xe=s(41892),ve=s(24600),Se=s(84210),be=s(28187),Me=s(42402),je=s(60442);function we(e){return(0,a.VK)((()=>{var t;return{isDefined:e.isDefined(),channel:null===(t=e.getKeyStore("channel").getValue())||void 0===t?void 0:t.replace(/^#/,"")}}),[e])}function Ce(){return(0,K.jsx)(je.Z,{imageURL:xe.Z.images.tooltips.pageUpdates.slackPng,imageHeight:100,caption:(0,K.jsx)(r.FormattedMessage,{defaultMessage:"Connect a Slack channel to get updates about this page and pages within it.",id:"topbar.updatesButton.slackIntegrationButton.tooltip"})})}const ke=()=>(0,K.jsx)(je.Z,{imageURL:xe.Z.images.tooltips.pageUpdates.slackPng,imageHeight:100,caption:(0,K.jsx)(r.FormattedMessage,{defaultMessage:"Disconnect a Slack channel to stop getting updates about this page and pages within it.",id:"topbar.updatesButton.slackIntegrationButton.disconnectTooltip"})}),Te=(0,i.forwardRef)((function(e,t){window.__c={n:"SlackInheritedMenuItem"};const{blockStore:s,...i}=e,{blockStore:n,slackIntegrationStore:o}=(0,be.Jk)(s),{isDefined:l,channel:c}=we(o),u=(0,a.VK)((()=>(0,Se.ZP)({store:n,pageVisitSource:d.tY.LinkInPage})),[n]);return l?(0,K.jsx)(U.Z,{placement:U.Z.Placement.Left,render:e=>(0,K.jsx)(L.Z,{...(0,E.Z)(e,i),svg:ve.P,title:c,caption:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(r.FormattedMessage,{defaultMessage:"Based on",id:"topbar.updatesButton.slackIntegrationButton.activeTitle"})," ",(0,K.jsx)(Me.Z,{href:u,children:(0,K.jsx)(fe.Z,{store:n,style:{display:"inline"}})})]}),ref:t}),renderTooltip:ke}):null})),Ie=(0,i.forwardRef)((function(e,t){window.__c={n:"SlackConnectedMenuItem"};const{blockStore:s,...i}=e,{slackIntegrationStore:n}=(0,a.VK)((()=>(0,be.Jk)(s)),[s]),{isDefined:o,channel:l}=we(n);return o?(0,K.jsx)(U.Z,{placement:U.Z.Placement.Left,render:e=>(0,K.jsx)(L.Z,{svg:ve.P,title:l,caption:(0,K.jsx)(r.FormattedMessage,{defaultMessage:"Connected to Slack channel",id:"topbar.updatesButton.slackIntegrationButton.connectedCaption"}),...(0,E.Z)(e,i)}),renderTooltip:ke,ref:t}):null}));var Pe=s(26825),_e=s(48019),Ze=s(78140),Fe=s(40721),Ae=s(42782);const Re=(0,i.forwardRef)((function(e,t){const{context:s,parent:o,isSharedDirectly:r,botStore:l,botPermissionSourcePage:d,originConnectionLabel:c,...u}=e,m=(0,n.O7)(),p=(0,a.VK)((()=>oe.default.state.currentSpaceStore),[]),g=s.blocks[0],h=(0,a.VK)((()=>g.canAdmin()&&(null==p?void 0:p.canRead())),[g,p]),{botCapabilities:f,botName:y}=(0,a.VK)((()=>({botCapabilities:l.getCapabilities(),botName:l.getName()})),[l]);return(0,i.createElement)(Ae.Z,{...u,key:l.id,renderOrigin:e=>(0,K.jsx)(re.Z,{...e,title:c,icon:(0,K.jsx)(le.Z,{botStore:l,showActiveDot:!0,style:{position:"relative"}})}),renderExtension:(e,t)=>{let i;return i=m.device.isPhone?{menuType:H.og.Modal,right:(0,K.jsx)(Fe.DoneMenuText,{}),onClickRight:t.close,...e}:{menuType:H.og.Popup,width:220,...e},(0,K.jsx)(Ze.Z,{...i,children:(0,K.jsx)(_e.Z,{context:s,initialFocus:0,onAccept:o.onAccept,sections:[De({isSharedDirectly:r,botCapabilities:f,botPermissionSourcePage:d}),...h?[Be({isSharedDirectly:r,botId:l.id,botName:y})]:[]]})})},onFocus:o.onFocus,focused:u.focused,openOnFocus:!1,ref:t})}));function De(e){const{botCapabilities:t,isSharedDirectly:s,botPermissionSourcePage:i}=e,n=(0,Pe.uH)(t);return{key:"active connection capabilities section",render:e=>(0,K.jsx)(N.Z,{...e,topBorder:!1}),actions:[...s?[]:[St(i)],bt(n)]}}function Be(e){const{isSharedDirectly:t,botId:s,botName:i}=e;return{key:"active connection disconnect section",render:e=>(0,K.jsx)(N.Z,{...e}),actions:t?[Mt(s,i)]:[jt(s)]}}var Le=s(47453),Ne=s(59753),Oe=s(9844),Ee=s(31299),Ve=s(41623),Ue=s(38755),We=s(26350);const Ke=(0,i.forwardRef)((function(e,t){const{context:s,parent:o,alreadyConnectedIntegrationIds:r,alreadyConnectedBotIds:l,originButtonLabel:d,...c}=e,u=s.blocks[0],m=(0,n.O7)(),p=(0,a.VK)((()=>oe.default.state.currentSpaceStore),[]),g=(0,a.VK)((()=>null==p?void 0:p.getBotSettingsStore().getValue()),[p]),h=(0,a.VK)((()=>null!=g&&g.integration_restrictions&&null!=g&&g.integration_approval_statuses?Object.keys(g.integration_approval_statuses):[]),[g]),[f,y]=(0,i.useState)(""),[x,v]=(0,i.useState)({status:"loading"});(0,i.useEffect)((()=>{Promise.all([async function(e){return await Ee.RF({environment:m,query:e})}(f),async function(e){return await Ee.sC({query:e,environment:m,spaceId:null==p?void 0:p.id,botSettings:g})}(f)]).then((e=>{let[t,s]=e;const i=new Set,n=function(e){const{alreadyConnectedBotIds:t,alreadyConnectedIntegrationIds:s,botValues:i,environment:n}=e,a=[];for(const o of i){const e=o.id,i=t.has(e)||o.integration_id&&s.has(o.integration_id),r=Ne.kk.fromValue(J.cZ,o),l=(0,Ve.Nq)(n,r)||(0,Ue.Fn)(n)&&(0,Ve.f_)(r);!i&&l&&a.push(o)}return a}({alreadyConnectedBotIds:l,alreadyConnectedIntegrationIds:r,botValues:t,environment:m}).map((e=>(e.integration_id&&i.add(e.integration_id),{table:J.cZ,value:e})));let a=s.map((e=>{if(p){const t=We.t1.createChildStore(p,{id:e,table:Oe.K2}),s=t.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:s}=e;return s(t)}));if(s&&!(0,ie.VM)(s)){return{table:Oe.K2,value:s}}}})).filter(X.$K).filter((e=>!(i.has(e.value.id)||r.has(e.value.id))));if(ie.Cb.name.toLowerCase().includes(f.toLowerCase())){const e={table:"legacy_integration",value:ie.Cb};a=[...a,e]}const o=[...n,...a].sort(((e,t)=>{var s,i;const n=null===(s=e.value.name)||void 0===s?void 0:s.toLowerCase(),a=null===(i=t.value.name)||void 0===i?void 0:i.toLowerCase();return n&&a?n<a?-1:n>a?1:0:0}));v({results:o,status:"ready"})})).catch((e=>v({status:"error"})))}),[f,p,l,g,h,m,r,u]);return(0,K.jsx)(Ae.Z,{...c,renderOrigin:(e,t)=>(0,K.jsx)(L.Z,{...e,ref:t,title:d,svg:Le.R}),renderExtension:(e,t)=>{const i=m.device.isMobile?{menuType:H.og.Modal,right:(0,K.jsx)(Fe.DoneMenuText,{}),onClickRight:t.close,...e}:{menuType:H.og.Popup,width:220,...e},n=m.device.isMobile?{menuType:H.og.Modal,topbarStyle:{height:0}}:{menuType:H.og.Popup,width:220,maxHeight:"16vh",...e},a=Boolean(u.canAdmin()&&(null==p?void 0:p.canRead()));return(0,K.jsx)(Ze.Z,{...i,onClick:e=>{e.stopPropagation()},children:(0,K.jsx)(_e.Z,{initialFocus:0,context:s,onAccept:()=>{w.sSR(m)},sections:[...a?[ze(f,y),""===f?qe({searchResults:x,resultsMenuProps:n}):He({searchResults:x,resultsMenuProps:n})]:[],Qe(a,ie.Cb)]})})},onFocus:o.onFocus,focused:c.focused,openOnFocus:!0,ref:t})}));function ze(e,t){return{key:"search connections section",render:e=>(0,K.jsx)(N.Z,{...e,isInput:!0}),actions:[pt(e,t)]}}function qe(e){const{searchResults:t,resultsMenuProps:s}=e,i=new Set;return{key:"search initial connections section",render:e=>(0,K.jsx)(Ge,{...e,resultsMenuProps:s}),actions:[..."ready"===t.status?t.results.map((e=>"bot"===e.table?(e.value.integration_id&&i.add(e.value.integration_id),ht(e.value)):kt(e)?(0,be.F6)()&&!(0,be.SG)()?void 0:yt(e.value):ft(e.value))).filter(X.$K):"loading"===t.status?[mt()]:[gt()]]}}function Ge(e){window.__c={n:"IntegrationSearchResultsSection"};const{resultsMenuProps:t,...s}=e,n=(0,i.useRef)(null),a=(0,i.useCallback)((()=>{var e;const t=null===(e=n.current)||void 0===e||null===(e=e.querySelector('[role="menuitem"]'))||void 0===e?void 0:e.clientHeight,s=window.innerHeight<600?3:7;n.current&&t&&(n.current.style.maxHeight=s*t+.5*t+"px")}),[]);return(0,i.useEffect)((()=>(a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)})),[a]),(0,K.jsx)(Ze.Z,{...t,innerRef:n,children:(0,K.jsx)(N.Z,{...s,isInput:!0,topBorder:!1,style:{margin:0,paddingTop:0,paddingBottom:0}})})}function He(e){const{searchResults:t,resultsMenuProps:s}=e;let i=[];return i="error"===t.status?[gt()]:"loading"===t.status?[mt()]:"ready"===t.status&&t.results.length>0?t.results.map((e=>e.table===J.cZ?ht(e.value):kt(e)?(0,be.F6)()&&!(0,be.SG)()?void 0:yt(e.value):ft(e.value))).filter(X.$K):[{key:"connections search error",displayName:$e.default.formatMessage(ct.connectionNoSearchResultsLabel),analyticsName:ct.connectionNoSearchResultsLabel.defaultMessage,searchName:ct.connectionNoSearchResultsLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ut],render:e=>(0,K.jsx)(ge.Z,{title:$e.default.formatMessage(ct.connectionNoSearchResultsLabel)}),action:()=>{}}],{key:"connections search results",render:e=>(0,K.jsx)(Ge,{...e,resultsMenuProps:s}),actions:i}}function Qe(e,t){const s=e,i=!(0,be.F6)()||(0,be.SG)();return{key:"manage connections section",render:t=>(0,K.jsx)(N.Z,{...t,style:{marginTop:e?6:0}}),actions:[...!s&&i?[yt(t)]:[],{key:"manage connections",displayName:$e.default.formatMessage(ct.manageConnectionsLabel),analyticsName:ct.manageConnectionsLabel.defaultMessage,searchName:ct.manageConnectionsLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,Ye.ff(Ye.tq)],render:e=>(0,K.jsx)(L.Z,{...e,title:$e.default.formatMessage(ct.manageConnectionsLabel),svg:te.H}),action:()=>{et.r$({currentTab:"connected_apps",openedFrom:"topbar"})}}]}}var Ye=s(19037),$e=s(33929),Je=s(76463),Xe=s(47307),et=s(91376),tt=s(76464),st=s(99405),it=s(95477),nt=s(91924),at=s(47839),ot=s(15356),rt=s(9953);const lt=(0,r.defineMessages)({somethingWentWrong:{defaultMessage:"Something went wrong.",id:"slackActions.dialogError.loginWithSlack.errorMessage"},titleMessage:{defaultMessage:"Slack login",id:"slackActions.loginPopupModal.title"},removeIntegrationMessage:{id:"slackIntegrationButton.removeIntegrationConfirmationDialog.prompt",defaultMessage:"Are you sure you want to remove Slack integration?"},removeIntegrationConfirmationLabel:{id:"slackIntegrationButton.removeIntegrationConfirmationDialog.removeButton.label",defaultMessage:"Remove"}});const dt=async e=>{let{environment:t,blockId:s,intl:i}=e;w.McA(t),await async function(e){const{environment:t,blockId:s,intl:i}=e,n=(0,nt.eC)(t);let a=(0,st.GD)(it.default.domainBaseUrl,{blockId:s,authType:n,userId:t.currentUser.id});if(a=n.redirectToAuth?a:await(0,nt.HU)(t,a),t.device.isElectron)return void at.openExternalUrl(a);const o=await ot.M(t,{width:530,height:530,url:a,titleMessage:lt.titleMessage});if(!o)return void Xe.showErrorMessage(i.formatMessage(lt.somethingWentWrong));const r=(0,st.Wj)({url:o,isMobile:t.device.isMobile,baseUrl:it.default.domainBaseUrl,publicDomainName:it.default.publicDomainName,protocol:it.default.protocol,currentUrl:window.location.href});"slackAuthCallback"===r.name&&R.handleSlackAuthCallback({route:r,environment:t})}({environment:t,blockId:s,intl:i})},ct=(0,r.defineMessages)({connectionLoadingLabel:{id:"topbar.connectionsSection.connectionLoading.label",defaultMessage:"Connections loading…"},connectionSearchPlaceholderLabel:{id:"topbar.connectionsSection.topbarMoreConnectionsSubMenu.label",defaultMessage:"Search for connections..."},connectionSearchErrorLabel:{id:"topbar.connectionsSection.connectionSearchError.label",defaultMessage:"Something went wrong"},connectionNoSearchResultsLabel:{id:"topbar.connectionsSection.noSearchResults.label",defaultMessage:"No results"},connectionSearchResultLabel:{id:"topbar.connectionsSection.connectionSearchResult.label",defaultMessage:"{name}"},slackEmptyLabel:{id:"topbar.connectionSection.slackEmpty.label",defaultMessage:"Slack"},slackConnectedLabel:{id:"topbar.connectionSection.slackConnected.label",defaultMessage:"Connected to Slack channel"},manageConnectionsLabel:{id:"topbar.connectionsSection.manageConnections.label",defaultMessage:"Manage connections"},addConnectionsLabel:{id:"topbar.connectionsSection.addConnections.label",defaultMessage:"Add connections"},fromParentPageLabel:{id:"topbar.connectionsSection.fromParenPage.label",defaultMessage:"From"},capabilitiesLabel:{id:"topbar.connectionsSection.capabilities.label",defaultMessage:"Capabilities"},disconnectLabel:{id:"topbar.connectionSection.disconnectIntegration.label",defaultMessage:"Disconnect"},disconnectConfirmationLabel:{id:"topbar.connectionSection.disconnectIntegrationConfirmation.label",defaultMessage:"{botName} will be removed from this page and all child pages. Continue?"},restrictionLabel:{id:"topbar.connectionSection.restrictIntegration.label",defaultMessage:"Restrict"},restrictionConfirmationLabel:{id:"topbar.connectionSection.restrictIntegrationConfirmation.label",defaultMessage:"Are you sure you want to remove this permission and restrict access? This page will no longer share settings from the parent page."},restrictionAcceptLabel:{id:"topbar.connectionSection.restrictAccept.label",defaultMessage:"Restrict access"},connectionLabel:{id:"topbar.connectionSection.connectionIntegration.label",defaultMessage:"{connectionName}"},connectionBotConfirmlabel:{id:"topbar.connectionSection.connectBotConfirmation.label",defaultMessage:"{botName} will have access to this and all child pages. Continue?"},connectionIntegrationConfirmlabel:{id:"topbar.connectionSection.connectIntegrationConfirmation.label",defaultMessage:"{integrationName} is developed by a third party partner and you will be redirected outside of Notion to authorize this connection. Continue?"}}),ut=Ye.ff(Ye.xD([Ye.tq,Ye.ff(Ye.xD([Ye.zz,Ye.J5]))]));function mt(){return{key:"connections loading",displayName:$e.default.formatMessage(ct.connectionLoadingLabel),analyticsName:ct.connectionLoadingLabel.defaultMessage,searchName:ct.connectionLoadingLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ut],render:e=>(0,K.jsx)(pe.Z,{...e,icon:(0,K.jsx)(me.Z,{}),title:$e.default.formatMessage(ct.connectionLoadingLabel)}),action:()=>{}}}function pt(e,t){return{key:"search connections input",analyticsName:ct.connectionSearchPlaceholderLabel.defaultMessage,displayName:$e.default.formatMessage(ct.connectionSearchPlaceholderLabel),searchName:ct.connectionSearchPlaceholderLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ut],render:()=>(0,K.jsx)(ue.ZP,{value:e,onChange:e=>t(e.target.value),placeholder:$e.default.formatMessage(ct.connectionSearchPlaceholderLabel),focus:!0}),action:()=>{}}}function gt(){return{key:"connections search error",displayName:$e.default.formatMessage(ct.connectionSearchErrorLabel),analyticsName:ct.connectionSearchErrorLabel.defaultMessage,searchName:ct.connectionSearchErrorLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ut],render:e=>(0,K.jsx)(ge.Z,{title:$e.default.formatMessage(ct.connectionSearchErrorLabel)}),action:()=>{}}}function ht(e){const{id:t,name:s}=e,i=$e.default.formatMessage(ct.connectionSearchResultLabel,{name:s});return{key:`${t}`,displayName:i,analyticsName:i,searchName:s,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ut],render:(t,s)=>(0,K.jsx)(ce,{...t,bot:e,focused:t.focused,onClick:async()=>{await wt(s.blocks[0],s.environment,e)},ref:t.ref}),action:async t=>{await wt(t.blocks[0],t.environment,e)}}}function ft(e){const{id:t,name:s,info:i}=e,n=$e.default.formatMessage(ct.connectionLabel,{connectionName:s});return{key:`${t}`,displayName:n,analyticsName:n,searchName:s,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ut,Ye.ff(Ye.tq)],render:e=>(0,K.jsx)(re.Z,{...e,title:n,icon:(0,K.jsx)("img",{src:i.icon,style:{width:18,height:"auto"},ref:e.ref})}),action:async t=>{let{environment:s}=t;e.id!==ie.T0&&await async function(e,t){const{id:s,name:i}=e,n=await Xe.confirmUserAction({message:$e.default.formatMessage(ct.connectionIntegrationConfirmlabel,{integrationName:i})}),a=(0,se.E)(s,i);n&&R.navigateToExternalURL({environment:t,url:a,targetSelf:!1})}(e,s)}}}function yt(e){const t=$e.default.formatMessage(ct.slackEmptyLabel);return{key:"slack empty",displayName:t,analyticsName:ct.slackEmptyLabel.defaultMessage,searchName:t,closeParentMenu:!0,validators:[Ye.Gg,Ye.J5,Ye.YP,Ye.tJ,Ye.OF,Ye.ff(Ye.Fx)],render:s=>(0,K.jsx)(U.Z,{placement:U.Z.Placement.Left,render:i=>(0,K.jsx)(re.Z,{...(0,E.Z)(i,s),title:t,icon:(0,K.jsx)("img",{src:e.info.icon,style:{height:18}})}),renderTooltip:Ce}),action:e=>{var t;dt({environment:e.environment,blockId:null===(t=e.blocks)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.id,intl:$e.default.getIntl()})}}}function xt(){const e=$e.default.formatMessage(ct.slackConnectedLabel);return{key:"slack connected inherited",displayName:e,analyticsName:ct.slackConnectedLabel.defaultMessage,searchName:e,closeParentMenu:!0,validators:[Ye.Gg,Ye.J5,Ye.ur,Ye.ff(Ye.Fx)],render:(e,t,s)=>(0,K.jsx)(Te,{blockStore:t.blocks[0],...e}),action:e=>{}}}function vt(){const e=$e.default.formatMessage(ct.slackConnectedLabel);return{key:"slack connected on block",displayName:e,analyticsName:ct.slackConnectedLabel.defaultMessage,searchName:e,closeParentMenu:!0,validators:[Ye.Gg,Ye.J5,Ye.Rd,Ye.ff(Ye.Fx)],render:(e,t,s)=>(0,K.jsx)(Ie,{blockStore:t.blocks[0],...e}),action:e=>{const{slackIntegrationStore:t}=(0,be.Jk)(e.blocks[0]);((e,t,s)=>{Xe.showDialog({message:s.formatMessage(lt.removeIntegrationMessage),showCancel:!0,keepFocus:!0,items:[{label:s.formatMessage(lt.removeIntegrationConfirmationLabel),color:"red",onAccept:()=>{w.Uut(e),B.createAndCommit({userAction:"slackActions.handleRemoveSlackIntegration",environment:e,perform:e=>{rt.sW({store:t,data:{enabled:!1},transaction:e})}})}}]})})(e.environment,t,$e.default.getIntl())}}}function St(e){const t=$e.default.formatMessage(ct.fromParentPageLabel);return{key:"from parent page",displayName:t,analyticsName:t,searchName:t,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:()=>{},render:(t,s)=>{let{blocks:i}=s;const n=i[0],a=We.G.createChildStore(n,{table:ne.iU,id:e.blockId});return(0,K.jsx)(Ct,{parentBlockStore:a})}}}function bt(e){const t=$e.default.formatMessage(ct.capabilitiesLabel);return{key:"capabilities",displayName:t,analyticsName:t,searchName:t,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:()=>{},render:()=>(0,K.jsx)(ye._,{role:e})}}function Mt(e,t){const s=$e.default.formatMessage(ct.disconnectLabel);return{key:"disconnect integration",displayName:s,analyticsName:s,searchName:ct.disconnectLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:async s=>{let{blocks:i,environment:n}=s;const a=i[0];await async function(e,t,s,i){await Xe.confirmUserAction({message:$e.default.formatMessage(ct.disconnectConfirmationLabel,{botName:i})})&&Je.RN({botId:s,store:e,environment:t})}(a,n,e,t)},render:e=>(0,K.jsx)(L.Z,{...e,svg:ee.f,title:s,focused:!0})}}function jt(e){const t=$e.default.formatMessage(ct.disconnectLabel),s=$e.default.formatMessage(ct.restrictionLabel);return{key:"restrict page from permission model",displayName:s,analyticsName:s,searchName:ct.restrictionLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:async t=>{let{blocks:s,environment:i}=t;const n=s[0];await async function(e,t,s){if(await Xe.confirmUserAction({message:$e.default.formatMessage(ct.restrictionConfirmationLabel),acceptLabel:$e.default.formatMessage(ct.restrictionAcceptLabel)})){const i={type:"bot_permission",role:"none",bot_id:e};B.createAndCommit({userAction:"TopbarMoreConnections.restrictPagePermissions",environment:s,perform:e=>{tt.Pk({environment:s,store:t,permissionItem:i,shouldInherit:!0,transaction:e})}})}}(e,n,i)},render:e=>(0,K.jsx)(L.Z,{...e,svg:ee.f,title:t,focused:!0})}}async function wt(e,t,s){await Xe.confirmUserAction({message:$e.default.formatMessage(ct.connectionBotConfirmlabel,{botName:s.name})})&&Je.v2({botValue:s,store:e,environment:t})}function Ct(e){window.__c={n:"FromParentPageMenuItem"};const{parentBlockStore:t}=e,s=(0,a.VK)((()=>t.getIcon()),[t]),l=(0,a.VK)((()=>t.isEmptyPage()),[t]),c=(0,n.O7)(),u=(0,o.Fg)(),[m,p]=(0,i.useState)("transparent"),g=c.device.isMobile?{fontSize:14,paddingLeft:4}:{fontSize:12,paddingLeft:4};return(0,K.jsx)(ge.Z,{...e,title:(0,K.jsxs)("span",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[(0,K.jsx)(r.FormattedMessage,{id:"topbar.connectionSection.parentPage.label",defaultMessage:"From"}),(0,K.jsxs)("span",{style:{display:"flex",alignItems:"center",padding:2,borderRadius:2,marginLeft:2,cursor:"pointer",backgroundColor:m,color:u.regularTextColor,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},onClick:()=>{R.navigateToBlock({environment:c,store:t,pageVisitSource:d.tY.LinkInPage})},onMouseEnter:()=>{p(u.selectLightGray[100])},onMouseLeave:()=>{p("transparent")},onMouseDown:()=>{p(u.selectLightGray[200])},onMouseUp:()=>{p(u.selectLightGray[100])},children:[(0,K.jsx)(he.Z,{disabled:!0,icon:s,isEmptyPage:l,size:12,style:{margin:"0px 2px"}}),(0,K.jsx)(fe.Z,{store:t})]})]}),textWrapperStyle:g})}function kt(e){return"legacy_integration"===e.table&&e.value.id===ie.Cb.id}var Tt=s(67669);function It(e,t,s){const i=function(e){var t;const s=e.blocks[0],i=(0,Tt.YO)(s).filter((0,X.AO)((e=>(0,$.FB)(e.permissionItem)?{true:{...e,permissionItem:e.permissionItem}}:{false:e})));if(0===i.length)return{status:"no bots"};const n=new Map,a=null===(t=oe.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=i.map((e=>{let{from:t,permissionItem:i}=e;const o=We.t1.createChildStore(s,{table:J.cZ,id:i.bot_id,spaceId:a});if("block"===t.table)return n.set(i.bot_id,t),o})).filter(X.$K);if(o.every((e=>e.isReady()))){const t=o.filter((t=>t.isDefined()&&Boolean((0,Ve.Nq)(e.environment,t.getModel()))));if((0,Ue.Fn)(e.environment)){const e=t.map((e=>e.getIntegrationId())),s=new Set(e),i=o.filter((e=>!(!e.isDefined()||s.has(e.getIntegrationId())||!Boolean((0,Ve.f_)(e.getModel()))||(s.add(e.getIntegrationId()),0))));t.push(...i)}return{status:"ready",botStores:t,botIdToSharedPageIds:n}}return{status:"loading"}}(e),{status:n}=i;if("no bots"===n||"loading"===n)return i;{const{botStores:e,botIdToSharedPageIds:n}=i;return{status:"ready",botActions:e.map((e=>{if(e.isDefined()){const i=e.getIntegrationId();i&&t.add(i);const a=n.get(e.id);if(a)return s.add(e.id),function(e){const{botStore:t,botPermissionSourcePage:s}=e,{id:i}=t,n=t.getName(),a=$e.default.formatMessage(ct.connectionLabel,{connectionName:n});return{key:`${i}`,displayName:a,analyticsName:a,searchName:a,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:()=>{},render:(e,i,n)=>{const o=i.blocks[0].id===s.blockId;return(0,K.jsx)(Re,{...e,context:i,parent:n,isSharedDirectly:o,botStore:t,botPermissionSourcePage:s,originConnectionLabel:a})}}}({botStore:e,botPermissionSourcePage:a})}})).filter(X.$K)}}}function Pt(e){const t=new Set,s=new Set,i=It(e,t,s),n=function(e,t){const s=$e.default.formatMessage(ct.addConnectionsLabel);return{key:"add connections action",displayName:s,analyticsName:ct.addConnectionsLabel.defaultMessage,searchName:ct.addConnectionsLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ut],action:()=>{},render:(i,n,a)=>(0,K.jsx)(Ke,{...i,context:n,parent:a,alreadyConnectedIntegrationIds:e,alreadyConnectedBotIds:t,originButtonLabel:s})}}(t,s);if("no bots"===i.status)return{loadingAction:[],connectedActions:[],searchSubMenu:n};if("loading"===i.status)return{loadingAction:[mt()],connectedActions:[],searchSubMenu:n};{const{botActions:e}=i;return{loadingAction:[],connectedActions:e,searchSubMenu:n}}}function _t(e){const{loadingAction:t,connectedActions:s,searchSubMenu:i}=Pt(e);return{key:"topbar connections",render:e=>(0,K.jsx)(N.Z,{...e,topBorder:!0,title:(0,K.jsx)(r.FormattedMessage,{id:"topbar.connectionSection.label",defaultMessage:"Connections"})}),actions:[...t,...[xt(),vt()],...s,i]}}var Zt=s(64536),Ft=s(42115),At=s(28020),Rt=s(68821),Dt=s(78316),Bt=s(77181),Lt=s(21969),Nt=s(41984),Ot=s(24764),Et=s(36896),Vt=s(44604),Ut=s(886),Wt=s(77080),Kt=s(47593),zt=s(30496),qt=s(92083),Gt=s(34583),Ht=s(41363),Qt=s(29768),Yt=s(62967),$t=s(42784),Jt=s(71247),Xt=s(34658),es=s(24212),ts=s(81267),ss=s(5337),is=s(63029);const ns=(0,r.defineMessages)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fontStyleSection:{id:"action.section.fontStyle",defaultMessage:"Style"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},unlockPageName:{id:"action.unlockPageName.name",defaultMessage:"Unlock page"},openAIAssistant:{id:"action.openMobileAIAssistant.name",defaultMessage:"Open AI Assistant"},openinMacAppName:{id:"action.openinMacApp.name",defaultMessage:"Open in Mac app"},openinWindowsAppName:{id:"action.openinWindowsApp.name",defaultMessage:"Open in Windows app"},openiniOSAppName:{id:"action.openiniOSApp.name",defaultMessage:"Open in iOS app"},openinAndroidAppName:{id:"action.openinAndroidApp.name",defaultMessage:"Open in Android app"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"Page history"},showDeletedPagesName:{id:"action.showDeletedPages.name",defaultMessage:"Show deleted pages"},importName:{id:"action.import.name",defaultMessage:"Import"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"}});function as(e){return(0,Yt.cN)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[Ye.or([Ye.ff(Ye.YG),Ye.f7]),Ye.J5],render:(t,s,i)=>{const n=s.blocks[0].getFormat().page_font,a=e.font===n||!e.font&&!n;return(0,K.jsx)(q,{...t,isActive:a,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption})},closeParentMenu:!1,action:(t,s)=>{let{blocks:i,environment:n}=t;B.createAndCommit({userAction:"actionRegistry.createFontAction",environment:n,perform:t=>{_.FH({stores:i,update:{page_font:e.font},transaction:t}),w.G14(n,{type:e.font||"default"})}})}})}const os=as({displayName:ns.fontDefaultName,caption:(0,K.jsx)(r.FormattedMessage,{...ns.fontDefaultCaption}),font:void 0,tooltip:(0,K.jsx)(r.FormattedMessage,{...ns.fontDefaultTooltip}),style:{fontSize:24,fontFamily:j.Z.getCompositeFontFamily(l.SP).sans,position:"relative",top:-2}}),rs=as({displayName:ns.fontSerifName,caption:(0,K.jsx)(r.FormattedMessage,{...ns.fontSerifCaption}),font:"serif",tooltip:(0,K.jsx)(r.FormattedMessage,{...ns.fontSerifTooltip}),style:{fontSize:25,fontFamily:j.Z.getCompositeFontFamily(l.SP).serif}}),ls=as({displayName:ns.fontMonoName,caption:(0,K.jsx)(r.FormattedMessage,{...ns.fontMonoCaption}),font:"mono",tooltip:(0,K.jsx)(r.FormattedMessage,{...ns.fontMonoTooltip}),style:{fontSize:26,fontFamily:j.Z.getCompositeFontFamily(l.SP).mono,position:"relative",top:-3,letterSpacing:-1}}),ds=(0,Yt.$J)({key:"font section",title:ns.fontStyleSection,render:e=>(0,K.jsx)(Y,{...e}),actions:[os,rs,ls]}),cs=(0,Yt.wL)({key:"small text",displayName:ns.fontSmallTextKeywords,label:$e.default.formatMessage(ns.fontSmallTextLabel),property:"page_small_text",validators:[Ye.ff(Ye.tq),Ye.or([Ye.ff(Ye.YG),Ye.f7]),Ye.J5],afterAction:(e,t)=>w.DRv(t,{type:e?"small":"large"})}),us=(0,Yt.wL)({key:"full width",displayName:ns.fullWidthLabel,label:$e.default.formatMessage(ns.fullWidthLabel),property:"page_full_width",validators:[Ye.ff(Ye.Mn),Ye.ff(Ye.YG),Ye.J5],afterAction:(e,t)=>w.LDb(t,{type:e?"full_width":"default_width"})}),ms=(0,Yt.$J)({key:"page style",render:e=>(0,K.jsx)(N.Z,{...e}),actions:[cs,us]}),ps=(0,Yt.cN)({key:"customize page",displayName:ns.customizePageLabel,analyticsName:ns.customizePageLabel.defaultMessage,svg:m.F,validators:[Ye.U_,Ye.ff(Ye.YG)],closeParentMenu:!0,render:e=>(0,K.jsx)(L.Z,{...e,title:(0,K.jsx)(r.FormattedMessage,{...ns.customizePageLabel}),svg:m.F}),action:e=>{T.bA({originRect:e.originRect})}}),gs=(0,Yt.cN)({key:"page lock",displayName:ns.lockPageName,analyticsName:ns.lockPageName.defaultMessage,svg:y.b,validators:[Ye.ff(Ye.YG),Ye.J5,Ye.ff(Ye.p1)],closeParentMenu:!1,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=s[0];F.bo({environment:i,store:n,lock:!0})}}),hs=(0,Yt.cN)({key:"page unlock",displayName:ns.unlockPageName,analyticsName:ns.unlockPageName.defaultMessage,svg:S.U,validators:[Ye.ff(Ye.YG),Ye.J5,Ye.p1],closeParentMenu:!1,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=s[0];F.bo({environment:i,store:n,lock:!1})}}),fs=(0,Yt.cs)({key:"copy link to block non-desktop",displayName:Yt.RE.copyLinkNavigableTypeName,analyticsName:Yt.RE.copyLinkNavigableTypeName.defaultMessage,svg:f.N,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[Ye.jl,Ye.U7,Ye.ff(Ye.d)],closeParentMenu:!0,action:(e,t)=>{C.Hs({...e,event:t})}}),ys=(0,Yt.cs)({key:"duplicate",displayName:Yt.RE.duplicateName,analyticsName:Yt.RE.duplicateName.defaultMessage,svg:p.a,validators:[Ye.DF,Ye.J5,Ye.KE,Ye.xk,Ye.ff(Ye.P9(c.Ti.externalObjectInstancePage))],shortcuts:["duplicate"],closeParentMenu:!0,action:async e=>{let{environment:t}=e;const s=At.np();if(!s)return;const i=s.getParentCollectionStore();if(i&&Gt.M_(t)){const e=new Ut.Z(t);e.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:i});Wt.default.checkGate("collection_subitem_nested_operations")&&(0,Bt.wP)(s,e)?await k.h5({environment:t,blocks:[s],collectionContextStore:e}):B.createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:t,perform:e=>{const[n,a]=I.Qi({environment:t,stores:[s],addCopyName:(0,Nt.Z)(s),transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!s.isInsideTemplate(),targetSpaceId:(0,M.C)(i.pointer.spaceId),baseUrl:it.default.domainBaseUrl,publicDomainName:it.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:!1}),o=n[0];A.zw({childStore:o,parentStore:i,transaction:e}),s.isTemplate()&&Z.R3({parent:i.getTemplatePagesStore(),append:o,transaction:e}),R.navigateToBlock({environment:t,store:o,pageVisitSource:d.tY.Duplicate})}})}}}),xs=(0,Yt.cN)({key:"open in mac app",displayName:ns.openinMacAppName,analyticsName:ns.openinMacAppName.defaultMessage,svg:x.h,validators:[Ye.U7,Ye.ff(Ye.tY),Ye.ff(Ye.tq),Ye.V5],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=(0,Se.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});R.openInNativeApp({url:(0,Lt.W)(n),environment:i})}}),vs=(0,Yt.cN)({key:"open in windows app",displayName:ns.openinWindowsAppName,analyticsName:ns.openinWindowsAppName.defaultMessage,svg:x.h,validators:[Ye.U7,Ye.ff(Ye.tY),Ye.ff(Ye.tq),Ye.ED],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=(0,Se.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});R.openInNativeApp({url:(0,Lt.W)(n),environment:i})}}),Ss=(0,Yt.cN)({key:"open in ios app",displayName:ns.openiniOSAppName,analyticsName:ns.openiniOSAppName.defaultMessage,svg:x.h,validators:[Ye.U7,Ye.ff(Ye.tY),Ye.gn],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=(0,Se.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});R.openInNativeApp({url:n,environment:i})}}),bs=(0,Yt.cN)({key:"open in android app",displayName:ns.openinAndroidAppName,analyticsName:ns.openinAndroidAppName.defaultMessage,svg:x.h,validators:[Ye.U7,Ye.ff(Ye.tY),Ye.Dt],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=(0,Se.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});R.openInNativeApp({url:n,environment:i})}}),Ms=(0,Yt.cN)({key:"open page updates",analyticsName:"Open page updates",displayName:ns.pageUpdates,svg:u.t,validators:[Ye.RF,Ye.tq],closeParentMenu:!0,action:()=>{zt.Z.setState({open:!0})}}),js=(0,Yt.cN)({key:"action page history",displayName:ns.pageHistoryName,analyticsName:ns.pageHistoryName.defaultMessage,svg:b.w,validators:[Ye.or([Ye._T,Ye.k5]),Ye.Gg,Ye.DF,Ye.jl,Ye.ff(Ye.YO)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;return D.jN({environment:t,blockStore:s[0],from:"topbar"})},render:(e,t)=>{let{onClick:s,key:i,...n}=e,{environment:a}=t;return(0,K.jsx)(Ft.Z,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:s,alwaysAllowClick:!0,render:(e,t)=>(0,K.jsx)(L.Z,{...(0,E.Z)(n,e),title:$e.default.formatMessage(ns.pageHistoryName),svg:b.w,dontShrinkRight:!0,right:t}),renderUpgradeTooltip:()=>{}},i)}}),ws=(0,Yt.cN)({key:"open page trash",displayName:ns.showDeletedPagesName,analyticsName:ns.showDeletedPagesName.defaultMessage,svg:v.u,validators:[Ye.DF,Ye.J5,Ye.oY,Ye.jl,Ye.ff(Ye.nJ)],closeParentMenu:!0,action:()=>{Et.Z.setState({open:!0}),Vt.Z.setState({...Vt.Z.state,currentTab:"in_current_page"})}}),Cs=(0,Yt.$J)({key:"pageHistory",render:e=>(0,K.jsx)(N.Z,{...e}),actions:[Ms,is.Yw,js,Zt.pageAnalyticsMenu,ws,es.Op]}),ks=(0,Yt.cN)({key:"open import modal",displayName:ns.importName,analyticsName:ns.importName.defaultMessage,svg:h.l,validators:[Ye.Gg,Ye.YZ,Ye.J5,Ye.ff(Ye.YG),Ye.ff(Ye.P9(c.Ti.externalObjectInstancePage))],closeParentMenu:!0,action:e=>{let{blocks:t}=e;(0,Rt.c)()?qt.Z.setState({...qt.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}):Kt.Z.setState({open:!0,pageStore:t[0]})}}),Ts=(0,Yt.cN)({key:"export block",displayName:ns.exportName,analyticsName:ns.exportName.defaultMessage,validators:[Ye.Gg,Ye.jl,Ye.Kb],closeParentMenu:!0,render:e=>(0,K.jsx)(L.Z,{...e,svg:g.R,title:(0,K.jsx)(r.FormattedMessage,{...ns.exportName}),caption:(0,K.jsx)(r.FormattedMessage,{...ns.exportCaption})}),action:e=>{let{blocks:t,environment:s}=e;const i=t[0];if(!i.isDefined())return;let n=!0;const a=(0,Dt.fm)(t[0]);if(a){const e=null==a?void 0:a.collectionStore();null!=e&&e.isPageTreeCollection()&&(n=!1)}P.q$({environment:s,root:{id:i.id,table:"block",spaceId:i.getSpaceId()},isCollectionViewExportTypeSupported:n})}});var Is=s(18514),Ps=s(13713),_s=s(83182),Zs=s(939),Fs=s.n(Zs),As=s(49427);class Rs extends G.Z{constructor(){super(...arguments),this.wordCount=0}willMount(){this.wordCount=function(e){const t=As.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return Fs()(e.innerText)}return 0}(this.props.store)}renderComponent(){return(0,K.jsx)(i.Fragment,{children:this.wordCount})}}Rs.displayName="PageWordCount";const Ds=Rs;function Bs(e){window.__c={n:"TopbarMoreMenu"};const{blockStore:t,onClickOriginRect:s,handleAccept:i,handleDismiss:l}=e,d=(0,n.O7)(),c=(0,n.Fy)(),m=(0,a.VK)((()=>({environment:d,blocks:[t],originRect:s,publicEditMode:void 0})),[d,t,s]),p=(0,a.VK)((()=>function(e){const{environment:t,context:s}=e,i=s.blocks[0],n=i.getFollowSettingsKey(),a=Wt.default.checkGate("property_updates_notifications"),o=(0,r.defineMessages)({getNotifiedFor:{defaultMessage:"Get notified",id:"topbar.moreButton.getNotified"}}),l=a?Ot.CA({followSettingsKey:n,environment:t,blockStore:i,from:"more_menu"}):Ot.Zk({followSettingsKey:n,environment:t,blockStore:i,from:"more_menu"});return[ds,ms,$t.ww,(0,Yt.$J)({key:"topbar move or turn into actions",render:e=>(0,K.jsx)(N.Z,{...e}),actions:[ss.bV,Jt.A]}),(0,Yt.$J)({key:"topbar database edit lock",render:e=>(0,K.jsx)(N.Z,{...e}),actions:[Ht.cO,Ht.YZ,Ht.Bj,Ht.BC,Ht.fK,Ht.MR,ss.R$]}),(0,Yt.$J)({key:"topbar page edit lock",render:e=>(0,K.jsx)(N.Z,{...e}),actions:[ps,gs,hs]}),(0,Yt.$J)({key:"topbar primary actions",render:e=>(0,K.jsx)(N.Z,{...e}),actions:[Ht.q6,es.hS,(0,Yt.MV)({key:"get notified for",displayName:o.getNotifiedFor,analyticsName:o.getNotifiedFor.defaultMessage,svg:u.t,width:300,initialFocus:l.findIndex((e=>e.isSelectedOption))??0,validators:[],subActions:()=>[(0,Yt.$J)({key:"get notified for",render:e=>(0,K.jsx)(N.Z,{...e}),actions:l.map((e=>{let{action:t}=e;return t}))})]}),is.aU,fs,ys,...(0,Qt.jW)()?[Qt.m7,Qt.nh]:[Qt.gl],...(0,Qt.jW)()?[Qt.fI,Qt.MI]:[Qt.DN],Xt.Jw,xs,vs,Ss,bs,ts.l,Ht.GZ]}),Cs,(0,Yt.$J)({key:"topbar import actions",render:e=>(0,K.jsx)(N.Z,{...e}),actions:[ks,Ts,Ht.mS]}),_t(s)]}({environment:d,context:m})),[d,m]),g=(0,a.VK)((()=>!t.isCollectionView()&&t.canEdit()&&t.hasContent()),[t]),h=(0,a.VK)((()=>t.canEdit()),[t]),f=(0,a.VK)((()=>t.canEdit()&&t.isCollectionView()),[t]),y=(0,o.yK)((e=>({caption:{color:e.lightTextColor}})),[]),x=c.isMobile?{menuType:H.og.Modal,title:(0,K.jsx)(r.FormattedMessage,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),right:(0,K.jsx)(Fe.DoneMenuText,{}),onClickRight:l}:{menuType:H.og.Popup,maxHeight:"80vh"};return(0,K.jsxs)(Ze.Z,{...x,children:[(0,K.jsx)(_e.Z,{sections:p,onAccept:i,context:m}),(g||h)&&(0,K.jsxs)(N.Z,{topBorder:!0,children:[g&&(0,K.jsx)(pe.Z,{caption:(0,K.jsx)("span",{style:y.caption,children:(0,K.jsx)(r.FormattedMessage,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,K.jsx)(Ds,{store:t})}})})}),h&&(0,K.jsx)(Ps.Z,{store:t,isPageMoreButton:!0})]}),f&&(0,K.jsx)(Ls,{})]})}function Ls(){return(0,K.jsx)(N.Z,{topBorder:!0,children:(0,K.jsx)(_s.Z,{title:(0,K.jsx)(r.FormattedMessage,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,Is.UY)("guides.database"),analyticsFrom:"topbar_more_button"})})}},64536:(e,t,s)=>{s.r(t),s.d(t,{PageAnalyticsPageOptOut:()=>I,TopbarPageAnalyticsOptOutMenu:()=>T,TopbarPageAnalyticsOptOutMenuStore:()=>k,pageAnalyticsMenu:()=>C});s(67294);var i=s(480),n=s(86628),a=s(49085),o=s(83176),r=s(18442),l=s(31412),d=s(62967),c=s(97627),u=s(19037),m=s(18514),p=s(74948),g=s(36391),h=s(80444),f=s(73420),y=s(53437),x=s(72495),v=s(42402),S=s(55422),b=s(60526),M=s(85893);const j=(0,l.defineMessages)({pageAnalyticsName:{id:"action.pageAnalytics.name",defaultMessage:"Page analytics"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},privacySettingsName:{id:"action.privacySettings.name",defaultMessage:"Privacy settings"}}),w=e=>{const t=e.blocks[0];if(!t)return!1;return(0,b.W2)({canEditPage:t.canEdit(),device:e.environment.device})},C=(0,d.MV)({key:"page analytics menu",displayName:j.pageAnalyticsName,analyticsName:j.pageAnalyticsName.defaultMessage,validators:[u.DF],svg:o.z,subActions:e=>[{key:"view analytics",render:e=>(0,M.jsx)(x.Z,{...e}),actions:[(0,d.cN)({key:"view analytics",displayName:j.viewAnalyticsName,analyticsName:j.viewAnalyticsName.defaultMessage,svg:o.z,validators:[w],closeParentMenu:!0,action:()=>{p.handleSidebarButtonClick(e.environment,e.blocks[0],g.gY.Updates,"more_menu"),g.ZP.setState({...g.ZP.state,currentSubTab:g.uF.Analytics})}}),(0,d.cN)({key:"privacy settings",displayName:j.privacySettingsName,analyticsName:j.privacySettingsName.defaultMessage,svg:r.H,validators:[],closeParentMenu:!0,action:e=>{k.setState({isOpen:!0,rect:e.originRect})}})]}]}),k=a.default.createValue({isOpen:!1,rect:void 0}),T=()=>{window.__c={n:"TopbarPageAnalyticsOptOutMenu"};const e=(0,i.O7)(),t=(0,n.VK)((()=>k.state.isOpen),[]),s=(0,n.VK)((()=>k.state.rect),[]),a=(0,n.VK)((()=>h.default.state.mainEditorCurrentBlockStore),[]);return a?(0,M.jsx)(y.ZP,{popupType:e.device.isMobile?y.ZP.PopupType.SlideUp:y.ZP.PopupType.Popup,alignmentToOrigin:y.ZP.Alignment.Center,open:t,render:()=>(0,M.jsx)("div",{style:{minWidth:360,padding:16},children:(0,M.jsxs)(f.sg,{gap:16,children:[(0,M.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,M.jsx)(l.FormattedMessage,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,M.jsx)(I,{store:a})]})}),originRect:s,onDismiss:()=>k.setState({isOpen:!1,rect:void 0})}):null};function I(e){window.__c={n:"PageAnalyticsPageOptOut"};const t=(0,i.O7)(),s=(0,n.VK)((()=>{const e=h.default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),a=(0,n.VK)((()=>{const t=null==s?void 0:s.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[s,e.store.id]);return(0,M.jsx)(S.Z,{type:"dropdown",currentOption:a?"do_not_record":"record",options:[{key:"record",label:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:s=>{"do_not_record"===s?c.kY(t,e.store.id):c.pu(t,e.store.id)},isMobile:t.device.isMobile,title:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,M.jsx)(v.Z,{external:!0,href:(0,m.UY)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},70268:(e,t,s)=>{s.d(t,{B:()=>o});s(67294);var i=s(24405),n=s(36596),a=s(85893);function o(e){window.__c={n:"UpdateSidebarLoadingSkeleton"};let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const s=(0,i.yK)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),o=[...Array(t)].map(((e,t)=>(0,a.jsxs)("div",{style:s.skeletonSection,children:[(0,a.jsx)(n.Z,{style:s.skeletonCircle}),(0,a.jsxs)("div",{style:{width:"80%"},children:[(0,a.jsx)(n.Z,{style:{width:"80%",...s.skeletonRect,marginTop:0}}),(0,a.jsx)(n.Z,{style:{width:"50%",...s.skeletonRect}}),(0,a.jsx)(n.Z,{style:{width:"60%",...s.skeletonRect}}),(0,a.jsx)(n.Z,{style:{width:"50%",...s.skeletonRect}})]})]},t)));return(0,a.jsx)("div",{children:o})}},6175:(e,t,s)=>{s.d(t,{Z:()=>d});var i=s(67294),n=s(24405),a=s(97880),o=s(55797),r=s(85893);function l(e){return e.src?(0,r.jsx)("img",{style:e.style,src:e.src}):null}const d=i.forwardRef(((e,t)=>{window.__c={n:"VimeoVideoPlayer"};const s=(0,n.Fg)(),d=i.useRef(e);d.current=e,i.useEffect((()=>{const t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",document.body.appendChild(t);const s=window.Vimeo;if(!s)return()=>{};const i=document.getElementById(e.src),n=new s.Player(i);return n?(n.on("play",(e=>{var t,s;null===(t=(s=d.current).onPlay)||void 0===t||t.call(s,e)})),n.on("pause",(e=>{var t,s;null===(t=(s=d.current).onPause)||void 0===t||t.call(s,e)})),n.on("ended",(e=>{var t,s;null===(t=(s=d.current).onEnd)||void 0===t||t.call(s,e)})),()=>{n.off("play"),n.off("pause"),n.off("ended")}):()=>{}}),[e.src,d.current.src]);const c=function(e,t){const s=(0,a.qP)(t).flatMap((e=>{let[t,s]=e;return`${t}=${s}`})).join("&");return`${e}&${s}`}(d.current.src,{texttrack:d.current.defaultTextTrack,playsinline:!1,...d.current.options}),u={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:12,border:`1px solid ${s.tableDividerColor}`};return(0,r.jsxs)(o.Z,{ratio:d.current.aspectRatioOverride??9/16,children:[(0,r.jsx)(l,{style:u,src:d.current.preloadThumbnailSrc}),(0,r.jsx)("iframe",{ref:t,id:d.current.src,className:d.current.className,allowFullScreen:!0,src:c,style:{...u,...d.current.style}})]})}))},56282:(e,t,s)=>{s.d(t,{Z:()=>w});s(67294);var i=s(73935),n=s(83355),a=s(13991),o=s(6740),r=s(49085),l=s(12137),d=s(8848),c=s(22491),u=s(72126),m=s(82990),p=s(63143),g=s(31412),h=s(24677),f=s(31792),y=s(27724);class x extends r.default{getInitialState(){return{showFadeInAnimation:!1,isRepositioning:!1}}}const v=x;var S=s(23063),b=s(6685),M=s(85893);class j extends n.Z{constructor(){super(...arguments),this.storeTypes={focusStore:r.default.createClass(!1),mouseStore:f.Z,withImageRepositioningStore:v},this.renderDraggable=()=>(0,M.jsx)(b.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disabled:!this.isRepositioning(),render:e=>(0,M.jsx)("div",{...(0,c.iv)(this.getDragContainerStyle()),...e,children:this.props.render({imagePosition:this.getRenderedCoverPosition(),isRepositioning:this.isRepositioning(),showFadeInAnimation:!1})})}),this.shouldBeActiveStore=this.createComputedStore((()=>0===y.default.state.stores.length)),this.handleFocus=e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=e=>{this.stores.focusStore.setState(!1)},this.handleMouseMove=e=>{this.mouseStore.setState({...this.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{this.mouseStore.setState({...this.mouseStore.state,mouseEntered:!1})},this.handleMouseMoveThrottled=(0,u.P2)(this.handleMouseMove,100),this.handleMouseLeaveDebounced=(0,u.Ds)(this.handleMouseLeave,100),this.handleWindowMouseDown=e=>{const t=i.findDOMNode(this);t&&!t.contains(e.target)&&this.isRepositioning()&&this.props.onFlushTemporaryPosition({imagePosition:this.getRenderedCoverPosition(),reset:()=>{this.mouseStore.reset(),this.stores.withImageRepositioningStore.reset()}})},this.handleRepositionClick=(e,t)=>{h.ZH(this.environment);const s=new Image;s.onload=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,isRepositioning:!0,image:s})},t&&(s.src=t)},this.handleCancelClick=e=>{this.stores.withImageRepositioningStore.reset()},this.handleSavePositionClick=e=>{this.props.onFlushTemporaryPosition({imagePosition:this.getRenderedCoverPosition(),reset:()=>{this.stores.withImageRepositioningStore.reset()}})},this.handleDragStart=e=>{const t=this.isRepositioning(),{image:s}=this.stores.withImageRepositioningStore.state;if(s&&t){const e=i.findDOMNode(this);if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/s.width*s.height,i=this.getRenderedCoverPosition();this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:t,startDragRenderedPosition:i})}}},this.handleDragMove=e=>{if(this.isRepositioning()){const{startDragRenderedPosition:t,startDragImageScreenHeight:s}=this.stores.withImageRepositioningStore.state,i=e.diffY/(s||0)+(t||0);this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,temporaryPosition:(0,u.NM)((0,l.Z)(i,0,1),4)})}},this.handleDragEnd=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})},this.handleDragCancel=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})}}didMount(){super.didMount(),window.addEventListener("mousedown",this.handleWindowMouseDown)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown)}willMountOrUpdate(){this.isRepositioning()&&!this.shouldBeActiveStore.state&&this.stores.withImageRepositioningStore.reset()}renderComponent(){const{device:e}=this.environment,{style:t}=this.props,{isMobile:s}=e,i=this.isRepositioning(),{mouseEntered:n}=this.mouseStore.state,a=this.stores.focusStore.state;return(0,M.jsxs)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseEnter:this.handleMouseMoveThrottled,onMouseMove:this.handleMouseMoveThrottled,onMouseLeave:this.handleMouseLeaveDebounced,...(0,c.iv)({position:"relative",width:"100%"},t),children:[this.renderDraggable(),this.renderDragMessage(),this.props.renderControl({handleRepositionClick:this.handleRepositionClick,handleSavePositionClick:this.handleSavePositionClick,handleCancelClick:this.handleCancelClick,isVisible:s||n||a||i,isRepositioning:i})]})}renderDragMessage(){const{isRepositioning:e}=this.stores.withImageRepositioningStore.state;if(!this.props.small)return(0,M.jsx)(S.Z,{isVisible:!0,animationStyle:{opacity:e?1:0},render:()=>{return(0,M.jsx)("div",{...(0,c.iv)((t=this.props.dragMessageContainerStyle,{background:d.ZP.blackWithAlpha(.4),borderRadius:4,color:d.ZP.white,fontSize:12,fontFamily:m.Z.getCompositeFontFamily(a.SP).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center",...t??{}})),"aria-hidden":!e,children:(0,M.jsx)(g.FormattedMessage,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})});var t}})}isRepositioning(){return this.stores.withImageRepositioningStore.state.isRepositioning}getRenderedCoverPosition(){const{temporaryPosition:e}=this.stores.withImageRepositioningStore.state;return(0,u.hj)(e)?e:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,u.hj)(e))return e}const s=.5;if(t.isCollectionView()){const e=t.getCollectionViewCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,p.z4)(t)?s:t}}const i=t.getFormat().page_cover_position;if((0,u.hj)(i))return i;return s}(this.props.source,this.props.store)}get mouseStore(){return this.props.mouseStore||this.stores.mouseStore}getDragContainerStyle(){return{width:"100%",cursor:this.isRepositioning()?"move":"inherit"}}}j.displayName="WithImageRepositioning";const w=j},79649:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(64275),l=s(26139),d=s(82990),c=s(31412),u=s(75018),m=s(37181),p=s(18514),g=s(38755),h=s(80444),f=s(77080),y=s(92083),x=s(66309),v=s(42922),S=s(64921),b=s(61519),M=s(64369),j=(s(57658),s(41892)),w=s(8848);var C=s(90403),k=s(85893);function T(){window.__c={n:"ImageCarousel"};const[e,t]=(0,i.useState)(0),s=(0,i.useRef)(null),n=(0,o.Fg)(),a=function(e){return(0,o.yK)((t=>({container:{position:"relative",margin:"24px auto",textAlign:"center"},imageContainer:{position:"relative",height:280,borderRadius:8,overflow:"hidden",background:"dark"===t.mode?"#1D1B16":"#E3E2E0"},image:{height:280,width:497},caption:{fontWeight:d.Z.fontWeight.regular},navigation:{display:"flex",alignItems:"center",justifyContent:"center",gap:0,margin:"12px auto 8px"},activeDot:{background:t.regularTextColor},dot:{borderRadius:"100%",background:t.buttonPressedBackground,height:14,width:14,cursor:"pointer",border:`4px solid ${t.sidebarBackground}`},progress:{background:t.buttonPressedBackground,height:3,position:"absolute",left:0,right:0,bottom:0,transform:"translateX(-100%)",transition:`transform ${e}ms linear`}})),[e])}(5e3),{reset:r}=function(e,t){const s=(0,i.useRef)(),n=(0,i.useRef)(null),[a,o]=(0,i.useState)(t),r=(0,i.useCallback)((()=>o((e=>null===e?t:null))),[t]);function l(){var e;null===(e=s.current)||void 0===e||e.call(s)}const d=(0,i.useCallback)((()=>{n.current&&clearInterval(n.current)}),[]),c=(0,i.useCallback)((()=>{d(),n.current=setInterval(l,t)}),[d,t]);return(0,i.useEffect)((()=>{s.current=e}),[e]),(0,i.useEffect)((()=>(n.current&&clearInterval(n.current),null!==a&&(n.current=setInterval(l,a)),d)),[a,d]),{toggle:r,clear:d,reset:c}}((()=>{t((e=>(e+1)%P.length))}),5e3),l=(0,i.useCallback)((e=>{t(e%P.length),r()}),[r]),c=(0,i.useMemo)((()=>P[e%P.length]),[e]),u=(0,i.useMemo)((()=>{const t=[];for(let s=0;s<P.length;s++){const i=e===s?{...a.dot,...a.activeDot}:a.dot,n=(0,k.jsx)("div",{style:i,onClick:()=>l(s)});t.push(n)}return t}),[e,a,l]);return(0,i.useEffect)((()=>{s.current&&(s.current.style.transform="translateX(0)")}),[e]),(0,k.jsxs)("div",{style:a.container,children:[(0,k.jsxs)("div",{style:a.imageContainer,children:[(0,k.jsx)("img",{src:"dark"===n.mode?c.imageSrcDark:c.imageSrcLight,style:a.image,className:"notion-fadein-slow"},`img-${e}`),(0,k.jsx)("div",{ref:s,style:a.progress},`progress-${e}`)]}),(0,k.jsx)("div",{style:a.navigation,children:u}),(0,k.jsx)("div",{style:a.caption,className:"notion-fadein-slow",children:c.caption},`txt-${e}`)]})}function I(){window.__c={n:"AdminConsoleCaption"};const e=(0,o.yK)((e=>({textContainer:{display:"flex",alignItems:"center",justifyContent:"center",gap:4},badge:{fontWeight:d.Z.fontWeight.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?w.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content"}})),[]);return(0,k.jsxs)(M.Z,{style:e.textContainer,children:[(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Organization level controls",id:"enterpriseLaunchModal.imageScene.revampedAdminConsole"}),(0,k.jsx)(C.Z,{style:e.badge,content:(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Coming soon",id:"enterpriseLaunchModal.imageScene.comingSoon"})})]})}const P=[{imageSrcLight:j.Z.images.enterpriseModal.managedUsersLightPng,imageSrcDark:j.Z.images.enterpriseModal.managedUsersDarkPng,caption:(0,k.jsx)(M.Z,{children:(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Managed users dashboard & controls",id:"enterpriseLaunchModal.imageScene.managedUsers"})})},{imageSrcLight:j.Z.images.enterpriseModal.securityLightPng,imageSrcDark:j.Z.images.enterpriseModal.securityDarkPng,caption:(0,k.jsx)(M.Z,{children:(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Security & compliance integrations",id:"enterpriseLaunchModal.imageScene.securityAndComplianceIntegrations"})})},{imageSrcLight:j.Z.images.enterpriseModal.organizationsLightPng,imageSrcDark:j.Z.images.enterpriseModal.organizationsDarkPng,caption:(0,k.jsx)(I,{})}];const _=(0,c.injectIntl)((function(e){window.__c={n:"EnterpriseLaunchModal"};const t=(0,n.O7)(),s=(0,o.yK)((e=>({container:{maxWidth:560,padding:24},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:18,height:18},closeButtonHovered:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.mediumTextColor},title:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",fontWeight:d.Z.fontWeight.semibold,fontSize:28,lineHeight:"30px",maxWidth:400,margin:"4px auto 16px",textAlign:"center"},captionContainer:{width:"100%"},caption:{textAlign:"center",margin:"0 auto",padding:"0 12px 0"},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5,marginLeft:-24,width:"calc(100% + 48px)"},learnMoreContainer:{paddingTop:24,width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},learnMoreButton:{margin:"0 auto",gap:4},externalLinkIcon:{width:18}})),[]),j=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e}=h.default.state;e&&m.Kq(t,{phase:"dismissed_modal",transactionUserAction:"EnterpriseLaunchModal.debug.clickCancel",userSettingsStore:e})}),[t]),w=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e}=h.default.state;if(!e)return;const s=(0,p.UY)("blog.enterpriseLaunch");u.navigateToExternalURL({environment:t,url:s}),m.Kq(t,{phase:"dismissed_completely",transactionUserAction:"EnterpriseLaunchModal.debug.clickLearnMore",userSettingsStore:e})}),[t]),C=(0,a.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:s,mainEditorCurrentBlockStore:i,inAppCalloutStore:n}=h.default.state;if(!n.canShow("enterprise_launch_promo"))return!1;if(t.device.isMobile)return!1;if(!e||!e.isReady())return!1;const a=e.getSettings();return!!a&&(!!(s&&i&&i.canRead())&&(!y.Z.state.open&&(!(!s.canAdmin()||!(0,g.j9)(s))&&!(void 0!==a.enterprise_launch_modal_phase||!f.default.checkGate("enterprise_launch_modal")))))}),[t.device]);return t.device.isMobile?null:(0,k.jsx)(x.default,{shouldShow:C,calloutId:"enterprise_launch_promo",desktopRenderInner:()=>(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(S.Z,{onClick:j,style:s.closeButton,hoveredStyle:s.closeButtonHovered,children:(0,r.D)(s.closeIcon)}),(0,k.jsx)(M.Z,{isMultiline:!0,style:s.title,children:(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Meet the improved{br}Enterprise experience",id:"enterpriseLaunchModal.title",values:{br:(0,k.jsx)("br",{})}})}),(0,k.jsx)("div",{style:s.captionContainer,children:(0,k.jsx)(M.Z,{isSecondaryColor:!0,isMultiline:!0,style:s.caption,children:(0,k.jsx)(c.FormattedMessage,{defaultMessage:"The connected workspace people love is now easier to implement and checks all your admin, security & compliance needs",id:"enterpriseLaunchModal.caption"})})}),(0,k.jsx)(T,{}),(0,k.jsx)(b.Z,{size:1,style:s.divider}),(0,k.jsx)("div",{style:s.learnMoreContainer,children:(0,k.jsxs)(v.Z,{style:s.learnMoreButton,onClick:w,isLarge:!0,children:[(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Learn more",id:"enterpriseLaunchModal.learnMore"}),(0,l.K)(s.externalLinkIcon)]})})]}),desktopInnerStyle:s.container,desktopOnDismiss:j,phoneRenderInner:()=>null})}))},457:(e,t,s)=>{s.d(t,{Z:()=>c});s(67294);var i=s(13991),n=s(24405),a=s(8848),o=s(1799),r=s(97880),l=s(82990),d=s(85893);function c(e){window.__c={n:"MFABackupCodes"};const{type:t}=e,s=(0,n.yK)((e=>({pane:{display:"flex",whiteSpace:"pre-line",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:4,backgroundColor:a.FN.light.yellow[50],paddingTop:8,paddingBottom:8,marginBottom:10},textCode:{fontFamily:l.Z.getHeaderFontFamily({pageFont:"mono",locale:i.SP}),fontWeight:l.Z.fontWeight.regular,fontSize:l.Z.fontSize.UIRegular.desktop,font:l.Z.baseFontFamily.emailMono,color:a.FN.light.brown[500],textAlign:"center"},redactedBackupCode:{textDecoration:"line-through",opacity:.2}})),[]);return(0,d.jsx)("div",{style:s.pane,children:(0,d.jsx)("div",{style:s.textCode,children:"status"===t?e.status.map(((e,t)=>(0,d.jsx)("div",{style:e.hasBeenUsed?s.redactedBackupCode:{},children:o.A},t))):"unencryptedCodes"===t?e.backupCodes.map(o.K).join("\n"):(0,r.t1)(t)})})}},56839:(e,t,s)=>{s.d(t,{R$:()=>g,ZP:()=>h});var i=s(67294),n=s(24405),a=s(72126),o=s(82990),r=s(31412),l=s(18514),d=s(68785),c=s(88175),u=s(73602),m=s(11898),p=s(85893);const g=6;function h(e){let{isLoading:t,phoneNumber:s,errorMessage:o,resentStatus:h,resentAt:y,onDismiss:x,onBack:v,onVerifyCode:S,onResendLink:b}=e;window.__c={n:"MFAPromptSMSVerification"};const M=(0,n.yK)(f,[]),[j,w]=(0,i.useState)([]),C=(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeTitle",defaultMessage:"Verify phone number"}),k=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeHeader.default",defaultMessage:"Enter the code sent to {phoneNumber} to complete setup.",values:{phoneNumber:s}})," ",(0,p.jsx)(u.y,{resentAt:y,resentStatus:h,onResendLink:b})]}),T={text:t?(0,p.jsx)(d.Z,{}):(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>S(j.join("")),disabled:t||"resending"===h||(0,a.oA)(j).length!==g},I=[{text:(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeNeedHelp",defaultMessage:"Need help?"}),href:(0,l.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return(0,p.jsx)(c.Z,{title:C,header:k,errorMessage:o,primaryAction:T,secondaryActions:I,onDismiss:x,onBack:v,disableBackButton:t,children:(0,p.jsx)("div",{style:M.body,children:(0,p.jsx)(m.ZP,{numInputs:g,format:"settings",disabled:!1,value:j,onChange:w,autoFocus:!0,isValidKey:m.rN})})})}function f(e){return(0,n.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:o.Z.fontWeight.medium,fontSize:o.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},18469:(e,t,s)=>{s.d(t,{R$:()=>p,ZP:()=>g});var i=s(67294),n=s(24405),a=s(72126),o=s(82990),r=s(31412),l=s(18514),d=s(68785),c=s(88175),u=s(11898),m=s(85893);const p=6;function g(e){let{isLoading:t,errorMessage:s,onDismiss:o,onBack:g,onVerifyCode:f}=e;window.__c={n:"MFAPromptTOTPVerification"};const y=(0,n.yK)(h,[]),[x,v]=(0,i.useState)([]),S=(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeTitle",defaultMessage:"Verify code"}),b=(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeHeader",defaultMessage:"Enter the one-time code from authenticator to complete setup."}),M={text:t?(0,m.jsx)(d.Z,{}):(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>f(x.join("")),disabled:t||(0,a.oA)(x).length!==p},j=[{text:(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.needHelp",defaultMessage:"Need help?"}),href:(0,l.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return(0,m.jsx)(c.Z,{title:S,header:b,errorMessage:s,primaryAction:M,secondaryActions:j,onDismiss:o,onBack:g,disableBackButton:t,children:(0,m.jsx)("div",{style:y.body,children:(0,m.jsx)(u.ZP,{numInputs:p,format:"settings",disabled:t,value:x,onChange:e=>{v(e)},autoFocus:!0,isValidKey:u.rN})})})}function h(e){return(0,n.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:o.Z.fontWeight.medium,fontSize:o.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},67579:(e,t,s)=>{s.d(t,{f:()=>y});var i=s(67294),n=s(24405),a=s(69651),o=s(73123),r=s(33929),l=s(87279),d=s(33338),c=s(52275),u=s(78140),m=s(32163),p=s(53437),g=s(72495),h=s(91642),f=s(85893);function y(e){window.__c={n:"DateFilter"};const t=(0,n.yK)((e=>({popup:{width:125,marginLeft:5},pillStyle:{display:"flex",alignItems:"center"}})),[]),{currentFilter:s,hideAllTime:y}=e,[x,v]=(0,i.useState)(!1),S=o.Hz.filter((e=>!y||"all_time"!==e)).map((t=>{const s=()=>{e.onChangeFilter(t),v(!1)};return{key:t,action:()=>{},render:()=>(0,f.jsx)(c.Z,{focused:!1,onClick:s,title:r.default.formatMessage(o.Rh[t])})}})),b=(0,f.jsx)(d.Z,{on:Boolean(s),wrapStyle:t.pillStyle,icon:(0,a.C)({width:16,marginRight:6,fill:"currentColor"}),title:r.default.formatMessage(o.Rh[s]),onClick:()=>{v(!0)}}),M=[{key:"filters",items:S,render:e=>(0,f.jsx)(g.Z,{...e,title:null,loading:!1})}],j=(0,f.jsx)(u.Z,{menuType:l.og.Popup,header:null,children:(0,f.jsx)(m.Z,{type:m.i.Vertical,initialFocus:0,sections:M})});return(0,f.jsx)(h.Z,{marginAfter:!1,children:(0,f.jsx)(p.ZP,{popupType:p.ZP.PopupType.Popup,placementToOrigin:p.ZP.Placement.Bottom,alignmentToOrigin:p.ZP.Alignment.Start,open:x,render:()=>j,onDismiss:()=>v(!1),keepFocus:!0,origin:b,preventScaleTransition:!0,style:t.popup})})}},88898:(e,t,s)=>{s.d(t,{O:()=>L});var i=s(67294),n=s(480),a=s(24405),o=s(53877),r=s(42875),l=s(19889),d=s(4308),c=s(50906),u=s(87279),m=s(78140),p=s(40721),g=s(13148),h=s(31412),f=s(52275),y=s(72495),x=s(85893);function v(e){const{onClick:t}=e;return(0,x.jsx)(y.Z,{topBorder:!0,children:(0,x.jsx)(f.Z,{focused:!1,icon:(0,g.U)({width:14,marginLeft:0}),title:(0,x.jsx)(h.FormattedMessage,{defaultMessage:"Remove verification",id:"VerificationPropertyOverlayMenu.removeVerificationButton"}),onClick:t,style:{fontSize:14}})})}var S=s(30120),b=s(86628),M=s(28020),j=s(33929),w=s(66653),C=s(93289);const k=(0,h.defineMessages)({placeholder:{id:"VerificationExpiryMenu.pickSpecificDate.placeholder",defaultMessage:"Pick a date"}});function T(e){window.__c={n:"VerificationCustomDatePicker"};const{onChange:t,clearCustomDatePicker:s}=e,n=(0,i.useRef)(e.today),a=(0,i.useRef)(e.today.plus({days:1})),[r,l]=(0,i.useState)(!1),d=(0,b.VK)((()=>M.AK.state),[]);return(0,x.jsxs)(y.Z,{mobileStyle:{paddingBottom:10},style:{padding:"12px 0"},children:[(0,x.jsx)(w.Z,{placeholder:j.default.formatMessage(k.placeholder),focused:r,value:"verified"!==e.verificationState.type||e.verificationState.isIndefinite?void 0:o.ME(e.verificationState.dateTimeRange.end),onUpdate:e=>{if(e.error)return;const i=e.value&&o.XI(e.value);i?t({start:n.current,end:i.start}):s()},onFocus:()=>l(!0),onBlur:()=>l(!1),onClearButtonClick:s,hideClearButton:!0}),(0,x.jsx)(C.Z,{firstDayOfWeek:d,value:a.current.toMillis(),selectValue:!1,onChange:e=>{t({start:n.current,end:S.ou.fromMillis(e)})},disabledDays:{before:new Date(a.current.toMillis())}})]})}var I=s(36700),P=s(69651),_=s(61768),Z=s(70693);function F(e){window.__c={n:"VerificationExpiryPickerMenu"};const{verificationState:t,onChange:s,onCustomDateClick:n}=e,o=(0,h.useIntl)(),r=(0,i.useRef)(e.today),l=(0,a.yK)((e=>({title:{fontSize:14,color:e.regularTextColor},optionsContainer:{width:"100%"},clockIconStyle:{width:14,marginLeft:0,marginTop:2}})),[]),c="expired"===t.type||"none"===t.type?(0,x.jsx)(h.FormattedMessage,{defaultMessage:"Verify page",id:"VerificationExpiryPicker.verify.header"}):(0,x.jsx)(h.FormattedMessage,{defaultMessage:"Reverify page",id:"VerificationExpiryPicker.reverify.header"}),u="verified"===t.type&&t.isIndefinite,m="verified"===t.type&&!t.isIndefinite&&t.dateTimeRange.end;return(0,x.jsxs)(y.Z,{title:c,children:[d.Xs.map((e=>{const t=m&&d.fm({start:r.current,end:m})===e;return(0,x.jsx)(f.Z,{focused:!1,icon:(0,I.m)(l.clockIconStyle),inline:!1,title:(0,x.jsx)("span",{style:l.title,children:(0,x.jsx)(h.FormattedMessage,{defaultMessage:"For {numDays} days",id:"VerificationExpiryMenu.preset.title",values:{numDays:e}})}),caption:o.formatMessage({defaultMessage:"Until {date}",id:"VerificationExpiryMenu.preset.subtitle"},{date:Z.mb({dateTime:d.z5(e,r.current).end,intl:o,shortenDateAndRange:!0})}),checkState:!!t,onClick:()=>{return t=e,void s({start:r.current,end:r.current.plus({days:t})});var t}},e)})),(0,x.jsx)(f.Z,{focused:!1,icon:(0,_.k)({width:14,marginLeft:0,marginTop:1}),inline:!1,title:(0,x.jsx)("span",{style:l.title,children:(0,x.jsx)(h.FormattedMessage,{defaultMessage:"Indefinitely",id:"VerificationExpiryPicker.option.indefinitely"})}),onClick:()=>s(),checkState:u},"indefinite"),(0,x.jsx)(f.Z,{focused:!1,icon:(0,P.C)({width:14,marginLeft:0}),title:(0,x.jsx)("span",{style:l.title,children:(0,x.jsx)(h.FormattedMessage,{defaultMessage:"Pick a date",id:"VerificationExpiryPicker.option.customDate"})}),onClick:n},"custom")]})}var A=s(66897),R=s(64369);function D(e){window.__c={n:"VerificationMetadata"};const{getRecordModel:t,actorPointer:s,lastVerifiedDate:i}=e,a=(0,n.Fy)(),o=(0,h.useIntl)(),r=(0,b.VK)((()=>(0,A.$4)(o,(0,A.Hl)({pointer:s,getRecordModel:t}))),[t,o,s]);return(0,x.jsxs)("div",{style:{padding:"8px 14px"},children:[(0,x.jsx)(R.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:a.isMobile,isMultiline:!0,style:{marginBottom:4},children:(0,x.jsx)(h.FormattedMessage,{defaultMessage:"Last verified by {user}",id:"VerificationMetadata.lastVerified",values:{user:r}})}),(0,x.jsx)(R.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:a.isMobile,children:(0,Z.mb)({dateTime:i,intl:o})})]})}var B=s(11028);function L(e){window.__c={n:"VerificationPropertyOverlayMenu"};const{verificationValue:t,getRecordModel:s,onChange:g,blockId:h,propertyName:f,onClose:y}=e,S=(0,n.O7)(),b=(0,n.Fy)(),M=(0,a.Fg)(),[j,w]=(0,i.useState)(!1),C=(0,i.useMemo)((()=>d.WN(t)),[t]),k="verified"===C.type,I=(0,i.useRef)(o.Uu((0,r.r)())),P=(0,i.useRef)(o.Uu((0,r.r)()).plus({days:1})),_=e=>{var t;const s=null===(t=S.currentUser)||void 0===t?void 0:t.id;if(!s)return;if(null!=e&&e.end&&e.end.toMillis()<P.current.toMillis())return;const i={table:l.KJ,id:s},n=e?o.OQ.toPersistedDateTimeRange(e):o.OQ.toPersistedDateTime(I.current.toMillis()),a="none"===C.type?"add":"update";c.s$$(S,{action:a,verification_page_id:h,verification_expiry:e?e.end.toMillis():void 0}),g({value:[i,n]})};let Z={menuType:u.og.Popup,footer:"none"!==C.type&&(0,x.jsx)("div",{style:{borderTop:`1px solid ${M.regularDividerColor}`},children:(0,x.jsx)(D,{lastVerifiedDate:k&&C.isIndefinite?C.startDateTime:C.dateTimeRange.start,getRecordModel:s,actorPointer:C.actorPointer})})};return b.isMobile&&(Z={...Z,title:f,menuType:u.og.Modal,right:(0,x.jsx)(p.DoneMenuText,{}),onClickRight:y}),(0,x.jsx)(m.Z,{...Z,header:!j&&"none"!==C.type&&(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{style:{padding:b.isMobile?10:7,paddingLeft:b.isMobile?20:7,background:b.isMobile?M.popoverBackground:M.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${M.regularDividerColor}`},children:(0,x.jsx)(B.z,{verificationValue:t})})}),children:j?(0,x.jsx)(T,{today:I.current,verificationState:C,onChange:e=>_(e),clearCustomDatePicker:()=>w(!1)}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(F,{today:I.current,verificationState:C,onChange:e=>_(e),onCustomDateClick:()=>w(!0)}),(k||"expired"===C.type)&&(0,x.jsx)(v,{onClick:()=>{c.s$$(S,{action:"remove",verification_page_id:h}),g({value:void 0})}})]})})}},72340:(e,t,s)=>{s.d(t,{$6:()=>o,CN:()=>n,Tc:()=>a});var i=s(77080);const n=5;function a(e){return"on"===i.default.getEligibleGroup({experimentId:"parallel_confluence_importer_via_api",defaultGroup:"control"})}function o(e){return i.default.getEligibleGroup({experimentId:"special_case_confluence_file_size",defaultGroup:n.toString()})}},8989:(e,t,s)=>{s.d(t,{b:()=>o,t:()=>a});var i=s(77080),n=s(72340);function a(){return"on"===i.default.getEligibleGroup({experimentId:"generic_importer",defaultGroup:"control"})}function o(e){const t=i.default.getEligibleGroup({experimentId:"special_case_generic_file_size",defaultGroup:n.CN.toString()});return Number(t)}},45567:(e,t,s)=>{s.d(t,{G7:()=>o,Gh:()=>l,LR:()=>a,gU:()=>r,jo:()=>n});var i=s(97880);const n="fileTypeAnyFiles",a="fileTypeImages",o="fileTypeVideos",r="fileTypeNone";function l(e){let{fileMimeType:t,allowedType:s}=e;switch(s){case n:return!0;case a:return function(e){return e.startsWith("image")&&!e.includes("photoshop")}(t);case o:return function(e){return e.startsWith("video")}(t);case r:return!1;default:(0,i.t1)(s)}}},94660:(e,t,s)=>{s.d(t,{IJ:()=>o,PL:()=>a,W4:()=>r,p8:()=>l});var i=s(62992),n=s(64002);function a(e,t){return e.filter((e=>{const s=e.getCopiedFromPointer();return Boolean(s&&(0,i.J)(s)&&Boolean(t&&t(s.id)))}))}const o=5;function r(e){const t=window.location.href;return n.SK(t,{tg:e.templateGalleryItem})}function l(){const e=window.location.href;let t;return t=n.iO(e,"tg"),t=n.iO(t,"np"),t=n.iO(t,"pjm"),t}},35314:(e,t,s)=>{s.d(t,{e:()=>o});var i=s(67294),n=s(86628),a=s(77794);function o(){const[e,t]=(0,i.useState)(0),[s]=(0,i.useState)((()=>new a.E)),o=(0,i.createRef)();return(0,i.useEffect)((()=>{o.current&&s.observe(o.current)}),[o,s]),(0,n.VK)((()=>{e!==s.rect.state.width&&t(s.rect.state.width)}),[e,s.rect]),[o,e]}},99622:(e,t,s)=>{s.d(t,{Y:()=>o});var i=s(86628),n=s(78291),a=s(88893);function o(){return(0,i.VK)((()=>a.Q6(n.default.state.data)),[])}},22508:(e,t,s)=>{s.d(t,{Co:()=>k,E6:()=>b,GZ:()=>M,TW:()=>I,Uw:()=>C,YQ:()=>w,rw:()=>j});s(57658),s(67294);var i=s(33728),n=s(7406),a=s(68626),o=s(91155),r=s(27006),l=s(4615),d=s(31412),c=s(50906),u=s(54642),m=s(76464),p=s(95209),g=s(64964),h=s(19306),f=s(26907),y=s(67669),x=s(88893),v=s(35057),S=s(85893);async function b(e){const{environment:t,onInviteComplete:s,flowId:i,intl:r,spaceStore:l,invitedUsers:d,inviteTargetsStore:u,inviteOrigin:m}=e;let p={success:!1};try{p=await w({environment:t,spaceStore:l,invitedUsers:d,from:m,flowId:i,intl:r,inviteTargetsStore:u})}catch(g){const e=(0,n.tg)(g);c.S4I(t,{invite_stage:"invite_member",invite_flow_id:i,error:e}),a.log({level:"error",from:"personPropertyInviteAction",type:"handleMemberInvite",error:(0,o.Ui)(g)})}finally{p.success&&c.pRQ(t,{invited_user_count:Object.keys(p.invitedUsers).length,invite_flow_id:i,origin:m}),null==s||s(p)}}async function M(e){const{environment:t,blockStore:s,inviteTargetsStore:d,sudoModeStore:u,onInviteComplete:p,inviteOrigin:g,role:h,emailMessage:x,flowId:v}=e;let S={success:!1};try{if(S=await async function(e){const{environment:t,blockStore:s,sudoModeStore:n,inviteTargetsStore:a,role:o,inviteOrigin:d,emailMessage:c,onInviteStart:u}=e,p=e.flowId||(0,l.ZP)();if(!(0,r.iC)(o))return{success:!1};const{tokenQuery:g,inviteTargets:h}=a.state;if((0,i.oH)(g.trim())&&0===h.length){const e={type:"newUser",value:{email:g.trim()},source:"email"};f.H({target:e,inviteTargetsStore:a})||a.setState({inviteTargets:[...a.state.inviteTargets,e],tokenQuery:""})}const x=y.mU(s,f.B({inviteTargetsStore:a}));null==u||u();return await m.n_({environment:t,store:s,sudoModeStore:n,inviteTargets:x,inviteRole:o,isOnboarding:!1,invite:{inviteFlowId:p,inviteMessage:c,inviteOrigin:d}})}({environment:t,blockStore:s,sudoModeStore:u,inviteTargetsStore:d,role:h,emailMessage:x,inviteOrigin:g,flowId:v}),!S.success)return}catch(b){const e=(0,n.tg)(b);c.S4I(t,{invite_stage:"invite_guest",invite_flow_id:v,error:e}),a.log({level:"error",from:"personPropertyInviteAction",type:"handleGuestInvite",error:(0,o.Ui)(b)})}finally{S.success&&c.ViF(t,{invited_user_count:Object.keys(S.invitedUsers).length,origin:g,invite_flow_id:v}),null==p||p(S)}return S}async function j(e){const{environment:t,spaceStore:s,originId:i,originType:o,reasonMessage:r,intl:l,flowId:d,onInviteComplete:m,invitedUsers:p,inviteOrigin:g}=e,h=[];let f={success:!1};try{const e=Object.entries(p).map((e=>{let[n,a]=e;return u.requestAccess(t,{type:"actor-to-space",forActorId:a,spaceId:s.id,message:r,attributes:{origin_id:i,origin_type:o,origin_table:"block",add_permissions_on_approval:!1}}).catch((()=>h.push([n,a])))}));await Promise.all(e),f={success:!0,invitedUsers:p,requestedUsers:{}}}catch(y){const e=(0,n.tg)(y);return c.S4I(t,{invite_stage:"request_member",invite_flow_id:d,error:e}),T(l,p),a.log({level:"error",from:"personPropertyInviteAction",type:"handleMemberRequest",data:{miscDataToConvertToString:{inviteTargetEmailsWithErrors:h}}}),f}finally{f.success&&c.TJ1(t,{invited_user_count:Object.keys(f.invitedUsers).length,origin:g,invite_flow_id:d}),null==m||m(f)}return f}async function w(e){const{environment:t,spaceStore:s,from:i,invitedUsers:n,intl:o,flowId:r,onInviteStart:l,inviteTargetsStore:d}=e,c=function(e){const t=[];if(!e)return t;for(const[s,i]of Object.entries(e))t.push({type:"existingUser",value:{id:i,email:s,version:1}});return t}(n),u=function(e){return e.state.inviteTargets.filter((e=>"newUser"===e.type))}(d),p=[...c];for(const a of u){c.some((e=>e.value.email===a.value.email))||p.push(a)}const f=(0,v.zt)(),y=f&&(0,x.o9)(f)?"editor":e.inviteRole??"read_and_write";let S={success:!1};try{null==l||l(),S=await m.n_({environment:t,store:s,inviteTargets:p,inviteRole:y,isOnboarding:!1,invite:{inviteOrigin:i,inviteFlowId:r}})}catch(b){return((e,t)=>{0!==t.length&&g.oV({label:e.formatMessage({id:"contextual_invite.contextual_invite_failure",defaultMessage:"Failed to invite to {users} as members"},{users:(0,h.W)(t.flatMap((e=>e.value.email||[])))})})})(o,p),a.log({level:"error",from:"contextualInviteHelpers",type:"inviteMembers.inviteTargets",data:{miscDataToConvertToString:{usersToInviteAsMembers:p}}}),S}return S}async function C(e){const{environment:t,inviteTargetsStore:s,allowShowEmptyError:n,personPropertyInviteStore:a}=e,o=s.state.tokenQuery;if(""===o)return void(0===s.state.inviteTargets.length&&n&&a.setState({...a.state,showEmptyError:!0}));const r=(0,i.CU)(o),l=await p.M5(t,r);let d=[];0===l.length&&(d=[{type:"invalidUser",value:{text:o}}]);const c=l.filter((e=>!f.H({inviteTargetsStore:s,target:e}))),u=[...s.state.inviteTargets,...c,...d];s.setState({...s.state,inviteTargets:u,tokenQuery:""})}function k(e){const{email:t,inviteTargetsStore:s}=e,i={type:"newUser",value:{email:t},source:"email"},n=[...s.state.inviteTargets];f.H({inviteTargetsStore:s,target:i})||n.push(i),s.setState({...s.state,inviteTargets:n})}const T=(e,t)=>{const s=Object.keys(t);0!==s.length&&g.oV({label:e.formatMessage({id:"contextual_invite.request_members_failure",defaultMessage:"Failed to request {users} to become members"},{users:(0,h.W)(s)})})};function I(e){const{success:t,invitedUserEmails:s,isRequestMember:i}=e;t?0!==s.length&&(i?g.oV({label:(0,S.jsx)(d.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage.sendMemberRequest",defaultMessage:"Successfully sent request to admin to invite {users}",values:{users:(0,h.W)(s)}})}):g.oV({label:(0,S.jsx)(d.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage",defaultMessage:"Successfully invited {users}",values:{users:(0,h.W)(s)}})})):g.oV({label:(0,S.jsx)(d.FormattedMessage,{id:"shareMenu.inviteFailure.snackbarMessage",defaultMessage:"Failed to invite {users}",values:{users:(0,h.W)(s)}})})}},7314:(e,t,s)=>{s.d(t,{Z:()=>H});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(8848),l=s(72126),d=s(31412),c=s(50906),u=s(3386),m=s(26388),p=s(7567),g=s(99273),h=s(55899),f=s(8675),y=s(22508),x=s(13394),v=(s(21703),s(27006)),S=s(82990),b=s(95209),M=s(42922),j=s(64369),w=s(44385),C=s(18168),k=s(26907),T=s(67669),I=s(53353),P=s(26781),_=s(80444),Z=s(85893);function F(e){window.__c={n:"PersonPropertyInviteButton"};const{store:t,sudoModeStore:s,personPropertyInviteStore:o,onInviteCompleteFn:r,inviteOrigin:l}=e,u=(0,n.O7)(),p=B(),g=(0,a.qz)(e.inviteTargetsStore,h.ZP),f=(0,a.VK)((()=>o.state.isLoading),[o]),S=(0,i.useCallback)((e=>{o.setState({...o.state,isLoading:e,focus:x.S.NoFocus})}),[o]),[M,j]=(0,i.useState)("member"),F=(0,a.VK)((()=>{const{emailMessage:e}=o.state;return e}),[o]),L=(0,a.VK)((()=>{const{role:e}=o.state;return e}),[o]),N=(0,d.useIntl)(),O=(0,a.VK)((()=>o.state.flowId),[o]),E=(0,a.VK)((()=>_.default.state.currentSpaceStore),[]),V=(0,a.VK)((()=>t.canEditMembership()),[t]),U=(0,a.VK)((()=>(0,k.B)({inviteTargetsStore:g})),[g]),W=(0,i.useCallback)((async()=>{await y.Uw({environment:u,inviteTargetsStore:g,personPropertyInviteStore:o,allowShowEmptyError:!0})}),[u,g,o]),K=(0,i.useCallback)((()=>{const e=(0,k.B)({inviteTargetsStore:g}),t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),s=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return T.dA(u,[...t,...s])}),[u,g]),z=(0,a.VK)((()=>K()),[K]),q=(0,a.VK)((()=>T.Z9()),[]),G=(0,I.Z)(t),H=(0,a.VK)((()=>{if(G.isGuestRequestRequired)return!1;const e=G.isStoreInTeam&&!G.teamAllowsGuests,t=!G.isStoreInTeam&&!G.spaceAllowsGuests||G.isStoreInTeam&&!G.teamAllowsGuests&&!G.spaceAllowsGuests,s=U.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&s}),[U,G]),Q=(0,a.VK)((()=>null==E?void 0:E.getRole()),[E]),Y=(0,a.VK)((()=>!(!Q||!(0,v.RN)(Q))&&!(!E||E.getDisableMembershipRequests())),[Q,E]),$=(0,a.VK)((()=>!(!Q||!(0,v.dy)(Q))||(Y||j("guest"),!1)),[Q,Y,j]),J=(0,P.S)(t),X=F.length>1e3,ee=(0,i.useCallback)((e=>{const{response:t,shouldDoCompleteFn:s,invitedUserEmails:i,isRequestMember:n}=e;t.success?s&&(c.Y7v(u,{invited_user_count:i.length,is_success:t.success,can_add_member:$,invite_option:M,origin:l,invite_flow_id:O}),y.TW({success:t.success,invitedUserEmails:i,isRequestMember:n}),S(!1),r(t)):(y.TW({success:t.success,invitedUserEmails:i}),c.Y7v(u,{invited_user_count:i.length,is_success:t.success,can_add_member:$,invite_option:M,origin:l}))}),[r,O,S,u,M,$,l]),te=(0,i.useCallback)((async e=>{const{invitedUserEmails:i,shouldDoCompleteFn:n}=e;return await y.GZ({environment:u,inviteOrigin:l,role:L,emailMessage:F,inviteTargetsStore:g,blockStore:t,sudoModeStore:s,flowId:O,onInviteComplete:e=>{ee({response:e,shouldDoCompleteFn:n||!1,invitedUserEmails:i})}})}),[u,L,F,t,s,O,g,ee,l]),se=(0,i.useCallback)((async e=>{const{invitedUserEmails:t,guestInviteResponse:s,shouldDoCompleteFn:i}=e;if(!E)return null;const n=null!=s&&s.success?s.invitedUsers:void 0;await y.E6({environment:u,spaceStore:E,flowId:O,onInviteComplete:e=>{ee({response:e,shouldDoCompleteFn:i||!1,invitedUserEmails:t})},intl:N,invitedUsers:n,inviteTargetsStore:g,inviteOrigin:l})}),[E,u,O,g,N,ee,l]),ie=(0,i.useCallback)((async e=>{const{invitedUserEmails:s,guestInviteResponse:i}=e;if(!E)return null;const n=null!=i&&i.success?i.invitedUsers:void 0;n&&await y.rw({environment:u,spaceStore:E,originType:"person_property_invite",intl:N,invitedUsers:n,reasonMessage:void 0,originId:t.id,flowId:O,onInviteComplete:e=>{ee({response:e,shouldDoCompleteFn:!0,invitedUserEmails:s,isRequestMember:!0})},inviteOrigin:l})}),[u,O,E,N,ee,t,l]),ne=(0,i.useCallback)((async()=>{const e="member"===M,t=g.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email));if(0===t.length)return void c.S4I(u,{invite_stage:"click_invite_button",invite_flow_id:O,error:"No valid input emails"});const s=K();if(S(!0),e)if(s)await se({invitedUserEmails:t,guestInviteResponse:void 0,shouldDoCompleteFn:!0});else{const e=!$&&!Y,s=await te({invitedUserEmails:t,shouldDoCompleteFn:e});$?await se({invitedUserEmails:t,guestInviteResponse:s,shouldDoCompleteFn:!0}):Y&&await ie({invitedUserEmails:t,guestInviteResponse:s})}else s?c.S4I(u,{invite_stage:"click_invite_button",invite_flow_id:O,error:"Invite guest with guest limitation exceed"}):await te({invitedUserEmails:t,shouldDoCompleteFn:!0});S(!1),g.reset()}),[u,$,Y,M,O,K,g,te,se,ie,S]),ae=(0,i.useCallback)((async()=>{await W();const e=(0,k.B)({inviteTargetsStore:g}).length;c.tXe(u,{invited_user_count:e,invite_option:M,can_add_member:$,origin:l,inviteTargets:g.state.inviteTargets.map((e=>e.type.toString())),inviteTokenQuery:g.state.tokenQuery,invite_flow_id:O}),await ne()}),[u,O,W,ne,M,$,g,l]);let oe;oe=H?J:X?(0,Z.jsx)(d.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0;const re=(0,i.useMemo)((()=>[{key:"member",render:()=>(0,Z.jsx)(m.Z,{disableTooltip:$||Y,renderTooltip:()=>(0,Z.jsx)(d.FormattedMessage,{id:"invite.person_property.invite_member.tooltip",defaultMessage:"You do not have permission to add or request members to this workspace"}),render:e=>(0,Z.jsx)(D,{isSelected:"member"===M,inviteOption:"member",events:e})}),isDisabled:!$&&!Y},{key:"guest",render:()=>(0,Z.jsx)(m.Z,{disableTooltip:!z&&q,renderTooltip:()=>(0,Z.jsx)(w.e,{}),render:e=>(0,Z.jsx)(D,{isSelected:"guest"===M,inviteOption:"guest",events:e})})}]),[M,z,q,Y,$]);return(0,Z.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,Z.jsx)("div",{style:p.section,children:(0,Z.jsx)(C.Z,{items:re,itemStyle:p.itemStyle,innerStyle:p.innerStyle,value:M,onChange:e=>{j(e),c.Iow(u,{invite_option:e,invite_flow_id:O,origin:l})}})}),!z&&q||"guest"!==M?(0,Z.jsx)(R,{tooltip:oe,disabled:!V||H||X,onClick:ae,isLoading:f}):(0,Z.jsx)(A,{onClick:()=>{c.ZAW(u,{invited_user_count:U.length,invite_flow_id:O,origin:l}),b.Vu({environment:u,upgradeButtonName:"user_permission_item"})}})]})}function A(e){const{onClick:t}=e;return(0,Z.jsx)(m.Z,{disableTooltip:!1,renderTooltip:()=>(0,Z.jsx)(w.e,{}),render:e=>(0,Z.jsx)(M.Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},onClick:t,...e,children:(0,Z.jsx)(d.FormattedMessage,{id:"invite.person_property.upgrade",defaultMessage:"Upgrade"})})})}function R(e){const{tooltip:t,disabled:s,onClick:i,isLoading:n}=e;return(0,Z.jsx)(m.Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,Z.jsx)(M.Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},disabled:s,onClick:i,...e,isLoading:n,children:(0,Z.jsx)(d.FormattedMessage,{id:"invite.person_property.invite",defaultMessage:"Invite"})})})}function D(e){window.__c={n:"InviteOptionBox"};const{isSelected:t,inviteOption:s,events:i}=e,n=B(),a=t?n.mainTextSelected:n.mainTextUnselected;let o,r;switch(s){case"guest":o=(0,Z.jsx)(d.FormattedMessage,{id:"invite.person_property.addAsGuest.title",defaultMessage:"Add to page only"}),r=(0,Z.jsx)(d.FormattedMessage,{id:"invite.person_property.addAsGuest.subtitle",defaultMessage:"Invite as a Guest"});break;case"member":o=(0,Z.jsx)(d.FormattedMessage,{id:"invite.person_property.addAsMember.title",defaultMessage:"Add to Workspace"}),r=(0,Z.jsx)(d.FormattedMessage,{id:"invite.person_property.addAsMember.subtitle",defaultMessage:"Invite and bill as a Member"});break;default:throw new Error(`Unsupported invite option: ${s}`)}return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)("div",{style:n.row,...i,children:(0,Z.jsxs)("div",{style:a,children:[o,(0,Z.jsx)(j.Z,{isSmall:!0,style:n.optionSubtitle,children:r})]})})})}function B(){return(0,o.yK)((e=>({mainTextSelected:{fontWeight:S.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14,lineHeight:"14px"},mainTextUnselected:{color:e.mediumTextColor,fontSize:14,lineHeight:"14px"},row:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,lineHeight:"14px"},section:{padding:"16px 11px 16px 11px"},itemStyle:{margin:5,borderRadius:8,borderWidth:2},innerStyle:{borderWidth:0},optionSubtitle:{whiteSpace:"pre-wrap",paddingTop:2,fontSize:12}})),[])}var L=s(80721),N=s(73063);function O(e){let{handleBackButtonClick:t}=e;window.__c={n:"PersonPropertyInviteHeader"};const s=(0,o.yK)((()=>({container:{display:"flex",margin:"0 12px 0px",height:40}})),[]);return(0,Z.jsx)("div",{style:s.container,children:(0,Z.jsx)(E,{onClick:t})})}function E(e){window.__c={n:"BackButton"};const{onClick:t}=e,s=(0,d.useIntl)(),i=(0,o.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:S.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:S.Z.fontWeight.medium}})),[]);return(0,Z.jsxs)("div",{style:i.topContainer,children:[(0,Z.jsx)(N.Z,{icon:L.W,iconStyle:i.arrowIcon,style:i.iconButton,onClick:t,ariaLabel:s.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,Z.jsx)(j.Z,{style:i.sendInviteLabel,children:(0,Z.jsx)(d.FormattedMessage,{id:"invite.person_property.popup_title",defaultMessage:"Invite and mention"})})]})}var V=s(94044),U=s(74194),W=s(19306);const K=l.Ds((e=>{let{environment:t,flowId:s,origin:i}=e;c.KZ(t,{origin:i,invite_flow_id:s})}),1e3);function z(e){window.__c={n:"PersonPropertyInviteMessageInput"};const{inviteTargetsStore:t,personPropertyInviteStore:s,inviteOrigin:o}=e,r=(0,n.O7)(),{focus:l,emailMessage:d}=(0,a.VK)((()=>{const{focus:e,emailMessage:t}=s.state;return{focus:e,emailMessage:t}}),[s]),c=(0,a.VK)((()=>s.state.flowId),[s]),u=(0,i.useCallback)((()=>{t.reset()}),[t]),m=(0,i.useCallback)((e=>{s.setState({...s.state,focus:l,emailMessage:e.target.value}),K({environment:r,flowId:c,origin:o})}),[r,s,c,o,l]),p=(0,i.useCallback)((()=>{u()}),[u]),g=(0,i.useCallback)((()=>{s.setState({...s.state,focus:x.S.MessageInput,emailMessage:d})}),[s,d]);return(0,Z.jsx)(q,{focus:l===x.S.MessageInput,value:d,onFocus:g,onChange:m,onCancel:p,maxLength:1e3,inviteTargetsStore:t})}function q(e){window.__c={n:"EmailMessageInput"};const{focus:t,value:s,maxLength:i,inviteTargetsStore:r,onFocus:l,onChange:c,onCancel:u}=e,m=(0,d.useIntl)(),p=s.length/i>=.8,g=(0,V.TQ)(s),h=p||g,f=(0,n.Fy)(),y=(0,o.yK)((e=>({container:{maxHeight:80,bottom:0,padding:"2px 16px 2px 16px",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",overflow:"hidden",zIndex:1,height:72},input:{maxHeight:80,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:2,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s",height:"100%"},inputBox:{padding:"0px 4px 0px 4px",boxShadow:e.inputBoxShadow,background:e.inputBackground,width:"auto",height:"100%",borderRadius:6,...t&&{background:"none",boxShadow:"rgba(35, 131, 226, 0.57) 0px 0px 0px 1px inset, rgba(35, 131, 226, 0.35) 0px 0px 0px 2px"}}})),[t]),x=(0,a.VK)((()=>r.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email))),[r]),v=(0,a.VK)((()=>x.length>0?m.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.withEmails",defaultMessage:"Add a message for {users}"},{users:(0,W.W)(x)}):m.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.noEmails",defaultMessage:"Add a message to your invite..."})),[m,x]);return(0,Z.jsxs)("div",{style:y.container,children:[h&&(0,Z.jsx)(G,{value:s,maxLength:i,shouldShowLengthWarning:p,shouldShowLinkWarning:g}),(0,Z.jsx)(U.Z,{textarea:!0,focusInitial:!1,format:U.B.Transparent,placeholder:v,maxlength:i,focus:t,value:s,onFocus:l,onChange:c,inputStyle:y.input,onCancel:u,style:y.inputBox,onClick:()=>{f.isMobile||null==l||l()}})]})}function G(e){window.__c={n:"EmailMessageWarning"};const{shouldShowLengthWarning:t,shouldShowLinkWarning:s,value:i,maxLength:n}=e,a=(0,o.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,Z.jsx)("div",{style:a.container,children:(0,Z.jsxs)("div",{style:a.warning,children:[t&&(0,Z.jsx)(d.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:i.length,maxCharacters:n}}),t&&s&&" · ",s&&(0,Z.jsx)(d.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}function H(e){window.__c={n:"PersonPropertyInvitePopup"};const{store:t,handleBackButtonClick:s,onInviteCompleteFn:r,inviteTargetsStore:d,personPropertyInviteStore:c,inviteOrigin:m}=e,p=(0,a.qz)(void 0,f.Z),g=(0,n.O7)(),h=(0,i.useCallback)((async()=>{await y.Uw({environment:g,inviteTargetsStore:d,personPropertyInviteStore:c,allowShowEmptyError:!1})}),[g,d,c]),x=(0,o.yK)((()=>({container:{position:"relative",width:450,transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:500},searchBar:{paddingLeft:16,paddingRight:16,paddingBottom:16,paddingTop:16},horizontalLine:{margin:"0",color:"#E3E2E0",opacity:.3}})),[]);return(0,Z.jsx)(u.Z,{capture:!0,onLeft:l.yR,onRight:l.yR,onSelectAll:l.yR,onRedo:l.yR,onUndo:l.yR,onCut:l.yR,onCopy:l.yR,onPaste:l.yR,onKeypress:l.yR,onDelete:l.yR,onBackspace:l.yR,onTab:l.yR,onEnter:h,children:(0,Z.jsxs)("div",{style:x.container,children:[(0,Z.jsx)(O,{handleBackButtonClick:s}),(0,Z.jsx)("hr",{style:x.horizontalLine}),(0,Z.jsx)("div",{style:x.searchBar,children:(0,Z.jsx)(Q,{store:t,inviteTargetsStore:d,personPropertyInviteStore:c,inviteOrigin:m})}),(0,Z.jsx)(z,{store:t,inviteTargetsStore:d,personPropertyInviteStore:c,inviteOrigin:m}),(0,Z.jsx)("div",{children:(0,Z.jsx)(F,{store:t,inviteTargetsStore:d,sudoModeStore:p,onInviteCompleteFn:r,personPropertyInviteStore:c,inviteOrigin:m})})]})})}function Q(e){window.__c={n:"InviteSection"};const{store:t,personPropertyInviteStore:s,inviteOrigin:i}=e,l=(0,d.useIntl)(),u=(0,n.O7)(),f=(0,a.qz)(e.inviteTargetsStore,h.ZP),{focus:y,emailMessage:v}=(0,a.VK)((()=>{const{focus:e,emailMessage:t}=s.state;return{focus:e,emailMessage:t}}),[s]),{role:S,showEmptyError:b}=(0,a.VK)((()=>{const{role:e,showEmptyError:t}=s.state;return{role:e,showEmptyError:t}}),[s]),M=(0,a.VK)((()=>t.getType()),[t]),j=(0,a.VK)((()=>f.state.inviteTargets),[f]),w=(0,a.VK)((()=>s.state.flowId),[s]),C=(0,a.VK)((()=>t.canEditMembership()),[t]),k=j.length>0,T=(0,o.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:4,color:r.ZP.uiGray}})),[]);return(0,Z.jsx)(m.Z,{disableTooltip:C,renderTooltip:()=>{if(!C)return(0,Z.jsx)(d.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>(0,Z.jsx)("div",{style:{display:"flex"},...e,children:(0,Z.jsx)(g.Z,{store:t,inviteTargetsStore:f,disabled:!C,origin:i,flowId:w,focus:y===x.S.InviteInput,hideIconColorAndTooltips:!0,showEmptyError:b,onFocus:()=>{s.setState({...s.state,focus:x.S.InviteInput,emailMessage:v||""})},placeholder:l.formatMessage({id:"invite.person_property.inviteTargetsInput.placeholder",defaultMessage:"Add emails..."}),onInputChanged:()=>s.setState({...s.state,showEmptyError:!1}),right:k&&(0,Z.jsx)(p.ZP,{disabled:!C,role:S,table:"block",type:"user_permission",blockType:M,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:T.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>{s.setState({...s.state,role:e}),c.Omp(u,{invited_role:e,invite_flow_id:w,origin:i})}})})})})}},13394:(e,t,s)=>{s.d(t,{S:()=>a,Z:()=>r});var i=s(49085),n=s(4615);let a=function(e){return e.InviteInput="invite_input",e.MessageInput="message_input",e.NoFocus="no_focus",e}({});class o extends i.default{getInitialState(){return{flowId:(0,n.ZP)(),role:"editor",focus:a.InviteInput,emailMessage:"",isLoading:!1,showEmptyError:!1}}}const r=o},35868:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},36214:(e,t,s)=>{s.d(t,{FI:()=>k,sM:()=>C,vY:()=>T});s(21703);var i=s(13991),n=s(72126),a=(s(4615),s(45953)),o=(s(21202),s(15047),s(11002)),r=s(27095),l=s(73314),d=s(31412),c=s(50906),u=s(54642),m=s(9284),p=s(54532),g=s(86282),h=s(9953),f=s(4408),y=s(28014),x=s(39699),v=(s(95477),s(33929)),S=s(27249),b=s(80444),M=s(88632),j=s(77080);const w=(0,d.defineMessages)({invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnCreateTemplate:{defaultMessage:"Invalid space view data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidStorage.message"},invalidUserSettings:{defaultMessage:"Invalid user settings data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidUserSettings.message"}});async function C(e){const{environment:t,spaceViewStore:s,isPrivate:a,userSettingsStore:o,redirectData:r,userRootStore:l,planType:d,spaceJoinOrCreate:u,teamStore:p,templates:f,templateType:M,personaTeamStore:C,isNewUserOnboarding:T}=e,I=s.getSpaceStore();if(!I)throw new Error(v.default.formatMessage(w.invalidSpaceStore));let P,_=[];if(o&&I&&f&&(_=await async function(e){const{spaceStore:t,spaceViewStore:s,userSettingsStore:i,teamStore:a}=e;if(await Promise.all(n.oA([t.load(),s.load(),i.load(),null==a?void 0:a.load()])),t.canEdit()){if(!s.isDefined())throw new Error(v.default.formatMessage(w.invalidSpaceStoreOnCreateTemplate));if(!i.isDefined())throw new Error(v.default.formatMessage(w.invalidUserSettings));if(!s.getCreatedOnboardingTemplates()){return await async function(e){var t;const{environment:s,spaceStore:i,spaceViewStore:a,isPrivate:o,teamStore:r,personaTeamStore:l,templateType:d,userSettingsStore:c}=e;let u=[];if("page_template"===d&&e.templates){const t=e.templates.map((e=>r?g.rC({environment:s,item:e,isPrivate:!1,spaceStore:i,spaceViewStore:a,useMinimalTemplates:!0,teamStore:r,type:"inTeam",from:"onboarding",isOnboarding:!0}):g.rC({environment:s,item:e,isPrivate:o,spaceStore:i,spaceViewStore:a,useMinimalTemplates:!0,type:"inSpace",isOnboarding:!0})));u=n.oA(await Promise.all(t))}else"app_template"===d&&e.templates&&r&&(u=await m.installAppsInTeam({environment:s,presets:e.templates,spaceStore:i,spaceViewStore:a,teamStore:r}));const p=null===(t=c.getSettings())||void 0===t?void 0:t.persona;if(l&&p){let e=[];if(["product","marketing","sales","eng"].includes(p)){e="on"===j.default.getEligibleGroup({defaultGroup:"control",experimentId:"persona_template_truncation"})?(0,S.OJ)(p,j.default,v.default.getIntl()):(0,S.CN)(p,j.default,v.default.getIntl())}const t=e.map((e=>g.rC({environment:s,item:e,isPrivate:!1,spaceStore:i,spaceViewStore:a,useMinimalTemplates:!0,teamStore:l,type:"inTeam",from:"onboarding",isOnboarding:!0})));u=[...u,...n.oA(await Promise.all(t))]}e.templates&&e.templates.length>0&&x.createAndCommit({userAction:"spaceActions.createOnboardingTemplatesInSpace",environment:s,perform:e=>{const t={created_onboarding_templates:!0};h.sW({store:a,data:t,transaction:e})}});return u}({...e})}}return[]}({...e,spaceStore:I,userSettingsStore:o,teamStore:p,personaTeamStore:C})),o)P=await async function(e){const{environment:t,spaceStore:s,spaceViewStore:n,userSettingsStore:a,planType:o,spaceJoinOrCreate:r,isNewUserOnboarding:l}=e;if(await Promise.all([s.load(),n.load(),a.load()]),s.canEdit()){if(!n.isDefined())throw new Error(v.default.formatMessage(w.invalidSpaceStoreOnCreateTemplate));if(!a.isDefined())throw new Error(v.default.formatMessage(w.invalidUserSettings));const e=function(e,t){if(e.device.isMobile)return null;if("en-US"!==i.SP)return null;if(!t)return null;switch(j.default.getEligibleGroup({defaultGroup:"control",experimentId:"learn_notion_three_steps"})){case"on":return"learnNotionThreeSteps";case"control":return null}}(t,l);let d;if(d=e||(t.device.isMobile?"mobile":"personal"===o?"desktopPersonal":"create"===r?"desktopTeamCreate":"desktopTeamJoin"),!n.getCreatedGettingStarted())return k({environment:t,spaceStore:s,spaceViewStore:n,type:d,userSettingsStore:a});c.VUL(t,{getting_started_page_type:d,spaceId:s.id,errorType:"createdGettingStartedPageAlreadyExists"})}}({isNewUserOnboarding:T,environment:t,spaceStore:I,spaceViewStore:s,userSettingsStore:o,planType:d,spaceJoinOrCreate:u});else{const{currentUserSettingsStore:e}=b.default.state;c.VUL(t,{errorType:"userSettingsStoreNotDefined",spaceId:I.id,errorMessage:e?"currentUserSettingsStore is defined but not userSettingsStore from onboarding data":"currentUserSettingsStore is not defined as well"})}return await async function(e){const{environment:t,spaceViewStore:s,isPrivate:i,redirectData:n,userRootStore:a,templateType:o,spaceStore:r,createdTemplatePages:l,createdGettingStartedPage:d}=e;if("fork_page"===n.type){return await y.ux({environment:t,userRootStore:a,isPrivate:i,forkedPageId:n.pageId,spaceStore:r,spaceViewStore:s})}if("app_template"===o&&l.length>0){return"on"===j.default.getEligibleGroup({experimentId:"team_land_getting_started",defaultGroup:"control"})?d:l[0]}return d}({environment:t,redirectData:r,spaceViewStore:s,spaceStore:I,userRootStore:l,isPrivate:a,templateType:M,createdTemplatePages:_,createdGettingStartedPage:P})}async function k(e){const{environment:t,type:s,spaceStore:i,spaceViewStore:n,userSettingsStore:o}=e;if(!M.Z.state.online)return;const d=function(e,t){return(0,l.G)(r.S$[e],t)}(s,v.default.getIntl()).rootId,m=await u.loadBlockSubtree(t,{block:{id:d,spaceId:i.id},shallow:!1});let g;if("failed"===m.type)return void c.VUL(t,{getting_started_page_type:s,errorType:"loadBlockSubtreeFailed",spaceId:i.id,errorMessage:m.error.message,copyPageId:d});g=a.PF.create(m.data.subtreeRecordMap);const S="spaceActions.createGettingStartedPageInSpace",{performResult:b}=x.createAndCommit({userAction:S,environment:t,perform:e=>{const a=y.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,transaction:e});f.fL({environment:t,inMemoryRecordCache:a.inMemoryRecordCache,recordMap:g,debugSource:S});const r=p.K8(t,{blockId:d,inMemoryRecordCache:a.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!r)throw c.VUL(t,{getting_started_page_type:s,errorType:"createAndDuplicatePageFailed",spaceId:i.id}),new Error(v.default.formatMessage(y.sY.createAndDuplicatePageError));p.E9({environment:t,sourceBlockId:d,targetBlockPointer:a.pointer,sourceBlockSubtree:r,targetInMemoryRecordCache:a.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:a.useCrdt()});const l={},u={};return"evernote"===s?u.created_evernote_getting_started=!0:l.created_getting_started=!0,Object.keys(l).length>0&&h.sW({store:n,data:l,transaction:e}),Object.keys(u).length>0&&h.sW({store:o.getSettingsStore(),data:u,transaction:e}),a}});return c.yvO(t,{getting_started_page_type:s,getting_started_page_id:d,duplicated_from_page_id:d,duplicated_to_page_id:b.id}),b}function T(e,t){return"school"===e?(0,l.H)(P,t):"personal"===e?(0,l.H)(I,t):(0,l.H)(_,t)}const I=[o.Y.quickNoteV2,o.Y.personalHomeV2,o.Y.taskList,o.Y.journalV2,o.Y.readingListV2],P=[o.Y.classNotesV2,o.Y.cornellNotesSystemV2,o.Y.clubHomepageV2,o.Y.gradeCalculatorV2],_=[o.Y.teamMeetingNotes,o.Y.teamDocs,o.Y.teamHome,o.Y.teamTasks,o.Y.taskList]},55535:(e,t,s)=>{s.d(t,{W:()=>o,Z:()=>l});var i=s(67294),n=s(51077),a=s(85893);const o=16;function r(e){let{icon:t,style:s,size:i=o}=e;return(0,a.jsx)(n.Z,{type:"notion_icon",size:i,icon:`/icons/${t}_lightgray.svg`,largeIcon:!0,style:s})}const l=i.memo(r)},72395:(e,t,s)=>{s.d(t,{Z:()=>m});var i=s(67294),n=s(480),a=s(24405),o=s(82990),r=s(75024),l=s(94841),d=s(55535),c=s(85893);function u(e){let{children:t,title:s,icon:u,panelStyle:m,headerStyle:p,actions:g,right:h,disableRightFadeIn:f}=e;window.__c={n:"PersonalHomePanelPreview"};const[y,x]=(0,i.useState)(!1),v=(0,n.O7)(),S=Boolean(h),b=(0,a.yK)((e=>{const t=`0 0 0 1px ${e.personalHomeTileBorder}`;return{panel:{zIndex:1,position:"relative",margin:1,width:"calc(100% - 1px)",display:"flex",flexDirection:"column",background:e.personalHomeTileBackground,borderRadius:6,padding:l.A5,paddingBottom:20,boxShadow:"dark"===e.mode?t:`${t}, 0 12px 40px rgba(0, 0, 0, 0.025)`,...m},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:l.jX,marginTop:-l.A5,...p},panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,r.yv)(v,"UISmall"),fontWeight:o.Z.fontWeight.medium,color:e.text.secondary,flexShrink:0,maxWidth:S?200:"100%"},title:{...o.Z.textOverflowStyle},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:d.W,height:d.W,marginRight:8,marginTop:1},actions:{display:"flex",flexDirection:"row",paddingLeft:6,opacity:y?1:0,transition:"opacity 200ms ease-in"},right:{opacity:f||y?1:0,transition:f?"":"opacity 200ms ease-in",overflow:"hidden",marginRight:8}}}),[p,m,y,f,S,v]);return(0,c.jsxs)("div",{style:b.panel,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[(0,c.jsxs)("div",{style:b.headerContainer,children:[(0,c.jsxs)("div",{style:b.panelTitleAndIcon,children:[(0,c.jsx)("div",{style:b.panelIconContainer,children:u}),(0,c.jsx)("span",{style:b.title,children:s}),(0,c.jsx)("span",{style:b.actions,children:g})]}),S&&(0,c.jsx)("div",{style:b.right,children:h})]}),t]})}const m=i.memo(u)},14568:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(35431);class n extends i.Z{}const a=new n},31075:(e,t,s)=>{s.d(t,{i:()=>p});s(21703),s(67294);var i=s(26825),n=s(31412),a=s(50906),o=s(47307),r=s(76464),l=s(39699),d=s(64369),c=s(18878),u=s(18245),m=s(85893);async function p(e){const{oldPermissionItem:t,newPermissionItem:s,wasInherited:p,environment:g,store:h,sudoModeStore:f,restrictingVisibility:y,fromPermissionWrapper:x}=e;if(!(0,i.Kf)(t,s))throw new Error("Permission type mismatch.");const v=!!f&&f.shouldSaveTransactionWithSudoMode(h),S=(0,i.nl)(t.role,s.role);if(p&&S!==s.role||y)return void(await async function(e){const{environment:t,useSudoMode:s,store:i,permissionItem:a,fromPermissionWrapper:u}=e,p="none"===a.role?{type:"remove",permissionItem:a}:{type:"restrict"},g="user_permission"===a.type&&a.user_id===t.currentUser.id;(g||await o.confirmUserAction({message:(0,c.mX)(p),acceptLabel:(0,c.nH)(p),cancelLabel:(0,m.jsx)(n.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,m.jsx)(d.Z,{isSmall:!0,isMultiline:!0,children:(0,m.jsx)(n.FormattedMessage,{id:"restrictedPermissionConfirmationModal.footer.whisperText",defaultMessage:"Admins will still be able to restore permissions from restricted pages."})})}))&&l.createAndCommit({userAction:"PermissionItem.onAccept",environment:t,useSudoMode:s,perform:e=>{r.Pk({environment:t,store:i,permissionItem:a,shouldInherit:!0,transaction:e,fromPermissionWrapper:u})}})}({environment:g,useSudoMode:v,store:h,permissionItem:s,fromPermissionWrapper:x}));!h.isTopLevel()&&t.role!==s.role&&S!==t.role&&a.SMF(g),l.createAndCommit({userAction:"PermissionItem.handlePermissionItemChange",environment:g,useSudoMode:v,perform:t=>{const i=u.default.mark("share_menu.update_page_permission_lag");r.ep({environment:g,store:h,permissionItems:[s],transaction:t,pagePermissionChangeLocation:e.location,metric:i,fromPermissionWrapper:x})}})}},48608:(e,t,s)=>{s.d(t,{Z:()=>Z});s(67294);var i=s(83355),n=s(86628),a=s(49085),o=s(79362),r=s(89036),l=s(40462),d=s(54855),c=s(97880),u=s(31412),m=s(50906),p=s(42922),g=s(64921),h=s(60458),f=s(63296),y=s(31278),x=s(64369),v=s(43250),S=s(79817),b=s(38755),M=s(95697),j=s(24646),w=s(85834),C=s(35057),k=s(73466),T=s(10039),I=s(85893);class P extends i.Z{constructor(){super(...arguments),this.storeTypes={contextualInviteStore:w.ZP,isSpaceCardSelected:a.default.createClass(!1)},this.containerStyle={padding:12,display:"flex",flexDirection:"column",gap:16},this.iconStyle={width:20,height:20,fill:this.theme.lightIconColor}}didMount(){m.$24(this.environment,S.Oh(this.environment,this.stores.contextualInviteStore)),(0,M.$)(this.environment)&&this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:w.uq.page_guest})}renderComponent(){var e;const{contextualInviteStore:t}=this.stores,s=(null===(e=t.state)||void 0===e?void 0:e.shareModalGuestMemberConfirmationExpGroup)||"control",i=t.getGuestEmails();if(!i.length)return null;const n=(0,M.$)(this.environment),a=(0,b.Q6)(this.props.spaceStore);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{className:v.B8p,style:{...this.containerStyle,paddingTop:16,paddingBottom:16,paddingLeft:18,paddingRight:18},children:(0,I.jsxs)("div",{children:[(0,I.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:(0,I.jsxs)("div",{children:[t.state.inviteStage===w.TG.share_workspace?(0,I.jsx)(F,{useZeroTeamsExperience:n,shareModalGuestMemberConfirmationExpGroup:s,guestEmails:i,useGuestInviteRequestExperience:a}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(x.Z,{style:{fontWeight:600,marginBottom:4},children:a?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.requestToWorkspace.guestInviteRequestEnabled.title",defaultMessage:"Also request to add as member"}):(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.requestToWorkspace.title",defaultMessage:"Request to add to workspace"})}),(0,I.jsx)(x.Z,{isMultiline:!0,isSmall:!0,children:a?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.requestToWorkspace.guestInviteRequestEnabled.subtitle",defaultMessage:"Guest {emailCount, plural, one {request} other {requests}} sent. Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:i.length}}):(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.requestToWorkspace.subtitle",defaultMessage:"Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:i.length}})})]}),(0,I.jsx)("div",{style:{display:"flex",flexWrap:"wrap",marginTop:16,marginBottom:16},children:(0,I.jsx)(A,{spaceStore:this.props.spaceStore,emails:i,shareModalGuestMemberConfirmationExpGroup:s})})]})}),"control"===s?this.renderSpaceCard({showSpaceCardToggle:n}):this.renderGuestMemberCards({shareModalGuestMemberConfirmationExpGroup:s}),(0,I.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,I.jsx)(f.Z,{isLarge:!0,style:{marginRight:10},onClick:async()=>{var e,i;"control"===s?this.selectPageGuestOption():(t.setState({...t.state,selection:w.uq.closed}),null===(e=(i=t.state).resetShareMenuFn)||void 0===e||e.call(i));await this.handleInviteClick()},children:"control"===s?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"}):(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.cancel.button",defaultMessage:"Cancel"})}),(0,I.jsx)(p.Z,{isLarge:!0,disabled:n&&!this.stores.isSpaceCardSelected.state||!n&&this.stores.contextualInviteStore.state.selection===w.uq.closed,onClick:async()=>{"control"===s&&(t.state.inviteStage===w.TG.share_workspace&&this.selectWorkspaceMemberOption(),t.state.inviteStage===w.TG.request_workspace&&this.selectRequestWorkspaceMemberOption()),await this.handleInviteClick()},children:(0,I.jsx)(_,{inviteStage:t.state.inviteStage,shareModalGuestMemberConfirmationExpGroup:s,useGuestInviteRequestExperience:a})})]})]})})})}renderGuestMemberCards(e){let{shareModalGuestMemberConfirmationExpGroup:t}=e;return"v1"!==t&&"v2"!==t?null:(0,I.jsxs)("div",{style:{display:"flex",gap:8,flexDirection:"column"},children:[(0,I.jsx)("div",{children:this.renderGuestMemberSelectionCard({title:"v1"===t?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.title.v1",defaultMessage:"Guest"}):(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.title.v2",defaultMessage:"Invite to Page"}),subtitle:(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.subtitle",defaultMessage:"Can access only this page"}),icon:(0,d.a)({fill:o.Lr[this.theme.mode].yellow,width:22,height:24}),selected:this.stores.contextualInviteStore.state.selection===w.uq.page_guest,onClick:()=>{this.selectPageGuestOption()}})}),(0,I.jsx)("div",{children:this.renderGuestMemberSelectionCard({title:"v1"===t?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.title.v1",defaultMessage:"Member"}):(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.title.v2",defaultMessage:"Invite to Workspace"}),subtitle:(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.subtitle",defaultMessage:"Can access all pages in {spaceName}. This person will be billed as a member.",values:{spaceName:(0,b.rn)(this.environment,this.props.spaceStore)}}),icon:(0,l.o)({fill:o.Lr[this.theme.mode].green,width:22,height:24}),selected:this.stores.contextualInviteStore.state.selection===w.uq.workspace_member,onClick:()=>{this.selectWorkspaceMemberOption()}})})]})}renderGuestMemberSelectionCard(e){let{title:t,subtitle:s,icon:i,selected:n,onClick:a}=e;return(0,I.jsxs)(g.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:this.theme.regularDividerColor,borderRadius:8,padding:12,justifyContent:"space-between",alignItems:"center"},onClick:a,children:[(0,I.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,I.jsx)("div",{style:{paddingRight:12},children:i}),(0,I.jsxs)("div",{children:[(0,I.jsx)(x.Z,{children:t}),(0,I.jsx)(x.Z,{isSmall:!0,style:{width:350,whiteSpace:"pre-wrap"},children:s})]})]}),(0,I.jsx)(h.Z,{round:!0,checked:n,fill:this.theme.contentBackground,size:20,onClick:a})]})}renderSpaceCard(e){let{showSpaceCardToggle:t}=e;const{spaceStore:s}=this.props,i=(0,b.Wd)(this.environment,s),n=(0,b.rn)(this.environment,this.props.spaceStore),a=s.getPublicSpaceData();let o;a&&"none"!==a.role&&(o=(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.spaceCard.subtitle",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} · {planType}",values:{numberOfWorkspaceMembers:this.props.intl.formatNumber(a.memberCount),planType:this.props.intl.formatMessage((0,j.em)(a.subscriptionTier))}}));const l=i||n?(0,I.jsx)(y.Z,{disabled:!0,icon:i,isEmptyPage:!1,title:n,size:30,style:{color:this.theme.regularTextColor,marginRight:12}}):(0,r.v)(this.iconStyle);return(0,I.jsxs)(g.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:this.theme.regularDividerColor,borderRadius:5,padding:12,justifyContent:"space-between",alignItems:"center"},disabled:!t,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state),children:[(0,I.jsxs)("div",{style:{display:"flex"},children:[l,(0,I.jsxs)("div",{children:[(0,I.jsx)(x.Z,{children:n}),(0,I.jsx)(x.Z,{isSmall:!0,children:o})]})]}),t&&(0,I.jsx)(h.Z,{round:!0,checked:this.stores.isSpaceCardSelected.state,fill:this.theme.contentBackground,size:20,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state)})]})}selectWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:w.uq.workspace_member})}selectRequestWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:w.uq.request_workspace_member})}selectPageGuestOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:w.uq.page_guest})}async handleInviteClick(){const{contextualInviteStore:e}=this.stores,{spaceStore:t,blockStore:s,intl:i}=this.props,{shareModalGuestMemberConfirmationExpGroup:n,callbackAsyncFn:a}=e.state;if(e.state.inviteStage===w.TG.closed||e.state.inviteStage===w.TG.share_page)return;const{selection:o}=e.state;switch(o){case w.uq.request_workspace_member:m.cir(this.environment,{...S.Oh(this.environment,e),from:"share_menu"}),await S.fC({environment:this.environment,spaceStore:t,originId:s.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:e,intl:i});break;case w.uq.workspace_member:if(m.E0y(this.environment,S.Oh(this.environment,e)),(0,M.$)(this.environment)){e.setState({...e.state,inviteStage:w.TG.closed});if(!(await k.HD({environment:this.environment,flowId:e.state.flowId??"",trackCreateTeamComplete:!1})))return}"control"!==n&&await(null==a?void 0:a()),await S.j_({environment:this.environment,spaceStore:t,contextualInviteStore:e,from:"page_contextual_invite",intl:i});break;case w.uq.page_guest:"control"!==n&&await(null==a?void 0:a()),e.reset();break;case w.uq.closed:e.reset();break;default:(0,c.t1)(o)}}}function _(e){const{inviteStage:t,shareModalGuestMemberConfirmationExpGroup:s,useGuestInviteRequestExperience:i}=e;return t===w.TG.share_workspace?"control"===s?i?(0,I.jsx)(u.FormattedMessage,{id:"ContextualInvite.addToWorkspace.guestInviteRequestEnabled.button",defaultMessage:"Add member to workspace"}):(0,I.jsx)(u.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button",defaultMessage:"Add to workspace"}):(0,I.jsx)(u.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button.variant",defaultMessage:"Invite"}):i?(0,I.jsx)(u.FormattedMessage,{id:"ContextualInvite.sendRequest.guestInviteRequestEnabled.button",defaultMessage:"Send member request"}):(0,I.jsx)(u.FormattedMessage,{id:"ContextualInvite.sendRequest.button",defaultMessage:"Send request"})}P.displayName="ContextualInvite";const Z=(0,u.injectIntl)(P);function F(e){let{useZeroTeamsExperience:t,useGuestInviteRequestExperience:s,shareModalGuestMemberConfirmationExpGroup:i,guestEmails:a}=e;window.__c={n:"ShareWorkspace"};const o=(0,n.VK)((()=>!(0,C.QM)()),[]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(x.Z,{style:{fontWeight:600,marginBottom:4},children:["control"===i?s?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.guestInviteRequestEnabled.title",defaultMessage:"Also add as member"}):(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.title",defaultMessage:"Add to workspace"}):void 0,"v1"===i?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.title.v1",defaultMessage:"Invite as guest or member?"}):void 0,"v2"===i?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.title.v2",defaultMessage:"Invite to page or workspace?"}):void 0]}),"control"===i?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(x.Z,{isMultiline:!0,isSmall:!0,style:{marginBottom:6},children:s?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.guestInviteRequestEnabled.subtitle",defaultMessage:"Guest {emailCount, plural, one {request} other {requests}} sent. Do you want to add {emailCount, plural,\n        one {this person}\n        other {these people}\n    } to the workspace in addition to the page? {isPaid, select,\n        true {This is a billable event.}\n        other {}\n    }",values:{emailCount:a.length,isPaid:o}}):(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.subtitle",defaultMessage:"Do you want to add {emailCount, plural,\n        one {this person}\n        other {these people}\n    } to the workspace in addition to the page? {isPaid, select,\n        true {This is a billable event.}\n        other {}\n    }",values:{emailCount:a.length,isPaid:o}})}),(0,I.jsx)(x.Z,{isMultiline:!0,isSmall:!0,children:t?(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle.blockLimit",defaultMessage:"Adding them as a member will auto-create a teamspace{isFreeTier, select,\n        free { and apply the 1,000 block limit to your workspace.}\n        other {}\n    }",values:{isFreeTier:o?"paid":"free"}}):(0,I.jsx)(u.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle",defaultMessage:"{isFreeTier, select,\n        free {This action will apply the 1,000 block limit to your workspace.}\n        other {}\n    }",values:{emailCount:a.length,isFreeTier:o?"paid":"free"}})})]}):void 0]})}function A(e){let{emails:t,shareModalGuestMemberConfirmationExpGroup:s,spaceStore:i}=e;window.__c={n:"EmailTokensSubtitle"};const a=(0,n.VK)((()=>(0,b.Q6)(i)),[i]);return(0,I.jsx)(I.Fragment,{children:t.map((e=>(0,I.jsx)(T.Z,{store:i,tokenType:"control"!==s?"member":a?"guestRequestRequired":"guest",showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e},spaceRole:"not_in_space"}},e)))})}},56678:(e,t,s)=>{s.d(t,{Z:()=>b});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(8848),l=s(77657),d=s(5257),c=s(91315),u=s(29477),m=s(149),p=s(50906),g=s(54642),h=s(42631),f=s(68785),y=s(89728),x=s(80444),v=s(30874),S=s(85893);function b(e){window.__c={n:"ImportContactsButton"};const{onClickAuthenticated:t,title:s,hideChevronIcon:b,containerStyle:M,buttonStyle:j,from:w,inviteOrigin:C,flowId:k,loadContacts:T}=e,I=(0,n.O7)(),[P,_]=i.useState(!1),Z=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),F=(0,a.VK)((()=>{const e=null==Z?void 0:Z.getBotSettingsStore().getValue();return"approved_only"!==(null==e?void 0:e.integration_restrictions)||Boolean((null==e?void 0:e.integration_approval_statuses)&&e.integration_approval_statuses[l.nO])}),[Z]),A=(0,a.VK)((()=>v.Z.integrations.state.find((e=>e.id===l.nO))),[]),R=(0,a.VK)((()=>v.Z.completeSlackAuthentications.state),[]),D=(0,o.yK)((e=>({circleCheck:{height:14,width:14,color:r.ZP.blue},chevron:{height:12,width:12},title:{display:"flex",alignItems:"center",color:r.ZP.uiLightBlack,size:14,gap:6},loadingSpinner:{width:14,height:14,marginLeft:6}})),[]);if(!Z)return(0,S.jsx)(S.Fragment,{});if(!F)return(0,S.jsx)(S.Fragment,{});const B=P?(0,S.jsx)(f.Z,{style:D.loadingSpinner}):(0,S.jsxs)(S.Fragment,{children:[R.length>0&&(0,c.r)(D.circleCheck),!b&&(0,d.o)(D.chevron)]});return(0,S.jsx)("div",{style:M,children:(0,S.jsx)(y.Z,{style:j,onClick:async()=>{0===R.length?await async function(e){const{from:s,inviteOrigin:i,flowId:n}=e,a=I.currentUser.id;if(!A||!Z||!a)return;try{var o;_(!0),p.n0P(I,{origin:i,from:s,invite_flow_id:n});const e=await h.hM({environment:I,integration:A,spaceId:Z.id,from:s});if(m.x.isFail(e))return void p.ZKQ(I,{origin:i,from:s,invite_flow_id:n,is_success:!1});const a=null===(o=e.value.externalAuthentication)||void 0===o?void 0:o.parent_id;if(!a)return;p.ZKQ(I,{origin:i,from:s,invite_flow_id:n,is_success:!0}),T&&await Promise.race([g.loadContacts(I,{botId:a,spaceId:Z.id,integrationId:A.id}),(0,u.Vs)(2e3)]),null==t||t()}finally{_(!1)}}({from:w,inviteOrigin:C,flowId:k,loadContacts:T}):R.length>0&&(null==t||t())},children:(0,S.jsxs)("div",{style:D.title,children:[s,B]})})})}},10039:(e,t,s)=>{s.d(t,{Z:()=>Z});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(8848),r=s(84619),l=s(33728),d=s(3338),c=s(40462),u=s(84169),m=s(36329),p=s(26774),g=s(97880),h=s(82990),f=s(7928),y=s(31412),x=s(26388),v=s(45653),S=s(85567),b=s(45101),M=s(16639),j=s(53353),w=s(26781),C=s(4023),k=s(80444),T=s(55899),I=s(78291),P=s(88893),_=s(85893);const Z=function(e){window.__c={n:"InviteTargetToken"};const{store:t,target:s}=e,Z=(0,i.Fy)(),F=(0,y.useIntl)(),A=(0,a.yK)((()=>({verifiedDomain:{margin:2,backgroundColor:"rgba(83, 168, 63, 0.1)"},disabled:{margin:2,backgroundColor:"rgba(211, 79, 67, 0.1)",border:"dashed #D9655B 1px",paddingLeft:5},normal:{margin:2},guest:{margin:2,backgroundColor:"rgba(218, 163, 64, 0.2)"},error:{margin:2,backgroundColor:"rgba(195,90,75,0.2)",color:"#DE5550"},tokenContent:{display:"flex",alignItems:"center",maxWidth:"100%"},tokenSpan:{maxWidth:"100%",marginRight:4},tokenText:{marginLeft:4,...h.Z.textOverflowStyle}})),[]),R=(0,n.VK)((()=>{const{data:e}=I.default.state,t=e?P.CM(e):[],s={};return t.forEach((e=>{s[e.userId]=e})),s}),[]),D=(0,n.VK)((()=>{const e=k.default.state.currentSpaceStore;return new Set(null==e?void 0:e.getEmailDomains())}),[]),B=(0,j.Z)(t),L=(0,w.S)(t),N=(0,n.VK)((()=>{if("invalidUser"===s.type)return"invalidUser";if(e.tokenType)return e.tokenType;if("group"===s.type)return"group";if("existingUser"===s.type&&!Boolean(s.spaceRole)){const e=R[s.value.id];s.spaceRole=e?e.role:"not_in_space"}if(!(0,b.OA)(s))return"member";if(B.isGuestRequestRequired)return"guestRequestRequired";const t=(0,l.Gd)(s.value.email);return t&&D.has(t)?"verifiedDomain":B.isStoreInTeam&&!B.teamAllowsGuests?"teamGuestDisabled":!B.isStoreInTeam&&!B.spaceAllowsGuests||B.isStoreInTeam&&!B.teamAllowsGuests&&!B.spaceAllowsGuests?"spaceGuestDisabled":"guest"}),[e.tokenType,s,R,D,B]),O=(0,n.VK)((()=>{switch(N){case"member":case"group":return A.normal;case"invalidUser":return A.error;case"guest":case"guestRequestRequired":return A.guest;case"verifiedDomain":return A.verifiedDomain;case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return A.disabled;default:(0,g.t1)(N)}}),[N,A]);function E(){const e=(0,u.m)({height:16,width:16,color:"#D34F43"});switch(N){case"member":return(0,T.fZ)(s)?(0,_.jsx)(v.Z,{userValue:s.value,size:16}):(0,T.KU)(s)?(0,_.jsx)(v.Z,{size:16,avatar:s.value}):(0,_.jsx)(v.Z,{size:16});case"guest":case"guestRequestRequired":return(0,c.o)({height:16,width:16,color:"#DAA340"});case"invalidUser":return(0,m._)({height:16,width:16,color:"#DE5550"});case"verifiedDomain":return(0,d.p)({height:16,width:16,color:"#53A83F"});case"group":return(0,_.jsx)("div",{style:{height:16,width:16,backgroundColor:o.ZP.whiteWithAlpha(.8),borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,p.O)({height:12,width:12,color:o.ZP.mediumTextColor})});case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return e;default:(0,g.t1)(N)}}function V(t){const i=E();let n=function(){switch(s.type){case"newUser":return s.value.email.trim();case"invalidUser":return s.value.text.trim();case"existingUser":return(0,f.Nz)(F,s.value);case"group":return(0,M.kF)({intl:F,group:s.value});default:(0,g.t1)(s)}}(),a=A.tokenText;return e.onlyShowTokenType&&(["guest","teamGuestDisabled","spaceGuestDisabled"].includes(t)?(n="Guest",a={...a,color:"#DAA340"}):(n="Member",a={...a,color:"#53A83F"})),(0,_.jsxs)("div",{style:A.tokenContent,children:[i,(0,_.jsx)("div",{style:a,children:n})]})}function U(t){var s;t.stopPropagation(),null===(s=e.onClickRemove)||void 0===s||s.call(e)}const W="newUser"===s.type?s.value.email:"invalidUser"===s.type?s.value.text:s.value.id,K="group"!==s.type&&"invalidUser"!==s.type?s.value.email:void 0;return(0,_.jsx)(x.Z,{placement:C.u.Top,renderTooltip:()=>function(e){const{tokenType:t,target:s,email:i}=e;return"guest"===t?(0,_.jsx)(y.FormattedMessage,{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip",values:{email:i}}):"spaceGuestDisabled"===t||"teamGuestDisabled"===t||"guestRequestRequired"===t?L:"teamGroupOwner"===t&&"group"===s.type?(0,_.jsx)(y.FormattedMessage,{defaultMessage:"Groups cannot be added as team owners.",id:"inviteTargetToken.groupTeamOwner.tooltip"}):"invalidUser"===s.type?(0,_.jsx)(y.FormattedMessage,{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip",values:{text:s.value.text}}):"verifiedDomain"===t&&"group"!==s.type?(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(y.FormattedMessage,{defaultMessage:"{email}{br}will automatically be added to the workspace{br}since @{domain} is a verified domain.",id:"inviteTargetToken.verifiedDomain.tooltip",values:{email:s.value.email,br:(0,_.jsx)("br",{}),domain:(0,l.Gd)(s.value.email)}})}):"group"===s.type?s.value.name??(0,_.jsx)(y.FormattedMessage,{defaultMessage:"Untitled group",id:"inviteTargetToken.group.untitled"}):i}({tokenType:N,email:K,target:s}),render:t=>(0,_.jsx)("div",{style:A.tokenSpan,...t,children:(0,_.jsx)(S.Z,{isSingle:!1,format:Z.isMobile?r.lo.Large:r.lo.Medium,showRemoveButton:e.showRemoveButton,onClickRemove:U,disabledFeedback:!0,value:V(N),style:O,shouldWrap:!1})})},W)}},99273:(e,t,s)=>{s.d(t,{Z:()=>S});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(8848),r=s(72126),l=s(31412),d=s(33728),c=s(4708),u=s(26907),m=s(35057),p=s(50906),g=s(95209);const h=r.Ds((e=>{let{environment:t,flowId:s,subscriptionTier:i,origin:n}=e;p.UWw(t,{invite_flow_id:s,subscription_tier:i,invite_origin:n})}),1e3);var f=s(47082),y=s(55899),x=s(10039),v=s(85893);const S=function(e){window.__c={n:"InviteTargetsInput"};const{flowId:t,store:s,disabled:p,placeholder:S,right:b,focus:M,hideIconColorAndTooltips:j,showEmptyError:w,origin:C,onFocus:k,onSubmit:T,onInputChanged:I}=e,P=(0,i.O7)(),_=(0,i.Fy)(),Z=(0,n.qz)(e.inviteTargetsStore,y.ZP),F=(0,n.VK)((()=>Z.state.inviteTargets),[Z]),A=(0,n.VK)((()=>Z.state.tokenQuery),[Z]),R=F.map((e=>{const t="newUser"===e.type?e.value.email:"invalidUser"===e.type?e.value.text:e.value.id;return(0,v.jsx)(x.Z,{store:s,target:e,showRemoveButton:!0,tokenType:j?"member":void 0,onClickRemove:()=>function(e){const{targetToRemove:t,inviteTargetsStore:s}=e;if(0===s.state.inviteTargets.length)return;const i=s.state.inviteTargets.filter((e=>e!==t));0===i.length?s.setState({...s.state,inviteTargets:[]}):s.setState({...s.state,inviteTargets:i})}({inviteTargetsStore:Z,targetToRemove:e})},t)})),D=(0,a.yK)((e=>({tokenSpan:{maxWidth:"100%"},tokenInputMenuItem:{paddingTop:0===F.length?0:6,paddingLeft:4,paddingRight:4,paddingBottom:4,borderRadius:4,minHeight:"unset",...M&&{background:"none"},...p&&{background:e.inputBackground,color:e.mediumTextColor,fill:o.ZP.white,opacity:.4}},inputAndTokenWrapRight:{gap:6},tokenInputMenuItemInput:{paddingTop:0===F.length?6:0},warningMessage:{color:"#DE5550"}})),[F,M,p]),B=function(e){let{invalidInvites:t,showEmptyError:s,styles:i}=e;if(s)return(0,v.jsx)("div",{style:i,children:(0,v.jsx)(l.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.noEmails",defaultMessage:"Please enter an email address"})});if(0===t.length)return null;const n=t[0].value.text;if(1===t.length)return(0,v.jsx)("div",{style:i,children:(0,v.jsx)(l.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.singleEmail",defaultMessage:"“{text}” is not a valid email",values:{text:n}})});return(0,v.jsx)("div",{style:i,children:(0,v.jsx)(l.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.multipleEmails",defaultMessage:"{additionalInvalid, plural, one {“{text}” and {additionalInvalid} other are not valid emails} other {“{text}” and {additionalInvalid} others are not valid emails}}",values:{text:n,additionalInvalid:t.length-1}})})}({invalidInvites:(0,r.oA)(F.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:w,styles:D.warningMessage});return(0,v.jsx)(f.Z,{focus:M,focusAfterAnimation:!0,onClick:()=>{_.isMobile||null==k||k()},format:f.Z.Format.Share,value:A,onChange:e=>async function(e){const{environment:t,event:s,flowId:i,inviteTargetsStore:n,inviteOrigin:a,onInputChanged:o}=e;null==o||o(),n.setState({...n.state,tokenQuery:s.target.value}),h({environment:t,flowId:i,subscriptionTier:(0,m.zt)(),origin:a});const r=s.target.value;let l,p,f;(0,c.Lm)()?({extractedEmails:l,invalidParts:p,newInputValue:f}=(0,d.nj)(r)):(({extractedEmails:l,newInputValue:f}=(0,d.zI)(r)),p=[]);const y=[...await g.M5(t,l),...p.map((e=>({type:"invalidUser",value:{text:e}})))].filter((e=>!u.H({inviteTargetsStore:n,target:e}))),x=[...n.state.inviteTargets,...y];n.setState({...n.state,inviteTargets:x,tokenQuery:f})}({environment:P,event:e,inviteTargetsStore:Z,inviteOrigin:C,flowId:t,onInputChanged:I}),type:"email",tokens:R,disabled:p,autoComplete:"off",placeholder:S,onRemoveLastToken:()=>{Z.setState({...Z.state,inviteTargets:Z.state.inviteTargets.slice(0,-1)})},right:b,showBorder:!0,inputStyle:D.tokenInputMenuItemInput,inputAndTokenWrapRightStyle:D.inputAndTokenWrapRight,style:D.tokenInputMenuItem,onSubmit:T,inputFullWidth:!0,message:B})}},71862:(e,t,s)=>{s.d(t,{Z:()=>R});s(67294);var i=s(83355),n=s(15145),a=s(8848),o=s(72126),r=s(27006),l=s(21202),d=s(29369),c=s(97880),u=s(82990),m=s(31412),p=s(47307),g=s(64921),h=s(84076),f=s(31278),y=s(76798),x=s(26388),v=s(64369),S=s(7567),b=s(84210),M=s(95697),j=s(31075),w=s(55838),C=s(61766),k=s(26350),T=s(78291),I=s(88893),P=s(9867),_=s(1951),Z=s(85893);const F=function(e){const{store:t}=e;return(0,Z.jsx)(m.FormattedMessage,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:(0,Z.jsx)(_.Z,{store:t,useInvertedColors:!0})}})};class A extends i.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:C.Z},this.permissionItemStore=void 0,this.handleRoleSelect=async e=>{if(D(this.props.permissionItem))return;const t=this.props.permissionItem,s=o.d9(t);s.role=e;const i=this.props.currentBlockStore.isTopLevel();if(i&&r.ix(s)){const{data:e}=T.default.state,n=e?I.su(e):1;if(!(0,M.bq)()&&r.YX(t.role)&&!r.YX(s.role)&&n>1){if(!(await p.confirmUserAction({message:(0,Z.jsx)("span",{children:(0,Z.jsx)(m.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <semibold>Only you will be able to access it.</semibold>",values:{semibold:e=>(0,Z.jsx)("span",{style:{fontWeight:u.Z.fontWeight.semibold},children:e})},id:"blockPermissionsSettings.confirmationDialog.private.message"})}),acceptLabel:(0,Z.jsx)(m.FormattedMessage,{defaultMessage:"Move to Private",id:"blockPermissionsSettings.confirmationDialog.privateButton.label"})})))return}else if(!(0,M.bq)()&&i&&!r.YX(t.role)&&r.YX(s.role)){if(!(await p.confirmUserAction({message:(0,Z.jsx)("span",{children:(0,Z.jsx)(m.FormattedMessage,{defaultMessage:"Are you sure you want to share this page with the workspace? <semibold>It will be accessible by all {memberCount} members.</semibold>",id:"blockPermissionsSettings.confirmationDialog.workspace.message",values:{semibold:e=>(0,Z.jsx)("span",{style:{fontWeight:u.Z.fontWeight.semibold},children:e}),memberCount:n}})}),acceptLabel:(0,Z.jsx)(m.FormattedMessage,{defaultMessage:"Move to workspace",id:"blockPermissionsSettings.confirmationDialog.workspaceButton.label"})})))return}}await(0,j.i)({oldPermissionItem:t,newPermissionItem:s,wasInherited:this.isInherited(),environment:this.environment,store:this.props.currentBlockStore,sudoModeStore:this.props.sudoModeStore,location:this.props.location,fromPermissionWrapper:this.props.fromPermissionWrapper})},this.handleUserItemClick=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})},this.getPermissionItemStore=()=>{const{from:e,currentBlockStore:t}=this.props,s=e.table;return s===l.iU?k.G.createChildStore(t,{table:l.iU,id:e.blockId}):s===d.e0?k.zX.createChildStore(t,{table:d.e0,id:e.teamId}):void(0,c.t1)(s)}}willMountOrUpdate(){this.permissionItemStore=this.getPermissionItemStore()}renderComponent(){const{device:e}=this.environment,t=this.props.onClick?this.props.onClick:this.handleUserItemClick,s=N(this.props.permissionItem,this.props.currentBlockStore),i=this.renderTooltip();return(0,Z.jsx)(x.Z,{delayThreshold:0,renderTooltip:()=>i,textWrap:!0,disableTooltip:!Boolean(i),style:{maxWidth:240},render:i=>(0,Z.jsx)(g.Z,{disabled:s,mobileFeedback:e.isMobile,ignoreLocalHoverState:this.props.ignoreLocalHoverState,style:{...s?{cursor:"not-allowed"}:{}},onClick:t,...i,children:this.renderMenuItem()}),placement:x.Z.Placement.Left})}renderMenuItem(){const{device:e}=this.environment,{showInherited:t,permissionItem:s}=this.props,i=this.isInherited();return(0,Z.jsxs)("div",{className:"notranslate",style:E(this.environment,this.props.isCompact),children:[(0,Z.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,marginRight:e.isMobile?12:10,...this.props.iconStyle},children:this.props.icon}),(0,Z.jsxs)("div",{style:{marginRight:"auto",minWidth:0},children:[(0,Z.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,Z.jsx)(v.Z,{style:{...!B(s)&&{fontWeight:400}},children:this.props.title}),this.props.tag&&(0,Z.jsx)("div",{style:{marginLeft:4},children:this.props.tag})]}),this.props.subtitle&&(0,Z.jsx)(v.Z,{isSmall:!0,children:this.props.subtitle}),t&&i&&this.renderInheritedRecordTitle()]}),(0,Z.jsx)("div",{style:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8},children:this.props.permissionRoleSelect?this.props.permissionRoleSelect:!D(s)&&(0,Z.jsx)(S.ZP,{role:this.role,table:l.iU,blockType:this.props.currentBlockStore.getType(),type:s.type,disabled:N(this.props.permissionItem,this.props.currentBlockStore),isUserPermission:O(s,this.environment),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:-8,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12},showPermissionOverrideWarning:i,isRemovableOverride:this.props.isRemovableOverride})})]})}renderTooltip(){return this.isInherited()?!L(this.props.permissionItem)&&this.permissionItemStore?(0,Z.jsx)(F,{store:this.permissionItemStore}):null:this.props.nonInheritedTooltip}renderInheritedRecordTitle(){const e=this.permissionItemStore||this.getPermissionItemStore(),t=e.table===l.iU?(0,b.ZP)({store:e,fullyQualified:!1,pageVisitSource:n.tY.LinkInPage}):void 0,s=e.table===d.e0?()=>{e.table===d.e0&&P.RF({environment:this.environment,teamId:e.id,tab:w.a.Members,from:"permission_item"})}:void 0,{device:i}=this.environment,o=e.getIcon(),r="team"!==e.table&&e.isEmptyPage();return(0,Z.jsx)(v.Z,{isSmall:!0,style:{lineHeight:1.4},children:i.isMobile?(0,Z.jsx)(m.FormattedMessage,{defaultMessage:"Based on {linkBoxWithPageTitle}",id:"pagePermissionItem.inheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:(0,Z.jsx)(h.Z,{disabled:i.isMobile,underline:!i.isMobile,inline:!0,href:t,onClick:s,children:(0,Z.jsx)(y.Z,{store:e,style:{display:"inline"}})})}}):(0,Z.jsx)(m.FormattedMessage,{defaultMessage:"From {linkBoxWithPageTitle}",id:"pagePermissionItem.fromInheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:(0,Z.jsxs)(h.Z,{disabled:i.isMobile,underline:!1,inline:!0,href:t,onClick:s,innerStyle:{display:"inline-flex",alignItems:"center",borderBottom:`0.5px solid ${a.ZP.mediumTextColor}`},children:[(0,Z.jsx)(f.Z,{disabled:!0,style:{marginRight:4},icon:o,size:14,isEmptyPage:r}),(0,Z.jsx)(y.Z,{store:e,style:{display:"inline",fontWeight:u.Z.fontWeight.semibold}})]})}})})}get role(){const{permissionItem:e,currentBlockStore:t}=this.props;if(D(e))return"none";if("content_only_editor"===e.role&&this.isInherited()){var s,i;const n=t.getParentCollectionStore(),a=null==n?void 0:n.getParentBlockStore();return a&&a.table===(null===(s=this.permissionItemStore)||void 0===s?void 0:s.table)&&a.id===(null===(i=this.permissionItemStore)||void 0===i?void 0:i.id)?e.role:"read_and_write"}return e.role}isInherited(){var e;return(null===(e=this.permissionItemStore)||void 0===e?void 0:e.id)!==this.props.currentBlockStore.id}}A.displayName="PermissionItem",A.iconSize=32;const R=A;function D(e){return"team_overview_permission"===e.type||"hidden_permission"===e.type}function B(e){return"user_permission"===e.type}function L(e){return"team_overview_permission"===e.type}function N(e,t){return"hidden_permission"===e.type||!L(e)&&!t.canAdmin()}function O(e,t){const s=t.currentUser.id;return"user_permission"===e.type&&e.user_id===s}function E(e,t){const{WindowSizeStore:s}=e;return{display:"flex",alignItems:"center",minHeight:t?44:52,paddingTop:8,paddingBottom:8,paddingLeft:s.getSafePaddingLeftCSS(14),paddingRight:s.getSafePaddingRightCSS(14)}}},85414:(e,t,s)=>{s.r(t),s.d(t,{OfflineMessage:()=>Cn,default:()=>kn});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(31412),l=s(1743),d=s(56940),c=s(78140),u=s(40721),m=s(64369),p=s(46247),g=s(43250),h=s(87279),f=s(18514),y=s(80444),x=s(88632),v=s(85834),S=s(52878),b=s(72126),M=s(26825),j=s(27006),w=s(21202),C=s(15047),k=s(29369),T=s(98165),I=s(67669),P=s(26350);function _(e){const{store:t}=e;if(t.getParentTable()===C.bx)return!1;const s=(0,T.Om)(t),i=s?(0,M.Wo)((0,T.fJ)(s)):[],n=t.getPermissionItems(),a={};for(const o of i)a[(0,M.OC)(o)]=o;for(const o of n){const e=o.role,t=a[(0,M.OC)(o)];if(t){if((0,j.iC)(e)&&(0,j.iC)(t.role)&&(0,M.xO)(e,t.role))return!0;if(j.KF(t)&&!j.KF(o))return!0}else if((0,j.ix)(o)||(0,j.ZQ)(o)||(0,j.RI)(o))return!0}return!1}function Z(e){const{store:t}=e,s=(0,T.uJ)(t)[1];return{parentStore:s,canAccessParent:s&&s.canRead()}}function F(e){const{mostPermissivePermissions:t,store:s,ancestorTeamId:i,type:n}=e;if(!i)return;const a=t.find((e=>{let{permissionItem:t}=e;return t.type===n&&t.team_id===i}));if(a)return a;const o=t.find((e=>{let{permissionItem:t}=e;return j.Le(t)}));return"explicit_team_guest_permission"!==n||o?{permissionItem:{type:n,role:"none",team_id:i},from:(null==o?void 0:o.from)??{table:w.iU,blockId:s.id}}:void 0}function A(e){const{spaceStore:t,store:s}=e,i=(0,I.YO)(s);let n=[];t&&(n=t.getPermissionGroups());const a=T.VP(s),o=function(e){let{mostPermissivePermissions:t,store:s}=e;return t.find((e=>{let{permissionItem:t}=e;return j.$D(t)}))||{permissionItem:{type:"public_permission",role:"none"},from:{table:w.iU,blockId:s.id}}}({mostPermissivePermissions:i,store:s}),r=function(e){let{mostPermissivePermissions:t,store:s,teamStore:i}=e;const n=t.find((e=>{let{permissionItem:t}=e;return j.ix(t)}));if(n)return n;const a=t.find((e=>j.Le(e.permissionItem)));return{permissionItem:{type:"space_permission",role:"none"},from:null!=a&&a.from||!i||"none"!==i.getSpacePermissionRole()?(null==a?void 0:a.from)??{table:w.iU,blockId:s.id}:{table:k.e0,teamId:i.id}}}({mostPermissivePermissions:i,store:s,teamStore:a}),l=F({mostPermissivePermissions:i,store:s,ancestorTeamId:null==a?void 0:a.id,type:"explicit_team_guest_permission"}),d=F({mostPermissivePermissions:i,store:s,ancestorTeamId:null==a?void 0:a.id,type:"explicit_team_permission"}),c=F({mostPermissivePermissions:i,store:s,ancestorTeamId:null==a?void 0:a.id,type:"explicit_team_owner_permission"});let u=i.filter((e=>{let{permissionItem:t}=e;return j.hV(t)}));u=b.MR(u,(e=>{if(t){return t.getPermissionGroups().findIndex((t=>t.id===e.permissionItem.group_id))}return e.permissionItem.group_id}));let m=i.filter((e=>{let{permissionItem:t}=e;return(j.zU(t)||j.LW(t))&&t.team_id!==(null==a?void 0:a.id)}));const p=new Map;m.forEach(((e,t)=>{let{permissionItem:s}=e;p.has(s.team_id)||p.set(s.team_id,t)})),m=b.MR(m,[e=>{let{permissionItem:t}=e;return p.get(t.team_id)||0},e=>{let{permissionItem:t}=e;return"explicit_team_owner_permission"===t.type?0:1}]);const g=i.filter((e=>{let{permissionItem:t}=e;return j.jg(t)})),h=Boolean(null==a?void 0:a.isDefined()),f="none"!==r.permissionItem.role,y=f||h||g.length>1||g.length&&!j.zz(g[0].permissionItem.role)||u.length||j.YX(r.permissionItem.role);return{showRestrictedPermissionBanner:i.some((e=>j.Le(e.permissionItem)&&e.from.table===w.iU&&e.from.blockId===s.id)),showTeamPermission:h,showSpacePermission:f,mostPermissivePublicItem:o,mostPermissiveAncestorTeamOwnerItem:c,mostPermissiveAncestorTeamMemberItem:d,mostPermissiveAncestorTeamGuestItem:l,mostPermissiveSpaceItem:r,pagePermissionUIModel:{showUserPermissions:y,mostPermissiveGroupPermissions:u,mostPermissiveTeamPermissions:m,mostPermissiveUserPermissions:g,spacePermissionGroups:n},permissionItemsCount:(y?g.length:0)+m.length+u.length+(f?1:0)+(h?1:0)}}var R=s(28578),D=s(48608),B=s(97880),L=s(55899),N=s(41892),O=s(8848),E=s(80721),V=s(91315),U=s(64275),W=s(11185),K=s(43876),z=s(82990),q=s(24215);var G=s(51077),H=s(73063),Q=s(66957),Y=s(2194),$=s(85893);function J(e){let{inviteTargetsStore:t,mostPermissivePublicItem:s}=e;window.__c={n:"ShareMenuHeader"};const{display:i,source:n}=(0,a.VK)((()=>{const{display:e}=R.ZP.state;if(e===R.wV.Invite){const{source:t}=R.ZP.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(i){case R.wV.MainShareMenu:case R.wV.Publish:return(0,$.jsx)(ee,{mostPermissivePublicItem:s});case R.wV.Invite:if("notion"===n)return(0,$.jsx)(se,{inviteTargetsStore:t});if("slack"===n)return(0,$.jsx)(ie,{});throw(0,B.t1)(n);default:(0,B.t1)(i)}}const X=[R.XF.Share,R.XF.Publish];function ee(e){let{mostPermissivePublicItem:t}=e;window.__c={n:"ShareMenuTabs"};const s=(0,n.O7)(),l=i.useRef(null),{isMobile:d}=s.device,c=(0,a.VK)((()=>R.ZP.state.tab),[]),u=(0,o.yK)((e=>({tabStyle:{color:e.lightTextColor,...d&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:z.Z.fontWeight.medium},tabTitleStyle:{color:"inherit"},style:d?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:14}})),[d]),m=(0,o.yK)((()=>({publishTabContainer:{display:"flex",alignItems:"center"}})),[]),p=(0,i.useCallback)((e=>{const t=X[e];t!==c&&(!function(e,t){q.j(e,"share_menu_tab_click",t)}(s,{tab:t}),t===R.XF.Share&&R.ZP.setState({...R.ZP.state,display:R.wV.MainShareMenu,tab:R.XF.Share}),t===R.XF.Publish&&R.ZP.setState({...R.ZP.state,display:R.wV.Publish,tab:R.XF.Publish}))}),[c,s]),g="none"!==t.permissionItem.role,h=[(0,$.jsx)(i.Fragment,{children:d?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Permissions",id:"shareMenu.permissionsTab.title"},"permissions"):(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,$.jsxs)("div",{ref:l,style:m.publishTabContainer,children:[(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),g&&te.publishedCheckIcon({opacity:c===R.XF.Publish?1:.5}),(0,$.jsx)(Y.jG,{originRef:l})]},"publishTab")];return(0,$.jsx)(Q.Z,{...u,tabs:h,selectedIndex:X.indexOf(c),onChange:p})}const te={[R.XF.Share]:(0,K.s)({height:17,width:17,marginRight:4}),[R.XF.Publish]:(0,W.I)({height:15,width:15,marginRight:4}),publishedCheckIcon:e=>{let{opacity:t}=e;return(0,V.r)({color:O.ZP.blue,width:14,height:14,marginLeft:4.5,opacity:t})}};function se(e){let{inviteTargetsStore:t}=e;window.__c={n:"InviteFromNotionHeader"};const s=(0,o.yK)((()=>({container:{display:"flex",margin:"0 12px 6px",height:48}})),[]),n=(0,i.useCallback)((()=>{t.reset(),R.ZP.setState({...R.ZP.state,display:R.wV.MainShareMenu,tab:R.XF.Share})}),[t]);return(0,$.jsx)("div",{style:s.container,children:(0,$.jsx)(ne,{onClick:n})})}function ie(){window.__c={n:"InviteFromSlackHeader"};const e=(0,r.useIntl)(),t=(0,o.yK)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:z.Z.fontWeight.semibold}})),[]),s=(0,i.useCallback)((()=>{R.ZP.setState({...R.ZP.state,tab:R.XF.Share,display:R.wV.Invite,source:R.T5.Notion,focus:R.Sw.Search,emailMessage:""})}),[]),n=(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(G.Z,{type:"image_url",imageURL:N.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:{marginLeft:4,marginRight:4}}),(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]});return(0,$.jsxs)("div",{style:t.container,children:[(0,$.jsx)(m.Z,{style:t.titleLabel,children:(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:n}})}),(0,$.jsx)(H.Z,{ariaLabel:e.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close slack integration and go back to the main invite flow."}),icon:U.D,style:{borderRadius:"100%"},onClick:s})]})}function ne(e){window.__c={n:"BackButton"};const{onClick:t}=e,s=(0,r.useIntl)(),i=(0,o.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:z.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:z.Z.fontWeight.medium}})),[]);return(0,$.jsxs)("div",{style:i.topContainer,children:[(0,$.jsx)(H.Z,{icon:E.W,iconStyle:i.arrowIcon,style:i.iconButton,onClick:t,ariaLabel:s.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,$.jsx)(m.Z,{style:i.sendInviteLabel,children:(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite"})})]})}var ae=s(42922),oe=s(42402);function re(e){const{store:t}=e;return(0,a.VK)((()=>{const e=y.default.state.currentSpaceStore,s=(0,T.VP)(t);return s?{isPublicAccessDisabled:Boolean(s.getDisablePublicAccess()),disabledBy:"team"}:{isPublicAccessDisabled:Boolean(null==e?void 0:e.getDisablePublicAccess()),disabledBy:"space"}}),[t])}var le=s(31075);function de(e){window.__c={n:"PublishToWeb"};const{store:t,mostPermissivePublicItem:s,permissionItemArgs:l}=e,{permissionItem:d,from:c}=s,{sudoModeStore:u,location:p}=l,g=(0,n.O7)(),h=(0,a.VK)((()=>t.canAdmin()),[t]),{isPublicAccessDisabled:f}=re({store:t}),x=!h||f,v=(0,o.yK)((e=>({container:{display:"flex",flex:1,justifyContent:"center",alignItems:"center",flexDirection:"column",padding:32,textAlign:"center",cursor:x?"not-allowed":""},icon:{height:30,width:30,marginBottom:10,fill:e.mediumIconColor},title:{fontWeight:z.Z.fontWeight.semibold,fontSize:14,marginBottom:6},caption:{marginLeft:26,marginRight:26,marginBottom:20},button:{display:"flex",width:"100%",padding:16,cursor:x?"not-allowed":"pointer"}})),[x]),S=(0,a.VK)((()=>{var e;return null===(e=y.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace()}),[]),b=c.table===w.iU?c.blockId:c.teamId,M=(0,i.useCallback)((()=>{const e=!S&&d.allow_duplicate;(0,le.i)({oldPermissionItem:d,newPermissionItem:{...d,role:"reader",allow_duplicate:e},wasInherited:b!==t.id,environment:g,store:t,sudoModeStore:u,location:p})}),[g,b,p,S,d,t,u]);return(0,$.jsxs)("div",{style:v.container,children:[(0,W.I)(v.icon),(0,$.jsx)("div",{style:v.title,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.title"})}),(0,$.jsx)(m.Z,{isMultiline:!0,isSecondaryColor:!0,style:v.caption,children:(0,$.jsx)(ce,{store:t})}),(0,$.jsx)(ae.Z,{style:v.button,disabled:x,onClick:M,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.button"})})]})}function ce(e){let{store:t}=e;window.__c={n:"PublishToWebMessage"};const{isPublicAccessDisabled:s,disabledBy:i}=re({store:t}),n=(0,a.VK)((()=>t.canAdmin()),[t]);return s?"team"===i?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via teamspace settings.",id:"publishTab.publishToWeb.disabledByTeamspace.caption"}):(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via workspace settings.",id:"publishTab.publishToWeb.disabledByWorkspace.caption"}):n?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Publish a static website of this page. You can allow others to view, duplicate, and remix. <inlinelink>Learn more</inlinelink>. ",id:"publishTab.publishToWeb.hasFullAccess.caption",values:{inlinelink:e=>(0,$.jsx)(oe.Z,{external:!0,href:(0,f.UY)("guides.autogeneratedDomains"),children:e})}}):(0,$.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to this page to publish to web.",id:"publishTab.publishToWeb.noFullAccess.caption"})}var ue=s(15145),me=s(39226),pe=s(50906),ge=s(14871),he=s(75018),fe=s(64921),ye=s(74194),xe=s(63296),ve=s(24006),Se=s(26388),be=s(60442),Me=s(42115),je=s(84210),we=s(33929),Ce=s(5162),ke=s(77080),Te=s(81236),Ie=s(88893),Pe=s(91376);function _e(e){window.__c={n:"LearnAboutAutogeneratedDomainsCTA"};const t=(0,n.O7)(),{WindowSizeStore:s}=t,{safePaddingLeftCSS:i,safePaddingRightCSS:l}=(0,a.VK)((()=>({safePaddingLeftCSS:s.getSafePaddingLeftCSS(8),safePaddingRightCSS:s.getSafePaddingRightCSS(8)})),[s]),{isMobile:d}=(0,n.Fy)(),{spaceStore:c,canChangeSettings:u,publicSpaceData:p}=(0,a.VK)((()=>{const e=y.default.state.currentSpaceStore;return e?{spaceStore:e,canChangeSettings:e.canAdmin(),publicSpaceData:Te.Z.getPublicSpaceData(t,e.id)}:{}}),[t]),g=(0,o.yK)((t=>({container:{boxShadow:`0 -1px 0 ${t.regularDividerColor}`,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",padding:"8px 8px",paddingLeft:i,paddingRight:l,color:t.mediumTextColor,backgroundColor:t.inputBackground,...e.style}})),[e.style,i,l]);if(!c)return null;if(d)return null;if(!p)return null;return p.domainIsAutogenerated&&u?(0,$.jsx)("span",{style:g.container,children:(0,$.jsxs)("div",{style:{display:"flex"},children:[(0,$.jsx)(m.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!0,style:{paddingRight:"4px"},...e.labelStyle,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Set a domain for your public links in",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.setDomainForPublicLinks"})}),(0,$.jsx)("span",{style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",color:O.ZP.inherit},onClick:()=>{Pe.r$({currentTab:"settings"})},children:(0,$.jsx)(m.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!1,style:{textDecoration:"underline"},...e.labelStyle,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Settings",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.openSettingsCTA"})})})]})}):null}var Ze=s(13991),Fe=s(7057),Ae=s(42853),Re=s(63143),De=s(52275),Be=s(31945),Le=s(32163),Ne=s(89728),Oe=s(72495),Ee=s(93289),Ve=s(42782),Ue=s(28020),We=s(61766),Ke=s(31194);function ze(e){window.__c={n:"PublicPermissionItemLinkExpirationMenu"};const t=(0,n.Fy)(),[,,s]=(0,a.AF)(void 0,We.Z),i=(0,o.Fg)(),l=(0,n.O7)(),d=(0,a.VK)((()=>(0,Ie.y$)(l)),[l]),{buttonMenuItemStyle:u}=(0,o.yK)((()=>({buttonMenuItemStyle:{opacity:e.disabled?.6:1,cursor:e.disabled?"not-allowed":""}})),[e.disabled]);return(0,$.jsx)(Be.ZP,{...e.upsellEvents,disablePopup:!d,disabled:e.disabled,popupType:t.isMobile?Be.Z4.SlideUp:Be.Z4.Popup,buttonPopupStore:s,renderOrigin:t=>(0,$.jsx)(De.Z,{...t,focused:!1,disabled:e.disabled,style:u,title:(0,$.jsxs)(m.Z,{children:[(0,$.jsx)(r.FormattedMessage,{id:"publicPermissionItem.expirationTime.label",defaultMessage:"Link expires"})," ",e.upgradeLabel]}),right:(0,$.jsxs)(Ne.Z,{...t,disabled:e.disabled,ignoreLocalHoverState:!0,style:{paddingLeft:0,paddingRight:0},children:[(0,$.jsx)(qe,{permissionItem:e.permissionItem}),(0,Ae.i)({width:10,marginLeft:4,fill:i.lightIconColor})]})}),alignmentToOrigin:Ke.lU.End,placementToOrigin:Ke.Iw.Bottom,render:s=>{const i=[{key:"options",render:e=>(0,$.jsx)(Oe.Z,{...e}),items:He().map((t=>({key:t.type,action:()=>{Ge(e,l,t.time),s.close()},render:e=>(0,$.jsx)(De.Z,{...e,focused:e.focused,disabled:!1,title:t.title,caption:t.caption})})))},{key:"custom",render:e=>(0,$.jsx)(Oe.Z,{...e,topBorder:!0}),items:[{key:"custom",action:()=>{s.close()},render:(t,i)=>(0,$.jsx)(Ve.Z,{...t,renderOrigin:e=>(0,$.jsx)(De.Z,{...e,disabled:!1,title:(0,$.jsx)(r.FormattedMessage,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"})}),onFocus:i.onFocus,disableDefaultClick:!0,renderExtension:(t,i)=>(0,$.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,$.jsx)(Ee.Z,{...t,firstDayOfWeek:Ue.AK.state,value:e.permissionItem.expiration_timestamp||(new Date).getTime(),onChange:t=>{Ge(e,l,t),i.close(),s.close()},disabledDays:{before:new Date}})})})}]}];let n;return n=t.isMobile?{menuType:h.og.Modal,title:(0,$.jsx)(r.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.title",defaultMessage:"Expiration time"}),right:(0,$.jsx)(r.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.label",defaultMessage:"Done"}),onClickRight:s.close}:{menuType:h.og.Popup,width:264},(0,$.jsx)(c.Z,{className:g.IpQ,...n,children:(0,$.jsx)(Le.Z,{type:Le.i.Vertical,initialFocus:void 0,sections:i})})}})}function qe(e){const{permissionItem:t}=e;return!t.expiration_timestamp||(0,j.o7)(t)?(0,$.jsx)(r.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"}):(0,$.jsx)(m.Z,{children:e.permissionItem.expiration_timestamp&&(0,Fe.tv)(e.permissionItem.expiration_timestamp,Ze.SP)})}function Ge(e,t,s){const{permissionItem:i,onChange:n}=e;if("public_permission"!==i.type)return;if(void 0!==s&&s<=(new Date).getTime())return;const a=i,o=b.d9(a),r=s;o.expiration_timestamp=r,n(o),pe.n4j(t,{expiration_time:r})}function He(){const e=(new Date).getTime()+Re.U6,t=(new Date).getTime()+Re.A0,s=(new Date).getTime()+7*Re.A0;return[{type:"never",time:void 0,title:(0,$.jsx)(r.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"})},{type:"hour",time:e,title:(0,$.jsx)(r.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.hour",defaultMessage:"In an hour"}),caption:new Intl.DateTimeFormat(Ze.SP,{hour:"numeric",minute:"numeric"}).format(e)},{type:"day",time:t,title:(0,$.jsx)(r.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.day",defaultMessage:"In a day"}),caption:new Intl.DateTimeFormat(Ze.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)},{type:"week",time:s,title:(0,$.jsx)(r.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.week",defaultMessage:"In a week"}),caption:new Intl.DateTimeFormat(Ze.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(s)}]}function Qe(e){window.__c={n:"PublishToWebSettings"};const{store:t,mostPermissivePublicItem:s,permissionItemArgs:l}=e,{permissionItem:d,from:c}=s,{sudoModeStore:u,location:m,onUpgradeButtonClick:p}=l,g=(0,n.O7)(),{isMobile:h}=g.device,y=(0,o.yK)((e=>({title:{color:e.blueColor,fontWeight:z.Z.fontWeight.medium,fontSize:14,display:"flex",alignItems:"center",margin:"0px 16px 10px",paddingTop:h?4:0},icon:{height:16,width:16,marginRight:6},linkSharingOptions:{margin:"10px 2px"},learnAboutDomainsCTA:{fontSize:14,margin:"8px 8px",padding:0,backgroundColor:void 0,boxShadow:void 0,textAlign:"left",alignItems:"flex-start"},buttonGroup:{margin:"10px 14px 16px",display:"flex",gap:10},button:{flexGrow:1,height:34},disabledButton:{opacity:.7,cursor:"not-allowed"}})),[h]),x=(0,a.VK)((()=>!t.canAdmin()),[t]),v=c.table===w.iU?c.blockId:c.teamId,S=(0,i.useCallback)((e=>{(0,le.i)({oldPermissionItem:d,newPermissionItem:{...d,...e},wasInherited:v!==t.id,environment:g,store:t,sudoModeStore:u,location:m})}),[d,v,t,g,u,m]),b=(0,i.useCallback)((()=>{S({role:"none"})}),[S]),M=(0,a.VK)((()=>(0,je.ZP)({store:t,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=Te.Z.getPublicSpaceData(g,t.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:ue.tY.LinkInPage})),[t,g]),j=(0,i.useCallback)((()=>{!function(e){q.j(e,"view_public_site_click")}(g),he.navigate({url:M,environment:g,openInNew:"tab"})}),[g,M]);return(0,$.jsxs)("div",{children:[(0,$.jsxs)("div",{style:y.title,children:[(0,me.v)(y.icon),(0,$.jsx)("span",{children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"This page is live on the web. <inlinelink>Learn more</inlinelink>.",id:"publishTab.settings.liveOnWeb.title",values:{inlinelink:e=>(0,$.jsx)(oe.Z,{external:!0,href:(0,f.UY)("guides.autogeneratedDomains"),children:e})}})})]}),(0,$.jsx)(Ye,{currentBlockStore:t}),(0,$.jsx)(_e,{style:y.learnAboutDomainsCTA,labelStyle:{isSmall:!1}}),(0,$.jsx)("div",{style:y.linkSharingOptions,children:(0,$.jsx)(Je,{currentBlockStore:t,permissionItem:d,onChange:S,onUpgradeButtonClick:p})}),(0,$.jsxs)("div",{style:y.buttonGroup,children:[(0,$.jsx)(Se.Z,{disableTooltip:!x,renderTooltip:()=>(0,$.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to this page to unpublish it",id:"publishTab.settings.liveOnWeb.unpublishTooltip"}),render:e=>(0,$.jsx)(xe.Z,{onClick:b,disabled:x,style:x?{...y.button,...y.disabledButton}:y.button,...e,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Unpublish",id:"publishTab.settings.liveOnWeb.unpublish"})})}),(0,$.jsx)(ae.Z,{onClick:j,style:y.button,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"View site",id:"publishTab.settings.liveOnWeb.viewSite"})})]})]})}function Ye(e){window.__c={n:"PageLinkButton"};const[t,s]=i.useState(!1),[l,d]=i.useState(void 0),{currentBlockStore:c}=e,u=(0,n.O7)(),m=(0,a.VK)((()=>$e(u)),[u]),p=(0,o.yK)((()=>({container:{...m,height:"auto"},flex:{flex:1},wrapper:{display:"flex",padding:"1px 0"},input:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:0},button:{height:28,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"}})),[m]),g=(0,a.VK)((()=>(0,je.ZP)({store:c,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=Te.Z.getPublicSpaceData(u,c.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:ue.tY.CopyLink})),[c,u]),h=(0,i.useCallback)((()=>{u.mobileNative&&(0,Ce.Y)("supportsNativeCopy")?u.mobileNative.copyText(g,we.default.formatMessage(ge.tq.copiedLinkToClipboard)):ge.RD({environment:u,stringValue:g,copiedMessage:ge.tq.copiedLinkToClipboard}),clearTimeout(l),s(!0),d(window.setTimeout((()=>{s(!1)}),1e3)),pe.c7L(u)}),[u,g,l]);return(0,$.jsx)("div",{style:p.container,children:(0,$.jsx)("div",{style:p.flex,children:(0,$.jsxs)("div",{style:p.wrapper,children:[(0,$.jsx)(ye.Z,{value:g,disabled:!0,style:p.input}),(0,$.jsx)(xe.Z,{onClick:h,style:p.button,children:t?(0,$.jsx)(r.FormattedMessage,{id:"pageShareMenu.copiedLinkButton.label",defaultMessage:"✓ Copied"}):(0,$.jsx)(r.FormattedMessage,{id:"pageShareMenu.copyMaybePublicLinkButton.label.web",defaultMessage:"Copy web link"})})]})})})}function $e(e){const t=e.WindowSizeStore;return{display:"flex",alignItems:"center",width:"100%",height:e.device.isMobile?36:30,paddingTop:5,paddingBottom:5,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}}function Je(e){window.__c={n:"PageLinkOptions"};const{permissionItem:t,onUpgradeButtonClick:s,onChange:l,currentBlockStore:d}=e,c=(0,n.O7)(),u=(0,a.VK)((()=>!d.canAdmin()),[d]),p=(0,a.VK)((()=>{var e;return Boolean(null===(e=y.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace())}),[]),g=j.RF(t.role),h=!1!==t.allow_duplicate,f=j.J5(t.role),x=Boolean(t.allow_search_engine_indexing),v=(0,i.useCallback)((()=>{l({role:f?"comment_only":"read_and_write"})}),[f,l]),S=(0,i.useCallback)((()=>{l({role:g?"reader":"comment_only"})}),[g,l]),b=(0,i.useCallback)((()=>{const e=!x;l({allow_search_engine_indexing:e}),pe.g0v(c,{allow_search_engine_indexing:e})}),[c,l,x]),M=(0,i.useCallback)((()=>{const e=!h;l({allow_duplicate:e}),pe.l7z(c,{allow_duplicate:e})}),[h,c,l]),w=(0,a.VK)((()=>ke.default.checkGate("expiring_public_links")),[]),C=(0,a.VK)((()=>!(0,Ie.y$)(c)&&(0,Ie.M9)(c)),[c]),k=(0,a.VK)((()=>!(0,Ie.f3)(c)&&(0,Ie.M9)(c)),[c]),T=(0,a.VK)((()=>$e(c)),[c]),I=(0,a.VK)((()=>u||p&&!h),[u,h,p]),P=(0,o.yK)((()=>({optionLabel:{marginRight:"auto",opacity:u?.6:1},optionButton:u?{...T,cursor:"not-allowed"}:T})),[u,T]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)($.Fragment,{children:[w&&(0,$.jsx)(Me.Z,{alwaysAllowClick:Boolean(t.expiration_timestamp),onClick:()=>{},analyticsName:"public_permission_item_expiration",requireUpgradeToTier:C,tooltipPlacement:Se.Z.Placement.Left,renderTooltip:tt,renderUpgradeTooltip:st,onUpgradeClick:s,render:(e,s)=>(0,$.jsx)(ze,{upsellEvents:e,upgradeLabel:s,permissionItem:t,onChange:l,disabled:u})}),(0,$.jsx)(Se.Z,{placement:Se.Z.Placement.Left,renderTooltip:Xe,render:e=>(0,$.jsxs)(fe.Z,{onClick:v,style:P.optionButton,disabled:u,...e,children:[(0,$.jsx)(m.Z,{style:P.optionLabel,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Allow editing",id:"pagePermissionItem.allowEdits.setting"})}),(0,$.jsx)(ve.Z,{on:f,onClick:v,disabled:u})]})}),(0,$.jsx)(Se.Z,{placement:Se.Z.Placement.Left,renderTooltip:et,render:e=>(0,$.jsxs)(fe.Z,{onClick:S,style:P.optionButton,disabled:u,...e,children:[(0,$.jsx)(m.Z,{style:P.optionLabel,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Allow comments",id:"pagePermissionItem.allowComments.setting"})}),(0,$.jsx)(ve.Z,{on:g,onClick:S,disabled:u})]})})]}),(0,$.jsx)(Se.Z,{placement:Se.Z.Placement.Left,renderTooltip:p&&!h?nt:it,render:e=>(0,$.jsxs)(fe.Z,{onClick:M,disabled:I,style:P.optionButton,...e,children:[(0,$.jsx)(m.Z,{style:P.optionLabel,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Allow duplicate as template",id:"pagePermissionItem.allowDuplicateTemplate.setting"})}),(0,$.jsx)(ve.Z,{on:h,onClick:M,disabled:I})]})}),(0,$.jsx)(Me.Z,{requireUpgradeToTier:k,alwaysAllowClick:t.allow_search_engine_indexing,analyticsName:"allow_search_engine_indexing",onClick:b,onUpgradeClick:s,tooltipPlacement:Se.Z.Placement.Left,renderTooltip:tt,renderUpgradeTooltip:st,render:(e,t)=>(0,$.jsxs)(fe.Z,{style:P.optionButton,disabled:u,...e,children:[(0,$.jsxs)(m.Z,{style:P.optionLabel,children:[(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Search engine indexing",id:"pagePermissionItem.allowSearchEngines.setting"})," ",t]}),(0,$.jsx)(ve.Z,{on:x,onClick:b,disabled:u||Boolean(t)})]})})]})}function Xe(){return(0,$.jsx)(be.Z,{caption:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Any logged in Notion user can edit this page. Share the secret link with people you trust.",id:"pagePermissionItem.allowEdits.tooltip"}),imageHeight:120,imageWidth:240,imageURL:N.Z.images.tooltips.share.allowEditingPng})}function et(){return(0,$.jsx)(be.Z,{caption:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Any logged in Notion user can comment on this page.",id:"pagePermissionItem.allowComments.tooltip"}),imageHeight:120,imageWidth:240,imageURL:N.Z.images.tooltips.share.allowCommentsPng})}function tt(){return(0,$.jsx)(be.Z,{caption:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"If allowed, your public page may appear in search engines such as Google, but only if you or someone else links to it elsewhere on the web.",id:"pagePermissionItem.allowSearchEngine.tooltip"}),imageHeight:120,imageWidth:240,imageURL:N.Z.images.tooltips.share.allowSearchEnginesPng})}function st(){return(0,$.jsx)(be.Z,{imageURL:N.Z.images.tooltips.upsells.searchEngineIndexingPng,imageWidth:240,imageHeight:100,title:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Upgrade for search engine indexing",id:"pagePermissionItem.searchEngineUpgradeTooltip.title"}),caption:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Have your page appear in search engine results.",id:"pagePermissionItem.searchEngineUpgradeTooltip.caption"})})}function it(){return(0,$.jsx)(be.Z,{caption:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"If allowed, this will allow other people to duplicate your public page to their workspace.",id:"pagePermissionItem.allowDuplicateTemplate.tooltip"}),imageHeight:120,imageWidth:240,imageURL:N.Z.images.tooltips.share.allowDuplicatePng})}function nt(){return(0,$.jsx)(be.Z,{caption:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"This workspace does not allow page duplication to other workspaces.",id:"pagePermissionItem.duplicateTemplateDisabled.tooltip"}),imageWidth:240})}function at(e){const{store:t,mostPermissivePublicItem:s,permissionItemArgs:i}=e,{permissionItem:n}=s;return"none"!==n.role?(0,$.jsx)(Qe,{store:t,mostPermissivePublicItem:s,permissionItemArgs:i}):(0,$.jsx)(de,{store:t,mostPermissivePublicItem:s,permissionItemArgs:i})}var ot=s(77657),rt=s(94044),lt=s(54642),dt=s(95209),ct=s(3386),ut=s(53336),mt=s(7567),pt=s(44385),gt=s(4708),ht=s(79817),ft=s(26907),yt=s(45101),xt=s(53353),vt=s(26781),St=s(34859),bt=s(30874),Mt=s(29798),jt=s(78291),wt=s(57345),Ct=s(56678),kt=s(99273),Tt=s(64964),It=s(77907),Pt=s(96455);const _t=function(e){window.__c={n:"PermissionsInviteEntry"};const{store:t}=e,{isMobile:s}=(0,n.Fy)(),i=(0,a.VK)((()=>t.canEditMembership()),[t]),l=(0,o.yK)((()=>({buttonContainer:{display:"flex",alignItems:"center",gap:rt.p_},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden"},blueButton:{minWidth:rt.UF}})),[]);return(0,$.jsx)(Se.Z,{renderTooltip:()=>(0,$.jsx)(r.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:i,render:t=>(0,$.jsxs)("div",{style:l.buttonContainer,...t,children:[(0,$.jsx)(Pt.Z,{onClick:e.onClick,disabled:!i&&!0,style:l.inputButton,children:(0,$.jsx)("div",{style:z.Z.textOverflowStyle,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!s&&(0,$.jsx)(ae.Z,{isLarge:!0,onClick:e.onClick,disabled:!i&&!0,style:l.blueButton,children:(0,$.jsx)(r.FormattedMessage,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function Zt(e){window.__c={n:"MobileInviteSection"};const{store:t,permissionItemArgs:s}=e,{onUpgradeButtonClick:l,sudoModeStore:d}=s,c=(0,a.qz)(void 0,S.Z),{permissionsInviteStore:u}=(0,a.VK)((()=>c.state),[c]),m=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),p=(0,a.VK)((()=>c.stage),[c]),g=(0,a.VK)((()=>u.state.modalOpen),[u]),h=(0,n.MO)(),f=(0,n.O7)(),x=(0,a.VK)((()=>t.canAdmin()),[t]),b=(0,a.VK)((()=>{const{data:e}=jt.default.state;return Boolean(e&&Ie.YK(e))}),[]),M=(0,a.VK)((()=>function(e){const{store:t}=e,s=(0,T.VP)(t),i=y.default.state.currentSpaceStore;return Boolean((null==i?void 0:i.getDisableGuests())||(null==s?void 0:s.getDisableGuests()))}({store:t})),[t]),j=(0,o.yK)((e=>({button:{display:"flex",alignItems:"center",minHeight:52},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[]),w=(0,i.useCallback)(((e,t)=>{e&&t>0&&Tt.oV({label:(0,$.jsx)(r.FormattedMessage,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:h?j.requestedUsersToast:void 0})}),[h,j.requestedUsersToast]);return m?p!==v.TG.closed?(0,$.jsx)(It.LazyUniversalMemberInvite,{universalInviteStore:c,mode:"milestone_2",spaceStore:m,sudoModeStore:d,store:t,disabled:!x,membersOnly:M,isSubscribed:b,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:{height:36}}):(0,$.jsx)(fe.Z,{mobileFeedback:!0,disabled:!0,style:j.button,children:(0,$.jsxs)("div",{style:j.buttonInner,children:[g&&(0,$.jsx)(It.LazyPermissionsInviteWithModal,{store:t,disabled:!x,membersOnly:M,isSubscribed:b,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:j.modalButton,permissionsInviteStore:u,onInviteComplete:w}),(0,$.jsx)(_t,{store:t,onClick:()=>(0,yt.z5)({environment:f,permissionsInviteStore:u,store:t,isSubscribed:b,renderInShareModal:!1})})]})}):null}var Ft=s(19889),At=s(7928),Rt=s(91536),Dt=s(64684);function Bt(){const{data:e}=jt.default.state,t=e?Ie.CM(e):[],s=new Map;return t.forEach((e=>{s.set(e.userId,e)})),s}function Lt(e){const{spaceVisibleUserMap:t,blockStore:s,userId:i}=e,n=t.get(i);if(!n||"none"!==n.role)return;if(!n.isTeamGuest)return"guest";const a=T.VP(s);if(!a)return"guest";return(0,Dt.s8)({team:{membership:a.getRawMembership()},userId:i})?"team_level_guest":"guest"}var Nt=s(65598),Ot=s(16639),Et=s(12793),Vt=s(31278),Ut=s(25735),Wt=s(71862);function Kt(e){window.__c={n:"GroupPermissionTooltip"};const{group:t}=e,s=(0,r.useIntl)(),i=(0,Ot.kF)({intl:s,group:t});return(0,$.jsx)(Ut.Y,{group:t,limit:15,noMembersMessage:(0,$.jsx)(be.Z,{imageURL:N.Z.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:e=>(0,$.jsx)("span",{style:{fontWeight:z.Z.fontWeight.bold},children:e}),groupName:i},id:"blockPermissionsSettings.groupPermission.tooltip"})})})}const zt=function(e){window.__c={n:"BlockGroupPermissionItem"};const{store:t,groupPermission:s,spaceId:i,fromPermissionWrapper:n}=e,o=(0,r.useIntl)(),l=(0,a.VK)((()=>{const{currentSpaceStore:e}=y.default.state;if(!e)return!1;return e.getPermissionGroups().find((e=>e.id===s.permissionItem.group_id))}),[s.permissionItem.group_id]);if(!l)return null;const d=l.user_ids||[],c=(0,Ot.kF)({intl:o,group:l}),u=l.icon&&(0,$.jsx)(Vt.Z,{disabled:!0,title:c,icon:l.icon?{pointer:{table:"space",id:i},icon:l.icon}:void 0,isEmptyPage:!1,size:18});return(0,$.jsx)("div",{style:{fontWeight:400},className:g.gGc,children:(0,$.jsx)(Wt.Z,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:(0,$.jsx)(Et.Z,{size:Wt.Z.iconSize}),title:c,tag:u,ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:(0,$.jsx)(Kt,{group:l}),subtitle:(0,$.jsxs)("div",{children:[(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,$.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:d.length}})]}),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:n,...e.permissionItemArgs})},l.id)};var qt=s(88198),Gt=s(45653);function Ht(e){window.__c={n:"Icon"};const{userValue:t,shouldShowPendingInvitation:s}=e,i=(0,o.yK)((()=>({iconPlaceholder:{height:Wt.Z.iconSize,width:Wt.Z.iconSize,borderRadius:20}})),[]);return t?(0,$.jsx)(Gt.Z,{userValue:t,size:Wt.Z.iconSize,initialOverrideStyle:s?{borderStyle:"dashed"}:void 0}):(0,$.jsx)($t,{style:i.iconPlaceholder})}function Qt(e){window.__c={n:"Title"};const{userValue:t,guestLabel:s,shouldShowPendingInvitation:i}=e,n=(0,r.useIntl)(),a=(0,o.yK)((()=>({titlePlaceholder:{height:8,width:81,borderRadius:4},pendingInvitation:{color:O.ZP.PendingInvitationTextColor}})),[]);if(!t)return(0,$.jsx)($t,{style:a.titlePlaceholder});const l=(0,At.Nz)(n,t);return(0,$.jsx)($.Fragment,{children:l?(0,$.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,$.jsx)(m.Z,{className:"notranslate",style:i?a.pendingInvitation:void 0,children:l}),s&&(0,$.jsx)(qt.b,{labelType:s})]}):(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"})})}function Yt(e){window.__c={n:"Subtitle"};const{userValue:t,shouldShowPendingInvitation:s}=e,i=(0,o.yK)((()=>({uiLabel:{display:"flex"},subtitlePlaceholder:{height:8,width:139,borderRadius:4,marginTop:10},dotSeparator:{marginLeft:2,marginRight:2},pendingInvitation:{color:O.ZP.PendingInvitationTextColor}})),[]);return null!=t&&t.email?s?(0,$.jsx)(m.Z,{isSmall:!0,style:i.pendingInvitation,children:(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.invitationSent",defaultMessage:"Pending Invitation"})}):(0,$.jsx)(m.Z,{isSmall:!0,children:t.email}):(0,$.jsx)($t,{style:i.subtitlePlaceholder})}function $t(e){window.__c={n:"Placeholder"};const t=(0,o.yK)((t=>({placeholder:{...e.style,background:t.lightDividerColor}})),[e.style]);return(0,$.jsx)("div",{style:t.placeholder})}const Jt=function(e){window.__c={n:"BlockUserPermissionItem"};const{store:t,userPermission:s,spaceVisibleUserMap:i,fromPermissionWrapper:n}=e,o=(0,a.VK)((()=>P.U6.createChildStore(t,{table:Ft.KJ,id:s.permissionItem.user_id}).getValue()),[t,s.permissionItem.user_id]),r=(0,a.VK)((()=>{if(null!=o&&o.id)return Lt({spaceVisibleUserMap:i,userId:o.id,blockStore:t})}),[t,i,o]),l=(0,a.VK)((()=>!0!==(null==o?void 0:o.onboarding_completed)&&(0,gt.fJ)()),[o]);return(0,$.jsx)("div",{children:(0,$.jsx)(Wt.Z,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,$.jsx)(Ht,{userValue:o,shouldShowPendingInvitation:l}),title:(0,$.jsx)(Qt,{userValue:o,guestLabel:r,shouldShowPendingInvitation:l}),subtitle:(0,$.jsx)(Yt,{userValue:o,shouldShowPendingInvitation:l}),showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:n,...e.permissionItemArgs})},s.permissionItem.user_id)};var Xt=s(56666);function es(e){let{permissions:t}=e;window.__c={n:"ExpandablePermissionsList"};const[s,n]=(0,i.useState)(!1),a=(0,o.yK)((e=>({button:{display:s?"none":"inline-flex",padding:10,width:"100%"},icon:{width:14,transform:"rotate(90deg)",marginLeft:14,marginRight:18,fill:e.lightIconColor},list:{display:s?"block":"none"}})),[s]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(fe.Z,{onClick:()=>n(!0),style:a.button,children:[(0,$.jsx)("div",{children:(0,Xt.o)(a.icon)}),(0,$.jsx)(m.Z,{isSmall:!0,isSecondaryColor:!0,children:(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.expandButton",defaultMessage:"{count} more people",values:{count:t.length}})})]}),(0,$.jsx)("div",{style:a.list,children:t})]})}var ts=s(50571);const ss=function(e){window.__c={n:"MorePeoplePermissionItem"};const{store:t}=e,s=(0,o.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),i={table:w.iU,blockId:t.id};return(0,$.jsx)(Wt.Z,{icon:(0,ts.S)(s.icon),iconStyle:s.iconContainer,title:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you don't have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:(0,$.jsx)($.Fragment,{}),currentBlockStore:t,permissionItem:{type:"hidden_permission"},from:i,upgradeButtonName:"team_permission_item"})};var is=s(76781),ns=s(84076),as=s(38755),os=s(74016),rs=s(61061),ls=s(44495),ds=s(76798),cs=s(62385),us=s(47307),ms=s(76464),ps=s(39699),gs=s(18878);var hs=s(55838),fs=s(4023),ys=s(9867);function xs(e){window.__c={n:"PermissionsRestoreBanner"};const{showRestoreButton:t,store:s,type:i,sudoModeStore:r}=e,{isMobile:l}=(0,n.Fy)(),d=(0,a.VK)((()=>T.uJ(s)[1]),[s]),c=(0,n.O7)(),u=(0,a.VK)((()=>({paddingLeft:c.WindowSizeStore.getSafePaddingLeftCSS(14),paddingRight:c.WindowSizeStore.getSafePaddingLeftCSS(14)})),[c]),p=(0,o.yK)((e=>({container:{display:"flex",minHeight:20,flexDirection:"row",alignItems:"center",paddingTop:8,paddingBottom:6,paddingLeft:u.paddingLeft,paddingRight:u.paddingRight},banner:{display:"flex",flexDirection:"row",width:"100%",fontSize:12},icon:{width:16,fill:e.mediumIconColor},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginRight:5},messageContainer:{display:"flex",flexDirection:"column"},label:{display:"inline",marginLeft:l?14:0,color:l?"#CF8807":e.mediumTextColor,fontWeight:l?z.Z.fontWeight.regular:z.Z.fontWeight.medium,marginRight:6,lineHeight:"20px"},buttonContainer:{marginLeft:-5},divider:{opacity:"75%"},mobileContainer:{borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:9,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"rgba(246, 192, 80, 0.26)"}})),[l,u]);return l?(0,$.jsxs)("div",{style:p.mobileContainer,children:[(0,$.jsx)(m.Z,{isMultiline:!0,isSmall:!0,style:p.label,children:(0,$.jsx)(bs,{type:i,navigableParentStore:d,showRestoreButton:t})}),t&&(0,$.jsx)(vs,{store:s,type:i})]}):(0,$.jsx)("div",{style:p.container,children:(0,$.jsxs)("div",{style:p.banner,children:[(0,$.jsx)("div",{style:p.iconContainer,children:Ms[i](p.icon)}),(0,$.jsxs)("div",{children:[(0,$.jsx)(m.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:p.label,children:(0,$.jsx)(bs,{type:i,navigableParentStore:d,showRestoreButton:t})}),t&&(0,$.jsx)("span",{style:p.buttonContainer,children:(0,$.jsx)(vs,{store:s,type:i,sudoModeStore:r})})]})]})})}function vs(e){window.__c={n:"PermissionsRestoreButton"};const{type:t,store:s,sudoModeStore:i}=e,{isMobile:l}=(0,n.Fy)(),d=(0,a.VK)((()=>!!i&&i.shouldSaveTransactionWithSudoMode(s)),[s,i]),c=(0,o.yK)((e=>({button:{color:l?"#CF8807":e.regularTextColor,fontWeight:z.Z.fontWeight.medium},tooltip:{width:210,whiteSpace:"initial"}})),[l]),u=(0,n.O7)();if("restore-team"===t){const e=async()=>{await async function(e){const{environment:t,useSudoMode:s,store:i}=e,n={type:"restoreTeamPermissions",permissionChanges:[]};await us.confirmUserAction({message:(0,gs.mX)(n),acceptLabel:(0,gs.nH)(n),cancelLabel:(0,$.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"})})&&ps.createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:t,useSudoMode:s,perform:e=>{ms.Kh({environment:t,store:i,transaction:e})}})}({environment:u,useSudoMode:d,store:s})};return(0,$.jsx)(Se.Z,{style:c.tooltip,placement:fs.u.Bottom,renderTooltip:()=>(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Reset page permissions to match default teamspace permissions",id:"permissionsRestoreBanner.tooltip.teamPermissions"}),render:t=>(0,$.jsx)("span",{...t,children:(0,$.jsx)(cs.Z,{style:c.button,onClick:e,children:(0,$.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.teamPermissions",defaultMessage:"Reset"})})})})}if("unrestrict"===t){const e=async()=>{const e=s.getPermissionItems(),t=T.Om(s),i=t?(0,M.Wo)(T.fJ(t)):[],n=(0,M.Xr)(e,i);await async function(e){const{environment:t,useSudoMode:s,store:i,permissionChanges:n}=e,a={type:"restore",permissionChanges:n};await us.confirmUserAction({message:(0,gs.mX)(a),acceptLabel:(0,gs.nH)(a),cancelLabel:(0,$.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,$.jsx)(gs.mo,{openState:a})})&&(i.getPermissionItemsStore().canAdmin()?ps.createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:t,useSudoMode:s,perform:e=>{ms.MX({environment:t,store:i,transaction:e})}}):ms.hs({environment:t,store:i}))}({environment:u,useSudoMode:d,store:s,permissionChanges:n})};return(0,$.jsx)(cs.Z,{style:c.button,onClick:e,children:(0,$.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.restrictedPermissions",defaultMessage:"Restore"})})}(0,B.t1)(t)}function Ss(e){window.__c={n:"ClickableAttribution"};const{navigableParentStore:t,maxLength:s,showUnderline:i}=e,{isMobile:r}=(0,n.Fy)(),l=(0,n.O7)(),d=(0,o.yK)((e=>({linkBox:{color:e.mediumTextColor},title:{display:"inline"}})),[]),c=(0,a.VK)((()=>{if(t instanceof P.G)return(0,je.ZP)({store:t,fullyQualified:!1,pageVisitSource:ue.tY.LinkInPage})}),[t]);if(!t)return null;const u=r&&t.table===k.e0;return(0,$.jsx)(ns.Z,{disabled:u,style:u?void 0:d.linkBox,underline:i&&!u,inline:!0,onClick:t.table===k.e0?()=>{t.table===k.e0&&ys.RF({environment:l,teamId:t.id,tab:hs.a.Members,from:"permission_item"})}:void 0,href:c,children:(0,$.jsx)(ds.Z,{shouldWrap:!0,maxLength:s,store:t,style:d.title})})}function bs(e){window.__c={n:"PermissionsRestoreBannerLabel"};const{type:t,navigableParentStore:s,showRestoreButton:i}=e,{isMobile:a}=(0,n.Fy)(),o=(0,$.jsx)(Ss,{navigableParentStore:s,maxLength:a||!i?void 0:30,showUnderline:!0});switch(t){case"restore-team":return(0,$.jsx)(r.FormattedMessage,{id:"pageShareMenu.restoreTeamPermissionsBanner.label",defaultMessage:"Page access is different from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:o}});case"unrestrict":return a?(0,$.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.mobileLabel",defaultMessage:"Page access is restricted to people below.",values:{linkBoxWithPageTitle:o}}):(0,$.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:o}});default:(0,B.t1)(t)}}const Ms={unrestrict:rs.B,"restore-team":ls.D},js=(0,r.defineMessages)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function ws(e){let{store:t}=e;window.__c={n:"PermissionLevelBanner"};const s=(0,n.O7)(),l=(0,a.VK)((()=>(0,Ue.B7)(s)),[s]),d=(0,a.VK)((()=>t.canEditContentOnly()),[t]),c=(0,o.yK)((e=>({container:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},banner:{fontSize:12,display:"inline-flex"},icon:{marginLeft:14,marginRight:8},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:5}})),[]),{role:u,attribution:p}=(0,a.VK)((()=>{if(!l)return{role:"none",attribution:null};const e=(0,I.Dt)({userId:l.id,store:t}),i=function(e){let{environment:t,calculatedPermission:s,store:i}=e;const n=(0,T.Pj)(i)||y.default.state.currentSpaceStore;if(!n)return null;if((0,j.hV)(s)){const e=(0,as.TC)({spaceStore:n,groupId:s.group_id}),t=null==e?void 0:e.name;return t?(0,$.jsxs)($.Fragment,{children:[(0,is.x)({width:18,marginRight:5}),t]}):null}if((0,j.fG)(s)){var a;const e=s.team_id||(null===(a=(0,T.VP)(i))||void 0===a?void 0:a.id);if(!e)return null;const t=P.zX.createChildStore(n,{table:k.e0,id:e,spaceId:n.id});return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(os.p,{disabled:!0,store:t,size:18,style:{marginRight:5}}),(0,$.jsx)(Ss,{navigableParentStore:t,showUnderline:!0})]})}if((0,j.ix)(s))return(0,j.KF)(s)?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(os.p,{disabled:!0,store:n,size:18,style:{marginRight:5}}),(0,as.rn)(t,n)]});if((0,j.$D)(s))return(0,$.jsx)(ns.Z,{underline:!0,inline:!0,onClick:()=>{R.ZP.setState({...R.ZP.state,display:R.wV.Publish,tab:R.XF.Publish})},children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"})});return null}({environment:s,calculatedPermission:e,store:t});return{role:e.role,attribution:i}}),[l,t,s]);if((0,i.useEffect)((()=>{u&&pe.hYM(s,{share_menu_session_id:R.ZP.state.sessionId,role:u})}),[]),!(0,j.iC)(u))return null;const g=function(e){switch(e){case"editor":return js.fullAccess;case"read_and_write":return js.editor;case"content_only_editor":return js.contentEditor;case"comment_only":return js.commenter;case"reader":return js.reader;case"none":case"membership_admin":return null;default:(0,B.t1)(e)}}(u);return g?(0,$.jsx)(Se.Z,{delayThreshold:0,renderTooltip:()=>(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!d,textWrap:!0,style:{maxWidth:180},render:e=>(0,$.jsxs)("div",{style:c.container,...e,children:[(0,$.jsx)(Gt.Z,{userStore:l,size:20,style:c.icon}),(0,$.jsx)(m.Z,{style:c.banner,children:(0,$.jsx)(r.FormattedMessage,{...g,values:{hasAttribution:Boolean(p),attribution:(0,$.jsx)("span",{style:c.attribution,children:p})}})})]}),placement:Se.Z.Placement.Left}):null}function Cs(){return(0,$.jsx)(ks,{children:(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.moreAttribution",defaultMessage:"More people with access"})})}function ks(e){window.__c={n:"AttributionWrapper"};const{children:t}=e,{WindowSizeStore:s}=(0,n.O7)(),{paddingLeft:i,paddingRight:r}=(0,a.VK)((()=>({paddingLeft:s.getSafePaddingLeftCSS(14),paddingRight:s.getSafePaddingRightCSS(14)})),[s]),l=(0,o.yK)((e=>({label:{color:e.mediumTextColor,fontWeight:z.Z.fontWeight.medium,paddingLeft:i,paddingRight:r,paddingTop:8,paddingBottom:6}})),[i,r]);return(0,$.jsx)(m.Z,{isSmall:!0,style:l.label,children:t})}const Ts=function(e){window.__c={n:"PermissionsAttributionHeader"};const{store:t}=e,{parentStore:s,canAccessParent:i}=(0,a.VK)((()=>Z({store:t})),[t]);return i?(0,$.jsx)(ks,{children:(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.attribution",defaultMessage:"From {attribution}",values:{attribution:(0,$.jsx)(Ss,{navigableParentStore:s})}})}):(0,$.jsx)(ks,{children:(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.genericHeader",defaultMessage:"People with access"})})};var Is=s(19037);function Ps(e){window.__c={n:"RestrictedBanner"};const{store:t}=e,s=(0,n.O7)(),i=(0,a.VK)((()=>function(e){const{store:t,environment:s}=e;return Is.or([Is.zz,Is.xD([Is.c2,Is.ff(Is.zz)])])({environment:s,blocks:[t],publicEditMode:void 0})}({store:t,environment:s})),[t,s]);return(0,$.jsx)(xs,{type:"unrestrict",showRestoreButton:i,store:t,sudoModeStore:e.sudoModeStore})}function _s(e){window.__c={n:"ElevatedBanner"};const{store:t}=e;return(0,a.VK)((()=>_({store:t})),[t])?(0,$.jsx)(xs,{type:"restore-team",showRestoreButton:!1,store:t,sudoModeStore:e.sudoModeStore}):null}const Zs=function(e){window.__c={n:"PermissionsWarningBanner"};const{store:t,showRestrictedPermissionBanner:s}=e,{canAccessParent:i}=(0,a.VK)((()=>Z({store:t})),[t]);return i?s?(0,$.jsx)(Ps,{store:t,sudoModeStore:e.sudoModeStore}):(0,$.jsx)(_s,{store:t,sudoModeStore:e.sudoModeStore}):null};var Fs=s(16880),As=s(27714),Rs=s(16184),Ds=s(21213),Bs=s(98519),Ls=s(23063);function Ns(){const e=(0,n.O7)(),{currentSpaceStore:t}=(0,a.Kw)(y.default);return(0,a.VK)((()=>t?(0,as.rn)(e,t):""),[e,t])}const Os=[{key:"private",title:()=>(0,$.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"}),caption:(0,$.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:Rs.Q},{key:"unlisted",title:e=>(0,$.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.anyoneWithLink",defaultMessage:"Anyone with link at {spaceName}",values:{spaceName:e}}),caption:(0,$.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.anyoneWithLink",defaultMessage:"People invited and workspace members with link can access"}),icon:As.N},{key:"open",title:e=>(0,$.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:e}}),caption:(0,$.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspace",defaultMessage:"All workspace members can search and access"}),icon:Ds.T}];function Es(e){window.__c={n:"MobileLinkSharingPill"};const{store:t,spacePermission:s}=e,n=Us(s.permissionItem),l=(0,a.VK)((()=>t.canAdmin()),[t]),d=Ns(),c=(0,a.VK)((()=>{const e=y.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),[u,p]=(0,i.useState)(!1),g=(0,o.yK)((e=>({chevron:{width:12,fill:e.mediumIconColor,marginLeft:"auto"},button:{height:42,color:e.mediumTextColor,marginBottom:8,padding:"0 6px",marginLeft:-6,marginRight:-6,width:"100%"},icon:{fill:e.regularIconColor,width:32,height:32,backgroundColor:e.lightDividerColor,padding:6,borderRadius:4,marginRight:12},animation:{maxHeight:220},enterAnimation:{maxHeight:0},exitAnimation:{maxHeight:0},container:{overflow:"hidden"}})),[]),h=Os.find((e=>e.key===n));return h&&c?(0,$.jsxs)("div",{style:g.container,children:[(0,$.jsxs)(Ne.Z,{style:g.button,icon:h.icon,iconStyle:g.icon,disabled:!l,disabledFeedback:!0,onClick:()=>p(!u),children:[(0,$.jsxs)("div",{children:[(0,$.jsx)(m.Z,{isSmall:!0,children:(0,$.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityMobileTitle",defaultMessage:"Page visibility"})}),(0,$.jsx)(m.Z,{children:h.title(d)})]}),l&&(u?(0,Ae.i)(g.chevron):(0,Fs.R)(g.chevron))]}),(0,$.jsx)(Ls.Z,{isVisible:u,animationStyle:g.animation,enterAnimationStyle:g.enterAnimation,exitAnimationStyle:g.exitAnimation,springConfig:{maxHeight:{stiffness:60,damping:12,precision:.1}},render:()=>(0,$.jsx)(Vs,{...e,parentCloseCallback:()=>p(!1)})})]}):null}function Vs(e){window.__c={n:"PrivacyMenu"};const{store:t,spacePermission:s,sudoModeStore:r,location:l,isRestricted:d,parentCloseCallback:u}=e,p=(0,n.O7)(),g=p.device.isMobile,f=Us(s.permissionItem),x=s.from,v=x.table===w.iU?x.blockId:x.teamId,S=!(x.table===t.table&&v===t.id),b=(0,a.VK)((()=>{const{currentSpaceStore:e}=y.default.state;return!!e&&t.isTopLevelWorkspacePage(e.id)}),[t]),k=Ns(),I=(0,a.VK)((()=>{const e=function(e){const{store:t}=e;if(t.getParentTable()===C.bx)return;const s=(0,T.Om)(t);if(!s)return;const i=(0,M.Wo)((0,T.fJ)(s));for(const n of i)if((0,j.ix)(n))return n}({store:t});return e?Us(e):"private"}),[t]),P=(0,i.useRef)(null),_=(0,o.yK)((e=>{const t={width:14,fill:g?e.regularIconColor:e.mediumTextColor};return{icon:{fill:g?e.regularIconColor:e.mediumTextColor,width:16},iconContainer:{alignSelf:"center",marginLeft:g?13:9},hiddencheckmark:{...t,visibility:"hidden"},selectedCheckmark:{...t,visibility:"visible"},checkmarkContainer:{marginLeft:12},selectedTitle:{fontWeight:z.Z.fontWeight.semibold},mobileScroller:{border:`1px solid ${e.regularDividerColor}`,borderRadius:8,marginBottom:24},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${e.regularDividerColor}`},caption:{whiteSpace:"normal"}}}),[g]);return(0,$.jsx)(c.Z,{menuType:h.og.Popup,disableScroller:!0,scrollerStyle:g?_.mobileScroller:{},children:(0,$.jsx)(Le.Z,{type:Le.i.Vertical,initialFocus:void 0,sections:[{key:"visibilityOptions",render:e=>(0,$.jsx)(Oe.Z,{...e,disableDesktopPadding:g}),items:Os.map(((e,i)=>{const n=e.key,a=f===n,o=a?_.selectedCheckmark:_.hiddencheckmark,c=i!==Os.length-1,h={...g?_.mobileButton:{},...g&&c?_.mobileButtonDivider:{}};return{key:n,render:t=>(0,$.jsxs)("div",{children:["unlisted"===n&&(0,$.jsx)("div",{ref:P,children:(0,$.jsx)(Y.C8,{originRef:P})}),(0,$.jsx)(De.Z,{title:e.title(k),caption:(0,$.jsx)(m.Z,{isSmall:!0,isMultiline:!0,style:_.caption,children:e.caption}),icon:e.icon(_.icon),desktopIconStyle:_.iconContainer,titleStyle:a&&!g?_.selectedTitle:void 0,right:(0,Bs.k)(o),rightStyle:_.checkmarkContainer,style:h,...t})]}),action:()=>{if(a)return;const e=s.permissionItem,i={type:"space_permission",role:Ws(e,f,n)};"unlisted"===n&&(i.unlisted_timestamp=Date.now());const o=function(e,t){if(e===t)return!1;switch(t){case"open":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,B.t1)(t)}}(I,n)&&!d&&!b;(0,le.i)({oldPermissionItem:e,newPermissionItem:i,wasInherited:S,environment:p,store:t,sudoModeStore:r,location:l,restrictingVisibility:o}),u()}}}))}]})})}function Us(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function Ws(e,t,s){return"private"===s?"none":"private"===t?"editor":e.role}const Ks=function(e){window.__c={n:"LinkSharingPill"};const{store:t,spacePermission:s}=e,n=Us(s.permissionItem),l=(0,a.VK)((()=>t.canAdmin()),[t]),d=Ns(),c=(0,a.VK)((()=>{const e=y.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),u=(0,a.qz)(void 0,We.Z),m=(0,i.useRef)(null),p=(0,o.yK)((e=>({chevron:{width:12,marginLeft:4,fill:e.mediumIconColor},popup:{overflow:"visible",width:"100%",minWidth:430},button:{justifyContent:"center",borderRadius:32,height:32,color:e.mediumTextColor,paddingLeft:12,maxWidth:380},title:{...z.Z.textOverflowStyle},icon:{fill:e.mediumTextColor,width:16}})),[]);return c?(0,$.jsx)(Be.ZP,{buttonPopupStore:u,popupType:Be.Z4.Popup,popupWrapStyle:p.popup,renderOrigin:e=>{const t=Os.find((e=>e.key===n));return t?(0,$.jsx)(Se.Z,{placement:Se.Z.Placement.Bottom,alignment:Se.Z.Alignment.Start,disableTooltip:l,renderTooltip:()=>(0,$.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to change the privacy setting",id:"linkSharingPill.disabledTooltip.message"}),render:s=>(0,$.jsxs)(xe.Z,{...e,ref:m,style:p.button,icon:t.icon,iconStyle:p.icon,disabled:!l,disabledFeedback:!0,...s,children:[(0,$.jsx)("div",{style:p.title,children:t.title(d)}),l&&(0,Ae.i)(p.chevron),(0,$.jsx)(Y.iq,{originRef:m,handlePrimaryButtonClick:()=>{u.setState({...u.state,open:!0})}})]})}):null},placementToOrigin:Ke.Iw.Bottom,alignmentToOrigin:Ke.lU.Start,sameWidthAsOrigin:!0,render:t=>(0,$.jsx)(Vs,{...e,parentCloseCallback:()=>t.close()})}):null};var zs=s(32739),qs=s(95477);function Gs(e){window.__c={n:"MobilePageLinkButtonInner"};const{store:t,buttonPopupStore:s,events:i}=e,a=(0,n.O7)(),{device:l,mobileNative:d}=a,c=(0,o.yK)((e=>({button:{flex:1,height:36,minHeight:36}})),[]);return(0,$.jsx)(ae.Z,{onClick:()=>{l.isMobileNative?function(e){const{store:t,mobileNative:s}=e,i=(0,zs.u5)({schemeUrl:(0,je.ZP)({store:t,pageVisitSource:ue.tY.CopyLink}),baseUrl:qs.default.domainBaseUrl});s&&s.share(i)}({store:t,mobileNative:d}):Ys({store:t,buttonPopupStore:s,environment:a}),pe.V5j(a)},style:c.button,...i,children:l.isMobileNative?(0,$.jsx)(r.FormattedMessage,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):(0,$.jsx)(r.FormattedMessage,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function Hs(e){window.__c={n:"PageLinkButtonInner"};const{store:t,buttonPopupStore:s,events:i}=e,a=(0,n.O7)(),l=(0,o.yK)((e=>({button:{height:24,paddingLeft:8,paddingRight:8,color:e.regularTextColor,marginLeft:"auto"},icon:{width:14,height:14,fill:e.regularIconColor,marginLeft:0,marginRight:6},label:{color:e.regularTextColor}})),[]);return(0,$.jsxs)(Ne.Z,{isSmall:!0,onClick:()=>{Ys({store:t,buttonPopupStore:s,environment:a}),pe.V5j(a)},style:l.button,...i,children:[(0,As.N)(l.icon),(0,$.jsx)(m.Z,{isSmall:!0,style:l.label,children:(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})})]})}function Qs(e){const{calculatedPermissions:t}=e,s=t.mostPermissivePublicItem.permissionItem;if((0,j.YX)(s.role))return(0,$.jsx)(r.FormattedMessage,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const i=t.mostPermissiveSpaceItem.permissionItem;return(0,j.YX)(i.role)?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):t.permissionItemsCount>1?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Only you and other invited members and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip"}):(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function Ys(e){const{store:t,buttonPopupStore:s,environment:i}=e,n=(0,je.ZP)({store:t,pageVisitSource:ue.tY.CopyLink});await ge.RD({environment:i,stringValue:n,copiedMessage:ge.tq.copiedLinkToClipboard}),s&&s.setState({open:!1})}const $s=function(e){window.__c={n:"PageLinkButton"};const{store:t,buttonPopupStore:s,calculatedPermissions:i}=e,{device:a}=(0,n.O7)(),r=(0,o.yK)((()=>({tooltip:{width:280}})),[]);return(0,$.jsx)(Se.Z,{delayThreshold:0,placement:Se.Z.Placement.Bottom,renderTooltip:()=>(0,$.jsx)(Qs,{calculatedPermissions:i}),textWrap:!0,style:r.tooltip,render:e=>a.isMobile?(0,$.jsx)(Gs,{store:t,buttonPopupStore:s,events:e}):(0,$.jsx)(Hs,{store:t,buttonPopupStore:s,events:e})})};const Js=function(e){window.__c={n:"ShareMenuFooter"};const{isMobile:t}=(0,n.Fy)(),s=(0,o.yK)((e=>({container:{display:"flex",alignItems:t?"normal":"center",boxShadow:`0 -1px 0 ${e.regularDividerColor}`,flexDirection:t?"column":"row",justifyContent:"space-between",padding:"8px 14px"}})),[t]),{mostPermissiveSpaceItem:i,showRestrictedPermissionBanner:a}=e.calculatedPermissions;return(0,$.jsx)($.Fragment,{children:(0,$.jsxs)("div",{style:s.container,children:[t?(0,$.jsx)(Es,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:i,isRestricted:a}):(0,$.jsx)(Ks,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:i,isRestricted:a}),(0,$.jsx)($s,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]})})};var Xs=s(90965);function ei(e){window.__c={n:"UnlistedPermissionItem"};const{store:t,spacePermission:s,fromPermissionWrapper:i}=e,n=(0,o.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]);return(0,$.jsx)(Wt.Z,{icon:(0,As.N)(n.icon),iconStyle:n.iconContainer,title:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Members with the link",id:"blockPermissionsSettings.permissionItem.linkAccess"}),currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,upgradeButtonName:"space_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})}function ti(e){window.__c={n:"Title"};const{spaceStore:t}=e,s=(0,n.O7)(),i=(0,a.VK)((()=>(0,as.rn)(s,t)),[s,t]);return(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:i}})}function si(e){window.__c={n:"Subtitle"};const{spaceStore:t}=e,s=(0,a.VK)((()=>(0,Xs.t5)((0,as.jv)(t))),[t]);return(0,$.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} person} other {{numberOfWorkspaceMembers} people}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:s}})}function ii(){return(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all members in your workspace.",id:"blockPermissionsSettings.spacePermission.tooltip"})}const ni=function(e){window.__c={n:"SpacePermissionItem"};const{store:t,spacePermission:s,fromPermissionWrapper:i}=e,n=(0,a.VK)((()=>{const e=y.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),r=(0,o.yK)((()=>({container:{width:"100%"}})),[]);return n?s.permissionItem.unlisted_timestamp?(0,$.jsx)(ei,{...e}):(0,$.jsx)("div",{style:r.container,className:g.afv,children:(0,$.jsx)(Wt.Z,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:(0,$.jsx)(os.p,{disabled:!0,store:n,size:Wt.Z.iconSize}),title:(0,$.jsx)(ti,{spaceStore:n}),nonInheritedTooltip:(0,$.jsx)(ii,{}),subtitle:(0,$.jsx)(si,{spaceStore:n}),upgradeButtonName:"space_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})}):null};var ai=s(79362),oi=s(91192),ri=s(95697);function li(e){const{teamName:t,isCompact:s}=e;return s?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}):t?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:t}}):(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function di(e){const{membersCount:t,isCompact:s}=e;return s?null:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function ci(e){window.__c={n:"TeamGuestPermissionTooltip"};const{teamName:t}=e,s=(0,o.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,$.jsx)("div",{style:s.tooltip,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})}):null}const ui=function(e){var t;window.__c={n:"TeamGuestPermissionItem"};const{store:s,blockTeamGuestPermission:i,isExternalTeam:n,fromPermissionWrapper:r}=e,{permissionItem:l}=i,d=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),c=j.bm(l)?l.team_id:null===(t=T.VP(s))||void 0===t?void 0:t.id,{teamStore:u,teamIsDefined:m,teamName:p,teamIcon:h,membersCount:f}=(0,a.VK)((()=>{if(!d||!c)return{};const e=P.zX.createChildStore(d,{table:k.e0,id:c,spaceId:d.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName(),teamIcon:e.getIcon(),membersCount:(0,ri.xf)({teamStore:e,spaceStore:d}).length}:{}}),[d,c]),x=!n,v=(0,o.yK)((()=>({container:{width:"100%"}})),[]);if(!u)return null;const S=h&&ai.V2(h.icon)?ai.mk(h.icon):"gray",b=h?{...h,icon:`/icons/user-circle_${S}.svg`}:void 0;return(0,$.jsx)("div",{style:v.container,className:g.YHn,children:(0,$.jsx)(Wt.Z,{isCompact:x,currentBlockStore:s,permissionItem:l,icon:m?(0,$.jsx)(os.p,{disabled:!0,store:u,size:Wt.Z.iconSize,icon:b}):(0,oi.x)(),title:(0,$.jsx)(li,{teamName:p,isCompact:x}),nonInheritedTooltip:(0,$.jsx)(ci,{teamName:p}),from:i.from,subtitle:m&&(0,$.jsx)(di,{membersCount:f,isCompact:x}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:r,...e.permissionItemArgs})})};var mi=s(1951);function pi(e){const{teamName:t,isCompact:s}=e;return s&&t?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}):t?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Members of {teamName}",id:"blockPermissionsSettings.permissionItem.teamAccess",values:{teamName:t}}):(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function gi(e){const{membersCount:t,isCompact:s}=e;return s?null:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function hi(e){window.__c={n:"TeamMemberPermissionTooltip"};const{teamName:t}=e,s=(0,o.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,$.jsx)("div",{style:s.tooltip,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamPermission.tooltip"})}):null}const fi=function(e){var t;window.__c={n:"TeamMemberPermissionItem"};const{store:s,blockTeamPermission:i,isExternalTeam:n,fromPermissionWrapper:r}=e,{permissionItem:l}=i,d=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),c=j.zU(l)?l.team_id:null===(t=T.VP(s))||void 0===t?void 0:t.id,{teamStore:u,teamIsDefined:m,teamName:p,membersCount:h}=(0,a.VK)((()=>{if(!d||!c)return{};const e=P.zX.createChildStore(d,{table:k.e0,id:c,spaceId:d.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName(),membersCount:(0,ri.xf)({teamStore:e,spaceStore:d}).length}}),[d,c]),f=!n,x=(0,o.yK)((()=>({container:{width:"100%"}})),[]);return u?(0,$.jsx)("div",{style:x.container,className:g.YHn,children:(0,$.jsx)(Wt.Z,{isCompact:f,currentBlockStore:s,permissionItem:i.permissionItem,from:i.from,icon:m?(0,$.jsx)(os.p,{disabled:!0,store:u,size:Wt.Z.iconSize}):(0,oi.x)(),title:(0,$.jsx)(pi,{teamName:p,isCompact:f}),nonInheritedTooltip:(0,$.jsx)(hi,{teamName:(0,$.jsx)(mi.Z,{store:u,useInvertedColors:!0})}),subtitle:m&&(0,$.jsx)(gi,{membersCount:h,isCompact:f}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:r,...e.permissionItemArgs})}):null};var yi=s(79414);function xi(e){const{store:t,teamOwners:s,teamStore:i,teamName:n}=e;if(n){const e=s.map((e=>P.U6.createChildStore(t,{table:Ft.KJ,id:e})));return(0,$.jsx)(yi.n,{teamStore:i,ownerStores:e})}return(0,oi.x)()}function vi(e){const{teamName:t,isCompact:s}=e;return s&&t?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",values:{teamName:t}}):t?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Owners of {teamName}",id:"blockPermissionsSettings.permissionItem.teamOwnerAccess",values:{teamName:t}}):(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function Si(e){const{teamOwnersCount:t,isCompact:s}=e;return s||0===t?null:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:t}})}function bi(e){window.__c={n:"TeamOwnerPermissionTooltip"};const{teamName:t}=e,s=(0,o.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,$.jsx)("div",{style:s.tooltip,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:t},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})}):null}const Mi=function(e){var t;window.__c={n:"TeamOwnerPermissionItem"};const{store:s,blockTeamOwnerPermission:i,isExternalTeam:n,fromPermissionWrapper:r}=e,{permissionItem:l}=i,d=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),c=j.LW(l)?l.team_id:null===(t=T.VP(s))||void 0===t?void 0:t.id,{teamStore:u,teamName:m,teamOwners:p}=(0,a.VK)((()=>{if(!d||!c)return{undefined:void 0};const e=P.zX.createChildStore(d,{table:k.e0,id:c,spaceId:d.id});return{teamStore:e,teamName:e.getName(),teamOwners:(0,Dt.XO)({membership:e.getMembers()})}}),[d,c]),h=!n,f=(0,o.yK)((()=>({container:{width:"100%"}})),[]);return u?(0,$.jsx)("div",{style:f.container,className:g.ZmO,children:(0,$.jsx)(Wt.Z,{isCompact:h,currentBlockStore:s,permissionItem:i.permissionItem,from:i.from,icon:(0,$.jsx)(xi,{store:s,teamName:m,teamStore:u,teamOwners:p}),title:(0,$.jsx)(vi,{teamName:m,isCompact:h}),nonInheritedTooltip:(0,$.jsx)(bi,{teamName:(0,$.jsx)(mi.Z,{store:u,useInvertedColors:!0})}),subtitle:(0,$.jsx)(Si,{teamOwnersCount:p.length,isCompact:h}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:r,...e.permissionItemArgs})}):null};var ji=s(25942),wi=s(33241),Ci=s(22487);function ki(e){const{teamName:t}=e;return t?(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccess",values:{teamName:t??""}}):(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hidden"})}function Ti(e){const{membersCount:t}=e;return(0,$.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}const Ii=function(e){var t;window.__c={n:"TeamPermissionItem"};const{store:s,blockTeamMemberPermission:r,blockTeamOwnerPermission:l,blockTeamGuestPermission:d}=e,c=(0,n.O7)(),u=(0,n.Fy)(),[m,p]=(0,i.useState)(!1),{permissionItem:g}=r,h=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),f=j.zU(g)?g.team_id:null===(t=T.VP(s))||void 0===t?void 0:t.id,x=l.permissionItem.role,v=g.role,S={type:"team_overview_permission",role:x===v?v:"none"===v||"none"===x?"limited":"access"},{teamStore:b,teamIsDefined:M,teamName:C}=(0,a.VK)((()=>{if(!h||!f)return{undefined:void 0};const e=P.zX.createChildStore(h,{table:k.e0,id:f,spaceId:h.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[h,f]),I=(0,Ci.K)(b),_=(0,a.VK)((()=>{if(!h)return!1;return!h.getDisableTeamGuests()&&((null==b||!b.isDefault())&&(0,gt.F$)())}),[h,b]),Z=(0,i.useCallback)((()=>{const e=!1===m;if(p(!m),e){if(!b)return;pe.dSV(c,{share_menu_session_id:R.ZP.state.sessionId,type:"team",team_id:b.id})}}),[c,m,p,b]),F=(0,o.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor},teamPermissionsContainer:{paddingLeft:16,display:m?"block":"none"},roleButton:{marginRight:-8,color:e.mediumTextColor,fontSize:u.isMobile?14:12}})),[m,u.isMobile]),A=(0,Fs.R)(F.icon);return b?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(Wt.Z,{currentBlockStore:s,permissionItem:S,from:r.from,icon:M?(0,$.jsx)(os.p,{disabled:!0,store:b,size:Wt.Z.iconSize}):(0,oi.x)(),title:(0,$.jsx)(ki,{teamName:C}),subtitle:M&&(0,$.jsx)(Ti,{membersCount:I}),upgradeButtonName:"team_permission_item",onClick:Z,permissionRoleSelect:m?A:(0,$.jsx)(wi.d,{role:S.role,icon:ji.P,disabled:!0,buttonStyle:F.roleButton,table:w.iU,isRemovable:!1,isCurrentUser:!1}),...e.permissionItemArgs}),(0,$.jsxs)("div",{style:F.teamPermissionsContainer,children:[l&&(0,$.jsx)(Mi,{store:s,permissionItemArgs:e.permissionItemArgs,blockTeamOwnerPermission:l,fromPermissionWrapper:"expandable_permission"}),r&&(0,$.jsx)(fi,{store:s,permissionItemArgs:e.permissionItemArgs,blockTeamPermission:r,fromPermissionWrapper:"expandable_permission"}),_&&d&&(0,$.jsx)(ui,{store:s,permissionItemArgs:e.permissionItemArgs,blockTeamGuestPermission:d,fromPermissionWrapper:"expandable_permission"})]})]}):null};function Pi(e){const{store:t,permissionItemArgs:s}=e,{showTeamPermission:i,showSpacePermission:n,mostPermissiveAncestorTeamOwnerItem:a,mostPermissiveAncestorTeamMemberItem:o,mostPermissiveAncestorTeamGuestItem:r,mostPermissiveSpaceItem:l,pagePermissionUIModel:d}=e.calculatedPermissions,c=Number(i)+Number(n);return(0,$.jsxs)($.Fragment,{children:[i&&a&&o&&(0,$.jsx)(Ii,{store:t,blockTeamOwnerPermission:a,blockTeamMemberPermission:o,blockTeamGuestPermission:r,permissionItemArgs:s}),n&&(0,$.jsx)(ni,{store:t,spacePermission:l,permissionItemArgs:s,fromPermissionWrapper:"permission_list"}),(0,$.jsx)(_i,{store:t,pagePermissions:d,numberPermissionsAlreadyRendered:c,permissionItemArgs:s})]})}function _i(e){window.__c={n:"PagePermissionsList"};const t=(0,r.useIntl)(),s=(0,a.VK)((()=>{const e=y.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:i,pagePermissions:n,numberPermissionsAlreadyRendered:o,permissionItemArgs:l,showHeader:d}=e,{showUserPermissions:c,mostPermissiveGroupPermissions:u,mostPermissiveTeamPermissions:m,mostPermissiveUserPermissions:p,spacePermissionGroups:g}=n,h=(0,a.VK)((()=>Bt()),[]),f=(0,a.VK)((()=>{const e=c?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:s}=e,i={};return t.forEach((t=>{i[t.permissionItem.user_id]=(0,$.jsx)(Jt,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:s,fromPermissionWrapper:"permission_list"},t.permissionItem.user_id)})),i}({store:i,mostPermissiveUserPermissions:p,permissionItemArgs:l,spaceVisibleUserMap:h}):[];return b.oA(Object.keys(e).map((s=>{const n=P.U6.createChildStore(i,{table:Ft.KJ,id:s}),a=n.getModel();if(!n.isReady()||a)return{title:(0,At.Nz)(t,a),permissionItem:e[s]}})))}),[c,p,l,i,t,h]),x=s?function(e){const{spaceId:t,spacePermissionGroups:s,mostPermissiveGroupPermissions:i}=e,n={};return i.forEach((i=>{const a=i.permissionItem.group_id;s.find((e=>e.id===a))&&(n[a]=(0,$.jsx)(zt,{store:e.store,groupPermission:i,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),n}({store:i,spaceId:s,spacePermissionGroups:g,mostPermissiveGroupPermissions:u,permissionItemArgs:l}):[],v=function(e){const{store:t,mostPermissiveTeamPermissions:s,permissionItemArgs:i}=e;return s.map((e=>j.LW(e.permissionItem)?(0,$.jsx)(Mi,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:i,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):j.bm(e.permissionItem)?(0,$.jsx)(ui,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:i,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,$.jsx)(fi,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:i,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:i,mostPermissiveTeamPermissions:m,permissionItemArgs:l}),S=[...f,...Object.keys(x).map((e=>{const s=g.find((t=>t.id===e));return{title:s?(0,Ot.kF)({intl:t,group:s}):"",permissionItem:x[e]}}))];S.sort(((e,t)=>e.title.localeCompare(t.title)));const M=v.concat(S.map((e=>e.permissionItem))),w=M.length;if(0===w)return null;if(w>5-o){const e=Math.max(2-o,0);return(0,$.jsxs)($.Fragment,{children:[d&&(0,$.jsx)(Cs,{}),M.slice(0,e),(0,$.jsx)(es,{permissions:M.slice(e,-1)}),M[w-1]]})}return(0,$.jsxs)($.Fragment,{children:[d&&(0,$.jsx)(Cs,{}),M]})}function Zi(e,t){return e.from.table===w.iU&&e.from.blockId===t.id}const Fi=function(e){window.__c={n:"PermissionsList"};const t=(0,n.O7)(),{device:s}=t,{store:r,permissionItemArgs:l,calculatedPermissions:d}=e,{sudoModeStore:c}=l,{permissionItemsCount:u,pagePermissionUIModel:m,showRestrictedPermissionBanner:p}=d,g=(0,a.VK)((()=>{const e=y.default.state.currentSpaceStore;if(!e)return!0;if(r.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;const s=(0,T.uJ)(r);for(const i of s)if((0,Nt.OY)(i)&&i.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;return!1}),[r,t]);let h=null;const f=(0,a.VK)((()=>function(e){const{store:t,showRestrictedPermissionBanner:s}=e,{canAccessParent:i}=Z({store:t});return i&&(s||_({store:t}))}({store:r,showRestrictedPermissionBanner:p})),[r,p]),{canAccessParent:x}=(0,a.VK)((()=>Z({store:r})),[r]),v={...d};if(!f&&x){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:s,mostPermissiveTeamPermissions:i,mostPermissiveUserPermissions:n}=t,[a,o]=b.uK(s,(t=>Zi(t,e))),[r,l]=b.uK(i,(t=>Zi(t,e))),[d,c]=b.uK(n,(t=>Zi(t,e))),u={...t,mostPermissiveGroupPermissions:o,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},m={...t,mostPermissiveGroupPermissions:a,mostPermissiveTeamPermissions:r,mostPermissiveUserPermissions:d};return[u,m]}(r,m);v.pagePermissionUIModel=e,h=(0,$.jsx)(_i,{store:r,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:l,showHeader:!0})}const S=(0,a.VK)((()=>!function(e){const{store:t}=e,s=(0,T.uJ)(t),i=s.find((e=>e instanceof P.G&&e.isRestricted())),n=s[s.length-1];return i||n.getParentTable()===C.bx&&n.canRead()}({store:r})),[r]),M=s.isMobile?St.Z.None:St.Z.Y,j=(0,o.yK)((e=>({scroller:{paddingBottom:10,minHeight:s.isMobile||0===u?void 0:1===u?60:90}})),[s,u]);return(0,i.useEffect)((()=>{Rt.oE({environment:t,calculatedPermissions:d})}),[]),(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(ut.Z,{style:j.scroller,type:M,children:[!g&&(0,$.jsx)(ws,{store:r}),(0,$.jsx)(Zs,{store:r,showRestrictedPermissionBanner:p,sudoModeStore:c}),!f&&u>0&&(0,$.jsx)(Ts,{store:r}),(0,$.jsx)(Pi,{store:r,calculatedPermissions:v,permissionItemArgs:l}),h,S&&(0,$.jsx)(ss,{store:r})]}),!s.isMobile&&(0,$.jsx)(Js,{store:r,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:v,permissionItemArgs:l})]})};s(57658);var Ai=s(33728),Ri=s(58573),Di=s(59054),Bi=s(85397),Li=s(47612),Ni=s(60322),Oi=s(36591),Ei=s(36329),Vi=s(21752),Ui=s(43765),Wi=s(69507),Ki=s(70268),zi=s(98742),qi=s(35057),Gi=s(10039);function Hi(e){window.__c={n:"PublicPermissionLevelBanner"};const{publicPermission:t}=e,s=(0,o.yK)((e=>({banner:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},label:{fontSize:12,display:"inline-flex",marginRight:10},icon:{height:20,width:20,marginLeft:14,marginRight:8,color:e.mediumIconColor},manageButton:{color:e.regularTextColor,fontWeight:z.Z.fontWeight.medium}})),[]),i=t.permissionItem.role;return j.YX(i)?(0,$.jsxs)("div",{style:s.banner,children:[(0,$.jsxs)(m.Z,{style:s.label,children:[(0,W.I)(s.icon),(0,$.jsx)(Qi,{role:i})]}),(0,$.jsx)(cs.Z,{style:s.manageButton,onClick:()=>R.ZP.setState({...R.ZP.state,display:R.wV.Publish,tab:R.XF.Publish}),children:(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Manage"})})]}):null}function Qi(e){const{role:t}=e;switch(t){case"read_and_write":return(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,B.t1)(t)}}function Yi(e){window.__c={n:"ShareMenuSearchRequestImpl"};const{store:t,shouldShowSlackOnly:s,calculatedPermissions:i,permissionItemArgs:l,tokenQuery:d,showShimmer:c,error:u,ready:m,result:p}=e,g=i.pagePermissionUIModel,h=(0,n.O7)(),f=(0,a.qz)(e.inviteTargetsStore,L.ZP),x=(0,a.qz)(e.menuListStore,Mt.Z),v=(0,a.VK)((()=>Bt()),[]),S=(0,a.VK)((()=>gt.Rv()),[]),b=(0,o.yK)((e=>({sectionMenuItem:{paddingTop:0,display:"flex",flexDirection:"column",gap:2},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:110},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:54,width:54,marginBottom:12,fill:e.mediumIconColor},arrowUpLeftIcon:{width:12,height:12,marginRight:3,marginTop:3,color:"#C7C6C4"}})),[]),{inPageTargets:M,notInPageTargets:C,filteredImportedContacts:k}=(0,a.VK)((()=>{const{inviteUsers:e,inviteGroups:s,importedContacts:n=[]}=p??{inviteUsers:[],inviteGroups:[],importedContacts:[]},a=[...e,...s],o=[],r=[],l=new Set;a.forEach((e=>{"group"!==e.type&&l.add(e.value.email.toLowerCase());const s=Boolean(yt.Zp({store:t,target:e})),n=function(e){const{inviteTarget:t,blockStore:s,spacePermission:i,teamMemberPermission:n,groupPermission:a}=e,o=t.type;if("newUser"===o)return{role:"none",type:"user_permission",user_id:t.value.email};if("existingUser"===o)return I.uY({userId:t.value.id,store:s});if("group"===o){const e={role:"none",type:"group_permission",group_id:t.value.id},o=(0,T.VP)(s),r=null==o?void 0:o.getMembers().find((e=>(0,Dt.lF)({groupId:t.value.id,teamMember:e})));return[i,...o&&n&&r?[n]:[],a||{permissionItem:e,from:{table:w.iU,blockId:s.id}}].sort(((e,t)=>j.xm[t.permissionItem.role]-j.xm[e.permissionItem.role]))}(0,B.t1)(o)}({inviteTarget:e,blockStore:t,spacePermission:i.mostPermissiveSpaceItem,teamMemberPermission:i.mostPermissiveAncestorTeamMemberItem,groupPermission:"group"===e.type?g.mostPermissiveGroupPermissions.find((t=>t.permissionItem.group_id===e.value.id)):void 0}),a=Array.isArray(n)?n[0].permissionItem:n;if("existingUser"===e.type&&!Boolean(e.spaceRole)){const t=v.get(e.value.id);e.spaceRole=t?t.role:"not_in_space"}(s||j.YX(a.role??"none"))&&"newUser"!==e.type?o.push({inviteTarget:e,permissionItem:a,mostPermissivePermissions:Array.isArray(n)?n:void 0}):"newUser"!==e.type&&r.push(e)}));const d=n.filter((e=>!l.has(e.value.email.toLowerCase())));return{inPageTargets:o,notInPageTargets:r,filteredImportedContacts:d}}),[t,p,i.mostPermissiveSpaceItem,i.mostPermissiveAncestorTeamMemberItem,g.mostPermissiveGroupPermissions,v]),{isValidEmail:_,isEmailInTargets:Z}=(0,a.VK)((()=>{const e=(0,Ai.H3)(d);return{isValidEmail:(0,Ai.oH)(e),isEmailInTargets:[...M.map((e=>{let{inviteTarget:t}=e;return t})),...C].some((t=>"group"!==t.type&&t.value.email===e))}}),[d,M,C]),F=_&&!Z,A=!s&&C.length>0&&0===d.length,R=!s&&d.length>0&&M.length>0,D=!s&&C.length>0&&d.length>0,N=S&&k.length>0,O={key:"imported contacts",render:e=>(0,$.jsx)(Oe.Z,{...e,style:b.sectionMenuItem,title:(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.importedContactsSection.title",defaultMessage:"From Slack"}),loading:!m}),items:k.map(((e,s)=>({key:e.value.email,render:s=>(0,$.jsx)(rn,{...s,invited:!1,inviteTarget:e,isInInviteTargets:ft.H({target:e,inviteTargetsStore:f}),blockStore:t,spaceVisibleUserMap:v}),action:()=>{ft.H({target:e,inviteTargetsStore:f})?f.setState({...f.state,inviteTargets:f.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(pe.hEo(h,{invite_token_query:d,selected_user_token:e,selected_user_token_rank:s,from:"share_modal_invite",subscription_tier:(0,qi.zt)(),type:"slack"}),f.setState({inviteTargets:[...f.state.inviteTargets,e],tokenQuery:""}),x.unsetFocus())}})))},{shouldShowAutoFillEmail:E,showGuestVsMemberTag:V}=(0,a.VK)((()=>{if(F){return{shouldShowAutoFillEmail:"control"!==gt.uD(),showGuestVsMemberTag:!1}}if(A||R||D||N||s)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};if(s&&0===O.items.length)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};if(0===d.length)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};return{shouldShowAutoFillEmail:"control"!==gt.uD(),showGuestVsMemberTag:!1}}),[F,A,R,D,N,s,O.items.length,d]),U=(0,a.VK)((()=>{const{data:e}=jt.default.state,{currentSpaceStore:t}=y.default.state;return t&&e?Ie.hn(e).map((s=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(s.userId)){const e=P.U6.createChildStore(t,{table:Ft.KJ,id:s.userId}).getEmail();return e&&(0,Ai.Gd)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]),W=(0,xt.Z)(t);if(u)return(0,$.jsx)(Wi.l,{loading:!m,children:(0,$.jsx)(Ui.Z,{title:(0,$.jsx)(r.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!m&&c)return(0,$.jsx)(Ki.B,{areaHeight:window.innerHeight});const K={key:"user results",render:e=>(0,$.jsx)(Oe.Z,{...e,style:b.sectionMenuItem,loading:!m,title:(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:un({tokenQuery:d,possibleDomains:U,showGuestVsMemberTag:V,shouldShowAutoFillEmail:E,isGuestInviteRequestRequired:W.isGuestRequestRequired,environment:h,inviteTargetsStore:f,menuListStore:x,store:t,styles:b})},z={key:"suggested",render:e=>(0,$.jsx)(Oe.Z,{...e,style:b.sectionMenuItem,title:(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!m}),items:C.map(((e,s)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:s=>{const i=ft.H({target:e,inviteTargetsStore:f});return(0,$.jsx)(rn,{...s,invited:!1,inviteTarget:e,isInInviteTargets:i,blockStore:t,spaceVisibleUserMap:v})},action:()=>$i({inviteTarget:e,inviteTargetsStore:f,menuListStore:x,rank:s,tokenQuery:d,environment:h,type:"suggested"})})))},q={key:"in page",render:e=>(0,$.jsx)(Oe.Z,{...e,style:b.sectionMenuItem,title:(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!m}),items:M.map(((e,s)=>{const{inviteTarget:i,permissionItem:n,mostPermissivePermissions:a}=e,{type:o}=i;if("existingUser"===o){if(!!a&&a.length>1)return{key:i.value.id,render:e=>(0,$.jsx)(en,{...e,blockStore:t,inviteTarget:i,permissionItem:n,mostPermissivePermissions:a,spaceVisibleUserMap:v,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>{}};{const e=g.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===i.value.id));return e?{key:i.value.id,render:s=>(0,$.jsx)(De.Z,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,$.jsx)(Jt,{store:t,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:v,permissionItemArgs:l})}),action:()=>{}}:{key:i.value.id,render:e=>(0,$.jsx)(en,{...e,blockStore:t,inviteTarget:i,permissionItem:n,spaceVisibleUserMap:v,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>$i({inviteTarget:i,inviteTargetsStore:f,menuListStore:x,rank:s,tokenQuery:d,environment:h,type:"in_page"})}}}if("group"===o){if(!!a&&a.length>1)return{key:i.value.id,render:a=>(0,$.jsx)(en,{...a,blockStore:t,inviteTarget:i,permissionItem:n,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:v,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>{}};{const e=g.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===i.value.id));return e?{key:i.value.id,render:s=>(0,$.jsx)(De.Z,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,$.jsx)(zt,{store:t,groupPermission:e,spaceId:t.getSpaceId(),showInherited:!0,permissionItemArgs:l})}),action:()=>{}}:{key:i.value.id,render:e=>(0,$.jsx)(en,{...e,blockStore:t,inviteTarget:i,permissionItem:n,spaceVisibleUserMap:v,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>$i({inviteTarget:i,inviteTargetsStore:f,menuListStore:x,rank:s,tokenQuery:d,environment:h,type:"in_page"})}}}(0,B.t1)(o)}))},G={key:"not in page",render:e=>(0,$.jsx)(Oe.Z,{...e,style:b.sectionMenuItem,title:d.length>0&&(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"}),loading:!m}),items:C.map(((e,s)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:s=>(0,$.jsx)(rn,{...s,invited:!1,inviteTarget:e,isInInviteTargets:ft.H({target:e,inviteTargetsStore:f}),blockStore:t,spaceVisibleUserMap:v}),action:()=>$i({inviteTarget:e,inviteTargetsStore:f,menuListStore:x,rank:s,tokenQuery:d,environment:h,type:"not_in_page"})})))};let H=[];return F&&H.push(K),A&&H.push(z),R&&H.push(q),D&&H.push(G),N&&H.push(O),s&&(H=[O],0===O.items.length)?(0,$.jsx)(ln,{styles:b}):0===H.length&&(H=[K],0===d.length)?(0,$.jsx)(dn,{styles:b,shouldShowSlackMessage:S}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(Hi,{publicPermission:i.mostPermissivePublicItem}),(0,$.jsx)(Le.Z,{type:Le.i.Vertical,initialFocus:d.length>0?0:void 0,sections:H,store:x})]})}function $i(e){const{inviteTarget:t,inviteTargetsStore:s,menuListStore:i,rank:n,tokenQuery:a,environment:o,type:r}=e;if(ft.H({target:t,inviteTargetsStore:s})){const e=s.state.inviteTargets.filter((e=>"group"===t.type&&"group"===e.type||"existingUser"===t.type&&"existingUser"===e.type?t.value.id!==e.value.id:"newUser"!==t.type||"newUser"!==e.type||t.value.email!==e.value.email));return s.setState({...s.state,inviteTargets:e}),void i.unsetFocus()}pe.hEo(o,{invite_token_query:a,selected_user_token:t,selected_user_token_rank:n,from:"share_modal_invite",subscription_tier:(0,qi.zt)(),type:r}),s.setState({inviteTargets:[...s.state.inviteTargets,t],tokenQuery:""}),i.unsetFocus()}const Ji=i.forwardRef(((e,t)=>{window.__c={n:"InPageGroupResultItem"};const{blockStore:s,inviteTarget:l,permissionItem:d,mostPermissivePermissions:c,permissionItemArgs:u}=e,p=(0,n.O7)(),g=(0,r.useIntl)(),[h,f]=(0,i.useState)(!1),x=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),v=(0,a.VK)((()=>s.getSpaceId()),[s]),S=(0,a.VK)((()=>c&&c.length>0),[c]),b=(0,a.VK)((()=>{if("group"===l.type)return(0,Ot.kF)({group:l.value,intl:g})}),[l,g]),M=(0,a.VK)((()=>{if(x&&"group"===l.type&&l.value.icon)return{pointer:{table:x.table,id:x.id},icon:l.value.icon}}),[x,l]),j=(0,a.VK)((()=>x?"group"!==l.type?0:(0,Ot.rm)({group:l.value,spaceStore:x,limit:void 0}).totalNumberMembers:0),[x,l]),C=(0,i.useCallback)((()=>{if(S){const e=!1===h;f(!h),e&&pe.dSV(p,{share_menu_session_id:R.ZP.state.sessionId,type:"group",group_id:l.value.id})}}),[p,S,h,f,l]),k=(0,o.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10},permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:z.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,$.jsx)(Se.Z,{delayThreshold:0,placement:Se.Z.Placement.Left,textWrap:!0,style:k.tooltip,renderTooltip:()=>(0,$.jsx)(tn,{blockStore:s,blockPermissionItem:d}),render:i=>(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)("div",{...i,children:(0,$.jsx)(De.Z,{...e,...(0,zi.Z)(e,{onClick:C}),ref:t,title:(0,$.jsxs)("div",{style:k.titleContainer,children:[(0,$.jsx)(Et.Z,{size:32}),(0,$.jsxs)("div",{style:k.groupInfoContainer,children:[(0,$.jsxs)("div",{style:k.nameAndIconContainer,children:[(0,$.jsx)(m.Z,{style:k.groupNameLabel,children:b}),Boolean(null==M?void 0:M.icon)&&(0,$.jsx)(Vt.Z,{disabled:!0,bucket:"public",title:b,icon:M,size:18,isEmptyPage:!1})]}),(0,$.jsx)(m.Z,{isSmall:!0,style:k.groupMembersLabel,children:S&&h?(0,$.jsx)(sn,{}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,$.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:j}})]})})]})]}),right:(0,$.jsx)(wi.d,{table:w.iU,disabled:!0,icon:S?h?Fs.R:ji.P:void 0,role:d.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:k.permissionRoleButton})})}),S&&h&&(0,$.jsx)("div",{style:k.expandablePermissionList,children:null==c?void 0:c.map(((e,t)=>{const i=e.permissionItem.type;let n=null;switch(i){case"space_permission":n=(0,$.jsx)(ni,{store:s,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":n=(0,$.jsx)(fi,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":n=(0,$.jsx)(zt,{spaceId:v,store:s,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":break;case"explicit_team_owner_permission":case"explicit_team_guest_permission":break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":break;case"team_owner_permission":case"team_permission":break;default:(0,B.t1)(i)}return(0,$.jsx)("div",{style:k.roundedPermissionItem,children:n},t)}))})]})})})),Xi=i.forwardRef(((e,t)=>{window.__c={n:"InPageUserResultItem"};const{blockStore:s,inviteTarget:r,permissionItem:l,mostPermissivePermissions:d,spaceVisibleUserMap:c,permissionItemArgs:u}=e,m=(0,n.O7)(),[p,g]=(0,i.useState)(!1),h="existingUser"===r.type?P.U6.createChildStore(s,{table:Ft.KJ,id:r.value.id}):void 0,f=(0,a.VK)((()=>"none"===r.spaceRole?Lt({spaceVisibleUserMap:c,userId:r.value.id,blockStore:s}):(0,Vi.K)(r.spaceRole)),[r,c,s]),y=(0,a.VK)((()=>s.getSpaceId()),[s]),x=(0,a.VK)((()=>d&&d.length>0),[d]),v=(0,i.useCallback)((()=>{const e=!1===p;g(!p),e&&pe.dSV(m,{share_menu_session_id:R.ZP.state.sessionId,type:"user",userId:r.value.id})}),[m,p,g,r]),S=(0,o.yK)((e=>({permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:z.Z.fontWeight.bold},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:24},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,$.jsx)(Se.Z,{delayThreshold:0,placement:Se.Z.Placement.Left,textWrap:!0,style:S.tooltip,renderTooltip:()=>(0,$.jsx)(tn,{blockStore:s,blockPermissionItem:l}),render:i=>(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)("div",{...i,children:(0,$.jsx)(De.Z,{...e,...(0,zi.Z)(e,{onClick:v}),ref:t,title:(0,$.jsx)(Vi.Z,{isLarge:!0,actorStore:h,containerStyle:S.cellMemberAvatarContainer,spaceRole:f,caption:x&&p?(0,$.jsx)(sn,{}):void 0}),right:(0,$.jsx)(wi.d,{table:w.iU,disabled:!0,icon:x?p?Fs.R:ji.P:void 0,role:l.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:S.permissionRoleButton})})}),x&&p&&(0,$.jsx)("div",{style:S.expandablePermissionList,children:null==d?void 0:d.map(((e,t)=>{const i=e.permissionItem.type;let n=null;switch(i){case"space_permission":n=(0,$.jsx)(ni,{store:s,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_owner_permission":n=(0,$.jsx)(Mi,{store:s,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":n=(0,$.jsx)(fi,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":n=(0,$.jsx)(ui,{store:s,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":n=(0,$.jsx)(zt,{store:s,spaceId:y,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":n=(0,$.jsx)(Jt,{store:s,userPermission:e,permissionItemArgs:u,spaceVisibleUserMap:c,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":break;case"team_owner_permission":case"team_permission":break;default:(0,B.t1)(i)}return(0,$.jsx)("div",{style:S.roundedPermissionItem,children:n},t)}))})]})})})),en=i.forwardRef(((e,t)=>{const{inviteTarget:s}=e,i=s.type;switch(i){case"group":return(0,$.jsx)(Ji,{...e,ref:t,inviteTarget:s});case"existingUser":return(0,$.jsx)(Xi,{...e,ref:t,inviteTarget:s});default:(0,B.t1)(i)}}));function tn(e){window.__c={n:"InPageItemTooltip"};const{blockStore:t,blockPermissionItem:s}=e,i=(0,n.O7)(),l=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),d=(0,a.VK)((()=>{if(l)return(0,as.Wd)(i,l)}),[i,l]),c=(0,a.VK)((()=>{const e=s.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return P.zX.createChildStore(t,{table:k.e0,id:s.team_id})}}),[t,s]),u=(0,a.VK)((()=>null==c?void 0:c.getIcon()),[c]),m=(0,o.yK)((()=>({container:{fontWeight:z.Z.fontWeight.bold,...z.Z.textOverflowStyle},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),p=s.type;return"space_permission"===p?(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:(0,$.jsxs)("span",{style:m.container,children:[d&&(0,$.jsx)(Vt.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:12,style:m.recordIcon}),l&&(0,$.jsx)(ds.Z,{store:l,style:m.recordTitle})]})}}):"explicit_team_owner_permission"===p?(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:(0,$.jsxs)("span",{style:m.container,children:[u&&(0,$.jsx)(Vt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,$.jsx)(ds.Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_permission"===p?(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:(0,$.jsxs)("span",{style:m.container,children:[u&&(0,$.jsx)(Vt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,$.jsx)(ds.Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_guest_permission"===p?(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:(0,$.jsxs)("span",{style:m.container,children:[u&&(0,$.jsx)(Vt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,$.jsx)(ds.Z,{store:c,style:m.recordTitle})]})}}):"group_permission"===p?(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===p||"exclusive_user_permission"===p||"public_permission"===p||"restricted_permission"===p||"deleted_permission"===p||"team_permission"===p||"team_owner_permission"===p||"bot_permission"===p?(0,$.jsx)($.Fragment,{children:j.YX(s.role??"none")&&(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})}):void(0,B.t1)(p)}function sn(){return(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function nn(e){window.__c={n:"CircleCheckmark"};const{checked:t}=e,s=(0,o.yK)((e=>({circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:22,height:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,borderColor:t?O.ZP.blue:e.buttonPressedBackground,backgroundColor:t?O.ZP.blue:"transparent",marginRight:6},checkIcon:{height:12,width:12,color:"white"}})),[t]);return(0,$.jsx)("div",{style:s.circleCheckmark,children:t&&(0,Oi.e)(s.checkIcon)})}const an=i.forwardRef(((e,t)=>{window.__c={n:"NotInPageGroupResultItem"};const{inviteTarget:s,isInInviteTargets:i,disabled:n}=e,l=(0,r.useIntl)(),d=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),c=(0,a.VK)((()=>(0,Ot.kF)({group:s.value,intl:l})),[s,l]),u=(0,a.VK)((()=>{if(d&&s.value.icon)return{pointer:{table:d.table,id:d.id},icon:s.value.icon}}),[d,s]),p=(0,a.VK)((()=>{if(!d)return 0;return(0,Ot.rm)({group:s.value,spaceStore:d,limit:void 0}).totalNumberMembers}),[d,s]),g=(0,o.yK)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[]),h=(0,$.jsxs)("div",{style:g.titleContainer,children:[(0,$.jsx)(Et.Z,{size:32}),(0,$.jsxs)("div",{style:g.groupInfoContainer,children:[(0,$.jsxs)("div",{style:g.nameAndIconContainer,children:[(0,$.jsx)(m.Z,{style:g.groupNameLabel,children:c}),Boolean(null==u?void 0:u.icon)&&(0,$.jsx)(Vt.Z,{disabled:!0,bucket:"public",title:c,icon:u,size:18,isEmptyPage:!1})]}),(0,$.jsxs)(m.Z,{isSmall:!0,style:g.groupMembersLabel,children:[(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,$.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:p}})]})]})]});return(0,$.jsx)(De.Z,{...e,ref:t,title:h,right:(0,$.jsx)(nn,{checked:i}),disabled:n})})),on=i.forwardRef(((e,t)=>{window.__c={n:"NotInPageUserResultItem"};const{inviteTarget:s,blockStore:n,isInInviteTargets:r,disabled:l,spaceVisibleUserMap:d,...c}=e,u=(0,o.yK)((()=>({cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[]),m=(0,a.VK)((()=>"existingUser"===s.type?Lt({spaceVisibleUserMap:d,userId:s.value.id,blockStore:n}):void 0),[s,d,n]),p=(0,i.useMemo)((()=>"existingUser"===s.type?{actorStore:P.U6.createChildStore(n,{table:Ft.KJ,id:s.value.id}),avatar:void 0}:"newUser"===s.type?{actorStore:void 0,avatar:{email:s.value.email,name:"slack"===s.source?s.value.name:void 0,avatarUrl:"slack"===s.source?s.value.avatar_url:void 0}}:void(0,B.t1)(s)),[s,n]);return(0,$.jsx)(De.Z,{...c,ref:t,title:(0,$.jsx)(Vi.Z,{isLarge:!0,...p,containerStyle:u.cellMemberAvatarContainer,avatarBadge:"newUser"===s.type&&"slack"===s.source?(0,$.jsx)(G.Z,{type:"image_url",imageURL:N.Z.images.externalIntegrations.slackIconPng,size:18,style:u.iconBox,imageStyle:u.iconBoxImage}):void 0,spaceRole:m}),disabled:l,right:!l&&(0,$.jsx)(nn,{checked:r})})})),rn=i.forwardRef(((e,t)=>{const{inviteTarget:s,blockStore:i,spaceVisibleUserMap:n}=e,a=s.type;switch(a){case"group":return(0,$.jsx)(an,{...e,ref:t,inviteTarget:s});case"newUser":case"existingUser":return(0,$.jsx)(on,{...e,ref:t,inviteTarget:s,blockStore:i,spaceVisibleUserMap:n});default:(0,B.t1)(a)}}));function ln(e){const{styles:t}=e;return(0,$.jsxs)("div",{style:t.zeroState,children:[(0,Ei._)(t.zeroStateIcon),(0,$.jsxs)("div",{style:t.zeroStateText,children:[(0,$.jsx)("div",{style:{fontWeight:z.Z.fontWeight.semibold,marginBottom:4},children:(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,$.jsx)("div",{children:(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different Slack workspace or typing an email address"})})]})]})}function dn(e){const{styles:t,shouldShowSlackMessage:s}=e;return(0,$.jsxs)("div",{style:t.zeroState,children:[(0,Li.C)(t.zeroStateIcon),(0,$.jsxs)("div",{style:t.zeroStateText,children:[(0,$.jsx)("div",{style:{fontWeight:z.Z.fontWeight.semibold,marginBottom:4},children:(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Search or add people"})}),(0,$.jsx)("div",{children:s?(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try connecting a Slack workspace or typing an email address"}):(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.defaultText",defaultMessage:"Try typing an email address"})})]})]})}function cn(e){let{tokenQuery:t,possibleDomains:s,shouldShowAutoFillEmail:i}=e;const n=(0,Ri.ZP)(t,function(e,t,s){return s?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,s)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:s}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,s,i),(e=>e.tokenQuery));return 0===n.length?[{tokenQuery:t,weight:0}]:n}function un(e){let{tokenQuery:t,possibleDomains:s,showGuestVsMemberTag:i,isGuestInviteRequestRequired:n,shouldShowAutoFillEmail:a,environment:o,inviteTargetsStore:l,menuListStore:d,store:c,styles:u}=e;return cn({tokenQuery:t,possibleDomains:s,shouldShowAutoFillEmail:a}).map(((e,s)=>({key:e.tokenQuery,render:t=>(0,$.jsx)(De.Z,{icon:(0,Bi.a)({width:24,height:24}),title:(0,$.jsx)(mn,{tokenQuery:e.tokenQuery,shouldShowAutofillEmail:a,isGuestInviteRequestRequired:n}),caption:n?(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:(0,$.jsxs)($.Fragment,{children:[a?(0,Ni.y)(u.arrowUpLeftIcon):null,i?(0,$.jsx)(Gi.Z,{store:c,onlyShowTokenType:!0,showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e.tokenQuery},spaceRole:"not_in_space"}},e.tokenQuery):null]}),rightStyle:{marginRight:4},...t}),action:async()=>{const i=(0,Ai.H3)(e.tokenQuery);if(!(0,Ai.oH)(i)){if(gt.Lm()){const t={type:"invalidUser",value:{text:e.tokenQuery}};ft.H({target:t,inviteTargetsStore:l})||l.setState({inviteTargets:[...l.state.inviteTargets,t],tokenQuery:""})}return}const n=await dt.M5(o,[i]);if(!n.length)return;const a=n[0];ft.H({target:a,inviteTargetsStore:l})||(pe.hEo(o,{invite_token_query:t,selected_user_token:a,selected_user_token_rank:s,from:"share_modal_invite",subscription_tier:(0,qi.zt)(),type:"autofill"}),l.setState({inviteTargets:[...l.state.inviteTargets,a],tokenQuery:""}),d.unsetFocus())}})))}function mn(e){const{tokenQuery:t,shouldShowAutofillEmail:s,isGuestInviteRequestRequired:i}=e;return i?(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):s?(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"”{tokenQuery}”",values:{tokenQuery:t}}):(0,$.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const pn=function(e){window.__c={n:"ShareMenuSearchRequest"};const t=(0,n.O7)(),s=(0,r.useIntl)(),[o,l]=(0,i.useState)(!0),d=(0,a.VK)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,a.VK)((()=>{if(e.shouldShowSlackOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=bt.Z.completeSlackAuthentications.state.length>0&&gt.Rv();return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly]),[{value:u,status:m}]=(0,Di.r5)((async()=>dt.jL({query:d,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:s}).finally((()=>l(!1)))),[t,s,e.membersOnly,d,c],{debounce:40});return(0,$.jsx)(Yi,{...e,tokenQuery:d,showShimmer:o,ready:"pending"!==m,error:"rejected"===m,result:u})};function gn(e){window.__c={n:"InviteContent"};const t=(0,n.O7)(),s=(0,a.qz)(e.inviteTargetsStore,L.ZP),l=(0,a.VK)((()=>s.state.inviteTargets),[s]),{display:d,source:c,focus:u,emailMessage:m}=(0,a.VK)((()=>{const{display:e}=R.ZP.state;return e===R.wV.Invite?R.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),p=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),g=(0,a.VK)((()=>c===R.T5.Notion&&0===l.length&&(0,gt.Rv)()),[l.length,c]),h=(0,a.VK)((()=>bt.Z.completeSlackAuthentications.state),[]),f=(0,i.useCallback)((()=>{s.reset()}),[s]),[x,v]=(0,i.useState)(!1);(0,i.useEffect)((()=>{if(p&&!x&&g){for(const e of h)lt.loadContacts(t,{botId:e.id,spaceId:p.id,integrationId:ot.nO}).catch((e=>{}));v(!0)}}),[g]);const S=d===R.wV.Invite&&l.length>0,b=(0,o.yK)((e=>({scroller:{flexGrow:1},integrationName:{display:"flex"},integrationIcon:{marginRight:4},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9}})),[]);return d!==R.wV.Invite?null:(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(ut.Z,{type:St.Z.Y,style:b.scroller,children:(0,$.jsx)(pn,{inviteTargetsStore:s,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:c===R.T5.Slack,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})}),g&&(0,$.jsx)(Ct.Z,{onClickAuthenticated:()=>{R.ZP.setState({...R.ZP.state,tab:R.XF.Share,display:R.wV.Invite,focus:R.Sw.Search,source:R.T5.Slack,emailMessage:m}),s.setState({...s.state,tokenQuery:""})},title:function(){const e=(0,$.jsxs)("div",{style:b.integrationName,children:[(0,$.jsx)(G.Z,{type:"image_url",imageURL:N.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:b.integrationIcon}),(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"importContactsButton.integrationName"})]});return(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",values:{integrationNameWithLogo:e}})}(),containerStyle:b.importContactsContainer,buttonStyle:b.importContactsButton,from:"share_menu",inviteOrigin:"page_share_modal",flowId:e.flowId,loadContacts:!0}),(0,$.jsx)(xn,{open:S&&!g,focus:u===R.Sw.Message,value:m,onFocus:()=>{c&&d===R.wV.Invite&&R.ZP.setState({...R.ZP.state,focus:R.Sw.Message,tab:R.XF.Share,display:d,source:c,emailMessage:m})},onChange:e=>{R.ZP.setState({...R.ZP.state,focus:u,tab:R.XF.Share,display:d,source:c,emailMessage:e.target.value})},onCancel:async()=>{await wt.zd({environment:t,inviteTargetsStore:s})&&(wt.a6(t),f())},maxLength:1e3})]})}function hn(e){window.__c={n:"InviteSection"};const{store:t,menuListStore:s,sudoModeStore:l,contextualInviteStore:d}=e,c=(0,n.O7)(),u=(0,r.useIntl)(),m=(0,a.qz)(e.inviteTargetsStore,L.ZP),{display:p,source:g,focus:h,emailMessage:f}=(0,a.VK)((()=>{const{display:e}=R.ZP.state;return e===R.wV.Invite?R.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),x=()=>{m.reset(),R.ZP.setState({...R.ZP.state,tab:R.XF.Share,display:R.wV.MainShareMenu})},[S,b]=(0,i.useState)("editor"),M=(0,a.VK)((()=>t.getType()),[t]),j=(0,a.VK)((()=>d.state.flowId),[d]),w=(0,a.VK)((()=>(0,ft.B)({inviteTargetsStore:m})),[m]),C=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),k=(0,a.VK)((()=>new Set(null==C?void 0:C.getEmailDomains())),[C]),T=(0,a.VK)((()=>{const{data:e}=jt.default.state,t=e?Ie.CM(e):[],s={};return t.forEach((e=>{s[e.userId]=e})),s}),[]),P=e=>!ht.$s({contextualInviteUser:e,allowedDomains:k}),_=(0,a.VK)((()=>t.canEditMembership()),[t]),Z=(0,a.VK)((()=>{const e=w.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),t=w.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return I.dA(c,[...e,...t])}),[c,w]),F=(0,xt.Z)(t),A=(0,a.VK)((()=>{if(F.isGuestRequestRequired)return!1;const e=F.isStoreInTeam&&!F.teamAllowsGuests,t=!F.isStoreInTeam&&!F.spaceAllowsGuests||F.isStoreInTeam&&!F.teamAllowsGuests&&!F.spaceAllowsGuests,s=w.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&s}),[w,F]),D=(0,a.VK)((()=>{const e=w.some(yt.OA);return F.isGuestRequestRequired&&e}),[w,F]),N=(0,a.VK)((()=>{const{currentSpaceStore:e}=y.default.state;return(0,gt.gp)({currentSpaceStore:e})}),[]),E=(0,i.useCallback)((e=>{const t=e.type;if("existingUser"===t){const t=T[e.value.id];if(!t)return!0;return"none"===t.role&&!t.isTeamGuest&&t.isPageGuest}return"newUser"===t||"group"!==t&&void 0}),[T]),V=(0,a.VK)((()=>{if(!C)return"control";if(!(0,ht.ch)({environment:c,spaceStore:C,contextualInviteStore:d}))return"control";return w.filter(E).length>0?(0,gt.kG)(c):"control"}),[w,c,E,C,d]),U=(0,vt.S)(t),W=f.length>1e3,K=w.length>0,z=(0,o.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:4,color:O.ZP.uiGray}})),[]);async function q(){const e=w.filter(E),s=w.filter((e=>!E(e)));"control"===V?await wt.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:S,emailMessage:f,inviteTargetsStore:m,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{x(),(e=>{d.setState({...d.state,invitedUsers:e.filter(E).map(ht.Si).filter(B.$K).filter(P)}),C&&ht.fr({environment:c,spaceStore:C,contextualInviteStore:d})})(w)},onInviteComplete:(e,t)=>wt.Cv({success:e,requestedUserEmails:t,inviteTargets:w})}):(s.length>0&&(m.setState({...m.state,inviteTargets:s}),await wt.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:S,emailMessage:f,inviteTargetsStore:m,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{m.reset()},onInviteComplete:(e,t)=>wt.Cv({success:e,requestedUserEmails:t,inviteTargets:s})})),((e,t,s,i)=>{d.setState({...d.state,invitedUsers:e.filter(E).map(ht.Si).filter(B.$K).filter(P),inviteTargets:e,shareModalGuestMemberConfirmationExpGroup:t,callbackAsyncFn:s,resetShareMenuFn:i}),C&&(ht.fr({environment:c,spaceStore:C,contextualInviteStore:d}),d.setState({...d.state,selection:v.uq.closed}))})(w,V,(async()=>(m.setState({...m.state,inviteTargets:e}),await wt.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:S,emailMessage:f,inviteTargetsStore:m,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{x()},onInviteComplete:(t,s)=>wt.Cv({success:t,requestedUserEmails:s,inviteTargets:e})}))),(()=>{x()})))}async function G(){void 0===s.state.focus.indexGlobal&&void 0===s.state.focus.indexLocal&&void 0===s.state.focus.section&&((0,gt.Lm)()&&w.length<1||await q())}let H;return H=A||D?U:W?(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,(0,$.jsx)(Se.Z,{disableTooltip:_,renderTooltip:()=>{if(!_)return(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>(0,$.jsxs)("div",{style:{display:"flex"},...e,children:[(0,$.jsx)(kt.Z,{store:t,inviteTargetsStore:m,flowId:j,disabled:!_,origin:"page_contextual_invite",focus:h===R.Sw.Search,hideIconColorAndTooltips:"control"!==V,onFocus:()=>{R.ZP.setState({...R.ZP.state,tab:R.XF.Share,display:R.wV.Invite,focus:R.Sw.Search,source:g||R.T5.Notion,emailMessage:f||""}),pe.yEH(c,{source:g||R.T5.Notion})},onSubmit:G,placeholder:N?u.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}):u.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder",defaultMessage:"Add people, groups, or emails..."}),right:K&&(0,$.jsx)(mt.ZP,{disabled:!_,role:S,table:"block",type:"user_permission",blockType:M,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:z.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>b(e)})}),Z?(0,$.jsx)(fn,{onClick:()=>dt.Vu({environment:c,upgradeButtonName:"user_permission_item"})}):(0,$.jsx)(yn,{tooltip:H,disabled:!_||A||W,onClick:async()=>{p!==R.wV.MainShareMenu?await q():R.ZP.setState({...R.ZP.state,tab:R.XF.Share,display:R.wV.Invite,focus:R.Sw.Search,source:R.T5.Notion,emailMessage:""})}})]})})}function fn(e){const{onClick:t}=e;return(0,$.jsx)(Se.Z,{disableTooltip:!1,renderTooltip:()=>(0,$.jsx)(pt.e,{}),render:e=>(0,$.jsx)(ae.Z,{isLarge:!0,style:{marginLeft:8},onClick:t,...e,children:(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}function yn(e){const{tooltip:t,disabled:s,onClick:i}=e;return(0,$.jsx)(Se.Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,$.jsx)(ae.Z,{isLarge:!0,style:{marginLeft:8},disabled:s,onClick:i,...e,children:(0,$.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}function xn(e){window.__c={n:"EmailMessageInput"};const{open:t,focus:s,value:i,maxLength:n,onFocus:a,onChange:l,onCancel:d}=e,c=(0,r.useIntl)(),u=i.length/n>=.8,m=(0,rt.TQ)(i),p=u||m,g=(0,o.yK)((e=>({container:{maxHeight:t?100:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),h=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,$.jsxs)("div",{style:g.container,children:[p&&(0,$.jsx)(vn,{value:i,maxLength:n,shouldShowLengthWarning:u,shouldShowLinkWarning:m}),(0,$.jsx)(ye.Z,{textarea:!0,focusInitial:!1,format:ye.B.Transparent,placeholder:h,maxlength:n,focus:s,value:i,onFocus:a,onChange:l,inputStyle:g.input,onCancel:d})]})}function vn(e){window.__c={n:"EmailMessageWarning"};const{shouldShowLengthWarning:t,shouldShowLinkWarning:s,value:i,maxLength:n}=e,a=(0,o.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,$.jsx)("div",{style:a.container,children:(0,$.jsxs)("div",{style:a.warning,children:[t&&(0,$.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:i.length,maxCharacters:n}}),t&&s&&" · ",s&&(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}const Sn=function(e){window.__c={n:"ShareMenuInviteTab"};const{store:t,permissionItemArgs:s,inviteTargetsStore:i,contextualInviteStore:r}=e,l=(0,n.Fy)(),d=(0,a.qz)(void 0,Mt.Z),{display:c}=(0,a.VK)((()=>R.ZP.state),[]),u=(0,a.VK)((()=>r.state.flowId),[r]),m=(0,o.yK)((()=>({container:{position:"relative",height:c!==R.wV.MainShareMenu?540:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:540},searchBar:{paddingLeft:14,paddingRight:14,paddingBottom:8}})),[c]);return(0,$.jsx)(ct.Z,{capture:!0,onTab:function(e){e.preventDefault(),l.isMobile||c!==R.wV.MainShareMenu||R.ZP.setState({...R.ZP.state,tab:R.XF.Share,display:R.wV.Invite,focus:R.Sw.Search,source:R.T5.Notion,emailMessage:""})},children:(0,$.jsxs)("div",{style:m.container,children:[(0,$.jsx)("div",{style:m.searchBar,children:l.isMobile?(0,$.jsx)(Zt,{store:t,permissionItemArgs:s}):(0,$.jsx)(hn,{store:t,inviteTargetsStore:i,menuListStore:d,sudoModeStore:s.sudoModeStore,contextualInviteStore:r})}),c===R.wV.MainShareMenu&&(0,$.jsx)(Fi,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:s}),c===R.wV.Invite&&!l.isMobile&&(0,$.jsx)(gn,{store:t,inviteTargetsStore:i,menuListStore:d,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:u})]})})};var bn=s(62397);const Mn=function(e){window.__c={n:"WorkspaceOwnerPermissionOverride"};const{store:t,sudoModeStore:s}=e,i=(0,a.VK)((()=>s.state.changePermissionsEnabled),[s]),n=(0,a.VK)((()=>s&&s.shouldUserHaveAccessToPrivatePageBlock()&&!s.doesUserAlreadyHaveEditorAccessOnBlock(t.id)&&s.state.privatePageStore),[s,t]),l=(0,o.yK)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.borderBoxShadow,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:z.Z.fontWeight.medium,justifyContent:"center",marginTop:8,opacity:i?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:i?"rotate(-90deg)":void 0}})),[i]);return n?(0,$.jsxs)("div",{style:l.container,children:[(0,$.jsx)(m.Z,{isMultiline:!0,children:(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,$.jsx)("b",{children:t})}}})}),(0,$.jsxs)(xe.Z,{disabled:i,style:l.button,onClick:()=>{s.setState({...s.state,changePermissionsEnabled:!0})},children:[(0,bn.I)(l.icon),i?(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,$.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function jn(e){window.__c={n:"ShareMenuContent"};const t=(0,a.VK)((()=>R.ZP.state.tab),[]);switch(t){case R.XF.Share:return(0,$.jsx)(Sn,{...e});case R.XF.Publish:return(0,$.jsx)(at,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,B.t1)(t)}}const wn=function(e){window.__c={n:"ShareMenu"};const{store:t,permissionItemArgs:s}=e,i=(0,n.Fy)(),r=(0,a.qz)(e.inviteTargetsStore,L.ZP),l=(0,o.yK)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]);return(0,$.jsxs)("div",{style:l.container,children:[s.sudoModeStore&&(0,$.jsx)(Mn,{store:t,sudoModeStore:s.sudoModeStore}),!i.isMobile&&(0,$.jsx)(J,{inviteTargetsStore:r,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),(0,$.jsx)(jn,{inviteTargetsStore:r,...e})]})};function Cn(){window.__c={n:"OfflineMessage"};const e=(0,n.Fy)(),t=(0,o.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",height:160}})),[]);return(0,$.jsx)("div",{style:t.container,children:(0,$.jsx)(m.Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Please go online to publish & share.",id:"blockPermissionsSettings.offline.prompt"})})})}const kn=function(e){window.__c={n:"ShareMenuContainer"};const{store:t,sudoModeStore:s,onUpgradeButtonClick:b,location:M}=e,j=(0,n.Fy)(),w=(0,a.qz)(void 0,S.Z),{contextualInviteStore:C}=(0,a.VK)((()=>w.state),[w]),k=(0,a.VK)((()=>y.default.state.currentSpaceStore),[]),T=(0,a.VK)((()=>A({spaceStore:k,store:t})),[k,t]),I=(0,a.VK)((()=>C.state.inviteStage),[C]),P=(0,a.VK)((()=>R.ZP.state.tab),[]),_=(0,o.yK)((()=>({title:{fontSize:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto"}})),[]),Z=(0,i.useMemo)((()=>({onUpgradeButtonClick:b,sudoModeStore:s,location:M})),[b,s,M]);if(!k)return null;if(!j.isMobile&&(I===v.TG.share_workspace||I===v.TG.request_workspace))return(0,$.jsx)(D.Z,{blockStore:t,spaceStore:k,contextualInviteStore:C});const F=j.isMobile?{menuType:h.og.Modal,disableHeaderShadow:!0,title:(0,$.jsx)(m.Z,{isMobile:j.isMobile,style:_.title,children:(0,$.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})}),additionalTopbarContent:(0,$.jsx)(ee,{mostPermissivePublicItem:T.mostPermissivePublicItem}),left:(0,$.jsx)(p.Z,{href:(0,f.UY)("guides.sharing"),analyticsFrom:"sharing"}),footer:P===R.XF.Share&&(0,$.jsx)(Js,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:T,permissionItemArgs:Z}),topbarStyle:_.topbarStyle,right:(0,$.jsx)(u.DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:h.og.Popup,maxHeight:"90vh"};return(0,$.jsx)($.Fragment,{children:(0,$.jsx)(c.Z,{...F,className:g.B8p,children:(0,$.jsx)(l.Z,{capture:!0,allowEsc:!0,children:(0,$.jsx)(d.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!1,focusOffscreenInput:!1,render:()=>x.Z.state.online?(0,$.jsx)(wn,{store:t,permissionItemArgs:Z,calculatedPermissions:T,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:C}):(0,$.jsx)(Cn,{})})})})})}},12994:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});s(67294);var i=s(83355),n=s(42875),a=s(72126),o=s(94044),r=s(31412),l=s(74194),d=s(78140),c=s(89728),u=s(53437),m=s(57806),p=s(4708),g=s(79817),h=s(87279),f=s(45101),y=s(65598),x=s(38755),v=s(95697),S=s(4023),b=s(80444),M=s(85834),j=s(52878),w=s(48608),C=s(480),k=s(86628),T=s(24405),I=s(84169),P=s(50906),_=s(16354),Z=s(64369),F=s(18514),A=s(85893);function R(e){window.__c={n:"LearnAboutSharingLink"};const t=(0,C.O7)(),{device:s,WindowSizeStore:i}=t,n=(0,k.VK)((()=>({left:i.getSafePaddingLeftCSS(8),right:i.getSafePaddingRightCSS(12)})),[i]),a=(0,k.VK)((()=>(0,v.bq)()),[]),o=(0,T.yK)((e=>({button:{display:"flex",alignItems:"center",width:s.isMobile?"100%":void 0,height:s.isMobile?44:24,paddingTop:s.isMobile?12:4,paddingBottom:s.isMobile?12:4,paddingLeft:n.left,paddingRight:n.right},helpIcon:{width:s.isMobile?16:14,height:s.isMobile?16:14,fill:s.isMobile?e.mediumIconColor:e.lightIconColor}})),[s.isMobile,n]);return(0,A.jsx)(_.Z,{href:(0,F.UY)("guides.sharing"),onClick:()=>P.Fsx(t,{from:"sharing"}),style:{width:s.isMobile?"100%":void 0},external:!0,children:(0,A.jsxs)(c.Z,{mobileFeedback:s.isMobile,isSmall:!0,style:{...o.button,...e.style},disabled:Boolean(e.disableHover),children:[(0,A.jsx)("div",{style:{marginLeft:s.isMobile?2:0,marginRight:s.isMobile?8:6},children:(0,I.m)(o.helpIcon)}),(0,A.jsx)(Z.Z,{isSmall:!0,isMobile:s.isMobile,isSecondaryColor:!s.isMobile,children:a?(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Learn more",id:"blockPermissionsSettings.learnMore.prompt"}):(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"})})]})})}R.displayName="LearnAboutSharingLink";const D=R;class B extends i.Z{constructor(){super(...arguments),this.storeTypes={universalInviteStore:j.Z},this.renderEmailInput=this.createComputedStore((()=>"milestone_2"===this.props.mode))}renderComponent(){const{universalInviteStore:e}=this.stores,{permissionsInviteStore:t,contextualInviteStore:s}=e.state,i=e.stage,{spaceStore:n}=this.props;if(this.environment.device.isMobile||i===M.TG.closed)return null;if(!(0,y.Mm)(this.props.store)&&(i===M.TG.share_workspace||i===M.TG.request_workspace))return(0,A.jsx)(w.Z,{blockStore:this.props.store,spaceStore:n,contextualInviteStore:s});if(i===M.TG.share_page){const i={...this.props,renderInShareMenu:!0,spaceStore:n,permissionsInviteStore:t,contextualInviteStore:s,onInviteClick:()=>{(0,v.$)(this.environment)?s.setState({...s.state,inviteStage:M.TG.closed}):g.fr({environment:this.environment,spaceStore:n,contextualInviteStore:s})},onInviteComplete:e=>{g.x5({success:e,intl:this.props.intl,contextualInviteStore:s})},onCancel:async()=>{await(0,f.Aw)({environment:this.environment,permissionsInviteStoreState:t.state,from:"share_menu"})||e.reset()}};return this.renderEmailInput.state?(0,A.jsx)(L,{...i}):(0,A.jsx)(m.default,{...i})}}}B.displayName="UniversalMemberInvite";class L extends m.PermissionsInviteBase{constructor(){super(...arguments),this.inviteTargetLength=this.createComputedStore((()=>this.stores.permissionsInviteStore.state.inviteTargets.length)),this.blockTitle=this.createComputedStore((()=>{if((0,y.Mm)(this.props.store))return"";const e=this.props.store;if(!e.isDefined())return"";const t=e.getModel().getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,n.r)(),intl:this.props.intl});return t||e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,n.r)(),intl:this.props.intl})})),this.handleInviteInputSubmit=async()=>{const{permissionsInviteStore:e}=this.stores;"invitee"===e.state.inputFocus?e.setState({...e.state,inputFocus:"email-content"}):await super.handleInviteInputSubmit()},this.resetFocusOnClickEmpty=e=>{const{permissionsInviteStore:t}=this.stores;e.currentTarget===e.target&&t.setState({...t.state,inputFocus:"none"})}}renderComponent(){return this.renderInShareMenu.state?this.renderUniversalInviteInner():super.renderComponent()}renderUniversalInviteInner(){const{permissionsInviteStore:e}=this.stores;return(0,A.jsxs)("div",{style:O(this.environment),onClick:this.resetFocusOnClickEmpty,children:[(0,A.jsx)(u.ZP,{popupType:u.kQ.Popup,alignmentToOrigin:S.v.Start,placementToOrigin:S.u.Bottom,open:"invitee"===e.state.inputFocus,originGap:10,disableMouseCapture:!0,forceRemeasureStore:this.inviteTargetLength,origin:super.renderHeader(),onDismiss:()=>{e.setState({...e.state,inputFocus:"email-content"})},render:()=>{const e=super.renderSearchRequest(),t={menuType:h.og.Popup,disableScroller:!1};return(0,A.jsx)("div",{children:(0,A.jsx)(d.Z,{...t,children:e})})},style:{width:360}}),this.renderEmailMessageInput(),this.renderSinglePlayerOptions(),this.renderActions()]})}renderEmailMessageInput(){const{permissionsInviteStore:e}=this.stores,t=this.getEmailMessage(),{inputFocus:s,emailMessage:i}=e.state,n=i.length/o.vr>=.8,a=(0,o.TQ)(i),r=n||a,d=(0,p._6)(this.environment),c="email-content"===s;return(0,A.jsx)(l.Z,{textarea:!0,value:i,focus:c,focusInitial:!1,maxlength:o.vr,onFocus:()=>{e.setState({...e.state,inputFocus:"email-content"})},style:{background:c?"none":this.theme.inputBackground,alignItems:"flex-start",paddingLeft:12,paddingRight:12,paddingTop:8,paddingBottom:r?34:12},inputStyle:{minHeight:d?80:100},placeholder:t,onChange:t=>{e.setState({...e.state,emailMessage:t.target.value})},right:r&&this.renderMessageWarning({shouldShowLengthWarning:n,shouldShowLinkWarning:a}),isRightLastElementOfInput:!0,onSubmit:async()=>{await super.handleInviteClick()}})}renderSinglePlayerOptions(){if((0,y.Mm)(this.props.store))return null;const{contextualInviteStore:e,permissionsInviteStore:t}=this.stores,{currentSpaceStore:s}=b.default.state;if(!s)return null;if(!(0,v.$)(this.environment))return null;const{inviteTargets:i}=t.state;return!t.state.isInviteTargetsEmpty&&i.some((e=>f.OA(e)))?(0,A.jsx)(w.Z,{blockStore:this.props.store,spaceStore:s,contextualInviteStore:e}):null}renderActions(){return(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center",width:"100%"},onClick:this.resetFocusOnClickEmpty,children:[(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"flex-end",gap:8},children:[this.renderDesktopInputRightInnerButton({isLarge:!1}),(0,A.jsx)(c.Z,{style:{minWidth:o.UF,justifyContent:"center"},isLarge:!1,isLightGray:!0,onClick:()=>{var e,t;null===(e=(t=this.props).onCancel)||void 0===e||e.call(t)},children:(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Cancel",id:"ContextualInvite.permissions_invites.button.cancel"})})]}),(0,A.jsx)(D,{style:{paddingLeft:0,paddingRight:0},disableHover:!0})]})}renderMessageWarning(e){const{permissionsInviteStore:t}=this.stores,{shouldShowLengthWarning:s,shouldShowLinkWarning:i}=e;return(0,A.jsxs)("span",{style:{fontSize:12,color:this.theme.lightTextColor,position:"absolute",bottom:8,left:12},children:[s&&(0,A.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:t.state.emailMessage.length,maxCharacters:o.vr}}),s&&i&&" · ",i&&(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})}getEmailMessage(){const{currentUserStore:e,currentSpaceStore:t}=b.default.state,{permissionsInviteStore:s}=this.stores,{intl:i}=this.props,{inviteTargets:n}=s.state,r=!s.state.isInviteTargetsEmpty&&a.yW(n,f.OA);if(!t)return i.formatMessage(o.VX.default);const l=null==e?void 0:e.getDisplayName(i),d=(0,x.rn)(this.environment,t);if(!l||!d)return i.formatMessage(o.VX.default);return(0,o.jm)({includeOptional:!1,isGuest:r,emailProps:{userName:l,pageName:this.blockTitle.state,spaceName:d},intl:this.props.intl})}}const N=(0,r.injectIntl)(B);function O(e){const{WindowSizeStore:t}=e;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:10,paddingBottom:10,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14),flexDirection:"column",gap:10}}},35700:(e,t,s)=>{s.d(t,{J:()=>c});s(67294);var i=s(24405),n=s(89024),a=s(7124),o=s(63296),r=s(85248),l=s(79872),d=s(85893);function c(e){window.__c={n:"SidebarFooterNotification"};const{title:t,description:s,cta:c,onClick:u,onDismiss:m,progressPercent:p,isButtonDisabled:g}=e,h=(0,i.yK)((e=>({cardContainer:{padding:14},buttonContainer:{paddingTop:8},button:{width:"100%"},dismissButton:{position:"relative",top:0,right:0,background:"none"},cta:{textDecoration:"underline"},unfilledBar:{color:"dark"===e.mode?e.accentColors.gray[400]:void 0}})),[]),f=void 0!==p;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{style:h.cardContainer,children:[(0,d.jsxs)(n.jX,{direction:"row",gap:"auto",align:"center",children:[(0,d.jsx)(a.q,{styleName:"Body-12px/Medium",colorName:"primary",children:t}),void 0!==m&&(0,d.jsx)(l.U,{onClick:m,style:h.dismissButton})]}),(0,d.jsx)(a.q,{styleName:"Body-12px/Regular",children:(0,d.jsxs)(n.jX,{gap:f?8:0,children:[s,f&&(0,d.jsx)(r.k,{percentage:100*p,height:8,unfilledColor:h.unfilledBar.color}),(0,d.jsx)("div",{style:h.buttonContainer,children:(0,d.jsx)(o.Z,{onClick:u,disabled:g,disabledFeedback:g,style:h.button,children:(0,d.jsx)(a.q,{styleName:"Body-14px/Regular",colorName:"primary",children:c})})})]})})]})})}},75546:(e,t,s)=>{s.d(t,{o:()=>c});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(82990),r=s(95697),l=s(43488),d=s(85893);function c(e){let{teamStore:t,withSelectedStyle:s}=e;window.__c={n:"TeamHeaderLabel"};const c=(0,i.Fy)(),u=(0,n.VK)((()=>{var e;return{teamName:t.getName()??"",shouldShowLock:(0,r.C2)(null==t||null===(e=t.getSettingsStore())||void 0===e?void 0:e.getValue())}}),[t]),m=(0,a.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},lockIcon:{width:15,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},labelText:{...o.Z.textOverflowStyle,...s?{color:e.regularTextColor,fontWeight:o.Z.fontWeight.semibold}:{color:e.darkTextColor,fontWeight:o.Z.fontWeight.medium},fontSize:c.isMobile?o.Z.fontSize.UIRegular.mobile:o.Z.fontSize.UIRegular.desktop}})),[c.isMobile,s]);return u?(0,d.jsxs)("div",{style:m.container,children:[(0,d.jsx)("div",{style:m.labelText,children:u.teamName}),u.shouldShowLock&&(0,d.jsx)(l.Z,{iconStyle:m.lockIcon})]}):null}},22756:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{isModalOpen:!1,currentTab:"selectData",account:void 0,isAccountLinkingInProgress:!1,isAccountDelinkingInProgress:!1,workspaces:[],teamsAndProjects:[],selectedWorkspace:void 0,selectedProjectsAndTeamspaces:{},importCompletedTasks:!0,teams:void 0,loadMoreClicks:0,isLoadingProjects:!1,isLoadingAsanaWorkspaces:!1,result:void 0,isComplete:!1,loggerPageId:void 0,templateCreationInProgress:!1,isFetchingAsanaAccount:!1,choosingWorkspacesCompleted:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const a=new n},17549:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},85680:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{isOpen:!1}}}const a=new n},52507:(e,t,s)=>{s.d(t,{AS:()=>l,Hs:()=>d,ZP:()=>c});var i=s(49085),n=s(59753),a=s(44312),o=s(97880);class r extends i.default{getInitialState(){return{modalOpen:!1,loading:!1,domainVerification:void 0}}}const l=(0,o.AO)((e=>"invalid"===e.type||"unverified"===e.type?{true:e}:{false:e}));function d(e){const t=n.kk.fromValue(a.Jd,e);return{type:t.verified_at?"verified":"unverified",id:t.id,domain:t.domain,verificationCode:t.verification_code,createdAt:t.created_at,expiresAt:t.expires_at,invalidatedAt:t.getInfo().invalidated_at}}const c=r},45214:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},5188:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},78900:(e,t,s)=>{s.d(t,{Z:()=>i});const i=new(s(61766).Z)},49900:(e,t,s)=>{s.d(t,{d:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},69122:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{isModalOpen:!1,account:void 0,workspaces:[],isLoadingProjects:!1,mondayFoldersAndBoards:[],selectedProjectsAndTeamspaces:{},templateCreationInProgress:!1,currentTab:"selectData",loggerPageId:void 0,showAuthPopup:!1,email:void 0,APIToken:void 0,result:void 0,isComplete:!1,selectedWorkspace:void 0,isLoadingMondayWorkspaces:!1,isFetchingMondayAccount:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const a=new n},4548:(e,t,s)=>{s.d(t,{Z:()=>i});const i=new(s(45589).Z)},25399:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},54983:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{}}}const a=n},33052:(e,t,s)=>{s.d(t,{Z:()=>o});var i=s(49085),n=s(29369);class a extends i.default{getInitialState(){return{modalOpen:!1,tokenQuery:"",inviteTargets:[],inviteRole:"member",isInviteTargetsEmpty:!0,table:n.e0,isFocused:!0,flowId:void 0,inputFocus:"invitee",emailMessage:""}}}const o=a},67742:(e,t,s)=>{s.d(t,{Z:()=>b});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(53877),r=s(11751),l=s(31412),d=s(39699),c=s(1865),u=s(37181),m=s(38755),p=s(35700),g=s(80444),h=s(81886),f=s(88893),y=s(35057),x=s(28956),v=s(85893);function S(e,t,s){if(s){if("warning"===t){if("settings"===e)return{disableWarningNotificationInSettings:!0,disableWarningNotificationInSidebar:s.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:s.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:s.disableLimitNotificationInSidebar,expirationDate:s.expirationDate};if("sidebar"===e)return{disableWarningNotificationInSettings:s.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:!0,disableLimitNotificationInSettings:s.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:s.disableLimitNotificationInSidebar,expirationDate:s.expirationDate}}if("limit_reached"===t){if("settings"===e)return{disableWarningNotificationInSettings:s.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:s.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:!0,disableLimitNotificationInSidebar:s.disableLimitNotificationInSidebar,expirationDate:s.expirationDate};if("sidebar"===e)return{disableWarningNotificationInSettings:s.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:s.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:s.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:!0,expirationDate:s.expirationDate}}}return{disableWarningNotificationInSettings:"warning"===t&&"settings"===e,disableWarningNotificationInSidebar:"warning"===t&&"sidebar"===e,disableLimitNotificationInSettings:"limit_reached"===t&&"settings"===e,disableLimitNotificationInSidebar:"limit_reached"===t&&"sidebar"===e,expirationDate:(0,o.Xz)({date:Date.now(),daysToAdd:7})}}const b=function(e){window.__c={n:"AddOnLimitUsage"};const t=(0,h.MQ)(e.source),s=(0,n.VK)((()=>x.Z.state),[]),b=(0,i.O7)(),M=(0,a.yK)((()=>({icon:{height:12,width:12,display:"inline"}})),[]),{membersCount:j,spaceName:w,settings:C,currentUserSettingsStore:k}=(0,n.VK)((()=>{var e;return{membersCount:(0,f.qX)(),spaceName:g.default.state.currentSpaceStore&&(0,m.rn)(b,g.default.state.currentSpaceStore),settings:null===(e=g.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.addOnLimitNotifications,currentUserSettingsStore:g.default.state.currentUserSettingsStore}}),[b]),T=(0,n.VK)((()=>s?+s.spaceUsage/s.spaceLimit:0),[s]),{notificationType:I}=(0,n.VK)((()=>({notificationType:T>=h.Tq?"limit_reached":"warning"})),[T]);if(!k)return null;if(!t)return null;let P;"settings"===e.source&&j>=3&&(null!=C&&C.expirationDate?Date.now()<C.expirationDate&&(P=!0):(!function(e,t){d.createAndCommit({userAction:"addOnLimitNotifications.ai.initializeSettings",environment:e,perform:e=>{u.d2({transaction:e,userSettingsStore:t,data:{addOnLimitNotifications:{disableWarningNotificationInSettings:!1,disableWarningNotificationInSidebar:!1,disableLimitNotificationInSettings:!1,disableLimitNotificationInSidebar:!1,expirationDate:(0,o.Xz)({date:Date.now(),daysToAdd:7})}}})}})}(b,k),P=!0));const _="limit_reached"===I?(0,v.jsx)(l.FormattedMessage,{id:"addOnLimitUsage.description.usedAllFreeResponses.admins",defaultMessage:"{spaceName} has used all their free AI responses.",values:{spaceName:w}}):(0,v.jsx)(l.FormattedMessage,{id:"addOnLimitUsage.description.approachingLimit.admins",defaultMessage:"{spaceName} has used {spaceUsage} of the {usageLimit} free responses provided to this workspace.",values:{spaceName:w,spaceUsage:(null==s?void 0:s.spaceUsage)??0,usageLimit:(null==s?void 0:s.spaceLimit)??0}});return(0,v.jsx)(p.J,{title:(0,v.jsxs)(v.Fragment,{children:[(0,r.t)(M.icon)," ",(0,v.jsx)(l.FormattedMessage,{id:"spaceSettings.sidebar.addOnUpgradeLink",defaultMessage:"Notion AI"})]}),description:_,cta:(0,v.jsx)(l.FormattedMessage,{id:"spaceSettings.sidebar.addOnPurchase.buttonLabel",defaultMessage:"Purchase"}),onClick:()=>function(e,t){c.y(e,{from:"sidebar"===t?"ai_limit_sidebar":"ai_limit_settings",for:(0,y.zt)(),addOnFeature:"ai"})}(b,e.source),onDismiss:P?void 0:()=>function(e,t,s){var i;const{currentUserSettingsStore:n}=g.default.state;if(!n)return;const a={addOnLimitNotifications:S(t,s,null===(i=n.getSettings())||void 0===i?void 0:i.addOnLimitNotifications)};d.createAndCommit({userAction:"addOnLimitNotifications.ai.markNotificationAsDismissed",environment:e,perform:e=>{u.d2({transaction:e,userSettingsStore:n,data:a})}})}(b,e.source,I),progressPercent:T})}},32856:(e,t,s)=>{s.d(t,{D:()=>a});var i=s(86628),n=s(77080);function a(e){window.__c={n:"ExperimentSwitch"};const{experimentId:t,groups:s,disableExposureLogging:a}=e;return s[function(e){const{experimentId:t,disableExposureLogging:s,defaultGroup:a}=e;return(0,i.VK)((()=>n.default.getEligibleGroup({experimentId:t,defaultGroup:a??"control",disableExposureLogging:s})),[t,s,a])}({experimentId:t,disableExposureLogging:a})]}},28833:(e,t,s)=>{s.r(t),s.d(t,{default:()=>le,isCancellationStage:()=>oe,isConfirmPurchaseStage:()=>ae,isLimitReachedStage:()=>ne});var i=s(67294),n=s(13991),a=s(480),o=s(86628),r=s(24405),l=s(41892),d=s(8848),c=s(7057),u=s(64275),m=s(44495),p=s(3791),g=s(896),h=s(47425),f=s(97880),y=s(82990),x=s(31412),v=s(47307),S=s(64964),b=s(65544),M=s(1865),j=s(42922),w=s(11066),C=s(68785),k=s(92660),T=s(42402),I=s(52533),P=s(18514),_=s(38755),Z=s(80444),F=s(78291),A=s(80671),R=s(34583),D=s(81886),B=s(40670),L=s(43163),N=s(88893),O=s(35057),E=s(63423),V=s(33493),U=s(27533),W=s(85893);function K(e){window.__c={n:"LimitReachedStage"};const{addOnFeature:t,canPurchaseAddOn:s,isSubscribed:i}=e,n=ie(),o=(0,a.O7)();return s&&i?(0,W.jsx)(z,{addOnFeature:t,canPurchaseAddOn:s}):(0,W.jsxs)(W.Fragment,{children:[(0,m.D)(n.icon),(0,W.jsx)(G,{addOnFeature:t,canPurchaseAddOn:s}),(0,W.jsx)(H,{addOnFeature:t,canPurchaseAddOn:s}),(0,W.jsx)(j.Z,{isLarge:!0,style:n.button,onClick:async()=>s?i?A.Cl(void 0):async function(e,t){await M.y(e,{from:"plans_page",for:t,addOnFeature:"ai"}),A.v5()}(o,"free"):A.v5(),children:s?(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase"}):(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function z(e){var t,s;window.__c={n:"ConfirmPurchase"};const{addOnFeature:i,canPurchaseAddOn:n}=e,r=(0,a.O7)(),d=ie(),c=(0,o.VK)((()=>(0,O.zt)()),[]),u=(0,o.VK)((()=>F.default.state.data),[]),m=(0,o.VK)((()=>E.Z.state.open?E.Z.state.coupon:null),[]),p=(0,o.VK)((()=>Z.default.state.currentSpaceStore),[]);if(!p)return null;const g=(0,I.S$)({environment:r})&&(0,h.QR)(c);if(r.device.isMobileNative&&!g)return null;let y;if(!u||"unsubscribed_admin"!==u.type&&"subscribed_admin"!==u.type||(y=u),y&&"revenueCat"===(null===(t=y.customerData)||void 0===t?void 0:t.activeSubscriptionPlatform)){const e=(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return v.showErrorMessage(e),null}const S=(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator."});if(!(0,N.GJ)(u))return v.showErrorMessage(S),null;const b=null===(s=y)||void 0===s||null===(s=s.customerData)||void 0===s?void 0:s.stripe;if(!b)return null;const M=b.isSubscribed?b.interval:"month",j=m?function(e){switch(e){case"ai_fifty_percent":return(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount"});default:(0,f.t1)(e)}}(m):"year"===M?(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount"}):null;return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("img",{src:l.Z.images.pricing.aiLogoPng,style:d.aiLogo}),(0,W.jsx)(G,{addOnFeature:i,canPurchaseAddOn:n}),(0,W.jsx)(Q,{addOnFeature:i}),j?q(j):null,(0,W.jsx)(Y,{addOnFeature:i,interval:M,stripeData:b,spaceStore:p})]})}function q(e){window.__c={n:"DiscountBadge"};const t=ie();return(0,W.jsx)(w.Z,{style:{...t.sharedStyleForDiscountBadge},disabled:!0,children:(0,W.jsx)("div",{style:{...t.innerStyleForDiscountBadge},children:e})})}function G(e){window.__c={n:"Title"};const{addOnFeature:t,canPurchaseAddOn:s}=e,i=ie();let n;switch(t){case"ai":n=s?(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.title.admin",defaultMessage:"Get more Notion AI"}):(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"});break;default:(0,f.t1)(t)}return(0,W.jsx)("h3",{style:i.title,children:n})}function H(e){window.__c={n:"Description"};const{addOnFeature:t,canPurchaseAddOn:s}=e;let i;const n=ie();switch(t){case"ai":i=s?(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace"}):(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use."});break;default:(0,f.t1)(t)}return(0,W.jsx)("p",{style:n.paragraph,children:(0,W.jsx)("div",{style:n.text,children:i})})}function Q(e){window.__c={n:"ConfirmationDescription"};const{addOnFeature:t}=e;let s;const i=(0,a.O7)(),n=ie(),r=(0,o.VK)((()=>Z.default.state.currentSpaceStore),[]);if(!r)return null;const l=(0,o.VK)((()=>(0,_.rn)(i,r)),[i,r]);switch(t){case"ai":s=(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.description.admins",defaultMessage:"Go unlimited with Notion AI for all members in {spaceName}.",values:{spaceName:l}});break;default:(0,f.t1)(t)}return(0,W.jsx)("p",{style:n.paragraph,children:(0,W.jsx)("div",{style:n.text,children:s})})}function Y(e){window.__c={n:"ConfirmationBillingSummary"};const{addOnFeature:t,interval:s,stripeData:n,spaceStore:r}=e,l=ie(),d=(0,a.O7)(),c=(0,o.VK)((()=>(0,N.qX)()),[]),u=n.currencyCode??"USD",{tax:m,coupon:g}=(0,o.VK)((()=>({tax:E.Z.state.open?E.Z.state.tax:0,coupon:E.Z.state.open?E.Z.state.coupon:void 0})),[]),h=(0,o.VK)((()=>V.Z.getPrice(d,(e=>e.product===t&&e.billingInterval===s&&e.currencyCode===u))),[t,d,s,u]),f=(0,o.VK)((()=>V.Z.getPrice(d,(e=>e.product===t&&"month"===e.billingInterval&&e.currencyCode===u))),[t,u,d]);if((0,i.useEffect)((()=>{!async function(){if(h.result&&n&&n.address){const e=h.result.getCostPerBillingInterval({quantity:c,coupon:g}).amount;await b.nf({environment:d,priceForTaxCalculation:e,address:n.address,customerId:n.customerId,vatId:n.vatId})}}()}),[d,n,h,c,g]),!h.isLoaded||!f.isLoaded)return(0,W.jsx)(C.Z,{});if(!h.result||!f.result)return null;const y=h.result,v=y.getCostPerBillingInterval({quantity:c,coupon:g}).withAddedAmount(m),M=f.result,w=M.getMonthlyUnitCost();let k=M.getMonthlyCost({quantity:c});"year"===s&&(k=k.withMultipliedAmount(12));const{addOnCostItem:I,addOnCostItemWithMembers:_}=(0,D.OL)(t,c,s,(0,W.jsx)(U.W,{cost:w.toMoneyValue(),trailingZeroDisplay:"stripIfInteger"}));return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("p",{style:l.monthlyCostText,children:[(0,W.jsx)("h3",{style:l.title,children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on"})}),(0,W.jsxs)("div",{style:l.costSectionTitle,children:[(0,W.jsx)("div",{children:I}),(0,W.jsx)("div",{style:l.rightAlign,children:(0,W.jsx)(U.W,{cost:k.toMoneyValue(),trailingZeroDisplay:"auto"})})]}),(0,W.jsx)("div",{style:l.costSection,children:_}),(0,W.jsx)($,{cost:y.getCostPerBillingInterval({quantity:c}),fullCost:k}),(0,W.jsx)(J,{price:y,coupon:g,quantity:c}),(0,W.jsxs)("div",{style:l.costSection,children:[(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:"}),(0,W.jsx)("div",{style:l.rightAlign,children:(0,W.jsx)(U.W,{cost:{amount:m,currencyCode:u},trailingZeroDisplay:"auto"})})]}),(0,W.jsxs)("div",{style:l.totalCostSection,children:[(0,W.jsx)("h3",{style:l.title,children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total"})}),(0,W.jsx)("div",{style:l.rightAlign,children:(0,W.jsx)("h3",{style:l.title,children:(0,W.jsx)(U.W,{cost:v.toMoneyValue(),trailingZeroDisplay:"auto"})})})]}),(0,W.jsx)("div",{style:l.perMonth,children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",values:{interval:s}})})]}),(0,W.jsx)(j.Z,{isLarge:!0,style:l.button,onClick:async()=>{const e=(0,p.aG)({addOnFeature:t,addOnTier:"base",addOnBillingInterval:s,addOnPricingModel:"standard",addOnPricingVariant:"retail",currencyCode:y.currencyCode,isCancellation:!1});await R.Mg({environment:d,spaceStore:r,from:"add_on_upgrade_modal",addOns:e,inAppOffer:g}),A.v5();const i=B.mV({type:"purchaseAddOn",addOnFeature:t});i&&S.oV(i)},children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase"})}),(0,W.jsx)("p",{style:l.termsOfService,children:(0,W.jsx)("div",{style:l.text,children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",values:{br:(0,W.jsx)("br",{}),fairUsePolicies:e=>(0,W.jsx)(T.Z,{href:(0,P.UY)("ai.fairUsePolicies"),children:e}),terms:e=>(0,W.jsx)(T.Z,{href:(0,P.UY)("ai.terms"),children:e})}})})})]})}function $(e){window.__c={n:"AnnualDiscount"};const t=ie(),{cost:s,fullCost:i}=e;if(s.amount===i.amount)return null;const n=i.minus(s),a=Math.floor(n.amount/i.amount*100);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{style:t.costSectionTitle,children:[(0,W.jsx)("div",{children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.annual.dynamicDiscountMessage",defaultMessage:"<bold>Annual discount ({discountPercent}%)</bold>",values:{bold:e=>(0,W.jsx)("b",{children:e}),discountPercent:a}})}),(0,W.jsx)("div",{style:t.greenRightAlign,children:(0,W.jsx)(U.W,{cost:n.withMultipliedAmount(-1).toMoneyValue(),trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,W.jsx)("div",{style:t.costSection,children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan"})})]})}function J(e){window.__c={n:"CouponDiscount"};const t=ie(),{price:s,coupon:i,quantity:n}=e;if(!(0,g.pp)(i))return null;const a=s.getDiscountPerBillingInterval({quantity:n,coupon:i}).withMultipliedAmount(-1);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{style:t.costSectionTitle,children:[(0,W.jsx)("div",{children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",values:{bold:e=>(0,W.jsx)("b",{children:e}),percentage:(0,L.o)(i)}})}),(0,W.jsx)("div",{style:t.greenRightAlign,children:(0,W.jsx)(U.W,{cost:a,trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,W.jsx)("div",{style:t.costSection,children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months"})})]})}function X(e){window.__c={n:"CancellationStageCTA"};const{data:t,addOnFeature:s}=e,i=ie(),n=(0,a.O7)(),o=function(e,t){var s;return null===(s=e.addOns.find((e=>e.feature===t)))||void 0===s?void 0:s.billingInterval}(t,s);return o?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("div",{style:i.buttonWithTopPadding,children:(0,W.jsx)(w.Z,{style:i.redButton,hoveredStyle:{background:d.ZP.redWithAlpha(.8)},onClick:async()=>{const e=Z.default.state.currentSpaceStore,{data:t}=F.default.state;let i;var a;"unsubscribed_admin"!==(null==t?void 0:t.type)&&"subscribed_admin"!==(null==t?void 0:t.type)||(i=null===(a=t.customerData)||void 0===a?void 0:a.stripe.currencyCode);if(!e||!i)return v.showErrorMessage((0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.cancellationStage.errorMessage",defaultMessage:"Unable to cancel add-on subscription. Please try again later."}));const r=(0,p.aG)({addOnFeature:s,addOnTier:"base",addOnBillingInterval:o,addOnPricingModel:"standard",addOnPricingVariant:"retail",currencyCode:i,isCancellation:!0});await R.Mg({environment:n,spaceStore:e,from:"add_on_upgrade_modal",addOns:r}),A.v5()},children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal"})})}),(0,W.jsx)("div",{style:i.buttonWithTopPadding,children:(0,W.jsx)(w.Z,{style:i.noButton,onClick:()=>A.v5(),children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel"})})})]}):null}function ee(e){window.__c={n:"CancellationStageDescription"};const{data:t}=e,s=ie();let i,a=!1;if("subscribed_admin"===t.type||"unsubscribed_admin"===t.type){var o;const e=null===(o=t.customerData)||void 0===o?void 0:o.stripe;i=null==e?void 0:e.periodEnd,a=Boolean((null==e?void 0:e.schedule)||(null==e?void 0:e.willCancelAt))}return i?(0,W.jsx)("p",{style:s.paragraph,children:(0,W.jsx)("div",{style:s.text,children:a?(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellationWithPendingChanges.description",defaultMessage:"You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. This change will cancel your previous pending changes. You can resubscribe anytime.",values:{periodEnd:(0,c.Yx)(i,"long",n.SP),bold:e=>(0,W.jsx)("b",{children:e})}}):(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",values:{periodEnd:(0,c.Yx)(i,"long",n.SP),bold:e=>(0,W.jsx)("b",{children:e})}})})}):null}function te(e){window.__c={n:"CancellationStage"};const{addOnFeature:t,canPurchaseAddOn:s,data:i}=e,n=ie();if(!s)return null;let a;switch(t){case"ai":a=(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.title",defaultMessage:"Remove AI at the end of your billing period?"});break;default:(0,f.t1)(t)}return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("h3",{style:n.cancellationTitle,children:a}),(0,W.jsx)(ee,{data:i}),(0,W.jsx)(X,{data:i,addOnFeature:t})]})}function se(){window.__c={n:"MobileMessage"};const e=ie(),t=(0,a.O7)();let s=(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited."});return(t.device.isIOS||t.device.isIpad)&&(s=(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"You are out of free AI."})),(0,W.jsxs)(W.Fragment,{children:[(0,m.D)(e.icon),(0,W.jsx)("h3",{style:e.title,children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"})}),(0,W.jsx)("p",{style:e.paragraph,children:(0,W.jsx)("div",{style:e.text,children:s})}),(0,W.jsx)(j.Z,{isLarge:!0,style:e.button,onClick:()=>A.v5(),children:(0,W.jsx)(x.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function ie(){return(0,r.yK)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.mediumTextColor},costSectionTitle:{display:"flex",color:e.mediumTextColor},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.mediumTextColor,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:d.ZP.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:4,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:y.Z.fontWeight.medium},closeIcon:{width:14,fill:e.mediumTextColor},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.mediumTextColor,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:4},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:4,color:e.regularTextColor,background:e.accentColors.gray[50],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function ne(){return re("limit_reached")}function ae(){return re("confirm_purchase")}function oe(){return re("cancel_plan")}function re(e){const t=E.Z.state;if(t.open)return t.stage===e}const le=function(e){window.__c={n:"AddOnUpgradeModal"};const{data:t}=e,s="ai",i=(0,N.GJ)(t),n=ie(),o=N.YK(t);return(0,a.O7)().device.isMobile?(0,W.jsx)(k.Z,{innerStyle:n.innerStyle,requireOnline:!0,modalStore:E.Z,onDismiss:()=>A.v5(),render:()=>(0,W.jsx)("div",{style:n.mobileModal,children:(0,W.jsx)("div",{style:n.innerModalPadding,children:(0,W.jsx)(se,{})})})}):(0,W.jsx)(k.Z,{innerStyle:n.innerStyle,requireOnline:!0,modalStore:E.Z,onDismiss:()=>A.v5(),render:()=>(0,W.jsx)("div",{style:ae()||ne()&&o&&i?n.largeModal:oe()?n.cancellationModal:n.modal,children:(0,W.jsxs)("div",{style:oe()?n.cancellationInnerModalPadding:n.innerModalPadding,children:[(0,W.jsx)(w.Z,{onClick:()=>{A.v5()},style:n.cancelButton,hoveredStyle:n.hovered,children:(0,u.D)(n.closeIcon)}),ne()&&(0,W.jsx)(K,{addOnFeature:s,canPurchaseAddOn:i,isSubscribed:o}),ae()&&(0,W.jsx)(z,{addOnFeature:s,canPurchaseAddOn:i}),oe()&&(0,W.jsx)(te,{addOnFeature:s,canPurchaseAddOn:i,data:t})]})})})}},81886:(e,t,s)=>{s.d(t,{MQ:()=>y,OL:()=>f,Tq:()=>g});var i=s(67294),n=s(480),a=s(86628),o=s(97880),r=s(31412),l=s(54642),d=s(38755),c=s(80444),u=s(78291),m=s(88893),p=s(85893);const g=1;async function h(e,t,s,i){const n=u.default.state.data;if(!n)return!1;const a=m.XZ(e,n),o=c.default.state.currentSpaceStore;if(!(o&&(0,d.rn)(e,o))||!(0,m.GJ)(n))return!1;if(!i)return!1;const r=await l.getAIUsageEligibility(e,{spaceId:i});if("failed"===r.type)return!1;const p=r.data,h=p?+p.spaceUsage/p.spaceLimit:0;return(!1!==(null==p?void 0:p.isEligible)||!p.isSalesAssisted)&&(!a&&function(e,t,s){const i=e>=g?"limit_reached":"warning";if("warning"===i){if("settings"===t&&null!=s&&s.disableWarningNotificationInSettings||"sidebar"===t&&null!=s&&s.disableWarningNotificationInSidebar)return!1}else if("limit_reached"===i&&("settings"===t&&null!=s&&s.disableLimitNotificationInSettings||"sidebar"===t&&null!=s&&s.disableLimitNotificationInSidebar))return!1;return e>=.7}(h,t,s))}function f(e,t,s,i){switch(e){case"ai":return{addOnCostItem:(0,p.jsx)("div",{children:(0,p.jsx)(r.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI",defaultMessage:"<bold>Notion AI</bold>",values:{bold:e=>(0,p.jsx)("b",{children:e})}})}),addOnCostItemWithMembers:(0,p.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:(0,p.jsx)(r.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI.memberInfo",defaultMessage:"({memberCount, plural, one {{memberCount} member} other {{memberCount} members}} x {price} per month{interval, select, month {} other { x 12 months}})",values:{memberCount:t,interval:s,price:i}})})};default:(0,o.t1)(e)}}function y(e){const t=(0,n.O7)(),s=(0,a.VK)((()=>{var e;return null===(e=c.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.addOnLimitNotifications}),[]),o=(0,a.VK)((()=>{var e;return null===(e=c.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),[r,l]=(0,i.useState)();return(0,i.useEffect)((()=>{!async function(){const i=await h(t,e,s,o);l(i)}()}),[t,e,s,o]),r}},43163:(e,t,s)=>{s.d(t,{o:()=>o});s(67294);var i=s(97880),n=s(31412),a=s(85893);function o(e){switch(e){case"ai_fifty_percent":return(0,a.jsx)(n.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscounts.fiftyPercent",defaultMessage:"50%"});default:(0,i.t1)(e)}}},15418:(e,t,s)=>{s.r(t),s.d(t,{CreateTeamFromPageConfirmModal:()=>f});s(67294);var i=s(480),n=s(24405),a=s(62208),o=s(82990),r=s(31412),l=s(42922),d=s(63296),c=s(92660),u=s(29551),m=s(73466),p=s(66214),g=s(80068),h=s(85893);function f(){window.__c={n:"CreateTeamFromPageConfirmModal"};const e=(0,i.O7)(),t=(0,r.useIntl)(),s=(0,n.yK)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:o.Z.fontWeight.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]);return(0,h.jsx)(c.Z,{onDismiss:()=>{p.Z.setState({open:!1})},render:()=>(0,h.jsx)("div",{style:s.modal,children:(0,h.jsxs)(u.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,a.z)(s.loopIcon),(0,h.jsx)("div",{style:s.title,children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,h.jsx)("div",{style:s.description,children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,h.jsx)(l.Z,{isLarge:!0,style:s.confirmButton,onClick:()=>{if(p.Z.state.open){const{pageStore:s,flowId:i}=p.Z.state;m.Sq({environment:e,intl:t,page:s,flowId:i}),p.Z.setState({open:!1})}},children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,h.jsx)(d.Z,{isLarge:!0,style:s.cancelButton,onClick:()=>p.Z.setState({open:!1}),children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,h.jsx)(g.Z,{message:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),requireOnline:!0,modalStore:p.Z})}},14982:(e,t,s)=>{s.r(t),s.d(t,{SidebarCreateTeamModal:()=>te});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(41892),l=s(64275),d=s(49364),c=s(72126),u=s(97880),m=s(82990),p=s(31412),g=s(50906),h=s(64921),f=s(74194),y=s(3386),x=s(68785),v=s(50506),S=s(64369),b=s(45653),M=s(13490),j=s(33929),w=s(38755),C=s(95697),k=s(68418),T=s(80444),I=s(26350),P=s(33052),_=s(9867),Z=s(42922),F=s(78122),A=s(35057),R=s(73466),D=s(80068),B=s(85893);function L(){window.__c={n:"SidebarCreateTeamModalFooter"};const e=(0,n.O7)(),{currentSpaceStore:t,spaceViewStore:s}=(0,a.VK)((()=>({currentSpaceStore:T.default.state.currentSpaceStore,spaceViewStore:T.default.state.currentSpaceViewStore})),[]),r=(0,a.VK)((()=>k.Z.state),[]),l=(0,C.OX)(),d=function(){const e=(0,a.VK)((()=>A.Mk()&&!k.Z.state.isDefault),[]),t=k.F.Team,s=k.F.Members;return e?[t,s]:[t]}(),{screen:m,pageNumber:g,teamId:h}=r,f=""===r.name,y=(0,o.yK)((e=>({box:{justifyContent:"space-between",alignItems:"center",display:"flex",width:"100%",paddingTop:22},button:{marginLeft:8},previous:{fontSize:14,color:e.mediumTextColor,cursor:"pointer"},learnMoreLink:{overflow:"hidden"}})),[]),x=(0,i.useCallback)(((s,i)=>{t&&function(e){let{pageOrder:t,pageNumber:s,teamId:i,currentSpaceStore:n,environment:a,from:o}=e;const r=s+1;if(r<=t.length)k.Z.update((e=>({...e,loading:!1,screen:t[r-1],pageNumber:r})));else if(i){const e=I.zX.createChildStore(n,{table:"team",id:i,spaceId:n.id});_.hI({environment:a,teamStore:e,shouldScroll:!0}),_.ED({environment:a,from:o,teamStore:e})}}({pageOrder:d,pageNumber:g,teamId:i||h,currentSpaceStore:t,environment:e,from:s})}),[t,e,g,d,h]),v=c.Ds((async()=>{if(!t||!s)return;let i=h;switch(m){case k.F.Team:i=await async function(e){var t;let{spaceStore:s,environment:i,shouldShowZeroTeamsExperience:n,sidebarCreateTeamModalStoreState:a}=e;const{name:o,description:r,icon:l,flowId:d,accessLevel:c,isDefault:u}=a;if(!(await(0,F.Xg)({environment:i,spaceStore:s,teamName:o})))return;let m;k.Z.update((e=>({...e,loading:!0}))),m=n?await R.HD({environment:i,name:o,description:r,icon:l,flowId:d,trackCreateTeamComplete:!0}):await R.Cm({environment:i,name:o,description:r,icon:l,accessLevel:c,isDefault:u,flowId:d,createTeamHome:!0});if(!m)return;const p=null===(t=m)||void 0===t?void 0:t.id;return k.Z.update((e=>({...e,teamId:p}))),p}({spaceStore:t,environment:e,shouldShowZeroTeamsExperience:l,sidebarCreateTeamModalStoreState:r});break;case k.F.Members:break;default:(0,u.t1)(m)}i?x("success",i):k.Z.update((e=>({...e,loading:!1})))}),1e3,{leading:!0,trailing:!1}),S=(0,i.useCallback)(v,[v]);return(0,B.jsxs)("div",{style:y.box,children:[(0,B.jsx)(D.Z,{containerStyle:y.learnMoreLink,helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_sidebar_create_team_modal"}),(0,B.jsx)("div",{style:{display:"inline-flex"},children:(0,B.jsx)(Z.Z,{isLarge:!0,onClick:S,disabled:f,style:y.button,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.footer.createTeam",defaultMessage:"Create teamspace"})})})]})}var N=s(60701),O=s(38078),E=s(74016);const V={userSelect:"none",WebkitUserSelect:"none",position:"relative",padding:"22px 26px"},U={createTeamContainer:{...V,width:480},addMembersContainer:{...V,width:500},full:{width:"100%"}},W=(0,p.defineMessages)({teamNamePlaceholder:{id:"sidebarCreateTeamModal.teamScreen.namePlaceholder",defaultMessage:"Acme Labs"},teamDescriptionPlaceholder:{id:"sidebarCreateTeamModal.teamScreen.descriptionPlaceholder",defaultMessage:"Details about your teamspace"}});function K(){window.__c={n:"TeamDescriptionRow"};const[e,t]=(0,a.AF)(k.Z);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M.Z,{hasMarginTop:!0,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamDescriptionLabel",defaultMessage:"Description"})}),(0,B.jsx)(f.Z,{value:e.description,placeholder:j.default.formatMessage(W.teamDescriptionPlaceholder),textarea:!0,onChange:s=>{t({...e,description:s.target.value})}})]})}function z(e){return(0,B.jsx)("div",{id:e.titleAriaId,style:{fontSize:18,fontWeight:m.Z.fontWeight.semibold},children:(()=>{switch(e.screen){case k.F.Team:return(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamTitle.label",defaultMessage:"Create a new teamspace"});case k.F.Members:return(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.membersTitle.label",defaultMessage:"Add people"});default:(0,u.t1)(e.screen)}})()})}function q(e){window.__c={n:"ModalContent"};const t=(0,n.O7)(),[s]=(0,a.AF)(k.Z),o=(0,i.useCallback)(((e,s)=>{_.ED({environment:t,from:s,teamStore:e})}),[t]),{screen:r}=s;switch(r){case k.F.Team:return(0,B.jsx)(Q,{titleAriaId:e.titleAriaId,descriptionAriaId:e.descriptionAriaId});case k.F.Members:const t=s.teamId;return t?(0,B.jsx)(J,{teamId:t,onCompleted:e=>{o(e,"success")},onCanceled:e=>{o(e,"dismiss_button")}}):null;default:(0,u.t1)(r)}}function G(){window.__c={n:"TeamIconAndNameRow"};const[e,t]=(0,a.AF)(k.Z),s=(0,a.VK)((()=>T.default.state.currentSpaceStore),[]),i=(0,o.yK)((e=>({container:{display:"inline-flex",width:"100%",verticalAlign:"middle"},icon:{marginRight:8,marginTop:1}})),[]);if(!s)return null;const n=e.icon?{icon:e.icon,pointer:{table:"space",id:s.id}}:void 0;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M.Z,{hasMarginTop:!0,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamNameLabel",defaultMessage:"Icon & name"})}),(0,B.jsxs)("div",{style:i.container,children:[(0,B.jsx)(E.p,{icon:n,size:26,style:i.icon,onChange:s=>{t({...e,icon:s})},iconLoggingData:{recordTable:"team",source:"team_creation"}}),(0,B.jsx)(f.Z,{value:e.name,placeholder:j.default.formatMessage(W.teamNamePlaceholder),onChange:s=>{t({...e,name:s.target.value})},preventSafariAutofill:!0})]})]})}function H(e){window.__c={n:"Description"};const t=(0,o.yK)((()=>({})),[]);return(0,B.jsx)(S.Z,{id:e.descriptionAriaId,isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:t.description,children:(()=>{switch(e.screen){case k.F.Team:return(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamDescription.label",defaultMessage:"Teamspaces are where your team organizes pages, permissions, and members"});case k.F.Members:return null;default:(0,u.t1)(e.screen)}})()})}function Q(e){window.__c={n:"TeamScreen"};const[t]=(0,a.AF)(k.Z),s=(0,n.O7)();return(0,i.useEffect)((()=>{if(t.open){const{from:e,flowId:i}=t;g.krX(s,{from:e,flowId:i})}}),[]),(0,B.jsxs)("div",{style:U.createTeamContainer,children:[(0,B.jsx)(z,{titleAriaId:e.titleAriaId,screen:k.F.Team}),(0,B.jsx)(H,{descriptionAriaId:e.descriptionAriaId,screen:k.F.Team}),(0,B.jsxs)("div",{style:U.full,children:[(0,B.jsx)(G,{}),(0,B.jsx)(K,{}),(0,B.jsx)($,{})]}),(0,B.jsx)(L,{})]})}function Y(){window.__c={n:"ScreenLoadingSpinner"};const e=(0,a.VK)((()=>k.Z.state.loading),[]),t=(0,o.yK)((e=>({spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0}})),[]);return(0,B.jsx)(B.Fragment,{children:e&&(0,B.jsx)("div",{style:t.spinner,children:(0,B.jsx)(x.Z,{style:{position:"absolute",top:"50%",left:"50%"}})})})}function $(){window.__c={n:"AccessLevelSection"};const e=(0,o.yK)((e=>({openAccessMessage:{fontSize:13,color:e.mediumTextColor,marginTop:20,lineHeight:1.4,display:"flex"},iconContainer:{marginRight:8},openTeamIcon:{width:24,fill:e.mediumIconColor},teamAccessPopupContainer:{marginTop:20}})),[]),[t,s]=(0,a.AF)(k.Z),i=(0,C.OX)(),r=(0,n.O7)(),l=(0,a.VK)((()=>{const e=T.default.state.currentSpaceStore;return e?(0,w.rn)(r,e):"this workspace"}),[r]);return i?(0,B.jsxs)("div",{style:e.openAccessMessage,children:[(0,B.jsx)("div",{style:e.iconContainer,children:(0,d.R)(e.openTeamIcon)}),(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.openAccessLabel",defaultMessage:"Everyone at {spaceName} and new members will have access to this teamspace",values:{spaceName:l}})]}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M.Z,{hasMarginTop:!0,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.permissionsLabel",defaultMessage:"Permissions"})}),(0,B.jsx)(N._,{currentAccessLevel:t.accessLevel,currentIsDefault:t.isDefault,onChange:(e,i)=>{s(i?{...t,accessLevel:"open",isDefault:i}:{...t,accessLevel:e,isDefault:i})}})]})}function J(e){window.__c={n:"MemberScreen"};const t=(0,n.O7)(),[,,s]=(0,a.AF)(k.Z),[,,i]=(0,a.AF)(void 0,P.Z);(0,a.VK)((()=>{const{defaultInviteTargets:e,flowId:t}=s.state;i.setState({...i.state,flowId:t}),e&&i.setState({...i.state,isInviteTargetsEmpty:!1,inviteTargets:e})}),[s,i]);const o=(0,a.VK)((()=>T.default.state.currentSpaceStore),[]);if(!o)return null;const r=I.zX.createChildStore(o,{table:"team",id:e.teamId,spaceId:o.id});return(0,B.jsx)("div",{style:U.full,children:(0,B.jsx)("div",{style:U.addMembersContainer,children:(0,B.jsx)(O.Z,{store:r,permissionsInviteStore:i,isNewlyCreatedTeam:!0,onSubmitSuccessful:()=>{e.onCompleted(r),_.hI({environment:t,teamStore:r,shouldScroll:!0})},onDismiss:()=>{e.onCanceled(r)}})})})}const X=[r.Z.images.avatars.avatar1Png,r.Z.images.avatars.avatar2Png,r.Z.images.avatars.avatar3Png];function ee(e){let{handleModalClose:t}=e;window.__c={n:"FirstTeamHeader"};const s=(0,o.yK)((e=>({container:{borderTopLeftRadius:5,borderTopRightRadius:5,background:e.inputBackground,boxShadow:e.inputBoxShadow},header:{display:"flex",padding:14,fontWeight:m.Z.fontWeight.medium},avatarGroup:{display:"flex",width:"100",marginLeft:4,alignSelf:"center"},avatar:{marginLeft:-4},message:{paddingLeft:14,paddingRight:14},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,B.jsx)("div",{style:s.container,children:(0,B.jsxs)("div",{style:s.header,children:[(0,B.jsx)("div",{style:s.avatarGroup,children:X.map(((e,t)=>(0,B.jsx)(b.Z,{avatarShouldShowShadow:!0,style:s.avatar,size:28,avatar:{avatarUrl:e}},t)))}),(0,B.jsx)(S.Z,{style:s.message,isMultiline:!0,isSmall:!0,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.firstTeamHeader",defaultMessage:"Create your first teamspace to start using Notion with your teammates"})}),(0,B.jsx)(h.Z,{onClick:t,style:s.closeButton,hoveredStyle:s.closeButtonHover,children:(0,l.D)(s.closeButtonIcon)})]})})}function te(){window.__c={n:"SidebarCreateTeamModal"};const e=(0,n.O7)(),[t,,]=(0,a.AF)(k.Z),s=(0,i.useId)(),r=(0,i.useId)(),d=(0,o.yK)((e=>({modal:{maxWidth:500,borderRadius:5},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor},wrapper:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}})),[]),u=(0,i.useCallback)((t=>{_.ED({environment:e,from:t})}),[e]),{open:m,loading:p,screen:g}=t,f=(0,C.OX)(),x=(0,i.useRef)(f);return(0,i.useEffect)((()=>{p||(x.current=f&&g===k.F.Team)}),[p,g,f]),m?(0,B.jsx)(v.Z,{ariaLabelledBy:s,ariaDescribedBy:r,open:m,innerStyle:d.modal,onDismiss:()=>{u("modal")},render:()=>{const{device:t}=e;return(0,B.jsxs)("div",{style:{height:"100%"},children:[!t.isMobile&&(x.current?(0,B.jsx)(ee,{handleModalClose:()=>{u("close_button")}}):(0,B.jsx)(h.Z,{onClick:()=>{u("close_button")},style:d.closeButton,hoveredStyle:d.closeButtonHover,children:(0,l.D)(d.closeButtonIcon)})),(0,B.jsx)("div",{style:d.wrapper,children:(0,B.jsx)(y.Z,{capture:!0,onBackspace:c.yR,onLeft:c.yR,onRight:c.yR,onSelectAll:c.yR,onRedo:c.yR,onUndo:c.yR,onCut:c.yR,onCopy:c.yR,onPaste:c.yR,onKeypress:c.yR,onDelete:c.yR,onTab:c.yR,children:(0,B.jsx)(q,{titleAriaId:s,descriptionAriaId:r})})}),(0,B.jsx)(Y,{})]})}}):null}},60701:(e,t,s)=>{s.d(t,{_:()=>M});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(36591),r=s(42853),l=s(5257),d=s(52275),c=s(31945),u=s(78140),m=s(32163),p=s(72495),g=s(26388),h=s(87279),f=s(98742),y=s(4023),x=s(31194),v=s(56187),S=s(26160),b=s(85893);function M(e){let{currentAccessLevel:t,currentIsDefault:s=!1,onChange:M,teamStore:j,disabledWithRightChevron:w=!1,style:C}=e;window.__c={n:"TeamAccessLevelButtonPopup"};const{device:k}=(0,i.O7)(),T=(0,v.q)(j),I=(0,a.yK)((e=>({chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},selectedButton:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${e.outlineButtonBorder}`,...C},selectedCheckmark:{width:k.isMobile?16:14},icon:{alignSelf:"center",marginTop:0}})),[k.isMobile,C]),P=(0,n.VK)((()=>(null==j?void 0:j.isDefault())??s),[j,s]),_=P?"default":t,Z=(0,S.U)({teamStore:j,onChange:M,isDefault:P});return(0,b.jsx)(c.ZP,{popupType:k.isMobile?c.Z4.SlideUp:c.Z4.Popup,renderOrigin:e=>{const t=Z.find((e=>e.key===_));if(!t)return null;const s=t.disableAllOptionsTooltip,i=w||Boolean(s)||Boolean(j)&&!T;return(0,b.jsx)(g.Z,{placement:y.u.Bottom,alignment:y.v.Start,disableTooltip:!s||!T,renderTooltip:()=>s,style:{width:350},textWrap:!0,render:s=>(0,b.jsx)(d.Z,{...(0,f.Z)(e,s),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:I.icon,disabled:i,right:w?(0,l.o)(I.chevron):i?void 0:(0,r.i)(I.chevron),focused:!1,shouldWrapCaption:!0,buttonStyle:I.selectedButton})})},placementToOrigin:x.Iw.Bottom,alignmentToOrigin:x.lU.Start,sameWidthAsOrigin:!0,render:e=>{const t=[{key:"access levels",render:e=>(0,b.jsx)(p.Z,{...e,topBorder:0!==e.index}),items:Z.map((t=>{const s=t.key===_;return{key:t.key,render:e=>(0,b.jsx)(g.Z,{placement:y.u.Top,disableTooltip:!t.tooltip,renderTooltip:()=>t.tooltip,render:i=>(0,b.jsx)(d.Z,{...(0,f.Z)(e,i),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:I.icon,right:s?(0,b.jsx)("div",{style:I.selectedCheckmark,children:(0,o.e)()}):void 0,disabled:t.disabled,shouldWrapCaption:!0})}),action:()=>{t.onSelect(),e.close()}}}))}];return(0,b.jsx)(u.Z,{menuType:h.og.Popup,children:(0,b.jsx)(m.Z,{type:m.i.Vertical,initialFocus:void 0,sections:t})})}})}},86232:(e,t,s)=>{s.d(t,{M:()=>b});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(82990),l=s(38755),d=s(95697),c=s(1083),u=s(64552),m=s(31412),p=s(89728),g=s(80444),h=s(9867),f=s(85893);const y=function(e){window.__c={n:"TeamJoinButton"};const{teamStore:t,from:s,navigateToTeamHomeOnJoin:o,onJoinedTeam:r,style:l,hoveredStyle:d,icon:c,isRed:u}=e,y=(0,n.O7)(),x=(0,a.VK)((()=>g.default.state.currentSpaceStore),[]),v=(0,i.useCallback)((async()=>{x&&(await h.um({environment:y,teamStore:t,currentSpaceStore:x,from:s,andNavigateToTeamHome:o??!1}),null==r||r())}),[x,y,t,s,o,r]);return(0,f.jsx)(p.Z,{style:l,hoveredStyle:d,onClick:v,icon:c,isRed:u,children:(0,f.jsx)(m.FormattedMessage,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var x=s(8787),v=s(14889);const S=function(e){window.__c={n:"TeamRequestButton"};const{teamStore:t,style:s,hoveredStyle:n}=e,[o,r]=(0,i.useState)(!1),l=(0,a.VK)((()=>t.getName()),[t]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(p.Z,{style:s,hoveredStyle:n,onClick:()=>r(!0),children:(0,f.jsx)(m.FormattedMessage,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,f.jsx)(v.Z,{teamStore:t,teamName:l,teamId:t.id,isModalOpen:o,onDismiss:()=>r(!1)})]})};function b(e){window.__c={n:"TeamJoinLeaveButton"};const{teamStore:t,style:s,hoveredStyle:i}=e,m=(0,n.O7)(),p=(0,c.Q)(),g=(0,u.e)(t),h=(0,a.VK)((()=>t.getTeamAccessLevel()),[t]),v=(0,o.yK)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:r.Z.fontWeight.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...s},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...i}})),[s,i]),b=(0,a.VK)((()=>(0,d.Hu)({membership:t.getRawMembership()})&&(0,l.Fn)(m)),[m,t]),M=!g&&"open"===h||b,j=!g&&"closed"===h;return p?null:g?(0,f.jsx)(x.Z,{...e,style:v.joinTeamButton,hoveredStyle:v.joinTeamButtonHoveredStyle}):M?(0,f.jsx)(y,{...e,style:v.joinTeamButton,hoveredStyle:v.joinTeamButtonHoveredStyle}):j?(0,f.jsx)(S,{teamStore:t,style:v.joinTeamButton,hoveredStyle:v.joinTeamButtonHoveredStyle}):null}},8787:(e,t,s)=>{s.d(t,{Z:()=>h});var i=s(67294),n=s(480),a=s(86628),o=s(36591),r=s(72126),l=s(64684),d=s(31412),c=s(89728),u=s(26388),m=s(80444),p=s(9867);var g=s(85893);const h=function(e){window.__c={n:"TeamLeaveButton"};const{teamStore:t,from:s,onLeavingTeam:h,style:f,hoveredStyle:y,icon:x,isRed:v,placement:S,alignment:b,buttonInternals:M}=e,j=(0,n.O7)(),w=(0,a.VK)((()=>m.default.state.currentSpaceStore),[]),C=(0,i.useCallback)((async()=>{if(!w)return;await p.s({environment:j,teamStore:t,currentSpaceStore:w,from:s})&&(null==h||h())}),[w,j,t,s,h]),k=(0,g.jsx)(d.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),T=function(e){let{teamStore:t}=e;const s=(0,n.O7)().currentUser.id,{isDefaultTeam:i}=(0,a.VK)((()=>({isDefaultTeam:t.isDefault()})),[t]),o=function(e){const t=(0,a.VK)((()=>m.default.state.currentSpaceStore),[]);return(0,a.VK)((()=>e.isDefined()&&null!=t&&t.isDefined()?(0,l.x4)({members:e.getMembers(),groups:(null==t?void 0:t.getPermissionGroups())??[]}):[]),[e,t])}(t),c=(0,a.VK)((()=>s?o.filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(s)})):[]),[o,s]),u=(0,a.VK)((()=>{if(!t.isReady())return!1;const e=(0,l.XO)({membership:t.getMembers()});return 1===e.length&&e[0]===s}),[t,s]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:s,userGroups:i}=e;if(t)return(0,g.jsx)(d.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You can’t leave this teamspace because everyone in the workspace must be a member"});if(s)return(0,g.jsx)(d.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(i.length>0)return(0,g.jsx)(d.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:r.oA(i.map((e=>e.name))).join()}})}({isDefaultTeam:i,isOnlyTeamOwner:u,userGroups:c})}({teamStore:t}),I=Boolean(T),P=I?T:k;return(0,g.jsx)(u.Z,{style:I?{width:240}:void 0,disableTooltip:!Boolean(P),renderTooltip:e=>(0,g.jsx)("div",{...e,children:P}),textWrap:I,placement:S,alignment:b,render:e=>(0,g.jsx)(c.Z,{...e,style:f,hoveredStyle:y,onClick:C,disabled:I,disabledFeedback:I,icon:x,isRed:v,children:M||(0,g.jsxs)(g.Fragment,{children:[(0,o.e)({width:12.5,marginRight:4}),(0,g.jsx)(d.FormattedMessage,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},43488:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var i=s(16184),n=s(31412),a=s(26388),o=s(85893);function r(e){let{iconStyle:t}=e;return(0,o.jsx)(a.Z,{textWrap:!0,style:{width:210},placement:a.Z.Placement.Bottom,renderTooltip:()=>(0,o.jsx)(n.FormattedMessage,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,o.jsx)("div",{...e,children:(0,i.Q)(t)})})}},38680:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(33728),r=s(59054),l=s(31412),d=s(78140),c=s(43579),u=s(91487),m=s(47082),p=s(4708),g=s(87279),h=s(45101),f=s(95697),y=s(80444),x=s(33052),v=s(34583),S=s(42853),b=s(72126),M=s(52275),j=s(31945),w=s(32163),C=s(89728),k=s(72495),T=s(26388),I=s(31194),P=s(56187),_=s(85893);function Z(e){window.__c={n:"TeamRoleSelect"};const{disabled:t,selectedRole:s,allRoles:o,onChange:r,store:c,labelStyle:u}=e,{device:m}=(0,i.O7)(),p=(0,a.Fg)(),h=(0,P.q)(c),x=(0,n.VK)((()=>{const{currentSpaceStore:e}=y.default.state;return null==e?void 0:e.canEditMembership()}),[]),v=(0,n.VK)((()=>c.isDefault()),[c]);return(0,_.jsx)(j.ZP,{popupType:m.isMobile?j.Z4.SlideUp:j.Z4.Popup,renderOrigin:e=>(0,_.jsxs)(C.Z,{style:u,disabled:t,disabledFeedback:!0,...e,children:[(0,_.jsx)(l.FormattedMessage,{...f.q9[s].label}),(0,S.i)({width:10,marginLeft:4,fill:p.lightIconColor})]}),placementToOrigin:I.Iw.Bottom,render:e=>{const t=[{key:"roles",render:e=>(0,_.jsx)(k.Z,{...e,topBorder:0!==e.index}),items:o.map((t=>{const i=!h&&"owner"===t,n=v&&"team_level_guest"===t,a=!x&&"team_level_guest"===t,o=!h&&"team_level_guest"===t,d=i||n||a||o;return{key:t,render:e=>(0,_.jsx)(T.Z,{disableTooltip:!d,placement:T.Z.Placement.Right,textWrap:!0,renderTooltip:()=>i?(0,_.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingOwnerForMembers",defaultMessage:"Teamspace members can't add owners"}):n?(0,_.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestsInDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"}):a||o?(0,_.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestForNonSpaceAdminsOrNonTeamOwners",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"}):void 0,render:i=>(0,_.jsx)("span",{...i,children:(0,_.jsx)(M.Z,{...e,focused:!1,checkState:b.Xy(t,s),disabled:d,disabledFeedback:d,title:(0,_.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,_.jsx)(l.FormattedMessage,{...f.q9[t].label})}),caption:(0,_.jsx)("span",{style:{color:p.mediumTextColor},children:(0,_.jsx)(l.FormattedMessage,{...f.q9[t].caption})}),shouldWrapCaption:!0})})}),action:()=>{r(t),e.close()}}}))}];let i;return i=m.isMobile?{menuType:g.og.Modal,title:(0,_.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,_.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:g.og.Popup,width:264},(0,_.jsx)(d.Z,{...i,children:(0,_.jsx)(w.Z,{type:w.i.Vertical,initialFocus:void 0,sections:t})})}})}const F="member";function A(e){window.__c={n:"TeamPermissionsInviteInput"};const{store:t,permissionsInviteStore:s,onEmptySubmit:i}=e,r=(0,l.useIntl)(),d=(0,n.VK)((()=>Boolean(s.state.isFocused)),[s]),c=(0,n.VK)((()=>s.state.tokenQuery),[s]),p=(0,n.VK)((()=>s.state.inviteRole),[s]),g=(0,n.VK)((()=>s.state.inviteTargets),[s]),f=(0,a.yK)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:d?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[d]);function y(e){if(s.state.isInviteTargetsEmpty)return;const t=s.state.inviteTargets.filter((t=>t!==e));0===g.length?s.setState({...s.state,inviteTargets:[],inviteRole:F,isInviteTargetsEmpty:!0}):s.setState({...s.state,inviteTargets:t})}function x(e){s.setState({...s.state,isFocused:e})}const v=g.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,_.jsx)(u.Z,{target:e,onClickRemove:y,role:p,shouldWrap:!0,style:f.inputTokenVerticalMargin,backgroundColor:(0,h.gQ)(e)},t)}));return(0,_.jsx)(m.Z,{focus:d,onClick:()=>x(!0),format:m.Z.Format.Share,value:c,onChange:function(e){const t=e.target.value,{extractedEmails:i,newInputValue:n}=(0,o.zI)(t),a=i.map((e=>({type:"newUser",value:{email:e},source:"email"}))).filter((e=>!(0,h.Nd)({target:e,permissionsInviteStore:s}))),r=[...s.state.inviteTargets,...a];r.length>0?(s.setState({...s.state,inviteTargets:r,isInviteTargetsEmpty:!1,tokenQuery:n}),x(!(a.length>0))):s.setState({...s.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:n})},onEmptySubmit:i,type:"email",placeholder:r.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:v,onRemoveLastToken:function(){const e={...s.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=F),s.setState(e)},focusAfterAnimation:!0,right:(0,_.jsx)(R,{store:t,permissionsInviteStore:s}),style:f.tokenMenuItem,inputStyle:f.inputTokenVerticalMargin,inputDivStyle:f.inputDiv,inputFullWidth:!0})}function R(e){window.__c={n:"TeamPermissionsInviteRoleSelect"};const{store:t,permissionsInviteStore:s}=e,i=(0,n.VK)((()=>{const e=y.default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,p.F$)()}),[]),o=(0,n.VK)((()=>s.state.inviteRole),[s]),r=(0,a.yK)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){s.setState({...s.state,inviteRole:e})}return i?(0,_.jsx)(Z,{store:t,selectedRole:o,allRoles:f.ZN,onChange:l,labelStyle:r.teamRoleLabel}):(0,_.jsx)(Z,{store:t,selectedRole:o,allRoles:f.$r,onChange:l,labelStyle:r.teamRoleLabel})}const D=function(e){window.__c={n:"TeamPermissionsInvite"};const{store:t,onEmptySubmit:s}=e,o=(0,i.O7)();(0,r.r5)((async()=>{await v.bi(o)}),[]);const l=(0,n.qz)(e.permissionsInviteStore,x.Z),u=(0,n.VK)((()=>Boolean(l.state.isFocused)),[l]),m=(0,n.VK)((()=>l.state.tokenQuery),[l]),p=(0,n.VK)((()=>u&&m.length>0),[u,m]),h=(0,a.yK)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.contentBackground,boxShadow:e.largeBoxShadow,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){l.setState({...l.state,isFocused:e})}return(0,_.jsx)("div",{onFocus:()=>f(!0),onBlur:()=>f(!1),children:(0,_.jsx)(d.Z,{menuType:g.og.Popup,header:(0,_.jsx)(A,{store:t,permissionsInviteStore:l,onEmptySubmit:s}),scrollerStyle:h.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:p&&(0,_.jsx)("div",{style:h.permissionsInviteSearchRequest,children:(0,_.jsx)(c.Z,{permissionsInviteStore:l,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}},38078:(e,t,s)=>{s.d(t,{Z:()=>L,u:()=>B});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(33728),l=s(27714),d=s(82990),c=s(31412),u=s(50906),m=s(14871),p=s(95209),g=s(64964),h=s(42922),f=s(68785),y=s(63296),x=s(89728),v=s(26388),S=s(64369),b=s(43250),M=s(4708),j=s(15010),w=s(45101),C=s(95697),k=s(77907),T=s(80444),I=s(35057),P=s(9867),_=s(74016),Z=s(30765),F=s(85893);const A={button:{height:32},buttonContainer:{width:"100%",paddingTop:22,display:"flex",justifyContent:"end"},multiButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"space-between"},singleButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"right"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},containerLeftAligned:{display:"flex",alignItems:"left",justifyContent:"left",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},titleAndIcon:{paddingBottom:18,alignItems:"center",display:"flex"},addMembersTo:{minWidth:"25%"},icon:{paddingRight:3,paddingLeft:3},teamName:{paddingRight:10,fontWeight:d.Z.fontWeight.medium,...d.Z.textOverflowStyle,maxWidth:250},full:{width:"100%"},submitTooltip:{minWidth:250},subtitle:{paddingTop:16}};function R(e){var t;let{isLoading:s,isNewlyCreatedTeam:i,onDismiss:n,onSubmit:o,inviteTargets:r,includesGroups:l,inviteRole:d,canEditSpaceMembership:u,membershipRequestsDisabled:m,spaceAllowedDomains:p,hasTeamGuestsMatchAllowedDomain:g}=e;window.__c={n:"InviteSubmitButton"};const x=r.length>0,S=l&&"owner"===d,b=r.filter((e=>(0,w.OA)(e))).length>0&&m&&!u,j=(0,a.VK)((()=>(0,M.F$)()&&"team_level_guest"===d&&r.some((e=>"group"===e.type||"existingUser"===e.type&&"none"!==e.spaceRole&&"not_in_space"!==e.spaceRole))),[d,r]),C=S||j||b||g;if(s)return(0,F.jsx)(h.Z,{style:{...A.button,minWidth:80},disabled:!0,children:(0,F.jsx)(f.Z,{isWhite:!0})});if(i&&!x)return(0,F.jsx)(y.Z,{style:A.button,onClick:n,disabled:s,children:(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.skipForNow",defaultMessage:"Skip for now"})});const k=S?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.groupsAsOwnersTooltip",defaultMessage:"Cannot add groups as teamspace owners. Remove any groups to continue."}):j?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.memberOrGroupInvitedAsTeamGuestTooltip",defaultMessage:"Cannot add space members or groups as teamspace guests. Remove them to continue."}):g?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.hasTeamGuestsMatchAllowedDomain",defaultMessage:"Cannot add users with {emailDomains} as teamspace guests. Remove them to continue.",values:{emailDomains:null==p||null===(t=p.map((e=>`@${e}`)))||void 0===t?void 0:t.join(", ")}}):null;return(0,F.jsx)(v.Z,{textWrap:!0,style:A.submitTooltip,disableTooltip:!k,renderTooltip:()=>k,render:e=>(0,F.jsx)(h.Z,{style:A.button,onClick:o,disabled:!x||s||C,...e,children:(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlayV2.inviteButton.label",defaultMessage:"Invite"})})})}function D(e){let{inviteTargets:t,workspaceName:s,canEditSpaceMembership:i,membershipRequestsDisabled:n,isFreeTier:a,inviteRole:o,hasTeamGuestsMatchAllowedDomain:r}=e;if(void 0===i)return null;if(!t||0===t.length)return null;const l=t.map((e=>{if("group"!==e.type&&(0,w.OA)(e))return e.value.email})).filter((e=>e));if(!l||0===l.length)return null;const d=e=>(0,F.jsx)("b",{children:e}),u=s??"this workspace";return i?a?(0,F.jsx)(S.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingularOwner.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a workspace owner.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPluralOwners.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as workspace owners.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})}):"team_level_guest"===o?r?null:(0,F.jsx)(S.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.teamGuest.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed teamspace guest.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.teamGuest.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed teamspace guests.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})}):(0,F.jsx)(S.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed workspace member.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed workspace members.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})}):n?(0,F.jsx)(S.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipDisabled.subtitle",defaultMessage:"You can't add workspace guests to a teamspace. Ask your admin to add them as workspace members first."})}):(0,F.jsx)(S.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipSingular.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{guestEmail}</b> as a member to {workspaceName}.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipPlural.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> as members to {workspaceName}.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})})}function B(e){window.__c={n:"InviteLink"};const{store:t,isSmall:s}=e,i=(0,n.O7)(),a=(0,o.yK)((e=>({button:{marginRight:5,marginLeft:5,height:32,fontSize:s?12:14},icon:{width:s?12:14,height:s?12:14}})),[s]);return(0,F.jsx)(x.Z,{onClick:()=>{m.RD({environment:i,stringValue:C.W8(t.id),copiedMessage:m.tq.copiedLinkToClipboard}),u.XTk(i,{store:t})},icon:l.N,style:a.button,iconStyle:a.icon,isBlue:!0,children:s?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkCondensedButton.label",defaultMessage:"Copy link"}):(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkButton.label",defaultMessage:"Copy invite link"})})}const L=function(e){let{store:t,permissionsInviteStore:s,isNewlyCreatedTeam:o,onSubmitSuccessful:l,onDismiss:d}=e;window.__c={n:"TeamPermissionsInviteOverlay"};const m=(0,n.O7)(),{teamName:h,workspaceName:f,canEditSpaceMembership:y,membershipRequestsDisabled:x,teamAccessLevel:v,spaceAllowedDomains:S}=(0,a.VK)((()=>{const{currentSpaceStore:e}=T.default.state;return{teamName:t.getName(),workspaceName:null==e?void 0:e.getName(),canEditSpaceMembership:null==e?void 0:e.canEditMembership(),membershipRequestsDisabled:null==e?void 0:e.getDisableMembershipRequests(),teamAccessLevel:t.getTeamAccessLevel(),spaceAllowedDomains:null==e?void 0:e.getEmailDomains()}}),[t]);(0,i.useEffect)((()=>()=>{o&&P.hI({environment:m,teamStore:t,shouldScroll:!0})}),[o,t,m]);const[L,N]=(0,i.useState)(!1),O=(0,a.VK)((()=>s.state.inviteTargets),[s]),E=(0,a.VK)((()=>s.state.inviteTargets.length),[s]),V=(0,a.VK)((()=>s.state.inviteRole),[s]),U=(0,a.VK)((()=>{if(s.state.isInviteTargetsEmpty)return!1;return Boolean(s.state.inviteTargets.find((e=>"group"===e.type)))}),[s]),W=(0,a.VK)((()=>I.QM()),[]),K=(0,a.VK)((()=>!(null==S||!S.length||"team_level_guest"!==V||!(0,M.F$)())&&O.some((e=>"group"!==e.type&&(0,r.dy)(S,e.value.email)))),[S,V,O]),z=(0,a.VK)((()=>(0,M.s$)()?!W&&!C.U2(t):"open"===v&&(0,M.u3)()),[t,v,W]),q=async()=>{if(N(!0),E>0){const e=s.state.inviteTargets,{success:i}=await p.zK({environment:m,store:t,permissionsInviteStore:s,inviteOrigin:"team_invite_overlay"});if(void 0!==y)if(i){u.JkE(m,{invite_origin:"team_invite_overlay",domainType:(0,j.JF)(),new_workspace_member_count:E});const s=(0,w.t0)({inviteTargets:e,recordStore:t,canEditSpaceMembership:y});if(!s)return;setTimeout((()=>{g.oV({label:s})}))}else setTimeout((()=>{g.oV({label:(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlay.inviteMembersFailure.message",defaultMessage:"Failed to send invites"})})}))}p.Mr({permissionsInviteStore:s}),N(!1),null==l||l()};return(0,F.jsx)("div",{className:b.D$4,style:{...A.full},children:(0,F.jsxs)("div",{style:A.containerLeftAligned,children:[(0,F.jsxs)("div",{style:A.titleAndIcon,children:[(0,F.jsx)("div",{style:A.addMembersTo,children:(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.membersTitle.label",defaultMessage:"Invite people to"})}),(0,F.jsx)("div",{style:A.icon,children:(0,F.jsx)(_.p,{disabled:!0,store:t,size:20})}),(0,F.jsx)(Z.s,{style:A.teamName,children:h})]}),(0,F.jsxs)("div",{style:A.full,children:[(0,F.jsx)(k.LazyTeamPermissionsInvite,{store:t,permissionsInviteStore:s,onEmptySubmit:q}),(0,F.jsx)("div",{style:A.subtitle,children:(0,F.jsx)(D,{inviteTargets:O,workspaceName:f,canEditSpaceMembership:y,membershipRequestsDisabled:x,isFreeTier:W,inviteRole:V,hasTeamGuestsMatchAllowedDomain:K})})]}),(0,F.jsx)("div",{style:z?A.multiButtonContainer:A.singleButtonContainer,children:(0,F.jsxs)("div",{style:z?A.multiButtonContainer:{},children:[z&&(0,F.jsx)(B,{store:t}),(0,F.jsx)(R,{isLoading:L,onSubmit:q,onDismiss:()=>{p.Mr({permissionsInviteStore:s}),null==d||d()},isNewlyCreatedTeam:o,inviteTargets:O,includesGroups:U,inviteRole:V,canEditSpaceMembership:y,membershipRequestsDisabled:x,spaceAllowedDomains:S,hasTeamGuestsMatchAllowedDomain:K})]})})]})})}},71015:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});s(67294);var i=s(86628),n=s(9019),a=s(38078),o=s(85893);const r=function(e){window.__c={n:"TeamPermissionsInviteWithModal"};const[t,,s]=(0,i.AF)(e.permissionsInviteStore),r=()=>{s.reset()};return(0,o.jsx)(n.Z,{modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:500},open:t.modalOpen,onDismiss:r,renderContent:()=>(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"end",padding:22},children:(0,o.jsx)(a.Z,{store:e.store,permissionsInviteStore:s,isNewlyCreatedTeam:!1,onSubmitSuccessful:r,onDismiss:r})}),origin:e.origin})}},43119:(e,t,s)=>{s.d(t,{C:()=>b,Z:()=>M});s(57658);var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(16184),l=s(31412),d=s(52275),c=s(31945),u=s(78140),m=s(32163),p=s(72495),g=s(45653),h=s(87279),f=s(75546),y=s(80444),x=s(14034),v=s(74016),S=s(85893);function b(e){window.__c={n:"TeamPickerButton"};const{renderOrigin:t,onTeamAccept:s,sectionTitle:i,showMemberCount:o,right:f,showPrivate:v,onPrivateAccept:b,captionItem:w}=e,C=(0,n.Fy)().isMobile,k=j(),T=(0,x.E)(),I=(0,a.VK)((()=>T.filter((e=>e.canAddOrRemoveTopLevelPages()))),[T]),P=(0,a.VK)((()=>y.default.state.currentUserStore),[]),_=[];if(w){const e={key:"caption",render:e=>(0,S.jsx)(p.Z,{...e,topBorder:!0}),items:[w]};_.push(e)}const Z=I.map((e=>({key:e.id,action:()=>{s(e)},render:t=>(0,S.jsx)(M,{...t,team:e,onAccept:s,showMemberCount:o,right:f})}))),F={key:"teams",render:e=>(0,S.jsx)(p.Z,{...e,title:i}),items:Z};if(_.push(F),v){const e={key:"private",render:e=>(0,S.jsx)(p.Z,{...e,topBorder:Z.length>0}),items:[{key:"private",action:()=>{},render:e=>(0,S.jsx)(d.Z,{...e,icon:(0,S.jsxs)("div",{style:{position:"relative"},children:[(0,S.jsx)(g.Z,{hasTooltip:!1,userStore:P}),(0,r.Q)(k.privateItemLockIcon)]}),title:(0,S.jsx)(l.FormattedMessage,{id:"teamPickerButton.addToPrivate",defaultMessage:"Add to Private"}),onClick:()=>{null==b||b()}})}]};_.push(e)}return(0,S.jsx)(c.ZP,{...e,popupType:C?c.Z4.SlideUp:c.Z4.Popup,renderOrigin:t,render:e=>{let t;return t=C?{menuType:h.og.ActionSheet}:{menuType:h.og.Popup,width:"100%"},(0,S.jsx)(u.Z,{...t,children:(0,S.jsx)(m.Z,{style:{width:C?void 0:256},type:m.i.Vertical,initialFocus:void 0,sections:_})})}})}const M=i.forwardRef(((e,t)=>{window.__c={n:"TeamItem"};const{team:s,onAccept:i,showMemberCount:n,right:o,...r}=e,c=j(),u=(0,a.VK)((()=>s.getUserIdsInTeam().length),[s]);return(0,S.jsx)(d.Z,{...r,ref:t,onClick:e=>i(s),icon:(0,S.jsx)(v.p,{store:s,size:20,disabled:!0}),title:(0,S.jsx)(f.o,{teamStore:s}),right:r.focused?o:null,caption:n?(0,S.jsx)("div",{style:c.caption,children:(0,S.jsx)(l.FormattedMessage,{defaultMessage:"{numberOfMembers, plural, one {{numberOfMembers} member} other {{numberOfMembers} members}}",id:"teamPickerButton.teamItem.teamMemberCount",values:{numberOfMembers:u}})}):null})}));function j(){return(0,o.yK)((e=>({privateItemLockIcon:{position:"absolute",bottom:-2,right:-2,zIndex:1,width:10,height:10,fill:e.accentColors.red[500]},caption:{color:e.lightTextColor}})),[])}},80068:(e,t,s)=>{s.d(t,{Z:()=>m});s(67294);var i=s(24405),n=s(97880),a=s(31412),o=s(74523),r=s(18514),l=s(30765),d=s(85893);function c(e){switch(e){case"bestPractices":return(0,r.UY)("guides.teamspacesLearnMore");case"workspaceOwnerGuide":return(0,r.UY)("guides.teamspacesWorkspaceOwner");case"settingsAndPermissions":return(0,r.UY)("guides.teamspacesSettingsAndPermissions");default:return(0,n.t1)(e)}}function u(e){return e||(0,d.jsx)(l.s,{children:(0,d.jsx)(a.FormattedMessage,{defaultMessage:"Learn about teamspaces",id:"teamsLearnMoreLink"})})}function m(e){let{onClick:t,message:s,helpCenterLocation:n,analyticsFrom:a,containerStyle:r}=e;window.__c={n:"TeamsLearnMoreLink"};const l=(0,i.yK)((()=>({button:{maxWidth:"100%"}})),[]);return(0,d.jsx)("div",{style:r,children:(0,d.jsx)(o.Z,{buttonStyle:l.button,title:u(s),analyticsFrom:a,href:c(n),onClick:t})})}},79414:(e,t,s)=>{s.d(t,{n:()=>g});s(67294);var i=s(86628),n=s(24405),a=s(7928),o=s(31412),r=s(31278),l=s(45653),d=s(71862),c=s(80993),u=s(85893);const m=d.Z.iconSize,p=c.Kt;function g(e){let{ownerStores:t,teamStore:s,isSmall:a=!1}=e;window.__c={n:"TeamOwnerIcons"};const o=a?p:m,l=a?10:16,d=(0,n.yK)((e=>({container:{position:"relative",width:o,height:o},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[o]),{teamName:c,teamIcon:g}=(0,i.VK)((()=>({teamName:s.getName(),teamIcon:s.getIcon()})),[s]),f=e=>(0,u.jsx)(r.Z,{disabled:!0,title:c,icon:g,isEmptyPage:!1,size:e});return 0===t.length?f(o):(0,u.jsxs)("div",{style:d.container,children:[(0,u.jsx)(h,{isSmall:a,store:t[0]}),(0,u.jsx)("div",{style:d.teamBadge,children:f(l)})]})}function h(e){let{store:t,isSmall:s=!1,style:d={}}=e;window.__c={n:"OwnerIcon"};const c=(0,o.useIntl)(),g=s?p:m,h=(0,n.yK)((e=>({icon:{width:g,height:g,borderRadius:g,boxShadow:e.avatarBoxShadow,...d}})),[g,d]),f=(0,i.VK)((()=>null!=t&&t.isDefined()?(0,a.Nz)(c,null==t?void 0:t.getModel()):void 0),[c,t]),y=f?(0,u.jsx)(l.Z,{avatarShouldShowShadow:!0,userStore:t,size:g}):(0,u.jsx)(r.Z,{bucket:"public",disabled:!0,isEmptyPage:!1,title:f,size:g,icon:void 0});return(0,u.jsx)("div",{style:h.icon,children:y})}},14465:(e,t,s)=>{s.d(t,{z:()=>o});s(67294);var i=s(24405),n=s(82990),a=s(85893);function o(e){let{title:t,subtitle:s,style:o}=e;window.__c={n:"TeamSettingsHeader"};const r=(0,i.yK)((e=>({base:{width:"100%"},title:{fontWeight:n.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14},subtitle:{fontWeight:n.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:12}})),[]);return(0,a.jsxs)("div",{style:{...r.base,...o},children:[(0,a.jsx)("div",{style:r.title,children:t}),s&&(0,a.jsx)("div",{style:r.subtitle,children:s})]})}},80993:(e,t,s)=>{s.d(t,{Kt:()=>u,MQ:()=>c,Ph:()=>m,oM:()=>d});var i=s(67294),n=s(24405),a=s(61519),o=s(89728),r=s(14465),l=s(85893);const d=15,c=8,u=20;function m(e){window.__c={n:"TeamSettingsList"};const t=(0,n.yK)((()=>({button:{height:"auto",paddingLeft:0,paddingRight:0,display:"flex"},title:{marginBottom:10}})),[]);return Boolean(e.onClick)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(o.Z,{onClick:e.onClick,style:t.button,children:(0,l.jsx)(p,{...e})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(p,{...e})]})}function p(e){let{title:t,rows:s,hideDividers:o=!1,itemStyle:r,onClick:u}=e;window.__c={n:"TeamSettingsListContainer"};const m=(0,n.yK)((e=>({container:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,width:"100%"},list:{listStyle:"none",padding:0,margin:0},listItem:{marginLeft:d,marginRight:d,paddingTop:c,paddingBottom:c,...r},divider:{marginLeft:d,marginRight:d,borderColor:`${e.regularDividerColor}`}})),[r]);return(0,l.jsx)("div",{style:{...m.container},children:(0,l.jsx)("ul",{style:m.list,children:s.map(((e,t)=>(0,l.jsxs)(i.Fragment,{children:[!o&&t>0&&(0,l.jsx)(a.Z,{size:1,innerStyle:m.divider}),(0,l.jsx)("li",{style:m.listItem,children:e},t)]},t)))})})}},14034:(e,t,s)=>{s.d(t,{E:()=>o});var i=s(480),n=s(86628),a=s(28020);function o(){var e;const t=(0,i.O7)();return(null===(e=(0,n.Kw)((0,a.k_)(t)))||void 0===e?void 0:e.userJoinedTeamsStores)??[]}},1083:(e,t,s)=>{s.d(t,{Q:()=>l});var i=s(480),n=s(86628),a=s(38755),o=s(80444),r=s(78291);function l(){const e=function(){const e=(0,i.O7)();return(0,n.VK)((()=>{const t=o.default.state.currentSpaceStore,s=r.default.state.data;return t?a.Cx(t)?s?{loading:!1,isUserTeamGuestOfSpace:a.di(e,s)}:{loading:!0}:{loading:!1,isUserTeamGuestOfSpace:!1}:{loading:!0}}),[e])}();return(0,n.VK)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},64552:(e,t,s)=>{s.d(t,{e:()=>r});var i=s(480),n=s(86628),a=s(95697),o=s(80444);function r(e){const t=(0,i.O7)(),s=(0,n.VK)((()=>o.default.state.currentSpaceStore),[]);return(0,n.VK)((()=>(0,a.AL)({teamStore:e,spaceStore:s,userId:t.currentUser.id})),[s,t.currentUser.id,e])}},22487:(e,t,s)=>{s.d(t,{K:()=>r});var i=s(86628),n=s(27006),a=s(95697),o=s(80444);function r(e){return(0,i.VK)((()=>{if(!e)return 0;const t=o.default.state.currentSpaceStore,s=o.default.state.currentUserStore;if(!n.YX((null==t?void 0:t.getRole())??"none")){return(0,a.tu)({currentUserStore:s,currentSpaceStore:t,teamStore:e,members:e.getMembers()}).length}return(0,a.tO)({teamStore:e,spaceStore:t}).length}),[e])}},26160:(e,t,s)=>{s.d(t,{U:()=>M});s(30541),s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(8848),r=s(39812),l=s(40462),d=s(90199),c=s(49364),u=s(64684),m=s(31412),p=s(1865),g=s(38755),h=s(12205),f=s(80444),y=s(74136),x=s(85893);const v=function(e){let{tier:t}=e;const s=()=>"business"===t?(0,x.jsx)(m.FormattedMessage,{id:"upgradeToBusinessBadge",defaultMessage:"Business"}):(0,x.jsx)(m.FormattedMessage,{id:"upgradeToEnterpriseBadge",defaultMessage:"Enterprise"});return(0,x.jsx)(y.Z,{children:(0,x.jsx)(s,{})})};var S=s(11628),b=s(97082);function M(e){let{teamStore:t,isDefault:s,onChange:y=(()=>{})}=e;const M=(0,i.O7)(),w=(0,h.J)(),C=(0,b.y)(null==t?void 0:t.id),k=(0,S.P)(),T="business",I=(0,n.VK)((()=>f.default.state.currentSpaceStore),[]),P=(0,n.VK)((()=>{if(I)return(0,g.rn)(M,I)}),[M,I]),_=(0,n.VK)((()=>{const e=null==t?void 0:t.getSettingsStore().getValue();return!!e&&("private"===(0,u.B5)(e)??!1)}),[t]),Z=(0,a.yK)((()=>({openIcon:{width:20,height:20},lockIcon:{width:18,height:18},closedIcon:{width:20,height:20},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginLeft:5,marginRight:5}})),[]),F=(0,x.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamspaceUpsellBusiness.tooltip",defaultMessage:"Upgrade to Business Plan to enable Private teamspaces"}),A=(0,x.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamSpace.title",defaultMessage:"Default"}),R=(0,x.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.title",defaultMessage:"Open"}),D=(0,x.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.closedTeamSpace.title",defaultMessage:"Closed"}),B=(0,x.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamSpace.title",defaultMessage:"Private"}),L="dark"===(0,a.Fg)().mode?o.ZP.uiLightGray:o.ZP.black,N=[{key:"open",icon:e=>(0,x.jsx)("div",{style:Z.iconContainer,children:(0,c.R)({...e,...Z.openIcon})}),iconColor:L,level:R,title:R,caption:(0,x.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.openTeamspace.caption",defaultMessage:"Anyone can see and join this teamspace"}),disabled:!1,onSelect:()=>y("open",!1)},{key:"closed",icon:e=>(0,x.jsx)("div",{style:Z.iconContainer,children:(0,r.u)({...e,...Z.closedIcon})}),iconColor:L,level:D,title:D,caption:(0,x.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.closedTeamspace.caption",defaultMessage:"Anyone can see this teamspace but not join"}),disabled:!1,onSelect:()=>y("closed",!1)},{key:"private",icon:e=>(0,x.jsx)("div",{style:Z.iconContainer,children:(0,d.b)({...e,...Z.lockIcon})}),iconColor:L,level:B,title:k?B:(0,x.jsx)(j,{title:B,badge:(0,x.jsx)(v,{tier:T})}),caption:(0,x.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.privateTeamspace.caption",defaultMessage:"Only members can see that this teamspace exists"}),disabled:!k&&!w,tooltip:k?void 0:F,onSelect:()=>{if(!k&&!_)return p.y(M,{from:"team_security_settings",for:T,dontOpenPlansOnCancel:!0});y("private",!1)}}];if(s||w){const e=s&&(!w||C),t={key:"default",icon:e=>(0,x.jsx)("div",{style:Z.iconContainer,children:(0,l.o)({...e,...Z.lockIcon})}),iconColor:L,level:A,title:A,caption:(0,x.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.defaultTeamspace.caption",defaultMessage:"Everyone at {spaceName} must be a member",values:{spaceName:P}}),disabled:!1,disableAllOptionsTooltip:e?w?(0,x.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.closeOrPrivateTeamspace.disabledTooltipOnlyDefaultTeam",defaultMessage:"Add another default teamspace to change teamspace permissions."}):(0,x.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamspace.disabledTooltipNonAdmin",defaultMessage:"You can't change this setting because you are not a workspace admin"}):void 0,onSelect:()=>y("open",!0)};N.unshift(t)}return N}function j(e){let{title:t,badge:s}=e;window.__c={n:"TitleWithBadge"};const i=(0,a.yK)((()=>({container:{display:"flex",flexWrap:"wrap",alignItems:"center"},badge:{marginLeft:5}})),[]);return(0,x.jsxs)("div",{style:i.container,children:[t,(0,x.jsx)("div",{style:i.badge,children:s})]})}},29318:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ne});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(15145),l=s(45433),d=s(11002),c=s(31412),u=s(50906),m=s(54642),p=s(9284),g=s(81924),h=s(86282),f=s(75018),y=s(39699),x=s(50506),v=s(28020),S=s(34045),b=s(93959),M=s(54258),j=s(4708),w=s(98165),C=s(94660),k=s(80444),T=s(31931),I=s(59307);var P=s(65435),_=s(84465),Z=s(94952),F=s(73314),A=s(97880),R=s(33929),D=s(77080);function B(e){const{subscriptionTier:t,userPersona:s,selectedTopCategory:i,isNewInAppGalleryEnabled:n}=e;if(n){const e=function(e){var t;const s=e??(null===(t=I.Z.state.data)||void 0===t?void 0:t.defaultCategoryId);if(!s)return;const i=(0,P.oO)(s);if(!i)return;return{selectedTopCategory:s,allTemplates:N(i)}}(i);if(e)return e}return function(e){return{selectedTopCategory:void 0,allTemplates:L(e)}}({subscriptionTier:t,userPersona:s})}function L(e){let{userPersona:t,subscriptionTier:s}=e;const i=R.default.getIntl();return Object.fromEntries((0,P.Io)({userPersona:t,subscriptionTier:s}).map((e=>[e,[..._.gh[e].map((e=>(0,b.F0)((0,S.appConfigs)(),e))),..._.J9[e].filter((e=>(0,Z.G)(e,D.default))).map((e=>(0,F.G)(e,i)))]])))}function N(e){return e.subcategories.reduce(((e,t)=>{let{id:s,templates:i}=t;return s&&null!=i&&i.length?{...e,[s]:i.map((e=>"preset"===e.type?(0,b.F0)((0,S.appConfigs)(),e.uri):"pageTemplate"===e.type?e.template:void(0,A.t1)(e)))}:e}),{})}var O=s(29949),E=s(41892),V=s(75071),U=s(21202),W=s(42922),K=s(31945),z=s(62896),q=s(73063),G=s(16354),H=s(64369),Q=s(31192);var Y=s(82136),$=s(26350),J=s(43119),X=s(14034),ee=s(85893);function te(e){window.__c={n:"TemplateDetail"};const t=(0,n.O7)(),s=(0,c.useIntl)(),r=function(e){const[t,s]=i.useState(!1);return i.useEffect((()=>{const t=window.matchMedia(e);function i(e){s(e.matches)}return t.addEventListener("change",i),()=>{t.removeEventListener("change",i)}}),[e]),t}("(max-width: 960px)"),l=(0,o.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor},contentContainer:{margin:16,padding:"20px 24px",border:"1px solid rgba(0, 0, 0, 0.07)",borderRadius:8,background:e.sidebarBackground,display:"flex",flexDirection:"row",justifyContent:"space-between",columnGap:50,flexWrap:r?"wrap":"nowrap"},getTemplateColumn:{width:r?"100%":void 0,display:"flex",flexDirection:r?"column-reverse":"column"},madeByLabelV1:{marginTop:16,marginBottom:16},heroImg:{height:"100%",width:"100%"},getTemplateButton:{width:r?"100%":220,height:38,fontSize:16},addBadgeTeamTemplateButton:{textTransform:"none",color:e.blueColor},madeByV2Container:{marginBottom:16,display:"flex",flexDirection:"row",alignItems:"center",gap:6,width:"content-fit"},madeByV2Label:{fontSize:14,fontWeight:500},madeByV2AvatarContainer:{width:30,height:30,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:`1px solid ${e.outlineButtonBorder}`,overflow:"hidden",backgroundColor:"rgb(245, 245, 245)"},madeByV2Avatar:{width:30,height:30},madeByV2NotionAvatar:{width:16,height:16}})),[r]),{status:d,selectedTemplate:m,cloneTo:p,selectedTeam:g}=(0,a.VK)((()=>O.Z.state),[]),h=(0,a.VK)((()=>(0,j.s2)()),[]),f=(0,a.VK)((()=>{if("open"===d&&"preset"===(null==m?void 0:m.type)){const e=m.uri,t=(0,b.iX)((0,S.appConfigs)(),e),s=null==t?void 0:t.presets.find((t=>t.uri===e));if(t&&s)return{currentApp:t,currentPreset:s}}}),[d,m]),y=(0,a.VK)((()=>{if(m){if("preset"===m.type){var e;if(!f)return;const{currentPreset:s}=f,i=null===(e=s.previews)||void 0===e?void 0:e.find((e=>"previewRootId"in e)),n=i&&new $.G(t,{table:U.iU,id:i.previewRootId,spaceId:i.spaceId}),a=n?(0,ee.jsx)("div",{style:{overflow:"hidden",paddingTop:64,paddingLeft:64,paddingRight:64},children:(0,ee.jsx)(Q.Z,{store:n,loadingContainerStore:void 0,context:Y.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:0,titleStyle:{fontSize:32},disabled:!0},n.id)}):(0,ee.jsx)("img",{style:l.heroImg,src:E.Z.images.appPackages.projectPreview1Png});return[s.name,s.description,(0,ee.jsx)("img",{src:s.icon,style:{width:30,height:30}},s.uri),a]}if("pageTemplate"===m.type){const{template:e}=m,s=new $.G(t,{table:U.iU,id:e.previewRootId,spaceId:e.spaceId}),i=s.isCollectionView()?64:0,n=(0,ee.jsx)("div",{style:{overflow:"hidden",paddingTop:i,paddingLeft:i,paddingRight:i},children:(0,ee.jsx)(Q.Z,{store:s,loadingContainerStore:void 0,context:Y.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:Q.Z.defaultPageCoverHeight(t),disabled:!0,style:{...s.isFullWidth()?{width:"calc(100% - 64px)",margin:"0 32px"}:{}}})});return[e.name,e.description,(0,ee.jsx)("span",{style:{fontSize:20,height:30},children:e.emoji?(0,ee.jsx)(z.Z,{children:e.emoji}):(0,ee.jsx)("img",{src:e.icon,style:{width:30,height:30}},e.icon)},e.rootId),n]}(0,A.t1)(m)}}),[f,t,m,l.heroImg]),x=(0,X.E)(),v=(0,a.VK)((()=>x.filter((e=>e.canAddOrRemoveTopLevelPages()))),[x]),{creatorName:M,creatorAvatar:w,creatorUrl:C}=(0,a.VK)((()=>{if(!h||!m||"preset"===m.type)return{creatorName:"Notion",creatorAvatar:E.Z.images.notionLogoPng,creatorUrl:(0,P.D2)("notion")};const{template:e}=m,{creatorId:s}=e;if(!s){const{creatorName:t,creatorAvatar:s,creatorHandle:i}=e;return{creatorName:t,creatorAvatar:s,creatorUrl:t&&i?(0,P.D2)(i):void 0}}const i=new $.yj(t,{table:"template_creator",id:s}),n=i.getName(),a=i.getCreatorAvatarWithProtocol(),o=i.getUsername();return{creatorName:n,creatorAvatar:a,creatorUrl:n&&o?(0,P.D2)(o):void 0}}),[h,m,t]);if("open"!==d||void 0===m||!y)return null;const[k,T,I,_]=y,Z=v.length>0&&"destination_picker"===p&&!g,F=(0,ee.jsx)(c.FormattedMessage,{id:"templateDetail.getTemplateButton.label",defaultMessage:"Get template"}),R=(0,ee.jsx)(W.Z,{style:l.getTemplateButton,onClick:()=>{e.onAcceptTemplate(m,g),u.ye(t,{template_name:k,from:O.Z.state.analyticsFrom,target_team:null==g?void 0:g.id})},children:F}),D=(0,ee.jsx)(J.C,{showMemberCount:!0,showPrivate:!0,placementToOrigin:K.pO.Top,originGap:4,sectionTitle:(0,ee.jsx)(c.FormattedMessage,{...P.cY.addToTeamspace}),renderOrigin:e=>(0,ee.jsx)(W.Z,{...e,style:l.getTemplateButton,children:F}),onTeamAccept:s=>{e.onAcceptTemplate(m,s),u.ye(t,{template_name:k,from:O.Z.state.analyticsFrom,target_team:s.id})},onPrivateAccept:()=>{e.onAcceptTemplate(m),u.ye(t,{template_name:k,from:O.Z.state.analyticsFrom,target_team:"private"})},right:(0,ee.jsx)(q.Z,{isBlue:!0,style:{borderRadius:"100px",pointerEvents:"none"},icon:V.f,hovered:!0,caption:(0,ee.jsx)(c.FormattedMessage,{defaultMessage:"Add",id:"TemplateDetail.TeamItem.addButton"}),ariaLabel:s.formatMessage({id:"TemplateDetail.TeamItem.addButtonLabel",defaultMessage:"Add"}),captionStyle:l.addBadgeTeamTemplateButton})}),B=(0,ee.jsxs)("div",{style:l.madeByLabelV1,children:[(0,ee.jsx)(H.Z,{isSmall:!0,children:(0,ee.jsx)(c.FormattedMessage,{id:"templateDetail.madeBy.label",defaultMessage:"Made by"})}),(0,ee.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginTop:4},children:[(0,ee.jsx)("img",{src:E.Z.images.notionLogoPng,style:{width:15,height:16}}),(0,ee.jsx)("span",{style:{fontSize:14,fontWeight:500,marginLeft:5,marginRight:5},children:"Notion"})]})]}),L=M?(0,ee.jsxs)(G.Z,{style:{...l.madeByV2Container,...!C&&{cursor:"default"}},href:C,disabled:!C,external:!0,children:[w&&(0,ee.jsx)("div",{style:l.madeByV2AvatarContainer,children:(0,ee.jsx)("img",{src:w,style:w===E.Z.images.notionLogoPng?l.madeByV2NotionAvatar:l.madeByV2Avatar})}),(0,ee.jsx)(H.Z,{style:l.madeByV2Label,children:(0,ee.jsx)(c.FormattedMessage,{id:"templateDetail.madeBy.label.v2",defaultMessage:"By {author}",values:{author:M}})})]}):null;return(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)("div",{style:l.container,children:[(0,ee.jsx)("div",{style:{height:"100%",overflowX:"hidden",overflowY:"auto",maskImage:"linear-gradient(black 80%, transparent 100%)",WebkitMaskImage:"linear-gradient(black 80%, transparent 100%)"},children:(0,ee.jsxs)("div",{style:{position:"relative"},children:[(0,ee.jsx)("div",{style:{marginTop:-20,opacity:1,zIndex:999,pointerEvents:"none"},children:_}),(0,ee.jsx)("div",{style:{backgroundColor:"transparent",position:"absolute",left:0,top:0,right:0,bottom:0,zIndex:1e3}})]})}),(0,ee.jsxs)("div",{style:l.contentContainer,children:[(0,ee.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,ee.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",marginBottom:h?0:20},children:[!h&&I,(0,ee.jsx)("div",{style:{display:"flex",flexDirection:"column",marginLeft:h?0:10},children:(0,ee.jsx)("span",{style:{fontSize:20,fontWeight:700,lineHeight:1.2,marginTop:3,marginBottom:12},children:k})})]}),(0,ee.jsx)("div",{children:h&&L}),(0,ee.jsx)("div",{style:{fontSize:14},children:T})]}),(0,ee.jsxs)("div",{style:l.getTemplateColumn,children:[Z?D:R,!h&&B]})]})]})})}var se=s(58573),ie=s(22686),ne=s(35840),ae=s(50226),oe=s(72126),re=s(73657),le=s(52275),de=s(61519),ce=s(74194),ue=s(3386),me=s(78140),pe=s(32163),ge=s(72495),he=s(11219),fe=s(87279),ye=s(18514),xe=s(31194),ve=s(14694);function Se(e){let{topCategoryId:t,categoryId:s}=e;window.__c={n:"TemplateGallerySidebarCategoryName"};const i=(0,c.useIntl)(),n=(0,o.yK)((e=>({sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"}})),[]),r=(0,a.VK)((()=>{const e=function(){var e;if(!t)return;const i=P.oO(t);return i?null===(e=i.subcategories)||void 0===e?void 0:e.find((e=>e.id===s)):void 0}();if(e)return e.name;const n=_._5[s];return n?i.formatMessage(n):""}),[t,s,i]);return(0,ee.jsx)(ve.Z,{style:n.sidebarTitle,children:r})}var be=s(83065),Me=s(92607);function je(){window.__c={n:"TemplateGallerySidebarMoreFromCommunity"};const e=(0,n.O7)(),t=(0,a.VK)((()=>(0,j.s2)()),[]),s=(0,o.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},icon:{width:14,height:14,marginLeft:6,transform:"rotate(45deg)"},linkContentV2Container:{display:"flex",flexDirection:"column",gap:4},linkContentV2Title:{display:"flex",flexDirection:"row",alignItems:"center",fontWeight:600,fontSize:14},linkContentV2Subtitle:{maxWidth:250,whiteSpace:"inherit",overflow:"inherit",fontWeight:400,fontSize:13}})),[]),r=(0,i.useMemo)((()=>(0,ee.jsxs)(ee.Fragment,{children:[(0,Me.v)(s.icon),(0,ee.jsx)(c.FormattedMessage,{defaultMessage:"More from the Community",id:"templateGallerySidebar.goToMarketingTemplateGalleryButton.label"})]})),[s.icon]),l=(0,i.useMemo)((()=>(0,ee.jsxs)("div",{style:s.linkContentV2Container,children:[(0,ee.jsxs)(H.Z,{isInline:!1,style:s.linkContentV2Title,children:[(0,ee.jsx)(c.FormattedMessage,{defaultMessage:"More templates",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.labe2"}),(0,be._)(s.icon)]}),(0,ee.jsx)(H.Z,{isInline:!1,isSecondaryColor:!0,style:s.linkContentV2Subtitle,children:(0,ee.jsx)(c.FormattedMessage,{defaultMessage:"Discover thousands of templates made by Notion users like you",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.reason2"})})]})),[s.icon,s.linkContentV2Container,s.linkContentV2Subtitle,s.linkContentV2Title]);return(0,ee.jsx)(G.Z,{href:(0,ye.UY)("templateGallery"),onClick:()=>u.T2x(e),style:{display:"flex",flexDirection:"row",alignItems:"center"},external:!0,children:t?l:r})}var we=s(8848),Ce=s(42853),ke=s(98519),Te=s(82990),Ie=s(51077),Pe=s(89728),_e=s(98742);function Ze(e){let{}=e;window.__c={n:"TemplateGalleryTopCategoryFilter"};const t=(0,o.yK)((e=>({newInAppGalleryTopCategoryFilterBarContainer:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,marginBottom:8},newInAppGalleryTopCategoryFilterButton:{display:"flex",alignItems:"center",justifyContent:"space-between",color:e.mediumTextColor,padding:"8px 12px",borderRadius:4,marginRight:0,fontSize:Te.Z.fontSize.UIRegular.desktop,background:e.inputBackground},newInAppGalleryTopCategoryFilterChevronIcon:{width:15,height:15,fill:e.mediumIconColor}})),[]),{selectedTopCategory:s}=(0,a.VK)((()=>O.Z.state),[]),i=(0,a.VK)((()=>I.Z.getTopTemplateCategories()),[]),n=(0,a.VK)((()=>s?P.oO(s):void 0),[s]),r=(0,a.VK)((()=>(0,j.s2)()&&(null==i?void 0:i.length)>0),[i]);return r?(0,ee.jsx)("div",{style:t.newInAppGalleryTopCategoryFilterBarContainer,children:(0,ee.jsx)(K.ZP,{popupType:K.Z4.Popup,alignmentToOrigin:K.vR.End,placementToOrigin:K.pO.Bottom,sameWidthAsOrigin:!0,render:e=>(0,ee.jsx)(me.Z,{menuType:fe.og.Popup,children:(0,ee.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:[{key:"top-category",items:i.map((e=>({key:e.id,action:()=>{if(!r)return;const t=N(e);O.Z.setState({...O.Z.state,selectedTopCategory:e.id,allTemplates:t,limitResults:P.JL(t)})},render:t=>(0,ee.jsx)(le.Z,{...t,title:(0,ee.jsx)(Fe,{category:e,showSelected:e.id===s})})}))),render:e=>(0,ee.jsx)(ge.Z,{...e})}],onAccept:()=>e.close()})}),renderOrigin:e=>(0,ee.jsxs)(Pe.Z,{...(0,_e.Z)(e,{onClick:()=>{}}),style:t.newInAppGalleryTopCategoryFilterButton,children:[(0,ee.jsx)(Fe,{category:n}),(0,Ce.i)(t.newInAppGalleryTopCategoryFilterChevronIcon)]})})}):null}function Fe(e){let{category:t,showSelected:s=!1}=e;window.__c={n:"TemplateGalleryTopCategoryWithIcon"};const i=(0,o.yK)((e=>({selectedIconStyle:{width:14,height:14,fill:we.ZP.defaultText},categorySelection:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,lineHeight:"20px"},categoryButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}})),[]);return t?(0,ee.jsxs)("span",{style:i.categoryButtonContainer,children:[(0,ee.jsxs)("span",{style:i.categorySelection,children:[(0,ee.jsx)(Ie.Z,{type:"notion_icon",size:20,icon:t.icon.name,isLoading:!1,progressPercent:void 0,largeIcon:!0}),(0,ee.jsx)("span",{children:t.name})]}),s&&(0,ee.jsx)("span",{children:(0,ke.k)(i.selectedIconStyle)})]}):null}const Ae=(0,c.defineMessages)({allPersona:{id:"templateGallery.sidebar.persona.allTemplates",defaultMessage:"All templates"},noResults:{id:"templateGallery.sidebar.results",defaultMessage:"No results"}});function Re(){window.__c={n:"TemplateGallerySidebar"};const[e,t]=(0,i.useState)(""),s=(0,c.useIntl)(),r=(0,o.Fg)(),l=(0,n.O7)(),d=(0,a.VK)((()=>(0,j.s2)()),[]),{selectedCategory:m,status:p}=(0,a.VK)((()=>O.Z.state),[]),[g,h]=(0,i.useState)(!1);(0,i.useEffect)((()=>{if(!g){const t=O.Z.state.selectedTemplate;var e;if(t)null===(e=document)||void 0===e||null===(e=e.getElementById(`tg-${"uri"in t?S.presetUriToHumanReadableName[t.uri]:t.template.name}`))||void 0===e||e.scrollIntoView({block:"center"}),h(!0)}}),[g]),(0,i.useEffect)((()=>{"closed"===p&&h(!1)}),[h,p]);const f=(0,o.yK)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},sidebarMoreFromCommunityContainer:{padding:12,borderTop:`1px solid ${e.accentColors.translucentGray[200]}`},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},filterBar:{display:"flex",flexDirection:"row",width:273,flexWrap:"wrap",gap:6},newInAppGalleryBrandContainer:{display:"flex",alignItems:"center",width:"100%",gap:6,marginBottom:10},newInAppGalleryBrandName:{fontSize:15,fontWeight:600,color:e.regularTextColor},newInAppGalleryBrandIcon:{width:18,height:15,fill:e.regularTextColor},newInAppGallerySearchBarContainer:{padding:"0px 12px"}})),[]),y=(0,i.useMemo)((()=>(0,ee.jsx)(ue.Z,{capture:!0,onBackspace:oe.yR,onLeft:oe.yR,onRight:oe.yR,onSelectAll:oe.yR,onRedo:oe.yR,onUndo:oe.yR,onCut:oe.yR,onCopy:oe.yR,onPaste:oe.yR,onKeypress:oe.yR,onDelete:oe.yR,onTab:oe.yR,children:(0,ee.jsx)(ce.Z,{placeholder:s.formatMessage({id:"templateGallery.sidebar.searchbar.placeholder",defaultMessage:"Search templates"}),left:(0,ne.R)(f.searchIcon),showClearButton:!0,format:ce.Z.Format.Small,value:e,style:f.searchBar,onChange:e=>t(e.target.value)})})),[e,s,f.searchBar,f.searchIcon]),x=(0,i.useCallback)((e=>{var t,s;const i=[{key:"personas",render:e=>(0,ee.jsx)(ge.Z,{...e,topBorder:0!==e.index}),items:[void 0,...(0,P.Io)({userPersona:null===(t=k.default.state.currentUserSettingsStore)||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.persona,subscriptionTier:null===(s=k.default.state.currentSpaceStore)||void 0===s?void 0:s.getSubscriptionTier()}).filter((e=>"suggested"!==e))].map((t=>({key:t??"all",render:e=>(0,ee.jsx)(le.Z,{...e,focused:!1,checkState:oe.Xy(t,m),title:(0,ee.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,ee.jsx)(c.FormattedMessage,{...t?_._5[t]:Ae.allPersona})}),shouldWrapCaption:!0}),action:()=>{O.Z.setState({...O.Z.state,selectedCategory:t}),e.close(),u.NgT(l,{persona:t??"all"})}})))}],n={menuType:fe.og.Popup,width:260};return(0,ee.jsx)(me.Z,{...n,children:(0,ee.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:i})})}),[l,m]),v=(0,i.useMemo)((()=>(0,ee.jsx)("div",{style:f.filterBar,children:(0,ee.jsx)(K.ZP,{popupType:K.Z4.Popup,renderOrigin:e=>(0,ee.jsx)(he.Z,{on:!0,icon:(0,ie.f)({width:14,marginRight:6,fill:r.blueColor}),title:(0,ee.jsx)("span",{children:(0,ee.jsx)(c.FormattedMessage,{...m?_._5[m]:Ae.allPersona})}),...e}),placementToOrigin:xe.Iw.Bottom,render:e=>x(e)})})),[x,m,f.filterBar,r.blueColor]);return(0,ee.jsxs)("div",{style:f.sidebar,children:[!d&&(0,ee.jsxs)("div",{style:f.header,children:[y,v]}),d&&(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)("div",{style:f.header,children:[(0,ee.jsxs)(G.Z,{href:(0,ye.UY)("templateGallery"),onClick:()=>u.Ib5(l),style:f.newInAppGalleryBrandContainer,external:!0,children:[(0,ae.I)(f.newInAppGalleryBrandIcon),(0,ee.jsx)("span",{style:f.newInAppGalleryBrandName,children:(0,ee.jsx)(c.FormattedMessage,{id:"templateGallery.brand.title",defaultMessage:"Templates"})})]}),(0,ee.jsx)(Ze,{})]}),(0,ee.jsx)("div",{style:f.newInAppGallerySearchBarContainer,children:y})]}),(0,ee.jsx)(De,{currentQuery:e,selectedCategory:m}),d&&(0,ee.jsxs)("div",{children:[(0,ee.jsx)(de.Z,{size:"0"}),(0,ee.jsx)("div",{style:f.sidebarMoreFromCommunityContainer,children:(0,ee.jsx)(je,{})})]})]})}function De(e){window.__c={n:"TemplateGallerySidebarItemList"};const{currentQuery:t,selectedCategory:s}=e,n=""!==t||void 0!==s,{allTemplates:r,selectedTopCategory:l,status:d,limitResults:u}=(0,a.VK)((()=>O.Z.state),[]),m=(0,a.VK)((()=>(0,j.s2)()),[]),p=(0,o.yK)((e=>({button:{height:44,padding:"8px 0",borderRadius:4,marginBottom:4,transition:"all 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start"},categoryDiv:{marginBottom:n?0:14},unSelectedItem:{color:e.mediumTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.buttonHoveredBackground,fontWeight:500,color:e.regularTextColor},hoveredItem:{borderRadius:4,background:e.buttonHoveredBackground},presetTitle:{fontSize:14,color:e.regularTextColor},presetDescription:{fontSize:12},sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"},sidebarShowMore:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"2px 2px 0 6px"}})),[n]),g=(0,a.VK)((()=>{if("open"!==d||void 0===r)return[];const e=new Set;return Object.fromEntries(Object.entries(r).filter((e=>{let[t]=e;return void 0===s||t===s})).map((s=>{let[i,n]=s;return[i,(0,se.ZP)(t.replaceAll("-",""),n,(e=>`${e.name}`.replaceAll("-",""))).filter((t=>{const s=e.has(t.name);return e.add(t.name),!s}))]})))}),[d,r,s,t]),h=(0,i.useCallback)((e=>{"open"===d&&void 0!==u&&O.Z.setState({...O.Z.state,limitResults:{...u,[e]:!1}})}),[u,d]);return"open"!==d?null:(0,ee.jsx)("div",{style:{flexGrow:1,width:"100%",overflowX:"hidden",overflowY:"auto"},children:(0,ee.jsxs)(ge.Z,{desktopTitleStyle:{paddingLeft:8},children:[Object.entries(g).map((e=>{let[t,s]=e;if(0===s.length)return;const i=(null==u?void 0:u[t])&&!n&&s.length>C.IJ+1,a=i?s.length-C.IJ:0,o=i?s.slice(0,C.IJ):s;return(0,ee.jsxs)("div",{style:p.categoryDiv,children:[!n&&(0,ee.jsx)(Se,{topCategoryId:l,categoryId:t}),o.map((e=>"uri"in e?(0,ee.jsx)(Be,{icon:e.icon,name:e.name,template:{type:"preset",uri:e.uri}},e.uri):(0,ee.jsx)(Be,{icon:e.icon,emoji:e.emoji,name:e.name,template:{type:"pageTemplate",template:e}},e.id))),i&&a>0?(0,ee.jsx)(le.Z,{style:p.sidebarShowMore,focused:!1,onClick:()=>h(t),title:(0,ee.jsx)(c.FormattedMessage,{defaultMessage:"{numNotShown} more...",id:"templateGallerySidebar.category.showMore",values:{numNotShown:a}})}):void 0]},t)})),0===Object.values(g).flatMap((e=>e)).length&&(0,ee.jsx)(re.Z,{caption:R.default.formatMessage(Ae.noResults),style:{lineHeight:"14px",padding:6,margin:0}}),!m&&(0,ee.jsx)(le.Z,{desktopIconStyle:{alignSelf:"unset"},focused:!1,buttonStyle:{...p.button},title:(0,ee.jsx)(je,{})})]})})}function Be(e){var t;window.__c={n:"TemplateGallerySidebarItem"};const s=(0,n.O7)(),r=(0,o.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},itemText:{marginLeft:5},unSelectedItemText:{color:e.mediumTextColor},selectedItemText:{color:e.regularTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500},hoveredItem:{background:e.buttonHoveredBackground},presetIcon:{width:16,height:16,fontSize:16,color:e.regularEmojiColor},presetTitle:{fontSize:14},presetDescription:{fontSize:12}})),[]),{status:l,selectedTemplate:d,analyticsFrom:c}=(0,a.VK)((()=>O.Z.state),[]),m=(0,a.VK)((()=>"open"===l&&oe.Xy(d,e.template)),[l,e.template,d]),p=(0,i.useCallback)((()=>{const t="uri"in e.template?S.presetUriToHumanReadableName[e.template.uri]:e.template.template.previewRootId,i=(0,C.W4)({templateGalleryItem:t});f.navigate({environment:s,url:i}),u.n1D(s,{template_name:"preset"===e.template.type?e.template.uri:e.template.template.name,page_prepopulated_template_id:t,from:c})}),[c,s,e.template]);if("open"!==l)return null;const g=null!==(t=e.icon)&&void 0!==t&&t.startsWith("/")?(0,ee.jsx)("img",{src:e.icon,style:r.presetIcon}):(0,ee.jsx)("div",{style:r.presetIcon,children:(0,ee.jsx)(z.Z,{children:e.emoji??e.icon??""})}),h=`tg-${"uri"in e.template?S.presetUriToHumanReadableName[e.template.uri]:e.template.template.name}`;return(0,ee.jsx)(le.Z,{id:h,desktopIconStyle:{alignSelf:"unset"},buttonStyle:{...r.button,...m?r.selectedItem:void 0},textWrapperStyle:{...m?r.selectedItemText:r.unSelectedItemText,...r.itemText},focused:!1,icon:g,title:(0,ee.jsx)("span",{style:r.presetTitle,children:e.name}),shouldWrapCaption:!0,hoveredStyle:r.hoveredItem,onClick:p})}const Le=["companyHome","defaultWiki","engineeringWiki","salesWiki","teamWiki"];function Ne(){window.__c={n:"TemplateGalleryModal"};const e=(0,n.Fy)(),t=(0,n.O7)(),s=(0,c.useIntl)(),d=(0,i.useRef)(void 0),_=(0,o.yK)((t=>({modal:{width:e.isMobile?"auto":"90vw",height:e.isMobile?"auto":"90vh",borderRadius:8}})),[e.isMobile]),Z=(0,a.VK)((()=>k.default.state.currentSpaceStore),[]),{templateGalleryItem:F}=(0,a.VK)((()=>t.RouterStore.state.route),[t.RouterStore]),A=(0,a.VK)((()=>(0,j.s2)()),[]),{status:R,allTemplates:D,selectedTemplate:L,cloneTo:N,limitResults:E}=(0,a.VK)((()=>O.Z.state),[]);(0,i.useEffect)((()=>{if(F)return d.current=window.setTimeout((()=>{O.Z.setState({...O.Z.state,status:"closed"})}),1e4),()=>{void 0!==d.current&&window.clearTimeout(d.current)}}),[]);const V=(0,i.useRef)(void 0);(0,i.useEffect)((()=>{V.current&&(V.current=void 0)}),[null==Z?void 0:Z.id]),(0,i.useEffect)((()=>{var e;V.current||"closed"!==R&&(V.current=A?async function(e){const{environment:t,spaceId:s}=e,i=await m.getInAppCategoriesAndTemplates(t,{spaceId:s});return"success"===i.type&&(I.Z.setState({data:i.data}),"current"===i.data.version)}({environment:t,spaceId:null==Z?void 0:Z.id}):Promise.resolve(),null===(e=V.current)||void 0===e||e.then((()=>{var e,t;const s=F&&P.vY(F),{selectedTopCategory:i,allTemplates:n}=B({isNewInAppGalleryEnabled:A,userPersona:null===(e=k.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.persona,subscriptionTier:null===(t=k.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier(),selectedTopCategory:s});O.Z.setState({...O.Z.state,selectedTopCategory:i,allTemplates:n,limitResults:P.JL(n)})})).finally((()=>{void 0!==d.current&&window.clearTimeout(d.current)})))}),[t,A,null==Z?void 0:Z.id,V,R,F]),(0,i.useEffect)((()=>{if(void 0!==D&&"opening"===R){const e=void 0!==L&&(void 0===F||"gallery"===F)?L:Oe({templateGalleryItem:F,allTemplates:D});return O.Z.setState({...O.Z.state,status:"open",allTemplates:D,selectedTemplate:e,limitResults:E??P.JL(D),cloneTo:O.Z.state.cloneTo,analyticsFrom:O.Z.state.analyticsFrom}),void u.jWY(t,{template_name:"preset"===e.type?e.uri:e.template.name,from:O.Z.state.analyticsFrom})}}),[F,t,D,R,L,N,E]),(0,i.useEffect)((()=>{"open"===R&&void 0!==D&&void 0!==F&&"gallery"!==F&&O.Z.setState({...O.Z.state,selectedTemplate:Oe({templateGalleryItem:F,allTemplates:D})})}),[D,R,F]);const U=(0,a.VK)((()=>{const e=(0,v.np)();if("open"===R&&"current_page"===N&&e&&e.isEmptyPage())return e}),[N,R]),W=(0,i.useCallback)((async(e,s)=>{var i,n,a;O.Z.setState({...O.Z.state,status:"closed",selectedTemplate:void 0});const{currentSpaceStore:o,currentSpaceViewStore:d}=k.default.state,c=null==U||!U.getParentStore()||"block"!==(null===(i=U.getParentStore())||void 0===i?void 0:i.table)&&"space"!==(null===(n=U.getParentStore())||void 0===n?void 0:n.table)&&"team"!==(null===(a=U.getParentStore())||void 0===a?void 0:a.table)?s||o:U.getParentStore(),x=Date.now();let v;if("preset"===e.type&&(0,l.SA)(e.uri)){var j;const i=e.uri,n=null===(j=(0,b.iX)((0,S.appConfigs)(),i))||void 0===j?void 0:j.uri;if(!(n&&o&&d&&c))return;const a=s||w.VP(c);if(a){if(!(await async function(e){let{environment:t,spaceId:s,presetUri:i,teamStore:n}=e;return await(0,T.l)({environment:t,spaceId:s,presetUri:i,parentStore:n,teamId:n.id,from:"template_gallery"})}({environment:t,spaceId:o.id,presetUri:i,teamStore:a})))return}const r=U||(s?s.getTeamPagesStores().find((e=>e.getFormat().app_config_uri&&e.getFormat().app_config_uri===n)):void 0);y.createAndCommit({environment:t,userAction:"templateGallery.getTemplate",perform:e=>{const s=(0,S.appConfigs)().find((e=>e.uri===n)),a=null==s?void 0:s.presets.find((e=>e.uri===i));if(d&&a){const s=p.initializeApp({environment:t,spaceViewStore:d,appUri:n,presetUri:a.uri,appParentStore:c,temporaryContainerBlockStore:r,transaction:e,from:"template_gallery"});p.markTasksDatabaseTemplateIfNeeded(s),g.createSprintPage({environment:t,spaceViewStore:d,appParentStore:c,transaction:e,blockStores:s,creationEntryPoint:{type:"preset",presetUri:a.uri}})}}}),m.finalizeAppTemplate(t,{})}else{const i="preset"===e.type?(0,M.CQ)(e.uri):e.template;if(!i)return;if(!o||!d)return;const n={environment:t,item:i,spaceStore:o,spaceViewStore:d,useMinimalTemplates:!1,from:"template_gallery"},a=U?await h.rC({...n,isPrivate:!1,initializeStore:U,type:"inExistingStore"}):s?await h.rC({...n,isPrivate:!1,teamStore:s,type:"inTeam",appendOrPrepend:"append"}):await h.rC({...n,isPrivate:!0,type:"inSpace"});v=a,a&&f.navigateToBlock({environment:t,store:a,pageVisitSource:r.tY.Create})}const C="preset"===e.type?e.uri:e.template.name,I=Date.now()-x,P=U?!w.VP(U):!Boolean(s),_=P||null==s?void 0:s.id;u.enX(t,{template_name:C,destination:P?"private":"team",template_block_id:"pageTemplate"===e.type?e.template.rootId:void 0,template_duplication_duration_ms:I,team_id:_,created_page_id:v?v.id:null==U?void 0:U.id}),u.W2j(t,{type:"page",from:"template_gallery",new_page_id:v?v.id:null==U?void 0:U.id}),"preset"===e.type&&(0,l.SA)(e.uri)&&v&&u.bRT(t,{preset_uri:e.uri,created_block_stores:[v],from:"template_gallery",destination_team_id:_}),"pageTemplate"===e.type&&Ve(e.template.id)&&v&&u.Jw_(t,{from:"template_gallery",wiki_block_id:v.id,destination_team_id:_,wiki_template_id:e.template.id})}),[t,U]),K=(0,i.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=k.default.state,{RouterStore:s}=t,i=s.state.route;if(e&&"page"===i.name){const e=(0,C.p8)();f.navigate({environment:t,url:e})}}),[t]);return(0,ee.jsx)(x.Z,{ariaLabel:s.formatMessage({id:"templateGallery.dialogLabel",defaultMessage:"Templates"}),open:"open"===R,innerStyle:_.modal,onDismiss:K,render:()=>"open"!==R?null:(0,ee.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:[(0,ee.jsx)(Re,{}),(0,ee.jsx)(te,{onAcceptTemplate:W})]})})}function Oe(e){let{templateGalleryItem:t,allTemplates:s}=e;if(!t||"gallery"===t){var i;return"team"===(null===(i=k.default.state.currentSpaceStore)||void 0===i?void 0:i.getPlanType())?{type:"preset",uri:l.Yb}:Ee(s)}const n=Object.values(s).flatMap((e=>e)).find((e=>"uri"in e?S.presetUriToHumanReadableName[e.uri]===t:e.previewRootId===t));return n?"uri"in n?{type:"preset",uri:n.uri}:{type:"pageTemplate",template:n}:Ee(s)}function Ee(e){const t=e[Object.keys(e)[0]][0];return"uri"in t?{type:"preset",uri:t.uri}:{type:"pageTemplate",template:t}}function Ve(e){return Le.some((t=>d.Y[t].nameMessage.id===e))}},47054:(e,t,s)=>{s.d(t,{AD:()=>l});s(57658);var i=s(30120),n=s(59730),a=s(63143);function o(e){if(void 0===e)return i.ou.utc();const t={zone:"utc"};return"number"==typeof e?i.ou.fromMillis(e,t):i.ou.fromISO(e,t)}function r(e,t){const s=t?o(t):i.ou.utc(),a=o(e??function(e){const{days:t,endDate:s,startDate:a}=e;if(t<=0)throw new n.p8("Days must be greater than 0");const r=s?o(s):i.ou.utc();if(!r.isValid)throw new n.p8(`endDate ${s} is in an invalid format`);const l=a?o(a).toMillis():0,d=r.minus({days:t-1}).toMillis();return Math.max(d,l)}({days:7,endDate:t}));if(!a.isValid)throw new n.p8(`startDate ${e} is in an invalid format`);if(!s.isValid)throw new n.p8(`endDate ${t} is in an invalid format`);if(a>s)throw new n.p8(`startDate ${e} => ${a.toISO()} is after endDate ${t} => ${s.toISO()}`);return{startTimestamp:a.toMillis(),endTimestamp:s.toMillis()}}function l(e,t){const{startTimestamp:s,endTimestamp:i}=r(e,t),n=[];for(var l=s;l<=i;)n.push(o(l).toISODate()),l+=a.A0;return n}},39248:(e,t,s)=>{s.d(t,{E:()=>r});var i=s(4615),n=s(89101),a=s(64002);function o(e,t){const s=t.trim().toLowerCase(),i=(0,a.Of)(s).replace(/\./g,"-");return i?`${i}-${e}`:e}function r(e,t){if(!(0,i.e)(e))return`${n._j.integrations}/${e}`;const s=o(e,void 0===t?"":t);return`${n._j.integrations}/${s}`}},57222:(e,t,s)=>{s.d(t,{t:()=>i});const i=e=>({"en-US":{label:"English",caption:e.formatMessage({defaultMessage:"English (US)",id:"languagePicker.captions.englishUS"})},"de-DE":{label:"Deutsch",caption:e.formatMessage({defaultMessage:"German",id:"languagePicker.captions.germanDE"})},"ko-KR":{label:"한국어",caption:e.formatMessage({defaultMessage:"Korean",id:"languagePicker.captions.koreanKo"})},"zh-CN":{label:"简体中文",caption:e.formatMessage({defaultMessage:"Simplified Chinese",id:"languagePicker.captions.chineseS"})},"zh-TW":{label:"繁體中文",caption:e.formatMessage({defaultMessage:"Traditional Chinese",id:"languagePicker.captions.chineseT"})},"ja-JP":{label:"日本語",caption:e.formatMessage({defaultMessage:"Japanese",id:"languagePicker.captions.japaneseJa"})},"es-ES":{label:"Español (España)",caption:e.formatMessage({defaultMessage:"Spanish (Spain)",id:"languagePicker.captions.spanishEs"})},"es-LA":{label:"Español (Latinoamérica)",caption:e.formatMessage({defaultMessage:"Spanish (Latin America)",id:"languagePicker.captions.spanishLatam"})},"pt-BR":{label:"Português (Brasil)",caption:e.formatMessage({defaultMessage:"Portuguese (Brazil)",id:"languagePicker.captions.portugueseBr"})},"fr-FR":{label:"Français (France)",caption:e.formatMessage({defaultMessage:"French",id:"languagePicker.captions.frenchFr"})},"da-DK":{label:"Dansk",caption:e.formatMessage({defaultMessage:"Danish",id:"languagePicker.captions.danishDk"})},"fi-FI":{label:"Suomi",caption:e.formatMessage({defaultMessage:"Finnish",id:"languagePicker.captions.finnishFi"})},"nb-NO":{label:"Norsk",caption:e.formatMessage({defaultMessage:"Norwegian",id:"languagePicker.captions.norwegianNo"})},"nl-NL":{label:"Nederlands",caption:e.formatMessage({defaultMessage:"Dutch",id:"languagePicker.captions.dutchNl"})},"sv-SE":{label:"Svenska",caption:e.formatMessage({defaultMessage:"Swedish",id:"languagePicker.captions.swedishSe"})},pseudo:{label:"🤡Pseudolocale🤡",caption:e.formatMessage({defaultMessage:"Pseudolocale",id:"languagePicker.captions.pseudolocale"})}})}}]);