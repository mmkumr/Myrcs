"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9385],{89845:(e,t,i)=>{i.d(t,{Z:()=>g});i(67294);var o=i(83355),n=i(13991),r=i(8848),l=i(7057),s=i(53877),a=i(42875),c=i(36700),d=i(63143),h=i(31412),u=i(26388),p=i(85893);class m extends o.Z{constructor(){super(...arguments),this.reminderTimer=void 0}willMountOrUpdate(){this.createReminderTimer()}willUnmount(){this.clearReminderTimer()}createReminderTimer(){const e=this.props.value;if(!e)return;const t=s.KR(e,(0,a.r)());if(!t)return;const i=t.valueOf(),o=i-Date.now();o<0||o>d.A0||this.reminderTimer&&this.reminderTimer.timestamp===i||(this.reminderTimer&&clearTimeout(this.reminderTimer.timer),this.reminderTimer={timestamp:i,timer:setTimeout(this.enqueueForceUpdate,o)})}clearReminderTimer(){this.reminderTimer&&(clearTimeout(this.reminderTimer.timer),this.reminderTimer=void 0)}renderComponent(){const{value:e,withComma:t}=this.props;if(!e)return;const i=s.NK(e,(0,a.r)(),n.SP);let o;if(e.reminder){const t=s.Nm(e,(0,a.r)());o=t?{color:this.theme.errorText}:{color:r.ZP.blue}}const d=(0,p.jsxs)(p.Fragment,{children:[(0,l.ZV)({value:e,date_format:this.props.dateFormat,time_format:this.props.timeFormat,userTimeZone:(0,a.r)(),allowRelativeDates:!0,intl:this.props.intl,shortenDateAndRange:this.props.shortenDateAndRange,displayInUserTimezone:this.props.displayInUserTimezone}),e.reminder&&(0,c.m)({display:"inline-block",width:"1em",marginLeft:6,marginRight:2,paddingBottom:4,verticalAlign:"middle"}),t?", ":null]});return this.props.disableTooltip?(0,p.jsx)("div",{style:{...this.props.style,...o},children:d}):(0,p.jsx)(u.Z,{renderTooltip:()=>(0,p.jsxs)(p.Fragment,{children:[this.props.tooltipHeader,(0,p.jsxs)("div",{style:this.getTooltipStyle(),children:[f(i.start),i.end?` â†’ ${f(i.end)}`:""]})]}),render:e=>(0,p.jsx)("div",{style:{...this.props.style,...o},...e,children:d}),placement:this.props.tooltipPlacement})}getTooltipStyle(){return this.props.tooltipHeader?{color:this.theme.mediumInvertedTextColor}:{}}}m.displayName="DateBox";const g=(0,h.injectIntl)(m);function f(e){return(0,l.ZW)(e,"medium_with_time")}},10009:(e,t,i)=>{i.d(t,{s:()=>de,Z:()=>he});var o=i(67294),n=i(86628),r=i(21202),l=i(12534),s=i(26350),a=i(16354),c=i(1302),d=i(98104),h=i(29376),u=i(64921),p=i(76798),m=i(85893);function g(e){window.__c={n:"EditableRelationTokenTitle"};const{blockStore:t,titleStyle:i,shouldWrap:n,recordTitleRef:r}=e,l=(0,o.useRef)({getNode:()=>r.current}),s=(0,o.useCallback)((e=>{c.default.afterNextFlush((()=>{const e=t.getBlockTitleStore();if(!e)return;const i=e.getValue(),o=i?i[0][0].length:0,n={start:{index:o,store:e},end:{index:o,store:e}};d.NA({multiSelection:n})}))}),[t]);return(0,m.jsx)(u.Z,{style:{height:h.Mu+2,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:5,padding:"6px 8px 7px 8px",overflow:"hidden"},onClick:s,children:(0,m.jsx)(p.Z,{store:t,underline:!0,shouldWrap:n,style:i,ref:l})})}var f=i(72126),T=i(31412),x=i(33929),v=i(65187);const k=(0,T.defineMessages)({typeTitle:{defaultMessage:"Type a title...",id:"relationToken.title.placeholder"}});function S(e){window.__c={n:"EditingRelationTokenTitle"};const{blockStore:t,clickTitleBehavior:i,onTitleEnter:o}=e,r="edit"===i,l=(0,n.VK)((()=>t.getBlockTitleStore()),[t]);return(0,m.jsx)(v.Z,{store:l,disabled:!r,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableEmbedMenu:!0,onEnter:o,onTab:f.yR,placeholder:x.default.formatMessage(k.typeTitle),style:{padding:"6px 8px 7px 8px",textOverflow:"none",overflow:"visible",whiteSpace:"pre"},disableSelectAllBlocks:!0,pasteBehavior:"inline"})}var y=i(480),R=i(64002),b=i(30874),I=i(73935),w=i(83355),j=i(41432),M=i(8848),C=i(84619),W=i(70203),_=i(44805),O=i(97444),Z=i(95477),B=i(60682),P=i(24990);class z extends w.Z{constructor(){super(...arguments),this.node=void 0,this.handleMouseOver=e=>{const t=this.getInteractiveToken(),i=this.props.store.getTitleStore();i&&t&&O.Nh({environment:this.environment,event:e,interactiveToken:t,store:i,canEdit:this.props.canEdit})},this.handleMouseOut=e=>{const t=this.getInteractiveToken(),i=this.props.store.getTitleStore();i&&t&&O.Zl({environment:this.environment,event:e,interactiveToken:t,store:i,canEdit:this.props.canEdit})}}didMount(){super.didMount(),this.node=I.findDOMNode(this)}get theme(){const{ThemeModeStore:e}=this.environment;return(0,M.gh)({theme:e.state})}getInteractiveToken(){if(!this.node)return;const e=this.props.store,t=(0,W.x36)(e.id),i=(0,W.YCD)(t);return{textValue:[i],tokenIndex:0,textToken:i,node:this.node}}renderComponent(){const e=this.props.store,t=this.props.shouldWrap,i=this.props.style,o=this.props.disableLinks,n=this.props.disableHover,r=x.default.getIntl(),s=this.props.store.getRecordModel,a=e.id,c=(0,B.e_)(this.environment),d=Z.default.domainBaseUrl,h=this.environment.currentUser.id,u=this.props.isAndroid,p=this.props.externalIntegrations;if(!a)return;if("external_object_instance_page"!==e.getType())return;const g=e.getModel();return null!=g&&g.isType(j.Ti.externalObjectInstancePage)?(0,m.jsx)("span",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:l.Wi,children:(0,_.dD)({blockModel:g,shouldWrap:t,index:0,style:i,disableHover:n,disableLinks:o,isAndroid:u,theme:this.theme,getRecordModel:s,currentUserId:h,baseUrl:d,emojiType:c,externalIntegrations:p,intl:r,emojiData:P.Z.state,stopLinkPropagation:!0})}):void 0}}z.displayName="ExternalObjectInstancePageMentionToken",z.Format=C.lo;const E=z;function U(e){window.__c={n:"ExternalObjectInstancePageMentionRelationToken"};const{blockStore:t,shouldWrap:i,style:o}=e,r=(0,n.VK)((()=>(0,R.yn)(t.getSyncedUri())),[t]),l=(0,n.VK)((()=>b.Z.integrations.state),[]),s=(0,y.O7)();return(0,m.jsx)(E,{shouldWrap:i,store:t,style:o,disableHover:!r,disableLinks:!r,isAndroid:s.device.isAndroid,externalIntegrations:l,canEdit:!0})}var K=i(24405),D=i(9953),V=i(39699),A=i(31278),N=i(82990);const L={[C.lo.ExtraSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:16,closeIconSize:8},[C.lo.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",recordIconMarginRight:3,pageIconSize:16,closeIconSize:8},[C.lo.Medium]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[C.lo.Inline]:{height:20,fontSize:14,margin:"0 12px 0 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[C.lo.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",recordIconMarginRight:4,pageIconSize:24,closeIconSize:10}};function F(e){let{height:t}=e;return{display:"flex",alignItems:"center",lineHeight:1.2,height:t}}function H(e){window.__c={n:"RelationTokenPageIcon"};const{clickTitleBehavior:t,blockStore:i,format:r,shouldWrap:l}=e,s="edit"===t,a=(0,y.O7)(),c=(0,n.VK)((()=>i.getIcon()),[i]),d=(0,n.VK)((()=>i.isEmptyPage()),[i]),{style:h}=(0,K.yK)((()=>({style:{flexShrink:0,marginRight:s?0:L[r].recordIconMarginRight,justifyContent:"flex-start",...l&&{display:"inline-block",verticalAlign:"text-top",marginBottom:-1}}})),[s,r,l]),u=(0,o.useCallback)((e=>{const t=i.getIconStore();t&&V.createAndCommit({userAction:"RelationToken.handleRecordIconChange",environment:a,perform:i=>{D.sO({store:t,value:e,transaction:i})}})}),[i,a]),p={icon:c,size:L[r].pageIconSize,isEmptyPage:d,style:h};return s?(0,m.jsx)(A.Z,{...p,disabled:!1,onChange:u,bucket:"public"}):(0,m.jsx)(A.Z,{...p,disabled:!0})}var Q=i(19525);function Y(e){const{format:t,showRemoveButton:i,onClickRemove:o}=e,{height:n,closeIconSize:r}=L[t];return i?(0,m.jsx)(u.Z,{onClick:o,style:{display:"flex",alignItems:"center",justifyContent:"center",width:n,height:n,marginLeft:2,marginRight:2,flexGrow:0,flexShrink:0,borderRadius:4},children:(0,Q.b)({width:r,height:r,opacity:.5})}):null}function q(e){window.__c={n:"RelationTokenTitle"};const{blockStore:t,shouldWrap:i,titleStyle:n,recordTitleRef:r,noUnderline:l}=e,s=(0,o.useRef)({getNode:()=>r.current});return(0,m.jsx)(p.Z,{store:t,underline:!l,shouldWrap:i,style:n,ref:s})}var $=i(26388),G=i(29551);function J(e){let{tooltipTargetRef:t,containingParentRef:i,tooltipDynamicMouseOverflow:o,isTooltipOriginOverflowing:n}=e;return i?function(e){var t;let{tooltipTargetRef:i,containingParentRef:o}=e;return Boolean(i.current&&o&&"current"in o&&(null===(t=o.current)||void 0===t?void 0:t.offsetWidth)&&i.current.offsetWidth>o.current.offsetWidth)}({tooltipTargetRef:t,containingParentRef:i}):!!o&&n}function X(e){let{blockStore:t}=e;window.__c={n:"RelationTokenTooltipPageIcon"};const i=(0,y.O7)(),o=(0,K.Fg)();return(0,n.VK)((()=>(0,_.tp)({pageModel:t.getModel(),pageRole:t.getRole(),baseUrl:Z.default.domainBaseUrl,getRecordModel:t.getRecordModel,emojiType:(0,B.e_)(i),isSafariOrIOS:i.device.isSafari||i.device.isIOS,isClient:!0,showEmojiInline:i.device.isWindows,currentUserId:i.currentUser.id,theme:o,emojiData:P.Z.state})||null),[t,i,o])}var ee=i(68056),te=i(24666);function ie(e){return(0,n.VK)((()=>{var t;const i=te.default.state;return"editing"===i.mode&&(null===(t=(0,ee.QY)(i.multiSelection))||void 0===t?void 0:t.store)===e.getBlockTitleStore()}),[e])}function oe(e){window.__c={n:"RelationTokenTooltip"};const{children:t,showRelationTooltip:i,blockStore:n,tooltipOriginStyle:r,tooltipTargetRef:l,containingParentRef:s,tooltipDynamicMouseOverflow:a}=e,c=(0,K.yK)(ne,[]),d=ie(n),h=function(e){const[t,i]=(0,o.useState)(!1),n=e.current&&!t&&e.current.scrollWidth&&e.current.clientWidth&&e.current.scrollWidth>Math.min(e.current.clientWidth,400);return(0,o.useLayoutEffect)((()=>{n&&i(!0)}),[n]),t}(l),u=i&&!d&&J({tooltipTargetRef:l,containingParentRef:s,tooltipDynamicMouseOverflow:a,isTooltipOriginOverflowing:h});return(0,m.jsx)($.Z,{style:c.wrapper,placement:$.Z.Placement.Bottom,disableTooltip:!u,renderTooltip:()=>(0,m.jsx)(G.gq,{alignItems:"center",children:(0,m.jsxs)(G.gq,{style:c.destination,alignItems:"center",children:[(0,m.jsx)(X,{blockStore:n}),(0,m.jsx)(p.Z,{style:c.destinationText,store:n,maxLength:de})]})}),render:e=>(0,m.jsx)("div",{...e,ref:l,style:r,children:t})})}function ne(e){return{wrapper:{fontSize:N.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,fontWeight:N.Z.fontWeight.regular,fill:e.mediumIconColor,background:e.popoverBackground},destination:{padding:"4px 0 4px 6px"},destinationText:{paddingRight:6,maxWidth:1e3,...N.Z.textOverflowStyle}}}var re=i(15145),le=i(66890),se=i(78316),ae=i(84210),ce=i(80444);const de=1e3,he=(0,o.forwardRef)(((e,t)=>{const{parentStore:i,blockId:c,shouldWrap:d,format:u,showRemoveButton:p,clickTitleBehavior:g,onClickRemove:f}=e,T=s.G.createChildStore(i,{table:r.iU,id:c}),{style:x}=function(e){let{format:t,shouldShrink:i,shouldWrap:o,isSingle:n,style:r,clickTitleBehavior:l}=e;const s="edit"===l;return(0,K.yK)((()=>{const{fontSize:e,margin:l}=L[t],a=s?h.Mu:L[t].height;return{style:{...o?{display:"inline",lineHeight:1.5,borderRadius:4}:F({height:a}),fontSize:e,fontWeight:N.Z.fontWeight.medium,minWidth:i?0:"auto",margin:n?0:l,...t===C.lo.Inline&&{overflow:"hidden"},...r}}}),[t,i,o,n,s,r])}(e),{blockUrlPage:v,blockUrlPeek:k}=function(e){const t=(0,le.DK)(),i=(0,n.VK)((()=>(0,ae.ZP)({store:e,fullyQualified:!1,pageVisitSource:re.tY.LinkInPage})),[e]);return{blockUrlPeek:(0,n.VK)((()=>{const{mainEditorCurrentBlockStore:i}=ce.default.state;return se.mb({store:e,mainEditorCurrentBlockStore:i,collectionContextStore:t,fullyQualified:!1})}),[e,t]),blockUrlPage:i}}(T),S=(0,o.useRef)(null),y=(0,o.useRef)(null),R="peek"===g,b={display:x.display,height:x.height,alignItems:x.alignItems};(0,o.useImperativeHandle)(t,(()=>T),[T]);return(0,n.VK)((()=>"external_object_instance_page"===T.getType()),[T])?(0,m.jsx)(U,{shouldWrap:d,blockStore:T,style:x}):(0,m.jsx)(oe,{blockStore:T,tooltipTargetRef:y,...e,children:(0,m.jsxs)("div",{style:x,children:[R?(0,m.jsx)(a.Z,{href:v,metaHref:k,onClick:l.Wi,style:b,children:(0,m.jsx)(ue,{blockStore:T,recordTitleRef:S,tooltipTargetRef:y,...e})}):(0,m.jsx)(ue,{blockStore:T,recordTitleRef:S,tooltipTargetRef:y,...e}),(0,m.jsx)(Y,{showRemoveButton:p,onClickRemove:f,format:u})]})})}));function ue(e){const{format:t,blockStore:i,clickTitleBehavior:o,shouldWrap:n,recordTitleRef:r,tooltipTargetRef:l}=e;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(H,{format:t,blockStore:i,clickTitleBehavior:o,shouldWrap:n}),(0,m.jsx)(pe,{...e,blockStore:i,recordTitleRef:r,tooltipTargetRef:l})]})}function pe(e){window.__c={n:"RelationTokenTitleContainer"};const{blockStore:t,clickTitleBehavior:i,onTitleEnter:o,index:n,recordTitleRef:r,titleStyle:l,shouldWrap:s,noUnderline:a}=e,c="edit"===i,d=ie(t);return c?d&&o&&n?(0,m.jsx)(S,{blockStore:t,clickTitleBehavior:i,onTitleEnter:o}):(0,m.jsx)(g,{blockStore:t,recordTitleRef:r,titleStyle:l,shouldWrap:s}):(0,m.jsx)(q,{blockStore:t,recordTitleRef:r,titleStyle:l,shouldWrap:s,clickTitleBehavior:i,noUnderline:a})}},66890:(e,t,i)=>{i.d(t,{DK:()=>h,L1:()=>c,Y$:()=>d,xm:()=>a});i(21703);var o=i(67294),n=i(67381);const r="collectionContextStore",l=(0,n.Q)({displayName:r,legacyContextKey:r,modernContextDefaultValue:void 0}),s=l.context,a=l.legacyPropTypes,c=l.Provider;function d(){const e=o.useContext(s);if(void 0===e)throw new Error(`No context provided: ${r}`);return e}function h(){return o.useContext(s)}}}]);