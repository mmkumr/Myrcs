"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[2338],{3992:(e,t,o)=>{o.r(t),o.d(t,{addRecurrence:()=>g,createRecurrenceInner:()=>h,disableRecurrence:()=>f});var n=o(40506),i=o(4615),r=o(98963),a=o(18844),s=o(6287),l=o(80444),c=o(26350),d=o(50906),u=o(96802),p=o(9953),m=o(39699);function g(e){let{environment:t,blockStore:o,recurrence:l}=e;const u=o.getAutomationId(),g=function(e){return{...e,start_date:(0,n.Io)(new Date(e.start_date))}}(l);u?function(e,t,o,n){const l=o.getParentStore();if(!l||l.table!==s.v)return;const u=o.getSpaceId(),g={table:r.cv,id:t,spaceId:u},f=c.Mz.createChildStore(o,g),h=f.getTrigger();if(!h)return;const y=f.getActionStores()[0];m.createAndCommit({environment:e,userAction:"recurrenceActions.updateRecurrence",perform:t=>{const r=v({automationId:f.id,spaceId:u,collectionPointer:l.getSpaceShardedPointer(),templatePageId:o.id});let s;y?(s=y.id,p.sW({store:y,data:r,transaction:t})):(s=(0,i.ZP)(),p.ae({environment:e,table:a.Xj,inMemoryRecordCache:f.inMemoryRecordCache,transaction:t,value:{id:s,...r}})),p.sW({store:f,data:{status:"active",trigger:{id:h.id,type:"recurrence",recurrence:n},action_ids:[s]},transaction:t})}}),d.h$X(e,{type:"updated",frequency:n.frequency})}(t,u,o,g):function(e,t,o){m.createAndCommit({environment:e,userAction:"recurrenceActions.createRecurrence",perform:n=>{h(n,e,t,o)}})}(t,o,g)}function f(e){let{environment:t,blockStore:o}=e;const n=o.getAutomationId();if(!n)return;const i={table:r.cv,id:n,spaceId:o.getSpaceId()};m.createAndCommit({environment:t,userAction:"recurrenceActions.disableRecurrence",perform:e=>{p.sW({store:(0,c.Kv)(o,i),data:{status:"disabled",run_at:void 0},transaction:e})}}),d.h$X(t,{type:"disabled"})}function h(e,t,o,n){const{currentUserRootStore:c}=l.default.state;if(!c)return;const m=o.getParentStore();if(!m||m.table!==s.v)return;if(!m.getParentBlockStore())return;const g=o.getSpaceId(),f=(0,i.ZP)(),h=(0,i.ZP)();p.ae({environment:t,table:r.cv,inMemoryRecordCache:o.inMemoryRecordCache,value:{id:f,parent_id:o.id,parent_table:o.table,alive:!0,space_id:g,status:"active",trigger:{id:(0,i.ZP)(),type:"recurrence",recurrence:n},action_ids:[h]},transaction:e}),u.FH({stores:[o],update:{automation_id:f},transaction:e}),p.ae({environment:t,table:a.Xj,inMemoryRecordCache:o.inMemoryRecordCache,transaction:e,value:{id:h,...v({automationId:f,spaceId:g,collectionPointer:m.getSpaceShardedPointer(),templatePageId:o.id})}}),d.h$X(t,{type:"created",frequency:n.frequency})}function v(e){const{automationId:t,spaceId:o,collectionPointer:n,templatePageId:i}=e;return{parent_id:t,parent_table:r.cv,type:"create_page",alive:!0,space_id:o,config:{collection:n,template_page_id:i}}}},21269:(e,t,o)=>{o.d(t,{Z:()=>c});o(67294);var n=o(480),i=o(84169),r=o(50906),a=o(42917),s=o(16354),l=o(85893);const c=function(e){window.__c={n:"CollectionSettingsLearnMoreButton"};const{title:t,href:o,analyticsFrom:c}=e,d=(0,n.O7)();return(0,l.jsx)(s.Z,{href:o,onClick:()=>r.Fsx(d,{from:c}),external:!0,children:(0,l.jsx)(a.Z,{icon:i.m,title:t,isGray:!0})})}},71846:(e,t,o)=>{o.d(t,{S:()=>b,Z:()=>R});o(57658),o(67294);var n=o(83355),i=o(49085),r=o(56666),a=o(44495),s=o(6287),l=o(31412),c=o(8406),d=o(31299),u=o(33929),p=o(80444),m=o(29798),g=o(26350),f=o(73657),h=o(52275),v=o(68894),y=o(32163),S=o(11470),_=o(77137),M=o(72495),x=o(26388),C=o(78948),I=o(85893);let b=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({});const k=(0,l.defineMessages)({linkedInputPlaceholder:{defaultMessage:"Link to a database…",id:"database.viewSettings.searchCollections.linkedInputPlaceholder"},linkedOrSourceInputPlaceholder:{defaultMessage:"Link or create a database…",id:"database.viewSettings.searchCollections.linkedOrSourceInputPlaceholder"},automationInputPlaceholder:{id:"automations.databasePicker.automationInputPlaceholder",defaultMessage:"Select a database…"}});class P extends n.Z{constructor(){super(...arguments),this.storeTypes={inputStore:i.default.createClass(""),limitStore:i.default.createClass(5),menuListStore:m.Z},this.performSearchCollections=async e=>{const{query:t,limit:o}=e,{currentSpaceStore:n}=p.default.state,{collectionContextStore:i,parentStore:r,requireEditPermissions:a}=this.props,s=null==i?void 0:i.collectionViewBlockStore(),l=await d.RT({environment:this.environment,collectionViewBlockStore:s,parentStore:r,spaceStore:n,query:t,limit:o,requireEditPermissions:a});return{results:l.results,showMore:Math.max(0,l.total-l.results.length)}}}renderComponent(){const{collectionContextStore:e,selectedCollectionStore:t,context:o,parentStore:n}=this.props,{device:i}=this.environment,{limitStore:a,inputStore:c,menuListStore:p}=this.stores,m=c.state,x="linked"===(null==e?void 0:e.getCollectionViewBlockSourceState())||o===b.Relation?k.linkedInputPlaceholder:o===b.Source?k.linkedOrSourceInputPlaceholder:k.automationInputPlaceholder;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(M.Z,{children:(0,I.jsx)(v.ZP,{focusInitial:!i.isMobile||void 0,value:m,onChange:e=>{c.setState(e.target.value),a.setState(e.target.value?20:5),p.setState({focus:{section:0,indexLocal:0,indexGlobal:0}})},placeholder:u.default.formatMessage(x),showClearButton:!0})}),(0,I.jsx)(_.Z,{request:{query:m,limit:a.state},performRequest:this.performSearchCollections,debounce:d.vp,render:(i,c,d)=>{if(!c)return(0,I.jsx)(M.Z,{children:(0,I.jsx)(C.Z,{})});const{results:u,showMore:m}=c,v=u.map((i=>{const r=g.NW.createChildStore(n,{table:s.v,id:i});return{key:i,render:n=>{var a;return(0,I.jsx)(S.Z,{...n,checkState:t&&t.id===i,store:r,right:o===b.Relation&&(null==e||null===(a=e.collectionStore())||void 0===a?void 0:a.id)===i&&(0,I.jsx)(T,{})})},action:e=>{const{index:t}=e;this.handleAcceptExistingCollection({collectionStore:r,totalResults:u.length,clickedIndex:t})}}}));if(m>0){const e={key:"showMore",render:e=>(0,I.jsx)(h.Z,{...e,buttonStyle:{color:this.theme.mediumTextColor,fill:this.theme.mediumIconColor},icon:(0,r.o)({width:16,height:16}),title:(0,I.jsx)(l.FormattedMessage,{defaultMessage:"Show {showMore} more",id:"database.viewSettings.searchCollections.showMore.title",values:{showMore:Math.min(m,20)}})}),action:()=>{a.setState(a.state+20)}};v.push(e)}return(0,I.jsxs)(I.Fragment,{children:[u.length>0&&(0,I.jsx)(y.Z,{type:y.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,I.jsx)(M.Z,{...e}),items:v}],store:p}),0===u.length&&(0,I.jsx)(f.Z,{caption:(0,I.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.searchCollections.noResultsTitle"})})]})}})]})}handleAcceptExistingCollection(e){const{collectionStore:t,totalResults:o,clickedIndex:n}=e,{collectionContextStore:i,searchSessionId:r,context:a}=this.props,{inputStore:s}=this.stores;i&&c.wd({environment:this.environment,collectionContextStore:i,action:"select_existing_collection"});const{onAccept:l}=this.props;l(t),c.tW({environment:this.environment,eventName:"select_search_item",totalResults:o,clickedIndex:n,sessionId:r,source:a,queryLength:s.state.length})}}P.displayName="CollectionSettingsSearchCollections";const R=(0,l.injectIntl)(P);function T(){return(0,I.jsx)(x.Z,{renderTooltip:()=>(0,I.jsx)(l.FormattedMessage,{defaultMessage:"This database",id:"database.viewSettigs.searchCollections.thisDatabase.tooltip"}),render:e=>(0,I.jsx)("div",{...e,children:(0,a.D)({width:14,height:14})})})}},40071:(e,t,o)=>{o.d(t,{Z:()=>J});var n=o(94184),i=o.n(n),r=(o(67294),o(83355)),a=o(15145),s=o(88437),l=o(39132),c=o(18557),d=o(53470),u=o(37612),p=o(72126),m=o(31412),g=o(50906),f=o(98834),h=o(47307),v=o(96802),y=o(3992),S=o(75018),_=o(39699),M=o(66890),x=o(66213),C=o(19037),I=o(43250),b=o(84210),k=o(33929),P=o(87279),R=o(98742),T=o(25498),w=o(77907),A=o(17031),j=o(80444),V=o(61766),Z=o(77080),E=o(96049),F=o(31792),O=o(26350),D=o(24736),B=o(45669),N=o(93405),L=o(31945),q=o(78140),K=o(32163),W=o(53437),U=o(31278),$=o(76798),z=o(72495),X=o(26388),Y=o(34574),G=o(85893);const H=(0,m.defineMessages)({emptyPageTitle:{defaultMessage:"Empty",id:"database.templatePicker.emptyPageTitle"}});class Q extends r.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:F.Z,buttonPopupStore:V.Z},this.renderActionMenuPopup=e=>{const{device:t}=this.environment,o=!!this.props.templateStore&&(0,C.J5)({environment:this.environment,blocks:[this.props.templateStore],publicEditMode:void 0}),n={key:"section",render:e=>(0,G.jsx)(z.Z,{...e}),items:p.oA([this.props.templateStore&&!this.canEditContentOnly.state&&o&&{key:"repeatControl",render:(e,t)=>this.props.templateStore&&(0,G.jsx)(w.LazyRecurrenceConfigMenu,{...e,templateStore:this.props.templateStore,parent:t,cannotEditRecurrence:this.cannotEditRecurrence.state}),action:this.handleRecurrence},this.props.isOverlay&&!this.canEditContentOnly.state&&{key:"Set default",render:e=>(0,G.jsx)(N.Z,{...e,title:(0,G.jsx)(m.FormattedMessage,{defaultMessage:"Set as default",id:"database.collectionTemplatePickerItem.actionMenu.setAsDefault"}),svg:c.z}),action:()=>this.handleSetAsDefault(e)},this.props.templateStore&&{key:"Edit",render:e=>(0,G.jsx)(N.Z,{...e,title:o?(0,G.jsx)(m.FormattedMessage,{defaultMessage:"Edit",id:"database.templatePickerItem.actionMenu.edit"}):(0,G.jsx)(m.FormattedMessage,{defaultMessage:"View",id:"database.templatePickerItem.actionMenu.view"}),svg:o?d.H:l.c}),action:this.handleEdit},this.props.templateStore&&!this.canEditContentOnly.state&&o&&{key:"Duplicate",render:e=>(0,G.jsx)(N.Z,{...e,title:(0,G.jsx)(m.FormattedMessage,{defaultMessage:"Duplicate",id:"database.templatePickerItem.actionMenu.duplicate"}),svg:s.a}),action:this.handleDuplicate},this.props.templateStore&&!this.canEditContentOnly.state&&o&&{key:"Delete",render:e=>(0,G.jsx)(N.Z,{...e,title:(0,G.jsx)(m.FormattedMessage,{defaultMessage:"Delete",id:"database.templatePickerItem.actionMenu.delete"}),svg:u.y}),action:o?this.handleDelete:()=>{}}])};let i;return i=t.isMobile?{menuType:P.og.ActionSheet}:{menuType:P.og.Popup,width:230},(0,G.jsx)(q.Z,{...i,children:(0,G.jsx)(K.Z,{type:K.i.Vertical,initialFocus:void 0,sections:[n]})})},this.handleRecurrence=()=>{g.efr(this.environment,{isConfigured:void 0!==this.props.recurrence})},this.handleEdit=()=>{var e,t;const{buttonPopupStore:o}=this.stores;this.props.templateStore&&(null===(e=(t=this.props).onCancelClick)||void 0===e||e.call(t),this.navigateToBlock(this.props.templateStore),o.reset(),g.sYL(this.environment,{template_action:"edit"}))},this.handleDuplicate=()=>{var e,t;const{buttonPopupStore:o}=this.stores,{templateStore:n,collectionStore:i}=this.props;if(!n)return;null===(e=(t=this.props).onCancelClick)||void 0===e||e.call(t);const{performResult:r}=_.createAndCommit({userAction:"CollectionTemplatePickerItem.duplicatedStore",environment:this.environment,perform:e=>{const t=f.Zh({environment:this.environment,collectionStore:i,templateStore:n,transaction:e});if(n.getAutomationId()){const o=O.Mz.fromBlockStore(n),i=null==o?void 0:o.getRecurrence();o&&null!=o&&o.isActive()&&i&&y.createRecurrenceInner(e,this.environment,t,i)}return t}});r&&this.navigateToBlock(r),o.reset(),g.sYL(this.environment,{template_action:"duplicate"})},this.handleDelete=async()=>{const{templateStore:e,collectionStore:t}=this.props;if(!e)return;await h.confirmUserAction({message:(0,G.jsx)(m.FormattedMessage,{defaultMessage:"Are you sure you would like to delete this template?",id:"database.confirmDialog.templatePickerItem.deleteMessage"}),acceptLabel:(0,G.jsx)(m.FormattedMessage,{defaultMessage:"Delete",id:"database.confirmDialog.templatePickerItem.deleteButton.label"})})&&(_.createAndCommit({userAction:"CollectionTemplatePickerItem.handleDelete",environment:this.environment,perform:o=>f.R5({collectionStore:t,templateStore:e,transaction:o})}),g.sYL(this.environment,{template_action:"delete"}))},this.handleSetAsDefault=e=>{var t,o;const{collectionContextStore:n}=this.context,i=null==n?void 0:n.collectionStore(),r=null==n?void 0:n.collectionViewStore();if(!i||null==r||!r.isDefined())return;const a=null!==(t=this.props.templateStore)&&void 0!==t&&t.id?{template_page_id:null===(o=this.props.templateStore)||void 0===o?void 0:o.id}:"empty";h.showDialog({showCancel:!0,keepFocus:!1,message:(0,G.jsx)(m.FormattedMessage,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.message",defaultMessage:"<span>Use “{pageName}” as default template when creating new pages?</span>",values:{span:e=>(0,G.jsx)("span",{children:e}),pageName:this.props.templateStore?(0,G.jsx)($.Z,{store:this.props.templateStore,style:{display:"inline"}}):k.default.formatMessage(H.emptyPageTitle)}}),items:[{label:(0,G.jsx)(m.FormattedMessage,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollection",defaultMessage:"For all views in “{databaseName}”",values:{databaseName:(0,G.jsx)($.Z,{store:i,style:{display:"inline"}})}}),onAccept:()=>{e.close(),_.createAndCommit({environment:this.environment,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collection",perform:e=>{v.FH({stores:[i],update:{collection_default_template:a},transaction:e}),v.FH({stores:[r],update:{collection_view_default_template:a},transaction:e})}})}},{label:(0,G.jsx)(m.FormattedMessage,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollectionView",defaultMessage:"Only on “{viewName}” view",values:{viewName:(0,G.jsx)(B.Z,{collectionViewName:r.getName(),collectionViewType:r.getType()})}}),onAccept:()=>{e.close(),_.createAndCommit({environment:this.environment,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collectionView",perform:e=>{v.FH({stores:[r],update:{collection_view_default_template:a},transaction:e})}})}}]})},this.handleMouseMove=()=>{E.Z.state||this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.getRecordModel=this.props.collectionStore.getRecordModel,this.canEditContentOnly=this.createComputedStore((()=>{var e;return Boolean(null===(e=this.props.collectionStore.getParentBlockStore())||void 0===e?void 0:e.canEditContentOnly())})),this.cannotEditRecurrence=this.createComputedStore((()=>{if(!Z.default.checkGate("recurrence_queue_task_improvements"))return!1;if(!this.props.templateStore)return!1;const e=(0,T.w)(this.props.templateStore);return!e.automationStoresReady||e.violatesConstraint}))}get registries(){return[A.Z]}navigate(e){this.context.overrideLinkClick?this.context.overrideLinkClick(e):S.navigate({environment:this.environment,url:e})}renderComponent(){var e;const{device:t}=this.environment,{templateStore:o,isMobile:n,isOverlay:i,focused:r,locked:a,canConfigureCollection:s,draggable:l}=this.props,{mouseStore:c,buttonPopupStore:d}=this.stores,u=!o&&!i,p=(!a||a&&!l)&&(s||this.canEditContentOnly.state)&&(c.state.mouseEntered||d.state.open||n||i)&&!u,m=o?(0,G.jsx)($.Z,{store:o}):k.default.formatMessage(H.emptyPageTitle),g=null==o||null===(e=o.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:this.getRecordModel});return(0,G.jsx)(Y.Z,{className:I.$ji,type:o?"custom_template":"empty_page",format:i?"collection-overlay":"page-menu-item",locked:a||!s||!l,icon:(0,G.jsx)(U.Z,{disabled:!0,icon:g,isEmptyPage:(null==o?void 0:o.isEmptyPage())??!0,size:t.isMobile&&i?24:20,isLarge:!i,style:{...!i&&{pointerEvents:"none",marginRight:10}},pageIconStyle:{...!i&&{fill:this.theme.lightIconColor}}}),title:m,onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,right:p&&this.renderActionMenuButton(),onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,focused:r,isDefault:this.props.isDefault,recurrence:this.props.recurrence})}renderActionMenuButton(){const{isMobile:e,isOverlay:t}=this.props,{buttonPopupStore:o}=this.stores,n=!!this.props.templateStore&&(0,C.J5)({environment:this.environment,blocks:[this.props.templateStore],publicEditMode:void 0});return(0,G.jsx)(X.Z,{renderTooltip:()=>n?(0,G.jsx)(m.FormattedMessage,{defaultMessage:"Edit this template",id:"database.templatePickerItem.editTemplate.tooltip"}):(0,G.jsx)(m.FormattedMessage,{defaultMessage:"View this template",id:"database.templatePickerItem.viewTemplate.tooltip"}),delayThreshold:300,render:n=>(0,G.jsx)(L.ZP,{popupType:e?W.ZP.PopupType.SlideUp:W.ZP.PopupType.Popup,placementToOrigin:L.pO.Right,originGap:12,buttonPopupStore:o,renderOrigin:o=>(0,G.jsx)(D.Z,{className:i()(I.C_N,{[I.JiD]:e||t}),isMobile:e&&t,style:{...!t&&{marginRight:0}},...(0,R.Z)(n,o)}),render:this.renderActionMenuPopup,onClick:()=>{g.sYL(this.environment,{template_action:"open_menu"})}})})}navigateToBlock(e){const{mainEditorCurrentBlockStore:t}=j.default.state,o=t?(0,b.ZP)({store:t,peekViewBlockId:e.id,fullyQualified:!1,pageVisitSource:a.tY.PeekOpen}):(0,b.ZP)({store:e,fullyQualified:!1,pageVisitSource:a.tY.LinkInPage});this.navigate(o)}}Q.displayName="CollectionTemplatePickerItem",Q.contextTypes={...r.w,...x.wK,...M.xm};const J=Q},45669:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(31412),i=o(78316),r=o(62896),a=o(85893);const s=function(e){let{collectionViewName:t,collectionViewType:o}=e;return t?(0,a.jsx)(r.Z,{children:t}):"page"===o?(0,a.jsx)(n.FormattedMessage,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,a.jsx)(n.FormattedMessage,{...i.b1[o]})}},34574:(e,t,o)=>{o.d(t,{Z:()=>g});o(67294);var n=o(83355),i=o(49271),r=o(8848),a=o(53523),s=o(82990),l=o(31412),c=o(19124),d=o(64921),u=o(52275),p=o(85893);class m extends n.Z{constructor(){super(...arguments),this.completionsEnabledStore=this.createComputedStore((()=>{var e;const t=null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state;return(0,c.GD)(t)}))}renderComponent(){return"collection-overlay"===this.props.format?this.renderCollectionOverlayMenuItem():"phone-modal"===this.props.format?this.renderPhoneModalMenuItem():this.renderPageMenuItem()}renderCollectionOverlayMenuItem(){const{device:e}=this.environment;return(0,p.jsx)(u.Z,{className:this.props.className,icon:this.props.icon,title:this.renderTitle(),right:this.props.right,focused:this.props.focused,onClick:this.props.onClick,onMouseMove:this.props.onMouseMove,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,showDragHandle:!e.isMobile&&!this.props.locked,dragHandleDisabled:"empty_page"===this.props.type})}renderPhoneModalMenuItem(){return(0,p.jsx)(u.Z,{icon:this.props.icon,title:this.renderTitle(),focused:this.props.focused,onClick:this.props.onClick,showDragHandle:!1})}renderPageMenuItem(){return(0,p.jsxs)(d.Z,{style:this.getWrapStyle(),hovered:this.props.focused,onClick:this.props.onClick,onMouseMove:this.props.onMouseMove,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,hoveredStyle:{background:this.theme.buttonHoveredBackground,color:this.theme.regularTextColor},pressedStyle:{background:this.theme.buttonPressedBackground},children:[(0,p.jsx)("div",{style:{display:"flex",alignItems:"center",width:24,height:24,marginRight:10},children:this.props.icon}),this.renderTitle(),this.props.right&&(0,p.jsx)("div",{style:{marginLeft:"auto",marginRight:4},children:this.props.right})]})}renderTitle(){return"collection-overlay"!==this.props.format?this.props.title:(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[this.props.title,(0,p.jsxs)("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[this.props.isDefault&&(0,p.jsx)("span",{style:{fontSize:12,fontWeight:s.Z.fontWeight.medium,color:this.theme.mediumTextColor},children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"DEFAULT",id:"database.templatePickerMenuItem.default"})}),this.props.recurrence&&(0,a.N)({width:14,color:r.ZP.blue,marginLeft:8})]})]})}getWrapStyle(){const{device:e}=this.environment;return{...i.ZD,display:"flex",alignItems:"center",flexGrow:1,height:e.isMobile?36:32,fontSize:16,borderRadius:4,paddingLeft:8,marginBottom:2,color:this.completionsEnabledStore.state?this.theme.mediumTextColor:this.theme.lightTextColor}}}m.displayName="TemplatePickerMenuItem";const g=m},40863:(e,t,o)=>{o.d(t,{BO:()=>v,Ft:()=>p,Lh:()=>M,YG:()=>m,du:()=>h,y$:()=>f});o(57658);var n=o(30120),i=o(30823),r=o(40506),a=o(53877),s=o(42875),l=o(72126),c=o(59753),d=o(31412),u=o(28020);function p(e){const{collectionContextStore:t}=e,o=t.collectionViewStore();if(!o)return;const n=t.normalizedSchemaStore.state,i=o.getQuery(n);if(!i||!i.calendar_by)return;const r=t.dateRangeStart.state,l=t.dateRangeEnd.state,c=(0,a.hT)(r,(0,s.r)()),d=(0,a.hT)(l,(0,s.r)());return g({calendarBy:i.calendar_by,dateRangeStartDate:c,dateRangeEndDate:d})}function m(e){const{collectionContextStore:t,startOfDay:o}=e,i=t.collectionViewStore();if(!i)return;const r=t.normalizedSchemaStore.state,l=i.getQuery(r);if(!l||!l.calendar_by)return;const c=n.ou.fromMillis(o).endOf("day").valueOf(),d=(0,a.hT)(o,(0,s.r)()),u=(0,a.hT)(c,(0,s.r)());return g({calendarBy:l.calendar_by,dateRangeStartDate:d,dateRangeEndDate:u})}function g(e){const{dateRangeStartDate:t,dateRangeEndDate:o,calendarBy:n}=e;return{type:"results",filter:{operator:"and",filters:[{property:n,filter:{operator:"date_is_on_or_after",use_end:!0,value:{type:"exact",value:t}}},{property:n,filter:{operator:"date_is_on_or_before",value:{type:"exact",value:o}}}]},limit:5e3}}function f(e){const{collectionContextStore:t,results:o,getRecordValue:n,intl:i}=e,c=t.collectionViewStore(),d=t.normalizedQueryStore.state,p=t.normalizedSchemaStore.state,m=d?d.calendar_by:void 0,g=t.dateRangeStart.state,f=t.dateRangeEnd.state,S=u.AK.state,_=(0,s.r)(),M=t.getCurrentUserId();if(!(c&&d&&m&&p))return;const x=l.oA(o.map((e=>v({blockStore:e,calendarBy:m,schema:p,getRecordValue:n,userId:M,intl:i})))),C={};o.forEach(((e,t)=>{C[e.id]=t}));0===(d.sort||[]).length&&x.sort(((e,t)=>{const o=e.start.valueOf(),n=t.start.valueOf();if(o===n){return C[e.id]-C[t.id]}return o-n}));const I=(0,a.em)(g,S,_),b=(0,a.gQ)(f,S,_);let k=I;const P=[];do{const e=(0,a.gQ)(k.valueOf(),S,_),t={},o=x.filter((t=>(0,r.b8)(k.valueOf(),e.valueOf(),t.start.valueOf(),t.end?t.end.valueOf():void 0))).map((o=>{const{id:n,start:i,end:r,includeTime:a,timeZone:s}=o,{startColumn:l,columnCount:c}=h({startUnixTimestampMS:i.valueOf(),endUnixTimestampMS:r?r.valueOf():void 0,startOfWeekUnixTimestampMS:k.valueOf(),endOfWeekUnixTimestampMS:e.valueOf()}),d=y(l,c,t);return{id:n,start:i.valueOf(),end:r?r.valueOf():void 0,row:d,includeTime:a,timeZone:s}}));P.push({start:k.valueOf(),end:e.valueOf(),items:o}),k=(0,a.em)(k.plus({week:1}).plus({hour:25}).valueOf(),S,_)}while(k<b);return P}function h(e){const t=n.ou.fromMillis(e.startUnixTimestampMS),o=e.endUnixTimestampMS?n.ou.fromMillis(e.endUnixTimestampMS):void 0,i=n.ou.fromMillis(e.startOfWeekUnixTimestampMS),r=n.ou.fromMillis(e.endOfWeekUnixTimestampMS),a=t.startOf("day"),s=n.ou.max(i,a),l=Math.ceil(s.diff(i,"days").get("days"));let c=1;if(o){const e=o.endOf("day"),t=n.ou.min(r,e);c=Math.ceil(t.diff(s,"days").get("days"))}return{start:t,end:o,startOfWeek:i,endOfWeek:r,startColumn:l,columnCount:c}}function v(e){const{blockStore:t,calendarBy:o,schema:n,getRecordValue:r,intl:l,userId:d}=e,u=t.getModel();if(!u)return;const p=(0,i.FT)({property:o,schema:n,block:u,getRecordModel:c.om.fromGetRecordValueFn(r),propertyMapping:void 0,collectionRequestContext:{userId:d,userTimeZone:(0,s.r)(),depth:0,intl:l,visitedProperties:new Set,resultCache:new Map}}).next().value;if("date"!==p.type)return;const m=p.value,g=m&&(0,a.NK)(m,(0,s.r)());if(!m||!g)return;return{id:u.id,start:g.start,end:g.end,includeTime:"datetime"===m.type||"datetimerange"===m.type,timeZone:"datetime"===m.type||"datetimerange"===m.type?m.time_zone:void 0}}function y(e,t,o){let n=0;for(;;){let i=!1;for(let r=0;r<t;r++)S(o,e+r,n)&&(i=!0);if(!i)break;n++}for(let i=0;i<t;i++)_(o,e+i,n);return n}function S(e,t,o){return Boolean(e[o]&&e[o][t])}function _(e,t,o){e[o]||(e[o]={}),e[o][t]=!0}const M=(0,d.defineMessages)({week:{defaultMessage:"Week",id:"calendar.viewRanges.week"},month:{defaultMessage:"Month",id:"calendar.viewRanges.month"}})},11335:(e,t,o)=>{o.d(t,{EE:()=>Z,EF:()=>$,Li:()=>O,P$:()=>H,R4:()=>G,WM:()=>N,Xd:()=>j,cB:()=>U,i1:()=>D,j_:()=>Q,qM:()=>B,qk:()=>E,rU:()=>W,sA:()=>X,tk:()=>z,vM:()=>K,wB:()=>F});o(21703),o(57658);var n=o(43261),i=o.n(n),r=o(67294),a=o(86628),s=o(3865),l=o(83372),c=o(23290),d=o(76205),u=o(1274),p=o(84116),m=o(78106),g=o(76218),f=o(72126),h=o(26825),v=o(4615),y=o(149),S=o(98963),_=o(18844),M=o(77420),x=o(6287),C=o(13493),I=o(97880),b=o(77080),k=o(30874),P=o(26350),R=o(35057),T=o(30912),w=o(52821),A=o(33929);function j(e){return e.isTriggerType("event")||e.isTriggerType("notification_event")}function V(e){const{action:t,actionValue:o,automationValue:n}=e;var i,r,a,s,l,c,d;if("create_page"===t.action.type){if(!o||"create_page"===o.type)return function(e){const{actionId:t,automationId:o,collectionPointer:n,properties:i,values:r,spaceId:a,templatePageId:s}=e;return{...Y({actionId:t,actionType:"create_page",automationId:o,spaceId:a}),config:{collection:n,properties:i,values:r,template_page_id:s}}}({actionId:t.action.id,automationId:n.id,collectionPointer:(null===(i=t.action.config)||void 0===i?void 0:i.collection)??(null==o||null===(r=o.config)||void 0===r?void 0:r.collection),properties:(null===(a=t.action.config)||void 0===a?void 0:a.properties)??(null==o||null===(s=o.config)||void 0===s?void 0:s.properties),spaceId:n.space_id,values:(null===(l=t.action.config)||void 0===l?void 0:l.values)??(null==o||null===(c=o.config)||void 0===c?void 0:c.values),templatePageId:null===(d=t.action.config)||void 0===d?void 0:d.template_page_id})}else if("update_pages"===t.action.type){var u,p,m,g,f,h;if(!o||"update_pages"===o.type)return function(e){const{actionId:t,automationId:o,properties:n,spaceId:i,target:r,values:a}=e;return{...Y({actionId:t,actionType:"update_pages",automationId:o,spaceId:i}),config:{target:r,properties:n,values:a}}}({actionId:t.action.id,automationId:n.id,properties:(null===(u=t.action.config)||void 0===u?void 0:u.properties)??(null==o||null===(p=o.config)||void 0===p?void 0:p.properties),spaceId:n.space_id,target:(null===(m=t.action.config)||void 0===m?void 0:m.target)??(null==o||null===(g=o.config)||void 0===g?void 0:g.target),values:(null===(f=t.action.config)||void 0===f?void 0:f.values)??(null==o||null===(h=o.config)||void 0===h?void 0:h.values)})}else if("slack_notification"===t.action.type){var v,y,S,_;if(!o||"slack_notification"===o.type)return function(e){const{actionId:t,automationId:o,externalBotId:n,spaceId:i,target:r}=e;return{...Y({actionId:t,actionType:"slack_notification",automationId:o,spaceId:i}),config:{target:r,external_bot_id:n}}}({actionId:t.action.id,automationId:n.id,externalBotId:(null===(v=t.action.config)||void 0===v?void 0:v.external_bot_id)??(null==o||null===(y=o.config)||void 0===y?void 0:y.external_bot_id),spaceId:n.space_id,target:(null===(S=t.action.config)||void 0===S?void 0:S.target)??(null==o||null===(_=o.config)||void 0===_?void 0:_.target)})}else{if("duplicate_blocks"===t.action.type||"modal_confirmation"===t.action.type||"open_page"===t.action.type||"query_collection"===t.action.type||"complete_sprint"===t.action.type)return;(0,I.t1)(t.action)}}function Z(e){const{automationStore:t,currentUserId:o,inMemoryRecordCache:n}=e;return(0,a.VK)((()=>{const e=null==t?void 0:t.getRole(),i=null==t?void 0:t.getValue(),r=(null==t?void 0:t.getActionStores().map((e=>e.getValue())).filter(I.$K))??[],a=null==t?void 0:t.pointer;return c=>{if(o&&e&&i&&a){if(!(0,s.Vd)(i)&&!(0,s.nl)(i))return i;if("update_name"===c.type){const t=function(e){var t;const{action:o,automationValue:n}=e;return(null===(t=n.properties)||void 0===t?void 0:t.name)!==o.name?{...n,properties:{...n.properties,name:o.name}}:n}({action:c,automationValue:i});i!==t&&(n.setRecord({pointer:a,userId:o},{role:e,value:t}),n.emitAll())}else if("update_source"===c.type){const t=function(e){const{action:t,automationValue:o}=e,n=t.pointer,i=n.table===x.v?{pointer:n,type:x.v}:{pointer:n,type:C.n};return{...o,trigger:{...o.trigger,event:{...o.trigger.event,source:i}}}}({action:c,automationValue:i});i!==t&&(n.setRecord({pointer:a,userId:o},{role:e,value:t}),n.emitAll())}else if("update_trigger"===c.type){const t=function(e){const{action:t,automationValue:o}=e,n=t.trigger;if("page_added"===n.type)return o.trigger.event.pagesAdded?o:{...o,trigger:{...o.trigger,event:{...o.trigger.event,pagesAdded:!0}}};if("any_page_property_edited"===n.type)return"any"!==o.trigger.event.pagePropertiesEdited.type?{...o,trigger:{...o.trigger,event:{...o.trigger.event,pagePropertiesEdited:{type:"any"}}}}:o;if("property_changed"===n.type){const e="some"===o.trigger.event.pagePropertiesEdited.type?o.trigger.event.pagePropertiesEdited.some:[],t=f.cx(e,(e=>e.property===n.property)),i={filter:n.filter,property:n.property},r=-1===t?[...e,i]:e.map((e=>e.property===n.property?i:e));return{...o,trigger:{...o.trigger,event:{...o.trigger.event,pagePropertiesEdited:{some:r,type:"some"}}}}}(0,I.t1)(n)}({action:c,automationValue:i});i!==t&&(n.setRecord({pointer:a,userId:o},{role:e,value:t}),n.emitAll())}else if("update_action"===c.type){var d;const t=r.find((e=>e.id===c.action.id)),s=V({action:c,actionValue:t,automationValue:i});if(!s)return;if(n.setRecord({pointer:{id:s.id,spaceId:i.space_id,table:_.Xj},userId:o},{role:"editor",value:s}),null===(d=i.action_ids)||void 0===d||!d.includes(s.id)){const t={...i,action_ids:[...i.action_ids??[],s.id]};n.setRecord({pointer:a,userId:o},{role:e,value:t})}n.emitAll()}else if("remove_action"===c.type){const r=c.action.id;n.deleteRecord({pointer:{id:r,spaceId:i.space_id,table:_.Xj},userId:o});const s={...i,action_ids:(i.action_ids??[]).filter((e=>e!==r))};n.setRecord({pointer:a,userId:o},{role:e,value:s}),function(e){const{automationStore:t,newAutomationValue:o,currentUserId:n,inMemoryRecordCache:i}=e,r=t.getParentStore();if((null==r?void 0:r.table)!==x.v)return;const a={automationStore:t,parentPointer:r.getSpaceShardedPointer(),type:"event",persisted:!0,intl:A.default.getIntl(),parentRecordStore:r},s=(0,T.pt)({context:a,automationValue:o});if(y.x.isFail(s))return;const c=(o.action_ids??[]).map((e=>({pointer:{id:e,spaceId:o.space_id,table:_.Xj},userId:n})));for(const u of c){const e=i.getRecordModel(u),t=i.getRecord(u);if(!e||!t||!t.value||"create_page"!==t.value.type&&"update_pages"!==t.value.type)continue;const o=new Set(s.value.actionInputValueTypes[e.id].map((e=>{if(e.kind===p.yp.ContextValue)return e.id;e.kind!==p.yp.ThisRow&&e.kind!==p.yp.Binding&&(0,I.t1)(e)})).filter(I.$K)),n=(0,l.z)(e.type).acceptFormulaVisitor({action:e,visitor:{visitVariableOutsideOfFormula:e=>o.has(e)?{type:"keep"}:{type:"replace",value:void 0},visitFormula:e=>e.value&&(0,g.UB)(e).some((e=>!o.has(e)))?{type:"replace",value:void 0}:{type:"keep"}}});let r=t.value;for(const i of n)if("update"===i.command)if(1===i.path.length&&"config"===i.path[0]&&Object.keys(i.args).includes("target")&&"update_pages"===r.type)r={...r,config:{target:void 0,properties:[],values:{}}};else if(2===i.path.length&&"config"===i.path[0]&&"values"===i.path[1]){var d;const e=Object.keys(i.args)[0];r={...r,config:{...r.config,values:{...null===(d=r.config)||void 0===d?void 0:d.values,[e]:void 0}}}}i.setRecord(u,{value:r,role:t.role})}}({automationStore:t,newAutomationValue:s,currentUserId:o,inMemoryRecordCache:n}),n.emitAll()}else if("remove_trigger"===c.type){const t=function(e){const{action:t,automationValue:o}=e,n=t.trigger;if("page_added"===n.type)return o.trigger.event.pagesAdded?{...o,trigger:{...o.trigger,event:{...o.trigger.event,pagesAdded:!1}}}:o;if("any_page_property_edited"===n.type)return"any"===o.trigger.event.pagePropertiesEdited.type?{...o,trigger:{...o.trigger,event:{...o.trigger.event,pagePropertiesEdited:{type:"none"}}}}:o;if("property_changed"===n.type){const e=("some"===o.trigger.event.pagePropertiesEdited.type?o.trigger.event.pagePropertiesEdited.some:[]).filter((e=>e.property!==n.property));return{...o,trigger:{...o.trigger,event:{...o.trigger.event,pagePropertiesEdited:e.length>0?{some:e,type:"some"}:{type:"none"}}}}}(0,I.t1)(n)}({action:c,automationValue:i});i!==t&&(n.setRecord({pointer:a,userId:o},{role:e,value:t}),n.emitAll())}else(0,I.t1)(c)}}}),[t,o,n])}function E(e){const{automationContextStore:t,automationStore:o,collectionStore:n}=e,i=n.getSchema(),r=o.getKeyStore("properties").getKeyStore("name").getValue();if(null==r||!r.trim())return!1;const a=o.getTrigger(),s="event"===(null==a?void 0:a.type),l="notification_event"===(null==a?void 0:a.type);if(!s&&!l)return!1;const{pagesAdded:c,pagePropertiesEdited:d,source:u}=a.event;if(void 0===u)return!1;if("some"===d.type&&d.some.some((e=>L({collectionSchema:i,property:e.property})||q({collectionSchema:i,property:e.property,type:"trigger"}))))return!1;if(!c&&("none"===d.type||"some"===d.type&&0===d.some.length))return!1;const p=o.getActionStores().filter((e=>e.isDefined()));return 0!==p.length&&p.every((e=>function(e){const{actionStore:t,automationContextStore:o,collectionStore:n}=e;if(t.isType("slack_notification"))return(0,I.$K)(t.getConfigStore().getKeyStore("external_bot_id").getValue())&&(0,I.$K)(t.getConfigStore().getKeyStore("target").getValue());if(t.isType("update_pages")){const e=t.getConfigStore().getKeyStore("target").getValue(),i=t.getConfigStore().getKeyStore("properties").getValue()??[];if(!(0,I.$K)(e)||0===i.length)return!1;if("collection"===e.type){const t=P.NW.createChildStore(n,e.collection).getSchema();if(i.some((e=>L({property:e,collectionSchema:t})||q({collectionSchema:t,property:e,type:"action"}))))return!1}else if("variable"===e.type){const t=(0,m.MY)(e.id);if("global"===t.source&&"button_page"===t.global){const e=n.getSchema();if(i.some((t=>L({property:t,collectionSchema:e})||q({collectionSchema:e,property:t,type:"action"}))))return!1}else{const t=null==o?void 0:o.compilationResultStore.state;if(!t||y.x.isFail(t))return!1;const n=(0,m.vx)(t.value.valueTypes,e.id),r=n?F(n,o.context.parentRecordStore):void 0;if(!r)return!1;const a=r.getSchema();if(i.some((e=>L({property:e,collectionSchema:a})||q({collectionSchema:a,property:e,type:"action"}))))return!1}}else{if("page"===e.type)return!1;(0,I.t1)(e)}return!0}if(t.isType("create_page")){const e=t.getConfigStore().getKeyStore("collection").getValue();if(!(0,I.$K)(e))return!1;const o=P.NW.createChildStore(n,e).getSchema();return!(t.getConfigStore().getKeyStore("properties").getValue()??[]).some((e=>L({property:e,collectionSchema:o})||q({collectionSchema:o,property:e,type:"action"})))}throw new Error(`isActionStoreComplete not implemented for ${t.getType()}`)}({actionStore:e,automationContextStore:t,collectionStore:n})))}function F(e,t){let o;return"block"===e.type.type&&e.type.collection?o=P.NW.createChildStore(t,e.type.collection):"array"===e.type.type&&"block"===e.type.of.type&&e.type.of.collection&&(o=P.NW.createChildStore(t,e.type.of.collection)),o}function O(e){const{collectionStore:t}=e;if(!t)return!1;if((t.getFormat().automation_ids??[]).length>=c.ss&&!(0,R.sX)())return!1;const o=t.pointer,n=t.getSpaceId();return(0,u.IC)({targetTriggerType:"event",targetParentPointer:o,targetSpaceId:n}).every((e=>{let{pointer:o,minimumRequiredRole:n}=e;const i=t.getRecordRole(o);return!!i&&(0,h.yY)(i,n)}))}function D(e){const{automationStore:t,actionStores:o}=e,n=t.getMinimumFieldsForPermissions();if(!n)return!1;if(!o.every((e=>e.isDefined())))return!1;const i=o.some((e=>!e.isType("slack_notification")));if(!(0,R.sX)()&&i)return!1;return(0,u.fz)({automationValue:n,actionValues:o.map((e=>({config:e.getConfig(),type:e.getType()})))}).every((e=>{let{pointer:o,minimumRequiredRole:n}=e;const i=t.getRecordRole(o);return!!i&&(0,h.yY)(i,n)}))}function B(e){const{automationStore:t}=e,o=t.getMinimumFieldsForPermissions();if(!o)return!1;return(0,u.bM)(o).every((e=>{let{pointer:o,minimumRequiredRole:n}=e;const i=t.getRecordRole(o);return!!i&&(0,h.yY)(i,n)}))}function N(e){const{anyOptionCheckState:t,currentFilter:o,propertyId:n,updateCurrentState:i}=e;!0===t?i({type:"update_trigger",trigger:{type:"property_changed",property:n,filter:{operator:"changes_to_any"}}}):!1===t?i({type:"remove_trigger",trigger:{type:"property_changed",property:n,filter:{operator:"changes_to_any"}}}):"partial"===t?i({type:"update_trigger",trigger:{type:"property_changed",property:n,filter:o}}):(0,I.t1)(t)}function L(e){const{property:t,collectionSchema:o}=e;return!!o&&!o[t]}function q(e){const{collectionSchema:t,property:o,type:n}=e,i=null==t?void 0:t[o];return!i||("action"===n?!(0,s.SF)(i):!s.Ym[i.type])}function K(e){const{automationStore:t,collectionStore:o}=e;if(!t.isTriggerType("event")&&!t.isTriggerType("notification_event"))return!1;const n=t.getEventConfiguration();if(!n||void 0===n.source||n.source.type===x.v||"filter"===n.source.type)return!1;const i=P.Xr.createChildStore(o,n.source.pointer);return function(e){const t=W(e);return(0,I.$K)(t)}({collectionSchema:o.getSchema(),collectionViewStore:i})}function W(e){var t;const{collectionViewStore:o,collectionSchema:n}=e,i=o.getPropertyFiltersStore().getValue()??[],r=null===(t=o.getQuery(n))||void 0===t?void 0:t.filter,a={operator:"and",filters:(0,d.OH)({propertyFilters:i,combinatorFilter:r,schema:n})},l=(0,d.SH)(a,(e=>{if((0,d.aN)(e)){const t=n[e.property];return!!t&&!(0,s.TX)(t)}return!1}));if(l)return(0,d.aN)(l)?l.property:(0,d.Mm)(l)?l.timestamp:void 0}function U(e){if("collectionTypedView"===e.contextType)return!1;const t=e.collectionStore();return!!t&&!(t.isSyncedCollection()&&!b.default.checkGate("support_synced_database_automations"))}function $(e){const{collectionSchema:t,propertyIds:o,searchTerm:n}=e;if(!n)return o.slice(0);const r=new Map,a=o.map((e=>{const o=t[e],n=o?`${o.name} ${w.SO[o.type]}`:"";return r.set(e,n),n})),s=i().filter(n,a).map((e=>{let{original:t}=e;return t}));return o.filter((e=>s.includes(r.get(e)??"")))}function z(e){return y.x.isFail(e.compilationResultStore.state)?[]:e.compilationResultStore.state.value.valueTypes}function X(e){const{automationId:t,automationName:o,collectionStore:n,userId:i}=e;return function(e){const{actionIds:t,automationId:o,collectionStore:n,eventConfiguration:i,lastEditedTime:r,properties:a,userId:s}=e,l=Date.now();return{action_ids:t,alive:!0,created_by_id:s,created_by_table:"notion_user",created_time:l,id:o,last_edited_by_id:s,last_edited_by_table:"notion_user",last_edited_time:r??l,parent_id:n.id,parent_table:x.v,properties:a??{},space_id:n.getSpaceId(),status:"active",trigger:{event:i,id:(0,v.ZP)(),type:"event"},version:1}}({actionIds:[],automationId:t,collectionStore:n,eventConfiguration:{pagesAdded:!1,pagePropertiesEdited:{type:"none"},source:{pointer:n.getSpaceShardedPointer(),type:x.v}},properties:{name:o},userId:i})}function Y(e){const{actionId:t,actionType:o,automationId:n,spaceId:i}=e;return{alive:!0,id:t??(0,v.ZP)(),parent_id:n,parent_table:S.cv,space_id:i,type:o,version:1}}function G(e){const t=e.getActionStores().filter((0,I.AO)((e=>e.isType("slack_notification")?{true:e}:{false:e}))),o={};for(const n of t){const e=n.getConfig(),t=null==e?void 0:e.external_bot_id;if(!t)continue;const i=P.Qx.createChildStore(n,{id:t,spaceId:n.getSpaceId(),table:M.cZ}).getCreatedByStore();i&&(o[n.id]=i.getDisplayName(A.default.getIntl()))}return o}async function H(e){const{automationAvailabilityContext:t}=e;let o=t.automation.getTriggerType();"notification_event"===o&&(o="event");const n=c.Gl[o],i="default_bound"===n.max?c.xZ:n.max;if(t.automationActions.length>=i)return[];const r=(0,l.P)("display"),a=[];for(const s of r)await s.isAvailableForContext(t)&&a.push(s);return a}function Q(){const e=(0,a.VK)((()=>k.Z.completeSlackAuthentications.state),[]);return(0,r.useMemo)((()=>0===e.length?{type:"connectToSlackDefault"}:1===e.length?{type:"selectChannelNew"}:{type:"selectWorkspace"}),[e.length])}},25498:(e,t,o)=>{o.d(t,{m:()=>r,w:()=>a});o(57658);var n=o(81491),i=o(98165);const r=[{frequency:"day",interval:1},{frequency:"week",interval:1},{frequency:"month",interval:1},{frequency:"year",interval:1}],a=e=>{const t=i.qA(e)??[],o=[];for(const n of t){if(!("block"===n.table&&!0===n.isTemplate()&&n.getFormat().automation_id&&n.id!==e.id))continue;const t=n.getAutomationStore();if(t){if(!t.isReady())return{automationStoresReady:!1};void 0!==t.getRecurrence()&&t.isDefined()&&o.push(t.getModel())}}return{automationStoresReady:!0,violatesConstraint:(0,n.templateAncestorsViolateRecurrenceNesting)(o)}}},5971:(e,t,o)=>{o.d(t,{E:()=>r});var n=o(86628),i=o(77080);function r(e){return(0,n.VK)((()=>i.default.checkGate(e)),[e])}},68910:(e,t,o)=>{o.d(t,{L:()=>l});var n=o(14577),i=o(78106),r=o(72126),a=o(149),s=o(30912);class l{constructor(e){this.context=void 0,this.compilationResultStore=new n.Z((()=>(0,s.pt)({context:this.context})),{useDeepEqual:!0,debugName:"compilationResultsStore"}),this.context=e}getAllContextValues(){const e=this.compilationResultStore.state;return a.x.isFail(e)?[]:r.d9(e.value.valueTypes)}getContextValuesForAction(e){const t=this.compilationResultStore.state;return a.x.isFail(t)?[]:t.value.actionInputValueTypes[e]??[]}getValidationErrorsForAction(e){const t=this.compilationResultStore.state;return a.x.isFail(t)?[]:t.value.actionValidationFailures[e]??[]}getContextValueForActionById(e,t){const o=this.getContextValuesForAction(e);return(0,i.vx)(o,t)}}}}]);